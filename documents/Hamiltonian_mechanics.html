<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="898">Hamiltonian mechanics</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hamiltonian mechanics</h1>
<hr/>

<p><strong>Hamiltonian mechanics</strong> is a <a class="uri" href="theory" title="wikilink">theory</a> developed as a reformulation of <a href="classical_mechanics" title="wikilink">classical mechanics</a> and predicts the same outcomes as non-Hamiltonian classical mechanics. It uses a different mathematical formalism, providing a more abstract understanding of the theory. Historically, it was an important reformulation of classical mechanics, which later contributed to the formulation of <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>.</p>

<p>Hamiltonian mechanics was first formulated by <a href="William_Rowan_Hamilton" title="wikilink">William Rowan Hamilton</a> in 1833, starting from <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a>, a previous reformulation of classical mechanics introduced by <a href="Joseph_Louis_Lagrange" title="wikilink">Joseph Louis Lagrange</a> in 1788.</p>
<h2 id="overview">Overview</h2>

<p>In Hamiltonian mechanics, a classical physical system is described by a set of <a href="canonical_coordinates" title="wikilink">canonical coordinates</a> 

<math display="inline" id="Hamiltonian_mechanics:0">
 <semantics>
  <mrow>
   <mi>ùíì</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùíí</mi>
    <mo>,</mo>
    <mi>ùíë</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùíì</ci>
    <interval closure="open">
     <ci>ùíí</ci>
     <ci>ùíë</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{r}=(\boldsymbol{q},\boldsymbol{p})
  </annotation>
 </semantics>
</math>

, where each component of the coordinate 

<math display="inline" id="Hamiltonian_mechanics:1">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>i</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i},p_{i}
  </annotation>
 </semantics>
</math>

 is indexed to the <a href="frame_of_reference" title="wikilink">frame of reference</a> of the system.</p>

<p>The <a href="time_evolution" title="wikilink">time evolution</a> of the system is uniquely defined by Hamilton's equations:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>{\mathrm{d}t} = -\frac{\partial \mathcal{H}}{\partial \boldsymbol{q}}\\ &amp; \frac{\mathrm{d}\boldsymbol{q}}{\mathrm{d}t} = +\frac{\partial \mathcal{H}}{\partial \boldsymbol{p}} \end{align}  |cellpadding= 5 |border |border colour = #0073CF |background colour=#F5FFFA}}</p>

<p>where 

<math display="inline" id="Hamiltonian_mechanics:2">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
   <mo>=</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùíí</mi>
     <mo>,</mo>
     <mi>ùíë</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>‚Ñã</ci>
    <apply>
     <times></times>
     <ci>‚Ñã</ci>
     <vector>
      <ci>ùíí</ci>
      <ci>ùíë</ci>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}=\mathcal{H}(\boldsymbol{q},\boldsymbol{p},t)
  </annotation>
 </semantics>
</math>

 is the Hamiltonian, which often corresponds to the total energy of the system.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> For a closed system, it is the sum of the <a href="kinetic_energy" title="wikilink">kinetic</a> and <a href="potential_energy" title="wikilink">potential</a> energy in the system.</p>

<p>In Newtonian mechanics, the time evolution is obtained by computing the total force being exerted on each particle of the system, and from <a href="Newton's_laws_of_motion" title="wikilink">Newton's second law</a>, the time-evolutions of both position and velocity are computed. In contrast, in Hamiltonian mechanics, the time evolution is obtained by computing the Hamiltonian of the system in the generalized coordinates and inserting it in the Hamiltonian equations. This approach is equivalent to the one used in <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a>. In fact, as is shown below, the Hamiltonian is the <a href="Legendre_transform" title="wikilink">Legendre transform</a> of the Lagrangian, and thus both approaches give the same equations for the same generalized momentum. The main motivation to use Hamiltonian mechanics instead of Lagrangian mechanics comes from the <a href="Symplectic_manifold" title="wikilink">symplectic</a> structure of <a href="Hamiltonian_system" title="wikilink">Hamiltonian systems</a>.</p>

<p>While Hamiltonian mechanics can be used to describe simple systems such as a bouncing ball, a pendulum or an oscillating spring in which energy changes from kinetic to potential and back again over time, its strength is shown in more complex dynamic systems, such as planetary orbits in <a href="Perturbation_theory" title="wikilink">celestial mechanics</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The more degrees of freedom the system has, the more complicated its time evolution is and, in most cases, it becomes <a href="Chaos_theory" title="wikilink">chaotic</a>.</p>
<h3 id="basic-physical-interpretation">Basic physical interpretation</h3>

<p>A simple interpretation of the Hamilton mechanics comes from its application on a one-dimensional system consisting of one particle of mass <em>m</em>. The Hamiltonian represents the total energy of the system, which is the sum of <a href="kinetic_energy" title="wikilink">kinetic</a> and <a href="potential_energy" title="wikilink">potential energy</a>, traditionally denoted <em>T</em> and <em>V</em>, respectively. Here <em>q</em> is the coordinate and <em>p</em> is the momentum, <em>mv.</em> Then</p>

<p>

<math display="block" id="Hamiltonian_mechanics:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     <mo>=</mo>
     <mrow>
      <mi>T</mi>
      <mo>+</mo>
      <mi>V</mi>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mi>T</mi>
      <mo>=</mo>
      <mfrac>
       <msup>
        <mi>p</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mi>V</mi>
      <mo>=</mo>
      <mrow>
       <mi>V</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>q</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>‚Ñã</ci>
     <apply>
      <plus></plus>
      <ci>T</ci>
      <ci>V</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>T</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>V</ci>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}=T+V,\quad T=\frac{p^{2}}{2m},\quad V=V(q).
  </annotation>
 </semantics>
</math>

</p>

<p>Note that <em>T</em> is a function of <em>p</em> alone, while <em>V</em> is a function of <em>q</em> alone (i.e., <em>T</em> and <em>V</em> are <a class="uri" href="scleronomic" title="wikilink">scleronomic</a> ).</p>

<p>In this example, the time-derivative of the momentum <em>p</em> equals the <em>Newtonian force</em>, and so the first Hamilton equation means that the force equals the negative <a class="uri" href="gradient" title="wikilink">gradient</a> of potential energy. The time-derivative of <em>q</em> is the velocity, and so the second Hamilton equation means that the particle‚Äôs velocity equals the derivative of its kinetic energy with respect to its momentum.</p>
<h3 id="calculating-a-hamiltonian-from-a-lagrangian">Calculating a Hamiltonian from a Lagrangian</h3>

<p>Given a <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a> in terms of the <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> 

<math display="inline" id="Hamiltonian_mechanics:4">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i}
  </annotation>
 </semantics>
</math>

 and <a href="generalized_velocities" title="wikilink">generalized velocities</a> 

<math display="inline" id="Hamiltonian_mechanics:5">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>q</mi>
    <mo>Àô</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-Àô</ci>
     <ci>q</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}_{i}
  </annotation>
 </semantics>
</math>

 and time,</p>
<ol>
<li>The momenta are calculated by differentiating the Lagrangian with respect to the (generalized) velocities

<math display="block" id="Hamiltonian_mechanics:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>q</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mover accent="true">
        <mi>q</mi>
        <mo>Àô</mo>
       </mover>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>i</mi>
       </msub>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>‚Ñí</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}(q_{i},\dot{q}_{i},t)=\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}}\,.
  </annotation>
 </semantics>
</math>

</li>
<li>The velocities 

<math display="inline" id="Hamiltonian_mechanics:7">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>q</mi>
    <mo>Àô</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-Àô</ci>
     <ci>q</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}_{i}
  </annotation>
 </semantics>
</math>

 are expressed in terms of the momenta 

<math display="inline" id="Hamiltonian_mechanics:8">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

 by inverting the expressions in the previous step.</li>
<li>The Hamiltonian is calculated using the usual definition of 

<math display="inline" id="Hamiltonian_mechanics:9">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñã</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}
  </annotation>
 </semantics>
</math>

 as the <a href="Legendre_transformation" title="wikilink">Legendre transformation</a> of 

<math display="inline" id="Hamiltonian_mechanics:10">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñí</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

:</li>
</ol>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Hamiltonian_mechanics:11">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </msub>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>i</mi>
       </msub>
       <mfrac>
        <mrow>
         <mo>‚àÇ</mo>
         <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
        </mrow>
        <mrow>
         <mo>‚àÇ</mo>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </msub>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>p</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>‚Ñã</ci>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñí</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-Àô</ci>
            <ci>q</ci>
           </apply>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>‚Ñí</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <ci>‚Ñí</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}=\sum_{i}{\dot{q}_{i}}\frac{\partial\mathcal{L}}{\partial{\dot{q}_{%
i}}}-\mathcal{L}=\sum_{i}{\dot{q}_{i}}p_{i}-\mathcal{L}\,.
  </annotation>
 </semantics>
</math>


</dd>
<dd>Then the velocities are substituted for through the above results.
</dd>
</dl>
</dd>
</dl>
<h2 id="deriving-hamiltons-equations">Deriving Hamilton's equations</h2>

<p>Hamilton's equations can be derived by looking at how the <a href="total_differential" title="wikilink">total differential</a> of the <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a> depends on time, generalized positions 

<math display="inline" id="Hamiltonian_mechanics:12">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>q</mi>
    <mi>i</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i}\,
  </annotation>
 </semantics>
</math>

 and generalized velocities 

<math display="inline" id="Hamiltonian_mechanics:13">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>q</mi>
     <mo>Àô</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Àô</ci>
      <ci>q</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}_{i}:
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Hamiltonian_mechanics:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>q</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>q</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mover accent="true">
             <mi>q</mi>
             <mo>Àô</mo>
            </mover>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mpadded width="+1.7pt">
       <mi>t</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>‚Ñí</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñí</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñí</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-Àô</ci>
            <ci>q</ci>
           </apply>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}\mathcal{L}=\sum_{i}\left(\frac{\partial\mathcal{L}}{\partial q_{i}}%
\mathrm{d}q_{i}+\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}}\mathrm{d}{%
\dot{q}_{i}}\right)+\frac{\partial\mathcal{L}}{\partial t}\mathrm{d}t\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Now the generalized momenta were defined as</p>

<p>

<math display="block" id="Hamiltonian_mechanics:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>i</mi>
       </msub>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>‚Ñí</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}=\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>If this is substituted into the total differential of the Lagrangian, one gets</p>

<p>

<math display="block" id="Hamiltonian_mechanics:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>q</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>q</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mpadded width="+1.7pt">
       <mi>t</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>‚Ñí</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñí</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}\mathcal{L}=\sum_{i}\left(\frac{\partial\mathcal{L}}{\partial q_{i}}%
\mathrm{d}q_{i}+p_{i}\mathrm{d}{\dot{q}_{i}}\right)+\frac{\partial\mathcal{L}}%
{\partial t}\mathrm{d}t\,.
  </annotation>
 </semantics>
</math>

</p>

<p>We can rewrite this as</p>

<p>

<math display="block" id="Hamiltonian_mechanics:17">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>q</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>q</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi mathvariant="normal">d</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msub>
            <mi>p</mi>
            <mi>i</mi>
           </msub>
           <msub>
            <mover accent="true">
             <mi>q</mi>
             <mo>Àô</mo>
            </mover>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>q</mi>
          <mo>Àô</mo>
         </mover>
         <mi>i</mi>
        </msub>
        <mi mathvariant="normal">d</mi>
        <msub>
         <mi>p</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mi mathvariant="normal">d</mi>
     <mpadded width="+1.7pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>‚Ñí</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>‚Ñí</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <ci>normal-d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>normal-d</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-Àô</ci>
            <ci>q</ci>
           </apply>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}\mathcal{L}=\sum_{i}\left(\frac{\partial\mathcal{L}}{\partial q_{i}}%
\mathrm{d}q_{i}+\mathrm{d}\left(p_{i}{\dot{q}_{i}}\right)-{\dot{q}_{i}}\mathrm%
{d}p_{i}\right)+\frac{\partial\mathcal{L}}{\partial t}\mathrm{d}t\,
  </annotation>
 </semantics>
</math>

</p>

<p>and rearrange again to get</p>

<p>

<math display="block" id="Hamiltonian_mechanics:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
         <mi>i</mi>
        </munder>
        <mrow>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mo>‚àÇ</mo>
            <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
           </mrow>
           <mrow>
            <mo>‚àÇ</mo>
            <msub>
             <mi>q</mi>
             <mi>i</mi>
            </msub>
           </mrow>
          </mfrac>
          <mi mathvariant="normal">d</mi>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mpadded width="+1.7pt">
       <mi>t</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <ci>‚Ñí</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>‚Ñí</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <ci>normal-d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}\left(\sum_{i}p_{i}{\dot{q}_{i}}-\mathcal{L}\right)=\sum_{i}\left(-%
\frac{\partial\mathcal{L}}{\partial q_{i}}\mathrm{d}q_{i}+{\dot{q}_{i}}\mathrm%
{d}p_{i}\right)-\frac{\partial\mathcal{L}}{\partial t}\mathrm{d}t\,.
  </annotation>
 </semantics>
</math>

</p>

<p>The term on the left-hand side is just the Hamiltonian that we have defined before, so we find that</p>

<p>

<math display="block" id="Hamiltonian_mechanics:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mo>‚àÇ</mo>
            <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
           </mrow>
           <mrow>
            <mo>‚àÇ</mo>
            <msub>
             <mi>q</mi>
             <mi>i</mi>
            </msub>
           </mrow>
          </mfrac>
          <mi mathvariant="normal">d</mi>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>‚Ñã</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>‚Ñí</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <ci>normal-d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}\mathcal{H}=\sum_{i}\left(-\frac{\partial\mathcal{L}}{\partial q_{i}%
}\mathrm{d}q_{i}+{\dot{q}_{i}}\mathrm{d}p_{i}\right)-\frac{\partial\mathcal{L}%
}{\partial t}\mathrm{d}t.
  </annotation>
 </semantics>
</math>

</p>

<p>We can also calculate the total differential of the Hamiltonian 

<math display="inline" id="Hamiltonian_mechanics:20">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñã</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}
  </annotation>
 </semantics>
</math>

 with respect to time directly, as we did with the Lagrangian 

<math display="inline" id="Hamiltonian_mechanics:21">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñí</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

 above, yielding:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>q</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>q</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>p</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>‚Ñã</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñã</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñã</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}\mathcal{H}=\sum_{i}\left(\frac{\partial\mathcal{H}}{\partial q_{i}}%
\mathrm{d}q_{i}+\frac{\partial\mathcal{H}}{\partial p_{i}}\mathrm{d}p_{i}%
\right)+\frac{\partial\mathcal{H}}{\partial t}\mathrm{d}t.
  </annotation>
 </semantics>
</math>

</p>

<p>It follows from the previous two independent equations that their right-hand sides are equal with each other. Thus we obtain the equation</p>

<p>

<math display="block" id="Hamiltonian_mechanics:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mo>‚àÇ</mo>
            <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
           </mrow>
           <mrow>
            <mo>‚àÇ</mo>
            <msub>
             <mi>q</mi>
             <mi>i</mi>
            </msub>
           </mrow>
          </mfrac>
          <mi mathvariant="normal">d</mi>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mover accent="true">
           <mi>q</mi>
           <mo>Àô</mo>
          </mover>
          <mi>i</mi>
         </msub>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>q</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>q</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mo>‚àÇ</mo>
           <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msub>
            <mi>p</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mfrac>
         <mi mathvariant="normal">d</mi>
         <msub>
          <mi>p</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi mathvariant="normal">d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>‚Ñí</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <ci>normal-d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñã</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>‚Ñã</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <ci>normal-d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i}\left(-\frac{\partial\mathcal{L}}{\partial q_{i}}\mathrm{d}q_{i}+{\dot%
{q}_{i}}\mathrm{d}p_{i}\right)-\frac{\partial\mathcal{L}}{\partial t}\mathrm{d%
}t=\sum_{i}\left(\frac{\partial\mathcal{H}}{\partial q_{i}}\mathrm{d}q_{i}+%
\frac{\partial\mathcal{H}}{\partial p_{i}}\mathrm{d}p_{i}\right)+\frac{%
\partial\mathcal{H}}{\partial t}\mathrm{d}t.
  </annotation>
 </semantics>
</math>

</p>

<p>Since this calculation was done <a href="On_shell_and_off_shell" title="wikilink">off-shell</a>, we can associate corresponding terms from both sides of this equation to yield:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mi>q</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mo>‚àÇ</mo>
         <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
        </mrow>
        <mrow>
         <mo>‚àÇ</mo>
         <msub>
          <mi>q</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </mfrac>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <msub>
         <mi>p</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mpadded width="+1.7pt">
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>i</mi>
       </msub>
      </mpadded>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mo>‚àÇ</mo>
          <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
         </mrow>
         <mrow>
          <mo>‚àÇ</mo>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>‚Ñã</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>‚Ñí</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\mathcal{H}}{\partial q_{i}}=-\frac{\partial\mathcal{L}}{%
\partial q_{i}}\,,\quad\frac{\partial\mathcal{H}}{\partial p_{i}}=\dot{q}_{i}%
\,,\quad\frac{\partial\mathcal{H}}{\partial t}=-{\partial\mathcal{L}\over%
\partial t}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>On-shell, <a href="Lagrange's_equations" title="wikilink">Lagrange's equations</a> tell us that</p>

<p>

<math display="block" id="Hamiltonian_mechanics:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi mathvariant="normal">d</mi>
      <mrow>
       <mi mathvariant="normal">d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>i</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <msub>
       <mi>q</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mn>0‚Äâ.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>normal-d</ci>
       <apply>
        <times></times>
        <ci>normal-d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>q</ci>
         </apply>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>‚Ñí</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">0‚Äâ.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial\mathcal{L}}{\partial{\dot{q}_{i}}%
}-\frac{\partial\mathcal{L}}{\partial q_{i}}=0\,.
  </annotation>
 </semantics>
</math>

</p>

<p>We can rearrange this to get</p>

<p>

<math display="block" id="Hamiltonian_mechanics:26">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <msub>
       <mi>q</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mover accent="true">
       <mi>p</mi>
       <mo>Àô</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>‚Ñí</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Àô</ci>
      <ci>p</ci>
     </apply>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\mathcal{L}}{\partial q_{i}}={\dot{p}}_{i}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus Hamilton's equations hold on-shell:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mi>q</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mpadded width="+1.7pt">
       <msub>
        <mover accent="true">
         <mi>p</mi>
         <mo>Àô</mo>
        </mover>
        <mi>j</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <msub>
         <mi>p</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mpadded width="+1.7pt">
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>j</mi>
       </msub>
      </mpadded>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mo>‚àÇ</mo>
          <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
         </mrow>
         <mrow>
          <mo>‚àÇ</mo>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>‚Ñã</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>p</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>‚Ñí</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\mathcal{H}}{\partial q_{j}}=-\dot{p}_{j}\,,\quad\frac{\partial%
\mathcal{H}}{\partial p_{j}}=\dot{q}_{j}\,,\quad\frac{\partial\mathcal{H}}{%
\partial t}=-{\partial\mathcal{L}\over\partial t}\,.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="as-a-reformulation-of-lagrangian-mechanics">As a reformulation of Lagrangian mechanics</h2>

<p>Starting with <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a>, the <a href="equation_of_motion" title="wikilink">equations of motion</a> are based on <a href="generalized_coordinates" title="wikilink">generalized coordinates</a></p>

<p>

<math display="block" id="Hamiltonian_mechanics:28">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mpadded width="+5pt">
    <msub>
     <mi>q</mi>
     <mi>j</mi>
    </msub>
   </mpadded>
   <mo rspace="7.5pt" stretchy="false">|</mo>
   <mrow>
    <mi>j</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">‚Ä¶</mi>
     <mo>,</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">conditional-set</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <eq></eq>
     <ci>j</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-‚Ä¶</ci>
      <ci>N</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{q_{j}\ |\ j=1,\ldots,N\right\}
  </annotation>
 </semantics>
</math>

</p>

<p>and matching generalized velocities</p>

<p>

<math display="block" id="Hamiltonian_mechanics:29">
 <semantics>
  <mrow>
   <mrow>
    <mo>{</mo>
    <mpadded width="+5pt">
     <msub>
      <mover accent="true">
       <mi>q</mi>
       <mo>Àô</mo>
      </mover>
      <mi>j</mi>
     </msub>
    </mpadded>
    <mo rspace="7.5pt" stretchy="false">|</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mi mathvariant="normal">‚Ä¶</mi>
      <mo>,</mo>
      <mi>N</mi>
     </mrow>
    </mrow>
    <mo>}</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">conditional-set</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Àô</ci>
      <ci>q</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <apply>
     <eq></eq>
     <ci>j</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-‚Ä¶</ci>
      <ci>N</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{\dot{q}_{j}\ |\ j=1,\ldots,N\right\}.
  </annotation>
 </semantics>
</math>

</p>

<p>We write the <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a> as</p>

<p>

<math display="block" id="Hamiltonian_mechanics:30">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>q</mi>
     <mi>j</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mover accent="true">
      <mi>q</mi>
      <mo>Àô</mo>
     </mover>
     <mi>j</mi>
    </msub>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>‚Ñí</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-Àô</ci>
       <ci>q</ci>
      </apply>
      <ci>j</ci>
     </apply>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(q_{j},\dot{q}_{j},t)
  </annotation>
 </semantics>
</math>

</p>

<p>with the subscripted variables understood to represent all <em>N</em> variables of that type. Hamiltonian mechanics aims to replace the generalized velocity variables with generalized momentum variables, also known as <em>conjugate momenta</em>. By doing so, it is possible to handle certain systems, such as aspects of quantum mechanics, that would otherwise be even more complicated.</p>

<p>For each generalized velocity, there is one corresponding <a href="conjugate_momentum" title="wikilink">conjugate momentum</a>, defined as:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <msub>
       <mover accent="true">
        <mi>q</mi>
        <mo>Àô</mo>
       </mover>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>‚Ñí</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{j}={\partial\mathcal{L}\over\partial\dot{q}_{j}}.
  </annotation>
 </semantics>
</math>

</p>

<p>In <a href="Cartesian_coordinates" title="wikilink">Cartesian coordinates</a>, the generalized momenta are precisely the physical linear <a href="momentum" title="wikilink">momenta</a>. In <a href="coordinates_(elementary_mathematics)" title="wikilink">circular polar coordinates</a>, the generalized momentum corresponding to the angular velocity is the physical <a href="angular_momentum" title="wikilink">angular momentum</a>. For an arbitrary choice of generalized coordinates, it may not be possible to obtain an intuitive interpretation of the conjugate momenta.</p>

<p>One thing which is not too obvious in this coordinate dependent formulation is that different generalized coordinates are really nothing more than different coordinate patches on the same <a href="symplectic_manifold" title="wikilink">symplectic manifold</a> (see <em><a href="#Mathematical_formalism" title="wikilink">Mathematical formalism</a></em>, below).</p>

<p>The <em>Hamiltonian</em> is the <a href="Legendre_transformation" title="wikilink">Legendre transform</a> of the <a href="Lagrangian_mechanics" title="wikilink">Lagrangian</a>:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:32">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>q</mi>
       <mi>j</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mi>j</mi>
      </msub>
      <mo>,</mo>
      <mi>t</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>q</mi>
          <mo>Àô</mo>
         </mover>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>p</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>q</mi>
        <mi>j</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mover accent="true">
         <mi>q</mi>
         <mo>Àô</mo>
        </mover>
        <mi>j</mi>
       </msub>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>‚Ñã</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>j</ci>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-Àô</ci>
         <ci>q</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>‚Ñí</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-Àô</ci>
         <ci>q</ci>
        </apply>
        <ci>j</ci>
       </apply>
       <ci>t</ci>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}\left(q_{j},p_{j},t\right)=\left(\sum_{i}\dot{q}_{i}p_{i}\right)-%
\mathcal{L}(q_{j},\dot{q}_{j},t).
  </annotation>
 </semantics>
</math>

</p>

<p>If the transformation equations defining the generalized coordinates are independent of <em>t</em>, and the Lagrangian is a sum of products of functions (in the generalized coordinates) which are homogeneous of order 0, 1 or 2, then it can be shown that <em>H</em> is equal to the total energy <em>E</em> = <em>T</em> + <em>V</em>.</p>

<p>Each side in the definition of <em>

<math display="inline" id="Hamiltonian_mechanics:33">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñã</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}
  </annotation>
 </semantics>
</math>

</em> produces a differential:</p>

<p>

<math display="inline" id="Hamiltonian_mechanics:34">
 <semantics>
  <mrow>
   <mi mathvariant="normal">d</mi>
   <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-d</ci>
    <ci>‚Ñã</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathrm{d}\mathcal{H}
  </annotation>
 </semantics>
</math>


</p>

<p>Substituting the previous definition of the conjugate momenta into this equation and matching coefficients, we obtain the equations of motion of Hamiltonian mechanics, known as the canonical equations of Hamilton:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
      </mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mi>q</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>Àô</mo>
       </mover>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <msub>
         <mi>p</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <msub>
       <mover accent="true">
        <mi>q</mi>
        <mo>Àô</mo>
       </mover>
       <mi>j</mi>
      </msub>
     </mrow>
     <mo rspace="22.5pt">,</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <mo>‚àÇ</mo>
         <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
        </mrow>
        <mrow>
         <mo>‚àÇ</mo>
         <mi>t</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>‚Ñã</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>p</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-Àô</ci>
        <ci>q</ci>
       </apply>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>‚Ñí</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\mathcal{H}}{\partial q_{j}}=-\dot{p}_{j},\qquad\frac{\partial%
\mathcal{H}}{\partial p_{j}}=\dot{q}_{j},\qquad\frac{\partial\mathcal{H}}{%
\partial t}=-{\partial\mathcal{L}\over\partial t}.
  </annotation>
 </semantics>
</math>

</p>

<p>Hamilton's equations consist of 2n first-order <a href="differential_equation" title="wikilink">differential equations</a>, while Lagrange's equations consist of n second-order equations. However, Hamilton's equations usually don't reduce the difficulty of finding explicit solutions. They still offer some advantages, since important theoretical results can be derived because coordinates and momenta are independent variables with nearly symmetric roles.</p>

<p>Hamilton's equations have another advantage over Lagrange's equations: if a system has a symmetry, such that a coordinate does not occur in the Hamiltonian, the corresponding momentum is conserved, and that coordinate can be ignored in the other equations of the set. Effectively, this reduces the problem from n coordinates to (n-1) coordinates. In the Lagrangian framework, of course the result that the corresponding momentum is conserved still follows immediately, but all the generalized velocities still occur in the Lagrangian - we still have to solve a system of equations in n coordinates.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The Lagrangian and Hamiltonian approaches provide the groundwork for deeper results in the theory of classical mechanics, and for formulations of quantum mechanics.</p>
<h2 id="geometry-of-hamiltonian-systems">Geometry of Hamiltonian systems</h2>

<p>A Hamiltonian system may be understood as a <a href="fiber_bundle" title="wikilink">fiber bundle</a> <em>E</em> over <a class="uri" href="time" title="wikilink">time</a> <em>R</em>, with the <a href="Level_set" title="wikilink">fibers</a> <em>E</em><sub><em>t</em></sub>, <em>t</em> ‚àà <em>R</em>, being the position space. The Lagrangian is thus a function on the <a href="jet_bundle" title="wikilink">jet bundle</a> <em>J</em> over <em>E</em>; taking the fiberwise <a href="Legendre_transform" title="wikilink">Legendre transform</a> of the Lagrangian produces a function on the dual bundle over time whose fiber at <em>t</em> is the <a href="cotangent_space" title="wikilink">cotangent space</a> <em>T</em><sup>*</sup><em>E</em><sub><em>t</em></sub>, which comes equipped with a natural <a href="symplectic_form" title="wikilink">symplectic form</a>, and this latter function is the Hamiltonian.</p>
<h2 id="generalization-to-quantum-mechanics-through-poisson-bracket">Generalization to quantum mechanics through Poisson bracket</h2>

<p>Hamilton's equations above work well for <a href="classical_mechanics" title="wikilink">classical mechanics</a>, but not for <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>, since the differential equations discussed assume that one can specify the exact position and momentum of the particle simultaneously at any point in time. However, the equations can be further generalized to then be extended to apply to quantum mechanics as well as to classical mechanics, through the deformation of the <a href="Poisson_algebra" title="wikilink">Poisson algebra</a> over <em>p</em> and <em>q</em> to the algebra of <a href="Moyal_bracket" title="wikilink">Moyal brackets</a>.</p>

<p>Specifically, the more general form of the Hamilton's equation reads</p>

<p>

<math display="block" id="Hamiltonian_mechanics:36">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi>f</mi>
    </mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">{</mo>
     <mi>f</mi>
     <mo>,</mo>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     <mo stretchy="false">}</mo>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>f</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <set>
      <ci>f</ci>
      <ci>‚Ñã</ci>
     </set>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>f</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\mathrm{d}f}{\mathrm{d}t}=\{f,\mathcal{H}\}+\frac{\partial f}{\partial t}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>f</em> is some function of <em>p</em> and <em>q</em>, and <em>H</em> is the Hamiltonian. To find out the rules for evaluating a <a href="Poisson_bracket" title="wikilink">Poisson bracket</a> without resorting to differential equations, see <a href="Lie_algebra" title="wikilink">Lie algebra</a>; a Poisson bracket is the name for the Lie bracket in a <a href="Poisson_algebra" title="wikilink">Poisson algebra</a>. These Poisson brackets can then be extended to <a href="Moyal_bracket" title="wikilink">Moyal brackets</a> comporting to an <strong>inequivalent</strong> Lie algebra, as proven by <a href="Hilbrand_J._Groenewold" title="wikilink">H. Groenewold</a>, and thereby describe quantum mechanical diffusion in phase space (See the <a href="phase_space_formulation" title="wikilink">phase space formulation</a> and the <a href="Wigner-Weyl_transform" title="wikilink">Wigner-Weyl transform</a>). This more algebraic approach not only permits ultimately extending <a href="probability_distribution" title="wikilink">probability distributions</a> in <a href="phase_space" title="wikilink">phase space</a> to <a href="Wigner_quasi-probability_distribution" title="wikilink">Wigner quasi-probability distributions</a>, but, at the mere Poisson bracket classical setting, also provides more power in helping analyze the relevant <a href="conserved_quantity" title="wikilink">conserved quantities</a> in a system.</p>
<h2 id="mathematical-formalism">Mathematical formalism</h2>

<p>Any <a href="smooth_function" title="wikilink">smooth</a> real-valued function <em>H</em> on a <a href="symplectic_manifold" title="wikilink">symplectic manifold</a> can be used to define a <a href="Hamiltonian_vector_field" title="wikilink">Hamiltonian system</a>. The function <em>H</em> is known as the <strong>Hamiltonian</strong> or the <strong>energy function</strong>. The symplectic manifold is then called the <a href="phase_space" title="wikilink">phase space</a>. The Hamiltonian induces a special <a href="vector_field" title="wikilink">vector field</a> on the symplectic manifold, known as the <a href="Hamiltonian_vector_field" title="wikilink">Hamiltonian vector field</a>.</p>

<p>The Hamiltonian vector field (a special type of <a href="symplectic_vector_field" title="wikilink">symplectic vector field</a>) induces a <a href="Hamiltonian_flow" title="wikilink">Hamiltonian flow</a> on the manifold. This is a one-parameter family of transformations of the manifold (the parameter of the curves is commonly called the <strong>time</strong>); in other words an <a href="Homotopy#Isotopy" title="wikilink">isotopy</a> of <a href="symplectomorphism" title="wikilink">symplectomorphisms</a>, starting with the identity. By <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a>, each symplectomorphism preserves the <a href="volume_form" title="wikilink">volume form</a> on the <a href="phase_space" title="wikilink">phase space</a>. The collection of symplectomorphisms induced by the Hamiltonian flow is commonly called the <strong>Hamiltonian mechanics</strong> of the Hamiltonian system.</p>

<p>The symplectic structure induces a <a href="Poisson_bracket" title="wikilink">Poisson bracket</a>. The Poisson bracket gives the space of functions on the manifold the structure of a <a href="Lie_algebra" title="wikilink">Lie algebra</a>.</p>

<p>Given a function <em>f</em></p>

<p>

<math display="block" id="Hamiltonian_mechanics:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi mathvariant="normal">d</mi>
      <mrow>
       <mi mathvariant="normal">d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mi>f</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mo>‚àÇ</mo>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mi>f</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo rspace="4.2pt" stretchy="false">{</mo>
      <mi>f</mi>
      <mo>,</mo>
      <mpadded width="+1.7pt">
       <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
      </mpadded>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>normal-d</ci>
      <apply>
       <times></times>
       <ci>normal-d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>f</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>f</ci>
     </apply>
     <set>
      <ci>f</ci>
      <ci>‚Ñã</ci>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\mathrm{d}}{\mathrm{d}t}f=\frac{\partial}{\partial t}f+\{\,f,\mathcal{H}%
\,\}.
  </annotation>
 </semantics>
</math>

</p>

<p>If we have a <a href="probability_distribution" title="wikilink">probability distribution</a>, œÅ, then (since the phase space velocity (

<math display="inline" id="Hamiltonian_mechanics:38">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>Àô</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mover accent="true">
     <mi>q</mi>
     <mo>Àô</mo>
    </mover>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Àô</ci>
      <ci>p</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Àô</ci>
      <ci>q</ci>
     </apply>
     <ci>i</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\dot{p}_{i}},{\dot{q}_{i}}
  </annotation>
 </semantics>
</math>

) has zero divergence, and probability is conserved) its convective derivative can be shown to be zero and so</p>

<p>

<math display="block" id="Hamiltonian_mechanics:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mo>‚àÇ</mo>
      <mrow>
       <mo>‚àÇ</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mi>œÅ</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo rspace="4.2pt" stretchy="false">{</mo>
      <mi>œÅ</mi>
      <mo>,</mo>
      <mpadded width="+1.7pt">
       <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
      </mpadded>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <partialdiff></partialdiff>
      <apply>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>œÅ</ci>
    </apply>
    <apply>
     <minus></minus>
     <set>
      <ci>œÅ</ci>
      <ci>‚Ñã</ci>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial t}\rho=-\{\,\rho,\mathcal{H}\,\}.
  </annotation>
 </semantics>
</math>

</p>

<p>This is called <a href="Liouville's_theorem_(Hamiltonian)" title="wikilink">Liouville's theorem</a>. Every <a href="smooth_function" title="wikilink">smooth function</a> <em>G</em> over the <a href="symplectic_manifold" title="wikilink">symplectic manifold</a> generates a one-parameter family of <a href="symplectomorphism" title="wikilink">symplectomorphisms</a> and if { <em>G</em>, <em>H</em> } = 0, then <em>G</em> is conserved and the symplectomorphisms are <a href="symmetry_transformation" title="wikilink">symmetry transformations</a>.</p>

<p>A Hamiltonian may have multiple conserved quantities <em>G</em><sub><em>i</em></sub>. If the symplectic manifold has dimension 2<em>n</em> and there are <em>n</em> functionally independent conserved quantities <em>G</em><sub><em>i</em></sub> which are in involution (i.e., { <em>G</em><sub><em>i</em></sub>, <em>G</em><sub><em>j</em></sub> } = 0), then the Hamiltonian is <a href="Liouville_integrability" title="wikilink">Liouville integrable</a>. The <a href="Liouville-Arnold_theorem" title="wikilink">Liouville-Arnold theorem</a> says that locally, any Liouville integrable Hamiltonian can be transformed via a symplectomorphism in a new Hamiltonian with the conserved quantities <em>G</em><sub><em>i</em></sub> as coordinates; the new coordinates are called <em>action-angle coordinates</em>. The transformed Hamiltonian depends only on the <em>G</em><sub><em>i</em></sub>, and hence the equations of motion have the simple form</p>

<p>

<math display="block" id="Hamiltonian_mechanics:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>G</mi>
       <mo>Àô</mo>
      </mover>
      <mi>i</mi>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>œÜ</mi>
       <mo>Àô</mo>
      </mover>
      <mi>i</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>F</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>G</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-Àô</ci>
       <ci>G</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-Àô</ci>
       <ci>œÜ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>F</ci>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{G}_{i}=0,\qquad\dot{\varphi}_{i}=F(G),
  </annotation>
 </semantics>
</math>

 for some function <em>F</em> (Arnol'd et al., 1988). There is an entire field focusing on small deviations from integrable systems governed by the <a href="KAM_theorem" title="wikilink">KAM theorem</a>.</p>

<p>The integrability of Hamiltonian vector fields is an open question. In general, Hamiltonian systems are <a href="chaos_theory" title="wikilink">chaotic</a>; concepts of measure, completeness, integrability and stability are poorly defined. At this time, the study of <a href="dynamical_systems" title="wikilink">dynamical systems</a> is primarily qualitative, and not a quantitative science.</p>
<h2 id="riemannian-manifolds">Riemannian manifolds</h2>

<p>An important special case consists of those Hamiltonians that are <a href="quadratic_form" title="wikilink">quadratic forms</a>, that is, Hamiltonians that can be written as</p>

<p>

<math display="block" id="Hamiltonian_mechanics:41">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>q</mi>
     <mo>,</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msub>
     <mrow>
      <mo stretchy="false">‚ü®</mo>
      <mi>p</mi>
      <mo>,</mo>
      <mi>p</mi>
      <mo stretchy="false">‚ü©</mo>
     </mrow>
     <mi>q</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>‚Ñã</ci>
     <interval closure="open">
      <ci>q</ci>
      <ci>p</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <list>
       <ci>p</ci>
       <ci>p</ci>
      </list>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}(q,p)=\frac{1}{2}\langle p,p\rangle_{q}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Hamiltonian_mechanics:42">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">‚ü®</mo>
    <mo>‚ãÖ</mo>
    <mo>,</mo>
    <mo>‚ãÖ</mo>
    <mo stretchy="false">‚ü©</mo>
   </mrow>
   <mi>q</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <list>
     <ci>normal-‚ãÖ</ci>
     <ci>normal-‚ãÖ</ci>
    </list>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\cdot,\cdot\rangle_{q}
  </annotation>
 </semantics>
</math>

 is a smoothly varying <a href="inner_product" title="wikilink">inner product</a> on the <a href="fibre_bundle" title="wikilink">fibers</a> 

<math display="inline" id="Hamiltonian_mechanics:43">
 <semantics>
  <mrow>
   <msubsup>
    <mi>T</mi>
    <mi>q</mi>
    <mo>*</mo>
   </msubsup>
   <mi>Q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>q</ci>
     </apply>
     <times></times>
    </apply>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{q}^{*}Q
  </annotation>
 </semantics>
</math>

, the <a href="cotangent_space" title="wikilink">cotangent space</a> to the point <em>q</em> in the <a href="configuration_space" title="wikilink">configuration space</a>, sometimes called a cometric. This Hamiltonian consists entirely of the <a href="kinetic_term" title="wikilink">kinetic term</a>.</p>

<p>If one considers a <a href="Riemannian_manifold" title="wikilink">Riemannian manifold</a> or a <a href="pseudo-Riemannian_manifold" title="wikilink">pseudo-Riemannian manifold</a>, the Riemannian <a href="metric_(mathematics)" title="wikilink">metric</a> induces a linear isomorphism between the tangent and cotangent bundles. (See <a href="Musical_isomorphism" title="wikilink">Musical isomorphism</a>). Using this isomorphism, one can define a cometric. (In coordinates, the matrix defining the cometric is the inverse of the matrix defining the metric.) The solutions to the <a href="Hamilton‚ÄìJacobi_equation" title="wikilink">Hamilton‚ÄìJacobi equations</a> for this Hamiltonian are then the same as the <a href="geodesic" title="wikilink">geodesics</a> on the manifold. In particular, the <a href="Hamiltonian_flow" title="wikilink">Hamiltonian flow</a> in this case is the same thing as the <a href="geodesic_flow" title="wikilink">geodesic flow</a>. The existence of such solutions, and the completeness of the set of solutions, are discussed in detail in the article on <a href="geodesic" title="wikilink">geodesics</a>. See also <a href="Geodesics_as_Hamiltonian_flows" title="wikilink">Geodesics as Hamiltonian flows</a>.</p>
<h2 id="sub-riemannian-manifolds">Sub-Riemannian manifolds</h2>

<p>When the cometric is degenerate, then it is not invertible. In this case, one does not have a Riemannian manifold, as one does not have a metric. However, the Hamiltonian still exists. In the case where the cometric is degenerate at every point <em>q</em> of the configuration space manifold <em>Q</em>, so that the <a href="Rank_(linear_algebra)" title="wikilink">rank</a> of the cometric is less than the dimension of the manifold <em>Q</em>, one has a <a href="sub-Riemannian_manifold" title="wikilink">sub-Riemannian manifold</a>.</p>

<p>The Hamiltonian in this case is known as a <strong>sub-Riemannian Hamiltonian</strong>. Every such Hamiltonian uniquely determines the cometric, and vice versa. This implies that every <a href="sub-Riemannian_manifold" title="wikilink">sub-Riemannian manifold</a> is uniquely determined by its sub-Riemannian Hamiltonian, and that the converse is true: every sub-Riemannian manifold has a unique sub-Riemannian Hamiltonian. The existence of sub-Riemannian geodesics is given by the <a href="Orbit_(control_theory)" title="wikilink">Chow‚ÄìRashevskii theorem</a>.</p>

<p>The continuous, real-valued <a href="Heisenberg_group" title="wikilink">Heisenberg group</a> provides a simple example of a sub-Riemannian manifold. For the Heisenberg group, the Hamiltonian is given by</p>

<p>

<math display="block" id="Hamiltonian_mechanics:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mi>z</mi>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mi>x</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mi>y</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mi>z</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>p</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>p</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>‚Ñã</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>z</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>z</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}(x,y,z,p_{x},p_{y},p_{z})=\frac{1}{2}\left(p_{x}^{2}+p_{y}^{2}%
\right).
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Hamiltonian_mechanics:45">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>z</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{z}
  </annotation>
 </semantics>
</math>

 is not involved in the Hamiltonian.</p>
<h2 id="poisson-algebras">Poisson algebras</h2>

<p>Hamiltonian systems can be generalized in various ways. Instead of simply looking at the <a href="associative_algebra" title="wikilink">algebra</a> of <a href="smooth_function" title="wikilink">smooth functions</a> over a <a href="symplectic_manifold" title="wikilink">symplectic manifold</a>, Hamiltonian mechanics can be formulated on general <a class="uri" href="commutative" title="wikilink">commutative</a> <a href="unital_algebra" title="wikilink">unital</a> <a href="real_number" title="wikilink">real</a> <a href="Poisson_algebra" title="wikilink">Poisson algebras</a>. A <a href="state_(functional_analysis)" title="wikilink">state</a> is a <a href="continuity_(topology)" title="wikilink">continuous</a> <a href="linear_functional" title="wikilink">linear functional</a> on the Poisson algebra (equipped with some suitable <a href="topological_space" title="wikilink">topology</a>) such that for any element <em>A</em> of the algebra, <em>A</em>¬≤ maps to a nonnegative real number.</p>

<p>A further generalization is given by <a href="Nambu_dynamics" title="wikilink">Nambu dynamics</a>.</p>
<h2 id="charged-particle-in-an-electromagnetic-field">Charged particle in an electromagnetic field</h2>

<p>A good illustration of Hamiltonian mechanics is given by the Hamiltonian of a charged particle in an <a href="electromagnetic_field" title="wikilink">electromagnetic field</a>. In <a href="Cartesian_coordinates" title="wikilink">Cartesian coordinates</a> (i.e. 

<math display="inline" id="Hamiltonian_mechanics:46">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{i}=x_{i}
  </annotation>
 </semantics>
</math>


), the Lagrangian of a non-relativistic classical particle in an electromagnetic field is (in <a href="SI_Units" title="wikilink">SI Units</a>):</p>

<p>

<math display="block" id="Hamiltonian_mechanics:47">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
        <mi>m</mi>
        <msubsup>
         <mover accent="true">
          <mi>x</mi>
          <mo>Àô</mo>
         </mover>
         <mi>i</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <mi>e</mi>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo>Àô</mo>
         </mover>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>A</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>e</mi>
      <mi>œï</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>‚Ñí</ci>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>m</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-Àô</ci>
           <ci>x</ci>
          </apply>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>e</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-Àô</ci>
          <ci>x</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>œï</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=\sum_{i}\tfrac{1}{2}m\dot{x}_{i}^{2}+\sum_{i}e\dot{x}_{i}A_{i}-e\phi,
  </annotation>
 </semantics>
</math>

</p>

<p>where e is the <a href="electric_charge" title="wikilink">electric charge</a> of the particle (not necessarily the <a href="elementary_charge" title="wikilink">elementary charge</a>), 

<math display="inline" id="Hamiltonian_mechanics:48">
 <semantics>
  <mi>œï</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>œï</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi
  </annotation>
 </semantics>
</math>

 is the <a href="electric_potential" title="wikilink">electric scalar potential</a>, and the 

<math display="inline" id="Hamiltonian_mechanics:49">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 are the components of the <a href="magnetic_vector_potential" title="wikilink">magnetic vector potential</a> (these may be modified through a <a href="gauge_fixing" title="wikilink">gauge transformation</a>). This is called <a href="minimal_coupling" title="wikilink">minimal coupling</a>.</p>

<p>The generalized momenta are given by:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:50">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>Àô</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>m</mi>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo>Àô</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>e</mi>
      <msub>
       <mi>A</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>‚Ñí</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-Àô</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-Àô</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}=\frac{\partial\mathcal{L}}{\partial\dot{x}_{i}}=m\dot{x}_{i}+eA_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>Rearranging, the velocities are expressed in terms of the momenta:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:51">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo>Àô</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <mi>e</mi>
       <msub>
        <mi>A</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
     <mi>m</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-Àô</ci>
      <ci>x</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{x}_{i}=\frac{p_{i}-eA_{i}}{m}.
  </annotation>
 </semantics>
</math>

</p>

<p>If we substitute the definition of the momenta, and the definitions of the velocities in terms of the momenta, into the definition of the Hamiltonian given above, and then simplify and rearrange, we get:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:52">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>{</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo>Àô</mo>
         </mover>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>p</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>}</mo>
     </mrow>
     <mo>-</mo>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>p</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mrow>
           <mi>e</mi>
           <msub>
            <mi>A</mi>
            <mi>i</mi>
           </msub>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>e</mi>
      <mi>œï</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>‚Ñã</ci>
     <apply>
      <minus></minus>
      <set>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>i</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-Àô</ci>
           <ci>x</ci>
          </apply>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </set>
      <ci>‚Ñí</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <times></times>
           <ci>e</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>A</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>œï</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}=\left\{\sum_{i}\dot{x}_{i}p_{i}\right\}-\mathcal{L}=\sum_{i}\frac{%
(p_{i}-eA_{i})^{2}}{2m}+e\phi.
  </annotation>
 </semantics>
</math>

</p>

<p>This equation is used frequently in <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>.</p>
<h2 id="relativistic-charged-particle-in-an-electromagnetic-field">Relativistic charged particle in an electromagnetic field</h2>

<p>The <a href="Lagrangian_mechanics#Special_relativistic_test_particle_with_electromagnetism" title="wikilink">Lagrangian</a> for a relativistic charged particle is given by:</p>

<p>

<math display="block" id="Hamiltonian_mechanics:53">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>m</mi>
        <msup>
         <mi>c</mi>
         <mn>2</mn>
        </msup>
        <msqrt>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
           <mrow>
            <mover accent="true">
             <mover accent="true">
              <mi>x</mi>
              <mo stretchy="false">‚Üí</mo>
             </mover>
             <mo>Àô</mo>
            </mover>
            <msup>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>t</mi>
              <mo stretchy="false">)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mrow>
           <msup>
            <mi>c</mi>
            <mn>2</mn>
           </msup>
          </mfrac>
         </mrow>
        </msqrt>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>e</mi>
       <mi>œï</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">‚Üí</mo>
         </mover>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mrow>
        <mi>e</mi>
        <mover accent="true">
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">‚Üí</mo>
         </mover>
         <mo>Àô</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>‚ãÖ</mo>
       <mover accent="true">
        <mi>A</mi>
        <mo stretchy="false">‚Üí</mo>
       </mover>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>‚Ñí</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>m</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <root></root>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <apply>
             <ci>normal-Àô</ci>
             <apply>
              <ci>normal-‚Üí</ci>
              <ci>x</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>t</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>c</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>œï</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>e</ci>
        <apply>
         <ci>normal-Àô</ci>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <ci>normal-‚Üí</ci>
        <ci>A</ci>
       </apply>
      </apply>
      <interval closure="open">
       <apply>
        <times></times>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>x</ci>
        </apply>
        <ci>t</ci>
       </apply>
       <ci>t</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(t)=-mc^{2}\sqrt{1-\frac{{\dot{\vec{x}}(t)}^{2}}{c^{2}}}-e\phi(\vec%
{x}(t),t)+e\dot{\vec{x}}(t)\cdot\vec{A}(\vec{x}(t),t)\,.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus the particle's canonical (total) momentum is</p>

<p>

<math display="block" id="Hamiltonian_mechanics:54">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
     </mpadded>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <mover accent="true">
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mo>Àô</mo>
       </mover>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>m</mi>
       <mover accent="true">
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mo>Àô</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <msqrt>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mover accent="true">
           <mover accent="true">
            <mi>x</mi>
            <mo stretchy="false">‚Üí</mo>
           </mover>
           <mo>Àô</mo>
          </mover>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mrow>
         <msup>
          <mi>c</mi>
          <mn>2</mn>
         </msup>
        </mfrac>
       </mrow>
      </msqrt>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mi>e</mi>
      <mover accent="true">
       <mi>A</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <ci>normal-‚Üí</ci>
       <ci>P</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñí</ci>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <ci>normal-Àô</ci>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>m</ci>
        <apply>
         <ci>normal-Àô</ci>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <root></root>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <ci>normal-Àô</ci>
            <apply>
             <ci>normal-‚Üí</ci>
             <ci>x</ci>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>t</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>c</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <apply>
        <ci>normal-‚Üí</ci>
        <ci>A</ci>
       </apply>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{P}\,(t)=\frac{\partial\mathcal{L}(t)}{\partial\dot{\vec{x}}(t)}=\frac{m%
\dot{\vec{x}}(t)}{\sqrt{1-\frac{{\dot{\vec{x}}(t)}^{2}}{c^{2}}}}+e\vec{A}(\vec%
{x}(t),t)\,,
  </annotation>
 </semantics>
</math>

 that is, the sum of the kinetic momentum and the potential momentum.</p>

<p>Solving for the velocity, we get</p>

<p>

<math display="block" id="Hamiltonian_mechanics:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
      <mo>Àô</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <mover accent="true">
          <mi>P</mi>
          <mo stretchy="false">‚Üí</mo>
         </mover>
        </mpadded>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>e</mi>
        <mover accent="true">
         <mi>A</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">‚Üí</mo>
          </mover>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>t</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>,</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <msqrt>
       <mrow>
        <msup>
         <mi>m</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <msup>
           <mi>c</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
         <msup>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mrow>
             <mpadded width="+1.7pt">
              <mover accent="true">
               <mi>P</mi>
               <mo stretchy="false">‚Üí</mo>
              </mover>
             </mpadded>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>t</mi>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
             <mi>e</mi>
             <mover accent="true">
              <mi>A</mi>
              <mo stretchy="false">‚Üí</mo>
             </mover>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mover accent="true">
                <mi>x</mi>
                <mo stretchy="false">‚Üí</mo>
               </mover>
               <mrow>
                <mo stretchy="false">(</mo>
                <mi>t</mi>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
              <mo>,</mo>
              <mi>t</mi>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
           <mo>)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
      </msqrt>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-Àô</ci>
      <apply>
       <ci>normal-‚Üí</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-‚Üí</ci>
        <ci>P</ci>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <apply>
        <ci>normal-‚Üí</ci>
        <ci>A</ci>
       </apply>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>c</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <ci>normal-‚Üí</ci>
            <ci>P</ci>
           </apply>
           <ci>t</ci>
          </apply>
          <apply>
           <times></times>
           <ci>e</ci>
           <apply>
            <ci>normal-‚Üí</ci>
            <ci>A</ci>
           </apply>
           <interval closure="open">
            <apply>
             <times></times>
             <apply>
              <ci>normal-‚Üí</ci>
              <ci>x</ci>
             </apply>
             <ci>t</ci>
            </apply>
            <ci>t</ci>
           </interval>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\vec{x}}(t)=\frac{\vec{P}\,(t)-e\vec{A}(\vec{x}(t),t)}{\sqrt{m^{2}+\frac{%
1}{c^{2}}{\left(\vec{P}\,(t)-e\vec{A}(\vec{x}(t),t)\right)}^{2}}}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>So the Hamiltonian is</p>

<p>

<math display="block" id="Hamiltonian_mechanics:56">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mover accent="true">
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">‚Üí</mo>
         </mover>
         <mo>Àô</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>‚ãÖ</mo>
       <mpadded width="+1.7pt">
        <mover accent="true">
         <mi>P</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
       </mpadded>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>c</mi>
      <msqrt>
       <mrow>
        <mrow>
         <msup>
          <mi>m</mi>
          <mn>2</mn>
         </msup>
         <msup>
          <mi>c</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>+</mo>
        <msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mrow>
            <mpadded width="+1.7pt">
             <mover accent="true">
              <mi>P</mi>
              <mo stretchy="false">‚Üí</mo>
             </mover>
            </mpadded>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>t</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mrow>
            <mi>e</mi>
            <mover accent="true">
             <mi>A</mi>
             <mo stretchy="false">‚Üí</mo>
            </mover>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mover accent="true">
               <mi>x</mi>
               <mo stretchy="false">‚Üí</mo>
              </mover>
              <mrow>
               <mo stretchy="false">(</mo>
               <mi>t</mi>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
             <mo>,</mo>
             <mi>t</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </msqrt>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>e</mi>
      <mi>œï</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi>t</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>‚Ñã</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <apply>
         <times></times>
         <apply>
          <ci>normal-Àô</ci>
          <apply>
           <ci>normal-‚Üí</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>P</ci>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <ci>‚Ñí</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>m</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>c</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <apply>
             <ci>normal-‚Üí</ci>
             <ci>P</ci>
            </apply>
            <ci>t</ci>
           </apply>
           <apply>
            <times></times>
            <ci>e</ci>
            <apply>
             <ci>normal-‚Üí</ci>
             <ci>A</ci>
            </apply>
            <interval closure="open">
             <apply>
              <times></times>
              <apply>
               <ci>normal-‚Üí</ci>
               <ci>x</ci>
              </apply>
              <ci>t</ci>
             </apply>
             <ci>t</ci>
            </interval>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>œï</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}(t)=\dot{\vec{x}}(t)\cdot\vec{P}\,(t)-\mathcal{L}(t)=c\sqrt{m^{2}c^%
{2}+{\left(\vec{P}\,(t)-e\vec{A}(\vec{x}(t),t)\right)}^{2}}+e\phi(\vec{x}(t),t%
)\,.
  </annotation>
 </semantics>
</math>

</p>

<p>From this we get the force equation (equivalent to the <a href="Euler‚ÄìLagrange_equation" title="wikilink">Euler‚ÄìLagrange equation</a>)</p>

<p>

<math display="block" id="Hamiltonian_mechanics:57">
 <semantics>
  <mrow>
   <mover accent="true">
    <mover accent="true">
     <mi>P</mi>
     <mo stretchy="false">‚Üí</mo>
    </mover>
    <mo>Àô</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>e</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mo>‚àá</mo>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mover accent="true">
         <mi>A</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>‚ãÖ</mo>
     <mover accent="true">
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
      <mo>Àô</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>e</mi>
     <mover accent="true">
      <mo>‚àá</mo>
      <mo stretchy="false">‚Üí</mo>
     </mover>
     <mpadded width="+1.7pt">
      <mi>œï</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-Àô</ci>
      <apply>
       <ci>normal-‚Üí</ci>
       <ci>P</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>‚Ñã</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <apply>
        <times></times>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>normal-‚àá</ci>
         </apply>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>A</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-Àô</ci>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <apply>
        <ci>normal-‚Üí</ci>
        <ci>normal-‚àá</ci>
       </apply>
       <ci>œï</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\vec{P}}=-\frac{\partial\mathcal{H}}{\partial\vec{x}}=e(\vec{\nabla}\vec{%
A})\cdot\dot{\vec{x}}-e\vec{\nabla}\phi\,
  </annotation>
 </semantics>
</math>

</p>

<p>from which one can derive</p>

<p>

<math display="block" id="Hamiltonian_mechanics:58">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mi>m</mi>
        <mover accent="true">
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">‚Üí</mo>
         </mover>
         <mo>Àô</mo>
        </mover>
       </mrow>
       <msqrt>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mfrac>
          <msup>
           <mover accent="true">
            <mover accent="true">
             <mi>x</mi>
             <mo stretchy="false">‚Üí</mo>
            </mover>
            <mo>Àô</mo>
           </mover>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>c</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mrow>
       </msqrt>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>e</mi>
      <mover accent="true">
       <mi>E</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mi>e</mi>
       <mover accent="true">
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mo>Àô</mo>
       </mover>
      </mrow>
      <mo>√ó</mo>
      <mpadded width="+1.7pt">
       <mover accent="true">
        <mi>B</mi>
        <mo stretchy="false">‚Üí</mo>
       </mover>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>d</ci>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <ci>normal-Àô</ci>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-Àô</ci>
           <apply>
            <ci>normal-‚Üí</ci>
            <ci>x</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>c</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>e</ci>
      <apply>
       <ci>normal-‚Üí</ci>
       <ci>E</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <ci>e</ci>
       <apply>
        <ci>normal-Àô</ci>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-‚Üí</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d}{dt}\left(\frac{m\dot{\vec{x}}}{\sqrt{1-\frac{\dot{\vec{x}}^{2}}{c^{2}%
}}}\right)=e\vec{E}+e\dot{\vec{x}}\times\vec{B}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>An equivalent expression for the Hamiltonian as function of the relativistic (kinetic) momentum, 

<math display="inline" id="Hamiltonian_mechanics:59">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>p</mi>
     <mo stretchy="false">‚Üí</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mi>Œ≥</mi>
     <mi>m</mi>
     <mover accent="true">
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">‚Üí</mo>
      </mover>
      <mo>Àô</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚Üí</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <times></times>
     <ci>Œ≥</ci>
     <ci>m</ci>
     <apply>
      <ci>normal-Àô</ci>
      <apply>
       <ci>normal-‚Üí</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{p}=\gamma m\dot{\vec{x}}(t)\,,
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Hamiltonian_mechanics:60">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñã</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mover accent="true">
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">‚Üí</mo>
         </mover>
         <mo>Àô</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>‚ãÖ</mo>
       <mpadded width="+1.7pt">
        <mover accent="true">
         <mi>p</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
       </mpadded>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <mi>m</mi>
       <msup>
        <mi>c</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mi>Œ≥</mi>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mi>e</mi>
      <mi>œï</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>Œ≥</mi>
      <mi>m</mi>
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>e</mi>
      <mi>œï</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">‚Üí</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>E</mi>
     <mo>+</mo>
     <mpadded width="+1.7pt">
      <mi>V</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>‚Ñã</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <apply>
         <times></times>
         <apply>
          <ci>normal-Àô</ci>
          <apply>
           <ci>normal-‚Üí</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <ci>normal-‚Üí</ci>
         <ci>p</ci>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>m</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>Œ≥</ci>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>œï</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>Œ≥</ci>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>œï</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <apply>
          <ci>normal-‚Üí</ci>
          <ci>x</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>E</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}(t)=\dot{\vec{x}}(t)\cdot\vec{p}\,(t)+\frac{mc^{2}}{\gamma}+e\phi(%
\vec{x}(t),t)=\gamma mc^{2}+e\phi(\vec{x}(t),t)=E+V\,.
  </annotation>
 </semantics>
</math>

</p>

<p>This has the advantage that 

<math display="inline" id="Hamiltonian_mechanics:61">
 <semantics>
  <mover accent="true">
   <mi>p</mi>
   <mo stretchy="false">‚Üí</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{p}
  </annotation>
 </semantics>
</math>


 can be measured experimentally whereas 

<math display="inline" id="Hamiltonian_mechanics:62">
 <semantics>
  <mover accent="true">
   <mi>P</mi>
   <mo stretchy="false">‚Üí</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{P}
  </annotation>
 </semantics>
</math>

 cannot. Notice that the Hamiltonian (<a href="total_energy" title="wikilink">total energy</a>) can be viewed as the sum of the <a href="kinetic_energy#Relativistic_kinetic_energy_of_rigid_bodies" title="wikilink">relativistic energy (kinetic+rest)</a>, 

<math display="inline" id="Hamiltonian_mechanics:63">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mo>=</mo>
    <mrow>
     <mi>Œ≥</mi>
     <mi>m</mi>
     <mpadded width="+1.7pt">
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <times></times>
     <ci>Œ≥</ci>
     <ci>m</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=\gamma mc^{2}\,,
  </annotation>
 </semantics>
</math>

 plus the <a href="potential_energy" title="wikilink">potential energy</a>, 

<math display="inline" id="Hamiltonian_mechanics:64">
 <semantics>
  <mrow>
   <mrow>
    <mi>V</mi>
    <mo>=</mo>
    <mrow>
     <mi>e</mi>
     <mpadded width="+1.7pt">
      <mi>œï</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>V</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>œï</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V=e\phi\,.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Canonical_transformation" title="wikilink">Canonical transformation</a></li>
<li><a href="Classical_field_theory" title="wikilink">Classical field theory</a></li>
<li><a href="Hamiltonian_field_theory" title="wikilink">Hamiltonian field theory</a></li>
<li><a href="Covariant_Hamiltonian_field_theory" title="wikilink">Covariant Hamiltonian field theory</a></li>
<li><a href="Classical_mechanics" title="wikilink">Classical mechanics</a></li>
<li><a href="Dynamical_systems_theory" title="wikilink">Dynamical systems theory</a></li>
<li><a href="Hamilton‚ÄìJacobi_equation" title="wikilink">Hamilton‚ÄìJacobi equation</a></li>
<li><a href="Hamilton‚ÄìJacobi‚ÄìEinstein_equation" title="wikilink">Hamilton‚ÄìJacobi‚ÄìEinstein equation</a></li>
<li><a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a></li>
<li><a href="Maxwell's_equations" title="wikilink">Maxwell's equations</a></li>
<li><a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian (quantum mechanics)</a></li>
<li><a href="Method_of_quantum_characteristics" title="wikilink">Quantum Hamilton's equations</a></li>
<li><a href="Quantum_field_theory" title="wikilink">Quantum field theory</a></li>
<li><a href="Hamiltonian_optics" title="wikilink">Hamiltonian optics</a></li>
<li><a href="De_Donder‚ÄìWeyl_theory" title="wikilink">De Donder‚ÄìWeyl theory</a></li>
<li><a href="Geometric_mechanics" title="wikilink">Geometric mechanics</a></li>
<li><a href="Routhian_mechanics" title="wikilink">Routhian mechanics</a></li>
</ul>
<h2 id="references">References</h2>
<h3 id="footnotes">Footnotes</h3>
<h3 id="sources">Sources</h3>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a> <a href="Category:Classical_mechanics" title="wikilink">Category:Classical mechanics</a> <a href="Category:Hamiltonian_mechanics" title="wikilink"> </a> <a href="Category:Dynamical_systems" title="wikilink">Category:Dynamical systems</a> <a href="Category:Symplectic_geometry" title="wikilink">Category:Symplectic geometry</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Analytical Mechanics, L.N. Hand, J.D. Finch, Cambridge University Press, 2008, ISBN 978-0-521-57572-0<a href="#fnref1">‚Ü©</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4">This derivation is along the lines as given in <a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

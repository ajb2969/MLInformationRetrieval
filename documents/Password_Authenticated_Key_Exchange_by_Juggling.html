<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1830">Password Authenticated Key Exchange by Juggling</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Password Authenticated Key Exchange by Juggling</h1>
<hr/>

<p>The <strong>Password Authenticated Key Exchange by Juggling</strong> (or J-PAKE) is a <a href="password-authenticated_key_agreement" title="wikilink">password-authenticated key agreement</a> protocol.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> This protocol allows two parties to establish private and authenticated communication solely based on their shared (low-entropy) password without requiring a <a href="Public_Key_Infrastructure" title="wikilink">Public Key Infrastructure</a>. It provides <a href="mutual_authentication" title="wikilink">mutual authentication</a> to the key exchange, a feature that is lacking in the <a href="Diffie-Hellman_key_exchange" title="wikilink">Diffie-Hellman key exchange</a> protocol.</p>
<h2 id="description">Description</h2>

<p>Two parties, Alice and Bob, agree on a group 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:0">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 with generator 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:1">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 of prime order 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:2">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 in which the discrete log problem is hard. Typically a <a href="Schnorr_group" title="wikilink">Schnorr group</a> is used. In general, J-PAKE can use any prime order group that is suitable for public key cryptography, including <a href="Elliptic_curve_cryptography" title="wikilink">Elliptic curve cryptography</a>. Let 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:3">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 be their shared (low-entropy) secret, which can be a password or a hash of a password (

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:4">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>≠</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>s</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\neq 0
  </annotation>
 </semantics>
</math>

). The protocol executes in two rounds.</p>
<dl>
<dt>Round 1: Alice selects 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:5">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <msub>
    <mo>∈</mo>
    <mi>R</mi>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <in></in>
     <ci>R</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}\in_{R}[0,q-1]
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:6">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <msub>
    <mo>∈</mo>
    <mi>R</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <in></in>
     <ci>R</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <interval closure="open-closed">
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}\in_{R}(0,q-1]
  </annotation>
 </semantics>
</math>

 and sends out 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:7">
 <semantics>
  <msup>
   <mi>g</mi>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{1}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:8">
 <semantics>
  <msup>
   <mi>g</mi>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{2}}
  </annotation>
 </semantics>
</math>

 together with the <a href="Zero-knowledge_proofs" title="wikilink">Zero-knowledge proofs</a> (using for example <a href="Schnorr_signature" title="wikilink">Schnorr signature</a>) for the proof of the exponents 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:9">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:10">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

. Similarly, Bob selects 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:11">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>3</mn>
   </msub>
   <msub>
    <mo>∈</mo>
    <mi>R</mi>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <in></in>
     <ci>R</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}\in_{R}[0,q-1]
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:12">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>4</mn>
   </msub>
   <msub>
    <mo>∈</mo>
    <mi>R</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <in></in>
     <ci>R</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">4</cn>
    </apply>
    <interval closure="open-closed">
     <cn type="integer">0</cn>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{4}\in_{R}(0,q-1]
  </annotation>
 </semantics>
</math>

 and sends out 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:13">
 <semantics>
  <msup>
   <mi>g</mi>
   <msub>
    <mi>x</mi>
    <mn>3</mn>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{3}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:14">
 <semantics>
  <msup>
   <mi>g</mi>
   <msub>
    <mi>x</mi>
    <mn>4</mn>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{4}}
  </annotation>
 </semantics>
</math>

 together with the <a href="Zero-knowledge_proofs" title="wikilink">Zero-knowledge proofs</a> for the proof of the exponents 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:15">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{3}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:16">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{4}
  </annotation>
 </semantics>
</math>

. The above communication can be completed in one round as neither party depends on the other. When it finishes, Alice and Bob verify the received <a href="Zero-knowledge_proofs" title="wikilink">Zero-knowledge proofs</a> and also check 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:17">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>g</mi>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>g</mi>
     <msub>
      <mi>x</mi>
      <mn>4</mn>
     </msub>
    </msup>
   </mrow>
   <mo>≠</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <list>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </list>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{2}},g^{x_{4}}\neq 1
  </annotation>
 </semantics>
</math>

.</dt>
</dl>
<dl>
<dt>Round 2: Alice sends out 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:18">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>4</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=g^{(x_{1}+x_{3}+x_{4})x_{2}s}
  </annotation>
 </semantics>
</math>

 and a <a href="Zero-knowledge_proof" title="wikilink">Zero-knowledge proof</a> for the proof of the exponent 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:19">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}s
  </annotation>
 </semantics>
</math>

. (Note Alice actually derives a new public key using 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:20">
 <semantics>
  <msup>
   <mi>g</mi>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>x</mi>
     <mn>3</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>x</mi>
     <mn>4</mn>
    </msub>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{1}+x_{3}+x_{4}}
  </annotation>
 </semantics>
</math>

 as the generator). Similarly, Bob sends out 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:21">
 <semantics>
  <mrow>
   <mi>B</mi>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>4</mn>
     </msub>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>B</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=g^{(x_{1}+x_{2}+x_{3})x_{4}s}
  </annotation>
 </semantics>
</math>

 and a <a href="Zero-knowledge_proof" title="wikilink">Zero-knowledge proof</a> for the proof of the exponent 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:22">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>4</mn>
   </msub>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">4</cn>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{4}s
  </annotation>
 </semantics>
</math>

.</dt>
</dl>

<p>After Round 2, Alice computes 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:23">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mo>/</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>4</mn>
        </msub>
        <mi>s</mi>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>4</mn>
     </msub>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>K</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>B</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">4</cn>
         </apply>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=(B/g^{x_{2}x_{4}s})^{x_{2}}=g^{(x_{1}+x_{3})x_{2}x_{4}s}
  </annotation>
 </semantics>
</math>

. Similarly, Bob computes 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:24">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mo>/</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>x</mi>
         <mn>4</mn>
        </msub>
        <mi>s</mi>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>x</mi>
     <mn>4</mn>
    </msub>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mn>4</mn>
     </msub>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>K</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">4</cn>
         </apply>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=(A/g^{x_{2}x_{4}s})^{x_{4}}=g^{(x_{1}+x_{3})x_{2}x_{4}s}
  </annotation>
 </semantics>
</math>

. With the same keying material 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:25">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

, Alice and Bob can derive a session key using a <a href="Cryptographic_hash_function" title="wikilink">Cryptographic hash function</a>

<math display="block" id="Password_Authenticated_Key_Exchange_by_Juggling:26">
 <semantics>
  <mrow>
   <mi>κ</mi>
   <mo>=</mo>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>K</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>κ</ci>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=H(K)
  </annotation>
 </semantics>
</math>

.</p>

<p>The two-round J-PAKE protocol is completely symmetric. This helps significantly simplify the security analysis. For example, the proof that one party does not leak any password information in the data exchange must hold true for the other party based on the symmetry. This reduces the number of the needed security proofs by half.</p>

<p>In practice, it is more likely to implement J-PAKE in three flows since one party shall normally take the initiative. This can be done trivially without loss of security. Suppose Alice initiates the communication by sending to Bob

<math display="block" id="Password_Authenticated_Key_Exchange_by_Juggling:27">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>g</mi>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{1}},g^{x_{2}}
  </annotation>
 </semantics>
</math>

 and Zero-knowledge proofs. Then Bob replies with

<math display="block" id="Password_Authenticated_Key_Exchange_by_Juggling:28">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>g</mi>
     <msub>
      <mi>x</mi>
      <mn>3</mn>
     </msub>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>g</mi>
     <msub>
      <mi>x</mi>
      <mn>4</mn>
     </msub>
    </msup>
    <mo>,</mo>
    <mi>B</mi>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>4</mn>
     </msub>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <ci>B</ci>
    </list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{x_{3}},g^{x_{4}},B=g^{(x_{1}+x_{2}+x_{3})x_{4}s}
  </annotation>
 </semantics>
</math>

 and Zero-knowledge proofs. Finally, Alice sends to Bob

<math display="block" id="Password_Authenticated_Key_Exchange_by_Juggling:29">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>3</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>4</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=g^{(x_{1}+x_{3}+x_{4})x_{2}s}
  </annotation>
 </semantics>
</math>

 and a Zero-knowledge proof. Both parties can now derive the same session key.</p>

<p>Depending on the application requirement, Alice and Bob may perform an optional key confirmation step. There are several ways to do it. A simple method described in <a href="SPEKE_(cryptography)" title="wikilink">SPEKE</a> works as follows: Alice sends to Bob 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:30">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>κ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <apply>
     <times></times>
     <ci>H</ci>
     <ci>κ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(H(\kappa))
  </annotation>
 </semantics>
</math>

, and then Bob replies with 

<math display="inline" id="Password_Authenticated_Key_Exchange_by_Juggling:31">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>κ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>κ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(\kappa)
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Alternatively, Alice and Bob can realize explicit key confirmation by using the newly constructed session key to encrypt a known value (or a random challenge). <a href="Encrypted_key_exchange" title="wikilink">EKE</a>, <a href="Kerberos_(protocol)" title="wikilink">Kerberos</a> and <a class="uri" href="Needham-Schroeder" title="wikilink">Needham-Schroeder</a> all attempt to provide explicit key confirmation by exactly this method.</p>
<h2 id="security-properties">Security properties</h2>

<p>The J-PAKE protocol claims to provide the following properties:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<ol>
<li>Off-line dictionary attack resistance - It does not leak any password verification information to a passive/active attacker.</li>
<li><a href="Forward_secrecy" title="wikilink">Forward secrecy</a> - It produces session keys that remain secure even when the password is later disclosed.</li>
<li>Known-key security - It prevents a disclosed session key from affecting the security of other sessions.</li>
<li>On-line dictionary attack resistance - It limits an active attacker to test only one password per protocol execution.</li>
</ol>

<p>Since 2015, J-PAKE has a formal security proof.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="the-protocol-design">The protocol design</h2>

<p>The J-PAKE protocol is designed by combining random public keys in such a structured way to achieve a vanishing effect if both parties supplied exactly the same passwords. This is somehow similar to the <a href="Anonymous_veto_network" title="wikilink">Anonymous veto network</a> protocol design. The essence of the idea, however, can be traced back to <a href="David_Chaum" title="wikilink">David Chaum</a>'s original <a href="dining_cryptographers_problem" title="wikilink">Dining Cryptographers</a> network protocol,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> where binary bits are combined in a structured way to achieve a vanishing effect.</p>
<h2 id="the-implementation">The implementation</h2>

<p>J-PAKE has been implemented in <a class="uri" href="OpenSSL" title="wikilink">OpenSSL</a> and <a class="uri" href="OpenSSH" title="wikilink">OpenSSH</a> as an experimental authentication protocol. It was removed from the OpenSSH source code at the end of January 2014.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> It has also been implemented in <a href="Network_Security_Services" title="wikilink">NSS</a> and is used by <a href="Firefox_Sync" title="wikilink">Firefox Sync</a>. Since February 2013, J-PAKE has been added to the lightweight API in <a class="uri" href="Bouncycastle" title="wikilink">Bouncycastle</a> (1.48 and onwards).</p>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://tools.ietf.org/html/draft-hao-jpake-01">J-PAKE draft</a></li>
<li><a href="http://www.links.org/?p=393">A prototype demo of J-PAKE in C</a></li>
<li><a href="http://haofeng66.googlepages.com/JPAKEDemo.java">A prototype demo of J-PAKE in Java</a></li>
<li><a href="http://homepages.cs.ncl.ac.uk/feng.hao/files/EllipticCurveJPAKEDemo.java">An example of implementing J-PAKE using Elliptic Curve</a></li>
<li><a href="http://www.lightbluetouchpaper.org/2008/05/29/j-pake">J-PAKE: From Dining Cryptographers to Jugglers</a></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Cryptography" title="wikilink">Category:Cryptography</a> <a href="Category:Cryptographic_protocols" title="wikilink">Category:Cryptographic protocols</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">F. Hao, P. Ryan. <a href="http://grouper.ieee.org/groups/1363/Research/contributions/hao-ryan-2008.pdf">Password Authenticated Key Exchange by Juggling</a>. ''Proceedings of the 16th International Workshop on Security Protocols, 2008.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3">F. Hao, P. Ryan. <a href="http://eprint.iacr.org/2010/190.pdf">J-PAKE: Authenticated Key Exchange Without PKI</a>. ''Springer Transactions on Computational Science XI, Special Issue on Security in Computing, Part II, Vol. 6480, pp. 192-206, 2010.<a href="#fnref3">↩</a></li>
<li id="fn4">M. Abdalla, F. Benhamouda, P. MacKenzie <a href="http://www.normalesup.org/~fbenhamo/files/publications/SP_AbdBenMac15.pdf">Security of the J-PAKE Password-Authenticated Key Exchange Protocol</a>.<a href="#fnref4">↩</a></li>
<li id="fn5">David Chaum. <a href="http://dx.doi.org/10.1007/BF00206326">The Dining Cryptographers Problem: Unconditional Sender and Recipient Untraceability</a> Journal of Cryptology, vol. 1, No, 1, pp. 65-75, 1988<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/Attic/jpake.c">OpenBSD CVS log for src/usr.bin/ssh/Attic/jpake.c</a><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

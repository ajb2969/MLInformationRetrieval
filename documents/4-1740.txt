   Continuous-time Markov chain      Continuous-time Markov chain   In probability theory , a continuous-time Markov chain ( CTMC 1 or continuous-time Markov process 2 ) is a mathematical model which takes values in some finite or countable set and for which the time spent in each state takes non-negative real values and has an exponential distribution . It is a continuous-time stochastic process with the Markov property which means that future behaviour of the model (both remaining time in current state and next state) depends only on the current state of the model and not on historical behaviour. The model is a continuous-time version of the Markov chain model, named because the output from such a process is a sequence (or chain) of states.  Definitions  A continuous-time Markov chain ( X t ) t ≥ 0 is defined by a finite or countable state space S , a transition rate matrix  Q with dimensions equal to that of the state space and initial probability distribution defined on the state space. For i ≠ j , the elements q ij are non-negative and describe the rate of the process transitions from state i to state j . The elements q ii are chosen such that each row of the transition rate matrix sums to zero.  There are three equivalent definitions of the process. 3  Infinitesimal definition  (Figure)  The continuous time Markov chain is characterized by the transition rates, the derivatives with respect to time of the transition probabilities between states i and j.   Let X t be the random variable describing the state of the process at time t , and assume that the process is in a state i at time t . Then X t + h is independent of previous values ( X s : s ≤ t ) and as h → 0 uniformly in t for all j       Pr   (    X   (   t  +  h   )    =  j   |    X   (  t  )    =  i   )    =    δ   i  j    +    q   i  j    h   +   o   (  h  )          Pr      X    t  h    j       X  t   i       subscript  δ    i  j       subscript  q    i  j    h     o  h      \Pr(X(t+h)=j|X(t)=i)=\delta_{ij}+q_{ij}h+o(h)     using little-o notation . The q ij can be seen as measuring how quickly the transition from i to j happens  Jump chain/holding time definition  Define a discrete-time Markov chain Y n to describe the n th jump of the process and variables S 1 , S 2 , S 3 , ... to describe holding times in each of the states where S i follows the exponential distribution with rate parameter − q Y i Y i .  Transition probability definition  For any value n = 0, 1, 2, 3, ... and times indexed up to this value of n : t 0 , t 1 , t 2 , ... and all states recorded at these times i 0 , i 1 , i 2 , i 3 , ... it holds that       Pr   (    X   t   n  +  1     =   i   n  +  1     |    X   t  0    =   i  0    ,    X   t  1    =   i  1    ,  …  ,    X   t  n    =   i  n    )    =    p    i  n    i   n  +  1       (    t   n  +  1    -   t  n    )         Pr     subscript  X   subscript  t    n  1      subscript  i    n  1        subscript  X   subscript  t  0     subscript  i  0       subscript  X   subscript  t  1     subscript  i  1    normal-…     subscript  X   subscript  t  n     subscript  i  n        subscript  p     subscript  i  n    subscript  i    n  1         subscript  t    n  1     subscript  t  n       \Pr(X_{t_{n+1}}=i_{n+1}|X_{t_{0}}=i_{0},X_{t_{1}}=i_{1},\ldots,X_{t_{n}}=i_{n}%
 )=p_{i_{n}i_{n+1}}(t_{n+1}-t_{n})     where p ij is the solution of the forward equation (a first-order differential equation )        P  ′    (  t  )    =   P   (  t  )   Q          superscript  P  normal-′   t     P  t  Q     P^{\prime}(t)=P(t)Q     with initial condition P(0) is the identity matrix .  Properties  Irreducibility  A state j is said to be accessible from a state i (written i → j ) if it is possible to get to j from i , that is if        Pr  i    (    X  t   =   j  for some  t   ≥  0   )    >  0.        subscript  Pr  i        subscript  X  t     j  for some  t        0     0.    \operatorname{Pr}_{i}(X_{t}=j\text{ for some }t\geq 0)>0.   A state i is said to communicate with a state j (written i ↔ j ) if both i → j and j → i . A set of states C is a communicating class if every pair of states in C communicates with each other, and no state in C communicates with any state not in C . Since the communication is an equivalence relation , the state space S can be partitioned into communicating classes. A CTMC is irreducible if the entire S is a single communicating class. 4 5  Recurrence and transience  A state i is recurrent if, starting in state i , the probability the process returns unboundedly many times to the state is 1, that is 6        Pr  i    (    {   t  ≥  0   :    X  t   =  i   }   is unbounded   )    =  1        subscript  Pr  i      conditional-set    t  0      subscript  X  t   i    is unbounded    1    \operatorname{Pr}_{i}(\{t\geq 0:X_{t}=i\}\text{ is unbounded})=1     and a state i is transient if this quantity has probability zero, 7        Pr  i    (    {   t  ≥  0   :    X  t   =  i   }   is unbounded   )    =  0.        subscript  Pr  i      conditional-set    t  0      subscript  X  t   i    is unbounded    0.    \operatorname{Pr}_{i}(\{t\geq 0:X_{t}=i\}\text{ is unbounded})=0.     If the expected return time (the time starting in state i until the next visit to state i ) is finite the state is positive recurrent, otherwise it is null recurrent.  Transient behaviour  Write P( t ) for the matrix with entries p ij = P( X t = j | X 0 = i ). Then the matrix P( t ) satisfies the forward equation, a first-order differential equation        P  ′    (  t  )    =   P   (  t  )   Q          superscript  P  normal-′   t     P  t  Q     P^{\prime}(t)=P(t)Q     where the prime denotes differentiation with respect to t . The solution to this equation is given by a matrix exponential       P   (  t  )    =   e   t  Q          P  t    superscript  e    t  Q      P(t)=e^{tQ}     In a simple case such as a CTMC on the state space {1,2}. The general Q matrix for such a process is the following 2 × 2 matrix with α , β > 0       Q  =   (      -  α     α      β     -  β      )    .      Q      α   α    β    β       Q=\begin{pmatrix}-\alpha&\alpha\\
 \beta&-\beta\end{pmatrix}.     The above relation for forward matrix can be solved explicitly in this case to give       P   (  t  )    =   (        β   α  +  β     +     α   α  +  β      e   -    (   α  +  β   )   t            α   α  +  β     -     α   α  +  β      e   -    (   α  +  β   )   t              β   α  +  β     -     β   α  +  β      e   -    (   α  +  β   )   t            α   α  +  β     +     β   α  +  β      e   -    (   α  +  β   )   t          )         P  t         β    α  β        α    α  β     superscript  e        α  β   t           α    α  β        α    α  β     superscript  e        α  β   t             β    α  β        β    α  β     superscript  e        α  β   t           α    α  β        β    α  β     superscript  e        α  β   t           P(t)=\begin{pmatrix}\frac{\beta}{\alpha+\beta}+\frac{\alpha}{\alpha+\beta}e^{-%
 (\alpha+\beta)t}&\frac{\alpha}{\alpha+\beta}-\frac{\alpha}{\alpha+\beta}e^{-(%
 \alpha+\beta)t}\\
 \frac{\beta}{\alpha+\beta}-\frac{\beta}{\alpha+\beta}e^{-(\alpha+\beta)t}&%
 \frac{\alpha}{\alpha+\beta}+\frac{\beta}{\alpha+\beta}e^{-(\alpha+\beta)t}\end%
 {pmatrix}     However, direct solutions are complicated to compute for larger matrices. The fact that Q is the generator for a semigroup of matrices       P   (   t  +  s   )    =   e    (   t  +  s   )   Q    =    e   t  Q     e   s  Q     =   P   (  t  )   P   (  s  )            P    t  s     superscript  e      t  s   Q            superscript  e    t  Q     superscript  e    s  Q            P  t  P  s      P(t+s)=e^{(t+s)Q}=e^{tQ}e^{sQ}=P(t)P(s)     is used.  Stationary distribution  The stationary distribution for an irreducible recurrent CTMC is the probability distribution to which the process converges for large values of t . Observe that for the two-state process considered earlier with P( t ) given by       P   (  t  )    =   (        β   α  +  β     +     α   α  +  β      e   -    (   α  +  β   )   t            α   α  +  β     -     α   α  +  β      e   -    (   α  +  β   )   t              β   α  +  β     -     β   α  +  β      e   -    (   α  +  β   )   t            α   α  +  β     +     β   α  +  β      e   -    (   α  +  β   )   t          )         P  t         β    α  β        α    α  β     superscript  e        α  β   t           α    α  β        α    α  β     superscript  e        α  β   t             β    α  β        β    α  β     superscript  e        α  β   t           α    α  β        β    α  β     superscript  e        α  β   t           P(t)=\begin{pmatrix}\frac{\beta}{\alpha+\beta}+\frac{\alpha}{\alpha+\beta}e^{-%
 (\alpha+\beta)t}&\frac{\alpha}{\alpha+\beta}-\frac{\alpha}{\alpha+\beta}e^{-(%
 \alpha+\beta)t}\\
 \frac{\beta}{\alpha+\beta}-\frac{\beta}{\alpha+\beta}e^{-(\alpha+\beta)t}&%
 \frac{\alpha}{\alpha+\beta}+\frac{\beta}{\alpha+\beta}e^{-(\alpha+\beta)t}\end%
 {pmatrix}     as t → ∞ the distribution tends to       P  π   =   (       β   α  +  β         α   α  +  β           β   α  +  β         α   α  +  β        )        subscript  P  π       β    α  β      α    α  β        β    α  β      α    α  β        P_{\pi}=\begin{pmatrix}\frac{\beta}{\alpha+\beta}&\frac{\alpha}{\alpha+\beta}%
 \\
 \frac{\beta}{\alpha+\beta}&\frac{\alpha}{\alpha+\beta}\end{pmatrix}     Observe that each row has the same distribution as this does not depend on starting state. The row vector π may be found by solving 8       π  Q   =  0.        π  Q   0.    \pi Q=0.     with the additional constraint that        ∑   i  ∈  S     π  i    =  1.        subscript     i  S     subscript  π  i    1.    \sum_{i\in S}\pi_{i}=1.     Example  The image to the right describes a continuous-time Markov chain with state-space {Bull market, Bear market, Stagnant market} and transition rate matrix    Q=\begin{pmatrix}     -0.025 & 0.02 & 0.005 \\ 0.3 & -0.5 & 0.2 \\ 0.02 & 0.4 & -0.42 \end{pmatrix}.  The stationary distribution of this chain can be found by solving π  Q = 0 subject to the constraint that elements must sum to 1 to obtain       π  =   (     0.885    0.071    0.044     )    .      π    0.885  0.071  0.044      \pi=\begin{pmatrix}0.885&0.071&0.044\end{pmatrix}.     Hitting times  The hitting time is the time, starting in a given set of states until the chain arrives in a given state or set of states. The distribution of such a time period has a phase type distribution. The simplest such distribution is that of a single exponentially distributed transition.  Expected hitting times  For a subset of states A ⊆ S , the vector k A of hitting times (where element k A i represents the expected value , starting in state i that the chain enters one of the states in the set A ) is the minimal non-negative solution to 9       k  i  A   =  0       superscript   subscript  k  i   A   0    \displaystyle k_{i}^{A}=0     Time reversal  For a CTMC X t , the time-reversed process is defined to be      X  ^   t   =   X   T  -  t         subscript   normal-^  X   t    subscript  X    T  t      \scriptstyle\hat{X}_{t}=X_{T-t}   . By Kelly's lemma this process has the same stationary distribution as the forward process.  A chain is said to be reversible if the reversed process is the same as the forward process. Kolmogorov's criterion states that the necessary and sufficient condition for a process to be reversible is that the product of transition rates around a closed loop must be the same in both directions.  Embedded Markov chain  One method of finding the stationary probability distribution , π , of an ergodic continuous-time Markov chain, Q , is by first finding its embedded Markov chain (EMC). Strictly speaking, the EMC is a regular discrete-time Markov chain, sometimes referred to as a jump process . Each element of the one-step transition probability matrix of the EMC, S , is denoted by s ij , and represents the conditional probability of transitioning from state i into state j . These conditional probabilities may be found by       s   i  j    =   {        q   i  j       ∑   k  ≠  i      q   i  k           if  i   ≠  j       0     otherwise  .            subscript  s    i  j     cases     subscript  q    i  j      subscript     k  i     subscript  q    i  k          if  i   j   0  otherwise     s_{ij}=\begin{cases}\frac{q_{ij}}{\sum_{k\neq i}q_{ik}}&\text{if }i\neq j\\
 0&\text{otherwise}.\end{cases}     From this, S may be written as      S  =   I  -     (   diag   (  Q  )    )    -  1    Q        S    I     superscript   diag  Q     1    Q      S=I-\left(\operatorname{diag}(Q)\right)^{-1}Q     where I is the identity matrix and diag( Q ) is the diagonal matrix formed by selecting the main diagonal from the matrix Q and setting all other elements to zero.  To find the stationary probability distribution vector, we must next find   ϕ   ϕ   \phi   such that        ϕ  S   =  ϕ   ,        ϕ  S   ϕ    \phi S=\phi,\,     with   ϕ   ϕ   \phi   being a row vector, such that all elements in   ϕ   ϕ   \phi   are greater than 0 and      ||  ϕ  ||   1     subscript   norm  ϕ   1    ||\phi||_{1}    = 1. From this, π may be found as       π  =    -   ϕ    (   diag   (  Q  )    )    -  1        ∥   ϕ    (   diag   (  Q  )    )    -  1     ∥   1     .      π        ϕ   superscript   diag  Q     1       subscript   norm    ϕ   superscript   diag  Q     1      1      \pi={-\phi(\operatorname{diag}(Q))^{-1}\over\left\|\phi(\operatorname{diag}(Q)%
 )^{-1}\right\|_{1}}.     Note that S may be periodic, even if Q is not. Once π is found, it must be normalized to a unit vector .  Another discrete-time process that may be derived from a continuous-time Markov chain is a δ-skeleton —the (discrete-time) Markov chain formed by observing X ( t ) at intervals of δ units of time. The random variables X (0), X (δ), X (2δ), ... give the sequence of states visited by the δ-skeleton.  Applications  Markov chains are used to describe physical processes where a system evolves in constant time. Sometimes, rather than a single systems, they are applied to an ensemble of identical, independent systems, and the probabilities are used to find how many members of the ensemble are in a given state. A master equation treatment is often used to analyse systems that evolve as Markov chains,  with approximations possible for complicated systems .  Chemical reactions  Imagine a large number n of molecules in solution in state A, each of which can undergo a chemical reaction to state B with a certain average rate. Perhaps the molecule is an enzyme, and the states refer to how it is folded. The state of any single enzyme follows a Markov chain, and since the molecules are essentially independent of each other, the number of molecules in state A or B at a time is n times the probability a given molecule is in that state.  Queueing theory  Numerous queueing models use continuous-time Markov chains. For example, an M/M/1 queue is a CTMC on the non-negative integers where upward transitions from i to i + 1 occur at rate λ according to a Poisson process and describe job arrivals, while transitions from i to i – 1 (for i > 1) occur at rate μ (job service times are exponentially distributed) and describe completed services (departures) from the queue.  Extensions  A time dependent (time heterogeneous) CTMC is as above, but with the infinitesimal generator matrix a function of time Q( t ).  See also   Master equation (physics)  Semi-Markov process  Variable-order Markov model  Spectral expansion solution  Matrix geometric solution method   References          "  Category:Markov processes     ↩  ↩  ↩   ↩    ↩      
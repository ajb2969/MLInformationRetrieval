<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="45">Van der Waerden test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Van der Waerden test</h1>
<hr/>

<p>Named for the Dutch mathematician <a href="Bartel_Leendert_van_der_Waerden" title="wikilink">Bartel Leendert van der Waerden</a>, the <strong>Van der Waerden test</strong> is a <a href="statistical_test" title="wikilink">statistical test</a> that <em>k</em> population distribution functions are equal. The Van Der Waerden test converts the ranks from a standard <a href="Kruskal-Wallis_one-way_analysis_of_variance" title="wikilink">Kruskal-Wallis one-way analysis of variance</a> to <a href="quantile" title="wikilink">quantiles</a> of the standard normal distribution (details given below). These are called normal scores and the test is computed from these normal scores.</p>

<p>The <em>k</em> population version of the test is an extension of the test for two populations published by Van der Waerden (1952,1953).</p>
<h2 id="background">Background</h2>

<p><a href="Analysis_of_Variance" title="wikilink">Analysis of Variance</a> (ANOVA) is a <a href="data_analysis" title="wikilink">data analysis</a> technique for examining the significance of the factors (<a href="independent_variables" title="wikilink">independent variables</a>) in a multi-factor model. The one factor model can be thought of as a generalization of the <a href="two_sample_t-test" title="wikilink">two sample t-test</a>. That is, the two sample t-test is a test of the hypothesis that two population means are equal. The one factor ANOVA tests the hypothesis that <em>k</em> population means are equal. The standard ANOVA assumes that the errors (i.e., residuals) are <a href="normal_distribution" title="wikilink">normally distributed</a>. If this normality assumption is not valid, an alternative is to use a <a href="non-parametric_test" title="wikilink">non-parametric test</a>.</p>
<h2 id="test-definition">Test definition</h2>

<p>Let <em>n<sub>j</sub></em> (<em>j</em> = 1, 2, ..., <em>k</em>) represent the sample sizes for each of the <em>k</em> groups (i.e., samples) in the data. Let <em>N</em> denote the sample size for all groups. Let <em>X<sub>ij</sub></em> represent the <em>i</em><sup>th</sup> value in the <em>j</em><sup>th</sup> group. The normal scores are computed as</p>

<p>

<math display="block" id="Van_der_Waerden_test:0">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi mathvariant="normal">Φ</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mrow>
       <mi>R</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>X</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>N</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Φ</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>R</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{ij}=\Phi^{-1}\left(\frac{R(X_{ij})}{N+1}\right)
  </annotation>
 </semantics>
</math>

 where <em>R</em>(<em>X<sub>ij</sub></em>) denotes the rank of observation <em>X<sub>ij</sub></em> and where <em>Φ</em><sup>−1</sup> denotes the normal <a href="quantile_function" title="wikilink">quantile function</a>. The average of the normal scores for each sample can then be computed as</p>

<p>

<math display="block" id="Van_der_Waerden_test:1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>A</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>n</mi>
       <mi>j</mi>
      </msub>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>n</mi>
        <mi>j</mi>
       </msub>
      </munderover>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mi>j</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>A</ci>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>j</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <ci>normal-…</ci>
      <ci>k</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{A}_{j}=\frac{1}{n_{j}}\sum_{i=1}^{n_{j}}A_{ij}\quad j=1,2,\ldots,k
  </annotation>
 </semantics>
</math>

 The variance of the normal scores can be computed as</p>

<p>

<math display="block" id="Van_der_Waerden_test:2">
 <semantics>
  <mrow>
   <msup>
    <mi>s</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>k</mi>
     </munderover>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <msub>
        <mi>n</mi>
        <mi>j</mi>
       </msub>
      </munderover>
      <msubsup>
       <mi>A</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>s</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s^{2}=\frac{1}{N-1}\sum_{j=1}^{k}\sum_{i=1}^{n_{j}}A_{ij}^{2}
  </annotation>
 </semantics>
</math>

 The Van Der Waerden test can then be defined as follows:</p>
<dl>
<dd>H<sub>0</sub>: All of the <em>k</em> population distribution functions are identical
</dd>
<dd>H<sub>a</sub>: At least one of the populations tends to yield larger observations than at least one of the other populations
</dd>
</dl>

<p>The test statistic is</p>

<p>

<math display="block" id="Van_der_Waerden_test:3">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mi>s</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>k</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>j</mi>
      </msub>
      <msubsup>
       <mover accent="true">
        <mi>A</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mi>j</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>A</ci>
         </apply>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{1}=\frac{1}{s^{2}}\sum_{j=1}^{k}n_{j}\bar{A}_{j}^{2}
  </annotation>
 </semantics>
</math>

 For <a href="significance_level" title="wikilink">significance level</a> α, the critical region is</p>

<p>

<math display="block" id="Van_der_Waerden_test:4">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mn>1</mn>
   </msub>
   <mo>></mo>
   <msubsup>
    <mi>χ</mi>
    <mrow>
     <mi>α</mi>
     <mo>,</mo>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>χ</ci>
      <list>
       <ci>α</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{1}>\chi_{\alpha,k-1}^{2}
  </annotation>
 </semantics>
</math>

 where Χ<sub>α,k − 1</sub><sup>2</sup> is the α-<a class="uri" href="quantile" title="wikilink">quantile</a> of the <a href="chi-squared_distribution" title="wikilink">chi-squared distribution</a> with <em>k</em> − 1 degrees of freedom. The null hypothesis is rejected if the test statistic is in the critical region. If the hypothesis of identical distributions is rejected, one can perform a <a href="multiple_comparisons" title="wikilink">multiple comparisons</a> procedure to determine which pairs of populations tend to differ. The populations <em>j<sub>1</sub></em> and <em>j<sub>2</sub></em> seem to be different if the following inequality is satisfied:</p>

<p>

<math display="block" id="Van_der_Waerden_test:5">
 <semantics>
  <mrow>
   <mrow>
    <mo>|</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>A</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <msub>
       <mi>j</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>A</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <msub>
       <mi>j</mi>
       <mn>2</mn>
      </msub>
     </msub>
    </mrow>
    <mo>|</mo>
   </mrow>
   <mo>></mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>s</mi>
    </mpadded>
    <msub>
     <mi>t</mi>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mi>α</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msub>
    <msqrt>
     <mfrac>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>T</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
     </mfrac>
    </msqrt>
    <msqrt>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>n</mi>
        <msub>
         <mi>j</mi>
         <mn>1</mn>
        </msub>
       </msub>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <msub>
        <mi>n</mi>
        <msub>
         <mi>j</mi>
         <mn>2</mn>
        </msub>
       </msub>
      </mfrac>
     </mrow>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>j</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>j</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\bar{A}_{j_{1}}-\bar{A}_{j_{2}}\right|>s\,t_{1-\alpha/2}\sqrt{\frac{N-1-%
T_{1}}{N-k}}\sqrt{\frac{1}{n_{j_{1}}}+\frac{1}{n_{j_{2}}}}
  </annotation>
 </semantics>
</math>

 with <em>t</em><sub>1 − α/2</sub> the (1 − α/2)-<a class="uri" href="quantile" title="wikilink">quantile</a> of the <a href="Student's_t-distribution" title="wikilink">t-distribution</a>.</p>
<h2 id="comparison-with-the-kruskal-wallis-test">Comparison with the Kruskal-Wallis test</h2>

<p>The most common non-parametric test for the one-factor model is the <a href="Kruskal-Wallis_one-way_analysis_of_variance" title="wikilink">Kruskal-Wallis test</a>. The Kruskal-Wallis test is based on the ranks of the data. The advantage of the Van Der Waerden test is that it provides the high efficiency of the standard ANOVA analysis when the normality assumptions are in fact satisfied, but it also provides the robustness of the Kruskal-Wallis test when the normality assumptions are not satisfied.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<ul>
<li>van der Waerden, B.L. (1952). "Order tests for the two-sample problem and their power", <em>Indagationes Mathematicae</em>, 14, 453–458.</li>
</ul>
<ul>
<li>van der Waerden, B.L. (1953). "Order tests for the two-sample problem. II, III", <em>Proceedings of the Koninklijke Nederlandse Akademie van Wetenschappen, Serie A</em>, 564, 303–310, 311–316.</li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_tests" title="wikilink">Category:Statistical tests</a> <a href="Category:Non-parametric_statistics" title="wikilink">Category:Non-parametric statistics</a></p>
</body>
</html>

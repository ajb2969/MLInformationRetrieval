   Image moment      Image moment   In image processing , computer vision and related fields, an image moment is a certain particular weighted average ( moment ) of the image pixels' intensities, or a function of such moments, usually chosen to have some attractive property or interpretation.  Image moments are useful to describe objects after segmentation . Simple properties of the image which are found via image moments include area (or total intensity), its centroid , and information about its orientation .  Raw moments  For a 2D continuous function f ( x , y ) the moment (sometimes called "raw moment") of order ( p + q ) is defined as       M   p  q    =    ∫   -  ∞   ∞     ∫   -  ∞   ∞     x  p    y  q   f   (  x  ,  y  )   d   x   d  y          subscript  M    p  q      superscript   subscript            superscript   subscript             superscript  x  p    superscript  y  q   f   x  y   d  x  d  y       M_{pq}=\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty}x^{p}y^{q}f%
 (x,y)\,dx\,dy     for p , q = 0,1,2,... Adapting this to scalar (greyscale) image with pixel intensities I ( x , y ), raw image moments M ij are calculated by       M   i  j    =    ∑  x     ∑  y     x  i    y  j   I   (  x  ,  y  )           subscript  M    i  j      subscript   x     subscript   y      superscript  x  i    superscript  y  j   I   x  y        M_{ij}=\sum_{x}\sum_{y}x^{i}y^{j}I(x,y)\,\!     In some cases, this may be calculated by considering the image as a probability density function , i.e. , by dividing the above by       ∑  x     ∑  y    I   (  x  ,  y  )         subscript   x     subscript   y     I   x  y       \sum_{x}\sum_{y}I(x,y)\,\!     A uniqueness theorem (Hu [1962]) states that if f ( x , y ) is piecewise continuous and has nonzero values only in a finite part of the xy plane, moments of all orders exist, and the moment sequence ( M pq ) is uniquely determined by f ( x , y ). Conversely, ( M pq ) uniquely determines f ( x , y ). In practice, the image is summarized with functions of a few lower order moments.  Examples  Simple image properties derived via raw moments include:   Area (for binary images) or sum of grey level (for greytone images): M 00  Centroid: { ,  } = { M 10 / M 00 , M 01 / M 00 }   Central moments  Central moments are defined as       μ   p  q    =    ∫   -  ∞   ∞     ∫   -  ∞   ∞      (   x  -   x  ¯    )   p     (   y  -   y  ¯    )   q   f   (  x  ,  y  )   d   x   d  y          subscript  μ    p  q      superscript   subscript            superscript   subscript             superscript    x   normal-¯  x    p    superscript    y   normal-¯  y    q   f   x  y   d  x  d  y       \mu_{pq}=\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty}(x-\bar{x%
 })^{p}(y-\bar{y})^{q}f(x,y)\,dx\,dy     where     x  ¯   =    M  10    M  00         normal-¯  x      subscript  M  10    subscript  M  00      \bar{x}=\frac{M_{10}}{M_{00}}   and     y  ¯   =    M  01    M  00         normal-¯  y      subscript  M  01    subscript  M  00      \bar{y}=\frac{M_{01}}{M_{00}}   are the components of the centroid .  If ƒ ( x , y ) is a digital image, then the previous equation becomes       μ   p  q    =    ∑  x     ∑  y      (   x  -   x  ¯    )   p     (   y  -   y  ¯    )   q   f   (  x  ,  y  )           subscript  μ    p  q      subscript   x     subscript   y      superscript    x   normal-¯  x    p    superscript    y   normal-¯  y    q   f   x  y        \mu_{pq}=\sum_{x}\sum_{y}(x-\bar{x})^{p}(y-\bar{y})^{q}f(x,y)     The central moments of order up to 3 are:        μ  00   =   M  00    ,       subscript  μ  00    subscript  M  00     \mu_{00}=M_{00},\,\!           μ  01   =  0   ,       subscript  μ  01   0    \mu_{01}=0,\,\!           μ  10   =  0   ,       subscript  μ  10   0    \mu_{10}=0,\,\!           μ  11   =    M  11   -    x  ¯    M  01     =    M  11   -    y  ¯    M  10      ,         subscript  μ  11      subscript  M  11      normal-¯  x    subscript  M  01             subscript  M  11      normal-¯  y    subscript  M  10        \mu_{11}=M_{11}-\bar{x}M_{01}=M_{11}-\bar{y}M_{10},           μ  20   =    M  20   -    x  ¯    M  10      ,       subscript  μ  20      subscript  M  20      normal-¯  x    subscript  M  10       \mu_{20}=M_{20}-\bar{x}M_{10},           μ  02   =    M  02   -    y  ¯    M  01      ,       subscript  μ  02      subscript  M  02      normal-¯  y    subscript  M  01       \mu_{02}=M_{02}-\bar{y}M_{01},           μ  21   =     M  21   -   2   x  ¯    M  11    -    y  ¯    M  20     +   2    x  ¯   2    M  01      ,       subscript  μ  21        subscript  M  21     2   normal-¯  x    subscript  M  11       normal-¯  y    subscript  M  20       2   superscript   normal-¯  x   2    subscript  M  01       \mu_{21}=M_{21}-2\bar{x}M_{11}-\bar{y}M_{20}+2\bar{x}^{2}M_{01},           μ  12   =     M  12   -   2   y  ¯    M  11    -    x  ¯    M  02     +   2    y  ¯   2    M  10      ,       subscript  μ  12        subscript  M  12     2   normal-¯  y    subscript  M  11       normal-¯  x    subscript  M  02       2   superscript   normal-¯  y   2    subscript  M  10       \mu_{12}=M_{12}-2\bar{y}M_{11}-\bar{x}M_{02}+2\bar{y}^{2}M_{10},           μ  30   =     M  30   -   3   x  ¯    M  20     +   2    x  ¯   2    M  10      ,       subscript  μ  30        subscript  M  30     3   normal-¯  x    subscript  M  20       2   superscript   normal-¯  x   2    subscript  M  10       \mu_{30}=M_{30}-3\bar{x}M_{20}+2\bar{x}^{2}M_{10},           μ  03   =     M  03   -   3   y  ¯    M  02     +   2    y  ¯   2    M  01      .       subscript  μ  03        subscript  M  03     3   normal-¯  y    subscript  M  02       2   superscript   normal-¯  y   2    subscript  M  01       \mu_{03}=M_{03}-3\bar{y}M_{02}+2\bar{y}^{2}M_{01}.     It can be shown that:       μ   p  q    =    ∑  m  p     ∑  n  q     (     p      m     )    (     q      n     )     (   -   x  ¯    )    (   p  -  m   )      (   -   y  ¯    )    (   q  -  n   )     M   m  n            subscript  μ    p  q      superscript   subscript   m   p     superscript   subscript   n   q      binomial  p  m    binomial  q  n    superscript     normal-¯  x      p  m     superscript     normal-¯  y      q  n     subscript  M    m  n         \mu_{pq}=\sum_{m}^{p}\sum_{n}^{q}{p\choose m}{q\choose n}(-\bar{x})^{(p-m)}(-%
 \bar{y})^{(q-n)}M_{mn}     Central moments are translational invariant .  Examples  Information about image orientation can be derived by first using the second order central moments to construct a covariance matrix .       μ  20  ′   =    μ  20   /   μ  00    =     M  20   /   M  00    -    x  ¯   2           subscript   superscript  μ  normal-′   20      subscript  μ  20    subscript  μ  00              subscript  M  20    subscript  M  00     superscript   normal-¯  x   2       \mu^{\prime}_{20}=\mu_{20}/\mu_{00}=M_{20}/M_{00}-\bar{x}^{2}          μ  02  ′   =    μ  02   /   μ  00    =     M  02   /   M  00    -    y  ¯   2           subscript   superscript  μ  normal-′   02      subscript  μ  02    subscript  μ  00              subscript  M  02    subscript  M  00     superscript   normal-¯  y   2       \mu^{\prime}_{02}=\mu_{02}/\mu_{00}=M_{02}/M_{00}-\bar{y}^{2}          μ  11  ′   =    μ  11   /   μ  00    =     M  11   /   M  00    -    x  ¯    y  ¯            subscript   superscript  μ  normal-′   11      subscript  μ  11    subscript  μ  00              subscript  M  11    subscript  M  00       normal-¯  x    normal-¯  y        \mu^{\prime}_{11}=\mu_{11}/\mu_{00}=M_{11}/M_{00}-\bar{x}\bar{y}     The covariance matrix of the image    I   (  x  ,  y  )       I   x  y     I(x,y)   is now       cov   [   I   (  x  ,  y  )    ]    =   [      μ  20  ′      μ  11  ′        μ  11  ′      μ  02  ′      ]        cov    I   x  y        subscript   superscript  μ  normal-′   20    subscript   superscript  μ  normal-′   11      subscript   superscript  μ  normal-′   11    subscript   superscript  μ  normal-′   02       \operatorname{cov}[I(x,y)]=\begin{bmatrix}\mu^{\prime}_{20}&\mu^{\prime}_{11}%
 \\
 \mu^{\prime}_{11}&\mu^{\prime}_{02}\end{bmatrix}   .  The eigenvectors of this matrix correspond to the major and minor axes of the image intensity, so the orientation can thus be extracted from the angle of the eigenvector associated with the largest eigenvalue. It can be shown that this angle Θ is given by the following formula:      Θ  =    1  2    arctan   (    2   μ  11  ′      μ  20  ′   -   μ  02  ′     )         normal-Θ      1  2         2   subscript   superscript  μ  normal-′   11       subscript   superscript  μ  normal-′   20    subscript   superscript  μ  normal-′   02         \Theta=\frac{1}{2}\arctan\left(\frac{2\mu^{\prime}_{11}}{\mu^{\prime}_{20}-\mu%
 ^{\prime}_{02}}\right)     The above formula holds as long as:        μ  20  ′   -   μ  02  ′    ≠  0         subscript   superscript  μ  normal-′   20    subscript   superscript  μ  normal-′   02    0    \mu^{\prime}_{20}-\mu^{\prime}_{02}\neq 0     The eigenvalues of the covariance matrix can easily be shown to be        λ  i   =      μ  20  ′   +   μ  02  ′    2   ±      4   μ   ′  11  2    +    (    μ   ′  20    -   μ   ′  02     )   2     2     ,       subscript  λ  i    plus-or-minus       subscript   superscript  μ  normal-′   20    subscript   superscript  μ  normal-′   02    2           4   superscript   subscript   superscript  μ  normal-′   11   2     superscript     subscript   superscript  μ  normal-′   20    subscript   superscript  μ  normal-′   02    2     2      \lambda_{i}=\frac{\mu^{\prime}_{20}+\mu^{\prime}_{02}}{2}\pm\frac{\sqrt{4{\mu^%
 {\prime}}_{11}^{2}+({\mu^{\prime}}_{20}-{\mu^{\prime}}_{02})^{2}}}{2},     and are proportional to the squared length of the eigenvector axes. The relative difference in magnitude of the eigenvalues are thus an indication of the eccentricity of the image, or how elongated it is. The eccentricity is        1  -    λ  2    λ  1      .        1     subscript  λ  2    subscript  λ  1       \sqrt{1-\frac{\lambda_{2}}{\lambda_{1}}}.     Scale invariant moments  Moments η i j where i + j ≥ 2 can be constructed to be invariant to both translation and changes in scale by dividing the corresponding central moment by the properly scaled (00)th moment, using the following formula.       η   i  j    =    μ   i  j     μ  00   (   1  +    i  +  j   2    )          subscript  η    i  j       subscript  μ    i  j     superscript   subscript  μ  00     1      i  j   2        \eta_{ij}=\frac{\mu_{ij}}{\mu_{00}^{\left(1+\frac{i+j}{2}\right)}}\,\!     Rotation invariant moments  It is possible to calculate moments which are invariant under translation , changes in scale , and also rotation . Most frequently used are the Hu set of invariant moments: 1 2      I  1   =    η  20   +   η  02         subscript  I  1      subscript  η  20    subscript  η  02      I_{1}=\eta_{20}+\eta_{02}        I  2   =     (    η  20   -   η  02    )   2   +   4   η  11  2          subscript  I  2      superscript     subscript  η  20    subscript  η  02    2     4   superscript   subscript  η  11   2       I_{2}=(\eta_{20}-\eta_{02})^{2}+4\eta_{11}^{2}        I  3   =     (    η  30   -   3   η  12     )   2   +    (    3   η  21    -   η  03    )   2         subscript  I  3      superscript     subscript  η  30     3   subscript  η  12     2    superscript      3   subscript  η  21     subscript  η  03    2      I_{3}=(\eta_{30}-3\eta_{12})^{2}+(3\eta_{21}-\eta_{03})^{2}        I  4   =     (    η  30   +   η  12    )   2   +    (    η  21   +   η  03    )   2         subscript  I  4      superscript     subscript  η  30    subscript  η  12    2    superscript     subscript  η  21    subscript  η  03    2      I_{4}=(\eta_{30}+\eta_{12})^{2}+(\eta_{21}+\eta_{03})^{2}        I  5   =     (    η  30   -   3   η  12     )    (    η  30   +   η  12    )    [     (    η  30   +   η  12    )   2   -   3    (    η  21   +   η  03    )   2     ]    +    (    3   η  21    -   η  03    )    (    η  21   +   η  03    )    [    3    (    η  30   +   η  12    )   2    -    (    η  21   +   η  03    )   2    ]          subscript  I  5          subscript  η  30     3   subscript  η  12        subscript  η  30    subscript  η  12     delimited-[]     superscript     subscript  η  30    subscript  η  12    2     3   superscript     subscript  η  21    subscript  η  03    2             3   subscript  η  21     subscript  η  03       subscript  η  21    subscript  η  03     delimited-[]      3   superscript     subscript  η  30    subscript  η  12    2     superscript     subscript  η  21    subscript  η  03    2         I_{5}=(\eta_{30}-3\eta_{12})(\eta_{30}+\eta_{12})[(\eta_{30}+\eta_{12})^{2}-3(%
 \eta_{21}+\eta_{03})^{2}]+(3\eta_{21}-\eta_{03})(\eta_{21}+\eta_{03})[3(\eta_{%
 30}+\eta_{12})^{2}-(\eta_{21}+\eta_{03})^{2}]        I  6   =     (    η  20   -   η  02    )    [     (    η  30   +   η  12    )   2   -    (    η  21   +   η  03    )   2    ]    +   4   η  11    (    η  30   +   η  12    )    (    η  21   +   η  03    )          subscript  I  6          subscript  η  20    subscript  η  02     delimited-[]     superscript     subscript  η  30    subscript  η  12    2    superscript     subscript  η  21    subscript  η  03    2        4   subscript  η  11      subscript  η  30    subscript  η  12       subscript  η  21    subscript  η  03        I_{6}=(\eta_{20}-\eta_{02})[(\eta_{30}+\eta_{12})^{2}-(\eta_{21}+\eta_{03})^{2%
 }]+4\eta_{11}(\eta_{30}+\eta_{12})(\eta_{21}+\eta_{03})         I  7   =     (    3   η  21    -   η  03    )    (    η  30   +   η  12    )    [     (    η  30   +   η  12    )   2   -   3    (    η  21   +   η  03    )   2     ]    -    (    η  30   -   3   η  12     )    (    η  21   +   η  03    )    [    3    (    η  30   +   η  12    )   2    -    (    η  21   +   η  03    )   2    ]      .       subscript  I  7           3   subscript  η  21     subscript  η  03       subscript  η  30    subscript  η  12     delimited-[]     superscript     subscript  η  30    subscript  η  12    2     3   superscript     subscript  η  21    subscript  η  03    2            subscript  η  30     3   subscript  η  12        subscript  η  21    subscript  η  03     delimited-[]      3   superscript     subscript  η  30    subscript  η  12    2     superscript     subscript  η  21    subscript  η  03    2         I_{7}=(3\eta_{21}-\eta_{03})(\eta_{30}+\eta_{12})[(\eta_{30}+\eta_{12})^{2}-3(%
 \eta_{21}+\eta_{03})^{2}]-(\eta_{30}-3\eta_{12})(\eta_{21}+\eta_{03})[3(\eta_{%
 30}+\eta_{12})^{2}-(\eta_{21}+\eta_{03})^{2}].     The first one, I 1 , is analogous to the moment of inertia around the image's centroid, where the pixels' intensities are analogous to physical density. The last one, I 7 , is skew invariant, which enables it to distinguish mirror images of otherwise identical images.  A general theory on deriving complete and independent sets of rotation invariant moments was proposed by J. Flusser 3 and T. Suk. 4 They showed that the traditional Hu's invariant set is not independent nor complete. I 3 is not very useful as it is dependent on the others. In the original Hu's set there is a missing third order independent moment invariant:       I  8   =     η  11    [     (    η  30   +   η  12    )   2   -    (    η  03   +   η  21    )   2    ]    -    (    η  20   -   η  02    )    (    η  30   +   η  12    )    (    η  03   +   η  21    )          subscript  I  8        subscript  η  11    delimited-[]     superscript     subscript  η  30    subscript  η  12    2    superscript     subscript  η  03    subscript  η  21    2           subscript  η  20    subscript  η  02       subscript  η  30    subscript  η  12       subscript  η  03    subscript  η  21        I_{8}=\eta_{11}[(\eta_{30}+\eta_{12})^{2}-(\eta_{03}+\eta_{21})^{2}]-(\eta_{20%
 }-\eta_{02})(\eta_{30}+\eta_{12})(\eta_{03}+\eta_{21})     External links   Analysis of Binary Images , University of Edinburgh  Statistical Moments , University of Edinburgh  Variant moments , Machine Perception and Computer Vision page (Matlab and Python source code)  Hu Moments introductory video on YouTube   References    "  Category:Computer vision     M. K. Hu, "Visual Pattern Recognition by Moment Invariants", IRE Trans. Info. Theory, vol. IT-8, pp.179–187, 1962 ↩  http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=cvmatchshapes#humoments Hu Moments' OpenCV method ↩  J. Flusser: " On the Independence of Rotation Moment Invariants ", Pattern Recognition, vol. 33, pp. 1405–1410, 2000. ↩  J. Flusser and T. Suk, " Rotation Moment Invariants for Recognition of Symmetric Objects ", IEEE Trans. Image Proc., vol. 15, pp. 3784–3790, 2006. ↩     
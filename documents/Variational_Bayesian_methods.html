<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="35">Variational Bayesian methods</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Variational Bayesian methods</h1>
<hr/>

<p><strong>Variational Bayesian</strong> methods are a family of techniques for approximating intractable <a href="integral" title="wikilink">integrals</a> arising in <a href="Bayesian_inference" title="wikilink">Bayesian inference</a> and <a href="machine_learning" title="wikilink">machine learning</a>. They are typically used in complex <a href="statistical_model" title="wikilink">statistical models</a> consisting of observed variables (usually termed "data") as well as unknown <a href="parameter" title="wikilink">parameters</a> and <a href="latent_variable" title="wikilink">latent variables</a>, with various sorts of relationships among the three types of <a href="random_variable" title="wikilink">random variables</a>, as might be described by a <a href="graphical_model" title="wikilink">graphical model</a>. As is typical in Bayesian inference, the parameters and latent variables are grouped together as "unobserved variables". Variational Bayesian methods are primarily used for two purposes:</p>
<ol>
<li>To provide an analytical approximation to the <a href="posterior_probability" title="wikilink">posterior probability</a> of the unobserved variables, in order to do <a href="statistical_inference" title="wikilink">statistical inference</a> over these variables.</li>
<li>To derive a <a href="lower_bound" title="wikilink">lower bound</a> for the <a href="marginal_likelihood" title="wikilink">marginal likelihood</a> (sometimes called the "evidence") of the observed data (i.e. the <a href="marginal_probability" title="wikilink">marginal probability</a> of the data given the model, with marginalization performed over unobserved variables). This is typically used for performing <a href="model_selection" title="wikilink">model selection</a>, the general idea being that a higher marginal likelihood for a given model indicates a better fit of the data by that model and hence a greater probability that the model in question was the one that generated the data. (See also the <a href="Bayes_factor" title="wikilink">Bayes factor</a> article.)</li>
</ol>

<p>In the former purpose (that of approximating a posterior probability), variational Bayes is an alternative to <a href="Monte_Carlo_sampling" title="wikilink">Monte Carlo sampling</a> methods — particularly, <a href="Markov_chain_Monte_Carlo" title="wikilink">Markov chain Monte Carlo</a> methods such as <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a> — for taking a fully Bayesian approach to <a href="statistical_inference" title="wikilink">statistical inference</a> over complex <a href="probability_distribution" title="wikilink">distributions</a> that are difficult to directly evaluate or <a href="sample_(statistics)" title="wikilink">sample</a> from. In particular, whereas Monte Carlo techniques provide a numerical approximation to the exact posterior using a set of samples, Variational Bayes provides a locally-optimal, exact analytical solution to an approximation of the posterior.</p>

<p>Variational Bayes can be seen as an extension of the EM (<a class="uri" href="expectation-maximization" title="wikilink">expectation-maximization</a>) algorithm from <a href="maximum_a_posteriori_estimation" title="wikilink">maximum a posteriori estimation</a> (MAP estimation) of the single most probable value of each parameter to fully Bayesian estimation which computes (an approximation to) the entire <a href="posterior_distribution" title="wikilink">posterior distribution</a> of the parameters and latent variables. As in EM, it finds a set of optimal parameter values, and it has the same alternating structure as does EM, based on a set of interlocked (mutually dependent) equations that cannot be solved analytically.</p>

<p>For many applications, variational Bayes produces solutions of comparable accuracy to Gibbs sampling at greater speed. However, deriving the set of equations used to iteratively update the parameters often requires a large amount of work compared with deriving the comparable Gibbs sampling equations. This is the case even for many models that are conceptually quite simple, as is demonstrated below in the case of a basic non-hierarchical model with only two parameters and no latent variables.</p>
<h2 id="mathematical-derivation-of-the-mean-field-approximation">Mathematical derivation of the mean-field approximation</h2>

<p>In <a href="Calculus_of_variations" title="wikilink">variational</a> inference, the posterior distribution over a set of unobserved variables 

<math display="inline" id="Variational_Bayesian_methods:0">
 <semantics>
  <mrow>
   <mi>𝐙</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <msub>
      <mi>Z</mi>
      <mn>1</mn>
     </msub>
     <mi mathvariant="normal">…</mi>
     <msub>
      <mi>Z</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐙</ci>
    <set>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Z</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Z</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}=\{Z_{1}\dots Z_{n}\}
  </annotation>
 </semantics>
</math>

 given some data 

<math display="inline" id="Variational_Bayesian_methods:1">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 is approximated by a variational distribution, 

<math display="inline" id="Variational_Bayesian_methods:2">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Q</ci>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(\mathbf{Z})
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Variational_Bayesian_methods:3">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≈</mo>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <approx></approx>
    <csymbol cd="unknown">Q</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mathbf{Z}\mid\mathbf{X})\approx Q(\mathbf{Z}).
  </annotation>
 </semantics>
</math>

</p>

<p>The distribution 

<math display="inline" id="Variational_Bayesian_methods:4">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Q</ci>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(\mathbf{Z})
  </annotation>
 </semantics>
</math>

 is restricted to belong to a family of distributions of simpler form than 

<math display="inline" id="Variational_Bayesian_methods:5">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mathbf{Z}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

, selected with the intention of making 

<math display="inline" id="Variational_Bayesian_methods:6">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Q</ci>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(\mathbf{Z})
  </annotation>
 </semantics>
</math>

 similar to the true posterior, 

<math display="inline" id="Variational_Bayesian_methods:7">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mathbf{Z}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

. The lack of similarity is measured in terms of a dissimilarity function 

<math display="inline" id="Variational_Bayesian_methods:8">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo>;</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <list>
     <ci>Q</ci>
     <ci>P</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(Q;P)
  </annotation>
 </semantics>
</math>

 and hence inference is performed by selecting the distribution 

<math display="inline" id="Variational_Bayesian_methods:9">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Q</ci>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(\mathbf{Z})
  </annotation>
 </semantics>
</math>

 that minimizes 

<math display="inline" id="Variational_Bayesian_methods:10">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo>;</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <list>
     <ci>Q</ci>
     <ci>P</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(Q;P)
  </annotation>
 </semantics>
</math>

.</p>

<p>The most common type of variational Bayes, known as <em>mean-field variational Bayes</em>, uses the <a href="Kullback–Leibler_divergence" title="wikilink">Kullback–Leibler divergence</a> (KL-divergence) of <em>P</em> from <em>Q</em> as the choice of dissimilarity function. This choice makes this minimization tractable. The KL-divergence is defined as</p>

<p>

<math display="block" id="Variational_Bayesian_methods:11">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mi>KL</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>𝐙</mi>
   </munder>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>log</mi>
   <mfrac>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo>∣</mo>
      <mi>𝐗</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>KL</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Q</csymbol>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>𝐙</ci>
    </apply>
    <csymbol cd="unknown">Q</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <log></log>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>𝐙</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Z</csymbol>
       <ci>normal-∣</ci>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{\mathrm{KL}}(Q||P)=\sum_{\mathbf{Z}}Q(\mathbf{Z})\log\frac{Q(\mathbf{Z})}{P%
(\mathbf{Z}\mid\mathbf{X})}.
  </annotation>
 </semantics>
</math>

</p>

<p>Note that <em>Q</em> and <em>P</em> are reversed from what one might expect. This use of reversed KL-divergence is conceptually similar to the <a href="expectation-maximization_algorithm" title="wikilink">expectation-maximization algorithm</a>. (Using the KL-divergence in the other way produces the <a href="expectation_propagation" title="wikilink">expectation propagation</a> algorithm.)</p>

<p>The KL-divergence can be written as</p>

<p>

<math display="block" id="Variational_Bayesian_methods:12">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mi>KL</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>𝐙</mi>
   </munder>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>log</mi>
   <mfrac>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo>,</mo>
      <mi>𝐗</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>+</mo>
   <mi>log</mi>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>KL</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Q</csymbol>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>𝐙</ci>
    </apply>
    <csymbol cd="unknown">Q</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <log></log>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>𝐙</ci>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <interval closure="open">
       <ci>𝐙</ci>
       <ci>𝐗</ci>
      </interval>
     </apply>
    </apply>
    <plus></plus>
    <log></log>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{\mathrm{KL}}(Q||P)=\sum_{\mathbf{Z}}Q(\mathbf{Z})\log\frac{Q(\mathbf{Z})}{P%
(\mathbf{Z},\mathbf{X})}+\log P(\mathbf{X}),
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Variational_Bayesian_methods:13">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>D</mi>
    <mi>KL</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>𝐙</mi>
   </munder>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>log</mi>
   <mfrac>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo>,</mo>
      <mi>𝐗</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <msub>
    <mi>D</mi>
    <mi>KL</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">|</mo>
    <mo stretchy="false">|</mo>
    <mi>P</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <log></log>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>KL</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Q</csymbol>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>𝐙</ci>
    </apply>
    <csymbol cd="unknown">Q</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <log></log>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>𝐙</ci>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <interval closure="open">
       <ci>𝐙</ci>
       <ci>𝐗</ci>
      </interval>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <ci>KL</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Q</csymbol>
     <ci>normal-|</ci>
     <ci>normal-|</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Q</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log P(\mathbf{X})=D_{\mathrm{KL}}(Q||P)-\sum_{\mathbf{Z}}Q(\mathbf{Z})\log%
\frac{Q(\mathbf{Z})}{P(\mathbf{Z},\mathbf{X})}=D_{\mathrm{KL}}(Q||P)+\mathcal{%
L}(Q).
  </annotation>
 </semantics>
</math>

</p>

<p>As the <em>log <a href="model_evidence" title="wikilink">evidence</a></em> 

<math display="inline" id="Variational_Bayesian_methods:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mi>P</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <log></log>
     <ci>P</ci>
    </apply>
    <ci>𝐗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log P(\mathbf{X})
  </annotation>
 </semantics>
</math>

 is fixed with respect to 

<math display="inline" id="Variational_Bayesian_methods:15">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

, maximizing the final term 

<math display="inline" id="Variational_Bayesian_methods:16">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℒ</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(Q)
  </annotation>
 </semantics>
</math>

 minimizes the KL divergence of 

<math display="inline" id="Variational_Bayesian_methods:17">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Variational_Bayesian_methods:18">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

. By appropriate choice of 

<math display="inline" id="Variational_Bayesian_methods:19">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:20">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℒ</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(Q)
  </annotation>
 </semantics>
</math>

 becomes tractable to compute and to maximize. Hence we have both an analytical approximation 

<math display="inline" id="Variational_Bayesian_methods:21">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 for the posterior 

<math display="inline" id="Variational_Bayesian_methods:22">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mathbf{Z}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

, and a lower bound 

<math display="inline" id="Variational_Bayesian_methods:23">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℒ</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(Q)
  </annotation>
 </semantics>
</math>

 for the evidence 

<math display="inline" id="Variational_Bayesian_methods:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mi>P</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <log></log>
     <ci>P</ci>
    </apply>
    <ci>𝐗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log P(\mathbf{X})
  </annotation>
 </semantics>
</math>

. The lower bound 

<math display="inline" id="Variational_Bayesian_methods:25">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Q</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℒ</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(Q)
  </annotation>
 </semantics>
</math>

 is known as the (negative) <em>variational <a href="Thermodynamic_free_energy" title="wikilink">free energy</a></em> because it can also be expressed as an "energy" 

<math display="inline" id="Variational_Bayesian_methods:26">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mi>Q</mi>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mrow>
      <mi>log</mi>
      <mi>P</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo>,</mo>
      <mi>𝐗</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <ci>Q</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <log></log>
      <ci>P</ci>
     </apply>
     <interval closure="open">
      <ci>𝐙</ci>
      <ci>𝐗</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{Q}[\log P(\mathbf{Z},\mathbf{X})]
  </annotation>
 </semantics>
</math>

 plus the entropy of 

<math display="inline" id="Variational_Bayesian_methods:27">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="in-practice">In practice</h2>

<p>The variational distribution 

<math display="inline" id="Variational_Bayesian_methods:28">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Q</ci>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(\mathbf{Z})
  </annotation>
 </semantics>
</math>

 is usually assumed to factorize over some <a href="partition_of_a_set" title="wikilink">partition</a> of the latent variables, i.e. for some partition of the latent variables 

<math display="inline" id="Variational_Bayesian_methods:29">
 <semantics>
  <mi>𝐙</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐙</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}
  </annotation>
 </semantics>
</math>

 into 

<math display="inline" id="Variational_Bayesian_methods:30">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐙</mi>
    <mn>1</mn>
   </msub>
   <mi mathvariant="normal">…</mi>
   <msub>
    <mi>𝐙</mi>
    <mi>M</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐙</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐙</ci>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}_{1}\dots\mathbf{Z}_{M}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Variational_Bayesian_methods:31">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>M</mi>
   </munderover>
   <msub>
    <mi>q</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐙</mi>
     <mi>i</mi>
    </msub>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Q</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>M</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>i</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐙</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(\mathbf{Z})=\prod_{i=1}^{M}q_{i}(\mathbf{Z}_{i}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

</p>

<p>It can be shown using the <a href="calculus_of_variations" title="wikilink">calculus of variations</a> (hence the name "variational Bayes") that the "best" distribution 

<math display="inline" id="Variational_Bayesian_methods:32">
 <semantics>
  <msubsup>
   <mi>q</mi>
   <mi>j</mi>
   <mo>*</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>j</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{j}^{*}
  </annotation>
 </semantics>
</math>

 for each of the factors 

<math display="inline" id="Variational_Bayesian_methods:33">
 <semantics>
  <msub>
   <mi>q</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{j}
  </annotation>
 </semantics>
</math>

 (in terms of the distribution minimizing the KL divergence, as described above) can be expressed as:</p>

<p>

<math display="block" id="Variational_Bayesian_methods:34">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>j</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐙</mi>
     <mi>j</mi>
    </msub>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <msub>
       <mo>E</mo>
       <mrow>
        <mi>i</mi>
        <mo>≠</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mi>ln</mi>
         <mi>p</mi>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>𝐙</mi>
         <mo>,</mo>
         <mi>𝐗</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mi>e</mi>
        <mrow>
         <msub>
          <mo>E</mo>
          <mrow>
           <mi>i</mi>
           <mo>≠</mo>
           <mi>j</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mi>ln</mi>
            <mi>p</mi>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>𝐙</mi>
            <mo>,</mo>
            <mi>𝐗</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </msup>
      </mpadded>
      <mi>d</mi>
      <msub>
       <mi>𝐙</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>j</ci>
     </apply>
     <times></times>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐙</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-E</ci>
        <apply>
         <neq></neq>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ln></ln>
         <ci>p</ci>
        </apply>
        <interval closure="open">
         <ci>𝐙</ci>
         <ci>𝐗</ci>
        </interval>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-E</ci>
          <apply>
           <neq></neq>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <ln></ln>
           <ci>p</ci>
          </apply>
          <interval closure="open">
           <ci>𝐙</ci>
           <ci>𝐗</ci>
          </interval>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐙</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})=\frac{e^{\operatorname{E}_{i\neq j}[%
\ln p(\mathbf{Z},\mathbf{X})]}}{\int e^{\operatorname{E}_{i\neq j}[\ln p(%
\mathbf{Z},\mathbf{X})]}\,d\mathbf{Z}_{j}}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Variational_Bayesian_methods:35">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mrow>
     <mi>i</mi>
     <mo>≠</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo>,</mo>
      <mi>𝐗</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <apply>
      <neq></neq>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>p</ci>
     </apply>
     <interval closure="open">
      <ci>𝐙</ci>
      <ci>𝐗</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{i\neq j}[\ln p(\mathbf{Z},\mathbf{X})]
  </annotation>
 </semantics>
</math>

 is the <a href="expected_value" title="wikilink">expectation</a> of the logarithm of the <a href="joint_probability" title="wikilink">joint probability</a> of the data and latent variables, taken over all variables not in the partition.</p>

<p>In practice, we usually work in terms of logarithms, i.e.:</p>

<p>

<math display="block" id="Variational_Bayesian_methods:36">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <msubsup>
    <mi>q</mi>
    <mi>j</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐙</mi>
     <mi>j</mi>
    </msub>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo>E</mo>
    <mrow>
     <mi>i</mi>
     <mo>≠</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>ln</mi>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐙</mi>
     <mo>,</mo>
     <mi>𝐗</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>+</mo>
   <mtext>constant</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ln></ln>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>j</ci>
     </apply>
     <times></times>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐙</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <apply>
      <neq></neq>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <ln></ln>
     <csymbol cd="unknown">p</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Z</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
    <plus></plus>
    <mtext>constant</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})=\operatorname{E}_{i\neq j}[\ln p(%
\mathbf{Z},\mathbf{X})]+\text{constant}
  </annotation>
 </semantics>
</math>

</p>

<p>The constant in the above expression is related to the <a href="normalizing_constant" title="wikilink">normalizing constant</a> (the denominator in the expression above for 

<math display="inline" id="Variational_Bayesian_methods:37">
 <semantics>
  <msubsup>
   <mi>q</mi>
   <mi>j</mi>
   <mo>*</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>j</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{j}^{*}
  </annotation>
 </semantics>
</math>

) and is usually reinstated by inspection, as the rest of the expression can usually be recognized as being a known type of distribution (e.g. <a href="Gaussian_distribution" title="wikilink">Gaussian</a>, <a href="gamma_distribution" title="wikilink">gamma</a>, etc.).</p>

<p>Using the properties of expectations, the expression 

<math display="inline" id="Variational_Bayesian_methods:38">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mrow>
     <mi>i</mi>
     <mo>≠</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐙</mi>
      <mo>,</mo>
      <mi>𝐗</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <apply>
      <neq></neq>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>p</ci>
     </apply>
     <interval closure="open">
      <ci>𝐙</ci>
      <ci>𝐗</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{i\neq j}[\ln p(\mathbf{Z},\mathbf{X})]
  </annotation>
 </semantics>
</math>

 can usually be simplified into a function of the fixed <a href="hyperparameter" title="wikilink">hyperparameters</a> of the <a href="prior_distribution" title="wikilink">prior distributions</a> over the latent variables and of expectations (and sometimes higher <a href="moment_(mathematics)" title="wikilink">moments</a> such as the <a class="uri" href="variance" title="wikilink">variance</a>) of latent variables not in the current partition (i.e. latent variables not included in 

<math display="inline" id="Variational_Bayesian_methods:39">
 <semantics>
  <msub>
   <mi>𝐙</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐙</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}_{j}
  </annotation>
 </semantics>
</math>

). This creates <a href="circular_dependency" title="wikilink">circular dependencies</a> between the parameters of the distributions over variables in one partition and the expectations of variables in the other partitions. This naturally suggests an <a class="uri" href="iterative" title="wikilink">iterative</a> algorithm, much like EM (the <a class="uri" href="expectation-maximization" title="wikilink">expectation-maximization</a> algorithm), in which the expectations (and possibly higher moments) of the latent variables are initialized in some fashion (perhaps randomly), and then the parameters of each distribution are computed in turn using the current values of the expectations, after which the expectation of the newly computed distribution is set appropriately according to the computed parameters. An algorithm of this sort is guaranteed to <a href="limit_of_a_sequence" title="wikilink">converge</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Furthermore, if the distributions in question are part of the <a href="exponential_family" title="wikilink">exponential family</a>, which is usually the case, convergence will be to a <a href="global_maximum" title="wikilink">global maximum</a>, since the exponential family is <a href="convex_function" title="wikilink">convex</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>In other words, for each of the partitions of variables, by simplifying the expression for the distribution over the partition's variables and examining the distribution's functional dependency on the variables in question, the family of the distribution can usually be determined (which in turn determines the value of the constant). The formula for the distribution's parameters will be expressed in terms of the prior distributions' hyperparameters (which are known constants), but also in terms of expectations of functions of variables in other partitions. Usually these expectations can be simplified into functions of expectations of the variables themselves (i.e. the <a href="mean" title="wikilink">means</a>); sometimes expectations of squared variables (which can be related to the <a class="uri" href="variance" title="wikilink">variance</a> of the variables), or expectations of higher powers (i.e. higher <a href="moment_(mathematics)" title="wikilink">moments</a>) also appear. In most cases, the other variables' distributions will be from known families, and the formulas for the relevant expectations can be looked up. However, those formulas depend on those distributions' parameters, which depend in turn on the expectations about other variables. The result is that the formulas for the parameters of each variable's distributions can be expressed as a series of equations with mutual, <a class="uri" href="nonlinear" title="wikilink">nonlinear</a> dependencies among the variables. Usually, it is not possible to solve this system of equations directly. However, as described above, the dependencies suggest a simple iterative algorithm, which in most cases is guaranteed to converge. An example will make this process clearer.</p>
<h2 id="a-basic-example">A basic example</h2>

<p>Consider a simple non-hierarchical Bayesian model consisting of a set of <a href="independent_identically_distributed" title="wikilink">i.i.d.</a> observations from a <a href="Gaussian_distribution" title="wikilink">Gaussian distribution</a>, with unknown <a class="uri" href="mean" title="wikilink">mean</a> and <a class="uri" href="variance" title="wikilink">variance</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In the following, we work through this model in great detail to illustrate the workings of the variational Bayes method.</p>

<p>For mathematical convenience, in the following example we work in terms of the <a href="precision_(statistics)" title="wikilink">precision</a> — i.e. the reciprocal of the variance (or in a multivariate Gaussian, the inverse of the <a href="covariance_matrix" title="wikilink">covariance matrix</a>) — rather than the variance itself. (From a theoretical standpoint, precision and variance are equivalent since there is a <a href="one-to-one_correspondence" title="wikilink">one-to-one correspondence</a> between the two.)</p>
<h3 id="the-mathematical-model">The mathematical model</h3>

<p>We place <a href="conjugate_prior" title="wikilink">conjugate prior</a> distributions on the unknown mean and variance, i.e. the mean also follows a Gaussian distribution while the precision follows a <a href="gamma_distribution" title="wikilink">gamma distribution</a>. In other words:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:40">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mu
  </annotation>
 </semantics>
</math>


</p>

<p>We are given 

<math display="inline" id="Variational_Bayesian_methods:41">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 data points 

<math display="inline" id="Variational_Bayesian_methods:42">
 <semantics>
  <mrow>
   <mi>𝐗</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐗</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>N</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\{x_{1},\dots,x_{N}\}
  </annotation>
 </semantics>
</math>

 and our goal is to infer the <a href="posterior_distribution" title="wikilink">posterior distribution</a> 

<math display="inline" id="Variational_Bayesian_methods:43">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo>∣</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>N</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(\mu,\tau)=p(\mu,\tau\mid x_{1},\ldots,x_{N})
  </annotation>
 </semantics>
</math>

 of the parameters 

<math display="inline" id="Variational_Bayesian_methods:44">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:45">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

.</p>

<p>The <a href="hyperparameter" title="wikilink">hyperparameters</a> 

<math display="inline" id="Variational_Bayesian_methods:46">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{0}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:47">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{0}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:48">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:49">
 <semantics>
  <msub>
   <mi>b</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{0}
  </annotation>
 </semantics>
</math>

 are fixed, given values. They can be set to small positive numbers to give broad prior distributions indicating ignorance about the prior distributions of 

<math display="inline" id="Variational_Bayesian_methods:50">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:51">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="the-joint-probability">The joint probability</h3>

<p>The <a href="joint_probability" title="wikilink">joint probability</a> of all variables can be rewritten as</p>

<p>

<math display="block" id="Variational_Bayesian_methods:52">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo>∣</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo>∣</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{X},\mu,\tau)=p(\mathbf{X}\mid\mu,\tau)p(\mu\mid\tau)p(\tau)
  </annotation>
 </semantics>
</math>

</p>

<p>where the individual factors are</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:53">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo>∣</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">τ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(\mathbf{X}\mid\mu,\tau)
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:54">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒩</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>∣</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">N</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathcal{N}(x\mid\mu,\sigma^{2})
  </annotation>
 </semantics>
</math>


</p>
<h3 id="factorized-approximation">Factorized approximation</h3>

<p>Assume that 

<math display="inline" id="Variational_Bayesian_methods:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <mi>τ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>τ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>q</ci>
     <interval closure="open">
      <ci>μ</ci>
      <ci>τ</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>μ</ci>
     <ci>q</ci>
     <ci>τ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(\mu,\tau)=q(\mu)q(\tau)
  </annotation>
 </semantics>
</math>

, i.e. that the posterior distribution factorizes into independent factors for 

<math display="inline" id="Variational_Bayesian_methods:56">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Variational_Bayesian_methods:57">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

. This type of assumption underlies the variational Bayesian method. The true posterior distribution does not in fact factor this way (in fact, in this simple case, it is known to be a <a href="Gaussian-gamma_distribution" title="wikilink">Gaussian-gamma distribution</a>), and hence the result we obtain will be an approximation.</p>
<h3 id="derivation-of-qμ">Derivation of q(μ)</h3>

<p>Then</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:58">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msubsup>
     <mi>q</mi>
     <mi>μ</mi>
     <mo>*</mo>
    </msubsup>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>μ</ci>
      </apply>
      <times></times>
     </apply>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln q_{\mu}^{*}(\mu)
  </annotation>
 </semantics>
</math>


</p>

<p>In the above derivation, 

<math display="inline" id="Variational_Bayesian_methods:59">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:60">
 <semantics>
  <msub>
   <mi>C</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:61">
 <semantics>
  <msub>
   <mi>C</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{3}
  </annotation>
 </semantics>
</math>

 refer to values that are constant with respect to 

<math display="inline" id="Variational_Bayesian_methods:62">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

. Note that the term 

<math display="inline" id="Variational_Bayesian_methods:63">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mi>τ</mi>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <ci>τ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>p</ci>
     </apply>
     <ci>τ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{\tau}[\ln p(\tau)]
  </annotation>
 </semantics>
</math>

 is not a function of 

<math display="inline" id="Variational_Bayesian_methods:64">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and will have the same value regardless of the value of 

<math display="inline" id="Variational_Bayesian_methods:65">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

. Hence in line 3 we can absorb it into the constant term at the end. We do the same thing in line 7.</p>

<p>The last line is simply a quadratic polynomial in 

<math display="inline" id="Variational_Bayesian_methods:66">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

. Since this is the logarithm of 

<math display="inline" id="Variational_Bayesian_methods:67">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>μ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>μ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{\mu}^{*}(\mu)
  </annotation>
 </semantics>
</math>

, we can see that 

<math display="inline" id="Variational_Bayesian_methods:68">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>μ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>μ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{\mu}^{*}(\mu)
  </annotation>
 </semantics>
</math>

 itself is a <a href="Gaussian_distribution" title="wikilink">Gaussian distribution</a>.</p>

<p>With a certain amount of tedious math (expanding the squares inside of the braces, separating out and grouping the terms involving 

<math display="inline" id="Variational_Bayesian_methods:69">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:70">
 <semantics>
  <msup>
   <mi>μ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>μ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu^{2}
  </annotation>
 </semantics>
</math>

 and <a href="completing_the_square" title="wikilink">completing the square</a> over 

<math display="inline" id="Variational_Bayesian_methods:71">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

), we can derive the parameters of the Gaussian distribution:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:72">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msubsup>
     <mi>q</mi>
     <mi>μ</mi>
     <mo>*</mo>
    </msubsup>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>μ</ci>
      </apply>
      <times></times>
     </apply>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln q_{\mu}^{*}(\mu)
  </annotation>
 </semantics>
</math>


</p>

<p>Note that all of the above steps can be shortened by using the formula for the <a href="Normal_distribution#Sum_of_two_quadratics" title="wikilink">sum of two quadratics</a>.</p>

<p>In other words:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:73">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>μ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>μ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle q_{\mu}^{*}(\mu)
  </annotation>
 </semantics>
</math>


</p>
<h3 id="derivation-of-qτ">Derivation of q(τ)</h3>

<p>The derivation of 

<math display="inline" id="Variational_Bayesian_methods:74">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>τ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>τ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{\tau}^{*}(\tau)
  </annotation>
 </semantics>
</math>

 is similar to above, although we omit some of the details for the sake of brevity.</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:75">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msubsup>
     <mi>q</mi>
     <mi>τ</mi>
     <mo>*</mo>
    </msubsup>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>τ</ci>
      </apply>
      <times></times>
     </apply>
    </apply>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln q_{\tau}^{*}(\tau)
  </annotation>
 </semantics>
</math>


</p>

<p>Exponentiating both sides, we can see that 

<math display="inline" id="Variational_Bayesian_methods:76">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>τ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>τ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{\tau}^{*}(\tau)
  </annotation>
 </semantics>
</math>

 is a <a href="gamma_distribution" title="wikilink">gamma distribution</a>. Specifically:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:77">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>τ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>τ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle q_{\tau}^{*}(\tau)
  </annotation>
 </semantics>
</math>


</p>
<h3 id="algorithm-for-computing-the-parameters">Algorithm for computing the parameters</h3>

<p>Let us recap the conclusions from the previous sections:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:78">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>μ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>μ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle q_{\mu}^{*}(\mu)
  </annotation>
 </semantics>
</math>


</p>

<p>and</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:79">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>τ</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>τ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>τ</ci>
     </apply>
     <times></times>
    </apply>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle q_{\tau}^{*}(\tau)
  </annotation>
 </semantics>
</math>


</p>

<p>In each case, the parameters for the distribution over one of the variables depend on expectations taken with respect to the other variable. We can expand the expectations, using the standard formulas for the expectations of moments of the Gaussian and gamma distributions:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:80">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>τ</mi>
    <mo>∣</mo>
    <msub>
     <mi>a</mi>
     <mi>N</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>b</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <ci>τ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{E}[\tau\mid a_{N},b_{N}]
  </annotation>
 </semantics>
</math>


</p>

<p>Applying these formulas to the above equations is trivial in most cases, but the equation for 

<math display="inline" id="Variational_Bayesian_methods:81">
 <semantics>
  <msub>
   <mi>b</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{N}
  </annotation>
 </semantics>
</math>

 takes more work:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:82">
 <semantics>
  <msub>
   <mi>b</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle b_{N}
  </annotation>
 </semantics>
</math>


</p>

<p>We can then write the parameter equations as follows, without any expectations:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:83">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mu_{N}
  </annotation>
 </semantics>
</math>


</p>

<p>Note that there are circular dependencies among the formulas for 

<math display="inline" id="Variational_Bayesian_methods:84">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{N}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:85">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{N}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:86">
 <semantics>
  <msub>
   <mi>b</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{N}
  </annotation>
 </semantics>
</math>

. This naturally suggests an <a href="expectation-maximization_algorithm" title="wikilink">EM</a>-like algorithm:</p>
<ol>
<li>Compute 

<math display="inline" id="Variational_Bayesian_methods:87">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>n</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </msubsup>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n=1}^{N}x_{n}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:88">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </msubsup>
    <msubsup>
     <mi>x</mi>
     <mi>n</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n=1}^{N}x_{n}^{2}.
  </annotation>
 </semantics>
</math>

 Use these values to compute 

<math display="inline" id="Variational_Bayesian_methods:89">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{N}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:90">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>N</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{N}.
  </annotation>
 </semantics>
</math>

</li>
<li>Initialize 

<math display="inline" id="Variational_Bayesian_methods:91">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{N}
  </annotation>
 </semantics>
</math>

 to some arbitrary value.</li>
<li>Use the current value of 

<math display="inline" id="Variational_Bayesian_methods:92">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mi>N</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{N},
  </annotation>
 </semantics>
</math>

 along with the known values of the other parameters, to compute 

<math display="inline" id="Variational_Bayesian_methods:93">
 <semantics>
  <msub>
   <mi>b</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{N}
  </annotation>
 </semantics>
</math>

.</li>
<li>Use the current value of 

<math display="inline" id="Variational_Bayesian_methods:94">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mi>N</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{N},
  </annotation>
 </semantics>
</math>

 along with the known values of the other parameters, to compute 

<math display="inline" id="Variational_Bayesian_methods:95">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{N}
  </annotation>
 </semantics>
</math>

.</li>
<li>Repeat the last two steps until convergence (i.e. until neither value has changed more than some small amount).</li>
</ol>

<p>We then have values for the hyperparameters of the approximating distributions of the posterior parameters, which we can use to compute any properties we want of the posterior — e.g. its mean and variance, a 95% highest-density region (the smallest interval that includes 95% of the total probability), etc.</p>

<p>It can be shown that this algorithm is guaranteed to converge to a local maximum, and since both posterior distributions are in the <a href="exponential_family" title="wikilink">exponential family</a>, this local maximum will be a <a href="global_maximum" title="wikilink">global maximum</a>.</p>

<p>Note also that the posterior distributions have the same form as the corresponding prior distributions. We did <em>not</em> assume this; the only assumption we made was that the distributions factorize, and the form of the distributions followed naturally. It turns out (see below) that the fact that the posterior distributions have the same form as the prior distributions is not a coincidence, but a general result whenever the prior distributions are members of the <a href="exponential_family" title="wikilink">exponential family</a>, which is the case for most of the standard distributions.</p>
<h2 id="further-discussion">Further discussion</h2>
<h3 id="step-by-step-recipe">Step-by-step recipe</h3>

<p>The above example shows the method by which the variational-Bayesian approximation to a <a href="posterior_probability" title="wikilink">posterior probability</a> density in a given <a href="Bayesian_network" title="wikilink">Bayesian network</a> is derived:</p>
<ol>
<li>Describe the network with a <a href="graphical_model" title="wikilink">graphical model</a>, identifying the observed variables (data) 

<math display="inline" id="Variational_Bayesian_methods:96">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 and unobserved variables (<a href="parameter" title="wikilink">parameters</a> 

<math display="inline" id="Variational_Bayesian_methods:97">
 <semantics>
  <mi>𝚯</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝚯</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Theta}
  </annotation>
 </semantics>
</math>

 and <a href="latent_variable" title="wikilink">latent variables</a> 

<math display="inline" id="Variational_Bayesian_methods:98">
 <semantics>
  <mi>𝐙</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐙</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}
  </annotation>
 </semantics>
</math>

) and their <a href="conditional_probability_distribution" title="wikilink">conditional probability distributions</a>. Variational Bayes will then construct an approximation to the posterior probability 

<math display="inline" id="Variational_Bayesian_methods:99">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>,</mo>
    <mi>𝚯</mi>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Θ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{Z},\boldsymbol{\Theta}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

. The approximation has the basic property that it is a factorized distribution, i.e. a product of two or more <a href="statistical_independence" title="wikilink">independent</a> distributions over disjoint subsets of the unobserved variables.</li>
<li>Partition the unobserved variables into two or more subsets, over which the independent factors will be derived. There is no universal procedure for doing this; creating too many subsets yields a poor approximation, while creating too few makes the entire variational Bayes procedure intractable. Typically, the first split is to separate the parameters and latent variables; often, this is enough by itself to produce a tractable result. Assume that the partitions are called 

<math display="inline" id="Variational_Bayesian_methods:100">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐙</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>𝐙</mi>
    <mi>M</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐙</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐙</ci>
     <ci>M</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}_{1},\ldots,\mathbf{Z}_{M}
  </annotation>
 </semantics>
</math>

.</li>
<li>For a given partition 

<math display="inline" id="Variational_Bayesian_methods:101">
 <semantics>
  <msub>
   <mi>𝐙</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐙</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}_{j}
  </annotation>
 </semantics>
</math>

, write down the formula for the best approximating distribution 

<math display="inline" id="Variational_Bayesian_methods:102">
 <semantics>
  <mrow>
   <msubsup>
    <mi>q</mi>
    <mi>j</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐙</mi>
     <mi>j</mi>
    </msub>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>j</ci>
     </apply>
     <times></times>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐙</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

 using the basic equation 

<math display="inline" id="Variational_Bayesian_methods:103">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <msubsup>
    <mi>q</mi>
    <mi>j</mi>
    <mo>*</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐙</mi>
     <mi>j</mi>
    </msub>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo>E</mo>
    <mrow>
     <mi>i</mi>
     <mo>≠</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>ln</mi>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐙</mi>
     <mo>,</mo>
     <mi>𝐗</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>+</mo>
   <mtext>constant</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ln></ln>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <ci>j</ci>
     </apply>
     <times></times>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐙</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <apply>
      <neq></neq>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <ln></ln>
     <csymbol cd="unknown">p</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Z</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
    <plus></plus>
    <mtext>constant</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln q_{j}^{*}(\mathbf{Z}_{j}\mid\mathbf{X})=\operatorname{E}_{i\neq j}[\ln p(%
\mathbf{Z},\mathbf{X})]+\text{constant}
  </annotation>
 </semantics>
</math>

 .</li>
<li>Fill in the formula for the <a href="joint_probability" title="wikilink">joint probability</a> distribution using the graphical model. Any component conditional distributions that don't involve any of the variables in 

<math display="inline" id="Variational_Bayesian_methods:104">
 <semantics>
  <msub>
   <mi>𝐙</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐙</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}_{j}
  </annotation>
 </semantics>
</math>

 can be ignored; they will be folded into the constant term.</li>
<li>Simplify the formula and apply the expectation operator, following the above example. Ideally, this should simplify into expectations of basic functions of variables not in 

<math display="inline" id="Variational_Bayesian_methods:105">
 <semantics>
  <msub>
   <mi>𝐙</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐙</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}_{j}
  </annotation>
 </semantics>
</math>

 (e.g. first or second raw <a href="moment_(mathematics)" title="wikilink">moments</a>, expectation of a logarithm, etc.). In order for the variational Bayes procedure to work well, these expectations should generally be expressible analytically as functions of the parameters and/or <a href="hyperparameter" title="wikilink">hyperparameters</a> of the distributions of these variables. In all cases, these expectation terms are constants with respect to the variables in the current partition.</li>
<li>The functional form of the formula with respect to the variables in the current partition indicates the type of distribution. In particular, exponentiating the formula generates the <a href="probability_density_function" title="wikilink">probability density function</a> (PDF) of the distribution (or at least, something proportional to it, with unknown <a href="normalization_constant" title="wikilink">normalization constant</a>). In order for the overall method to be tractable, it should be possible to recognize the functional form as belonging to a known distribution. Significant mathematical manipulation may be required to convert the formula into a form that matches the PDF of a known distribution. When this can be done, the normalization constant can be reinstated by definition, and equations for the parameters of the known distribution can be derived by extracting the appropriate parts of the formula.</li>
<li>When all expectations can be replaced analytically with functions of variables not in the current partition, and the PDF put into a form that allows identification with a known distribution, the result is a set of equations expressing the values of the optimum parameters as functions of the parameters of variables in other partitions.</li>
<li>When this procedure can be applied to all partitions, the result is a set of mutually linked equations specifying the optimum values of all parameters.</li>
<li>An <a href="expectation_maximization" title="wikilink">expectation maximization</a> (EM) type procedure is then applied, picking an initial value for each parameter and the iterating through a series of steps, where at each step we cycle through the equations, updating each parameter in turn. This is guaranteed to converge.</li>
</ol>
<h3 id="most-important-points">Most important points</h3>

<p>Due to all of the mathematical manipulations involved, it is easy to lose track of the big picture. The important things are:</p>
<ol>
<li>The idea of variational Bayes is to construct an analytical approximation to the <a href="posterior_probability" title="wikilink">posterior probability</a> of the set of unobserved variables (parameters and latent variables), given the data. This means that the form of the solution is similar to other <a href="Bayesian_inference" title="wikilink">Bayesian inference</a> methods, such as <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a> — i.e. a distribution that seeks to describe everything that is known about the variables. As in other Bayesian methods — but unlike e.g. in <a href="expectation_maximization" title="wikilink">expectation maximization</a> (EM) or other <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> methods — both types of unobserved variables (i.e. parameters and latent variables) are treated the same, i.e. as <a href="random_variable" title="wikilink">random variables</a>. Estimates for the variables can then be derived in the standard Bayesian ways, e.g. calculating the mean of the distribution to get a single point estimate or deriving a <a href="credible_interval" title="wikilink">credible interval</a>, highest density region, etc.</li>
<li>"Analytical approximation" means that a formula can be written down for the posterior distribution. The formula generally consists of a product of well-known probability distributions, each of which <em>factorizes</em> over a set of unobserved variables (i.e. it is <a href="conditionally_independent" title="wikilink">conditionally independent</a> of the other variables, given the observed data). This formula is not the true posterior distribution, but an approximation to it; in particular, it will generally agree fairly closely in the lowest <a href="moment_(mathematics)" title="wikilink">moments</a> of the unobserved variables, e.g. the <a class="uri" href="mean" title="wikilink">mean</a> and <a class="uri" href="variance" title="wikilink">variance</a>.</li>
<li>The result of all of the mathematical manipulations is (1) the identity of the probability distributions making up the factors, and (2) mutually dependent formulas for the parameters of these distributions. The actual values of these parameters are computed numerically, through an alternating iterative procedure much like EM.</li>
</ol>
<h3 id="compared-with-expectation-maximization-em">Compared with expectation maximization (EM)</h3>

<p>Variational Bayes (VB) is often compared with <a href="expectation_maximization" title="wikilink">expectation maximization</a> (EM). The actual numerical procedure is quite similar, in that both are alternating iterative procedures that successively converge on optimum parameter values. The initial steps to derive the respective procedures are also vaguely similar, both starting out with formulas for probability densities and both involving significant amounts of mathematical manipulations.</p>

<p>However, there are a number of differences. Most important is <em>what</em> is being computed.</p>
<ul>
<li>EM computes point estimates of posterior distribution of those random variables that can be categorized as "parameters", but estimates of the actual posterior distributions of the latent variables (at least in "soft EM", and often only when the latent variables are discrete). The point estimates computed are the <a href="mode_(statistics)" title="wikilink">modes</a> of these parameters; no other information is available.</li>
<li>VB, on the other hand, computes estimates of the actual posterior distribution of all variables, both parameters and latent variables. When point estimates need to be derived, generally the <a class="uri" href="mean" title="wikilink">mean</a> is used rather than the mode, as is normal in Bayesian inference. Concomitant with this, it should be noted that the parameters computed in VB do <em>not</em> have the same significance as those in EM. EM computes optimum values of the parameters of the Bayes network itself. VB computes optimum values of the parameters of the distributions used to approximate the parameters and latent variables of the Bayes network. For example, a typical Gaussian <a href="mixture_model" title="wikilink">mixture model</a> will have parameters for the mean and variance of each of the mixture components. EM would directly estimate optimum values for these parameters. VB, however, would first fit a distribution to these parameters — typically in the form of a <a href="prior_distribution" title="wikilink">prior distribution</a>, e.g. a <a href="normal-scaled_inverse_gamma_distribution" title="wikilink">normal-scaled inverse gamma distribution</a> — and would then compute values for the parameters of this prior distribution, i.e. essentially <a class="uri" href="hyperparameters" title="wikilink">hyperparameters</a>. In this case, VB would compute optimum estimates of the four parameters of the normal-scaled inverse gamma distribution that describes the joint distribution of the mean and variance of the component.</li>
</ul>

<p><br/>
==A more complex example==  Imagine a Bayesian <a href="Gaussian_mixture_model" title="wikilink">Gaussian mixture model</a> described as follows:<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="inline" id="Variational_Bayesian_methods:106">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{\pi}
  </annotation>
 </semantics>
</math>


</p>

<p>Note:</p>
<ul>
<li>SymDir() is the symmetric <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a> of dimension 

<math display="inline" id="Variational_Bayesian_methods:107">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

, with the hyperparameter for each component set to 

<math display="inline" id="Variational_Bayesian_methods:108">
 <semantics>
  <msub>
   <mi>α</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{0}
  </annotation>
 </semantics>
</math>

. The Dirichlet distribution is the <a href="conjugate_prior" title="wikilink">conjugate prior</a> of the <a href="categorical_distribution" title="wikilink">categorical distribution</a> or <a href="multinomial_distribution" title="wikilink">multinomial distribution</a>.</li>
<li>

<math display="inline" id="Variational_Bayesian_methods:109">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒲</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒲</ci>
    <list></list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{W}()
  </annotation>
 </semantics>
</math>

 is the <a href="Wishart_distribution" title="wikilink">Wishart distribution</a>, which is the conjugate prior of the <a href="precision_matrix" title="wikilink">precision matrix</a> (inverse <a href="covariance_matrix" title="wikilink">covariance matrix</a>) for a <a href="multivariate_Gaussian_distribution" title="wikilink">multivariate Gaussian distribution</a>.</li>
<li>Mult() is a <a href="multinomial_distribution" title="wikilink">multinomial distribution</a> over a single observation (equivalent to a <a href="categorical_distribution" title="wikilink">categorical distribution</a>). The state space is a "one-of-K" representation, i.e. a 

<math display="inline" id="Variational_Bayesian_methods:110">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

-dimensional vector in which one of the elements is 1 (specifying the identity of the observation) and all other elements are 0.</li>
<li>

<math display="inline" id="Variational_Bayesian_methods:111">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒩</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒩</ci>
    <list></list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}()
  </annotation>
 </semantics>
</math>

 is the <a href="Gaussian_distribution" title="wikilink">Gaussian distribution</a>, in this case specifically the <a href="multivariate_Gaussian_distribution" title="wikilink">multivariate Gaussian distribution</a>.</li>
</ul>

<p>The interpretation of the above variables is as follows:</p>
<ul>
<li>

<math display="inline" id="Variational_Bayesian_methods:112">
 <semantics>
  <mrow>
   <mi>𝐗</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>𝐱</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>𝐱</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐗</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <ci>N</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\{\mathbf{x}_{1},\dots,\mathbf{x}_{N}\}
  </annotation>
 </semantics>
</math>

 is the set of 

<math display="inline" id="Variational_Bayesian_methods:113">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 data points, each of which is a 

<math display="inline" id="Variational_Bayesian_methods:114">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

-dimensional vector distributed according to a <a href="multivariate_Gaussian_distribution" title="wikilink">multivariate Gaussian distribution</a>.</li>
<li>

<math display="inline" id="Variational_Bayesian_methods:115">
 <semantics>
  <mrow>
   <mi>𝐙</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>𝐳</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>𝐳</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐙</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐳</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐳</ci>
      <ci>N</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Z}=\{\mathbf{z}_{1},\dots,\mathbf{z}_{N}\}
  </annotation>
 </semantics>
</math>

 is a set of latent variables, one per data point, specifying which mixture component the corresponding data point belongs to, using a "one-of-K" vector representation with components 

<math display="inline" id="Variational_Bayesian_methods:116">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{nk}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Variational_Bayesian_methods:117">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">…</mi>
    <mi>K</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1\dots K
  </annotation>
 </semantics>
</math>

, as described above.</li>
<li>

<math display="inline" id="Variational_Bayesian_methods:118">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\pi}
  </annotation>
 </semantics>
</math>

 is the mixing proportions for the 

<math display="inline" id="Variational_Bayesian_methods:119">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 mixture components.</li>
<li>

<math display="inline" id="Variational_Bayesian_methods:120">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mi mathvariant="normal">…</mi>
     <mi>K</mi>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\mu}_{i=1\dots K}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:121">
 <semantics>
  <msub>
   <mi>𝚲</mi>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mi mathvariant="normal">…</mi>
     <mi>K</mi>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝚲</ci>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\Lambda}_{i=1\dots K}
  </annotation>
 </semantics>
</math>

 specify the parameters (<a class="uri" href="mean" title="wikilink">mean</a> and <a href="precision_(statistics)" title="wikilink">precision</a>) associated with each mixture component.</li>
</ul>

<p>The joint probability of all variables can be rewritten as</p>

<p>

<math display="block" id="Variational_Bayesian_methods:122">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo>,</mo>
    <mi>𝐙</mi>
    <mo>,</mo>
    <mi>π</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>𝚲</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo>∣</mo>
    <mi>𝐙</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>𝚲</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>∣</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>μ</mi>
    <mo>∣</mo>
    <mi>𝚲</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝚲</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">π</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">Λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{X},\mathbf{Z},\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})=p(\mathbf{%
X}\mid\mathbf{Z},\mathbf{\mu},\mathbf{\Lambda})p(\mathbf{Z}\mid\mathbf{\pi})p(%
\mathbf{\pi})p(\mathbf{\mu}\mid\mathbf{\Lambda})p(\mathbf{\Lambda})
  </annotation>
 </semantics>
</math>

</p>

<p>where the individual factors are</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:123">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐗</mi>
    <mo>∣</mo>
    <mi>𝐙</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>𝚲</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(\mathbf{X}\mid\mathbf{Z},\mathbf{\mu},\mathbf{\Lambda})
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:124">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒩</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐱</mi>
    <mo>∣</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>𝚺</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">N</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">μ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Σ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathcal{N}(\mathbf{x}\mid\mathbf{\mu},\mathbf{\Sigma})
  </annotation>
 </semantics>
</math>


</p>

<p>Assume that 

<math display="inline" id="Variational_Bayesian_methods:125">
 <semantics>
  <mrow>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐙</mi>
     <mo>,</mo>
     <mi>π</mi>
     <mo>,</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <mi>𝚲</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐙</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>π</mi>
     <mo>,</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <mi>𝚲</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>q</ci>
     <vector>
      <ci>𝐙</ci>
      <ci>π</ci>
      <ci>μ</ci>
      <ci>𝚲</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>𝐙</ci>
     <ci>q</ci>
     <vector>
      <ci>π</ci>
      <ci>μ</ci>
      <ci>𝚲</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(\mathbf{Z},\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})=q(\mathbf{Z})q(%
\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})
  </annotation>
 </semantics>
</math>

.</p>

<p>Then</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:126">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msup>
     <mi>q</mi>
     <mo>*</mo>
    </msup>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <times></times>
     </apply>
    </apply>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln q^{*}(\mathbf{Z})
  </annotation>
 </semantics>
</math>


</p>

<p>where we have defined</p>

<p>

<math display="block" id="Variational_Bayesian_methods:127">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msub>
     <mi>ρ</mi>
     <mrow>
      <mi>n</mi>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>ln</mi>
        <msub>
         <mi>π</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo stretchy="false">|</mo>
          <msub>
           <mi>𝚲</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">|</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>D</mi>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mi>ln</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <msub>
       <mo>E</mo>
       <mrow>
        <msub>
         <mi>μ</mi>
         <mi>k</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>𝚲</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>𝐱</mi>
            <mi>n</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>μ</mi>
            <mi>k</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi mathvariant="normal">T</mi>
        </msup>
        <msub>
         <mi>𝚲</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>𝐱</mi>
           <mi>n</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>μ</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <ln></ln>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>π</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <ci>normal-E</ci>
        <apply>
         <ln></ln>
         <apply>
          <abs></abs>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝚲</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>D</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-E</ci>
        <list>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝚲</ci>
          <ci>k</ci>
         </apply>
        </list>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐱</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>μ</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝚲</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐱</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>μ</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln\rho_{nk}=\operatorname{E}[\ln\pi_{k}]+\frac{1}{2}\operatorname{E}[\ln|%
\mathbf{\Lambda}_{k}|]-\frac{D}{2}\ln(2\pi)-\frac{1}{2}\operatorname{E}_{%
\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}}[(\mathbf{x}_{n}-\mathbf{\mu}_{k})^{\rm T%
}\mathbf{\Lambda}_{k}(\mathbf{x}_{n}-\mathbf{\mu}_{k})]
  </annotation>
 </semantics>
</math>

</p>

<p>Exponentiating both sides of the formula for 

<math display="inline" id="Variational_Bayesian_methods:128">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msup>
     <mi>q</mi>
     <mo>*</mo>
    </msup>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <times></times>
     </apply>
    </apply>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln q^{*}(\mathbf{Z})
  </annotation>
 </semantics>
</math>

 yields</p>

<p>

<math display="block" id="Variational_Bayesian_methods:129">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>q</mi>
     <mo>*</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐙</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∝</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <msubsup>
      <mi>ρ</mi>
      <mrow>
       <mi>n</mi>
       <mi>k</mi>
      </mrow>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>n</mi>
        <mi>k</mi>
       </mrow>
      </msub>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <times></times>
     </apply>
     <ci>𝐙</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ρ</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{*}(\mathbf{Z})\propto\prod_{n=1}^{N}\prod_{k=1}^{K}\rho_{nk}^{z_{nk}}
  </annotation>
 </semantics>
</math>

</p>

<p>Requiring that this be normalized ends up requiring that the 

<math display="inline" id="Variational_Bayesian_methods:130">
 <semantics>
  <msub>
   <mi>ρ</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ρ</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{nk}
  </annotation>
 </semantics>
</math>

 sum to 1 over all values of 

<math display="inline" id="Variational_Bayesian_methods:131">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, yielding</p>

<p>

<math display="block" id="Variational_Bayesian_methods:132">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>q</mi>
     <mo>*</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐙</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <msubsup>
      <mi>r</mi>
      <mrow>
       <mi>n</mi>
       <mi>k</mi>
      </mrow>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>n</mi>
        <mi>k</mi>
       </mrow>
      </msub>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <times></times>
     </apply>
     <ci>𝐙</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{*}(\mathbf{Z})=\prod_{n=1}^{N}\prod_{k=1}^{K}r_{nk}^{z_{nk}}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Variational_Bayesian_methods:133">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mrow>
     <mi>n</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>ρ</mi>
     <mrow>
      <mi>n</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </msubsup>
     <msub>
      <mi>ρ</mi>
      <mrow>
       <mi>n</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ρ</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}=\frac{\rho_{nk}}{\sum_{j=1}^{K}\rho_{nj}}
  </annotation>
 </semantics>
</math>

</p>

<p>In other words, 

<math display="inline" id="Variational_Bayesian_methods:134">
 <semantics>
  <mrow>
   <msup>
    <mi>q</mi>
    <mo>*</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <times></times>
    </apply>
    <ci>𝐙</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{*}(\mathbf{Z})
  </annotation>
 </semantics>
</math>

 is a product of single-observation <a href="multinomial_distribution" title="wikilink">multinomial distributions</a>, and factors over each individual 

<math display="inline" id="Variational_Bayesian_methods:135">
 <semantics>
  <msub>
   <mi>𝐳</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐳</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{z}_{n}
  </annotation>
 </semantics>
</math>

, which is distributed as a single-observation multinomial distribution with parameters 

<math display="inline" id="Variational_Bayesian_methods:136">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Variational_Bayesian_methods:137">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">…</mi>
    <mi>K</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1\dots K
  </annotation>
 </semantics>
</math>

.</p>

<p>Furthermore, we note that</p>

<p>

<math display="block" id="Variational_Bayesian_methods:138">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>z</mi>
      <mrow>
       <mi>n</mi>
       <mi>k</mi>
      </mrow>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>r</mi>
     <mrow>
      <mi>n</mi>
      <mi>k</mi>
     </mrow>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[z_{nk}]=r_{nk}\,
  </annotation>
 </semantics>
</math>

</p>

<p>which is a standard result for categorical distributions.</p>

<p>Now, considering the factor 

<math display="inline" id="Variational_Bayesian_methods:139">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mi>𝚲</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>q</ci>
    <vector>
     <ci>π</ci>
     <ci>μ</ci>
     <ci>𝚲</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(\mathbf{\pi},\mathbf{\mu},\mathbf{\Lambda})
  </annotation>
 </semantics>
</math>

, note that it automatically factors into 

<math display="inline" id="Variational_Bayesian_methods:140">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∏</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>K</mi>
    </msubsup>
    <mrow>
     <mi>q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>μ</mi>
       <mi>k</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>𝚲</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>q</ci>
    <ci>π</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>K</ci>
     </apply>
     <apply>
      <times></times>
      <ci>q</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <ci>k</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(\mathbf{\pi})\prod_{k=1}^{K}q(\mathbf{\mu}_{k},\mathbf{\Lambda}_{k})
  </annotation>
 </semantics>
</math>

 due to the structure of the graphical model defining our Gaussian mixture model, which is specified above.</p>

<p>Then,</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:141">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <msup>
     <mi>q</mi>
     <mo>*</mo>
    </msup>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <times></times>
     </apply>
    </apply>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln q^{*}(\mathbf{\pi})
  </annotation>
 </semantics>
</math>


</p>

<p>Taking the exponential of both sides, we recognize 

<math display="inline" id="Variational_Bayesian_methods:142">
 <semantics>
  <mrow>
   <msup>
    <mi>q</mi>
    <mo>*</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <times></times>
    </apply>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{*}(\mathbf{\pi})
  </annotation>
 </semantics>
</math>

 as a <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a></p>

<p>

<math display="block" id="Variational_Bayesian_methods:143">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>q</mi>
     <mo>*</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>π</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <mo>Dir</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <times></times>
     </apply>
     <ci>π</ci>
    </apply>
    <apply>
     <ci>Dir</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{*}(\mathbf{\pi})\sim\operatorname{Dir}(\mathbf{\alpha})\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Variational_Bayesian_methods:144">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>α</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>N</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{k}=\alpha_{0}+N_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Variational_Bayesian_methods:145">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mpadded width="+1.7pt">
     <msub>
      <mi>r</mi>
      <mrow>
       <mi>n</mi>
       <mi>k</mi>
      </mrow>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{k}=\sum_{n=1}^{N}r_{nk}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Finally</p>

<p>

<math display="block" id="Variational_Bayesian_methods:146">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <msup>
    <mi>q</mi>
    <mo>*</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>μ</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>𝚲</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>ln</mi>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>μ</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>𝚲</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>n</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </munderover>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>z</mi>
     <mrow>
      <mi>n</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
   <mi>ln</mi>
   <mi class="ltx_font_mathcaligraphic">𝒩</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐱</mi>
     <mi>n</mi>
    </msub>
    <mo>∣</mo>
    <msub>
     <mi>μ</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msubsup>
     <mi>𝚲</mi>
     <mi>k</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mtext>constant</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ln></ln>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <times></times>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ln></ln>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <ci>normal-E</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-]</ci>
    </cerror>
    <ln></ln>
    <csymbol cd="unknown">N</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <mtext>constant</mtext>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln q^{*}(\mathbf{\mu}_{k},\mathbf{\Lambda}_{k})=\ln p(\mathbf{\mu}_{k},%
\mathbf{\Lambda}_{k})+\sum_{n=1}^{N}\operatorname{E}[z_{nk}]\ln\mathcal{N}(%
\mathbf{x}_{n}\mid\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}^{-1})+\text{constant}
  </annotation>
 </semantics>
</math>

</p>

<p>Grouping and reading off terms involving 

<math display="inline" id="Variational_Bayesian_methods:147">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\mu}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:148">
 <semantics>
  <msub>
   <mi>𝚲</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝚲</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\Lambda}_{k}
  </annotation>
 </semantics>
</math>

, the result is a <a href="Gaussian-Wishart_distribution" title="wikilink">Gaussian-Wishart distribution</a> given by</p>

<p>

<math display="block" id="Variational_Bayesian_methods:149">
 <semantics>
  <mrow>
   <msup>
    <mi>q</mi>
    <mo>*</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>μ</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>𝚲</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi class="ltx_font_mathcaligraphic">𝒩</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>μ</mi>
     <mi>k</mi>
    </msub>
    <mo>∣</mo>
    <msub>
     <mi>𝐦</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>β</mi>
       <mi>k</mi>
      </msub>
      <msub>
       <mi>𝚲</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi class="ltx_font_mathcaligraphic">𝒲</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝚲</mi>
     <mi>k</mi>
    </msub>
    <mo>∣</mo>
    <msub>
     <mi>𝐖</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>ν</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <times></times>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">N</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐦</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝚲</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">W</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐖</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ν</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{*}(\mathbf{\mu}_{k},\mathbf{\Lambda}_{k})=\mathcal{N}(\mathbf{\mu}_{k}\mid%
\mathbf{m}_{k},(\beta_{k}\mathbf{\Lambda}_{k})^{-1})\mathcal{W}(\mathbf{%
\Lambda}_{k}\mid\mathbf{W}_{k},\nu_{k})
  </annotation>
 </semantics>
</math>

</p>

<p>given the definitions</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:150">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\beta_{k}
  </annotation>
 </semantics>
</math>


</p>

<p>Finally, notice that these functions require the values of 

<math display="inline" id="Variational_Bayesian_methods:151">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

, which make use of 

<math display="inline" id="Variational_Bayesian_methods:152">
 <semantics>
  <msub>
   <mi>ρ</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ρ</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{nk}
  </annotation>
 </semantics>
</math>

, which is defined in turn based on 

<math display="inline" id="Variational_Bayesian_methods:153">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mi>ln</mi>
     <msub>
      <mi>π</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <apply>
     <ln></ln>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>π</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[\ln\pi_{k}]
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:154">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>𝚲</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <apply>
     <ln></ln>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[\ln|\mathbf{\Lambda}_{k}|]
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Variational_Bayesian_methods:155">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mrow>
     <msub>
      <mi>μ</mi>
      <mi>k</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>𝚲</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>𝐱</mi>
         <mi>n</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>μ</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msub>
      <mi>𝚲</mi>
      <mi>k</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐱</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>μ</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <ci>k</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}}[(\mathbf{x}_{n}-%
\mathbf{\mu}_{k})^{\rm T}\mathbf{\Lambda}_{k}(\mathbf{x}_{n}-\mathbf{\mu}_{k})]
  </annotation>
 </semantics>
</math>

. Now that we have determined the distributions over which these expectations are taken, we can derive formulas for them:</p>

<p>

<math display="inline" id="Variational_Bayesian_methods:156">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mrow>
     <msub>
      <mi>μ</mi>
      <mi>k</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>𝚲</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>𝐱</mi>
         <mi>n</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>μ</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msub>
      <mi>𝚲</mi>
      <mi>k</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>𝐱</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>μ</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝚲</ci>
       <ci>k</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>normal-T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝚲</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{E}_{\mathbf{\mu}_{k},\mathbf{\Lambda}_{k}}[(\mathbf%
{x}_{n}-\mathbf{\mu}_{k})^{\rm T}\mathbf{\Lambda}_{k}(\mathbf{x}_{n}-\mathbf{%
\mu}_{k})]
  </annotation>
 </semantics>
</math>


</p>

<p>These results lead to</p>

<p>

<math display="block" id="Variational_Bayesian_methods:157">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mrow>
     <mi>n</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>∝</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>π</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mi>k</mi>
    </msub>
    <msubsup>
     <mover accent="true">
      <mi mathvariant="normal">Λ</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mi>k</mi>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>{</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mi>D</mi>
         <mrow>
          <mn>2</mn>
          <msub>
           <mi>β</mi>
           <mi>k</mi>
          </msub>
         </mrow>
        </mfrac>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>ν</mi>
          <mi>k</mi>
         </msub>
         <mn>2</mn>
        </mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>𝐱</mi>
            <mi>n</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>𝐦</mi>
            <mi>k</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi mathvariant="normal">T</mi>
        </msup>
        <msub>
         <mi>𝐖</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>𝐱</mi>
           <mi>n</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>𝐦</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>}</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>π</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>normal-Λ</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>D</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ν</ci>
          <ci>k</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐱</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐦</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <ci>normal-T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐖</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐱</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐦</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}\propto{\tilde{\pi}}_{k}{\tilde{\Lambda}}_{k}^{1/2}\exp\left\{-\frac{D}{%
2\beta_{k}}-\frac{\nu_{k}}{2}(\mathbf{x}_{n}-\mathbf{m}_{k})^{\rm T}\mathbf{W}%
_{k}(\mathbf{x}_{n}-\mathbf{m}_{k})\right\}
  </annotation>
 </semantics>
</math>

</p>

<p>These can be converted from proportional to absolute values by normalizing over 

<math display="inline" id="Variational_Bayesian_methods:158">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 so that the corresponding values sum to 1.</p>

<p>Note that:</p>
<ol>
<li>The update equations for the parameters 

<math display="inline" id="Variational_Bayesian_methods:159">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:160">
 <semantics>
  <msub>
   <mi>𝐦</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐦</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:161">
 <semantics>
  <msub>
   <mi>𝐖</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐖</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{W}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:162">
 <semantics>
  <msub>
   <mi>ν</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ν</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu_{k}
  </annotation>
 </semantics>
</math>

 of the variables 

<math display="inline" id="Variational_Bayesian_methods:163">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\mu}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:164">
 <semantics>
  <msub>
   <mi>𝚲</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝚲</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\Lambda}_{k}
  </annotation>
 </semantics>
</math>

 depend on the statistics 

<math display="inline" id="Variational_Bayesian_methods:165">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:166">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐱</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐱</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\bar{\mathbf{x}}}_{k}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Variational_Bayesian_methods:167">
 <semantics>
  <msub>
   <mi>𝐒</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐒</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{k}
  </annotation>
 </semantics>
</math>

, and these statistics in turn depend on 

<math display="inline" id="Variational_Bayesian_methods:168">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

.</li>
<li>The update equations for the parameters 

<math display="inline" id="Variational_Bayesian_methods:169">
 <semantics>
  <msub>
   <mi>α</mi>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">…</mi>
    <mi>K</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{1\dots K}
  </annotation>
 </semantics>
</math>

 of the variable 

<math display="inline" id="Variational_Bayesian_methods:170">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\pi}
  </annotation>
 </semantics>
</math>

 depend on the statistic 

<math display="inline" id="Variational_Bayesian_methods:171">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{k}
  </annotation>
 </semantics>
</math>

, which depends in turn on 

<math display="inline" id="Variational_Bayesian_methods:172">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

.</li>
<li>The update equation for 

<math display="inline" id="Variational_Bayesian_methods:173">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

 has a direct circular dependence on 

<math display="inline" id="Variational_Bayesian_methods:174">
 <semantics>
  <msub>
   <mi>β</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>β</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:175">
 <semantics>
  <msub>
   <mi>𝐦</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐦</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{m}_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:176">
 <semantics>
  <msub>
   <mi>𝐖</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐖</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{W}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:177">
 <semantics>
  <msub>
   <mi>ν</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ν</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu_{k}
  </annotation>
 </semantics>
</math>

 as well as an indirect circular dependence on 

<math display="inline" id="Variational_Bayesian_methods:178">
 <semantics>
  <msub>
   <mi>𝐖</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐖</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{W}_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:179">
 <semantics>
  <msub>
   <mi>ν</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ν</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:180">
 <semantics>
  <msub>
   <mi>α</mi>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">…</mi>
    <mi>K</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{1\dots K}
  </annotation>
 </semantics>
</math>

 through 

<math display="inline" id="Variational_Bayesian_methods:181">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>π</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>π</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\tilde{\pi}}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Variational_Bayesian_methods:182">
 <semantics>
  <msub>
   <mover accent="true">
    <mi mathvariant="normal">Λ</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>normal-Λ</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\tilde{\Lambda}}_{k}
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p>This suggests an iterative procedure that alternates between two steps:</p>
<ol>
<li>An E-step that computes the value of 

<math display="inline" id="Variational_Bayesian_methods:183">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

 using the current values of all the other parameters.</li>
<li>An M-step that uses the new value of 

<math display="inline" id="Variational_Bayesian_methods:184">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

 to compute new values of all the other parameters.</li>
</ol>

<p>Note that these steps correspond closely with the standard EM algorithm to derive a <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> or <a href="maximum_a_posteriori" title="wikilink">maximum a posteriori</a> (MAP) solution for the parameters of a <a href="Gaussian_mixture_model" title="wikilink">Gaussian mixture model</a>. The responsibilities 

<math display="inline" id="Variational_Bayesian_methods:185">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{nk}
  </annotation>
 </semantics>
</math>

 in the E step correspond closely to the <a href="posterior_probability" title="wikilink">posterior probabilities</a> of the latent variables given the data, i.e. 

<math display="inline" id="Variational_Bayesian_methods:186">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐙</mi>
    <mo>∣</mo>
    <mi>𝐗</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{Z}\mid\mathbf{X})
  </annotation>
 </semantics>
</math>

; the computation of the statistics 

<math display="inline" id="Variational_Bayesian_methods:187">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{k}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Variational_Bayesian_methods:188">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>𝐱</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐱</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\bar{\mathbf{x}}}_{k}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Variational_Bayesian_methods:189">
 <semantics>
  <msub>
   <mi>𝐒</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐒</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{S}_{k}
  </annotation>
 </semantics>
</math>

 corresponds closely to the computation of corresponding "soft-count" statistics over the data; and the use of those statistics to compute new values of the parameters corresponds closely to the use of soft counts to compute new parameter values in normal EM over a Gaussian mixture model.</p>
<h2 id="exponential-family-distributions">Exponential-family distributions</h2>

<p>Note that in the previous example, once the distribution over unobserved variables was assumed to factorize into distributions over the "parameters" and distributions over the "latent data", the derived "best" distribution for each variable was in the same family as the corresponding prior distribution over the variable. This is a general result that holds true for all prior distributions derived from the <a href="exponential_family" title="wikilink">exponential family</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Variational_message_passing" title="wikilink">Variational message passing</a>: a modular algorithm for variational Bayesian inference.</li>
<li><a href="Expectation-maximization_algorithm" title="wikilink">Expectation-maximization algorithm</a>: a related approach which corresponds to a special case of variational Bayesian inference.</li>
<li><a href="Generalized_filtering" title="wikilink">Generalized filtering</a>: a variational filtering scheme for nonlinear state space models.</li>
<li><a href="Calculus_of_variations" title="wikilink">Calculus of variations</a>: the field of mathematical analysis that deals with maximizing or minimizing functionals.</li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.gatsby.ucl.ac.uk/vbayes/">Variational-Bayes Repository</a> A repository of papers, software, and links related to the use of variational methods for approximate Bayesian learning</li>
<li><a href="http://www.inference.phy.cam.ac.uk/mackay/itila/">The on-line textbook: Information Theory, Inference, and Learning Algorithms</a>, by <a href="David_J.C._MacKay" title="wikilink">David J.C. MacKay</a> provides an introduction to variational methods (p. 422).</li>
<li><a href="http://www.cse.buffalo.edu/faculty/mbeal/thesis/index.html">Variational Algorithms for Approximate Bayesian Inference</a>, by M. J. Beal includes comparisons of EM to Variational Bayesian EM and derivations of several models including Variational Bayesian HMMs.</li>
<li><a href="http://www.robots.ox.ac.uk/~sjrob/Pubs/fox_vbtut.pdf">A Tutorial on Variational Bayes</a>. Fox, C. and Roberts, S. 2012. Artificial Intelligence Review, .</li>
<li><a href="http://www.cs.jhu.edu/~jason/tutorials/variational.html">High-Level Explanation of Variational Inference</a> by Jason Eisner may be worth reading before a more mathematically detailed treatment.</li>
</ul>

<p>"</p>

<p><a href="Category:Bayesian_statistics" title="wikilink">Category:Bayesian statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Christopher Bishop, <em>Pattern Recognition and Machine Learning</em>, 2006<a href="#fnref2">↩</a></li>
<li id="fn3">Based on Chapter 10 of <em>Pattern Recognition and Machine Learning</em> by <a href="Christopher_M._Bishop" title="wikilink">Christopher M. Bishop</a><a href="#fnref3">↩</a></li>
<li id="fn4">Based on Chapter 10 of <em>Pattern Recognition and Machine Learning</em> by <a href="Christopher_M._Bishop" title="wikilink">Christopher M. Bishop</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

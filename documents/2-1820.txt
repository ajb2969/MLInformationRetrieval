   Jensen's inequality      Jensen's inequality   In mathematics , Jensen's inequality , named after the Danish mathematician Johan Jensen , relates the value of a convex function of an integral to the integral of the convex function. It was proved by Jensen in 1906. 1 Given its generality, the inequality appears in many forms depending on the context, some of which are presented below. In its simplest form the inequality states that the convex transformation of a mean is less than or equal to the mean after convex transformation; it is a simple corollary that the opposite is true of concave transformations.  Jensen's inequality generalizes the statement that the secant line of a convex function lies above the graph of the function, which is Jensen's inequality for two points: the secant line consists of weighted means of the convex function,        t  f   (   x  1   )    +    (   1  -  t   )   f   (   x  2   )     ,        t  f   subscript  x  1        1  t   f   subscript  x  2      tf(x_{1})+(1-t)f(x_{2}),     while the graph of the function is the convex function of the weighted means,       f   (    t   x  1    +    (   1  -  t   )    x  2     )    .      f      t   subscript  x  1        1  t    subscript  x  2       f\left(tx_{1}+(1-t)x_{2}\right).     In the context of probability theory , it is generally stated in the following form: if X is a random variable and   Ï†   Ï†   Ï†   is a convex function, then        Ï†   (   ğ”¼   [  X  ]    )    â‰¤   ğ”¼   [   Ï†   (  X  )    ]     .        Ï†    ğ”¼   delimited-[]  X       ğ”¼   delimited-[]    Ï†  X       \varphi\left(\mathbb{E}[X]\right)\leq\mathbb{E}\left[\varphi(X)\right].     Statements  The classical form of Jensen's inequality involves several numbers and weights. The inequality can be stated quite generally using either the language of measure theory or (equivalently) probability. In the probabilistic setting, the inequality can be further generalized to its full strength .  Finite form  For a real convex function    Ï†   Ï†   Ï†   , numbers in its domain, and positive weights , Jensen's inequality can be stated as:       Ï†   (    âˆ‘    a  i    x  i      âˆ‘   a  i     )    â‰¤     âˆ‘    a  i   Ï†   (   x  i   )      âˆ‘   a  i      (  1  )          Ï†         subscript  a  i    subscript  x  i        subscript  a  i              subscript  a  i   Ï†   subscript  x  i        subscript  a  i     1     \varphi\left(\frac{\sum a_{i}x_{i}}{\sum a_{i}}\right)\leq\frac{\sum a_{i}%
 \varphi(x_{i})}{\sum a_{i}}\qquad\qquad(1)     and the inequality is reversed if   Ï†   Ï†   Ï†   is concave , which is      Ï†   (    âˆ‘    a  i    x  i      âˆ‘   a  i     )   â‰¥    âˆ‘    a  i   Ï†   (   x  i   )      âˆ‘   a  i     .   (  2  )      fragments  Ï†   fragments  normal-(         subscript  a  i    subscript  x  i        subscript  a  i     normal-)           subscript  a  i   Ï†   subscript  x  i        subscript  a  i     normal-.  italic-   fragments  normal-(  2  normal-)     \varphi\left(\frac{\sum a_{i}x_{i}}{\sum a_{i}}\right)\geq\frac{\sum a_{i}%
 \varphi(x_{i})}{\sum a_{i}}.\qquad\qquad(2)     Equality holds if and only if     x  1   =   x  2   =  â‹¯  =   x  n          subscript  x  1    subscript  x  2        normal-â‹¯        subscript  x  n      x_{1}=x_{2}=\cdots=x_{n}   or   Ï†   Ï†   Ï†   is linear.  As a particular case, if the weights are all equal, then (1) and (2) become       Ï†   (    âˆ‘   x  i    n   )    â‰¤     âˆ‘   Ï†   (   x  i   )     n    (  3  )          Ï†       subscript  x  i    n           Ï†   subscript  x  i     n   3     \varphi\left(\frac{\sum x_{i}}{n}\right)\leq\frac{\sum\varphi(x_{i})}{n}\qquad%
 \qquad(3)          Ï†   (    âˆ‘   x  i    n   )    â‰¥     âˆ‘   Ï†   (   x  i   )     n    (  4  )          Ï†       subscript  x  i    n           Ï†   subscript  x  i     n   4     \varphi\left(\frac{\sum x_{i}}{n}\right)\geq\frac{\sum\varphi(x_{i})}{n}\qquad%
 \qquad(4)     For instance, the function     l  o  g   (  x  )       l  o  g  x    log(x)    is concave , so substituting     Ï†   (  x  )    =   l  o  g   (  x  )          Ï†  x     l  o  g  x     Ï†(x)=log(x)   in the previous formula (4) establishes the (logarithm of the) familiar arithmetic mean-geometric mean inequality :         x  1   +   x  2   +  â‹¯  +   x  n    n   â‰¥      x  1   â‹…   x  2    â‹¯   x  n    n   .  or   log    (     âˆ‘   i  =  1   n    x  i    n   )   â‰¥     âˆ‘   i  =  1   n     log    (   x  i   )     n      fragments       subscript  x  1    subscript  x  2   normal-â‹¯   subscript  x  n    n       n      normal-â‹…   subscript  x  1    subscript  x  2    normal-â‹¯   subscript  x  n     normal-.   or     fragments  normal-(      superscript   subscript     i  1    n    subscript  x  i    n   normal-)        superscript   subscript     i  1    n      subscript  x  i     n     \frac{x_{1}+x_{2}+\cdots+x_{n}}{n}\geq\sqrt[n]{x_{1}\cdot x_{2}\cdots x_{n}}.%
 \quad\text{or}\quad\log\!\left(\frac{\sum_{i=1}^{n}x_{i}}{n}\right)\geq\frac{%
 \sum_{i=1}^{n}\log\!\left(x_{i}\right)}{n}     A common application has x as a function of another variable (or set of variables) t , that is,  g ( t i )}} . All of this carries directly over to the general continuous case: the weights are replaced by a non-negative integrable function    f   (  x  )       f  x    f(x)   , such as a probability distribution, and the summations are replaced by integrals.  Measure-theoretic and probabilistic form  Let    (  Î©  ,  A  ,  Î¼  )     normal-Î©  A  Î¼    \scriptstyle(\Omega,A,\mu)   be a measure space , such that     Î¼   (  Î©  )    =  1        Î¼  normal-Î©   1    Î¼(Î©)=1   . If g is a real -valued function that is Î¼- integrable , and if   Ï†   Ï†   Ï†   is a convex function on the real line, then:        Ï†   (    âˆ«  Î©     g   d  Î¼    )    â‰¤    âˆ«  Î©     Ï†  âˆ˜   g    d  Î¼     .        Ï†    subscript   normal-Î©     g  d  Î¼       subscript   normal-Î©       Ï†  g   d  Î¼      \varphi\left(\int_{\Omega}g\,d\mu\right)\leq\int_{\Omega}\varphi\circ g\,d\mu.     In real analysis, we may require an estimate on       Ï†   (    âˆ«  a  b    f   (  x  )   d  x    )    ,      Ï†    superscript   subscript   a   b     f  x  d  x      \varphi\left(\int_{a}^{b}f(x)\,dx\right),     where    a  ,   b  âˆˆ  ğ‘      a    b  normal-âˆˆ  ğ‘     a,bâˆˆ\mathbf{R}   , and    f  :    a  a   ,   b  â†’  ğ‘       normal-:  f     a  a     b  normal-â†’  ğ‘      f:aa,bâ†’\mathbf{R}   is a non-negative Lebesgue- integrable function. In this case, the Lebesgue measure of     a  a   ,  b       a  a   b    aa,b   need not be unity. However, by integration by substitution, the interval can be rescaled so that it has measure unity. Then Jensen's inequality can be applied to get        Ï†   (    âˆ«  a  b    f   (  x  )   d  x    )    â‰¤    1   b  -  a      âˆ«  a  b    Ï†   (    (   b  -  a   )   f   (  x  )    )   d  x      .        Ï†    superscript   subscript   a   b     f  x  d  x         1    b  a      superscript   subscript   a   b     Ï†      b  a   f  x   d  x       \varphi\left(\int_{a}^{b}f(x)\,dx\right)\leq\frac{1}{b-a}\int_{a}^{b}\varphi((%
 b-a)f(x))\,dx.     The same result can be equivalently stated in a probability theory setting, by a simple change of notation. Let    (  Î©  ,  ğ”‰  ,  â„™  )     normal-Î©  ğ”‰  â„™    \scriptstyle(\Omega,\mathfrak{F},\mathbb{P})   be a probability space , X an integrable real-valued random variable and   Ï†   Ï†   Ï†   a convex function . Then:        Ï†   (   ğ”¼   [  X  ]    )    â‰¤   ğ”¼   [   Ï†   (  X  )    ]     .        Ï†    ğ”¼   delimited-[]  X       ğ”¼   delimited-[]    Ï†  X       \varphi\left(\mathbb{E}[X]\right)\leq\mathbb{E}\left[\varphi(X)\right].     In this probability setting, the measure   Î¼   Î¼   Î¼   is intended as a probability   â„™   â„™   \scriptstyle\mathbb{P}   , the integral with respect to   Î¼   Î¼   Î¼   as an expected value    ğ”¼   ğ”¼   \scriptstyle\mathbb{E}   , and the function g as a random variable  X .  Notice that the equality holds if and only if X is constant (degenerate random variable) or   Ï†   Ï†   Ï†   is linear.  General inequality in a probabilistic setting  More generally, let T be a real topological vector space , and X a T -valued integrable random variable. In this general setting, integrable means that there exists an element    ğ”¼   [  X  ]       ğ”¼   delimited-[]  X     \scriptstyle\mathbb{E}[X]   in T , such that for any element z in the dual space of T      ğ”¼   |   âŸ¨  z  ,  X  âŸ©   |    <  âˆ        ğ”¼     z  X        \scriptstyle\mathbb{E}|\langle z,X\rangle|<\infty   , and     âŸ¨  z  ,   ğ”¼   [  X  ]    âŸ©   =   ğ”¼   [   âŸ¨  z  ,  X  âŸ©   ]         z    ğ”¼   delimited-[]  X       ğ”¼   delimited-[]   z  X       \scriptstyle\langle z,\mathbb{E}[X]\rangle=\mathbb{E}[\langle z,X\rangle]   . Then, for any measurable convex function   Ï†   Ï†   Ï†   and any sub- Ïƒ-algebra    ğ”Š   ğ”Š   \scriptstyle\mathfrak{G}   of   ğ”‰   ğ”‰   \scriptstyle\mathfrak{F}   :      Ï†   (  ğ”¼   [  X  |  ğ”Š  ]   )   â‰¤  ğ”¼   [  Ï†   (  X  )   |  ğ”Š  ]   .     fragments  Ï†   fragments  normal-(  E   fragments  normal-[  X  normal-|  G  normal-]   normal-)    E   fragments  normal-[  Ï†   fragments  normal-(  X  normal-)   normal-|  G  normal-]   normal-.    \varphi\left(\mathbb{E}\left[X|\mathfrak{G}\right]\right)\leq\mathbb{E}\left[%
 \varphi(X)|\mathfrak{G}\right].     Here    ğ”¼   [  â‹…  |  ğ”Š  ]      fragments  E   fragments  normal-[  normal-â‹…  normal-|  G  normal-]     \scriptstyle\mathbb{E}[\cdot|\mathfrak{G}]   stands for the expectation conditioned to the Ïƒ-algebra   ğ”Š   ğ”Š   \scriptstyle\mathfrak{G}   . This general statement reduces to the previous ones when the topological vector space   T   T   T   is the real axis , and   ğ”Š   ğ”Š   \scriptstyle\mathfrak{G}   is the trivial   Ïƒ   Ïƒ   Ïƒ   -algebra 2  Proofs  (Figure)  A graphical "proof" of Jensen's inequality for the probabilistic case. The dashed curve along the   X   X   X   axis is the hypothetical distribution of   X   X   X   , while the dashed curve along the   Y   Y   Y   axis is the corresponding distribution of   Y   Y   Y   values. Note that the convex mapping    Y   (  X  )       Y  X    Y(X)   increasingly "stretches" the distribution for increasing values of   X   X   X   .   Jensen's inequality can be proved in several ways, and three different proofs corresponding to the different statements above will be offered. Before embarking on these mathematical derivations, however, it is worth analyzing an intuitive graphical argument based on the probabilistic case where   X   X   X   is a real number (see figure). Assuming a hypothetical distribution of   X   X   X   values, one can immediately identify the position of    ğ”¼   [  X  ]       ğ”¼   delimited-[]  X     \scriptstyle\mathbb{E}[X]   and its image    Ï†   (   ğ”¼   [  X  ]    )       Ï†    ğ”¼   delimited-[]  X      \scriptstyle\varphi(\mathbb{E}[X])   in the graph. Noticing that for convex mappings    Y  =   Ï†   (  X  )        Y    Ï†  X     Y=Ï†(X)   the corresponding distribution of   Y   Y   Y   values is increasingly "stretched out" for increasing values of   X   X   X   , it is easy to see that the distribution of   Y   Y   Y   is broader in the interval corresponding to and narrower in for any ; in particular, this is also true for     X  0   =   ğ”¼   [  X  ]         subscript  X  0     ğ”¼   delimited-[]  X      \scriptstyle X_{0}=\mathbb{E}[X]   . Consequently, in this picture the expectation of   Y   Y   Y   will always shift upwards with respect to the position of    Ï†   (   ğ”¼   [  X  ]    )       Ï†    ğ”¼   delimited-[]  X      \scriptstyle\varphi(\mathbb{E}[X])   . A similar reasoning holds if the distribution of   X   X   X   covers a decreasing portion of the convex function, or both a decreasing and an increasing portion of it. This "proves" the inequality, i.e.        ğ”¼   [  Y  ]    =   ğ”¼   [   Ï†   (  X  )    ]    â‰¥   Ï†   (   ğ”¼   [  X  ]    )     ,          ğ”¼   delimited-[]  Y      ğ”¼   delimited-[]    Ï†  X            Ï†    ğ”¼   delimited-[]  X        \mathbb{E}[Y]=\mathbb{E}[\varphi(X)]\geq\varphi(\mathbb{E}[X]),     with equality when    Ï†   (  X  )       Ï†  X    Ï†(X)   is not strictly convex, e.g. when it is a straight line, or when   X   X   X   follows a degenerate distribution (i.e. is a constant).  The proofs below formalize this intuitive notion.  Proof 1 (finite form)  If and are two arbitrary nonnegative real numbers such that 1}} then convexity of   Ï†   Ï†   Ï†   implies      âˆ€   x  1   ,   x  2   :  Ï†   (   Î»  1    x  1   +   Î»  2    x  2   )   â‰¤    Î»  1    Ï†   (   x  1   )   +    Î»  2    Ï†   (   x  2   )   .     fragments  for-all   subscript  x  1   normal-,   subscript  x  2   normal-:  italic-  Ï†   fragments  normal-(   subscript  Î»  1    subscript  x  1     subscript  Î»  2    subscript  x  2   normal-)     subscript  Î»  1   Ï†   fragments  normal-(   subscript  x  1   normal-)     subscript  Î»  2   Ï†   fragments  normal-(   subscript  x  2   normal-)   normal-.    \forall x_{1},x_{2}:\qquad\varphi\left(\lambda_{1}x_{1}+\lambda_{2}x_{2}\right%
 )\leq\lambda_{1}\,\varphi(x_{1})+\lambda_{2}\,\varphi(x_{2}).     This can be easily generalized: if are nonnegative real numbers such that 1}} , then        Ï†   (     Î»  1    x  1    +    Î»  2    x  2    +  â‹¯  +    Î»  n    x  n     )    â‰¤      Î»  1    Ï†   (   x  1   )    +     Î»  2    Ï†   (   x  2   )    +  â‹¯  +     Î»  n    Ï†   (   x  n   )      ,        Ï†       subscript  Î»  1    subscript  x  1       subscript  Î»  2    subscript  x  2    normal-â‹¯     subscript  Î»  n    subscript  x  n           subscript  Î»  1   Ï†   subscript  x  1       subscript  Î»  2   Ï†   subscript  x  2    normal-â‹¯     subscript  Î»  n   Ï†   subscript  x  n       \varphi(\lambda_{1}x_{1}+\lambda_{2}x_{2}+\cdots+\lambda_{n}x_{n})\leq\lambda_%
 {1}\,\varphi(x_{1})+\lambda_{2}\,\varphi(x_{2})+\cdots+\lambda_{n}\,\varphi(x_%
 {n}),     for any . This finite form of the Jensen's inequality can be proved by induction : by convexity hypotheses, the statement is true for n =Â 2  . Suppose it is true also for some n , one needs to prove it for    n  +  1      n  1    n+1   . At least one of the is strictly positive, say ; therefore by convexity inequality:      Ï†   (     âˆ‘   i  =  1    n  +  1       Î»  i    x  i     )       Ï†    superscript   subscript     i  1      n  1       subscript  Î»  i    subscript  x  i       \displaystyle\varphi\left(\sum_{i=1}^{n+1}\lambda_{i}x_{i}\right)     Since         âˆ‘   i  =  2    n  +  1      Î»  i    1  -   Î»  1      =  1   ,        superscript   subscript     i  2      n  1       subscript  Î»  i     1   subscript  Î»  1      1    \sum_{i=2}^{n+1}\frac{\lambda_{i}}{1-\lambda_{1}}=1,     one can apply the induction hypotheses to the last term in the previous formula to obtain the result, namely the finite form of the Jensen's inequality.  In order to obtain the general inequality from this finite form, one needs to use a density argument. The finite form can be rewritten as:        Ï†   (   âˆ«    x   d   Î¼  n    (  x  )     )    â‰¤   âˆ«   Ï†   (  x  )   d   Î¼  n    (  x  )      ,        Ï†      x  d   subscript  Î¼  n   x         Ï†  x  d   subscript  Î¼  n   x      \varphi\left(\int x\,d\mu_{n}(x)\right)\leq\int\varphi(x)\,d\mu_{n}(x),     where Î¼ n is a measure given by an arbitrary convex combination of Dirac deltas :        Î¼  n   =    âˆ‘   i  =  1   n     Î»  i    Î´   x  i       .       subscript  Î¼  n     superscript   subscript     i  1    n      subscript  Î»  i    subscript  Î´   subscript  x  i        \mu_{n}=\sum_{i=1}^{n}\lambda_{i}\delta_{x_{i}}.     Since convex functions are continuous , and since convex combinations of Dirac deltas are weakly  dense in the set of probability measures (as could be easily verified), the general statement is obtained simply by a limiting procedure.  Proof 2 (measure-theoretic form)  Let g be a real-valued Î¼-integrable function on a probability space Î©, and let   Ï†   Ï†   Ï†   be a convex function on the real numbers. Since   Ï†   Ï†   Ï†   is convex, at each real number   x   x   x   we have a nonempty set of subderivatives , which may be thought of as lines touching the graph of   Ï†   Ï†   Ï†   at   x   x   x   , but which are at or below the graph of   Ï†   Ï†   Ï†   at all points.  Now, if we define        x  0   :=    âˆ«  Î©     g   d  Î¼     ,     assign   subscript  x  0     subscript   normal-Î©     g  d  Î¼      x_{0}:=\int_{\Omega}g\,d\mu,   because of the existence of subderivatives for convex functions, we may choose a and b such that         a  x   +  b   â‰¤   Ï†   (  x  )     ,          a  x   b     Ï†  x     ax+b\leq\varphi(x),   for all real   x   x   x   and         a   x  0    +  b   =   Ï†   (   x  0   )     .          a   subscript  x  0    b     Ï†   subscript  x  0      ax_{0}+b=\varphi(x_{0}).   But then we have that        Ï†  âˆ˜  g    (  x  )    â‰¥    a  g   (  x  )    +  b           Ï†  g   x       a  g  x   b     \varphi\circ g(x)\geq ag(x)+b   for all   x   x   x   . Since we have a probability measure, the integral is monotone with     Î¼   (  Î©  )    =  1        Î¼  normal-Î©   1    Î¼(Î©)=1   so that         âˆ«  Î©     Ï†  âˆ˜   g    d  Î¼    â‰¥    âˆ«  Î©     (    a  g   +  b   )   d  Î¼    =    a    âˆ«  Î©     g   d  Î¼     +   b    âˆ«  Î©    d  Î¼      =    a   x  0    +  b   =   Ï†   (   x  0   )    =   Ï†   (    âˆ«  Î©     g   d  Î¼    )     ,          subscript   normal-Î©       Ï†  g   d  Î¼      subscript   normal-Î©         a  g   b   d  Î¼             a    subscript   normal-Î©     g  d  Î¼       b    subscript   normal-Î©     d  Î¼               a   subscript  x  0    b          Ï†   subscript  x  0           Ï†    subscript   normal-Î©     g  d  Î¼        \int_{\Omega}\varphi\circ g\,d\mu\geq\int_{\Omega}(ag+b)\,d\mu=a\int_{\Omega}g%
 \,d\mu+b\int_{\Omega}d\mu=ax_{0}+b=\varphi(x_{0})=\varphi\left(\int_{\Omega}g%
 \,d\mu\right),     as desired.  Proof 3 (general inequality in a probabilistic setting)  Let X be an integrable random variable that takes values in a real topological vector space T . Since    Ï†  :   T  â†’  ğ‘      normal-:  Ï†    T  normal-â†’  ğ‘     Ï†:Tâ†’\mathbf{R}   is convex, for any     x  ,  y   âˆˆ  T       x  y   T    x,y\in T   , the quantity         Ï†   (   x  +    Î¸   y    )    -   Ï†   (  x  )     Î¸   ,          Ï†    x    Î¸  y       Ï†  x    Î¸    \frac{\varphi(x+\theta\,y)-\varphi(x)}{\theta},     is decreasing as   Î¸   Î¸   Î¸   approaches 0 + . In particular, the subdifferential of   Ï†   Ï†   Ï†   evaluated at   x   x   x   in the direction   y   y   y   is well-defined by          (   D  Ï†   )    (  x  )    â‹…  y   :=    lim   Î¸  â†“  0       Ï†   (   x  +    Î¸   y    )    -   Ï†   (  x  )     Î¸    =    inf   Î¸  â‰   0       Ï†   (   x  +    Î¸   y    )    -   Ï†   (  x  )     Î¸     .       assign   normal-â‹…      D  Ï†   x   y     subscript    normal-â†“  Î¸  0          Ï†    x    Î¸  y       Ï†  x    Î¸           subscript  infimum    Î¸  0          Ï†    x    Î¸  y       Ï†  x    Î¸       (D\varphi)(x)\cdot y:=\lim_{\theta\downarrow 0}\frac{\varphi(x+\theta\,y)-%
 \varphi(x)}{\theta}=\inf_{\theta\neq 0}\frac{\varphi(x+\theta\,y)-\varphi(x)}{%
 \theta}.     It is easily seen that the subdifferential is linear in   y   y   y   (that is false and the assertion requires Hahn-Banach theorem to be proved) and, since the infimum taken in the right-hand side of the previous formula is smaller than the value of the same term for    Î¸  =  1      Î¸  1    Î¸=1   , one gets        Ï†   (  x  )    â‰¤    Ï†   (   x  +  y   )    -     (   D  Ï†   )    (  x  )    â‹…  y     .        Ï†  x       Ï†    x  y     normal-â‹…      D  Ï†   x   y      \varphi(x)\leq\varphi(x+y)-(D\varphi)(x)\cdot y.     In particular, for an arbitrary sub-   Ïƒ   Ïƒ   Ïƒ   -algebra   ğ”Š   ğ”Š   \scriptstyle\mathfrak{G}   we can evaluate the last inequality when    x  =  ğ”¼   [  X  |  ğ”Š  ]   ,  y  =  X  -  ğ”¼   [  X  |  ğ”Š  ]      fragments  x   E   fragments  normal-[  X  normal-|  G  normal-]   normal-,  y   X   E   fragments  normal-[  X  normal-|  G  normal-]     \scriptstyle x=\mathbb{E}[X|\mathfrak{G}],\,y=X-\mathbb{E}[X|\mathfrak{G}]   to obtain      Ï†   (  ğ”¼   [  X  |  ğ”Š  ]   )   â‰¤  Ï†   (  X  )   -   (  D  Ï†  )    (  ğ”¼   [  X  |  ğ”Š  ]   )   â‹…   (  X  -  ğ”¼   [  X  |  ğ”Š  ]   )   .     fragments  Ï†   fragments  normal-(  E   fragments  normal-[  X  normal-|  G  normal-]   normal-)    Ï†   fragments  normal-(  X  normal-)     fragments  normal-(  D  Ï†  normal-)    fragments  normal-(  E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-â‹…   fragments  normal-(  X   E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-.    \varphi(\mathbb{E}[X|\mathfrak{G}])\leq\varphi(X)-(D\varphi)(\mathbb{E}[X|%
 \mathfrak{G}])\cdot(X-\mathbb{E}[X|\mathfrak{G}]).     Now, if we take the expectation conditioned to   ğ”Š   ğ”Š   \scriptstyle\mathfrak{G}   on both sides of the previous expression, we get the result since:      ğ”¼   [   [   (  D  Ï†  )    (  ğ”¼   [  X  |  ğ”Š  ]   )   â‹…   (  X  -  ğ”¼   [  X  |  ğ”Š  ]   )   ]   |  ğ”Š  ]   =   (  D  Ï†  )    (  ğ”¼   [  X  |  ğ”Š  ]   )   â‹…  ğ”¼   [   (  X  -  ğ”¼   [  X  |  ğ”Š  ]   )   |  ğ”Š  ]   =  0  ,     fragments  E   fragments  normal-[   fragments  normal-[   fragments  normal-(  D  Ï†  normal-)    fragments  normal-(  E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-â‹…   fragments  normal-(  X   E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-]   normal-|  G  normal-]     fragments  normal-(  D  Ï†  normal-)    fragments  normal-(  E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-â‹…  E   fragments  normal-[   fragments  normal-(  X   E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-|  G  normal-]    0  normal-,    \mathbb{E}\left[\left[(D\varphi)(\mathbb{E}[X|\mathfrak{G}])\cdot(X-\mathbb{E}%
 [X|\mathfrak{G}])\right]|\mathfrak{G}\right]=(D\varphi)(\mathbb{E}[X|\mathfrak%
 {G}])\cdot\mathbb{E}[\left(X-\mathbb{E}[X|\mathfrak{G}]\right)|\mathfrak{G}]=0,     by the linearity of the subdifferential in the y variable, and the following well-known property of the conditional expectation :      ğ”¼   [   (  ğ”¼   [  X  |  ğ”Š  ]   )   |  ğ”Š  ]   =  ğ”¼   [  X  |  ğ”Š  ]   .     fragments  E   fragments  normal-[   fragments  normal-(  E   fragments  normal-[  X  normal-|  G  normal-]   normal-)   normal-|  G  normal-]    E   fragments  normal-[  X  normal-|  G  normal-]   normal-.    \mathbb{E}\left[\left(\mathbb{E}[X|\mathfrak{G}]\right)|\mathfrak{G}\right]=%
 \mathbb{E}[X|\mathfrak{G}].     Applications and special cases  Form involving a probability density function  Suppose   Î©   normal-Î©   Î©   is a measurable subset of the real line and f ( x ) is a non-negative function such that        âˆ«   -  âˆ   âˆ    f   (  x  )   d  x    =  1.        superscript   subscript            f  x  d  x    1.    \int_{-\infty}^{\infty}f(x)\,dx=1.     In probabilistic language, f is a probability density function .  Then Jensen's inequality becomes the following statement about convex integrals:  If g is any real-valued measurable function and   Ï†   Ï†   Ï†   is convex over the range of g , then        Ï†   (    âˆ«   -  âˆ   âˆ    g   (  x  )   f   (  x  )   d  x    )    â‰¤    âˆ«   -  âˆ   âˆ    Ï†   (   g   (  x  )    )   f   (  x  )   d  x     .        Ï†    superscript   subscript            g  x  f  x  d  x       superscript   subscript            Ï†    g  x   f  x  d  x      \varphi\left(\int_{-\infty}^{\infty}g(x)f(x)\,dx\right)\leq\int_{-\infty}^{%
 \infty}\varphi(g(x))f(x)\,dx.     If g ( x ) = x , then this form of the inequality reduces to a commonly used special case:        Ï†   (    âˆ«   -  âˆ   âˆ     x   f   (  x  )   d  x    )    â‰¤    âˆ«   -  âˆ   âˆ    Ï†   (  x  )   f   (  x  )   d  x     .        Ï†    superscript   subscript            x  f  x  d  x       superscript   subscript            Ï†  x  f  x  d  x      \varphi\left(\int_{-\infty}^{\infty}x\,f(x)\,dx\right)\leq\int_{-\infty}^{%
 \infty}\varphi(x)\,f(x)\,dx.     Alternative finite form  Let  and take   Î¼   Î¼   Î¼   to be the counting measure on   Î©   normal-Î©   Î©   , then the general form reduces to a statement about sums:        Ï†   (    âˆ‘   i  =  1   n    g   (   x  i   )    Î»  i     )    â‰¤    âˆ‘   i  =  1   n    Ï†   (   g   (   x  i   )    )    Î»  i      ,        Ï†    superscript   subscript     i  1    n     g   subscript  x  i    subscript  Î»  i        superscript   subscript     i  1    n     Ï†    g   subscript  x  i     subscript  Î»  i       \varphi\left(\sum_{i=1}^{n}g(x_{i})\lambda_{i}\right)\leq\sum_{i=1}^{n}\varphi%
 (g(x_{i}))\lambda_{i},     provided that and        Î»  1   +  â‹¯  +   Î»  n    =  1.         subscript  Î»  1   normal-â‹¯   subscript  Î»  n    1.    \lambda_{1}+\cdots+\lambda_{n}=1.     There is also an infinite discrete form.  Statistical physics  Jensen's inequality is of particular importance in statistical physics when the convex function is an exponential, giving:        e   ğ”¼   [  X  ]     â‰¤   ğ”¼   [   e  X   ]     ,       superscript  e    ğ”¼   delimited-[]  X       ğ”¼   delimited-[]   superscript  e  X       e^{\mathbb{E}[X]}\leq\mathbb{E}\left[e^{X}\right],     where the expected values are with respect to some probability distribution in the random variable    X   X   X   .  The proof in this case is very simple (cf. Chandler, Sec. 5.5). The desired inequality follows directly, by writing       ğ”¼   [   e  X   ]    =    e   ğ”¼   [  X  ]     ğ”¼   [   e   X  -   ğ”¼   [  X  ]      ]          ğ”¼   delimited-[]   superscript  e  X        superscript  e    ğ”¼   delimited-[]  X     ğ”¼   delimited-[]   superscript  e    X    ğ”¼   delimited-[]  X          \mathbb{E}\left[e^{X}\right]=e^{\mathbb{E}[X]}\mathbb{E}\left[e^{X-\mathbb{E}[%
 X]}\right]     and then applying the inequality to the final exponential.  Information theory  If    p   (  x  )       p  x    p(x)   is the true probability distribution for   x   x   x   , and    q   (  x  )       q  x    q(x)   is another distribution, then applying Jensen's inequality for the random variable Y ( x ) = q ( x )/ p ( x ) and the function     Ï†   (  y  )    =   âˆ’  l  o  g   (  y  )          Ï†  y     normal-âˆ’  l  o  g  y     Ï†(y)=âˆ’log(y)   gives       ğ”¼   [   Ï†   (  Y  )    ]    â‰¥   Ï†   (   ğ”¼   [  Y  ]    )          ğ”¼   delimited-[]    Ï†  Y       Ï†    ğ”¼   delimited-[]  Y       \mathbb{E}[\varphi(Y)]\geq\varphi(\mathbb{E}[Y])     Therefore:      -  D   (  p   (  x  )   âˆ¥  q   (  x  )   )   =  âˆ«  p   (  x  )   log   (    q   (  x  )     p   (  x  )     )   d  x  â‰¤  log   (  âˆ«  p   (  x  )      q   (  x  )     p   (  x  )      d  x  )   =  log   (  âˆ«  q   (  x  )   d  x  )   =  0     fragments   D   fragments  normal-(  p   fragments  normal-(  x  normal-)   parallel-to  q   fragments  normal-(  x  normal-)   normal-)     p   fragments  normal-(  x  normal-)     fragments  normal-(      q  x     p  x    normal-)   d  x     fragments  normal-(   p   fragments  normal-(  x  normal-)       q  x     p  x    d  x  normal-)      fragments  normal-(   q   fragments  normal-(  x  normal-)   d  x  normal-)    0    -D(p(x)\|q(x))=\int p(x)\log\left(\frac{q(x)}{p(x)}\right)\,dx\leq\log\left(%
 \int p(x)\frac{q(x)}{p(x)}\,dx\right)=\log\left(\int q(x)\,dx\right)=0     a result called Gibbs' inequality .  It shows that the average message length is minimised when codes are assigned on the basis of the true probabilities p rather than any other distribution q . The quantity that is non-negative is called the Kullbackâ€“Leibler divergence of q from p .  Since    âˆ’  l  o  g   (  x  )       normal-âˆ’  l  o  g  x    âˆ’log(x)   is a strictly convex function for    x  >  0      x  0    x>0   , it follows that equality holds when    p   (  x  )       p  x    p(x)   equals    q   (  x  )       q  x    q(x)   almost everywhere.  Raoâ€“Blackwell theorem  If L is a convex function, then from Jensen's inequality we get         L   (   ğ”¼   [   Î´   (  X  )    ]    )    â‰¤    ğ”¼   [   L   (   Î´   (  X  )    )    ]    â‡’      ğ”¼   [   L   (   ğ”¼   [   Î´   (  X  )    ]    )    ]    â‰¤   ğ”¼   [   L   (   Î´   (  X  )    )    ]      .     formulae-sequence      L    ğ”¼   delimited-[]    Î´  X         ğ”¼   delimited-[]    L    Î´  X      normal-â‡’        ğ”¼   delimited-[]    L    ğ”¼   delimited-[]    Î´  X          ğ”¼   delimited-[]    L    Î´  X         L(\mathbb{E}[\delta(X)])\leq\mathbb{E}[L(\delta(X))]\quad\Rightarrow\quad%
 \mathbb{E}[L(\mathbb{E}[\delta(X)])]\leq\mathbb{E}[L(\delta(X))].     So if Î´( X ) is some estimator of an unobserved parameter Î¸ given a vector of observables X ; and if T ( X ) is a sufficient statistic for Î¸; then an improved estimator, in the sense of having a smaller expected loss L , can be obtained by calculating       Î´  1    (  X  )   =   ğ”¼  Î¸    [  Î´   (   X  â€²   )   |  T   (   X  â€²   )   =  T   (  X  )   ]   ,     fragments   subscript  Î´  1    fragments  normal-(  X  normal-)     subscript  ğ”¼  Î¸    fragments  normal-[  Î´   fragments  normal-(   superscript  X  normal-â€²   normal-)   normal-|  T   fragments  normal-(   superscript  X  normal-â€²   normal-)    T   fragments  normal-(  X  normal-)   normal-]   normal-,    \delta_{1}(X)=\mathbb{E}_{\theta}[\delta(X^{\prime})\,|\,T(X^{\prime})=T(X)],     the expected value of Î´ with respect to Î¸, taken over all possible vectors of observations X compatible with the same value of T ( X ) as that observed.  This result is known as the Raoâ€“Blackwell theorem .  See also   Karamata's inequality for a more general inequality  Popoviciu's inequality  Law of averages  Proof without words   Notes  References    Tristan Needham (1993) "A Visual Explanation of Jensen's Inequality", American Mathematical Monthly 100(8):768â€“71.    External links   Jensen's Operator Inequality of Hansen and Pedersen.      "  Category:Inequalities  Category:Probabilistic inequalities  Category:Statistical inequalities  Category:Theorems in analysis  Category:Articles containing proofs  Category:Convex analysis     â†©  Attention: In this generality additional assumptions on the convex function and/ or the topological vector space are needed, see Example (1.3) on p.Â 53 in â†©     
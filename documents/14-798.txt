   Bloch wave – MoM method      Bloch wave – MoM method   Bloch wave – MoM is a technique for determining the band structure of triply-periodic electromagnetic media such as photonic crystals . This technique uses the method of moments (MoM) in combination with a Bloch wave expansion of the electromagnetic field in the structure. It is based on the 3-dimensional spectral domain method (Kastner [1987]). This approach is very efficient in terms of the number of plane waves needed for good convergence and is analogous to the spectral domain MoM method commonly used for analyzing 2D periodic structures such as frequency selective surfaces (FSS). In the latter case, the electromagnetic field is expanded in terms of a plane wave spectrum (Scott [1989]). In both cases, the field is expanded in terms or a set of eigenfunction modes (either a Bloch wave in 3D or a plane wave spectrum in 2D), and an integral equation is enforced on the surface of the scatterers in each unit cell. In the FSS case, the unit cell is 2-dimensional and in the photonic crystal case, the unit cell is 3-dimensional.  Field equations for 3D PEC photonic crystal structures  For perfectly electrically conducting (PEC) structures admitting only electric current sources J , the electric field E is related to the vector magnetic potential A via the well-known relation:       𝔼   =    -   j  k  η   [   𝔸  +    1   k  2     ∇   (   ∇  ∙  𝔸   )      ]      (  1.1  )        𝔼       j  k  η   delimited-[]    𝔸      1   superscript  k  2     normal-∇   normal-∙  normal-∇  𝔸         1.1     \mathbb{E}~{}=~{}-jk\eta\left[\mathbb{A}+\frac{1}{k^{2}}\nabla(\nabla\bullet%
 \mathbb{A})\right]~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(1.1)     and the vector magnetic potential is in turn related to the source currents via:         ∇  2   𝔸   +    k  2    𝔸     =    -  𝕁    (  1.2  )            superscript  normal-∇  2   𝔸      superscript  k  2   𝔸       𝕁   1.2     \nabla^{2}\mathbb{A}+k^{2}\mathbb{A}~{}=~{}-\mathbb{J}~{}~{}~{}~{}~{}~{}~{}~{}%
 ~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(1.2)     where        k  2    =     ω  2    (   μ  ϵ   )     (  1.3  )         superscript  k  2       superscript  ω  2     μ  ϵ    1.3     k^{2}~{}=~{}\omega^{2}(\mu\epsilon)~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~%
 {}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(%
 1.3)     Bloch wave expansion of the fields  To solve equations (1.1) and (1.2) within the periodic volume, we may assume a Bloch wave expansion for all currents, fields and potentials:       𝕁   (  x  ,  y  ,  z  )    =      ∑   m  n  p      𝕁   (   α  m   ,   β  n   ,   γ  p   )    e   j   (     α  m   x   +    β  n   y   +    γ  p   z    )        (   2.1  a   )          𝕁   x  y  z       subscript     m  n  p      𝕁    subscript  α  m    subscript  β  n    subscript  γ  p     superscript  e    j       subscript  α  m   x      subscript  β  n   y      subscript  γ  p   z          2.1  a      \mathbb{J}(x,y,z)~{}=~{}\sum_{mnp}~{}\mathbb{J}(\alpha_{m},\beta_{n},\gamma_{p%
 })~{}e^{j(\alpha_{m}x+\beta_{n}y+\gamma_{p}z)}~{}~{}~{}~{}~{}(2.1a)          𝔼   (  x  ,  y  ,  z  )    =      ∑   m  n  p      𝔼   (   α  m   ,   β  n   ,   γ  p   )    e   j   (     α  m   x   +    β  n   y   +    γ  p   z    )        (   2.1  b   )          𝔼   x  y  z       subscript     m  n  p      𝔼    subscript  α  m    subscript  β  n    subscript  γ  p     superscript  e    j       subscript  α  m   x      subscript  β  n   y      subscript  γ  p   z          2.1  b      \mathbb{E}(x,y,z)~{}=~{}\sum_{mnp}~{}\mathbb{E}(\alpha_{m},\beta_{n},\gamma_{p%
 })~{}e^{j(\alpha_{m}x+\beta_{n}y+\gamma_{p}z)}~{}~{}~{}~{}(2.1b)          𝔸   (  x  ,  y  ,  z  )    =     ∑   m  n  p      𝔸   (   α  m   ,   β  n   ,   γ  p   )     e   j   (     α  m   x   +    β  n   y   +    γ  p   z    )       (   2.1  c   )           𝔸   x  y  z      subscript     m  n  p      𝔸    subscript  α  m    subscript  β  n    subscript  γ  p     superscript  e    j       subscript  α  m   x      subscript  β  n   y      subscript  γ  p   z        2.1  c       \mathbb{A}(x,y,z)~{}=~{}\sum_{mnp}~{}\mathbb{A}(\alpha_{m},\beta_{n},\gamma_{p%
 })~{}e^{j(\alpha_{m}x+\beta_{n}y+\gamma_{p}z)}~{}~{}~{}(2.1c)     where for simplicity, we assume an orthogonal lattice in which α only depends on m , β only depends on n and γ only depends on p . In the equations above,        α  m    =       k  0     sin    θ  0      cos    ϕ  0      +    2  m  π    l  x      (   2.2  a   )         subscript  α  m         subscript  k  0      subscript  θ  0       subscript  ϕ  0         2  m  π    subscript  l  x       2.2  a      \alpha_{m}~{}=~{}k_{0}~{}\sin\theta_{0}~{}\cos\phi_{0}~{}+~{}\frac{2m\pi}{l_{x%
 }}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(2.2a)           β  n    =       k  0     sin    θ  0      sin    ϕ  0      +    2  n  π    l  y      (   2.2  b   )         subscript  β  n         subscript  k  0      subscript  θ  0       subscript  ϕ  0         2  n  π    subscript  l  y       2.2  b      \beta_{n}~{}=~{}k_{0}~{}\sin\theta_{0}~{}\sin\phi_{0}~{}+~{}\frac{2n\pi}{l_{y}%
 }~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(2.2b)           γ  p    =       k  0     cos    θ  0      +    2  p  π    l  z      (   2.2  c   )         subscript  γ  p         subscript  k  0      subscript  θ  0         2  p  π    subscript  l  z       2.2  c      \gamma_{p}~{}=~{}k_{0}~{}\cos\theta_{0}~{}+~{}\frac{2p\pi}{l_{z}}~{}~{}~{}~{}~%
 {}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(2.2c)     and,        k  0    =     2  π   /  λ    (  2.3  )         subscript  k  0        2  π   λ   2.3     k_{0}~{}=~{}2\pi/\lambda~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}%
 ~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(2.3)     where l x , l y , l z are the dimensions of the unit cell in the x , y , z directions respectively, λ is the effective wavelength in the crystal and θ 0 , φ 0 are the directions of propagation in spherical coordinates . Note that k in equations (1.1) and (1.2) comes from the time derivative in Maxwell's equations and is the free space propagation constant, proportional to frequency as we see in equation (1.3). On the other hand, k 0 in the equations above comes from our assumed Bloch wave solution given by equations (2.1) & (2.2). As a result, it represents the propagation constant in the periodic medium. These two k's , i.e. the free space propagation constant and the propagation constant of the Bloch wave, are in general different thereby allowing for dispersion in our solution.  Integral equation for PEC media  Substituting equations (2.1) into (1.1) and (1.2) yields the spectral domain Greens function relating the radiated electric field to its source currents:       𝔼   (   α  m   ,   β  n   ,   γ  p   )    =       j  k  η     k  2   -   α  m  2   -   β  n  2   -   γ  p  2        𝔾   m  n  p     𝕁   (   α  m   ,   β  n   ,   γ  p   )     (  3.1  )          𝔼    subscript  α  m    subscript  β  n    subscript  γ  p            j  k  η      superscript  k  2    superscript   subscript  α  m   2    superscript   subscript  β  n   2    superscript   subscript  γ  p   2      subscript  𝔾    m  n  p    𝕁    subscript  α  m    subscript  β  n    subscript  γ  p     3.1     \mathbb{E}(\alpha_{m},\beta_{n},\gamma_{p})~{}=~{}\frac{jk\eta}{k^{2}-\alpha_{%
 m}^{2}-\beta_{n}^{2}-\gamma_{p}^{2}}~{}\mathbb{G}_{mnp}~{}\mathbb{J}(\alpha_{m%
 },\beta_{n},\gamma_{p})~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~%
 {}~{}~{}~{}~{}~{}~{}(3.1)   where,        𝔾   m  n  p     =    (      1  -     α  m  2    k  2         -      α  m    β  n     k  2         -      α  m    γ  p     k  2           -      α  m    β  n     k  2         1  -     β  n  2    k  2         -      β  n    γ  p     k  2           -      α  m    γ  p     k  2         -      β  n    γ  p     k  2         1  -     γ  p  2    k  2         )    (  3.2  )         subscript  𝔾    m  n  p         1     superscript   subscript  α  m   2    superscript  k  2            subscript  α  m    subscript  β  n     superscript  k  2            subscript  α  m    subscript  γ  p     superscript  k  2              subscript  α  m    subscript  β  n     superscript  k  2       1     superscript   subscript  β  n   2    superscript  k  2            subscript  β  n    subscript  γ  p     superscript  k  2              subscript  α  m    subscript  γ  p     superscript  k  2            subscript  β  n    subscript  γ  p     superscript  k  2       1     superscript   subscript  γ  p   2    superscript  k  2       3.2     \mathbb{G}_{mnp}~{}=~{}\left(\begin{matrix}\par
  1-\frac{\alpha_{m}^{2}}{k^{2}%
 }&-\frac{\alpha_{m}\beta_{n}}{k^{2}}&-\frac{\alpha_{m}\gamma_{p}}{k^{2}}\\
 -\frac{\alpha_{m}\beta_{n}}{k^{2}}&1-\frac{\beta_{n}^{2}}{k^{2}}&-\frac{\beta_%
 {n}\gamma_{p}}{k^{2}}\\
 -\frac{\alpha_{m}\gamma_{p}}{k^{2}}&-\frac{\beta_{n}\gamma_{p}}{k^{2}}&1-\frac%
 {\gamma_{p}^{2}}{k^{2}}\par
 \end{matrix}\right)~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~%
 {}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~%
 {}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(3.2)     With this, the electric field boundary condition on the surface of PEC material within a unit cell becomes:         ∑   m  n  p        1    k  2   -   α  m  2   -   β  n  2   -   γ  p  2        𝔾   m  n  p     𝕁   (   α  m   ,   β  n   ,   γ  p   )     e   j   (     α  m   x   +    β  n   y   +    γ  p   z    )        =   𝟘   (  3.3  )          subscript     m  n  p        1     superscript  k  2    superscript   subscript  α  m   2    superscript   subscript  β  n   2    superscript   subscript  γ  p   2      subscript  𝔾    m  n  p    𝕁    subscript  α  m    subscript  β  n    subscript  γ  p     superscript  e    j       subscript  α  m   x      subscript  β  n   y      subscript  γ  p   z         0  3.3     ~{}\sum_{mnp}~{}\frac{1}{k^{2}-\alpha_{m}^{2}-\beta_{n}^{2}-\gamma_{p}^{2}}~{}%
 \mathbb{G}_{mnp}~{}\mathbb{J}(\alpha_{m},\beta_{n},\gamma_{p})~{}e^{j(\alpha_{%
 m}x+\beta_{n}y+\gamma_{p}z)}~{}=~{}\mathbb{0}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}%
 ~{}~{}~{}~{}~{}(3.3)     Since we are seeking characteristic modes (eigenmodes) of the structure, there is no impressed E-field on the RHS of this electric field integral equation (EFIE). Equation (3.3) is not strictly correct, since only the tangential electric field is zero on the surface of the PEC scatterer. This inexactness will be resolved presently when we test with the current basis functions, defined as residing on the surface of the scatterer.  Method of Moments solution  As is usual in the method of moments, we assume an expansion for the source currents over some known set of basis functions with unknown weighting coefficients J j :        𝕁    (  x  ,  y  ,  z  )    =      ∑  j       J  j     𝕁  j    (  x  ,  y  ,  z  )      (  3.4  )          𝕁   x  y  z       subscript   j      subscript  J  j    subscript  𝕁  j    x  y  z     3.4     ~{}\mathbb{J}(x,y,z)~{}=~{}\sum_{j}~{}J_{j}~{}\mathbb{J}_{j}(x,y,z)~{}~{}~{}~{%
 }~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}(3.4)     Substituting (3.4) into (3.3) and then testing the resulting equation with the i -th current basis function (i.e., dotting from the left and integrating over the domain of the i -th current basis function, thereby completing the quadratic form) produces the i -th row of the matrix eigenvalue problem as:         ∑  j       J  j     [     ∑   m  n  p        𝕁  i    (   -   α  m    ,   -   β  n    ,   -   γ  p    )     𝔾   m  n  p      𝕁  j    (   α  m   ,   β  n   ,   γ  p   )      k  2   -   α  m  2   -   β  n  2   -   γ  p  2      ]     =    𝟘    (  3.5  )          subscript   j      subscript  J  j    delimited-[]    subscript     m  n  p         subscript  𝕁  i       subscript  α  m       subscript  β  n       subscript  γ  p      subscript  𝔾    m  n  p     subscript  𝕁  j     subscript  α  m    subscript  β  n    subscript  γ  p        superscript  k  2    superscript   subscript  α  m   2    superscript   subscript  β  n   2    superscript   subscript  γ  p   2           0  3.5     ~{}\sum_{j}~{}J_{j}~{}\left[~{}\sum_{mnp}~{}\frac{\mathbb{J}_{i}(-\alpha_{m},-%
 \beta_{n},-\gamma_{p})~{}\mathbb{G}_{mnp}~{}\mathbb{J}_{j}(\alpha_{m},\beta_{n%
 },\gamma_{p})}{k^{2}-\alpha_{m}^{2}-\beta_{n}^{2}-\gamma_{p}^{2}}\right]~{}=~{%
 }\mathbb{0}~{}~{}~{}(3.5)     This matrix equation is very simple to implement and requires only that the 3D FT of the basis functions be computed, preferably in closed form. With this method, computing bands of a 3D photonic crystal is as easy as computing reflection and transmission from a 2D periodic surface . In fact, equation (3.5) is identical to the basic EFIE for a freestanding PEC FSS (Scott [1989] or Frequency selective surface eq. (4.2)), the only difference being the stronger singularity in 3D which accelerates convergence of the triple sums.  The real advantage of this method over the plane wave expansion method is that current unknowns are only needed over the surface of the scatterers in the unit cell, so the matrix eigenvalue problem can be as small as 1x1 for simple scatterers at low frequencies.  Computing bands  To compute bands of the crystal (i.e. k - k 0 diagrams), we may assume values for ( k 0 , θ 0 , φ 0 ) and then search for those values of k which drive the determinant of the impedance matrix to zero. Equation (3.5) has been used to compute bands in various types of doped and undoped photonic crystals (Scott[1998], Scott [2002]).  See also   Bloch wave  Photonic crystal  Metamaterial  Frequency selective surface  Fourier optics  Bragg diffraction   References        External links  "  Category:Photonics  Category:Optics  Category:Metamaterials  Category:Physical optics  Category:Fourier analysis   
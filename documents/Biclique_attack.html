<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="828">Biclique attack</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Biclique attack</h1>
<hr>A '''biclique attack''' is a variant of the [[Meet-in-the-middle attack|meet-in-the-middle]] (MITM) method of [[
<p>cryptanalysis]]. It utilizes a <a class="uri" href="biclique" title="wikilink">biclique</a> structure to extend the number of possibly attacked rounds by the MITM attack. Since biclique cryptanalysis is based on MITM attacks, it is applicable to both <a href="Block_cipher" title="wikilink">block ciphers</a> and (iterated) <a href="Cryptographic_hash_function" title="wikilink">hash-functions</a>. Biclique attacks are known for having broken both full <a href="Advanced_Encryption_Standard" title="wikilink">AES</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and full <a href="International_Data_Encryption_Algorithm" title="wikilink">IDEA</a>,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> though only with slight advantage over brute force. It has also been applied to the <a class="uri" href="KASUMI" title="wikilink">KASUMI</a> cipher and preimage resistance of the <a href="Skein_(hash_function)" title="wikilink">Skein-512</a> and <a class="uri" href="SHA-2" title="wikilink">SHA-2</a> hash functions.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The biclique attack is  the best publicly known single-key attack on <a href="Advanced_Encryption_Standard" title="wikilink">AES</a>. The computational complexity of the attack is 

<math display="inline" id="Biclique_attack:0">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>126.1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="float">126.1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{126.1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Biclique_attack:1">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>189.7</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="float">189.7</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{189.7}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:2">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>254.4</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="float">254.4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{254.4}
  </annotation>
 </semantics>
</math>

 for AES128, AES192 and AES256, respectively. It is the only publicly known single-key attack on AES that attacks the full number of rounds.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Previous attacks have attacked round reduced variants (typically variants reduced to 7 or 8 rounds).</p>

<p>As the computational complexity of the attack is 

<math display="inline" id="Biclique_attack:3">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>126.1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="float">126.1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{126.1}
  </annotation>
 </semantics>
</math>

, it is a theoretical attack, which means the security of AES has not been broken, and the use of AES remains relatively secure. The biclique attack is nevertheless an interesting attack, which suggests a new approach to performing cryptanalysis on block ciphers. The attack has also rendered more information about AES, as it has brought into question the safety-margin in the number of rounds used therein.</p>
<h2 id="history">History</h2>

<p>The original MITM attack was first suggested by Diffie and Hellman in 1977, when they discussed the cryptanalytic properties of DES.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> They argued that the key-size was too small, and that reapplying DES multiple times with different keys, could be a solution to the key-size; however, they advised against using double-DES and suggested triple-DES as a minimum, due to MITM attacks (MITM attacks can easily be applied to double-DES to reduce the security from 

<math display="inline" id="Biclique_attack:4">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>56</mn>
    <mo>*</mo>
    <mn>2</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">56</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{56*2}
  </annotation>
 </semantics>
</math>

 to just 

<math display="inline" id="Biclique_attack:5">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mo>*</mo>
   <msup>
    <mn>2</mn>
    <mn>56</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">56</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2*2^{56}
  </annotation>
 </semantics>
</math>

, since one can independently bruteforce the first and the second DES-encryption if they have the plain- and ciphertext).</p>

<p>Since Diffie and Hellman suggested MITM attacks, many variations have emerged that are useful in situations, where the basic MITM attack is inapplicable. The biclique attack variant, was first suggested by Khovratovich, Rechberger and Savelieva for use with hash-function cryptanalysis.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> However, it was Bogdanov, Khovratovich and Rechberger who showed how to apply the concept of bicliques to the secret-key setting including block-cipher cryptanalysis, when they published their attack on AES. Prior to this, MITM attacks on AES and many other block ciphers had received little attention. Mostly due to the need for independent key bits between the two 'MITM subciphers' in order to facilitate the MITM attack — something that is hard to achieve with many modern key schedules, such as that of AES.</p>
<h2 id="the-biclique">The biclique</h2>

<p>For a general explanation of what a biclique structure is, see the wiki-page for <a href="Complete_bipartite_graph" title="wikilink">bicliques</a>.</p>

<p>In a MITM attack, the keybits 

<math display="inline" id="Biclique_attack:6">
 <semantics>
  <msub>
   <mi>K</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:7">
 <semantics>
  <msub>
   <mi>K</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{2}
  </annotation>
 </semantics>
</math>

, belonging to the first and second subcipher, needs to be independent; that is, they need to be independent of each other, else the matched intermediate values for the plain- and ciphertext cannot be computed independently in the MITM attack (there are variants of MITM attacks, where the blocks can have shared key-bits. See the <a href="3-Subset_Meet-in-the-Middle_attack" title="wikilink">3-subset MITM attack</a>). This property is often hard to exploit over a larger number of rounds, due to the diffusion of the attacked cipher.<br/>
Simply put: The more rounds you attack, the larger subciphers you will have. The larger subciphers you have, the less independent key-bits between the subciphers you will have to bruteforce independently. Of course, the actual amount of independent key-bits in each subcipher, depends on the diffusion properties of the key-schedule.</p>

<p>The way the biclique helps with tackling the above, is that it allows one to - for instance - attack 7 rounds of AES using MITM attacks, and then by utilizing a biclique structure of length 3 (i.e. it covers 3 rounds of the cipher), you can map the intermediate state at the start of round 7 to the end of the last round, e.g. 10 (if it is AES128), thus attacking the full number of rounds of the cipher, even if it was not possible to attack that amount of rounds with a basic MITM attack.</p>

<p>The meaning of the biclique is thus to build a structure effectively, which can map an intermediate value at the end of the MITM attack to the ciphertext at the end. Which ciphertext the intermediate state gets mapped to at the end, of course depends on the key used for the encryption. The key used to map the state to the ciphertext in the biclique, is based on the keybits bruteforced in the first and second subcipher of the MITM attack.</p>

<p>The essence of biclique attacks is thus, besides the MITM attack, to be able to build a biclique structure effectively, that depending on the keybits 

<math display="inline" id="Biclique_attack:8">
 <semantics>
  <msub>
   <mi>K</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:9">
 <semantics>
  <msub>
   <mi>K</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{2}
  </annotation>
 </semantics>
</math>

 can map a certain intermediate state to the corresponding ciphertext.</p>
<h2 id="how-to-build-the-biclique">How to build the biclique</h2>
<h3 id="bruteforce">Bruteforce</h3>

<p>Get 

<math display="inline" id="Biclique_attack:10">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 intermediate states and 

<math display="inline" id="Biclique_attack:11">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 ciphertexts, then compute the keys that maps between them. This requires 

<math display="inline" id="Biclique_attack:12">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 key-recoveries, since each intermediate state needs to be linked to all ciphertexts.</p>
<h3 id="independent-related-key-differentials">Independent related-key differentials</h3>

<p>(This method was suggested by Bogdanov, Khovratovich and Rechberger in their paper: Biclique Cryptanalysis of the Full AES)</p>

<p><strong>Preliminary:</strong><br/>
Remember that the function of the biclique is to map the intermediate values, 

<math display="inline" id="Biclique_attack:13">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

, to the ciphertext-values, 

<math display="inline" id="Biclique_attack:14">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

, based on the key 

<math display="inline" id="Biclique_attack:15">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

 such that:<br/>


<math display="inline" id="Biclique_attack:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∀</mo>
     <mi>i</mi>
    </mrow>
    <mo>,</mo>
    <mi>j</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>j</mi>
    </msub>
    <munder accentunder="true">
     <mover accent="true">
      <mo>→</mo>
      <mrow>
       <mi>K</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mover>
     <mo>𝑓</mo>
    </munder>
    <msub>
     <mi>C</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <list>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <ci>i</ci>
     </apply>
     <ci>j</ci>
    </list>
    <apply>
     <apply>
      <ci>f</ci>
      <apply>
       <apply>
        <times></times>
        <ci>K</ci>
        <interval closure="closed">
         <ci>i</ci>
         <ci>j</ci>
        </interval>
       </apply>
       <ci>normal-→</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \forall i,j:S_{j}\xrightarrow[f]{K[i,j]}C_{i}
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Procedure:</strong><br/>
<u>Step one:</u> An intermediate state(

<math display="inline" id="Biclique_attack:17">
 <semantics>
  <msub>
   <mi>S</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{0}
  </annotation>
 </semantics>
</math>

), a ciphertext(

<math display="inline" id="Biclique_attack:18">
 <semantics>
  <msub>
   <mi>C</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{0}
  </annotation>
 </semantics>
</math>

) and a key(

<math display="inline" id="Biclique_attack:19">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,0]
  </annotation>
 </semantics>
</math>

) is chosen such that

<math display="block" id="Biclique_attack:20">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mn>0</mn>
   </msub>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mn>0</mn>
       <mo>,</mo>
       <mn>0</mn>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <msub>
    <mi>C</mi>
    <mi>o</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>f</ci>
     <apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <interval closure="closed">
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </interval>
      </apply>
      <ci>normal-→</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>o</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{0}\xrightarrow[f]{K[0,0]}C_{o}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Biclique_attack:21">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is the function that maps an intermediate state to a ciphertext using a given key. This is denoted as the base computation.</p>

<p><u>Step two:</u> Two sets of related keys of size 

<math display="inline" id="Biclique_attack:22">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 is chosen. The keys are chosen such that:</p>
<ul>
<li>The first set of keys are keys, which fulfills the following differential-requirements over 

<math display="inline" id="Biclique_attack:23">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 with respect to the base computation

<math display="block" id="Biclique_attack:24">
 <semantics>
  <mrow>
   <mn>0</mn>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <msubsup>
      <mi mathvariant="normal">Δ</mi>
      <mi>i</mi>
      <mi>K</mi>
     </msubsup>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <msub>
    <mi mathvariant="normal">Δ</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>f</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Δ</ci>
        <ci>K</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>normal-→</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Δ</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\xrightarrow[f]{\Delta^{K}_{i}}\Delta_{i}
  </annotation>
 </semantics>
</math>

</li>
<li>The second set of keys are keys, which fulfills the following differential-requirements over 

<math display="inline" id="Biclique_attack:25">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 with respect to the base computation

<math display="block" id="Biclique_attack:26">
 <semantics>
  <mrow>
   <msub>
    <mo>∇</mo>
    <mi>j</mi>
   </msub>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <msubsup>
      <mo>∇</mo>
      <mi>j</mi>
      <mi>K</mi>
     </msubsup>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>f</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-∇</ci>
        <ci>K</ci>
       </apply>
       <ci>j</ci>
      </apply>
      <ci>normal-→</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-∇</ci>
     <ci>j</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{j}\xrightarrow[f]{\nabla^{K}_{j}}0
  </annotation>
 </semantics>
</math>

</li>
<li>The keys are chosen such that the trails of the 

<math display="inline" id="Biclique_attack:27">
 <semantics>
  <msub>
   <mi mathvariant="normal">Δ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Δ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta_{i}
  </annotation>
 </semantics>
</math>

- and 

<math display="inline" id="Biclique_attack:28">
 <semantics>
  <msub>
   <mo>∇</mo>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-∇</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{j}
  </annotation>
 </semantics>
</math>

-differentials are independent - i.e. they do not share any active non-linear components.</li>
</ul>

<p>In other words:<br/>
An input difference of 0 should map to an output difference of 

<math display="inline" id="Biclique_attack:29">
 <semantics>
  <msub>
   <mi mathvariant="normal">Δ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Δ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta_{i}
  </annotation>
 </semantics>
</math>

 under a key difference of 

<math display="inline" id="Biclique_attack:30">
 <semantics>
  <msubsup>
   <mi mathvariant="normal">Δ</mi>
   <mi>i</mi>
   <mi>K</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Δ</ci>
     <ci>K</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{K}_{i}
  </annotation>
 </semantics>
</math>

. All differences are in respect to the base computation.<br/>
An input difference of 

<math display="inline" id="Biclique_attack:31">
 <semantics>
  <msub>
   <mo>∇</mo>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-∇</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{j}
  </annotation>
 </semantics>
</math>

 should map to an output difference of 0 under a key difference of 

<math display="inline" id="Biclique_attack:32">
 <semantics>
  <msubsup>
   <mo>∇</mo>
   <mi>J</mi>
   <mi>K</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-∇</ci>
     <ci>K</ci>
    </apply>
    <ci>J</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla^{K}_{J}
  </annotation>
 </semantics>
</math>

. All differences are in respect to the base computation.</p>

<p><u>Step three:</u> Since the trails do not share any non-linear components (such as S-boxes), the trails can be combined to get:<br/>


<math display="inline" id="Biclique_attack:33">
 <semantics>
  <mrow>
   <mn>0</mn>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <msubsup>
      <mi mathvariant="normal">Δ</mi>
      <mi>i</mi>
      <mi>K</mi>
     </msubsup>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <mrow>
    <msub>
     <mi mathvariant="normal">Δ</mi>
     <mi>i</mi>
    </msub>
    <mo>⊕</mo>
    <msub>
     <mo>∇</mo>
     <mi>j</mi>
    </msub>
   </mrow>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <msubsup>
      <mo>∇</mo>
      <mi>j</mi>
      <mi>K</mi>
     </msubsup>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <mn>0</mn>
   <mo>=</mo>
   <msub>
    <mo>∇</mo>
    <mi>j</mi>
   </msub>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <msubsup>
       <mi mathvariant="normal">Δ</mi>
       <mi>i</mi>
       <mi>K</mi>
      </msubsup>
      <mo>⊕</mo>
      <msubsup>
       <mo>∇</mo>
       <mi>j</mi>
       <mi>K</mi>
      </msubsup>
     </mrow>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <msub>
    <mi mathvariant="normal">Δ</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <ci>f</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Δ</ci>
         <ci>K</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <ci>normal-→</ci>
      </apply>
     </apply>
     <cn type="integer">0</cn>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Δ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-∇</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <ci>f</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-∇</ci>
         <ci>K</ci>
        </apply>
        <ci>j</ci>
       </apply>
       <ci>normal-→</ci>
      </apply>
     </apply>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <ci>f</ci>
      <apply>
       <apply>
        <csymbol cd="latexml">direct-sum</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>normal-Δ</ci>
          <ci>K</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>normal-∇</ci>
          <ci>K</ci>
         </apply>
         <ci>j</ci>
        </apply>
       </apply>
       <ci>normal-→</ci>
      </apply>
     </apply>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Δ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\xrightarrow[f]{\Delta^{K}_{i}}\Delta_{i}\oplus\nabla_{j}\xrightarrow[f]{%
\nabla^{K}_{j}}0=\nabla_{j}\xrightarrow[f]{\Delta^{K}_{i}\oplus\nabla^{K}_{j}}%
\Delta_{i}
  </annotation>
 </semantics>
</math>

,<br/>
which conforms to the definitions of both the differentials from step 2.<br/>
It is trivial to see that the tuple 

<math display="inline" id="Biclique_attack:34">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>S</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>C</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mrow>
    <mi>K</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>K</ci>
     <interval closure="closed">
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </interval>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (S_{0},C_{0},K[0,0])
  </annotation>
 </semantics>
</math>

 from the base computation, also conforms by definition to both the differentials, as the differentials are in respect to the base computation. Substituting 

<math display="inline" id="Biclique_attack:35">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>C</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <cn type="integer">0</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{0},C_{0}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Biclique_attack:36">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,0]
  </annotation>
 </semantics>
</math>

 into any of the two definitions, will yield 

<math display="inline" id="Biclique_attack:37">
 <semantics>
  <mrow>
   <mn>0</mn>
   <munderover accent="true" accentunder="true">
    <mo>→</mo>
    <mo>𝑓</mo>
    <mo>0</mo>
   </munderover>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>f</ci>
     <apply>
      <ci>normal-0</ci>
      <ci>normal-→</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\xrightarrow[f]{0}0
  </annotation>
 </semantics>
</math>

 since 

<math display="inline" id="Biclique_attack:38">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Δ</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mo>∇</mo>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Δ</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta_{0}=0,\nabla_{0}=0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:39">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Δ</mi>
    <mn>0</mn>
    <mi>K</mi>
   </msubsup>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Δ</ci>
      <ci>K</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{K}_{0}=0
  </annotation>
 </semantics>
</math>

.<br/>
This means that the tuple of the base computation, can also be XOR'ed to the combined trails: 

<math display="inline" id="Biclique_attack:40">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>0</mn>
    </msub>
    <mo>⊕</mo>
    <msub>
     <mo>∇</mo>
     <mi>j</mi>
    </msub>
   </mrow>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <mrow>
       <mi>K</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mn>0</mn>
        <mo>,</mo>
        <mn>0</mn>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo>⊕</mo>
      <msubsup>
       <mi mathvariant="normal">Δ</mi>
       <mi>i</mi>
       <mi>K</mi>
      </msubsup>
      <mo>⊕</mo>
      <msubsup>
       <mo>∇</mo>
       <mi>j</mi>
       <mi>K</mi>
      </msubsup>
     </mrow>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <mrow>
    <msub>
     <mi>C</mi>
     <mn>0</mn>
    </msub>
    <mo>⊕</mo>
    <msub>
     <mi mathvariant="normal">Δ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>f</ci>
     <apply>
      <apply>
       <csymbol cd="latexml">direct-sum</csymbol>
       <apply>
        <times></times>
        <ci>K</ci>
        <interval closure="closed">
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </interval>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Δ</ci>
         <ci>K</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-∇</ci>
         <ci>K</ci>
        </apply>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>normal-→</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Δ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{0}\oplus\nabla_{j}\xrightarrow[f]{K[0,0]\oplus\Delta^{K}_{i}\oplus\nabla^{K%
}_{j}}C_{0}\oplus\Delta_{i}
  </annotation>
 </semantics>
</math>

 <u>Step four:</u> It is trivial to see that:<br/>


<math display="inline" id="Biclique_attack:41">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>0</mn>
    </msub>
    <mo>⊕</mo>
    <msub>
     <mo>∇</mo>
     <mi>j</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}=S_{0}\oplus\nabla_{j}
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Biclique_attack:42">
 <semantics>
  <mrow>
   <mrow>
    <mi>K</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>⊕</mo>
    <msubsup>
     <mi mathvariant="normal">Δ</mi>
     <mi>i</mi>
     <mi>K</mi>
    </msubsup>
    <mo>⊕</mo>
    <msubsup>
     <mo>∇</mo>
     <mi>j</mi>
     <mi>K</mi>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>K</ci>
     <interval closure="closed">
      <ci>i</ci>
      <ci>j</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>K</ci>
      <interval closure="closed">
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </interval>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Δ</ci>
       <ci>K</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-∇</ci>
       <ci>K</ci>
      </apply>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]=K[0,0]\oplus\Delta^{K}_{i}\oplus\nabla^{K}_{j}
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Biclique_attack:43">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mn>0</mn>
    </msub>
    <mo>⊕</mo>
    <msub>
     <mi mathvariant="normal">Δ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Δ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{i}=C_{0}\oplus\Delta_{i}
  </annotation>
 </semantics>
</math>

<br/>
If this is substituted into the above combined differential trails, the result will be:<br/>


<math display="inline" id="Biclique_attack:44">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>j</mi>
   </msub>
   <munder accentunder="true">
    <mover accent="true">
     <mo>→</mo>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mover>
    <mo>𝑓</mo>
   </munder>
   <msub>
    <mi>C</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>f</ci>
     <apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <interval closure="closed">
        <ci>i</ci>
        <ci>j</ci>
       </interval>
      </apply>
      <ci>normal-→</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}\xrightarrow[f]{K[i,j]}C_{i}
  </annotation>
 </semantics>
</math>

<br/>
Which is the same as the definition, there was earlier had above for a biclique:<br/>


<math display="inline" id="Biclique_attack:45">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∀</mo>
     <mi>i</mi>
    </mrow>
    <mo>,</mo>
    <mi>j</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>j</mi>
    </msub>
    <munder accentunder="true">
     <mover accent="true">
      <mo>→</mo>
      <mrow>
       <mi>K</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mover>
     <mo>𝑓</mo>
    </munder>
    <msub>
     <mi>C</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <list>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <ci>i</ci>
     </apply>
     <ci>j</ci>
    </list>
    <apply>
     <apply>
      <ci>f</ci>
      <apply>
       <apply>
        <times></times>
        <ci>K</ci>
        <interval closure="closed">
         <ci>i</ci>
         <ci>j</ci>
        </interval>
       </apply>
       <ci>normal-→</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \forall i,j:S_{j}\xrightarrow[f]{K[i,j]}C_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>It is thus possible to create a biclique of size 

<math display="inline" id="Biclique_attack:46">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 (

<math display="inline" id="Biclique_attack:47">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 since all 

<math display="inline" id="Biclique_attack:48">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 keys of the first set of keys, can be combined with the 

<math display="inline" id="Biclique_attack:49">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 keys from the second set of keys). This means a biclique of size 

<math display="inline" id="Biclique_attack:50">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 can be created using only 

<math display="inline" id="Biclique_attack:51">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mo>*</mo>
   <msup>
    <mn>2</mn>
    <mi>d</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2*2^{d}
  </annotation>
 </semantics>
</math>

 computations of the differentials 

<math display="inline" id="Biclique_attack:52">
 <semantics>
  <msub>
   <mi mathvariant="normal">Δ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Δ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:53">
 <semantics>
  <msub>
   <mo>∇</mo>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-∇</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{j}
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="Biclique_attack:54">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Biclique_attack:55">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Δ</mi>
    <mi>i</mi>
   </msub>
   <mo>≠</mo>
   <msub>
    <mo>∇</mo>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Δ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-∇</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta_{i}\neq\nabla_{j}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Biclique_attack:56">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mi>j</mi>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i+j>0
  </annotation>
 </semantics>
</math>

 then all of the keys 

<math display="inline" id="Biclique_attack:57">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

 will also be different in the biclique.</p>

<p>This way is how the biclique is constructed in the leading biclique attack on AES. It should be noted that there are some practical limitations in constructing bicliques with this technique. The longer the biclique is, the more rounds the differential trails has to cover. The diffusion properties of the cipher, thus plays a crucial role in the effectiveness of constructing the biclique.</p>
<h3 id="other-ways-of-constructing-the-biclique">Other ways of constructing the biclique</h3>

<p>Bogdanov, Khovratovich and Rechberger also describe another way to construct the biclique, called 'Interleaving Related-Key Differential Trails' in the article: "Biclique Cryptanalysis of the Full AES".</p>
<h2 id="biclique-cryptanalysis-procedure">Biclique Cryptanalysis procedure</h2>

<p><u>Step one:</u> The attacker groups all possible keys into key-subsets of size 

<math display="inline" id="Biclique_attack:58">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="Biclique_attack:59">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

, where the key in a group is indexed as 

<math display="inline" id="Biclique_attack:60">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

 in a matrix of size 

<math display="inline" id="Biclique_attack:61">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>d</mi>
   </msup>
   <mo>×</mo>
   <msup>
    <mn>2</mn>
    <mi>d</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}\times 2^{d}
  </annotation>
 </semantics>
</math>

. The attacker splits the cipher into two sub-ciphers, 

<math display="inline" id="Biclique_attack:62">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:63">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 (such that 

<math display="inline" id="Biclique_attack:64">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mo>∘</mo>
    <mi>g</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <compose></compose>
     <ci>f</ci>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=f\circ g
  </annotation>
 </semantics>
</math>

), as in a normal MITM attack. The set of keys for each of the sub-ciphers is of cardinality 

<math display="inline" id="Biclique_attack:65">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

, and is called 

<math display="inline" id="Biclique_attack:66">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,0]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:67">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,j]
  </annotation>
 </semantics>
</math>

. The combined key of the sub-ciphers is expressed with the aforementioned matrix 

<math display="inline" id="Biclique_attack:68">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

.</p>

<p><u>Step two:</u> The attacker builds a biclique for each group of 

<math display="inline" id="Biclique_attack:69">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 keys. The biclique is of dimension-d, since it maps 

<math display="inline" id="Biclique_attack:70">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 internal states, 

<math display="inline" id="Biclique_attack:71">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}
  </annotation>
 </semantics>
</math>

, to 

<math display="inline" id="Biclique_attack:72">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 ciphertexts, 

<math display="inline" id="Biclique_attack:73">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{i}
  </annotation>
 </semantics>
</math>

, using 

<math display="inline" id="Biclique_attack:74">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{2d}
  </annotation>
 </semantics>
</math>

 keys. The section "How to build the biclique" suggests how to build the biclique using "Independent related-key differentials". The biclique is in that case built using the differentials of the set of keys, 

<math display="inline" id="Biclique_attack:75">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,0]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:76">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,j]
  </annotation>
 </semantics>
</math>

, belonging to the sub-ciphers.</p>

<p><u>Step three:</u> The attacker takes the 

<math display="inline" id="Biclique_attack:77">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 possible ciphertexts, 

<math display="inline" id="Biclique_attack:78">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{i}
  </annotation>
 </semantics>
</math>

, and asks a decryption-oracle to provide the matching plaintexts, 

<math display="inline" id="Biclique_attack:79">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}
  </annotation>
 </semantics>
</math>

.</p>

<p><u>Step four:</u> The attacker chooses an internal state, 

<math display="inline" id="Biclique_attack:80">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}
  </annotation>
 </semantics>
</math>

 and the corresponding plaintext, 

<math display="inline" id="Biclique_attack:81">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}
  </annotation>
 </semantics>
</math>

, and performs the usual MITM attack over 

<math display="inline" id="Biclique_attack:82">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:83">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 by attacking from the internal state and the plaintext.</p>

<p><u>Step five:</u> Whenever a key-candidate is found that matches 

<math display="inline" id="Biclique_attack:84">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Biclique_attack:85">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}
  </annotation>
 </semantics>
</math>

, that key is tested on another plain-/ciphertext pair. if the key validates on the other pair, it is highly likely that it is the correct key.</p>
<h2 id="example-attack">Example attack</h2>

<p>The following example is based on the biclique attack on AES from the paper "Biclique Cryptanalysis of the Full AES".<br/>
The descriptions in the example uses the same terminology that the authors of the attack used (i.e. for variable names, etc).<br/>
For simplicity it is the attack on the AES128 variant that is covered below.<br/>
The attack consists of a 7-round MITM attack with the biclique covering the last 3 rounds.</p>
<h3 id="key-partitioning">Key partitioning</h3>

<p>The key-space is partitioned into 

<math display="inline" id="Biclique_attack:86">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>112</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">112</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{112}
  </annotation>
 </semantics>
</math>

 groups of keys, where each group consist of 

<math display="inline" id="Biclique_attack:87">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>16</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">16</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{16}
  </annotation>
 </semantics>
</math>

 keys.<br/>
For each of the 

<math display="inline" id="Biclique_attack:88">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>112</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">112</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{112}
  </annotation>
 </semantics>
</math>

 groups, a unique base-key 

<math display="inline" id="Biclique_attack:89">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,0]
  </annotation>
 </semantics>
</math>

 for the base-computation is selected.<br/>
The base-key has two specific bytes set to zero, shown in the below table (which represents the key the same way AES does in a 4x4 matrix for AES128):<br/>
:

<math display="block" id="Biclique_attack:90">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <minus></minus>
     <minus></minus>
     <minus></minus>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <minus></minus>
     <minus></minus>
     <minus></minus>
    </matrixrow>
    <matrixrow>
     <minus></minus>
     <minus></minus>
     <minus></minus>
     <minus></minus>
    </matrixrow>
    <matrixrow>
     <minus></minus>
     <minus></minus>
     <minus></minus>
     <minus></minus>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}-&-&-&0\\
0&-&-&-\\
-&-&-&-\\
-&-&-&-\end{bmatrix}
  </annotation>
 </semantics>
</math>

 The remaining 14 bytes (112 bits) of the key is then enumerated. This yields 

<math display="inline" id="Biclique_attack:91">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>112</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">112</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{112}
  </annotation>
 </semantics>
</math>

 unique base-keys; one for each group of keys.<br/>
The ordinary 

<math display="inline" id="Biclique_attack:92">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>16</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">16</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{16}
  </annotation>
 </semantics>
</math>

 keys in each group is then chosen with respect to their base-key. They are chosen such that they are nearly identical to the base-key. They only vary in 2 bytes (either the 

<math display="inline" id="Biclique_attack:93">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

's or the 

<math display="inline" id="Biclique_attack:94">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

's) of the below shown 4 bytes:<br/>
:

<math display="block" id="Biclique_attack:95">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mi>i</mi>
     </mtd>
     <mtd columnalign="center">
      <mi>i</mi>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mi>j</mi>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mi>j</mi>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
     <mtd columnalign="center">
      <mo>-</mo>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <minus></minus>
     <minus></minus>
     <ci>i</ci>
     <ci>i</ci>
    </matrixrow>
    <matrixrow>
     <ci>j</ci>
     <minus></minus>
     <ci>j</ci>
     <minus></minus>
    </matrixrow>
    <matrixrow>
     <minus></minus>
     <minus></minus>
     <minus></minus>
     <minus></minus>
    </matrixrow>
    <matrixrow>
     <minus></minus>
     <minus></minus>
     <minus></minus>
     <minus></minus>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}-&-&i&i\\
j&-&j&-\\
-&-&-&-\\
-&-&-&-\end{bmatrix}
  </annotation>
 </semantics>
</math>

 This gives 

<math display="inline" id="Biclique_attack:96">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>8</mn>
   </msup>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">8</cn>
    </apply>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{8}K[i,0]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:97">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>8</mn>
   </msup>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">8</cn>
    </apply>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{8}K[0,j]
  </annotation>
 </semantics>
</math>

, which combined gives 

<math display="inline" id="Biclique_attack:98">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>16</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">16</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{16}
  </annotation>
 </semantics>
</math>

 different keys, 

<math display="inline" id="Biclique_attack:99">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

. these 

<math display="inline" id="Biclique_attack:100">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>16</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">16</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{16}
  </annotation>
 </semantics>
</math>

 keys constitute the keys in the group for a respective base key.</p>
<h3 id="biclique-construction">Biclique construction</h3>

<p>

<math display="inline" id="Biclique_attack:101">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>112</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">112</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{112}
  </annotation>
 </semantics>
</math>

 bicliques is constructed using the "Independent related-key differentials" technique, as described in the "How to construct the biclique" section.<br/>
The requirement for using that technique, was that the forward- and backward-differential trails that need to be combined, did not share any active non-linear elements. How is it known that this is the case?<br/>
Due to the way the keys in step 1 is chosen in relation to the base key, the differential trails 

<math display="inline" id="Biclique_attack:102">
 <semantics>
  <msub>
   <mi mathvariant="normal">Δ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Δ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta_{i}
  </annotation>
 </semantics>
</math>

 using the keys 

<math display="inline" id="Biclique_attack:103">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,0]
  </annotation>
 </semantics>
</math>

 never share any active S-boxes (which is the only non-linear component in AES), with the differential trails 

<math display="inline" id="Biclique_attack:104">
 <semantics>
  <msub>
   <mo>∇</mo>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-∇</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{j}
  </annotation>
 </semantics>
</math>

 using the key 

<math display="inline" id="Biclique_attack:105">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,j]
  </annotation>
 </semantics>
</math>

. It is therefore possible to XOR the differential trails and create the biclique.</p>
<h3 id="mitm-attack">MITM attack</h3>

<p>When the bicliques are created, the MITM attack can almost begin. Before doing the MITM attack, the 

<math display="inline" id="Biclique_attack:106">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 intermediate values from the plaintext:<br/>


<math display="inline" id="Biclique_attack:107">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>i</mi>
   </msub>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>i</mi>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mover>
   <munderover accent="true" accentunder="true">
    <mo>→</mo>
    <msub>
     <mi>v</mi>
     <mi>i</mi>
    </msub>
    <mi></mi>
   </munderover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <apply>
      <times></times>
      <ci>K</ci>
      <interval closure="closed">
       <ci>i</ci>
       <cn type="integer">0</cn>
      </interval>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">absent</csymbol>
      <ci>normal-→</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}\xrightarrow[]{K[i,0]}\xrightarrow[v_{i}]{}
  </annotation>
 </semantics>
</math>

,<br/>
the 

<math display="inline" id="Biclique_attack:108">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>d</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{d}
  </annotation>
 </semantics>
</math>

 intermediate values from the ciphertext:<br/>


<math display="inline" id="Biclique_attack:109">
 <semantics>
  <mrow>
   <munderover accent="true" accentunder="true">
    <mo>←</mo>
    <msub>
     <mi>v</mi>
     <mi>j</mi>
    </msub>
    <mi></mi>
   </munderover>
   <mover accent="true">
    <mo>←</mo>
    <mrow>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mi>j</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mover>
   <msub>
    <mi>S</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">absent</csymbol>
      <ci>normal-←</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <times></times>
      <ci>K</ci>
      <interval closure="closed">
       <cn type="integer">0</cn>
       <ci>j</ci>
      </interval>
     </apply>
     <ci>normal-←</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>j</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xleftarrow[v_{j}]{}\xleftarrow[]{K[0,j]}S_{j}
  </annotation>
 </semantics>
</math>

,<br/>
and the corresponding intermediate states and sub-keys 

<math display="inline" id="Biclique_attack:110">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mn>0</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <cn type="integer">0</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,0]
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Biclique_attack:111">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[0,j]
  </annotation>
 </semantics>
</math>

, are precomputed and stored, however.</p>

<p>Now the MITM attack can be carried out. In order to test a key 

<math display="inline" id="Biclique_attack:112">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

, It is only necessary to recalculate the parts of the cipher, which is known will vary between 

<math display="inline" id="Biclique_attack:113">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>i</mi>
   </msub>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>i</mi>
      <mo>,</mo>
      <mn>0</mn>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mover>
   <munderover accent="true" accentunder="true">
    <mo>→</mo>
    <msub>
     <mi>v</mi>
     <mi>i</mi>
    </msub>
    <mi></mi>
   </munderover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <apply>
      <times></times>
      <ci>K</ci>
      <interval closure="closed">
       <ci>i</ci>
       <cn type="integer">0</cn>
      </interval>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">absent</csymbol>
      <ci>normal-→</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}\xrightarrow[]{K[i,0]}\xrightarrow[v_{i}]{}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:114">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>i</mi>
   </msub>
   <mover accent="true">
    <mo>→</mo>
    <mrow>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mover>
   <munderover accent="true" accentunder="true">
    <mo>→</mo>
    <msub>
     <mi>v</mi>
     <mi>i</mi>
    </msub>
    <mi></mi>
   </munderover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <apply>
      <times></times>
      <ci>K</ci>
      <interval closure="closed">
       <ci>i</ci>
       <ci>j</ci>
      </interval>
     </apply>
     <ci>normal-→</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">absent</csymbol>
      <ci>normal-→</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}\xrightarrow[]{K[i,j]}\xrightarrow[v_{i}]{}
  </annotation>
 </semantics>
</math>

. For the backward computation from 

<math display="inline" id="Biclique_attack:115">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Biclique_attack:116">
 <semantics>
  <munderover accent="true" accentunder="true">
   <mo>←</mo>
   <msub>
    <mi>v</mi>
    <mi>j</mi>
   </msub>
   <mi></mi>
  </munderover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">absent</csymbol>
     <ci>normal-←</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xleftarrow[v_{j}]{}
  </annotation>
 </semantics>
</math>

, this is 4 S-boxes that needs to be recomputed. For the forwards computation from 

<math display="inline" id="Biclique_attack:117">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Biclique_attack:118">
 <semantics>
  <munderover accent="true" accentunder="true">
   <mo>→</mo>
   <msub>
    <mi>v</mi>
    <mi>i</mi>
   </msub>
   <mi></mi>
  </munderover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">absent</csymbol>
     <ci>normal-→</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xrightarrow[v_{i}]{}
  </annotation>
 </semantics>
</math>

, it is just 3 (an in-depth explanation for the amount of needed recalculation can be found in "Biclique Cryptanalysis of the full AES" paper, where this example is taken from).</p>

<p>When the intermediate values match, a key-candidate 

<math display="inline" id="Biclique_attack:119">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <interval closure="closed">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K[i,j]
  </annotation>
 </semantics>
</math>

 between 

<math display="inline" id="Biclique_attack:120">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Biclique_attack:121">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{j}
  </annotation>
 </semantics>
</math>

 is found. The key-candidate is then tested on another plain-/ciphertext pair.</p>
<h3 id="results">Results</h3>

<p>This attack lowers the computational complexity of AES128 to 

<math display="inline" id="Biclique_attack:122">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>126.18</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="float">126.18</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{126.18}
  </annotation>
 </semantics>
</math>

, which is 3-5 faster than a bruteforce approach. The data complexity of the attack is 

<math display="inline" id="Biclique_attack:123">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>88</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">88</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{88}
  </annotation>
 </semantics>
</math>

 and the memory complexity is 

<math display="inline" id="Biclique_attack:124">
 <semantics>
  <msup>
   <mn>2</mn>
   <mn>8</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <cn type="integer">8</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{8}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://research.microsoft.com/en-us/projects/cryptanalysis/aesbc.pdf">Biclique Cryptanalysis of the Full AES</a><a href="#fnref1">↩</a></li>
<li id="fn2">[<a class="uri" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.352.9346&amp;rep">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.352.9346&amp;rep;</a>;=rep1&amp;type;=pdf Narrow-Bicliques: Cryptanalysis of Full IDEA]<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="https://eprint.iacr.org/2011/286.pdf">Bicliques for Preimages: Attacks on Skein-512 and the SHA-2 family</a><a href="#fnref3">↩</a></li>
<li id="fn4">Andrey Bogdanov, Dmitry Khovratovich and Christian Rechberger. <a href="http://research.microsoft.com/en-us/projects/cryptanalysis/aesbc.pdf">"Biclique Cryptanalysis of the Full AES"</a><a href="#fnref4">↩</a></li>
<li id="fn5">Whitfield Diffie, Martin E. Hellman. <a href="http://vanilla47.com/PDFs/Cryptography/Cryptoanalysis/Exhaustive%20Cryptoanalysis%20of%20the%20NBS%20data%20encryption%20standards.pdf">"Exhaustive Cryptanalysis of the NBS Data Encryption Standard"</a><a href="#fnref5">↩</a></li>
<li id="fn6">Dmitry Khovratovich1 and Christian Rechberger2 and Alexandra Savelieva3. <a href="http://eprint.iacr.org/2011/286.pdf">"Bicliques for Preimages: Attacks on Skein-512 and the SHA-2 family"</a><a href="#fnref6">↩</a></li>
</ol>
</section>
</hr></body>
</html>

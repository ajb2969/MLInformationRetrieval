   Euler's factorization method      Euler's factorization method   Euler 's factorization method is a technique for factoring a number by writing it as a sum of two squares in two different ways. For example the number   1000009   1000009   1000009   can be written as     1000  2   +   3  2        superscript  1000  2    superscript  3  2     1000^{2}+3^{2}   or as     972  2   +   235  2        superscript  972  2    superscript  235  2     972^{2}+235^{2}   and Euler's method gives the factorization    1000009  =   293  ⋅  3413       1000009   normal-⋅  293  3413     1000009=293\cdot 3413   .  The idea that two distinct representations of an odd positive integer may lead to a factorization was apparently first proposed by Marin Mersenne . However, it was not put to use extensively until Euler one hundred years later. His most celebrated use of the method that now bears his name was to factor the number   1000009   1000009   1000009   , which apparently was previously thought to be prime even though it is not a pseudoprime by any major primality test.  Euler's factorization method is more effective than Fermat's for integers whose factors are not close together and potentially much more efficient than trial division if one can find representations of numbers as sums of two squares reasonably easily. Euler's development ultimately permitted much more efficient factoring of numbers and, by the 1910s, the development of large factor tables going up to about ten million. The methods used to find representations of numbers as sums of two squares are essentially the same as with finding differences of squares in Fermat's factorization method .  The great disadvantage of Euler's factorization method is that it cannot be applied to factoring an integer with any prime factor of the form 4 k + 3 occurring to an odd power in its prime factorization, as such a number can never be the sum of two squares. Even odd composite numbers of the form 4 k + 1 are often the product of two primes of the form 4 k + 3 (e.g. 3053 = 43 × 71) and again cannot be factored by Euler's method.  This restricted applicability has made Euler's factorization method disfavoured for computer factoring algorithms , since any user attempting to factor a random integer is unlikely to know whether Euler's method can actually be applied to the integer in question. It is only relatively recently that there have been attempts to develop Euler's method into computer algorithms for use on specialised numbers where it is known Euler's method can be applied.  Theoretical basis  The Brahmagupta–Fibonacci identity states that the product of two sums of two squares is a sum of two squares. Euler's method relies on this theorem but it can be viewed as the converse, given    n  =    a  2   +   b  2    =    c  2   +   d  2          n     superscript  a  2    superscript  b  2            superscript  c  2    superscript  d  2       n=a^{2}+b^{2}=c^{2}+d^{2}   we find   n   n   n   as a product of sums of two squares.  First deduce that        a  2   -   c  2    =    d  2   -   b  2           superscript  a  2    superscript  c  2       superscript  d  2    superscript  b  2      a^{2}-c^{2}=d^{2}-b^{2}     and factor both sides to get        (   a  -  c   )    (   a  +  c   )    =    (   d  -  b   )    (   d  +  b   )            a  c     a  c        d  b     d  b      (a-c)(a+c)=(d-b)(d+b)   (1)  Now let    k  =   gcd   (   a  -  c   ,   d  -  b   )        k   gcd    a  c     d  b      k=\operatorname{gcd}(a-c,d-b)   and    h  =   gcd   (   a  +  c   ,   d  +  b   )        h   gcd    a  c     d  b      h=\operatorname{gcd}(a+c,d+b)   so that there exists some constants    l  ,  m  ,   l  ′   ,   m  ′      l  m   superscript  l  normal-′    superscript  m  normal-′     l,m,l^{\prime},m^{\prime}   satisfying        (   a  -  c   )   =   k  l         a  c     k  l     (a-c)=kl   ,       (   d  -  b   )   =   k  m         d  b     k  m     (d-b)=km   ,        gcd   (  l  ,  m  )    =  1       gcd  l  m   1    \operatorname{gcd}(l,m)=1           (   a  +  c   )   =   h   m  ′          a  c     h   superscript  m  normal-′      (a+c)=hm^{\prime}   ,       (   d  +  b   )   =   h   l  ′          d  b     h   superscript  l  normal-′      (d+b)=hl^{\prime}   ,        gcd   (   l  ′   ,   m  ′   )    =  1       gcd   superscript  l  normal-′    superscript  m  normal-′    1    \operatorname{gcd}(l^{\prime},m^{\prime})=1     Substituting these into equation (1) gives       k  l  h   m  ′    =   k  m  h   l  ′          k  l  h   superscript  m  normal-′      k  m  h   superscript  l  normal-′      klhm^{\prime}=kmhl^{\prime}     Canceling common factors yields       l   m  ′    =    l  ′   m         l   superscript  m  normal-′       superscript  l  normal-′   m     lm^{\prime}=l^{\prime}m     Now using the fact that    (  l  ,  m  )     l  m    (l,m)   and    (   l  ′   ,   m  ′   )      superscript  l  normal-′    superscript  m  normal-′     (l^{\prime},m^{\prime})   are pairs of relatively prime numbers, we find that       l  =   l  ′       l   superscript  l  normal-′     l=l^{\prime}         m  =   m  ′       m   superscript  m  normal-′     m=m^{\prime}      So        (   a  -  c   )   =   k  l         a  c     k  l     (a-c)=kl          (   d  -  b   )   =   k  m         d  b     k  m     (d-b)=km          (   a  +  c   )   =   h  m         a  c     h  m     (a+c)=hm          (   d  +  b   )   =   h  l         d  b     h  l     (d+b)=hl      We now see that    m  =   gcd   (   a  +  c   ,   d  -  b   )        m   gcd    a  c     d  b      m=\operatorname{gcd}(a+c,d-b)   and    l  =   gcd   (   a  -  c   ,   d  +  b   )        l   gcd    a  c     d  b      l=\operatorname{gcd}(a-c,d+b)     Applying the Brahmagupta–Fibonacci identity we get         (    k  2   +   h  2    )    (    l  2   +   m  2    )    =     (    k  l   -   h  m    )   2   +    (    k  m   +   h  l    )   2    =     (    (   a  -  c   )   -   (   a  +  c   )    )   2   +    (    (   d  -  b   )   +   (   d  +  b   )    )   2    =     (   2  c   )   2   +    (   2  d   )   2    =   4  n    ,             superscript  k  2    superscript  h  2       superscript  l  2    superscript  m  2        superscript      k  l     h  m    2    superscript      k  m     h  l    2            superscript      a  c     a  c    2    superscript      d  b     d  b    2            superscript    2  c   2    superscript    2  d   2           4  n      (k^{2}+h^{2})(l^{2}+m^{2})=(kl-hm)^{2}+(km+hl)^{2}=((a-c)-(a+c))^{2}+((d-b)+(d%
 +b))^{2}=(2c)^{2}+(2d)^{2}=4n,            (    k  2   +   h  2    )    (    l  2   +   m  2    )    =     (    k  l   +   h  m    )   2   +    (    k  m   -   h  l    )   2    =     (    (   a  -  c   )   +   (   a  +  c   )    )   2   +    (    (   d  -  b   )   -   (   d  +  b   )    )   2    =     (   2  a   )   2   +    (   2  b   )   2    =   4  n    .             superscript  k  2    superscript  h  2       superscript  l  2    superscript  m  2        superscript      k  l     h  m    2    superscript      k  m     h  l    2            superscript      a  c     a  c    2    superscript      d  b     d  b    2            superscript    2  a   2    superscript    2  b   2           4  n      (k^{2}+h^{2})(l^{2}+m^{2})=(kl+hm)^{2}+(km-hl)^{2}=((a-c)+(a+c))^{2}+((d-b)-(d%
 +b))^{2}=(2a)^{2}+(2b)^{2}=4n.     As each factor is a sum of two squares, one of these must contain both even numbers: either    (  k  ,  h  )     k  h    (k,h)   or    (  l  ,  m  )     l  m    (l,m)   . Without loss of generality, assume that pair    (  k  ,  h  )     k  h    (k,h)   is even. The factorization then becomes       n  =    (     (    k  2    )   2   +    (    h  2    )   2    )    (    l  2   +   m  2    )     .      n       superscript    k  2   2    superscript    h  2   2       superscript  l  2    superscript  m  2       n=((\tfrac{k}{2})^{2}+(\tfrac{h}{2})^{2})(l^{2}+m^{2}).\,   .  Worked example  Since    1000009  =    1000  2   +   3  2    =    972  2   +   235  2          1000009     superscript  1000  2    superscript  3  2            superscript  972  2    superscript  235  2       \ 1000009=1000^{2}+3^{2}=972^{2}+235^{2}     we have from the formula above:      a = 1000   (A) a − c = 28   gcd[A,C] k = 4     b = 3   (B) a + c = 1972   gcd[B,D] h = 34     c = 972   (C) d − b = 232   l = 7     d = 235   (D) d + b = 238   m = 58     Thus,      1000009  =    [     (   4  2   )   2   +    (   34  2   )   2    ]   ⋅   (    7  2   +   58  2    )        1000009   normal-⋅   delimited-[]     superscript    4  2   2    superscript    34  2   2        superscript  7  2    superscript  58  2       1000009=\left[\left(\frac{4}{2}\right)^{2}+\left(\frac{34}{2}\right)^{2}\right%
 ]\cdot\left(7^{2}+58^{2}\right)\,            =    (    2  2   +   17  2    )   ⋅   (    7  2   +   58  2    )        absent   normal-⋅     superscript  2  2    superscript  17  2       superscript  7  2    superscript  58  2       =\left(2^{2}+17^{2}\right)\cdot\left(7^{2}+58^{2}\right)\,          =    (   4  +  289   )   ⋅   (   49  +  3364   )        absent   normal-⋅    4  289     49  3364      =(4+289)\cdot(49+3364)\,          =   293  ⋅   3413        absent   normal-⋅  293  3413     =293\cdot 3413\,        References        "  Euler's factorization method   
   Pole splitting      Pole splitting   Pole splitting is a phenomenon exploited in some forms of frequency compensation used in an electronic amplifier . When a capacitor is introduced between the input and output sides of the amplifier with the intention of moving the pole lowest in frequency (usually an input pole) to lower frequencies, pole splitting causes the pole next in frequency (usually an output pole) to move to a higher frequency. This pole movement increases the stability of the amplifier and improves its step response at the cost of decreased speed. 1 2 3 4  Example of pole splitting    This example shows that introduction of the capacitor referred to as C C in the amplifier of Figure 1 has two results: first it causes the lowest frequency pole of the amplifier to move still lower in frequency and second, it causes the higher pole to move higher in frequency. 5 The amplifier of Figure 1 has a low frequency pole due to the added input resistance R i and capacitance C i , with the time constant C i ( R A // R i ). This pole is moved down in frequency by the Miller effect . The amplifier is given a high frequency output pole by addition of the load resistance R L and capacitance C L , with the time constant C L ('' R o // R L '' ). The upward movement of the high-frequency pole occurs because the Miller-amplified compensation capacitor C C alters the frequency dependence of the output voltage divider.  The first objective, to show the lowest pole moves down in frequency, is established using the same approach as the Miller's theorem article. Following the procedure described in the article on Miller's theorem , the circuit of Figure 1 is transformed to that of Figure 2, which is electrically equivalent to Figure 1. Application of Kirchhoff's current law to the input side of Figure 2 determines the input voltage     v   i     subscript  v  i    \ v_{i}   to the ideal op amp as a function of the applied signal voltage     v   a     subscript  v  a    \ v_{a}   , namely,         \frac {v_i} {v_a}  =  \frac {R_i} {R_i+R_A} \frac {1} {1+j \omega (C_M+C_i) (R_A//R_i)} \ ,  which exhibits a roll-off with frequency beginning at f 1 where         \begin{align}  f_{1} & =  \frac {1} {2 \pi (C_M+C_i)(R_A//R_i) } \\  & =  \frac {1} {2 \pi \tau_1} \ , \\  \end{align}   which introduces notation    τ  1     subscript  τ  1    \tau_{1}   for the time constant of the lowest pole. This frequency is lower than the initial low frequency of the amplifier, which for C C = 0 F is    1   2  π   C  i    (   R  A   /  /   R  i   )        1   fragments  2  π   subscript  C  i    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)      \frac{1}{2\pi C_{i}(R_{A}//R_{i})}   .  Turning to the second objective, showing the higher pole moves still higher in frequency, it is necessary to look at the output side of the circuit, which contributes a second factor to the overall gain, and additional frequency dependence. The voltage     v   o     subscript  v  o    \ v_{o}   is determined by the gain of the ideal op amp inside the amplifier as           v   o   =    A  v     v  i      .       subscript  v  o      subscript  A  v    subscript  v  i      \ v_{o}=A_{v}v_{i}\ .        Using this relation and applying Kirchhoff's current law to the output side of the circuit determines the load voltage    v  ℓ     subscript  v  normal-ℓ    v_{\ell}   as a function of the voltage     v   i     subscript  v  i    \ v_{i}   at the input to the ideal op amp as:          v  ℓ    v  i    =    A  v     R  L     R  L   +   R  o             subscript  v  normal-ℓ    subscript  v  i       subscript  A  v      subscript  R  L      subscript  R  L    subscript  R  o        \frac{v_{\ell}}{v_{i}}=A_{v}\frac{R_{L}}{R_{L}+R_{o}}\,\!         \sdot      1  +    j  ω   C  C    R  o    /   A  v      1  +  j  ω   (   C  L   +   C  C   )    (   R  o   /  /   R  L   )       .      \sdot      1      j  ω   subscript  C  C    subscript  R  o     subscript  A  v      fragments  1   j  ω   fragments  normal-(   subscript  C  L     subscript  C  C   normal-)    fragments  normal-(   subscript  R  o      subscript  R  L   normal-)       \sdot\frac{1+j\omega C_{C}R_{o}/A_{v}}{1+j\omega(C_{L}+C_{C})(R_{o}//R_{L})}\ .        This expression is combined with the gain factor found earlier for the input side of the circuit to obtain the overall gain as         \frac {v_{\ell}} {v_a} = \frac {v_{\ell}}{v_i} \frac {v_i} {v_a}         =    A  v     R  i     R  i   +   R  A      \sdot     R  L     R  L   +   R  o          absent     subscript  A  v      subscript  R  i      subscript  R  i    subscript  R  A     \sdot     subscript  R  L      subscript  R  L    subscript  R  o        =A_{v}\frac{R_{i}}{R_{i}+R_{A}}\sdot\frac{R_{L}}{R_{L}+R_{o}}\,\!        \sdot    1   1  +  j  ω   (   C  M   +   C  i   )    (   R  A   /  /   R  i   )         \sdot    1   fragments  1   j  ω   fragments  normal-(   subscript  C  M     subscript  C  i   normal-)    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)       \sdot\frac{1}{1+j\omega(C_{M}+C_{i})(R_{A}//R_{i})}\,\!         \sdot      1  +    j  ω   C  C    R  o    /   A  v      1  +  j  ω   (   C  L   +   C  C   )    (   R  o   /  /   R  L   )       .      \sdot      1      j  ω   subscript  C  C    subscript  R  o     subscript  A  v      fragments  1   j  ω   fragments  normal-(   subscript  C  L     subscript  C  C   normal-)    fragments  normal-(   subscript  R  o      subscript  R  L   normal-)       \sdot\frac{1+j\omega C_{C}R_{o}/A_{v}}{1+j\omega(C_{L}+C_{C})(R_{o}//R_{L})}\ .        This gain formula appears to show a simple two-pole response with two time constants. (It also exhibits a zero in the numerator but, assuming the amplifier gain A v is large, this zero is important only at frequencies too high to matter in this discussion, so the numerator can be approximated as unity.) However, although the amplifier does have a two-pole behavior, the two time-constants are more complicated than the above expression suggests because the Miller capacitance contains a buried frequency dependence that has no importance at low frequencies, but has considerable effect at high frequencies. That is, assuming the output R-C product, C L ( R o // R L ), corresponds to a frequency well above the low frequency pole, the accurate form of the Miller capacitance must be used, rather than the Miller approximation . According to the article on Miller effect , the Miller capacitance is given by         \begin{align} C_M & = C_C \left( 1 - \frac {v_{\ell}} {v_i} \right) \\  & = C_C \left( 1 - A_v \frac {R_L} {R_L+R_o} \frac {1+j \omega C_C R_o/A_v } {1+j \omega (C_L + C_C ) (R_o//R_L) } \right ) \ . \\  \end{align}  (For a positive Miller capacitance, A v is negative.) Upon substitution of this result into the gain expression and collecting terms, the gain is rewritten as:           v  ℓ    v  a    =    A  v     R  i     R  i   +   R  A       R  L     R  L   +   R  o        1  +    j  ω   C  C    R  o    /   A  v      D  ω       ,         subscript  v  normal-ℓ    subscript  v  a       subscript  A  v      subscript  R  i      subscript  R  i    subscript  R  A        subscript  R  L      subscript  R  L    subscript  R  o         1      j  ω   subscript  C  C    subscript  R  o     subscript  A  v      subscript  D  ω       \frac{v_{\ell}}{v_{a}}=A_{v}\frac{R_{i}}{R_{i}+R_{A}}\frac{R_{L}}{R_{L}+R_{o}}%
 \frac{1+j\omega C_{C}R_{o}/A_{v}}{D_{\omega}}\ ,        with D ω given by a quadratic in ω, namely:        D  ω     subscript  D  ω    D_{\omega}\,\!       =   [  1  +  j  ω   (   C  L   +   C  C   )    (   R  o   /  /   R  L   )   ]      fragments    fragments  normal-[  1   j  ω   fragments  normal-(   subscript  C  L     subscript  C  C   normal-)    fragments  normal-(   subscript  R  o      subscript  R  L   normal-)   normal-]     =[1+j\omega(C_{L}+C_{C})(R_{o}//R_{L})]\,\!        \sdot    [  1  +  j  ω   C  i    (   R  A   /  /   R  i   )   ]      fragments  \sdot   fragments  normal-[  1   j  ω   subscript  C  i    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)   normal-]     \sdot\ [1+j\omega C_{i}(R_{A}//R_{i})]\,\!       +  j  ω   C  C    (   R  A   /  /   R  i   )      fragments   j  ω   subscript  C  C    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)     \ +j\omega C_{C}(R_{A}//R_{i})\,\!        \sdot    (   1  -    A  v     R  L     R  L   +   R  O       )       \sdot    1     subscript  A  v      subscript  R  L      subscript  R  L    subscript  R  O         \sdot\left(1-A_{v}\frac{R_{L}}{R_{L}+R_{O}}\right)\,\!       +    (  j  ω  )   2    C  C    C  L    (   R  A   /  /   R  i   )    (   R  O   /  /   R  L   )   .     fragments    superscript   fragments  normal-(  j  ω  normal-)   2    subscript  C  C    subscript  C  L    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)    fragments  normal-(   subscript  R  O      subscript  R  L   normal-)   normal-.    \ +(j\omega)^{2}C_{C}C_{L}(R_{A}//R_{i})(R_{O}//R_{L})\ .        Every quadratic has two factors, and this expression looks simpler if it is rewritten as         \ D_{ \omega } =(1+j \omega { \tau}_1 )(1+j \omega { \tau}_2 )        =  1  +  j  ω   (   τ  1   +   τ  2   )   )  +  (  j  ω  )    2   τ    1   τ     2    ,     fragments   1   j  ω   fragments  normal-(   subscript  τ  1     subscript  τ  2   normal-)   normal-)   normal-(  j  ω  normal-)   2   τ   1   τ   2   normal-,    =1+j\omega({\tau}_{1}+{\tau}_{2}))+(j\omega)^{2}\tau_{1}\tau_{2}\ ,        where    τ  1     subscript  τ  1    \tau_{1}   and    τ  2     subscript  τ  2    \tau_{2}   are combinations of the capacitances and resistances in the formula for D ω . 6 They correspond to the time constants of the two poles of the amplifier. One or the other time constant is the longest; suppose    τ  1     subscript  τ  1    \tau_{1}   is the longest time constant, corresponding to the lowest pole, and suppose    τ  1     subscript  τ  1    \tau_{1}   >>    τ  2     subscript  τ  2    \tau_{2}   . (Good step response requires    τ  1     subscript  τ  1    \tau_{1}   >>    τ  2     subscript  τ  2    \tau_{2}   . See Selection of C C below.)  At low frequencies near the lowest pole of this amplifier, ordinarily the linear term in ω is more important than the quadratic term, so the low frequency behavior of D ω is:         \begin{align} \ D_{ \omega } & = 1+ j \omega [(C_M+C_i) (R_A//R_i) +(C_L+C_C) (R_o//R_L)] \\  & =  1+j \omega ( \tau_1 + \tau_2) \approx 1 + j \omega \tau_1 \ , \ \\  \end{align}  where now C M is redefined using the Miller approximation as          C  M   =    C  C    (   1  -    A  v     R  L     R  L   +   R  o       )     ,       subscript  C  M      subscript  C  C     1     subscript  A  v      subscript  R  L      subscript  R  L    subscript  R  o          C_{M}=C_{C}\left(1-A_{v}\frac{R_{L}}{R_{L}+R_{o}}\right)\ ,        which is simply the previous Miller capacitance evaluated at low frequencies. On this basis    τ  1     subscript  τ  1    \tau_{1}   is determined, provided    τ  1     subscript  τ  1    \tau_{1}   >>    τ  2     subscript  τ  2    \tau_{2}   . Because C M is large, the time constant    τ  1     subscript  τ  1    {\tau}_{1}   is much larger than its original value of C i ( R A // R i ). 7  At high frequencies the quadratic term becomes important. Assuming the above result for    τ  1     subscript  τ  1    \tau_{1}   is valid, the second time constant, the position of the high frequency pole, is found from the quadratic term in D ω as          τ  2   =     τ  1    τ  2     τ  1    ≈      τ  1    τ  2      τ  1   +   τ  2       .         subscript  τ  2        subscript  τ  1    subscript  τ  2     subscript  τ  1              subscript  τ  1    subscript  τ  2       subscript  τ  1    subscript  τ  2        \tau_{2}=\frac{\tau_{1}\tau_{2}}{\tau_{1}}\approx\frac{\tau_{1}\tau_{2}}{\tau_%
 {1}+\tau_{2}}\ .        Substituting in this expression the quadratic coefficient corresponding to the product     τ  1    τ  2        subscript  τ  1    subscript  τ  2     \tau_{1}\tau_{2}   along with the estimate for    τ  1     subscript  τ  1    \tau_{1}   , an estimate for the position of the second pole is found:         \begin{align}  \tau_2 & = \frac {(C_C C_L +C_L C_i+C_i C_C)(R_A//R_i)  (R_O//R_L) } {(C_M+C_i) (R_A//R_i) +(C_L+C_C) (R_o//R_L)}  \\  & \approx  \frac {C_C C_L +C_L C_i+C_i C_C} {C_M} (R_O//R_L)\ ,  \\  \end{align}  and because C M is large, it seems    τ  2     subscript  τ  2    \tau_{2}   is reduced in size from its original value C L ( R o // R L ); that is, the higher pole has moved still higher in frequency because of C C . 8  In short, introduction of capacitor C C moved the low pole lower and the high pole higher, so the term pole splitting seems a good description.  Selection of C C  What value is a good choice for C C ? For general purpose use, traditional design (often called dominant-pole or single-pole compensation ) requires the amplifier gain to drop at 20 dB/decade from the corner frequency down to 0 dB gain, or even lower. 9  10 With this design the amplifier is stable and has near-optimal step response even as a unity gain voltage buffer. A more aggressive technique is two-pole compensation. 11  12  The way to position f 2 to obtain the design is shown in Figure 3. At the lowest pole f 1 , the Bode gain plot breaks slope to fall at 20 dB/decade. The aim is to maintain the 20 dB/decade slope all the way down to zero dB, and taking the ratio of the desired drop in gain (in dB) of 20 log 10  A v to the required change in frequency (on a log frequency scale 13 ) of ( log 10  f 2 − log 10  f 1 ) = log 10 ( f 2 / f 1 ) the slope of the segment between f 1 and f 2 is:    Slope per decade of frequency      =   20      log  10    (   A  v   )      log  10    (    f  2   /   f  1    )        ,      absent    20       subscript  log  10    subscript  A  v       subscript  log  10      subscript  f  2    subscript  f  1         =20\frac{\mathrm{log_{10}}(A_{v})}{\mathrm{log_{10}}(f_{2}/f_{1})}\ ,        which is 20 dB/decade provided f 2 = A v f 1 . If f 2 is not this large, the second break in the Bode plot that occurs at the second pole interrupts the plot before the gain drops to 0 dB with consequent lower stability and degraded step response.  Figure 3 shows that to obtain the correct gain dependence on frequency, the second pole is at least a factor A v higher in frequency than the first pole. The gain is reduced a bit by the voltage dividers at the input and output of the amplifier, so with corrections to A v for the voltage dividers at input and output the pole-ratio condition for good step response becomes:           τ  1    τ  2    ≈    A  v     R  i     R  i   +   R  A      \sdot      R  L     R  L   +   R  o        ,         subscript  τ  1    subscript  τ  2       subscript  A  v      subscript  R  i      subscript  R  i    subscript  R  A     \sdot     subscript  R  L      subscript  R  L    subscript  R  o        \frac{\tau_{1}}{\tau_{2}}\approx A_{v}\frac{R_{i}}{R_{i}+R_{A}}\sdot\frac{R_{L%
 }}{R_{L}+R_{o}}\ ,        (Figure)  Figure 4: Miller capacitance at low frequencies C M (top) and compensation capacitor C C (bottom) as a function of gain using Excel . Capacitance units are pF.   Using the approximations for the time constants developed above,           τ  1    τ  2    ≈     (    τ  1   +   τ  2    )   2     τ  1    τ  2     ≈    A  v     R  i     R  i   +   R  A      \sdot      R  L     R  L   +   R  o        ,           subscript  τ  1    subscript  τ  2       superscript     subscript  τ  1    subscript  τ  2    2      subscript  τ  1    subscript  τ  2             subscript  A  v      subscript  R  i      subscript  R  i    subscript  R  A     \sdot     subscript  R  L      subscript  R  L    subscript  R  o         \frac{\tau_{1}}{\tau_{2}}\approx\frac{(\tau_{1}+\tau_{2})^{2}}{\tau_{1}\tau_{2%
 }}\approx A_{v}\frac{R_{i}}{R_{i}+R_{A}}\sdot\frac{R_{L}}{R_{L}+R_{o}}\ ,        or          [   (   C  M   +   C  i   )    (   R  A   /  /   R  i   )   +   (   C  L   +   C  C   )    (   R  o   /  /   R  L   )   ]   2     (   C  C    C  L   +   C  L    C  i   +   C  i    C  C   )    (   R  A   /  /   R  i   )    (   R  O   /  /   R  L   )         superscript   fragments  normal-[   fragments  normal-(   subscript  C  M     subscript  C  i   normal-)    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)     fragments  normal-(   subscript  C  L     subscript  C  C   normal-)    fragments  normal-(   subscript  R  o      subscript  R  L   normal-)   normal-]   2    fragments   fragments  normal-(   subscript  C  C    subscript  C  L     subscript  C  L    subscript  C  i     subscript  C  i    subscript  C  C   normal-)    fragments  normal-(   subscript  R  A      subscript  R  i   normal-)    fragments  normal-(   subscript  R  O      subscript  R  L   normal-)      \frac{[(C_{M}+C_{i})(R_{A}//R_{i})+(C_{L}+C_{C})(R_{o}//R_{L})]^{2}}{(C_{C}C_{%
 L}+C_{L}C_{i}+C_{i}C_{C})(R_{A}//R_{i})(R_{O}//R_{L})}\,\!          \color   W  h  i  t  e   \sdot    =    A  v     R  i     R  i   +   R  A      \sdot      R  L     R  L   +   R  o        ,        \color  W  h  i  t  e  \sdot      subscript  A  v      subscript  R  i      subscript  R  i    subscript  R  A     \sdot     subscript  R  L      subscript  R  L    subscript  R  o        {\color{White}\sdot}=A_{v}\frac{R_{i}}{R_{i}+R_{A}}\sdot\frac{R_{L}}{R_{L}+R_{%
 o}}\ ,        which provides a quadratic equation to determine an appropriate value for C C . Figure 4 shows an example using this equation. At low values of gain this example amplifier satisfies the pole-ratio condition without compensation (that is, in Figure 4 the compensation capacitor C C is small at low gain), but as gain increases, a compensation capacitance rapidly becomes necessary (that is, in Figure 4 the compensation capacitor C C increases rapidly with gain) because the necessary pole ratio increases with gain. For still larger gain, the necessary C C drops with increasing gain because the Miller amplification of C C , which increases with gain (see the Miller equation ), allows a smaller value for C C .  To provide more safety margin for design uncertainties, often A v is increased to two or three times A v on the right side of this equation. 14 See Sansen 15 or Huijsing 16 and article on step response .  Slew rate  The above is a small-signal analysis. However, when large signals are used, the need to charge and discharge the compensation capacitor adversely affects the amplifier slew rate ; in particular, the response to an input ramp signal is limited by the need to charge C C .  See also   Frequency compensation  Miller effect  Common source  Bode plot  Step response   References and notes  External links   Bode Plots in the Circuit Theory Wikibook  Bode Plots in the Control Systems Wikibook   "  Category:Analog circuits  Category:Electronic design     That is, the rise time is selected to be the fastest possible consistent with low overshoot and ringing . ↩  ↩  ↩  ↩  Although this example appears very specific, the associated mathematical analysis is very much used in circuit design. ↩  The sum of the time constants is the coefficient of the term linear in jω and the product of the time constants is the coefficient of the quadratic term in (jω) 2 . ↩  The expression for    τ  1     subscript  τ  1    \tau_{1}   differs a little from ( C M +C i ) ( R A // R i ) as found initially for f 1 , but the difference is minor assuming the load capacitance is not so large that it controls the low frequency response instead of the Miller capacitance. ↩  As an aside, the higher the high-frequency pole is made in frequency, the more likely it becomes for a real amplifier that other poles (not considered in this analysis) play a part. ↩  ↩  ↩  Feucht, Dennis: Two-pole compensation ↩  ↩  That is, the frequency is plotted in powers of ten, as 1, 10, 10 2  etc . ↩  A factor of two results in the maximally flat or Butterworth design for a two-pole amplifier. However, real amplifiers have more than two poles, and a factor greater than two often is necessary. ↩       
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="792">Quaternions and spatial rotation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Quaternions and spatial rotation</h1>
<hr>[[unit vector|Unit]] [[quaternion]]s, also known as [[versor]]s, provide a convenient [[mathematics|mathematical]] notation for representing [[Orientation (geometry)|orientation]]s and [[rotation]]s of objects in three dimensions. Compared to [[Euler angles]] they are simpler to [[function composition|compose]] and avoid the problem of [[g
<p>imbal lock]]. Compared to <a href="Rotation_matrix" title="wikilink">rotation matrices</a> they are more <a href="numerically_stable" title="wikilink">numerically stable</a> and may be more efficient. Quaternions have found their way into applications in <a href="computer_graphics" title="wikilink">computer graphics</a>, <a href="computer_vision" title="wikilink">computer vision</a>, <a class="uri" href="robotics" title="wikilink">robotics</a>, <a class="uri" href="navigation" title="wikilink">navigation</a>, <a href="molecular_dynamics" title="wikilink">molecular dynamics</a>, <a href="flight_dynamics" title="wikilink">flight dynamics</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a href="orbital_mechanics" title="wikilink">orbital mechanics</a> of <a href="satellite" title="wikilink">satellites</a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and <a href="Texture_(crystalline)" title="wikilink">crystallographic texture</a> analysis.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>When used to represent rotation, unit quaternions are also called <strong>rotation quaternions</strong>. When used to represent an <a href="Orientation_(geometry)" title="wikilink">orientation</a> (rotation relative to a reference coordinate system), they are called <strong>orientation quaternions</strong> or <strong>attitude quaternions</strong>. </p>
<h2 id="using-quaternion-rotations">Using quaternion rotations</h2>

<p> In 3-dimensional space, according to <a href="Euler's_rotation_theorem" title="wikilink">Euler's rotation theorem</a>, any rotation or sequence of rotations of a rigid body or coordinate system about a fixed point is equivalent to a single rotation by a given angle 

<math display="inline" id="Quaternions_and_spatial_rotation:0">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   θ
  </annotation>
 </semantics>
</math>

 about a fixed axis (called <em>Euler axis</em>) that runs through the fixed point. The Euler axis is typically represented by a <a href="unit_vector" title="wikilink">unit vector</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:1">
 <semantics>
  <mover accent="true">
   <mi>u</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}
  </annotation>
 </semantics>
</math>

. Therefore, any rotation in three dimensions can be represented as a combination of a vector 

<math display="inline" id="Quaternions_and_spatial_rotation:2">
 <semantics>
  <mover accent="true">
   <mi>u</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}
  </annotation>
 </semantics>
</math>

 and a scalar 

<math display="inline" id="Quaternions_and_spatial_rotation:3">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   θ
  </annotation>
 </semantics>
</math>

. Quaternions give a simple way to encode this <a href="axis–angle_representation" title="wikilink">axis–angle representation</a> in four numbers, and can be used to apply the corresponding rotation to a <a href="Position_(vector)" title="wikilink">position vector</a>, representing a <a href="Point_(geometry)" title="wikilink">point</a> relative to the <a href="Origin_(mathematics)" title="wikilink">origin</a> in <a href="real_coordinate_space" title="wikilink"><strong>R</strong><sup>3</sup></a>.</p>

<p>A <a href="Euclidean_vector" title="wikilink">Euclidean vector</a> such as 

<math display="inline" id="Quaternions_and_spatial_rotation:4">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal"></mi>
    <mn>3</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal"></mi>
    <mn>4</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <ci>normal-</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <times></times>
     <ci>normal-</ci>
     <cn type="integer">4</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2, 3, 4)
  </annotation>
 </semantics>
</math>

 or <mtpl></mtpl> can be rewritten as 

<math display="inline" id="Quaternions_and_spatial_rotation:5">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>𝐢</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mn>3</mn>
    <mi>𝐣</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mn>4</mn>
    <mi>𝐤</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>𝐣</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>𝐤</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\mathbf{i}+3\mathbf{j}+4\mathbf{k}
  </annotation>
 </semantics>
</math>

 or <mtpl></mtpl>, where 

<math display="inline" id="Quaternions_and_spatial_rotation:6">
 <semantics>
  <mi>𝐢</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐢</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{i}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Quaternions_and_spatial_rotation:7">
 <semantics>
  <mi>𝐣</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐣</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{j}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Quaternions_and_spatial_rotation:8">
 <semantics>
  <mi>𝐤</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐤</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k}
  </annotation>
 </semantics>
</math>

 are unit vectors representing the three <a href="Cartesian_coordinate_system" title="wikilink">Cartesian axes</a>. A rotation through an angle of 

<math display="inline" id="Quaternions_and_spatial_rotation:9">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   θ
  </annotation>
 </semantics>
</math>

 around the axis defined by a unit vector</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:10">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>u</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>u</mi>
     <mi>x</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>u</mi>
     <mi>y</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>u</mi>
     <mi>z</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>u</mi>
      <mi>x</mi>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mi>y</mi>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mi>z</mi>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-→</ci>
      <ci>u</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <ci>z</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>x</ci>
       </apply>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>y</ci>
       </apply>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}=(u_{x},u_{y},u_{z})=u_{x}\mathbf{i}+u_{y}\mathbf{j}+u_{z}\mathbf{k}
  </annotation>
 </semantics>
</math>

 can be represented by a quaternion. This can be done using an <a href="Pauli_matrices" title="wikilink">extension</a> of <a href="Euler's_formula" title="wikilink">Euler's formula</a>:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:11">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mo>=</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mfrac>
      <mi>θ</mi>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>x</mi>
        </msub>
        <mi>𝐢</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>y</mi>
        </msub>
        <mi>𝐣</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>z</mi>
        </msub>
        <mi>𝐤</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>cos</mi>
     <mfrac>
      <mi>θ</mi>
      <mn>2</mn>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>x</mi>
        </msub>
        <mi>𝐢</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>y</mi>
        </msub>
        <mi>𝐣</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>u</mi>
         <mi>z</mi>
        </msub>
        <mi>𝐤</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>sin</mi>
      <mfrac>
       <mi>θ</mi>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐪</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>θ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>x</ci>
         </apply>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>y</ci>
         </apply>
         <ci>𝐣</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>z</ci>
         </apply>
         <ci>𝐤</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <cos></cos>
       <apply>
        <divide></divide>
        <ci>θ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>x</ci>
         </apply>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>y</ci>
         </apply>
         <ci>𝐣</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>z</ci>
         </apply>
         <ci>𝐤</ci>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <divide></divide>
         <ci>θ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=e^{\frac{\theta}{2}{(u_{x}\mathbf{i}+u_{y}\mathbf{j}+u_{z}\mathbf{k%
})}}=\cos\frac{\theta}{2}+(u_{x}\mathbf{i}+u_{y}\mathbf{j}+u_{z}\mathbf{k})%
\sin\frac{\theta}{2}
  </annotation>
 </semantics>
</math>

</p>

<p>It can be shown that the desired rotation can be applied to an ordinary vector 

<math display="inline" id="Quaternions_and_spatial_rotation:12">
 <semantics>
  <mrow>
   <mi>𝐩</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>p</mi>
     <mi>x</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mi>y</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>p</mi>
     <mi>z</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>x</mi>
     </msub>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>y</mi>
     </msub>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>z</mi>
     </msub>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐩</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>z</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>x</ci>
       </apply>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>y</ci>
       </apply>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>z</ci>
       </apply>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=(p_{x},p_{y},p_{z})=p_{x}\mathbf{i}+p_{y}\mathbf{j}+p_{z}\mathbf{k}
  </annotation>
 </semantics>
</math>

 in 3-dimensional space, considered as a quaternion with a real coordinate equal to zero, by evaluating the <a href="#The_conjugation_operation" title="wikilink">conjugation</a> of 

<math display="inline" id="Quaternions_and_spatial_rotation:13">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Quaternions_and_spatial_rotation:14">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:15">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐩</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>𝐪𝐩𝐪</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐩</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐪𝐩𝐪</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p^{\prime}}=\mathbf{q}\mathbf{p}\mathbf{q}^{-1}
  </annotation>
 </semantics>
</math>

 using the <a href="Hamilton_product" title="wikilink">Hamilton product</a>, where <mtpl></mtpl> is the new position vector of the point after the rotation.</p>

<p>This operation carries the <em>set</em> of all "pure" quaternions p (those with real part equal to zero) — which constitute a 3-dimensional space among the quaternions — into itself, by the desired rotation about the axis <strong><em>u</em></strong>, by the angle θ. (Each real quaternion is carried into itself by this operation. But for the purpose of rotations in 3-dimensional space, we ignore the real quaternions.)</p>

<p>The rotation is clockwise if our line of sight points in the same direction as 

<math display="inline" id="Quaternions_and_spatial_rotation:16">
 <semantics>
  <mover accent="true">
   <mi>u</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}
  </annotation>
 </semantics>
</math>

.</p>

<p>In this instance, 

<math display="inline" id="Quaternions_and_spatial_rotation:17">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 is a <a href="unit_quaternion" title="wikilink">unit quaternion</a> and</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:18">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐪</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mi>θ</mi>
        <mn>2</mn>
       </mfrac>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>u</mi>
           <mi>x</mi>
          </msub>
          <mi>𝐢</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>u</mi>
           <mi>y</mi>
          </msub>
          <mi>𝐣</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>u</mi>
           <mi>z</mi>
          </msub>
          <mi>𝐤</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>cos</mi>
      <mfrac>
       <mi>θ</mi>
       <mn>2</mn>
      </mfrac>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>u</mi>
          <mi>x</mi>
         </msub>
         <mi>𝐢</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>u</mi>
          <mi>y</mi>
         </msub>
         <mi>𝐣</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>u</mi>
          <mi>z</mi>
         </msub>
         <mi>𝐤</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mfrac>
        <mi>θ</mi>
        <mn>2</mn>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐪</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>θ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>u</ci>
           <ci>x</ci>
          </apply>
          <ci>𝐢</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>u</ci>
           <ci>y</ci>
          </apply>
          <ci>𝐣</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>u</ci>
           <ci>z</ci>
          </apply>
          <ci>𝐤</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <cos></cos>
       <apply>
        <divide></divide>
        <ci>θ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>x</ci>
         </apply>
         <ci>𝐢</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>y</ci>
         </apply>
         <ci>𝐣</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>z</ci>
         </apply>
         <ci>𝐤</ci>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <divide></divide>
         <ci>θ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}^{-1}=e^{-\frac{\theta}{2}{(u_{x}\mathbf{i}+u_{y}\mathbf{j}+u_{z}%
\mathbf{k})}}=\cos\frac{\theta}{2}-(u_{x}\mathbf{i}+u_{y}\mathbf{j}+u_{z}%
\mathbf{k})\sin\frac{\theta}{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>It follows that conjugation by the product of two quaternions is the composition of conjugations by these quaternions: If 

<math display="inline" id="Quaternions_and_spatial_rotation:19">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Quaternions_and_spatial_rotation:20">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 are unit quaternions, then rotation (conjugation) by 

<math display="inline" id="Quaternions_and_spatial_rotation:21">
 <semantics>
  <mi>𝐩𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{pq}
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐩𝐪</mi>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐩𝐪</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>𝐩𝐪</mi>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <msup>
     <mi>𝐪</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>𝐩</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>𝐩</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐪</mi>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <msup>
       <mi>𝐪</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>𝐩</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>𝐩𝐪</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐩𝐪</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝐩𝐪</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐪</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐩</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>𝐩</ci>
      <apply>
       <times></times>
       <ci>𝐪</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐪</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐩</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{pq}\vec{v}(\mathbf{pq})^{-1}=\mathbf{pq}\vec{v}\mathbf{q}^{-1}\mathbf{%
p}^{-1}=\mathbf{p}(\mathbf{q}\vec{v}\mathbf{q}^{-1})\mathbf{p}^{-1}
  </annotation>
 </semantics>
</math>

, which is the same as rotating (conjugating) by 

<math display="inline" id="Quaternions_and_spatial_rotation:23">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 and then by 

<math display="inline" id="Quaternions_and_spatial_rotation:24">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

. The scalar component of the result is necessarily zero.</p>

<p>The quaternion inverse of a rotation is the opposite rotation, since 

<math display="inline" id="Quaternions_and_spatial_rotation:25">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐪</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐪</mi>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <msup>
       <mi>𝐪</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>𝐪</mi>
   </mrow>
   <mo>=</mo>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐪</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝐪</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐪</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>𝐪</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}^{-1}(\mathbf{q}\vec{v}\mathbf{q}^{-1})\mathbf{q}=\vec{v}
  </annotation>
 </semantics>
</math>

. The square of a quaternion rotation is a rotation by twice the angle around the same axis. More generally <mtpl></mtpl> is a rotation by 

<math display="inline" id="Quaternions_and_spatial_rotation:26">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 times the angle around the same axis as 

<math display="inline" id="Quaternions_and_spatial_rotation:27">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

. This can be extended to arbitrary real 

<math display="inline" id="Quaternions_and_spatial_rotation:28">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, allowing for smooth interpolation between spatial orientations; see <a class="uri" href="Slerp" title="wikilink">Slerp</a>.</p>

<p>Two rotation quaternions can be combined into one equivalent quaternion by the relation:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:29">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐪</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐪</mi>
     <mn>2</mn>
    </msub>
    <msub>
     <mi>𝐪</mi>
     <mn>1</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐪</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐪</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐪</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}^{\prime}=\mathbf{q}_{2}\mathbf{q}_{1}
  </annotation>
 </semantics>
</math>

</p>

<p>in which 

<math display="inline" id="Quaternions_and_spatial_rotation:30">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mi mathvariant="normal">′</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝐪</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q′}
  </annotation>
 </semantics>
</math>

 corresponds to the rotation <mtpl></mtpl> followed by the rotation <mtpl></mtpl>. (Note that quaternion multiplication is not <a class="uri" href="commutative" title="wikilink">commutative</a>.) Thus, an arbitrary number of rotations can be composed together and then applied as a single rotation.</p>
<h3 id="example">Example</h3>
<h4 id="the-conjugation-operation">The conjugation operation</h4>
<figure><b>(Figure)</b>
<figcaption>A rotation of 120° around the first diagonal permutes 

<math display="inline" id="Quaternions_and_spatial_rotation:31">
 <semantics>
  <mi>𝐢</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐢</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{i}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Quaternions_and_spatial_rotation:32">
 <semantics>
  <mi>𝐣</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐣</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{j}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Quaternions_and_spatial_rotation:33">
 <semantics>
  <mi>𝐤</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐤</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k}
  </annotation>
 </semantics>
</math>

 cyclically.</figcaption>
</figure>

<p><em>Conjugating</em> 

<math display="inline" id="Quaternions_and_spatial_rotation:34">
 <semantics>
  <mi>𝐩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

 <em>by</em> 

<math display="inline" id="Quaternions_and_spatial_rotation:35">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 refers to the operation <mtpl></mtpl>.</p>

<p>Consider the rotation 

<math display="inline" id="Quaternions_and_spatial_rotation:36">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 around the axis 

<math display="inline" id="Quaternions_and_spatial_rotation:37">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>𝐢</mi>
    <mo>+</mo>
    <mi>𝐣</mi>
    <mo>+</mo>
    <mi>𝐤</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>𝐢</ci>
     <ci>𝐣</ci>
     <ci>𝐤</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}=\mathbf{i}+\mathbf{j}+\mathbf{k}
  </annotation>
 </semantics>
</math>

, with a rotation angle of 120°, or 

<math display="inline" id="Quaternions_and_spatial_rotation:38">
 <semantics>
  <mfrac>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
   </mrow>
   <mn>3</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
    </apply>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{2π}{3}
  </annotation>
 </semantics>
</math>

 <a href="radian" title="wikilink">radians</a>.</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:39">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <mi>π</mi>
    </mrow>
    <mn>3</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=\frac{2\pi}{3}
  </annotation>
 </semantics>
</math>

</p>

<p> The length of 

<math display="inline" id="Quaternions_and_spatial_rotation:40">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Quaternions_and_spatial_rotation:41">
 <semantics>
  <msqrt>
   <mn>3</mn>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{3}
  </annotation>
 </semantics>
</math>

, the half angle is 

<math display="inline" id="Quaternions_and_spatial_rotation:42">
 <semantics>
  <mfrac>
   <mi>π</mi>
   <mn>3</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>π</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{π}{3}
  </annotation>
 </semantics>
</math>

 (60°) with <a class="uri" href="cosine" title="wikilink">cosine</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:43">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mn>2</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}
  </annotation>
 </semantics>
</math>

, (

<math display="inline" id="Quaternions_and_spatial_rotation:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mi>o</mi>
    <mi>s</mi>
    <mi mathvariant="normal"></mi>
    <mn>60</mn>
    <mi mathvariant="normal">°</mi>
   </mrow>
   <mo>=</mo>
   <mn>0.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>c</ci>
     <ci>o</ci>
     <ci>s</ci>
     <ci>normal-</ci>
     <cn type="integer">60</cn>
     <ci>normal-°</ci>
    </apply>
    <cn type="float">0.5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   cos 60°=0.5
  </annotation>
 </semantics>
</math>

) and <a class="uri" href="sine" title="wikilink">sine</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:45">
 <semantics>
  <mfrac>
   <msqrt>
    <mn>3</mn>
   </msqrt>
   <mn>2</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <root></root>
     <cn type="integer">3</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\sqrt{3}}{2}
  </annotation>
 </semantics>
</math>

, (

<math display="inline" id="Quaternions_and_spatial_rotation:46">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <mi>n</mi>
   <mi mathvariant="normal"></mi>
   <mn>60</mn>
   <mi mathvariant="normal">°</mi>
   <mi mathvariant="normal">≈</mi>
   <mn>0.866</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <ci>n</ci>
    <ci>normal-</ci>
    <cn type="integer">60</cn>
    <ci>normal-°</ci>
    <ci>normal-≈</ci>
    <cn type="float">0.866</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sin 60°≈0.866
  </annotation>
 </semantics>
</math>

). We are therefore dealing with a conjugation by the unit quaternion</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:47">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>u</mi>
    </mtd>
    <mtd columnalign="left">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mfrac>
        <mi>α</mi>
        <mn>2</mn>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mrow>
         <mfrac>
          <mi>α</mi>
          <mn>2</mn>
         </mfrac>
         <mo>⋅</mo>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mo>∥</mo>
           <mover accent="true">
            <mi>v</mi>
            <mo stretchy="false">→</mo>
           </mover>
           <mo>∥</mo>
          </mrow>
         </mfrac>
        </mrow>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mfrac>
        <mi>π</mi>
        <mn>3</mn>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mrow>
         <mfrac>
          <mi>π</mi>
          <mn>3</mn>
         </mfrac>
         <mo>⋅</mo>
         <mfrac>
          <mn>1</mn>
          <msqrt>
           <mn>3</mn>
          </msqrt>
         </mfrac>
        </mrow>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mfrac>
         <msqrt>
          <mn>3</mn>
         </msqrt>
         <mn>2</mn>
        </mfrac>
        <mo>⋅</mo>
        <mfrac>
         <mn>1</mn>
         <msqrt>
          <mn>3</mn>
         </msqrt>
        </mfrac>
       </mrow>
       <mover accent="true">
        <mi>v</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <msqrt>
         <mn>3</mn>
        </msqrt>
        <mn>2</mn>
       </mfrac>
       <mo>⋅</mo>
       <mfrac>
        <mrow>
         <mi>𝐢</mi>
         <mo>+</mo>
         <mi>𝐣</mi>
         <mo>+</mo>
         <mi>𝐤</mi>
        </mrow>
        <msqrt>
         <mn>3</mn>
        </msqrt>
       </mfrac>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mfrac>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>𝐢</mi>
       <mo>+</mo>
       <mi>𝐣</mi>
       <mo>+</mo>
       <mi>𝐤</mi>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>u</ci>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <cos></cos>
       <apply>
        <divide></divide>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <divide></divide>
          <ci>α</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <csymbol cd="latexml">norm</csymbol>
           <apply>
            <ci>normal-→</ci>
            <ci>v</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <cos></cos>
       <apply>
        <divide></divide>
        <ci>π</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <divide></divide>
          <ci>π</ci>
          <cn type="integer">3</cn>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <root></root>
           <cn type="integer">3</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <divide></divide>
         <apply>
          <root></root>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <root></root>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <divide></divide>
        <apply>
         <root></root>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <ci>𝐢</ci>
         <ci>𝐣</ci>
         <ci>𝐤</ci>
        </apply>
        <apply>
         <root></root>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>𝐢</ci>
       <ci>𝐣</ci>
       <ci>𝐤</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lll}u&=&\cos\frac{\alpha}{2}+\sin\frac{\alpha}{2}\cdot\frac{1}%
{\|\vec{v}\|}\vec{v}\\
&=&\cos\frac{\pi}{3}+\sin\frac{\pi}{3}\cdot\frac{1}{\sqrt{3}}\vec{v}\\
&=&\frac{1}{2}+\frac{\sqrt{3}}{2}\cdot\frac{1}{\sqrt{3}}\vec{v}\\
&=&\frac{1}{2}+\frac{\sqrt{3}}{2}\cdot\frac{\mathbf{i}+\mathbf{j}+\mathbf{k}}{%
\sqrt{3}}\\
&=&\frac{1+\mathbf{i}+\mathbf{j}+\mathbf{k}}{2}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>If 

<math display="inline" id="Quaternions_and_spatial_rotation:48">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is the rotation function,</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:49">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>u</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>u</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>u</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>u</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(a\mathbf{i}+b\mathbf{j}+c\mathbf{k})=u(a\mathbf{i}+b\mathbf{j}+c\mathbf{k})u%
^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>It can be proved that the inverse of a unit quaternion is obtained simply by <a href="additive_inverse" title="wikilink">changing the sign</a> of its imaginary components. As a consequence,</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:50">
 <semantics>
  <mrow>
   <msup>
    <mi>u</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>𝐢</mi>
     <mo>-</mo>
     <mi>𝐣</mi>
     <mo>-</mo>
     <mi>𝐤</mi>
    </mrow>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>u</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>𝐢</ci>
      <ci>𝐣</ci>
      <ci>𝐤</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{-1}=\frac{1-\mathbf{i}-\mathbf{j}-\mathbf{k}}{2}
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:51">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>𝐢</mi>
      <mo>+</mo>
      <mi>𝐣</mi>
      <mo>+</mo>
      <mi>𝐤</mi>
     </mrow>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>𝐢</mi>
      <mo>-</mo>
      <mi>𝐣</mi>
      <mo>-</mo>
      <mi>𝐤</mi>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>𝐢</ci>
       <ci>𝐣</ci>
       <ci>𝐤</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>𝐢</ci>
       <ci>𝐣</ci>
       <ci>𝐤</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(a\mathbf{i}+b\mathbf{j}+c\mathbf{k})=\frac{1+\mathbf{i}+\mathbf{j}+\mathbf{k%
}}{2}(a\mathbf{i}+b\mathbf{j}+c\mathbf{k})\frac{1-\mathbf{i}-\mathbf{j}-%
\mathbf{k}}{2}
  </annotation>
 </semantics>
</math>

</p>

<p>This can be simplified, using the ordinary rules for quaternion arithmetic, to</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:52">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>c</mi>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>a</mi>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>𝐤</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(a\mathbf{i}+b\mathbf{j}+c\mathbf{k})=c\mathbf{i}+a\mathbf{j}+b\mathbf{k}
  </annotation>
 </semantics>
</math>

</p>

<p>As expected, the rotation corresponds to keeping a <a class="uri" href="cube" title="wikilink">cube</a> held fixed at one point, and rotating it 120° about the long diagonal through the fixed point (observe how the three axes are <a href="cyclic_permutation" title="wikilink">permuted cyclically</a>).</p>
<h4 id="quaternion-arithmetic-in-practice">Quaternion arithmetic in practice</h4>

<p>Let's show how we reached the previous result. Let's develop the expression of 

<math display="inline" id="Quaternions_and_spatial_rotation:53">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 (in two stages), and apply the rules</p>

<p>

<math display="inline" id="Quaternions_and_spatial_rotation:54">
 <semantics>
  <mi>𝐢𝐣</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐢𝐣</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{ij}
  </annotation>
 </semantics>
</math>


</p>

<p>It gives us:</p>

<p>

<math display="inline" id="Quaternions_and_spatial_rotation:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle f(a\mathbf{i}+b\mathbf{j}+c\mathbf{k})=
  </annotation>
 </semantics>
</math>


</p>

<p>which is the expected result. As we can see, such computations are relatively long and tedious if done manually; however, in a computer program, this amounts to calling the quaternion multiplication routine twice.</p>
<h3 id="quaternion-derived-rotation-matrix">Quaternion-derived rotation matrix</h3>

<p>A quaternion rotation can be algebraically manipulated into a <a href="Rotation_matrix#Quaternion" title="wikilink">quaternion-derived rotation matrix</a>. By simplifying the quaternion multiplications 

<math display="inline" id="Quaternions_and_spatial_rotation:56">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mi mathvariant="normal"></mi>
   <mi>𝐩</mi>
   <mi mathvariant="normal"></mi>
   <mi>𝐪</mi>
   <mo>*</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <csymbol cd="unknown"></csymbol>
    <csymbol cd="unknown">p</csymbol>
    <csymbol cd="unknown"></csymbol>
    <csymbol cd="unknown">q</csymbol>
    <times></times>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q p q}*
  </annotation>
 </semantics>
</math>

, they can be rewritten as a <a href="rotation_matrix" title="wikilink">rotation matrix</a> given an axis–angle representation:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:57">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>c</mi>
       <mo>+</mo>
       <mrow>
        <msubsup>
         <mi>a</mi>
         <mi>x</mi>
         <mn>2</mn>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>x</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>y</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>z</mi>
        </msub>
        <mi>s</mi>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>x</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>z</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>y</mi>
        </msub>
        <mi>s</mi>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>y</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>x</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>z</mi>
        </msub>
        <mi>s</mi>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi>c</mi>
       <mo>+</mo>
       <mrow>
        <msubsup>
         <mi>a</mi>
         <mi>y</mi>
         <mn>2</mn>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>y</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>z</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>x</mi>
        </msub>
        <mi>s</mi>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>z</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>x</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>y</mi>
        </msub>
        <mi>s</mi>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>z</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>y</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>x</mi>
        </msub>
        <mi>s</mi>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi>c</mi>
       <mo>+</mo>
       <mrow>
        <msubsup>
         <mi>a</mi>
         <mi>z</mi>
         <mn>2</mn>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>c</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <plus></plus>
      <ci>c</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>z</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>y</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>z</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>c</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>x</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>y</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>x</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>c</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>z</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}c+a_{x}^{2}(1-c)&a_{x}a_{y}(1-c)-a_{z}s&a_{x}a_{z}(1-c)+a_{y}s%
\\
a_{y}a_{x}(1-c)+a_{z}s&c+a_{y}^{2}(1-c)&a_{y}a_{z}(1-c)-a_{x}s\\
a_{z}a_{x}(1-c)-a_{y}s&a_{z}a_{y}(1-c)+a_{x}s&c+a_{z}^{2}(1-c)\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Quaternions_and_spatial_rotation:58">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Quaternions_and_spatial_rotation:59">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 are shorthand for 

<math display="inline" id="Quaternions_and_spatial_rotation:60">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>i</mi>
   <mi>n</mi>
   <mi>θ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>i</ci>
    <ci>n</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   sinθ
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Quaternions_and_spatial_rotation:61">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mi>o</mi>
   <mi>s</mi>
   <mi>θ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>c</ci>
    <ci>o</ci>
    <ci>s</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   cosθ
  </annotation>
 </semantics>
</math>

, respectively. Although care should be taken (due to <a href="Degeneracy_(mathematics)" title="wikilink">degeneracy</a> as the quaternion approaches the <a href="multiplicative_identity" title="wikilink">identity</a> quaternion (

<math display="inline" id="Quaternions_and_spatial_rotation:62">
 <semantics>
  <mn>𝟏</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{1}
  </annotation>
 </semantics>
</math>

) or the <a class="uri" href="sine" title="wikilink">sine</a> of the angle approaches zero) the axis and angle can be extracted via:</p>

<p>

<math display="inline" id="Quaternions_and_spatial_rotation:63">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{q}
  </annotation>
 </semantics>
</math>


 Note that the 

<math display="inline" id="Quaternions_and_spatial_rotation:64">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   θ
  </annotation>
 </semantics>
</math>

 equality holds only when <mtpl></mtpl> is non-negative.</p>

<p>Alternatively, the rotation matrix can be expressed as</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:65">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mi>q</mi>
         <mi>j</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mi>q</mi>
         <mi>k</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>j</mi>
          </msub>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>k</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>j</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>j</mi>
          </msub>
         </mrow>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>k</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mi>q</mi>
         <mi>i</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mi>q</mi>
         <mi>k</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>j</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>j</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>j</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo>+</mo>
         <mrow>
          <msub>
           <mi>q</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mi>q</mi>
         <mi>i</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mi>q</mi>
         <mi>j</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1-2q_{j}^{2}-2q_{k}^{2}&2(q_{i}q_{j}-q_{k}q_{r})&2(q_{i}q_{k}+q%
_{j}q_{r})\\
2(q_{i}q_{j}+q_{k}q_{r})&1-2q_{i}^{2}-2q_{k}^{2}&2(q_{j}q_{k}-q_{i}q_{r})\\
2(q_{i}q_{k}-q_{j}q_{r})&2(q_{j}q_{k}+q_{i}q_{r})&1-2q_{i}^{2}-2q_{j}^{2}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>As with other schemes to apply rotations, the <a href="Rotation" title="wikilink">centre of rotation</a> must be <a href="Translation_(geometry)" title="wikilink">translated</a> to the origin before the rotation is applied and translated back to its original position afterwards.</p>
<h2 id="explanation">Explanation</h2>
<h3 id="quaternions-briefly">Quaternions briefly</h3>

<p>The <a href="complex_numbers" title="wikilink">complex numbers</a> can be defined by introducing an abstract symbol 

<math display="inline" id="Quaternions_and_spatial_rotation:66">
 <semantics>
  <mi>𝐢</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐢</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{i}
  </annotation>
 </semantics>
</math>

 which satisfies the usual rules of algebra and additionally the rule <mtpl></mtpl>. This is sufficient to reproduce all of the rules of complex number arithmetic: for example:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <mrow>
        <mi>b</mi>
        <mi>𝐢</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>c</mi>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <mi>𝐢</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <mi>c</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>a</mi>
      <mi>d</mi>
      <mi>𝐢</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>𝐢</mi>
      <mi>c</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>𝐢</mi>
      <mi>d</mi>
      <mi>𝐢</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <mi>c</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>a</mi>
      <mi>d</mi>
      <mi>𝐢</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>c</mi>
      <mi>𝐢</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>d</mi>
      <msup>
       <mi>𝐢</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>a</mi>
        <mi>c</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>b</mi>
        <mi>d</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>b</mi>
         <mi>c</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>a</mi>
         <mi>d</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>𝐢</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>𝐢</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>c</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>𝐢</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>d</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐢</ci>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐢</ci>
       <ci>d</ci>
       <ci>𝐢</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>d</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>c</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐢</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>c</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>c</ci>
        </apply>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>d</ci>
        </apply>
       </apply>
       <ci>𝐢</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a+b\mathbf{i})(c+d\mathbf{i})=ac+ad\mathbf{i}+b\mathbf{i}c+b\mathbf{i}d%
\mathbf{i}=ac+ad\mathbf{i}+bc\mathbf{i}+bd\mathbf{i}^{2}=(ac-bd)+(bc+ad)%
\mathbf{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>In the same way the quaternions can be defined by introducing abstract symbols 

<math display="inline" id="Quaternions_and_spatial_rotation:68">
 <semantics>
  <mi>𝐢</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐢</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{i}
  </annotation>
 </semantics>
</math>


, 

<math display="inline" id="Quaternions_and_spatial_rotation:69">
 <semantics>
  <mi>𝐣</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐣</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{j}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Quaternions_and_spatial_rotation:70">
 <semantics>
  <mi>𝐤</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐤</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k}
  </annotation>
 </semantics>
</math>

 which satisfy the rules <mtpl></mtpl> and the usual algebraic rules <em>except</em> the commutative law of multiplication (a familiar example of such a noncommutative multiplication is <a href="matrix_multiplication" title="wikilink">matrix multiplication</a>). From this all of the rules of quaternion arithmetic follow: for example, one can show that:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:71">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mrow>
       <mi>b</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>c</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>d</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>e</mi>
      <mo>+</mo>
      <mrow>
       <mi>f</mi>
       <mi>𝐢</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>g</mi>
       <mi>𝐣</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>h</mi>
       <mi>𝐤</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>𝐢</ci>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>𝐣</ci>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <ci>𝐤</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a+b\mathbf{i}+c\mathbf{j}+d\mathbf{k})(e+f\mathbf{i}+g\mathbf{j}+h\mathbf{k})=
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Quaternions_and_spatial_rotation:72">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>a</mi>
       <mi>e</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>b</mi>
       <mi>f</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>c</mi>
       <mi>g</mi>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>d</mi>
       <mi>h</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>f</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>b</mi>
         <mi>e</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>c</mi>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>d</mi>
        <mi>g</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mi>g</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>b</mi>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>c</mi>
        <mi>e</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <mi>f</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi>a</mi>
          <mi>h</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mi>b</mi>
          <mi>g</mi>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>c</mi>
         <mi>f</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <mi>e</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>e</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>g</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>h</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>f</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>e</ci>
       </apply>
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>g</ci>
      </apply>
     </apply>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>g</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>e</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <ci>𝐣</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>h</ci>
        </apply>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>g</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>f</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>e</ci>
      </apply>
     </apply>
     <ci>𝐤</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (ae-bf-cg-dh)+(af+be+ch-dg)\mathbf{i}+(ag-bh+ce+df)\mathbf{j}+(ah+bg-cf+de)%
\mathbf{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>The imaginary part 

<math display="inline" id="Quaternions_and_spatial_rotation:73">
 <semantics>
  <mrow>
   <mrow>
    <mi>b</mi>
    <mi>𝐢</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>c</mi>
    <mi>𝐣</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>d</mi>
    <mi>𝐤</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>b</ci>
     <ci>𝐢</ci>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <ci>𝐣</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>𝐤</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b\mathbf{i}+c\mathbf{j}+d\mathbf{k}
  </annotation>
 </semantics>
</math>


 of a quaternion behaves like a vector 

<math display="inline" id="Quaternions_and_spatial_rotation:74">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>b</mi>
    <mo>,</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <vector>
     <ci>b</ci>
     <ci>c</ci>
     <ci>d</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}=(b,c,d)
  </annotation>
 </semantics>
</math>

 in three dimension vector space, and the real part 

<math display="inline" id="Quaternions_and_spatial_rotation:75">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 behaves like a <a href="scalar_(mathematics)" title="wikilink">scalar</a> in 

<math display="inline" id="Quaternions_and_spatial_rotation:76">
 <semantics>
  <mi>𝐑</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐑</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}
  </annotation>
 </semantics>
</math>

. When quaternions are used in geometry, it is more convenient to define them as <a href="Classical_Hamiltonian_quaternions#Quaternion" title="wikilink">a scalar plus a vector</a>:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:77">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>a</mi>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>𝐢</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>c</mi>
      <mi>𝐣</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>d</mi>
      <mi>𝐤</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>a</mi>
     <mo>+</mo>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐤</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a+b\mathbf{i}+c\mathbf{j}+d\mathbf{k}=a+\vec{v}.
  </annotation>
 </semantics>
</math>

</p>

<p>Those who have studied vectors at school might find it strange to add a <em>number</em> to a <em>vector</em>, as they are objects of very different natures, or to <em>multiply</em> two vectors together, as this operation is usually undefined. However, if one remembers that it is a mere notation for the real and imaginary parts of a quaternion, it becomes more legitimate. In other words, the correct reasoning is the addition of two quaternions, one with zero vector/imaginary part, and another one with zero scalar/real part:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:78">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>a</mi>
     <mo>+</mo>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo>,</mo>
      <mover accent="true">
       <mn>0</mn>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo>,</mo>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <interval closure="open">
      <ci>a</ci>
      <apply>
       <ci>normal-→</ci>
       <cn type="integer">0</cn>
      </apply>
     </interval>
     <interval closure="open">
      <cn type="integer">0</cn>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a+\vec{v}=(a,\vec{0})+(0,\vec{v}).
  </annotation>
 </semantics>
</math>

</p>

<p>We can express quaternion multiplication in the modern language of vector <a href="cross_product" title="wikilink">cross</a> and <a href="dot_product" title="wikilink">dot products</a> (which were actually inspired by the quaternions in the first place). When multiplying the vector/imaginary parts, in place of the rules <mtpl></mtpl> we have the quaternion multiplication rule:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:79">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mover accent="true">
      <mi>w</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>×</mo>
      <mover accent="true">
       <mi>w</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>w</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>w</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>w</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>w</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}\vec{w}=\vec{v}\times\vec{w}-\vec{v}\cdot\vec{w},
  </annotation>
 </semantics>
</math>

 where:</p>
<ul>
<li>

<math display="inline" id="Quaternions_and_spatial_rotation:80">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mover accent="true">
    <mi>w</mi>
    <mo stretchy="false">→</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>w</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}\vec{w}
  </annotation>
 </semantics>
</math>

 is the resulting quaternion,</li>
<li>

<math display="inline" id="Quaternions_and_spatial_rotation:81">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>×</mo>
   <mover accent="true">
    <mi>w</mi>
    <mo stretchy="false">→</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>w</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}\times\vec{w}
  </annotation>
 </semantics>
</math>

 is vector cross product (a vector),</li>
<li>

<math display="inline" id="Quaternions_and_spatial_rotation:82">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>⋅</mo>
   <mover accent="true">
    <mi>w</mi>
    <mo stretchy="false">→</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋅</ci>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>w</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}\cdot\vec{w}
  </annotation>
 </semantics>
</math>

 is vector scalar product (a scalar).</li>
</ul>

<p>Quaternion multiplication is noncommutative (because of the cross product, which anti-commutes), while scalar–scalar and scalar–vector multiplications commute. From these rules it follows immediately that (<a href="Quaternions#Quaternions_and_the_geometry_of_R3" title="wikilink">see details</a>):</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:83">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>s</mi>
       <mo>+</mo>
       <mover accent="true">
        <mi>v</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mover accent="true">
        <mi>w</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>s</mi>
        <mi>t</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>⋅</mo>
        <mover accent="true">
         <mi>w</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>s</mi>
        <mover accent="true">
         <mi>w</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>t</mi>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>×</mo>
        <mover accent="true">
         <mi>w</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>s</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>w</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>w</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>s</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>w</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>t</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>w</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (s+\vec{v})(t+\vec{w})=(st-\vec{v}\cdot\vec{w})+(s\vec{w}+t\vec{v}+\vec{v}%
\times\vec{w}).
  </annotation>
 </semantics>
</math>

</p>

<p>The (left and right) multiplicative inverse or reciprocal of a nonzero quaternion is given by the conjugate-to-norm ratio (<a href="Quaternion#Conjugation.2C_the_norm.2C_and_reciprocal" title="wikilink">see details</a>):</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:84">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>s</mi>
       <mo>+</mo>
       <mover accent="true">
        <mi>v</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>s</mi>
        <mo>+</mo>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>*</mo>
     </msup>
     <msup>
      <mrow>
       <mo fence="true">∥</mo>
       <mrow>
        <mi>s</mi>
        <mo>+</mo>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
       <mo fence="true">∥</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>s</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mrow>
      <msup>
       <mi>s</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mrow>
        <mo fence="true">∥</mo>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo fence="true">∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>s</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>s</ci>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <plus></plus>
         <ci>s</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>s</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>v</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (s+\vec{v})^{-1}=\frac{(s+\vec{v})^{*}}{\lVert s+\vec{v}\rVert^{2}}=\frac{s-%
\vec{v}}{s^{2}+\lVert\vec{v}\rVert^{2}},
  </annotation>
 </semantics>
</math>

</p>

<p>as can be verified by direct calculation.</p>
<h3 id="proof-of-the-quaternion-rotation-identity">Proof of the quaternion rotation identity</h3>

<p>Let 

<math display="inline" id="Quaternions_and_spatial_rotation:85">
 <semantics>
  <mover accent="true">
   <mi>u</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}
  </annotation>
 </semantics>
</math>

 be a unit vector (the rotation axis) and let 

<math display="inline" id="Quaternions_and_spatial_rotation:86">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>cos</mi>
     <mfrac>
      <mi>α</mi>
      <mn>2</mn>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mover accent="true">
      <mi>u</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mi>sin</mi>
      <mfrac>
       <mi>α</mi>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <apply>
     <plus></plus>
     <apply>
      <cos></cos>
      <apply>
       <divide></divide>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <divide></divide>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=\cos\frac{\alpha}{2}+\vec{u}\sin\frac{\alpha}{2}
  </annotation>
 </semantics>
</math>

. Our goal is to show that</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:87">
 <semantics>
  <mrow>
   <mover accent="true">
    <msup>
     <mi>v</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>q</mi>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <msup>
     <mi>q</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mfrac>
        <mi>α</mi>
        <mn>2</mn>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mover accent="true">
        <mi>u</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mi>sin</mi>
        <mfrac>
         <mi>α</mi>
         <mn>2</mn>
        </mfrac>
       </mrow>
      </mrow>
     </mrow>
     <mo rspace="4.2pt">)</mo>
    </mrow>
    <mpadded width="+1.7pt">
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mpadded>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mfrac>
        <mi>α</mi>
        <mn>2</mn>
       </mfrac>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mover accent="true">
        <mi>u</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mi>sin</mi>
        <mfrac>
         <mi>α</mi>
         <mn>2</mn>
        </mfrac>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-→</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>q</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <sin></sin>
         <apply>
          <divide></divide>
          <ci>α</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <sin></sin>
         <apply>
          <divide></divide>
          <ci>α</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v^{\prime}}=q\vec{v}q^{-1}=\left(\cos\frac{\alpha}{2}+\vec{u}\sin\frac{%
\alpha}{2}\right)\,\vec{v}\,\left(\cos\frac{\alpha}{2}-\vec{u}\sin\frac{\alpha%
}{2}\right)
  </annotation>
 </semantics>
</math>

 yields the vector 

<math display="inline" id="Quaternions_and_spatial_rotation:88">
 <semantics>
  <mover accent="true">
   <mi>v</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}
  </annotation>
 </semantics>
</math>


 rotated by an angle 

<math display="inline" id="Quaternions_and_spatial_rotation:89">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 around the axis 

<math display="inline" id="Quaternions_and_spatial_rotation:90">
 <semantics>
  <mover accent="true">
   <mi>u</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}
  </annotation>
 </semantics>
</math>

. Expanding out, we have</p>

<p>

<math display="inline" id="Quaternions_and_spatial_rotation:91">
 <semantics>
  <mover accent="true">
   <msup>
    <mi>v</mi>
    <mo>′</mo>
   </msup>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>v</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\vec{v^{\prime}}
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Quaternions_and_spatial_rotation:92">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>⊥</mo>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <csymbol cd="latexml">bottom</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{\bot}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Quaternions_and_spatial_rotation:93">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>∥</mo>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{\|}
  </annotation>
 </semantics>
</math>

 are the components of  perpendicular and parallel to  respectively. This is the <a href="Rodrigues'_rotation_formula" title="wikilink">formula of a rotation</a> by 

<math display="inline" id="Quaternions_and_spatial_rotation:94">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

 around the  axis.</p>
<h2 id="quaternion-rotation-operations">Quaternion rotation operations</h2>

<p>A very formal explanation of the properties used in this section is given by Altman.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="the-hypersphere-of-rotations">The hypersphere of rotations</h3>
<h4 id="visualizing-the-space-of-rotations">Visualizing the space of rotations</h4>

<p>Unit quaternions represent the <a href="group_(mathematics)" title="wikilink">group</a> of Euclidean <a href="rotation_(mathematics)" title="wikilink">rotations</a> in <a href="three-dimensional_space" title="wikilink">three dimensions</a> in a very straightforward way. The correspondence between rotations and quaternions can be understood by first visualizing the space of rotations itself.</p>
<figure><b>(Figure)</b>
<figcaption>Two rotations by different angles and different axes in the space of rotations. The length of the vector is related to the magnitude of the rotation.</figcaption>
</figure>

<p>In order to visualize the space of rotations, it helps to consider a simpler case. Any rotation in three dimensions can be described by a rotation by some <a href="Angle_of_rotation" title="wikilink">angle</a> about some <a href="Axis_of_rotation" title="wikilink">axis</a>; for our purposes, we will use an axis <em>vector</em> to establish <a href="Orientation_(vector_space)" title="wikilink">handedness</a> for our angle. Consider the special case in which the axis of rotation lies in the <em>xy</em> plane. We can then specify the axis of one of these rotations by a point on a circle through which the vector crosses, and we can select the radius of the circle to denote the <a href="angle_of_rotation" title="wikilink">angle of rotation</a>. Similarly, a rotation whose axis of rotation lies in the <em>xy</em> plane can be described as a point on a sphere of <em>fixed</em> radius in <em>three</em> dimensions. Beginning at the north pole of a sphere in three-dimensional space, we specify the point at the north pole to be the identity rotation (a zero angle rotation). Just as in the case of the identity rotation, no axis of rotation is defined, and the angle of rotation (zero) is irrelevant. A rotation having a very small rotation angle can be specified by a slice through the sphere parallel to the <em>xy</em> plane and very near the north pole. The circle defined by this slice will be very small, corresponding to the small angle of the rotation. As the rotation angles become larger, the slice moves in the negative <em>z</em> direction, and the circles become larger until the equator of the sphere is reached, which will correspond to a rotation angle of 180 degrees. Continuing southward, the radii of the circles now become smaller (corresponding to the absolute value of the angle of the rotation considered as a negative number). Finally, as the south pole is reached, the circles shrink once more to the identity rotation, which is also specified as the point at the south pole.</p>

<p>Notice that a number of characteristics of such rotations and their representations can be seen by this visualization. The space of rotations is continuous, each rotation has a neighborhood of rotations which are nearly the same, and this neighborhood becomes flat as the neighborhood shrinks. Also, each rotation is actually represented by two antipodal points on the sphere, which are at opposite ends of a line through the center of the sphere. This reflects the fact that each rotation can be represented as a rotation about some axis, or, equivalently, as a negative rotation about an axis pointing in the opposite direction (a so-called <a href="Double_covering_group" title="wikilink">double cover</a>). The "latitude" of a circle representing a particular rotation angle will be half of the angle represented by that rotation, since as the point is moved from the north to south pole, the latitude ranges from zero to 180 degrees, while the angle of rotation ranges from 0 to 360 degrees. (the "longitude" of a point then represents a particular axis of rotation.) Note however that this set of rotations is not closed under composition. Two successive rotations with axes in the <em>xy</em> plane will not necessarily give a rotation whose axis lies in the <em>xy</em> plane, and thus cannot be represented as a point on the sphere. This will not be the case with a general rotation in 3-space, in which rotations do form a closed set under composition.</p>
<figure><b>(Figure)</b>
<figcaption>The sphere of rotations for the rotations that have a "horizontal" axis (in the <em>xy</em> plane).</figcaption>
</figure>

<p>This visualization can be extended to a general rotation in 3-dimensional space. The identity rotation is a point, and a small angle of rotation about some axis can be represented as a point on a sphere with a small radius. As the angle of rotation grows, the sphere grows, until the angle of rotation reaches 180 degrees, at which point the sphere begins to shrink, becoming a point as the angle approaches 360 degrees (or zero degrees from the negative direction). This set of expanding and contracting spheres represents a <a href="3-sphere" title="wikilink">hypersphere in four dimensional space</a> (a 3-sphere). Just as in the simpler example above, each rotation represented as a point on the hypersphere is matched by its antipodal point on that hypersphere. The "latitude" on the hypersphere will be half of the corresponding angle of rotation, and the neighborhood of any point will become "flatter" (i.e. be represented by a 3-D Euclidean space of points) as the neighborhood shrinks. This behavior is matched by the set of unit quaternions: A general quaternion represents a point in a four dimensional space, but constraining it to have unit magnitude yields a three-dimensional space equivalent to the surface of a hypersphere. The magnitude of the unit quaternion will be unity, corresponding to a hypersphere of unit radius. The vector part of a unit quaternion represents the radius of the 2-sphere corresponding to the axis of rotation, and its magnitude is the cosine of half the angle of rotation. Each rotation is represented by two unit quaternions of opposite sign, and, as in the space of rotations in three dimensions, the quaternion product of two unit quaternions will yield a unit quaternion. Also, the space of unit quaternions is "flat" in any infinitesimal neighborhood of a given unit quaternion.</p>
<h4 id="parameterizing-the-space-of-rotations">Parameterizing the space of rotations</h4>

<p>We can parameterize the surface of a sphere with two coordinates, such as latitude and longitude. But latitude and longitude are ill-behaved (<a href="degeneracy_(mathematics)" title="wikilink">degenerate</a>) at the north and south poles, though the poles are not intrinsically different from any other points on the sphere. At the poles (latitudes +90° and −90°), the longitude becomes meaningless.</p>

<p>It can be shown that no two-parameter coordinate system can avoid such degeneracy. We can avoid such problems by embedding the sphere in three-dimensional space and parameterizing it with three Cartesian coordinates 

<math display="inline" id="Quaternions_and_spatial_rotation:95">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y)
  </annotation>
 </semantics>
</math>

, placing the north pole at 

<math display="inline" id="Quaternions_and_spatial_rotation:96">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo>,</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal"></mi>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal"></mi>
     <mn>0</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <vector>
     <ci>w</ci>
     <ci>x</ci>
     <ci>y</ci>
    </vector>
    <vector>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>normal-</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>normal-</ci>
      <cn type="integer">0</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y)=(1, 0, 0)
  </annotation>
 </semantics>
</math>

, the south pole at 

<math display="inline" id="Quaternions_and_spatial_rotation:97">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo>,</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">−</mi>
     <mn>1</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal"></mi>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal"></mi>
     <mn>0</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <vector>
     <ci>w</ci>
     <ci>x</ci>
     <ci>y</ci>
    </vector>
    <vector>
     <apply>
      <times></times>
      <ci>normal-−</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>normal-</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>normal-</ci>
      <cn type="integer">0</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y)=(−1, 0, 0)
  </annotation>
 </semantics>
</math>

, and the equator at 

<math display="inline" id="Quaternions_and_spatial_rotation:98">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w=0
  </annotation>
 </semantics>
</math>

, <mtpl></mtpl>. Points on the sphere satisfy the constraint <mtpl></mtpl>, so we still have just two <a href="degrees_of_freedom_(physics_and_chemistry)" title="wikilink">degrees of freedom</a> though there are three coordinates. A point 

<math display="inline" id="Quaternions_and_spatial_rotation:99">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y)
  </annotation>
 </semantics>
</math>

 on the sphere represents a rotation in the ordinary space around the horizontal axis directed by the vector 

<math display="inline" id="Quaternions_and_spatial_rotation:100">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal"></mi>
    <mn>0</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>x</ci>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>normal-</ci>
     <cn type="integer">0</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y, 0)
  </annotation>
 </semantics>
</math>

 by an angle 

<math display="inline" id="Quaternions_and_spatial_rotation:101">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mrow>
     <msup>
      <mi>cos</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mi>w</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mrow>
     <msup>
      <mi>sin</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msqrt>
      <mrow>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>y</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>α</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>w</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=2\cos^{-1}w=2\sin^{-1}\sqrt{x^{2}+y^{2}}
  </annotation>
 </semantics>
</math>

.</p>

<p>In the same way the hyperspherical space of 3D rotations can be parameterized by three angles (<a href="Euler_angles" title="wikilink">Euler angles</a>), but any such parameterization is degenerate at some points on the hypersphere, leading to the problem of <a href="gimbal_lock" title="wikilink">gimbal lock</a>. We can avoid this by using four Euclidean coordinates 

<math display="inline" id="Quaternions_and_spatial_rotation:102">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mi>z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
    <ci>z</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w,x,y,z
  </annotation>
 </semantics>
</math>

, with <mtpl></mtpl>. The point 

<math display="inline" id="Quaternions_and_spatial_rotation:103">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mi>z</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
    <ci>z</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y,z)
  </annotation>
 </semantics>
</math>

 represents a rotation around the axis directed by the vector 

<math display="inline" id="Quaternions_and_spatial_rotation:104">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mi>z</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>x</ci>
    <ci>y</ci>
    <ci>z</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y,z)
  </annotation>
 </semantics>
</math>

 by an angle 

<math display="inline" id="Quaternions_and_spatial_rotation:105">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <msup>
       <mi>cos</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>w</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <msup>
       <mi>sin</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msqrt>
       <mrow>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>y</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </msqrt>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>α</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>w</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>y</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=2\cos^{-1}w=2\sin^{-1}\sqrt{x^{2}+y^{2}+z^{2}}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="explaining-quaternions-properties-with-rotations">Explaining quaternions' properties with rotations</h2>
<h3 id="non-commutativity">Non-commutativity</h3>

<p>The multiplication of quaternions is <a class="uri" href="non-commutative" title="wikilink">non-commutative</a>. This fact explains how the <mtpl></mtpl> formula can work at all, having <mtpl></mtpl> by definition. Since the multiplication of unit quaternions corresponds to the composition of three-dimensional rotations, this property can be made intuitive by showing that three-dimensional rotations are not commutative in general.</p>

<p>Set two books next to each other. Rotate one of them 90 degrees clockwise around the <em>z</em> axis, then flip it 180 degrees around the <em>x</em> axis. Take the other book, flip it 180° around <em>x</em> axis first, and 90° clockwise around <em>z</em> later. The two books do not end up parallel. This shows that, in general, the composition of two different rotations around two distinct spatial axes will not commute.</p>
<h3 id="orientation">Orientation</h3>

<p>The <a href="vector_cross_product" title="wikilink">vector cross product</a>, used to define the axis–angle representation, does confer an <a href="orientation_(vector_space)" title="wikilink">orientation</a> ("handedness") to space: in a three-dimensional vector space, the three vectors in the equation 

<math display="inline" id="Quaternions_and_spatial_rotation:106">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐚</mi>
    <mi mathvariant="normal">×</mi>
    <mi>𝐛</mi>
   </mrow>
   <mo>=</mo>
   <mi>𝐜</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐚</ci>
     <ci>normal-×</ci>
     <ci>𝐛</ci>
    </apply>
    <ci>𝐜</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{a}×\mathbf{b}=\mathbf{c}
  </annotation>
 </semantics>
</math>

 will always form a right-handed set (or a left-handed set, depending on how the cross product is defined), thus fixing an orientation in the vector space. Alternatively, the dependence on orientation is expressed in referring to such 

<math display="inline" id="Quaternions_and_spatial_rotation:107">
 <semantics>
  <mover accent="true">
   <mi>u</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{u}
  </annotation>
 </semantics>
</math>

 that specifies a rotation as to <em><a href="axial_vector" title="wikilink">axial vectors</a></em>. In quaternionic formalism the choice of an orientation of the space corresponds to order of multiplication: 

<math display="inline" id="Quaternions_and_spatial_rotation:108">
 <semantics>
  <mrow>
   <mi>𝐢𝐣</mi>
   <mo>=</mo>
   <mi>𝐤</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐢𝐣</ci>
    <ci>𝐤</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{ij}=\mathbf{k}
  </annotation>
 </semantics>
</math>

 but 

<math display="inline" id="Quaternions_and_spatial_rotation:109">
 <semantics>
  <mrow>
   <mi>𝐣𝐢</mi>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">−</mi>
    <mi>𝐤</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐣𝐢</ci>
    <apply>
     <times></times>
     <ci>normal-−</ci>
     <ci>𝐤</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{ji}=−\mathbf{k}
  </annotation>
 </semantics>
</math>

. If one reverses the orientation, then the formula above becomes <mtpl></mtpl>, i.e., a unit 

<math display="inline" id="Quaternions_and_spatial_rotation:110">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 is replaced with the conjugate quaternion – the same behaviour as of axial vectors.</p>
<h2 id="comparison-with-other-representations-of-rotations">Comparison with other representations of rotations</h2>
<h3 id="advantages-of-quaternions">Advantages of quaternions</h3>

<p>The representation of a rotation as a quaternion (4 numbers) is more compact than the representation as an <a href="orthogonal_matrix" title="wikilink">orthogonal matrix</a> (9 numbers). Furthermore, for a given axis and angle, one can easily construct the corresponding quaternion, and conversely, for a given quaternion one can easily read off the axis and the angle. Both of these are much harder with matrices or <a href="Euler_angles" title="wikilink">Euler angles</a>.</p>

<p>In <a href="video_game" title="wikilink">video games</a> and other applications, one is often interested in “smooth rotations”, meaning that the scene should slowly rotate and not in a single step. This can be accomplished by choosing a <a class="uri" href="curve" title="wikilink">curve</a> such as the <a href="slerp" title="wikilink">spherical linear interpolation</a> in the quaternions, with one endpoint being the identity transformation 1 (or some other initial rotation) and the other being the intended final rotation. This is more problematic with other representations of rotations.</p>

<p>When composing several rotations on a computer, rounding errors necessarily accumulate. A quaternion that’s slightly off still represents a rotation after being normalised: a matrix that’s slightly off may not be <a href="Orthogonal_matrix" title="wikilink">orthogonal</a> anymore and is harder to convert back to a proper orthogonal matrix.</p>

<p>Quaternions also avoid a phenomenon called <a href="gimbal_lock" title="wikilink">gimbal lock</a> which can result when, for example in <a href="flight_dynamics" title="wikilink">pitch/yaw/roll rotational systems</a>, the pitch is rotated 90° up or down, so that yaw and roll then correspond to the same motion, and a degree of freedom of rotation is lost. In a <a class="uri" href="gimbal" title="wikilink">gimbal</a>-based aerospace inertial navigation system, for instance, this could have disastrous results if the aircraft is in a steep dive or ascent.</p>
<h3 id="conversion-to-and-from-the-matrix-representation">Conversion to and from the matrix representation</h3>
<h4 id="from-a-quaternion-to-an-orthogonal-matrix">From a quaternion to an orthogonal matrix</h4>

<p>The <a href="orthogonal_matrix" title="wikilink">orthogonal matrix</a> corresponding to a rotation by the unit quaternion 

<math display="inline" id="Quaternions_and_spatial_rotation:111">
 <semantics>
  <mrow>
   <mi>𝐳</mi>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <mi>𝐢</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <mi>𝐣</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>d</mi>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐳</ci>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐤</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{z}=a+b\mathbf{i}+c\mathbf{j}+d\mathbf{k}
  </annotation>
 </semantics>
</math>

 (with 

<math display="inline" id="Quaternions_and_spatial_rotation:112">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>𝐳</mi>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <abs></abs>
     <ci>𝐳</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\mathbf{z}|=1
  </annotation>
 </semantics>
</math>

) when post-multiplying with a column vector is given by</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:113">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <msup>
           <mi>a</mi>
           <mn>2</mn>
          </msup>
          <mo>+</mo>
          <msup>
           <mi>b</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo>-</mo>
         <msup>
          <mi>c</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>d</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>b</mi>
          <mi>c</mi>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mn>2</mn>
          <mi>a</mi>
          <mi>d</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>b</mi>
          <mi>d</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>a</mi>
          <mi>c</mi>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>b</mi>
          <mi>c</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>a</mi>
          <mi>d</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>a</mi>
         <msup>
          <mo>;</mo>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>b</mi>
          <mn>2</mn>
         </msup>
         <mo>+</mo>
         <msup>
          <mi>c</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>d</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>c</mi>
          <mi>d</mi>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mn>2</mn>
          <mi>a</mi>
          <mi>b</mi>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>b</mi>
          <mi>d</mi>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mn>2</mn>
          <mi>a</mi>
          <mi>c</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>c</mi>
          <mi>d</mi>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>a</mi>
          <mi>b</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>a</mi>
         <msup>
          <mo>;</mo>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>b</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>c</mi>
          <mn>2</mn>
         </msup>
         <mo>+</mo>
         <msup>
          <mi>d</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <matrix>
     <matrixrow>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>b</ci>
        <ci>c</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>b</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
        <ci>c</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>b</ci>
        <ci>c</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-;</ci>
        <cn type="integer">2</cn>
       </apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </cerror>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>c</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>b</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>c</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-;</ci>
        <cn type="integer">2</cn>
       </apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </cerror>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R=\begin{pmatrix}a^{2}+b^{2}-c^{2}-d^{2}&2bc-2ad&2bd+2ac\\
2bc+2ad&a;^{2}-b^{2}+c^{2}-d^{2}&2cd-2ab\\
2bd-2ac&2cd+2ab&a;^{2}-b^{2}-c^{2}+d^{2}\\
\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>This rotation matrix is used on vector w as w_rotated = R*w. The quaternion representation of this rotation is given by:</p>

<p>[0, w_rotated^T] = z [0, w^T] z*</p>

<p>where z* is the conjugate of the quaternion z, given by 

<math display="inline" id="Quaternions_and_spatial_rotation:114">
 <semantics>
  <mrow>
   <msup>
    <mi>𝐳</mi>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mo>-</mo>
    <mrow>
     <mi>b</mi>
     <mi>𝐢</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>c</mi>
     <mi>𝐣</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>d</mi>
     <mi>𝐤</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐳</ci>
     <times></times>
    </apply>
    <apply>
     <minus></minus>
     <ci>a</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>𝐢</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>𝐣</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝐤</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{z^{*}}=a-b\mathbf{i}-c\mathbf{j}-d\mathbf{k}
  </annotation>
 </semantics>
</math>

</p>

<p>Also, quaternion multiplication is defined as (assuming a and b are quaternions, like z above):</p>

<p>ab = [a_0*b_0 - dotproduct(a_vec,b_vec); a_0*b_vec + b_0*a_vec + crossproduct(a_vec,b_vec)]</p>

<p>where the order a,b is important since the cross product of two vectors is not commutative.</p>
<h4 id="from-an-orthogonal-matrix-to-a-quaternion">From an orthogonal matrix to a quaternion</h4>

<p>One must be careful when converting a rotation matrix to a quaternion, as several straightforward methods tend to be unstable when the <a href="Trace_(linear_algebra)" title="wikilink">trace</a> (sum of the diagonal elements) of the rotation matrix is zero or very small. For a stable method of converting an orthogonal matrix to a quaternion, see <a href="Rotation_matrix#Quaternion" title="wikilink">Rotation matrix#Quaternion</a>.</p>
<h4 id="fitting-quaternions">Fitting quaternions</h4>

<p>The above section described how to recover a quaternion 

<math display="inline" id="Quaternions_and_spatial_rotation:115">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 from a  <a href="rotation_matrix" title="wikilink">rotation matrix</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:116">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

. Suppose, however, that we have some matrix 

<math display="inline" id="Quaternions_and_spatial_rotation:117">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 that is not a pure rotation—due to <a href="round-off_error" title="wikilink">round-off errors</a>, for example—and we wish to find the quaternion 

<math display="inline" id="Quaternions_and_spatial_rotation:118">
 <semantics>
  <mi>𝐪</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐪</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}
  </annotation>
 </semantics>
</math>

 that most accurately represents 

<math display="inline" id="Quaternions_and_spatial_rotation:119">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

. In that case we construct a symmetric  matrix</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:120">
 <semantics>
  <mrow>
   <mrow>
    <mi>K</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>3</mn>
     </mfrac>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>z</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>z</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>x</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>z</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>x</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>Q</mi>
           <mrow>
            <mi>z</mi>
            <mi>z</mi>
           </mrow>
          </msub>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">3</cn>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=\frac{1}{3}\begin{bmatrix}Q_{xx}-Q_{yy}-Q_{zz}&Q_{yx}+Q_{xy}&Q_{zx}+Q_{xz}&Q%
_{yz}-Q_{zy}\\
Q_{yx}+Q_{xy}&Q_{yy}-Q_{xx}-Q_{zz}&Q_{zy}+Q_{yz}&Q_{zx}-Q_{xz}\\
Q_{zx}+Q_{xz}&Q_{zy}+Q_{yz}&Q_{zz}-Q_{xx}-Q_{yy}&Q_{xy}-Q_{yx}\\
Q_{yz}-Q_{zy}&Q_{zx}-Q_{xz}&Q_{xy}-Q_{yx}&Q_{xx}+Q_{yy}+Q_{zz}\end{bmatrix},
  </annotation>
 </semantics>
</math>

 and find the <a class="uri" href="eigenvector" title="wikilink">eigenvector</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:121">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mi>z</mi>
   <mo>,</mo>
   <mi>w</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>x</ci>
    <ci>y</ci>
    <ci>z</ci>
    <ci>w</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y,z,w)
  </annotation>
 </semantics>
</math>

 corresponding to the largest eigenvalue (that value will be 1 if and only if 

<math display="inline" id="Quaternions_and_spatial_rotation:122">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 is a pure rotation). The quaternion so obtained will correspond to the rotation closest to the original matrix 

<math display="inline" id="Quaternions_and_spatial_rotation:123">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h3 id="performance-comparisons">Performance comparisons</h3>

<p>This section discusses the performance implications of using quaternions versus other methods (axis/angle or rotation matrices) to perform rotations in 3D.</p>
<h4 id="results">Results</h4>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Storage requirements</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Method</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><a href="Rotation_matrix" title="wikilink">Rotation matrix</a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><a class="uri" href="Quaternion" title="wikilink">Quaternion</a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><a href="Axis-angle_representation" title="wikilink">Angle/axis</a></p></td>
</tr>
</tbody>
</table>

<p>* Note: angle/axis can be stored as 3 elements by multiplying the unit rotation axis by half of the rotation angle, forming the logarithm of the quaternion, at the cost of additional calculations.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Performance comparison of rotation chaining operations</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Method</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Rotation matrices</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Quaternions</p></td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Performance comparison of vector rotating operations<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Method</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Rotation matrix</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Quaternions</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Angle/axis</p></td>
</tr>
</tbody>
</table>
<h4 id="used-methods">Used methods</h4>

<p>There are three basic approaches to rotating a vector :</p>
<ol>
<li>Compute the matrix product of a 3 × 3 <a href="rotation_matrix" title="wikilink">rotation matrix</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:124">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 and the original 3 × 1 <a href="column_vector" title="wikilink">column</a> matrix representing . This requires 3 × (3 multiplications + 2 additions) = 9 multiplications and 6 additions, the most efficient method for rotating a vector.</li>
<li>A rotation can be represented by a unit-length quaternion 

<math display="inline" id="Quaternions_and_spatial_rotation:125">
 <semantics>
  <mrow>
   <mi>𝐪</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo>,</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-,</ci>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}=(w,)
  </annotation>
 </semantics>
</math>

 with scalar (real) part 

<math display="inline" id="Quaternions_and_spatial_rotation:126">
 <semantics>
  <mi>w</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>w</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w
  </annotation>
 </semantics>
</math>

 and vector (imaginary) part . The rotation can be applied to a 3D vector  via the formula 

<math display="inline" id="Quaternions_and_spatial_rotation:127">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mtext>new</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mover accent="true">
       <mi>r</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mo>×</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>r</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo>×</mo>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>w</mi>
        <mover accent="true">
         <mi>v</mi>
         <mo stretchy="false">→</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <mtext>new</mtext>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>r</ci>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>w</ci>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{\text{new}}=\vec{v}+2\vec{r}\times(\vec{r}\times\vec{v}+w\vec{v})
  </annotation>
 </semantics>
</math>

. This requires only 15 multiplications and 15 additions to evaluate (or 18 muls and 12 adds if the factor of 2 is done via multiplication.) This formula, originally thought to be used with axis/angle notation (Rodrigues' formula), can also be applied to quaternion notation. This yields the same result as the less efficient but more compact formula of quaternion multiplication 

<math display="inline" id="Quaternions_and_spatial_rotation:128">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mtext>new</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>q</mi>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <msup>
     <mi>q</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <mtext>new</mtext>
    </apply>
    <apply>
     <times></times>
     <ci>q</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{\text{new}}=q\vec{v}q^{-1}
  </annotation>
 </semantics>
</math>

.</li>
<li>Use the <a href="Rotation_matrix#Angle-Axis_representation_and_quaternion_representation" title="wikilink">angle/axis formula</a> to convert an angle/axis to a <a href="rotation_matrix" title="wikilink">rotation matrix</a> 

<math display="inline" id="Quaternions_and_spatial_rotation:129">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 then multiplying with a vector, or, similarly, use a formula to convert quaternion notation to a rotation matrix, then multiplying with a vector. Converting the angle/axis to 

<math display="inline" id="Quaternions_and_spatial_rotation:130">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 costs 12 multiplies, 2 function calls (sin, cos), and 10 add/subtracts; from item 1, rotating using 

<math display="inline" id="Quaternions_and_spatial_rotation:131">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 adds an additional 9 multiplications and 6 additions for a total of 21 multiplies, 16 add/subtracts, and 2 function calls (sin, cos). Converting a quaternion to 

<math display="inline" id="Quaternions_and_spatial_rotation:132">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 costs 12 multiplies and 12 add/subtracts; from item 1, rotating using 

<math display="inline" id="Quaternions_and_spatial_rotation:133">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 adds an additional 9 multiplications and 6 additions for a total of 21 multiplies and 18 add/subtracts.</li>
</ol>
<h2 id="pairs-of-unit-quaternions-as-rotations-in-4d-space">Pairs of unit quaternions as rotations in 4D space</h2>

<p>A pair of unit quaternions <mtpl></mtpl> and <mtpl></mtpl> can represent any <a href="Rotations_in_4-dimensional_Euclidean_space" title="wikilink">rotation in 4D space</a>. Given a four dimensional vector , and pretending that it is a quaternion, we can rotate the vector  like this:</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:134">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>𝐳</mi>
      <mi mathvariant="normal">l</mi>
     </msub>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <msub>
      <mi>𝐳</mi>
      <mi mathvariant="normal">r</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>a</mi>
          <mi mathvariant="normal">l</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>b</mi>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>c</mi>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>d</mi>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>b</mi>
          <mi mathvariant="normal">l</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>a</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>d</mi>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>c</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mi mathvariant="normal">l</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>d</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>a</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>b</mi>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>d</mi>
          <mi mathvariant="normal">l</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>c</mi>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>b</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>a</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">l</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>a</mi>
          <mi mathvariant="normal">r</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>b</mi>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>c</mi>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>d</mi>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>b</mi>
          <mi mathvariant="normal">r</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>a</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>d</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>c</mi>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mi mathvariant="normal">r</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>d</mi>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>a</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>b</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>d</mi>
          <mi mathvariant="normal">r</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>c</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>b</mi>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mi>a</mi>
          <msub>
           <mo>;</mo>
           <mi mathvariant="normal">r</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mi>w</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>x</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>y</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>z</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐳</ci>
       <ci>normal-l</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐳</ci>
       <ci>normal-r</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>normal-l</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>normal-l</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>normal-l</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>normal-l</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>normal-l</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">a</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-l</ci>
         </apply>
        </cerror>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>normal-l</ci>
         </apply>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">c</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-l</ci>
         </apply>
        </cerror>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>normal-l</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">d</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-l</ci>
         </apply>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">a</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-l</ci>
         </apply>
        </cerror>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>normal-l</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>normal-l</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>normal-l</ci>
         </apply>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">b</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-l</ci>
         </apply>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">a</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-l</ci>
         </apply>
        </cerror>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>normal-r</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>normal-r</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>normal-r</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>normal-r</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>normal-r</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">a</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-r</ci>
         </apply>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">d</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-r</ci>
         </apply>
        </cerror>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>normal-r</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>normal-r</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>normal-r</ci>
         </apply>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">a</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-r</ci>
         </apply>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">b</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-r</ci>
         </apply>
        </cerror>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>normal-r</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">c</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-r</ci>
         </apply>
        </cerror>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>normal-r</ci>
         </apply>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">a</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-;</ci>
          <ci>normal-r</ci>
         </apply>
        </cerror>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <ci>w</ci>
       </matrixrow>
       <matrixrow>
        <ci>x</ci>
       </matrixrow>
       <matrixrow>
        <ci>y</ci>
       </matrixrow>
       <matrixrow>
        <ci>z</ci>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\vec{v})=\mathbf{z}_{\rm{l}}\vec{v}\mathbf{z}_{\rm{r}}=\begin{pmatrix}a_{\rm%
{l}}&-b_{\rm{l}}&-c_{\rm{l}}&-d_{\rm{l}}\\
b_{\rm{l}}&a;_{\rm{l}}&-d_{\rm{l}}&c;_{\rm{l}}\\
c_{\rm{l}}&d;_{\rm{l}}&a;_{\rm{l}}&-b_{\rm{l}}\\
d_{\rm{l}}&-c_{\rm{l}}&b;_{\rm{l}}&a;_{\rm{l}}\end{pmatrix}\begin{pmatrix}a_{%
\rm{r}}&-b_{\rm{r}}&-c_{\rm{r}}&-d_{\rm{r}}\\
b_{\rm{r}}&a;_{\rm{r}}&d;_{\rm{r}}&-c_{\rm{r}}\\
c_{\rm{r}}&-d_{\rm{r}}&a;_{\rm{r}}&b;_{\rm{r}}\\
d_{\rm{r}}&c;_{\rm{r}}&-b_{\rm{r}}&a;_{\rm{r}}\end{pmatrix}\begin{pmatrix}w\\
x\\
y\\
z\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>The pair of matrices represents a rotation of ℝ<sup>4</sup>. Note that since 

<math display="inline" id="Quaternions_and_spatial_rotation:135">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>𝐳</mi>
       <mi mathvariant="normal">l</mi>
      </msub>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>𝐳</mi>
     <mi mathvariant="normal">r</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐳</mi>
     <mi mathvariant="normal">l</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <msub>
       <mi>𝐳</mi>
       <mi mathvariant="normal">r</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐳</ci>
       <ci>normal-l</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐳</ci>
      <ci>normal-r</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐳</ci>
      <ci>normal-l</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐳</ci>
       <ci>normal-r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{z}_{\rm{l}}\vec{v})\mathbf{z}_{\rm{r}}=\mathbf{z}_{\rm{l}}(\vec{v}%
\mathbf{z}_{\rm{r}})
  </annotation>
 </semantics>
</math>

, the two matrices must commute. Therefore, there are two commuting subgroups of the set of four dimensional rotations. Arbitrary four dimensional rotations have 6 degrees of freedom, each matrix represents 3 of those 6 degrees of freedom.</p>

<p>Since the generators of the four-dimensional rotations can be represented by pairs of quaternions (as follows), all four-dimensional rotations can also be represented.</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:136">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐳</mi>
     <mi mathvariant="normal">l</mi>
    </msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <msub>
     <mi>𝐳</mi>
     <mi mathvariant="normal">r</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mrow>
            <mi>a</mi>
            <mi>b</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mrow>
            <mi>a</mi>
            <mi>c</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mrow>
            <mi>a</mi>
            <mi>d</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>a</mi>
           <mi>b</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mrow>
            <mi>b</mi>
            <mi>c</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mrow>
            <mi>b</mi>
            <mi>d</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>a</mi>
           <mi>c</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>b</mi>
           <mi>c</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mrow>
            <mi>c</mi>
            <mi>d</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>a</mi>
           <mi>d</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>b</mi>
           <mi>d</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>c</mi>
           <mi>d</mi>
          </mrow>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>w</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>x</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>z</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐳</ci>
      <ci>normal-l</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐳</ci>
      <ci>normal-r</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>b</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>c</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>a</ci>
          <ci>b</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>c</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>a</ci>
          <ci>c</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>b</ci>
          <ci>c</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>c</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>a</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>b</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>c</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <ci>w</ci>
      </matrixrow>
      <matrixrow>
       <ci>x</ci>
      </matrixrow>
      <matrixrow>
       <ci>y</ci>
      </matrixrow>
      <matrixrow>
       <ci>z</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{z}_{\rm{l}}\vec{v}\mathbf{z}_{\rm{r}}=\begin{pmatrix}1&-dt_{ab}&-dt_{%
ac}&-dt_{ad}\\
dt_{ab}&1&-dt_{bc}&-dt_{bd}\\
dt_{ac}&dt_{bc}&1&-dt_{cd}\\
dt_{ad}&dt_{bd}&dt_{cd}&1\end{pmatrix}\begin{pmatrix}w\\
x\\
y\\
z\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:137">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐳</mi>
    <mi mathvariant="normal">l</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>a</mi>
          <mi>b</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>c</mi>
          <mi>d</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi>i</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>a</mi>
          <mi>c</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>b</mi>
          <mi>d</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi>j</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>a</mi>
          <mi>d</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>b</mi>
          <mi>c</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi>k</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐳</ci>
     <ci>normal-l</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>b</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>c</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>c</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>c</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{z}_{\rm{l}}=1+{dt_{ab}+dt_{cd}\over 2}i+{dt_{ac}-dt_{bd}\over 2}j+{dt_%
{ad}+dt_{bc}\over 2}k
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Quaternions_and_spatial_rotation:138">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐳</mi>
    <mi mathvariant="normal">r</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>a</mi>
          <mi>b</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>c</mi>
          <mi>d</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi>i</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>a</mi>
          <mi>c</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>b</mi>
          <mi>d</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi>j</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>a</mi>
          <mi>d</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mrow>
          <mi>b</mi>
          <mi>c</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi>k</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐳</ci>
     <ci>normal-r</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>b</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>c</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>c</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>c</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{z}_{\rm{r}}=1+{dt_{ab}-dt_{cd}\over 2}i+{dt_{ac}+dt_{bd}\over 2}j+{dt_%
{ad}-dt_{bc}\over 2}k
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Anti-twister_mechanism" title="wikilink">Anti-twister mechanism</a></li>
<li><a href="Binary_polyhedral_group" title="wikilink">Binary polyhedral group</a></li>
<li><a class="uri" href="Biquaternion" title="wikilink">Biquaternion</a></li>
<li><a href="Charts_on_SO(3)" title="wikilink">Charts on SO(3)</a></li>
<li><a href="Clifford_algebra" title="wikilink">Clifford algebras</a></li>
<li><a href="Conversion_between_quaternions_and_Euler_angles" title="wikilink">Conversion between quaternions and Euler angles</a></li>
<li><a href="Covering_space" title="wikilink">Covering space</a></li>
<li><a href="Dual_quaternion" title="wikilink">Dual quaternion</a></li>
<li><a href="Elliptic_geometry#Elliptic_space" title="wikilink">Elliptic geometry#Elliptic space</a></li>
<li><a href="Quaternion_rotation_biradial" title="wikilink">Quaternion rotation biradial</a></li>
<li><a href="Rotation_formalisms_in_three_dimensions" title="wikilink">Rotation formalisms in three dimensions</a></li>
<li><a href="Rotation_(mathematics)" title="wikilink">Rotation (mathematics)</a></li>
<li><a href="Spin_group" title="wikilink">Spin group</a></li>
<li><a class="uri" href="Slerp" title="wikilink">Slerp</a>, spherical linear interpolation</li>
<li><a href="Olinde_Rodrigues" title="wikilink">Olinde Rodrigues</a></li>
<li><a href="William_Rowan_Hamilton" title="wikilink">William Rowan Hamilton</a></li>
</ul>
<h2 id="references">References</h2>

<p>E. P. Battey-Pratt &amp; T. J. Racey (1980) Geometric Model for Fundamental Particles <em>International Journal of Theoretical Physics. Vol 19, No. 6</em></p>
<h2 id="external-links-and-resources">External links and resources</h2>
<ul>
<li><a href="http://www.cs.ucr.edu/~vbz/resources/quatut.pdf">Shoemake, Ken. Quaternions</a></li>
<li><a href="http://rosettacode.org/wiki/Simple_Quaternion_type_and_operations">Simple Quaternion type and operations in over thirty computer languages</a> on <a href="Rosetta_Code" title="wikilink">Rosetta Code</a></li>
<li><a href="http://graphics.stanford.edu/courses/cs348c-95-fall/software/quatdemo/">Hart, Francis, Kauffman. Quaternion demo</a></li>
<li><a href="http://www.diku.dk/publikationer/tekniske.rapporter/1998/98-5.ps.gz">Dam, Koch, Lillholm. Quaternions, Interpolation and Animation</a></li>
<li><a href="http://www.cs.unc.edu/techreports/01-014.pdf">Vicci, Leandra. Quaternions and Rotations in 3-Space: The Algebra and its Geometric Interpretation</a></li>
<li><a href="http://world.std.com/~sweetser/quaternions/ps/cornellcstr75-245.pdf">Howell, Thomas and Lafon, Jean-Claude. The Complexity of the Quaternion Product, TR75-245, Cornell University, 1975</a></li>
<li><a href="http://people.csail.mit.edu/bkph/articles/Quaternions.pdf">Berthold K.P. Horn. Some Notes on Unit Quaternions and Rotation</a>.</li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Quaternions" title="wikilink">Category:Quaternions</a> <a href="Category:Rotation_in_three_dimensions" title="wikilink">Category:Rotation in three dimensions</a> <a href="Category:3D_computer_graphics" title="wikilink">Category:3D computer graphics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Amnon Katz (1996) <em>Computational Rigid Vehicle Dynamics</em>, <a href="Krieger_Publishing_Co." title="wikilink">Krieger Publishing Co.</a> ISBN 978-1575240169<a href="#fnref1">↩</a></li>
<li id="fn2">J. B. Kuipers (1999) <em>Quaternions and rotation Sequences: a Primer with Applications to Orbits, Aerospace, and Virtual Reality</em>, <a href="Princeton_University_Press" title="wikilink">Princeton University Press</a> ISBN 978-0-691-10298-6<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">Simon L. Altman (1986) <em>Rotations, Quaternions, and Double Groups</em>, Dover Publications (see especially Ch. 12).<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6">Eberly, D., Rotation Representations and performance issues<a href="#fnref6">↩</a></li>
</ol>
</section>
</hr></body>
</html>

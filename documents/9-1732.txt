   Fisher's noncentral hypergeometric distribution      Fisher's noncentral hypergeometric distribution   (Figure)  Probability mass function for Fisher's noncentral hypergeometric distribution for different values of the odds ratio ω.  m 1 = 80, m 2 = 60, n = 100, ω = 0.01, ..., 1000   In probability theory and statistics , Fisher's noncentral hypergeometric distribution is a generalization of the hypergeometric distribution where sampling probabilities are modified by weight factors. Fisher's noncentral hypergeometric distribution can also be defined as the conditional distribution of two or more binomially distributed variables dependent upon their fixed sum.  The distribution may be illustrated by the following urn model . Assume, for example, that an urn contains m 1 red balls and m 2 white balls, totalling N = m 1 + m 2 balls. Each red ball has the weight ω 1 and each white ball has the weight ω 2 . We will say that the odds ratio is ω = ω 1 / ω 2 . Now we are taking balls randomly in such a way that the probability of taking a particular ball is proportional to its weight, but independent of what happens to the other balls. The number of balls taken of a particular color follows the binomial distribution . If the total number n of balls taken is known then the conditional distribution of the number of taken red balls for given n is Fisher's noncentral hypergeometric distribution. To generate this distribution experimentally, we have to repeat the experiment until it happens to give n balls.  If we want to fix the value of n prior to the experiment then we have to take the balls one by one until we have n balls. The balls are therefore no longer independent. This gives a slightly different distribution known as Wallenius' noncentral hypergeometric distribution . It is far from obvious why these two distributions are different. See the entry for noncentral hypergeometric distributions for an explanation of the difference between these two distributions and a discussion of which distribution to use in various situations.  The two distributions are both equal to the (central) hypergeometric distribution when the odds ratio is 1.  Unfortunately, both distributions are known in the literature as "the" noncentral hypergeometric distribution. It is important to be specific about which distribution is meant when using this name.  Fisher's noncentral hypergeometric distribution was first given the name extended hypergeometric distribution (Harkness, 1965), and some authors still use this name today.  Univariate distribution  \right\rfloor \, , where    A  =   ω  -  1       A    ω  1     A=\omega-1   ,    B  =     m  1   +  n   -  N  -    (    m  1   +  n  +  2   )   ω        B       subscript  m  1   n   N       subscript  m  1   n  2   ω      B=m_{1}+n-N-(m_{1}+n+2)\omega   ,    C  =    (    m  1   +  1   )    (   n  +  1   )   ω       C       subscript  m  1   1     n  1   ω     C=(m_{1}+1)(n+1)\omega   .|  variance   =       P  2    P  0    -    (    P  1    P  0    )   2          subscript  P  2    subscript  P  0     superscript     subscript  P  1    subscript  P  0    2     \frac{P_{2}}{P_{0}}-\left(\frac{P_{1}}{P_{0}}\right)^{2}    , where P k is given above.|  skewness   =|  kurtosis   =|  entropy    =|  mgf        =|  char       =  }}  The probability function, mean and variance are given in the table to the right.  An alternative expression of the distribution has both the number of balls taken of each color and the number of balls not taken as random variables, whereby the expression for the probability becomes symmetric.  The calculation time for the probability function can be high when the sum in P 0 has many terms. The calculation time can be reduced by calculating the terms in the sum recursively relative to the term for y = x and ignoring negligible terms in the tails (Liao and Rosen, 2001).  The mean can be approximated by:      μ  ≈     -   2  c     b  -     b  2   -   4  a  c            μ        2  c      b       superscript  b  2     4  a  c         \mu\approx\frac{-2c}{b-\sqrt{b^{2}-4ac}}\,   , where    a  =   ω  -  1       a    ω  1     a=\omega-1   ,    b  =     m  1   +  n   -  N  -    (    m  1   +  n   )   ω        b       subscript  m  1   n   N       subscript  m  1   n   ω      b=m_{1}+n-N-(m_{1}+n)\omega   ,    c  =    m  1   n  ω       c     subscript  m  1   n  ω     c=m_{1}n\omega   .  The variance can be approximated by:       σ  2   ≈    N   N  -  1    /   (    1  μ   +   1    m  1   -  μ    +   1   n  -  μ    +   1    μ  +   m  2    -  n     )         superscript  σ  2       N    N  1        1  μ     1     subscript  m  1   μ      1    n  μ      1      μ   subscript  m  2    n        \sigma^{2}\approx\frac{N}{N-1}\bigg/\left(\frac{1}{\mu}+\frac{1}{m_{1}-\mu}+%
 \frac{1}{n-\mu}+\frac{1}{\mu+m_{2}-n}\right)   .  Better approximations to the mean and variance are given by Levin (1984, 1990), McCullagh and Nelder (1989), Liao (1992), and Eisinga and Pelzer (2011). The saddlepoint methods to approximate the mean and the variance suggested Eisinga and Pelzer (2011) offer extremely accurate results.  Properties  The following symmetry relations apply:        fnchypg   (  x  ;  n  ,   m  1   ,  N  ,  ω  )    =   fnchypg   (   n  -  x   ;  n  ,   m  2   ,  N  ,   1  /  ω   )     .       fnchypg  x  n   subscript  m  1   N  ω    fnchypg    n  x   n   subscript  m  2   N    1  ω      \operatorname{fnchypg}(x;n,m_{1},N,\omega)=\operatorname{fnchypg}(n-x;n,m_{2},%
 N,1/\omega)\,.           fnchypg   (  x  ;  n  ,   m  1   ,  N  ,  ω  )    =   fnchypg   (  x  ;   m  1   ,  n  ,  N  ,  ω  )     .       fnchypg  x  n   subscript  m  1   N  ω    fnchypg  x   subscript  m  1   n  N  ω     \operatorname{fnchypg}(x;n,m_{1},N,\omega)=\operatorname{fnchypg}(x;m_{1},n,N,%
 \omega)\,.           fnchypg   (  x  ;  n  ,   m  1   ,  N  ,  ω  )    =   fnchypg   (    m  1   -  x   ;   N  -  n   ,   m  1   ,  N  ,   1  /  ω   )     .       fnchypg  x  n   subscript  m  1   N  ω    fnchypg     subscript  m  1   x     N  n    subscript  m  1   N    1  ω      \operatorname{fnchypg}(x;n,m_{1},N,\omega)=\operatorname{fnchypg}(m_{1}-x;N-n,%
 m_{1},N,1/\omega)\,.     Recurrence relation:        fnchypg   (  x  ;  n  ,   m  1   ,  N  ,  ω  )    =    fnchypg   (   x  -  1   ;  n  ,   m  1   ,  N  ,  ω  )       (     m  1   -  x   +  1   )    (    n  -  x   +  1   )     x   (     m  2   -  n   +  x   )      ω     .       fnchypg  x  n   subscript  m  1   N  ω      fnchypg    x  1   n   subscript  m  1   N  ω            subscript  m  1   x   1       n  x   1      x       subscript  m  2   n   x     ω     \operatorname{fnchypg}(x;n,m_{1},N,\omega)=\operatorname{fnchypg}(x-1;n,m_{1},%
 N,\omega)\frac{(m_{1}-x+1)(n-x+1)}{x(m_{2}-n+x)}\omega\,.      Recurrence relation  A Fisher hypergeometric distribution gives the distribution of the number of successes in   n   n   n   independent draws from a population of size    n  tot     subscript  n  tot    n_{\text{tot}}   containing    n  succ     subscript  n  succ    n_{\text{succ}}   successes with the odds ratio   w   w   w   .      {         w  f   (  x  )    (   x  -  n   )    (    n  succ   -  x   )    -    (   x  +  1   )   f   (   x  +  1   )    (    n  +   n  succ    -   n  tot   -  x  -  1   )     =  0   ,         f   (  0  )    =   1     F  1    2      (   -  n   ,   -   n  succ    ;     -  n   -   n  succ    +   n  tot   +  1   ;  w  )         }             w  f  x    x  n      subscript  n  succ   x        x  1   f    x  1       n   subscript  n  succ     subscript  n  tot   x  1     0         f  0     1     subscript   subscript  F  1   2      n      subscript  n  succ          n    subscript  n  succ     subscript  n  tot   1   w          \left\{\begin{array}[]{l}wf(x)(x-n)(n_{\text{succ}}-x)-(x+1)f(x+1)(n+n_{\text{%
 succ}}-n_{\text{tot}}-x-1)=0,\\
 f(0)=\frac{1}{\,{}_{2}F_{1}(-n,-n_{\text{succ}};-n-n_{\text{succ}}+n_{\text{%
 tot}}+1;w)}\end{array}\right\}     Multivariate distribution  \prod_{i=1}^{c} \binom{m_i}{y_i}\omega_i^{y_i}|  cdf        =|  mean       =The mean μ i of x i can be approximated by      μ  i   =     m  i   r   ω  i      r   ω  i    +  1         subscript  μ  i        subscript  m  i   r   subscript  ω  i        r   subscript  ω  i    1      \mu_{i}=\frac{m_{i}r\omega_{i}}{r\omega_{i}+1}    where r is the unique positive solution to       ∑   i  =  1   c    μ  i    =   n         superscript   subscript     i  1    c    subscript  μ  i    n    \sum_{i=1}^{c}\mu_{i}=n\,    .|  median     =|  mode       =|  variance   =|  skewness   =|  kurtosis   =|  entropy    =|  mgf        =|  char       =  }}  The distribution can be expanded to any number of colors c of balls in the urn. The multivariate distribution is used when there are more than two colors.  The probability function and a simple approximation to the mean are given to the right. Better approximations to the mean and variance are given by McCullagh and Nelder (1989).  Properties  The order of the colors is arbitrary so that any colors can be swapped.  The weights can be arbitrarily scaled:       mfnchypg   (  𝐱  ;  n  ,  𝐦  ,  𝝎  )    =   mfnchypg   (  𝐱  ;  n  ,  𝐦  ,   r  𝝎   )         mfnchypg  𝐱  n  𝐦  𝝎    mfnchypg  𝐱  n  𝐦    r  𝝎      \operatorname{mfnchypg}(\mathbf{x};n,\mathbf{m},\boldsymbol{\omega})=%
 \operatorname{mfnchypg}(\mathbf{x};n,\mathbf{m},r\boldsymbol{\omega})\,\,   for all     r  ∈   ℝ  +    .      r   subscript  ℝ      r\in\mathbb{R}_{+}.     Colors with zero number ( m i = 0) or zero weight (ω i = 0) can be omitted from the equations.  Colors with the same weight can be joined:      mfnchypg   (  𝐱  ;  n  ,  𝐦  ,   (   ω  1   ,  …  ,   ω   c  -  1    ,   ω   c  -  1    )   )      mfnchypg  𝐱  n  𝐦    subscript  ω  1   normal-…   subscript  ω    c  1     subscript  ω    c  1       \displaystyle{}\operatorname{mfnchypg}\left(\mathbf{x};n,\mathbf{m},(\omega_{1%
 },\ldots,\omega_{c-1},\omega_{c-1})\right)     where    hypg   (  x  ;  n  ,  m  ,  N  )      hypg  x  n  m  N    \operatorname{hypg}(x;n,m,N)   is the (univariate, central) hypergeometric distribution probability.    Applications  Fisher's noncentral hypergeometric distribution is useful for models of biased sampling or biased selection where the individual items are sampled independently of each other with no competition. The bias or odds can be estimated from an experimental value of the mean. Use Wallenius' noncentral hypergeometric distribution instead if items are sampled one by one with competition.  Fisher's noncentral hypergeometric distribution is used mostly for tests in contingency tables where a conditional distribution for fixed margins is desired. This can be useful, for example, for testing or measuring the effect of a medicine. See McCullagh and Nelder (1989).  Software available   FisherHypergeometricDistribution in Mathematica .  An implementation for the R programming language is available as the package named BiasedUrn . Includes univariate and multivariate probability mass functions, distribution functions, quantiles , random variable generating functions, mean and variance.  The R package MCMCpack includes the univariate probability mass function and random variable generating function.  SAS System includes univariate probability mass function and distribution function.  Implementation in C++ is available from www.agner.org .  Calculation methods are described by Liao and Rosen (2001) and Fog (2008).   See also   Noncentral hypergeometric distributions  Wallenius' noncentral hypergeometric distribution  Hypergeometric distribution  Urn models  Biased sample  Bias  Contingency table  Fisher's exact test   References  .  .  .  .  .  .  .  .  .  .   "  Category:Discrete distributions  Category:Probability distributions   
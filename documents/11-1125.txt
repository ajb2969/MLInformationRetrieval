   Cylindrical harmonics      Cylindrical harmonics   In mathematics , the cylindrical harmonics are a set of linearly independent solutions to Laplace's differential equation ,      ∇  2   V   =  0        superscript  normal-∇  2   V   0    \nabla^{2}V=0   , expressed in cylindrical coordinates , ρ (radial coordinate), φ (polar angle), and z (height). Each function V n ( k ) is the product of three terms, each depending on one coordinate alone. The ρ -dependent term is given by Bessel functions (which occasionally are also called cylindrical harmonics).  Definition  Each function     V  n    (  k  )        subscript  V  n   k    V_{n}(k)   of this basis consists of the product of three functions:        V  n    (  k  ;  ρ  ,  φ  ,  z  )    =    P  n    (  k  ,  ρ  )    Φ  n    (  φ  )   Z   (  k  ,  z  )           subscript  V  n    k  ρ  φ  z       subscript  P  n    k  ρ    subscript  normal-Φ  n   φ  Z   k  z      V_{n}(k;\rho,\varphi,z)=P_{n}(k,\rho)\Phi_{n}(\varphi)Z(k,z)\,     where    (  ρ  ,  φ  ,  z  )     ρ  φ  z    (\rho,\varphi,z)   are the cylindrical coordinates, and n and k are constants which distinguish the members of the set from each other. As a result of the superposition principle applied to Laplace's equation, very general solutions to Laplace's equation can be obtained by linear combinations of these functions.  Since all of the surfaces of constant ρ, φ and z are conicoid, Laplace's equation is separable in cylindrical coordinates. Using the technique of the separation of variables , a separated solution to Laplace's equation may be written:      V  =   P   (  ρ  )   Φ   (  φ  )   Z   (  z  )        V    P  ρ  normal-Φ  φ  Z  z     V=P(\rho)\,\Phi(\varphi)\,Z(z)     and Laplace's equation, divided by V , is written:         P  ¨   P   +     1  ρ      P  ˙   P    +     1   ρ  2       Φ  ¨   Φ    +    Z  ¨   Z    =  0           normal-¨  P   P       1  ρ      normal-˙  P   P        1   superscript  ρ  2       normal-¨  normal-Φ   normal-Φ       normal-¨  Z   Z    0    \frac{\ddot{P}}{P}+\frac{1}{\rho}\,\frac{\dot{P}}{P}+\frac{1}{\rho^{2}}\,\frac%
 {\ddot{\Phi}}{\Phi}+\frac{\ddot{Z}}{Z}=0     The Z part of the equation is a function of z alone, and must therefore be equal to a constant:        Z  ¨   Z   =   k  2          normal-¨  Z   Z    superscript  k  2     \frac{\ddot{Z}}{Z}=k^{2}     where k is, in general, a complex number . For a particular k , the Z(z) function has two linearly independent solutions. If k is real they are:       Z   (  k  ,  z  )    =    cosh   (   k  z   )    or   sinh   (   k  z   )           Z   k  z         k  z    or      k  z       Z(k,z)=\cosh(kz)\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,\sinh(kz)\,     or by their behavior at infinity:       Z   (  k  ,  z  )    =    e   k  z    or    e   -   k  z             Z   k  z      superscript  e    k  z    or   superscript  e      k  z        Z(k,z)=e^{kz}\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,e^{-kz}\,     If k is imaginary:       Z   (  k  ,  z  )    =    cos   (    |  k  |   z   )    or   sin   (    |  k  |   z   )           Z   k  z           k   z    or        k   z       Z(k,z)=\cos(|k|z)\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,\sin(|k|z)\,     or:       Z   (  k  ,  z  )    =    e   i   |  k  |   z    or    e   -   i   |  k  |   z             Z   k  z      superscript  e    i    k   z    or   superscript  e      i    k   z        Z(k,z)=e^{i|k|z}\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,e^{-i|k|z}\,     It can be seen that the Z(k,z) functions are the kernels of the Fourier transform or Laplace transform of the Z(z) function and so k may be a discrete variable for periodic boundary conditions, or it may be a continuous variable for non-periodic boundary conditions.  Substituting    k  2     superscript  k  2    k^{2}   for     Z  ¨   /  Z       normal-¨  Z   Z    \ddot{Z}/Z   , Laplace's equation may now be written:         P  ¨   P   +     1  ρ      P  ˙   P    +    1   ρ  2      Φ  ¨   Φ    +   k  2    =  0           normal-¨  P   P       1  ρ      normal-˙  P   P        1   superscript  ρ  2       normal-¨  normal-Φ   normal-Φ     superscript  k  2    0    \frac{\ddot{P}}{P}+\frac{1}{\rho}\,\frac{\dot{P}}{P}+\frac{1}{\rho^{2}}\frac{%
 \ddot{\Phi}}{\Phi}+k^{2}=0     Multiplying by    ρ  2     superscript  ρ  2    \rho^{2}   , we may now separate the P and Φ functions and introduce another constant ( n ) to obtain:        Φ  ¨   Φ   =   -   n  2           normal-¨  normal-Φ   normal-Φ      superscript  n  2      \frac{\ddot{\Phi}}{\Phi}=-n^{2}            ρ  2     P  ¨   P    +   ρ    P  ˙   P    +    k  2    ρ  2     =   n  2            superscript  ρ  2      normal-¨  P   P      ρ     normal-˙  P   P       superscript  k  2    superscript  ρ  2      superscript  n  2     \rho^{2}\frac{\ddot{P}}{P}+\rho\frac{\dot{P}}{P}+k^{2}\rho^{2}=n^{2}     Since   φ   φ   \varphi   is periodic, we may take n to be a non-negative integer and accordingly, the    Φ   (  φ  )       normal-Φ  φ    \Phi(\varphi)   the constants are subscripted. Real solutions for    Φ   (  φ  )       normal-Φ  φ    \Phi(\varphi)   are       Φ  n   =    cos   (   n  φ   )    or   sin   (   n  φ   )          subscript  normal-Φ  n        n  φ    or      n  φ       \Phi_{n}=\cos(n\varphi)\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,\sin(n\varphi)     or, equivalently:       Φ  n   =    e   i  n  φ    or   e   -   i  n  φ           subscript  normal-Φ  n     superscript  e    i  n  φ    or   superscript  e      i  n  φ        \Phi_{n}=e^{in\varphi}\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,e^{-in\varphi}     The differential equation for   ρ   ρ   \rho   is a form of Bessel's equation.  If k is zero, but n is not, the solutions are:        P  n    (  0  ,  ρ  )    =    ρ  n   or    ρ   -  n             subscript  P  n    0  ρ      superscript  ρ  n   or   superscript  ρ    n       P_{n}(0,\rho)=\rho^{n}\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,\rho^{-n}\,     If both k and n are zero, the solutions are:        P  0    (  0  ,  ρ  )    =    ln  ρ    or   1            subscript  P  0    0  ρ       ρ     or  1      P_{0}(0,\rho)=\ln\rho\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,1\,     If k is a real number we may write a real solution as:        P  n    (  k  ,  ρ  )    =     J  n    (   k  ρ   )    or    Y  n    (   k  ρ   )            subscript  P  n    k  ρ        subscript  J  n     k  ρ    or     subscript  Y  n     k  ρ       P_{n}(k,\rho)=J_{n}(k\rho)\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,Y_{n}(k\rho)\,     where     J  n    (  z  )        subscript  J  n   z    J_{n}(z)   and     Y  n    (  z  )        subscript  Y  n   z    Y_{n}(z)   are ordinary Bessel functions .  If k is an imaginary number, we may write a real solution as:        P  n    (  k  ,  ρ  )    =     I  n    (    |  k  |   ρ   )    or    K  n    (    |  k  |   ρ   )            subscript  P  n    k  ρ        subscript  I  n       k   ρ    or     subscript  K  n       k   ρ       P_{n}(k,\rho)=I_{n}(|k|\rho)\,\,\,\,\,\,\mathrm{or}\,\,\,\,\,\,K_{n}(|k|\rho)\,     where     I  n    (  z  )        subscript  I  n   z    I_{n}(z)   and     K  n    (  z  )        subscript  K  n   z    K_{n}(z)   are modified Bessel functions .  The cylindrical harmonics for (k,n) are now the product of these solutions and the general solution to Laplace's equation is given by a linear combination of these solutions:       V   (  ρ  ,  φ  ,  z  )    =    ∑  n    ∫   d   k    A  n    (  k  )    P  n    (  k  ,  ρ  )    Φ  n    (  φ  )   Z   (  k  ,  z  )            V   ρ  φ  z      subscript   n       d  k   subscript  A  n   k   subscript  P  n    k  ρ    subscript  normal-Φ  n   φ  Z   k  z        V(\rho,\varphi,z)=\sum_{n}\int dk\,\,A_{n}(k)P_{n}(k,\rho)\Phi_{n}(\varphi)Z(k%
 ,z)\,     where the     A  n    (  k  )        subscript  A  n   k    A_{n}(k)   are constants with respect to the cylindrical coordinates and the limits of the summation and integration are determined by the boundary conditions of the problem. Note that the integral may be replaced by a sum for appropriate boundary conditions. The orthogonality of the     J  n    (  x  )        subscript  J  n   x    J_{n}(x)   is often very useful when finding a solution to a particular problem. The     Φ  n    (  φ  )        subscript  normal-Φ  n   φ    \Phi_{n}(\varphi)   and    Z   (  k  ,  z  )       Z   k  z     Z(k,z)   functions are essentially Fourier or Laplace expansions, and form a set of orthogonal functions. When     P  n    (   k  ρ   )        subscript  P  n     k  ρ     P_{n}(k\rho)   is simply     J  n    (   k  ρ   )        subscript  J  n     k  ρ     J_{n}(k\rho)   , the orthogonality of    J  n     subscript  J  n    J_{n}   , along with the orthogonality relationships of     Φ  n    (  φ  )        subscript  normal-Φ  n   φ    \Phi_{n}(\varphi)   and    Z   (  k  ,  z  )       Z   k  z     Z(k,z)   allow the constants to be determined.  If     (  x  )   k     subscript  x  k    (x)_{k}   is the sequence of the positive zeros of    J  n     subscript  J  n    J_{n}   then:        ∫  0  1     J  n    (    x  k   ρ   )    J  n    (    x  k  ′   ρ   )    ρ   d  ρ    =    1  2    J   n  +  1      (   x  k   )   2    δ   k   k  ′            superscript   subscript   0   1      subscript  J  n      subscript  x  k   ρ    subscript  J  n      superscript   subscript  x  k   normal-′   ρ   ρ  d  ρ        1  2    subscript  J    n  1     superscript   subscript  x  k   2    subscript  δ    k   superscript  k  normal-′        \int_{0}^{1}J_{n}(x_{k}\rho)J_{n}(x_{k}^{\prime}\rho)\rho\,d\rho=\frac{1}{2}J_%
 {n+1}(x_{k})^{2}\delta_{kk^{\prime}}     In solving problems, the space may be divided into any number of pieces, as long as the values of the potential and its derivative match across a boundary which contains no sources.  Example: Point source inside a conducting cylindrical tube  As an example, consider the problem of determining the potential of a unit source located at    (   ρ  0   ,   φ  0   ,   z  0   )      subscript  ρ  0    subscript  φ  0    subscript  z  0     (\rho_{0},\varphi_{0},z_{0})   inside a conducting cylindrical tube (e.g. an empty tin can) which is bounded above and below by the planes    z  =   -  L       z    L     z=-L   and    z  =  L      z  L    z=L   and on the sides by the cylinder    ρ  =  a      ρ  a    \rho=a   . 1 (In MKS units, we will assume      q  /  4   π   ϵ  0    =  1          q  4   π   subscript  ϵ  0    1    q/4\pi\epsilon_{0}=1   ). Since the potential is bounded by the planes on the z axis, the Z(k,z) function can be taken to be periodic. Since the potential must be zero at the origin, we take the     P  n    (   k  ρ   )        subscript  P  n     k  ρ     P_{n}(k\rho)   function to be the ordinary Bessel function     J  n    (   k  ρ   )        subscript  J  n     k  ρ     J_{n}(k\rho)   , and it must be chosen so that one of its zeroes lands on the bounding cylinder. For the measurement point below the source point on the z axis, the potential will be:       V   (  ρ  ,  φ  ,  z  )    =    ∑   n  =  0   ∞      ∑   r  =  0   ∞      A   n  r     J  n    (    k   n  r    ρ   )    cos   (   n   (   φ  -   φ  0    )    )     sinh   (    k   n  r     (   L  +  z   )    )    z     ≤   z  0           V   ρ  φ  z      superscript   subscript     n  0        superscript   subscript     r  0         subscript  A    n  r     subscript  J  n      subscript  k    n  r    ρ       n    φ   subscript  φ  0           subscript  k    n  r      L  z     z           subscript  z  0      V(\rho,\varphi,z)=\sum_{n=0}^{\infty}\sum_{r=0}^{\infty}\,A_{nr}J_{n}(k_{nr}%
 \rho)\cos(n(\varphi-\varphi_{0}))\sinh(k_{nr}(L+z))\,\,\,\,\,z\leq z_{0}     where     k   n  r    a       subscript  k    n  r    a    k_{nr}a   is the r-th zero of     J  n    (  z  )        subscript  J  n   z    J_{n}(z)   and, from the orthogonality relationships for each of the functions:       A   n  r    =      4   (   2  -   δ   n  0     )     a  2         sinh   k   n  r      (   L  -   z  0    )     sinh   2   k   n  r    L          J  n    (    k   n  r     ρ  0    )      k   n  r      [    J   n  +  1     (    k   n  r    a   )    ]   2            subscript  A    n  r          4    2   subscript  δ    n  0       superscript  a  2           subscript  k    n  r       L   subscript  z  0         2   subscript  k    n  r    L          subscript  J  n      subscript  k    n  r     subscript  ρ  0        subscript  k    n  r     superscript   delimited-[]     subscript  J    n  1       subscript  k    n  r    a     2        A_{nr}=\frac{4(2-\delta_{n0})}{a^{2}}\,\,\frac{\sinh k_{nr}(L-z_{0})}{\sinh 2k%
 _{nr}L}\,\,\frac{J_{n}(k_{nr}\rho_{0})}{k_{nr}[J_{n+1}(k_{nr}a)]^{2}}\,     Above the source point:       V   (  ρ  ,  φ  ,  z  )    =    ∑   n  =  0   ∞      ∑   r  =  0   ∞      A   n  r     J  n    (    k   n  r    ρ   )    cos   (   n   (   φ  -   φ  0    )    )     sinh   (    k   n  r     (   L  -  z   )    )    z     ≥   z  0           V   ρ  φ  z      superscript   subscript     n  0        superscript   subscript     r  0         subscript  A    n  r     subscript  J  n      subscript  k    n  r    ρ       n    φ   subscript  φ  0           subscript  k    n  r      L  z     z           subscript  z  0      V(\rho,\varphi,z)=\sum_{n=0}^{\infty}\sum_{r=0}^{\infty}\,A_{nr}J_{n}(k_{nr}%
 \rho)\cos(n(\varphi-\varphi_{0}))\sinh(k_{nr}(L-z))\,\,\,\,\,z\geq z_{0}           A   n  r    =      4   (   2  -   δ   n  0     )     a  2         sinh   k   n  r      (   L  +   z  0    )     sinh   2   k   n  r    L         J  n    (    k   n  r     ρ  0    )      k   n  r      [    J   n  +  1     (    k   n  r    a   )    ]   2       .       subscript  A    n  r          4    2   subscript  δ    n  0       superscript  a  2           subscript  k    n  r       L   subscript  z  0         2   subscript  k    n  r    L          subscript  J  n      subscript  k    n  r     subscript  ρ  0        subscript  k    n  r     superscript   delimited-[]     subscript  J    n  1       subscript  k    n  r    a     2        A_{nr}=\frac{4(2-\delta_{n0})}{a^{2}}\,\,\frac{\sinh k_{nr}(L+z_{0})}{\sinh 2k%
 _{nr}L}\,\,\frac{J_{n}(k_{nr}\rho_{0})}{k_{nr}[J_{n+1}(k_{nr}a)]^{2}}.\,     It is clear that when    ρ  =  a      ρ  a    \rho=a   or     |  z  |   =  L        z   L    |z|=L   , the above function is zero. It can also be easily shown that the two functions match in value and in the value of their first derivatives at    z  =   z  0       z   subscript  z  0     z=z_{0}   .  Point source inside cylinder  Removing the plane ends (i.e. taking the limit as L approaches infinity) gives the field of the point source inside a conducting cylinder:       V   (  ρ  ,  φ  ,  z  )    =    ∑   n  =  0   ∞      ∑   r  =  0   ∞      A   n  r     J  n    (    k   n  r    ρ   )    cos   (   n   (   φ  -   φ  0    )    )     e   -    k   n  r     |   z  -   z  0    |               V   ρ  φ  z      superscript   subscript     n  0        superscript   subscript     r  0         subscript  A    n  r     subscript  J  n      subscript  k    n  r    ρ       n    φ   subscript  φ  0       superscript  e       subscript  k    n  r        z   subscript  z  0             V(\rho,\varphi,z)=\sum_{n=0}^{\infty}\sum_{r=0}^{\infty}\,A_{nr}J_{n}(k_{nr}%
 \rho)\cos(n(\varphi-\varphi_{0}))e^{-k_{nr}|z-z_{0}|}           A   n  r    =      2   (   2  -   δ   n  0     )     a  2        J  n    (    k   n  r     ρ  0    )      k   n  r      [    J   n  +  1     (    k   n  r    a   )    ]   2       .       subscript  A    n  r          2    2   subscript  δ    n  0       superscript  a  2         subscript  J  n      subscript  k    n  r     subscript  ρ  0        subscript  k    n  r     superscript   delimited-[]     subscript  J    n  1       subscript  k    n  r    a     2        A_{nr}=\frac{2(2-\delta_{n0})}{a^{2}}\,\,\frac{J_{n}(k_{nr}\rho_{0})}{k_{nr}[J%
 _{n+1}(k_{nr}a)]^{2}}.\,     Point source in open space  As the radius of the cylinder ( a ) approaches infinity, the sum over the zeroes of J_n(z) becomes an integral, and we have the field of a point source in infinite space:       V   (  ρ  ,  φ  ,  z  )    =   1  R   =    ∑   n  =  0   ∞     ∫  0  ∞    d   k    A  n    (  k  )    J  n    (   k  ρ   )    cos   (   n   (   φ  -   φ  0    )    )     e   -   k   |   z  -   z  0    |                 V   ρ  φ  z      1  R          superscript   subscript     n  0        superscript   subscript   0       d  k   subscript  A  n   k   subscript  J  n     k  ρ       n    φ   subscript  φ  0       superscript  e      k      z   subscript  z  0              V(\rho,\varphi,z)=\frac{1}{R}=\sum_{n=0}^{\infty}\int_{0}^{\infty}dk\,A_{n}(k)%
 J_{n}(k\rho)\cos(n(\varphi-\varphi_{0}))e^{-k|z-z_{0}|}           A  n    (  k  )    =    (   2  -   δ   n  0     )    J  n    (   k   ρ  0    )           subscript  A  n   k       2   subscript  δ    n  0      subscript  J  n     k   subscript  ρ  0       A_{n}(k)=(2-\delta_{n0})J_{n}(k\rho_{0})\,     and R is the distance from the point source to the measurement point:       R  =       (   z  -   z  0    )   2   +   ρ  2   +   ρ  0  2    -   2  ρ   ρ  0    cos   (   φ  -   φ  0    )        .      R         superscript    z   subscript  z  0    2    superscript  ρ  2    superscript   subscript  ρ  0   2      2  ρ   subscript  ρ  0       φ   subscript  φ  0          R=\sqrt{(z-z_{0})^{2}+\rho^{2}+\rho_{0}^{2}-2\rho\rho_{0}\cos(\varphi-\varphi_%
 {0})}.\,     Point source in open space at origin  Finally, when the point source is at the origin,     ρ  0   =   z  0   =  0         subscript  ρ  0    subscript  z  0        0     \rho_{0}=z_{0}=0           V   (  ρ  ,  φ  ,  z  )    =   1     ρ  2   +   z  2      =    ∫  0  ∞     J  0    (   k  ρ   )     e   -   k   |  z  |       d  k     .          V   ρ  φ  z      1       superscript  ρ  2    superscript  z  2             superscript   subscript   0        subscript  J  0     k  ρ    superscript  e      k    z      d  k       V(\rho,\varphi,z)=\frac{1}{\sqrt{\rho^{2}+z^{2}}}=\int_{0}^{\infty}J_{0}(k\rho%
 )e^{-k|z|}\,dk.     See also   Spherical harmonics   Notes  References      "  Category:Differential equations     Configuration and variables as in ↩     
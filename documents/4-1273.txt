   Integer square root      Integer square root   In number theory , the integer square root (isqrt) of a positive integer  n is the positive integer m which is the greatest integer less than or equal to the square root of n ,        isqrt   (  n  )    =   ⌊   n   ⌋    .        isqrt  n       n      \mbox{isqrt}(n)=\lfloor\sqrt{n}\rfloor.     For example,     isqrt   (  27  )    =  5        isqrt  27   5    \mbox{isqrt}(27)=5   because     5  ⋅  5   =  25  ≤  27         normal-⋅  5  5   25       27     5\cdot 5=25\leq 27   and     6  ⋅  6   =  36  >  27         normal-⋅  6  6   36       27     6\cdot 6=36>27   .  Algorithm  One way of calculating    n      n    \sqrt{n}   and    isqrt   (  n  )       isqrt  n    \mbox{isqrt}(n)   is to use Newton's method to find a solution for the equation      x  2   -  n   =  0         superscript  x  2   n   0    x^{2}-n=0   , giving the iterative formula        x   k  +  1    =    1  2    (    x  k   +   n   x  k     )     ,    k  ≥  0   ,    x  0   >  0.       formulae-sequence     subscript  x    k  1        1  2      subscript  x  k     n   subscript  x  k        formulae-sequence    k  0      subscript  x  0   0.      {x}_{k+1}=\frac{1}{2}\left(x_{k}+\frac{n}{x_{k}}\right),\quad k\geq 0,\quad x_%
 {0}>0.     The sequence     {   x  k   }      subscript  x  k     \{x_{k}\}    converges  quadratically to    n      n    \sqrt{n}   as    k  →  ∞     normal-→  k     k\to\infty   . It can be proven that if     x  0   =  n       subscript  x  0   n    x_{0}=n   is chosen as the initial guess, one can stop as soon as       |    x   k  +  1    -   x  k    |   <  1           subscript  x    k  1     subscript  x  k     1    |x_{k+1}-x_{k}|<1   to ensure that      ⌊   x   k  +  1    ⌋   =   ⌊   n   ⌋    .         subscript  x    k  1         n      \lfloor x_{k+1}\rfloor=\lfloor\sqrt{n}\rfloor.     Using only integer division  For computing    ⌊   n   ⌋        n     \lfloor\sqrt{n}\rfloor   for very large integers n , one can use the quotient of Euclidean division for both of the division operations. This has the advantage of only using integers for each intermediate value, thus making the use of floating point representations of large numbers unnecessary. It is equivalent to using the iterative formula         x   k  +  1    =   ⌊    1  2    (    x  k   +   ⌊   n   x  k    ⌋    )    ⌋    ,    k  ≥  0   ,     x  0   >  0   ,    x  0   ∈  ℤ      .     formulae-sequence     subscript  x    k  1          1  2      subscript  x  k       n   subscript  x  k          formulae-sequence    k  0    formulae-sequence     subscript  x  0   0      subscript  x  0   ℤ       {x}_{k+1}=\left\lfloor\frac{1}{2}\left(x_{k}+\left\lfloor\frac{n}{x_{k}}\right%
 \rfloor\right)\right\rfloor,\quad k\geq 0,\quad x_{0}>0,\quad x_{0}\in\mathbb{%
 Z}.     By using the fact that        ⌊    1  2    (    x  k   +   ⌊   n   x  k    ⌋    )    ⌋   =   ⌊    1  2    (    x  k   +   n   x  k     )    ⌋    ,            1  2      subscript  x  k       n   subscript  x  k              1  2      subscript  x  k     n   subscript  x  k         \left\lfloor\frac{1}{2}\left(x_{k}+\left\lfloor\frac{n}{x_{k}}\right\rfloor%
 \right)\right\rfloor=\left\lfloor\frac{1}{2}\left(x_{k}+\frac{n}{x_{k}}\right)%
 \right\rfloor,     one can show that this will reach    ⌊   n   ⌋        n     \lfloor\sqrt{n}\rfloor   within a finite number of iterations.  However,    ⌊   n   ⌋        n     \lfloor\sqrt{n}\rfloor   is not necessarily a fixed point of the above iterative formula. Indeed, it can be shown that    ⌊   n   ⌋        n     \lfloor\sqrt{n}\rfloor   is a fixed point if and only if    n  +  1      n  1    n+1   is not a perfect square. If    n  +  1      n  1    n+1   is a perfect square, the sequence ends up in a period-two cycle between    ⌊   n   ⌋        n     \lfloor\sqrt{n}\rfloor   and     ⌊   n   ⌋   +  1          n    1    \lfloor\sqrt{n}\rfloor+1   instead of converging.  Domain of computation  Although    n      n    \sqrt{n}   is irrational for many   n   n   n   , the sequence    {   x  k   }      subscript  x  k     \{x_{k}\}   contains only rational terms when    x  0     subscript  x  0    x_{0}   is rational. Thus, with this method it is unnecessary to exit the field of rational numbers in order to calculate    isqrt   (  n  )       isqrt  n    \mbox{isqrt}(n)   , a fact which has some theoretical advantages.  Stopping criterion  One can prove that    c  =  1      c  1    c=1   is the largest possible number for which the stopping criterion       |    x   k  +  1    -   x  k    |   <  c           subscript  x    k  1     subscript  x  k     c    |x_{k+1}-x_{k}|   ensures     ⌊   x   k  +  1    ⌋   =   ⌊   n   ⌋          subscript  x    k  1         n      \lfloor x_{k+1}\rfloor=\lfloor\sqrt{n}\rfloor   in the algorithm above.  In implementations which use number formats that cannot represent all rational numbers exactly (for example, floating point), a stopping constant less than one should be used to protect against roundoff errors.  See also   Methods of computing square roots   External links   A geometric view of the square root algorithm   "  Category:Number theoretic algorithms  Category:Number theory  Category:Root-finding algorithms   
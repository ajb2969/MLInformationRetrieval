   Sobol sequence      Sobol sequence   Sobol sequences (also called LP œÑ sequences or ( t , s ) sequences in base¬†2) are an example of quasi-random low-discrepancy sequences . They were first introduced by the Russian mathematician I. M. Sobol (–ò–ª—å—è –ú–µ–µ—Ä–æ–≤–∏—á –°–æ–±–æ–ª—å) in 1967. Sobol,I.M.  (1967), "Distribution of points in a cube and approximate evaluation of integrals". Zh. Vych. Mat. Mat. Fiz.  7 : 784‚Äì802 (in Russian); U.S.S.R Comput. Maths. Math. Phys.  7 : 86‚Äì112 (in English).  These sequences use a base of two to form successively finer uniform partitions of the unit interval, and then reorder the coordinates in each dimension.  Good distributions in the s-dimensional unit hypercube  Let I s = [0,1] s be the s-dimensional unit hypercube and f a real integrable function over I s . The original motivation of Sobol was to construct a sequence x n in I s so that         lim   n  ‚Üí  ‚àû       1  n     ‚àë   i  =  1   n    f   (   x  i   )       =    ‚à´   I  s    f         subscript    normal-‚Üí  n         1  n     superscript   subscript     i  1    n     f   subscript  x  i         subscript    superscript  I  s    f     \lim_{n\to\infty}\;\frac{1}{n}\sum_{i=1}^{n}f(x_{i})\;=\;\int_{I^{s}}f   and the convergence be as fast as possible.  It is more or less clear that for the sum to converge towards the integral, the points x n should fill I s minimizing the holes. Another good property would be that the projections of x n on a lower-dimensional face of I s leave very few holes as well. Hence the homogeneous filling of I s does not qualify ; because in lower-dimensions many points will be at the same place, therefore useless for the integral estimation.  These good distributions are called (t,m,s)-nets and (t,s)-sequences in base b. To introduce them, define first an elementary s-interval in base b a subset of I s of the form       ‚àè   j  =  1   s    [    a  j    b   d  j     ,     a  j   +  1    b   d  j     ]       superscript   subscript  product    j  1    s       subscript  a  j    superscript  b   subscript  d  j          subscript  a  j   1    superscript  b   subscript  d  j        \prod_{j=1}^{s}\left[\frac{a_{j}}{b^{d_{j}}},\frac{a_{j}+1}{b^{d_{j}}}\right]   , where a j , d j are non-negative integers and     a  j   <   b   d  j         subscript  a  j    superscript  b   subscript  d  j      a_{j}   for all j in {1, ...,s}  Given 2 integers    0  ‚â§  t  ‚â§  m        0  t       m     0\leq t\leq m   , a (t,m,s)-net in base b is a sequence x n of b m points of I s such that       Card   P   ‚à©   {   x  1   ,  ‚Ä¶  ,   x   b  m    }    =   b  t           Card  P     subscript  x  1   normal-‚Ä¶   subscript  x   superscript  b  m       superscript  b  t     \text{Card}\,P\cap\{x_{1},...,x_{b^{m}}\}=b^{t}   for all elementary interval P in base b of hypervolume Œª(P) = b t-m .  Given a non-negative integer t, a (t,s)-sequence in base b is an infinite sequence of points x n such that for all integers     k  ‚â•  0   ,   m  ‚â•  t      formulae-sequence    k  0     m  t     k\geq 0,\;m\geq t   , the sequence    {   x   k   b  m     ,  ‚Ä¶  ,   x     (   k  +  1   )    b  m    -  1    }      subscript  x    k   superscript  b  m     normal-‚Ä¶   subscript  x        k  1    superscript  b  m    1      \{x_{kb^{m}},...,x_{(k+1)b^{m}-1}\}   is a (t,m,s)-net in base b.  In his article, Sobol described Œ† œÑ -meshes and LP œÑ sequences , which are (t,m,s)-nets and (t,s)-sequences in base 2 respectively. The terms (t,m,s)-nets and (t,s)-sequences in base b (also called Niederreiter sequences) were coined in 1988 by Harald Niederreiter . 1 The term Sobol sequences was introduced in late English-speaking papers in comparison with Halton , Faure and other low-discrepancy sequences.  A fast algorithm for the construction of Sobol sequences  A more efficient Gray code implementation was proposed by Antonov and Saleev. 2  As for the generation of Sobol numbers, they are clearly aided by the use of Gray code     G   (  n  )    =   n  ‚äï   ‚åä   n  /  2   ‚åã          G  n    direct-sum  n      n  2       G(n)=n\oplus\lfloor n/2\rfloor   instead of n for constructing the n -th point draw.  Suppose we have already generated all the Sobol sequence draws up to n ‚àí¬†1, and kept in memory the values x n ‚àí1, j for all the required dimensions. Since the Gray code G ( n ) differs from that of the preceding one G ( n ‚àí¬†1) by just a single, say the k -th, bit (which is a rightmost bit of n ‚àí¬†1), all that needs to be done is a single XOR operation for each dimension in order to propagate all of the x n ‚àí1 to x n , i.e.        x   n  ,  i    =    x    n  -  1   ,  i    ‚äï   v   k  ,  i      .       subscript  x   n  i     direct-sum   subscript  x     n  1   i     subscript  v   k  i       x_{n,i}=x_{n-1,i}\oplus v_{k,i}.\,     Additional uniformity properties  Sobol introduced additional uniformity conditions known as property A and A‚Äô. 3  Definition . A low-discrepancy sequence is said to satisfy Property A if for any binary segment (not an arbitrary subset) of the d-dimensional sequence of length 2 d there is exactly one draw in each 2 d hypercubes that result from subdividing the unit hypercube along each of its length extensions into half.  Definition . A low-discrepancy sequence is said to satisfy Property A‚Äô if for any binary segment (not an arbitrary subset) of the d-dimensional sequence of length 4 d there is exactly one draw in each 4 d hypercubes that result from subdividing the unit hypercube along each of its length extensions into four equal parts.  There are mathematical conditions that guarantee properties A and A'.  Theorem . The d-dimensional Sobol sequence possesses Property A iff        det   (   ùïç  d   )    ‚â°   1  mod  2    ,         subscript  ùïç  d     modulo  1  2     \det(\mathbb{V}_{d})\equiv 1(\mod 2),     where V d is the d √ó d binary matrix defined by       ùïç  d   :=   (      v   1  ,  1  ,  1       v   2  ,  1  ,  1      ‚Ä¶     v   d  ,  1  ,  1         v   1  ,  2  ,  1       v   2  ,  2  ,  1      ‚Ä¶     v   d  ,  2  ,  1        ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ       v   1  ,  d  ,  1       v   2  ,  d  ,  1      ‚Ä¶     v   d  ,  d  ,  1       )      assign   subscript  ùïç  d      subscript  v   1  1  1     subscript  v   2  1  1    normal-‚Ä¶   subscript  v   d  1  1       subscript  v   1  2  1     subscript  v   2  2  1    normal-‚Ä¶   subscript  v   d  2  1      normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ     subscript  v   1  d  1     subscript  v   2  d  1    normal-‚Ä¶   subscript  v   d  d  1        \mathbb{V}_{d}:=\begin{pmatrix}{v_{1,1,1}}&{v_{2,1,1}}&{\dots}&{v_{d,1,1}}\\
 {v_{1,2,1}}&{v_{2,2,1}}&{\dots}&{v_{d,2,1}}\\
 {\vdots}&{\vdots}&{\ddots}&{\vdots}\\
 {v_{1,d,1}}&{v_{2,d,1}}&{\dots}&{v_{d,d,1}}\end{pmatrix}   ,  with v k,j,m denoting the m-th digit after the binary point of the direction number v k,j = (0. v k,j,1 v k,j,2 . . .) 2 .  Theorem . The d -dimensional Sobol sequence possesses Property A' iff        det   (   ùïå  d   )    ‚â°   1  mod  2    ,         subscript  ùïå  d     modulo  1  2     \det(\mathbb{U}_{d})\equiv 1\mod 2,     where U d is the 2 d √ó¬†2 d binary matrix defined by       ùïå  d   :=   (      v   1  ,  1  ,  1       v   1  ,  1  ,  2       v   2  ,  1  ,  1       v   2  ,  1  ,  2      ‚Ä¶     v   d  ,  1  ,  1       v   d  ,  1  ,  2         v   1  ,  2  ,  1       v   1  ,  2  ,  2       v   2  ,  2  ,  1       v   2  ,  2  ,  2      ‚Ä¶     v   d  ,  2  ,  1       v   d  ,  2  ,  2        ‚ãÆ    ‚ãÆ    ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ    ‚ãÆ       v   1  ,   2  d   ,  1       v   1  ,   2  d   ,  2       v   2  ,   2  d   ,  1       v   2  ,   2  d   ,  2      ‚Ä¶     v   d  ,   2  d   ,  1       v   d  ,   2  d   ,  2       )      assign   subscript  ùïå  d      subscript  v   1  1  1     subscript  v   1  1  2     subscript  v   2  1  1     subscript  v   2  1  2    normal-‚Ä¶   subscript  v   d  1  1     subscript  v   d  1  2       subscript  v   1  2  1     subscript  v   1  2  2     subscript  v   2  2  1     subscript  v   2  2  2    normal-‚Ä¶   subscript  v   d  2  1     subscript  v   d  2  2      normal-‚ãÆ  normal-‚ãÆ  normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ  normal-‚ãÆ     subscript  v   1    2  d   1     subscript  v   1    2  d   2     subscript  v   2    2  d   1     subscript  v   2    2  d   2    normal-‚Ä¶   subscript  v   d    2  d   1     subscript  v   d    2  d   2        \mathbb{U}_{d}:=\begin{pmatrix}{v_{1,1,1}}&{v_{1,1,2}}&{v_{2,1,1}}&{v_{2,1,2}}%
 &{\dots}&{v_{d,1,1}}&{v_{d,1,2}}\\
 {v_{1,2,1}}&{v_{1,2,2}}&{v_{2,2,1}}&{v_{2,2,2}}&{\dots}&{v_{d,2,1}}&{v_{d,2,2}%
 }\\
 {\vdots}&{\vdots}&{\vdots}&{\vdots}&{\ddots}&{\vdots}&{\vdots}\\
 {v_{1,2d,1}}&{v_{1,2d,2}}&{v_{2,2d,1}}&{v_{2,2d,2}}&{\dots}&{v_{d,2d,1}}&{v_{d%
 ,2d,2}}\end{pmatrix}   ,  with v k,j,m denoting the m-th digit after the binary point of the direction number v k,j = (0. v k,j,1 v k,j,2 . . .) 2 .  Tests for properties A and A‚Äô are independent. Thus it is possible to construct the Sobol sequence which satisfies both properties A and A‚Äô or only one of them.  The initialization of Sobol numbers  To construct a Sobol sequence a set of direction numbers v i,j needs to be selected. There is some freedom in the selection of initial direction numbers. 4 Therefore, it is possible to receive different realisations of the Sobol sequence for selected dimensions. A bad selection of initial numbers can considerably reduce the efficiency of Sobol sequences when used for computation.  Arguably the easiest choice for the initialisation numbers is just to have the l -th leftmost bit set, and all other bits to be zero, i.e. m k,j = 1 for all k and j . This initialisation is usually called unit initialisation . However, such a sequence fails the test for Property A and A‚Äô even for low dimensions and hence this initialisation is bad.  Implementation and availability of Sobol sequences  Good initialisation numbers for different numbers of dimensions are provided by several authors. For example, Sobol provides initialisation numbers for dimensions up to 51. 5 The same set of initialisation numbers is used by Bratley and Fox. 6  Initialisation numbers for high dimensions are available on Joe and Kuo. 7  Peter J√§ckel provides initialisation numbers up to dimension 32 in his book " Monte Carlo methods in finance ". 8  Other implementations are available as C, Fortran 77, or Fortran 90 routines in the Numerical Recipes collection of software. 9  Finally, commercial Sobol sequence generators are available within, for example, the NAG Library , 10 or from the British-Russian Offshore Development Agency (BRODA). 11 12  See also   Low-discrepancy sequences   Notes    References    External links   Collected Algorithms of the ACM  (See algorithms 647, 659, and 738.)  Collection of Sobol sequences generator programming codes  Freeware C++ generator of Sobol sequence   "  Category:Quasirandomness  Category:Sequences and series     Niederreiter, H. (1988). "Low-Discrepancy and Low-Dispersion Sequences", Journal of Number Theory  30 : 51‚Äì70. ‚Ü©  Antonov, I.A. and Saleev, V.M. (1979) "An economic method of computing LP œÑ -sequences". Zh. Vych. Mat. Mat. Fiz.  19 : 243‚Äì245 (in Russian); U.S.S.R Comput. Maths. Math. Phys.  19 : 252‚Äì256 (in English). ‚Ü©  Sobol, I.M. (1976) "Uniformly distributed sequences with an additional uniform property". Zh. Vych. Mat. Mat. Fiz.  16 : 1332‚Äì1337 (in Russian); U.S.S.R Comput. Maths. Math. Phys.  16 : 236‚Äì242 (in English). ‚Ü©  These numbers are usually called initialisation numbers ‚Ü©  Sobol, I.M. and Levitan, Y.L. (1976). "The production of points uniformly distributed in a multidimensional cube" Tech. Rep. 40, Institute of Applied Mathematics, USSR Academy of Sciences (in Russian). ‚Ü©  Bratley, P. and Fox, B. L. (1988), "Algorithm 659: Implementing Sobol‚Äôs quasirandom sequence generator". ACM Trans. Math. Software  14 : 88‚Äì100. ‚Ü©  ‚Ü©  J√§ckel, P. (2002) "Monte Carlo methods in finance". New York: John Wiley and Sons . (ISBN 0-471-49741-X.) ‚Ü©  Press, W.H., Teukolsky, S. A., Vetterling, W. T., and Flannery, B. P. (1992) "Numerical Recipes in Fortran 77: The Art of Scientific Computing, 2nd ed." Cambridge University Press, Cambridge, U.K. ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©     
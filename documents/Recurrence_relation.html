<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="366">Recurrence relation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Recurrence relation</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, a <strong>recurrence relation</strong> is an <a class="uri" href="equation" title="wikilink">equation</a> that <a href="recursion" title="wikilink">recursively</a> defines a <a class="uri" href="sequence" title="wikilink">sequence</a> or multidimensional array of values, once one or more initial terms are given: each further term of the sequence or array is defined as a <a href="Function_(mathematics)" title="wikilink">function</a> of the preceding terms.</p>

<p>The term <strong><a href="#Relationship_to_difference_equations_narrowly_defined" title="wikilink">difference equation</a></strong> sometimes (and for the purposes of this article) refers to a specific type of recurrence relation. However, "difference equation" is frequently used to refer to <em>any</em> recurrence relation.</p>
<h2 id="examples">Examples</h2>
<h3 id="logistic-map">Logistic map</h3>

<p>An example of a recurrence relation is the <a href="logistic_map" title="wikilink">logistic map</a>:</p>

<p>

<math display="block" id="Recurrence_relation:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>r</mi>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n+1}=rx_{n}(1-x_{n}),
  </annotation>
 </semantics>
</math>

</p>

<p>with a given constant <em>r</em>; given the initial term <em>x</em><sub>0</sub> each subsequent term is determined by this relation.</p>

<p>Some simply defined recurrence relations can have very complex (<a href="chaos_theory" title="wikilink">chaotic</a>) behaviours, and they are a part of the field of mathematics known as <a href="Nonlinearity" title="wikilink">nonlinear analysis</a>.</p>

<p>Solving a recurrence relation means obtaining a <a href="closed-form_solution" title="wikilink">closed-form solution</a>: a non-recursive function of <em>n</em>.</p>
<h3 id="fibonacci-numbers">Fibonacci numbers</h3>

<p>The <a href="Fibonacci_number" title="wikilink">Fibonacci numbers</a> are the archetype of a linear, homogeneous recurrence relation with constant coefficients (see below). They are defined using the linear recurrence relation</p>

<p>

<math display="block" id="Recurrence_relation:1">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>F</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{n}=F_{n-1}+F_{n-2}
  </annotation>
 </semantics>
</math>

</p>

<p>with <a href="initial_condition" title="wikilink">seed values</a>:</p>

<p>

<math display="block" id="Recurrence_relation:2">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{0}=0
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:3">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{1}=1
  </annotation>
 </semantics>
</math>

</p>

<p>Explicitly, recurrence yields the equations:</p>

<p>

<math display="block" id="Recurrence_relation:4">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>F</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{2}=F_{1}+F_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:5">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mn>2</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>F</mi>
     <mn>1</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{3}=F_{2}+F_{1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:6">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mn>4</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mn>3</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>F</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <cn type="integer">4</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{4}=F_{3}+F_{2}
  </annotation>
 </semantics>
</math>

 etc.</p>

<p>We obtain the sequence of Fibonacci numbers, which begins:</p>
<dl>
<dd>0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
</dd>
</dl>

<p>It can be solved by methods described below yielding the <a href="Binet_formula" title="wikilink">closed-form expression</a>, which involves powers of the two roots of the characteristic polynomial <em>t</em><sup>2</sup> = <em>t</em> + 1; the <a href="generating_function" title="wikilink">generating function</a> of the sequence is the <a href="rational_function" title="wikilink">rational function</a></p>

<p>

<math display="block" id="Recurrence_relation:7">
 <semantics>
  <mrow>
   <mfrac>
    <mi>t</mi>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>t</mi>
     <mo>-</mo>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>t</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{t}{1-t-t^{2}}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="binomial-coefficients">Binomial coefficients</h3>

<p>A simple example of a multidimensional recurrence relation is given by the <a href="binomial_coefficient" title="wikilink">binomial coefficients</a> 

<math display="inline" id="Recurrence_relation:8">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{k}}\right)}
  </annotation>
 </semantics>
</math>

, which count the number of ways of selecting <em>k</em> out of a set of <em>n</em> elements. They can be computed by the recurrence relation</p>

<p>

<math display="block" id="Recurrence_relation:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{n}\atop{k}}\right)}={\left({{n-1}\atop{k-1}}\right)}+{\left({{n-1}%
\atop{k}}\right)},
  </annotation>
 </semantics>
</math>

 with the base cases 

<math display="inline" id="Recurrence_relation:10">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mn>0</mn>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mstyle scriptlevel="+1">
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
     </mtable>
    </mstyle>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>n</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>n</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{n}\atop{0}}\right)}={\textstyle\left({{n}\atop{n}}\right)}=1
  </annotation>
 </semantics>
</math>

. Using this formula to compute the values of all binomial coefficients generates an infinite array called <a href="Pascal's_triangle" title="wikilink">Pascal's triangle</a>. The same values can also be computed directly by a different formula that is not a recurrence, but that requires multiplication and not just addition to compute: 

<math display="inline" id="Recurrence_relation:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mrow>
       <mi>k</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>k</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{n}\atop{k}}\right)}=\frac{n!}{k!(n-k)!}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="structure">Structure</h2>
<h3 id="linear-homogeneous-recurrence-relations-with-constant-coefficients">Linear homogeneous recurrence relations with constant coefficients</h3>

<p>An order <em>d</em> <strong>linear homogeneous recurrence relation with constant coefficients</strong> is an equation of the form</p>

<p>

<math display="block" id="Recurrence_relation:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>d</mi>
      </msub>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>d</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\cdots+c_{d}a_{n-d},
  </annotation>
 </semantics>
</math>

</p>

<p>where the <em>d</em> coefficients <em>c<sub>i</sub></em> (for all <em>i</em>) are constants.</p>

<p>More precisely, this is an infinite list of simultaneous linear equations, one for each <em>n</em>&gt;<em>d</em>−1. A sequence that satisfies a relation of this form is called a <strong>linear recurrence sequence</strong> or LRS. There are <em>d</em> <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a> for LRS, i.e., the initial values 

<math display="inline" id="Recurrence_relation:13">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>d</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <ci>d</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},\dots,a_{d-1}
  </annotation>
 </semantics>
</math>

 can be taken to be any values but then the linear recurrence determines the sequence uniquely.</p>

<p>The same coefficients yield the <a href="characteristic_polynomial" title="wikilink">characteristic polynomial</a> (also "auxiliary polynomial")</p>

<p>

<math display="block" id="Recurrence_relation:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>t</mi>
     <mi>d</mi>
    </msup>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>t</mi>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>t</mi>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>-</mo>
    <msub>
     <mi>c</mi>
     <mi>d</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(t)=t^{d}-c_{1}t^{d-1}-c_{2}t^{d-2}-\cdots-c_{d}
  </annotation>
 </semantics>
</math>

 whose <em>d</em> roots play a crucial role in finding and understanding the sequences satisfying the recurrence. If the roots <em>r</em><sub>1</sub>, <em>r</em><sub>2</sub>, ... are all distinct, then the solution to the recurrence takes the form</p>

<p>

<math display="block" id="Recurrence_relation:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>1</mn>
      </msub>
      <msubsup>
       <mi>r</mi>
       <mn>1</mn>
       <mi>n</mi>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>2</mn>
      </msub>
      <msubsup>
       <mi>r</mi>
       <mn>2</mn>
       <mi>n</mi>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mi>d</mi>
      </msub>
      <msubsup>
       <mi>r</mi>
       <mi>d</mi>
       <mi>n</mi>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>d</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=k_{1}r_{1}^{n}+k_{2}r_{2}^{n}+\cdots+k_{d}r_{d}^{n},
  </annotation>
 </semantics>
</math>

 where the coefficients <em>k<sub>i</sub></em> are determined in order to fit the initial conditions of the recurrence. When the same roots occur multiple times, the terms in this formula corresponding to the second and later occurrences of the same root are multiplied by increasing powers of <em>n</em>. For instance, if the characteristic polynomial can be factored as (<em>x</em>−<em>r</em>)<sup>3</sup>, with the same root <em>r</em> occurring three times, then the solution would take the form</p>

<p>

<math display="block" id="Recurrence_relation:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>1</mn>
      </msub>
      <msup>
       <mi>r</mi>
       <mi>n</mi>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>2</mn>
      </msub>
      <mi>n</mi>
      <msup>
       <mi>r</mi>
       <mi>n</mi>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>3</mn>
      </msub>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>r</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=k_{1}r^{n}+k_{2}nr^{n}+k_{3}n^{2}r^{n}.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>As well as the <a href="Fibonacci_number" title="wikilink">Fibonacci numbers</a>, other sequences generated by linear homogeneous recurrences include the <a href="Lucas_number" title="wikilink">Lucas numbers</a> and <a href="Lucas_sequence" title="wikilink">Lucas sequences</a>, the <a href="Jacobsthal_number" title="wikilink">Jacobsthal numbers</a>, the <a href="Pell_number" title="wikilink">Pell numbers</a> and more generally the solutions to <a href="Pell's_equation" title="wikilink">Pell's equation</a>.</p>
<h3 id="rational-generating-function">Rational generating function</h3>

<p>Linear recursive sequences are precisely the sequences whose <a href="generating_function" title="wikilink">generating function</a> is a <a href="rational_function" title="wikilink">rational function</a>: the denominator is the polynomial obtained from the auxiliary polynomial by reversing the order of the coefficients, and the numerator is determined by the initial values of the sequence.</p>

<p>The simplest cases are periodic sequences, 

<math display="inline" id="Recurrence_relation:17">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>d</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>n</mi>
    <mo>≥</mo>
    <mi>d</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <ci>n</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=a_{n-d},n\geq d
  </annotation>
 </semantics>
</math>

, which have sequence 

<math display="inline" id="Recurrence_relation:18">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>d</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <ci>d</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},a_{1},\dots,a_{d-1},a_{0},\dots
  </annotation>
 </semantics>
</math>

 and generating function a sum of geometric series:</p>

<p>

<math display="inline" id="Recurrence_relation:19">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>1</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mrow>
         <mi>d</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <msup>
        <mi>x</mi>
        <mrow>
         <mi>d</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mrow>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>x</mi>
       <mi>d</mi>
      </msup>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <apply>
         <minus></minus>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{a_{0}+a_{1}x^{1}+\cdots+a_{d-1}x^{d-1}}{1-x^{d}}=
  </annotation>
 </semantics>
</math>


</p>

<p>More generally, given the recurrence relation:</p>

<p>

<math display="block" id="Recurrence_relation:20">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>d</mi>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>d</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\cdots+c_{d}a_{n-d}
  </annotation>
 </semantics>
</math>

 with generating function</p>

<p>

<math display="block" id="Recurrence_relation:21">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>1</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}+a_{1}x^{1}+a_{2}x^{2}+\cdots,
  </annotation>
 </semantics>
</math>

</p>

<p>the series is annihilated at <em>a<sub>d</sub></em> and above by the polynomial:</p>

<p>

<math display="block" id="Recurrence_relation:22">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>1</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>d</mi>
     </msub>
     <msup>
      <mi>x</mi>
      <mi>d</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-c_{1}x^{1}-c_{2}x^{2}-\cdots-c_{d}x^{d}.
  </annotation>
 </semantics>
</math>

</p>

<p>That is, multiplying the generating function by the polynomial yields</p>

<p>

<math display="block" id="Recurrence_relation:23">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>d</mi>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>d</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{n}=a_{n}-c_{1}a_{n-1}-c_{2}a_{n-2}-\cdots-c_{d}a_{n-d}
  </annotation>
 </semantics>
</math>

</p>

<p>as the coefficient on 

<math display="inline" id="Recurrence_relation:24">
 <semantics>
  <msup>
   <mi>x</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>x</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{n}
  </annotation>
 </semantics>
</math>

, which vanishes (by the recurrence relation) for <em>n</em> ≥ <em>d</em>. Thus</p>

<p>

<math display="block" id="Recurrence_relation:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>1</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>2</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>1</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mn>2</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mi>d</mi>
       </msub>
       <msup>
        <mi>x</mi>
        <mi>d</mi>
       </msup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>b</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
      <msup>
       <mi>x</mi>
       <mn>1</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mrow>
        <mi>d</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <msup>
       <mi>x</mi>
       <mrow>
        <mi>d</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(a_{0}+a_{1}x^{1}+a_{2}x^{2}+\cdots\right)\left(1-c_{1}x^{1}-c_{2}x^{2}-%
\cdots-c_{d}x^{d}\right)=\left(b_{0}+b_{1}x^{1}+b_{2}x^{2}+\cdots+b_{d-1}x^{d-%
1}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>so dividing yields</p>

<p>

<math display="block" id="Recurrence_relation:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>1</mn>
      </msub>
      <msup>
       <mi>x</mi>
       <mn>1</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>b</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>1</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mn>2</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mrow>
         <mi>d</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <msup>
        <mi>x</mi>
        <mrow>
         <mi>d</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mrow>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>1</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mn>2</mn>
       </msub>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mi>d</mi>
       </msub>
       <msup>
        <mi>x</mi>
        <mi>d</mi>
       </msup>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <apply>
         <minus></minus>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>d</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}+a_{1}x^{1}+a_{2}x^{2}+\cdots=\frac{b_{0}+b_{1}x^{1}+b_{2}x^{2}+\cdots+b_%
{d-1}x^{d-1}}{1-c_{1}x^{1}-c_{2}x^{2}-\cdots-c_{d}x^{d}},
  </annotation>
 </semantics>
</math>

</p>

<p>expressing the generating function as a rational function.</p>

<p>The denominator is 

<math display="inline" id="Recurrence_relation:27">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mi>d</mi>
    </msup>
    <mi>p</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>x</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>d</ci>
    </apply>
    <ci>p</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{d}p\left(x^{-1}\right),
  </annotation>
 </semantics>
</math>

 a transform of the auxiliary polynomial (equivalently, reversing the order of coefficients); one could also use any multiple of this, but this normalization is chosen both because of the simple relation to the auxiliary polynomial, and so that 

<math display="inline" id="Recurrence_relation:28">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{0}=a_{0}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="relationship-to-difference-equations-narrowly-defined">Relationship to difference equations narrowly defined</h3>

<p>Given an ordered <a class="uri" href="sequence" title="wikilink">sequence</a> 

<math display="inline" id="Recurrence_relation:29">
 <semantics>
  <msubsup>
   <mrow>
    <mo>{</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>}</mo>
   </mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mi mathvariant="normal">∞</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </set>
     <apply>
      <eq></eq>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{a_{n}\right\}_{n=1}^{\infty}
  </annotation>
 </semantics>
</math>

 of <a href="real_numbers" title="wikilink">real numbers</a>: the <strong>first difference</strong> 

<math display="inline" id="Recurrence_relation:30">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta(a_{n})
  </annotation>
 </semantics>
</math>

 is defined as</p>

<p>

<math display="block" id="Recurrence_relation:31">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta(a_{n})=a_{n+1}-a_{n}\,
  </annotation>
 </semantics>
</math>

.</p>

<p>The <strong>second difference</strong> 

<math display="inline" id="Recurrence_relation:32">
 <semantics>
  <mrow>
   <msup>
    <mi mathvariant="normal">Δ</mi>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Δ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{2}(a_{n})
  </annotation>
 </semantics>
</math>

 is defined as</p>

<p>

<math display="block" id="Recurrence_relation:33">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi mathvariant="normal">Δ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Δ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{2}(a_{n})=\Delta(a_{n+1})-\Delta(a_{n})
  </annotation>
 </semantics>
</math>

,</p>

<p>which can be simplified to</p>

<p>

<math display="block" id="Recurrence_relation:34">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi mathvariant="normal">Δ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Δ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{2}(a_{n})=a_{n+2}-2a_{n+1}+a_{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>More generally: the <strong><em>k</em><sup>th</sup> difference</strong> of the sequence <em>a<sub>n</sub></em> is written as 

<math display="inline" id="Recurrence_relation:35">
 <semantics>
  <mrow>
   <msup>
    <mi mathvariant="normal">Δ</mi>
    <mi>k</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Δ</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{k}(a_{n})
  </annotation>
 </semantics>
</math>

 is defined recursively as</p>

<p>

<math display="block" id="Recurrence_relation:36">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi mathvariant="normal">Δ</mi>
     <mi>k</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi mathvariant="normal">Δ</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi mathvariant="normal">Δ</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>t</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>k</mi>
    </munderover>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>t</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>t</mi>
     </msup>
     <msub>
      <mi>a</mi>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>k</mi>
       </mrow>
       <mo>-</mo>
       <mi>t</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Δ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Δ</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Δ</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <ci>k</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <ci>k</ci>
         </apply>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta^{k}(a_{n})=\Delta^{k-1}(a_{n+1})-\Delta^{k-1}(a_{n})=\sum_{t=0}^{k}{%
\left({{k}\atop{t}}\right)}(-1)^{t}a_{n+k-t}
  </annotation>
 </semantics>
</math>

.</p>

<p>(The sequence and its differences are related by a <a href="binomial_transform" title="wikilink">binomial transform</a>.) The more restrictive definition of <strong>difference equation</strong> is an equation composed of <em>a<sub>n</sub></em> and its <em>k</em><sup>th</sup> differences. (A widely used broader definition treats "difference equation" as synonymous with "recurrence relation". See for example <a href="rational_difference_equation" title="wikilink">rational difference equation</a> and <a href="matrix_difference_equation" title="wikilink">matrix difference equation</a>.)</p>

<p>Actually, it is easily seen that 

<math display="inline" id="Recurrence_relation:37">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>n</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mn>0</mn>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>n</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mn>1</mn>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <mi mathvariant="normal">Δ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>a</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>n</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>k</mi>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <msup>
       <mi mathvariant="normal">Δ</mi>
       <mi>k</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>a</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Δ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+k}={n\choose 0}a_{n}+{n\choose 1}\Delta(a_{n})+\cdots+{n\choose k}\Delta^%
{k}(a_{n}).
  </annotation>
 </semantics>
</math>

 Thus, a difference equation can be defined as an equation that involves <em>a<sub>n</sub></em>, <em>a<sub>n-1</sub></em>, <em>a<sub>n-2</sub></em> etc. (or equivalenty <em>a<sub>n</sub></em>, <em>a<sub>n+1</sub></em>, <em>a<sub>n+2</sub></em> etc.)</p>

<p>Since difference equations are a very common form of recurrence, some authors use the two terms interchangeably. For example, the difference equation</p>

<p>

<math display="block" id="Recurrence_relation:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>3</mn>
     <msup>
      <mi mathvariant="normal">Δ</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi mathvariant="normal">Δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>7</mn>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Δ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3\Delta^{2}(a_{n})+2\Delta(a_{n})+7a_{n}=0
  </annotation>
 </semantics>
</math>

</p>

<p>is equivalent to the recurrence relation</p>

<p>

<math display="block" id="Recurrence_relation:39">
 <semantics>
  <mrow>
   <mrow>
    <mn>3</mn>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>2</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>4</mn>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>8</mn>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3a_{n+2}=4a_{n+1}-8a_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>Thus one can solve many recurrence relations by rephrasing them as difference equations, and then solving the difference equation, analogously to how one solves <a href="ordinary_differential_equations" title="wikilink">ordinary differential equations</a>. However, the <a href="Ackermann_number" title="wikilink">Ackermann numbers</a> are an example of a recurrence relation that do not map to a difference equation, much less points on the solution to a differential equation.</p>

<p>See <a href="time_scale_calculus" title="wikilink">time scale calculus</a> for a unification of the theory of difference equations with that of <a href="differential_equations" title="wikilink">differential equations</a>.</p>

<p><a href="Summation_equation" title="wikilink">Summation equations</a> relate to difference equations as <a href="integral_equation" title="wikilink">integral equations</a> relate to differential equations.</p>
<h4 id="from-sequences-to-grids">From sequences to grids</h4>

<p>Single-variable or one-dimensional recurrence relations are about sequences (i.e. functions defined on one-dimensional grids). Multi-variable or n-dimensional recurrence relations are about n-dimensional grids. Functions defined on n-grids can also be studied with <strong>partial difference equations</strong>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="solving">Solving</h2>
<h3 id="general-methods">General methods</h3>

<p>For order 1, the recurrence</p>

<p>

<math display="block" id="Recurrence_relation:40">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=ra_{n-1}
  </annotation>
 </semantics>
</math>

 has the solution <em>a<sub>n</sub></em> = <em>r<sup>n</sup></em> with <em>a</em><sub>0</sub> = 1 and the most general solution is <em>a<sub>n</sub></em> = <em>kr<sup>n</sup></em> with <em>a</em><sub>0</sub> = <em>k</em>. The characteristic polynomial equated to zero (the <a href="Characteristic_polynomial" title="wikilink">characteristic equation</a>) is simply <em>t</em> − <em>r</em> = 0.</p>

<p>Solutions to such recurrence relations of higher order are found by systematic means, often using the fact that <em>a<sub>n</sub></em> = <em>r<sup>n</sup></em> is a solution for the recurrence exactly when <em>t</em> = <em>r</em> is a root of the characteristic polynomial. This can be approached directly or using <a href="generating_function" title="wikilink">generating functions</a> (<a href="formal_power_series" title="wikilink">formal power series</a>) or matrices.</p>

<p>Consider, for example, a recurrence relation of the form</p>

<p>

<math display="block" id="Recurrence_relation:41">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>A</mi>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>B</mi>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=Aa_{n-1}+Ba_{n-2}.
  </annotation>
 </semantics>
</math>

</p>

<p>When does it have a solution of the same general form as <em>a<sub>n</sub></em> = <em>r<sup>n</sup></em>? Substituting this guess (<a class="uri" href="ansatz" title="wikilink">ansatz</a>) in the recurrence relation, we find that</p>

<p>

<math display="block" id="Recurrence_relation:42">
 <semantics>
  <mrow>
   <msup>
    <mi>r</mi>
    <mi>n</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msup>
      <mi>r</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <msup>
      <mi>r</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{n}=Ar^{n-1}+Br^{n-2}
  </annotation>
 </semantics>
</math>

</p>

<p>must be true for <strong>all</strong> <em>n</em> &gt; 1.</p>

<p>Dividing through by <em>r</em><sup><em>n</em>−2</sup>, we get that all these equations reduce to the same thing:</p>

<p>

<math display="block" id="Recurrence_relation:43">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>r</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>A</mi>
      <mi>r</mi>
     </mrow>
     <mo>+</mo>
     <mi>B</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>r</ci>
     </apply>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{2}=Ar+B,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mi>A</mi>
      <mi>r</mi>
     </mrow>
     <mo>-</mo>
     <mi>B</mi>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>r</ci>
     </apply>
     <ci>B</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{2}-Ar-B=0,
  </annotation>
 </semantics>
</math>

</p>

<p>which is the characteristic equation of the recurrence relation. Solve for <em>r</em> to obtain the two roots <em>λ</em><sub>1</sub>, <em>λ</em><sub>2</sub>: these roots are known as the <a href="characteristic_root" title="wikilink">characteristic roots</a> or <strong>eigenvalues</strong> of the characteristic equation. Different solutions are obtained depending on the nature of the roots: If these roots are distinct, we have the general solution</p>

<p>

<math display="block" id="Recurrence_relation:45">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>C</mi>
     <msubsup>
      <mi>λ</mi>
      <mn>1</mn>
      <mi>n</mi>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>D</mi>
     <msubsup>
      <mi>λ</mi>
      <mn>2</mn>
      <mi>n</mi>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=C\lambda_{1}^{n}+D\lambda_{2}^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>while if they are identical (when <em>A</em><sup>2</sup> + 4<em>B</em> = 0), we have</p>

<p>

<math display="block" id="Recurrence_relation:46">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>C</mi>
     <msup>
      <mi>λ</mi>
      <mi>n</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>D</mi>
     <mi>n</mi>
     <msup>
      <mi>λ</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=C\lambda^{n}+Dn\lambda^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>This is the most general solution; the two constants <em>C</em> and <em>D</em> can be chosen based on two given initial conditions <em>a</em><sub>0</sub> and <em>a</em><sub>1</sub> to produce a specific solution.</p>

<p>In the case of complex eigenvalues (which also gives rise to complex values for the solution parameters <em>C</em> and <em>D</em>), the use of complex numbers can be eliminated by rewriting the solution in trigonometric form. In this case we can write the eigenvalues as 

<math display="inline" id="Recurrence_relation:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>λ</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mo>±</mo>
     <mrow>
      <mi>β</mi>
      <mi>i</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">2</cn>
     </apply>
    </list>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <ci>α</ci>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1},\lambda_{2}=\alpha\pm\beta i.
  </annotation>
 </semantics>
</math>

 Then it can be shown that</p>

<p>

<math display="block" id="Recurrence_relation:48">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>C</mi>
     <msubsup>
      <mi>λ</mi>
      <mn>1</mn>
      <mi>n</mi>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>D</mi>
     <msubsup>
      <mi>λ</mi>
      <mn>2</mn>
      <mi>n</mi>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=C\lambda_{1}^{n}+D\lambda_{2}^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>can be rewritten as<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Recurrence_relation:49">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>M</mi>
      <mi>n</mi>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>θ</mi>
           <mi>n</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>F</mi>
        <mrow>
         <mi>sin</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>θ</mi>
           <mi>n</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mi>G</mi>
     <msup>
      <mi>M</mi>
      <mi>n</mi>
     </msup>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>θ</mi>
         <mi>n</mi>
        </mrow>
        <mo>-</mo>
        <mi>δ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>M</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>E</ci>
        <apply>
         <cos></cos>
         <apply>
          <times></times>
          <ci>θ</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>F</ci>
        <apply>
         <sin></sin>
         <apply>
          <times></times>
          <ci>θ</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>M</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>θ</ci>
         <ci>n</ci>
        </apply>
        <ci>δ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=2M^{n}\left(E\cos(\theta n)+F\sin(\theta n)\right)=2GM^{n}\cos(\theta n-%
\delta),
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Recurrence_relation:50">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>M</mi>
      <mo>=</mo>
      <msqrt>
       <mrow>
        <msup>
         <mi>α</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>β</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </msqrt>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mstyle displaystyle="false">
       <mfrac>
        <mi>α</mi>
        <mi>M</mi>
       </mfrac>
      </mstyle>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mstyle displaystyle="false">
       <mfrac>
        <mi>β</mi>
        <mi>M</mi>
       </mfrac>
      </mstyle>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>C</mi>
       <mo>,</mo>
       <mi>D</mi>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mi>E</mi>
       <mo>∓</mo>
       <mrow>
        <mi>F</mi>
        <mi>i</mi>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
    <mtd></mtd>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>G</mi>
      <mo>=</mo>
      <msqrt>
       <mrow>
        <msup>
         <mi>E</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>F</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </msqrt>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>δ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mstyle displaystyle="false">
       <mfrac>
        <mi>E</mi>
        <mi>G</mi>
       </mfrac>
      </mstyle>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>δ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mstyle displaystyle="false">
       <mfrac>
        <mi>F</mi>
        <mi>G</mi>
       </mfrac>
      </mstyle>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <ci>M</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>β</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>α</ci>
       <ci>M</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>β</ci>
       <ci>M</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <list>
       <ci>C</ci>
       <ci>D</ci>
      </list>
      <apply>
       <csymbol cd="latexml">minus-or-plus</csymbol>
       <ci>E</ci>
       <apply>
        <times></times>
        <ci>F</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <ci>G</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>E</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>F</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <cos></cos>
       <ci>δ</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>E</ci>
       <ci>G</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <sin></sin>
       <ci>δ</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>F</ci>
       <ci>G</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}M=\sqrt{\alpha^{2}+\beta^{2}}&\cos(\theta)=\tfrac{\alpha}{%
M}&\sin(\theta)=\tfrac{\beta}{M}\\
C,D=E\mp Fi&&\\
G=\sqrt{E^{2}+F^{2}}&\cos(\delta)=\tfrac{E}{G}&\sin(\delta)=\tfrac{F}{G}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Here <em>E</em> and <em>F</em> (or equivalently, <em>G</em> and δ) are real constants which depend on the initial conditions. Using</p>

<p>

<math display="block" id="Recurrence_relation:51">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mn>1</mn>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>λ</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mi>α</mi>
    </mrow>
    <mo>=</mo>
    <mi>A</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1}+\lambda_{2}=2\alpha=A,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:52">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mn>1</mn>
     </msub>
     <mo>⋅</mo>
     <msub>
      <mi>λ</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>α</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>β</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mi>B</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1}\cdot\lambda_{2}=\alpha^{2}+\beta^{2}=-B,
  </annotation>
 </semantics>
</math>

</p>

<p>one may simplify the solution given above as</p>

<p>

<math display="block" id="Recurrence_relation:53">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>B</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <mi>n</mi>
       <mn>2</mn>
      </mfrac>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>θ</mi>
           <mi>n</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>F</mi>
        <mrow>
         <mi>sin</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>θ</mi>
           <mi>n</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>B</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>θ</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>F</ci>
       <apply>
        <sin></sin>
        <apply>
         <times></times>
         <ci>θ</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=(-B)^{\frac{n}{2}}\left(E\cos(\theta n)+F\sin(\theta n)\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>a</em><sub>1</sub> and <em>a</em><sub>2</sub> are the initial conditions and</p>

<p>

<math display="inline" id="Recurrence_relation:54">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle E
  </annotation>
 </semantics>
</math>


</p>

<p>In this way there is no need to solve for λ<sub>1</sub> and λ<sub>2</sub>.</p>

<p>In all cases—real distinct eigenvalues, real duplicated eigenvalues, and complex conjugate eigenvalues—the equation is <a href="stability_theory" title="wikilink">stable</a> (that is, the variable <em>a</em> converges to a fixed value (specifically, zero)); if and only if <em>both</em> eigenvalues are smaller than one in <a href="absolute_value" title="wikilink">absolute value</a>. In this second-order case, this condition on the eigenvalues can be shown<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> to be equivalent to |<em>A</em>| b_{n}=Ab_{n-1}+Bb_{n-2}+K</p>

<p>with constant term <em>K</em>, this can be converted into homogeneous form as follows: The <a href="steady_state" title="wikilink">steady state</a> is found by setting <em>b<sub>n</sub></em> = <em>b</em><sub><em>n</em>−1</sub> = <em>b</em><sub><em>n</em>−2</sub> = <em>b</em>* to obtain</p>

<p>

<math display="block" id="Recurrence_relation:55">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>b</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mfrac>
     <mi>K</mi>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>A</mi>
      <mo>-</mo>
      <mi>B</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <times></times>
    </apply>
    <apply>
     <divide></divide>
     <ci>K</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{*}=\frac{K}{1-A-B}.
  </annotation>
 </semantics>
</math>

</p>

<p>Then the non-homogeneous recurrence can be rewritten in homogeneous form as</p>

<p>

<math display="block" id="Recurrence_relation:56">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>b</mi>
       <mi>n</mi>
      </msub>
      <mo>-</mo>
      <msup>
       <mi>b</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>A</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <msub>
         <mi>b</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <msup>
         <mi>b</mi>
         <mo>*</mo>
        </msup>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>B</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <msub>
         <mi>b</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <msup>
         <mi>b</mi>
         <mo>*</mo>
        </msup>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <times></times>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <times></times>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [b_{n}-b^{*}]=A[b_{n-1}-b^{*}]+B[b_{n-2}-b^{*}],
  </annotation>
 </semantics>
</math>

</p>

<p>which can be solved as above.</p>

<p>The stability condition stated above in terms of eigenvalues for the second-order case remains valid for the general <em>n</em><sup>th</sup>-order case: the equation is stable if and only if all eigenvalues of the characteristic equation are less than one in absolute value.</p>
<h3 id="solving-via-linear-algebra">Solving via linear algebra</h3>

<p>A linearly recursive sequence y of order n</p>

<p>

<math display="block" id="Recurrence_relation:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <msub>
        <mi>y</mi>
        <mrow>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo>+</mo>
         <mi>k</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>c</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msub>
       <msub>
        <mi>y</mi>
        <mrow>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
         <mo>+</mo>
         <mi>k</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+k}-c_{n-1}y_{n-1+k}-c_{n-2}y_{n-2+k}+\cdots-c_{0}y_{k}=0
  </annotation>
 </semantics>
</math>

</p>

<p>is identical to</p>

<p>

<math display="block" id="Recurrence_relation:58">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n}=c_{n-1}y_{n-1}+c_{n-2}y_{n-2}+\cdots+c_{0}y_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Expanded with n-1 identities of kind 

<math display="inline" id="Recurrence_relation:59">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n-k}=y_{n-k},
  </annotation>
 </semantics>
</math>

 this n-th order equation is translated into a system of n first order linear equations,</p>

<p>

<math display="block" id="Recurrence_relation:60">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mi>n</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi></mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋱</mi>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+5pt">
      <mi>C</mi>
     </mpadded>
     <msub>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>C</mi>
      <mi>n</mi>
     </msup>
     <msub>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>y</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-⋯</ci>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">0</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <ci>normal-⋯</ci>
        <ci>normal-⋯</ci>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <ci>normal-⋱</ci>
        <ci>normal-⋱</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
        <ci>normal-⋱</ci>
        <ci>normal-⋱</ci>
        <ci>normal-⋱</ci>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <ci>normal-⋯</ci>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>C</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{n}=\begin{bmatrix}y_{n}\\
y_{n-1}\\
\vdots\\
\vdots\\
y_{1}\end{bmatrix}=\par
\begin{bmatrix}c_{n-1}&c_{n-2}&\cdots&\cdots&c_{0}\\
1&0&\cdots&\cdots&0\\
0&\ddots&\ddots&&\vdots\\
\vdots&\ddots&\ddots&\ddots&\vdots\\
0&\cdots&0&1&0\end{bmatrix}\par
\begin{bmatrix}y_{n-1}\\
y_{n-2}\\
\vdots\\
\vdots\\
y_{0}\end{bmatrix}=C\ \vec{y}_{n-1}=C^{n}\vec{y}_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Observe that the vector 

<math display="inline" id="Recurrence_relation:61">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>y</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{n}
  </annotation>
 </semantics>
</math>

 can be computed by <em>n</em> applications of the <a href="companion_matrix" title="wikilink">companion matrix</a>, C, to the initial state vector, 

<math display="inline" id="Recurrence_relation:62">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}
  </annotation>
 </semantics>
</math>

. Thereby, n-th entry of the sought sequence y, is the top component of 

<math display="inline" id="Recurrence_relation:63">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>n</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>n</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>y</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
    </list>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>y</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{n},y_{n}=\vec{y}_{n}[n]
  </annotation>
 </semantics>
</math>

.</p>

<p><a href="Eigendecomposition_of_a_matrix#Example" title="wikilink">Eigendecomposition</a>, 

<math display="inline" id="Recurrence_relation:64">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msup>
      <mover accent="true">
       <mi>C</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msup>
    </mpadded>
    <msub>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>λ</mi>
       <mn>1</mn>
       <mi>n</mi>
      </msubsup>
     </mpadded>
     <msub>
      <mover accent="true">
       <mi>e</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mn>2</mn>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>λ</mi>
       <mn>2</mn>
       <mi>n</mi>
      </msubsup>
     </mpadded>
     <msub>
      <mover accent="true">
       <mi>e</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>λ</mi>
       <mi>n</mi>
       <mi>n</mi>
      </msubsup>
     </mpadded>
     <msub>
      <mover accent="true">
       <mi>e</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>y</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>C</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>e</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>e</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>n</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>e</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{n}=\vec{C}^{n}\,\vec{y}_{0}=c_{1}\,\lambda_{1}^{n}\,\vec{e}_{1}+c_{2}%
\,\lambda_{2}^{n}\,\vec{e}_{2}+\cdots+c_{n}\,\lambda_{n}^{n}\,\vec{e}_{n}
  </annotation>
 </semantics>
</math>

 into eigenvalues, 

<math display="inline" id="Recurrence_relation:65">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1},\lambda_{2},\ldots,\lambda_{n}
  </annotation>
 </semantics>
</math>

, and eigenvectors, 

<math display="inline" id="Recurrence_relation:66">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>e</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mover accent="true">
     <mi>e</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mover accent="true">
     <mi>e</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>e</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>e</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>e</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{e}_{1},\vec{e}_{2},\ldots,\vec{e}_{n}
  </annotation>
 </semantics>
</math>

, is used to compute 

<math display="inline" id="Recurrence_relation:67">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>y</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{n}.
  </annotation>
 </semantics>
</math>

 Thanks to the crucial fact that system <em>C</em> time-shifts every eigenvector, <em>e</em>, by simply scaling its components <em>λ</em> times,</p>

<p>

<math display="block" id="Recurrence_relation:68">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>C</mi>
    </mpadded>
    <msub>
     <mover accent="true">
      <mi>e</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>λ</mi>
     <mi>i</mi>
    </msub>
    <msub>
     <mover accent="true">
      <mi>e</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mi>n</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>λ</mi>
          <mi>i</mi>
         </msub>
        </mpadded>
        <msub>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mi>n</mi>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>λ</mi>
          <mi>i</mi>
         </msub>
        </mpadded>
        <msub>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>λ</mi>
          <mi>i</mi>
         </msub>
        </mpadded>
        <msub>
         <mi>e</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>e</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>e</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>C</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>i</ci>
          <ci>n</ci>
         </list>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>i</ci>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </list>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </list>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>i</ci>
          <ci>n</ci>
         </list>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>i</ci>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </list>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <list>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </list>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C\,\vec{e}_{i}=\lambda_{i}\vec{e}_{i}=C\begin{bmatrix}e_{i,n}\\
e_{i,n-1}\\
\vdots\\
e_{i,1}\end{bmatrix}=\begin{bmatrix}\lambda_{i}\,e_{i,n}\\
\lambda_{i}\,e_{i,n-1}\\
\vdots\\
\lambda_{i}\,e_{i,1}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>that is, time-shifted version of eigenvector,<em>e</em>, has components <em>λ</em> times larger, the eigenvector components are powers of <em>λ</em>, 

<math display="inline" id="Recurrence_relation:69">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>e</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>[</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <msubsup>
          <mi>λ</mi>
          <mi>i</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msubsup>
          <mi>λ</mi>
          <mi>i</mi>
          <mn>2</mn>
         </msubsup>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>λ</mi>
          <mi>i</mi>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mi>T</mi>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>e</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{e}_{i}=\begin{bmatrix}\lambda_{i}^{n-1}&\cdots&\lambda_{i}^{2}&\lambda_{i%
}&1\end{bmatrix}^{T},
  </annotation>
 </semantics>
</math>

 and, thus, recurrent linear homogeneous equation solution is a combination of exponential functions, 

<math display="inline" id="Recurrence_relation:70">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mn>1</mn>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>λ</mi>
       <mi>i</mi>
       <mi>n</mi>
      </msubsup>
     </mpadded>
     <msub>
      <mover accent="true">
       <mi>e</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>y</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <ci>i</ci>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>e</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{n}=\sum_{1}^{n}{c_{i}\,\lambda_{i}^{n}\,\vec{e}_{i}}
  </annotation>
 </semantics>
</math>

. The components 

<math display="inline" id="Recurrence_relation:71">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i}
  </annotation>
 </semantics>
</math>

 can be determined out of initial conditions:</p>

<p>

<math display="block" id="Recurrence_relation:72">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>y</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>y</mi>
        <mrow>
         <mrow>
          <mo>-</mo>
          <mi>n</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>λ</mi>
       <mi>i</mi>
       <mn>0</mn>
      </msubsup>
     </mpadded>
     <msub>
      <mover accent="true">
       <mi>e</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mover accent="true">
           <mi>e</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mn>1</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mover accent="true">
           <mi>e</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mn>2</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mover accent="true">
           <mi>e</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mi>n</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mpadded>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mi>n</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>E</mi>
    </mpadded>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mi>n</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>y</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>n</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>e</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>e</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>e</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>e</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋯</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>n</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>E</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋯</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>n</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}_{0}=\begin{bmatrix}y_{0}\\
y_{-1}\\
\vdots\\
y_{-n+1}\end{bmatrix}=\sum_{i=1}^{n}{c_{i}\,\lambda_{i}^{0}\,\vec{e}_{i}}=%
\begin{bmatrix}\vec{e}_{1}&\vec{e}_{2}&\cdots&\vec{e}_{n}\end{bmatrix}\,\begin%
{bmatrix}c_{1}\\
c_{2}\\
\cdots\\
c_{n}\end{bmatrix}=E\,\begin{bmatrix}c_{1}\\
c_{2}\\
\cdots\\
c_{n}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Solving for coefficients,</p>

<p>

<math display="block" id="Recurrence_relation:73">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>c</mi>
         <mi>n</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>E</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msub>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <msubsup>
            <mi>λ</mi>
            <mn>1</mn>
            <mrow>
             <mi>n</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mtd>
          <mtd columnalign="center">
           <msubsup>
            <mi>λ</mi>
            <mn>2</mn>
            <mrow>
             <mi>n</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋯</mi>
          </mtd>
          <mtd columnalign="center">
           <msubsup>
            <mi>λ</mi>
            <mi>n</mi>
            <mrow>
             <mi>n</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋮</mi>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋮</mi>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋱</mi>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋮</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <msub>
            <mi>λ</mi>
            <mn>1</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>λ</mi>
            <mn>2</mn>
           </msub>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋯</mi>
          </mtd>
          <mtd columnalign="center">
           <msub>
            <mi>λ</mi>
            <mi>n</mi>
           </msub>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋯</mi>
          </mtd>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mpadded>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mrow>
           <mrow>
            <mo>-</mo>
            <mi>n</mi>
           </mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋯</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>E</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <matrix>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-⋯</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <ci>normal-⋮</ci>
         <ci>normal-⋮</ci>
         <ci>normal-⋱</ci>
         <ci>normal-⋮</ci>
        </matrixrow>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-⋯</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <ci>n</ci>
         </apply>
        </matrixrow>
        <matrixrow>
         <cn type="integer">1</cn>
         <cn type="integer">1</cn>
         <ci>normal-⋯</ci>
         <cn type="integer">1</cn>
        </matrixrow>
       </matrix>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}c_{1}\\
c_{2}\\
\cdots\\
c_{n}\end{bmatrix}=E^{-1}\vec{y}_{0}=\begin{bmatrix}\lambda_{1}^{n-1}&\lambda_%
{2}^{n-1}&\cdots&\lambda_{n}^{n-1}\\
\vdots&\vdots&\ddots&\vdots\\
\lambda_{1}&\lambda_{2}&\cdots&\lambda_{n}\\
1&1&\cdots&1\end{bmatrix}^{-1}\,\begin{bmatrix}y_{0}\\
y_{-1}\\
\vdots\\
y_{-n+1}\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>This also works with arbitrary boundary conditions 

<math display="inline" id="Recurrence_relation:74">
 <semantics>
  <munder>
   <munder accentunder="true">
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>a</mi>
     </msub>
     <mo movablelimits="false">,</mo>
     <msub>
      <mi>y</mi>
      <mi>b</mi>
     </msub>
     <mo movablelimits="false">,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
    <mo movablelimits="false">⏟</mo>
   </munder>
   <mtext>n</mtext>
  </munder>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-⏟</ci>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>b</ci>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <mtext>n</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \underbrace{y_{a},y_{b},\ldots}_{\text{n}}
  </annotation>
 </semantics>
</math>

, not necessary the initial ones,</p>

<p>

<math display="block" id="Recurrence_relation:75">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>y</mi>
        <mi>a</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>y</mi>
        <mi>b</mi>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>a</mi>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <msub>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>b</mi>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mstyle displaystyle="false">
         <msubsup>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </msubsup>
        </mstyle>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>i</mi>
          </msub>
         </mpadded>
         <mpadded width="+1.7pt">
          <msubsup>
           <mi>λ</mi>
           <mi>i</mi>
           <mi>a</mi>
          </msubsup>
         </mpadded>
         <msub>
          <mover accent="true">
           <mi>e</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>n</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mstyle displaystyle="false">
         <msubsup>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </msubsup>
        </mstyle>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>i</mi>
          </msub>
         </mpadded>
         <mpadded width="+1.7pt">
          <msubsup>
           <mi>λ</mi>
           <mi>i</mi>
           <mi>b</mi>
          </msubsup>
         </mpadded>
         <msub>
          <mover accent="true">
           <mi>e</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>n</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mstyle displaystyle="false">
         <msubsup>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </msubsup>
        </mstyle>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>i</mi>
          </msub>
         </mpadded>
         <mpadded width="+1.7pt">
          <msubsup>
           <mi>λ</mi>
           <mi>i</mi>
           <mi>a</mi>
          </msubsup>
         </mpadded>
         <msubsup>
          <mi>λ</mi>
          <mi>i</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mstyle displaystyle="false">
         <msubsup>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </msubsup>
        </mstyle>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>i</mi>
          </msub>
         </mpadded>
         <mpadded width="+1.7pt">
          <msubsup>
           <mi>λ</mi>
           <mi>i</mi>
           <mi>b</mi>
          </msubsup>
         </mpadded>
         <msubsup>
          <mi>λ</mi>
          <mi>i</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋮</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>a</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>b</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>y</ci>
         </apply>
         <ci>a</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>n</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>y</ci>
         </apply>
         <ci>b</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>n</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <ci>a</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>e</ci>
          </apply>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <ci>b</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>e</ci>
          </apply>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <ci>a</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <ci>b</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <csymbol cd="latexml">absent</csymbol>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}y_{a}\\
y_{b}\\
\vdots\end{bmatrix}=\begin{bmatrix}\vec{y}_{a}[n]\\
\vec{y}_{b}[n]\\
\vdots\end{bmatrix}=\begin{bmatrix}\sum_{i=1}^{n}{c_{i}\,\lambda_{i}^{a}\,\vec%
{e}_{i}[n]}\\
\sum_{i=1}^{n}{c_{i}\,\lambda_{i}^{b}\,\vec{e}_{i}[n]}\\
\vdots\end{bmatrix}=\begin{bmatrix}\sum_{i=1}^{n}{c_{i}\,\lambda_{i}^{a}\,%
\lambda_{i}^{n-1}}\\
\sum_{i=1}^{n}{c_{i}\,\lambda_{i}^{b}\,\lambda_{i}^{n-1}}\\
\vdots\end{bmatrix}=
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:76">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mstyle displaystyle="false">
         <mrow>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <msub>
             <mi>c</mi>
             <mi>i</mi>
            </msub>
           </mpadded>
           <msubsup>
            <mi>λ</mi>
            <mi>i</mi>
            <mrow>
             <mrow>
              <mi>a</mi>
              <mo>+</mo>
              <mi>n</mi>
             </mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mrow>
        </mstyle>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mstyle displaystyle="false">
         <mrow>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <msub>
             <mi>c</mi>
             <mi>i</mi>
            </msub>
           </mpadded>
           <msubsup>
            <mi>λ</mi>
            <mi>i</mi>
            <mrow>
             <mrow>
              <mi>b</mi>
              <mo>+</mo>
              <mi>n</mi>
             </mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mrow>
        </mstyle>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msubsup>
           <mi>λ</mi>
           <mn>1</mn>
           <mrow>
            <mrow>
             <mi>a</mi>
             <mo>+</mo>
             <mi>n</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msubsup>
         </mtd>
         <mtd columnalign="center">
          <msubsup>
           <mi>λ</mi>
           <mn>2</mn>
           <mrow>
            <mrow>
             <mi>a</mi>
             <mo>+</mo>
             <mi>n</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msubsup>
         </mtd>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋯</mi>
         </mtd>
         <mtd columnalign="center">
          <msubsup>
           <mi>λ</mi>
           <mi>n</mi>
           <mrow>
            <mrow>
             <mi>a</mi>
             <mo>+</mo>
             <mi>n</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msubsup>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msubsup>
           <mi>λ</mi>
           <mn>1</mn>
           <mrow>
            <mrow>
             <mi>b</mi>
             <mo>+</mo>
             <mi>n</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msubsup>
         </mtd>
         <mtd columnalign="center">
          <msubsup>
           <mi>λ</mi>
           <mn>2</mn>
           <mrow>
            <mrow>
             <mi>b</mi>
             <mo>+</mo>
             <mi>n</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msubsup>
         </mtd>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋯</mi>
         </mtd>
         <mtd columnalign="center">
          <msubsup>
           <mi>λ</mi>
           <mi>n</mi>
           <mrow>
            <mrow>
             <mi>b</mi>
             <mo>+</mo>
             <mi>n</mi>
            </mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msubsup>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋮</mi>
         </mtd>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋮</mi>
         </mtd>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋱</mi>
         </mtd>
         <mtd columnalign="center">
          <mi mathvariant="normal">⋮</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mpadded>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mn>1</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mn>2</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>c</mi>
          <mi>n</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <sum></sum>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <plus></plus>
            <ci>a</ci>
            <ci>n</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <sum></sum>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>λ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <plus></plus>
            <ci>b</ci>
            <ci>n</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <ci>a</ci>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <ci>a</ci>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <ci>a</ci>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <ci>b</ci>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <ci>b</ci>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>λ</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <ci>b</ci>
           <ci>n</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
        <ci>normal-⋮</ci>
        <ci>normal-⋱</ci>
        <ci>normal-⋮</ci>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>n</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\begin{bmatrix}\sum{c_{i}\,\lambda_{i}^{a+n-1}}\\
\sum{c_{i}\,\lambda_{i}^{b+n-1}}\\
\vdots\end{bmatrix}=\begin{bmatrix}\lambda_{1}^{a+n-1}&\lambda_{2}^{a+n-1}&%
\cdots&\lambda_{n}^{a+n-1}\\
\lambda_{1}^{b+n-1}&\lambda_{2}^{b+n-1}&\cdots&\lambda_{n}^{b+n-1}\\
\vdots&\vdots&\ddots&\vdots\end{bmatrix}\,\begin{bmatrix}c_{1}\\
c_{2}\\
\vdots\\
c_{n}\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>This description is really no different from general method above, however it is more succinct. It also works nicely for situations like</p>

<p>

<math display="block" id="Recurrence_relation:77">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <msub>
        <mi>a</mi>
        <mi>n</mi>
       </msub>
       <mo>=</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>b</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <msub>
         <mi>b</mi>
         <mi>n</mi>
        </msub>
        <mo>=</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <msub>
           <mi>a</mi>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
         </mrow>
         <mo>+</mo>
         <msub>
          <mi>b</mi>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mo>.</mo>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
   </mtable>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">cases</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{cases}a_{n}=a_{n-1}-b_{n-1}\\
b_{n}=2a_{n-1}+b_{n-1}.\end{cases}
  </annotation>
 </semantics>
</math>

 where there are several linked recurrences.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h3 id="solving-with-z-transforms">Solving with z-transforms</h3>

<p>Certain difference equations - in particular, <a href="Z-transform#Linear_constant-coefficient_difference_equation" title="wikilink">linear constant coefficient</a> difference equations - can be solved using <a href="z-transform" title="wikilink">z-transforms</a>. The <em>z</em>-transforms are a class of <a href="integral_transform" title="wikilink">integral transforms</a> that lead to more convenient algebraic manipulations and more straightforward solutions. There are cases in which obtaining a direct solution would be all but impossible, yet solving the problem via a thoughtfully chosen integral transform is straightforward.</p>
<h3 id="theorem">Theorem</h3>

<p>Given a linear homogeneous recurrence relation with constant coefficients of order <em>d</em>, let <em>p</em>(<em>t</em>) be the <a href="characteristic_polynomial" title="wikilink">characteristic polynomial</a> (also "auxiliary polynomial")</p>

<p>

<math display="block" id="Recurrence_relation:78">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>t</mi>
     <mi>d</mi>
    </msup>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>t</mi>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>t</mi>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>-</mo>
    <msub>
     <mi>c</mi>
     <mi>d</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t^{d}-c_{1}t^{d-1}-c_{2}t^{d-2}-\cdots-c_{d}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>such that each <em>c<sub>i</sub></em> corresponds to each <em>c<sub>i</sub></em> in the original recurrence relation (see the general form above). Suppose λ is a root of <em>p</em>(<em>t</em>) having multiplicity <em>r</em>. This is to say that (<em>t</em>−λ)<sup><em>r</em></sup> divides <em>p</em>(<em>t</em>). The following two properties hold:</p>
<ol>
<li>Each of the <em>r</em> sequences 

<math display="inline" id="Recurrence_relation:79">
 <semantics>
  <mrow>
   <msup>
    <mi>λ</mi>
    <mi>n</mi>
   </msup>
   <mo>,</mo>
   <mrow>
    <mi>n</mi>
    <msup>
     <mi>λ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <msup>
     <mi>λ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>n</mi>
     <mrow>
      <mi>r</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>λ</mi>
     <mi>n</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>λ</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <apply>
       <minus></minus>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda^{n},n\lambda^{n},n^{2}\lambda^{n},\dots,n^{r-1}\lambda^{n}
  </annotation>
 </semantics>
</math>


 satisfies the recurrence relation.</li>
<li>Any sequence satisfying the recurrence relation can be written uniquely as a linear combination of solutions constructed in part 1 as <em>λ</em> varies over all distinct roots of <em>p</em>(<em>t</em>).</li>
</ol>

<p>As a result of this theorem a linear homogeneous recurrence relation with constant coefficients can be solved in the following manner:</p>
<ol>
<li>Find the characteristic polynomial <em>p</em>(<em>t</em>).</li>
<li>Find the roots of <em>p</em>(<em>t</em>) counting multiplicity.</li>
<li>Write <em>a<sub>n</sub></em> as a linear combination of all the roots (counting multiplicity as shown in the theorem above) with unknown coefficients <em>b<sub>i</sub></em>.</li>
</ol>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Recurrence_relation:80">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>b</mi>
        <mn>1</mn>
       </msub>
       <msubsup>
        <mi>λ</mi>
        <mn>1</mn>
        <mi>n</mi>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mn>2</mn>
       </msub>
       <mi>n</mi>
       <msubsup>
        <mi>λ</mi>
        <mn>1</mn>
        <mi>n</mi>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mn>3</mn>
       </msub>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
       <msubsup>
        <mi>λ</mi>
        <mn>1</mn>
        <mi>n</mi>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>r</mi>
       </msub>
       <msup>
        <mi>n</mi>
        <mrow>
         <mi>r</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msubsup>
        <mi>λ</mi>
        <mn>1</mn>
        <mi>n</mi>
       </msubsup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>b</mi>
        <mrow>
         <mrow>
          <mi>d</mi>
          <mo>-</mo>
          <mi>q</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <msubsup>
        <mi>λ</mi>
        <mo>*</mo>
        <mi>n</mi>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>b</mi>
        <mi>d</mi>
       </msub>
       <msup>
        <mi>n</mi>
        <mrow>
         <mi>q</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msubsup>
        <mi>λ</mi>
        <mo>*</mo>
        <mi>n</mi>
       </msubsup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <ci>r</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>d</ci>
          <ci>q</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <times></times>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <ci>q</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>λ</ci>
         <times></times>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=\left(b_{1}\lambda_{1}^{n}+b_{2}n\lambda_{1}^{n}+b_{3}n^{2}\lambda_{1}^{%
n}+\cdots+b_{r}n^{r-1}\lambda_{1}^{n}\right)+\cdots+\left(b_{d-q+1}\lambda_{*}%
^{n}+\cdots+b_{d}n^{q-1}\lambda_{*}^{n}\right)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>This is the general solution to the original recurrence relation. (<em>q</em> is the multiplicity of λ<sub>*</sub>)
</dd>
</dl>
<dl>
<dd>4. Equate each 

<math display="inline" id="Recurrence_relation:81">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mi>d</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>d</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},a_{1},\dots,a_{d}
  </annotation>
 </semantics>
</math>

 from part 3 (plugging in <em>n</em> = 0, ..., <em>d</em> into the general solution of the recurrence relation) with the known values 

<math display="inline" id="Recurrence_relation:82">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mi>d</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>d</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},a_{1},\dots,a_{d}
  </annotation>
 </semantics>
</math>

 from the original recurrence relation. However, the values <em>a<sub>n</sub></em> from the original recurrence relation used do not usually have to be contiguous: excluding exceptional cases, just <em>d</em> of them are needed (i.e., for an original linear homogeneous recurrence relation of order 3 one could use the values <em>a</em><sub>0</sub>, <em>a</em><sub>1</sub>, <em>a</em><sub>4</sub>). This process will produce a linear system of <em>d</em> equations with <em>d</em> unknowns. Solving these equations for the unknown coefficients 

<math display="inline" id="Recurrence_relation:83">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>b</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>b</mi>
    <mi>d</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>d</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{1},b_{2},\dots,b_{d}
  </annotation>
 </semantics>
</math>

 of the general solution and plugging these values back into the general solution will produce the particular solution to the original recurrence relation that fits the original recurrence relation's initial conditions (as well as all subsequent values 

<math display="inline" id="Recurrence_relation:84">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0},a_{1},a_{2},\dots
  </annotation>
 </semantics>
</math>


 of the original recurrence relation).
</dd>
</dl>

<p>The method for solving linear <a href="differential_equations" title="wikilink">differential equations</a> is similar to the method above—the "intelligent guess" (<a class="uri" href="ansatz" title="wikilink">ansatz</a>) for linear differential equations with constant coefficients is <em>e</em><sup>λ<em>x</em></sup> where λ is a complex number that is determined by substituting the guess into the differential equation.</p>

<p>This is not a coincidence. Considering the <a href="Taylor_series" title="wikilink">Taylor series</a> of the solution to a linear differential equation:</p>

<p>

<math display="block" id="Recurrence_relation:85">
 <semantics>
  <mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>n</mi>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <merror class="ltx_ERROR undefined undefined">
     <mtext>\infin</mtext>
    </merror>
   </munderover>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>a</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <mtext>\infin</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <ci>n</ci>
       </apply>
       <ci>a</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <ci>a</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n=0}^{\infin}\frac{f^{(n)}(a)}{n!}(x-a)^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>it can be seen that the coefficients of the series are given by the <em>n</em><sup>th</sup> derivative of <em>f</em>(<em>x</em>) evaluated at the point <em>a</em>. The differential equation provides a linear difference equation relating these coefficients.</p>

<p>This equivalence can be used to quickly solve for the recurrence relationship for the coefficients in the power series solution of a linear differential equation.</p>

<p>The rule of thumb (for equations in which the polynomial multiplying the first term is non-zero at zero) is that:</p>

<p>

<math display="block" id="Recurrence_relation:86">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </msup>
   <mo>→</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>k</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{[k]}\to f[n+k]
  </annotation>
 </semantics>
</math>

 and more generally</p>

<p>

<math display="block" id="Recurrence_relation:87">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>x</mi>
     <mi>m</mi>
    </msup>
    <mo>*</mo>
    <msup>
     <mi>y</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>k</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </msup>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>m</mi>
      </mrow>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mi>k</mi>
      </mrow>
      <mo>-</mo>
      <mi>m</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <ci>f</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{m}*y^{[k]}\to n(n-1)(n-m+1)f[n+k-m]
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Example:</strong> The recurrence relationship for the Taylor series coefficients of the equation:</p>

<p>

<math display="block" id="Recurrence_relation:88">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
         <mo>+</mo>
         <mrow>
          <mn>3</mn>
          <mi>x</mi>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mn>4</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>y</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mn>3</mn>
        <mo stretchy="false">]</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>3</mn>
         <mi>x</mi>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>y</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mn>2</mn>
        <mo stretchy="false">]</mo>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>y</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x^{2}+3x-4)y^{[3]}-(3x+1)y^{[2]}+2y=0
  </annotation>
 </semantics>
</math>

</p>

<p>is given by</p>

<p>

<math display="block" id="Recurrence_relation:89">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mn>3</mn>
       <mi>n</mi>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>4</mn>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>3</mn>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>3</mn>
      <mi>n</mi>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>2</mn>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>f</ci>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>n</ci>
        <ci>f</ci>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>f</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>n</ci>
       <ci>f</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(n-1)f[n+1]+3nf[n+2]-4f[n+3]-3nf[n+1]-f[n+2]+2f[n]=0
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Recurrence_relation:90">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mn>4</mn>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>3</mn>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>n</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>4</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>f</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>n</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -4f[n+3]+2nf[n+2]+n(n-4)f[n+1]+2f[n]=0.
  </annotation>
 </semantics>
</math>

</p>

<p>This example shows how problems generally solved using the power series solution method taught in normal differential equation classes can be solved in a much easier way.</p>

<p><strong>Example:</strong> The differential equation</p>

<p>

<math display="block" id="Recurrence_relation:91">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>a</mi>
     <msup>
      <mi>y</mi>
      <mi>′′</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>′′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ay^{\prime\prime}+by^{\prime}+cy=0
  </annotation>
 </semantics>
</math>

</p>

<p>has solution</p>

<p>

<math display="block" id="Recurrence_relation:92">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>a</mi>
      <mi>x</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=e^{ax}.
  </annotation>
 </semantics>
</math>

</p>

<p>The conversion of the differential equation to a difference equation of the Taylor coefficients is</p>

<p>

<math display="block" id="Recurrence_relation:93">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>a</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   af[n+2]+bf[n+1]+cf[n]=0.
  </annotation>
 </semantics>
</math>

</p>

<p>It is easy to see that the <em>n</em>th derivative of <em>e</em><sup><em>ax</em></sup> evaluated at 0 is <em>a</em><sup><em>n</em></sup></p>
<h3 id="solving-non-homogeneous-recurrence-relations">Solving non-homogeneous recurrence relations</h3>

<p>If the recurrence is inhomogeneous, a particular solution can be found by the <a href="method_of_undetermined_coefficients" title="wikilink">method of undetermined coefficients</a> and the solution is the sum of the solution of the homogeneous and the particular solutions. Another method to solve an inhomogeneous recurrence is the method of <em>symbolic differentiation</em>. For example, consider the following recurrence:</p>

<p>

<math display="block" id="Recurrence_relation:94">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+1}=a_{n}+1
  </annotation>
 </semantics>
</math>

</p>

<p>This is an inhomogeneous recurrence. If we substitute <em>n</em> ↦ <em>n</em>+1, we obtain the recurrence</p>

<p>

<math display="block" id="Recurrence_relation:95">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+2}=a_{n+1}+1
  </annotation>
 </semantics>
</math>

</p>

<p>Subtracting the original recurrence from this equation yields</p>

<p>

<math display="block" id="Recurrence_relation:96">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>2</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+2}-a_{n+1}=a_{n+1}-a_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>or equivalently</p>

<p>

<math display="block" id="Recurrence_relation:97">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+2}=2a_{n+1}-a_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>This is a homogeneous recurrence, which can be solved by the methods explained above. In general, if a linear recurrence has the form</p>

<p>

<math display="block" id="Recurrence_relation:98">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>k</mi>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>k</mi>
       </mrow>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>λ</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+k}=\lambda_{k-1}a_{n+k-1}+\lambda_{k-2}a_{n+k-2}+\cdots+\lambda_{1}a_{n+1%
}+\lambda_{0}a_{n}+p(n)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Recurrence_relation:99">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{0},\lambda_{1},\dots,\lambda_{k-1}
  </annotation>
 </semantics>
</math>


 are constant coefficients and <em>p</em>(<em>n</em>) is the inhomogeneity, then if <em>p</em>(<em>n</em>) is a polynomial with degree <em>r</em>, then this inhomogeneous recurrence can be reduced to a homogeneous recurrence by applying the method of symbolic differencing <em>r</em> times.</p>

<p>If</p>

<p>

<math display="block" id="Recurrence_relation:100">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>x</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(x)=\sum_{n=0}^{\infty}p_{n}x^{n}
  </annotation>
 </semantics>
</math>

 is the generating function of the inhomogeneity, the generating function</p>

<p>

<math display="block" id="Recurrence_relation:101">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mi>a</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>x</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(x)=\sum_{n=0}^{\infty}a(n)x^{n}
  </annotation>
 </semantics>
</math>

 of the inhomogeneous recurrence</p>

<p>

<math display="block" id="Recurrence_relation:102">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>s</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>c</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mi>i</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>p</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mi>n</mi>
     <mo>≥</mo>
     <msub>
      <mi>n</mi>
      <mi>r</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=\sum_{i=1}^{s}c_{i}a_{n-i}+p_{n},\quad n\geq n_{r},
  </annotation>
 </semantics>
</math>

 with constant coefficients <mtpl></mtpl> is derived from</p>

<p>

<math display="block" id="Recurrence_relation:103">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>s</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>c</mi>
          <mi>i</mi>
         </msub>
         <msup>
          <mi>x</mi>
          <mi>i</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>n</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mrow>
         <msub>
          <mi>n</mi>
          <mi>r</mi>
         </msub>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </munderover>
       <mrow>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <msub>
           <mi>a</mi>
           <mi>n</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>p</mi>
           <mi>n</mi>
          </msub>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
        <msup>
         <mi>x</mi>
         <mi>n</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>s</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>c</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mi>x</mi>
        <mi>i</mi>
       </msup>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>n</mi>
          <mo>=</mo>
          <mn>0</mn>
         </mrow>
         <mrow>
          <msub>
           <mi>n</mi>
           <mi>r</mi>
          </msub>
          <mo>-</mo>
          <mi>i</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </munderover>
        <mrow>
         <msub>
          <mi>a</mi>
          <mi>n</mi>
         </msub>
         <msup>
          <mi>x</mi>
          <mi>n</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>A</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>n</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>r</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>n</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>n</ci>
           <ci>r</ci>
          </apply>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(1-\sum_{i=1}^{s}c_{i}x^{i}\right)A(x)=P(x)+\sum_{n=0}^{n_{r}-1}[a_{n}-p_%
{n}]x^{n}-\sum_{i=1}^{s}c_{i}x^{i}\sum_{n=0}^{n_{r}-i-1}a_{n}x^{n}.
  </annotation>
 </semantics>
</math>

 If <em>P</em>(<em>x</em>) is a rational generating function, <em>A</em>(<em>x</em>) is also one. The case discussed above, where <em>p<sub>n</sub></em> = <em>K</em> is a constant, emerges as one example of this formula, with <em>P</em>(<em>x</em>) = <em>K</em>/(1−<em>x</em>). Another example, the recurrence 

<math display="inline" id="Recurrence_relation:104">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>10</mn>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">10</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=10a_{n-1}+n
  </annotation>
 </semantics>
</math>


 with linear inhomogeneity, arises in the definition of the <a href="schizophrenic_number" title="wikilink">schizophrenic numbers</a>. The solution of homogeneous recurrences is incorporated as <em>p</em> = <em>P</em> = 0.</p>
<h3 id="solving-non-homogeneous-recurrence-relations-with-variable-coefficients">Solving non-homogeneous recurrence relations with variable coefficients</h3>

<p>Moreover, for the general first-order linear inhomogeneous recurrence relation with variable coefficients:</p>

<p>

<math display="block" id="Recurrence_relation:105">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>f</mi>
        <mi>n</mi>
       </msub>
       <msub>
        <mi>a</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>g</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>n</mi>
     </msub>
     <mo>≠</mo>
     <mn>0</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+1}=f_{n}a_{n}+g_{n},\qquad f_{n}\neq 0,
  </annotation>
 </semantics>
</math>

 there is also a nice method to solve it:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>

<math display="block" id="Recurrence_relation:106">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>g</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n+1}-f_{n}a_{n}=g_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:107">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>n</mi>
      </msub>
      <msub>
       <mi>a</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>g</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{a_{n+1}}{\prod_{k=0}^{n}f_{k}}-\frac{f_{n}a_{n}}{\prod_{k=0}^{n}f_{k}}=%
\frac{g_{n}}{\prod_{k=0}^{n}f_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:108">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mfrac>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>g</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{a_{n+1}}{\prod_{k=0}^{n}f_{k}}-\frac{a_{n}}{\prod_{k=0}^{n-1}f_{k}}=%
\frac{g_{n}}{\prod_{k=0}^{n}f_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>Let</p>

<p>

<math display="block" id="Recurrence_relation:109">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{n}=\frac{a_{n}}{\prod_{k=0}^{n-1}f_{k}},
  </annotation>
 </semantics>
</math>

 Then</p>

<p>

<math display="block" id="Recurrence_relation:110">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>A</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>g</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{n+1}-A_{n}=\frac{g_{n}}{\prod_{k=0}^{n}f_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:111">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>m</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>A</mi>
       <mi>m</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>n</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>A</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>m</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <mfrac>
     <msub>
      <mi>g</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>m</mi>
      </msubsup>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>m</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <apply>
         <plus></plus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>m</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <csymbol cd="latexml">product</csymbol>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>m</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{m=0}^{n-1}(A_{m+1}-A_{m})=A_{n}-A_{0}=\sum_{m=0}^{n-1}\frac{g_{m}}{\prod%
_{k=0}^{m}f_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:112">
 <semantics>
  <mrow>
   <mfrac>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∏</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>A</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </munderover>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∏</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi>m</mi>
       </msubsup>
       <msub>
        <mi>f</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>m</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <csymbol cd="latexml">product</csymbol>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>m</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{a_{n}}{\prod_{k=0}^{n-1}f_{k}}=A_{0}+\sum_{m=0}^{n-1}\frac{g_{m}}{\prod_%
{k=0}^{m}f_{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:113">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>A</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>m</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </munderover>
       <mfrac>
        <msub>
         <mi>g</mi>
         <mi>m</mi>
        </msub>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∏</mo>
          <mrow>
           <mi>k</mi>
           <mo>=</mo>
           <mn>0</mn>
          </mrow>
          <mi>m</mi>
         </msubsup>
         <msub>
          <mi>f</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>m</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>g</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <csymbol cd="latexml">product</csymbol>
           <apply>
            <eq></eq>
            <ci>k</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <ci>m</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>f</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=\left(\prod_{k=0}^{n-1}f_{k}\right)\left(A_{0}+\sum_{m=0}^{n-1}\frac{g_{%
m}}{\prod_{k=0}^{m}f_{k}}\right)
  </annotation>
 </semantics>
</math>

</p>
<h3 id="general-linear-homogeneous-recurrence-relations">General linear homogeneous recurrence relations</h3>

<p>Many linear homogeneous recurrence relations may be solved by means of the <a href="generalized_hypergeometric_series" title="wikilink">generalized hypergeometric series</a>. Special cases of these lead to recurrence relations for the <a href="orthogonal_polynomials" title="wikilink">orthogonal polynomials</a>, and many <a href="special_function" title="wikilink">special functions</a>. For example, the solution to</p>

<p>

<math display="block" id="Recurrence_relation:114">
 <semantics>
  <mrow>
   <msub>
    <mi>J</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
      <mi>z</mi>
     </mfrac>
     <msub>
      <mi>J</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>J</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
       <ci>z</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>J</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>J</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{n+1}=\frac{2n}{z}J_{n}-J_{n-1}
  </annotation>
 </semantics>
</math>

</p>

<p>is given by</p>

<p>

<math display="block" id="Recurrence_relation:115">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>J</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>J</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>J</ci>
      <ci>n</ci>
     </apply>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{n}=J_{n}(z),\,
  </annotation>
 </semantics>
</math>

</p>

<p>the <a href="Bessel_function" title="wikilink">Bessel function</a>, while</p>

<p>

<math display="block" id="Recurrence_relation:116">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>b</mi>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>M</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
        <mo>-</mo>
        <mi>b</mi>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>M</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <msub>
      <mi>M</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>b</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
        <ci>b</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (b-n)M_{n-1}+(2n-b-z)M_{n}-nM_{n+1}=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>is solved by</p>

<p>

<math display="block" id="Recurrence_relation:117">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>M</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mi>b</mi>
     <mo>;</mo>
     <mi>z</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>M</ci>
     <vector>
      <ci>n</ci>
      <ci>b</ci>
      <ci>z</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{n}=M(n,b;z)\,
  </annotation>
 </semantics>
</math>

</p>

<p>the <a href="confluent_hypergeometric_series" title="wikilink">confluent hypergeometric series</a>.</p>
<h3 id="solving-a-first-order-rational-difference-equation">Solving a first order rational difference equation</h3>

<p>A first order rational difference equation has the form 

<math display="inline" id="Recurrence_relation:118">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mi>a</mi>
      <msub>
       <mi>w</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi>b</mi>
    </mrow>
    <mrow>
     <mrow>
      <mi>c</mi>
      <msub>
       <mi>w</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi>d</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>a</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>c</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{t+1}=\tfrac{aw_{t}+b}{cw_{t}+d}
  </annotation>
 </semantics>
</math>

. Such an equation can be solved by writing 

<math display="inline" id="Recurrence_relation:119">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{t}
  </annotation>
 </semantics>
</math>


 as a nonlinear transformation of another variable 

<math display="inline" id="Recurrence_relation:120">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}
  </annotation>
 </semantics>
</math>

 which itself evolves linearly. Then standard methods can be used to solve the linear difference equation in 

<math display="inline" id="Recurrence_relation:121">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="stability">Stability</h2>
<h3 id="stability-of-linear-higher-order-recurrences">Stability of linear higher-order recurrences</h3>

<p>The linear recurrence of order <em>d</em>,</p>

<p>

<math display="block" id="Recurrence_relation:122">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">…</mi>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>d</mi>
      </msub>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>d</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\dots+c_{d}a_{n-d},\,
  </annotation>
 </semantics>
</math>

</p>

<p>has the <a href="Characteristic_polynomial" title="wikilink">characteristic equation</a></p>

<p>

<math display="block" id="Recurrence_relation:123">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>λ</mi>
     <mi>d</mi>
    </msup>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>λ</mi>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>λ</mi>
      <mrow>
       <mi>d</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">…</mi>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>d</mi>
     </msub>
     <msup>
      <mi>λ</mi>
      <mn>0</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda^{d}-c_{1}\lambda^{d-1}-c_{2}\lambda^{d-2}-\dots-c_{d}\lambda^{0}=0.\,
  </annotation>
 </semantics>
</math>

</p>

<p>The recurrence is <a href="Stability_theory" title="wikilink">stable</a>, meaning that the iterates converge asymptotically to a fixed value, if and only if the <a class="uri" href="eigenvalues" title="wikilink">eigenvalues</a> (i.e., the roots of the characteristic equation), whether real or complex, are all less than <a href="unity_(mathematics)" title="wikilink">unity</a> in absolute value.</p>
<h3 id="stability-of-linear-first-order-matrix-recurrences">Stability of linear first-order matrix recurrences</h3>

<p>In the first-order matrix difference equation</p>

<p>

<math display="block" id="Recurrence_relation:124">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>t</mi>
     </msub>
     <mo>-</mo>
     <msup>
      <mi>x</mi>
      <mo>*</mo>
     </msup>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <msup>
       <mi>x</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [x_{t}-x^{*}]=A[x_{t-1}-x^{*}]\,
  </annotation>
 </semantics>
</math>

</p>

<p>with state vector <em>x</em> and transition matrix <em>A</em>, <em>x</em> converges asymptotically to the steady state vector <em>x</em>* if and only if all eigenvalues of the transition matrix <em>A</em> (whether real or complex) have an <a href="absolute_value" title="wikilink">absolute value</a> which is less than 1.</p>
<h3 id="stability-of-nonlinear-first-order-recurrences">Stability of nonlinear first-order recurrences</h3>

<p>Consider the nonlinear first-order recurrence</p>

<p>

<math display="block" id="Recurrence_relation:125">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=f(x_{n-1}).
  </annotation>
 </semantics>
</math>

</p>

<p>This recurrence is <a href="stability_theory" title="wikilink">locally stable</a>, meaning that it <a href="limit_of_a_sequence" title="wikilink">converges</a> to a fixed point <em>x</em>* from points sufficiently close to <em>x</em>*, if the slope of <em>f</em> in the neighborhood of <em>x</em>* is smaller than <a href="unity_(mathematics)" title="wikilink">unity</a> in absolute value: that is,</p>

<p>

<math display="block" id="Recurrence_relation:126">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <msup>
      <mi>f</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>x</mi>
       <mo>*</mo>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo><</mo>
   <mpadded width="+1.7pt">
    <mn>1.</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <abs></abs>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |f^{\prime}(x^{*})|<1.\,
  </annotation>
 </semantics>
</math>

</p>

<p>A nonlinear recurrence could have multiple fixed points, in which case some fixed points may be locally stable and others locally unstable; for continuous <em>f</em> two adjacent fixed points cannot both be locally stable.</p>

<p>A nonlinear recurrence relation could also have a cycle of period <em>k</em> for <em>k</em> &gt; 1. Such a cycle is stable, meaning that it attracts a set of initial conditions of positive measure, if the composite function</p>

<p>

<math display="block" id="Recurrence_relation:127">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mo>∘</mo>
     <mi>f</mi>
     <mo>∘</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>∘</mo>
     <mi>f</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>f</ci>
      <ci>normal-⋯</ci>
      <ci>f</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x):=f\circ f\circ\cdot\cdot\cdot\circ f(x)
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>f</em> appearing <em>k</em> times is locally stable according to the same criterion:</p>

<p>

<math display="block" id="Recurrence_relation:128">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <msup>
       <mi>g</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>x</mi>
        <mo>*</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo><</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <abs></abs>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |g^{\prime}(x^{*})|<1,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>x</em>* is any point on the cycle.</p>

<p>In a <a href="chaos_theory" title="wikilink">chaotic</a> recurrence relation, the variable <em>x</em> stays in a bounded region but never converges to a fixed point or an attracting cycle; any fixed points or cycles of the equation are unstable. See also <a href="logistic_map" title="wikilink">logistic map</a>, <a href="dyadic_transformation" title="wikilink">dyadic transformation</a>, and <a href="tent_map" title="wikilink">tent map</a>.</p>
<h2 id="relationship-to-differential-equations">Relationship to differential equations</h2>

<p>When solving an <a href="ordinary_differential_equation" title="wikilink">ordinary differential equation</a> <a href="numerical_ordinary_differential_equations" title="wikilink">numerically</a>, one typically encounters a recurrence relation. For example, when solving the <a href="initial_value_problem" title="wikilink">initial value problem</a></p>

<p>

<math display="block" id="Recurrence_relation:129">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>y</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo>,</mo>
       <mrow>
        <mi>y</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mi>y</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <ci>t</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>t</ci>
       </apply>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}(t)=f(t,y(t)),\ \ y(t_{0})=y_{0},
  </annotation>
 </semantics>
</math>

</p>

<p>with <a href="Euler's_method" title="wikilink">Euler's method</a> and a step size <em>h</em>, one calculates the values</p>

<p>

<math display="block" id="Recurrence_relation:130">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>y</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>y</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo>+</mo>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mi>y</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>h</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="7.5pt">,</mo>
      <mi mathvariant="normal">…</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <ci>y</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
      <list>
       <apply>
        <times></times>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>h</ci>
         </apply>
        </apply>
       </apply>
       <ci>normal-…</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}=y(t_{0}),\ \ y_{1}=y(t_{0}+h),\ \ y_{2}=y(t_{0}+2h),\ \dots
  </annotation>
 </semantics>
</math>

</p>

<p>by the recurrence</p>

<p>

<math display="block" id="Recurrence_relation:131">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mpadded lspace="1.7pt" width="+1.7pt">
      <mi>y</mi>
     </mpadded>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>t</mi>
        <mi>n</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \,y_{n+1}=y_{n}+hf(t_{n},y_{n}).
  </annotation>
 </semantics>
</math>

</p>

<p>Systems of linear first order differential equations can be discretized exactly analytically using the methods shown in the <a class="uri" href="discretization" title="wikilink">discretization</a> article.</p>
<h2 id="applications">Applications</h2>
<h3 id="biology">Biology</h3>

<p>Some of the best-known difference equations have their origins in the attempt to model <a class="uri" href="population" title="wikilink">population</a> dynamics. For example, the <a href="Fibonacci_number" title="wikilink">Fibonacci numbers</a> were once used as a model for the growth of a rabbit population.</p>

<p>The <a href="logistic_map" title="wikilink">logistic map</a> is used either directly to model population growth, or as a starting point for more detailed models. In this context, coupled difference equations are often used to model the interaction of two or more populations. For example, the Nicholson-Bailey model for a host-<a class="uri" href="parasite" title="wikilink">parasite</a> interaction is given by</p>

<p>

<math display="block" id="Recurrence_relation:132">
 <semantics>
  <mrow>
   <msub>
    <mi>N</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <msub>
     <mi>N</mi>
     <mi>t</mi>
    </msub>
    <mpadded width="+1.7pt">
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>a</mi>
        <msub>
         <mi>P</mi>
         <mi>t</mi>
        </msub>
       </mrow>
      </mrow>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{t+1}=\lambda N_{t}e^{-aP_{t}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:133">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>P</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>N</mi>
      <mi>t</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>a</mi>
          <msub>
           <mi>P</mi>
           <mi>t</mi>
          </msub>
         </mrow>
        </mrow>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>a</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{t+1}=N_{t}(1-e^{-aP_{t}}),\,
  </annotation>
 </semantics>
</math>

</p>

<p>with <em>N</em><sub><em>t</em></sub> representing the hosts, and <em>P</em><sub><em>t</em></sub> the parasites, at time <em>t</em>.</p>

<p><a href="Integrodifference_equation" title="wikilink">Integrodifference equations</a> are a form of recurrence relation important to spatial <a class="uri" href="ecology" title="wikilink">ecology</a>. These and other difference equations are particularly suited to modeling <a href="voltinism" title="wikilink">univoltine</a> populations.</p>
<h3 id="computer-science">Computer science</h3>

<p>Recurrence relations are also of fundamental importance in <a href="analysis_of_algorithms" title="wikilink">analysis of algorithms</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> If an <a class="uri" href="algorithm" title="wikilink">algorithm</a> is designed so that it will break a problem into smaller subproblems (<a href="Divide_and_conquer_algorithm" title="wikilink">divide and conquer</a>), its running time is described by a recurrence relation.</p>

<p>A simple example is the time an algorithm takes to find an element in an ordered vector with 

<math display="inline" id="Recurrence_relation:134">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>


 elements, in the worst case.</p>

<p>A naive algorithm will search from left to right, one element at a time. The worst possible scenario is when the required element is the last, so the number of comparisons is 

<math display="inline" id="Recurrence_relation:135">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

.</p>

<p>A better algorithm is called <a href="Binary_search_algorithm" title="wikilink">binary search</a>. However, it requires a sorted vector. It will first check if the element is at the middle of the vector. If not, then it will check if the middle element is greater or lesser than the sought element. At this point, half of the vector can be discarded, and the algorithm can be run again on the other half. The number of comparisons will be given by</p>

<p>

<math display="block" id="Recurrence_relation:136">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1}=1
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:137">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=1+c_{n/2}
  </annotation>
 </semantics>
</math>

</p>

<p>which will be close to 

<math display="inline" id="Recurrence_relation:138">
 <semantics>
  <mrow>
   <msub>
    <mi>log</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <log></log>
     <cn type="integer">2</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log_{2}(n)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="digital-signal-processing">Digital signal processing</h3>

<p>In <a href="digital_signal_processing" title="wikilink">digital signal processing</a>, recurrence relations can model feedback in a system, where outputs at one time become inputs for future time. They thus arise in <a href="infinite_impulse_response" title="wikilink">infinite impulse response</a> (IIR) <a href="digital_filter" title="wikilink">digital filters</a>.</p>

<p>For example, the equation for a "feedforward" IIR <a href="comb_filter" title="wikilink">comb filter</a> of delay <em>T</em> is:</p>

<p>

<math display="block" id="Recurrence_relation:139">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>α</mi>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mi>T</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>α</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=(1-\alpha)x_{t}+\alpha y_{t-T}
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Recurrence_relation:140">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}
  </annotation>
 </semantics>
</math>

 is the input at time <em>t</em>, 

<math display="inline" id="Recurrence_relation:141">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}
  </annotation>
 </semantics>
</math>

 is the output at time <em>t</em>, and α controls how much of the delayed signal is fed back into the output. From this we can see that</p>

<p>

<math display="block" id="Recurrence_relation:142">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>α</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mi>T</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>α</mi>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mrow>
           <mn>2</mn>
           <mi>T</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>α</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>α</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>t</ci>
          <ci>T</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>α</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>t</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>T</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=(1-\alpha)x_{t}+\alpha((1-\alpha)x_{t-T}+\alpha y_{t-2T})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Recurrence_relation:143">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mi>α</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mi>x</mi>
    <mi>t</mi>
   </msub>
   <mo>+</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>α</mi>
    <mo>-</mo>
    <msup>
     <mi>α</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>t</mi>
     <mo>-</mo>
     <mi>T</mi>
    </mrow>
   </msub>
   <mo>+</mo>
   <msup>
    <mi>α</mi>
    <mn>2</mn>
   </msup>
   <msub>
    <mi>y</mi>
    <mrow>
     <mi>t</mi>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mi>T</mi>
     </mrow>
    </mrow>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">1</cn>
     <minus></minus>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>t</ci>
    </apply>
    <plus></plus>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">α</csymbol>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>α</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>t</ci>
      <ci>T</ci>
     </apply>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>α</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <minus></minus>
      <ci>t</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=(1-\alpha)x_{t}+(\alpha-\alpha^{2})x_{t-T}+\alpha^{2}y_{t-2T})
  </annotation>
 </semantics>
</math>

</p>

<p>etc.</p>
<h3 id="economics">Economics</h3>

<p>Recurrence relations, especially linear recurrence relations, are used extensively in both theoretical and empirical economics.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> In particular, in macroeconomics one might develop a model of various broad sectors of the economy (the financial sector, the goods sector, the labor market, etc.) in which some agents' actions depend on lagged variables. The model would then be solved for current values of key variables (interest rate, real GDP, etc.) in terms of <a href="exogeny" title="wikilink">exogenous variables</a> and lagged <a href="endogeneity_(economics)" title="wikilink">endogenous</a> variables. See also <a href="time_series_analysis" title="wikilink">time series analysis</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Iterated_function" title="wikilink">Iterated function</a></li>
<li><a href="Matrix_difference_equation" title="wikilink">Matrix difference equation</a></li>
<li><a href="Orthogonal_polynomials" title="wikilink">Orthogonal polynomials</a></li>
<li><a class="uri" href="Recursion" title="wikilink">Recursion</a></li>
<li><a href="Recursion_(computer_science)" title="wikilink">Recursion (computer science)</a></li>
<li><a href="Lagged_Fibonacci_generator" title="wikilink">Lagged Fibonacci generator</a></li>
<li><a href="Master_theorem" title="wikilink">Master theorem</a></li>
<li><a href="Circle_points_segments_proof" title="wikilink">Circle points segments proof</a></li>
<li><a href="Continued_fraction" title="wikilink">Continued fraction</a></li>
<li><a href="Time_scale_calculus" title="wikilink">Time scale calculus</a></li>
<li><a href="Integrodifference_equation" title="wikilink">Integrodifference equation</a></li>
<li><a href="Combinatorial_principles" title="wikilink">Combinatorial principles</a></li>
<li><a href="Infinite_impulse_response" title="wikilink">Infinite impulse response</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li><a href="Thomas_H._Cormen" title="wikilink">Thomas H. Cormen</a>, <a href="Charles_E._Leiserson" title="wikilink">Charles E. Leiserson</a>, <a href="Ronald_L._Rivest" title="wikilink">Ronald L. Rivest</a>, and <a href="Clifford_Stein" title="wikilink">Clifford Stein</a>. <em><a href="Introduction_to_Algorithms" title="wikilink">Introduction to Algorithms</a></em>, Second Edition. MIT Press and McGraw-Hill, 1990. ISBN 0-262-03293-7. Chapter 4: Recurrences, pp. 62–90.</li>
<li></li>
<li></li>
<li>

<p>chapter 7.</p></li>
<li>

<p>Chapter 9.1: Difference Equations.</p></li>
<li></li>
<li>

<p>at EqWorld - The World of Mathematical Equations.</p></li>
<li>

<p>at EqWorld - The World of Mathematical Equations.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li>[<a class="uri" href="http://books.google.com/books?id=pOBXUoVZ9EEC&amp;pg">http://books.google.com/books?id=pOBXUoVZ9EEC&amp;pg;</a>;=PA95&amp;lpg;=PA95&amp;dq;=%22difference+equation%22+%22recurrence+relation%22&amp;source;=web&amp;ots;=1kZStOrPh5&amp;sig;=VYKkC__C9AfmfrhjFhhLg_Q5YPk&amp;hl;=en&amp;sa;=X&amp;oi;=book_result&amp;resnum;=5&amp;ct;=result Introductory Discrete Mathematics]</li>
<li>

<p><a class="uri" href="OEIS" title="wikilink">OEIS</a> index to a few thousand examples of linear recurrences, sorted by order (number of terms) and signature (vector of values of the constant coefficients)</p></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Algebra" title="wikilink">Category:Algebra</a> <a href="Category:Recurrence_relations" title="wikilink"> </a> <a href="Category:Theory_of_computation" title="wikilink">Category:Theory of computation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://books.google.com/books?id=1klnDGelHGEC">Partial difference equations</a>, Sui Sun Cheng, CRC Press, 2003, ISBN 978-0-415-29884-1<a href="#fnref2">↩</a></li>
<li id="fn3">Chiang, Alpha C., <em>Fundamental Methods of Mathematical Economics</em>, third edition, McGraw-Hill, 1984.<a href="#fnref3">↩</a></li>
<li id="fn4">Papanicolaou, Vassilis, "On the asymptotic stability of a class of linear difference equations," <em>Mathematics Magazine</em> 69(1), February 1996, 34–43.<a href="#fnref4">↩</a></li>
<li id="fn5">.<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="http://faculty.pccu.edu.tw/%7Emeng/Math15.pdf">http://faculty.pccu.edu.tw/%7Emeng/Math15.pdf</a><a href="#fnref6">↩</a></li>
<li id="fn7">Cormen, T. et al, <em>Introduction to Algorithms</em>, MIT Press, 2009<a href="#fnref7">↩</a></li>
<li id="fn8">R. Sedgewick, F. Flajolet, <em>An Introduction to the Analysis of Algorithms</em>, Addison-Wesley, 2013<a href="#fnref8">↩</a></li>
<li id="fn9">Sargent, Thomas J., <em>Dynamic Macroeconomic Theory</em>, Harvard University Press, 1987.<a href="#fnref9">↩</a></li>
</ol>
</section>
</body>
</html>

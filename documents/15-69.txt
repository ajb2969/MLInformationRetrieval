   Combined Linear Congruential Generator      Combined Linear Congruential Generator   A Combined Linear Congruential Generator ( CLCG ) is a pseudo-random number generator algorithm based on combining two or more linear congruential generators (LCG). A traditional LCG has a period which is inadequate for complex system simulation. 1 By combining two or more LCGs, random numbers with a longer period and better statistical properties can be created. 2 The algorithm is defined as: 3       X  i   ≡    (    ∑   j  =  1   k      (   -  1   )    j  -  1     Y   i  ,  j      )      (   mod   (    m  1   -  1   )    )         subscript  X  i    annotated    superscript   subscript     j  1    k      superscript    1     j  1     subscript  Y   i  j       pmod     subscript  m  1   1       X_{i}\equiv\left(\sum_{j=1}^{k}(-1)^{j-1}Y_{i,j}\right)\;\;(\mathop{{\rm mod}}%
 (m_{1}-1))     where:      m  1     subscript  m  1    m_{1}   — the " modulus " of the first LCG      Y   i  ,  j      subscript  Y   i  j     Y_{i,j}   — the i th input from the j th LCG      X  i     subscript  X  i    X_{i}   — the i th generated random integer  with:       R  i   ≡   {       X  i   /   m  1        for   X  i    >  0         (    m  1   -  1   )   /   m  1        for   X  i    =  0            subscript  R  i    cases     subscript  X  i    subscript  m  1        for   subscript  X  i    0        subscript  m  1   1    subscript  m  1        for   subscript  X  i    0      R_{i}\equiv\begin{cases}X_{i}/m_{1}&\text{for }X_{i}>0\\
 (m_{1}-1)/m_{1}&\text{for }X_{i}=0\end{cases}   where    R  i     subscript  R  i    R_{i}   is a uniformly distributed random number between 0 and 1.  Derivation  If W i ,1 , W i ,2 , ..., W i ,k are any independent, discrete, random-variables and one of them is uniformly distributed from 0 to m 1 − 2, then Z i is uniformly distributed between 0 and m 1 − 2, where: 4       Z  i   =    (    ∑   j  =  1   k    W   i  ,  j     )      (   mod   (    m  1   -  1   )    )         subscript  Z  i    annotated    superscript   subscript     j  1    k    subscript  W   i  j      pmod     subscript  m  1   1       Z_{i}=\left(\sum_{j=1}^{k}W_{i,j}\right)\;\;(\mathop{{\rm mod}}(m_{1}-1))     Let X i ,1 , X i ,2 , ..., X i , k be outputs from k LCGs. If W i , j is defined as X i , j − 1, then W i , j will be approximately uniformly distributed from 0 to m j − 1. 5 The coefficient "(−1) j −1 " implicitly performs the subtraction of one from X i , j . 6  Properties  The CLCG provides an efficient way to calculate pseudo-random numbers. The LCG algorithm is computationally inexpensive to use. 7 The results of multiple LCG algorithms are combined through the CLCG algorithm to create pseudo-random numbers with a longer period than is achievable with the LCG method by itself. 8  The period of a CLCG is dependent on the seed value used to initiate the algorithm. The maximum period of a CLCG is defined by the function: 9      P  =    (    (    m  1   -  1   )    (    m  2   -  1   )   ⋯   (    m  k   -  1   )    )   /   (   2   k  -  1    )        P         subscript  m  1   1      subscript  m  2   1   normal-⋯     subscript  m  k   1     superscript  2    k  1       P=((m_{1}-1)(m_{2}-1)\cdots(m_{k}-1))/(2^{k-1})     Example  The following is an example algorithm designed for use in 32 bit computers: 10      k  =  2      k  2    k=2   LCGs are used with the following properties:       a  1   =   40  ,  014        subscript  a  1    40  014     a_{1}=40,014          m  1   =   2  ,  147  ,  483  ,  563        subscript  m  1    2  147  483  563     m_{1}=2,147,483,563          a  2   =   40  ,  692        subscript  a  2    40  692     a_{2}=40,692          m  2   =   2  ,  147  ,  483  ,  399        subscript  m  2    2  147  483  399     m_{2}=2,147,483,399          c  1   =   c  2   =  0         subscript  c  1    subscript  c  2        0     c_{1}=c_{2}=0     The CLCG algorithm is setup as follows:  1. The seed for the first LCG,    Y   0  ,  1      subscript  Y   0  1     Y_{0,1}   , should be selected in the range of [1, 2,147,483,562].   The seed for the second LCG,    Y   0  ,  2      subscript  Y   0  2     Y_{0,2}   , should be selected in the range of [1, 2,147,483,398].  Set    i  =  0      i  0    i=0      2. The two LCGs are evaluated as follows:       Y    i  +  1   ,  1    =   40  ,    014  ×   Y   i  ,  1        (   mod   2  ,  147  ,  483  ,  563    )          subscript  Y     i  1   1     40   annotated    014   subscript  Y   i  1      pmod   2  147  483  563        Y_{i+1,1}=40,014\times Y_{i,1}\;\;(\mathop{{\rm mod}}2,147,483,563)          Y    i  +  1   ,  2    =   40  ,    692  ×   Y   i  ,  2        (   mod   2  ,  147  ,  483  ,  399    )          subscript  Y     i  1   2     40   annotated    692   subscript  Y   i  2      pmod   2  147  483  399        Y_{i+1,2}=40,692\times Y_{i,2}\;\;(\mathop{{\rm mod}}2,147,483,399)     3. The CLCG equation is solved as shown below:       X   i  +  1    =    (    Y    i  +  1   ,  1    -   Y    i  +  1   ,  2     )      (   mod   2  ,  147  ,  483  ,  562    )         subscript  X    i  1     annotated     subscript  Y     i  1   1     subscript  Y     i  1   2      pmod   2  147  483  562       X_{i+1}=(Y_{i+1,1}-Y_{i+1,2})\;\;(\mathop{{\rm mod}}2,147,483,562)     4. Calculate the random number:       R   i  +  1    =   {        X   i  +  1    /  2   ,  147  ,  483  ,  563       for   X   i  +  1     >  0         (    X   i  +  1    /  2   ,  147  ,  483  ,  563  )   +  1       for   X   i  +  1     <  0        2  ,  147  ,  483  ,   562  /  2   ,  147  ,  483  ,  563       for   X   i  +  1     =  0            subscript  R    i  1     cases      subscript  X    i  1    2   147  483  563       for   subscript  X    i  1     0         subscript  X    i  1    2   147  483  563   1       for   subscript  X    i  1     0    2  147  483    562  2   147  483  563       for   subscript  X    i  1     0      R_{i+1}=\begin{cases}X_{i+1}/2,147,483,563&\text{for }X_{i+1}>0\\
 (X_{i+1}/2,147,483,563)+1&\text{for }X_{i+1}<0\\
 2,147,483,562/2,147,483,563&\text{for }X_{i+1}=0\end{cases}     5. Increment the counter (i=i+1) then return to step 2 and repeat.  The maximum period of the two LCGs used is calculated using the formula:. 11      (   m  -  1   )      m  1    (m-1)   This equates to 2.1x10 9 for the two LCGs used.  This CLCG shown in this example has a maximum period of:         (    m  1   -  1   )    (    m  2   -  1   )    /  2   =   2.3  ×   10  18               subscript  m  1   1      subscript  m  2   1    2     2.3   superscript  10  18      (m_{1}-1)(m_{2}-1)/2=2.3\times 10^{18}   This represents a tremendous improvement over the period of the individual LCGs. It can be seen that the combined method increases the period by 9 orders of magnitude.  Surprisingly the period of this CLCG may not be sufficient for all applications:. 12 Other algorithms using the CLCG method have been used to create pseudo-random number generators with periods as long as 3x10 57 . 13 14 15  See also   Linear congruential generator   References     Banks, Jerry., Carson, John S., Nelson, Barry L., Nicol, David M., (2010). Discrete-Event System Simulation , 5th edition, Prentice Hall, ISBN 0-13-606212-1.        External links   An overview of use and testing of pseudo-random number generators   "  Category:Pseudorandom number generators  Category:Modular arithmetic     Banks 2010, Sec. 7.3.2 ↩  Banks 2010, Sec. 7.3.2 ↩  L'Ecuyer 1988 ↩  L'Ecuyer 1988 ↩  L'Ecuyer 1988 ↩  Banks 2010, Sec. 7.3.2 ↩  Pandey 2008, Sec. 2.2 ↩  Pandey 2008, Sec. 2.2 ↩  Banks 2010, Sec. 7.3.2 ↩  L'Ecuyer 1988 ↩  Banks 2010, Sec. 7.3.2 ↩  Banks 2010, Sec. 7.3.2 ↩  L'Ecuyer 1996 ↩  L'Ecuyer 1999 ↩  L'Ecuyer 2002 ↩     
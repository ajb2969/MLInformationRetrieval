   Smith–Minkowski–Siegel mass formula      Smith–Minkowski–Siegel mass formula   In mathematics, the Smith–Minkowski–Siegel mass formula (or Minkowski–Siegel mass formula ) is a formula for the sum of the weights of the lattices ( quadratic forms ) in a genus , weighted by the reciprocals of the orders of their automorphism groups. The mass formula is often given for integral quadratic forms, though it can be generalized to quadratic forms over any algebraic number field.  In 0 and 1 dimensions the mass formula is trivial, in 2 dimensions it is essentially equivalent to Dirichlet's  class number formulas for imaginary quadratic fields , and in 3 dimensions some partial results were given by Ferdinand Eisenstein . The mass formula in higher dimensions was first given by , though his results were forgotten for many years. It was rediscovered by , and an error in Minkowski's paper was found and corrected by .  Many published versions of the mass formula have errors; in particular the 2-adic densities are difficult to get right, and it is sometimes forgotten that the trivial cases of dimensions 0 and 1 are different from the cases of dimension at least 2.  give an expository account and precise statement of the mass formula for integral quadratic forms, which is reliable because they check it on a large number of explicit cases.  For recent proofs of the mass formula see  and .  The Smith–Minkowski–Siegel mass formula is essentially the constant term of the Weil–Siegel formula .  Statement of the mass formula  If f is an n -dimensional positive definite integral quadratic form (or lattice) then the mass of its genus is defined to be       m   (  f  )    =    ∑  Λ    1   |   Aut   (  Λ  )    |           m  f     subscript   normal-Λ     1     Aut  normal-Λ        m(f)=\sum_{\Lambda}{1\over|\operatorname{Aut}(\Lambda)|}     where the sum is over all integrally inequivalent forms in the same genus as f , and Aut(Λ) is the automorphism group of Λ. The form of the mass formula given by  states that for n ≥ 2 the mass is given by       m   (  f  )    =   2   π   -    n   (   n  +  1   )    /  4       ∏   j  =  1   n    Γ   (   j  /  2   )     ∏   p  prime     2   m  p    (  f  )              m  f     2   superscript  π        n    n  1    4       superscript   subscript  product    j  1    n     normal-Γ    j  2     subscript  product    p  prime      2   subscript  m  p   f         m(f)=2\pi^{-n(n+1)/4}\prod_{j=1}^{n}\Gamma(j/2)\prod_{p\text{ prime}}2m_{p}(f)     where m p ( f ) is the p -mass of f , given by        m  p    (  f  )    =    p    (    r  n   (   n  -  1   )    +   s   (   n  +  1   )     )   /  2     N   (   p  r   )            subscript  m  p   f      superscript  p        r  n    n  1      s    n  1     2      N   superscript  p  r       m_{p}(f)={p^{(rn(n-1)+s(n+1))/2}\over N(p^{r})}     for sufficiently large r , where p s is the highest power of p dividing the determinant of f . The number N ( p r ) is the number of n by n matrices X with coefficients that are integers mod p  r such that        X  tr   A  X   ≡    A   mod   p  r           superscript  X  tr   A  X    modulo  A   superscript  p  r      X^{\text{tr}}AX\equiv A\ \bmod\ p^{r}     where A is the Gram matrix of f , or in other words the order of the automorphism group of the form reduced mod p  r .  Some authors state the mass formula in terms of the p -adic density        α  p    (  f  )    =    N   (   p  r   )     p    r  n   (   n  -  1   )    /  2     =    p    s   (   n  +  1   )    /  2      m  p    (  f  )              subscript  α  p   f       N   superscript  p  r     superscript  p      r  n    n  1    2             superscript  p      s    n  1    2       subscript  m  p   f       \alpha_{p}(f)={N(p^{r})\over p^{rn(n-1)/2}}={p^{s(n+1)/2}\over m_{p}(f)}     instead of the p -mass. The p -mass is invariant under rescaling f but the p -density is not.  In the (trivial) cases of dimension 0 or 1 the mass formula needs some modifications. The factor of 2 in front represents the Tamagawa number of the special orthogonal group, which is only 1 in dimensions 0 and 1. Also the factor of 2 in front of m p ( f ) represents the index of the special orthogonal group in the orthogonal group, which is only 1 in 0 dimensions.  Evaluation of the mass  The mass formula gives the mass as an infinite product over all primes. This can be rewritten as a finite product as follows. For all but a finite number of primes (those not dividing 2 det( ƒ )) the p -mass m p ( ƒ ) is equal to the standard p-mass std p ( ƒ ), given by         std  p    (  f  )    =   1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   2  -  n     )    (   1  -    (         (   -  1   )    n  /  2     det   (  f  )         p      )    p   -   n  /  2       )            subscript  std  p   f     1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p    2  n       1     binomial     superscript    1     n  2      f    p    superscript  p      n  2           \operatorname{std}_{p}(f)={1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-n})(1-{(-%
 1)^{n/2}\det(f)\choose p}p^{-n/2})}\quad   (for n = dim( ƒ ) even)        std  p    (  f  )    =   1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   1  -  n     )           subscript  std  p   f     1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p    1  n         \operatorname{std}_{p}(f)={1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{1-n})}   (for n = dim( ƒ ) odd)  where the Legendre symbol in the second line is interpreted as 0 if p divides 2 det( ƒ ).  If all the p -masses have their standard value, then the total mass is the standard mass       std   (  f  )    =   2   π   -    n   (   n  +  1   )    /  4      (    ∏   j  =  1   n    Γ   (   j  /  2   )     )   ζ   (  2  )   ζ   (  4  )   ⋯  ζ   (   n  -  1   )         std  f     2   superscript  π        n    n  1    4       superscript   subscript  product    j  1    n     normal-Γ    j  2     ζ  2  ζ  4  normal-⋯  ζ    n  1      \operatorname{std}(f)=2\pi^{-n(n+1)/4}\left(\prod_{j=1}^{n}\Gamma(j/2)\right)%
 \zeta(2)\zeta(4)\cdots\zeta(n-1)   (For n odd)       std   (  f  )    =   2   π   -    n   (   n  +  1   )    /  4      (    ∏   j  =  1   n    Γ   (   j  /  2   )     )   ζ   (  2  )   ζ   (  4  )   ⋯  ζ   (   n  -  2   )    ζ  D    (   n  /  2   )         std  f     2   superscript  π        n    n  1    4       superscript   subscript  product    j  1    n     normal-Γ    j  2     ζ  2  ζ  4  normal-⋯  ζ    n  2    subscript  ζ  D     n  2      \operatorname{std}(f)=2\pi^{-n(n+1)/4}\left(\prod_{j=1}^{n}\Gamma(j/2)\right)%
 \zeta(2)\zeta(4)\cdots\zeta(n-2)\zeta_{D}(n/2)   (For n even)  where        ζ  D    (  s  )    =    ∏  p    1   1  -    (      D      p      )    p   -  s               subscript  ζ  D   s     subscript  product  p     1    1     binomial  D  p    superscript  p    s          \zeta_{D}(s)=\prod_{p}{1\over 1-{D\choose p}p^{-s}}      D = (−1) n /2 det( ƒ )   The values of the Riemann zeta function for an even integers s are given in terms of Bernoulli numbers by        ζ   (  s  )    =      (   2  π   )   s    2  ×   s  !      |   B  s   |     .        ζ  s        superscript    2  π   s     2    s        subscript  B  s       \zeta(s)={(2\pi)^{s}\over 2\times s!}|B_{s}|.     So the mass of ƒ is given as a finite product of rational numbers as        m   (  f  )    =    std   (  f  )      ∏   p  |  2  det   (  f  )        m  p    (  f  )      std  p    (  f  )        .        m  f      std  f     subscript  product   fragments  p  normal-|  2    fragments  normal-(  f  normal-)          subscript  m  p   f     subscript  std  p   f        m(f)=\operatorname{std}(f)\prod_{p|2\det(f)}{m_{p}(f)\over\operatorname{std}_{%
 p}(f)}.     Evaluation of the p -mass  If the form f has a p-adic Jordan decomposition      f  =   ∑   q   f  q         f      q   subscript  f  q       f=\sum qf_{q}     where q runs through powers of p and f q has determinant prime to p and dimension n ( q ), then the p -mass is given by      1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   2  -  n     )    (   1  -   p   -   n  /  2      )        1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p    2  n       1   superscript  p      n  2         {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-n})(1-p^{-n/2})}     when n is odd, or      1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   2  -  n     )    (   1  +   p   -   n  /  2      )        1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p    2  n       1   superscript  p      n  2         {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-n})(1+p^{-n/2})}     when n is even and (−1) n /2 d q is a quadratic residue. or      1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   -   2  t      )        1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p      2  t         {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{-2t})}     when n is even and (−1) n /2 d q is a quadratic nonresidue.  For p = 2 the diagonal factor M p ( f q ) is notoriously tricky to calculate. (The notation is misleading as it depends not only on f q but also on f 2 q and f q /2 .)   We say that f q is odd if it represents an odd 2-adic integer, and even otherwise.  The octane value of f q is an integer mod 8; if f q is even its octane value is 0 if the determinant is +1 or −1 mod 8, and is 4 if the determinant is +3 or −3 mod 8, while if f q is odd it can be diagonalized and its octane value is then the number of diagonal entries that are 1 mod 4 minus the number that are 3 mod 4.  We say that f q is bound if at least one of f 2 q and f q /2 is odd, and say it is free otherwise.  The integer t is defined so that the dimension of f q is 2 t if f q is even, and 2 t + 1 or 2 t + 2 if f q is odd.   Then the diagonal factor M p ( f q ) is given as follows.      1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   2  -   2  t      )    (   1  -   p   -  t     )        1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p    2    2  t        1   superscript  p    t        {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-2t})(1-p^{-t})}     when the form is bound or has octane value +2 or −2 mod 8 or      1   2   (   1  -   p   -  2     )    (   1  -   p   -  4     )   ⋯   (   1  -   p   2  -   2  t      )    (   1  +   p   -  t     )        1    2    1   superscript  p    2       1   superscript  p    4     normal-⋯    1   superscript  p    2    2  t        1   superscript  p    t        {1\over 2(1-p^{-2})(1-p^{-4})\cdots(1-p^{2-2t})(1+p^{-t})}     when the form is free and has octane value −1 or 0 or 1 mod 8 or      (      D      m      )     binomial  D  m    {D\choose m}     when the form is free and has octane value −3 or 3 or 4 mod 8.  Evaluation of ζ D ( s )  The required values of the Dirichlet series ζ D ( s ) can be evaluated as follows. We write χ for the Dirichlet character with χ( m ) given by 0 if m is even, and the Jacobi symbol       ζ  D    (  s  )    =   L   (  s  ,  χ  )    =   L   (  s  ,  ψ  )     ∏   p  |  k     (   1  -    ψ   (  p  )     p  s     )              subscript  ζ  D   s     L   s  χ           L   s  ψ     subscript  product   fragments  p  normal-|  k      1      ψ  p    superscript  p  s          \zeta_{D}(s)=L(s,\chi)=L(s,\psi)\prod_{p|k}\left(1-{\psi(p)\over p^{s}}\right)   is m is odd. We write k for the modulus of this character and k 1 for its conductor, and put χ = χ 1 ψ where χ 1 is the principal character mod k and ψ is a primitive character mod k 1 . Then       L   (   1  -  s   ,  ψ  )    =      k  1   s  -  1    Γ   (  s  )      (   2  π   )   s     (    i   -  s    +   ψ   (   -  1   )    i  s     )   G   (  ψ  )   L   (  s  ,  ψ  )          L     1  s   ψ           superscript   subscript  k  1     s  1    normal-Γ  s    superscript    2  π   s       superscript  i    s      ψ    1    superscript  i  s     G  ψ  L   s  ψ      L(1-s,\psi)={k_{1}^{s-1}\Gamma(s)\over(2\pi)^{s}}(i^{-s}+\psi(-1)i^{s})G(\psi)%
 L(s,\psi)     The functional equation for the L-series is        G   (  ψ  )    =    ∑   r  =  1    k  1     ψ   (  r  )    e    2  π  i  r   /   k  1        .        G  ψ     superscript   subscript     r  1     subscript  k  1      ψ  r   superscript  e      2  π  i  r    subscript  k  1         G(\psi)=\sum_{r=1}^{k_{1}}\psi(r)e^{2\pi ir/k_{1}}.     where G is the Gauss sum       L   (   1  -  s   ,  ψ  )    =   -     k  1   s  -  1    s     ∑   r  =  1    k  1     ψ   (  r  )    B  s    (   r  /   k  1    )             L     1  s   ψ           superscript   subscript  k  1     s  1    s     superscript   subscript     r  1     subscript  k  1      ψ  r   subscript  B  s     r   subscript  k  1          L(1-s,\psi)=-{k_{1}^{s-1}\over s}\sum_{r=1}^{k_{1}}\psi(r)B_{s}(r/k_{1})     If s is a positive integer then        ∑  Λ    1   |   Aut   (  Λ  )    |     =     |   B   n  /  2    |   n     ∏   1  ≤  j  <   n  /  2       |   B   2  j    |    4  j            subscript   normal-Λ     1     Aut  normal-Λ             subscript  B    n  2     n     subscript  product      1  j         n  2           subscript  B    2  j       4  j        \sum_{\Lambda}{1\over|\operatorname{Aut}(\Lambda)|}={|B_{n/2}|\over n}\prod_{1%
 \leq j     where B s ( x ) is a Bernoulli polynomial .  Examples  For the case of even unimodular lattices Λ of dimension n > 0 divisible by 8 the mass formula is          |   B  4   |   8     |   B  2   |   4     |   B  4   |   8     |   B  6   |   12    =      1  /  30   8       1  /  6   4       1  /  30   8      1  /  42   12    =   1  696729600    .               subscript  B  4    8        subscript  B  2    4        subscript  B  4    8        subscript  B  6    12          1  30   8       1  6   4       1  30   8       1  42   12           1  696729600      {|B_{4}|\over 8}{|B_{2}|\over 4}{|B_{4}|\over 8}{|B_{6}|\over 12}={1/30\over 8%
 }\;{1/6\over 4}\;{1/30\over 8}\;{1/42\over 12}={1\over 696729600}.     where B k is a Bernoulli number .  ===Dimension n = 0=== The formula above fails for n = 0, and in general the mass formula needs to be modified in the trivial cases when the dimension is at most 1. For n = 0 there is just one lattice, the zero lattice, of weight 1, so the total mass is 1.  ===Dimension n = 8=== The mass formula gives the total mass as          |   B  8   |   16     |   B  2   |   4     |   B  4   |   8     |   B  6   |   12     |   B  8   |   16     |   B  10   |   20     |   B  12   |   24     |   B  14   |   28    =   691  277667181515243520000    .             subscript  B  8    16        subscript  B  2    4        subscript  B  4    8        subscript  B  6    12        subscript  B  8    16        subscript  B  10    20        subscript  B  12    24        subscript  B  14    28      691  277667181515243520000     {|B_{8}|\over 16}{|B_{2}|\over 4}{|B_{4}|\over 8}{|B_{6}|\over 12}{|B_{8}|%
 \over 16}{|B_{10}|\over 20}{|B_{12}|\over 24}{|B_{14}|\over 28}={691\over 2776%
 67181515243520000}.     There is exactly one even unimodular lattice of dimension 8, the E8 lattice , whose automorphism group is the Weyl group of E 8 of order 696729600, so this verifies the mass formula in this case. Smith originally gave a nonconstructive proof of the existence of an even unimodular lattice of dimension 8 using the fact that the mass is non-zero.  ===Dimension n = 16=== The mass formula gives the total mass as         1  970864271032320000   +   1  685597979049984000    =   691  277667181515243520000    .          1  970864271032320000     1  685597979049984000      691  277667181515243520000     {1\over 970864271032320000}+{1\over 685597979049984000}={691\over 277667181515%
 243520000}.   There are two even unimodular lattices of dimension 16, one with root system E 8 2 and automorphism group of order 2×696729600 2 = 970864271032320000, and one with root system D 16 and automorphism group of order 2 15 16! = 685597979049984000.  So the mass formula is  $${1\over 970864271032320000} + {1\over 685597979049984000} = {691\over 277667181515243520000 }.$$  ===Dimension n = 24=== There are 24 even unimodular lattices of dimension 24, called the Niemeier lattices . The mass formula for them is checked in .  ===Dimension n = 32=== The mass in this case is large, more than 40 million. This implies that there are more than 80 million even unimodular lattices of dimension 32, as each has automorphism group of order at least 2 so contributes at most 1/2 to the mass. By refining this argument,  showed that there are more than a billion such lattices. In higher dimensions the mass, and hence the number of lattices, increases very rapidly.  Generalizations  Siegel gave a more general formula that counts the weighted number of representations of one quadratic form by forms in some genus; the Smith–Minkowski–Siegel mass formula is the special case when one form is the zero form.  Tamagawa showed that the mass formula was equivalent to the statement that the Tamagawa number of the orthogonal group is 2, which is equivalent to saying that the Tamagawa number of its simply connected cover the spin group is 1. André Weil conjectured more generally that the Tamagawa number of any simply connected semisimple group is 1 , and this conjecture was proved by Kottwitz in 1988.  gave a mass formula for unimodular lattices without roots (or with given root system).  See also   Siegel identity   References       .       "  Category:Quadratic forms   
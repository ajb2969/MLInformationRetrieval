   Gilbert–Shannon–Reeds model      Gilbert–Shannon–Reeds model   In the mathematics of shuffling  playing cards , the Gilbert–Shannon–Reeds model is a probability distribution on riffle shuffle permutations that has been reported to be a good match for experimentally observed outcomes of human shuffling, 1 and that forms the basis for a recommendation that a deck of cards should be riffled seven times in order to thoroughly randomize it. 2 It is named after the work of Edgar Gilbert , Claude Shannon , and J. Reeds, reported in a 1955 technical report by Gilbert 3 and in a 1981 unpublished manuscript of Reeds.  The model  The Gilbert–Shannon–Reeds model may be defined in several equivalent ways.  Most similarly to the way humans shuffle cards, it can be defined as a random cut and riffle. The deck of cards is cut into two packets; if there are a total of n cards, then the probability of selecting k cards in the first deck and n − k in the second deck is     (      n      k      )   /   2  n        binomial  n  k    superscript  2  n     {\textstyle\left({{n}\atop{k}}\right)}/2^{n}   . Then, one card at a time is repeatedly moved from the bottom of one of the packets to the top of the shuffled deck, such that if x cards remain in one packet and y cards remain in the other packet, then the probability of choosing a card from the first packet is x /( x + y ) and the probability of choosing a card from the second packet is y /( x + y ). 4  An alternative description can be based on a property of the model, that it generates a permutation of the initial deck in which each card is equally likely to have come from the first or the second packet. 5 To generate a random permutation according to this model, begin by flipping a fair coin  n times, to determine for each position of the shuffled deck whether it comes from the first packet or the second packet. Then split into two packets whose sizes are the number of tails and the number of heads flipped, and use the same coin flip sequence to determine from which packet to pull each card of the shuffled deck.  Another alternative description is more abstract, but lends itself better to mathematical analysis. Generate a set of n values from the uniform continuous distribution on the unit interval, and place them in sorted order. Then the doubling map     x  ↦    2  x      (   mod  1   )       maps-to  x   annotated    2  x    pmod  1      x\mapsto 2x\;\;(\mathop{{\rm mod}}1)   from the theory of dynamical systems maps this system of points to a permutation of the points in which the permuted ordering obeys the Gilbert–Shannon–Reeds model, and the positions of the new points are again uniformly random. 6 7  Among all of the possible riffle shuffle permutations of a card deck, the Gilbert–Shannon–Reeds model gives almost all riffles equal probability, 1/2 n , of occurring. However, there is one exception, the identity permutation , which has a greater probability ( n + 1)/2 n of occurring. 8 9  Inverse  The inverse permutation of a random riffle may be generated directly. To do so, start with a deck of n cards and then repeatedly deal off the bottom card of the deck onto one of two piles, choosing randomly with equal probability which of the two piles to deal each card onto. Then, when all cards have been dealt, stack the two piles back together. 10  The effect of repeated riffles  analyzed mathematically the total variation distance between two probability distributions on permutations: the uniform distribution in which all permutations are equally likely, and the distribution generated by repeated applications of the Gilbert–Shannon–Reeds model. The total variation distance measures how similar or dissimilar two probability distributions are; it is zero only when the two distributions are identical, and attains a maximum value of one for probability distributions that never generate the same values as each other. Bayer and Diaconis reported that, for decks of n cards shuffled      3  2     log  2   n    +  θ          3  2     subscript   2   n    θ    \tfrac{3}{2}\log_{2}n+\theta   times, where θ is an arbitrary constant, the total variation distance is close to one when θ is significantly less than zero, and close to zero when θ is significantly greater than zero, independently of n . In particular their calculations showed that for n = 52, five riffles produce a distribution whose total variation distance from uniform is still close to one, while seven riffles give total variation distance 0.334. This result was widely reported as implying that card decks should be riffled seven times in order to thoroughly randomize them. 11 12 13  Similar analyses have been performed using the Kullback–Leibler divergence , a distance between two probability distributions defined in terms of entropy ; the divergence of a distribution from uniform can be interpreted as the number of bits of information that can still be recovered about the initial state of the card deck. The results are qualitatively different: rather than having a sharp threshold between random and non-random at     3  2     log  2   n         3  2     subscript   2   n     \tfrac{3}{2}\log_{2}n   shuffles, as occurs for total variation distance, the divergence decays more gradually, decreasing linearly as the number of shuffles ranges from zero to     log  2   n      subscript   2   n    \log_{2}n   (at which point the number of remaining bits of information is linear, smaller by a logarithmic factor than its initial value) and then decreasing exponentially until, after     3  2     log  2   n         3  2     subscript   2   n     \tfrac{3}{2}\log_{2}n   shuffles, only a constant number of bits of information remain. 14 15  References  "  Category:Card shuffling  Category:Stochastic models     . ↩  . ↩  ↩     . ↩  This follows immediately from Theorem 1 of  together with the observation that the identity permutation has one rising sequence and all other riffle permutations have exactly two rising sequences. ↩  instead states erroneously that all permutations are likely. ↩   . ↩  . ↩  . ↩  . ↩  . ↩     
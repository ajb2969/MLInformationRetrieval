<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1739">Averaged Lagrangian</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Averaged Lagrangian</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>300 px|High-altitude <a href="wave_cloud" title="wikilink">wave cloud</a> formed over the Hampton area at <a href="Burra,_South_Australia" title="wikilink">Burra, South Australia</a> on 16 January 2007.</figcaption>
</figure>

<p>In <a href="continuum_mechanics" title="wikilink">continuum mechanics</a>, Whitham's <strong>averaged Lagrangian</strong> method – or in short <strong>Whitham's method</strong> – is used to study the <a href="Lagrangian_dynamics" title="wikilink">Lagrangian dynamics</a> of <a href="Slowly_varying_envelope_approximation" title="wikilink">slowly-varying</a> <a href="wave_train" title="wikilink">wave trains</a> in an inhomogeneous (moving) <a href="transmission_medium" title="wikilink">medium</a>. The method is applicable to both <a href="linear_system" title="wikilink">linear</a> and <a href="non-linear_system" title="wikilink">non-linear systems</a>. As a direct consequence of the averaging used in the method, <a href="wave_action_(continuum_mechanics)" title="wikilink">wave action</a> is a <a href="conservation_law" title="wikilink">conserved property</a> of the wave motion. In contrast, the wave <a class="uri" href="energy" title="wikilink">energy</a> is not necessarily conserved, due to the exchange of energy with the mean motion. However the total energy, the sum of the energies in the wave motion and the mean motion, will be conserved for a time-<a href="invariant_(physics)" title="wikilink">invariant</a> Lagrangian. Further, the averaged Lagrangian has a strong relation to the <a href="dispersion_relation" title="wikilink">dispersion relation</a> of the system.</p>

<p>The method is due to <a href="Gerald_Whitham" title="wikilink">Gerald Whitham</a>, who developed it in the 1960s. It is for instance used in the modelling of <a href="surface_gravity_wave" title="wikilink">surface gravity waves</a> on <a href="fluid_interface" title="wikilink">fluid interfaces</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and in <a href="plasma_physics" title="wikilink">plasma physics</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="resulting-equations-for-pure-wave-motion">Resulting equations for pure wave motion</h2>

<p>In case a <a href="Lagrangian_formulation_of_mechanics" title="wikilink">Lagrangian formulation</a> of a <a href="continuum_mechanics" title="wikilink">continuum mechanics</a> system is available, the averaged Lagrangian methodology can be used to find approximations for the average dynamics of wave motion – and (eventually) for the interaction between the wave motion and the mean motion – assuming the <a href="envelope_(mathematics)" title="wikilink">envelope</a> dynamics of the carrier waves is <a href="slowly_varying_envelope_approximation" title="wikilink">slowly varying</a>. Phase averaging of the Lagrangian results in an averaged Lagrangian, which is always independent of the wave phase itself (but depends on slowly varying wave quantities like wave <a class="uri" href="amplitude" title="wikilink">amplitude</a>, <a class="uri" href="frequency" title="wikilink">frequency</a> and <a class="uri" href="wavenumber" title="wikilink">wavenumber</a>). By <a href="Noether's_theorem" title="wikilink">Noether's theorem</a>, <a href="variational_principle" title="wikilink">variation</a> of the averaged Lagrangian 

<math display="inline" id="Averaged_Lagrangian:0">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℒ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℒ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

 with respect to the <a href="invariant_(physics)" title="wikilink">invariant</a> wave phase 

<math display="inline" id="Averaged_Lagrangian:1">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>θ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 then gives rise to a <a href="conservation_law" title="wikilink">conservation law</a>:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>| <mtpl><eqref>1<eqref></eqref></eqref></mtpl> }}</p>

<p>This equation states the <em>conservation of <a href="Wave_action_(continuum_mechanics)" title="wikilink">wave action</a></em> – a generalization of the concept of an <a href="adiabatic_invariant" title="wikilink">adiabatic invariant</a> to continuum mechanics – with<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:2">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒜</mi>
   <mo>≡</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>t</mi>
        </msub>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>ω</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <ci>𝒜</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ℒ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>t</ci>
         </apply>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ℒ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>ω</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}\equiv-\frac{\partial\mathcal{L}}{\partial(\partial_{t}\theta)}=+%
\frac{\partial\mathcal{L}}{\partial\omega}
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:3">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝓑</mi>
   <mo>≡</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo mathvariant="bold">∇</mo>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>𝒌</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <ci>𝓑</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ℒ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <ci>bold-∇</ci>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ℒ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝒌</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mathcal{B}}\equiv-\frac{\partial\mathcal{L}}{\partial(\boldsymbol%
{\nabla}\theta)}=-\frac{\partial\mathcal{L}}{\partial\boldsymbol{k}}
  </annotation>
 </semantics>
</math>

</p>

<p>being the wave action 

<math display="inline" id="Averaged_Lagrangian:4">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

 and wave action <a class="uri" href="flux" title="wikilink">flux</a> 

<math display="inline" id="Averaged_Lagrangian:5">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝓑</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝓑</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mathcal{B}}
  </annotation>
 </semantics>
</math>

 respectively. Further 

<math display="inline" id="Averaged_Lagrangian:6">
 <semantics>
  <mi>𝒙</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒙</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{x}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:7">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 denote space and time respectively, while 

<math display="inline" id="Averaged_Lagrangian:8">
 <semantics>
  <mo mathvariant="bold">∇</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>bold-∇</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}
  </annotation>
 </semantics>
</math>

 is the <a href="gradient_operator" title="wikilink">gradient operator</a>. The <a href="angular_frequency" title="wikilink">angular frequency</a> 

<math display="inline" id="Averaged_Lagrangian:9">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ω</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and <a class="uri" href="wavenumber" title="wikilink">wavenumber</a> 

<math display="inline" id="Averaged_Lagrangian:10">
 <semantics>
  <mrow>
   <mi>𝒌</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒌</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 are defined as<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>and both are assumed to be slowly varying. Due to this definition, 

<math display="inline" id="Averaged_Lagrangian:11">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ω</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:12">
 <semantics>
  <mrow>
   <mi>𝒌</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒌</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 have to satisfy the consistency relations:</p>

<p>The first consistency equation is known as the <strong>conservation of wave crests</strong>, and the second states that the wavenumber field 

<math display="inline" id="Averaged_Lagrangian:13">
 <semantics>
  <mrow>
   <mi>𝒌</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒌</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 is <a class="uri" href="irrotational" title="wikilink">irrotational</a> (i.e. has zero <a href="curl_(mathematics)" title="wikilink">curl</a>).</p>
<h2 id="method">Method</h2>

<p>The averaged Lagrangian approach applies to wave motion – possibly superposed on a mean motion – that can be described in a <a href="Lagrangian_formulation_of_mechanics" title="wikilink">Lagrangian formulation</a>. Using an <a class="uri" href="ansatz" title="wikilink">ansatz</a> on the form of the wave part of the motion, the <a href="Lagrangian_(field_theory)" title="wikilink">Lagrangian</a> is <a href="wave_phase" title="wikilink">phase</a> <a href="average" title="wikilink">averaged</a>. Since the Lagrangian is associated with the <a href="kinetic_energy" title="wikilink">kinetic energy</a> and <a href="potential_energy" title="wikilink">potential energy</a> of the motion, the oscillations contribute to the Lagrangian, although the mean value of the wave's oscillatory excursion is zero (or very small).</p>

<p>The resulting averaged Lagrangian contains wave characteristics like the <a class="uri" href="wavenumber" title="wikilink">wavenumber</a>, <a href="angular_frequency" title="wikilink">angular frequency</a> and <a class="uri" href="amplitude" title="wikilink">amplitude</a> (or equivalently the wave's <a href="energy_density" title="wikilink">energy density</a> or <a href="Wave_action_(continuum_mechanics)" title="wikilink">wave action</a>). But the wave phase itself is absent due to the phase averaging. Consequently, through <a href="Noether's_theorem" title="wikilink">Noether's theorem</a>, there is a <a href="conservation_law" title="wikilink">conservation law</a> called the conservation of wave action.</p>

<p>Originally the averaged Lagrangian method was developed by Whitham for slowly-varying <a href="dispersion_relation" title="wikilink">dispersive</a> wave trains.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> Several extensions have been made, e.g. to interacting wave components,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>,<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> higher-order <a href="modulation" title="wikilink">modulational</a> effects,<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> <a class="uri" href="dissipation" title="wikilink">dissipation</a> effects.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h3 id="variational-formulation">Variational formulation</h3>

<p>The averaged Lagrangian method requires the existence of a Lagrangian describing the wave motion. For instance for a <a href="field_(physics)" title="wikilink">field</a> 

<math display="inline" id="Averaged_Lagrangian:14">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

, described by a <a href="Lagrangian_density" title="wikilink">Lagrangian density</a> 

<math display="inline" id="Averaged_Lagrangian:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>t</mi>
      </msub>
      <mi>φ</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo mathvariant="bold">∇</mo>
      <mi>φ</mi>
     </mrow>
     <mo>,</mo>
     <mi>φ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>L</ci>
    <vector>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>φ</ci>
     </apply>
     <apply>
      <ci>bold-∇</ci>
      <ci>φ</ci>
     </apply>
     <ci>φ</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L\left(\partial_{t}\varphi,\boldsymbol{\nabla}\varphi,\varphi\right),
  </annotation>
 </semantics>
</math>

 the <a href="principle_of_stationary_action" title="wikilink">principle of stationary action</a> is:<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo largeop="true" rspace="4.2pt" symmetric="true">∫</mo>
       <mrow>
        <mo largeop="true" rspace="4.2pt" symmetric="true">∭</mo>
        <mrow>
         <mi>L</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mrow>
            <msub>
             <mo>∂</mo>
             <mi>t</mi>
            </msub>
            <mi>φ</mi>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>𝒙</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
           <mrow>
            <mo mathvariant="bold">∇</mo>
            <mi>φ</mi>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>𝒙</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
           <mi>φ</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>𝒙</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo rspace="4.2pt">)</mo>
         </mrow>
         <mtext>d</mtext>
         <mpadded width="+1.7pt">
          <mi>𝒙</mi>
         </mpadded>
         <mtext>d</mtext>
         <mi>t</mi>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <apply>
      <int></int>
      <apply>
       <csymbol cd="latexml">triple-integral</csymbol>
       <apply>
        <times></times>
        <ci>L</ci>
        <vector>
         <apply>
          <times></times>
          <apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <partialdiff></partialdiff>
            <ci>t</ci>
           </apply>
           <ci>φ</ci>
          </apply>
          <interval closure="open">
           <ci>𝒙</ci>
           <ci>t</ci>
          </interval>
         </apply>
         <apply>
          <times></times>
          <apply>
           <ci>bold-∇</ci>
           <ci>φ</ci>
          </apply>
          <interval closure="open">
           <ci>𝒙</ci>
           <ci>t</ci>
          </interval>
         </apply>
         <apply>
          <times></times>
          <ci>φ</ci>
          <interval closure="open">
           <ci>𝒙</ci>
           <ci>t</ci>
          </interval>
         </apply>
        </vector>
        <mtext>d</mtext>
        <ci>𝒙</ci>
        <mtext>d</mtext>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\left(\int\,\iiint\,L\left(\partial_{t}\varphi(\boldsymbol{x},t),%
\boldsymbol{\nabla}\varphi(\boldsymbol{x},t),\varphi(\boldsymbol{x},t)\right)%
\,\text{d}\boldsymbol{x}\,\text{d}t\right)=0,
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Averaged_Lagrangian:17">
 <semantics>
  <mo mathvariant="bold">∇</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>bold-∇</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}
  </annotation>
 </semantics>
</math>

 the <a href="gradient_operator" title="wikilink">gradient operator</a> and 

<math display="inline" id="Averaged_Lagrangian:18">
 <semantics>
  <msub>
   <mo>∂</mo>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <partialdiff></partialdiff>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}
  </annotation>
 </semantics>
</math>

 the <a href="time_derivative" title="wikilink">time derivative</a> operator. This action principle results in the <a href="Euler–Lagrange_equation" title="wikilink">Euler–Lagrange equation</a>:<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>t</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>L</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msub>
             <mo>∂</mo>
             <mi>t</mi>
            </msub>
            <mi>φ</mi>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mo mathvariant="bold">∇</mo>
       <mo>⋅</mo>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>L</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mo mathvariant="bold">∇</mo>
            <mi>φ</mi>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>φ</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>L</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <partialdiff></partialdiff>
           <ci>t</ci>
          </apply>
          <ci>φ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>bold-∇</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>L</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <ci>bold-∇</ci>
          <ci>φ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>φ</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\left(\frac{\partial L}{\partial\left(\partial_{t}\varphi\right)}%
\right)+\boldsymbol{\nabla}\cdot\left(\frac{\partial L}{\partial\left(%
\boldsymbol{\nabla}\varphi\right)}\right)-\frac{\partial L}{\partial\varphi}=0,
  </annotation>
 </semantics>
</math>

</p>

<p>which is the <a href="partial_differential_equation#Classification" title="wikilink">second-order partial differential equation</a> describing the dynamics of 

<math display="inline" id="Averaged_Lagrangian:20">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi.
  </annotation>
 </semantics>
</math>

 Higher-order partial differential equations require the inclusion of higher than first-order derivatives in the Lagrangian.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<dl>
<dt>Example</dt>
</dl>

<p>For example, consider a <a class="uri" href="non-dimensional" title="wikilink">non-dimensional</a> and <a class="uri" href="non-linear" title="wikilink">non-linear</a> <a href="Klein–Gordon_equation" title="wikilink">Klein–Gordon equation</a> in one space dimension 

<math display="inline" id="Averaged_Lagrangian:21">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

:<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>This Euler–Lagrange equation emerges from the Lagrangian density:<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>

<p>The small-amplitude approximation for the <a href="Sine–Gordon_equation" title="wikilink">Sine–Gordon equation</a> corresponds with the value 

<math display="inline" id="Averaged_Lagrangian:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mn>1</mn>
      <mn>24</mn>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">24</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=-\tfrac{1}{24}.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> For 

<math display="inline" id="Averaged_Lagrangian:23">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=0
  </annotation>
 </semantics>
</math>

 the <a href="linear_system" title="wikilink">system is linear</a> and the classical one-dimensional Klein–Gordon equation is obtained.</p>
<h3 id="slowly-varying-waves">Slowly-varying waves</h3>
<h4 id="slowly-varying-linear-waves">Slowly-varying linear waves</h4>

<p>Whitham developed several approaches to obtain a averaged Lagrangian method.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a><a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> The simplest one is for <a href="slowly_varying_envelope_approximation" title="wikilink">slowly-varying</a> <a href="linear_system" title="wikilink">linear</a> <a href="wavetrain" title="wikilink">wavetrains</a>, which method will be applied here.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>

<p>The slowly-varying wavetrain – without mean motion – in a linear dispersive system is described as:<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>φ</mi>
    <mo>∼</mo>
    <mrow>
     <mi mathvariant="normal">ℜ</mi>
     <mrow>
      <mo>{</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>A</mi>
       </mpadded>
       <msup>
        <mtext>e</mtext>
        <mrow>
         <mi>i</mi>
         <mi>θ</mi>
        </mrow>
       </msup>
      </mrow>
      <mo>}</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>a</mi>
     </mpadded>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>θ</mi>
        <mo>+</mo>
        <mi>α</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <ci>φ</ci>
     <apply>
      <real></real>
      <apply>
       <times></times>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <mtext>e</mtext>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <cos></cos>
       <apply>
        <plus></plus>
        <ci>θ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi\sim\Re\left\{A\,\text{e}^{i\theta}\right\}=a\,\cos\left(\theta+\alpha%
\right),
  </annotation>
 </semantics>
</math>

  with  

<math display="inline" id="Averaged_Lagrangian:25">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mrow>
    <mo>|</mo>
    <mi>A</mi>
    <mo>|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <abs></abs>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=\left|A\right|
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:26">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mo>=</mo>
    <mrow>
     <mi>arg</mi>
     <mrow>
      <mo>{</mo>
      <mi>A</mi>
      <mo>}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <arg></arg>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=\arg\left\{A\right\},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Averaged_Lagrangian:27">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is the <a href="real_number" title="wikilink">real-valued</a> <a href="wave_phase" title="wikilink">wave phase</a>, 

<math display="inline" id="Averaged_Lagrangian:28">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>A</mi>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |A|
  </annotation>
 </semantics>
</math>

 denotes the <a href="absolute_value" title="wikilink">absolute value</a> of the <a href="complex_number" title="wikilink">complex-valued</a> <a class="uri" href="amplitude" title="wikilink">amplitude</a> 

<math display="inline" id="Averaged_Lagrangian:29">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A,
  </annotation>
 </semantics>
</math>

 while 

<math display="inline" id="Averaged_Lagrangian:30">
 <semantics>
  <mrow>
   <mi>arg</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>A</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <arg></arg>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \arg\{A\}
  </annotation>
 </semantics>
</math>

 is its <a href="arg_(mathematics)" title="wikilink">argument</a> and 

<math display="inline" id="Averaged_Lagrangian:31">
 <semantics>
  <mrow>
   <mi mathvariant="normal">ℜ</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>A</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <real></real>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Re\{A\}
  </annotation>
 </semantics>
</math>

 denotes its <a href="real_part" title="wikilink">real part</a>. The real-valued amplitude and phase shift are denoted by 

<math display="inline" id="Averaged_Lagrangian:32">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:33">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 respectively.</p>

<p>Now, <em>by definition</em>, the <a href="angular_frequency" title="wikilink">angular frequency</a> 

<math display="inline" id="Averaged_Lagrangian:34">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 and <a class="uri" href="wavenumber" title="wikilink">wavenumber</a> vector 

<math display="inline" id="Averaged_Lagrangian:35">
 <semantics>
  <mi>𝒌</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}
  </annotation>
 </semantics>
</math>

 are expressed as the <a href="time_derivative" title="wikilink">time derivative</a> and <a class="uri" href="gradient" title="wikilink">gradient</a> of the wave phase 

<math display="inline" id="Averaged_Lagrangian:36">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>θ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 as:<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:37">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>≡</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mpadded width="+1.7pt">
      <mi>θ</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>ω</ci>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega\equiv-\partial_{t}\theta\,
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:38">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝒌</mi>
    <mo>≡</mo>
    <mrow>
     <mo>+</mo>
     <mrow>
      <mo mathvariant="bold">∇</mo>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>𝒌</ci>
    <apply>
     <plus></plus>
     <apply>
      <ci>bold-∇</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}\equiv+\boldsymbol{\nabla}\theta.\,
  </annotation>
 </semantics>
</math>

</p>

<p>As a consequence, 

<math display="inline" id="Averaged_Lagrangian:39">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ω</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:40">
 <semantics>
  <mrow>
   <mi>𝒌</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒌</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 have to satisfy the consistency relations:</p>

<p>

<math display="block" id="Averaged_Lagrangian:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mi>𝒌</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mi>ω</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>𝒌</ci>
     </apply>
     <apply>
      <ci>bold-∇</ci>
      <ci>ω</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\boldsymbol{k}+\boldsymbol{\nabla}\omega=\boldsymbol{0}
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:42">
 <semantics>
  <mrow>
   <mrow>
    <mo mathvariant="bold">∇</mo>
    <mo>×</mo>
    <mi>𝒌</mi>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>bold-∇</ci>
     <ci>𝒌</ci>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\times\boldsymbol{k}=\boldsymbol{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>These two consistency relations denote the "conservation of wave crests", and the <a href="irrotational" title="wikilink">irrotationality</a> of the wavenumber field.</p>

<p>Because of the assumption of slow variations in the wave train – as well as in a possible <a href="homogeneity_(physics)" title="wikilink">inhomogeneous</a> medium and mean motion – the quantities 

<math display="inline" id="Averaged_Lagrangian:43">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:44">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:45">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:46">
 <semantics>
  <mi>𝒌</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:47">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 all vary slowly in space 

<math display="inline" id="Averaged_Lagrangian:48">
 <semantics>
  <mi>𝒙</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒙</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{x}
  </annotation>
 </semantics>
</math>

 and time 

<math display="inline" id="Averaged_Lagrangian:49">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 – but the wave phase 

<math display="inline" id="Averaged_Lagrangian:50">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 itself does not vary slowly. Consequently, derivatives of 

<math display="inline" id="Averaged_Lagrangian:51">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:52">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:53">
 <semantics>
  <mi>𝒌</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:54">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 are neglected in the determination of the derivatives of 

<math display="inline" id="Averaged_Lagrangian:55">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 for use in the averaged Lagrangian:<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:56">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>t</mi>
    </msub>
    <mi>φ</mi>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>ω</mi>
     </mpadded>
     <mpadded width="+1.7pt">
      <mi>a</mi>
     </mpadded>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>θ</mi>
        <mo>+</mo>
        <mi>α</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
     <ci>φ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>ω</ci>
      <ci>a</ci>
      <apply>
       <sin></sin>
       <apply>
        <plus></plus>
        <ci>θ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\varphi\approx+\omega\,a\,\sin(\theta+\alpha)
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mi>φ</mi>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>𝒌</mi>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>a</mi>
      </mpadded>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>θ</mi>
         <mo>+</mo>
         <mi>α</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ci>bold-∇</ci>
     <ci>φ</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>𝒌</ci>
      <ci>a</ci>
      <apply>
       <sin></sin>
       <apply>
        <plus></plus>
        <ci>θ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\varphi\approx-\boldsymbol{k}\,a\,\sin(\theta+\alpha).
  </annotation>
 </semantics>
</math>

</p>

<p>Next these assumptions on 

<math display="inline" id="Averaged_Lagrangian:58">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and its derivatives are applied to the Lagrangian density 

<math display="inline" id="Averaged_Lagrangian:59">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>t</mi>
      </msub>
      <mi>φ</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo mathvariant="bold">∇</mo>
      <mi>φ</mi>
     </mrow>
     <mo>,</mo>
     <mi>φ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>L</ci>
    <vector>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>φ</ci>
     </apply>
     <apply>
      <ci>bold-∇</ci>
      <ci>φ</ci>
     </apply>
     <ci>φ</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L\left(\partial_{t}\varphi,\boldsymbol{\nabla}\varphi,\varphi\right).
  </annotation>
 </semantics>
</math>

</p>
<h4 id="slowly-varying-non-linear-waves">Slowly-varying non-linear waves</h4>

<p>Several approaches to slowly-varying <a class="uri" href="non-linear" title="wikilink">non-linear</a> wavetrains are possible. One is by the use of <a href="Stokes_expansion" title="wikilink">Stokes expansions</a>,<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a> used by Whitham to analyse slowly-varying <a href="Stokes_wave" title="wikilink">Stokes waves</a>.<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> A Stokes expansion of the field 

<math display="inline" id="Averaged_Lagrangian:60">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 can be written as:<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:61">
 <semantics>
  <mrow>
   <mrow>
    <mi>φ</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>a</mi>
      </mpadded>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>θ</mi>
         <mo>+</mo>
         <mi>α</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>a</mi>
        <mn>2</mn>
       </msub>
      </mpadded>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>θ</mi>
         </mrow>
         <mo>+</mo>
         <msub>
          <mi>α</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>a</mi>
        <mn>3</mn>
       </msub>
      </mpadded>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mn>3</mn>
          <mi>θ</mi>
         </mrow>
         <mo>+</mo>
         <msub>
          <mi>α</mi>
          <mn>3</mn>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>φ</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <cos></cos>
       <apply>
        <plus></plus>
        <ci>θ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>θ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <ci>θ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi=a\,\cos\left(\theta+\alpha\right)+a_{2}\,\cos\left(2\theta+\alpha_{2}%
\right)+a_{3}\,\cos\left(3\theta+\alpha_{3}\right)+\cdots,
  </annotation>
 </semantics>
</math>

</p>

<p>where the amplitudes 

<math display="inline" id="Averaged_Lagrangian:62">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:63">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2},
  </annotation>
 </semantics>
</math>

 etc. are slowly varying, as are the phases 

<math display="inline" id="Averaged_Lagrangian:64">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:65">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{2},
  </annotation>
 </semantics>
</math>

 etc. As for the linear wave case, in lowest order (as far as <a href="modulation" title="wikilink">modulational</a> effects are concerned) derivatives of amplitudes and phases are neglected, except for derivatives 

<math display="inline" id="Averaged_Lagrangian:66">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:67">
 <semantics>
  <mi>𝒌</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}
  </annotation>
 </semantics>
</math>

 of the fast phase 

<math display="inline" id="Averaged_Lagrangian:68">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>θ</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Averaged_Lagrangian:69">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mi>φ</mi>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mo>+</mo>
      <mrow>
       <mi>ω</mi>
       <mpadded width="+1.7pt">
        <mi>a</mi>
       </mpadded>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>θ</mi>
          <mo>+</mo>
          <mi>α</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>ω</mi>
      <mpadded width="+1.7pt">
       <msub>
        <mi>a</mi>
        <mn>2</mn>
       </msub>
      </mpadded>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>θ</mi>
         </mrow>
         <mo>+</mo>
         <msub>
          <mi>α</mi>
          <mn>2</mn>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>3</mn>
      <mi>ω</mi>
      <mpadded width="+1.7pt">
       <msub>
        <mi>a</mi>
        <mn>3</mn>
       </msub>
      </mpadded>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mn>3</mn>
          <mi>θ</mi>
         </mrow>
         <mo>+</mo>
         <msub>
          <mi>α</mi>
          <mn>3</mn>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
     <ci>φ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>ω</ci>
       <ci>a</ci>
       <apply>
        <sin></sin>
        <apply>
         <plus></plus>
         <ci>θ</ci>
         <ci>α</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>ω</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>θ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>ω</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <sin></sin>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">3</cn>
         <ci>θ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\varphi\approx+\omega a\,\sin\left(\theta+\alpha\right)+2\omega a_%
{2}\,\sin\left(2\theta+\alpha_{2}\right)+3\omega a_{3}\,\sin\left(3\theta+%
\alpha_{3}\right)+\cdots,
  </annotation>
 </semantics>
</math>

  and</p>

<p>

<math display="block" id="Averaged_Lagrangian:70">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mi>φ</mi>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>𝒌</mi>
        <mpadded width="+1.7pt">
         <mi>a</mi>
        </mpadded>
        <mrow>
         <mi>sin</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>θ</mi>
           <mo>+</mo>
           <mi>α</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <mi>𝒌</mi>
       <mpadded width="+1.7pt">
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mpadded>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mi>θ</mi>
          </mrow>
          <mo>+</mo>
          <msub>
           <mi>α</mi>
           <mn>2</mn>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>3</mn>
       <mi>𝒌</mi>
       <mpadded width="+1.7pt">
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
       </mpadded>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mn>3</mn>
           <mi>θ</mi>
          </mrow>
          <mo>+</mo>
          <msub>
           <mi>α</mi>
           <mn>3</mn>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ci>bold-∇</ci>
     <ci>φ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>𝒌</ci>
        <ci>a</ci>
        <apply>
         <sin></sin>
         <apply>
          <plus></plus>
          <ci>θ</ci>
          <ci>α</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>𝒌</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>θ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>α</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>𝒌</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <sin></sin>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <ci>θ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>α</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\varphi\approx-\boldsymbol{k}a\,\sin\left(\theta+\alpha%
\right)-2\boldsymbol{k}a_{2}\,\sin\left(2\theta+\alpha_{2}\right)-3\boldsymbol%
{k}a_{3}\,\sin\left(3\theta+\alpha_{3}\right)+\cdots.
  </annotation>
 </semantics>
</math>

</p>

<p>These approximations are to be applied in the Lagrangian density 

<math display="inline" id="Averaged_Lagrangian:71">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

, and its phase average 

<math display="inline" id="Averaged_Lagrangian:72">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>L</mi>
    <mo>¯</mo>
   </mover>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{L}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="averaged-lagrangian-for-slowly-varying-waves">Averaged Lagrangian for slowly-varying waves</h3>

<p>For pure wave motion the Lagrangian 

<math display="inline" id="Averaged_Lagrangian:73">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mi>φ</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mi>φ</mi>
    </mrow>
    <mo>,</mo>
    <mi>φ</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>L</ci>
    <vector>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>φ</ci>
     </apply>
     <apply>
      <ci>bold-∇</ci>
      <ci>φ</ci>
     </apply>
     <ci>φ</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L\left(\partial_{t}\varphi,\boldsymbol{\nabla}\varphi,\varphi\right)
  </annotation>
 </semantics>
</math>

 is expressed in terms of the field 

<math display="inline" id="Averaged_Lagrangian:74">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 and its derivatives.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a><a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> In the averaged Lagrangian method, the above-given assumptions on the field 

<math display="inline" id="Averaged_Lagrangian:75">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝒙</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <interval closure="open">
     <ci>𝒙</ci>
     <ci>t</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(\boldsymbol{x},t)
  </annotation>
 </semantics>
</math>

 – and its derivatives – are applied to calculate the Lagrangian. The Lagrangian is thereafter averaged over the wave phase 

<math display="inline" id="Averaged_Lagrangian:76">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>θ</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta:
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:77">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>L</mi>
     <mo>¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
     </mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
      </msubsup>
      <mrow>
       <mi>L</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mo>∂</mo>
          <mi>t</mi>
         </msub>
         <mi>φ</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mo mathvariant="bold">∇</mo>
         <mi>φ</mi>
        </mrow>
        <mo>,</mo>
        <mi>φ</mi>
        <mo rspace="5.3pt">)</mo>
       </mrow>
       <mtext>d</mtext>
       <mi>θ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>L</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>L</ci>
       <vector>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>t</ci>
         </apply>
         <ci>φ</ci>
        </apply>
        <apply>
         <ci>bold-∇</ci>
         <ci>φ</ci>
        </apply>
        <ci>φ</ci>
       </vector>
       <mtext>d</mtext>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{L}=\frac{1}{2\pi}\int_{0}^{2\pi}L\left(\partial_{t}\varphi,%
\boldsymbol{\nabla}\varphi,\varphi\right)\;\text{d}\theta.
  </annotation>
 </semantics>
</math>

</p>

<p>As a last step, this averaging result 

<math display="inline" id="Averaged_Lagrangian:78">
 <semantics>
  <mover accent="true">
   <mi>L</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{L}
  </annotation>
 </semantics>
</math>

 can be expressed as the <em>averaged Lagrangian</em> density 

<math display="inline" id="Averaged_Lagrangian:79">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ω</mi>
    <mo>,</mo>
    <mi>𝒌</mi>
    <mo>,</mo>
    <mi>a</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℒ</ci>
    <vector>
     <ci>ω</ci>
     <ci>𝒌</ci>
     <ci>a</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(\omega,\boldsymbol{k},a)
  </annotation>
 </semantics>
</math>

 – which is a function of the slowly varying parameters 

<math display="inline" id="Averaged_Lagrangian:80">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:81">
 <semantics>
  <mi>𝒌</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:82">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and independent of the wave phase 

<math display="inline" id="Averaged_Lagrangian:83">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 itself.<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a></p>

<p>The averaged Lagrangian density 

<math display="inline" id="Averaged_Lagrangian:84">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℒ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℒ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

 is now proposed by Whitham to follow the average <a href="variational_principle" title="wikilink">variational principle</a>:<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a></p>

<p>From the variations of 

<math display="inline" id="Averaged_Lagrangian:85">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℒ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℒ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

 follow the dynamical equations for the slowly-varying wave properties.</p>
<dl>
<dt>Example</dt>
</dl>

<p>Continuing on the example of the nonlinear Klein–Gordon equation, see equations  and , and applying the above approximations for 

<math display="inline" id="Averaged_Lagrangian:86">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Averaged_Lagrangian:87">
 <semantics>
  <mrow>
   <msub>
    <mo>∂</mo>
    <mi>t</mi>
   </msub>
   <mi>φ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <partialdiff></partialdiff>
     <ci>t</ci>
    </apply>
    <ci>φ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\varphi
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:88">
 <semantics>
  <mrow>
   <msub>
    <mo>∂</mo>
    <mi>x</mi>
   </msub>
   <mi>φ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <partialdiff></partialdiff>
     <ci>x</ci>
    </apply>
    <ci>φ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{x}\varphi
  </annotation>
 </semantics>
</math>

 (for this 1D example) in the Lagrangian density, the result after averaging over 

<math display="inline" id="Averaged_Lagrangian:89">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is:</p>

<p>

<math display="block" id="Averaged_Lagrangian:90">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>L</mi>
     <mo>¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mn>4</mn>
        </mfrac>
       </mstyle>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>ω</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>k</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>a</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>3</mn>
         <mn>32</mn>
        </mfrac>
       </mstyle>
       <mi>σ</mi>
       <msup>
        <mi>a</mi>
        <mn>4</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>ω</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>k</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>4</mn>
         </mfrac>
        </mstyle>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi>a</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒪</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>a</mi>
        <mn>6</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>L</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">3</cn>
        <cn type="integer">32</cn>
       </apply>
       <ci>σ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ω</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝒪</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">6</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{L}=\tfrac{1}{4}(\omega^{2}-k^{2}-1)a^{2}-\tfrac{3}{32}\sigma a^{4}+(%
\omega^{2}-k^{2}-\tfrac{1}{4})a_{2}^{2}+\mathcal{O}(a^{6}),
  </annotation>
 </semantics>
</math>

 where it has been assumed that, in <a href="big-O_notation" title="wikilink">big-O notation</a>, 

<math display="inline" id="Averaged_Lagrangian:91">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒪</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>𝒪</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2}=\mathcal{O}(a^{2})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:92">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒪</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>a</mi>
      <mn>3</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <times></times>
     <ci>𝒪</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{3}=\mathcal{O}(a^{3})
  </annotation>
 </semantics>
</math>

. Variation of 

<math display="inline" id="Averaged_Lagrangian:93">
 <semantics>
  <mover accent="true">
   <mi>L</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{L}
  </annotation>
 </semantics>
</math>

 with respect to 

<math display="inline" id="Averaged_Lagrangian:94">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2}
  </annotation>
 </semantics>
</math>

 leads to 

<math display="inline" id="Averaged_Lagrangian:95">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2}=0.
  </annotation>
 </semantics>
</math>

 So the averaged Lagrangian is:</p>

<p>For linear wave motion the averaged Lagrangian is obtained by setting 

<math display="inline" id="Averaged_Lagrangian:96">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

 equal to zero.</p>
<h3 id="set-of-equations-emerging-from-the-averaged-lagrangian">Set of equations emerging from the averaged Lagrangian</h3>

<p>Applying the averaged Lagrangian principle, variation with respect to the wave phase 

<math display="inline" id="Averaged_Lagrangian:97">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 leads to the conservation of wave action:</p>

<p>

<math display="block" id="Averaged_Lagrangian:98">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>t</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi class="ltx_font_mathcaligraphic">ℒ</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>ω</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo mathvariant="bold">∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi class="ltx_font_mathcaligraphic">ℒ</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>𝒌</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ℒ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>ω</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>bold-∇</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ℒ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝒌</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\left(+\frac{\partial\mathcal{L}}{\partial\omega}\right)+%
\boldsymbol{\nabla}\cdot\left(-\frac{\partial\mathcal{L}}{\partial\boldsymbol{%
k}}\right)=0,
  </annotation>
 </semantics>
</math>

</p>

<p>since 

<math display="inline" id="Averaged_Lagrangian:99">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mi>θ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=-\partial_{t}\theta
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:100">
 <semantics>
  <mrow>
   <mi>𝒌</mi>
   <mo>=</mo>
   <mrow>
    <mo mathvariant="bold">∇</mo>
    <mi>θ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒌</ci>
    <apply>
     <ci>bold-∇</ci>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}=\boldsymbol{\nabla}\theta
  </annotation>
 </semantics>
</math>

 while the wave phase 

<math display="inline" id="Averaged_Lagrangian:101">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 does not appear in the averaged Lagrangian density 

<math display="inline" id="Averaged_Lagrangian:102">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℒ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℒ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

 due to the phase averaging. Defining the wave action as 

<math display="inline" id="Averaged_Lagrangian:103">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒜</mi>
   <mo>≡</mo>
   <mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>∂</mo>
      <mi>ω</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>𝒜</ci>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>ℒ</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}\equiv+\partial\mathcal{L}/\partial\omega
  </annotation>
 </semantics>
</math>


 and the wave action flux as 

<math display="inline" id="Averaged_Lagrangian:104">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝓑</mi>
   <mo>≡</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>∂</mo>
      <mi>𝒌</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>𝓑</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>ℒ</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>𝒌</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mathcal{B}}\equiv-\partial\mathcal{L}/\partial\boldsymbol{k}
  </annotation>
 </semantics>
</math>

 the result is:</p>

<p>

<math display="block" id="Averaged_Lagrangian:105">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mi class="ltx_font_mathcaligraphic">𝒜</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mo>⋅</mo>
     <mi class="ltx_font_mathcaligraphic">𝓑</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>𝒜</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>bold-∇</ci>
      <ci>𝓑</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\mathcal{A}+\boldsymbol{\nabla}\cdot\boldsymbol{\mathcal{B}}=0.
  </annotation>
 </semantics>
</math>

</p>

<p>The wave action equation is accompanied with the consistency equations for 

<math display="inline" id="Averaged_Lagrangian:106">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:107">
 <semantics>
  <mi>𝒌</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒌</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{k}
  </annotation>
 </semantics>
</math>

 which are:</p>

<p>

<math display="block" id="Averaged_Lagrangian:108">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>∂</mo>
      <mi>t</mi>
     </msub>
     <mi>𝒌</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mi>ω</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <ci>𝒌</ci>
     </apply>
     <apply>
      <ci>bold-∇</ci>
      <ci>ω</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\boldsymbol{k}+\boldsymbol{\nabla}\omega=\boldsymbol{0}
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:109">
 <semantics>
  <mrow>
   <mrow>
    <mo mathvariant="bold">∇</mo>
    <mo>×</mo>
    <mi>𝒌</mi>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>bold-∇</ci>
     <ci>𝒌</ci>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\times\boldsymbol{k}=\boldsymbol{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Variation with respect to the amplitude 

<math display="inline" id="Averaged_Lagrangian:110">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 leads to the <a href="dispersion_relation" title="wikilink">dispersion relation</a> 

<math display="inline" id="Averaged_Lagrangian:111">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∂</mo>
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo>∂</mo>
     <mi>a</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>ℒ</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>a</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial\mathcal{L}/\partial a=0.
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dt>Example</dt>
</dl>

<p>Continuing with the nonlinear Klein–Gordon equation, using the average variational principle on equation , the wave action equation becomes by variation with respect to the wave phase 

<math display="inline" id="Averaged_Lagrangian:112">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>θ</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Averaged_Lagrangian:113">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>t</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
        <mi>ω</mi>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mo>∂</mo>
       <mi>x</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
        <mi>k</mi>
        <msup>
         <mi>a</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>ω</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}\left(\tfrac{1}{2}\omega a^{2}\right)+\partial_{x}\left(\tfrac{1}{%
2}ka^{2}\right)=0,
  </annotation>
 </semantics>
</math>

</p>

<p>and the nonlinear dispersion relation follows from variation with respect to the amplitude 

<math display="inline" id="Averaged_Lagrangian:114">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>a</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Averaged_Lagrangian:115">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>ω</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>k</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>3</mn>
        <mn>4</mn>
       </mfrac>
      </mstyle>
      <mi>σ</mi>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ω</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">4</cn>
      </apply>
      <ci>σ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega^{2}=k^{2}+1+\tfrac{3}{4}\sigma a^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>So the wave action is 

<math display="inline" id="Averaged_Lagrangian:116">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒜</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>ω</mi>
    <msup>
     <mi>a</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒜</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>ω</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}=\tfrac{1}{2}\omega a^{2}
  </annotation>
 </semantics>
</math>

 and the wave action flux 

<math display="inline" id="Averaged_Lagrangian:117">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℬ</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>k</mi>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℬ</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{B}=\tfrac{1}{2}ka^{2}.
  </annotation>
 </semantics>
</math>

 The <a href="group_velocity" title="wikilink">group velocity</a> 

<math display="inline" id="Averaged_Lagrangian:118">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>g</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{g}
  </annotation>
 </semantics>
</math>


 is 

<math display="inline" id="Averaged_Lagrangian:119">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>v</mi>
     <mi>g</mi>
    </msub>
    <mo>≡</mo>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℬ</mi>
     <mo>/</mo>
     <mi class="ltx_font_mathcaligraphic">𝒜</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>k</mi>
     <mo>/</mo>
     <mi>ω</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>g</ci>
     </apply>
     <apply>
      <divide></divide>
      <ci>ℬ</ci>
      <ci>𝒜</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <ci>k</ci>
      <ci>ω</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{g}\equiv\mathcal{B}/\mathcal{A}=k/\omega.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="mean-motion-and-pseudo-phase">Mean motion and pseudo-phase</h3>
<h2 id="conservation-of-wave-action">Conservation of wave action</h2>

<p>The averaged Lagrangian is obtained by integration of the Lagrangian over the <a href="wave_phase" title="wikilink">wave phase</a>. As a result, the averaged Lagrangian only contains the <a href="derivative" title="wikilink">derivatives</a> of the wave phase 

<math display="inline" id="Averaged_Lagrangian:120">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 (these derivatives being, by definition, the angular frequency and wavenumber) and does not depend on the wave phase itself. So the solutions will be independent of the choice of the <a href="origin_(mathematics)" title="wikilink">zero level</a> for the wave phase. Consequently – by <a href="Noether's_theorem" title="wikilink">Noether's theorem</a> – <a href="calculus_of_variations" title="wikilink">variation</a> of the averaged Lagrangian 

<math display="inline" id="Averaged_Lagrangian:121">
 <semantics>
  <mover accent="true">
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>ℒ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\mathcal{L}}
  </annotation>
 </semantics>
</math>

 with respect to the wave phase results in a <a href="conservation_law" title="wikilink">conservation law</a>:</p>

<p>= 0, }}</p>

<p>where</p>

<p>

<math display="block" id="Averaged_Lagrangian:122">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒜</mi>
   <mo>≡</mo>
   <mfrac>
    <mrow>
     <mi>δ</mi>
     <mover accent="true">
      <mi class="ltx_font_mathcaligraphic">ℒ</mi>
      <mo>¯</mo>
     </mover>
    </mrow>
    <mrow>
     <mi>δ</mi>
     <mi>ω</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mi>δ</mi>
      <mover accent="true">
       <mi class="ltx_font_mathcaligraphic">ℒ</mi>
       <mo>¯</mo>
      </mover>
     </mrow>
     <mrow>
      <mi>δ</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>t</mi>
        </msub>
        <mi>θ</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <ci>𝒜</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>δ</ci>
       <apply>
        <ci>normal-¯</ci>
        <ci>ℒ</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>δ</ci>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>ℒ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>t</ci>
         </apply>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathcal{A}\equiv\frac{\delta\overline{\mathcal{L}}}{\delta\omega%
}=-\frac{\delta\overline{\mathcal{L}}}{\delta\left(\partial_{t}\theta\right)}
  </annotation>
 </semantics>
</math>

  and  

<math display="inline" id="Averaged_Lagrangian:123">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝓑</mi>
    <mo>≡</mo>
    <mrow>
     <mo>-</mo>
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mi>δ</mi>
        <mover accent="true">
         <mi class="ltx_font_mathcaligraphic">ℒ</mi>
         <mo>¯</mo>
        </mover>
       </mrow>
       <mrow>
        <mi>δ</mi>
        <mi>𝒌</mi>
       </mrow>
      </mfrac>
     </mstyle>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mi>δ</mi>
        <mover accent="true">
         <mi class="ltx_font_mathcaligraphic">ℒ</mi>
         <mo>¯</mo>
        </mover>
       </mrow>
       <mrow>
        <mi>δ</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo mathvariant="bold">∇</mo>
          <mi>θ</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mstyle>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <ci>𝓑</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>ℒ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>δ</ci>
        <ci>𝒌</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <ci>normal-¯</ci>
         <ci>ℒ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>δ</ci>
        <apply>
         <ci>bold-∇</ci>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\boldsymbol{\mathcal{B}}\equiv-\frac{\delta\overline{\mathcal{L}}%
}{\delta\boldsymbol{k}}=-\frac{\delta\overline{\mathcal{L}}}{\delta\left(%
\boldsymbol{\nabla}\theta\right)},
  </annotation>
 </semantics>
</math>


</p>

<p>with 

<math display="inline" id="Averaged_Lagrangian:124">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

 the <a href="wave_action_(continuum_mechanics)" title="wikilink">wave action</a> and 

<math display="inline" id="Averaged_Lagrangian:125">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝓑</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝓑</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mathcal{B}}
  </annotation>
 </semantics>
</math>

 the wave action <a class="uri" href="flux" title="wikilink">flux</a>. Further 

<math display="inline" id="Averaged_Lagrangian:126">
 <semantics>
  <msub>
   <mo>∂</mo>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <partialdiff></partialdiff>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}
  </annotation>
 </semantics>
</math>

 denotes the <a href="partial_derivative" title="wikilink">partial derivative</a> with respect to time, and 

<math display="inline" id="Averaged_Lagrangian:127">
 <semantics>
  <mo mathvariant="bold">∇</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>bold-∇</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="gradient" title="wikilink">gradient</a> operator. By definition, the <a href="group_velocity" title="wikilink">group velocity</a> 

<math display="inline" id="Averaged_Lagrangian:128">
 <semantics>
  <msub>
   <mi>𝒗</mi>
   <mi>g</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝒗</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{v}_{g}
  </annotation>
 </semantics>
</math>


 is given by:</p>

<p>

<math display="block" id="Averaged_Lagrangian:129">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝓑</mi>
    <mo>≡</mo>
    <mrow>
     <msub>
      <mi>𝒗</mi>
      <mi>g</mi>
     </msub>
     <mi class="ltx_font_mathcaligraphic">𝒜</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>𝓑</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒗</ci>
      <ci>g</ci>
     </apply>
     <ci>𝒜</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\mathcal{B}}\equiv\boldsymbol{v}_{g}\mathcal{A}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Note that in general the energy of the wave motion does not need to be conserved, since there can be an energy exchange with a mean flow. The total energy – the sum of the energies of the wave motion and the mean flow – is conserved (when there is no work by external forces and no <a href="energy_dissipation" title="wikilink">energy dissipation</a> by <a class="uri" href="viscosity" title="wikilink">viscosity</a>).</p>

<p>Conservation of wave action is also found by applying the <a href="generalized_Lagrangian_mean" title="wikilink">generalized Lagrangian mean</a> (GLM) method to the equations of the combined flow of waves and mean motion, using <a href="Newtonian_mechanics" title="wikilink">Newtonian mechanics</a> instead of a variational approach.<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a></p>
<h2 id="conservation-of-energy-and-momentum">Conservation of energy and momentum</h2>
<h2 id="connection-to-the-dispersion-relation">Connection to the dispersion relation</h2>

<p>Pure wave motion by linear models always leads to an averaged Lagrangian density of the form:<a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:130">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mo>=</mo>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ω</mi>
      <mo>,</mo>
      <mi>𝒌</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>a</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℒ</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <interval closure="open">
      <ci>ω</ci>
      <ci>𝒌</ci>
     </interval>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=G(\omega,\boldsymbol{k})a^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Consequently, the variation with respect to amplitude

<math display="block" id="Averaged_Lagrangian:131">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∂</mo>
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo>∂</mo>
     <mi>a</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>ℒ</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>a</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial\mathcal{L}/\partial a=0
  </annotation>
 </semantics>
</math>

 gives</p>

<p>

<math display="block" id="Averaged_Lagrangian:132">
 <semantics>
  <mrow>
   <mrow>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ω</mi>
     <mo>,</mo>
     <mi>𝒌</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <interval closure="open">
      <ci>ω</ci>
      <ci>𝒌</ci>
     </interval>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\omega,\boldsymbol{k})=0.
  </annotation>
 </semantics>
</math>

</p>

<p>So this turns out to be the dispersion relation for the linear waves, and the averaged Lagrangian for linear waves is always the dispersion function 

<math display="inline" id="Averaged_Lagrangian:133">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ω</mi>
    <mo>,</mo>
    <mi>𝒌</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <ci>ω</ci>
     <ci>𝒌</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\omega,\boldsymbol{k})
  </annotation>
 </semantics>
</math>


 times the amplitude squared.</p>

<p>More generally, for weakly nonlinear and slowly modulated waves propagating in one space dimension and including higher-order dispersion effects – not neglecting the time and space derivatives 

<math display="inline" id="Averaged_Lagrangian:134">
 <semantics>
  <mrow>
   <msub>
    <mo>∂</mo>
    <mi>t</mi>
   </msub>
   <mi>a</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <partialdiff></partialdiff>
     <ci>t</ci>
    </apply>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{t}a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:135">
 <semantics>
  <mrow>
   <msub>
    <mo>∂</mo>
    <mi>x</mi>
   </msub>
   <mi>a</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <partialdiff></partialdiff>
     <ci>x</ci>
    </apply>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{x}a
  </annotation>
 </semantics>
</math>

 of the amplitude 

<math display="inline" id="Averaged_Lagrangian:136">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>μ</mi>
     <mi>x</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>μ</mi>
     <mi>t</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>a</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>μ</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>μ</ci>
      <ci>t</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a(\mu x,\mu t)
  </annotation>
 </semantics>
</math>

 when taking derivatives, where 

<math display="inline" id="Averaged_Lagrangian:137">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>≪</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <ci>μ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu\ll 1
  </annotation>
 </semantics>
</math>

 is a small modulation parameter – the averaged Lagrangian density is of the form:<a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a></p>

<p>

<math display="block" id="Averaged_Lagrangian:138">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>G</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ω</mi>
       <mo>,</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>a</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>G</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ω</mi>
       <mo>,</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>a</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msup>
       <mi>μ</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>G</mi>
          <mrow>
           <mi>ω</mi>
           <mi>ω</mi>
          </mrow>
         </msub>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mo>∂</mo>
             <mi>T</mi>
            </msub>
            <mi>a</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <msub>
          <mi>G</mi>
          <mrow>
           <mi>ω</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mo>∂</mo>
            <mi>T</mi>
           </msub>
           <mi>a</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mo>∂</mo>
            <mi>X</mi>
           </msub>
           <mi>a</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>G</mi>
          <mrow>
           <mi>k</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mo>∂</mo>
             <mi>X</mi>
            </msub>
            <mi>a</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℒ</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>G</ci>
      <interval closure="open">
       <ci>ω</ci>
       <ci>k</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>G</ci>
       <cn type="integer">2</cn>
      </apply>
      <interval closure="open">
       <ci>ω</ci>
       <ci>k</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>μ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <apply>
          <times></times>
          <ci>ω</ci>
          <ci>ω</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <partialdiff></partialdiff>
           <ci>T</ci>
          </apply>
          <ci>a</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <apply>
          <times></times>
          <ci>ω</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>T</ci>
         </apply>
         <ci>a</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <partialdiff></partialdiff>
          <ci>X</ci>
         </apply>
         <ci>a</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <partialdiff></partialdiff>
           <ci>X</ci>
          </apply>
          <ci>a</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=G(\omega,k)a^{2}+G_{2}(\omega,k)a^{4}+\tfrac{1}{2}\mu^{2}\left(G_{%
\omega\omega}(\partial_{T}a)^{2}+2G_{\omega k}(\partial_{T}a)(\partial_{X}a)+G%
_{kk}(\partial_{X}a)^{2}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>with the <a href="multiple_scale_analysis" title="wikilink">slow variables</a> 

<math display="inline" id="Averaged_Lagrangian:139">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mi>μ</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <times></times>
     <ci>μ</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\mu x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Averaged_Lagrangian:140">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mo>=</mo>
    <mrow>
     <mi>μ</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>μ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\mu t.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="references">References</h2>
<h3 id="notes">Notes</h3>
<h3 id="publications-by-whitham-on-the-method">Publications by Whitham on the method</h3>

<p><em>An overview can be found in the book:</em></p>
<ul>
<li></li>
</ul>

<p><em>Some publications by Whitham on the method are:</em></p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h3 id="further-reading">Further reading</h3>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Continuum_mechanics" title="wikilink">Category:Continuum mechanics</a> <a href="Category:Lagrangian_mechanics" title="wikilink">Category:Lagrangian mechanics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"></li>
<li id="fn30"></li>
<li id="fn31"></li>
<li id="fn32"></li>
<li id="fn33"></li>
<li id="fn34"></li>
<li id="fn35"><a href="#fnref35">↩</a></li>
<li id="fn36"></li>
<li id="fn37"><a href="#fnref37">↩</a></li>
</ol>
</section>
</body>
</html>

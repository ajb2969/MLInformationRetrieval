   Integration by substitution      Integration by substitution   In calculus , integration by substitution , also known as u-substitution , is a method for finding integrals . Using the fundamental theorem of calculus often requires finding an antiderivative. For this and other reasons, integration by substitution is an important tool in mathematics. It is the counterpart to the chain rule of differentiation .  Substitution for single variable  Relation to the fundamental theorem of calculus  Let    I  âŠ†  â„      I  normal-âŠ†  normal-â„    IâŠ†â„   be an interval and    Ï†  :    a  a   ,   b  â†’  I       normal-:  Ï†     a  a     b  normal-â†’  I      Ï†:aa,bâ†’I   be a continuously differentiable function. Suppose that     :   I  â†’  â„      normal-:  absent    I  normal-â†’  normal-â„     :Iâ†’â„   is a continuous function . Then         âˆ«   Ï†   (  a  )     Ï†   (  b  )      f   (  x  )   d  x    =    âˆ«  a  b    f   (   Ï†   (  t  )    )    Ï†  â€²    (  t  )   d  t     .        superscript   subscript     Ï†  a      Ï†  b      f  x  d  x      superscript   subscript   a   b     f    Ï†  t    superscript  Ï†  normal-â€²   t  d  t      \int_{\varphi(a)}^{\varphi(b)}f(x)\,dx=\int_{a}^{b}f(\varphi(t))\varphi^{%
 \prime}(t)\,dt.     In other notation: the substitution    x  =   Ï†   (  t  )        x    Ï†  t     x=Ï†(t)   yields      d  x    d  t    =   Ï†  â€²   (  t  )            d  x     d  t      Ï†  normal-â€²  t     \frac{dx}{dt}=Ï†â€²(t)   and thus, formally,     d  x   =   Ï†  â€²   (  t  )   d  t         d  x     Ï†  normal-â€²  t  d  t     dx=Ï†â€²(t)dt   , which is the required substitution for    d  x      d  x    dx   . (One could view the method of integration by substitution as a major justification of Leibniz's notation for integrals and derivatives.)  The formula is used to transform one integral into another integral that is easier to compute. Thus, the formula can be used from left to right or from right to left in order to simplify a given integral. When used in the latter manner, it is sometimes known as u-substitution or w-substitution .  Integration by substitution can be derived from the fundamental theorem of calculus as follows. Let   Æ’   Æ’   Æ’   and   Ï†   Ï†   Ï†   be two functions satisfying the above hypothesis that   Æ’   Æ’   Æ’   is continuous on   I   I   I   and    Ï†  â€²      Ï†  normal-â€²    Ï†â€²   is continuous on the closed interval     a  a   ,  b       a  a   b    aa,b   . Then the function    Æ’   (   Ï†   (  t  )    )   Ï†  â€²   (  t  )       Æ’    Ï†  t   Ï†  normal-â€²  t    Æ’(Ï†(t))Ï†â€²(t)   is also continuous on     a  a   ,  b       a  a   b    aa,b   . Hence the integrals       âˆ«   Ï†   (  a  )     Ï†   (  b  )      f   (  x  )   d  x       superscript   subscript     Ï†  a      Ï†  b      f  x  d  x     \int_{\varphi(a)}^{\varphi(b)}f(x)\,dx     and       âˆ«  a  b    f   (   Ï†   (  t  )    )    Ï†  â€²    (  t  )   d  t       superscript   subscript   a   b     f    Ï†  t    superscript  Ï†  normal-â€²   t  d  t     \int_{a}^{b}f(\varphi(t))\varphi^{\prime}(t)\,dt     in fact exist, and it remains to show that they are equal.  Since   Æ’   Æ’   Æ’   is continuous, it has an antiderivative    F   F   F   . The composite function     F  âˆ˜  Ï†      F  normal-âˆ˜  Ï†    Fâˆ˜Ï†   is then defined. Since   F   F   F   and   Ï†   Ï†   Ï†   are differentiable, the chain rule gives          (   F  âˆ˜  Ï†   )   â€²    (  t  )    =    F  â€²    (   Ï†   (  t  )    )    Ï†  â€²    (  t  )    =   f   (   Ï†   (  t  )    )    Ï†  â€²    (  t  )     .           superscript    F  Ï†   normal-â€²   t      superscript  F  normal-â€²     Ï†  t    superscript  Ï†  normal-â€²   t          f    Ï†  t    superscript  Ï†  normal-â€²   t      (F\circ\varphi)^{\prime}(t)=F^{\prime}(\varphi(t))\varphi^{\prime}(t)=f(%
 \varphi(t))\varphi^{\prime}(t).     Applying the fundamental theorem of calculus twice gives        âˆ«  a  b     f   (   Ï†   (  t  )    )    Ï†  â€²    (  t  )   d  t       superscript   subscript   a   b     f    Ï†  t    superscript  Ï†  normal-â€²   t  d  t     \displaystyle\int_{a}^{b}f(\varphi(t))\varphi^{\prime}(t)\,dt     which is the substitution rule.  Examples  Consider the integral       âˆ«  0  2    x   cos   (    x  2   +  1   )    d  x       superscript   subscript   0   2     x       superscript  x  2   1    d  x     \int_{0}^{2}x\cos(x^{2}+1)\,dx     If we apply the formula from right to left and make the substitution u = ( x ) = x 2 + 1, we obtain du = 2 x  dx and hence; x  dx = Â½ du  (1) Definite integral       âˆ«   x  =  0    x  =  2      x   cos   (    x  2   +  1   )    d  x       superscript   subscript     x  0      x  2      x       superscript  x  2   1    d  x     \displaystyle\int_{x=0}^{x=2}x\cos(x^{2}+1)\,dx     It is important to note that since the lower limit x = 0 was replaced with u = 0 2 + 1 = 1, and the upper limit x = 2 replaced with u = 2 2 + 1 = 5, a transformation back into terms of x was unnecessary.  For the integral       âˆ«  0  1       1  -   x  2      d  x       superscript   subscript   0   1         1   superscript  x  2     d  x     \int_{0}^{1}\sqrt{1-x^{2}}\;dx     the formula needs to be used from left to right: the substitution x = sin( u ), dx = cos( u ) du is useful, because      (   1  -    sin  2    (  u  )     )    =   cos   (  u  )            1    superscript   2   u       u     \sqrt{(1-\sin^{2}(u))}=\cos(u)   :        âˆ«  0  1       1  -   x  2      d  x    =    âˆ«  0   Ï€  2       1  -    sin  2    (  u  )       cos   (  u  )    d  u    =    âˆ«  0   Ï€  2       cos  2    (  u  )    d  u    =   Ï€  4           superscript   subscript   0   1         1   superscript  x  2     d  x      superscript   subscript   0     Ï€  2          1    superscript   2   u       u   d  u           superscript   subscript   0     Ï€  2        superscript   2   u   d  u           Ï€  4      \int_{0}^{1}\sqrt{1-x^{2}}\;dx=\int_{0}^{\frac{\pi}{2}}\sqrt{1-\sin^{2}(u)}%
 \cos(u)\;du=\int_{0}^{\frac{\pi}{2}}\cos^{2}(u)\;du=\frac{\pi}{4}     The resulting integral can be computed using integration by parts or a double angle formula followed by one more substitution. One can also note that the function being integrated is the upper right quarter of a circle with a radius of one, and hence integrating the upper right quarter from zero to one is the geometric equivalent to the area of one quarter of the unit circle, or Ï€/4.  (2) Antiderivatives  Substitution can be used to determine antiderivatives . One chooses a relation between x and u , determines the corresponding relation between dx and du by differentiating, and performs the substitutions. An antiderivative for the substituted function can hopefully be determined; the original substitution between u and x is then undone.  Similar to our first example above, we can determine the following antiderivative with this method:        âˆ«   x   cos   (    x  2   +  1   )    d  x     =     1  2      âˆ«   2  x   cos   (    x  2   +  1   )    d  x              x       superscript  x  2   1    d  x        1  2       2  x       superscript  x  2   1    d  x       \displaystyle{}\quad\int x\cos(x^{2}+1)\,dx=\frac{1}{2}\int 2x\cos(x^{2}+1)\,dx     where C is an arbitrary constant of integration .  Note that there were no integral boundaries to transform, but in the last step we had to revert the original substitution u = x 2 +Â 1.  Substitution for multiple variables  One may also use substitution when integrating functions of several variables. Here the substitution function ( v 1 ,..., v n ) = Ï† ( u 1 ,Â ..., u n ) needs to be injective and continuously differentiable, and the differentials transform as       d   v  1   â‹¯  d   v  n    =    |   det    (   D  Ï†   )    (   u  1   ,  â€¦  ,   u  n   )     |   d   u  1   â‹¯  d   u  n          d   subscript  v  1   normal-â‹¯  d   subscript  v  n             normal-D  Ï†     subscript  u  1   normal-â€¦   subscript  u  n       d   subscript  u  1   normal-â‹¯  d   subscript  u  n      dv_{1}\cdots dv_{n}=|\det(\operatorname{D}\varphi)(u_{1},\ldots,u_{n})|\,du_{1%
 }\cdots du_{n}     where det(D Ï† )( u 1 ,Â ..., u n ) denotes the determinant of the Jacobian matrix containing the partial derivatives of Ï† . This formula expresses the fact that the absolute value of the determinant of a matrix equals the volume of the parallelotope spanned by its columns or rows.  More precisely, the change of variables formula is stated in the next theorem:  Theorem . Let U be an open set in R n and Ï† : U â†’ R n an injective differentiable function with continuous partial derivatives, the Jacobian of which is nonzero for every x in U . Then for any real-valued, compactly supported, continuous function f , with support contained in Ï† ( U ),         âˆ«   Ï†   (  U  )      f   (  ğ¯  )   d  ğ¯    =    âˆ«  U    f   (   Ï†   (  ğ®  )    )    |   det    (   D  Ï†   )    (  ğ®  )     |   d  ğ®     .        subscript     Ï†  U      f  ğ¯  d  ğ¯      subscript   U     f    Ï†  ğ®          normal-D  Ï†   ğ®     d  ğ®      \int_{\varphi(U)}f(\mathbf{v})\,d\mathbf{v}=\int_{U}f(\varphi(\mathbf{u}))%
 \left|\det(\operatorname{D}\varphi)(\mathbf{u})\right|\,d\mathbf{u}.     The conditions on the theorem can be weakened in various ways. First, the requirement that Ï† be continuously differentiable can be replaced by the weaker assumption that Ï† be merely differentiable and have a continuous inverse . This is guaranteed to hold if Ï† is continuously differentiable by the inverse function theorem . Alternatively, the requirement that Det(DÏ†)â‰ 0 can be eliminated by applying Sard's theorem .  For Lebesgue measurable functions, the theorem can be stated in the following form :  Theorem . Let U be a measurable subset of R n and Ï† : U â†’ R n an injective function, and suppose for every x in U there exists Ï†' ( x ) in R n , n such that Ï† ( y ) = Ï† ( x ) + Ï†' ( x )Â ( y âˆ’ x ) + o (|| y âˆ’ x ||) as y â†’ x . Then Ï† ( U ) is measurable, and for any real-valued function f defined on Ï† ( U ),        âˆ«   Ï†   (  U  )      f   (  v  )   d   v     =    âˆ«  U    f   (   Ï†   (  u  )    )    |   det    Ï†  â€²    (  u  )     |   d  u          subscript     Ï†  U      f  v  d  v      subscript   U     f    Ï†  u          superscript  Ï†  normal-â€²   u     d  u      \int_{\varphi(U)}f(v)\,dv\;=\;\int_{U}f(\varphi(u))\;\left|\det\varphi^{\prime%
 }(u)\right|\,du   in the sense that if either integral exists (or is properly infinite), then so does the other one, and they have the same value.  Another very general version in measure theory is the following :  Theorem . Let X be a locally compact  Hausdorff space equipped with a finite Radon measure Î¼, and let Y be a Ïƒ-compact Hausdorff space with a Ïƒ-finite Radon measure Ï. Let Ï† : X â†’ Y be a continuous and absolutely continuous function (where the latter means that Ï ( Ï† ( E ))Â =Â 0 whenever Î¼ ( E )Â =Â 0). Then there exists a real-valued Borel measurable function  w on X such that for every Lebesgue integrable function f : Y â†’ R , the function ( f    âˆ˜     \circ    Ï† ) w is Lebesgue integrable on X , and         âˆ«  Y    f   (  y  )   d  Ï   (  y  )     =    âˆ«  X     f  âˆ˜  Ï†    (  x  )   w   (  x  )   d  Î¼   (  x  )      .        subscript   Y     f  y  d  Ï  y      subscript   X       f  Ï†   x  w  x  d  Î¼  x      \int_{Y}f(y)\,d\rho(y)=\int_{X}f\circ\varphi(x)w(x)\,d\mu(x).   Furthermore, it is possible to write       w   (  x  )    =    g  âˆ˜  Ï†    (  x  )          w  x       g  Ï†   x     w(x)=g\circ\varphi(x)   for some Borel measurable function g on Y .  In geometric measure theory , integration by substitution is used with Lipschitz functions . A bi-Lipschitz function is a Lipschitz function Ï† : U â†’ R n which is one-to-one, and such that its inverse function Ï† âˆ’1 : Ï† ( U ) â†’ U is also Lipschitz. By Rademacher's theorem a bi-Lipschitz mapping is differentiable almost everywhere . In particular, the Jacobian determinant of a bi-Lipschitz mapping det D 'Ï† is well-defined almost everywhere. The following result then holds:  Theorem. Let U be an open subset of R n and Ï† : U â†’ R n be a bi-Lipschitz mapping. Let f : Ï† ( U ) â†’ R be measurable. Then        âˆ«  U     (   f  âˆ˜  Ï†   )    |   det   D  Ï†    |     =    âˆ«   Ï†   (  U  )     f         subscript   U       f  Ï†         D  Ï†         subscript     Ï†  U    f     \int_{U}(f\circ\varphi)|\det D\varphi|=\int_{\varphi(U)}f   in the sense that if either integral exists (or is properly infinite), then so does the other one, and they have the same value.  The above theorem was first proposed by Euler when he developed the notion of double integrals in 1769. Although generalized to triple integrals by Lagrange in 1773, and used by Legendre , Laplace , Gauss , and first generalized to n variables by Mikhail Ostrogradski in 1836, it resisted a fully rigorous formal proof for a surprisingly long time, and was first satisfactorily resolved 125 years later, by Ã‰lie Cartan in a series of papers beginning in the mid-1890s (; ).  Application in probability  Substitution can be used to answer the following important question in probability: given a random variable   X   X   X   with probability density    p  x     subscript  p  x    p_{x}   and another random variable   Y   Y   Y   related to   X   X   X   by the equation    y  =   Ï•   (  x  )        y    Ï•  x     y=\phi(x)   , what is the probability density for   Y   Y   Y   ?  It is easiest to answer this question by first answering a slightly different question: what is the probability that   Y   Y   Y   takes a value in some particular subset   S   S   S   ? Denote this probability    P   (  Y  âˆˆ  S  )      fragments  P   fragments  normal-(  Y   S  normal-)     P(Y\in S)   . Of course, if   Y   Y   Y   has probability density    p  y     subscript  p  y    p_{y}   then the answer is      P   (  Y  âˆˆ  S  )   =   âˆ«  S    p  y    (  y  )   d  y  ,     fragments  P   fragments  normal-(  Y   S  normal-)     subscript   S    subscript  p  y    fragments  normal-(  y  normal-)   d  y  normal-,    P(Y\in S)=\int_{S}p_{y}(y)\,dy,     but this isn't really useful because we don't know p y ; it's what we're trying to find in the first place. We can make progress by considering the problem in the variable   X   X   X   .   Y   Y   Y   takes a value in S whenever X takes a value in     Ï•   -  1     (  S  )        superscript  Ï•    1    S    \phi^{-1}(S)   , so      P   (  Y  âˆˆ  S  )   =   âˆ«    Ï•   -  1     (  S  )      p  x    (  x  )   d  x  .     fragments  P   fragments  normal-(  Y   S  normal-)     subscript      superscript  Ï•    1    S     subscript  p  x    fragments  normal-(  x  normal-)   d  x  normal-.    P(Y\in S)=\int_{\phi^{-1}(S)}p_{x}(x)\,dx.     Changing from variable x to y gives      P   (  Y  âˆˆ  S  )   =   âˆ«    Ï•   -  1     (  S  )      p  x    (  x  )   d  x  =   âˆ«  S    p  x    (   Ï•   -  1     (  y  )   )   |    d   Ï•   -  1      d  y    |  d  y  .     fragments  P   fragments  normal-(  Y   S  normal-)     subscript      superscript  Ï•    1    S     subscript  p  x    fragments  normal-(  x  normal-)   d  x    subscript   S    subscript  p  x    fragments  normal-(   superscript  Ï•    1     fragments  normal-(  y  normal-)   normal-)   normal-|      d   superscript  Ï•    1       d  y    normal-|  d  y  normal-.    P(Y\in S)=\int_{\phi^{-1}(S)}p_{x}(x)~{}dx=\int_{S}p_{x}(\phi^{-1}(y))~{}\left%
 |\frac{d\phi^{-1}}{dy}\right|~{}dy.     Combining this with our first equation gives        âˆ«  S     p  y    (  y  )   d  y    =    âˆ«  S     p  x    (    Ï•   -  1     (  y  )    )    |    d   Ï•   -  1      d  y    |   d  y          subscript   S      subscript  p  y   y  d  y      subscript   S      subscript  p  x      superscript  Ï•    1    y         d   superscript  Ï•    1       d  y     d  y      \int_{S}p_{y}(y)~{}dy=\int_{S}p_{x}(\phi^{-1}(y))~{}\left|\frac{d\phi^{-1}}{dy%
 }\right|~{}dy     so         p  y    (  y  )    =    p  x    (    Ï•   -  1     (  y  )    )    |    d   Ï•   -  1      d  y    |     .         subscript  p  y   y      subscript  p  x      superscript  Ï•    1    y         d   superscript  Ï•    1       d  y        p_{y}(y)=p_{x}(\phi^{-1}(y))~{}\left|\frac{d\phi^{-1}}{dy}\right|.     In the case where   X   X   X   and   Y   Y   Y   depend on several uncorrelated variables, i.e.     p  x   =    p  x    (    x  1   â€¦   x  n    )         subscript  p  x      subscript  p  x      subscript  x  1   normal-â€¦   subscript  x  n       p_{x}=p_{x}(x_{1}\ldots x_{n})   , and    y  =   Ï•   (  x  )        y    Ï•  x     y=\phi(x)   ,    p  y     subscript  p  y    p_{y}   can be found by substitution in several variables discussed above. The result is         p  y    (  y  )    =    p  x    (    Ï•   -  1     (  y  )    )    |   det   [   D   Ï•   -  1     (  y  )    ]    |     .         subscript  p  y   y      subscript  p  x      superscript  Ï•    1    y        delimited-[]    D   superscript  Ï•    1    y         p_{y}(y)=p_{x}(\phi^{-1}(y))~{}\left|\det\left[D\phi^{-1}(y)\right]\right|.     See also   Probability density function  Substitution of variables  Tangent half-angle substitution  Trigonometric substitution   References     .   .    .   .   External links   Integration by substitution at Encyclopedia of Mathematics  Area formula at Encyclopedia of Mathematics   es:MÃ©todos de integraciÃ³n#MÃ©todo de integraciÃ³n por sustituciÃ³n "  Category:Articles containing proofs  Category:Integral calculus   
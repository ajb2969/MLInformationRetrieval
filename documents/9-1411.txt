   Davidon–Fletcher–Powell formula      Davidon–Fletcher–Powell formula   The Davidon–Fletcher–Powell formula (or DFP ; named after William C. Davidon , Roger Fletcher , and Michael J. D. Powell ) finds the solution to the secant equation that is closest to the current estimate and satisfies the curvature condition (see below). It was the first quasi-Newton method to generalize the secant method to a multidimensional problem. This update maintains the symmetry and positive definiteness of the Hessian matrix .  Given a function    f   (  x  )       f  x    f(x)   , its gradient (    ∇  f     normal-∇  f    \nabla f   ), and positive definite  Hessian matrix    B   B   B   , the Taylor series is:        f   (    x  k   +   s  k    )    =    f   (   x  k   )    +    ∇  f     (   x  k   )   T    s  k    +    1  2    s  k  T   B   s  k      ,        f     subscript  x  k    subscript  s  k         f   subscript  x  k       normal-∇  f    superscript   subscript  x  k   T    subscript  s  k        1  2    subscript   superscript  s  T   k   B   subscript  s  k       f(x_{k}+s_{k})=f(x_{k})+\nabla f(x_{k})^{T}s_{k}+\frac{1}{2}s^{T}_{k}{B}s_{k},     and the Taylor series of the gradient itself (secant equation):         ∇  f    (    x  k   +   s  k    )    =     ∇  f    (   x  k   )    +   B   s  k      ,         normal-∇  f      subscript  x  k    subscript  s  k          normal-∇  f    subscript  x  k      B   subscript  s  k       \nabla f(x_{k}+s_{k})=\nabla f(x_{k})+Bs_{k},     is used to update   B   B   B   . The DFP formula finds a solution that is symmetric, positive definite and closest to the current approximate value of    B  k     subscript  B  k    B_{k}   :        B   k  +  1    =     (   I  -    γ  k    y  k    s  k  T     )    B  k    (   I  -    γ  k    s  k    y  k  T     )    +    γ  k    y  k    y  k  T      ,       subscript  B    k  1          I     subscript  γ  k    subscript  y  k    superscript   subscript  s  k   T      subscript  B  k     I     subscript  γ  k    subscript  s  k    superscript   subscript  y  k   T         subscript  γ  k    subscript  y  k    superscript   subscript  y  k   T       B_{k+1}=(I-\gamma_{k}y_{k}s_{k}^{T})B_{k}(I-\gamma_{k}s_{k}y_{k}^{T})+\gamma_{%
 k}y_{k}y_{k}^{T},     where        y  k   =     ∇  f    (    x  k   +   s  k    )    -    ∇  f    (   x  k   )      ,       subscript  y  k        normal-∇  f      subscript  x  k    subscript  s  k        normal-∇  f    subscript  x  k       y_{k}=\nabla f(x_{k}+s_{k})-\nabla f(x_{k}),           γ  k   =   1    y  k  T    s  k      .       subscript  γ  k     1     superscript   subscript  y  k   T    subscript  s  k       \gamma_{k}=\frac{1}{y_{k}^{T}s_{k}}.     and    B  k     subscript  B  k    B_{k}   is a symmetric and positive definite matrix . The corresponding update to the inverse Hessian approximation     H  k   =   B  k   -  1         subscript  H  k    superscript   subscript  B  k     1      H_{k}=B_{k}^{-1}   is given by:        H   k  +  1    =     H  k   -     H  k    y  k    y  k  T    H  k      y  k  T    H  k    y  k      +     s  k    s  k  T      y  k  T    s  k       .       subscript  H    k  1         subscript  H  k        subscript  H  k    subscript  y  k    superscript   subscript  y  k   T    subscript  H  k       superscript   subscript  y  k   T    subscript  H  k    subscript  y  k           subscript  s  k    superscript   subscript  s  k   T       superscript   subscript  y  k   T    subscript  s  k        H_{k+1}=H_{k}-\frac{H_{k}y_{k}y_{k}^{T}H_{k}}{y_{k}^{T}H_{k}y_{k}}+\frac{s_{k}%
 s_{k}^{T}}{y_{k}^{T}s_{k}}.      B   B   B   is assumed to be positive definite, and the vectors    s  k  T     superscript   subscript  s  k   T    s_{k}^{T}   and   y   y   y   must satisfy the curvature condition:        s  k  T    y  k    =    s  k  T   B   s  k    >   0.            superscript   subscript  s  k   T    subscript  y  k       superscript   subscript  s  k   T   B   subscript  s  k         0.     s_{k}^{T}y_{k}=s_{k}^{T}Bs_{k}>0.\,     The DFP formula is quite effective, but it was soon superseded by the BFGS formula , which is its dual (interchanging the roles of y and s).  See also   Newton's method  Newton's method in optimization  Quasi-Newton method  Broyden–Fletcher–Goldfarb–Shanno (BFGS) method  L-BFGS method  SR1 formula  Nelder–Mead method   References     .    "  Category:Optimization algorithms and methods   
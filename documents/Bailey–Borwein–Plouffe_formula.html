<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="445">Bailey–Borwein–Plouffe formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Bailey–Borwein–Plouffe formula</h1>
<hr/>

<p>The <strong>Bailey–Borwein–Plouffe formula</strong> (<strong>BBP formula</strong>) is a <a href="spigot_algorithm" title="wikilink">spigot algorithm</a> for computing the <em>n</em>th <a href="binary_digit" title="wikilink">binary digit</a> of <strong><a class="uri" href="pi" title="wikilink">pi</a></strong> (symbol: 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:0">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

) using <a href="Hexadecimal" title="wikilink"></a> math. The formula can directly calculate the value of any given digit of 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:1">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 without calculating the preceding digits. The BBP is a <a class="uri" href="summation" title="wikilink">summation</a>-style formula that was discovered in 1995 by <a href="Simon_Plouffe" title="wikilink">Simon Plouffe</a> and was named after the authors of the paper in which the formula was published, <a href="David_H._Bailey" title="wikilink">David H. Bailey</a>, <a href="Peter_Borwein" title="wikilink">Peter Borwein</a>, and <a href="Simon_Plouffe" title="wikilink">Simon Plouffe</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Before that paper, it had been published by Plouffe on his own site.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The formula is</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:2">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msup>
        <mn>16</mn>
        <mi>k</mi>
       </msup>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mn>4</mn>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
         <mn>2</mn>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>4</mn>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>5</mn>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>6</mn>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>π</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">16</cn>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">4</cn>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">8</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">2</cn>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">8</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">4</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">8</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">5</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">8</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi=\sum_{k=0}^{\infty}\left[\frac{1}{16^{k}}\left(\frac{4}{8k+1}-\frac{2}{8k+%
4}-\frac{1}{8k+5}-\frac{1}{8k+6}\right)\right]
  </annotation>
 </semantics>
</math>

.</p>

<p>The discovery of this formula came as a surprise. For centuries it had been assumed that there was no way to compute the <em>n</em>th digit of 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:3">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 without calculating all of the preceding <em>n</em> − 1 digits.</p>

<p>Since this discovery, many formulas for other irrational constants have been discovered of the general form</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:4">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msup>
        <mi>b</mi>
        <mi>k</mi>
       </msup>
      </mfrac>
      <mfrac>
       <mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>q</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>p</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=\sum_{k=0}^{\infty}\left[\frac{1}{b^{k}}\frac{p(k)}{q(k)}\right]
  </annotation>
 </semantics>
</math>

 where α is the constant and <em>p</em> and <em>q</em> are <a href="polynomial" title="wikilink">polynomials</a> in integer coefficients and <em>b</em> ≥ 2 is an integer <a href="radix" title="wikilink">base</a>.</p>

<p>Formulas in this form are known as <strong>BBP-type formulas</strong>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Certain combinations of specific <em>p</em>, <em>q</em> and <em>b</em> result in well-known constants, but there is no systematic algorithm for finding the appropriate combinations; known formulas are discovered through <a href="experimental_mathematics" title="wikilink">experimental mathematics</a>.</p>
<h2 id="specializations">Specializations</h2>

<p>A specialization of the general formula that has produced many results is</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mi>b</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo>,</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msup>
        <mi>b</mi>
        <mi>k</mi>
       </msup>
      </mfrac>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <msub>
         <mi>a</mi>
         <mi>j</mi>
        </msub>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mi>m</mi>
            <mi>k</mi>
           </mrow>
           <mo>+</mo>
           <mi>j</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>s</mi>
        </msup>
       </mfrac>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <vector>
      <ci>s</ci>
      <ci>b</ci>
      <ci>m</ci>
      <ci>A</ci>
     </vector>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>m</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <ci>m</ci>
            <ci>k</ci>
           </apply>
           <ci>j</ci>
          </apply>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(s,b,m,A)=\sum_{k=0}^{\infty}\left[\frac{1}{b^{k}}\sum_{j=1}^{m}\frac{a_{j}}{%
(mk+j)^{s}}\right]
  </annotation>
 </semantics>
</math>

 where <em>s</em>, <em>b</em> and <em>m</em> are integers and 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:6">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>a</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>a</mi>
     <mi>m</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>m</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=(a_{1},a_{2},\dots,a_{m})
  </annotation>
 </semantics>
</math>

 is a vector of integers. The P function leads to a compact notation for some solutions.</p>
<h3 id="previously-known-bbp-type-formulae">Previously known BBP-type formulae</h3>

<p>Some of the simplest formulae of this type that were well known before BBP, and that the P function leads to a compact notation, are</p>

<p>

<math display="inline" id="Bailey–Borwein–Plouffe_formula:7">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <mstyle displaystyle="true">
    <mfrac>
     <mn>10</mn>
     <mn>9</mn>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ln></ln>
    <apply>
     <divide></divide>
     <cn type="integer">10</cn>
     <cn type="integer">9</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln\frac{10}{9}
  </annotation>
 </semantics>
</math>


</p>

<p>

<math display="inline" id="Bailey–Borwein–Plouffe_formula:8">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ln></ln>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\ln 2
  </annotation>
 </semantics>
</math>


</p>

<p>Plouffe was also inspired by the <a href="Inverse_tangent#Infinite_series" title="wikilink">arctan power series</a> of the form (the P notation can be also generalized to the case where <em>b</em> is not an integer) :</p>

<p>

<math display="inline" id="Bailey–Borwein–Plouffe_formula:9">
 <semantics>
  <mrow>
   <mi>arctan</mi>
   <mstyle displaystyle="true">
    <mfrac>
     <mn>1</mn>
     <mi>b</mi>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <arctan></arctan>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\arctan\frac{1}{b}
  </annotation>
 </semantics>
</math>


</p>
<h3 id="the-search-for-new-equalities">The search for new equalities</h3>

<p>Using the P function mentioned above, the simplest known formula for 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:10">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 is for <em>s = 1</em> but <em>m &gt; 1</em>. Many now-discovered formulae are known for b as an exponent of 2 or 3 and m is an exponent of 2 or it is some other factor-rich value, but where several of the terms of vector A are zero. The discovery of these formulae involves a computer search for such linear combinations after computing the individual sums. The search procedure consists of choosing a range of parameter values for s, b, and m, evaluating the sums out to many digits, and then using an <a href="integer_relation_algorithm" title="wikilink">integer relation finding algorithm</a> (typically <a href="Helaman_Ferguson" title="wikilink">Helaman Ferguson</a>'s PSLQ algorithm) to find a vector <em>A</em> that adds up those intermediate sums to a well-known constant or perhaps to zero.</p>
<h3 id="the-bbp-formula-for-pi">The BBP formula for 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:11">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

</h3>

<p>The original BBP 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:12">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 summation formula was found in 1995 by Plouffe using <a href="integer_relation_algorithm" title="wikilink">PSLQ</a>. It is also representable using the <em>P</em> function above:</p>

<p>

<math display="inline" id="Bailey–Borwein–Plouffe_formula:13">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\pi
  </annotation>
 </semantics>
</math>


 which also reduces to this equivalent ratio of two polynomials:</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>π</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <msup>
         <mn>16</mn>
         <mi>k</mi>
        </msup>
       </mfrac>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mrow>
           <mn>120</mn>
           <msup>
            <mi>k</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mn>151</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>47</mn>
         </mrow>
         <mrow>
          <mrow>
           <mn>512</mn>
           <msup>
            <mi>k</mi>
            <mn>4</mn>
           </msup>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mn>1024</mn>
           <msup>
            <mi>k</mi>
            <mn>3</mn>
           </msup>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mn>712</mn>
           <msup>
            <mi>k</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mn>194</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>15</mn>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>π</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">16</cn>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">120</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">151</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">47</cn>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">512</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">4</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">1024</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">3</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">712</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">194</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">15</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi=\sum_{k=0}^{\infty}\left[\frac{1}{16^{k}}\left(\frac{120k^{2}+151k+47}{512%
k^{4}+1024k^{3}+712k^{2}+194k+15}\right)\right].
  </annotation>
 </semantics>
</math>

</p>

<p>This formula has been shown through a rigorous and fairly simple proof to equal 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:15">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h4 id="bbp-digit-extraction-algorithm-for-pi">BBP digit-extraction algorithm for 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:16">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

</h4>

<p>We would like to define a formula that returns the <a class="uri" href="hexadecimal" title="wikilink">hexadecimal</a> digit <em>n</em> of 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:17">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

. A few manipulations are required to implement a <a href="spigot_algorithm" title="wikilink">spigot algorithm</a> using this formula.</p>

<p>We must first rewrite the formula as</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>π</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>4</mn>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </munderover>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mn>16</mn>
           <mi>k</mi>
          </msup>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mn>8</mn>
            <mi>k</mi>
           </mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </munderover>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mn>16</mn>
           <mi>k</mi>
          </msup>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mn>8</mn>
            <mi>k</mi>
           </mrow>
           <mo>+</mo>
           <mn>4</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mn>16</mn>
          <mi>k</mi>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>5</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
     <mo>-</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mn>16</mn>
          <mi>k</mi>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>6</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>π</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cn type="integer">16</cn>
          <ci>k</ci>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">8</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cn type="integer">16</cn>
          <ci>k</ci>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <cn type="integer">8</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">4</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">16</cn>
         <ci>k</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">8</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">5</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">16</cn>
         <ci>k</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">8</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi=4\sum_{k=0}^{\infty}\frac{1}{(16^{k})(8k+1)}-2\sum_{k=0}^{\infty}\frac{1}{%
(16^{k})(8k+4)}-\sum_{k=0}^{\infty}\frac{1}{(16^{k})(8k+5)}-\sum_{k=0}^{\infty%
}\frac{1}{(16^{k})(8k+6)}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>Now, for a particular value of <em>n</em> and taking the first sum, we split the <a href="series_(mathematics)" title="wikilink">sum</a> to <a class="uri" href="infinity" title="wikilink">infinity</a> across the <em>n</em>th term</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mn>16</mn>
         <mi>k</mi>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>8</mn>
          <mi>k</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mn>16</mn>
          <mi>k</mi>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mn>16</mn>
          <mi>k</mi>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mn>8</mn>
           <mi>k</mi>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">16</cn>
        <ci>k</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <ci>k</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">16</cn>
         <ci>k</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">8</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">16</cn>
         <ci>k</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">8</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{k=0}^{\infty}\frac{1}{(16^{k})(8k+1)}=\sum_{k=0}^{n}\frac{1}{(16^{k})(8k%
+1)}+\sum_{k=n+1}^{\infty}\frac{1}{(16^{k})(8k+1)}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>We now multiply by 16<sup> <em>n</em></sup> so that the hexadecimal point (the divide between fractional and integer parts of the number) is in the <em>n</em>th place.</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mfrac>
      <msup>
       <mn>16</mn>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
      </msup>
      <mrow>
       <mrow>
        <mn>8</mn>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mfrac>
       <msup>
        <mn>16</mn>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
       </msup>
       <mrow>
        <mrow>
         <mn>8</mn>
         <mi>k</mi>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mfrac>
       <msup>
        <mn>16</mn>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
       </msup>
       <mrow>
        <mrow>
         <mn>8</mn>
         <mi>k</mi>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">16</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <ci>k</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">16</cn>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <ci>k</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">16</cn>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <ci>k</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{k=0}^{\infty}\frac{16^{n-k}}{8k+1}=\sum_{k=0}^{n}\frac{16^{n-k}}{8k+1}+%
\sum_{k=n+1}^{\infty}\frac{16^{n-k}}{8k+1}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>Since we only care about the fractional part of the sum, we look at our two terms and realise that only the first sum is able to produce whole numbers; conversely, the second sum cannot produce whole numbers since the numerator can never be larger than the denominator for <em>k</em> &gt; <em>n</em>. Therefore, we need a trick to remove the whole numbers for the first sum. That trick is mod 8<em>k</em> + 1. Our sum for the first fractional part then becomes:</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mfrac>
      <mrow>
       <msup>
        <mn>16</mn>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
       </msup>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>8</mn>
          <mi>k</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mn>8</mn>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mfrac>
      <msup>
       <mn>16</mn>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
      </msup>
      <mrow>
       <mrow>
        <mn>8</mn>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="latexml">modulo</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">16</cn>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <ci>k</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <ci>k</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">16</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">8</cn>
        <ci>k</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{k=0}^{n}\frac{16^{n-k}\bmod(8k+1)}{8k+1}+\sum_{k=n+1}^{\infty}\frac{16^{%
n-k}}{8k+1}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>Notice how the <a href="Modular_arithmetic" title="wikilink">modulo</a> operator always guarantees that only the fractional sum will be kept. To calculate 16<sup> <em>n</em> − <em>k</em></sup> mod (8<em>k</em> + 1) quickly and efficiently, use the <a href="modular_exponentiation" title="wikilink">modular exponentiation</a> algorithm. When the running product becomes greater than one, take the modulo just as you do for the running total in each sum.</p>

<p>Now to complete the calculation you must apply this to each of the four sums in turn. Once this is done, take the four summations and put them back into the sum to 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:22">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Bailey–Borwein–Plouffe_formula:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>4</mn>
     <msub>
      <mi mathvariant="normal">Σ</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi mathvariant="normal">Σ</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mn>3</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mn>4</mn>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4\Sigma_{1}-2\Sigma_{2}-\Sigma_{3}-\Sigma_{4}.\,\!
  </annotation>
 </semantics>
</math>

</p>

<p>Since only the fractional part is accurate, extracting the wanted digit requires that one removes the integer part of the final sum and multiplies by 16 to "skim off" the hexadecimal digit at this position (in theory, the next few digits up to the accuracy of the calculations used would also be accurate).</p>

<p>This process is similar to performing <a href="long_multiplication" title="wikilink">long multiplication</a>, but only having to perform the summation of some middle columns. While there are some <a href="carry_(arithmetic)" title="wikilink">carries</a> that are not counted, computers usually perform arithmetic for many bits (32 or 64) and they round and we are only interested in the most significant digit(s). There is a possibility that a particular computation will be akin to failing to add a small number (e.g. 1) to the number 999999999999999, and that the error will propagate to the most significant digit.</p>
<h2 id="bbp-compared-to-other-methods-of-computing-pi">BBP compared to other methods of computing 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:24">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

</h2>

<p>This algorithm computes 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:25">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 without requiring custom data types having thousands or even millions of digits. The method calculates the <em>n</em>th digit <em>without</em> calculating the first <em>n</em> − 1 digits, and can use small, efficient data types.</p>

<p>The algorithm is the fastest way to compute the <em>n</em>th digit (or a few digits in a neighborhood of the <em>n</em>th); because of this, by using multiple machines, it is the fastest way to compute all the digits from 1 to <em>n</em>.</p>

<p>Though the BBP formula can directly calculate the value of any given digit of 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:26">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 with less computational effort than formulas that must calculate all intervening digits, BBP remains <a href="Time_complexity#Linearithmic/quasilinear_time" title="wikilink">linearithmic</a> whereby successively larger values of <em>n</em> require increasingly more time to calculate; that is, the "further out" a digit is, the longer it takes BBP to calculate it, just like the standard 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:27">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

-computing algorithms.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="generalizations">Generalizations</h2>

<p>D.J. Broadhurst provides a generalization of the BBP algorithm that may be used to compute a number of other constants in nearly linear time and logarithmic space.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Explicit results are given for <a href="Catalan's_constant" title="wikilink">Catalan's constant</a>, 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:28">
 <semantics>
  <msup>
   <mi>π</mi>
   <mn>3</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>π</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi^{3}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:29">
 <semantics>
  <mrow>
   <msup>
    <mi>log</mi>
    <mn>3</mn>
   </msup>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <log></log>
     <cn type="integer">3</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log^{3}2
  </annotation>
 </semantics>
</math>

, <a href="Apéry's_constant" title="wikilink">Apéry's constant</a> 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:30">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ζ</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(3)
  </annotation>
 </semantics>
</math>

 (where 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:31">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ζ</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(x)
  </annotation>
 </semantics>
</math>

 is the <a href="Riemann_zeta_function" title="wikilink">Riemann zeta function</a>), 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:32">
 <semantics>
  <msup>
   <mi>π</mi>
   <mn>4</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>π</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi^{4}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:33">
 <semantics>
  <mrow>
   <msup>
    <mi>log</mi>
    <mn>4</mn>
   </msup>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <log></log>
     <cn type="integer">4</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log^{4}2
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:34">
 <semantics>
  <mrow>
   <msup>
    <mi>log</mi>
    <mn>5</mn>
   </msup>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <log></log>
     <cn type="integer">5</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log^{5}2
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:35">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>5</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ζ</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(5)
  </annotation>
 </semantics>
</math>

, and various products of powers of 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:36">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:37">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <log></log>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log 2
  </annotation>
 </semantics>
</math>

. These results are obtained primarily by the use of <a href="polylogarithm_ladder" title="wikilink">polylogarithm ladders</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Computing_π" title="wikilink">Computing 

<math display="inline" id="Bailey–Borwein–Plouffe_formula:38">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

</a></li>
<li><a href="Experimental_mathematics" title="wikilink">Experimental mathematics</a></li>
<li><a href="Bellard's_formula" title="wikilink">Bellard's formula</a></li>
<li><a href="Feynman_point" title="wikilink">Feynman point</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>D.J. Broadhurst, "<a href="http://arxiv.org/abs/math.CA/9803067">Polylogarithmic ladders, hypergeometric series and the ten millionth digits of ζ(3) and ζ(5)</a>", (1998) <em><a class="uri" href="arXiv" title="wikilink">arXiv</a></em> math.CA/9803067</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="Richard_J._Lipton" title="wikilink">Richard J. Lipton</a>, "<a href="http://rjlipton.wordpress.com/2010/07/14/making-an-algorithm-an-algorithm-bbp/">Making An Algorithm An Algorithm — BBP</a>", weblog post, July 14, 2010.</li>
<li><a href="Richard_J._Lipton" title="wikilink">Richard J. Lipton</a>, "<a href="http://rjlipton.wordpress.com/2009/03/15/cooks-class-contains-pi/">Cook’s Class Contains Pi</a>", weblog post, March 15, 2009.</li>
<li></li>
<li><a href="David_H._Bailey" title="wikilink">David H. Bailey</a>, "<a href="http://www.experimentalmath.info/bbp-codes/">BBP Code Directory</a>", web page with links to Beiley's code implementing the BBP algorithm, September 8, 2006.</li>
</ul>

<p>"</p>

<p><a href="Category:Pi_algorithms" title="wikilink">Category:Pi algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://plouffe.fr">Plouffe's website</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6">D.J. Broadhurst, "<a href="http://arxiv.org/abs/math.CA/9803067">Polylogarithmic ladders, hypergeometric series and the ten millionth digits of ζ(3) and ζ(5)</a>", (1998) <em>arXiv</em> math.CA/9803067<a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

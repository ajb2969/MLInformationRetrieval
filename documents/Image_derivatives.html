<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1573">Image derivatives</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Image derivatives</h1>
<hr>Image derivatives can be computed by using small convolution filters of size 2 x 2 or 3 x 3, such as the  [[Discrete Laplace operator|Laplacian]], [[Sobel operator|Sobel]], [[Roberts cross|Roberts]] and [[Prewitt operator|Prewitt]]  operators.<ref>Pratt, W.K., 2007. Digital image processing (4th ed.). John Wiley &amp; Sons, Inc. pp. 465‚Äì522</ref> However, a larger mask will generally give a better approximation of the derivative and examples of such filters are Gaussian derivatives <ref>H. Bouma, A. Vilanova, J.O. Besc√≥s, B.M.T.H. Romeny, F.A. Gerritsen, Fast and accurate gaussian derivatives based on b-splines, in: Proceedings of the 1st Internati<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</ref></hr></body></html>
<body>

<p>onal Conference on Scale Space and Variational Methods in Computer Vision, Springer-Verlag, Berlin, Heidelberg, 2007, pp. 406‚Äì417. and Gabor filters.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Sometimes high frequency noise needs to be removed and this can be incorporated in the filter so that the Gaussian kernel will act as a band pass filter.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The use of Gabor filters <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> in image processing has been motivated by some of its similarities to the perception in the human visual system.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>The pixel value is computed as a <a class="uri" href="convolution" title="wikilink">convolution</a></p>

<p>

<math display="block" id="Image_derivatives:0">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mi>u</mi>
    <mo>‚Ä≤</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mi>ùêù</mi>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <ci>normal-‚àó</ci>
     <ci>ùêù</ci>
     <ci>G</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{\prime}_{u}=\mathbf{d}\ast G
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Image_derivatives:1">
 <semantics>
  <mi>ùêù</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêù</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{d}
  </annotation>
 </semantics>
</math>

 is the derivative kernel and 

<math display="inline" id="Image_derivatives:2">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 is the pixel values in a region of the image and 

<math display="inline" id="Image_derivatives:3">
 <semantics>
  <mo>‚àó</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-‚àó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ast
  </annotation>
 </semantics>
</math>


 is the operator that performs the <a class="uri" href="convolution" title="wikilink">convolution</a>.</p>
<h2 id="sobel-derivatives">Sobel Derivatives</h2>

<p>The derivative kernels, known as the <a href="Sobel_operator" title="wikilink">Sobel operator</a> are defined as follows, for the 

<math display="inline" id="Image_derivatives:4">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Image_derivatives:5">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 directions respectively:</p>

<p>

<math display="block" id="Image_derivatives:6">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>p</mi>
     <mi>u</mi>
     <mo>‚Ä≤</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>+</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>*</mo>
      <mi>ùêÜ</mi>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <msubsup>
     <mi>p</mi>
     <mi>v</mi>
     <mo>‚Ä≤</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo lspace="12.5pt">-</mo>
          <mn>2</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo lspace="12.5pt">+</mo>
          <mn>2</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mo>*</mo>
     <mi>ùêÜ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>normal-‚Ä≤</ci>
      </apply>
      <ci>u</ci>
     </apply>
     <list>
      <apply>
       <times></times>
       <matrix>
        <matrixrow>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </matrixrow>
        <matrixrow>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </matrixrow>
        <matrixrow>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <plus></plus>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
         </apply>
        </matrixrow>
       </matrix>
       <ci>ùêÜ</ci>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>normal-‚Ä≤</ci>
      </apply>
      <ci>v</ci>
     </apply>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="float">0</cn>
        <apply>
         <plus></plus>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
      </matrix>
      <ci>ùêÜ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{\prime}_{u}=\begin{bmatrix}-1&-2&-1\\
0&0&0\\
+1&+2&+1\end{bmatrix}*\mathbf{G}\quad\mbox{and}\quad p^{\prime}_{v}=\begin{%
bmatrix}-1&0&+1\\
\ \ -2&\ \ 0&\ \ +2\\
-1&0&+1\end{bmatrix}*\mathbf{G}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Image_derivatives:7">
 <semantics>
  <mo>*</mo>
  <annotation-xml encoding="MathML-Content">
   <times></times>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   *
  </annotation>
 </semantics>
</math>

 here denotes the 2-dimensional <a class="uri" href="convolution" title="wikilink">convolution</a> operation.</p>

<p>This operator is separable and can be decomposed as the products of an interpolation and a differentiation kernel, so that, 

<math display="inline" id="Image_derivatives:8">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mi>v</mi>
   <mo>‚Ä≤</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>normal-‚Ä≤</ci>
    </apply>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{\prime}_{v}
  </annotation>
 </semantics>
</math>

, for an example can be written as</p>

<p>

<math display="block" id="Image_derivatives:9">
 <semantics>
  <mrow>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>+</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
      <apply>
       <plus></plus>
       <cn type="integer">2</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">2</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">0</cn>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}-1&0&+1\\
-2&0&+2\\
-1&0&+1\end{bmatrix}=\begin{bmatrix}1\\
2\\
1\end{bmatrix}\begin{bmatrix}-1&0&+1\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="farid-and-simoncelli-derivatives">Farid and Simoncelli Derivatives</h2>

<p>Farid and Simoncelli.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> propose to use a pair of kernels, one for interpolation and another for differentiation (compare to Sobel above). These kernels, of fixed sizes 5 x 5 and 7 x 7, are optimized so that the Fourier transform approximates their correct derivative relationship.</p>

<p>In <a href="MATLAB" title="wikilink">Matlab</a> code the so called 5-tap filter is</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">  k  = [<span class="fl">0.030320</span>  <span class="fl">0.249724</span>  <span class="fl">0.439911</span>  <span class="fl">0.249724</span>  <span class="fl">0.030320</span>];
  d  = [<span class="fl">0.104550</span>  <span class="fl">0.292315</span>  <span class="fl">0.000000</span> -<span class="fl">0.292315</span> -<span class="fl">0.104550</span>];
  d2 = [<span class="fl">0.232905</span>  <span class="fl">0.002668</span> -<span class="fl">0.471147</span>  <span class="fl">0.002668</span>  <span class="fl">0.232905</span>];</code></pre></div>

<p>And the 7-tap filter is</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">  k  = [ <span class="fl">0.004711</span>  <span class="fl">0.069321</span>  <span class="fl">0.245410</span>  <span class="fl">0.361117</span>  <span class="fl">0.245410</span>  <span class="fl">0.069321</span>  <span class="fl">0.004711</span>];
  d  = [ <span class="fl">0.018708</span>  <span class="fl">0.125376</span>  <span class="fl">0.193091</span>  <span class="fl">0.000000</span> -<span class="fl">0.193091</span> -<span class="fl">0.125376</span> -<span class="fl">0.018708</span>];
  d2 = [ <span class="fl">0.055336</span>  <span class="fl">0.137778</span> -<span class="fl">0.056554</span> -<span class="fl">0.273118</span> -<span class="fl">0.056554</span>  <span class="fl">0.137778</span>  <span class="fl">0.055336</span>];</code></pre></div>

<p>As an example the first order derivatives can be computed in the following using <a href="MATLAB" title="wikilink">Matlab</a> in order to perform the <a class="uri" href="convolution" title="wikilink">convolution</a></p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"> 
Iu=-conv2(conv(d,k),conv(k,k),im,<span class="st">'same'</span>);
Iv=-conv2(conv(k,k),conv(d,k),im,<span class="st">'same'</span>);</code></pre></div>
<h2 id="hast-derivatives">Hast Derivatives</h2>

<p>Derivative filters based on arbitrary cubic <a href="Spline_interpolation" title="wikilink">splines</a> was presented by Hast.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> He showed how both first and second order derivatives can be computed more correctly using cubic or trigonometric splines. Efficient derivative filters need to be of odd length so that the derivative is computed for the central pixel. However, any cubic filter is fitted over 4 sample points, giving a centre that falls between pixels. This is solved by a double filtering approach giving filters of size 7 x 7. The idea is to first filter by interpolation so that the interpolated value between pixels are obtained, whereafter the procedure is repeated using a derivative filters, where the centre value now falls on pixel centres. This can easily be proved by the associative law for convolution</p>

<p>

<math display="block" id="Image_derivatives:10">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mi>u</mi>
    <mo>‚Ä≤</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mi>ùêù</mi>
    <mo>‚àó</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ùê§</mi>
      <mo>‚àó</mo>
      <mi>G</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ùêù</mi>
      <mo>‚àó</mo>
      <mi>ùê§</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>normal-‚Ä≤</ci>
      </apply>
      <ci>u</ci>
     </apply>
     <apply>
      <ci>normal-‚àó</ci>
      <ci>ùêù</ci>
      <apply>
       <ci>normal-‚àó</ci>
       <ci>ùê§</ci>
       <ci>G</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚àó</ci>
      <apply>
       <ci>normal-‚àó</ci>
       <ci>ùêù</ci>
       <ci>ùê§</ci>
      </apply>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{\prime}_{u}=\mathbf{d}\ast(\mathbf{k}\ast G)=(\mathbf{d}\ast\mathbf{k})\ast
G
  </annotation>
 </semantics>
</math>

 Therefore the convolution kernel for computing the derivative 

<math display="inline" id="Image_derivatives:11">
 <semantics>
  <msub>
   <mi>ùê§</mi>
   <mi>ùêù</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùê§</ci>
    <ci>ùêù</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k_{d}}
  </annotation>
 </semantics>
</math>

 using an interpolating kernel 

<math display="inline" id="Image_derivatives:12">
 <semantics>
  <mi>ùê§</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê§</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k}
  </annotation>
 </semantics>
</math>

 and a derivative kernel 

<math display="inline" id="Image_derivatives:13">
 <semantics>
  <mi>ùêù</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêù</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{d}
  </annotation>
 </semantics>
</math>


 becomes</p>

<p>

<math display="block" id="Image_derivatives:14">
 <semantics>
  <mrow>
   <msub>
    <mi>ùê§</mi>
    <mi>ùêù</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>ùêù</mi>
    <mo>‚àó</mo>
    <mi>ùê§</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùê§</ci>
     <ci>ùêù</ci>
    </apply>
    <apply>
     <ci>normal-‚àó</ci>
     <ci>ùêù</ci>
     <ci>ùê§</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k_{d}}=\mathbf{d}\ast\mathbf{k}
  </annotation>
 </semantics>
</math>

</p>

<p>Also keep in mind that convolution is commutative, so that the order of the two kernels does not matter and it is also possible to insert a second order derivative as well as a first order derivative kernel. These kernels are derived from the fact that any spline surface can be fitted over a square pixel region, compare to <a href="B√©zier_surface" title="wikilink">Bezier surfaces</a>. Hast proves that such a surface can be performed as a separable convolution</p>

<p>

<math display="block" id="Image_derivatives:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>ùêÆ</mi>
     <mi>T</mi>
    </msup>
    <mi>M</mi>
    <mi>G</mi>
    <msup>
     <mi>M</mi>
     <mi>T</mi>
    </msup>
    <mi>ùêØ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>M</mi>
        <mi>T</mi>
       </msup>
       <mi>ùêÆ</mi>
      </mrow>
      <mo>‚äó</mo>
      <msup>
       <mi>ùêØ</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mi>M</mi>
    </mrow>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>p</ci>
      <interval closure="open">
       <ci>u</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêÆ</ci>
       <ci>T</ci>
      </apply>
      <ci>M</ci>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>M</ci>
       <ci>T</ci>
      </apply>
      <ci>ùêØ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚àó</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">tensor-product</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>M</ci>
          <ci>T</ci>
         </apply>
         <ci>ùêÆ</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ùêØ</ci>
         <ci>T</ci>
        </apply>
       </apply>
       <ci>M</ci>
      </apply>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(u,v)=\mathbf{u}^{T}MGM^{T}\mathbf{v}=M^{T}\mathbf{u}\otimes\mathbf{v}^{T}M\ast
G
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Image_derivatives:16">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is the spline basis matrix, 

<math display="inline" id="Image_derivatives:17">
 <semantics>
  <mi>ùêÆ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêÆ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{u}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Image_derivatives:18">
 <semantics>
  <mi>ùêØ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêØ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}
  </annotation>
 </semantics>
</math>


 are vectors containing the variables 

<math display="inline" id="Image_derivatives:19">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Image_derivatives:20">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

, such as</p>

<p>

<math display="block" id="Image_derivatives:21">
 <semantics>
  <mrow>
   <mi>ùêÆ</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>u</mi>
      <mn>3</mn>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>u</mi>
      <mn>2</mn>
     </msup>
     <mo>,</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêÆ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </list>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{u}=[u^{3},u^{2},u,1]^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Image_derivatives:22">
 <semantics>
  <mrow>
   <mi>ùêØ</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>v</mi>
      <mn>3</mn>
     </msup>
     <mo>,</mo>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
     <mo>,</mo>
     <mi>v</mi>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêØ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>v</ci>
      <cn type="integer">1</cn>
     </list>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}=[v^{3},v^{2},v,1]^{T}
  </annotation>
 </semantics>
</math>

 The convolution kernels can now be set to</p>

<p>

<math display="block" id="Image_derivatives:23">
 <semantics>
  <mrow>
   <mi>ùê§</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>ùêÆ</mi>
     <mi>T</mi>
    </msup>
    <mi>M</mi>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mi>ùêØ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ùê§</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêÆ</ci>
       <ci>T</ci>
      </apply>
      <ci>M</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
       <ci>ùêØ</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{k}=\mathbf{u}^{T}M=(M^{T}\mathbf{v})^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Image_derivatives:24">
 <semantics>
  <mrow>
   <mi>ùêù</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <msup>
       <mi>ùêÆ</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>u</mi>
     </mrow>
    </mfrac>
    <mi>M</mi>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mfrac>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>ùêØ</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <mi>v</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ùêù</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ùêÆ</ci>
         <ci>T</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>u</ci>
       </apply>
      </apply>
      <ci>M</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ùêØ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{d}=\frac{\partial\mathbf{u}^{T}}{\partial u}M=\left(M^{T}\frac{%
\partial\mathbf{v}}{\partial v}\right)^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Image_derivatives:25">
 <semantics>
  <mrow>
   <msup>
    <mi>ùêù</mi>
    <mn>ùüê</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mo>‚àÇ</mo>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>ùêÆ</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <msup>
       <mi>u</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mi>M</mi>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mfrac>
       <mrow>
        <msup>
         <mo>‚àÇ</mo>
         <mn>2</mn>
        </msup>
        <mi>ùêØ</mi>
       </mrow>
       <mrow>
        <mo>‚àÇ</mo>
        <msup>
         <mi>v</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêù</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ùêÆ</ci>
         <ci>T</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>M</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <cn type="integer">2</cn>
         </apply>
         <ci>ùêØ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>v</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{d^{2}}=\frac{\partial^{2}\mathbf{u}^{T}}{\partial u^{2}}M=\left(M^{T}%
\frac{\partial^{2}\mathbf{v}}{\partial v^{2}}\right)^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>The first order derivatives at the central pixel are hence computed as</p>

<p>

<math display="block" id="Image_derivatives:26">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mi>u</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mo>‚àÇ</mo>
          <msup>
           <mi>ùêÆ</mi>
           <mi>T</mi>
          </msup>
         </mrow>
         <mrow>
          <mo>‚àÇ</mo>
          <mi>u</mi>
         </mrow>
        </mfrac>
        <mi>M</mi>
       </mrow>
       <mo>‚àó</mo>
       <msup>
        <mi>ùêÆ</mi>
        <mi>T</mi>
       </msup>
      </mrow>
      <mi>M</mi>
      <mi>G</mi>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mi>ùêØ</mi>
     </mrow>
     <mo>‚àó</mo>
     <msup>
      <mi>M</mi>
      <mi>T</mi>
     </msup>
    </mrow>
    <mi>ùêØ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>ùêù</mi>
      <mo>‚àó</mo>
      <mi>ùê§</mi>
     </mrow>
     <mo>‚äó</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ùê§</mi>
        <mo>‚àó</mo>
        <mi>ùê§</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-‚àó</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-‚àó</ci>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <partialdiff></partialdiff>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ùêÆ</ci>
             <ci>T</ci>
            </apply>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <ci>u</ci>
           </apply>
          </apply>
          <ci>M</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùêÆ</ci>
          <ci>T</ci>
         </apply>
        </apply>
        <ci>M</ci>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>M</ci>
         <ci>T</ci>
        </apply>
        <ci>ùêØ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <ci>ùêØ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚àó</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <ci>normal-‚àó</ci>
        <ci>ùêù</ci>
        <ci>ùê§</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-‚àó</ci>
         <ci>ùê§</ci>
         <ci>ùê§</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{u}=\frac{\partial\mathbf{u}^{T}}{\partial u}M\ast\mathbf{u}^{T}MGM^{T}%
\mathbf{v}\ast M^{T}\mathbf{v}=\mathbf{d}\ast\mathbf{k}\otimes(\mathbf{k}\ast%
\mathbf{k})^{T}\ast G
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Image_derivatives:27">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mi>v</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <msup>
         <mi>ùêÆ</mi>
         <mi>T</mi>
        </msup>
        <mi>M</mi>
       </mrow>
       <mo>‚àó</mo>
       <msup>
        <mi>ùêÆ</mi>
        <mi>T</mi>
       </msup>
      </mrow>
      <mi>M</mi>
      <mi>G</mi>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mi>ùêØ</mi>
     </mrow>
     <mo>‚àó</mo>
     <msup>
      <mi>M</mi>
      <mi>T</mi>
     </msup>
    </mrow>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>ùêØ</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>v</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>ùê§</mi>
      <mo>‚àó</mo>
      <mi>ùê§</mi>
     </mrow>
     <mo>‚äó</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ùêù</mi>
        <mo>‚àó</mo>
        <mi>ùê§</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-‚àó</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-‚àó</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùêÆ</ci>
           <ci>T</ci>
          </apply>
          <ci>M</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùêÆ</ci>
          <ci>T</ci>
         </apply>
        </apply>
        <ci>M</ci>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>M</ci>
         <ci>T</ci>
        </apply>
        <ci>ùêØ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>ùêØ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>v</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚àó</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <ci>normal-‚àó</ci>
        <ci>ùê§</ci>
        <ci>ùê§</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-‚àó</ci>
         <ci>ùêù</ci>
         <ci>ùê§</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{v}=\mathbf{u}^{T}M\ast\mathbf{u}^{T}MGM^{T}\mathbf{v}\ast M^{T}\frac{%
\partial\mathbf{v}}{\partial v}=\mathbf{k}\ast\mathbf{k}\otimes(\mathbf{d}\ast%
\mathbf{k})^{T}\ast G
  </annotation>
 </semantics>
</math>

</p>

<p>Likewise, with the second order derivative kernels are</p>

<p>

<math display="block" id="Image_derivatives:28">
 <semantics>
  <mrow>
   <msubsup>
    <mi>D</mi>
    <mi>u</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <msup>
           <mo>‚àÇ</mo>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>ùêÆ</mi>
           <mi>T</mi>
          </msup>
         </mrow>
         <mrow>
          <mo>‚àÇ</mo>
          <msup>
           <mi>u</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mfrac>
        <mi>M</mi>
       </mrow>
       <mo>‚àó</mo>
       <msup>
        <mi>ùêÆ</mi>
        <mi>T</mi>
       </msup>
      </mrow>
      <mi>M</mi>
      <mi>G</mi>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mi>ùêØ</mi>
     </mrow>
     <mo>‚àó</mo>
     <msup>
      <mi>M</mi>
      <mi>T</mi>
     </msup>
    </mrow>
    <mi>ùêØ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>ùêù</mi>
       <mn>ùüê</mn>
      </msup>
      <mo>‚àó</mo>
      <mi>ùê§</mi>
     </mrow>
     <mo>‚äó</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ùê§</mi>
        <mo>‚àó</mo>
        <mi>ùê§</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-‚àó</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-‚àó</ci>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <partialdiff></partialdiff>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ùêÆ</ci>
             <ci>T</ci>
            </apply>
           </apply>
           <apply>
            <partialdiff></partialdiff>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>u</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <ci>M</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùêÆ</ci>
          <ci>T</ci>
         </apply>
        </apply>
        <ci>M</ci>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>M</ci>
         <ci>T</ci>
        </apply>
        <ci>ùêØ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <ci>ùêØ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚àó</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <ci>normal-‚àó</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ùêù</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>ùê§</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-‚àó</ci>
         <ci>ùê§</ci>
         <ci>ùê§</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{2}_{u}=\frac{\partial^{2}\mathbf{u}^{T}}{\partial u^{2}}M\ast\mathbf{u}^{T}%
MGM^{T}\mathbf{v}\ast M^{T}\mathbf{v}=\mathbf{d^{2}}\ast\mathbf{k}\otimes(%
\mathbf{k}\ast\mathbf{k})^{T}\ast G
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Image_derivatives:29">
 <semantics>
  <mrow>
   <msubsup>
    <mi>D</mi>
    <mi>v</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <msup>
         <mi>ùêÆ</mi>
         <mi>T</mi>
        </msup>
        <mi>M</mi>
       </mrow>
       <mo>‚àó</mo>
       <msup>
        <mi>ùêÆ</mi>
        <mi>T</mi>
       </msup>
      </mrow>
      <mi>M</mi>
      <mi>G</mi>
      <msup>
       <mi>M</mi>
       <mi>T</mi>
      </msup>
      <mi>ùêØ</mi>
     </mrow>
     <mo>‚àó</mo>
     <msup>
      <mi>M</mi>
      <mi>T</mi>
     </msup>
    </mrow>
    <mfrac>
     <mrow>
      <msup>
       <mo>‚àÇ</mo>
       <mn>2</mn>
      </msup>
      <mi>ùêØ</mi>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>ùê§</mi>
      <mo>‚àó</mo>
      <mi>ùê§</mi>
     </mrow>
     <mo>‚äó</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>ùêù</mi>
         <mn>ùüê</mn>
        </msup>
        <mo>‚àó</mo>
        <mi>ùê§</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
    <mo>‚àó</mo>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>v</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-‚àó</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-‚àó</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùêÆ</ci>
           <ci>T</ci>
          </apply>
          <ci>M</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùêÆ</ci>
          <ci>T</ci>
         </apply>
        </apply>
        <ci>M</ci>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>M</ci>
         <ci>T</ci>
        </apply>
        <ci>ùêØ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <ci>ùêØ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>v</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚àó</ci>
      <apply>
       <csymbol cd="latexml">tensor-product</csymbol>
       <apply>
        <ci>normal-‚àó</ci>
        <ci>ùê§</ci>
        <ci>ùê§</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-‚àó</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùêù</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>ùê§</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{2}_{v}=\mathbf{u}^{T}M\ast\mathbf{u}^{T}MGM^{T}\mathbf{v}\ast M^{T}\frac{%
\partial^{2}\mathbf{v}}{\partial v^{2}}=\mathbf{k}\ast\mathbf{k}\otimes(%
\mathbf{d^{2}}\ast\mathbf{k})^{T}\ast G
  </annotation>
 </semantics>
</math>

</p>

<p>The cubic spline filter is evaluated in its centre 

<math display="inline" id="Image_derivatives:30">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mo>=</mo>
   <mi>v</mi>
   <mo>=</mo>
   <mn>0.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>u</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u=v=0.5
  </annotation>
 </semantics>
</math>

 and therefore</p>

<p>

<math display="block" id="Image_derivatives:31">
 <semantics>
  <mrow>
   <mi>ùêÆ</mi>
   <mo>=</mo>
   <mi>ùêØ</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0.5</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
     <mo>,</mo>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0.5</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>,</mo>
     <mn>0.5</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>0.125</mn>
     <mo>,</mo>
     <mn>0.25</mn>
     <mo>,</mo>
     <mn>0.5</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ùêÆ</ci>
     <ci>ùêØ</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="float">0.5</cn>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="float">0.5</cn>
        <cn type="integer">2</cn>
       </apply>
       <cn type="float">0.5</cn>
       <cn type="integer">1</cn>
      </list>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <cn type="float">0.125</cn>
       <cn type="float">0.25</cn>
       <cn type="float">0.5</cn>
       <cn type="integer">1</cn>
      </list>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{u}=\mathbf{v}=[(0.5)^{3},(0.5)^{2},0.5,1]^{T}=[0.125,0.25,0.5,1]^{T}
  </annotation>
 </semantics>
</math>

 Likewise the first order derivatives becomes</p>

<p>

<math display="block" id="Image_derivatives:32">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>ùêÆ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0.5</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>‚àÇ</mo>
     <mi>u</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mi>ùêØ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0.5</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>‚àÇ</mo>
     <mi>v</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mn>3</mn>
      <mo>‚ãÖ</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0.5</mn>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mn>2</mn>
      <mo>‚ãÖ</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0.5</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>0.75</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <ci>ùêÆ</ci>
       </apply>
       <cn type="float">0.5</cn>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <partialdiff></partialdiff>
        <ci>ùêØ</ci>
       </apply>
       <cn type="float">0.5</cn>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="float">0.5</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <cn type="integer">2</cn>
        <cn type="float">0.5</cn>
       </apply>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </list>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <cn type="float">0.75</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </list>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\mathbf{u}(0.5)}{\partial u}=\frac{\partial\mathbf{v}(0.5)}{%
\partial v}=[3\cdot(0.5)^{2},2\cdot(0.5),1,0]^{T}=[0.75,1,1,0]^{T}
  </annotation>
 </semantics>
</math>

 And in a similar manner the second order derivatives are</p>

<p>

<math display="block" id="Image_derivatives:33">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
     <mi>ùêÆ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0.5</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <msup>
     <mi>u</mi>
     <mn>2</mn>
    </msup>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
     <mi>ùêØ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0.5</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mn>6</mn>
      <mo>‚ãÖ</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0.5</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>3</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>ùêÆ</ci>
       <cn type="float">0.5</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>ùêØ</ci>
       <cn type="float">0.5</cn>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <apply>
        <ci>normal-‚ãÖ</ci>
        <cn type="integer">6</cn>
        <cn type="float">0.5</cn>
       </apply>
       <cn type="integer">2</cn>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </list>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </list>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d^{2}\mathbf{u}(0.5)}{u^{2}}=\frac{d^{2}\mathbf{v}(0.5)}{dv^{2}}=[6\cdot%
(0.5),2,0,0]^{T}=[3,2,0,0]^{T}
  </annotation>
 </semantics>
</math>

</p>

<p>It should be noted that any cubic filter can be applied and used for computing the image derivates using the above equations, such as <a href="B√©zier_curve" title="wikilink">B√©zier</a>, <a href="Cubic_Hermite_spline" title="wikilink">Hermite</a> or <a href="B-spline" title="wikilink">B-splines</a>.</p>

<p>The example in below in <a href="MATLAB" title="wikilink">Matlab</a> use the Catmull-Rom spline to compute the derivatives</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"> 
M=[-<span class="fl">1</span>,<span class="fl">3</span>,-<span class="fl">3</span>,<span class="fl">1</span>;<span class="fl">2</span>,-<span class="fl">5</span>,<span class="fl">4</span>,-<span class="fl">1</span>;-<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>;<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>]*<span class="fl">0.5</span>;
u = [<span class="fl">0.125</span>;<span class="fl">0.25</span>;<span class="fl">0.5</span>;<span class="fl">1</span>];
up = [<span class="fl">0.75</span>;<span class="fl">1</span>;<span class="fl">1</span>;<span class="fl">0</span>];
d=up'*M;
k=u'*M;
Iu=-conv2(conv(d,k),conv(k,k),im,<span class="st">'same'</span>);
Iv=-conv2(conv(k,k),conv(d,k),im,<span class="st">'same'</span>);</code></pre></div>
<h2 id="other-approaches">Other Approaches</h2>

<p>Steerable filters can be used for computing derivatives <a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> Moreover, Savitzky and Golay <a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> propose a least-squares polynomial smoothing approach, which could be used for computing derivatives and Luo et al <a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> discuss this approach in further detail. Scharr <a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> shows how to create derivative filters by minimizing the error in the Fourier domain and J√§hne et al <a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> discuss in more detail the principles of filter design, including derivative filters.</p>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.csse.uwa.edu.au/~pk/research/matlabfns/Spatial/derivative5.m">derivative5.m</a> Farid and Simoncelli: 5-Tap 1st and 2nd discrete derivatives.</li>
<li><a href="http://www.csse.uwa.edu.au/~pk/research/matlabfns/Spatial/derivative7.m">derivative7.m</a> Farid and Simoncelli: 7-Tap 1st and 2nd discrete derivatives</li>
<li><a href="http://www.cb.uu.se/~aht/code/kernel.m">kernel.m</a> Hast: 1st and 2nd discrete derivatives for Cubic splines, Catmull-Rom splines, Bezier splines, B-Splines and Trigonometric splines.</li>
</ul>

<p>"</p>

<p><a href="Category:Image_processing" title="wikilink">Category:Image processing</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">P. Moreno, A. Bernardino, J. Santos-Victor, Improving the sift descriptor with smooth derivative filters, Pattern Recognition Letters 30 (2009) 18‚Äì26.<a href="#fnref1">‚Ü©</a></li>
<li id="fn2">J.J. Koenderink, A.J. van Doorn, Generic neighborhood operators, IEEE Trans. Pattern Anal. Mach. Intell. 14 (1992) 597‚Äì605.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3">D. Gabor, Theory of communication, J. Inst. Electr. Eng. 93 (1946) 429‚Äì457.<a href="#fnref3">‚Ü©</a></li>
<li id="fn4">J.G. Daugman, Complete discrete 2-D Gabor transforms by neural networks for image analysis and compression, IEEE Trans. Acoust. Speech Signal Process. 36 (1988) 1169‚Äì1179.<a href="#fnref4">‚Ü©</a></li>
<li id="fn5">H. Farid and E. P. Simoncelli, <a href="http://www.cns.nyu.edu/pub/lcv/farid03-reprint.pdf"><em>Differentiation of discrete multi-dimensional signals</em></a>, IEEE Trans Image Processing, vol.13(4), pp. 496--508, Apr 2004.<a href="#fnref5">‚Ü©</a></li>
<li id="fn6">H. Farid and E. P. Simoncelli, <a href="http://www.cs.dartmouth.edu/~farid/downloads/publications/caip97.pdf"><em>Optimally Rotation-Equivariant Directional Derivative Kernels</em></a>, Int'l Conf Computer Analysis of Images and Patterns, pp. 207--214, Sep 1997.<a href="#fnref6">‚Ü©</a></li>
<li id="fn7">A. Hast., <a href="http://www.sciencedirect.com/science/article/pii/S0167865514000282">"Simple filter design for first and second order derivatives by a double filtering approach"</a>, Pattern Recognition Letters, Vol. 42, no.1 June, pp. 65--71. 2014.<a href="#fnref7">‚Ü©</a></li>
<li id="fn8">W.T. Freeman, E.H. Adelson, The design and use of steerable filters, IEEE Trans. Pattern Anal. Mach. Intell. 13 (1991) 891‚Äì906.<a href="#fnref8">‚Ü©</a></li>
<li id="fn9">A. Savitzky, M.J.E. Golay, Smoothing and differentiation of data by simplified least squares procedures, Anal. Chem. 36 (1964) 1627‚Äì1639.<a href="#fnref9">‚Ü©</a></li>
<li id="fn10">J. Luo, K. Ying, P. He, J. Bai, Properties of savitzky‚Äìgolay digital differentiators, Digit. Signal Process. 15 (2005) 122‚Äì136.<a href="#fnref10">‚Ü©</a></li>
<li id="fn11">H. Scharr, Optimal second order derivative filter families for transparent motion estimation, in: M. Domanski, R. Stasinski, M. Bartkowiak (Eds.), EUSIPCO 2007.<a href="#fnref11">‚Ü©</a></li>
<li id="fn12">Scharr, Hanno, 2000, Dissertation (in German), <a href="http://nbn-resolving.de/urn/resolver.pl?urn=urn:nbn:de:bsz:16-opus-9622"><em>Optimal Operators in Digital Image Processing</em></a>.<a href="#fnref12">‚Ü©</a></li>
<li id="fn13">B. J√§hne, H. Scharr, and S. K√∂rkel. Principles of filter design. In Handbook of Computer Vision and Applications. Academic Press, 1999.<a href="#fnref13">‚Ü©</a></li>
<li id="fn14">B. J√§hne, P. Geissler, H. Haussecker (Eds.), Handbook of Computer Vision and Applications with Cdrom, 1st ed., Morgan Kaufmann Publishers Inc., San Francisco, CA, USA, 1999, pp. 125‚Äì151 (Chapter 6).<a href="#fnref14">‚Ü©</a></li>
</ol>
</section>
</body>


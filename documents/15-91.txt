   Orbit modeling      Orbit modeling   Orbit modeling is the process of creating mathematical models to simulate motion of a massive body as it moves in orbit around another massive body due to gravity . Other forces such as gravitational attraction from tertiary bodies, air resistance , solar pressure , or thrust from a propulsion system are typically modeled as secondary effects. Directly modeling an orbit can push the limits of machine precision due to the need to model small perturbations to very large orbits. Because of this, perturbation methods are often used to model the orbit in order to achieve better accuracy.  Background  The study of orbital motion and mathematical modeling of orbits began with the first attempts to predict planetary motions in the sky, although in ancient times the causes remained a mystery. Newton , at the time he formulated his laws of motion and of gravitation , applied them to the first analysis of perturbations, 1 recognizing the complex difficulties of their calculation. 2 Many of the great mathematicians since then have given attention to the various problems involved; throughout the 18th and 19th centuries there was demand for accurate tables of the position of the Moon and planets for purposes of navigation at sea.  The complex motions of orbits can be broken down. The hypothetical motion that the body follows under the gravitational effect of one other body only is typically a conic section , and can be readily modeled with the methods of geometry . This is called a two-body problem , or an unperturbed Keplerian orbit . The differences between the Keplerian orbit and the actual motion of the body are caused by perturbations . These perturbations are caused by forces other than the gravitational effect between the primary and secondary body and must be modeled to create an accurate orbit simulation. Most orbit modeling approaches model the two-body problem and then add models of these perturbing forces and simulate these models over time. Perturbing forces may include gravitational attraction from other bodies besides the primary, solar wind, drag, magnetic fields, and propulsive forces.  Analytical solutions (mathematical expressions to predict the positions and motions at any future time) for simple two-body and three-body problems exist; none have been found for the n -body problem except for certain special cases. Even the two-body problem becomes insoluble if one of the bodies is irregular in shape. 3  Due to the difficulty in finding analytic solutions to most problems of interest, computer modeling and simulation is typically used to analyze orbital motion. Commercial software applications such as Satellite Tool Kit have been created for the specific purpose of simulating orbits and trajectories of spacecraft.  Keplerian orbit model  In its simplest form, an orbit model can be created by assuming that only two bodies are involved, both behave as spherical point-masses, and that no other forces act on the bodies. For this case the model is simplified to a Kepler orbit .  Keplerian orbits follow conic sections . The mathematical model of the orbit which gives the distance between a central body and an orbiting body can be expressed as:       r   (  ν  )    =    a   (   1  -   e  2    )     1  +   e   cos   (  ν  )             r  ν       a    1   superscript  e  2       1    e    ν        r(\nu)=\frac{a(1-e^{2})}{1+e\cos(\nu)}     Where:     r   r   r   is the distance     a   a   a   is the semi-major axis , which defines the size of the orbit     e   e   e   is the eccentricity , which defines the shape of the orbit     ν   ν   \nu   is the true anomaly , which is the angle between the current position of the orbiting object and the location in the orbit at it is closest to the central body (called the periapsis ) Alternately, the equation can be expressed as:       r   (  ν  )    =   p   1  +   e   cos   (  ν  )             r  ν     p    1    e    ν        r(\nu)=\frac{p}{1+e\cos(\nu)}     Where   p   p   p   is called the semi-latus rectum of the curve. This form of the equation is particularly useful when dealing with parabolic trajectories, for which the semi-major axis is infinite.  An alternate approach uses Isaac Newton 's law of universal gravitation as defined below:      F  =   G     m  1    m  2     r  2         F    G       subscript  m  1    subscript  m  2     superscript  r  2       F=G\frac{m_{1}m_{2}}{r^{2}}     where:     F   F   F   is the magnitude of the gravitational force between the two point masses     G   G   G   is the gravitational constant      m  1     subscript  m  1    m_{1}   is the mass of the first point mass      m  2     subscript  m  2    m_{2}   is the mass of the second point mass     r   r   r   is the distance between the two point masses  Making an additional assumption that the mass of the primary body is much greater than the mass of the secondary body and substituting in Newton's second law of motion , results in the following differential equation       𝐫  ¨   =     G   m  1     r  2     𝐫  ^         normal-¨  𝐫         G   subscript  m  1     superscript  r  2     normal-^  𝐫      \ddot{\mathbf{r}}=\frac{Gm_{1}}{r^{2}}\mathbf{\hat{r}}     Solving this differential equation results in Keplerian motion for an orbit. In practice, Keplerian orbits are typically only useful for first-order approximations, special cases, or as the base model for a perturbed orbit.  Orbit simulation methods  Orbit models are typically propagated in time and space using special perturbation methods. This is performed by first modeling the orbit as a Keplerian orbit. Then perturbations are added to the model to account for the various perturbations that affect the orbit. 4 Special perturbations can be applied to any problem in celestial mechanics , as it is not limited to cases where the perturbing forces are small. 5 Special perturbation methods are the basis of the most accurate machine-generated planetary ephemerides . 6  Cowell's method  (Figure)  Cowell's method. Forces from all perturbing bodies (black and gray) are summed to form the total force on body i (red), and this is numerically integrated starting from the initial position (the epoch of osculation ).   Cowell's method is perhaps the simplest of the special perturbation methods; 7 mathematically, for   n   n   n   mutually interacting bodies, Newtonian forces on body   i   i   i   from the other bodies   j   j   j   are simply summed thus,        𝐫  ¨   i   =    ∑    j  =  1    j  ≠  i    n     G   m  j    (    𝐫  j   -   𝐫  i    )     r   i  j   3          subscript   normal-¨  𝐫   i     superscript   subscript      j  i     j  1     n       G   subscript  m  j      subscript  𝐫  j    subscript  𝐫  i      superscript   subscript  r    i  j    3       \mathbf{\ddot{r}}_{i}=\sum_{\underset{j\neq i}{j=1}}^{n}{Gm_{j}(\mathbf{r}_{j}%
 -\mathbf{r}_{i})\over r_{ij}^{3}}     where       𝐫  ¨   i     subscript   normal-¨  𝐫   i    \mathbf{\ddot{r}}_{i}   is the acceleration vector of body   i   i   i        G   G   G   is the gravitational constant      m  j     subscript  m  j    m_{j}   is the mass of body   j   j   j         𝐫  i     subscript  𝐫  i    \mathbf{r}_{i}   and    𝐫  j     subscript  𝐫  j    \mathbf{r}_{j}   are the position vectors of objects   i   i   i   and   j   j   j         r   i  j      subscript  r    i  j     r_{ij}   is the distance from object   i   i   i   to object   j   j   j   with all vectors being referred to the barycenter of the system. This equation is resolved into components in   x   x   x   ,   y   y   y   ,   z   z   z   and these are integrated numerically to form the new velocity and position vectors as the simulation moves forward in time. The advantage of Cowell's method is ease of application and programming. A disadvantage is that when perturbations become large in magnitude (as when an object makes a close approach to another) the errors of the method also become large. 8 Another disadvantage is that in systems with a dominant central body, such as the Sun , it is necessary to carry many significant digits in the arithmetic because of the large difference in the forces of the central body and the perturbing bodies. 9  Encke's method  (Figure)  Encke's method. Greatly exaggerated here, the small difference δ r (blue) between the osculating, unperturbed orbit (black) and the perturbed orbit (red), is numerically integrated starting from the initial position (the epoch of osculation ).   Encke's method begins with the osculating orbit as a reference and integrates numerically to solve for the variation from the reference as a function of time. 10 Its advantages are that perturbations are generally small in magnitude, so the integration can proceed in larger steps (with resulting lesser errors), and the method is much less affected by extreme perturbations than Cowell's method. Its disadvantage is complexity; it cannot be used indefinitely without occasionally updating the osculating orbit and continuing from there, a process known as rectification . 11  12  Letting   𝝆   𝝆   \boldsymbol{\rho}   be the radius vector of the osculating orbit ,   𝐫   𝐫   \mathbf{r}   the radius vector of the perturbed orbit, and    δ  𝐫      δ  𝐫    \delta\mathbf{r}   the variation from the osculating orbit,  = \mathbf{\ddot{r}} - \boldsymbol{\ddot{\rho}}.| 2 }}      𝐫  ¨     normal-¨  𝐫    \mathbf{\ddot{r}}   and    𝝆  ¨     bold-¨  𝝆    \boldsymbol{\ddot{\rho}}   are just the equations of motion of   𝐫   𝐫   \mathbf{r}   and   𝝆   𝝆   \boldsymbol{\rho}   ,  = \mathbf{a}_{\text{per}} - {\mu \over r^3} \mathbf{r} for the perturbed orbit and | 3 }}  = - {\mu \over \rho^3} \boldsymbol{\rho} for the unperturbed orbit,| 4 }}  where    μ  =   G   (   M  +  m   )        μ    G    M  m      \mu=G(M+m)   is the gravitational parameter with   M   M   M   and   m   m   m   the masses of the central body and the perturbed body,    𝐚  per     subscript  𝐚  per    \mathbf{a}_{\text{per}}   is the perturbing acceleration , and   r   r   r   and   ρ   ρ   \rho   are the magnitudes of   𝐫   𝐫   \mathbf{r}   and   𝝆   𝝆   \boldsymbol{\rho}   .  Substituting from equations () and () into equation (),  = \mathbf{a}_{\text{per}} + \mu \left( {\boldsymbol{\rho} \over \rho^3} - {\mathbf{r} \over r^3} \right), | 5 }}  which, in theory, could be integrated twice to find    δ  𝐫      δ  𝐫    \delta\mathbf{r}   . Since the osculating orbit is easily calculated by two-body methods,   𝝆   𝝆   \boldsymbol{\rho}   and    δ  𝐫      δ  𝐫    \delta\mathbf{r}   are accounted for and   𝐫   𝐫   \mathbf{r}   can be solved. In practice, the quantity in the brackets,     𝝆   ρ  3    -   𝐫   r  3          𝝆   superscript  ρ  3      𝐫   superscript  r  3      {\boldsymbol{\rho}\over\rho^{3}}-{\mathbf{r}\over r^{3}}   , is the difference of two nearly equal vectors, and further manipulation is necessary to avoid the need for extra significant digits . 13 14  Sperling–Burdet method  In 1991 Victor R. Bond and Michael F. Fraietta created an efficient and highly accurate method for solving the two-body perturbed problem. 15 This method uses the linearized and regularized differential equations of motion derived by Hans Sperling and a perturbation theory based on these equations developed by C.A. Burdet. In 1973, Bond and Hanssen improved Burdet's set of differential equations by using the total energy of the perturbed system as a parameter instead of the two-body energy and by reducing the number of elements to 13. In 1989 Bond and Gottlieb embedded the Jacobian integral, which is a constant when the potential function is explicitly dependent upon time as well as position in the Newtonian equations. The Jacobian constant was used as an element to replace the total energy in a reformulation of the differential equations of motion. In this process, another element which is proportional to a component of the angular momentum is introduced. This brought the total number of elements back to 14. In 1991, Bond and Fraietta made further revisions by replacing the Laplace vector with another vector integral as well as another scalar integral which removed small secular terms which appeared in the differential equations for some of the elements. 16  The Sperling–Burdet method is executed in a 5 step process as follows: 17   Step 1: Initialization   Given an initial position,    𝐫  0     subscript  𝐫  0    \mathbf{r}_{0}   , an initial velocity,    𝐯  0     subscript  𝐯  0    \mathbf{v}_{0}   , and an initial time,    t  0     subscript  t  0    t_{0}   , the following variables are initialized:      s  =  0      s  0    s=0          r  0   =    (    𝐫  0   ⋅   𝐫  0    )    1  /  2         subscript  r  0    superscript   normal-⋅   subscript  𝐫  0    subscript  𝐫  0      1  2      r_{0}=(\mathbf{r}_{0}\cdot\mathbf{r}_{0})^{1/2}         a  =   r  0       a   subscript  r  0     a=r_{0}         b  =    𝐫  0   ⋅   𝐯  0        b   normal-⋅   subscript  𝐫  0    subscript  𝐯  0      b=\mathbf{r}_{0}\cdot\mathbf{v}_{0}         τ  =   t  0       τ   subscript  t  0     \tau=t_{0}         𝜶  =   𝐫  0       𝜶   subscript  𝐫  0     \boldsymbol{\alpha}=\mathbf{r}_{0}         𝜷  =   a   𝐯  0        𝜷    a   subscript  𝐯  0      \boldsymbol{\beta}=a\mathbf{v}_{0}     Perturbations due to perturbing masses, defined as    V  0     subscript  V  0    V_{0}   and     [    ∂  V    ∂  𝐫    ]   0     subscript   delimited-[]      V     𝐫     0    \Bigg[{\partial{V}\over{\partial{\mathbf{r}}}}\Bigg]_{0}   , are evaluated  Perturbations due to other accelerations, defined as    𝐏  0     subscript  𝐏  0    \mathbf{P}_{0}   , are evaluated       α  J   =     2  μ    r  0    -    𝐯  0   ⋅   𝐯  0    -   2   V  0          subscript  α  J         2  μ    subscript  r  0     normal-⋅   subscript  𝐯  0    subscript  𝐯  0      2   subscript  V  0       \alpha_{J}=\frac{2\mu}{r_{0}}-\mathbf{v}_{0}\cdot\mathbf{v}_{0}-2V_{0}         γ  =   μ  -    α  J   α        γ    μ     subscript  α  J   α      \gamma=\mu-\alpha_{J}\alpha         𝜹  =     -    (    𝐯  0   ⋅   𝐯  0    )    𝐫  0     +    (    𝐫  0   ⋅   𝐯  0    )    𝐯  0    +    μ   r  0     𝐫  0     -    α  J    𝐫  0         𝜹           normal-⋅   subscript  𝐯  0    subscript  𝐯  0     subscript  𝐫  0        normal-⋅   subscript  𝐫  0    subscript  𝐯  0     subscript  𝐯  0        μ   subscript  r  0     subscript  𝐫  0        subscript  α  J    subscript  𝐫  0       \boldsymbol{\delta}=-(\mathbf{v}_{0}\cdot\mathbf{v}_{0})\mathbf{r}_{0}+(%
 \mathbf{r}_{0}\cdot\mathbf{v}_{0})\mathbf{v}_{0}+\frac{\mu}{r_{0}}\mathbf{r}_{%
 0}-\alpha_{J}\mathbf{r}_{0}         σ  =  0      σ  0    \sigma=0       Step 2: Transform Elements to Coordinates      𝐫  =   𝜶  +   𝜷  s   c  1    +   𝜹   s  2    c  2         𝐫    𝜶    𝜷  s   subscript  c  1      𝜹   superscript  s  2    subscript  c  2       \mathbf{r}=\boldsymbol{\alpha}+\boldsymbol{\beta}sc_{1}+\boldsymbol{\delta}s^{%
 2}c_{2}          𝐫  ′   =    𝜷   c  0    +   𝜹  s   c  1          superscript  𝐫  normal-′       𝜷   subscript  c  0      𝜹  s   subscript  c  1       \mathbf{r^{\prime}}=\boldsymbol{\beta}c_{0}+\boldsymbol{\delta}sc_{1}          𝐱  3   =     α  j    (   𝜶  -  𝐫   )    +  𝜹        subscript  𝐱  3        subscript  α  j     𝜶  𝐫    𝜹     \mathbf{x}_{3}=\alpha_{j}(\boldsymbol{\alpha}-\mathbf{r})+\boldsymbol{\delta}         γ  =   μ  -    α  j   a        γ    μ     subscript  α  j   a      \gamma=\mu-\alpha_{j}a         r  =   a  +   b  s   c  1    +   γ   s  2    c  2         r    a    b  s   subscript  c  1      γ   superscript  s  2    subscript  c  2       r=a+bsc_{1}+\gamma s^{2}c_{2}         𝐯  =    𝐫  ′   /  r       𝐯     superscript  𝐫  normal-′   r     \mathbf{v}=\mathbf{r^{\prime}}/r          r  ′   =    b   c  0    +   γ  s   c  1          superscript  r  normal-′       b   subscript  c  0      γ  s   subscript  c  1       r^{\prime}=bc_{0}+\gamma sc_{1}         t  =   τ  +   a  s   +   b   s  2    c  2    +   γ   s  3    c  3         t    τ    a  s     b   superscript  s  2    subscript  c  2      γ   superscript  s  3    subscript  c  3       t=\tau+as+bs^{2}c_{2}+\gamma s^{3}c_{3}      where     c  0   ,   c  1   ,   c  2   ,   c  3       subscript  c  0    subscript  c  1    subscript  c  2    subscript  c  3     c_{0},c_{1},c_{2},c_{3}   are Stumpff functions     Step 3: Evaluate Differential Equations for the Elements      𝐅  =   𝐏  -    ∂  V    ∂  𝐫         𝐅    𝐏      V     𝐫       \mathbf{F}=\mathbf{P}-{\partial{V}\over\partial{\mathbf{r}}}         𝐐  =     r  2   𝐅   +   2  𝐫   (    -  V   +  σ   )         𝐐       superscript  r  2   𝐅     2  𝐫      V   σ       \mathbf{Q}=r^{2}\mathbf{F}+2\mathbf{r}(-V+\sigma)          α  j  ′   =    2   (    -   𝐫  ′    +    r  𝝎   ×  𝐫    )    ⋅  𝐏        subscript   superscript  α  normal-′   j    normal-⋅    2       superscript  𝐫  normal-′        r  𝝎   𝐫     𝐏     \alpha^{\prime}_{j}=2(-\mathbf{r^{\prime}}+r\boldsymbol{\omega}\times\mathbf{r%
 })\cdot\mathbf{P}          μ   ϵ  ′    =    2   (    𝐫  ′   ⋅  𝐅   )   𝐫   -    (   𝐫  ⋅  𝐅   )    𝐫  ′    -    (   𝐫  ⋅   𝐫  ′    )   𝐅          μ   superscript  bold-italic-ϵ  normal-′        2   normal-⋅   superscript  𝐫  normal-′   𝐅   𝐫      normal-⋅  𝐫  𝐅    superscript  𝐫  normal-′       normal-⋅  𝐫   superscript  𝐫  normal-′    𝐅      \mu\boldsymbol{\epsilon}^{\prime}=2(\mathbf{r^{\prime}}\cdot\mathbf{F})\mathbf%
 {r}-(\mathbf{r}\cdot\mathbf{F})\mathbf{r^{\prime}}-(\mathbf{r}\cdot\mathbf{r^{%
 \prime}})\mathbf{F}          𝜶  ′   =    -   𝐐  s   c  1     -   μ   ϵ  ′    s  2    c  2    -    α  j  ′    [    𝜶   s  2    c  2    +   2  𝜷   s  3     c  ¯   3    +    1  2   𝜹   s  4    c  2  2     ]          superscript  𝜶  normal-′         𝐐  s   subscript  c  1       μ   superscript  bold-italic-ϵ  normal-′    superscript  s  2    subscript  c  2       subscript   superscript  α  normal-′   j    delimited-[]      𝜶   superscript  s  2    subscript  c  2      2  𝜷   superscript  s  3    subscript   normal-¯  c   3        1  2   𝜹   superscript  s  4    subscript   superscript  c  2   2          \boldsymbol{\alpha}^{\prime}=-\mathbf{Q}sc_{1}-\mu\boldsymbol{\epsilon}^{%
 \prime}s^{2}c_{2}-\alpha^{\prime}_{j}\big[\boldsymbol{\alpha}s^{2}c_{2}+2%
 \boldsymbol{\beta}s^{3}\bar{c}_{3}+\frac{1}{2}\boldsymbol{\delta}s^{4}c^{2}_{2%
 }\big]          𝜷  ′   =    𝐐   c  0    +   μ   ϵ  ′   s   c  1    +    α  j  ′    [     𝜶  s   c  1    +   𝜷   s  2     c  ¯   2     -   𝜹   s  3    (    2    c  ¯   3    -    c  1    c  2     )     ]          superscript  𝜷  normal-′       𝐐   subscript  c  0      μ   superscript  bold-italic-ϵ  normal-′   s   subscript  c  1       subscript   superscript  α  normal-′   j    delimited-[]        𝜶  s   subscript  c  1      𝜷   superscript  s  2    subscript   normal-¯  c   2       𝜹   superscript  s  3       2   subscript   normal-¯  c   3       subscript  c  1    subscript  c  2            \boldsymbol{\beta}^{\prime}=\mathbf{Q}c_{0}+\mu\boldsymbol{\epsilon}^{\prime}%
 sc_{1}+\alpha^{\prime}_{j}\big[\boldsymbol{\alpha}sc_{1}+\boldsymbol{\beta}s^{%
 2}\bar{c}_{2}-\boldsymbol{\delta}s^{3}(2\bar{c}_{3}-c_{1}c_{2})\big]          𝜹  ′   =     𝐐   α  j   s   c  1    -   μ   ϵ  ′    c  0     +    α  j  ′    [    -   𝜶   c  0     +   2   α  j   𝜷   s  3     c  ¯   3    +    1  2   𝜹   α  j    s  4    c  2  2     ]          superscript  𝜹  normal-′         𝐐   subscript  α  j   s   subscript  c  1      μ   superscript  bold-italic-ϵ  normal-′    subscript  c  0        subscript   superscript  α  normal-′   j    delimited-[]        𝜶   subscript  c  0       2   subscript  α  j   𝜷   superscript  s  3    subscript   normal-¯  c   3        1  2   𝜹   subscript  α  j    superscript  s  4    subscript   superscript  c  2   2          \boldsymbol{\delta}^{\prime}=\mathbf{Q}\alpha_{j}sc_{1}-\mu\boldsymbol{%
 \epsilon}^{\prime}c_{0}+\alpha^{\prime}_{j}\big[-\boldsymbol{\alpha}c_{0}+2%
 \alpha_{j}\boldsymbol{\beta}s^{3}\bar{c}_{3}+\frac{1}{2}\boldsymbol{\delta}%
 \alpha_{j}s^{4}c^{2}_{2}\big]          σ  ′   =     r  𝝎   ⋅  𝐫   ×  𝐅        superscript  σ  normal-′      normal-⋅    r  𝝎   𝐫   𝐅     \sigma^{\prime}=r\boldsymbol{\omega}\cdot\mathbf{r}\times\mathbf{F}          a  ′   =    -      1  r   𝐫   ⋅  𝐐   s   c  1     -    α  j  ′    [    a   s  2    c  2    +   2  b   s  3     c  ¯   3    +    1  2   γ   s  4    c  2  2     ]          superscript  a  normal-′          normal-⋅      1  r   𝐫   𝐐   s   subscript  c  1        superscript   subscript  α  j   normal-′    delimited-[]      a   superscript  s  2    subscript  c  2      2  b   superscript  s  3    subscript   normal-¯  c   3        1  2   γ   superscript  s  4    subscript   superscript  c  2   2          a^{\prime}=-\frac{1}{r}\mathbf{r}\cdot\mathbf{Q}sc_{1}-\alpha_{j}^{\prime}\big%
 [as^{2}c_{2}+2bs^{3}\bar{c}_{3}+\frac{1}{2}\gamma s^{4}c^{2}_{2}\big]          b  ′   =       1  r   𝐫   ⋅  𝐐    c  0    +    α  j  ′    [     a  s   c  1    +   b   s  2     c  ¯   2     -   γ   s  3    (    2    c  ¯   3    -    c  1    c  2     )     ]          superscript  b  normal-′        normal-⋅      1  r   𝐫   𝐐    subscript  c  0       superscript   subscript  α  j   normal-′    delimited-[]        a  s   subscript  c  1      b   superscript  s  2    subscript   normal-¯  c   2       γ   superscript  s  3       2   subscript   normal-¯  c   3       subscript  c  1    subscript  c  2            b^{\prime}=\frac{1}{r}\mathbf{r}\cdot\mathbf{Q}c_{0}+\alpha_{j}^{\prime}\big[%
 asc_{1}+bs^{2}\bar{c}_{2}-\gamma s^{3}(2\bar{c}_{3}-c_{1}c_{2})\big]          γ  ′   =    -      1  r   𝐫   ⋅  𝐐    α  j   s   c  1     +    α  j  ′    [    -   a   c  0     +   2  b   α  j    s  3     c  ¯   3    +    1  2   γ   α  j    s  4    c  2  2     ]          superscript  γ  normal-′          normal-⋅      1  r   𝐫   𝐐    subscript  α  j   s   subscript  c  1        superscript   subscript  α  j   normal-′    delimited-[]        a   subscript  c  0       2  b   subscript  α  j    superscript  s  3    subscript   normal-¯  c   3        1  2   γ   subscript  α  j    superscript  s  4    subscript   superscript  c  2   2          \gamma^{\prime}=-\frac{1}{r}\mathbf{r}\cdot\mathbf{Q}\alpha_{j}sc_{1}+\alpha_{%
 j}^{\prime}\big[-ac_{0}+2b\alpha_{j}s^{3}\bar{c}_{3}+\frac{1}{2}\gamma\alpha_{%
 j}s^{4}c^{2}_{2}\big]          τ  ′   =       1  r   𝐫   ⋅  𝐐    s  2    c  2    +    α  j  ′    [     a   s  3    c  3    +    1  2   b   s  4    c  2  2     -   2  γ   s  5    (    c  5   -   4    c  ¯   5     )     ]          superscript  τ  normal-′        normal-⋅      1  r   𝐫   𝐐    superscript  s  2    subscript  c  2       superscript   subscript  α  j   normal-′    delimited-[]        a   superscript  s  3    subscript  c  3        1  2   b   superscript  s  4    subscript   superscript  c  2   2       2  γ   superscript  s  5      subscript  c  5     4   subscript   normal-¯  c   5            \tau^{\prime}=\frac{1}{r}\mathbf{r}\cdot\mathbf{Q}s^{2}c_{2}+\alpha_{j}^{%
 \prime}\big[as^{3}c_{3}+\frac{1}{2}bs^{4}c^{2}_{2}-2\gamma s^{5}(c_{5}-4\bar{c%
 }_{5})\big]      Step 4: Integration   Here the differential equations are integrated over a period    Δ  s      normal-Δ  s    \Delta s   to obtain the element value at    s  +   Δ  s       s    normal-Δ  s     s+\Delta s       Step 5: Advance   Set    s  =   s  +   Δ  s        s    s    normal-Δ  s      s=s+\Delta s   and return to step 2 until simulation stopping conditions are met.     Models of perturbing forces  Perturbing forces cause orbits to become perturbed from a perfect Keplerian orbit. Models for each of these forces are created and executed during the orbit simulation so their effects on the orbit can be determined.  Non-spherical gravity  The Earth is not a perfect sphere nor is mass evenly distributed within the Earth. This results in the point-mass gravity model being inaccurate for orbits around the Earth, particularly Low Earth orbits . To account for variations in gravitational potential around the surface of the Earth, the gravitational field of the Earth is modeled with spherical harmonics 18 which are expressed through the equation:      𝐟  =    -    μ   R  2     𝐫  ^     +    ∑   n  =  2   ∞     ∑   m  =  0   n    𝐟   n  ,  m           𝐟          μ   superscript  R  2     normal-^  𝐫       superscript   subscript     n  2        superscript   subscript     m  0    n    subscript  𝐟   n  m         {\mathbf{f}}=-\frac{\mu}{R^{2}}\mathbf{\hat{r}}+\sum_{n=2}^{\infty}\sum_{m=0}^%
 {n}{\mathbf{f}}_{n,m}   where     μ   μ   {\mu}   is the gravitational parameter defined as the product of G, the universal gravitational constant , and the mass of the primary body.      𝐫  ^     normal-^  𝐫    \mathbf{\hat{r}}   is the unit vector defining the distance between the primary and secondary bodies, with   R   R   {R}   being the magnitude of the distance.      𝐟   n  ,  m      subscript  𝐟   n  m     {\mathbf{f}}_{n,m}   represents the contribution to   𝐟   𝐟   {\mathbf{f}}   of the spherical harmonic of degree n and order m , which is defined as: 19      𝐟   n  ,  m      subscript  𝐟   n  m     \displaystyle\mathbf{f}_{n,m}     where:      R  O     subscript  R  O    R_{O}   is the mean equatorial radius of the primary body.     R   R   R   is the magnitude of the position vector from the center of the primary body to the center of the secondary body.      C   n  ,  m      subscript  C   n  m     C_{n,m}   and    S   n  ,  m      subscript  S   n  m     S_{n,m}   are gravitational coefficients of degree n and order m . These are typically found through gravimetry measurements.   The unit vectors      𝐞  ^   1   ,    𝐞  ^   2   ,    𝐞  ^   3       subscript   normal-^  𝐞   1    subscript   normal-^  𝐞   2    subscript   normal-^  𝐞   3     \mathbf{\hat{e}}_{1},\mathbf{\hat{e}}_{2},\mathbf{\hat{e}}_{3}   define a coordinate system fixed on the primary body. For the Earth,     𝐞  ^   1     subscript   normal-^  𝐞   1    \mathbf{\hat{e}}_{1}   lies in the equatorial plane parallel to a line intersecting Earth's geometric center and the Greenwich meridian ,     𝐞  ^   3     subscript   normal-^  𝐞   3    \mathbf{\hat{e}}_{3}   points in the direction of the North polar axis, and      𝐞  ^   2   =     𝐞  ^   3   ×    𝐞  ^   1         subscript   normal-^  𝐞   2      subscript   normal-^  𝐞   3    subscript   normal-^  𝐞   1      \mathbf{\hat{e}}_{2}=\mathbf{\hat{e}}_{3}\times\mathbf{\hat{e}}_{1}         A   n  ,  m      subscript  A   n  m     A_{n,m}   is referred to as a derived Legendre polynomial of degree n and order m . They are solved through the recurrence relation       A   n  ,  m     (  u  )    =    1   n  -  m     (     (    2  n   -  1   )   u   A    n  -  1   ,  m     (  u  )    -    (    n  +  m   -  1   )    A    n  -  2   ,  m     (  u  )     )           subscript  A   n  m    u       1    n  m            2  n   1   u   subscript  A     n  1   m    u         n  m   1    subscript  A     n  2   m    u       A_{n,m}(u)=\frac{1}{n-m}((2n-1)uA_{n-1,m}(u)-(n+m-1)A_{n-2,m}(u))         s  λ     subscript  s  λ    s_{\lambda}   is sine of the geographic latitude of the secondary body, which is     𝐫  ^   ⋅    𝐞  ^   3      normal-⋅   normal-^  𝐫    subscript   normal-^  𝐞   3     \mathbf{\hat{r}}\cdot\mathbf{\hat{e}}_{3}   .       𝒞  m   ,   𝒮  m       subscript  𝒞  m    subscript  𝒮  m     \mathcal{C}_{m},\mathcal{S}_{m}   are defined with the following recurrence relation and initial conditions      𝒞  m   =     𝒞  1    𝒞   m  -  1     -    𝒮  1    𝒮   m  -  1       ,     𝒮  m   =     𝒮  1    𝒞   m  -  1     +    𝒞  1    𝒮   m  -  1       ,     𝒮  0   =  0   ,     𝒮  1   =   𝐑  ⋅    𝐞  ^   2     ,     𝒞  0   =  1   ,    𝒞  1   =   𝐑  ⋅    𝐞  ^   1            formulae-sequence     subscript  𝒞  m        subscript  𝒞  1    subscript  𝒞    m  1        subscript  𝒮  1    subscript  𝒮    m  1        formulae-sequence     subscript  𝒮  m        subscript  𝒮  1    subscript  𝒞    m  1        subscript  𝒞  1    subscript  𝒮    m  1        formulae-sequence     subscript  𝒮  0   0    formulae-sequence     subscript  𝒮  1    normal-⋅  𝐑   subscript   normal-^  𝐞   2      formulae-sequence     subscript  𝒞  0   1      subscript  𝒞  1    normal-⋅  𝐑   subscript   normal-^  𝐞   1           \mathcal{C}_{m}=\mathcal{C}_{1}\mathcal{C}_{m-1}-\mathcal{S}_{1}\mathcal{S}_{m%
 -1},\mathcal{S}_{m}=\mathcal{S}_{1}\mathcal{C}_{m-1}+\mathcal{C}_{1}\mathcal{S%
 }_{m-1},\mathcal{S}_{0}=0,\mathcal{S}_{1}=\mathbf{R}\cdot\mathbf{\hat{e}}_{2},%
 \mathcal{C}_{0}=1,\mathcal{C}_{1}=\mathbf{R}\cdot\mathbf{\hat{e}}_{1}      When modeling perturbations of an orbit around a primary body only the sum of the    𝐟   n  ,  m      subscript  𝐟   n  m     {\mathbf{f}}_{n,m}   terms need to be included in the perturbation since the point-mass gravity model is accounted for in the    -    μ   R  2     𝐫  ^            μ   superscript  R  2     normal-^  𝐫      -\frac{\mu}{R^{2}}\mathbf{\hat{r}}   term  Third-body perturbations  Gravitational forces from third bodies can cause perturbations to an orbit. For example, the Sun and Moon cause perturbations to Orbits around the Earth. 20 These forces are modeled in the same way that gravity is modeled for the primary body by means of Direct gravitational N-body simulations . Typically, only a spherical point-mass gravity model is used for modeling effects from these third bodies. 21 Some special cases of third-body perturbations have approximate analytic solutions. For example, perturbations for the right ascension of the ascending node and argument of perigee for a circular Earth orbit are: 22        Ω  ˙   MOON   =   -    0.00338   (   cos   (  i  )    )    /  n         subscript   normal-˙  normal-Ω   MOON         0.00338    i    n      \dot{\Omega}_{\mathrm{MOON}}=-0.00338(\cos(i))/n           ω  ˙   MOON   =   -    0.00169   (   4  -   5    sin  2    (  i  )      )    /  n         subscript   normal-˙  ω   MOON         0.00169    4    5    superscript   2   i      n      \dot{\omega}_{\mathrm{MOON}}=-0.00169(4-5\sin^{2}(i))/n      where:      Ω  ˙     normal-˙  normal-Ω    \dot{\Omega}   is the change to the right ascension of the ascending node in degrees per day.      ω  ˙     normal-˙  ω    \dot{\omega}   is the change to the argument of perigee in degrees per day.     i   i   i   is the orbital inclination.     n   n   n   is the number of orbital revolutions per day.   Solar radiation  Solar radiation pressure causes perturbations to orbits. The magnitude of acceleration it imparts to a spacecraft in Earth orbit is modeled using the equation below: 23       a  R   ≈   -     4.5  ×   10   -  6      (   1  +  r   )   A   /  m         subscript  a  R           4.5   superscript  10    6       1  r   A   m      a_{R}\approx-4.5\times 10^{-6}(1+r)A/m   where:      a  R     subscript  a  R    a_{R}   is the magnitude of acceleration in meters per second-squared.     A   A   A   is the cross-sectional area exposed to the Sun in meters-squared.     m   m   m   is the spacecraft mass in kilograms .     r   r   r   is the reflection factor which depends on material properties.    r  =  0      r  0    r=0   for absorption,    r  =  1      r  1    r=1   for specular reflection, and    r  ≈  0.4      r  0.4    r\approx 0.4   for diffuse reflection.  For orbits around the Earth, solar radiation pressure becomes a stronger force than drag above 800 km altitude. 24  Propulsion  There are many different types of spacecraft propulsion. Rocket engines are one of the most widely used. The force of a rocket engine is modeled by the equation: 25       F  n   =     m  ˙     v  e    =      m  ˙     v  e-act    +    A  e    (    p  e   -   p  amb    )            subscript  F  n      normal-˙  m    subscript  v  e              normal-˙  m    subscript  v  e-act       subscript  A  e      subscript  p  e    subscript  p  amb         F_{n}=\dot{m}\;v_{\text{e}}=\dot{m}\;v_{\text{e-act}}+A_{\text{e}}(p_{\text{e}%
 }-p_{\text{amb}})           where:            m  ˙     normal-˙  m    \dot{m}      =  exhaust gas mass flow         v  e     subscript  v  e    v_{\text{e}}      =  effective exhaust velocity         v  e-act     subscript  v  e-act    v_{\text{e-act}}      =  actual jet velocity at nozzle exit plane         A  e     subscript  A  e    A_{\text{e}}      =  flow area at nozzle exit plane (or the plane where the jet leaves the nozzle if separated flow)         p  e     subscript  p  e    p_{\text{e}}      =  static pressure at nozzle exit plane         p  amb     subscript  p  amb    p_{\text{amb}}      =  ambient (or atmospheric) pressure       Another possible method is a solar sail . Solar sails use radiation pressure in a way to achieve a desired propulsive force. 26 The perturbation model due to the solar wind can be used as a model of propulsive force from a solar sail.  Drag  The primary non-gravitational force acting on satellites in low Earth orbit is atmospheric drag. 27 Drag will act in opposition to the direction of velocity and remove energy from an orbit. The force due to drag is modeled by the following equation:         F  D    =      1  2      ρ     v  2      C  d    A    ,       subscript  F  D       1  2   ρ   superscript  v  2    subscript  C  d   A     F_{D}\,=\,\tfrac{1}{2}\,\rho\,v^{2}\,C_{d}\,A,     where      𝐅  D     subscript  𝐅  D    \mathbf{F}_{D}   is the force of drag,     ρ   ρ   \mathbf{}\rho   is the density of the fluid, 28     v   v   \mathbf{}v   is the velocity of the object relative to the fluid,      C  d     subscript  C  d    \mathbf{}C_{d}   is the drag coefficient (a dimensionless  parameter , e.g. 2 to 4 for most satellites 29 )     A   A   \mathbf{}A   is the reference area .  Orbits with an altitude below 120 km generally have such high drag that the orbits decay too rapidly to give a satellite a sufficient lifetime to accomplish any practical mission. On the other hand, orbits with an altitude above 600 km have relatively small drag so that the orbit decays slow enough that it has no real impact on the satellite over its useful life. 30  Density of air can vary significantly in the thermosphere where most low Earth orbiting satellites reside. The variation is primarily due to solar activity, and thus solar activity can greatly influence the force of drag on a spacecraft and complicate long-term orbit simulation. 31  Magnetic fields  Magnetic fields can play a significant role as a source of orbit perturbation as was seen in the Long Duration Exposure Facility . 32 Like gravity, the magnetic field of the Earth can be expressed through spherical harmonics as shown below: 33      𝐁  =    ∑   n  =  1   ∞     ∑   m  =  0   n    𝐁   n  ,  m          𝐁    superscript   subscript     n  1        superscript   subscript     m  0    n    subscript  𝐁   n  m        {\mathbf{B}}=\sum_{n=1}^{\infty}\sum_{m=0}^{n}{\mathbf{B}}_{n,m}   where     𝐁   𝐁   {\mathbf{B}}   is the magnetic field vector at a point above the Earth's surface.      𝐁   n  ,  m      subscript  𝐁   n  m     {\mathbf{B}}_{n,m}   represents the contribution to   𝐁   𝐁   {\mathbf{B}}   of the spherical harmonic of degree n and order m , defined as: 34      𝐁   n  ,  m      subscript  𝐁   n  m     \displaystyle\mathbf{B}_{n,m}     where:     a   a   a   is the mean equatorial radius of the primary body.     R   R   R   is the magnitude of the position vector from the center of the primary body to the center of the secondary body.      𝐫  ^     normal-^  𝐫    \mathbf{\hat{r}}   is a unit vector in the direction of the secondary body with its origin at the center of the primary body.      g   n  ,  m      subscript  g   n  m     g_{n,m}   and    h   n  ,  m      subscript  h   n  m     h_{n,m}   are Gauss coefficients of degree n and order m . These are typically found through magnetic field measurements.   The unit vectors      𝐞  ^   1   ,    𝐞  ^   2   ,    𝐞  ^   3       subscript   normal-^  𝐞   1    subscript   normal-^  𝐞   2    subscript   normal-^  𝐞   3     \mathbf{\hat{e}}_{1},\mathbf{\hat{e}}_{2},\mathbf{\hat{e}}_{3}   define a coordinate system fixed on the primary body. For the Earth,     𝐞  ^   1     subscript   normal-^  𝐞   1    \mathbf{\hat{e}}_{1}   lies in the equatorial plane parallel to a line intersecting Earth's geometric center and the Greenwich meridian ,     𝐞  ^   3     subscript   normal-^  𝐞   3    \mathbf{\hat{e}}_{3}   points in the direction of the North polar axis, and      𝐞  ^   2   =     𝐞  ^   3   ×    𝐞  ^   1         subscript   normal-^  𝐞   2      subscript   normal-^  𝐞   3    subscript   normal-^  𝐞   1      \mathbf{\hat{e}}_{2}=\mathbf{\hat{e}}_{3}\times\mathbf{\hat{e}}_{1}         A   n  ,  m      subscript  A   n  m     A_{n,m}   is referred to as a derived Legendre polynomial of degree n and order m . They are solved through the recurrence relation      A   n  ,  m     (  u  )    =    1   n  -  m     (     (    2  n   -  1   )   u   A    n  -  1   ,  m     (  u  )    -    (    n  +  m   -  1   )    A    n  -  2   ,  m     (  u  )     )           subscript  A   n  m    u       1    n  m            2  n   1   u   subscript  A     n  1   m    u         n  m   1    subscript  A     n  2   m    u       A_{n,m}(u)=\frac{1}{n-m}((2n-1)uA_{n-1,m}(u)-(n+m-1)A_{n-2,m}(u))         K   n  ,  m      subscript  K   n  m     K_{n,m}   is defined as: 1 if m = 0,      [    n  -  m    n  +  m    ]   0.5    K    n  -  1   ,  m         superscript   delimited-[]      n  m     n  m     0.5    subscript  K     n  1   m      \big[\frac{n-m}{n+m}\big]^{0.5}K_{n-1,m}   for    n  ≥   (   m  +  1   )       n    m  1     n\geq(m+1)   and    m  =   [   1  …  ∞   ]       m   delimited-[]    1  normal-…       m=[1\ldots\infty]   , and      [    (   n  +  m   )    (    n  -  m   +  1   )    ]    -  0.5     K   n  ,   m  -  1          superscript   delimited-[]      n  m       n  m   1       0.5     subscript  K   n    m  1       [(n+m)(n-m+1)]^{-0.5}K_{n,m-1}   for    n  ≥  m      n  m    n\geq m   and    m  =   [   2  …  ∞   ]       m   delimited-[]    2  normal-…       m=[2\ldots\infty]         s  λ     subscript  s  λ    s_{\lambda}   is sine of the geographic latitude of the secondary body, which is     𝐫  ^   ⋅    𝐞  ^   3      normal-⋅   normal-^  𝐫    subscript   normal-^  𝐞   3     \mathbf{\hat{r}}\cdot\mathbf{\hat{e}}_{3}   .       𝒞  m   ,   𝒮  m       subscript  𝒞  m    subscript  𝒮  m     \mathcal{C}_{m},\mathcal{S}_{m}   are defined with the following recurrence relation and initial conditions      𝒞  m   =     𝒞  1    𝒞   m  -  1     -    𝒮  1    𝒮   m  -  1       ,     𝒮  m   =     𝒮  1    𝒞   m  -  1     +    𝒞  1    𝒮   m  -  1       ,     𝒮  0   =  0   ,     𝒮  1   =   𝐑  ⋅    𝐞  ^   2     ,     𝒞  0   =  1   ,    𝒞  1   =   𝐑  ⋅    𝐞  ^   1            formulae-sequence     subscript  𝒞  m        subscript  𝒞  1    subscript  𝒞    m  1        subscript  𝒮  1    subscript  𝒮    m  1        formulae-sequence     subscript  𝒮  m        subscript  𝒮  1    subscript  𝒞    m  1        subscript  𝒞  1    subscript  𝒮    m  1        formulae-sequence     subscript  𝒮  0   0    formulae-sequence     subscript  𝒮  1    normal-⋅  𝐑   subscript   normal-^  𝐞   2      formulae-sequence     subscript  𝒞  0   1      subscript  𝒞  1    normal-⋅  𝐑   subscript   normal-^  𝐞   1           \mathcal{C}_{m}=\mathcal{C}_{1}\mathcal{C}_{m-1}-\mathcal{S}_{1}\mathcal{S}_{m%
 -1},\mathcal{S}_{m}=\mathcal{S}_{1}\mathcal{C}_{m-1}+\mathcal{C}_{1}\mathcal{S%
 }_{m-1},\mathcal{S}_{0}=0,\mathcal{S}_{1}=\mathbf{R}\cdot\mathbf{\hat{e}}_{2},%
 \mathcal{C}_{0}=1,\mathcal{C}_{1}=\mathbf{R}\cdot\mathbf{\hat{e}}_{1}      See also   Perturbation (astronomy)  Osculating orbit  Orbital resonance  n-body problem  two-body problem  sphere of influence (astrodynamics)   Notes and references  External links   1 Gravity maps of the Earth   "  Category:Orbital perturbations  Category:Dynamical systems  Category:Dynamics of the Solar System      ↩  ↩    see, for instance, Jet Propulsion Laboratory Development Ephemeris ↩  So named for Philip H. Cowell , who, with A.C.D. Cromellin, used a similar method to predict the return of Halley's comet. ↩  ↩  ↩  So named for Johann Franz Encke ; ↩   Battin (1999), sec. 10.2. ↩  Bate, Mueller, White (1971), sec. 9.3. ↩  Roy (1988), sec. 7.4. ↩  ↩  ↩   ↩   ↩  ↩     See Equation 2-14. ↩  ↩   Note that for the Earth's atmosphere , the air density can be found using the barometric formula . It is 1.293 kg/m 3 at 0 °C and 1 atmosphere . ↩           
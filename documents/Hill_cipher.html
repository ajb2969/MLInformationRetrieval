<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1680">Hill cipher</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Hill cipher</h1>
<hr/>

<p> In <a href="classical_cryptography" title="wikilink">classical cryptography</a>, the <strong>Hill cipher</strong> is a <a href="substitution_cipher#Polygraphic" title="wikilink">polygraphic substitution cipher</a> based on <a href="linear_algebra" title="wikilink">linear algebra</a>. Invented by <a href="Lester_S._Hill" title="wikilink">Lester S. Hill</a> in 1929, it was the first polygraphic cipher in which it was practical (though barely) to operate on more than three symbols at once. The following discussion assumes an elementary knowledge of <a href="matrix_(mathematics)" title="wikilink">matrices</a>.</p>
<h2 id="operation">Operation</h2>

<p>Each letter is represented by a number <a href="arithmetic" title="wikilink">modulo</a> 26. (Often the simple scheme A = 0, B = 1, ..., Z = 25 is used, but this is not an essential feature of the cipher.) To encrypt a message, each block of <em>n</em> letters (considered as an <em>n</em>-component <a href="vector_space" title="wikilink">vector</a>) is multiplied by an invertible <em>n</em> × <em>n</em> <a href="matrix_(mathematics)" title="wikilink">matrix</a>, again <a href="modular_arithmetic" title="wikilink">modulus</a> 26. To decrypt the message, each block is multiplied by the inverse of the matrix used for encryption.</p>

<p>The matrix used for encryption is the cipher <a href="key_(cryptography)" title="wikilink">key</a>, and it should be chosen randomly from the set of invertible <em>n</em> × <em>n</em> matrices (<a href="modular_arithmetic" title="wikilink">modulo</a> 26). The cipher can, of course, be adapted to an alphabet with any number of letters; all arithmetic just needs to be done <a href="modular_arithmetic" title="wikilink">modulo</a> the number of letters instead of <a href="modular_arithmetic" title="wikilink">modulo</a> 26.</p>

<p>Consider the message 'ACT', and the key below (or GYBNQKURP in letters):</p>

<p>

<math display="block" id="Hill_cipher:0">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mn>6</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>24</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>1</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>13</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>16</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>10</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>20</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>17</mn>
     </mtd>
     <mtd columnalign="center">
      <mn>15</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">6</cn>
     <cn type="integer">24</cn>
     <cn type="integer">1</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">13</cn>
     <cn type="integer">16</cn>
     <cn type="integer">10</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">20</cn>
     <cn type="integer">17</cn>
     <cn type="integer">15</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}6&24&1\\
13&16&10\\
20&17&15\end{pmatrix}
  </annotation>
 </semantics>
</math>

 Since 'A' is 0, 'C' is 2 and 'T' is 19, the message is the vector:</p>

<p>

<math display="block" id="Hill_cipher:1">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>2</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>19</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">2</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">19</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}0\\
2\\
19\end{pmatrix}
  </annotation>
 </semantics>
</math>

 Thus the enciphered vector is given by:</p>

<p>

<math display="block" id="Hill_cipher:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>6</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>24</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>13</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>20</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>67</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>222</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>319</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>14</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="integer">6</cn>
        <cn type="integer">24</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">13</cn>
        <cn type="integer">16</cn>
        <cn type="integer">10</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">20</cn>
        <cn type="integer">17</cn>
        <cn type="integer">15</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">19</cn>
       </matrixrow>
      </matrix>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">67</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">222</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">319</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <matrix>
       <matrixrow>
        <cn type="integer">15</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">14</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">7</cn>
       </matrixrow>
      </matrix>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">26</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}6&24&1\\
13&16&10\\
20&17&15\end{pmatrix}\begin{pmatrix}0\\
2\\
19\end{pmatrix}=\begin{pmatrix}67\\
222\\
319\end{pmatrix}\equiv\begin{pmatrix}15\\
14\\
7\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

 which corresponds to a <a class="uri" href="ciphertext" title="wikilink">ciphertext</a> of 'POH'. Now, suppose that our message is instead 'CAT', or:</p>

<p>

<math display="block" id="Hill_cipher:3">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mn>2</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>19</mn>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">2</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">19</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}2\\
0\\
19\end{pmatrix}
  </annotation>
 </semantics>
</math>

 This time, the enciphered vector is given by:</p>

<p>

<math display="block" id="Hill_cipher:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>6</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>24</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>13</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>20</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>31</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>216</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>325</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>13</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="integer">6</cn>
        <cn type="integer">24</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">13</cn>
        <cn type="integer">16</cn>
        <cn type="integer">10</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">20</cn>
        <cn type="integer">17</cn>
        <cn type="integer">15</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">19</cn>
       </matrixrow>
      </matrix>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">31</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">216</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">325</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <matrix>
       <matrixrow>
        <cn type="integer">5</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">8</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">13</cn>
       </matrixrow>
      </matrix>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">26</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}6&24&1\\
13&16&10\\
20&17&15\end{pmatrix}\begin{pmatrix}2\\
0\\
19\end{pmatrix}\equiv\begin{pmatrix}31\\
216\\
325\end{pmatrix}\equiv\begin{pmatrix}5\\
8\\
13\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

 which corresponds to a ciphertext of 'FIN'. Every letter has changed. The Hill cipher has achieved <a href="Claude_Elwood_Shannon" title="wikilink">Shannon</a>'s <a href="Confusion_and_diffusion" title="wikilink">diffusion</a>, and an n-dimensional Hill cipher can diffuse fully across n symbols at once.</p>
<h2 id="decryption">Decryption</h2>

<p>In order to decrypt, we turn the ciphertext back into a vector, then simply multiply by the inverse matrix of the key matrix (IFKVIVVMI in letters). (There are standard methods to calculate the inverse matrix; see <a href="matrix_inversion" title="wikilink">matrix inversion</a> for details.) We find that, <a href="modular_arithmetic" title="wikilink">modulo</a> 26, the inverse of the matrix used in the previous example is:</p>

<p>

<math display="block" id="Hill_cipher:5">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>6</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>24</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>13</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>16</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>20</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>21</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>21</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>21</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">6</cn>
       <cn type="integer">24</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">13</cn>
       <cn type="integer">16</cn>
       <cn type="integer">10</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">20</cn>
       <cn type="integer">17</cn>
       <cn type="integer">15</cn>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">8</cn>
       <cn type="integer">5</cn>
       <cn type="integer">10</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">21</cn>
       <cn type="integer">8</cn>
       <cn type="integer">21</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">21</cn>
       <cn type="integer">12</cn>
       <cn type="integer">8</cn>
      </matrixrow>
     </matrix>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">26</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}6&24&1\\
13&16&10\\
20&17&15\end{pmatrix}^{-1}\equiv\begin{pmatrix}8&5&10\\
21&8&21\\
21&12&8\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

 Taking the previous example ciphertext of 'POH', we get:</p>

<p>

<math display="block" id="Hill_cipher:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>21</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>21</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>21</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>12</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>14</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>7</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>260</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>574</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>539</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="integer">8</cn>
        <cn type="integer">5</cn>
        <cn type="integer">10</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">21</cn>
        <cn type="integer">8</cn>
        <cn type="integer">21</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">21</cn>
        <cn type="integer">12</cn>
        <cn type="integer">8</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">15</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">14</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">7</cn>
       </matrixrow>
      </matrix>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">260</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">574</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">539</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <matrix>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">19</cn>
       </matrixrow>
      </matrix>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">26</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}8&5&10\\
21&8&21\\
21&12&8\end{pmatrix}\begin{pmatrix}15\\
14\\
7\end{pmatrix}\equiv\begin{pmatrix}260\\
574\\
539\end{pmatrix}\equiv\begin{pmatrix}0\\
2\\
19\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

 which gets us back to 'ACT', just as we hoped.</p>

<p>We have not yet discussed two complications that exist in picking the encrypting matrix. Not all matrices have an inverse (see <a href="invertible_matrix" title="wikilink">invertible matrix</a>). The matrix will have an inverse if and only if its <a class="uri" href="determinant" title="wikilink">determinant</a> is not zero. Also, in the case of the Hill Cipher, the determinant of the encrypting matrix must not have any common factors with the modular base. Thus, if we work modulo 26 as above, the determinant must be nonzero, and must not be divisible by 2 or 13. If the determinant is 0, or has common factors with the modular base, then the matrix cannot be used in the Hill cipher, and another matrix must be chosen (otherwise it will not be possible to decrypt). Fortunately, matrices which satisfy the conditions to be used in the Hill cipher are fairly common.</p>

<p>For our example key matrix:</p>

<p>

<math display="block" id="Hill_cipher:7">
 <semantics>
  <mrow>
   <mrow>
    <mo>|</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>6</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>24</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>13</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>16</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>10</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>20</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>17</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>15</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>|</mo>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>6</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>16</mn>
         <mo>⋅</mo>
         <mn>15</mn>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>10</mn>
         <mo>⋅</mo>
         <mn>17</mn>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>24</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>13</mn>
         <mo>⋅</mo>
         <mn>15</mn>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>10</mn>
         <mo>⋅</mo>
         <mn>20</mn>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>1</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>13</mn>
        <mo>⋅</mo>
        <mn>17</mn>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>16</mn>
        <mo>⋅</mo>
        <mn>20</mn>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mn>441</mn>
   <mo>≡</mo>
   <mrow>
    <mn>25</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <determinant></determinant>
      <matrix>
       <matrixrow>
        <cn type="integer">6</cn>
        <cn type="integer">24</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">13</cn>
        <cn type="integer">16</cn>
        <cn type="integer">10</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">20</cn>
        <cn type="integer">17</cn>
        <cn type="integer">15</cn>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">6</cn>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-⋅</ci>
          <cn type="integer">16</cn>
          <cn type="integer">15</cn>
         </apply>
         <apply>
          <ci>normal-⋅</ci>
          <cn type="integer">10</cn>
          <cn type="integer">17</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">24</cn>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-⋅</ci>
          <cn type="integer">13</cn>
          <cn type="integer">15</cn>
         </apply>
         <apply>
          <ci>normal-⋅</ci>
          <cn type="integer">10</cn>
          <cn type="integer">20</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">13</cn>
         <cn type="integer">17</cn>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <cn type="integer">16</cn>
         <cn type="integer">20</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <cn type="integer">441</cn>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="integer">25</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">26</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{vmatrix}6&24&1\\
13&16&10\\
20&17&15\end{vmatrix}\equiv 6(16\cdot 15-10\cdot 17)-24(13\cdot 15-10\cdot 20)%
+1(13\cdot 17-16\cdot 20)\equiv 441\equiv 25\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

 So, modulo 26, the determinant is 25. Since this has no common factors with 26, this matrix can be used for the Hill cipher.</p>

<p>The risk of the determinant having common factors with the modulus can be eliminated by making the modulus <a href="prime_number" title="wikilink">prime</a>. Consequently a useful variant of the Hill cipher adds 3 extra symbols (such as a space, a period and a question mark) to increase the modulus to 29.</p>
<h2 id="example">Example</h2>

<p>Let</p>

<p>

<math display="inline" id="Hill_cipher:8">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mn>3</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>3</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>5</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">3</cn>
      <cn type="integer">3</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">2</cn>
      <cn type="integer">5</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=\begin{pmatrix}3&3\\
2&5\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>be the key and suppose the plaintext message is HELP. Then this plaintext is represented by two pairs</p>

<p>

<math display="inline" id="Hill_cipher:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>H</mi>
     <mi>E</mi>
     <mi>L</mi>
     <mi>P</mi>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>H</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>E</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>L</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>P</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>11</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>15</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>E</ci>
      <ci>L</ci>
      <ci>P</ci>
     </apply>
     <matrix>
      <matrixrow>
       <ci>H</ci>
      </matrixrow>
      <matrixrow>
       <ci>E</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <matrix>
      <matrixrow>
       <ci>L</ci>
      </matrixrow>
      <matrixrow>
       <ci>P</ci>
      </matrixrow>
     </matrix>
     <list>
      <matrix>
       <matrixrow>
        <cn type="integer">7</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">4</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">11</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">15</cn>
       </matrixrow>
      </matrix>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   HELP\to\begin{pmatrix}H\\
E\end{pmatrix},\begin{pmatrix}L\\
P\end{pmatrix}\to\begin{pmatrix}7\\
4\end{pmatrix},\begin{pmatrix}11\\
15\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Then we compute</p>

<p>

<math display="inline" id="Hill_cipher:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>3</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>3</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>5</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>8</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>26</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">3</cn>
       <cn type="integer">3</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">2</cn>
       <cn type="integer">5</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">7</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">4</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">7</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">8</cn>
      </matrixrow>
     </matrix>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">26</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}3&3\\
2&5\end{pmatrix}\begin{pmatrix}7\\
4\end{pmatrix}\equiv\begin{pmatrix}7\\
8\end{pmatrix}\;\;(\mathop{{\rm mod}}26),
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Hill_cipher:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>11</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">3</cn>
       <cn type="integer">3</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">2</cn>
       <cn type="integer">5</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">11</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">15</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">19</cn>
      </matrixrow>
     </matrix>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">26</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}3&3\\
2&5\end{pmatrix}\begin{pmatrix}11\\
15\end{pmatrix}\equiv\begin{pmatrix}0\\
19\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

</p>

<p>and continue encryption as follows:</p>

<p>

<math display="inline" id="Hill_cipher:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>8</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>19</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>H</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>I</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>(</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mi>A</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>T</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <ci>normal-→</ci>
     <list>
      <matrix>
       <matrixrow>
        <cn type="integer">7</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">8</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">19</cn>
       </matrixrow>
      </matrix>
     </list>
     <matrix>
      <matrixrow>
       <ci>H</ci>
      </matrixrow>
      <matrixrow>
       <ci>I</ci>
      </matrixrow>
     </matrix>
    </apply>
    <matrix>
     <matrixrow>
      <ci>A</ci>
     </matrixrow>
     <matrixrow>
      <ci>T</ci>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}7\\
8\end{pmatrix},\begin{pmatrix}0\\
19\end{pmatrix}\to\begin{pmatrix}H\\
I\end{pmatrix},\begin{pmatrix}A\\
T\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix K is invertible, hence 

<math display="inline" id="Hill_cipher:13">
 <semantics>
  <msup>
   <mi>K</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>K</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{-1}
  </annotation>
 </semantics>
</math>

 exists such that 

<math display="inline" id="Hill_cipher:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>K</mi>
    <msup>
     <mi>K</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>K</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>K</mi>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>I</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>K</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   KK^{-1}=K^{-1}K=I_{2}
  </annotation>
 </semantics>
</math>

. The inverse of K can be computed by using the <a href="Invertible_matrix#Inversion_of_2×2_matrices" title="wikilink">formula</a> 

<math display="inline" id="Hill_cipher:15">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>c</mi>
       </mtd>
       <mtd columnalign="center">
        <mi>d</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>a</mi>
        <mi>d</mi>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>b</mi>
        <mi>c</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>d</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mi>b</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mi>c</mi>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <ci>a</ci>
       <ci>b</ci>
      </matrixrow>
      <matrixrow>
       <ci>c</ci>
       <ci>d</ci>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <ci>d</ci>
       <apply>
        <minus></minus>
        <ci>b</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <ci>c</ci>
       </apply>
       <ci>a</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}a&b\\
c&d\end{pmatrix}^{-1}=(ad-bc)^{-1}\begin{pmatrix}d&-b\\
-c&a\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>This formula still holds after a modular reduction if a <a href="modular_multiplicative_inverse" title="wikilink">modular multiplicative inverse</a> is used to compute 

<math display="inline" id="Hill_cipher:16">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <mi>d</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>b</mi>
      <mi>c</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (ad-bc)^{-1}
  </annotation>
 </semantics>
</math>

. Hence in this case, we compute</p>

<p>

<math display="inline" id="Hill_cipher:17">
 <semantics>
  <mrow>
   <msup>
    <mi>K</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>≡</mo>
   <mrow>
    <msup>
     <mn>9</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>23</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>24</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mn>3</mn>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>23</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>24</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>20</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>9</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>K</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">9</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">5</cn>
        <cn type="integer">23</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">24</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <matrix>
       <matrixrow>
        <cn type="integer">5</cn>
        <cn type="integer">23</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">24</cn>
        <cn type="integer">3</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <matrix>
       <matrixrow>
        <cn type="integer">15</cn>
        <cn type="integer">17</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">20</cn>
        <cn type="integer">9</cn>
       </matrixrow>
      </matrix>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">26</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{-1}\equiv 9^{-1}\begin{pmatrix}5&23\\
24&3\end{pmatrix}\equiv 3\begin{pmatrix}5&23\\
24&3\end{pmatrix}\equiv\begin{pmatrix}15&17\\
20&9\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Hill_cipher:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>H</mi>
     <mi>I</mi>
     <mi>A</mi>
     <mi>T</mi>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>H</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>I</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>T</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>8</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>19</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>I</ci>
      <ci>A</ci>
      <ci>T</ci>
     </apply>
     <matrix>
      <matrixrow>
       <ci>H</ci>
      </matrixrow>
      <matrixrow>
       <ci>I</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <matrix>
      <matrixrow>
       <ci>A</ci>
      </matrixrow>
      <matrixrow>
       <ci>T</ci>
      </matrixrow>
     </matrix>
     <list>
      <matrix>
       <matrixrow>
        <cn type="integer">7</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">8</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">19</cn>
       </matrixrow>
      </matrix>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   HIAT\to\begin{pmatrix}H\\
I\end{pmatrix},\begin{pmatrix}A\\
T\end{pmatrix}\to\begin{pmatrix}7\\
8\end{pmatrix},\begin{pmatrix}0\\
19\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Then we compute</p>

<p>

<math display="inline" id="Hill_cipher:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>15</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>17</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>20</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>9</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>8</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>26</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">15</cn>
       <cn type="integer">17</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">20</cn>
       <cn type="integer">9</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">7</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">8</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">7</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">4</cn>
      </matrixrow>
     </matrix>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">26</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}15&17\\
20&9\end{pmatrix}\begin{pmatrix}7\\
8\end{pmatrix}\equiv\begin{pmatrix}7\\
4\end{pmatrix}\;\;(\mathop{{\rm mod}}26),
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Hill_cipher:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>17</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>20</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>9</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>19</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>11</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>15</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>26</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">15</cn>
       <cn type="integer">17</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">20</cn>
       <cn type="integer">9</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">19</cn>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">11</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">15</cn>
      </matrixrow>
     </matrix>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">26</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}15&17\\
20&9\end{pmatrix}\begin{pmatrix}0\\
19\end{pmatrix}\equiv\begin{pmatrix}11\\
15\end{pmatrix}\;\;(\mathop{{\rm mod}}26)
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore</p>

<p>

<math display="inline" id="Hill_cipher:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>7</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mo>(</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>11</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>15</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>H</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>E</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>L</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>P</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mi>H</mi>
     <mi>E</mi>
     <mi>L</mi>
     <mi>P</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <ci>normal-→</ci>
     <list>
      <matrix>
       <matrixrow>
        <cn type="integer">7</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">4</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">11</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">15</cn>
       </matrixrow>
      </matrix>
     </list>
     <matrix>
      <matrixrow>
       <ci>H</ci>
      </matrixrow>
      <matrixrow>
       <ci>E</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <matrix>
      <matrixrow>
       <ci>L</ci>
      </matrixrow>
      <matrixrow>
       <ci>P</ci>
      </matrixrow>
     </matrix>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>E</ci>
      <ci>L</ci>
      <ci>P</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}7\\
4\end{pmatrix},\begin{pmatrix}11\\
15\end{pmatrix}\to\begin{pmatrix}H\\
E\end{pmatrix},\begin{pmatrix}L\\
P\end{pmatrix}\to HELP
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="security">Security</h2>

<p>Unfortunately, the basic Hill cipher is vulnerable to a <a href="known-plaintext_attack" title="wikilink">known-plaintext attack</a> because it is completely <a class="uri" href="linear" title="wikilink">linear</a>. An opponent who intercepts 

<math display="inline" id="Hill_cipher:22">
 <semantics>
  <msup>
   <mi>n</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{2}
  </annotation>
 </semantics>
</math>

 plaintext/ciphertext character pairs can set up a linear system which can (usually) be easily solved; if it happens that this system is indeterminate, it is only necessary to add a few more plaintext/ciphertext pairs. Calculating this solution by standard linear algebra algorithms then takes very little time.</p>

<p>While matrix multiplication alone does not result in a secure cipher it is still a useful step when combined with other <a class="uri" href="non-linear" title="wikilink">non-linear</a> operations, because matrix multiplication can provide <a href="confusion_and_diffusion" title="wikilink">diffusion</a>. For example, an appropriately chosen matrix can guarantee that small differences before the matrix multiplication will result in large differences after the matrix multiplication. Some modern ciphers use indeed a matrix multiplication step to provide diffusion. For example, the MixColumns step in <a href="Advanced_Encryption_Standard" title="wikilink">AES</a> is a matrix multiplication. The function <em>g</em> in <a class="uri" href="Twofish" title="wikilink">Twofish</a> is a combination of non-linear S-boxes with a carefully chosen matrix multiplication (MDS).</p>
<h3 id="key-size">Key size</h3>

<p>The <a href="key_size" title="wikilink">key size</a> is the <a href="binary_logarithm" title="wikilink">binary logarithm</a> of the number of possible keys. There are 

<math display="inline" id="Hill_cipher:23">
 <semantics>
  <msup>
   <mn>26</mn>
   <msup>
    <mi>n</mi>
    <mn>2</mn>
   </msup>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">26</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   26^{n^{2}}
  </annotation>
 </semantics>
</math>

 matrices of dimension n × n. Thus 

<math display="inline" id="Hill_cipher:24">
 <semantics>
  <mrow>
   <msub>
    <mi>log</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mn>26</mn>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <log></log>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">26</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log_{2}(26^{n^{2}})
  </annotation>
 </semantics>
</math>

 or about 

<math display="inline" id="Hill_cipher:25">
 <semantics>
  <mrow>
   <mn>4.7</mn>
   <msup>
    <mi>n</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="float">4.7</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4.7n^{2}
  </annotation>
 </semantics>
</math>

 is an upper bound on the key size of the Hill cipher using n × n matrices. This is only an upper bound because not every matrix is invertible and thus usable as a key. The number of invertible matrices can be computed via the <a href="Chinese_Remainder_Theorem" title="wikilink">Chinese Remainder Theorem</a>. I.e., a matrix is invertible modulo 26 if and only if it is invertible both modulo 2 and modulo 13. The number of invertible n × n matrices modulo 2 is equal to the order of the <a href="general_linear_group" title="wikilink">general linear group</a> GL(n,<strong>Z</strong><sub>2</sub>). It is</p>

<p>

<math display="block" id="Hill_cipher:26">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>2</mn>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>2</mn>
        <mi>n</mi>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n^{2}}(1-1/2)(1-1/2^{2})\cdots(1-1/2^{n}).
  </annotation>
 </semantics>
</math>

 Equally, the number of invertible matrices modulo 13 (i.e. the order of GL(n,<strong>Z</strong><sub>13</sub>)) is</p>

<p>

<math display="block" id="Hill_cipher:27">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>13</mn>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>13</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>13</mn>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>13</mn>
        <mi>n</mi>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">13</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">13</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">13</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">13</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   13^{n^{2}}(1-1/13)(1-1/13^{2})\cdots(1-1/13^{n}).
  </annotation>
 </semantics>
</math>

 The number of invertible matrices modulo 26 is the product of those two numbers. Hence it is</p>

<p>

<math display="block" id="Hill_cipher:28">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>26</mn>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>2</mn>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>2</mn>
        <mi>n</mi>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>13</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>13</mn>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">⋯</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <msup>
        <mn>13</mn>
        <mi>n</mi>
       </msup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">26</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">13</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">13</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">13</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   26^{n^{2}}(1-1/2)(1-1/2^{2})\cdots(1-1/2^{n})(1-1/13)(1-1/13^{2})\cdots(1-1/13%
^{n}).
  </annotation>
 </semantics>
</math>

 Additionally it seems to be prudent to avoid too many zeroes in the key matrix, since they reduce diffusion. The net effect is that the effective keyspace of a basic Hill cipher is about 

<math display="inline" id="Hill_cipher:29">
 <semantics>
  <mrow>
   <mrow>
    <mn>4.64</mn>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>-</mo>
   <mn>1.7</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="float">4.64</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="float">1.7</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4.64n^{2}-1.7
  </annotation>
 </semantics>
</math>

. For a 5 × 5 Hill cipher, that is about 114 bits. Of course, key search is not the most efficient known attack.</p>
<h2 id="mechanical-implementation">Mechanical implementation</h2>

<p>When operating on 2 symbols at once, a Hill cipher offers no particular advantage over <a href="Playfair_cipher" title="wikilink">Playfair</a> or the <a href="bifid_cipher" title="wikilink">bifid cipher</a>, and in fact is weaker than either, and slightly more laborious to operate by pencil-and-paper. As the dimension increases, the cipher rapidly becomes infeasible for a human to operate by hand.</p>

<p>A Hill cipher of dimension 6 was implemented mechanically. Hill and a partner were awarded a <a class="uri" href="patent" title="wikilink">patent</a> () for this device, which performed a 6 × 6 matrix multiplication modulo 26 using a system of gears and chains.</p>

<p>Unfortunately the gearing arrangements (and thus the key) were fixed for any given machine, so triple encryption was recommended for security: a secret nonlinear step, followed by the wide diffusive step from the machine, followed by a third secret nonlinear step. (The much later <a href="Even-Mansour_cipher" title="wikilink">Even-Mansour cipher</a> also uses an unkeyed diffusive middle step). Such a combination was actually very powerful for 1929, and indicates that Hill apparently understood the concepts of a <a href="meet-in-the-middle_attack" title="wikilink">meet-in-the-middle attack</a> as well as confusion and diffusion. Unfortunately, his machine did not sell.</p>
<h2 id="see-also">See also</h2>

<p>Other practical "pencil-and-paper" polygraphic ciphers include:</p>
<ul>
<li><a href="Playfair_cipher" title="wikilink">Playfair cipher</a></li>
<li><a href="Bifid_cipher" title="wikilink">Bifid cipher</a></li>
<li><a href="Trifid_cipher" title="wikilink">Trifid cipher</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Lester S. Hill, Cryptography in an Algebraic Alphabet, <em>The American Mathematical Monthly</em> Vol.36, June–July 1929, pp. 306–312. (<a href="http://w08.middlebury.edu/INTD1065A/Lectures/Hill%20Cipher%20Folder/Hill1.pdf">PDF</a>)</li>
<li>Lester S. Hill, Concerning Certain Linear Transformation Apparatus of Cryptography, <em>The American Mathematical Monthly</em> Vol.38, 1931, pp. 135–154.</li>
<li>Jeffrey Overbey, William Traves, and Jerzy Wojdylo, <a href="http://www.informaworld.com/smpp/content~content=a748639583~db=all~order=page">On the Keyspace of the Hill Cipher</a>, <em><a class="uri" href="Cryptologia" title="wikilink">Cryptologia</a></em>, Vol.29, No.1, January 2005, pp59–72. (<a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.133.1840">CiteSeerX</a>) (<a href="http://jeff.over.bz/papers/undergrad/on-the-keyspace-of-the-hill-cipher.pdf">PDF</a>)</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>"<a href="http://massey.limfinity.com/207/hillcipher.php">Hill Cipher Web App</a>" implements the Hill cipher and shows the matrices involved</li>
<li>"<a href="http://massey.limfinity.com/207/hillcipher.pdf">Hill Cipher Explained</a>" illustrates the linear algebra behind the Hill Cipher</li>
<li>"<a href="http://asecuritysite.com/security/coding/hill">Hill's Cipher Calculator</a>" outlines the Hill Cipher with a Web page</li>
</ul>

<p>"</p>

<p><a href="Category:Classical_ciphers" title="wikilink">Category:Classical ciphers</a></p>
</body>
</html>

   Differential variational inequality      Differential variational inequality   In mathematics, a differential variational inequality (DVI) is a dynamical system that incorporates ordinary differential equations and variational inequalities or complementarity problems .  DVIs are useful for representing models involving both dynamics and inequality constraints. Examples of such problems include, for example, mechanical impact problems, electrical circuits with ideal  diodes , Coulomb friction problems for contacting bodies, and dynamic economic and related problems such as dynamic traffic networks and networks of queues (where the constraints can either be upper limits on queue length or that the queue length cannot become negative). DVIs are related to a number of other concepts including differential inclusions , projected dynamical systems , evolutionary inequalities , and parabolic variational inequalities .  Differential variational inequalities were first formally introduced by Pang and Stewart , whose definition should not be confused with the differential variational inequality used in Aubin and Cellina (1984).  Differential variational inequalities have the form to find     u   (  t  )    ∈  K        u  t   K    u(t)\in K   such that       ⟨   v  -   u   (  t  )     ,   F   (  t  ,   x   (  t  )    ,   u   (  t  )    )    ⟩   ≥  0         v    u  t      F   t    x  t     u  t      0    \langle v-u(t),F(t,x(t),u(t))\rangle\geq 0     for every    v  ∈  K      v  K    v\in K   and almost all t ; K a closed convex set, where          d  x    d  t    =   f   (  t  ,   x   (  t  )    ,   u   (  t  )    )     ,    x   (   t  0   )    =   x  0     .     formulae-sequence        d  x     d  t      f   t    x  t     u  t          x   subscript  t  0     subscript  x  0      \frac{dx}{dt}=f(t,x(t),u(t)),\quad x(t_{0})=x_{0}.     Closely associated with DVIs are dynamic/differential complementarity problems: if K is a closed convex cone, then the variational inequality is equivalent to the complementarity problem :        K  ∋    u   (  t  )    ⟂      F   (  t  ,   x   (  t  )    ,   u   (  t  )    )    ∈   K  *     .     formulae-sequence       u  t   perpendicular-to   K       F   t    x  t     u  t      superscript  K       K\ni u(t)\quad\perp\quad F(t,x(t),u(t))\in K^{*}.\,     Examples  Mechanical Contact  Consider a rigid ball of radius   r   r   r   falling from a height towards a table. Assume that the forces acting on the ball are gravitation and the contact forces of the table preventing penetration. Then the differential equation describing the motion is       m     d  2   y    d   t  2      =    -   m  g    +   N   (  t  )           m       superscript  d  2   y     d   superscript  t  2            m  g      N  t      m\frac{d^{2}y}{dt^{2}}=-mg+N(t)     where   m   m   m   is the mass of the ball and    N   (  t  )       N  t    N(t)   is the contact force of the table, and   g   g   g   is the gravitational acceleration. Note that both    y   (  t  )       y  t    y(t)   and    N   (  t  )       N  t    N(t)   are a priori unknown. While the ball and the table are separated, there is no contact force. There cannot be penetration (for a rigid ball and a rigid table), so      y   (  t  )    -  r   ≥  0          y  t   r   0    y(t)-r\geq 0   for all   t   t   t   . If      y   (  t  )    -  r   >  0          y  t   r   0    y(t)-r>0   then     N   (  t  )    =  0        N  t   0    N(t)=0   . On the other hand, if      y   (  t  )    -  r   =  0          y  t   r   0    y(t)-r=0   , then    N   (  t  )       N  t    N(t)   can take on any non-negative value. (We do not allow     N   (  t  )    <  0        N  t   0    N(t)<0   as this corresponds to some kind of adhesive.) This can be summarized by the complementarity relationship       0  ≤     y   (  t  )    -  r   ⟂      N   (  t  )    ≥  0.      formulae-sequence    0       y  t   r   perpendicular-to        N  t   0.     0\leq y(t)-r\quad\perp\quad N(t)\geq 0.     In the above formulation, we can set    K  =   {  z  ∣   z  ≥   0    }       K   conditional-set  z    z  0      K=\{\,z\mid z\geq 0\,\}   , so that its dual cone     K  *   =  K       superscript  K    K    K^{*}=K   is also the set of non-negative real numbers; this is a differential complementarity problem.  Ideal diodes in electrical circuits  An ideal diode is a diode that conducts electricity in the forward direction with no resistance if a forward voltage is applied, but allows no current to flow in the reverse direction. Then if the reverse voltage is    v   (  t  )       v  t    v(t)   , and the forward current is    i   (  t  )       i  t    i(t)   , then there is a complementarity relationship between the two:       0  ≤    v   (  t  )    ⟂      i   (  t  )    ≥  0      formulae-sequence    0     v  t   perpendicular-to        i  t   0     0\leq v(t)\quad\perp\quad i(t)\geq 0     for all   t   t   t   . If the diode is in a circuit containing a memory element, such as a capacitor or inductor, then the circuit can be represented as a differential variational inequality.  Index  The concept of the index of a DVI is important and determines many questions of existence and uniqueness of solutions to a DVI. This concept is closely related to the concept of index for differential algebraic equations (DAE's), which is the number of times the algebraic equations of a DAE must be differentiated in order to obtain a complete system of differential equations for all variables. For a DVI, the index is the number of differentiations of F ( t , x , u ) = 0 needed in order to locally uniquely identify u as a function of t and x .  This index can be computed for the above examples. For the mechanical impact example, if we differentiate    y   (  t  )       y  t    y(t)   once we have      d  y   /  d   t   (  t  )           d  y   d   t  t    dy/dt(t)   , which does not yet explicitly involve    N   (  t  )       N  t    N(t)   . However, if we differentiate once more, we can use the differential equation to give        d  2   y   /  d    t  2    =    (   1  /  m   )    [    -   m  g    +   N   (  t  )     ]               superscript  d  2   y   d    superscript  t  2        1  m    delimited-[]        m  g      N  t        d^{2}y/dt^{2}=(1/m)[-mg+N(t)]   , which does explicitly involve    N   (  t  )       N  t    N(t)   . Furthermore, if        d  2   y   /  d    t  2    =   b   (  t  )               superscript  d  2   y   d    superscript  t  2      b  t     d^{2}y/dt^{2}=b(t)   , we can explicitly determine    N   (  t  )       N  t    N(t)   in terms of    b   (  t  )       b  t    b(t)   .  For the ideal diode systems, the computations are considerably more difficult, but provided some generally valid conditions hold, the differential variational inequality can be shown to have index one.  Differential variational inequalities with index greater than two are generally not meaningful, but certain conditions and interpretations can make them meaningful (see the references Acary, Brogliato and Goeleven, and Heemels, Schumacher, and Weiland below).  References   Pang and Stewart (2008) "Differential Variational Inequalities", Mathematical Programming, vol. 113, no. 2, Series A, 345–424.  Aubin and Cellina (1984) Differential Inclusions Springer-Verlag.  Acary and Brogliato and Goeleven (2006) "Higher order Moreau's sweeping process. Mathematical formulation and numerical formulation", Mathematical Programming A.  Avi Mandelbaum (1989) "Dynamic Complementarity Problems", unpublished manuscript.  Heemels, Schumacher, and Weiland (2000) "Linear complementarity systems", SIAM Journal on Applied Mathematics, vol. 60, no. 4, 1234–1269.   "  Category:Dynamical systems   
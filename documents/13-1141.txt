   Truncation error (numerical integration)      Truncation error (numerical integration)   Truncation errors in numerical integration are of two kinds:   local truncation errors – the error caused by one iteration, and  global truncation errors – the cumulative error caused by many iterations.   Definitions  Suppose we have a continuous differential equation        y  ′   =   f   (  t  ,  y  )     ,     y   (   t  0   )    =   y  0    ,   t  ≥   t  0        formulae-sequence     superscript  y  normal-′     f   t  y      formulae-sequence      y   subscript  t  0     subscript  y  0      t   subscript  t  0       y^{\prime}=f(t,y),\qquad y(t_{0})=y_{0},\qquad t\geq t_{0}     and we wish to compute an approximation    y  n     subscript  y  n    y_{n}   of the true solution    y   (   t  n   )       y   subscript  t  n     y(t_{n})   at discrete time steps     t  1   ,   t  2   ,  …  ,   t  N       subscript  t  1    subscript  t  2   normal-…   subscript  t  N     t_{1},t_{2},\ldots,t_{N}   . For simplicity, assume the time steps are equally spaced:        h  =    t  n   -   t   n  -  1      ,   n  =   1  ,  2  ,  …  ,  N     .     formulae-sequence    h     subscript  t  n    subscript  t    n  1        n   1  2  normal-…  N      h=t_{n}-t_{n-1},\qquad n=1,2,\ldots,N.     Suppose we compute the sequence    y  n     subscript  y  n    y_{n}   with a one-step method of the form        y  n   =    y   n  -  1    +   h  A   (   t   n  -  1    ,   y   n  -  1    ,  h  ,  f  )      .       subscript  y  n      subscript  y    n  1      h  A    subscript  t    n  1     subscript  y    n  1    h  f       y_{n}=y_{n-1}+hA(t_{n-1},y_{n-1},h,f).     The function   A   A   A   is called the increment function , and can be interpreted as an estimate of the slope of    y  n     subscript  y  n    y_{n}   .  Local truncation error  The local truncation error     τ  n     subscript  τ  n    \tau_{n}   is the error that our increment function,   A   A   A   , causes during a single iteration, assuming perfect knowledge of the true solution at the previous iteration.  More formally, the local truncation error,    τ  n     subscript  τ  n    \tau_{n}   , at step   n   n   n   is computed from the difference between the left- and the right-hand side of the equation for the increment     y  n   ≈    y   n  -  1    +   h  A   (   t   n  -  1    ,   y   n  -  1    ,  h  ,  f  )          subscript  y  n      subscript  y    n  1      h  A    subscript  t    n  1     subscript  y    n  1    h  f       y_{n}\approx y_{n-1}+hA(t_{n-1},y_{n-1},h,f)   :        τ  n   =    y   (   t  n   )    -   y   (   t   n  -  1    )    -   h  A   (   t   n  -  1    ,   y   (   t   n  -  1    )    ,  h  ,  f  )      .       subscript  τ  n       y   subscript  t  n      y   subscript  t    n  1       h  A    subscript  t    n  1      y   subscript  t    n  1     h  f       \tau_{n}=y(t_{n})-y(t_{n-1})-hA(t_{n-1},y(t_{n-1}),h,f).    1 2  The numerical method is consistent if the local truncation error is    o   (  h  )       o  h    o(h)   (this means that for every    ε  >  0      ε  0    \varepsilon>0   there exists an   H   H   H   such that     |   τ  n   |   <   ε  h          subscript  τ  n      ε  h     |\tau_{n}|<\varepsilon h   for all    h  <  H      h  H    h   ; see big O notation ). If the increment function   A   A   A   is differentiable, then the method is consistent if, and only if,     A   (  t  ,  y  ,  0  ,  f  )    =   f   (  t  ,  y  )          A   t  y  0  f      f   t  y      A(t,y,0,f)=f(t,y)   . 3  Furthermore, we say that the numerical method has order   p   p   p    if for any sufficiently smooth solution of the initial value problem, the local truncation error is    O   (   h   p  +  1    )       O   superscript  h    p  1      O(h^{p+1})   (meaning that there exist constants   C   C   C   and   H   H   H   such that     |   τ  n   |   <   C   h   p  +  1            subscript  τ  n      C   superscript  h    p  1       |\tau_{n}|   for all    h  <  H      h  H    h   ). 4  Global truncation error  The global truncation error is the accumulation of the local truncation error over all of the iterations, assuming perfect knowledge of the true solution at the initial time step.  More formally, the global truncation error,    e  n     subscript  e  n    e_{n}   , at time    t  n     subscript  t  n    t_{n}   is defined by:      e  n     subscript  e  n    \displaystyle e_{n}    5  The numerical method is convergent if global truncation error goes to zero as the step size goes to zero; in other words, the numerical solution converges to the exact solution      lim   h  →  0      max  n    |   e  n   |     =  0        subscript    normal-→  h  0      subscript   n      subscript  e  n      0    \lim_{h\to 0}\max_{n}|e_{n}|=0   . 6  Relationship between local and global truncation errors  Sometimes it is possible to calculate an upper bound on the global truncation error, if we already know the local truncation error. This requires our increment function be sufficiently well-behaved.  The global truncation error satisfies the recurrence relation:        e   n  +  1    =    e  n   +   h   (    A   (   t  n   ,   y   (   t  n   )    ,  h  ,  f  )    -   A   (   t  n   ,   y  n   ,  h  ,  f  )     )    +   τ   n  +  1      .       subscript  e    n  1       subscript  e  n     h      A    subscript  t  n     y   subscript  t  n    h  f      A    subscript  t  n    subscript  y  n   h  f       subscript  τ    n  1       e_{n+1}=e_{n}+h\Big(A(t_{n},y(t_{n}),h,f)-A(t_{n},y_{n},h,f)\Big)+\tau_{n+1}.   This follows immediately from the definitions. Now assume that the increment function is Lipschitz continuous in the second argument, that is, there exists a constant   L   L   L   such that for all   t   t   t   and    y  1     subscript  y  1    y_{1}   and    y  2     subscript  y  2    y_{2}   , we have:        |    A   (  t  ,   y  1   ,  h  ,  f  )    -   A   (  t  ,   y  2   ,  h  ,  f  )     |   ≤   L   |    y  1   -   y  2    |     .            A   t   subscript  y  1   h  f      A   t   subscript  y  2   h  f        L       subscript  y  1    subscript  y  2        |A(t,y_{1},h,f)-A(t,y_{2},h,f)|\leq L|y_{1}-y_{2}|.   Then the global error satisfies the bound        |   e  n   |   ≤      max  j    τ  j     h  L     (    e   L   (    t  n   -   t  0    )     -  1   )     .         subscript  e  n          subscript   j    subscript  τ  j      h  L       superscript  normal-e    L     subscript  t  n    subscript  t  0      1      |e_{n}|\leq\frac{\max_{j}\tau_{j}}{hL}\left(\mathrm{e}^{L(t_{n}-t_{0})}-1%
 \right).    7  It follows from the above bound for the global error that if the function   f   f   f   in the differential equation is continuous in the first argument and Lipschitz continuous in the second argument (the condition from the Picard–Lindelöf theorem ), and the increment function   A   A   A   is continuous in all arguments and Lipschitz continuous in the second argument, then the global error tends to zero as the step size   h   h   h   approaches zero (in other words, the numerical method converges to the exact solution). 8  Extension to linear multistep methods  Now consider a linear multistep method , given by the formula       y   n  +  s    +    a   s  -  1     y    n  +  s   -  1     +    a   s  -  2     y    n  +  s   -  2     +  ⋯  +    a  0    y  n         subscript  y    n  s       subscript  a    s  1     subscript  y      n  s   1        subscript  a    s  2     subscript  y      n  s   2     normal-⋯     subscript  a  0    subscript  y  n      \displaystyle y_{n+s}+a_{s-1}y_{n+s-1}+a_{s-2}y_{n+s-2}+\cdots+a_{0}y_{n}   Thus, the next value for the numerical solution is computed according to        y   n  +  s    =    -    ∑   k  =  0    s  -  1      a   n  +  k     y   n  +  k       +   h    ∑   k  =  0   s     b  k   f   (   t   n  +  k    ,   y   n  +  k    )        .       subscript  y    n  s          superscript   subscript     k  0      s  1       subscript  a    n  k     subscript  y    n  k         h    superscript   subscript     k  0    s      subscript  b  k   f    subscript  t    n  k     subscript  y    n  k           y_{n+s}=-\sum_{k=0}^{s-1}a_{n+k}y_{n+k}+h\sum_{k=0}^{s}b_{k}f(t_{n+k},y_{n+k}).   The next iterate of a linear multistep method depends on the previous s iterates. Thus, in the definition for the local truncation error, it is now assumed that the previous s iterates all correspond to the exact solution:        τ  n   =     y   (   t   n  +  s    )    +    ∑   k  =  0    s  -  1      a   n  +  k    y   (   t   n  +  k    )      -   h    ∑   k  =  0   s     b  k   f   (   t   n  +  k    ,   y   (   t   n  +  k    )    )        .       subscript  τ  n         y   subscript  t    n  s       superscript   subscript     k  0      s  1       subscript  a    n  k    y   subscript  t    n  k         h    superscript   subscript     k  0    s      subscript  b  k   f    subscript  t    n  k      y   subscript  t    n  k            \tau_{n}=y(t_{n+s})+\sum_{k=0}^{s-1}a_{n+k}y(t_{n+k})-h\sum_{k=0}^{s}b_{k}f(t_%
 {n+k},y(t_{n+k})).    9 Again, the method is consistent if     τ  n   =   o   (  h  )         subscript  τ  n     o  h     \tau_{n}=o(h)   and it has order p if     τ  n   =   O   (   h   p  +  1    )         subscript  τ  n     O   superscript  h    p  1       \tau_{n}=O(h^{p+1})   . The definition of the global truncation error is also unchanged.  The relation between local and global truncation errors is slightly different from in the simpler setting of one-step methods. For linear multistep methods, an additional concept called zero-stability is needed to explain the relation between local and global truncation errors. Linear multistep methods that satisfy the condition of zero-stability have the same relation between local and global errors as one-step methods. In other words, if a linear multistep method is zero-stable and consistent, then it converges. And if a linear multistep method is zero-stable and has local error     τ  n   =   O   (   h   p  +  1    )         subscript  τ  n     O   superscript  h    p  1       \tau_{n}=O(h^{p+1})   , then its global error satisfies     e  n   =   O   (   h  p   )         subscript  e  n     O   superscript  h  p      e_{n}=O(h^{p})   . 10  See also   Order of accuracy  Numerical integration  Numerical ordinary differential equations  Truncation error   Notes  References    .   .   External links   Notes on truncation errors and Runge-Kutta methods    "  Category:Numerical integration (quadrature)     ↩  , calls     τ  n   /  h       subscript  τ  n   h    \tau_{n}/h   the truncation error. ↩  ↩  ; ↩  ↩  ↩  ↩  ↩  , uses a different definition, dividing this by essentially by h ↩  ↩     
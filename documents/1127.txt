   Tricubic interpolation      Tricubic interpolation   In the mathematical subfield numerical analysis , tricubic interpolation is a method for obtaining values at arbitrary points in 3D space of a function defined on a regular grid . The approach involves approximating the function locally by an expression of the form        f   (  x  ,  y  ,  z  )    =    ‚àë   i  =  0   3     ‚àë   j  =  0   3     ‚àë   k  =  0   3     a   i  j  k     x  i    y  j    z  k        .        f   x  y  z      superscript   subscript     i  0    3     superscript   subscript     j  0    3     superscript   subscript     k  0    3      subscript  a    i  j  k     superscript  x  i    superscript  y  j    superscript  z  k         f(x,y,z)=\sum_{i=0}^{3}\sum_{j=0}^{3}\sum_{k=0}^{3}a_{ijk}x^{i}y^{j}z^{k}.     This form has 64 coefficients    a   i  j  k      subscript  a    i  j  k     a_{ijk}   ; requiring the function to have a given value or given directional derivative at a point places one linear constraint on the 64 coefficients.  The term tricubic interpolation is used in more than one context; some experiments measure both the value of a function and its spatial derivatives, and it is desirable to interpolate preserving the values and the measured derivatives at the grid points. Those provide 32 constraints on the coefficients, and another 32 constraints can be provided by requiring smoothness of higher derivatives. 1  In other contexts, we can obtain the 64 coefficients by considering a 3x3x3 grid of small cubes surrounding the cube inside which we evaluate the function, and fitting the function at the 64 points on the corners of this grid.  The cubic interpolation article indicates that the method is equivalent to a sequential application of one-dimensional cubic interpolators. Let     CINT  x    (   a   -  1    ,   a  0   ,   a  1   ,   a  2   )        subscript  CINT  x     subscript  a    1     subscript  a  0    subscript  a  1    subscript  a  2      \mathrm{CINT}_{x}(a_{-1},a_{0},a_{1},a_{2})   be the value of a monovariable cubic polynomial (e.g. constrained by values,    a   -  1      subscript  a    1     a_{-1}   ,    a  0     subscript  a  0    a_{0}   ,    a  1     subscript  a  1    a_{1}   ,    a  2     subscript  a  2    a_{2}   from consecutive grid points) evaluated at   x   x   x   . In many useful cases, these cubic polynomials have the form      CINT  x    (   u   -  1    ,   u  0   ,   u  1   ,   u  2   )    =    ùêØ  x   ‚ãÖ   (   u   -  1    ,   u  0   ,   u  1   ,   u  2   )           subscript  CINT  x     subscript  u    1     subscript  u  0    subscript  u  1    subscript  u  2      normal-‚ãÖ   subscript  ùêØ  x     subscript  u    1     subscript  u  0    subscript  u  1    subscript  u  2       \mathrm{CINT}_{x}(u_{-1},u_{0},u_{1},u_{2})=\mathbf{v}_{x}\cdot\left(u_{-1},u_%
 {0},u_{1},u_{2}\right)   for some vector    ùêØ  x     subscript  ùêØ  x    \mathbf{v}_{x}   which is a function of   x   x   x   alone. The tricubic interpolator is equivalent to:         s   (  i  ,  j  ,  k  )        =   The value at grid point   (  i  ,  j  ,  k  )          t   (  i  ,  j  ,  z  )        =    CINT  z    (   s   (  i  ,  j  ,   -  1   )    ,   s   (  i  ,  j  ,  0  )    ,   s   (  i  ,  j  ,  1  )    ,   s   (  i  ,  j  ,  2  )    )          u   (  i  ,  y  ,  z  )        =    CINT  y    (   t   (  i  ,   -  1   ,  z  )    ,   t   (  i  ,  0  ,  z  )    ,   t   (  i  ,  1  ,  z  )    ,   t   (  i  ,  2  ,  z  )    )          f   (  x  ,  y  ,  z  )        =    CINT  x    (   u   (   -  1   ,  y  ,  z  )    ,   u   (  0  ,  y  ,  z  )    ,   u   (  1  ,  y  ,  z  )    ,   u   (  2  ,  y  ,  z  )    )             s   i  j  k      absent    The value at grid point   i  j  k         t   i  j  z      absent     subscript  CINT  z      s   i  j    1       s   i  j  0      s   i  j  1      s   i  j  2           u   i  y  z      absent     subscript  CINT  y      t   i    1   z      t   i  0  z      t   i  1  z      t   i  2  z           f   x  y  z      absent     subscript  CINT  x      u     1   y  z      u   0  y  z      u   1  y  z      u   2  y  z          \begin{aligned}\displaystyle s(i,j,k)&\displaystyle{}=\text{The value at grid %
 point }(i,j,k)\\
 \displaystyle t(i,j,z)&\displaystyle{}=\mathrm{CINT}_{z}\left(s(i,j,-1),s(i,j,%
 0),s(i,j,1),s(i,j,2)\right)\\
 \displaystyle u(i,y,z)&\displaystyle{}=\mathrm{CINT}_{y}\left(t(i,-1,z),t(i,0,%
 z),t(i,1,z),t(i,2,z)\right)\\
 \displaystyle f(x,y,z)&\displaystyle{}=\mathrm{CINT}_{x}\left(u(-1,y,z),u(0,y,%
 z),u(1,y,z),u(2,y,z)\right)\end{aligned}   where     i  ,  j  ,  k   ‚àà   {   -  1   ,  0  ,  1  ,  2  }        i  j  k      1   0  1  2     i,j,k\in\{-1,0,1,2\}   and     x  ,  y  ,  z   ‚àà   [  0  ,  1  ]        x  y  z    0  1     x,y,z\in[0,1]   .  At first glance, it might seem more convenient to use the 21 calls to   CINT   CINT   \mathrm{CINT}   described above instead of the    64  √ó  64      64  64    {64\times 64}   matrix described in Lekien and Marsden. 2 However, a proper implementation using a sparse format for the matrix (that is fairly sparse) makes the latter more efficient. This aspect is even much more pronounced when interpolation is needed at several locations inside the same cube. In this case, the    64  √ó  64      64  64    {64\times 64}   matrix is used once to compute the interpolation coefficients for the entire cube. The coefficients are then stored and used for interpolation at any location inside the cube. In comparison, sequential use of one-dimensional integrators    CINT  x     subscript  CINT  x    \mathrm{CINT}_{x}   performs extremely poorly for repeated interpolations because each computational step must be repeated for each new location.  See also   Cubic interpolation  Bicubic interpolation  Trilinear interpolation   References    External links   Java/C++ implementation of tricubic interpolation  C++ implementation of tricubic interpolation  Python implementation   "  Category:Multivariate interpolation     Tricubic Interpolation in Three Dimensions (2005), by F. Lekien, J. Marsden, Journal of Numerical Methods and Engineering ‚Ü©  Tricubic Interpolation in Three Dimensions (2005), by F. Lekien, J. Marsden, Journal of Numerical Methods and Engineering ‚Ü©     
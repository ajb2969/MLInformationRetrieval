<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1830">Optimal estimation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Optimal estimation</h1>
<hr/>

<p>In applied statistics, <strong>optimal estimation</strong> is a <a href="regularization_(mathematics)" title="wikilink">regularized</a> <a href="matrix_(mathematics)" title="wikilink">matrix</a> <a href="inverse_problem" title="wikilink">inverse method</a> based on <a href="Bayes_theorem" title="wikilink">Bayes theorem</a>. It is used very commonly in the <a href="geoscience" title="wikilink">geosciences</a>, particularly for <a href="atmospheric_sounding" title="wikilink">atmospheric sounding</a>. A matrix inverse problem looks like this:</p>

<p>

<math display="block" id="Optimal_estimation:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>ğ€</mi>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">â†’</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ğ€</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-â†’</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}\vec{x}=\vec{y}
  </annotation>
 </semantics>
</math>

 The essential concept is to transform the matrix, <strong>A</strong>, into a <a href="conditional_probability" title="wikilink">conditional probability</a> and the variables, 

<math display="inline" id="Optimal_estimation:1">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Optimal_estimation:2">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}
  </annotation>
 </semantics>
</math>

 into probability distributions by assuming Gaussian statistics and using empirically-determined covariance matrices.</p>
<h2 id="derivation">Derivation</h2>

<p>Typically, one expects the statistics of most measurements to be <a href="normal_distribution" title="wikilink">Gaussian</a>. So for example for 

<math display="inline" id="Optimal_estimation:3">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">|</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>y</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{y}|\vec{x})
  </annotation>
 </semantics>
</math>

, we can write:</p>

<p>

<math display="block" id="Optimal_estimation:4">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">|</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>Ï€</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mrow>
        <mi>m</mi>
        <mi>n</mi>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>ğ‘º</mi>
       <mi>ğ’š</mi>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>[</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ğ‘¨</mi>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">â†’</mo>
      </mover>
      <mo>-</mo>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">â†’</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
    <mmultiscripts>
     <mi>ğ‘º</mi>
     <mi>ğ’š</mi>
     <none></none>
     <none></none>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mmultiscripts>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ğ‘¨</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">â†’</mo>
     </mover>
     <mo>-</mo>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">â†’</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>y</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>Ï€</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ‘º</ci>
        <ci>ğ’š</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">A</csymbol>
       <apply>
        <ci>normal-â†’</ci>
        <ci>x</ci>
       </apply>
       <minus></minus>
       <apply>
        <ci>normal-â†’</ci>
        <ci>y</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ‘º</ci>
       <ci>ğ’š</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">A</csymbol>
      <apply>
       <ci>normal-â†’</ci>
       <ci>x</ci>
      </apply>
      <minus></minus>
      <apply>
       <ci>normal-â†’</ci>
       <ci>y</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{y}|\vec{x})=\frac{1}{(2\pi)^{mn/2}|\boldsymbol{S_{y}}|}\exp\left[-\frac%
{1}{2}(\boldsymbol{A}\vec{x}-\vec{y})^{T}\boldsymbol{S_{y}}^{-1}(\boldsymbol{A%
}\vec{x}-\vec{y})\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>m</em> and <em>n</em> are the numbers of elements in 

<math display="inline" id="Optimal_estimation:5">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Optimal_estimation:6">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}
  </annotation>
 </semantics>
</math>

 respectively 

<math display="inline" id="Optimal_estimation:7">
 <semantics>
  <mi>ğ‘¨</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ğ‘¨</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{A}
  </annotation>
 </semantics>
</math>

 is the matrix to be solved (the linear or linearised forward model) and 

<math display="inline" id="Optimal_estimation:8">
 <semantics>
  <msub>
   <mi>ğ‘º</mi>
   <mi>ğ’š</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ‘º</ci>
    <ci>ğ’š</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{S_{y}}
  </annotation>
 </semantics>
</math>

 is the covariance matrix of the vector 

<math display="inline" id="Optimal_estimation:9">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{y}
  </annotation>
 </semantics>
</math>

. This can be similarly done for 

<math display="inline" id="Optimal_estimation:10">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Optimal_estimation:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">â†’</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>2</mn>
         <mi>Ï€</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>m</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>ğ‘º</mi>
        <msub>
         <mi>ğ’™</mi>
         <mi>ğ’‚</mi>
        </msub>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mover accent="true">
            <mi>x</mi>
            <mo stretchy="false">â†’</mo>
           </mover>
           <mo>-</mo>
           <mover accent="true">
            <msub>
             <mi>x</mi>
             <mi>a</mi>
            </msub>
            <mo>^</mo>
           </mover>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>T</mi>
        </msup>
        <mmultiscripts>
         <mi>ğ‘º</mi>
         <msub>
          <mi>ğ’™</mi>
          <mi>ğ’‚</mi>
         </msub>
         <none></none>
         <none></none>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mmultiscripts>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">â†’</mo>
          </mover>
          <mo>-</mo>
          <mover accent="true">
           <msub>
            <mi>x</mi>
            <mi>a</mi>
           </msub>
           <mo>^</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>Ï€</ci>
        </apply>
        <apply>
         <divide></divide>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ‘º</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ’™</ci>
          <ci>ğ’‚</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-â†’</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <ci>normal-^</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>a</ci>
           </apply>
          </apply>
         </apply>
         <ci>T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ‘º</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ğ’™</ci>
           <ci>ğ’‚</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-â†’</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <ci>normal-^</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>a</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{x})=\frac{1}{(2\pi)^{m/2}|\boldsymbol{S_{x_{a}}}|}\exp\left[-\frac{1}{2%
}(\vec{x}-\widehat{x_{a}})^{T}\boldsymbol{S_{x_{a}}}^{-1}(\vec{x}-\widehat{x_{%
a}})\right]
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Optimal_estimation:12">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <apply>
     <ci>normal-â†’</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{x})
  </annotation>
 </semantics>
</math>

 is taken to be the so-called "a-priori" distribution

<math display="block" id="Optimal_estimation:13">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>x</mi>
    <mi>a</mi>
   </msub>
   <mo>^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{x_{a}}
  </annotation>
 </semantics>
</math>

 denotes the a-priori values for 

<math display="inline" id="Optimal_estimation:14">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

 while 

<math display="inline" id="Optimal_estimation:15">
 <semantics>
  <msub>
   <mi>ğ‘º</mi>
   <msub>
    <mi>ğ’™</mi>
    <mi>ğ’‚</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ‘º</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ’™</ci>
     <ci>ğ’‚</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{S_{x_{a}}}
  </annotation>
 </semantics>
</math>

 is its covariance matrix.</p>

<p>The nice thing about the Gaussian distributions is that only two parameters are needed to describe them and so the whole problem can be converted once again to matrices. Assuming that 

<math display="inline" id="Optimal_estimation:16">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">|</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>y</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{x}|\vec{y})
  </annotation>
 </semantics>
</math>

 takes the following form:</p>

<p>

<math display="block" id="Optimal_estimation:17">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">|</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>Ï€</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mrow>
        <mi>m</mi>
        <mi>n</mi>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>ğ‘º</mi>
       <mi>ğ’™</mi>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>[</mo>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">â†’</mo>
      </mover>
      <mo>-</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo>^</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
    <mmultiscripts>
     <mi>ğ‘º</mi>
     <mi>ğ’™</mi>
     <none></none>
     <none></none>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mmultiscripts>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">â†’</mo>
     </mover>
     <mo>-</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo>^</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>y</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>Ï€</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ‘º</ci>
        <ci>ğ’™</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <ci>normal-â†’</ci>
        <ci>x</ci>
       </apply>
       <minus></minus>
       <apply>
        <ci>normal-^</ci>
        <ci>x</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ‘º</ci>
       <ci>ğ’™</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <ci>normal-â†’</ci>
       <ci>x</ci>
      </apply>
      <minus></minus>
      <apply>
       <ci>normal-^</ci>
       <ci>x</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{x}|\vec{y})=\frac{1}{(2\pi)^{mn/2}|\boldsymbol{S_{x}}|}\exp\left[-\frac%
{1}{2}(\vec{x}-\widehat{x})^{T}\boldsymbol{S_{x}}^{-1}(\vec{x}-\widehat{x})\right]
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Optimal_estimation:18">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <apply>
     <ci>normal-â†’</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{y})
  </annotation>
 </semantics>
</math>

 may be neglected since, for a given value of 

<math display="inline" id="Optimal_estimation:19">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

, it is simply a constant scaling term. Now it is possible to solve for both the expectation value of 

<math display="inline" id="Optimal_estimation:20">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">â†’</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â†’</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Optimal_estimation:21">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo>^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{x}
  </annotation>
 </semantics>
</math>


, and for its covariance matrix by equating 

<math display="inline" id="Optimal_estimation:22">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">|</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>y</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{x}|\vec{y})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Optimal_estimation:23">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">|</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">â†’</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>y</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-â†’</ci>
      <ci>x</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\vec{y}|\vec{x})P(\vec{x})
  </annotation>
 </semantics>
</math>

. This produces the following equations:</p>

<p>

<math display="block" id="Optimal_estimation:24">
 <semantics>
  <mrow>
   <msub>
    <mi>ğ‘º</mi>
    <mi>ğ’™</mi>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>ğ‘¨</mi>
        <mi>T</mi>
       </msup>
       <msubsup>
        <mi>ğ‘º</mi>
        <mi>ğ’š</mi>
        <mrow>
         <mo mathvariant="bold">-</mo>
         <mn>ğŸ</mn>
        </mrow>
       </msubsup>
       <mi>ğ‘¨</mi>
      </mrow>
      <mo>+</mo>
      <msubsup>
       <mi>ğ‘º</mi>
       <msub>
        <mi>ğ’™</mi>
        <mi>ğ’‚</mi>
       </msub>
       <mrow>
        <mo mathvariant="bold">-</mo>
        <mn>ğŸ</mn>
       </mrow>
      </msubsup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ‘º</ci>
     <ci>ğ’™</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ğ‘¨</ci>
        <ci>T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ‘º</ci>
         <ci>ğ’š</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>ğ‘¨</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ‘º</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ’™</ci>
         <ci>ğ’‚</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{S_{x}}=(\boldsymbol{A}^{T}\boldsymbol{S_{y}^{-1}}\boldsymbol{A}+%
\boldsymbol{S_{x_{a}}^{-1}})^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Optimal_estimation:25">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <msub>
      <mi>x</mi>
      <mi>a</mi>
     </msub>
     <mo>^</mo>
    </mover>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>ğ‘º</mi>
      <mi>ğ’™</mi>
     </msub>
     <msup>
      <mi>ğ‘¨</mi>
      <mi>T</mi>
     </msup>
     <mmultiscripts>
      <mi>ğ‘º</mi>
      <mi>ğ’š</mi>
      <none></none>
      <none></none>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mmultiscripts>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>y</mi>
        <mo stretchy="false">â†’</mo>
       </mover>
       <mo>-</mo>
       <mrow>
        <mi>ğ‘¨</mi>
        <mover accent="true">
         <msub>
          <mi>x</mi>
          <mi>a</mi>
         </msub>
         <mo>^</mo>
        </mover>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-^</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ‘º</ci>
       <ci>ğ’™</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ğ‘¨</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ‘º</ci>
        <ci>ğ’š</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-â†’</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>ğ‘¨</ci>
        <apply>
         <ci>normal-^</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>a</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{x}=\widehat{x_{a}}+\boldsymbol{S_{x}}\boldsymbol{A}^{T}\boldsymbol{S_%
{y}}^{-1}(\vec{y}-\boldsymbol{A}\widehat{x_{a}})
  </annotation>
 </semantics>
</math>

</p>

<p>Because we are using Gaussians, the expected value is equivalent to the maximum likely value, and so this is also a form of <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> estimation.</p>

<p>Typically with optimal estimation, in addition to the vector of retrieved quantities, one extra matrix is returned along with the covariance matrix. This is sometimes called the resolution matrix or the averaging kernel and is calculated as follows:</p>

<p>

<math display="block" id="Optimal_estimation:26">
 <semantics>
  <mrow>
   <mi>ğ‘¹</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>ğ‘¨</mi>
         <mi>T</mi>
        </msup>
        <mmultiscripts>
         <mi>ğ‘º</mi>
         <mi>ğ’š</mi>
         <none></none>
         <none></none>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mmultiscripts>
        <mi>ğ‘¨</mi>
       </mrow>
       <mo>+</mo>
       <mmultiscripts>
        <mi>ğ‘º</mi>
        <msub>
         <mi>ğ’™</mi>
         <mi>ğ’‚</mi>
        </msub>
        <none></none>
        <none></none>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mmultiscripts>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>ğ‘¨</mi>
     <mi>T</mi>
    </msup>
    <mmultiscripts>
     <mi>ğ‘º</mi>
     <mi>ğ’š</mi>
     <none></none>
     <none></none>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mmultiscripts>
    <mi>ğ‘¨</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ğ‘¹</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ğ‘¨</ci>
         <ci>T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ‘º</ci>
          <ci>ğ’š</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>ğ‘¨</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ‘º</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ’™</ci>
          <ci>ğ’‚</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ğ‘¨</ci>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ‘º</ci>
       <ci>ğ’š</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>ğ‘¨</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{R}=(\boldsymbol{A}^{T}\boldsymbol{S_{y}}^{-1}\boldsymbol{A}+%
\boldsymbol{S_{x_{a}}}^{-1})^{-1}\boldsymbol{A}^{T}\boldsymbol{S_{y}}^{-1}%
\boldsymbol{A}
  </annotation>
 </semantics>
</math>

</p>

<p>This tells us, for a given element of the retrieved vector, how much of the other elements of the vector are mixed in. In the case of a retrieval of profile information, it typical indicates the altitude resolution for a given altitude. For instance if the resolution vectors for all the altitudes contain non-zero elements (to a numerical tolerance) in their four nearest neighbours, then the altitude resolution is only one fourth that of the actual grid size.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Inverse_problems" title="wikilink">Category:Inverse problems</a> <a href="Category:Remote_sensing" title="wikilink">Category:Remote sensing</a></p>
</body>
</html>

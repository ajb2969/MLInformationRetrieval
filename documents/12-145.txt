   Cocks IBE scheme      Cocks IBE scheme   Cocks IBE scheme is an identity based encryption system proposed by Clifford Cocks in 2001. 1 The security of the scheme is based on the hardness of the quadratic residuosity problem .  Protocol  Setup  The PKG chooses:   a public RSA-modulus    n  =   p  q       n    p  q     \textstyle n=pq   , where     p  ,  q  ,  p   ‚â°  q  ‚â°   3  mod  4          p  q  p   q        modulo  3  4      \textstyle p,q,\,p\equiv q\equiv 3\mod 4   are prime and kept secret,  the message and the cipher space     ‚Ñ≥  =   {   -  1   ,  1  }    ,   ùíû  =   ‚Ñ§  n       formulae-sequence    ‚Ñ≥     1   1      ùíû   subscript  ‚Ñ§  n      \textstyle\mathcal{M}=\left\{-1,1\right\},\mathcal{C}=\mathbb{Z}_{n}   and  a secure public hash function    f  :     {  0  ,  1  }   *   ‚Üí   ‚Ñ§  n       normal-:  f   normal-‚Üí   superscript   0  1      subscript  ‚Ñ§  n      \textstyle f:\left\{0,1\right\}^{*}\rightarrow\mathbb{Z}_{n}   .   Extract  When user    I  D      I  D    \textstyle ID   wants to obtain his private key, he contacts the PKG through a secure channel. The PKG   derives   a   a   \textstyle a   with     (   a  n   )   =  1        a  n   1    \textstyle\left(\frac{a}{n}\right)=1   by a determistic process from    I  D      I  D    \textstyle ID   (e.g. multiple application of   f   f   \textstyle f   ),  computes    r  =    a    (    n  +  5   -  p  -  q   )   /  8    mod  n       r   modulo   superscript  a        n  5   p  q   8    n     \textstyle r=a^{(n+5-p-q)/8}\bmod n   (which fulfils either     r  2   =   a  mod  n        superscript  r  2    modulo  a  n     \textstyle r^{2}=a\bmod n   or     r  2   =    -  a   mod  n        superscript  r  2    modulo    a   n     \textstyle r^{2}=-a\bmod n   , see below) and  transmits   r   r   \textstyle r   to the user.   Encrypt  To encrypt a bit (coded as   1   1   \textstyle 1   /    -  1      1    \textstyle-1   )    m  ‚àà  ‚Ñ≥      m  ‚Ñ≥    \textstyle m\in\mathcal{M}   for    I  D      I  D    \textstyle ID   , the user   chooses random    t  1     subscript  t  1    \textstyle t_{1}   with    m  =   (    t  1   n   )       m     subscript  t  1   n     \textstyle m=\left(\frac{t_{1}}{n}\right)   ,  chooses random    t  2     subscript  t  2    \textstyle t_{2}   with    m  =   (    t  2   n   )       m     subscript  t  2   n     \textstyle m=\left(\frac{t_{2}}{n}\right)   , different from    t  1     subscript  t  1    \textstyle t_{1}   ,  computes     c  1   =     t  1   +   a   t  1   -  1      mod  n        subscript  c  1    modulo     subscript  t  1     a   superscript   subscript  t  1     1      n     \textstyle c_{1}=t_{1}+at_{1}^{-1}\bmod n   and     c  2   =    t  2   -   a   t  2   -  1           subscript  c  2      subscript  t  2     a   superscript   subscript  t  2     1        c_{2}=t_{2}-at_{2}^{-1}   and  sends    s  =   (   c  1   ,   c  2   )       s    subscript  c  1    subscript  c  2      \textstyle s=(c_{1},c_{2})   to the user.   Decrypt  To decrypt a ciphertext    s  =   (   c  1   ,   c  2   )       s    subscript  c  1    subscript  c  2      s=(c_{1},c_{2})   for user    I  D      I  D    ID   , he   computes    Œ±  =    c  1   +   2  r        Œ±     subscript  c  1     2  r      \alpha=c_{1}+2r   if     r  2   =  a       superscript  r  2   a    r^{2}=a   or    Œ±  =    c  2   +   2  r        Œ±     subscript  c  2     2  r      \alpha=c_{2}+2r   otherwise, and  computes    m  =   (   Œ±  n   )       m    Œ±  n     m=\left(\frac{\alpha}{n}\right)   .   Note that here we are assuming that the encrypting entity does not know whether    I  D      I  D    ID   has the square root    r   r   r   of   a   a   a   or    -  a      a    -a   . In this case we have to send a ciphertext for both cases. As soon as this information is known to the encrypting entity, only one element needs to be sent.  Correctness  First note that since    p  ‚â°  q  ‚â°   3  mod  4         p  q        modulo  3  4      \textstyle p\equiv q\equiv 3\bmod 4   (i.e.     (    -  1   p   )   =   (    -  1   q   )   =   -  1             1   p       1   q          1      \left(\frac{-1}{p}\right)=\left(\frac{-1}{q}\right)=-1   ) and     (   a  n   )   ‚áí   (   a  p   )   =   (   a  q   )        normal-‚áí    a  n     a  p          a  q      \textstyle\left(\frac{a}{n}\right)\Rightarrow\left(\frac{a}{p}\right)=\left(%
 \frac{a}{q}\right)   , either   a   a   \textstyle a   or    -  a      a    \textstyle-a   is a quadratic residue modulo   n   n   \textstyle n   .  Therefore,   r   r   \textstyle r   is a square root of   a   a   \textstyle a   or    -  a      a    \textstyle-a   :      r  2     superscript  r  2    \displaystyle r^{2}     Moreover (for the case that   a   a   \textstyle a   is a quadratic residue, same idea holds for    -  a      a    \textstyle-a   ):      (     s  +   2  r    n    )        s    2  r    n    \displaystyle\left(\frac{s+2r}{n}\right)     Security  It can be shown that breaking the scheme is equivalent to solving the quadratic residuosity problem, which is suspected to be very hard. The common rules for choosing a RSA modulus hold: Use a secure   n   n   \textstyle n   , make the choice of   t   t   \textstyle t   uniform and random and moreover include some authenticity checks for   t   t   \textstyle t   (otherwise, an adaptive chosen ciphertext attack can be mounted by altering packets that transmit a single bit and using the oracle to observe the effect on the decrypted bit).  Problems  A major disadavantage of this scheme is that it can encrypt messages only bit per bit - therefore, it is only suitable for small data packets like a session key. To illustrate, consider a 128 bit key that is transmitted using a 1024 bit modulus. Then, one has to send 2¬†√ó¬†128¬†√ó¬†1024¬†bit =¬†32¬†KByte (when it is not known whether   r   r   r   is the square of a or ‚àí a ), which is only acceptable for environments in which session keys change infrequently.  This scheme does not preserve key-privacy, i.e. a passive adversary can recover meaningful information about the identity of the recipient observing the ciphertext.  References    "  Category:Identity-based cryptography     Clifford Cocks, An Identity Based Encryption Scheme Based on Quadratic Residues , Proceedings of the 8th IMA International Conference on Cryptography and Coding , 2001 ‚Ü©     
   Multi-compartment model      Multi-compartment model   A multi-compartment model is a type of mathematical model used for describing the way materials or energies are transmitted among the compartments of a system. Each compartment is assumed to be a homogeneous entity within which the entities being modelled are equivalent. For instance, in a pharmacokinetic model, the compartments may represent different sections of a body within which the concentration of a drug is assumed to be uniformly equal.  Hence a multi-compartment model is a lumped parameters model.  Multi-compartment models are used in many fields including pharmacokinetics , epidemiology , biomedicine , systems theory , complexity theory , engineering, physics, information science and social science. The circuits systems can be viewed as a multi-compartment model as well.  In systems theory, it involves the description of a network whose components are compartments that represent a population of elements that are equivalent with respect to the manner in which they process input signals to the compartment.       Instant homogeneous distribution of materials or energies within a "compartment."  The exchange rate of materials or energies among the compartments is related to the densities of these compartments.  Usually, it is desirable that the materials do not undergo chemical reactions while transmitting among the compartments.  When concentration of the cell is of interest, typically the volume is assumed to be constant over time, though this may not be totally true in reality.   Most commonly, the mathematics of multi-compartment models is simplified to provide only a single parameterâ€”such as concentrationâ€”within a compartment.  Single-compartment model  (Figure)  Singlecell.PNG   Possibly the simplest application of multi-compartment model is in the single-cell concentration monitoring (see the figure above). If the volume of a cell is V , the mass of solute is q , the input is u ( t ) and the secretion of the solution is proportional to the density of it within the cell, then the concentration of the solution ''C"' within the cell over time is given by        d  q    d  t    =    u   (  t  )    -   k  q            normal-d  q     normal-d  t        u  t     k  q      \frac{\mathrm{d}q}{\mathrm{d}t}=u(t)-kq         C  =   q  V       C    q  V     C=\frac{q}{V}     where k is the proportionality.  As the number of compartments increases, the model can be very complex and the solutions usually beyond ordinary calculation. Below shows a three-cell model with interlinks among each other.  The formulae for n-cell multi-compartment models become:        q  Ë™   1   =     q  1    k  11    +    q  2    k  12    +  â‹¯  +    q  n    k   1  n     +    u  1    (  t  )          subscript   normal-Ë™  q   1        subscript  q  1    subscript  k  11       subscript  q  2    subscript  k  12    normal-â‹¯     subscript  q  n    subscript  k    1  n        subscript  u  1   t      \displaystyle\dot{q}_{1}=q_{1}k_{11}+q_{2}k_{12}+\cdots+q_{n}k_{1n}+u_{1}(t)     Where      0  =    âˆ‘   i  =  1   n    k   i  j         0    subscript   superscript   n     i  1     subscript  k    i  j       0=\sum^{n}_{i=1}{k_{ij}}   for    j  =   1  ,  2  ,  â€¦  ,  n       j   1  2  normal-â€¦  n     j=1,2,\dots,n   (as the total 'contents' of all compartments is constant in a closed system)  Or in matrix forms:       ğª  Ë™   =   ğŠğª  +  ğ®        normal-Ë™  ğª     ğŠğª  ğ®     \mathbf{\dot{q}}=\mathbf{Kq}+\mathbf{u}     Where      ğŠ  =    [      k  11      k  12     â‹¯     k   ;   1  n          k  21      k  22     â‹¯     k   ;   2  n         â‹®    â‹®    â‹±    â‹®       k   n  1       k   n  2      â‹¯     k   ;   n  n        ]   ğª   =    [      q  1        q  2       â‹®       q  n      ]   ğ®   =   [       u  1    (  t  )          u  2    (  t  )        â‹®        u  n    (  t  )       ]         ğŠ       subscript  k  11    subscript  k  12   normal-â‹¯   fragments  k   subscript  normal-;    1  n        subscript  k  21    subscript  k  22   normal-â‹¯   fragments  k   subscript  normal-;    2  n       normal-â‹®  normal-â‹®  normal-â‹±  normal-â‹®     subscript  k    n  1     subscript  k    n  2    normal-â‹¯   fragments  k   subscript  normal-;    n  n       ğª             subscript  q  1      subscript  q  2     normal-â‹®     subscript  q  n     ğ®             subscript  u  1   t        subscript  u  2   t     normal-â‹®       subscript  u  n   t        \mathbf{K}=\begin{bmatrix}k_{11}&k_{12}&\cdots&k_{1n}\\
 k_{21}&k_{22}&\cdots&k_{2n}\\
 \vdots&\vdots&\ddots&\vdots\\
 k_{n1}&k_{n2}&\cdots&k_{nn}\\
 \end{bmatrix}\mathbf{q}=\begin{bmatrix}q_{1}\\
 q_{2}\\
 \vdots\\
 q_{n}\end{bmatrix}\mathbf{u}=\begin{bmatrix}u_{1}(t)\\
 u_{2}(t)\\
 \vdots\\
 u_{n}(t)\end{bmatrix}   and      [     1    1    â‹¯    1     ]   ğŠ   =   [     0    0    â‹¯    0     ]           1  1  normal-â‹¯  1    ğŠ     0  0  normal-â‹¯  0      \begin{bmatrix}1&1&\cdots&1\\
 \end{bmatrix}\mathbf{K}=\begin{bmatrix}0&0&\cdots&0\\
 \end{bmatrix}   (as the total 'contents' of all compartments is constant in a closed system)  In the special case of a closed system (see below) i.e. where    ğ®  =  0      ğ®  0    \mathbf{u}=0   then there is a general solution.      ğª  =     c  1    e    Î»  1   t     ğ¯  ğŸ    +    c  2    e    Î»  2   t     ğ¯  ğŸ    +  â‹¯  +    c  n    e    Î»  n   t     ğ¯  ğ§         ğª       subscript  c  1    superscript  e     subscript  Î»  1   t     subscript  ğ¯  1       subscript  c  2    superscript  e     subscript  Î»  2   t     subscript  ğ¯  2    normal-â‹¯     subscript  c  n    superscript  e     subscript  Î»  n   t     subscript  ğ¯  ğ§       \mathbf{q}=c_{1}e^{\lambda_{1}t}\mathbf{v_{1}}+c_{2}e^{\lambda_{2}t}\mathbf{v_%
 {2}}+\cdots+c_{n}e^{\lambda_{n}t}\mathbf{v_{n}}     Where    Î»  1     subscript  Î»  1    \lambda_{1}   ,    Î»  2     subscript  Î»  2    \lambda_{2}   , ... and    Î»  n     subscript  Î»  n    \lambda_{n}   are the eigenvalues of   ğŠ   ğŠ   \mathbf{K}   ;    ğ¯  ğŸ     subscript  ğ¯  1    \mathbf{v_{1}}   ,    ğ¯  ğŸ     subscript  ğ¯  2    \mathbf{v_{2}}   , ... and    ğ¯  ğ§     subscript  ğ¯  ğ§    \mathbf{v_{n}}   are the respective eigenvectors of   ğŠ   ğŠ   \mathbf{K}   ; and    c  1     subscript  c  1    c_{1}   ,    c  2     subscript  c  2    c_{2}   , .... and    c  n     subscript  c  n    c_{n}   are constants.  However it can be shown that given the above requirement to ensure the 'contents' of a closed system are constant, then for every pair of eigenvalue and eigenvector then either    Î»  =  0      Î»  0    \lambda=0   or      [     1    1    â‹¯    1     ]   ğ¯   =  0          1  1  normal-â‹¯  1    ğ¯   0    \begin{bmatrix}1&1&\cdots&1\\
 \end{bmatrix}\mathbf{v}=0   and also that one eigenvalue is 0, say    Î»  1     subscript  Î»  1    \lambda_{1}     So      ğª  =     c  1    ğ¯  ğŸ    +    c  2    e    Î»  2   t     ğ¯  ğŸ    +  â‹¯  +    c  n    e    Î»  n   t     ğ¯  ğ§         ğª       subscript  c  1    subscript  ğ¯  1       subscript  c  2    superscript  e     subscript  Î»  2   t     subscript  ğ¯  2    normal-â‹¯     subscript  c  n    superscript  e     subscript  Î»  n   t     subscript  ğ¯  ğ§       \mathbf{q}=c_{1}\mathbf{v_{1}}+c_{2}e^{\lambda_{2}t}\mathbf{v_{2}}+\cdots+c_{n%
 }e^{\lambda_{n}t}\mathbf{v_{n}}     Where        [     1    1    â‹¯    1     ]    ğ¯  ğ¢    =  0          1  1  normal-â‹¯  1     subscript  ğ¯  ğ¢    0    \begin{bmatrix}1&1&\cdots&1\\
 \end{bmatrix}\mathbf{v_{i}}=0   for    ğ¢  =   2  ,  3  ,   â€¦  n        ğ¢   2  3    normal-â€¦  n      \mathbf{i}=2,3,\dots n     This solution can be rearranged:      ğª  =    [     ğ¯  ğŸ    [      c  1     0    â‹¯    0     ]    +    ğ¯  ğŸ    [     0     c  2     â‹¯    0     ]    +  â€¦  +    ğ¯  ğ§    [     0    0    â‹¯     c  n      ]     ]    [     1       e    Î»  2   t        â‹®       e    Î»  n   t       ]        ğª     delimited-[]       subscript  ğ¯  1      subscript  c  1   0  normal-â‹¯  0        subscript  ğ¯  2     0   subscript  c  2   normal-â‹¯  0     normal-â€¦     subscript  ğ¯  ğ§     0  0  normal-â‹¯   subscript  c  n          1     superscript  e     subscript  Î»  2   t      normal-â‹®     superscript  e     subscript  Î»  n   t         \mathbf{q}=\Bigg[\mathbf{v_{1}}\begin{bmatrix}c_{1}&0&\cdots&0\\
 \end{bmatrix}+\mathbf{v_{2}}\begin{bmatrix}0&c_{2}&\cdots&0\\
 \end{bmatrix}+\dots+\mathbf{v_{n}}\begin{bmatrix}0&0&\cdots&c_{n}\\
 \end{bmatrix}\Bigg]\begin{bmatrix}1\\
 e^{\lambda_{2}t}\\
 \vdots\\
 e^{\lambda_{n}t}\\
 \end{bmatrix}     This somewhat inelegant equation demonstrates that all solutions of an n-cell multi-compartment model with constant or no inputs are of the form:      ğª  =   ğ€   [     1       e    Î»  2   t        â‹®       e    Î»  n   t       ]        ğª    ğ€    1     superscript  e     subscript  Î»  2   t      normal-â‹®     superscript  e     subscript  Î»  n   t         \mathbf{q}=\mathbf{A}\begin{bmatrix}1\\
 e^{\lambda_{2}t}\\
 \vdots\\
 e^{\lambda_{n}t}\\
 \end{bmatrix}     Where   ğ€   ğ€   \mathbf{A}   is a nxn matrix and    Î»  2     subscript  Î»  2    \lambda_{2}   ,    Î»  3     subscript  Î»  3    \lambda_{3}   , ... and    Î»  n     subscript  Î»  n    \lambda_{n}   are constants. Where      [     1    1    â‹¯    1     ]   ğ€   =   [     a    0    â‹¯    0     ]           1  1  normal-â‹¯  1    ğ€     a  0  normal-â‹¯  0      \begin{bmatrix}1&1&\cdots&1\\
 \end{bmatrix}\mathbf{A}=\begin{bmatrix}a&0&\cdots&0\\
 \end{bmatrix}     Model topologies  Generally speaking, as the number of compartments increase, it is challenging both to find the algebraic and numerical solutions of the model. However, there are special cases of models, which rarely exist in nature, when the topologies exhibit certain regularities that the solutions become easier to find. The model can be classified according to the interconnection of cells and input/output characteristics:   Closed model : No sinks or source, lit. all k oi = 0 and u i = 0;  Open model : There are sinks or/and sources among cells.  Catenary model : All compartments are arranged in a chain, with each pool connecting only to its neighbors. This model has two or more cells.  Cyclic model : It's a special case of the catenary model, with three or more cells, in which the first and last cell are connected, i.e. k 1 n â‰  0 or/and k n 1 â‰  0.  Mammillary model : Consists of a central compartment with peripheral compartments connecting to it. There are no interconnections among other compartments.  Reducible model : It's a set of unconnected models. It bears great resemblance to the computer concept of forest as against trees .   See also   Mathematical model  Biomedical engineering  Biological neuron models  Compartmental models in epidemiology  Physiologically-based pharmacokinetic modelling   References   Godfrey, K., Compartmental Models and Their Application , Academic Press, 1983 (ISBN 0-12-286970-2).  Anderson, D. H., Compartmental Modeling and Tracer Kinetics , Springer-Verlag Lecture Notes in Biomathematics #50, 1983 (ISBN 0-387-12303-2).  Jacquez, J. A, Compartmental Analysis in Biology and Medicine , 2nd ed., The University of Michigan Press, 1985.  Evans, W. C., Linear Systems, Compartmental Modeling, and Estimability Issues in IAQ Studies, in Tichenor, B., Characterizing Sources of Indoor Air Pollution and Related Sink Effects , ASTM STP 1287, pp.Â 239â€“262, 1996 (ISBN 0-8031-2030-3).   "  Category:Mathematical modeling  Category:Systems theory   
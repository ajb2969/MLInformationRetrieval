<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="387">Weber problem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Weber problem</h1>
<hr/>

<p>In <a class="uri" href="geometry" title="wikilink">geometry</a>, the <strong>Weber problem</strong>, named after <a href="Alfred_Weber" title="wikilink">Alfred Weber</a>, is one of the most famous problems in <a href="location_theory" title="wikilink">location theory</a>. It requires finding a point in the plane that minimizes the sum of the transportation costs from this point to <em>n</em> destination points, where different destination points are associated with different costs per unit distance.</p>

<p>The Weber problem generalizes the <a href="geometric_median" title="wikilink">geometric median</a>, which assumes transportation costs per unit distance are the same for all destination points, and the problem of computing the <a href="Fermat_point" title="wikilink">Fermat point</a>, the geometric median of three points. For this reason it is sometimes called the Fermat–Weber problem, although the same name has also been used for the unweighted geometric median problem. The Weber problem is in turn generalized by the <a href="attraction–repulsion_problem" title="wikilink">attraction–repulsion problem</a>, which allows some of the costs to be negative, so that greater distance from some points is better.</p>
<h2 id="definition-and-history-of-the-fermat-weber-and-attraction-repulsion-problems">Definition and history of the Fermat, Weber, and attraction-repulsion problems</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">
<p>The Fermat problem</p></th>
<th style="text-align: left;">
<p>The Weber problem</p></th>
<th style="text-align: left;">
<p>The attraction-repulsion problem</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>First formulated by</p></td>
<td style="text-align: left;">
<p>Fermat (before 1640)</p></td>
<td style="text-align: left;">
<p>Simpson (1750)</p></td>
<td style="text-align: left;">
<p>Tellier (1985)</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Geometrical solution of the triangle problem</p></td>
<td style="text-align: left;">
<p>Torricelli (1645)</p></td>
<td style="text-align: left;">
<p>Simpson (1750)</p></td>
<td style="text-align: left;">
<p>Tellier (2013)</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Direct numerical solution of the triangle problem</p></td>
<td style="text-align: left;">
<p>Tellier (1972)</p></td>
<td style="text-align: left;">
<p>Tellier (1972)</p></td>
<td style="text-align: left;">
<p>Tellier (1985)</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Iterative numerical solution of the problem</p></td>
<td style="text-align: left;">
<p>Kuhn and Kuenne (1962)</p></td>
<td style="text-align: left;">
<p>Kuhn and Kuenne (1962)</p></td>
<td style="text-align: left;">
<p>Chen, Hansen, Jaumard and Tuy (1992)</p></td>
</tr>
</tbody>
</table>

<p>In the triangle case, the Fermat problem consists in locating a point D with respect to three points A, B, and C in such a way that the sum of the distances between D and each of the three other points is minimized. It was formulated by the famous French mathematician <a href="Pierre_de_Fermat" title="wikilink">Pierre de Fermat</a> before 1640, and it can be seen as the true beginning of both location theory, and space-economy. Torricelli found a geometrical solution to this problem around 1645, but it still had no direct numerical solution more than 325 years later. Kuhn and Kuenne<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> found an iterative solution for the general Fermat problem in 1962, and, in 1972, <a href="Luc-Normand_Tellier" title="wikilink">Tellier</a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> found a direct numerical solution to the Fermat triangle problem, which is trigonometric. Kuhn and Kuenne’s solution applies to the case of polygons having more than three sides, which is not the case with Tellier’s solution for reasons explained further on.</p>

<p>The Weber problem consists, in the triangle case, in locating a point D with respect to three points A, B, and C in such a way that the sum of the transportation costs between D and each of the three other points is minimized. The Weber problem is a generalization of the Fermat problem since it involves both equal and unequal attractive forces (see below), while the Fermat problem only deals with equal attractive forces. It was first formulated, and solved geometrically in the triangle case, by <a href="Thomas_Simpson" title="wikilink">Thomas Simpson</a> in 1750.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> It was later popularized by <a href="Alfred_Weber" title="wikilink">Alfred Weber</a> in 1909.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Kuhn and Kuenne’s iterative solution found in 1962, and Tellier’s solution found in 1972 apply to the Weber triangle problem as well as to the Fermat one. Kuhn and Kuenne’s solution applies also to the case of polygons having more than three sides.</p>

<p>In its simplest version, the attraction-repulsion problem consists in locating a point D with respect to three points A<sub>1</sub>, A<sub>2</sub> and R in such a way that the attractive forces exerted by points A<sub>1</sub> and A<sub>2</sub>, and the repulsive force exerted by point R cancel each other out as it must do at the optimum. It constitutes a generalization of both the Fermat and Weber problems. It was first formulated and solved, in the triangle case, in 1985 by <a href="Luc-Normand_Tellier" title="wikilink">Luc-Normand Tellier</a>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In 1992, Chen, Hansen, Jaumard and Tuy found a solution to the Tellier problem for the case of polygons having more than three sides.</p>
<h2 id="torricellis-geometrical-solution-of-the-fermat-triangle-problem">Torricelli’s geometrical solution of the Fermat triangle problem</h2>

<p><a href="File:Figaa.jpg" title="wikilink">thumb|alt=Torricelli's solution|right|upright=1.5| Torricelli's geometrical solution of the Fermat triangle problem.</a></p>

<p><a href="Evangelista_Torricelli" title="wikilink">Evangelista Torricelli</a>’s geometrical solution of the Fermat triangle problem stems from two observations:</p>

<p>1– point D is at its optimal location when any significant move out of that location induces a net increase of the total distance to reference points A, B, and C, which means that the optimal point is the only point where an infinitesimal movement towards one of the three reference points induces a reduction of the distance to that point that is equal to the sum of the induced changes in the distances to the two other points; in fact, in the Fermat problem, the advantage to reduce the distance from A by one kilometer is equal to the advantage to reduce the distance from B by one kilometer or the distance from C by the same length; in other words, the activity to be located at D is equally attracted by A, B, and C;</p>

<p>2– according to an important theorem of Euclidean geometry, in a convex quadrilateral inscribed in a circle, the opposite angles are supplementary (that is their sum is equal to 180°); that theorem can also take the following form: if we cut a circle with a chord AB, we get two circle arcs, let us say AiB and AjB; on arc AiB, any ∠AiB angle is the same for any chosen point i, and, on arc AjB, all the ∠AjB angles are also equal for any chosen point j; moreover, the ∠AiB and ∠AjB angles are supplementary.</p>

<p>It can be proved that the first observation implies that, at the optimum, the angles between the AD, BD, and CD straight lines must be equal to 360° / 3 = 120°. Torricelli deduced from that conclusion that:</p>

<p>1– if any triangle ABD, whose ∠ADB angle is equal to 120°, generates an ABDE convex quadrilateral inscribed in a circle, the ∠ABE angle of the ABE triangle must be equal to (180° − 120°)= 60°;</p>

<p>2– one way to determine the set of locations of D for which the ∠ADB angle is equal to 120° is to draw an equilateral ABE triangle (because each angle of an equilateral triangle is equal to 60°), where E is located outside the ABC triangle, and draw a circle round that triangle; then all the D’ points of the circumference of that circle that lie within the ABC circle are such that the ∠AD’B angle is equal to 120°;</p>

<p>3– the same reasoning can be made with respect to triangles ACD, and BCD;</p>

<p>4– this leads to draw two other equilateral triangles ACF and BCG, where F and G are located outside the ABC triangle, as well as two other circles round these equilateral triangles, and to determine the location where the three circles intersect; at that location, the angles between the AD, BD, and CD straight lines is necessarily equal to 120°, which proves that it is the optimal location.</p>
<h2 id="simpsons-geometrical-solution-of-the-weber-triangle-problem">Simpson’s geometrical solution of the Weber triangle problem</h2>

<p><a href="File:Figb.jpg" title="wikilink">thumb|alt=Simpson's solution|right|upright=1.5| Simpson's geometrical solution of the Weber triangle problem.</a></p>

<p>Simpson’s geometrical solution of the so-called “Weber triangle problem” (which was first formulated by <a href="Thomas_Simpson" title="wikilink">Thomas Simpson</a> in 1750) directly derives from Torricelli’s solution. Simpson and Weber stressed the fact that, in a total transportation minimization problem, the advantage to get closer to each attraction point A, B or C depends on what is carried and on its transportation cost. Consequently, the advantage of getting one kilometer closer to A, B or C varies, and the ∠ADB, ∠ADC and ∠BDC angles no more need to be equal to 120°.</p>

<p>Simpson demonstrated that, in the same way as, in the Fermat triangle problem case, the constructed triangles ABE, ACF and BCG were equilateral because the three attractive forces were equal, in the Weber triangle problem case, the constructed triangles ABE, ACF and BCG, where E, F and G are located outside the ABC triangle, must be proportional to the attractive forces of the location system.</p>

<p>The solution is such that:</p>

<p>1– in the constructed triangle ABE, the AB side is proportional to the attractive force <sub>C</sub>w pointing towards C, the AE side is proportional to the attractive force <sub>B</sub>w pointing towards B, and the BE side is proportional to the attractive force <sub>A</sub>w pointing towards A;</p>

<p>2– in the constructed triangle BCG, the BC side is proportional to the attractive force <sub>A</sub>w pointing towards A, the BG side is proportional to the attractive force <sub>B</sub>w pointing towards B, and the CG side is proportional to the attractive force <sub>C</sub>w pointing towards C;</p>

<p>3– the optimal point D is located at the intersection of the two circumferences drawn round the ABE and BCG constructed triangles.</p>

<p>A third triangle of forces ACF, where F is located outside the ABC triangle, can be drawn based on the AC side, and a third circumference can be traced round that triangle. That third circumference crosses the two previous ones at the same point D.</p>
<h2 id="telliers-geometrical-solution-of-the-attraction-repulsion-triangle-problem">Tellier’s geometrical solution of the attraction-repulsion triangle problem</h2>

<p><a href="File:Figc.jpg" title="wikilink">thumb|alt=Tellier's solution|right|upright=1.5| Tellier's geometrical solution of the attraction-repulsion triangle problem.</a></p>

<p>A geometrical solution exists for the attraction-repulsion triangle problem. Its discovery is very recent.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> That geometrical solution differs from the two previous ones since, in this case, the two constructed force triangles overlap the A<sub>1</sub>A<sub>2</sub>R location triangle (where A<sub>1</sub> and A<sub>2</sub> are attraction points, and R, a repulsion one), while, in the preceding cases, they never did.</p>

<p>This solution is such that:</p>

<p>1– in the constructed triangle RA<sub>2</sub>H, which partly overlaps the A<sub>1</sub>A<sub>2</sub>R location triangle, the RA<sub>2</sub> side is proportional to the attractive force <sub>A1</sub>w pointing towards A<sub>1</sub>, the RH side is proportional to the attractive force <sub>A2</sub>w pointing towards A<sub>2</sub>, and the A<sub>2</sub>H side is proportional to the repulsive force <sub>R</sub>w pushing away from point R;</p>

<p>2– in the constructed triangle RA<sub>1</sub>I, which partly overlaps the A<sub>1</sub>A<sub>2</sub>R location triangle, the RA<sub>1</sub> side is proportional to the attractive force <sub>A2</sub>w pointing towards A<sub>2</sub>, the RI side is proportional to the attractive force <sub>A1</sub>w pointing towards A<sub>1</sub>, and the A<sub>1</sub>I side is proportional to the repulsive force <sub>R</sub>w pushing away from point R;</p>

<p>3– the optimal point D is located at the intersection of the two circumferences drawn round the RA<sub>2</sub>H and RA<sub>1</sub>I constructed triangles. This solution is useless if one of the forces is greater than the sum of the two other ones or if the angles are not compatible. In some cases, no force is larger than the two other ones, and the angles are not compatible; then, the optimal location lies at the point that exerts the greater attractive force.</p>
<h2 id="telliers-trigonometric-solution-of-the-fermat-and-weber-triangle-problems">Tellier’s trigonometric solution of the Fermat and Weber triangle problems</h2>

<p><a href="File:Figd.jpg" title="wikilink">thumb|alt=The Weber problem|right|upright=1.1| The angles of the Weber problem.</a> <a href="File:Fige.jpg" title="wikilink">thumb|alt=Non-coincidence of angles|right|upright=1.1| The case of non-coincidence of the vertices of the α angles.</a></p>

<p>More than 332 years separate the first formulation of the Fermat triangle problem and the discovery of its non-iterative numerical solution, while a geometrical solution existed for almost all that period of time. Is there an explanation for that? That explanation lies in the possibility of the origins of the three vectors oriented towards the three attraction points not coinciding. If those origins do coincide and lie at the optimum location P, the vectors oriented towards A, B and C, and the sides of the ABC location triangle form the six angles ∠1, ∠2, ∠3, ∠4, ∠5, and ∠6, and the three vectors form the ∠α<sub>A</sub>, ∠α<sub>B</sub> and ∠α<sub>C</sub> angles. It is easy to write the following six equations linking six unknowns (the angles ∠1, ∠2, ∠3, ∠4, ∠5, and ∠6) with six known values (angles ∠A, ∠B, and ∠C, whose values are given, and angles ∠α<sub>A</sub>, ∠α<sub>B</sub> and ∠α<sub>C</sub>, whose values depend only on the relative magnitude of the three attractive forces pointing towards the A, B and C attraction points):</p>
<dl>
<dd>∠1 + ∠2 = ∠C ;
</dd>
<dd>∠3 + ∠4 = ∠A ;
</dd>
<dd>∠5 + ∠6 = ∠B ;
</dd>
<dd>∠1 + ∠6 + ∠α<sub>A</sub> = 180° ;
</dd>
<dd>∠2 + ∠3 + ∠α<sub>B</sub> = 180° ;
</dd>
<dd>∠4 + ∠5 + ∠α<sub>C</sub> = 180°.
</dd>
</dl>

<p>Unfortunately, this system of six simultaneous equations with six unknowns is undetermined, and the possibility of the origins of the three vectors oriented towards the three attraction points not coinciding explains why. In the case of non-coincidence, we observe that all the six equations are still valid. However, the optimal location P has disappeared because of the triangular hole that exists inside the triangle. In fact, as Tellier (1972)<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> has shown, that triangular hole had exactly the same proportions as the “forces triangles” we drew in Simpson’s geometrical solution.</p>

<p>In order to solve the problem, we must add to the six simultaneous equations a seventh requirement, which states that there should be no triangular hole in the middle of the location triangle. In other words, the origins of the three vectors must coincide.</p>

<p>Tellier’s solution of the Fermat and Weber triangle problems involves three steps:</p>

<p>1– Determine the angles ∠α<sub>A</sub>, ∠α<sub>B</sub> and ∠α<sub>C</sub> that are such that the three attractives forces <sub>A</sub>w, <sub>B</sub>w and <sub>C</sub>w cancel each other to ensure equilibrium. This is done by means of the following independent equations:</p>
<dl>
<dd>cos ∠α<sub>A</sub> = −( <sub>B</sub>w<sup>2</sup> + <sub>C</sub>w<sup>2</sup> − <sub>A</sub>w<sup>2</sup>) / (2 <sub>B</sub>w <sub>C</sub>w) ;
</dd>
<dd>cos ∠α<sub>B</sub> = −( <sub>A</sub>w<sup>2</sup> + <sub>C</sub>w<sup>2</sup> − <sub>B</sub>w<sup>2</sup>) / (2 <sub>A</sub>w <sub>C</sub>w) ;
</dd>
<dd>cos ∠α<sub>C</sub> = −( <sub>A</sub>w<sup>2</sup> + <sub>B</sub>w<sup>2</sup> − <sub>C</sub>w<sup>2</sup>) / (2 <sub>A</sub>w <sub>B</sub>w) ;
</dd>
</dl>

<p>2– Determine the value of angle ∠3 (this equation derives from the requirement that point D must coincide with point E):</p>
<dl>
<dd>tan ∠3 = (k sin k’) / (1 + k cos k’) ;
</dd>
</dl>

<p>where k = (CB/CA) (sin ∠α<sub>B</sub> / sin ∠α<sub>A</sub>), and k’ = (∠A +∠B + ∠α<sub>C</sub>) − 180° ;</p>

<p>3– Solve the following system of simultaneous equations where ∠3 is now known:</p>
<dl>
<dd>∠1 + ∠2 = ∠C ;
</dd>
<dd>∠3 + ∠4 = ∠A ;
</dd>
<dd>∠5 + ∠6 = ∠B ;
</dd>
<dd>∠1 + ∠6 + ∠α<sub>A</sub> = 180° ;
</dd>
<dd>∠2 + ∠3 + ∠α<sub>B</sub> = 180° ;
</dd>
<dd>∠4 + ∠5 + ∠α<sub>C</sub> = 180°.
</dd>
</dl>
<h2 id="telliers-trigonometric-solution-of-the-triangle-attraction-repulsion-problem">Tellier’s trigonometric solution of the triangle attraction-repulsion problem</h2>

<p><a href="File:Figf.jpg" title="wikilink">thumb|alt= The attraction-repulsion triangle problem |right|upright=1.6| The angles of the attraction-repulsion triangle problem.</a> <a href="File:Figg.jpg" title="wikilink">thumb|alt= Non-coincidence of points D and E |right|upright=1.6| The case of non-coincidence of points D and E.</a></p>

<p>Tellier (1985)<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> extended the Fermat–Weber problem to the case of repulsive forces. Let us examine the triangle case where there are two attractive forces <sub>A1</sub>w and <sub>A2</sub>w, and one repulsive force <sub>R</sub>w. Here as in the previous case, the possibility exists for the origins of the three vectors not to coincide. So the solution must require their coinciding. Tellier’s trigonometric solution of this problem is the following:</p>

<p>1– Determine angle ∠e :</p>
<dl>
<dd>cos ∠e = -( <sub>A1</sub>w<sup>2</sup> + <sub>A2</sub>w<sup>2</sup> − <sub>R</sub>w<sup>2</sup>) / (2 <sub>A1</sub>w <sub>A2</sub>w) ;
</dd>
</dl>

<p>2– Determine angle ∠p :</p>
<dl>
<dd>cos ∠p = -( <sub>A1</sub>w<sup>2</sup> + <sub>R</sub>w<sup>2</sup> − <sub>A2</sub>w<sup>2</sup>) / (2 <sub>A1</sub>w <sub>R</sub>w) ;
</dd>
</dl>

<p>3– Determine angle ∠c :</p>
<dl>
<dd>∠c = 180° − ∠p ;
</dd>
</dl>

<p>4– Determine angle ∠d :</p>
<dl>
<dd>∠d = ∠e − ∠c ;
</dd>
</dl>

<p>5– Determine the value of angle ∠3 (this equation derives from the requirement that point D must coincide with point E):</p>
<dl>
<dd>tan ∠3 = x / y ;
</dd>
</dl>

<p>where x = sin ∠f – (RA<sub>1</sub>/RA<sub>2</sub>)(sin ∠d sin [∠e − ∠b] / sin ∠c) ; and y = (RA<sub>1</sub>/RA<sub>2</sub>)(sin ∠d cos [∠e − ∠b] / sin ∠c) − cos ∠f ;</p>

<p>6– Determine ∠1 :</p>
<dl>
<dd>∠1 = 180° − ∠e − ∠3 ;
</dd>
</dl>

<p>7– Determine ∠5 :</p>
<dl>
<dd>∠5 = 180° − ∠b − ∠c − ∠1 ;
</dd>
</dl>

<p>8– Determine ∠2 :</p>
<dl>
<dd>∠2 = ∠a − ∠5 .
</dd>
</dl>
<h2 id="iterative-solutions-of-the-fermat-weber-and-attraction-repulsion-problems">Iterative solutions of the Fermat, Weber and attraction-repulsion problems</h2>

<p>When the number of forces is larger than three, it is no longer possible to determine the angles separating the various forces without taking into account the geometry of the location polygon. Geometric and trigonometric methods are then powerless. Iterative optimizing methods are used in such cases. Kuhn and Kuenne (1962)<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> suggested an algorithm based on <a href="iteratively_reweighted_least_squares" title="wikilink">iteratively reweighted least squares</a> generalizing <a href="Weiszfeld's_algorithm" title="wikilink">Weiszfeld's algorithm</a> for the <a href="geometric_median" title="wikilink">unweighted problem</a>. Their method is valid for the Fermat and Weber problems involving many forces, but not for the attraction–repulsion problem. In this method, to find an approximation to the point <em>y</em> minimizing the weighted sum of distances</p>

<p>

<math display="block" id="Weber_problem:0">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mi>y</mi>
      </mrow>
      <mo>∥</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}w_{i}\,\|x_{i}-y\|,
  </annotation>
 </semantics>
</math>

 an initial approximation to the solution <em>y</em><sub>0</sub> is found, and then at each stage of the algorithm is moved closer to the optimal solution by setting <em>y</em><sub><em>j</em> + 1</sub> to be the point minimizing the sum of weighted squared distances</p>

<p>

<math display="block" id="Weber_problem:1">
 <semantics>
  <mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mrow>
    <mfrac>
     <msub>
      <mi>w</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mi>j</mi>
       </msub>
      </mrow>
      <mo>∥</mo>
     </mrow>
    </mfrac>
    <msup>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mi>y</mi>
      </mrow>
      <mo>∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <ci>y</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}\frac{w_{i}}{\|x_{i}-y_{j}\|}\|x_{i}-y\|^{2}
  </annotation>
 </semantics>
</math>

 where the initial weights <em>w</em><sub><em>i</em></sub> of the input points are divided by the distances from each point to the approximation from the previous stage. As the unique optimal solution to a weighted least squares problem, each successive approximation may be found as a weighted average:</p>

<p>

<math display="block" id="Weber_problem:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>j</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mfrac>
        <mrow>
         <msub>
          <mi>w</mi>
          <mi>i</mi>
         </msub>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>y</mi>
           <mi>j</mi>
          </msub>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mfrac>
        <msub>
         <mi>w</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>y</mi>
           <mi>j</mi>
          </msub>
         </mrow>
         <mo>∥</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>j</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-/</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.y_{j+1}=\left(\sum_{i=1}^{n}\frac{w_{i}x_{i}}{\|x_{i}-y_{j}\|}\right)%
\right/\left(\sum_{i=1}^{n}\frac{w_{i}}{\|x_{i}-y_{j}\|}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>For the attraction–repulsion problem one has instead to resort to the algorithm proposed by Chen, Hansen, Jaumard and Tuy (1992).<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="interpretation-of-the-land-rent-theory-in-the-light-of-the-attractionrepulsion-problem">Interpretation of the land rent theory in the light of the attraction–repulsion problem</h2>

<p>In the world of <a href="location_theory" title="wikilink">spatial economics</a>, repulsive forces are omnipresent. Land values are the main illustration of them. In fact a substantial portion of <a href="Bid_rent_theory" title="wikilink">land value theory</a>, both rural and urban, can be summed up in the following way.</p>

<p>In the case where everybody is attracted by a single attraction point (the rural market or the urban central business district), competition between the various bidders who all want to locate at the center will generate land values that will transform the unique attraction point of the system into a repulsion point from the land value point of view, and, at the equilibrium, each inhabitant and activity will be located at the point where the attractive and the repulsive forces exerted by the center on them will cancel out.</p>
<h2 id="the-attractionrepulsion-problem-and-the-new-economic-geography">The attraction–repulsion problem and the New Economic Geography</h2>

<p>The Tellier problem preceded the emergence of the <a href="Economic_geography#New_economic_geography" title="wikilink">New Economic Geography</a>. It is seen by Ottaviano and Thisse (2005)<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> as a prelude to the New Economic Geography (NEG) that developed in the 1990s, and earned <a href="Paul_Krugman" title="wikilink">Paul Krugman</a> a <a href="Nobel_Memorial_Prize" title="wikilink">Nobel Memorial Prize</a> in Economic Sciences in 2008. The concept of attractive force is akin to the NEG concept of agglomeration or centripetal force, and the concept of repulsive force is akin to the NEG concept of dispersal or centrifugal force.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>Chen, Pey-Chun, Hansen, Pierre, Jaumard, Brigitte and Hoang Tuy, 1992, "Weber's Problem with Attraction and Repulsion," Journal of Regional Science 32, 467–486.</li>
</ul>
<ul>
<li>Kuhn, Harold W. and Robert E. Kuenne, 1962, "An Efficient Algorithm for the Numerical Solution of the Generalized Weber Problem in Spatial Economics." Journal of Regional Science 4, 21–34.</li>
</ul>
<ul>
<li>Ottaviano, Gianmarco and Jacques-François Thisse, 2005, « New Economic Geography: what about the N? », Environment and Planning A 37, 1707–1725.</li>
</ul>
<ul>
<li>Simpson, Thomas, 1750, The Doctrine and Application of Fluxions, London.</li>
</ul>
<ul>
<li>Tellier, Luc-Normand and Boris Polanski, 1989, “The Weber Problem: Frequency of Different Solution Types and Extension to Repulsive Forces and Dynamic Processes”, Journal of Regional Science, vol 29, no. 3, p. 387–405.</li>
</ul>
<ul>
<li>Tellier, Luc-Normand, 1972, “The Weber Problem: Solution and Interpretation”, Geographical Analysis, vol. 4, no. 3, pp. 215–233.</li>
</ul>
<ul>
<li>Tellier, Luc-Normand, 1985, Économie spatiale: rationalité économique de l'espace habité, Chicoutimi, Gaëtan Morin éditeur, 280 pages.</li>
</ul>
<ul>
<li>Tellier, Luc-Normand, 2013, « Annexe 1: Solution géométrique du cas triangulaire du problème d’attraction–répulsion », annex of the paper of Pierre Hansen, Christophe Meyer and Luc-Normand Tellier, « Modèles topodynamique et de la Nouvelle économie géographique : compatibilité, convergence et avantages comparés », in Marc-Urbain Proulx (ed.), 2013, Sciences du territoire II : méthodologies, Québec, Presses de l’Université du Québec.</li>
</ul>
<ul>
<li>Weber, Alfred, 1909, Über den Standort der Industrien, Tübingen, J.C.B. Mohr) — English translation: The Theory of the Location of Industries, Chicago, Chicago University Press, 1929, 256 pages.</li>
</ul>
<ul>
<li>Wesolowski, Georges, 1993, «The Weber problem: History and perspective», Location Science, Vol. 1, p. 5–23.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Applied_mathematics" title="wikilink">Category:Applied mathematics</a> <a href="Category:Economic_problems" title="wikilink">Category:Economic problems</a> <a href="Category:Mathematical_optimization" title="wikilink">Category:Mathematical optimization</a> <a href="Category:Regional_science" title="wikilink">Category:Regional science</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Kuhn, Harold W. and Robert E. Kuenne, 1962, "An Efficient Algorithm for the Numerical Solution of the Generalized Weber Problem in Spatial Economics." Journal of Regional Science 4, 21–34.<a href="#fnref1">↩</a></li>
<li id="fn2">Tellier, Luc-Normand, 1972, “The Weber Problem: Solution and Interpretation”, Geographical Analysis, vol. 4, no. 3, pp. 215–233.<a href="#fnref2">↩</a></li>
<li id="fn3">Simpson, Thomas, 1750, The Doctrine and Application of Fluxions, London.<a href="#fnref3">↩</a></li>
<li id="fn4">Weber, Alfred, 1909, Über den Standort der Industrien, Tübingen, J.C.B. Mohr) — English translation: The Theory of the Location of Industries, Chicago, Chicago University Press, 1929, 256 pages.<a href="#fnref4">↩</a></li>
<li id="fn5">Tellier, Luc-Normand, 1985, Économie spatiale: rationalité économique de l'espace habité, Chicoutimi, Gaëtan Morin éditeur, 280 pages.<a href="#fnref5">↩</a></li>
<li id="fn6">Tellier, Luc-Normand, 2013, « Annexe 1 : Solution géométrique du cas triangulaire du problème d’attraction-répulsion », annex of the paper of Pierre Hansen, Christophe Meyer and Luc-Normand Tellier, « Modèles topodynamique et de la Nouvelle économie géographique : compatibilité, convergence et avantages comparés », in Marc-Urbain Proulx (ed.), 2013, Sciences du territoire II : méthodologies, Québec, Presses de l’Université du Québec.<a href="#fnref6">↩</a></li>
<li id="fn7">Tellier, Luc-Normand, 1972, “The Weber Problem: Solution and Interpretation”, Geographical Analysis, vol. 4, no. 3, pp. 215–233.<a href="#fnref7">↩</a></li>
<li id="fn8">Tellier, Luc-Normand, 1985, Économie spatiale: rationalité économique de l'espace habité, Chicoutimi, Gaëtan Morin éditeur, 280 pages.<a href="#fnref8">↩</a></li>
<li id="fn9">Kuhn, Harold W. and Robert E. Kuenne, 1962, "An Efficient Algorithm for the Numerical Solution of the Generalized Weber Problem in Spatial Economics." Journal of Regional Science 4, 21–34.<a href="#fnref9">↩</a></li>
<li id="fn10">Chen, Pey-Chun, Hansen, Pierre, Jaumard, Brigitte and Hoang Tuy, 1992, "Weber's Problem with Attraction and Repulsion," Journal of Regional Science 32, 467–486.<a href="#fnref10">↩</a></li>
<li id="fn11">Ottaviano, Gianmarco and Jacques-François Thisse, 2005, « New Economic Geography: what about the N? », Environment and Planning A 37, 1707–1725.<a href="#fnref11">↩</a></li>
</ol>
</section>
</body>
</html>

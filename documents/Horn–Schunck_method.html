<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="715">Horn–Schunck method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Horn–Schunck method</h1>
<hr/>

<p>The <strong>Horn–Schunck method</strong> of estimating <a href="optical_flow" title="wikilink">optical flow</a> is a global method which introduces a global constraint of <em>smoothness</em> to solve the <em><a href="aperture_problem" title="wikilink">aperture problem</a></em> (see <a href="Optical_Flow" title="wikilink">Optical Flow</a> for further description).</p>
<h2 id="mathematical-details">Mathematical details</h2>

<p>The Horn-Schunck algorithm assumes smoothness in the flow over the whole image. Thus, it tries to minimize distortions in flow and prefers solutions which show more smoothness.</p>

<p>The flow is formulated as a global energy functional which is then sought to be minimized. This function is given for two-dimensional image streams as:</p>

<p>

<math display="block" id="Horn–Schunck_method:0">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∬</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <msub>
            <mi>I</mi>
            <mi>x</mi>
           </msub>
           <mi>u</mi>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>I</mi>
            <mi>y</mi>
           </msub>
           <mi>v</mi>
          </mrow>
          <mo>+</mo>
          <msub>
           <mi>I</mi>
           <mi>t</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>α</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msup>
           <mrow>
            <mo fence="true">∥</mo>
            <mrow>
             <mo>∇</mo>
             <mi>u</mi>
            </mrow>
            <mo fence="true">∥</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mo>+</mo>
          <msup>
           <mrow>
            <mo fence="true">∥</mo>
            <mrow>
             <mo>∇</mo>
             <mi>v</mi>
            </mrow>
            <mo fence="true">∥</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mi mathvariant="normal">d</mi>
     <mi>x</mi>
     <mi mathvariant="normal">d</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <csymbol cd="latexml">double-integral</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>I</ci>
            <ci>x</ci>
           </apply>
           <ci>u</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>I</ci>
            <ci>y</ci>
           </apply>
           <ci>v</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>t</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>α</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <ci>normal-∇</ci>
             <ci>u</ci>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <ci>normal-∇</ci>
             <ci>v</ci>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-d</ci>
      <ci>x</ci>
      <ci>normal-d</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=\iint\left[(I_{x}u+I_{y}v+I_{t})^{2}+\alpha^{2}(\lVert\nabla u\rVert^{2}+%
\lVert\nabla v\rVert^{2})\right]{{\rm d}x{\rm d}y}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Horn–Schunck_method:1">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{x}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Horn–Schunck_method:2">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{y}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Horn–Schunck_method:3">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{t}
  </annotation>
 </semantics>
</math>

 are the derivatives of the image intensity values along the x, y and time dimensions respectively, 

<math display="inline" id="Horn–Schunck_method:4">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>V</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>u</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>v</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>⊤</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <interval closure="closed">
      <apply>
       <times></times>
       <ci>u</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </interval>
     <csymbol cd="latexml">top</csymbol>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{V}=[u(x,y),v(x,y)]^{\top}
  </annotation>
 </semantics>
</math>

 is the optical flow vector, and the parameter 

<math display="inline" id="Horn–Schunck_method:5">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is a regularization constant. Larger values of 

<math display="inline" id="Horn–Schunck_method:6">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 lead to a smoother flow. This functional can be minimized by solving the associated <a href="Euler–Lagrange_equations#Single_function_of_several_variables" title="wikilink">multi-dimensional Euler-Lagrange equations</a>. These are</p>

<p>

<math display="block" id="Horn–Schunck_method:7">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>u</mi>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>u</mi>
        <mi>x</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>y</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>u</mi>
        <mi>y</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial L}{\partial u}-\frac{\partial}{\partial x}\frac{\partial L}{%
\partial u_{x}}-\frac{\partial}{\partial y}\frac{\partial L}{\partial u_{y}}=0
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Horn–Schunck_method:8">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>L</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>v</mi>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>v</mi>
        <mi>x</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>y</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>L</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>v</mi>
        <mi>y</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>L</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>L</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial L}{\partial v}-\frac{\partial}{\partial x}\frac{\partial L}{%
\partial v_{x}}-\frac{\partial}{\partial y}\frac{\partial L}{\partial v_{y}}=0
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Horn–Schunck_method:9">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 is the integrand of the energy expression, giving</p>

<p>

<math display="block" id="Horn–Schunck_method:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>I</mi>
      <mi>x</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>I</mi>
         <mi>x</mi>
        </msub>
        <mi>u</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>I</mi>
         <mi>y</mi>
        </msub>
        <mi>v</mi>
       </mrow>
       <mo>+</mo>
       <msub>
        <mi>I</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>α</mi>
      <mn>2</mn>
     </msup>
     <mi mathvariant="normal">Δ</mi>
     <mi>u</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>x</ci>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>y</ci>
        </apply>
        <ci>v</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-Δ</ci>
      <ci>u</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{x}(I_{x}u+I_{y}v+I_{t})-\alpha^{2}\Delta u=0
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Horn–Schunck_method:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>I</mi>
      <mi>y</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>I</mi>
         <mi>x</mi>
        </msub>
        <mi>u</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>I</mi>
         <mi>y</mi>
        </msub>
        <mi>v</mi>
       </mrow>
       <mo>+</mo>
       <msub>
        <mi>I</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>α</mi>
      <mn>2</mn>
     </msup>
     <mi mathvariant="normal">Δ</mi>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>x</ci>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>y</ci>
        </apply>
        <ci>v</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-Δ</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{y}(I_{x}u+I_{y}v+I_{t})-\alpha^{2}\Delta v=0
  </annotation>
 </semantics>
</math>

</p>

<p>where subscripts again denote partial differentiation and 

<math display="inline" id="Horn–Schunck_method:12">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mo>∂</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>∂</mo>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <msup>
      <mo>∂</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>∂</mo>
      <msup>
       <mi>y</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Δ</ci>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <partialdiff></partialdiff>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <partialdiff></partialdiff>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta=\frac{\partial^{2}}{\partial x^{2}}+\frac{\partial^{2}}{\partial y^{2}}
  </annotation>
 </semantics>
</math>

 denotes the <a href="Laplace_operator" title="wikilink">Laplace operator</a>. In practice the Laplacian is approximated numerically using finite differences, and may be written 

<math display="inline" id="Horn–Schunck_method:13">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>u</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>u</mi>
      <mo>¯</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>u</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>u</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-¯</ci>
       <ci>u</ci>
      </apply>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>u</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta u(x,y)=\overline{u}(x,y)-u(x,y)
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Horn–Schunck_method:14">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>u</mi>
    <mo>¯</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-¯</ci>
     <ci>u</ci>
    </apply>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{u}(x,y)
  </annotation>
 </semantics>
</math>

 is a weighted average of 

<math display="inline" id="Horn–Schunck_method:15">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 calculated in a neighborhood around the pixel at location (x,y). Using this notation the above equation system may be written</p>

<p>

<math display="block" id="Horn–Schunck_method:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msubsup>
        <mi>I</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msup>
        <mi>α</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>u</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>I</mi>
      <mi>x</mi>
     </msub>
     <msub>
      <mi>I</mi>
      <mi>y</mi>
     </msub>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>α</mi>
      <mn>2</mn>
     </msup>
     <mover accent="true">
      <mi>u</mi>
      <mo>¯</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>I</mi>
      <mi>x</mi>
     </msub>
     <msub>
      <mi>I</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>y</ci>
      </apply>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (I_{x}^{2}+\alpha^{2})u+I_{x}I_{y}v=\alpha^{2}\overline{u}-I_{x}I_{t}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Horn–Schunck_method:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>I</mi>
      <mi>x</mi>
     </msub>
     <msub>
      <mi>I</mi>
      <mi>y</mi>
     </msub>
     <mi>u</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msubsup>
        <mi>I</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msup>
        <mi>α</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>α</mi>
      <mn>2</mn>
     </msup>
     <mover accent="true">
      <mi>v</mi>
      <mo>¯</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>I</mi>
      <mi>y</mi>
     </msub>
     <msub>
      <mi>I</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>y</ci>
      </apply>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{x}I_{y}u+(I_{y}^{2}+\alpha^{2})v=\alpha^{2}\overline{v}-I_{y}I_{t}
  </annotation>
 </semantics>
</math>

</p>

<p>which is linear in 

<math display="inline" id="Horn–Schunck_method:18">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Horn–Schunck_method:19">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 and may be solved for each pixel in the image. However, since the solution depends on the neighboring values of the flow field, it must be repeated once the neighbors have been updated. The following iterative scheme is derived:</p>

<p>

<math display="block" id="Horn–Schunck_method:20">
 <semantics>
  <mrow>
   <msup>
    <mi>u</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mover accent="true">
      <mi>u</mi>
      <mo>¯</mo>
     </mover>
     <mi>k</mi>
    </msup>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>I</mi>
       <mi>x</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>I</mi>
          <mi>x</mi>
         </msub>
         <msup>
          <mover accent="true">
           <mi>u</mi>
           <mo>¯</mo>
          </mover>
          <mi>k</mi>
         </msup>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>I</mi>
          <mi>y</mi>
         </msub>
         <msup>
          <mover accent="true">
           <mi>v</mi>
           <mo>¯</mo>
          </mover>
          <mi>k</mi>
         </msup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>I</mi>
         <mi>t</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msup>
       <mi>α</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msubsup>
       <mi>I</mi>
       <mi>x</mi>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>I</mi>
       <mi>y</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>u</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>u</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-¯</ci>
           <ci>u</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>y</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-¯</ci>
           <ci>v</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{k+1}=\overline{u}^{k}-\frac{I_{x}(I_{x}\overline{u}^{k}+I_{y}\overline{v}^{%
k}+I_{t})}{\alpha^{2}+I_{x}^{2}+I_{y}^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Horn–Schunck_method:21">
 <semantics>
  <mrow>
   <msup>
    <mi>v</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mover accent="true">
      <mi>v</mi>
      <mo>¯</mo>
     </mover>
     <mi>k</mi>
    </msup>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>I</mi>
       <mi>y</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>I</mi>
          <mi>x</mi>
         </msub>
         <msup>
          <mover accent="true">
           <mi>u</mi>
           <mo>¯</mo>
          </mover>
          <mi>k</mi>
         </msup>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>I</mi>
          <mi>y</mi>
         </msub>
         <msup>
          <mover accent="true">
           <mi>v</mi>
           <mo>¯</mo>
          </mover>
          <mi>k</mi>
         </msup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>I</mi>
         <mi>t</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msup>
       <mi>α</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msubsup>
       <mi>I</mi>
       <mi>x</mi>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>I</mi>
       <mi>y</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>v</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>v</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-¯</ci>
           <ci>u</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>y</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-¯</ci>
           <ci>v</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v^{k+1}=\overline{v}^{k}-\frac{I_{y}(I_{x}\overline{u}^{k}+I_{y}\overline{v}^{%
k}+I_{t})}{\alpha^{2}+I_{x}^{2}+I_{y}^{2}}
  </annotation>
 </semantics>
</math>

 where the superscript <em>k+1</em> denotes the next iteration, which is to be calculated and <em>k</em> is the last calculated result. This is in essence the <a href="Jacobi_method" title="wikilink">Jacobi method</a> applied to the large, sparse system arising when solving for all pixels simultaneously.</p>
<h2 id="properties">Properties</h2>

<p>Advantages of the Horn–Schunck algorithm include that it yields a high density of flow vectors, i.e. the flow information missing in inner parts of homogeneous objects is <em>filled in</em> from the motion boundaries. On the negative side, it is more sensitive to noise than local methods.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Lucas–Kanade_method" title="wikilink">Lucas–Kanade method</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>B.K.P. Horn and B.G. Schunck, "Determining optical flow." <em>Artificial Intelligence</em>, vol 17, pp 185–203, 1981. <a href="http://dspace.mit.edu/handle/1721.1/6337">Manuscript</a> available on MIT server.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://docs.opencv.org/modules/video/doc/motion_analysis_and_object_tracking.html">OpenCV implementation</a></li>
</ul>

<p>"</p>

<p><a href="Category:Motion_in_computer_vision" title="wikilink">Category:Motion in computer vision</a></p>
</body>
</html>

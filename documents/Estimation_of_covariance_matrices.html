<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1237">Estimation of covariance matrices</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Estimation of covariance matrices</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, sometimes the <a href="covariance_matrix" title="wikilink">covariance matrix</a> of a <a href="multivariate_random_variable" title="wikilink">multivariate random variable</a> is not known but has to be <a href="estimation_theory" title="wikilink">estimated</a>. <strong>Estimation of covariance matrices</strong> then deals with the question of how to approximate the actual covariance matrix on the basis of a sample from the <a href="Joint_probability_distribution" title="wikilink">multivariate distribution</a>. Simple cases, where observations are complete, can be dealt with by using the <a href="sample_covariance_matrix" title="wikilink">sample covariance matrix</a>. The sample covariance matrix (SCM) is an <a href="unbiased_estimator" title="wikilink">unbiased</a> and <a href="Efficiency_(statistics)" title="wikilink">efficient estimator</a> of the covariance matrix if the space of covariance matrices is viewed as an <a href="Differential_geometry#Intrinsic_versus_extrinsic" title="wikilink">extrinsic</a> <a href="convex_cone" title="wikilink">convex cone</a> in <strong>R</strong><sup><em>p</em>√ó<em>p</em></sup>; however, measured using the <a href="Symmetric_space" title="wikilink">intrinsic geometry</a> of <a href="Positive-definite_matrix" title="wikilink">positive-definite matrices</a>, the SCM is a <a href="Biased_estimator" title="wikilink">biased</a> and inefficient estimator.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In addition, if the random variable has <a href="normal_distribution" title="wikilink">normal distribution</a>, the sample covariance matrix has <a href="Wishart_distribution" title="wikilink">Wishart distribution</a> and a slightly differently scaled version of it is the <a href="maximum_likelihood_estimate" title="wikilink">maximum likelihood estimate</a>. Cases involving <a href="missing_data" title="wikilink">missing data</a> require deeper considerations. Another issue is the <a href="robust_statistics" title="wikilink">robustness</a> to <a href="outlier" title="wikilink">outliers</a>:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> "Sample covariance matrices are extremely sensitive to outliers".<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Statistical analyses of multivariate data often involve exploratory studies of the way in which the variables change in relation to one another and this may be followed up by explicit statistical models involving the covariance matrix of the variables. Thus the estimation of covariance matrices directly from observational data plays two roles:</p>

<p>:* to provide initial estimates that can be used to study the inter-relationships;</p>

<p>:* to provide sample estimates that can be used for model checking.</p>

<p>Estimates of covariance matrices are required at the initial stages of <a href="principal_component_analysis" title="wikilink">principal component analysis</a> and <a href="factor_analysis" title="wikilink">factor analysis</a>, and are also involved in versions of <a href="regression_analysis" title="wikilink">regression analysis</a> that treat the <a href="dependent_variable" title="wikilink">dependent variables</a> in a data-set, jointly with the <a href="independent_variable" title="wikilink">independent variable</a> as the outcome of a random sample.</p>
<h2 id="estimation-in-a-general-context">Estimation in a general context</h2>

<p>Given a <a href="Sample_(statistics)" title="wikilink">sample</a> consisting of <em>n</em> independent observations <em>x</em><sub>1</sub>,..., <em>x</em><sub><em>n</em></sub> of a <em>p</em>-dimensional <a href="random_vector" title="wikilink">random vector</a> <em>X</em> ‚àà <strong>R</strong><sup><em>p</em>√ó1</sup> (a <em>p</em>√ó1 column-vector), an <a href="Bias_of_an_estimator" title="wikilink">unbiased</a> <a class="uri" href="estimator" title="wikilink">estimator</a> of the (<em>p</em>√ó<em>p</em>) <a href="covariance_matrix" title="wikilink">covariance matrix</a></p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:0">
 <semantics>
  <mrow>
   <mrow>
    <mo>cov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>X</mi>
        <mo>-</mo>
        <mrow>
         <mo>E</mo>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>X</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <mrow>
          <mo>E</mo>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>X</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>cov</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>X</ci>
       <apply>
        <ci>normal-E</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>X</ci>
        <apply>
         <ci>normal-E</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(X)=\operatorname{E}\left[\left(X-\operatorname{E}[X])(X-%
\operatorname{E}[X]\right)^{\mathrm{T}}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>is the <a href="Sample_mean_and_covariance" title="wikilink">sample covariance matrix</a></p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùêê</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo>¬Ø</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo>¬Ø</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">T</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêê</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}={1\over{n-1}}\sum_{i=1}^{n}(x_{i}-\overline{x})(x_{i}-\overline{x})%
^{\mathrm{T}},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Estimation_of_covariance_matrices:2">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle x_{i}
  </annotation>
 </semantics>
</math>

 is the <em>i</em>-th observation of the <em>p</em>-dimensional random vector, and</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>¬Ø</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¬Ø</mo>
        </mover>
        <mn>1</mn>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi mathvariant="normal">‚ãÆ</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¬Ø</mo>
        </mover>
        <mi>p</mi>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¬Ø</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-‚ãÆ</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
         <ci>p</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{x}=\left[\begin{array}[c]{c}\bar{x}_{1}\\
\vdots\\
\bar{x}_{p}\end{array}\right]={1\over{n}}\sum_{i=1}^{n}x_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>is the <a href="Sample_mean_and_covariance" title="wikilink">sample mean</a>. This is true regardless of the distribution of the random variable <em>X</em>, provided of course that the theoretical means and covariances exist. The reason for the factor <em>n</em>¬†‚àí¬†1 rather than <em>n</em> is essentially the same as the reason for the same factor appearing in unbiased estimates of <a href="Variance#Population_variance_and_sample_variance" title="wikilink">sample variances</a> and <a href="Sample_mean_and_sample_covariance" title="wikilink">sample covariances</a>, which relates to the fact that the mean is not known and is replaced by the sample mean.</p>

<p>In cases where the distribution of the <a href="random_variable" title="wikilink">random variable</a> <em>X</em> is known to be within a certain family of distributions, other estimates may be derived on the basis of that assumption. A well-known instance is when the <a href="random_variable" title="wikilink">random variable</a> <em>X</em> is <a href="multivariate_normal_distribution" title="wikilink">normally distributed</a>: in this case the <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> <a class="uri" href="estimator" title="wikilink">estimator</a> of the covariance matrix is slightly different from the unbiased estimate, and is given by</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùêê</mi>
     <mi>ùêß</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo>¬Ø</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo>¬Ø</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">T</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêê</ci>
     <ci>ùêß</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q_{n}}={1\over n}\sum_{i=1}^{n}(x_{i}-\overline{x})(x_{i}-\overline{x}%
)^{\mathrm{T}}.
  </annotation>
 </semantics>
</math>

</p>

<p>A derivation of this result is given below. Clearly, the difference between the unbiased estimator and the maximum likelihood estimator diminishes for large <em>n</em>.</p>

<p>In the general case, the unbiased estimate of the covariance matrix provides an acceptable estimate when the data vectors in the observed data set are all complete: that is they contain no <a href="missing_values" title="wikilink">missing elements</a>. One approach to estimating the covariance matrix is to treat the estimation of each variance or pairwise covariance separately, and to use all the observations for which both variables have valid values. Assuming the missing data are <a href="missing_at_random" title="wikilink">missing at random</a> this results in an estimate for the covariance matrix which is unbiased. However, for many applications this estimate may not be acceptable because the estimated covariance matrix is not guaranteed to be positive semi-definite. This could lead to estimated correlations having absolute values which are greater than one, and/or a non-invertible covariance matrix.</p>

<p>When estimating the <a class="uri" href="cross-covariance" title="wikilink">cross-covariance</a> of a pair of signals that are <a href="wide-sense_stationary" title="wikilink">wide-sense stationary</a>, missing samples do <em>not</em> need be random (e.g., sub-sampling by an arbitrary factor is valid).</p>
<h2 id="maximum-likelihood-estimation-for-the-multivariate-normal-distribution">Maximum-likelihood estimation for the multivariate normal distribution</h2>

<p>A random vector <em>X</em> ‚àà <strong>R</strong><sup><em>p</em></sup> (a <em>p</em>√ó1 "column vector") has a multivariate normal distribution with a nonsingular covariance matrix Œ£ precisely if Œ£ ‚àà <strong>R</strong><sup><em>p</em> √ó <em>p</em></sup> is a <a href="positive-definite_matrix" title="wikilink">positive-definite matrix</a> and the <a href="probability_density_function" title="wikilink">probability density function</a> of <em>X</em> is</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>œÄ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>p</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
    </mpadded>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">Œ£</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>x</mi>
             <mo>-</mo>
             <mi>Œº</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi mathvariant="normal">T</mi>
          </msup>
          <msup>
           <mi mathvariant="normal">Œ£</mi>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>x</mi>
            <mo>-</mo>
            <mi>Œº</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>œÄ</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <determinant></determinant>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Œ£</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <minus></minus>
            <ci>x</ci>
            <ci>Œº</ci>
           </apply>
           <ci>normal-T</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>normal-Œ£</ci>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <ci>x</ci>
           <ci>Œº</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=(2\pi)^{-p/2}\,\det(\Sigma)^{-1/2}\exp\left(-{1\over 2}(x-\mu)^{\mathrm{T%
}}\Sigma^{-1}(x-\mu)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>Œº</em> ‚àà <strong>R</strong><sup><em>p</em>√ó1</sup> is the <a href="expected_value" title="wikilink">expected value</a> of <em>X</em>. The <a href="covariance_matrix" title="wikilink">covariance matrix</a> <em>Œ£</em> is the multidimensional analog of what in one dimension would be the <a class="uri" href="variance" title="wikilink">variance</a>, and 

<math display="inline" id="Estimation_of_covariance_matrices:6">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>2</mn>
      <mi>œÄ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>p</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msup>
   <mrow>
    <mo>det</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Œ£</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>œÄ</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <determinant></determinant>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Œ£</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2\pi)^{-p/2}\det(\Sigma)^{-1/2}
  </annotation>
 </semantics>
</math>

 normalizes the density 

<math display="inline" id="Estimation_of_covariance_matrices:7">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 so that it integrates to 1.</p>

<p>Suppose now that <em>X</em><sub>1</sub>, ..., <em>X</em><sub><em>n</em></sub> are <a href="statistical_independence" title="wikilink">independent</a> and identically distributed samples from the distribution above. Based on the <a href="observed_value" title="wikilink">observed values</a> <em>x</em><sub>1</sub>, ..., <em>x</em><sub><em>n</em></sub> of this <a href="Sample_(statistics)#Mathematical_description" title="wikilink">sample</a>, we wish to estimate Œ£.</p>
<h3 id="first-steps">First steps</h3>

<p>The likelihood function is:</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:8">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Œº</mi>
     <mo>,</mo>
     <mi mathvariant="normal">Œ£</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>œÄ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mrow>
         <mi>n</mi>
         <mi>p</mi>
        </mrow>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
    </mpadded>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mo movablelimits="false">det</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi mathvariant="normal">Œ£</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </msup>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
           <msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>x</mi>
               <mi>i</mi>
              </msub>
              <mo>-</mo>
              <mi>Œº</mi>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi mathvariant="normal">T</mi>
           </msup>
           <msup>
            <mi mathvariant="normal">Œ£</mi>
            <mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>x</mi>
              <mi>i</mi>
             </msub>
             <mo>-</mo>
             <mi>Œº</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>‚Ñí</ci>
     <interval closure="open">
      <ci>Œº</ci>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>œÄ</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>p</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <determinant></determinant>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Œ£</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <exp></exp>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
             <ci>Œº</ci>
            </apply>
            <ci>normal-T</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>normal-Œ£</ci>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>i</ci>
            </apply>
            <ci>Œº</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(\mu,\Sigma)=(2\pi)^{-np/2}\,\prod_{i=1}^{n}\det(\Sigma)^{-1/2}\exp%
\left(-{1\over 2}(x_{i}-\mu)^{\mathrm{T}}\Sigma^{-1}(x_{i}-\mu)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>It is fairly readily shown that the <a href="maximum_likelihood" title="wikilink">maximum-likelihood</a> estimate of the mean vector <em>Œº</em> is the "<a href="sample_mean" title="wikilink">sample mean</a>" vector:</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:9">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo>¬Ø</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <mi mathvariant="normal">‚ãØ</mi>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>/</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¬Ø</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{x}=(x_{1}+\cdots+x_{n})/n.
  </annotation>
 </semantics>
</math>

</p>

<p>See <a href="normal_distribution#Estimation_of_parameters" title="wikilink">the section on estimation in the article on the normal distribution</a> for details; the process here is similar.</p>

<p>Since the estimate 

<math display="inline" id="Estimation_of_covariance_matrices:10">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">¬Ø</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¬Ø</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}
  </annotation>
 </semantics>
</math>

 does not depend on Œ£, we can just substitute it for <em>Œº</em> in the <a href="likelihood_function" title="wikilink">likelihood function</a>, getting</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo>¬Ø</mo>
      </mover>
      <mo>,</mo>
      <mi mathvariant="normal">Œ£</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>‚àù</mo>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">Œ£</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>n</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>n</mi>
           </munderover>
           <mrow>
            <msup>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>x</mi>
                <mi>i</mi>
               </msub>
               <mo>-</mo>
               <mover accent="true">
                <mi>x</mi>
                <mo>¬Ø</mo>
               </mover>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
             <mi mathvariant="normal">T</mi>
            </msup>
            <msup>
             <mi mathvariant="normal">Œ£</mi>
             <mrow>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
            </msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>x</mi>
               <mi>i</mi>
              </msub>
              <mo>-</mo>
              <mover accent="true">
               <mi>x</mi>
               <mo>¬Ø</mo>
              </mover>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <times></times>
     <ci>‚Ñí</ci>
     <interval closure="open">
      <apply>
       <ci>normal-¬Ø</ci>
       <ci>x</ci>
      </apply>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <apply>
     <determinant></determinant>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Œ£</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
             <apply>
              <ci>normal-¬Ø</ci>
              <ci>x</ci>
             </apply>
            </apply>
            <ci>normal-T</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>normal-Œ£</ci>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>i</ci>
            </apply>
            <apply>
             <ci>normal-¬Ø</ci>
             <ci>x</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(\overline{x},\Sigma)\propto\det(\Sigma)^{-n/2}\exp\left(-{1\over 2%
}\sum_{i=1}^{n}(x_{i}-\overline{x})^{\mathrm{T}}\Sigma^{-1}(x_{i}-\overline{x}%
)\right),
  </annotation>
 </semantics>
</math>

</p>

<p>and then seek the value of Œ£ that maximizes the likelihood of the data (in practice it is easier to work with log¬†

<math display="inline" id="Estimation_of_covariance_matrices:12">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñí</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}
  </annotation>
 </semantics>
</math>

).</p>
<h3 id="the-trace-of-a-1-1-matrix">The trace of a 1 √ó 1 matrix</h3>

<p>Now we come to the first surprising step: regard the <a href="scalar_(mathematics)" title="wikilink">scalar</a> 

<math display="inline" id="Estimation_of_covariance_matrices:13">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo>¬Ø</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
   <msup>
    <mi mathvariant="normal">Œ£</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>-</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo>¬Ø</mo>
     </mover>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-¬Ø</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>normal-T</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-Œ£</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <ci>normal-¬Ø</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{i}-\overline{x})^{\mathrm{T}}\Sigma^{-1}(x_{i}-\overline{x})
  </annotation>
 </semantics>
</math>

 as the <a href="trace_(matrix)" title="wikilink">trace</a> of a 1√ó1 matrix.</p>

<p>This makes it possible to use the identity tr(<em>AB</em>) = tr(<em>BA</em>) whenever <em>A</em> and <em>B</em> are matrices so shaped that both products exist. We get</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:14">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>x</mi>
      <mo>¬Ø</mo>
     </mover>
     <mo>,</mo>
     <mi mathvariant="normal">Œ£</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>‚àù</mo>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">Œ£</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </munderover>
          <mrow>
           <mo>tr</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msup>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <msub>
                 <mi>x</mi>
                 <mi>i</mi>
                </msub>
                <mo>-</mo>
                <mover accent="true">
                 <mi>x</mi>
                 <mo>¬Ø</mo>
                </mover>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
              <mi mathvariant="normal">T</mi>
             </msup>
             <msup>
              <mi mathvariant="normal">Œ£</mi>
              <mrow>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msup>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>x</mi>
                <mi>i</mi>
               </msub>
               <mo>-</mo>
               <mover accent="true">
                <mi>x</mi>
                <mo>¬Ø</mo>
               </mover>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <times></times>
     <ci>‚Ñí</ci>
     <interval closure="open">
      <apply>
       <ci>normal-¬Ø</ci>
       <ci>x</ci>
      </apply>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <apply>
     <determinant></determinant>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Œ£</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <ci>tr</ci>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>x</ci>
               <ci>i</ci>
              </apply>
              <apply>
               <ci>normal-¬Ø</ci>
               <ci>x</ci>
              </apply>
             </apply>
             <ci>normal-T</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>normal-Œ£</ci>
             <apply>
              <minus></minus>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
             <apply>
              <ci>normal-¬Ø</ci>
              <ci>x</ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(\overline{x},\Sigma)\propto\det(\Sigma)^{-n/2}\exp\left(-{1\over 2%
}\sum_{i=1}^{n}\operatorname{tr}((x_{i}-\overline{x})^{\mathrm{T}}\Sigma^{-1}(%
x_{i}-\overline{x}))\right)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:15">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">Œ£</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </munderover>
          <mrow>
           <mo>tr</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>x</mi>
                <mi>i</mi>
               </msub>
               <mo>-</mo>
               <mover accent="true">
                <mi>x</mi>
                <mo>¬Ø</mo>
               </mover>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
             <msup>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <msub>
                 <mi>x</mi>
                 <mi>i</mi>
                </msub>
                <mo>-</mo>
                <mover accent="true">
                 <mi>x</mi>
                 <mo>¬Ø</mo>
                </mover>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
              <mi mathvariant="normal">T</mi>
             </msup>
             <msup>
              <mi mathvariant="normal">Œ£</mi>
              <mrow>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msup>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <determinant></determinant>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Œ£</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <ci>tr</ci>
           <apply>
            <times></times>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
             <apply>
              <ci>normal-¬Ø</ci>
              <ci>x</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>x</ci>
               <ci>i</ci>
              </apply>
              <apply>
               <ci>normal-¬Ø</ci>
               <ci>x</ci>
              </apply>
             </apply>
             <ci>normal-T</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>normal-Œ£</ci>
             <apply>
              <minus></minus>
              <cn type="integer">1</cn>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\det(\Sigma)^{-n/2}\exp\left(-{1\over 2}\sum_{i=1}^{n}\operatorname{tr}((x_{i%
}-\overline{x})(x_{i}-\overline{x})^{\mathrm{T}}\Sigma^{-1})\right)
  </annotation>
 </semantics>
</math>

</p>

<p>(so now we are taking the trace of a <em>p</em>√ó<em>p</em> matrix)</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:16">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">Œ£</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <mo>tr</mo>
          <mrow>
           <mo>(</mo>
           <mrow>
            <munderover>
             <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
             <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
             </mrow>
             <mi>n</mi>
            </munderover>
            <mrow>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>x</mi>
                <mi>i</mi>
               </msub>
               <mo>-</mo>
               <mover accent="true">
                <mi>x</mi>
                <mo>¬Ø</mo>
               </mover>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
             <msup>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <msub>
                 <mi>x</mi>
                 <mi>i</mi>
                </msub>
                <mo>-</mo>
                <mover accent="true">
                 <mi>x</mi>
                 <mo>¬Ø</mo>
                </mover>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
              <mi mathvariant="normal">T</mi>
             </msup>
             <msup>
              <mi mathvariant="normal">Œ£</mi>
              <mrow>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msup>
            </mrow>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <determinant></determinant>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Œ£</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <ci>tr</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>i</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <ci>n</ci>
           </apply>
           <apply>
            <times></times>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
             <apply>
              <ci>normal-¬Ø</ci>
              <ci>x</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>x</ci>
               <ci>i</ci>
              </apply>
              <apply>
               <ci>normal-¬Ø</ci>
               <ci>x</ci>
              </apply>
             </apply>
             <ci>normal-T</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>normal-Œ£</ci>
             <apply>
              <minus></minus>
              <cn type="integer">1</cn>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\det(\Sigma)^{-n/2}\exp\left(-{1\over 2}\operatorname{tr}\left(\sum_{i=1}^{n}%
(x_{i}-\overline{x})(x_{i}-\overline{x})^{\mathrm{T}}\Sigma^{-1}\right)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:17">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">Œ£</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <mo>tr</mo>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mi>S</mi>
            <msup>
             <mi mathvariant="normal">Œ£</mi>
             <mrow>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
            </msup>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <determinant></determinant>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Œ£</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <ci>tr</ci>
          <apply>
           <times></times>
           <ci>S</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>normal-Œ£</ci>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\det(\Sigma)^{-n/2}\exp\left(-{1\over 2}\operatorname{tr}\left(S\Sigma^{-1}%
\right)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>x</mi>
         <mo>¬Ø</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo>¬Ø</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
    </mrow>
    <mo>‚àà</mo>
    <msup>
     <mi>ùêë</mi>
     <mrow>
      <mi>p</mi>
      <mo>√ó</mo>
      <mi>p</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêë</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\sum_{i=1}^{n}(x_{i}-\overline{x})(x_{i}-\overline{x})^{\mathrm{T}}\in%
\mathbf{R}^{p\times p}.
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Estimation_of_covariance_matrices:19">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 is sometimes called the <a href="scatter_matrix" title="wikilink">scatter matrix</a>, and is positive definite if there exists a subset of the data consisting of 

<math display="inline" id="Estimation_of_covariance_matrices:20">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 linearly independent observations (which we will assume).</p>
<h3 id="using-the-spectral-theorem">Using the spectral theorem</h3>

<p>It follows from the <a href="spectral_theorem" title="wikilink">spectral theorem</a> of <a href="linear_algebra" title="wikilink">linear algebra</a> that a positive-definite symmetric matrix <em>S</em> has a unique positive-definite symmetric square root <em>S</em><sup>1/2</sup>. We can again use the <a href="trace_(matrix)" title="wikilink">"cyclic property"</a> of the trace to write</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:21">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">Œ£</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <mo>tr</mo>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msup>
             <mi>S</mi>
             <mrow>
              <mn>1</mn>
              <mo>/</mo>
              <mn>2</mn>
             </mrow>
            </msup>
            <msup>
             <mi mathvariant="normal">Œ£</mi>
             <mrow>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
            </msup>
            <msup>
             <mi>S</mi>
             <mrow>
              <mn>1</mn>
              <mo>/</mo>
              <mn>2</mn>
             </mrow>
            </msup>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <determinant></determinant>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Œ£</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <ci>tr</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>S</ci>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>normal-Œ£</ci>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>S</ci>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(\Sigma)^{-n/2}\exp\left(-{1\over 2}\operatorname{tr}\left(S^{1/2}\Sigma^{%
-1}S^{1/2}\right)\right).
  </annotation>
 </semantics>
</math>

</p>

<p>Let <em>B</em> = <em>S</em><sup>1/2</sup> <em>Œ£</em><sup>‚àí1</sup> <em>S</em><sup>1/2</sup>. Then the expression above becomes</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:22">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>S</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mo movablelimits="false">det</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>B</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>n</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </msup>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
           <mrow>
            <mo>tr</mo>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>B</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <determinant></determinant>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>S</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <determinant></determinant>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <apply>
         <divide></divide>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <ci>tr</ci>
           <ci>B</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(S)^{-n/2}\det(B)^{n/2}\exp\left(-{1\over 2}\operatorname{tr}(B)\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The positive-definite matrix <em>B</em> can be diagonalized, and then the problem of finding the value of <em>B</em> that maximizes</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:23">
 <semantics>
  <mrow>
   <mo movablelimits="false">det</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>B</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mrow>
         <mo>tr</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>B</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <determinant></determinant>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <ci>tr</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(B)^{n/2}\exp\left(-{1\over 2}\operatorname{tr}(B)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Since the trace of a square matrix equals the sum of eigen-values (<a href="Trace_(matrix)#Eigenvalue_relationships" title="wikilink">"trace and eigenvalues"</a>), the equation reduces to the problem of finding the eigen values Œª<sub>1</sub>, ..., Œª<sub><em>p</em></sub> that maximize</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:24">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>Œª</mi>
     <mi>i</mi>
     <mrow>
      <mi>n</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>Œª</mi>
         <mi>i</mi>
        </msub>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œª</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œª</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}^{n/2}\exp(-\lambda_{i}/2).
  </annotation>
 </semantics>
</math>

</p>

<p>This is just a calculus problem and we get Œª<sub><em>i</em></sub> = <em>n</em> for all <em>i.</em> Thus, assume <em>Q</em> is the matrix of eigen vectors, then</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:25">
 <semantics>
  <mrow>
   <mi>B</mi>
   <mo>=</mo>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <msub>
       <mi>I</mi>
       <mi>p</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>Q</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <msub>
     <mi>I</mi>
     <mi>p</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>B</ci>
     <apply>
      <times></times>
      <ci>Q</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Q</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=Q(nI_{p})Q^{-1}=nI_{p}
  </annotation>
 </semantics>
</math>

</p>

<p>i.e., <em>n</em> times the <em>p</em>√ó<em>p</em> identity matrix.</p>
<h3 id="concluding-steps">Concluding steps</h3>

<p>Finally we get</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:26">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œ£</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>S</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mi>B</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>S</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>S</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mi>n</mi>
       </mfrac>
       <msub>
        <mi>I</mi>
        <mi>p</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msup>
      <mi>S</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mi>S</mi>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>normal-Œ£</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <ci>S</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma=S^{1/2}B^{-1}S^{1/2}=S^{1/2}\left(\frac{1}{n}I_{p}\right)S^{1/2}=\frac{%
S}{n},
  </annotation>
 </semantics>
</math>

</p>

<p>i.e., the <em>p</em>√ó<em>p</em> "sample covariance matrix"</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:27">
 <semantics>
  <mrow>
   <mfrac>
    <mi>S</mi>
    <mi>n</mi>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>X</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>X</mi>
         <mo>¬Ø</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>X</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>X</mi>
          <mo>¬Ø</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <ci>S</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {S\over n}={1\over n}\sum_{i=1}^{n}(X_{i}-\overline{X})(X_{i}-\overline{X})^{%
\mathrm{T}}
  </annotation>
 </semantics>
</math>

</p>

<p>is the maximum-likelihood estimator of the "population covariance matrix" <em>Œ£</em>. At this point we are using a capital <em>X</em> rather than a lower-case <em>x</em> because we are thinking of it "as an estimator rather than as an estimate", i.e., as something random whose probability distribution we could profit by knowing. The random matrix <em>S</em> can be shown to have a <a href="Wishart_distribution" title="wikilink">Wishart distribution</a> with <em>n</em> ‚àí 1 degrees of freedom.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> That is:</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>X</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>X</mi>
         <mo>¬Ø</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>X</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>X</mi>
          <mo>¬Ø</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
    </mrow>
    <mo>‚àº</mo>
    <mrow>
     <msub>
      <mi>W</mi>
      <mi>p</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Œ£</mi>
      <mo>,</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <ci>normal-¬Ø</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>p</ci>
     </apply>
     <interval closure="open">
      <ci>normal-Œ£</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}(X_{i}-\overline{X})(X_{i}-\overline{X})^{\mathrm{T}}\sim W_{p}(%
\Sigma,n-1).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="alternative-derivation">Alternative derivation</h3>

<p>An alternative derivation of the maximum likelihood estimator can be performed via <a href="matrix_calculus" title="wikilink">matrix calculus</a> formulae (see also <a href="Determinant#Derivative" title="wikilink">differential of a determinant</a> and <a href="Invertible_matrix#Derivative_of_the_matrix_inverse" title="wikilink">differential of the inverse matrix</a>). It also verifies the aforementioned fact about the maximum likelihood estimate of the mean. Re-write the likelihood in the log form using the trace trick:</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>ln</mi>
      <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Œº</mi>
      <mo>,</mo>
      <mi mathvariant="normal">Œ£</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>const</mo>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mi>n</mi>
       <mn>2</mn>
      </mfrac>
      <mi>ln</mi>
      <mrow>
       <mo movablelimits="false">det</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">Œ£</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo>tr</mo>
       <mrow>
        <mo>[</mo>
        <mrow>
         <msup>
          <mi mathvariant="normal">Œ£</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </munderover>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>x</mi>
              <mi>i</mi>
             </msub>
             <mo>-</mo>
             <mi>Œº</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>x</mi>
               <mi>i</mi>
              </msub>
              <mo>-</mo>
              <mi>Œº</mi>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi mathvariant="normal">T</mi>
           </msup>
          </mrow>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ln></ln>
      <ci>‚Ñí</ci>
     </apply>
     <interval closure="open">
      <ci>Œº</ci>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <ci>const</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <ln></ln>
      <apply>
       <determinant></determinant>
       <ci>normal-Œ£</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>tr</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Œ£</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>i</ci>
           </apply>
           <ci>Œº</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>i</ci>
            </apply>
            <ci>Œº</ci>
           </apply>
           <ci>normal-T</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln\mathcal{L}(\mu,\Sigma)=\operatorname{const}-{n\over 2}\ln\det(\Sigma)-{1%
\over 2}\operatorname{tr}\left[\Sigma^{-1}\sum_{i=1}^{n}(x_{i}-\mu)(x_{i}-\mu)%
^{\mathrm{T}}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>The differential of this log-likelihood is</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mi>ln</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Œº</mi>
     <mo>,</mo>
     <mi mathvariant="normal">Œ£</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>n</mi>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo>[</mo>
       <mrow>
        <msup>
         <mi mathvariant="normal">Œ£</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mo>{</mo>
         <mrow>
          <mi>d</mi>
          <mi mathvariant="normal">Œ£</mi>
         </mrow>
         <mo>}</mo>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <ln></ln>
      <ci>‚Ñí</ci>
     </apply>
     <interval closure="open">
      <ci>Œº</ci>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>tr</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Œ£</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <set>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>normal-Œ£</ci>
         </apply>
        </set>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\ln\mathcal{L}(\mu,\Sigma)=-{n\over 2}\operatorname{tr}\left[\Sigma^{-1}\left%
\{d\Sigma\right\}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:31">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mrow>
          <msup>
           <mi mathvariant="normal">Œ£</mi>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mrow>
           <mo stretchy="false">{</mo>
           <mrow>
            <mi>d</mi>
            <mi mathvariant="normal">Œ£</mi>
           </mrow>
           <mo stretchy="false">}</mo>
          </mrow>
          <msup>
           <mi mathvariant="normal">Œ£</mi>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>n</mi>
           </munderover>
           <mrow>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>x</mi>
               <mi>i</mi>
              </msub>
              <mo>-</mo>
              <mi>Œº</mi>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <msup>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <msub>
                <mi>x</mi>
                <mi>i</mi>
               </msub>
               <mo>-</mo>
               <mi>Œº</mi>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
             <mi mathvariant="normal">T</mi>
            </msup>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi mathvariant="normal">Œ£</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </munderover>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>x</mi>
              <mi>i</mi>
             </msub>
             <mo>-</mo>
             <mi>Œº</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <msup>
            <mrow>
             <mo stretchy="false">{</mo>
             <mrow>
              <mi>d</mi>
              <mi>Œº</mi>
             </mrow>
             <mo stretchy="false">}</mo>
            </mrow>
            <mi mathvariant="normal">T</mi>
           </msup>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>tr</ci>
      <apply>
       <minus></minus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>normal-Œ£</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <set>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>normal-Œ£</ci>
          </apply>
         </set>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>normal-Œ£</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>i</ci>
            </apply>
            <ci>Œº</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>i</ci>
             </apply>
             <ci>Œº</ci>
            </apply>
            <ci>normal-T</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Œ£</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>i</ci>
           </apply>
           <ci>Œº</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <set>
            <apply>
             <times></times>
             <ci>d</ci>
             <ci>Œº</ci>
            </apply>
           </set>
           <ci>normal-T</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -{1\over 2}\operatorname{tr}\left[-\Sigma^{-1}\{d\Sigma\}\Sigma^{-1}\sum_{i=1}%
^{n}(x_{i}-\mu)(x_{i}-\mu)^{\mathrm{T}}-2\Sigma^{-1}\sum_{i=1}^{n}(x_{i}-\mu)%
\{d\mu\}^{\mathrm{T}}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>It naturally breaks down into the part related to the estimation of the mean, and to the part related to the estimation of the variance. The <a href="first_order_condition" title="wikilink">first order condition</a> for maximum, 

<math display="inline" id="Estimation_of_covariance_matrices:32">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mi>ln</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Œº</mi>
     <mo>,</mo>
     <mi mathvariant="normal">Œ£</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <ln></ln>
      <ci>‚Ñí</ci>
     </apply>
     <interval closure="open">
      <ci>Œº</ci>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\ln\mathcal{L}(\mu,\Sigma)=0
  </annotation>
 </semantics>
</math>

, is satisfied when the terms multiplying 

<math display="inline" id="Estimation_of_covariance_matrices:33">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>Œº</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>Œº</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Estimation_of_covariance_matrices:34">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi mathvariant="normal">Œ£</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>normal-Œ£</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\Sigma
  </annotation>
 </semantics>
</math>

 are identically zero. Assuming (the maximum likelihood estimate of) 

<math display="inline" id="Estimation_of_covariance_matrices:35">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 is non-singular, the first order condition for the estimate of the mean vector is</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:36">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mi>Œº</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>Œº</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}(x_{i}-\mu)=0,
  </annotation>
 </semantics>
</math>

</p>

<p>which leads to the maximum likelihood estimator</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:37">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>Œº</mi>
     <mo>^</mo>
    </mover>
    <mo>=</mo>
    <mover accent="true">
     <mi>X</mi>
     <mo stretchy="false">¬Ø</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <msub>
       <mi>X</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-^</ci>
      <ci>Œº</ci>
     </apply>
     <apply>
      <ci>normal-¬Ø</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\mu}=\bar{X}={1\over n}\sum_{i=1}^{n}X_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>This lets us simplify 

<math display="inline" id="Estimation_of_covariance_matrices:38">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">‚àë</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mi>Œº</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mi>Œº</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">‚àë</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¬Ø</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¬Ø</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>S</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <ci>Œº</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <ci>Œº</ci>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}(x_{i}-\mu)(x_{i}-\mu)^{\mathrm{T}}=\sum_{i=1}^{n}(x_{i}-\bar{x}%
)(x_{i}-\bar{x})^{\mathrm{T}}=S
  </annotation>
 </semantics>
</math>

 as defined above. Then the terms involving 

<math display="inline" id="Estimation_of_covariance_matrices:39">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi mathvariant="normal">Œ£</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>normal-Œ£</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\Sigma
  </annotation>
 </semantics>
</math>

 in 

<math display="inline" id="Estimation_of_covariance_matrices:40">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mi>ln</mi>
    <mi>L</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <apply>
     <ln></ln>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\ln L
  </annotation>
 </semantics>
</math>

 can be combined as</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:41">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi mathvariant="normal">Œ£</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mo>{</mo>
         <mrow>
          <mi>d</mi>
          <mi mathvariant="normal">Œ£</mi>
         </mrow>
         <mo>}</mo>
        </mrow>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mrow>
           <mi>n</mi>
           <msub>
            <mi>I</mi>
            <mi>p</mi>
           </msub>
          </mrow>
          <mo>-</mo>
          <mrow>
           <msup>
            <mi mathvariant="normal">Œ£</mi>
            <mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msup>
           <mi>S</mi>
          </mrow>
         </mrow>
         <mo>]</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Œ£</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <set>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>normal-Œ£</ci>
        </apply>
       </set>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>n</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>p</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>normal-Œ£</ci>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>S</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -{1\over 2}\operatorname{tr}\left(\Sigma^{-1}\left\{d\Sigma\right\}\left[nI_{p%
}-\Sigma^{-1}S\right]\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The first order condition 

<math display="inline" id="Estimation_of_covariance_matrices:42">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mi>ln</mi>
     <mi class="ltx_font_mathcaligraphic">‚Ñí</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Œº</mi>
     <mo>,</mo>
     <mi mathvariant="normal">Œ£</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <ln></ln>
      <ci>‚Ñí</ci>
     </apply>
     <interval closure="open">
      <ci>Œº</ci>
      <ci>normal-Œ£</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\ln\mathcal{L}(\mu,\Sigma)=0
  </annotation>
 </semantics>
</math>

 will hold when the term in the square bracket is (matrix-valued) zero. Pre-multiplying the latter by 

<math display="inline" id="Estimation_of_covariance_matrices:43">
 <semantics>
  <mi mathvariant="normal">Œ£</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ£</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 and dividing by 

<math display="inline" id="Estimation_of_covariance_matrices:44">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 gives</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:45">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi mathvariant="normal">Œ£</mi>
     <mo>^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mi>S</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>normal-Œ£</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Sigma}={1\over n}S,
  </annotation>
 </semantics>
</math>

</p>

<p>which of course coincides with the canonical derivation given earlier.</p>

<p>Dwyer <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> points out that decomposition into two terms such as appears above is "unnecessary" and derives the estimator in two lines of working. Note that it may be not trivial to show that such derived estimator is the unique global maximizer for likelihood function.</p>
<h2 id="intrinsic-covariance-matrix-estimation">Intrinsic covariance matrix estimation</h2>
<h3 id="intrinsic-expectation">Intrinsic expectation</h3>

<p>Given a <a href="Sample_(statistics)" title="wikilink">sample</a> of <em>n</em> independent observations <em>x</em><sub>1</sub>,..., <em>x</em><sub><em>n</em></sub> of a <em>p</em>-dimensional zero-mean Gaussian random variable <em>X</em> with covariance <strong>R</strong>, the <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> <a class="uri" href="estimator" title="wikilink">estimator</a> of <strong>R</strong> is given by</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:46">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>ùêë</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mi mathvariant="normal">T</mi>
       </msubsup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>ùêë</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{R}}={1\over n}\sum_{i=1}^{n}x_{i}x_{i}^{\mathrm{T}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The parameter <strong>R</strong> belongs to the set of <a href="Positive-definite_matrix" title="wikilink">positive-definite matrices</a>, which is a <a href="Riemannian_manifold" title="wikilink">Riemannian manifold</a>, not a <a href="vector_space" title="wikilink">vector space</a>, hence the usual vector-space notions of <a href="Expected_value" title="wikilink">expectation</a>, i.e. "E[<strong>R</strong>^]", and <a href="estimator_bias" title="wikilink">estimator bias</a> must be generalized to manifolds to make sense of the problem of covariance matrix estimation. This can be done by defining the expectation of an manifold-valued estimator <strong>R</strong>^ with respect to the manifold-valued point <strong>R</strong> as</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:47">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">E</mi>
     <mi>ùêë</mi>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo rspace="7.5pt" stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mpadded width="+5pt">
    <mover>
     <mo movablelimits="false">=</mo>
     <mi>def</mi>
    </mover>
   </mpadded>
   <mrow>
    <mrow>
     <msub>
      <mi>exp</mi>
      <mi>ùêë</mi>
     </msub>
     <mi mathvariant="normal">E</mi>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msubsup>
       <mi>exp</mi>
       <mi>ùêë</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mover accent="true">
       <mi>ùêë</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-E</ci>
      <ci>ùêë</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ùêë</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <exp></exp>
       <ci>ùêë</ci>
      </apply>
      <ci>normal-E</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <exp></exp>
         <ci>ùêë</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>ùêë</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{E}_{\mathbf{R}}[\hat{\mathbf{R}}]\ \stackrel{\mathrm{def}}{=}\ \exp_{%
\mathbf{R}}\mathrm{E}\left[\exp_{\mathbf{R}}^{-1}\hat{\mathbf{R}}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:48">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>exp</mi>
     <mi>ùêë</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>ùêë</mi>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>ùêë</mi>
        <mrow>
         <mo>-</mo>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mrow>
       </msup>
       <mover accent="true">
        <mi>ùêë</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <msup>
        <mi>ùêë</mi>
        <mrow>
         <mo>-</mo>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mrow>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <msup>
     <mi>ùêë</mi>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <exp></exp>
      <ci>ùêë</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>ùêë</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêë</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùêë</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>ùêë</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùêë</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêë</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp_{\mathbf{R}}(\hat{\mathbf{R}})=\mathbf{R}^{\frac{1}{2}}\exp\left(\mathbf{%
R}^{-\frac{1}{2}}\hat{\mathbf{R}}\mathbf{R}^{-\frac{1}{2}}\right)\mathbf{R}^{%
\frac{1}{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:49">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>exp</mi>
     <mi>ùêë</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>ùêë</mi>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>log</mi>
      <mrow>
       <msup>
        <mi>ùêë</mi>
        <mrow>
         <mo>-</mo>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mrow>
       </msup>
       <mover accent="true">
        <mi>ùêë</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <msup>
        <mi>ùêë</mi>
        <mrow>
         <mo>-</mo>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mrow>
       </msup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mi>ùêë</mi>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <exp></exp>
       <ci>ùêë</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>ùêë</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêë</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <log></log>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùêë</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-^</ci>
        <ci>ùêë</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùêë</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêë</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp_{\mathbf{R}}^{-1}(\hat{\mathbf{R}})=\mathbf{R}^{\frac{1}{2}}\left(\log%
\mathbf{R}^{-\frac{1}{2}}\hat{\mathbf{R}}\mathbf{R}^{-\frac{1}{2}}\right)%
\mathbf{R}^{\frac{1}{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>are the <a href="exponential_map_(Lie_theory)" title="wikilink">exponential map</a> and inverse exponential map, respectively, "exp" and "log" denote the ordinary <a href="matrix_exponential" title="wikilink">matrix exponential</a> and <a href="matrix_logarithm" title="wikilink">matrix logarithm</a>, and E[¬∑] is the ordinary expectation operator defined on a vector space, in this case the <a href="tangent_space" title="wikilink">tangent space</a> of the manifold.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h3 id="bias-of-the-sample-covariance-matrix">Bias of the sample covariance matrix</h3>

<p>The <a href="intrinsic_bias" title="wikilink">intrinsic bias</a> <a href="vector_field" title="wikilink">vector field</a> of the SCM estimator <strong>R</strong>^ is defined to be</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:50">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùêÅ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>exp</mi>
      <mi>ùêë</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi mathvariant="normal">E</mi>
      <mi>ùêë</mi>
     </msub>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msubsup>
       <mi>exp</mi>
       <mi>ùêë</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mover accent="true">
       <mi>ùêë</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ùêÅ</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>ùêë</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <exp></exp>
         <ci>ùêë</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-E</ci>
        <ci>ùêë</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ùêë</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <exp></exp>
          <ci>ùêë</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <ci>normal-^</ci>
         <ci>ùêë</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}(\hat{\mathbf{R}})=\exp_{\mathbf{R}}^{-1}\mathrm{E}_{\mathbf{R}}%
\left[\hat{\mathbf{R}}\right]=\mathrm{E}\left[\exp_{\mathbf{R}}^{-1}\hat{%
\mathbf{R}}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>The intrinsic estimator bias is then given by 

<math display="inline" id="Estimation_of_covariance_matrices:51">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>exp</mi>
     <mi>ùêë</mi>
    </msub>
    <mi>ùêÅ</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>ùêë</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <exp></exp>
      <ci>ùêë</ci>
     </apply>
     <ci>ùêÅ</ci>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>ùêë</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp_{\mathbf{R}}\mathbf{B}(\hat{\mathbf{R}})
  </annotation>
 </semantics>
</math>

.</p>

<p>For <a href="Complex_number" title="wikilink">complex</a> Gaussian random variables, this bias vector field can be shown<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> to equal</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:52">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùêÅ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>Œ≤</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>p</mi>
      <mo>,</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>ùêë</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ùêÅ</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>ùêë</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>Œ≤</ci>
      <interval closure="open">
       <ci>p</ci>
       <ci>n</ci>
      </interval>
      <ci>ùêë</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}(\hat{\mathbf{R}})=-\beta(p,n)\mathbf{R}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:53">
 <semantics>
  <mrow>
   <mrow>
    <mi>Œ≤</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>,</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>p</mi>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi>p</mi>
          <mrow>
           <mi>log</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mi>p</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>œà</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mi>p</mi>
           </mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mi>p</mi>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>œà</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mi>p</mi>
          </mrow>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>œà</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>œà</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Œ≤</ci>
     <interval closure="open">
      <ci>p</ci>
      <ci>n</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>p</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>p</ci>
          <apply>
           <log></log>
           <ci>n</ci>
          </apply>
         </apply>
         <ci>p</ci>
        </apply>
        <apply>
         <times></times>
         <ci>œà</ci>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <ci>p</ci>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <ci>p</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <ci>œà</ci>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <ci>p</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>œà</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>œà</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta(p,n)=\frac{1}{p}\left(p\log n+p-\psi(n-p+1)+(n-p+1)\psi(n-p+2)+\psi(n+1)%
-(n+1)\psi(n+2)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>and œà(¬∑) is the <a href="digamma_function" title="wikilink">digamma function</a>. The intrinsic bias of the sample covariance matrix equals</p>

<p>

<math display="block" id="Estimation_of_covariance_matrices:54">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>exp</mi>
      <mi>ùêë</mi>
     </msub>
     <mi>ùêÅ</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>ùêë</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>Œ≤</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>p</mi>
        <mo>,</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </msup>
    <mi>ùêë</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <exp></exp>
       <ci>ùêë</ci>
      </apply>
      <ci>ùêÅ</ci>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <ci>ùêë</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>Œ≤</ci>
        <interval closure="open">
         <ci>p</ci>
         <ci>n</ci>
        </interval>
       </apply>
      </apply>
     </apply>
     <ci>ùêë</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp_{\mathbf{R}}\mathbf{B}(\hat{\mathbf{R}})=e^{-\beta(p,n)}\mathbf{R}
  </annotation>
 </semantics>
</math>

</p>

<p>and the SCM is asymptotically unbiased as <em>n</em> ‚Üí ‚àû.</p>

<p>Similarly, the intrinsic <a href="Efficiency_(statistics)" title="wikilink">inefficiency</a> of the sample covariance matrix depends upon the <a href="Riemannian_curvature" title="wikilink">Riemannian curvature</a> of the space of positive-define matrices.</p>
<h2 id="shrinkage-estimation">Shrinkage estimation</h2>

<p>If the sample size <em>n</em> is small and the number of considered variables <em>p</em> is large, the above empirical estimators of covariance and correlation are very unstable. Specifically, it is possible to furnish estimators that improve considerably upon the maximum likelihood estimate in terms of mean squared error. Moreover, for <em>n</em>¬†A) with some suitable chosen target (

<math display="inline" id="Estimation_of_covariance_matrices:55">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

), e.g., the diagonal matrix. Subsequently, the mixing parameter (

<math display="inline" id="Estimation_of_covariance_matrices:56">
 <semantics>
  <mi>Œ¥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ¥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta
  </annotation>
 </semantics>
</math>

) is selected to maximize the expected accuracy of the shrunken estimator. This can be done by <a href="cross-validation_(statistics)" title="wikilink">cross-validation</a>, or by using an analytic estimate of the shrinkage intensity. The resulting regularized estimator (

<math display="inline" id="Estimation_of_covariance_matrices:57">
 <semantics>
  <mrow>
   <mrow>
    <mi>Œ¥</mi>
    <mi>A</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>Œ¥</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>B</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>Œ¥</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>Œ¥</ci>
     </apply>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta A+(1-\delta)B
  </annotation>
 </semantics>
</math>

) can be shown to outperform the maximum likelihood estimator for small samples. For large samples, the shrinkage intensity will reduce to zero, hence in this case the shrinkage estimator will be identical to the empirical estimator. Apart from increased efficiency the shrinkage estimate has the additional advantage that it is always positive definite and well conditioned.</p>

<p>Various shrinkage targets have been proposed:</p>
<ol>
<li>the <a href="identity_matrix" title="wikilink">identity matrix</a>, scaled by the average <a href="Variance#Sample_variance" title="wikilink">sample variance</a>;<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></li>
<li>the <a href="single-index_model" title="wikilink">single-index model</a>;<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></li>
<li>the constant-correlation model, where the sample variances are preserved, but all pairwise <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">correlation coefficients</a> are assumed to be equal to one another;<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></li>
<li>the two-parameter matrix, where all variances are identical, and all <a href="covariance" title="wikilink">covariances</a> are identical to one another (although <em>not</em> identical to the variances);<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></li>
<li>the <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> containing sample variances on the diagonal and zeros everywhere else.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></li>
</ol>

<p>A review on this topic is given, e.g., in Sch√§fer and Strimmer 2005.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> Software for computing a covariance shrinkage estimator is available in <a href="R_programming_language" title="wikilink">R</a> (packages <strong>corpcor</strong><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> and <strong>ShrinkCovMat</strong><a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a>), in <a href="Python_programming_language" title="wikilink">Python</a> (library <a href="http://scikit-learn.org/stable/modules/covariance.html">scikit-learn</a>), and in <a class="uri" href="MATLAB" title="wikilink">MATLAB</a>.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Propagation_of_uncertainty" title="wikilink">Propagation of uncertainty</a></li>
<li><a href="Sample_mean_and_sample_covariance" title="wikilink">Sample mean and sample covariance</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Estimation_for_specific_parameters" title="wikilink">Category:Estimation for specific parameters</a> <a href="Category:Statistical_deviation_and_dispersion" title="wikilink">Category:Statistical deviation and dispersion</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><em>Robust Statistics</em>, <a href="Peter._J._Huber" title="wikilink">Peter. J. Huber</a>, Wiley, 1981 (republished in paperback, 2004)<a href="#fnref3">‚Ü©</a></li>
<li id="fn4">"Modern applied statistics with S", <a href="William_N._Venables" title="wikilink">William N. Venables</a>, <a href="Brian_D._Ripley" title="wikilink">Brian D. Ripley</a>, Springer, 2002, ISBN 0-387-95457-0, ISBN 978-0-387-95457-8, page 336<a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="Kanti_Mardia" title="wikilink">K.V. Mardia</a>, <a href="John_Kent_(statistician)" title="wikilink">J.T. Kent</a>, and <a href="John_Bibby_(mathematician)" title="wikilink">J.M. Bibby</a> (1979) <em><a href="Multivariate_Analysis" title="wikilink">Multivariate Analysis</a></em>, <a href="Academic_Press" title="wikilink">Academic Press</a>.<a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9">O. Ledoit and M. Wolf (2004a) "<a href="http://www.econ.uzh.ch/faculty/wolf/publications/wellCond.pdf">A well-conditioned estimator for large-dimensional covariance matrices</a>" <em><a href="Journal_of_Multivariate_Analysis" title="wikilink">Journal of Multivariate Analysis</a></em> <strong>88</strong> (2): 365‚Äî411.<a href="#fnref9">‚Ü©</a></li>
<li id="fn10">O. Ledoit and M. Wolf (2003) "<a href="http://www.econ.uzh.ch/faculty/wolf/publications/jef.pdf">Improved estimation of the covariance matrix of stock returns with an application to portofolio selection</a>" <em>Journal of Empirical Finance</em> <strong>10</strong> (5): 603‚Äî621.<a href="#fnref10">‚Ü©</a></li>
<li id="fn11">O. Ledoit and M. Wolf (2004b) "<a href="http://www.econ.uzh.ch/faculty/ledoit/publications/honey.pdf">Honey, I shrunk the sample covariance matrix</a>" <em><a href="The_Journal_of_Portfolio_Management" title="wikilink">The Journal of Portfolio Management</a></em> <strong>30</strong> (4): 110‚Äî119.<a href="#fnref11">‚Ü©</a></li>
<li id="fn12">Appendix B.1 of O. Ledoit (1996) "<a href="http://www.anderson.ucla.edu/documents/areas/fac/finance/05-96.pdf">Improved Covariance Matrix Estimation</a>" <a href="http://www.anderson.ucla.edu/faculty/finance/working-papers">Finance Working Paper</a> No. 5-96, <a href="UCLA_Anderson_School_of_Management" title="wikilink">Anderson School of Management</a>, <a href="University_of_California,_Los_Angeles" title="wikilink">University of California, Los Angeles</a>.<a href="#fnref12">‚Ü©</a></li>
<li id="fn13">Appendix B.2 of O. Ledoit (1996).<a href="#fnref13">‚Ü©</a></li>
<li id="fn14">J. Sch√§fer and K. Strimmer (2005) <em><a href="http://www.bepress.com/sagmb/vol4/iss1/art32">A Shrinkage Approach to Large-Scale Covariance Matrix Estimation and Implications for Functional Genomics</a></em>, Statistical Applications in Genetics and Molecular Biology: Vol. 4: No. 1, Article 32.<a href="#fnref14">‚Ü©</a></li>
<li id="fn15"><a href="#fnref15">‚Ü©</a></li>
<li id="fn16"><a href="#fnref16">‚Ü©</a></li>
<li id="fn17">MATLAB code for shrinkage targets: <a href="http://www.econ.uzh.ch/dam/jcr:ffffffff-935a-b0d6-0000-00007f64e5b9/cov1para.m.zip">scaled identity</a>, <a href="http://www.econ.uzh.ch/dam/jcr:ffffffff-935a-b0d6-0000-0000648dfc98/covMarket.m.zip">single-index model</a>, <a href="http://www.econ.uzh.ch/dam/jcr:ffffffff-935a-b0d6-ffff-ffffde5e2d4e/covCor.m.zip">constant-correlation model</a>, <a href="http://ledoit.net/cov2para.m">two-parameter matrix</a>, and <a href="http://ledoit.net/shrinkDiag.m">diagonal matrix</a>.<a href="#fnref17">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

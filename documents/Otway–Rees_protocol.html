<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="870">Otway–Rees protocol</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Otway–Rees protocol</h1>
<hr/>

<p>The <strong>Otway–Rees protocol</strong> is a <a href="computer_network" title="wikilink">computer network</a> <a class="uri" href="authentication" title="wikilink">authentication</a> <a href="communications_protocol" title="wikilink">protocol</a> designed for use on <a href="insecure_network" title="wikilink">insecure networks</a> (e.g. the <a class="uri" href="Internet" title="wikilink">Internet</a>). It allows individuals communicating over such a network to prove their identity to each other while also preventing <a class="uri" href="eavesdropping" title="wikilink">eavesdropping</a> or <a href="replay_attack" title="wikilink">replay attacks</a> and allowing for the detection of modification.</p>

<p>The protocol can be specified as follows in <a href="security_protocol_notation" title="wikilink">security protocol notation</a>, where <strong>A</strong>lice is authenticating herself to <strong>B</strong>ob using a server <strong>S</strong> (<strong>M</strong> is a session-identifier, <strong>N<sub>A</sub></strong> and <strong>N<sub>B</sub></strong> are <a href="Cryptographic_nonce" title="wikilink">nonces</a>):</p>
<ol>
<li>

<math display="inline" id="Otway–Rees_protocol:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>→</mo>
    <mi>B</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>M</mi>
    <mo>,</mo>
    <mi>A</mi>
    <mo>,</mo>
    <mi>B</mi>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>N</mi>
       <mi>A</mi>
      </msub>
      <mo>,</mo>
      <mi>M</mi>
      <mo>,</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
      <mo stretchy="false">}</mo>
     </mrow>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>A</mi>
       <mi>S</mi>
      </mrow>
     </msub>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <ci>normal-→</ci>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
    <list>
     <ci>M</ci>
     <ci>A</ci>
     <ci>B</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>A</ci>
       </apply>
       <ci>M</ci>
       <ci>A</ci>
       <ci>B</ci>
      </set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\rightarrow B:M,A,B,\{N_{A},M,A,B\}_{K_{AS}}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Otway–Rees_protocol:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mo>→</mo>
    <mi>S</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>M</mi>
    <mo>,</mo>
    <mi>A</mi>
    <mo>,</mo>
    <mi>B</mi>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>N</mi>
       <mi>A</mi>
      </msub>
      <mo>,</mo>
      <mi>M</mi>
      <mo>,</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
      <mo stretchy="false">}</mo>
     </mrow>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>A</mi>
       <mi>S</mi>
      </mrow>
     </msub>
    </msub>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>N</mi>
       <mi>B</mi>
      </msub>
      <mo>,</mo>
      <mi>M</mi>
      <mo>,</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
      <mo stretchy="false">}</mo>
     </mrow>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>B</mi>
       <mi>S</mi>
      </mrow>
     </msub>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <ci>normal-→</ci>
     <ci>B</ci>
     <ci>S</ci>
    </apply>
    <list>
     <ci>M</ci>
     <ci>A</ci>
     <ci>B</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>A</ci>
       </apply>
       <ci>M</ci>
       <ci>A</ci>
       <ci>B</ci>
      </set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>B</ci>
       </apply>
       <ci>M</ci>
       <ci>A</ci>
       <ci>B</ci>
      </set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>B</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B\rightarrow S:M,A,B,\{N_{A},M,A,B\}_{K_{AS}},\{N_{B},M,A,B\}_{K_{BS}}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Otway–Rees_protocol:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>→</mo>
    <mi>B</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>M</mi>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>N</mi>
       <mi>A</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>K</mi>
       <mrow>
        <mi>A</mi>
        <mi>B</mi>
       </mrow>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>A</mi>
       <mi>S</mi>
      </mrow>
     </msub>
    </msub>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>N</mi>
       <mi>B</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>K</mi>
       <mrow>
        <mi>A</mi>
        <mi>B</mi>
       </mrow>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>B</mi>
       <mi>S</mi>
      </mrow>
     </msub>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <ci>normal-→</ci>
     <ci>S</ci>
     <ci>B</ci>
    </apply>
    <list>
     <ci>M</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>B</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>B</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S\rightarrow B:M,\{N_{A},K_{AB}\}_{K_{AS}},\{N_{B},K_{AB}\}_{K_{BS}}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Otway–Rees_protocol:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mo>→</mo>
    <mi>A</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>M</mi>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>N</mi>
       <mi>A</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>K</mi>
       <mrow>
        <mi>A</mi>
        <mi>B</mi>
       </mrow>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
     <msub>
      <mi>K</mi>
      <mrow>
       <mi>A</mi>
       <mi>S</mi>
      </mrow>
     </msub>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <ci>normal-→</ci>
     <ci>B</ci>
     <ci>A</ci>
    </apply>
    <list>
     <ci>M</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B\rightarrow A:M,\{N_{A},K_{AB}\}_{K_{AS}}
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>Note: The above steps do not authenticate <strong>B</strong> to <strong>A</strong>.</p>
<h2 id="attacks-on-the-protocol">Attacks on the protocol</h2>

<p>There are a variety of attacks on this protocol currently published.</p>

<p>One problem with this protocol is that a malicious intruder can arrange for <strong>A</strong> and <strong>B</strong> to end up with different keys. Here is how: after <strong>A</strong> and <strong>B</strong> execute the first three messages, <strong>B</strong> has received the key 

<math display="inline" id="Otway–Rees_protocol:4">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{AB}
  </annotation>
 </semantics>
</math>

. The intruder then intercepts the fourth message. He resends message 2, which results in <strong>S</strong> generating a new key 

<math display="inline" id="Otway–Rees_protocol:5">
 <semantics>
  <msubsup>
   <mi>K</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>K</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{\prime}_{AB}
  </annotation>
 </semantics>
</math>

, subsequently sent to <strong>B</strong>. The intruder intercepts this message too, but sends to '''A '''the part of it that <strong>B</strong> would have sent to <strong>A</strong>. So now <strong>A</strong> has finally received the expected fourth message, but with 

<math display="inline" id="Otway–Rees_protocol:6">
 <semantics>
  <msubsup>
   <mi>K</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
   <mo>′</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>K</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{\prime}_{AB}
  </annotation>
 </semantics>
</math>

 instead of 

<math display="inline" id="Otway–Rees_protocol:7">
 <semantics>
  <msub>
   <mi>K</mi>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{AB}
  </annotation>
 </semantics>
</math>

.</p>

<p>Another problem is that although the server tells <strong>B</strong> that <strong>A</strong> used a nonce, <strong>B</strong> doesn't know if this was a replay of an old message. Specifically, an intruder could discover an older nonce. The older nonce could be reused to authenticate against <strong>B</strong>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Kerberos_(protocol)" title="wikilink">Kerberos (protocol)</a></li>
<li><a href="Needham–Schroeder_protocol" title="wikilink">Needham–Schroeder protocol</a></li>
<li><a href="Yahalom_(protocol)" title="wikilink">Yahalom (protocol)</a></li>
<li><a href="Wide_Mouth_Frog_protocol" title="wikilink">Wide Mouth Frog protocol</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computer_access_control_protocols" title="wikilink">Category:Computer access control protocols</a> <a href="Category:Authentication_protocols" title="wikilink">Category:Authentication protocols</a> <a href="Category:Key_transport_protocols" title="wikilink">Category:Key transport protocols</a> <a href="Category:Symmetric-key_cryptography" title="wikilink">Category:Symmetric-key cryptography</a></p>
</body>
</html>

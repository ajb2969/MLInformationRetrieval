   Spherical law of cosines      Spherical law of cosines   In spherical trigonometry , the law of cosines (also called the cosine rule for sides 1 ) is a theorem relating the sides and angles of spherical triangles, analogous to the ordinary law of cosines from plane trigonometry .  Given a unit sphere, a "spherical triangle" on the surface of the sphere is defined by the great circles connecting three points    ğ®  ,  ğ¯     ğ®  ğ¯    \mathbf{u},\mathbf{v}   , and   ğ°   ğ°   \mathbf{w}   on the sphere (shown at right). If the lengths of these three sides are   a   a   a   (from   ğ®   ğ®   \mathbf{u}   to    ğ¯  )  ,  b     fragments  v  normal-)  normal-,  b    \mathbf{v}),b   (from   ğ®   ğ®   \mathbf{u}   to   ğ°   ğ°   \mathbf{w}   ), and   c   c   c   (from   ğ¯   ğ¯   \mathbf{v}   to   ğ°   ğ°   \mathbf{w}   ), and the angle of the corner opposite   c   c   c   is   C   C   C   , then the (first) spherical law of cosines states: 2 3        cos   (  c  )    =     cos   (  a  )     cos   (  b  )     +    sin   (  a  )     sin   (  b  )     cos   (  C  )       .        c         a     b        a     b     C       \cos(c)=\cos(a)\cos(b)+\sin(a)\sin(b)\cos(C).\,     Since this is a unit sphere, the lengths    a  ,  b     a  b    a,b   , and   c   c   c   are simply equal to the angles (in radians ) subtended by those sides from the center of the sphere (for a non-unit sphere, they are the distances divided by the radius). As a special case, for    C  =   Ï€  /  2       C    Ï€  2     C={Ï€}/{2}   , then     c  o  s  C   =  0        c  o  s  C   0    cosC=0   , and one obtains the spherical analogue of the Pythagorean theorem :        cos   (  c  )    =    cos   (  a  )     cos   (  b  )      .        c       a     b      \cos(c)=\cos(a)\cos(b).\,     A variation on the law of cosines, the second spherical law of cosines, 4 (also called the cosine rule for angles 5 ) states:       cos   (  A  )    =    -    cos   (  B  )     cos   (  C  )      +    sin   (  B  )     sin   (  C  )     cos   (  a  )            A           B     C         B     C     a       \cos(A)=-\cos(B)\cos(C)+\sin(B)\sin(C)\cos(a)\,     where   A   A   A   and   B   B   B   are the angles of the corners opposite to sides   a   a   a   and   b   b   b   , respectively. It can be obtained from consideration of a spherical triangle dual to the given one.  If the law of cosines is used to solve for   c   c   c   , the necessity of inverting the cosine magnifies rounding errors when   c   c   c   is small. In this case, the alternative formulation of the law of haversines is preferable. 6  Proof  A proof of the law of cosines can be constructed as follows. 7 Let    ğ®  ,  ğ¯     ğ®  ğ¯    \mathbf{u},\mathbf{v}   , and   ğ°   ğ°   \mathbf{w}   denote the unit vectors from the center of the sphere to those corners of the triangle. Then, the lengths (angles) of the sides are given by the dot products :       cos   (  a  )    =   ğ®  â‹…  ğ¯         a    normal-â‹…  ğ®  ğ¯     \cos(a)=\mathbf{u}\cdot\mathbf{v}          cos   (  b  )    =   ğ®  â‹…  ğ°         b    normal-â‹…  ğ®  ğ°     \cos(b)=\mathbf{u}\cdot\mathbf{w}          cos   (  c  )    =   ğ¯  â‹…  ğ°         c    normal-â‹…  ğ¯  ğ°     \cos(c)=\mathbf{v}\cdot\mathbf{w}     To get the angle   C   C   C   , we need the tangent vectors and at   ğ®   ğ®   \mathbf{u}   along the directions of sides   a   a   a   and   b   b   b   , respectively. For example, the tangent vector is the unit vector perpendicular to   ğ®   ğ®   \mathbf{u}   in the    ğ®  -  ğ¯      ğ®  ğ¯    \mathbf{u}-\mathbf{v}   plane, whose direction is given by the component of   ğ¯   ğ¯   \mathbf{v}   perpendicular to   ğ®   ğ®   \mathbf{u}   . This means:       ğ­  a   =    ğ¯  -   ğ®   (   ğ®  â‹…  ğ¯   )      âˆ¥   ğ¯  -   ğ®   (   ğ®  â‹…  ğ¯   )     âˆ¥    =    ğ¯  -   ğ®   cos   (  a  )       sin   (  a  )            subscript  ğ­  a       ğ¯    ğ®   normal-â‹…  ğ®  ğ¯      norm    ğ¯    ğ®   normal-â‹…  ğ®  ğ¯                ğ¯    ğ®    a       a       \mathbf{t}_{a}=\frac{\mathbf{v}-\mathbf{u}(\mathbf{u}\cdot\mathbf{v})}{\left\|%
 \mathbf{v}-\mathbf{u}(\mathbf{u}\cdot\mathbf{v})\right\|}=\frac{\mathbf{v}-%
 \mathbf{u}\cos(a)}{\sin(a)}     where for the denominator we have used the Pythagorean identity  1 âˆ’ cos 2 ( a )}} and where || || denotes the length of the vector in the denominator. Similarly,        ğ­  b   =    ğ°  -   ğ®   cos   (  b  )       sin   (  b  )      .       subscript  ğ­  b       ğ°    ğ®    b       b      \mathbf{t}_{b}=\frac{\mathbf{w}-\mathbf{u}\cos(b)}{\sin(b)}.     Then, the angle   C   C   C   is given by:       cos   (  C  )    =    ğ­  a   â‹…   ğ­  b    =     cos   (  c  )    -    cos   (  a  )     cos   (  b  )        sin   (  a  )     sin   (  b  )              C    normal-â‹…   subscript  ğ­  a    subscript  ğ­  b               c       a     b         a     b        \cos(C)=\mathbf{t}_{a}\cdot\mathbf{t}_{b}=\frac{\cos(c)-\cos(a)\cos(b)}{\sin(a%
 )\sin(b)}     from which the law of cosines immediately follows.  Proof without vectors  To the diagram above, add a plane tangent to the sphere at   ğ®   ğ®   \mathbf{u}   , and extend radii from the center of the sphere   ğ   ğ   \mathbf{O}   through   ğ¯   ğ¯   \mathbf{v}   and through   ğ°   ğ°   \mathbf{w}   to meet the plane at points   ğ²   ğ²   \mathbf{y}   and   ğ³   ğ³   \mathbf{z}   . We then have two plane triangles with a side in common: the triangle containing    ğ®  ,  ğ²     ğ®  ğ²    \mathbf{u},\mathbf{y}   and   ğ³   ğ³   \mathbf{z}   and the one containing    ğ  ,  ğ²     ğ  ğ²    \mathbf{O},\mathbf{y}   and   ğ³   ğ³   \mathbf{z}   . Sides of the first triangle are    t  a  n  a      t  a  n  a    tana   and    t  a  n  b      t  a  n  b    tanb   , with angle   C   C   C   between them; sides of the second triangle are    s  e  c  a      s  e  c  a    seca   and    s  e  c  b      s  e  c  b    secb   , with angle   c   c   c   between them. By the law of cosines for plane triangles (and remembering that of any angle is ),         tan  2   a   +    tan  2   b    -   2   tan  a    tan  b    cos  C            superscript   2   a     superscript   2   b      2    a     b     C      \displaystyle\tan^{2}a+\tan^{2}b-2\tan a\tan b\cos C     So       -    tan  a    tan  b    cos  C     =   1  -    sec  a    sec  b    cos  c               a     b     C       1      a     b     c       -\tan a\tan b\cos C=1-\sec a\sec b\cos c     Multiply both sides by    c  o  s  a  c  o  s  b      c  o  s  a  c  o  s  b    cosacosb   and rearrange.  Planar limit: small angles  For small spherical triangles, i.e. for small    a  ,  b     a  b    a,b   , and   c   c   c   , the spherical law of cosines is approximately the same as the ordinary planar law of cosines,        c  2   â‰ˆ     a  2   +   b  2    -   2  a  b   cos   (  C  )       .       superscript  c  2        superscript  a  2    superscript  b  2      2  a  b    C       c^{2}\approx a^{2}+b^{2}-2ab\cos(C).\,\!     To prove this, we'll use the small-angle approximation obtained from the Maclaurin series for the cosine and sine functions:        cos   (  a  )    =    1  -    a  2   2    +   O   (   a  4   )      ,    sin   (  a  )    =   a  +   O   (   a  3   )         formulae-sequence      a       1     superscript  a  2   2      O   superscript  a  4          a     a    O   superscript  a  3        \cos(a)=1-\frac{a^{2}}{2}+O(a^{4}),\,\sin(a)=a+O(a^{3})     Substituting these expressions into the spherical law of cosines nets:        1  -    c  2   2    +   O   (   c  4   )     =    1  -    a  2   2   -    b  2   2    +     a  2    b  2    4   +   O   (   a  4   )    +   O   (   b  4   )    +    cos   (  C  )     (    a  b   +   O   (    a  3   b   )    +   O   (   a   b  3    )    +   O   (    a  3    b  3    )     )             1     superscript  c  2   2      O   superscript  c  4         1     superscript  a  2   2      superscript  b  2   2         superscript  a  2    superscript  b  2    4     O   superscript  a  4      O   superscript  b  4        C       a  b     O     superscript  a  3   b      O    a   superscript  b  3       O     superscript  a  3    superscript  b  3          1-\frac{c^{2}}{2}+O(c^{4})=1-\frac{a^{2}}{2}-\frac{b^{2}}{2}+\frac{a^{2}b^{2}}%
 {4}+O(a^{4})+O(b^{4})+\cos(C)(ab+O(a^{3}b)+O(ab^{3})+O(a^{3}b^{3}))     or after simplifying:        c  2   =      a  2   +   b  2    -   2  a  b   cos   (  C  )      +   O   (   c  4   )    +   O   (   a  4   )    +   O   (   b  4   )    +   O   (    a  2    b  2    )    +   O   (    a  3   b   )    +   O   (   a   b  3    )    +   O   (    a  3    b  3    )      .       superscript  c  2          superscript  a  2    superscript  b  2      2  a  b    C       O   superscript  c  4      O   superscript  a  4      O   superscript  b  4      O     superscript  a  2    superscript  b  2       O     superscript  a  3   b      O    a   superscript  b  3       O     superscript  a  3    superscript  b  3        c^{2}=a^{2}+b^{2}-2ab\cos(C)+O(c^{4})+O(a^{4})+O(b^{4})+O(a^{2}b^{2})+O(a^{3}b%
 )+O(ab^{3})+O(a^{3}b^{3}).     Remembering the properties of big O notation , we can discard summands where the lowest exponent for   a   a   a   or   b   b   b   is greater than   1   1   1   , so finally, the error in this approximation is:        O   (   c  4   )    +   O   (    a  3   b   )    +   O   (   a   b  3    )     .        O   superscript  c  4      O     superscript  a  3   b      O    a   superscript  b  3       O(c^{4})+O(a^{3}b)+O(ab^{3}).\,\!     See also   Half-side formula  Hyperbolic law of cosines  Solution of triangles   Notes    he:×˜×¨×™×’×•× ×•××˜×¨×™×” ×¡×¤×™×¨×™×ª#××©×¤×˜ ×”×§×•×¡×™× ×•×¡×™× "  Category:Spherical trigonometry  Category:Articles containing proofs  Category:Theorems in geometry      Romuald Ireneus 'Scibor-Marchocki, [ http://www.webcitation.org/query?url=http://www.geocities.com/ResearchTriangle/2363/trig02.html&date; ;=2009-10-25+09:44:36 Spherical trigonometry], Elementary-Geometry Trigonometry web page (1997). â†©  W. Gellert, S. Gottwald, M. Hellwich, H. KÃ¤stner, and H. KÃ¼stner, The VNR Concise Encyclopedia of Mathematics , 2nd ed., ch. 12 (Van Nostrand Reinhold: New York, 1989). â†©  â†©   R. W. Sinnott, "Virtues of the Haversine", Sky and Telescope 68 (2), 159 (1984). â†©      
   Softmax function      Softmax function   In mathematics , in particular probability theory and related fields, the softmax function, or normalized exponential , 1 is a generalization of the logistic function that "squashes" a   K   K   K   -dimensional vector   𝐳   𝐳   \mathbf{z}   of arbitrary real values to a   K   K   K   -dimensional vector    σ   (  𝐳  )       σ  𝐳    \sigma(\mathbf{z})   of real values in the range (0, 1). The function is given by       σ   (   𝐳  𝐣   )    =    e   z  j      ∑   k  =  1   K    e   z  k            σ   subscript  𝐳  𝐣       superscript  e   subscript  z  j      superscript   subscript     k  1    K    superscript  e   subscript  z  k        \sigma(\mathbf{z_{j}})=\frac{e^{z_{j}}}{\sum_{k=1}^{K}e^{z_{k}}}   for j = 1, ..., K .  The softmax function is the gradient-log-normalizer of the categorical  probability distribution . For this reason, the softmax function is used in various probabilistic multiclass classification methods including multinomial logistic regression , 2 multiclass linear discriminant analysis , naive Bayes classifiers and artificial neural networks . 3 Specifically, in multinomial logistic regression and linear discriminant analysis, the input to the function is the result of   K   K   K   distinct linear functions , and the predicted probability for the   j   j   j   'th class given a sample vector   𝐱   𝐱   \mathbf{x}   is:      P   (  y  =  j  |  𝐱  )   =    e    𝐱  𝖳    𝐰  j       ∑   k  =  1   K    e    𝐱  𝖳    𝐰  k          fragments  P   fragments  normal-(  y   j  normal-|  x  normal-)       superscript  e     superscript  𝐱  𝖳    subscript  𝐰  j       superscript   subscript     k  1    K    superscript  e     superscript  𝐱  𝖳    subscript  𝐰  k         P(y=j|\mathbf{x})=\frac{e^{\mathbf{x}^{\mathsf{T}}\mathbf{w}_{j}}}{\sum_{k=1}^%
 {K}e^{\mathbf{x}^{\mathsf{T}}\mathbf{w}_{k}}}     This can be seen as the composition of   K   K   K   linear functions     𝐱  ↦     𝐱  𝖳    𝐰  1    ,  …    ,   𝐱  ↦    𝐱  𝖳    𝐰  K        formulae-sequence   maps-to  𝐱      superscript  𝐱  𝖳    subscript  𝐰  1    normal-…     maps-to  𝐱     superscript  𝐱  𝖳    subscript  𝐰  K       \mathbf{x}\mapsto\mathbf{x}^{\mathsf{T}}\mathbf{w}_{1},\ldots,\mathbf{x}%
 \mapsto\mathbf{x}^{\mathsf{T}}\mathbf{w}_{K}   and the softmax function.  Artificial neural networks  In neural network simulations, the softmax function is often implemented at the final layer of a network used for classification. Such networks are then trained under a log loss (or cross-entropy ) regime, giving a non-linear variant of multinomial logistic regression.  Since the function maps a vector and a specific index i to a real value, the derivative needs to take the index into account:        ∂   ∂   q  k     σ   (  𝐪  ,  i  )    =  …  =   σ   (  𝐪  ,  i  )    (    δ   i  k    -   σ   (  𝐪  ,  k  )     )                  subscript  q  k     σ   q  i    normal-…         σ   q  i      subscript  δ    i  k      σ   q  k         \frac{\partial}{\partial q_{k}}\sigma(\textbf{q},i)=\dots=\sigma(\textbf{q},i)%
 (\delta_{ik}-\sigma(\textbf{q},k))     Here, the Kronecker delta is used for simplicity (cf. the derivative of a sigmoid function , being expressed via the function itself).  See Multinomial logit for a probability model which uses the softmax activation function.  Reinforcement learning  In the field of reinforcement learning , a softmax function can be used to convert values into action probabilities. The function commonly used is: 4        P  t    (  a  )    =     exp   (     q  t    (  a  )    /  τ   )      ∑   i  =  1   n    exp   (     q  t    (  i  )    /  τ   )      ,          subscript  P  t   a              subscript  q  t   a   τ      superscript   subscript     i  1    n          subscript  q  t   i   τ      ,     P_{t}(a)=\frac{\exp(q_{t}(a)/\tau)}{\sum_{i=1}^{n}\exp(q_{t}(i)/\tau)}\text{,}     where the action value     q  t    (  a  )        subscript  q  t   a    q_{t}(a)   corresponds to the expected reward of following action a and   τ   τ   \tau   is called a temperature parameter (in allusion to chemical kinetics ). For high temperatures (    τ  →  ∞     normal-→  τ     \tau\to\infty   ), all actions have nearly the same probability and the lower the temperature, the more expected rewards affect the probability. For a low temperature (    τ  →   0  +      normal-→  τ   superscript  0      \tau\to 0^{+}   ), the probability of the action with the highest expected reward tends to 1.  Softmax Normalization  Sigmoidal or Softmax normalization is a way of reducing the influence of extreme values or outliers in the data without removing them from the dataset. It is useful given outlier data, which we wish to include in the dataset while still preserving the significance of data within a standard deviation of the mean. The data are nonlinearly transformed using a sigmoidal function, either the logistic sigmoid function: 5      x  i  ′   ≡   1   1  +   e   -   (     x  i   -   μ  i     σ  i    )            superscript   subscript  x  i   normal-′     1    1   superscript  e         subscript  x  i    subscript  μ  i     subscript  σ  i          x_{i}^{\prime}\equiv\frac{1}{1+e^{-(\frac{x_{i}-\mu_{i}}{\sigma_{i}})}}     or the hyperbolic tangent function, tanh : 6      x  i  ′   ≡    1  -   e   -   (     x  i   -   μ  i     σ  i    )       1  +   e   -   (     x  i   -   μ  i     σ  i    )            superscript   subscript  x  i   normal-′       1   superscript  e         subscript  x  i    subscript  μ  i     subscript  σ  i         1   superscript  e         subscript  x  i    subscript  μ  i     subscript  σ  i          x_{i}^{\prime}\equiv\frac{1-e^{-(\frac{x_{i}-\mu_{i}}{\sigma_{i}})}}{1+e^{-(%
 \frac{x_{i}-\mu_{i}}{\sigma_{i}})}}     The sigmoid function limits the normalized data to values between 0 and 1. The sigmoid function is almost linear near the mean and has smooth nonlinearity at both extremes, ensuring that all data points are within a limited range. This maintains the resolution of most values within a standard deviation of the mean.  The hyperbolic tangent function, tanh , limits the normalized data to values between -1 and 1. The hyperbolic tangent function is almost linear near the mean, but has a slope of half that of the sigmoid function. Like sigmoid, it has smooth , monotonic nonlinearity at both extremes. Also, like the sigmoid the function, it remains differentiable everywhere and the sign of the derivative (slope) is unaffected by the normalization. This ensures that optimization and numerical integration algorithms can continue to rely on the derivative to estimate changes to the output (normalized value) that will be produced by changes to the input in the region near any linearisation point.  References    See also   Softplus  Multinomial logistic regression   "  Category:Computational neuroscience  Category:Log-linear models  Category:Artificial neural networks      ↩  ai-faq What is a softmax activation function? ↩  Sutton, R. S. and Barto A. G. Reinforcement Learning: An Introduction . The MIT Press, Cambridge, MA, 1998. Softmax Action Selection ↩  ↩  ↩     
   Invariant factorization of LPDOs      Invariant factorization of LPDOs   Introduction  The factorization of a linear partial differential operator (LPDO) is an important issue in the theory of integrability, due to the Laplace-Darboux transformations, 1 which allow to construct integrable LPDEs. Laplace solved factorization problem for a bivariate hyperbolic operator of the second order (see Hyperbolic partial differential equation ), constructing two Laplace invariants. Each Laplace invariant is an explicit polynomial condition of factorization; coefficients of this polynomial are explicit functions of the coefficients of the initial LPDO. The polynomial conditions of factorization are called invariants because they have the same form for equivalent (i.e. self-adjoint) operators.  Beals-Kartashova-factorization (also called BK-factorization) is a constructive procedure to factorize a bivariate operator of the arbitrary order and arbitrary form . Correspondingly, the factorization conditions in this case also have polynomial form, are invariants and coincide with Laplace invariants for bivariate hyperbolic operator of the second order. The factorization procedure is purely algebraic, the number of possible factirzations depends on the number of simple roots of the Characteristic polynomial (also called symbol) of the initial LPDO and reduced LPDOs appearing at each factorization step. Below the factorization procedure is described for a bivariate operator of the arbitrary form, of the order 2 and 3. Explicit factorization formulas for an operator of the order   n   n   n   can be found in 2 General invariants are defined in 3 and invariant formulation of the Beals-Kartashova factorization is given in 4  Beals-Kartashova Factorization  Operator of order 2  Consider an operator        ğ’œ  2   =     a  20    âˆ‚  x  2    +    a  11     âˆ‚  x    âˆ‚  y     +    a  02    âˆ‚  y  2    +    a  10    âˆ‚  x    +    a  01    âˆ‚  y    +   a  00     .       subscript  ğ’œ  2        subscript  a  20    superscript   subscript   x   2       subscript  a  11     subscript   x    subscript   y        subscript  a  02    superscript   subscript   y   2       subscript  a  10    subscript   x       subscript  a  01    subscript   y     subscript  a  00      \mathcal{A}_{2}=a_{20}\partial_{x}^{2}+a_{11}\partial_{x}\partial_{y}+a_{02}%
 \partial_{y}^{2}+a_{10}\partial_{x}+a_{01}\partial_{y}+a_{00}.     with smooth coefficients and look for a factorization        ğ’œ  2   =    (     p  1    âˆ‚  x    +    p  2    âˆ‚  y    +   p  3    )    (     p  4    âˆ‚  x    +    p  5    âˆ‚  y    +   p  6    )     .       subscript  ğ’œ  2          subscript  p  1    subscript   x       subscript  p  2    subscript   y     subscript  p  3         subscript  p  4    subscript   x       subscript  p  5    subscript   y     subscript  p  6       \mathcal{A}_{2}=(p_{1}\partial_{x}+p_{2}\partial_{y}+p_{3})(p_{4}\partial_{x}+%
 p_{5}\partial_{y}+p_{6}).     Let us write down the equations on    p  i     subscript  p  i    p_{i}   explicitly, keeping in mind the rule of left composition, i.e. that         âˆ‚  x    (   Î±   âˆ‚  y    )    =      âˆ‚  x    (  Î±  )     âˆ‚  y    +   Î±   âˆ‚   x  y       .        subscript   x     Î±   subscript   y           subscript   x   Î±    subscript   y      Î±   subscript     x  y        \partial_{x}(\alpha\partial_{y})=\partial_{x}(\alpha)\partial_{y}+\alpha%
 \partial_{xy}.     Then in all cases        a  20   =    p  1    p  4     ,       subscript  a  20      subscript  p  1    subscript  p  4      a_{20}=p_{1}p_{4},           a  11   =     p  2    p  4    +    p  1    p  5      ,       subscript  a  11        subscript  p  2    subscript  p  4       subscript  p  1    subscript  p  5       a_{11}=p_{2}p_{4}+p_{1}p_{5},           a  02   =    p  2    p  5     ,       subscript  a  02      subscript  p  2    subscript  p  5      a_{02}=p_{2}p_{5},           a  10   =    â„’   (   p  4   )    +    p  3    p  4    +    p  1    p  6      ,       subscript  a  10       â„’   subscript  p  4       subscript  p  3    subscript  p  4       subscript  p  1    subscript  p  6       a_{10}=\mathcal{L}(p_{4})+p_{3}p_{4}+p_{1}p_{6},           a  01   =    â„’   (   p  5   )    +    p  3    p  5    +    p  2    p  6      ,       subscript  a  01       â„’   subscript  p  5       subscript  p  3    subscript  p  5       subscript  p  2    subscript  p  6       a_{01}=\mathcal{L}(p_{5})+p_{3}p_{5}+p_{2}p_{6},           a  00   =    â„’   (   p  6   )    +    p  3    p  6      ,       subscript  a  00       â„’   subscript  p  6       subscript  p  3    subscript  p  6       a_{00}=\mathcal{L}(p_{6})+p_{3}p_{6},     where the notation    â„’  =     p  1    âˆ‚  x    +    p  2    âˆ‚  y         â„’       subscript  p  1    subscript   x       subscript  p  2    subscript   y       \mathcal{L}=p_{1}\partial_{x}+p_{2}\partial_{y}   is used.  Without loss of generality,      a  20   â‰   0   ,       subscript  a  20   0    a_{20}\neq 0,   i.e.      p  1   â‰   0   ,       subscript  p  1   0    p_{1}\neq 0,   and it can be taken as 1,     p  1   =  1.       subscript  p  1   1.    p_{1}=1.   Now solution of the system of 6 equations on the variables       p  2   ,     subscript  p  2    p_{2},      â€¦   normal-â€¦   ...       p  6     subscript  p  6    p_{6}   can be found in three steps .  At the first step , the roots of a quadratic polynomial have to be found.  At the second step , a linear system of two algebraic equations has to be solved.  At the third step , one algebraic condition has to be checked.  Step 1. Variables       p  2   ,     subscript  p  2    p_{2},        p  4   ,     subscript  p  4    p_{4},       p  5     subscript  p  5    p_{5}   can be found from the first three equations,        a  20   =    p  1    p  4     ,       subscript  a  20      subscript  p  1    subscript  p  4      a_{20}=p_{1}p_{4},           a  11   =     p  2    p  4    +    p  1    p  5      ,       subscript  a  11        subscript  p  2    subscript  p  4       subscript  p  1    subscript  p  5       a_{11}=p_{2}p_{4}+p_{1}p_{5},           a  02   =    p  2    p  5     .       subscript  a  02      subscript  p  2    subscript  p  5      a_{02}=p_{2}p_{5}.     The (possible) solutions are then the functions of the roots of a quadratic polynomial:        ğ’«  2    (   -   p  2    )    =     a  20     (   -   p  2    )   2    +    a  11    (   -   p  2    )    +   a  02    =  0           subscript  ğ’«  2      subscript  p  2          subscript  a  20    superscript     subscript  p  2    2       subscript  a  11      subscript  p  2      subscript  a  02         0     \mathcal{P}_{2}(-p_{2})=a_{20}(-p_{2})^{2}+a_{11}(-p_{2})+a_{02}=0     Let   Ï‰   Ï‰   \omega   be a root of the polynomial     ğ’«  2   ,     subscript  ğ’«  2    \mathcal{P}_{2},   then        p  1   =  1   ,       subscript  p  1   1    p_{1}=1,           p  2   =   -  Ï‰    ,       subscript  p  2     Ï‰     p_{2}=-\omega,           p  4   =   a  20    ,       subscript  p  4    subscript  a  20     p_{4}=a_{20},           p  5   =     a  20   Ï‰   +   a  11     ,       subscript  p  5        subscript  a  20   Ï‰    subscript  a  11      p_{5}=a_{20}\omega+a_{11},     Step 2. Substitution of the results obtained at the first step, into the next two equations        a  10   =    â„’   (   p  4   )    +    p  3    p  4    +    p  1    p  6      ,       subscript  a  10       â„’   subscript  p  4       subscript  p  3    subscript  p  4       subscript  p  1    subscript  p  6       a_{10}=\mathcal{L}(p_{4})+p_{3}p_{4}+p_{1}p_{6},           a  01   =    â„’   (   p  5   )    +    p  3    p  5    +    p  2    p  6      ,       subscript  a  01       â„’   subscript  p  5       subscript  p  3    subscript  p  5       subscript  p  2    subscript  p  6       a_{01}=\mathcal{L}(p_{5})+p_{3}p_{5}+p_{2}p_{6},     yields linear system of two algebraic equations:        a  10   =    â„’   a  20    +    p  3    a  20    +   p  6     ,       subscript  a  10       â„’   subscript  a  20       subscript  p  3    subscript  a  20     subscript  p  6      a_{10}=\mathcal{L}a_{20}+p_{3}a_{20}+p_{6},          a  01   =  â„’   (   a  11   +   a  20   Ï‰  )   +   p  3    (   a  11   +   a  20   Ï‰  )   -  Ï‰   p  6   .  ,     fragments   subscript  a  01    L   fragments  normal-(   subscript  a  11     subscript  a  20   Ï‰  normal-)     subscript  p  3    fragments  normal-(   subscript  a  11     subscript  a  20   Ï‰  normal-)    Ï‰   subscript  p  6   normal-.  normal-,    a_{01}=\mathcal{L}(a_{11}+a_{20}\omega)+p_{3}(a_{11}+a_{20}\omega)-\omega p_{6%
 }.,     In particularly , if the root   Ï‰   Ï‰   \omega   is simple, i.e.         ğ’«  2  â€²    (  Ï‰  )    =    2   a  20   Ï‰   +   a  11    â‰   0   ,           superscript   subscript  ğ’«  2   normal-â€²   Ï‰       2   subscript  a  20   Ï‰    subscript  a  11         0     \mathcal{P}_{2}^{\prime}(\omega)=2a_{20}\omega+a_{11}\neq 0,   then these equations have the unique solution:        p  3   =      Ï‰   a  10    +   a  01    -   Ï‰  â„’   a  20    -   â„’   (     a  20   Ï‰   +   a  11    )       2   a  20   Ï‰   +   a  11      ,       subscript  p  3           Ï‰   subscript  a  10     subscript  a  01      Ï‰  â„’   subscript  a  20      â„’       subscript  a  20   Ï‰    subscript  a  11          2   subscript  a  20   Ï‰    subscript  a  11       p_{3}=\frac{\omega a_{10}+a_{01}-\omega\mathcal{L}a_{20}-\mathcal{L}(a_{20}%
 \omega+a_{11})}{2a_{20}\omega+a_{11}},           p  6   =      (     a  20   Ï‰   +   a  11    )    (    a  10   -   â„’   a  20     )    -    a  20    (    a  01   -   â„’   (     a  20   Ï‰   +   a  11    )     )       2   a  20   Ï‰   +   a  11      .       subscript  p  6              subscript  a  20   Ï‰    subscript  a  11       subscript  a  10     â„’   subscript  a  20         subscript  a  20      subscript  a  01     â„’       subscript  a  20   Ï‰    subscript  a  11            2   subscript  a  20   Ï‰    subscript  a  11       p_{6}=\frac{(a_{20}\omega+a_{11})(a_{10}-\mathcal{L}a_{20})-a_{20}(a_{01}-%
 \mathcal{L}(a_{20}\omega+a_{11}))}{2a_{20}\omega+a_{11}}.     At this step, for each root of the polynomial    ğ’«  2     subscript  ğ’«  2    \mathcal{P}_{2}   a corresponding set of coefficients    p  j     subscript  p  j    p_{j}   is computed.  Step 3. Check factorization condition (which is the last of the initial 6 equations)        a  00   =    â„’   (   p  6   )    +    p  3    p  6      ,       subscript  a  00       â„’   subscript  p  6       subscript  p  3    subscript  p  6       a_{00}=\mathcal{L}(p_{6})+p_{3}p_{6},   written in the known variables    p  j     subscript  p  j    p_{j}   and   Ï‰   Ï‰   \omega   ):       a  00   =    â„’   {      Ï‰   a  10    +   a  01    -   â„’   (    2   a  20   Ï‰   +   a  11    )       2   a  20   Ï‰   +   a  11     }    +       Ï‰   a  10    +   a  01    -   â„’   (    2   a  20   Ï‰   +   a  11    )       2   a  20   Ï‰   +   a  11     Ã—      a  20    (    a  01   -   â„’   (     a  20   Ï‰   +   a  11    )     )    +    (     a  20   Ï‰   +   a  11    )    (    a  10   -   â„’   a  20     )       2   a  20   Ï‰   +   a  11            subscript  a  00       â„’           Ï‰   subscript  a  10     subscript  a  01      â„’      2   subscript  a  20   Ï‰    subscript  a  11          2   subscript  a  20   Ï‰    subscript  a  11                 Ï‰   subscript  a  10     subscript  a  01      â„’      2   subscript  a  20   Ï‰    subscript  a  11          2   subscript  a  20   Ï‰    subscript  a  11            subscript  a  20      subscript  a  01     â„’       subscript  a  20   Ï‰    subscript  a  11              subscript  a  20   Ï‰    subscript  a  11       subscript  a  10     â„’   subscript  a  20           2   subscript  a  20   Ï‰    subscript  a  11         a_{00}=\mathcal{L}\left\{\frac{\omega a_{10}+a_{01}-\mathcal{L}(2a_{20}\omega+%
 a_{11})}{2a_{20}\omega+a_{11}}\right\}+\frac{\omega a_{10}+a_{01}-\mathcal{L}(%
 2a_{20}\omega+a_{11})}{2a_{20}\omega+a_{11}}\times\frac{a_{20}(a_{01}-\mathcal%
 {L}(a_{20}\omega+a_{11}))+(a_{20}\omega+a_{11})(a_{10}-\mathcal{L}a_{20})}{2a_%
 {20}\omega+a_{11}}     If        l  2   =     a  00   -   â„’   {      Ï‰   a  10    +   a  01    -   â„’   (    2   a  20   Ï‰   +   a  11    )       2   a  20   Ï‰   +   a  11     }     +       Ï‰   a  10    +   a  01    -   â„’   (    2   a  20   Ï‰   +   a  11    )       2   a  20   Ï‰   +   a  11     Ã—      a  20    (    a  01   -   â„’   (     a  20   Ï‰   +   a  11    )     )    +    (     a  20   Ï‰   +   a  11    )    (    a  10   -   â„’   a  20     )       2   a  20   Ï‰   +   a  11       =  0   ,         subscript  l  2        subscript  a  00     â„’           Ï‰   subscript  a  10     subscript  a  01      â„’      2   subscript  a  20   Ï‰    subscript  a  11          2   subscript  a  20   Ï‰    subscript  a  11                  Ï‰   subscript  a  10     subscript  a  01      â„’      2   subscript  a  20   Ï‰    subscript  a  11          2   subscript  a  20   Ï‰    subscript  a  11            subscript  a  20      subscript  a  01     â„’       subscript  a  20   Ï‰    subscript  a  11              subscript  a  20   Ï‰    subscript  a  11       subscript  a  10     â„’   subscript  a  20           2   subscript  a  20   Ï‰    subscript  a  11            0     l_{2}=a_{00}-\mathcal{L}\left\{\frac{\omega a_{10}+a_{01}-\mathcal{L}(2a_{20}%
 \omega+a_{11})}{2a_{20}\omega+a_{11}}\right\}+\frac{\omega a_{10}+a_{01}-%
 \mathcal{L}(2a_{20}\omega+a_{11})}{2a_{20}\omega+a_{11}}\times\frac{a_{20}(a_{%
 01}-\mathcal{L}(a_{20}\omega+a_{11}))+(a_{20}\omega+a_{11})(a_{10}-\mathcal{L}%
 a_{20})}{2a_{20}\omega+a_{11}}=0,     the operator    ğ’œ  2     subscript  ğ’œ  2    \mathcal{A}_{2}   is factorizable and explicit form for the factorization coefficients    p  j     subscript  p  j    p_{j}   is given above.  Operator of order 3  Consider an operator        ğ’œ  3   =    âˆ‘    j  +  k   â‰¤  3      a   j  k      âˆ‚  x  j    âˆ‚  y  k      =     a  30    âˆ‚  x  3    +    a  21     âˆ‚  x  2    âˆ‚  y     +    a  12     âˆ‚  x    âˆ‚  y  2     +    a  03    âˆ‚  y  3    +    a  20    âˆ‚  x  2    +    a  11     âˆ‚  x    âˆ‚  y     +    a  02    âˆ‚  y  2    +    a  10    âˆ‚  x    +    a  01    âˆ‚  y    +   a  00     .         subscript  ğ’œ  3     subscript       j  k   3       subscript  a    j  k      superscript   subscript   x   j    superscript   subscript   y   k                subscript  a  30    superscript   subscript   x   3       subscript  a  21     superscript   subscript   x   2    subscript   y        subscript  a  12     subscript   x    superscript   subscript   y   2        subscript  a  03    superscript   subscript   y   3       subscript  a  20    superscript   subscript   x   2       subscript  a  11     subscript   x    subscript   y        subscript  a  02    superscript   subscript   y   2       subscript  a  10    subscript   x       subscript  a  01    subscript   y     subscript  a  00       \mathcal{A}_{3}=\sum_{j+k\leq 3}a_{jk}\partial_{x}^{j}\partial_{y}^{k}=a_{30}%
 \partial_{x}^{3}+a_{21}\partial_{x}^{2}\partial_{y}+a_{12}\partial_{x}\partial%
 _{y}^{2}+a_{03}\partial_{y}^{3}+a_{20}\partial_{x}^{2}+a_{11}\partial_{x}%
 \partial_{y}+a_{02}\partial_{y}^{2}+a_{10}\partial_{x}+a_{01}\partial_{y}+a_{0%
 0}.     with smooth coefficients and look for a factorization        ğ’œ  3   =    (     p  1    âˆ‚  x    +    p  2    âˆ‚  y    +   p  3    )    (     p  4    âˆ‚  x  2    +    p  5     âˆ‚  x    âˆ‚  y     +    p  6    âˆ‚  y  2    +    p  7    âˆ‚  x    +    p  8    âˆ‚  y    +   p  9    )     .       subscript  ğ’œ  3          subscript  p  1    subscript   x       subscript  p  2    subscript   y     subscript  p  3         subscript  p  4    superscript   subscript   x   2       subscript  p  5     subscript   x    subscript   y        subscript  p  6    superscript   subscript   y   2       subscript  p  7    subscript   x       subscript  p  8    subscript   y     subscript  p  9       \mathcal{A}_{3}=(p_{1}\partial_{x}+p_{2}\partial_{y}+p_{3})(p_{4}\partial_{x}^%
 {2}+p_{5}\partial_{x}\partial_{y}+p_{6}\partial_{y}^{2}+p_{7}\partial_{x}+p_{8%
 }\partial_{y}+p_{9}).     Similar to the case of the operator     ğ’œ  2   ,     subscript  ğ’œ  2    \mathcal{A}_{2},   the conditions of factorization are described by the following system:        a  30   =    p  1    p  4     ,       subscript  a  30      subscript  p  1    subscript  p  4      a_{30}=p_{1}p_{4},           a  21   =     p  2    p  4    +    p  1    p  5      ,       subscript  a  21        subscript  p  2    subscript  p  4       subscript  p  1    subscript  p  5       a_{21}=p_{2}p_{4}+p_{1}p_{5},           a  12   =     p  2    p  5    +    p  1    p  6      ,       subscript  a  12        subscript  p  2    subscript  p  5       subscript  p  1    subscript  p  6       a_{12}=p_{2}p_{5}+p_{1}p_{6},           a  03   =    p  2    p  6     ,       subscript  a  03      subscript  p  2    subscript  p  6      a_{03}=p_{2}p_{6},           a  20   =    â„’   (   p  4   )    +    p  3    p  4    +    p  1    p  7      ,       subscript  a  20       â„’   subscript  p  4       subscript  p  3    subscript  p  4       subscript  p  1    subscript  p  7       a_{20}=\mathcal{L}(p_{4})+p_{3}p_{4}+p_{1}p_{7},           a  11   =    â„’   (   p  5   )    +    p  3    p  5    +    p  2    p  7    +    p  1    p  8      ,       subscript  a  11       â„’   subscript  p  5       subscript  p  3    subscript  p  5       subscript  p  2    subscript  p  7       subscript  p  1    subscript  p  8       a_{11}=\mathcal{L}(p_{5})+p_{3}p_{5}+p_{2}p_{7}+p_{1}p_{8},           a  02   =    â„’   (   p  6   )    +    p  3    p  6    +    p  2    p  8      ,       subscript  a  02       â„’   subscript  p  6       subscript  p  3    subscript  p  6       subscript  p  2    subscript  p  8       a_{02}=\mathcal{L}(p_{6})+p_{3}p_{6}+p_{2}p_{8},           a  10   =    â„’   (   p  7   )    +    p  3    p  7    +    p  1    p  9      ,       subscript  a  10       â„’   subscript  p  7       subscript  p  3    subscript  p  7       subscript  p  1    subscript  p  9       a_{10}=\mathcal{L}(p_{7})+p_{3}p_{7}+p_{1}p_{9},           a  01   =    â„’   (   p  8   )    +    p  3    p  8    +    p  2    p  9      ,       subscript  a  01       â„’   subscript  p  8       subscript  p  3    subscript  p  8       subscript  p  2    subscript  p  9       a_{01}=\mathcal{L}(p_{8})+p_{3}p_{8}+p_{2}p_{9},           a  00   =    â„’   (   p  9   )    +    p  3    p  9      ,       subscript  a  00       â„’   subscript  p  9       subscript  p  3    subscript  p  9       a_{00}=\mathcal{L}(p_{9})+p_{3}p_{9},   with     â„’  =     p  1    âˆ‚  x    +    p  2    âˆ‚  y      ,      â„’       subscript  p  1    subscript   x       subscript  p  2    subscript   y       \mathcal{L}=p_{1}\partial_{x}+p_{2}\partial_{y},   and again      a  30   â‰   0   ,       subscript  a  30   0    a_{30}\neq 0,   i.e.      p  1   =  1   ,       subscript  p  1   1    p_{1}=1,   and three-step procedure yields:  At the first step , the roots of a cubic polynomial        ğ’«  3    (   -   p  2    )    :=     a  30     (   -   p  2    )   3    +    a  21     (   -   p  2    )   2    +    a  12    (   -   p  2    )    +   a  03    =  0.       assign     subscript  ğ’«  3      subscript  p  2          subscript  a  30    superscript     subscript  p  2    3       subscript  a  21    superscript     subscript  p  2    2       subscript  a  12      subscript  p  2      subscript  a  03         0.     \mathcal{P}_{3}(-p_{2}):=a_{30}(-p_{2})^{3}+a_{21}(-p_{2})^{2}+a_{12}(-p_{2})+%
 a_{03}=0.     have to be found. Again   Ï‰   Ï‰   \omega   denotes a root and first four coefficients are        p  1   =  1   ,       subscript  p  1   1    p_{1}=1,           p  2   =   -  Ï‰    ,       subscript  p  2     Ï‰     p_{2}=-\omega,           p  4   =   a  30    ,       subscript  p  4    subscript  a  30     p_{4}=a_{30},           p  5   =     a  30   Ï‰   +   a  21     ,       subscript  p  5        subscript  a  30   Ï‰    subscript  a  21      p_{5}=a_{30}\omega+a_{21},           p  6   =     a  30    Ï‰  2    +    a  21   Ï‰   +   a  12     .       subscript  p  6        subscript  a  30    superscript  Ï‰  2       subscript  a  21   Ï‰    subscript  a  12      p_{6}=a_{30}\omega^{2}+a_{21}\omega+a_{12}.     At the second step , a linear system of three algebraic equations has to be solved:         a  20   -   â„’   a  30     =     p  3    a  30    +   p  7     ,         subscript  a  20     â„’   subscript  a  30          subscript  p  3    subscript  a  30     subscript  p  7      a_{20}-\mathcal{L}a_{30}=p_{3}a_{30}+p_{7},            a  11   -   â„’   (     a  30   Ï‰   +   a  21    )     =      p  3    (     a  30   Ï‰   +   a  21    )    -   Ï‰   p  7     +   p  8     ,         subscript  a  11     â„’       subscript  a  30   Ï‰    subscript  a  21             subscript  p  3        subscript  a  30   Ï‰    subscript  a  21       Ï‰   subscript  p  7      subscript  p  8      a_{11}-\mathcal{L}(a_{30}\omega+a_{21})=p_{3}(a_{30}\omega+a_{21})-\omega p_{7%
 }+p_{8},            a  02   -   â„’   (     a  30    Ï‰  2    +    a  21   Ï‰   +   a  12    )     =     p  3    (     a  30    Ï‰  2    +    a  21   Ï‰   +   a  12    )    -   Ï‰   p  8      .         subscript  a  02     â„’       subscript  a  30    superscript  Ï‰  2       subscript  a  21   Ï‰    subscript  a  12           subscript  p  3        subscript  a  30    superscript  Ï‰  2       subscript  a  21   Ï‰    subscript  a  12       Ï‰   subscript  p  8       a_{02}-\mathcal{L}(a_{30}\omega^{2}+a_{21}\omega+a_{12})=p_{3}(a_{30}\omega^{2%
 }+a_{21}\omega+a_{12})-\omega p_{8}.     At the third step , two algebraic conditions have to be checked.  Operator of order   n   n   n     Invariant Formulation  Definition The operators   ğ’œ   ğ’œ   \mathcal{A}   ,    ğ’œ  ~     normal-~  ğ’œ    \tilde{\mathcal{A}}   are called equivalent if there is a gauge transformation that takes one to the other:         ğ’œ  ~   g   =    e   -  Ï†    ğ’œ   (    e  Ï†   g   )     .         normal-~  ğ’œ   g      superscript  e    Ï†    ğ’œ     superscript  e  Ï†   g      \tilde{\mathcal{A}}g=e^{-\varphi}\mathcal{A}(e^{\varphi}g).   BK-factorization is then pure algebraic procedure which allows to construct explicitly a factorization of an arbitrary order LPDO    ğ’œ  ~     normal-~  ğ’œ    \tilde{\mathcal{A}}   in the form      ğ’œ  =    âˆ‘    j  +  k   â‰¤  n      a   j  k      âˆ‚  x  j    âˆ‚  y  k      =   â„’  âˆ˜    âˆ‘    j  +  k   â‰¤   (   n  -  1   )       p   j  k      âˆ‚  x  j    âˆ‚  y  k             ğ’œ    subscript       j  k   n       subscript  a    j  k      superscript   subscript   x   j    superscript   subscript   y   k             â„’    subscript       j  k     n  1        subscript  p    j  k      superscript   subscript   x   j    superscript   subscript   y   k          \mathcal{A}=\sum_{j+k\leq n}a_{jk}\partial_{x}^{j}\partial_{y}^{k}=\mathcal{L}%
 \circ\sum_{j+k\leq(n-1)}p_{jk}\partial_{x}^{j}\partial_{y}^{k}   with first-order operator    â„’  =     âˆ‚  x   -   Ï‰   âˆ‚  y     +  p       â„’       subscript   x     Ï‰   subscript   y     p     \mathcal{L}=\partial_{x}-\omega\partial_{y}+p   where   Ï‰   Ï‰   \omega   is an arbitrary simple root of the characteristic polynomial        ğ’«   (  t  )    =    âˆ‘   k  =  0   n     a    n  -  k   ,  k     t   n  -  k       ,    ğ’«   (  Ï‰  )    =  0.      formulae-sequence      ğ’«  t     subscript   superscript   n     k  0       subscript  a     n  k   k     superscript  t    n  k           ğ’«  Ï‰   0.     \mathcal{P}(t)=\sum^{n}_{k=0}a_{n-k,k}t^{n-k},\quad\mathcal{P}(\omega)=0.   Factorization is possible then for each simple root    Ï‰  ~     normal-~  Ï‰    \tilde{\omega}    iff  for    n  =  2  â†’   l  2   =  0  ,     fragments  n   2   normal-â†’   subscript  l  2    0  normal-,    n=2\ \ \rightarrow l_{2}=0,     for    n  =  3  â†’   l  3   =  0  ,   l  31   =  0  ,     fragments  n   3   normal-â†’   subscript  l  3    0  normal-,   subscript  l  31    0  normal-,    n=3\ \ \rightarrow l_{3}=0,l_{31}=0,     for    n  =  4  â†’   l  4   =  0  ,   l  41   =  0  ,   l  42   =  0  ,     fragments  n   4   normal-â†’   subscript  l  4    0  normal-,   subscript  l  41    0  normal-,   subscript  l  42    0  normal-,    n=4\ \ \rightarrow l_{4}=0,l_{41}=0,l_{42}=0,     and so on. All functions     l  2   ,   l  3   ,   l  31   ,   l  4   ,   l  41   ,   l  42   ,  â€¦      subscript  l  2    subscript  l  3    subscript  l  31    subscript  l  4    subscript  l  41    subscript  l  42   normal-â€¦    l_{2},l_{3},l_{31},l_{4},l_{41},\ \ l_{42},...   are known functions, for instance,        l  2   =     a  00   -   â„’   (   p  6   )     +    p  3    p  6      ,       subscript  l  2        subscript  a  00     â„’   subscript  p  6        subscript  p  3    subscript  p  6       l_{2}=a_{00}-\mathcal{L}(p_{6})+p_{3}p_{6},           l  3   =     a  00   -   â„’   (   p  9   )     +    p  3    p  9      ,       subscript  l  3        subscript  a  00     â„’   subscript  p  9        subscript  p  3    subscript  p  9       l_{3}=a_{00}-\mathcal{L}(p_{9})+p_{3}p_{9},           l  31   =     a  01   -   â„’   (   p  8   )     +    p  3    p  8    +    p  2    p  9      ,       subscript  l  31        subscript  a  01     â„’   subscript  p  8        subscript  p  3    subscript  p  8       subscript  p  2    subscript  p  9       l_{31}=a_{01}-\mathcal{L}(p_{8})+p_{3}p_{8}+p_{2}p_{9},     and so on.  Theorem All functions         l  2   =     a  00   -   â„’   (   p  6   )     +    p  3    p  6      ,    l  3   =      a  00   -   â„’   (   p  9   )     +    p  3    p  9     ,   l  31   ,  â€¦     .     formulae-sequence     subscript  l  2        subscript  a  00     â„’   subscript  p  6        subscript  p  3    subscript  p  6         subscript  l  3         subscript  a  00     â„’   subscript  p  9        subscript  p  3    subscript  p  9      subscript  l  31   normal-â€¦      l_{2}=a_{00}-\mathcal{L}(p_{6})+p_{3}p_{6},l_{3}=a_{00}-\mathcal{L}(p_{9})+p_{%
 3}p_{9},l_{31},....   are invariants under gauge transformations.  Definition Invariants     l  2   =   a  00   -  â„’   (   p  6   )   +   p  3    p  6   ,   l  3   =   a  00   -  â„’   (   p  9   )   +   p  3    p  9   ,   l  31   ,  â€¦  .  .     fragments   subscript  l  2     subscript  a  00    L   fragments  normal-(   subscript  p  6   normal-)     subscript  p  3    subscript  p  6   normal-,   subscript  l  3     subscript  a  00    L   fragments  normal-(   subscript  p  9   normal-)     subscript  p  3    subscript  p  9   normal-,   subscript  l  31   normal-,  normal-â€¦  normal-.  normal-.    l_{2}=a_{00}-\mathcal{L}(p_{6})+p_{3}p_{6},l_{3}=a_{00}-\mathcal{L}(p_{9})+p_{%
 3}p_{9},l_{31},.....   are called generalized invariants of a bivariate operator of arbitrary order.  In particular case of the bivariate hyperbolic operator its generalized invariants coincide with Laplace invariants (see Laplace invariant ).  Corollary If an operator    ğ’œ  ~     normal-~  ğ’œ    \tilde{\mathcal{A}}   is factorizable, then all operators equivalent to it, are also factorizable.  Equivalent operators are easy to compute:          e   -  Ï†      âˆ‚  x    e  Ï†     =    âˆ‚  x   +   Ï†  x     ,     e   -  Ï†      âˆ‚  y    e  Ï†     =    âˆ‚  y   +   Ï†  y      ,     formulae-sequence       superscript  e    Ï†      subscript   x    superscript  e  Ï†        subscript   x    subscript  Ï†  x          superscript  e    Ï†      subscript   y    superscript  e  Ï†        subscript   y    subscript  Ï†  y       e^{-\varphi}\partial_{x}e^{\varphi}=\partial_{x}+\varphi_{x},\quad e^{-\varphi%
 }\partial_{y}e^{\varphi}=\partial_{y}+\varphi_{y},           e   -  Ï†       âˆ‚  x    âˆ‚  y     e  Ï†     =    e   -  Ï†      âˆ‚  x     e  Ï†    e   -  Ï†        âˆ‚  y    e  Ï†     =    (    âˆ‚  x   +   Ï†  x    )   âˆ˜   (    âˆ‚  y   +   Ï†  y    )             superscript  e    Ï†       subscript   x    subscript   y     superscript  e  Ï†        superscript  e    Ï†      subscript   x      superscript  e  Ï†    superscript  e    Ï†        subscript   y    superscript  e  Ï†               subscript   x    subscript  Ï†  x       subscript   y    subscript  Ï†  y        e^{-\varphi}\partial_{x}\partial_{y}e^{\varphi}=e^{-\varphi}\partial_{x}e^{%
 \varphi}e^{-\varphi}\partial_{y}e^{\varphi}=(\partial_{x}+\varphi_{x})\circ(%
 \partial_{y}+\varphi_{y})   and so on. Some example are given below:         A  1   =     âˆ‚  x    âˆ‚  y    +   x   âˆ‚  x    +  1   =    âˆ‚  x    (    âˆ‚  y   +  x   )     ,     l  2    (   A  1   )    =   1  -  1  -  0   =  0    ;     formulae-sequence       subscript  A  1       subscript   x    subscript   y      x   subscript   x    1          subscript   x      subscript   y   x             subscript  l  2    subscript  A  1      1  1  0        0      A_{1}=\partial_{x}\partial_{y}+x\partial_{x}+1=\partial_{x}(\partial_{y}+x),%
 \quad l_{2}(A_{1})=1-1-0=0;            A  2   =     âˆ‚  x    âˆ‚  y    +   x   âˆ‚  x    +   âˆ‚  y   +  x  +  1    ,     A  2   =    e   -  x     A  1    e  x     ;     l  2    (   A  2   )    =    (   x  +  1   )   -  1  -  x   =  0     ;     formulae-sequence     subscript  A  2       subscript   x    subscript   y      x   subscript   x     subscript   y   x  1     formulae-sequence     subscript  A  2      superscript  e    x     subscript  A  1    superscript  e  x            subscript  l  2    subscript  A  2        x  1   1  x        0       A_{2}=\partial_{x}\partial_{y}+x\partial_{x}+\partial_{y}+x+1,\quad A_{2}=e^{-%
 x}A_{1}e^{x};\quad l_{2}(A_{2})=(x+1)-1-x=0;            A  3   =     âˆ‚  x    âˆ‚  y    +   2  x   âˆ‚  x    +    (   y  +  1   )    âˆ‚  y    +   2   (    x  y   +  x  +  1   )      ,     A  3   =    e   -   x  y      A  2    e   x  y      ;     l  2    (   A  3   )    =    2   (   x  +  1  +   x  y    )    -  2  -   2  x   (   y  +  1   )     =  0     ;     formulae-sequence     subscript  A  3       subscript   x    subscript   y      2  x   subscript   x        y  1    subscript   y      2      x  y   x  1       formulae-sequence     subscript  A  3      superscript  e      x  y      subscript  A  2    superscript  e    x  y             subscript  l  2    subscript  A  3        2    x  1    x  y     2    2  x    y  1          0       A_{3}=\partial_{x}\partial_{y}+2x\partial_{x}+(y+1)\partial_{y}+2(xy+x+1),%
 \quad A_{3}=e^{-xy}A_{2}e^{xy};\quad l_{2}(A_{3})=2(x+1+xy)-2-2x(y+1)=0;           A  4   =     âˆ‚  x    âˆ‚  y    +   x   âˆ‚  x    +    (    cos  x   +  1   )    âˆ‚  y    +   x   cos  x    +  x  +  1    ,     A  4   =    e   -   sin  x      A  2    e   sin  x      ;     l  2    (   A  4   )    =  0.       formulae-sequence     subscript  A  4       subscript   x    subscript   y      x   subscript   x          x   1    subscript   y      x    x    x  1     formulae-sequence     subscript  A  4      superscript  e      x      subscript  A  2    superscript  e    x           subscript  l  2    subscript  A  4    0.      A_{4}=\partial_{x}\partial_{y}+x\partial_{x}+(\cos x+1)\partial_{y}+x\cos x+x+%
 1,\quad A_{4}=e^{-\sin x}A_{2}e^{\sin x};\quad l_{2}(A_{4})=0.     Transpose  Factorization of an operator is the first step on the way of solving corresponding equation. But for solution we need right factors and BK-factorization constructs left factors which are easy to construct. On the other hand, the existence of a certain right factor of a LPDO is equivalent to the existence of a corresponding left factor of the transpose of that operator.  Definition The transpose    ğ’œ  t     superscript  ğ’œ  t    \mathcal{A}^{t}   of an operator      ğ’œ  =   âˆ‘    a  Î±    âˆ‚  Î±      ,    âˆ‚  Î±   =     âˆ‚  1   Î±  1    â‹¯    âˆ‚  n   Î±  n       .     formulae-sequence    ğ’œ       subscript  a  Î±    superscript   Î±         superscript   Î±       superscript   subscript   1    subscript  Î±  1    normal-â‹¯    superscript   subscript   n    subscript  Î±  n        \mathcal{A}=\sum a_{\alpha}\partial^{\alpha},\qquad\partial^{\alpha}=\partial_%
 {1}^{\alpha_{1}}\cdots\partial_{n}^{\alpha_{n}}.   is defined as       ğ’œ  t   u   =   âˆ‘     (   -  1   )    |  Î±  |      âˆ‚  Î±    (    a  Î±   u   )       .         superscript  ğ’œ  t   u        superscript    1     Î±      superscript   Î±      subscript  a  Î±   u        \mathcal{A}^{t}u=\sum(-1)^{|\alpha|}\partial^{\alpha}(a_{\alpha}u).   and the identity      âˆ‚  Î³    (   u  v   )    =    âˆ‘    (      Î³      Î±      )     âˆ‚  Î±   u     ,    âˆ‚   Î³  -  Î±    v          superscript   Î³     u  v          binomial  Î³  Î±     superscript   Î±   u       superscript     Î³  Î±    v      \partial^{\gamma}(uv)=\sum{\left({{\gamma}\atop{\alpha}}\right)}\partial^{%
 \alpha}u,\partial^{\gamma-\alpha}v   implies that      ğ’œ  t   =   âˆ‘     (   -  1   )    |   Î±  +  Î²   |     (       Î±  +  Î²       Î±      )    (    âˆ‚  Î²    a   Î±  +  Î²     )    âˆ‚  Î±      .       superscript  ğ’œ  t        superscript    1       Î±  Î²      binomial    Î±  Î²   Î±     superscript   Î²    subscript  a    Î±  Î²      superscript   Î±       \mathcal{A}^{t}=\sum(-1)^{|\alpha+\beta|}{\left({{\alpha+\beta}\atop{\alpha}}%
 \right)}(\partial^{\beta}a_{\alpha+\beta})\partial^{\alpha}.     Now the coefficients are        ğ’œ  t   =   âˆ‘     a  ~   Î±    âˆ‚  Î±      ,       superscript  ğ’œ  t        subscript   normal-~  a   Î±    superscript   Î±       \mathcal{A}^{t}=\sum\tilde{a}_{\alpha}\partial^{\alpha},          a  ~   Î±   =   âˆ‘     (   -  1   )    |   Î±  +  Î²   |     (       Î±  +  Î²       Î±      )     âˆ‚  Î²    (   a   Î±  +  Î²    )       .       subscript   normal-~  a   Î±        superscript    1       Î±  Î²      binomial    Î±  Î²   Î±     superscript   Î²    subscript  a    Î±  Î²         \tilde{a}_{\alpha}=\sum(-1)^{|\alpha+\beta|}{\left({{\alpha+\beta}\atop{\alpha%
 }}\right)}\partial^{\beta}(a_{\alpha+\beta}).     with a standard convention for binomial coefficients in several variables (see Binomial coefficient ), e.g. in two variables        (     Î±      Î²     )   =   (      (   Î±  1   ,   Î±  2   )        (   Î²  1   ,   Î²  2   )      )   =     (      Î±  1        Î²  1      )     (      Î±  2        Î²  2      )     .         binomial  Î±  Î²    binomial    subscript  Î±  1    subscript  Î±  2      subscript  Î²  1    subscript  Î²  2             binomial   subscript  Î±  1    subscript  Î²  1     binomial   subscript  Î±  2    subscript  Î²  2        {\left({{\alpha}\atop{\beta}}\right)}={\left({{(\alpha_{1},\alpha_{2})}\atop{(%
 \beta_{1},\beta_{2})}}\right)}={\left({{\alpha_{1}}\atop{\beta_{1}}}\right)}\,%
 {\left({{\alpha_{2}}\atop{\beta_{2}}}\right)}.   In particular, for the operator    ğ’œ  2     subscript  ğ’œ  2    \mathcal{A}_{2}   the coefficients are        a  ~    j  k    =   a   j  k     ,     j  +  k   =  2   ;      a  ~   10   =    -   a  10    +   2    âˆ‚  x    a  20     +    âˆ‚  y    a  11      ,     a  ~   01   =    -   a  01    +    âˆ‚  x    a  11    +   2    âˆ‚  y    a  02          ,     formulae-sequence     subscript   normal-~  a     j  k     subscript  a    j  k      formulae-sequence      j  k   2    formulae-sequence     subscript   normal-~  a   10        subscript  a  10      2    subscript   x    subscript  a  20       subscript   y    subscript  a  11         subscript   normal-~  a   01        subscript  a  01      subscript   x    subscript  a  11      2    subscript   y    subscript  a  02           \tilde{a}_{jk}=a_{jk},\quad j+k=2;\tilde{a}_{10}=-a_{10}+2\partial_{x}a_{20}+%
 \partial_{y}a_{11},\tilde{a}_{01}=-a_{01}+\partial_{x}a_{11}+2\partial_{y}a_{0%
 2},            a  ~   00   =     a  00   -    âˆ‚  x    a  10    -    âˆ‚  y    a  01     +    âˆ‚  x  2    a  20    +     âˆ‚  x    âˆ‚  x     a  11    +    âˆ‚  y  2    a  02      .       subscript   normal-~  a   00        subscript  a  00     subscript   x    subscript  a  10      subscript   y    subscript  a  01       superscript   subscript   x   2    subscript  a  20       subscript   x    subscript   x     subscript  a  11      superscript   subscript   y   2    subscript  a  02       \tilde{a}_{00}=a_{00}-\partial_{x}a_{10}-\partial_{y}a_{01}+\partial_{x}^{2}a_%
 {20}+\partial_{x}\partial_{x}a_{11}+\partial_{y}^{2}a_{02}.   For instance, the operator         âˆ‚   x  x    -   âˆ‚   y  y     +   y   âˆ‚  x    +   x   âˆ‚  y    +    1  4    (    y  2   -   x  2    )     -  1           subscript     x  x     subscript     y  y       y   subscript   x      x   subscript   y        1  4      superscript  y  2    superscript  x  2      1    \partial_{xx}-\partial_{yy}+y\partial_{x}+x\partial_{y}+\frac{1}{4}(y^{2}-x^{2%
 })-1   is factorizable as       [    âˆ‚  x   +   âˆ‚  y   +     1  2     (   y  -  x   )     ]    [  â€¦  ]        delimited-[]     subscript   x    subscript   y       1  2     y  x       delimited-[]  normal-â€¦     \big[\partial_{x}+\partial_{y}+\tfrac{1}{2}(y-x)\big]\,\big[...\big]   and its transpose    ğ’œ  1  t     superscript   subscript  ğ’œ  1   t    \mathcal{A}_{1}^{t}   is factorizable then as      [  â€¦  ]    [     âˆ‚  x   -   âˆ‚  y    +    1  2    (   y  +  x   )     ]    .       delimited-[]  normal-â€¦    delimited-[]       subscript   x    subscript   y        1  2     y  x        \big[...\big]\,\big[\partial_{x}-\partial_{y}+\tfrac{1}{2}(y+x)\big].     See also   Partial derivative  Invariant (mathematics)  Invariant theory  Characteristic polynomial   Notes    References   J. Weiss. BÃ¤cklund transformation and the PainlevÃ© property. 1 J. Math. Phys. 27 , 1293-1305 (1986).  R. Beals, E. Kartashova. Constructively factoring linear partial differential operators in two variables. Theor. Math. Phys. 145 (2), pp. 1510-1523 (2005)  E. Kartashova. A Hierarchy of Generalized Invariants for Linear Partial Differential Operators. Theor. Math. Phys. 147 (3), pp. 839-846 (2006)  E. Kartashova, O. Rudenko. Invariant Form of BK-factorization and its Applications. Proc. GIFT-2006, pp.225-241, Eds.: J. Calmet, R. W. Tucker, Karlsruhe University Press (2006); arXiv   "  Category:Multivariable calculus  Category:Differential operators  Category:Partial differential equations     Weiss (1986) â†©  R. Beals, E. Kartashova. Constructively factoring linear partial differential operators in two variables. Theor. Math. Phys. 145 (2), pp. 1510-1523 (2005) â†©  E. Kartashova. A Hierarchy of Generalized Invariants for Linear Partial Differential Operators. Theor. Math. Phys. 147 (3), pp. 839-846 (2006) â†©  E. Kartashova, O. Rudenko. Invariant Form of BK-factorization and its Applications. Proc. GIFT-2006, pp.225-241, Eds.: J. Calmet, R. W. Tucker, Karlsruhe University Press (2006); arXiv â†©     
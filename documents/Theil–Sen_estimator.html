<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1232">Theil–Sen estimator</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Theil–Sen estimator</h1>
<hr/>

<p> In <a href="non-parametric_statistics" title="wikilink">non-parametric statistics</a>, there is a method for <a href="robust_estimator" title="wikilink">robust</a> <a href="linear_regression" title="wikilink">linear regression</a> that chooses the <a class="uri" href="median" title="wikilink">median</a> <a class="uri" href="slope" title="wikilink">slope</a> among all lines through pairs of two-dimensional sample points. It has been called <strong>Theil–Sen estimator</strong>, <strong>Sen's slope estimator</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> <strong>slope selection</strong>,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> the <strong>single median method</strong>,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> <strong>Kendall robust line-fit method</strong>,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> and <strong>Kendall–Theil robust line</strong><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> It is named after <a href="Henri_Theil" title="wikilink">Henri Theil</a> and <a href="Pranab_K._Sen" title="wikilink">Pranab K. Sen</a>, who published papers on this method in 1950 and 1968 respectively. It can be computed efficiently, and is insensitive to <a href="outlier" title="wikilink">outliers</a>; it can be significantly more accurate than <a href="simple_linear_regression" title="wikilink">simple linear regression</a> for <a href="Skewness" title="wikilink">skewed</a> and <a class="uri" href="heteroskedastic" title="wikilink">heteroskedastic</a> data, and competes well against non-robust least squares even for normally distributed data in terms of <a href="statistical_power" title="wikilink">statistical power</a>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> It has been called "the most popular nonparametric technique for estimating a linear trend".<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h2 id="definition">Definition</h2>

<p>As defined by , the Theil–Sen estimator of a set of two-dimensional points <mtpl></mtpl> is the median 

<math display="inline" id="Theil–Sen_estimator:0">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 of the slopes <mtpl></mtpl> determined by all pairs of sample points.  extended this definition to handle the case in which two data points have the same 

<math display="inline" id="Theil–Sen_estimator:1">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

-coordinate. In Sen's definition, one takes the median of the slopes defined only from pairs of points having distinct 

<math display="inline" id="Theil–Sen_estimator:2">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

-coordinates.</p>

<p>Once the slope 

<math display="inline" id="Theil–Sen_estimator:3">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 has been determined, one may determine a line through the sample points by setting the 

<math display="inline" id="Theil–Sen_estimator:4">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

-intercept 

<math display="inline" id="Theil–Sen_estimator:5">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 to be the median of the values <mtpl></mtpl>.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> As Sen observed, this estimator is the value that makes the <a href="Kendall_tau_rank_correlation_coefficient" title="wikilink">Kendall tau rank correlation coefficient</a> comparing the values of <mtpl></mtpl> with the residual for the <em>i</em>-th observation become approximately zero.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>A <a href="confidence_interval" title="wikilink">confidence interval</a> for the slope estimate may be determined as the interval containing the middle 95% of the slopes of lines determined by pairs of points,<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> and may be estimated quickly by sampling pairs of points and determining the 95% interval of the sampled slopes. According to simulations, approximately 600 sample pairs are sufficient to determine an accurate confidence interval.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="variations">Variations</h2>

<p>A variation of the Theil–Sen estimator due to  determines, for each sample point <mtpl></mtpl>, the median <mtpl></mtpl> of the slopes <mtpl></mtpl> of lines through that point, and then determines the overall estimator as the median of these medians.</p>

<p>A different variant pairs up sample points by the rank of their 

<math display="inline" id="Theil–Sen_estimator:6">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

-coordinates (the point with the smallest coordinate being paired with the first point above the median coordinate, etc.) and computes the median of the slopes of the lines determined by these pairs of points.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>Variations of the Theil–Sen estimator based on <a href="weighted_median" title="wikilink">weighted medians</a> have also been studied, based on the principle that pairs of samples whose 

<math display="inline" id="Theil–Sen_estimator:7">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

-coordinates differ more greatly are more likely to have an accurate slope and therefore should receive a higher weight.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>For seasonal data, it may be appropriate to smooth out seasonal variations in the data by considering only pairs of sample points that both belong to the same month or the same season of the year, and finding the median of the slopes of the lines determined by this more restrictive set of pairs.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>
<h2 id="statistical-properties">Statistical properties</h2>

<p>The Theil–Sen estimator is an <a href="unbiased_estimator" title="wikilink">unbiased estimator</a> of the true slope in <a href="simple_linear_regression" title="wikilink">simple linear regression</a>.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> For many distributions of the response error, this estimator has high <a href="Efficiency_(statistics)" title="wikilink">asymptotic efficiency</a> relative to <a href="least_squares" title="wikilink">least-squares</a> estimation.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> Estimators with low efficiency require more independent observations to attain the same sample variance of efficient unbiased estimators.</p>

<p>The Theil–Sen estimator is more <a href="robust_statistics" title="wikilink">robust</a> than the least-squares estimator because it is much less sensitive to <a href="outlier" title="wikilink">outliers</a>: It has a <a href="breakdown_point" title="wikilink">breakdown point</a> of 

<math display="inline" id="Theil–Sen_estimator:8">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac>
     <mn>1</mn>
     <msqrt>
      <mn>2</mn>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mn>29.3</mn>
    <mo lspace="0pt" rspace="3.5pt">%</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">percent</csymbol>
     <cn type="float">29.3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\frac{1}{\sqrt{2}}\approx 29.3\%
  </annotation>
 </semantics>
</math>

, meaning that it can tolerate arbitrary corruption of up to 29.3% of the input data-points without degradation of its accuracy.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> However, the breakdown point decreases for higher-dimensional generalizations of the method.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> A higher breakdown point, 50%, holds for the repeated median estimator of Siegel.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>

<p>The Theil–Sen estimator is <a class="uri" href="equivariant" title="wikilink">equivariant</a> under every <a href="linear_transformation" title="wikilink">linear transformation</a> of its response variable,<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> but is not equivariant under affine transformations of both the predictor and response variables.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>
<h2 id="algorithms">Algorithms</h2>

<p>The median slope of a set of 

<math display="inline" id="Theil–Sen_estimator:9">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 sample points may be computed exactly by computing all <mtpl></mtpl> lines through pairs of points, and then applying a linear time <a href="Selection_algorithm" title="wikilink">median finding algorithm</a>, or it may be estimated by sampling pairs of points. It is equivalent, under <a href="projective_duality" title="wikilink">projective duality</a>, to the problem of finding the crossing point in an <a href="arrangement_of_lines" title="wikilink">arrangement of lines</a> that has the median 

<math display="inline" id="Theil–Sen_estimator:10">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

-coordinate among all such crossing points.</p>

<p>The problem of performing slope selection exactly but more efficiently than the brute force quadratic time algorithm has been extensively studied in <a href="computational_geometry" title="wikilink">computational geometry</a>. Several different methods are known for computing the Theil–Sen estimator exactly in 

<math display="inline" id="Theil–Sen_estimator:11">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mi>l</mi>
     <mi>o</mi>
     <mi>g</mi>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>l</ci>
     <ci>o</ci>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(nlogn)
  </annotation>
 </semantics>
</math>

 time, either deterministically<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> or using <a href="randomized_algorithm" title="wikilink">randomized algorithms</a>.<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> Siegel's repeated median estimator can also be constructed efficiently in the same time bound.<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> In models of computation in which the input coordinates are integers and bitwise operations on integers take constant time, the problem can be solved even more quickly, in randomized expected time 

<math display="inline" id="Theil–Sen_estimator:12">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <msqrt>
      <mrow>
       <mi>log</mi>
       <mi>n</mi>
      </mrow>
     </msqrt>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <root></root>
      <apply>
       <log></log>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(n\sqrt{\log n})
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a></p>

<p>An estimator for the slope with approximately median rank, having the same breakdown point as the Theil–Sen estimator, may be maintained in the <a href="streaming_algorithm" title="wikilink">data stream model</a> (in which the sample points are processed one by one by an algorithm that does not have enough persistent storage to represent the entire data set) using an algorithm based on <a href="ε-net_(computational_geometry)" title="wikilink">ε-nets</a>.<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a></p>
<h2 id="applications">Applications</h2>

<p>Theil–Sen estimation has been applied to <a class="uri" href="astronomy" title="wikilink">astronomy</a> due to its ability to handle <a href="censored_regression_model" title="wikilink">censored regression models</a>.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> In <a class="uri" href="biophysics" title="wikilink">biophysics</a>,  suggest its use for remote sensing applications such as the estimation of leaf area from reflectance data due to its "simplicity in computation, analytical estimates of confidence intervals, robustness to outliers, testable assumptions regarding residuals and ... limited a priori information regarding measurement errors". For measuring seasonal environmental data such as <a href="water_quality" title="wikilink">water quality</a>, a seasonally adjusted variant of the Theil–Sen estimator has been proposed as preferable to least squares estimation due to its high precision in the presence of skewed data.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a> In <a href="computer_science" title="wikilink">computer science</a>, the Theil–Sen method has been used to estimate trends in <a href="software_aging" title="wikilink">software aging</a>.<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> Another application of the Theil-Sen test is in meteorology and climatology. <a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a> The test is used to estimate the long-term trends of wind speed and occurrence.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Regression_dilution" title="wikilink">Regression dilution</a>, for another problem affecting estimated trend slopes</li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://pubs.usgs.gov/tm/2006/tm4a7/">Kendall-Theil Robust Line (KTRLine—version 1.0)</a> public-domain <a href="Visual_Basic" title="wikilink">Visual Basic</a> software for Theil–Sen estimation published by the <a href="United_States_Geological_Survey" title="wikilink">United States Geological Survey</a></li>
</ul>

<p>"</p>

<p><a href="Category:Robust_regression" title="wikilink">Category:Robust regression</a> <a href="Category:Computational_geometry" title="wikilink">Category:Computational geometry</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">.<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5">.<a href="#fnref5">↩</a></li>
<li id="fn6">; .<a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9">.<a href="#fnref9">↩</a></li>
<li id="fn10"></li>
<li id="fn11">.<a href="#fnref11">↩</a></li>
<li id="fn12">For determining confidence intervals, pairs of points must be sampled <a href="Sampling_(statistics)#Replacement_of_selected_units" title="wikilink">with replacement</a>; this means that the set of pairs used in this calculation includes pairs in which both points are the same as each other. These pairs are always outside the confidence interval, because they do not determine a well-defined slope value, but using them as part of the calculation causes the confidence interval to be wider than it would be without them.<a href="#fnref12">↩</a></li>
<li id="fn13">.<a href="#fnref13">↩</a></li>
<li id="fn14">.<a href="#fnref14">↩</a></li>
<li id="fn15">; ; ; .<a href="#fnref15">↩</a></li>
<li id="fn16">.<a href="#fnref16">↩</a></li>
<li id="fn17">, Theorem 5.1, p. 1384; .<a href="#fnref17">↩</a></li>
<li id="fn18">, Section 6; .<a href="#fnref18">↩</a></li>
<li id="fn19">, pp. 67, 164.<a href="#fnref19">↩</a></li>
<li id="fn20"></li>
<li id="fn21"></li>
<li id="fn22">, p. 1383.<a href="#fnref22">↩</a></li>
<li id="fn23">.<a href="#fnref23">↩</a></li>
<li id="fn24">; ; .<a href="#fnref24">↩</a></li>
<li id="fn25">; ; .<a href="#fnref25">↩</a></li>
<li id="fn26">.<a href="#fnref26">↩</a></li>
<li id="fn27">.<a href="#fnref27">↩</a></li>
<li id="fn28">.<a href="#fnref28">↩</a></li>
<li id="fn29">.<a href="#fnref29">↩</a></li>
<li id="fn30"></li>
<li id="fn31">.<a href="#fnref31">↩</a></li>
<li id="fn32">Romanić D. Ćurić M- Jovičić I. Lompar M. 2015. Long-term trends of the ‘Koshava’ wind during the period 1949–2010. International Journal of Climatology 35(2):288-302. <a class="uri" href="DOI:10.1002/joc.3981">DOI:10.1002/joc.3981</a>.<a href="#fnref32">↩</a></li>
</ol>
</section>
</body>
</html>

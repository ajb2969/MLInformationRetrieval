<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="247">ANOVA–simultaneous component analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>ANOVA–simultaneous component analysis</h1>
<hr/>

<p><strong>Analysis of variance – simultaneous component analysis</strong> (<strong>ASCA</strong> or <strong>ANOVA–SCA</strong>) is a method that partitions <a href="variance" title="wikilink">variation</a> and enables interpretation of these partitions by SCA, a method that is similar to <a href="principal_components_analysis" title="wikilink">principal components analysis (PCA)</a>. This method is a <a href="Multivariate_statistics" title="wikilink">multivariate</a> or even megavariate extension of <a href="ANOVA" title="wikilink">analysis of variance (ANOVA)</a>. The variation partitioning is similar to ANOVA. Each partition matches all variation induced by an effect or <a href="Factorial_experiment" title="wikilink">factor</a>, usually a treatment regime or experimental condition. The calculated effect partitions are called effect estimates. Because even the effect estimates are multivariate, interpretation of these effects estimates is not intuitive. By applying SCA on the effect estimates one gets a simple interpretable result.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In case of more than one effect this method estimates the effects in such a way that the different effects are not correlated.</p>
<h2 id="details">Details</h2>

<p>Many research areas see increasingly large numbers of <a href="variable_(mathematics)#Applied_statistics" title="wikilink">variables</a> in only few <a href="sample_(statistics)" title="wikilink">samples</a>. The low sample to variable ratio creates problems known as <a class="uri" href="multicollinearity" title="wikilink">multicollinearity</a> and <a href="singularity_(statistics)" title="wikilink">singularity</a>. Because of this, most traditional multivariate statistical methods cannot be applied.</p>
<h2 id="asca-algorithm">ASCA algorithm</h2>

<p>This section details how to calculate the ASCA model on a case of two main effects with one interaction effect. It is easy to extend the declared rationale to more main effects and more interaction effects. If the first effect is time and the second effect is dosage, only the interaction between time and dosage exist. We assume there are four time points and three dosage levels.</p>

<p>Let X be a <a href="matrix_(mathematics)" title="wikilink">matrix</a> that holds the data. X is mean centered, thus having <a href="centering_matrix#Properties" title="wikilink">zero mean columns</a>. Let A and B denote the main effects and AB the interaction of these effects. Two main effects in a biological experiment can be time (A) and pH (B), and these two effects may interact. In designing such experiments one controls the main effects to several (at least two) levels. The different levels of an effect can be referred to as A1, A2, A3 and A4, representing 2, 3, 4, 5 hours from the start of the experiment. The same thing holds for effect B, for example, pH 6, pH 7 and pH 8 can be considered effect levels.</p>

<p>A and B are required to be balanced if the effect estimates need to be orthogonal and the partitioning unique. Matrix E holds the information that is not assigned to any effect. The partitioning gives the following notation:</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:0">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mo>+</mo>
    <mi>B</mi>
    <mo>+</mo>
    <mrow>
     <mi>A</mi>
     <mi>B</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>E</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <plus></plus>
     <ci>A</ci>
     <ci>B</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=A+B+AB+E\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="calculating-main-effect-estimate-a-or-b">Calculating main effect estimate A (or B)</h2>

<p>Find all rows that correspond to effect A level 1 and averages these rows. The result is a <a href="vector_space" title="wikilink">vector</a>. Repeat this for the other effect levels. Make a new matrix of the same size of X and place the calculated averages in the matching rows. That is, give all rows that match effect (i.e.) A level 1 the average of effect A level 1. After completing the level estimates for the effect, perform an SCA. The scores of this SCA are the sample deviations for the effect, the important variables of this effect are in the weights of the SCA loading vector.</p>
<h2 id="calculating-interaction-effect-estimate-ab">Calculating interaction effect estimate AB</h2>

<p>Estimating the interaction effect is similar to estimating main effects. The difference is that for interaction estimates the rows that match effect A level 1 are combined with the effect B level 1 and all combinations of effects and levels are cycled through. In our example setting, with four time point and three dosage levels there are 12 interaction sets {A1-B1, A1B2, A2B1, A2B2 and so on}. It is important to deflate (remove) the main effects before estimating the interaction effect.</p>
<h2 id="sca-on-partitions-a-b-and-ab">SCA on partitions A, B and AB</h2>

<p>Simultaneous component analysis is mathematically identical to PCA, but is semantically different in that it models different objects or subjects at the same time. The standard notation for a SCA – and PCA – model is:</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:1">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>T</mi>
     <msup>
      <mi>P</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msup>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>E</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>T</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=TP^{{}^{\prime}}+E\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>X</em> is the data, <em>T</em> are the component scores and <em>P</em> are the component loadings. <em>E</em> is the <a href="Errors_and_residuals_in_statistics" title="wikilink">residual or error</a> matrix. Because ASCA models the variation partitions by SCA, the model for effect estimates looks like this:</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:2">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>a</mi>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mi>a</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>E</mi>
      <mi>a</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=T_{a}P_{a}^{{}^{\prime}}+E_{a}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:3">
 <semantics>
  <mrow>
   <mi>B</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>b</mi>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mi>b</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>E</mi>
      <mi>b</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>B</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=T_{b}P_{b}^{{}^{\prime}}+E_{b}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mi>B</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>E</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   AB=T_{ab}P_{ab}^{{}^{\prime}}+E_{ab}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:5">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>e</mi>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mi>e</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>E</mi>
      <mi>e</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>e</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>e</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>e</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=T_{e}P_{e}^{{}^{\prime}}+E_{e}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Note that every partition has its own error matrix. However, algebra dictates that in a balanced mean centered data set every two level system is of <a href="Rank_(linear_algebra)" title="wikilink">rank</a> 1. This results in zero errors, since any rank 1 matrix can be written as the product of a single component score and loading vector.</p>

<p>The full ASCA model with two effects and interaction including the SCA looks like this:</p>

<p>Decomposition:</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:6">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mo>+</mo>
    <mi>B</mi>
    <mo>+</mo>
    <mrow>
     <mi>A</mi>
     <mi>B</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>E</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <plus></plus>
     <ci>A</ci>
     <ci>B</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=A+B+AB+E\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="ANOVA–simultaneous_component_analysis:7">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>a</mi>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mi>a</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>b</mi>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mi>b</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>T</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>T</mi>
      <mi>e</mi>
     </msub>
     <msubsup>
      <mi>P</mi>
      <mi>e</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>E</mi>
     <mi>a</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>E</mi>
     <mi>b</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>E</mi>
     <mrow>
      <mi>a</mi>
      <mi>b</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>E</mi>
     <mi>e</mi>
    </msub>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>E</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>e</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>e</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>e</ci>
     </apply>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=T_{a}P_{a}^{{}^{\prime}}+T_{b}P_{b}^{{}^{\prime}}+T_{ab}P_{ab}^{{}^{\prime}}%
+T_{e}P_{e}^{{}^{\prime}}+E_{a}+E_{b}+E_{ab}+E_{e}+E\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="time-as-an-effect">Time as an effect</h2>

<p>Because 'time' is treated as a qualitative factor in the ANOVA decomposition preceding ASCA, a nonlinear multivariate time trajectory can be modeled. An example of this is shown in Figure 10 of this reference.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Analysis_of_variance" title="wikilink">Category:Analysis of variance</a> <a class="uri" href="Category:Bioinformatics" title="wikilink">Category:Bioinformatics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Smilde, Age K.; Jansen, Jeroen J.; Hoefsloot, Huub C. J.; Lamers, Robert-Jan A. N.; van der Greef, Jan; Timmerman, Marieke E. (2005) "ANOVA-simultaneous component analysis (ASCA): a new tool for analyzing designed metabolomics data", <em>Bioinformatics</em>, 21 (13), 3043-3048. <a href="#fnref1">↩</a></li>
<li id="fn2">Jansen, J. J.; Hoefsloot, H. C. J.; van der Greef, J.; Timmerman, M. E.; Westerhuis, J. A.;Smilde, A. K. (2005) "ASCA: analysis of multivariate data obtained from an experimental design". <em>Journal of Chemometrics</em>, 19: 469–481. <a href="#fnref2">↩</a></li>
<li id="fn3">Daniel J Vis , Johan A Westerhuis , Age K Smilde: Jan van der Greef (2007) "Statistical validation of megavariate effects in ASCA", ''BMC Bioinformatics" , 8:322 <a href="#fnref3">↩</a></li>
<li id="fn4">Smilde, A. K., Hoefsloot, H. C. and Westerhuis, J. A. (2008), "The geometry of ASCA". <em>Journal of Chemometrics</em>, 22, 464–471. <a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

   Draft:Knockoff filter      Draft:Knockoff filter     In statistics, Knockoff Filter 1 is a feature selection (variable selection) procedure proposed by Rina Foygel Barber and Emmanuel Cand√®s which control the False Discovery Rate for a linear regression model in classical setting (When there is at least many observations as variables ).  Method Set Up  For linear regression model:      ùê≤  =    ùêó  Œ≤   +  ùê≥       ùê≤      ùêó  Œ≤   ùê≥     \mathbf{y}=\mathbf{X}\beta+\mathbf{z}   ,  where    ùê≤  ‚àà   ‚Ñù  n       ùê≤   superscript  ‚Ñù  n     \mathbf{y}\in\mathbb{R}^{n}   is the response,    ùêó  ‚àà   ‚Ñù   n  √ó  p        ùêó   superscript  ‚Ñù    n  p      \mathbf{X}\in\mathbb{R}^{n\times p}   is the design matrix. We have an unknown coefficients vector    Œ≤  ‚àà   ‚Ñù  p       Œ≤   superscript  ‚Ñù  p     \mathbf{\beta}\in\mathbb{R}^{p}   as well as Gaussian noise    z  ‚àº   ùí©   (  0  ,    œÉ  2   ùêà   )       similar-to  z    ùí©   0     superscript  œÉ  2   ùêà       z\sim\mathcal{N}(0,\sigma^{2}\mathbf{I})   .  The False Discovery Rate in linear regression is defined as follow:  If there is a variable selection method gives you a indices set     S  ^   ‚äÇ   {  1  ,  ‚ãØ  ,  p  }        normal-^  S    1  normal-‚ãØ  p     \hat{S}\subset\{1,\cdots,p\}   , then      FDR  =   ùîº   [     #   {  j  :    Œ≤  j   =   0  but  j   ‚àà   S  ^    }     #   {  j  :   j  ‚àà    S  ^   ‚à®  1    }      ]        FDR    ùîº   delimited-[]      normal-#   conditional-set  j       subscript  Œ≤  j     0  but  j         normal-^  S         normal-#   conditional-set  j    j     normal-^  S   1           \text{FDR}=\mathbb{E}\left[\dfrac{\#\{j:\beta_{j}=0\text{ but }j\in\hat{S}\}}{%
 \#\{j:j\in\hat{S}\vee 1\}}\right]   ,  where the notation     x  ‚à®  y   :=   max   {  x  ,  y  }       assign    x  y     x  y     x\vee y:=\max\{x,y\}   . The FDR is said to be controlled at level   q   q   q   means that FDR     ‚â§  q      absent  q    \leq q   for all coefficient   Œ≤   Œ≤   \beta   .  To set up "Knockoff Filter", first normalize the design matrix    X   X   X   , and calculate the Gram matrix     ùö∫  =    ùêó  ùêì   ùêó       ùö∫     superscript  ùêó  ùêì   ùêó     \mathbf{\Sigma=X^{T}X}   . Then construct a knock off     ùêó  ~   j     subscript   normal-~  ùêó   j    \mathbf{\tilde{X}}_{j}   for each column of design matrix     X  j     subscript  X  j    X_{j}   such that         ùêó  ~   T    ùêó  ~    =  ùö∫         superscript   normal-~  ùêó   T    normal-~  ùêó    ùö∫    \mathbf{\tilde{X}}^{T}\mathbf{\tilde{X}}=\mathbf{\Sigma}   and      ùêó  T    ùêó  ~    =   ùö∫  -   diag   {  ùê¨  }            superscript  ùêó  T    normal-~  ùêó      ùö∫    diag   ùê¨       \mathbf{X}^{T}\mathbf{\tilde{X}}=\mathbf{\Sigma}-\text{diag}\{\mathbf{s}\}     where   s   s   s   is a nonnegative vector. Thus    ùêó  ~     normal-~  ùêó    \mathbf{\tilde{X}}   exhibits the same covariance structure as the original design matrix    X   X   X   and also        ùêó  j  T     ùêó  ~   k    =    ùêó  j  T    ùêó  k           superscript   subscript  ùêó  j   T    subscript   normal-~  ùêó   k       superscript   subscript  ùêó  j   T    subscript  ùêó  k      \mathbf{X}_{j}^{T}\mathbf{\tilde{X}}_{k}=\mathbf{X}_{j}^{T}\mathbf{X}_{k}   for all     ‚â†  k      absent  k    \neq k         ùêó  j  T     ùêó  ~   j    =    Œ£   j  j    -   s  j    =   1  -   s  j             superscript   subscript  ùêó  j   T    subscript   normal-~  ùêó   j       subscript  normal-Œ£    j  j     subscript  s  j           1   subscript  s  j       \mathbf{X}_{j}^{T}\mathbf{\tilde{X}}_{j}=\Sigma_{jj}-s_{j}=1-s_{j}     Then Construct the augmented matrix     ùêÄ  :=   [  ùêó   ùêó  ~   ]      assign  ùêÄ   ùêó   normal-~  ùêó      \mathbf{A}:=[\mathbf{X}\quad\mathbf{\tilde{X}}]   . Use the LASSO model        Œ≤  ^    (  Œª  )    =   arg    min  Œ≤    {     1  2     ‚à•   ùê≤  -   ùêÄ  Œ≤    ‚à•   2  2    +   Œª    ‚à•  Œ≤  ‚à•   1     }            normal-^  Œ≤   Œª     arg    subscript   Œ≤         1  2    superscript   subscript   norm    ùê≤    ùêÄ  Œ≤     2   2      Œª   subscript   norm  Œ≤   1         \hat{\beta}(\lambda)=\text{arg}\min_{\beta}\left\{\frac{1}{2}\|\mathbf{y}-%
 \mathbf{A}\mathbf{\beta}\|_{2}^{2}+\lambda\|\beta\|_{1}\right\}     to this augmented matrix to select the feature. Define statistics     Z  j   =   sup   {  Œª  :      Œ≤  ^   j    (  Œª  )    ‚â†  0   }         subscript  Z  j    supremum   conditional-set  Œª       subscript   normal-^  Œ≤   j   Œª   0       Z_{j}=\sup\left\{\lambda:\hat{\beta}_{j}(\lambda)\neq 0\right\}   . Then the Lasso model gives a    2  p      2  p    2p   -dimension statistics    (   Z  1   ,  ‚ãØ  ,   Z  p   ,    Z  ~   1   ,  ‚ãØ  ,    Z  ~   p   )      subscript  Z  1   normal-‚ãØ   subscript  Z  p    subscript   normal-~  Z   1   normal-‚ãØ   subscript   normal-~  Z   p     (Z_{1},\cdots,Z_{p},\tilde{Z}_{1},\cdots,\tilde{Z}_{p})   .  Define the statistics    W  j     subscript  W  j    W_{j}   for each variable:       W  j   =    Z  j   ‚à®     Z  ~   j   ‚ãÖ   {        +  1    if   Z  j     >    Z  ~   j            -  1    if   Z  j     <    Z  ~   j           =   {        Z  j    if   Z  j     >    Z  ~   j            -    Z  ~   j     if   Z  j     <    Z  ~   j                subscript  W  j      subscript  Z  j    normal-‚ãÖ   subscript   normal-~  Z   j    cases       1     if   subscript  Z  j      subscript   normal-~  Z   j    otherwise       1     if   subscript  Z  j      subscript   normal-~  Z   j    otherwise           cases      subscript  Z  j     if   subscript  Z  j      subscript   normal-~  Z   j    otherwise        subscript   normal-~  Z   j      if   subscript  Z  j      subscript   normal-~  Z   j    otherwise      W_{j}=Z_{j}\vee\tilde{Z}_{j}\cdot\begin{cases}+1\quad\text{if }Z_{j}>\tilde{Z}%
 _{j}\\
 -1\quad\text{if }Z_{j}<\tilde{Z}_{j}\end{cases}=\begin{cases}Z_{j}\qquad\text{%
 if }Z_{j}>\tilde{Z}_{j}\\
 -\tilde{Z}_{j}\quad\text{if }Z_{j}<\tilde{Z}_{j}\end{cases}     then define a threshold      T  =   min   {    t  ‚àà  ùí≤   :     #   {  j  :    W  j   ‚â§   -  t    }      #   {  j  :    W  j   ‚â•  t   }    ‚à®  1    ‚â§  q    }        T     normal-:    t  ùí≤         normal-#   conditional-set  j     subscript  W  j     t          normal-#   conditional-set  j     subscript  W  j   t     1    q       T=\min\left\{t\in\mathcal{W}:\frac{\#\{j:W_{j}\leq-t\}}{\#\{j:W_{j}\geq t\}%
 \vee 1}\leq q\right\}     The select the model    S  ^     normal-^  S    \hat{S}   as       S  ^   =   {  j  :    W  j   >  T   }        normal-^  S    conditional-set  j     subscript  W  j   T      \hat{S}=\{j:W_{j}>T\}     Advantages of Knockoff  It is proved by Rina Foygel Barber and Emmanuel Cand√®s that for any    q  ‚àà   (  0  ,  1  ]       q   0  1     q\in(0,1]   , the knockoff method defined above satisfies:       ùîº   [     #   {  j  :    Œ≤  j   =   0  but  j   ‚àà   S  ^    }     #   {  j  :   j  ‚àà    S  ^   ‚à®  1    }      ]    ‚â§  q        ùîº   delimited-[]      normal-#   conditional-set  j       subscript  Œ≤  j     0  but  j         normal-^  S         normal-#   conditional-set  j    j     normal-^  S   1         q    \mathbb{E}\left[\dfrac{\#\{j:\beta_{j}=0\text{ but }j\in\hat{S}\}}{\#\{j:j\in%
 \hat{S}\vee 1\}}\right]\leq q     Which means that the False Discovery Rate is well controlled.  References   Rina Foygel Barber and Emmanuel Cand√®s , "Controlling the False Discovery Rate via Knockoffs", submitted to arXiv, 21 Apr 2015.  Benjamini, Y; Hochberg, Y (1995). "Controlling the false discovery rate: a practical and powerful approach to multiple testing" (PDF). Journal of the Royal Statistical Society, Series B 57 (1): 289‚Äì300. MR 1325392.  Benjamini, Y. (2010). "Discovering the false discovery rate". Journal of the Royal Statistical Society: Series B (Statistical Methodology) 72 (4): 405‚Äì416. doi:10.1111/j.1467-9868.2010.00746.x .  Benjamini, Y; Yekutieli, D (2001). "The control of the false discovery rate in multiple testing under dependency" (PDF). Annals of Statistics 29 (4): 1165‚Äì1188. doi:10.1214/aos/1013699998 . MR 1869245"      Rina Foygel Barber and Emmanuel Cand√®s , "Controlling the False Discovery Rate via Knockoffs", submitted to arXiv, 21 Apr 2015] ‚Ü©     
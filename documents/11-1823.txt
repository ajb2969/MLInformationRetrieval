   Constellation model      Constellation model   The constellation model is a probabilistic, generative model for category-level object recognition in computer vision . Like other part-based models , the constellation model attempts to represent an object class by a set of N parts under mutual geometric constraints. Because it considers the geometric relationship between different parts, the constellation model differs significantly from appearance-only, or " bag-of-words " representation models, which explicitly disregard the location of image features.  The problem of defining a generative model for object recognition is difficult. The task becomes significantly complicated by factors such as background clutter, occlusion, and variations in viewpoint, illumination, and scale. Ideally, we would like the particular representation we choose to be robust to as many of these factors as possible.  In category-level recognition, the problem is even more challenging because of the fundamental problem of intra-class variation. Even if two objects belong to the same visual category, their appearances may be significantly different. However, for structured objects such as cars, bicycles, and people, separate instances of objects from the same category are subject to similar geometric constraints. For this reason, particular parts of an object such as the headlights or tires of a car still have consistent appearances and relative positions. The Constellation Model takes advantage of this fact by explicitly modeling the relative location, relative scale, and appearance of these parts for a particular object category. Model parameters are estimated using an unsupervised learning algorithm, meaning that the visual concept of an object class can be extracted from an unlabeled set of training images, even if that set contains "junk" images or instances of objects from multiple categories. It can also account for the absence of model parts due to appearance variability, occlusion, clutter, or detector error.  History  The idea for a "parts and structure" model was originally introduced by Fischler and Elschlager in 1973. 1 This model has since been built upon and extended in many directions. The Constellation Model, as introduced by Dr. Perona and his colleagues, was a probabilistic adaptation of this approach.  In the late '90s, Burl et al. 2 3 4 5 revisited the Fischler and Elschlager model for the purpose of face recognition. In their work, Burl et al. used manual selection of constellation parts in training images to construct a statistical model for a set of detectors and the relative locations at which they should be applied. In 2000, Weber et al. 6 7 8 9 made the significant step of training the model using a more unsupervised learning process, which precluded the necessity for tedious hand-labeling of parts. Their algorithm was particularly remarkable because it performed well even on cluttered and occluded image data. Fergus et al. 10 11 then improved upon this model by making the learning step fully unsupervised, having both shape and appearance learned simultaneously, and accounting explicitly for the relative scale of parts.  The method of Weber and Welling et al. 12  In the first step, a standard interest point detection method, such as Harris corner detection , is used to generate interest points. Image features generated from the vicinity of these points are then clustered using k-means or another appropriate algorithm. In this process of vector quantization , one can think of the centroids of these clusters as being representative of the appearance of distinctive object parts. Appropriate feature detectors are then trained using these clusters, which can be used to obtain a set of candidate parts from images.  As a result of this process, each image can now be represented as a set of parts. Each part has a type, corresponding to one of the aforementioned appearance clusters, as well as a location in the image space.  Basic generative model  Weber & Welling here introduce the concept of foreground and background . Foreground parts correspond to an instance of a target object class, whereas background parts correspond to background clutter or false detections.  Let T be the number of different types of parts. The positions of all parts extracted from an image can then be represented in the following "matrix,"       X  o   =   (       x  11   ,   x  12   ,  ⋯  ,   x   1   N  1            x  21   ,   x  22   ,  ⋯  ,   x   2   N  2          ⋮        x   T  1    ,   x   T  2    ,  ⋯  ,   x   T   N  T         )        superscript  X  o       subscript  x  11    subscript  x  12   normal-⋯   subscript  x    1   subscript  N  1          subscript  x  21    subscript  x  22   normal-⋯   subscript  x    2   subscript  N  2        normal-⋮      subscript  x    T  1     subscript  x    T  2    normal-⋯   subscript  x    T   subscript  N  T          X^{o}=\begin{pmatrix}x_{11},x_{12},{\cdots},x_{1N_{1}}\\
 x_{21},x_{22},{\cdots},x_{2N_{2}}\\
 \vdots\\
 x_{T1},x_{T2},{\cdots},x_{TN_{T}}\end{pmatrix}     where     N  i      subscript  N  i    N_{i}\,   represents the number of parts of type    i  ∈   {  1  ,  …  ,  T  }       i   1  normal-…  T     i\in\{1,\dots,T\}   observed in the image. The superscript o indicates that these positions are observable , as opposed to missing . The positions of unobserved object parts can be represented by the vector     x  m      superscript  x  m    x^{m}\,   . Suppose that the object will be composed of    F    F   F\,   distinct foreground parts. For notational simplicity, we assume here that    F  =   T       F  T    F=T\,   , though the model can be generalized to    F  >   T       F  T    F>T\,   . A hypothesis     h    h   h\,   is then defined as a set of indices, with     h  i   =   j        subscript  h  i   j    h_{i}=j\,   , indicating that point     x   i  j       subscript  x    i  j     x_{ij}\,   is a foreground point in     X  o      superscript  X  o    X^{o}\,   . The generative probabilistic model is defined through the joint probability density    p   (   X  o   ,   x  m   ,  h  )       p    superscript  X  o    superscript  x  m   h     p(X^{o},x^{m},h)\,   .  Model details  The rest of this section summarizes the details of Weber & Welling's model for a single component model. The formulas for multiple component models 13 are extensions of those described here.  To parametrize the joint probability density, Weber & Welling introduce the auxiliary variables    b    b   b\,   and    n    n   n\,   , where    b    b   b\,   is a binary vector encoding the presence/absence of parts in detection (     b  i   =   1        subscript  b  i   1    b_{i}=1\,   if     h  i   >   0        subscript  h  i   0    h_{i}>0\,   , otherwise     b  i   =   0        subscript  b  i   0    b_{i}=0\,   ), and    n    n   n\,   is a vector where     n  i      subscript  n  i    n_{i}\,   denotes the number of background candidates included in the    i   t  h      superscript  i    t  h     i^{th}   row of     X  o      superscript  X  o    X^{o}\,   . Since    b    b   b\,   and    n    n   n\,   are completely determined by    h    h   h\,   and the size of     X  o      superscript  X  o    X^{o}\,   , we have     p   (   X  o   ,   x  m   ,  h  )    =   p   (   X  o   ,   x  m   ,  h  ,  n  ,  b  )          p    superscript  X  o    superscript  x  m   h      p    superscript  X  o    superscript  x  m   h  n  b      p(X^{o},x^{m},h)=p(X^{o},x^{m},h,n,b)\,   . By decomposition,      p   (   X  o   ,   x  m   ,  h  ,  n  ,  b  )   =  p   (   X  o   ,   x  m   |  h  ,  n  ,  b  )   p   (  h  |  n  ,  b  )   p   (  n  )   p   (  b  )      fragments  p   fragments  normal-(   superscript  X  o   normal-,   superscript  x  m   normal-,  h  normal-,  n  normal-,  b  normal-)    p   fragments  normal-(   superscript  X  o   normal-,   superscript  x  m   normal-|  h  normal-,  n  normal-,  b  normal-)   p   fragments  normal-(  h  normal-|  n  normal-,  b  normal-)   p   fragments  normal-(  n  normal-)   p   fragments  normal-(  b  normal-)     p(X^{o},x^{m},h,n,b)=p(X^{o},x^{m}|h,n,b)p(h|n,b)p(n)p(b)\,     The probability density over the number of background detections can be modeled by a Poisson distribution ,       p   (  n  )    =    ∏   i  =  1   T     1    n  i   !      (   M  i   )    n  i     e   -   M  i             p  n     superscript   subscript  product    i  1    T       1     subscript  n  i      superscript   subscript  M  i    subscript  n  i     superscript  e     subscript  M  i         p(n)=\prod_{i=1}^{T}\frac{1}{n_{i}!}(M_{i})^{n_{i}}e^{-M_{i}}     where     M  i      subscript  M  i    M_{i}\,   is the average number of background detections of type    i    i   i\,   per image.  Depending on the number of parts    F    F   F\,   , the probability    p   (  b  )       p  b    p(b)\,   can be modeled either as an explicit table of length     2  F      superscript  2  F    2^{F}\,   , or, if    F    F   F\,   is large, as    F    F   F\,   independent probabilities, each governing the presence of an individual part.  The density    p   (  h  |  n  ,  b  )      fragments  p   fragments  normal-(  h  normal-|  n  normal-,  b  normal-)     p(h|n,b)\,   is modeled by      p   (  h  |  n  ,  b  )   =   {        1     ∏   f  =  1   F     N  f   b  f       ,       if  h   ∈   H   (  b  ,  n  )          0  ,      for other  h          fragments  p   fragments  normal-(  h  normal-|  n  normal-,  b  normal-)     cases    1    superscript   subscript  product    f  1    F    superscript   subscript  N  f    subscript  b  f          if  h     H   b  n     0    for other  h      p(h|n,b)=\par
 \begin{cases}\frac{1}{\textstyle\prod_{f=1}^{F}N_{f}^{b_{f}}},&%
 \mbox{if }h\in H(b,n)\\
 0,&\mbox{for other }h\end{cases}     where    H   (  b  ,  n  )       H   b  n     H(b,n)\,   denotes the set of all hypotheses consistent with    b    b   b\,   and    n    n   n\,   , and     N  f      subscript  N  f    N_{f}\,   denotes the total number of detections of parts of type    f    f   f\,   . This expresses the fact that all consistent hypotheses, of which there are     ∏   f  =  1   F    N  f   b  f        superscript   subscript  product    f  1    F    superscript   subscript  N  f    subscript  b  f      \textstyle\prod_{f=1}^{F}N_{f}^{b_{f}}   , are equally likely in the absence of information on part locations.  And finally,      p   (   X  o   ,   x  m   |  h  ,  n  )   =   p   f  g     (  z  )    p   b  g     (   x   b  g    )      fragments  p   fragments  normal-(   superscript  X  o   normal-,   superscript  x  m   normal-|  h  normal-,  n  normal-)     subscript  p    f  g     fragments  normal-(  z  normal-)    subscript  p    b  g     fragments  normal-(   subscript  x    b  g    normal-)     p(X^{o},x^{m}|h,n)=p_{fg}(z)p_{bg}(x_{bg})\,     where    z  =   (    x  o    x  m    )       z     superscript  x  o    superscript  x  m      z=(x^{o}x^{m})\,   are the coordinates of all foreground detections, observed and missing, and     x   b  g       subscript  x    b  g     x_{bg}\,   represents the coordinates of the background detections. Note that foreground detections are assumed to be independent of the background.     p   f  g     (  z  )        subscript  p    f  g    z    p_{fg}(z)\,   is modeled as a joint Gaussian with mean    μ    μ   \mu\,   and covariance    Σ    normal-Σ   \Sigma\,   .  Classification  The ultimate objective of this model is to classify images into classes "object present" (class     C  1      subscript  C  1    C_{1}\,   ) and "object absent" (class     C  0      subscript  C  0    C_{0}\,   ) given the observation     X  o      superscript  X  o    X^{o}\,   . To accomplish this, Weber & Welling run part detectors from the learning step exhaustively over the image, examining different combinations of detections. If occlusion is considered, then combinations with missing detections are also permitted. The goal is then to select the class with maximum a posteriori probability, by considering the ratio        p   (   C  1   |   X  o   )     p   (   C  0   |   X  o   )     ∝     ∑  h   p   (   X  o   ,  h  |   C  1   )     p   (   X  o   ,   h  0   |   C  0   )        proportional-to     fragments  p   fragments  normal-(   subscript  C  1   normal-|   superscript  X  o   normal-)     fragments  p   fragments  normal-(   subscript  C  0   normal-|   superscript  X  o   normal-)        fragments   subscript   h   p   fragments  normal-(   superscript  X  o   normal-,  h  normal-|   subscript  C  1   normal-)     fragments  p   fragments  normal-(   superscript  X  o   normal-,   subscript  h  0   normal-|   subscript  C  0   normal-)       \frac{p(C_{1}|X^{o})}{p(C_{0}|X^{o})}\propto\frac{\sum_{h}p(X^{o},h|C_{1})}{p(%
 X^{o},h_{0}|C_{0})}     where     h  0      subscript  h  0    h_{0}\,   denotes the null hypothesis, which explains all parts as background noise. In the numerator, the sum includes all hypotheses, including the null hypothesis, whereas in the denominator, the only hypothesis consistent with the absence of an object is the null hypothesis. In practice, some threshold can be defined such that, if the ratio exceeds that threshold, we then consider an instance of an object to be detected.  Model learning  After the preliminary step of interest point detection, feature generation and clustering, we have a large set of candidate parts over the training images. To learn the model, Weber & Welling first perform a greedy search over possible model configurations, or equivalently, over potential subsets of the candidate parts. This is done in an iterative fashion, starting with random selection. At subsequent iterations, parts in the model are randomly substituted, the model parameters are estimated, and the performance is assessed. The process is complete when further model performance improvements are no longer possible.  At each iteration, the model parameters      Θ  =   {  μ  ,  Σ  ,   p   (  b  )    ,  M  }       normal-Θ   μ  normal-Σ    p  b   M     \Theta=\{\mu,\Sigma,p(b),M\}\,     are estimated using expectation maximization .    μ    μ   \mu\,   and    Σ    normal-Σ   \Sigma\,   , we recall, are the mean and covariance of the joint Gaussian     p   f  g     (  z  )        subscript  p    f  g    z    p_{fg}(z)\,   ,    p   (  b  )       p  b    p(b)\,   is the probability distribution governing the binary presence/absence of parts, and    M    M   M\,   is the mean number of background detections over part types.  M-step  EM proceeds by maximizing the likelihood of the observed data,      L   (   X  o   |  Θ  )   =   ∑   i  =  1   I   log   ∑   h  i    ∫  p   (   X  i  o   ,   x  i  m   ,   h  i   |  Θ  )   d   x  i  m      fragments  L   fragments  normal-(   superscript  X  o   normal-|  Θ  normal-)     superscript   subscript     i  1    I     subscript    subscript  h  i     p   fragments  normal-(   superscript   subscript  X  i   o   normal-,   superscript   subscript  x  i   m   normal-,   subscript  h  i   normal-|  Θ  normal-)   d   superscript   subscript  x  i   m     L(X^{o}|\Theta)=\sum_{i=1}^{I}\log\sum_{h_{i}}\int p(X_{i}^{o},x_{i}^{m},h_{i}%
 |\Theta)dx_{i}^{m}     with respect to the model parameters    Θ    normal-Θ   \Theta\,   . Since this is difficult to achieve analytically, EM iteratively maximizes a sequence of cost functions,      Q   (   Θ  ~   |  Θ  )   =   ∑   i  =  1   I   E   [  log  p   (   X  i  o   ,   x  i  m   ,   h  i   |   Θ  ~   )   ]      fragments  Q   fragments  normal-(   normal-~  normal-Θ   normal-|  Θ  normal-)     superscript   subscript     i  1    I   E   fragments  normal-[   p   fragments  normal-(   superscript   subscript  X  i   o   normal-,   superscript   subscript  x  i   m   normal-,   subscript  h  i   normal-|   normal-~  normal-Θ   normal-)   normal-]     Q(\tilde{\Theta}|\Theta)=\sum_{i=1}^{I}E[\log p(X_{i}^{o},x_{i}^{m},h_{i}|%
 \tilde{\Theta})]     Taking the derivative of this with respect to the parameters and equating to zero produces the update rules:       μ  ~   =    1  I     ∑   i  =  1   I    E   [   z  i   ]           normal-~  μ       1  I     superscript   subscript     i  1    I     E   delimited-[]   subscript  z  i         \tilde{\mu}=\frac{1}{I}\sum_{i=1}^{I}E[z_{i}]          Σ  ~   =     1  I     ∑   i  =  1   I    E   [    z  i    z  i  T    ]      -    μ  ~     μ  ~   T          normal-~  normal-Σ         1  I     superscript   subscript     i  1    I     E   delimited-[]     subscript  z  i    superscript   subscript  z  i   T           normal-~  μ    superscript   normal-~  μ   T       \tilde{\Sigma}=\frac{1}{I}\sum_{i=1}^{I}E[z_{i}z_{i}^{T}]-\tilde{\mu}\tilde{%
 \mu}^{T}           p  ~    (   b  ¯   )    =    1  I     ∑   i  =  1   I    E   [   δ   b  ,   b  ¯     ]             normal-~  p    normal-¯  b        1  I     superscript   subscript     i  1    I     E   delimited-[]   subscript  δ   b   normal-¯  b           \tilde{p}(\bar{b})=\frac{1}{I}\sum_{i=1}^{I}E[\delta_{b,\bar{b}}]          M  ~   =    1  I     ∑   i  =  1   I    E   [   n  i   ]           normal-~  M       1  I     superscript   subscript     i  1    I     E   delimited-[]   subscript  n  i         \tilde{M}=\frac{1}{I}\sum_{i=1}^{I}E[n_{i}]     E-step  The update rules in the M-step are expressed in terms of sufficient statistics ,    E   [  z  ]       E   delimited-[]  z     E[z]\,   ,    E   [   z   z  T    ]       E   delimited-[]    z   superscript  z  T       E[zz^{T}]\,   ,    E   [   δ   b  ,   b  ¯     ]       E   delimited-[]   subscript  δ   b   normal-¯  b        E[\delta_{b,\bar{b}}]\,   and    E   [  n  ]       E   delimited-[]  n     E[n]\,   , which are calculated in the E-step by considering the posterior density:      p   (   h  i   ,   x  i  m   |   X  i  o   ,  Θ  )   =    p   (   h  i   ,   x  i  m   ,   X  i  o   |  Θ  )      ∑    h  i   ∈   H  b     ∫  p   (   h  i   ,   x  i  m   ,   X  i  o   |  Θ  )   d   x  i  m        fragments  p   fragments  normal-(   subscript  h  i   normal-,   superscript   subscript  x  i   m   normal-|   superscript   subscript  X  i   o   normal-,  Θ  normal-)       fragments  p   fragments  normal-(   subscript  h  i   normal-,   superscript   subscript  x  i   m   normal-,   superscript   subscript  X  i   o   normal-|  Θ  normal-)     fragments   subscript      subscript  h  i    subscript  H  b      p   fragments  normal-(   subscript  h  i   normal-,   superscript   subscript  x  i   m   normal-,   superscript   subscript  X  i   o   normal-|  Θ  normal-)   d   superscript   subscript  x  i   m       p(h_{i},x_{i}^{m}|X_{i}^{o},\Theta)=\frac{p(h_{i},x_{i}^{m},X_{i}^{o}|\Theta)}%
 {\textstyle\sum_{h_{i}\in H_{b}}\int p(h_{i},x_{i}^{m},X_{i}^{o}|\Theta)dx_{i}%
 ^{m}}     The method of Fergus et al. 14  In Weber et al., shape and appearance models are constructed separately. Once the set of candidate parts had been selected, shape is learned independently of appearance. The innovation of Fergus et al. is to learn not only two, but three model parameters simultaneously: shape, appearance, and relative scale. Each of these parameters are represented by Gaussian densities.  Feature representation  Whereas the preliminary step in the Weber et al. method is to search for the locations of interest points, Fergus et al. use the detector of Kadir and Brady 15 to find salient regions in the image over both location (center) and scale (radius). Thus, in addition to location information    X    X   X\,   this method also extracts associated scale information    S    S   S\,   . Fergus et al. then normalize the squares bounding these circular regions to 11 x 11 pixel patches, or equivalently, 121-dimensional vectors in the appearance space. These are then reduced to 10-15 dimensions by principal component analysis , giving the appearance information    A    A   A\,   .  Model structure  Given a particular object class model with parameters    Θ    normal-Θ   \Theta\,   , we must decide whether or not a new image contains an instance of that class. This is accomplished by making a Bayesian decision,      R  =    p   (  Object  |  X  ,  S  ,  A  )     p   (  No object  |  X  ,  S  ,  A  )         R     fragments  p   fragments  normal-(  Object  normal-|  X  normal-,  S  normal-,  A  normal-)     fragments  p   fragments  normal-(  No object  normal-|  X  normal-,  S  normal-,  A  normal-)       R=\frac{p(\mbox{Object}|X,S,A)}{p(\mbox{No object}|X,S,A)}          =    p   (  X  ,  S  ,  A  |  Object  )   p   (  Object  )     p   (  X  ,  S  ,  A  |  No object  )   p   (  No object  )         absent     fragments  p   fragments  normal-(  X  normal-,  S  normal-,  A  normal-|  Object  normal-)   p   fragments  normal-(  Object  normal-)     fragments  p   fragments  normal-(  X  normal-,  S  normal-,  A  normal-|  No object  normal-)   p   fragments  normal-(  No object  normal-)       =\frac{p(X,S,A|\mbox{Object})p(\mbox{Object})}{p(X,S,A|\mbox{No object})p(%
 \mbox{No object})}          ≈    p   (  X  ,  S  ,  A  |  Θ  )   p   (  Object  )     p   (  X  ,  S  ,  A  |   Θ   b  g    )   p   (  No object  )         absent     fragments  p   fragments  normal-(  X  normal-,  S  normal-,  A  normal-|  Θ  normal-)   p   fragments  normal-(  Object  normal-)     fragments  p   fragments  normal-(  X  normal-,  S  normal-,  A  normal-|   subscript  normal-Θ    b  g    normal-)   p   fragments  normal-(  No object  normal-)       \approx\frac{p(X,S,A|\Theta)p(\mbox{Object})}{p(X,S,A|\Theta_{bg})p(\mbox{No %
 object})}     where    Θ   b  g      subscript  normal-Θ    b  g     \Theta_{bg}   is the background model. This ratio is compared to a threshold    T    T   T\,   to determine object presence/absence.  The likelihoods are factored as follows:      p   (  X  ,  S  ,  A  |  Θ  )   =   ∑   h  ∈  H    p   (  X  ,  S  ,  A  ,  h  |  Θ  )   =     fragments  p   fragments  normal-(  X  normal-,  S  normal-,  A  normal-|  Θ  normal-)     subscript     h  H    p   fragments  normal-(  X  normal-,  S  normal-,  A  normal-,  h  normal-|  Θ  normal-)      p(X,S,A|\Theta)=\sum_{h\in H}p(X,S,A,h|\Theta)=          ∑   h  ∈  H        p   (  A  |  X  ,  S  ,  h  ,  Θ  )    ⏟   Appearance      p   (  X  |  S  ,  h  ,  Θ  )    ⏟   Shape      p   (  S  |  h  ,  Θ  )    ⏟   Rel. Scale      p   (  h  |  Θ  )    ⏟   Other        subscript     h  H       subscript   normal-⏟   fragments  p   fragments  normal-(  A  normal-|  X  normal-,  S  normal-,  h  normal-,  Θ  normal-)     Appearance    subscript   normal-⏟   fragments  p   fragments  normal-(  X  normal-|  S  normal-,  h  normal-,  Θ  normal-)     Shape    subscript   normal-⏟   fragments  p   fragments  normal-(  S  normal-|  h  normal-,  Θ  normal-)     Rel. Scale    subscript   normal-⏟   fragments  p   fragments  normal-(  h  normal-|  Θ  normal-)     Other      \sum_{h\in H}\underbrace{p(A|X,S,h,\Theta)}_{\mbox{Appearance}}\underbrace{p(X%
 |S,h,\Theta)}_{\mbox{Shape}}\underbrace{p(S|h,\Theta)}_{\mbox{Rel. Scale}}%
 \underbrace{p(h|\Theta)}_{\mbox{Other}}     Appearance  Each part    p    p   p\,   has an appearance modeled by a Gaussian density in the appearance space, with mean and covariance parameters     Θ  p   a  p  p    =   {   c  p   ,   V  p   }        superscript   subscript  normal-Θ  p     a  p  p      subscript  c  p    subscript  V  p      \Theta_{p}^{app}=\{c_{p},V_{p}\}   , independent of other parts' densities. The background model has parameters     Θ   b  g    a  p  p    =   {   c   b  g    ,   V   b  g    }        superscript   subscript  normal-Θ    b  g      a  p  p      subscript  c    b  g     subscript  V    b  g       \Theta_{bg}^{app}=\{c_{bg},V_{bg}\}   . Fergus et al. assume that, given detected features, the position and appearance of those features are independent. Thus,    p   (  A  |  X  ,  S  ,  h  ,  Θ  )   =  p   (  A  |  h  ,  Θ  )      fragments  p   fragments  normal-(  A  normal-|  X  normal-,  S  normal-,  h  normal-,  Θ  normal-)    p   fragments  normal-(  A  normal-|  h  normal-,  Θ  normal-)     p(A|X,S,h,\Theta)=p(A|h,\Theta)\,   . The ratio of the appearance terms reduces to        p   (  A  |  X  ,  S  ,  h  ,  Θ  )     p   (  A  |  X  ,  S  ,  h  ,   Θ   b  g    )     =    p   (  A  |  h  ,  Θ  )     p   (  A  |  h  ,   Θ   b  g    )            fragments  p   fragments  normal-(  A  normal-|  X  normal-,  S  normal-,  h  normal-,  Θ  normal-)     fragments  p   fragments  normal-(  A  normal-|  X  normal-,  S  normal-,  h  normal-,   subscript  normal-Θ    b  g    normal-)        fragments  p   fragments  normal-(  A  normal-|  h  normal-,  Θ  normal-)     fragments  p   fragments  normal-(  A  normal-|  h  normal-,   subscript  normal-Θ    b  g    normal-)       \frac{p(A|X,S,h,\Theta)}{p(A|X,S,h,\Theta_{bg})}=\frac{p(A|h,\Theta)}{p(A|h,%
 \Theta_{bg})}          =    ∏   p  =  1   P     (    G   (  A   (   h  p   )   |   c  p   ,   V  p   )     G   (  A   (   h  p   )   |   c   b  g    ,   V   b  g    )     )    b  p         absent    superscript   subscript  product    p  1    P    superscript     fragments  G   fragments  normal-(  A   fragments  normal-(   subscript  h  p   normal-)   normal-|   subscript  c  p   normal-,   subscript  V  p   normal-)     fragments  G   fragments  normal-(  A   fragments  normal-(   subscript  h  p   normal-)   normal-|   subscript  c    b  g    normal-,   subscript  V    b  g    normal-)      subscript  b  p       =\prod_{p=1}^{P}\left(\frac{G(A(h_{p})|c_{p},V_{p})}{G(A(h_{p})|c_{bg},V_{bg})%
 }\right)^{b_{p}}     Recall from Weber et al. that    h    h   h\,   is the hypothesis for the indices of foreground parts, and    b    b   b\,   is the binary vector giving the occlusion state of each part in the hypothesis.  Shape  Shape is represented by a joint Gaussian density of part locations within a particular hypothesis, after those parts have been transformed into a scale-invariant space. This transformation precludes the need to perform an exhaustive search over scale. The Gaussian density has parameters     Θ  shape   =   {  μ  ,  Σ  }        superscript  normal-Θ  shape    μ  normal-Σ     \Theta^{\mbox{shape}}=\{\mu,\Sigma\}\,   . The background model     Θ   b  g       subscript  normal-Θ    b  g     \Theta_{bg}\,   is assumed to be a uniform distribution over the image, which has area    α    α   \alpha\,   . Letting    f    f   f\,   be the number of foreground parts,        p   (  X  |  S  ,  h  ,  Θ  )     p   (  X  |  S  ,  h  ,   Θ   b  g    )     =  G   (  X   (  h  )   |  μ  ,  Σ  )    α  f      fragments     fragments  p   fragments  normal-(  X  normal-|  S  normal-,  h  normal-,  Θ  normal-)     fragments  p   fragments  normal-(  X  normal-|  S  normal-,  h  normal-,   subscript  normal-Θ    b  g    normal-)      G   fragments  normal-(  X   fragments  normal-(  h  normal-)   normal-|  μ  normal-,  Σ  normal-)    superscript  α  f     \frac{p(X|S,h,\Theta)}{p(X|S,h,\Theta_{bg})}=G(X(h)|\mu,\Sigma)\alpha^{f}     Relative scale  The scale of each part    p    p   p\,   relative to a reference frame is modeled by a Gaussian density with parameters     Θ  scale   =   {   t  p   ,   U  p   }        superscript  normal-Θ  scale     subscript  t  p    subscript  U  p      \Theta^{\mbox{scale}}=\{t_{p},U_{p}\}\,   . Each part is assumed to be independent of other parts. The background model     Θ   b  g       subscript  normal-Θ    b  g     \Theta_{bg}\,   assumes a uniform distribution over scale, within a range    r    r   r\,   .        p   (  S  |  h  ,  Θ  )     p   (  S  |  h  ,   Θ   b  g    )     =   ∏   p  =  1   P   G    (  S   (   h  p   )   |   t  p   ,   U  p   )    d  p     r  f      fragments     fragments  p   fragments  normal-(  S  normal-|  h  normal-,  Θ  normal-)     fragments  p   fragments  normal-(  S  normal-|  h  normal-,   subscript  normal-Θ    b  g    normal-)       superscript   subscript  product    p  1    P   G   superscript   fragments  normal-(  S   fragments  normal-(   subscript  h  p   normal-)   normal-|   subscript  t  p   normal-,   subscript  U  p   normal-)    subscript  d  p     superscript  r  f     \frac{p(S|h,\Theta)}{p(S|h,\Theta_{bg})}=\prod_{p=1}^{P}G(S(h_{p})|t_{p},U_{p}%
 )^{d_{p}}r^{f}     Occlusion and statistics of feature detection        p   (  h  |  Θ  )     p   (  h  |   Θ   b  g    )     =     p  Poiss    (  n  |  M  )      p  Poiss    (  N  |  M  )      1    C  r     n    (  N  ,  f  )     p   (  b  |  Θ  )      fragments     fragments  p   fragments  normal-(  h  normal-|  Θ  normal-)     fragments  p   fragments  normal-(  h  normal-|   subscript  normal-Θ    b  g    normal-)         fragments   subscript  p  Poiss    fragments  normal-(  n  normal-|  M  normal-)     fragments   subscript  p  Poiss    fragments  normal-(  N  normal-|  M  normal-)       1     superscript   subscript  C  r   n    N  f     p   fragments  normal-(  b  normal-|  Θ  normal-)     \frac{p(h|\Theta)}{p(h|\Theta_{bg})}=\frac{p_{\mbox{Poiss}}(n|M)}{p_{\mbox{%
 Poiss}}(N|M)}\frac{1}{{}^{n}C_{r}(N,f)}p(b|\Theta)     The first term models the number of features detected using a Poisson distribution , which has mean M. The second term serves as a "book-keeping" term for the hypothesis variable. The last term is a probability table for all possible occlusion patterns.  Learning  The task of learning the model parameters    Θ  =   {  μ  ,  Σ  ,  c  ,  V  ,  M  ,  p   (  b  |  Θ  )   ,  t  ,  U  }      fragments  Θ    fragments  normal-{  μ  normal-,  Σ  normal-,  c  normal-,  V  normal-,  M  normal-,  p   fragments  normal-(  b  normal-|  Θ  normal-)   normal-,  t  normal-,  U  normal-}     \Theta=\{\mu,\Sigma,c,V,M,p(b|\Theta),t,U\}\,   is accomplished by expectation maximization . This is carried out in a spirit similar to that of Weber et al. Details and formulas for the E-step and M-step can be seen in the literature. 16  Performance  The Constellation Model as conceived by Fergus et al. achieves successful categorization rates consistently above 90% on large datasets of motorbikes, faces, airplanes, and spotted cats. 17 For each of these datasets, the Constellation Model is able to capture the "essence" of the object class in terms of appearance and/or shape. For example, face and motorbike datasets generate very tight shape models because objects in those categories have very well-defined structure, whereas spotted cats vary significantly in pose, but have a very distinctive spotted appearance. Thus, the model succeeds in both cases. It is important to note that the Constellation Model does not generally account for significant changes in orientation. Thus, if the model is trained on images of horizontal airplanes, it will not perform well on, for instance, images of vertically oriented planes unless the model is extended to account for this sort of rotation explicitly.  In terms of computational complexity, the Constellation Model is very expensive. If    N    N   N\,   is the number of feature detections in the image, and    P    P   P\,   the number of parts in the object model, then the hypothesis space    H    H   H\,   is    O   (   N  P   )       O   superscript  N  P     O(N^{P})\,   . Because the computation of sufficient statistics in the E-step of expectation maximization necessitates evaluating the likelihood for every hypothesis, learning becomes a major bottleneck operation. For this reason, only values of    P  ≤  6      P  6    P\leq 6   have been used in practical applications, and the number of feature detections    N    N   N\,   is usually kept within the range of about 20-30 per image.  Variations  One variation that attempts to reduce complexity is the star model proposed by Fergus et al. 18 The reduced dependencies of this model allows for learning in    O   (    N  2   P   )       O     superscript  N  2   P     O(N^{2}P)\,   time instead of    O   (   N  P   )       O   superscript  N  P     O(N^{P})\,   . This allows for a greater number of model parts and image features to be used in training. Because the star model has fewer parameters, it is also better at avoiding the problem of over-fitting when trained on fewer images.  References  External links   L. Fei-fei. Object categorization: the constellation models . Lecture Slides. (2005) (link not working)   See also   Part-based models  One-shot learning   "  Category:Learning in computer vision  Category:Probabilistic models     M. Fischler and R. Elschlager. The Representation and Matching of Pictoral Structures. (1973) ↩  M. Burl, T. Leung, and P. Perona. Face Localization via Shape Statistics. (1995) ↩  T. Leung, M. Burl, and P. Perona. Finding Faces in Cluttered Scenes Using Random Labeled Graph Matching. (1995) ↩  M. Burl and P. Perona. Recognition of Planar Object Classes (1996) ↩  M. Burl, M. Weber, and P. Perona. A Probabilistic Approach to Object Recognition Using Local Photometry and Global Geometry (1998) ↩  M. Weber. Unsupervised Learning of Models for Object Recognition. PhD Thesis. (2000) ↩  M. Weber, W. Einhaeuser, M. Welling and P. Perona. Viewpoint-Invariant Learning and Detection of Human Heads. (2000) ↩  M. Weber, M. Welling, and P. Perona. Towards Automatic Discovery of Object Categories. (2000) ↩  M. Weber, M. Welling and P. Perona. Unsupervised Learning of Models for Recognition. (2000) ↩  R. Fergus, P. Perona, and A. Zisserman. Object Class Recognition by Unsupervised Scale-Invariant Learning. (2003) ↩  R. Fergus. Visual Object Category Recognition. PhD Thesis. (2005) ↩     T. Kadir and M. Brady. Saliency, scale and image description. (2001) ↩   R. Fergus and P. Perona. Caltech Object Category datasets. http://www.vision.caltech.edu/html-files/archive.html (2003) ↩  R. Fergus, P. Perona, and A. Zisserman. A Sparse Object Category Model for Efficient Learning and Exhaustive Recognition. (2005) ↩     
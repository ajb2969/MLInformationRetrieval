<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1465">FlexRay</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>FlexRay</h1>
<hr/>

<p><strong>FlexRay</strong> is an <a href="Vehicle_bus" title="wikilink">automotive network communications protocol</a> developed by the FlexRay Consortium to govern on-board automotive computing. It is designed to be faster and more reliable than <a href="Controller_Area_Network" title="wikilink">CAN</a> and <a href="Time-Triggered_Protocol" title="wikilink">TTP</a>, but it is also more expensive. The FlexRay consortium disbanded in 2009, but the FlexRay standard is now a set of ISO standards, ISO <a href="http://www.iso.org/iso/home/store/catalogue_tc/catalogue_detail.htm?csnumber=59804">17458-1</a> to <a href="http://www.iso.org/iso/home/store/catalogue_tc/catalogue_detail.htm?csnumber=59809">17458-5</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="features">Features</h2>

<p>FlexRay supports high data rates, up to , explicitly supports both star and "party line" bus topologies, and can have two independent data channels for fault-tolerance (communication can continue with reduced bandwidth if one channel is inoperative). The bus operates on a time cycle, divided into two parts: the static segment and the dynamic segment. The static segment is preallocated into slices for individual communication types, providing a stronger <a href="Real-time_computing" title="wikilink">real-time guarantee</a> than its predecessor <a href="Controller_Area_Network" title="wikilink">CAN</a>. The dynamic segment operates more like <a href="Controller_Area_Network" title="wikilink">CAN</a>, with nodes taking control of the bus as available, allowing event-triggered behavior.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="consortium">Consortium</h2>

<p>The FlexRay Consortium was made up of the following core members:</p>
<ul>
<li><a href="Freescale_Semiconductor" title="wikilink">Freescale Semiconductor</a></li>
<li><a href="Robert_Bosch_GmbH" title="wikilink">Robert Bosch GmbH</a></li>
<li><a href="NXP_Semiconductors" title="wikilink">NXP Semiconductors</a></li>
<li><a href="BMW_AG" title="wikilink">BMW AG</a></li>
<li><a href="Volkswagen_AG" title="wikilink">Volkswagen AG</a></li>
<li><a href="Daimler_AG" title="wikilink">Daimler AG</a></li>
<li><a href="General_Motors" title="wikilink">General Motors</a></li>
</ul>

<p>There were also Premium Associate and Associate members of FlexRay consortium. By September 2009, there were 28 premium associate members and more than 60 associate members. At the end of 2009, the consortium disbanded.</p>
<h2 id="where-used">Where used</h2>

<p>The first series production vehicle with FlexRay was at the end of 2006 in the <a href="BMW_X5" title="wikilink">BMW X5</a>,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> enabling a new and fast adaptive damping system. Full use of FlexRay was introduced in 2008 in the new <a href="BMW_7_Series_(F01)" title="wikilink">BMW 7 Series (F01)</a>.</p>
<h3 id="vehicles">Vehicles</h3>
<ul>
<li><a href="Audi_A6_C7" title="wikilink">Audi A6 C7</a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></li>
<li><a href="Audi_A7" title="wikilink">Audi A7</a></li>
<li><a href="Audi_A8_D4" title="wikilink">Audi A8 D4</a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></li>
<li><a href="Audi_Q7#Second_generation_(2015–)" title="wikilink">Audi Q7#Second generation (2015–)</a></li>
<li><a href="Audi_TT_Mk3" title="wikilink">Audi TT Mk3</a> (2014-)</li>
<li><a href="Audi_R8#second" title="wikilink">Audi R8#second</a> (2015-)</li>
<li><a href="Bentley_Flying_Spur_(2013)" title="wikilink">Bentley Flying Spur (2013)</a></li>
<li><a href="Bentley_Mulsanne_(2010)" title="wikilink">Bentley Mulsanne</a></li>
<li><a href="BMW_X5" title="wikilink">BMW X5</a> from 2007</li>
<li><a href="BMW_F20" title="wikilink">BMW 1-Series</a></li>
<li><a href="BMW_F30" title="wikilink">BMW 3-Series</a></li>
<li><a href="BMW_5_Series_(F10)" title="wikilink">BMW 5 Series (F10)</a></li>
<li><a href="BMW_5_Series_Gran_Turismo" title="wikilink">BMW 5 Series Gran Turismo</a></li>
<li><a href="BMW_F01" title="wikilink">BMW 7-Series</a></li>
<li><a href="Lamborghini_Huracán" title="wikilink">Lamborghini Huracán</a></li>
<li><a href="Mercedes-Benz_S-Class_(W222)" title="wikilink">Mercedes-Benz S-Class (W222)</a></li>
<li><a href="Mercedes-Benz_S-Class_(C217)" title="wikilink">Mercedes-Benz S-Class (C217)</a></li>
<li><a href="Mercedes-Benz_E-Class_(W212)" title="wikilink">Mercedes-Benz E-Class (W212)</a> from 2013<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
<li><a href="Mercedes-Benz_C-Class_(W205)" title="wikilink">Mercedes-Benz C-Class (W205)</a></li>
<li><a href="Rolls-Royce_Ghost" title="wikilink">Rolls-Royce Ghost</a></li>
<li><a href="Land_Rover" title="wikilink">Land Rover</a></li>
<li><a href="Volvo_XC90" title="wikilink">Volvo XC90</a> (2015-)</li>
</ul>
<h2 id="details">Details</h2>
<h3 id="clock">Clock</h3>

<p>FlexRay system consists of a bus and processors (<a href="Electronic_control_unit" title="wikilink">Electronic control unit</a>, or ECUs). Each ECU has an independent clock. The <a href="clock_drift" title="wikilink">clock drift</a> must be not more than 0.15% from the reference clock, so the difference between the slowest and the fastest clock in the system is no greater than 0.3%.</p>

<p>This means that, if ECU-s is a sender and ECU-r is a receiver, then for every 300 cycles of the sender there will be between 299 and 301 cycles of the receiver. The clocks are resynchronized frequently enough to assure that this causes no problems. The clock is sent in the static segment.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h3 id="bits-on-the-bus">Bits on the bus</h3>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>

<p>Correct averaging in case of no errors. The signal is merely delayed by 2 cycles.</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>

<p>Errors near the middle of 8-cycle region are canceled.</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>

<p>Errors near the boundary of 8-cycle region may affect the boundary bit.</p></td>
</tr>
</tbody>
</table>

<p>At each time, only one ECU writes to the <a href="bus_(computing)" title="wikilink">bus</a>. Each bit to be sent is held on the bus for 8 sample clock cycles. The receiver keeps a buffer of the last 5 samples, and uses the majority of the last 5 samples as the input signal.</p>

<p>Single-cycle transmission errors may affect results near the boundary of the bits, but will not affect cycles in the middle of the 8-cycle region.</p>
<h3 id="sampled-bits">Sampled bits</h3>

<p>The value of the bit is sampled in the middle of the 8-bit region. The errors are moved to the extreme cycles, and the clock is synchronized frequently enough for the drift to be small. (Drift is smaller than 1 cycle per 300 cycles, and during transmission the clock is synchronized more than once every 300 cycles).</p>
<h3 id="frame">Frame</h3>

<p>All the communication is sent in the form of frames. The message consists of bytes 

<math display="inline" id="FlexRay:0">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>m</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{x_{0},x_{1},\dots,x_{m-1}\}
  </annotation>
 </semantics>
</math>

, packed in the following way:</p>
<ul>
<li>Transmission Start Signal (TSS) – bit 0</li>
<li>Frame Start Signal (FSS) – bit 1</li>
<li><em>m</em> times:
<ul>
<li>Byte Start Signal 0 (BSS0) – bit 1</li>
<li>Byte Start Signal 1 (BSS1) – bit 0</li>
<li>0th bit of <em>i</em>-th byte</li>
<li>1st bit of <em>i</em>-th byte</li>
<li>2nd bit of <em>i</em>-th byte</li>
<li>...</li>
<li>7th bit of <em>i</em>-th byte</li>
</ul></li>
<li>Frame End Signal (FES) – bit 0</li>
<li>Transmission End Signal (TES) – bit 1</li>
</ul>

<p>If nothing is being communicated, the bus is held in state 1 (high voltage), so every receiver knows that the communication started when the voltage drops to 0.</p>

<p>The receiver knows when the message is complete by checking whether BSS0 (1) or FES (0) was received.</p>

<p>Note that 8-cycle per bit has nothing to do with bytes. Each byte takes 80 cycles to transfer. 16 for BSS0 and BSS1 and 64 for its bits. Also note that BSS0 has value 1, and BSS1 has value 0.</p>
<h3 id="clock-synchronization">Clock synchronization</h3>

<p>Clocks are resynchronized when the voted signal changes from 1 to 0, if the receiver was in either idle state or expecting BSS1.</p>

<p>As synchronization is done on the voted signal, small transmission errors during synchronization that affect the boundary bits may skew the synchronization no more than 1 cycle. As there are at most 88 cycles between synchronization (BSS1, 8 bits of the last byte, FES and TES - 11 bits of 8 cycles each), and the clock drift is no larger than 1 per 300 cycles, the drift may skew the clock no more than 1 cycle. Small transmission errors during the receiving may affect only the boundary bits. So in the worst case the two middle bits are correct, and thus the sampled value is correct.</p>

<p>Here's an example of a particularly bad case - error during synchronization, a lost cycle due to clock drift and error in transmission.</p>

<p>Errors that happened in the example</p>
<ul>
<li>Because of a single-bit error during synchronization, the synchronization was delayed by 1 cycle</li>
<li>Receiver clock was slower than sender clock, so receiver missed one cycle (marked X). This will not happen again before the next synchronization due to limits on maximum allowable clock drift.</li>
<li>Because of a single-bit error during transmission, a bit was voted wrongly near the result.</li>
</ul>

<p>Despite so many errors, the communication was received correctly.</p>

<p>The green cells are sampling points. All except the first are synchronized by the 1-&gt;0 edge in the transmission fragment shown.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Signal to be sent</p></th>
<th style="text-align: left;">
<p>style="text-align: center; border-left: solid black 1px" 1</p></th>
<th style="text-align: left;">
<p>style="text-align: center; border-left: solid black 1px" 0</p></th>
<th style="text-align: left;">
<p>style="text-align: center; border-left: solid black 1px" 1</p></th>
<th style="text-align: left;">
<p>style="text-align: center; border-left: solid black 1px" 0</p></th>
<th style="text-align: left;">
<p>style="text-align: center; border-left: solid black 1px" 1</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Signal sent</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>On the bus</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Received</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5-maj voted</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
</tbody>
</table>

<p><br/>
</p>
<h2 id="development-tools">Development tools</h2>

<p>When developing and/or troubleshooting the FlexRay bus, examination of hardware signals can be very important. <a href="Logic_analyzers" title="wikilink">Logic analyzers</a> and <a href="bus_analyzer" title="wikilink">bus analyzers</a> are tools which collect, analyze, decode, store signals so people can view the high-speed waveforms at their leisure.</p>
<h3 id="the-future-of-flexray">The future of FlexRay</h3>

<p>The bus has certain disadvantages like lower operating voltage levels and asymmetry of the edges, which leads to problems in extending the network length. Ethernet may replace FlexRay for bandwidth intensive, non-safety critical applications.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Byteflight" title="wikilink">Byteflight</a></li>
<li><a href="Controller_Area_Network" title="wikilink">Controller Area Network</a> (CAN)</li>
<li><a href="Local_Interconnect_Network" title="wikilink">Local Interconnect Network</a> (LIN) - lower cost and lower bandwidth than CAN</li>
<li><a href="MOST_Bus" title="wikilink">MOST Bus</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.flexray.com">FlexRay</a> FlexRay Consortium</li>
<li><a href="http://zone.ni.com/devzone/cda/tut/p/id/3352">FlexRay Overview</a> Technical Overview of FlexRay by National Instruments</li>
<li><a href="http://www.samtec.de/">Flexray Products</a> Samtec FlexRay product</li>
<li><a href="http://www.invehiclelan.com/">Flexray design tool</a> Low cost network design tool for FlexRay</li>
<li><a href="http://patakengineering.eu/en/download/">FlexRay controller core</a> Free VHDL core</li>
<li><a href="http://www.tek.com/industry/automotive">FlexRay debugging</a> Measurement, Debug and Analysis for Embedded Automotive Designs by Tektronix</li>
</ul>

<p>"</p>

<p><a href="Category:Network_protocols" title="wikilink">Category:Network protocols</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

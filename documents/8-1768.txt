   Lucas' theorem      Lucas' theorem   In number theory , Lucas's theorem expresses the remainder of division of the binomial coefficient     (      m      n      )     binomial  m  n    {\textstyle\left({{m}\atop{n}}\right)}   by a prime number  p in terms of the base  p expansions of the integers m and n .  Lucas's theorem first appeared in 1878 in papers by Édouard Lucas .    (part 1);   (part 2);   (part 3)   Formulation  For non-negative integers m and n and a prime p , the following congruence relation holds:        (     m      n     )   ≡     ∏   i  =  0   k    (      m  i        n  i      )       (   mod  p   )     ,       binomial  m  n    annotated    superscript   subscript  product    i  0    k    binomial   subscript  m  i    subscript  n  i      pmod  p      {\left({{m}\atop{n}}\right)}\equiv\prod_{i=0}^{k}{\left({{m_{i}}\atop{n_{i}}}%
 \right)}\;\;(\mathop{{\rm mod}}p),   where       m  =     m  k    p  k    +    m   k  -  1     p   k  -  1     +  ⋯  +    m  1   p   +   m  0     ,      m       subscript  m  k    superscript  p  k       subscript  m    k  1     superscript  p    k  1     normal-⋯     subscript  m  1   p    subscript  m  0      m=m_{k}p^{k}+m_{k-1}p^{k-1}+\cdots+m_{1}p+m_{0},   and      n  =     n  k    p  k    +    n   k  -  1     p   k  -  1     +  ⋯  +    n  1   p   +   n  0        n       subscript  n  k    superscript  p  k       subscript  n    k  1     superscript  p    k  1     normal-⋯     subscript  n  1   p    subscript  n  0      n=n_{k}p^{k}+n_{k-1}p^{k-1}+\cdots+n_{1}p+n_{0}   are the base p expansions of m and n respectively. This uses the convention that    (      m      n      )     binomial  m  n    {\textstyle\left({{m}\atop{n}}\right)}   = 0 if m \tbinom{m}{n} is divisible by a prime p if and only if at least one of the base p digits of n is greater than the corresponding digit of m .  Proof  There are several ways to prove Lucas's theorem. We first give a combinatorial argument and then a proof based on generating functions.  Let M be a set with m elements, and divide it into m i cycles of length p i for the various values of i . Then each of these cycles can be rotated separately, so that a group G which is the Cartesian product of cyclic groups C p i acts on M . It thus also acts on subsets N of size n . Since the number of elements in G is a power of p , the same is true of any of its orbits. Thus in order to compute    (      m      n      )     binomial  m  n    {\textstyle\left({{m}\atop{n}}\right)}   modulo p , we only need to consider fixed points of this group action. The fixed points are those subsets N that are a union of some of the cycles. More precisely one can show by induction on k - i , that N must have exactly n i cycles of size p i . Thus the number of choices for N is exactly      ∏   i  =  0   k    (       m  i        n  i       )       (   mod  p   )      annotated    superscript   subscript  product    i  0    k    binomial   subscript  m  i    subscript  n  i      pmod  p     \prod_{i=0}^{k}{\left({{m_{i}}\atop{n_{i}}}\right)}\;\;(\mathop{{\rm mod}}p)   .  Here is a proof based on generating functions, due to Nathan Fine. 1  If p is a prime and n is an integer with 1≤ n ≤ p -1, then the numerator of the binomial coefficient       (     p      n     )   =     p  ⋅   (   p  -  1   )    ⋯   (    p  -  n   +  1   )      n  ⋅   (   n  -  1   )    ⋯  1         binomial  p  n        normal-⋅  p    p  1    normal-⋯      p  n   1       normal-⋅  n    n  1    normal-⋯  1      {\left({{p}\atop{n}}\right)}=\frac{p\cdot(p-1)\cdots(p-n+1)}{n\cdot(n-1)\cdots
 1}   is divisible by p but the denominator is not. Hence p divides    (      p      n      )     binomial  p  n    {\textstyle\left({{p}\atop{n}}\right)}   . In terms of ordinary generating functions, this means that         (   1  +  X   )   p   ≡   1  +    X  p   mod  p     .       superscript    1  X   p     1     superscript  X  p   mod  p      (1+X)^{p}\equiv 1+X^{p}\text{ mod }p.   Continuing by induction, we have for every nonnegative integer i that         (   1  +  X   )    p  i    ≡   1  +    X   p  i    mod  p     .       superscript    1  X    superscript  p  i      1     superscript  X   superscript  p  i    mod  p      (1+X)^{p^{i}}\equiv 1+X^{p^{i}}\text{ mod }p.     Now let m be a nonnegative integer, and let p be a prime. Write m in base p , so that    m  =    ∑   i  =  0   k     m  i    p  i         m    superscript   subscript     i  0    k      subscript  m  i    superscript  p  i       m=\sum_{i=0}^{k}m_{i}p^{i}   for some nonnegative integer k and integers m i with 0 ≤ m i ≤ p -1. Then        ∑   n  =  0   m      (      m      n      )    X  n        superscript   subscript     n  0    m      binomial  m  n    superscript  X  n      \displaystyle\sum_{n=0}^{m}{\left({{m}\atop{n}}\right)}X^{n}   where in the final product, n i is digit i in the base p representation of n . This proves Lucas's theorem.  Variations and generalizations   The largest integer k such that p k divides the binomial coefficient    (      m      n      )     binomial  m  n    {\textstyle\left({{m}\atop{n}}\right)}   (or in other words, the valuation of the binomial coefficient with respect to the prime p ) is equal to the number of carries that occur when n and m − n are added in the base p . (This result is known as Kummer's theorem .)  Andrew Granville has given a generalization of Lucas's theorem to the case of p being a power of prime. 2   References  External links    Alternate Proof of Lucas'Theorem   "  Category:Articles containing proofs  Category:Theorems about prime numbers     ↩  ↩     
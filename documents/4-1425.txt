   Equidistributed sequence      Equidistributed sequence   In mathematics , a sequence { s 1 , s 2 , s 3 , …} of real numbers is said to be equidistributed , or uniformly distributed , if the proportion of terms falling in a subinterval is proportional to the length of that interval. Such sequences are studied in Diophantine approximation theory and have applications to Monte Carlo integration .  Definition  A sequence { s 1 , s 2 , s 3 , …} of real numbers is said to be equidistributed on an interval [ a , b ] if for any subinterval [ c , d ] of [ a , b ] we have         lim   n  →  ∞      |    {   s  1   ,  …  ,    s  n    }   ∩   [  c  ,  d  ]    |   n    =    d  -  c    b  -  a     .        subscript    normal-→  n             subscript  s  1   normal-…   subscript  s  n     c  d     n        d  c     b  a      \lim_{n\to\infty}{\left|\{\,s_{1},\dots,s_{n}\,\}\cap[c,d]\right|\over n}={d-c%
 \over b-a}.\,   (Here, the notation |{ s 1 ,…, s n }∩[ c , d ]| denotes the number of elements, out of the first n elements of the sequence, that are between c and d .)  For example, if a sequence is equidistributed in [0, 2], since the interval [0.5, 0.9] occupies 1/5 of the length of the interval [0, 2], as n becomes large, the proportion of the first n members of the sequence which fall between 0.5 and 0.9 must approach 1/5. Loosely speaking, one could say that each member of the sequence is equally likely to fall anywhere in its range. However, this is not to say that { s n } is a sequence of random variables; rather, it is a determinate sequence of real numbers.  Discrepancy  We define the discrepancy  D N for a sequence { s 1 , s 2 , s 3 , …} with respect to the interval [ a , b ] as        D  N   =    sup   a  ≤  c  ≤  d  ≤  b     |     |    {   s  1   ,  …  ,    s  N    }   ∩   [  c  ,  d  ]    |   N   -    d  -  c    b  -  a     |     .       subscript  D  N     subscript  supremum      a  c       d       b                 subscript  s  1   normal-…   subscript  s  N     c  d     N       d  c     b  a         D_{N}=\sup_{a\leq c\leq d\leq b}\left|\frac{\left|\{\,s_{1},\dots,s_{N}\,\}%
 \cap[c,d]\right|}{N}-\frac{d-c}{b-a}\right|.\,     A sequence is thus equidistributed if the discrepancy D N tends to zero as N tends to infinity.  Equidistribution is a rather weak criterion to express the fact that a sequence fills the segment leaving no gaps. For example, the drawings of a random variable uniform over a segment will be equidistributed in the segment, but there will be large gaps compared to a sequence which first enumerates multiples of ε in the segment, for some small ε, in an appropriately chosen way, and then continues to do this for smaller and smaller values of ε. See low-discrepancy sequence for stronger criteria and constructions of low-discrepancy sequences for constructions of sequences which are more evenly distributed.  Riemann integral criterion for equidistribution  Recall that if f is a function having a Riemann integral in the interval [ a , b ], then its integral is the limit of Riemann sums taken by sampling the function f in a set of points chosen from a fine partition of the interval. Therefore, if some sequence is equidistributed in [ a , b ], it is expected that this sequence can be used to calculate the integral of a Riemann-integrable function. This leads to the following criterion 1 for an equidistributed sequence:  Suppose { s 1 , s 2 , s 3 , …} is a sequence contained in the interval [ a , b ]. Then the following conditions are equivalent:   The sequence is equidistributed on [ a , b ].  For every Riemann-integrable ( complex-valued ) function f : [ a , b ] → C , the following limit holds:         lim   N  →  ∞      1  N     ∑   n  =  1   N    f   (   s  n   )       =    1   b  -  a      ∫  a  b    f   (  x  )   d  x           subscript    normal-→  N         1  N     superscript   subscript     n  1    N     f   subscript  s  n           1    b  a      superscript   subscript   a   b     f  x  d  x       \lim_{N\to\infty}\frac{1}{N}\sum_{n=1}^{N}f\left(s_{n}\right)=\frac{1}{b-a}%
 \int_{a}^{b}f(x)\,dx           Proof       First note that the definition of an equidistributed sequence is equivalent to the integral criterion whenever f is the indicator function of an interval: If f = 1 [ c , d ] , then the left hand side is the proportion of points of the sequence falling in the interval [ c , d ], and the right hand side is exactly      d  -  c    b  -  a    .        d  c     b  a     \textstyle\frac{d-c}{b-a}.   This means 2 → 1 (since indicator functions are Riemann-integrable), and 1 → 2 for f being an indicator function of an interval. It remains to assume that the integral criterion holds for indicator functions and prove that it holds for general Riemann-integrable functions as well. Note that both sides of the integral criterion equation are linear in f , and therefore the criterion holds for linear combinations of interval indicators, that is, step functions . To show it holds for f being a general Riemann-integrable function, first assume f is real-valued. Then by using Darboux's definition of the integral, we have for every ε > 0 two step functions f 1 and f 2 such that f 1 ≤ f ≤ f 2 and       ∫  a  b     (     f  2    (  x  )    -    f  1    (  x  )     )   d  x    ≤  ε   .        superscript   subscript   a   b          subscript  f  2   x      subscript  f  1   x    d  x    ε    \textstyle\int_{a}^{b}(f_{2}(x)-f_{1}(x))\,dx\leq\varepsilon.   Notice that:        ∫  a  b     f  1    (  x  )   d  x    =    lim   N  →  ∞      1  N     ∑   n  =  1   N     f  1    (   s  n   )       ≤    lim inf   N  →  ∞      1  N     ∑   n  =  1   N    f   (   s  n   )               superscript   subscript   a   b      subscript  f  1   x  d  x      subscript    normal-→  N         1  N     superscript   subscript     n  1    N      subscript  f  1    subscript  s  n              subscript  limit-infimum   normal-→  N         1  N     superscript   subscript     n  1    N     f   subscript  s  n          \int_{a}^{b}f_{1}(x)\,dx=\lim_{N\to\infty}\frac{1}{N}\sum_{n=1}^{N}f_{1}(s_{n}%
 )\leq\liminf_{N\to\infty}\frac{1}{N}\sum_{n=1}^{N}f(s_{n})           ∫  a  b     f  2    (  x  )   d  x    =    lim   N  →  ∞      1  N     ∑   n  =  1   N     f  2    (   s  n   )       ≥    lim sup   N  →  ∞      1  N     ∑   n  =  1   N    f   (   s  n   )               superscript   subscript   a   b      subscript  f  2   x  d  x      subscript    normal-→  N         1  N     superscript   subscript     n  1    N      subscript  f  2    subscript  s  n              subscript  limit-supremum   normal-→  N         1  N     superscript   subscript     n  1    N     f   subscript  s  n          \int_{a}^{b}f_{2}(x)\,dx=\lim_{N\to\infty}\frac{1}{N}\sum_{n=1}^{N}f_{2}(s_{n}%
 )\geq\limsup_{N\to\infty}\frac{1}{N}\sum_{n=1}^{N}f(s_{n})   By subtracting, we see that the limit superior and limit inferior of     1  N     ∑   n  =  1   N    f   (   s  n   )           1  N     superscript   subscript     n  1    N     f   subscript  s  n       \textstyle\frac{1}{N}\sum_{n=1}^{N}f(s_{n})   differ by at most ε. Since ε is arbitrary, we have the existence of the limit, and by Darboux's definition of the integral, it is the correct limit. Finally, for complex-valued Riemann-integrable functions, the result follows again from linearity, and from the fact that every such function can be written as f = u + vi , where u , v are real-valued and Riemann-integrable. ∎       This criterion leads to the idea of Monte-Carlo integration , where integrals are computed by sampling the function over a sequence of random variables equidistributed in the interval.  It is not possible to generalize the integral criterion to a class of functions bigger than just the Riemann-integrable ones. For example, if the Lebesgue integral is considered and f is taken to be in L 1 , then this criterion fails. As a counterexample, take f to be the indicator function of some equidistributed sequence. Then in the criterion, the left hand side is always 1, whereas the right hand side is zero, because the sequence is countable, so f is zero almost everywhere .  In fact, the de Bruijn–Post Theorem states the converse of the above criterion: If f is a function such that the criterion above holds for any equidistributed sequence in [ a , b ], then f is Riemann-integrable in [ a , b ]. 2  Equidistribution modulo 1  A sequence { a 1 , a 2 , a 3 , …} of real numbers is said to be equidistributed modulo 1 or uniformly distributed modulo 1 if the sequence of the fractional parts of a n , denoted by { a n } or by a n −⌊ a n ⌋, is equidistributed in the interval [0, 1].  Examples  (Figure)  Illustration of the filling of the unit interval ( x -axis) using the first n terms of the Van der Corput sequence, for n from 0 to 999 ( y -axis). Gradation in colour is due to aliasing.    The equidistribution theorem : The sequence of all multiples of an irrational α ,     0, α, 2α, 3α, 4α, …    is equidistributed modulo 1. 3     More generally, if p is a polynomial with at least one irrational coefficient (other than the constant term) then the sequence p ( n ) is uniformly distributed modulo 1.   This was proven by Weyl and is an application of van der Corput's difference theorem. 4   The sequence log( n ) is not uniformly distributed modulo 1. 5  The sequence of all multiples of an irrational α by successive prime numbers ,     2α, 3α, 5α, 7α, 11α, …    is equidistributed modulo 1. This is a famous theorem of analytic number theory , published by I. M. Vinogradov in 1948. 6     The van der Corput sequence is equidistributed. 7   Weyl's criterion  Weyl's criterion states that the sequence a n is equidistributed modulo 1 if and only if for all non-zero integers ℓ,        lim   n  →  ∞      1  n     ∑   j  =  1   n    e   2  π  i  ℓ   a  j        =  0.        subscript    normal-→  n         1  n     superscript   subscript     j  1    n    superscript  e    2  π  i  normal-ℓ   subscript  a  j        0.    \lim_{n\to\infty}\frac{1}{n}\sum_{j=1}^{n}e^{2\pi i\ell a_{j}}=0.   The criterion is named after, and was first formulated by, Hermann Weyl . 8 It allows to reduce equidistribution questions to bounds on exponential sums , a fundamental and general method.        Sketch of proof       If the sequence is equidistributed modulo 1, then we can apply the Riemann integral criterion (described above) on the function      f   (  x  )    =   e   2  π  i  ℓ  x     ,        f  x    superscript  e    2  π  i  normal-ℓ  x      \textstyle f(x)=e^{2\pi i\ell x},   which has integral zero on the interval [0, 1]. This gives Weyl's criterion immediately. Conversely, suppose Weyl's criterion holds. Then the Riemann integral criterion holds for functions f as above, and by linearity of the criterion, it holds for f being any trigonometric polynomial . By the Stone–Weierstrass theorem and an approximation argument, this extends to any continuous function f . Finally, let f be the indicator function of an interval. It is possible to bound f from above and below by two continuous functions on the interval, whose integrals differ by an arbitrary ε. By an argument similar to the proof of the Riemann integral criterion, it is possible to extend the result to any interval indicator function f , thereby proving equidistribution modulo 1 of the given sequence. ∎       Generalizations   A quantitative form of Weyl's criterion is given by the Erdős–Turán inequality .    Weyl's criterion extends naturally to higher dimensions , assuming the natural generalization of the definition of equidistribution modulo 1:   The sequence v n of vectors in R k is equidistributed modulo 1 if and only if for any non-zero vector ℓ ∈ Z k ,        lim   n  →  ∞      1  n     ∑   j  =  0    n  -  1     e    2  π  i  ℓ   ⋅   v  j        =  0.        subscript    normal-→  n         1  n     superscript   subscript     j  0      n  1     superscript  e   normal-⋅    2  π  i  normal-ℓ    subscript  v  j        0.    \lim_{n\to\infty}\frac{1}{n}\sum_{j=0}^{n-1}e^{2\pi i\ell\cdot v_{j}}=0.     Example of usage  Weyl's criterion can be used to easily prove the equidistribution theorem , stating that the sequence of multiples 0, α , 2 α , 3 α , … of some real number α is equidistributed modulo 1 if and only if α is irrational. 9  Suppose α is irrational and denote our sequence by a j = jα (where j starts from 0, to simplify the formula later). Let ℓ ≠ 0 be an integer. Since α is irrational, ℓα can never be an integer, so    e   2  π  i  ℓ  α      superscript  e    2  π  i  normal-ℓ  α     \textstyle e^{2\pi i\ell\alpha}   can never be 1. Using the formula for the sum of a finite geometric series ,        |    ∑   j  =  0    n  -  1     e   2  π  i  ℓ  j  α     |   =   |    ∑   j  =  0    n  -  1      (   e   2  π  i  ℓ  α    )   j    |   =   |    1  -   e   2  π  i  ℓ  n  α      1  -   e   2  π  i  ℓ  α      |   ≤   2   |   1  -   e   2  π  i  ℓ  α     |     ,            superscript   subscript     j  0      n  1     superscript  e    2  π  i  normal-ℓ  j  α          superscript   subscript     j  0      n  1     superscript   superscript  e    2  π  i  normal-ℓ  α    j                1   superscript  e    2  π  i  normal-ℓ  n  α       1   superscript  e    2  π  i  normal-ℓ  α              2      1   superscript  e    2  π  i  normal-ℓ  α          \left|\sum_{j=0}^{n-1}e^{2\pi i\ell j\alpha}\right|=\left|\sum_{j=0}^{n-1}%
 \left(e^{2\pi i\ell\alpha}\right)^{j}\right|=\left|\frac{1-e^{2\pi i\ell n%
 \alpha}}{1-e^{2\pi i\ell\alpha}}\right|\leq\frac{2}{\left|1-e^{2\pi i\ell%
 \alpha}\right|},   a bound that does not depend on n . Therefore after dividing by n and letting n tend to infinity, the left hand side tends to zero, and Weyl's criterion is satisfied.  Conversely, notice that if α is rational then this sequence is not equidistributed modulo 1, because there is only a finite number of options for the fractional part of a j = jα .  van der Corput's difference theorem  A theorem of Johannes van der Corput 10 states that if for each h the sequence s n + h − s n is uniformly distributed modulo 1, then so is s n . 11 12 13  A van der Corput set is a set H of integers such that if for each h in H the sequence s n + h − s n is uniformly distributed modulo 1, then so is s n . 14 15  Metric theorems  Metric theorems describe the behaviour of a parametrised sequence for almost all values of some parameter α : that is, for values of α not lying in some exceptional set of Lebesgue measure zero.   For any sequence of distinct integers b n , the sequence { b n α } is equidistributed mod 1 for almost all values of α . 16  The sequence { α n } is equidistributed mod 1 for almost all values of α > 1. 17   It is not known whether the sequences { e n } or {   π   π   \pi    n } are equidistributed mod 1. However it is known that the sequence { α n } is not equidistributed mod 1 if α is a PV number .  Well-distributed sequence  A sequence { s 1 , s 2 , s 3 , …} of real numbers is said to be well-distributed on [ a , b ] if for any subinterval [ c , d ] of [ a , b ] we have        lim   n  →  ∞      |    {   s   k  +  1    ,  …  ,    s   k  +  n     }   ∩   [  c  ,  d  ]    |   n    =     d  -  c    b  -  a           subscript    normal-→  n             subscript  s    k  1    normal-…   subscript  s    k  n      c  d     n        d  c     b  a      \lim_{n\to\infty}{\left|\{\,s_{k+1},\dots,s_{k+n}\,\}\cap[c,d]\right|\over n}=%
 {d-c\over b-a}\,    uniformly in k . Clearly every well-distributed sequence is uniformly distributed, but the converse does not hold. The definition of well-distributed modulo 1 is analogous.  Sequences equidistributed with respect to an arbitrary measure  For an arbitrary probability measure space     (  X  ,  μ  )     X  μ    (X,\mu)   , a sequence of points    x  n     subscript  x  n    x_{n}   is said to be equidistributed with respect to   μ   μ   \mu   if the mean of point measures  converges weakly to   μ   μ   \mu   : 18          ∑   k  =  1   n    δ   x  k     n   ⇒   μ    .     normal-⇒      superscript   subscript     k  1    n    subscript  δ   subscript  x  k     n   μ    \frac{\sum_{k=1}^{n}\delta_{x_{k}}}{n}\Rightarrow\mu\ .   It is true, for example, that for any Borel  probability measure on a separable , metrizable space, there exists an equidistributed sequence (with respect to the measure).  See also   Equidistribution theorem  Low-discrepancy sequence  Erdős–Turán inequality   References       Further reading      External links      Lecture notes with proof of Weyl's Criterion   "  Category:Diophantine approximation  Category:Dynamical systems  Category:Ergodic theory     Kuipers & Niederreiter (2006) pp. 2–3 ↩  http://math.uga.edu/~pete/udnotes.pdf , Theorem 8 ↩  Kuipers & Niederreiter (2006) p. 8 ↩  Kuipers & Niederreiter (2006) p. 27 ↩   Kuipers & Niederreiter (2006) p. 129 ↩  Kuipers & Niederreiter (2006) p. 127 ↩  ↩   ↩  Kuipers & Niederreiter (2006) p. 26 ↩  Montgomery (1994) p.18 ↩  ↩    See . ↩  ↩  Kuipers & Niederreiter (2006) p.171 ↩     
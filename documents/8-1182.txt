   Disintegration theorem      Disintegration theorem   In mathematics , the disintegration theorem is a result in measure theory and probability theory . It rigorously defines the idea of a non-trivial "restriction" of a measure to a measure zero subset of the measure space in question. It is related to the existence of conditional probability measures . In a sense, "disintegration" is the opposite process to the construction of a product measure .  Motivation  Consider the unit square in the Euclidean plane  R 2 , S = [0, 1] × [0, 1]. Consider the probability measure μ defined on S by the restriction of two-dimensional Lebesgue measure λ 2 to S . That is, the probability of an event E ⊆ S is simply the area of E . We assume E is a measurable subset of S .  Consider a one-dimensional subset of S such as the line segment L x = { x } × [0, 1]. L x has μ-measure zero; every subset of L x is a μ- null set ; since the Lebesgue measure space is a complete measure space ,      E  ⊆   L  x   ⟹   μ   (  E  )    =  0.        E   subscript  L  x          μ  E        0.     E\subseteq L_{x}\implies\mu(E)=0.     While true, this is somewhat unsatisfying. It would be nice to say that μ "restricted to" L x is the one-dimensional Lebesgue measure λ 1 , rather than the zero measure . The probability of a "two-dimensional" event E could then be obtained as an integral of the one-dimensional probabilities of the vertical "slices" E ∩ L x : more formally, if μ x denotes one-dimensional Lebesgue measure on L x , then       μ   (  E  )    =    ∫   [  0  ,  1  ]      μ  x    (   E  ∩   L  x    )   d  x          μ  E     subscript    0  1       subscript  μ  x     E   subscript  L  x    normal-d  x      \mu(E)=\int_{[0,1]}\mu_{x}(E\cap L_{x})\,\mathrm{d}x     for any "nice" E ⊆ S . The disintegration theorem makes this argument rigorous in the context of measures on metric spaces .  Statement of the theorem  (Hereafter, P ( X ) will denote the collection of Borel probability measures on a metric space ( X , d ).)  Let Y and X be two Radon spaces (i.e. separable metric spaces on which every probability measure is a Radon measure ). Let μ ∈ P ( Y ), let π : Y → X be a Borel- measurable function , and let   ν   ν   \nu   ∈ P ( X ) be the pushforward measure    ν   ν   \nu   = π ∗ (μ) = μ ∘ π −1 . Then there exists a   ν   ν   \nu   - almost everywhere uniquely determined family of probability measures {μ x } x ∈ X ⊆ P ( Y ) such that   the function    x  ↦   μ  x      maps-to  x   subscript  μ  x     x\mapsto\mu_{x}   is Borel measurable, in the sense that    x  ↦    μ  x    (  B  )       maps-to  x     subscript  μ  x   B     x\mapsto\mu_{x}(B)   is a Borel-measurable function for each Borel-measurable set B ⊆ Y ;  μ x "lives on" the fiber π −1 ( x ): for   ν   ν   \nu   - almost all  x ∈ X ,            μ  x    (   Y  ∖    π   -  1     (  x  )     )    =  0   ,         subscript  μ  x     Y     superscript  π    1    x     0    \mu_{x}\left(Y\setminus\pi^{-1}(x)\right)=0,         and so μ x ( E ) = μ x ( E ∩ π −1 ( x ));    for every Borel-measurable function f : Y → [0, ∞],            ∫  Y    f   (  y  )   d  μ   (  y  )     =    ∫  X     ∫    π   -  1     (  x  )      f   (  y  )   d   μ  x    (  y  )   d  ν   (  x  )       .        subscript   Y     f  y  normal-d  μ  y      subscript   X     subscript      superscript  π    1    x      f  y  normal-d   subscript  μ  x   y  normal-d  ν  x       \int_{Y}f(y)\,\mathrm{d}\mu(y)=\int_{X}\int_{\pi^{-1}(x)}f(y)\,\mathrm{d}\mu_{%
 x}(y)\mathrm{d}\nu(x).         In particular, for any event E ⊆ Y , taking f to be the indicator function of E , 1            μ   (  E  )    =    ∫  X     μ  x    (  E  )   d  ν   (  x  )      .        μ  E     subscript   X      subscript  μ  x   E  normal-d  ν  x      \mu(E)=\int_{X}\mu_{x}\left(E\right)\,\mathrm{d}\nu(x).        Applications  Product spaces  The original example was a special case of the problem of product spaces, to which the disintegration theorem applies.  When Y is written as a Cartesian product  Y = X 1 × X 2 and π i : Y → X i is the natural projection , then each fibre π 1 −1 ( x 1 ) can be canonically identified with X 2 and there exists a Borel family of probability measures     {   μ   x  1    }     x  1   ∈   X  1       subscript    subscript  μ   subscript  x  1        subscript  x  1    subscript  X  1      \{\mu_{x_{1}}\}_{x_{1}\in X_{1}}   in P ( X 2 ) (which is (π 1 ) ∗ (μ)-almost everywhere uniquely determined) such that       μ  =    ∫   X  1       μ   x  1     μ   (    π  1   -  1     (   d   x  1    )    )     =    ∫   X  1       μ   x  1     d    (   π  1   )   *    (  μ  )    (   x  1   )      ,        μ    subscript    subscript  X  1       subscript  μ   subscript  x  1    μ     superscript   subscript  π  1     1      normal-d   subscript  x  1              subscript    subscript  X  1       subscript  μ   subscript  x  1    normal-d   subscript   subscript  π  1     μ   subscript  x  1        \mu=\int_{X_{1}}\mu_{x_{1}}\,\mu\left(\pi_{1}^{-1}(\mathrm{d}x_{1})\right)=%
 \int_{X_{1}}\mu_{x_{1}}\,\mathrm{d}(\pi_{1})_{*}(\mu)(x_{1}),   which is in particular       ∫    X  1   ×   X  2     f   (   x  1   ,   x  2   )   μ   (  d   x  1   ,  d   x  2   )   =   ∫   X  1     (   ∫   X  2    f   (   x  1   ,   x  2   )   μ   (  d   x  2   |   x  1   )   )   μ   (   π  1   -  1     (  d   x  1   )   )      fragments   subscript      subscript  X  1    subscript  X  2     f   fragments  normal-(   subscript  x  1   normal-,   subscript  x  2   normal-)   μ   fragments  normal-(  d   subscript  x  1   normal-,  d   subscript  x  2   normal-)     subscript    subscript  X  1     fragments  normal-(   subscript    subscript  X  2    f   fragments  normal-(   subscript  x  1   normal-,   subscript  x  2   normal-)   μ   fragments  normal-(  d   subscript  x  2   normal-|   subscript  x  1   normal-)   normal-)   μ   fragments  normal-(   superscript   subscript  π  1     1     fragments  normal-(  d   subscript  x  1   normal-)   normal-)     \int_{X_{1}\times X_{2}}f(x_{1},x_{2})\,\mu(\mathrm{d}x_{1},\mathrm{d}x_{2})=%
 \int_{X_{1}}\left(\int_{X_{2}}f(x_{1},x_{2})\mu(\mathrm{d}x_{2}|x_{1})\right)%
 \mu\left(\pi_{1}^{-1}(\mathrm{d}x_{1})\right)   and      μ   (  A  ×  B  )   =   ∫  A   μ   (  B  |   x  1   )   μ   (   π  1   -  1     (  d   x  1   )   )   .     fragments  μ   fragments  normal-(  A   B  normal-)     subscript   A   μ   fragments  normal-(  B  normal-|   subscript  x  1   normal-)   μ   fragments  normal-(   superscript   subscript  π  1     1     fragments  normal-(  d   subscript  x  1   normal-)   normal-)   normal-.    \mu(A\times B)=\int_{A}\mu\left(B|x_{1}\right)\,\mu\left(\pi_{1}^{-1}(\mathrm{%
 d}x_{1})\right).     The relation to conditional expectation is given by the identities      E   (  f  |   π  1   )    (   x  1   )   =   ∫   X  2    f   (   x  1   ,   x  2   )   μ   (  d   x  2   |   x  1   )   ,     fragments  normal-E   fragments  normal-(  f  normal-|   subscript  π  1   normal-)    fragments  normal-(   subscript  x  1   normal-)     subscript    subscript  X  2    f   fragments  normal-(   subscript  x  1   normal-,   subscript  x  2   normal-)   μ   fragments  normal-(  d   subscript  x  2   normal-|   subscript  x  1   normal-)   normal-,    \operatorname{E}(f|\pi_{1})(x_{1})=\int_{X_{2}}f(x_{1},x_{2})\mu(\mathrm{d}x_{%
 2}|x_{1}),         μ   (  A  ×  B  |   π  1   )    (   x  1   )   =   1  A    (   x  1   )   ⋅  μ   (  B  |   x  1   )   .     fragments  μ   fragments  normal-(  A   B  normal-|   subscript  π  1   normal-)    fragments  normal-(   subscript  x  1   normal-)     subscript  1  A    fragments  normal-(   subscript  x  1   normal-)   normal-⋅  μ   fragments  normal-(  B  normal-|   subscript  x  1   normal-)   normal-.    \mu(A\times B|\pi_{1})(x_{1})=1_{A}(x_{1})\cdot\mu(B|x_{1}).     Vector calculus  The disintegration theorem can also be seen as justifying the use of a "restricted" measure in vector calculus . For instance, in Stokes' theorem as applied to a vector field flowing through a compact  surface Σ ⊂ R 3 , it is implicit that the "correct" measure on Σ is the disintegration of three-dimensional Lebesgue measure λ 3 on Σ, and that the disintegration of this measure on ∂Σ is the same as the disintegration of λ 3 on ∂Σ. 2  Conditional distributions  The disintegration theorem can be applied to give a rigorous treatment of conditioning probability distributions in statistics, while avoiding purely abstract formulations of conditional probability. 3  See also   Joint probability distribution  Copula (statistics)  Conditional expectation   References  "  Category:Theorems in measure theory  Category:Probability theorems     ↩  ↩  ↩     
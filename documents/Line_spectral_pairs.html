<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1764">Line spectral pairs</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Line spectral pairs</h1>
<hr/>

<p><strong>Line spectral pairs</strong> (<strong>LSP</strong>) or <strong>line spectral frequencies</strong> (<strong>LSF</strong>) are used to represent <a href="linear_predictive_coding" title="wikilink">linear prediction coefficients</a> (LPC) for transmission over a channel.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> LSPs have several properties (e.g. smaller sensitivity to quantization noise) that make them superior to direct quantization of LPCs. For this reason, LSPs are very useful in <a href="speech_coding" title="wikilink">speech coding</a>. LSP representation was developed by <a href="Fumitada_Itakura" title="wikilink">Fumitada Itakura</a> in the 1970s.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="mathematical-foundation">Mathematical foundation</h2>

<p>The LP <a class="uri" href="polynomial" title="wikilink">polynomial</a> 

<math display="inline" id="Line_spectral_pairs:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>p</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>k</mi>
      </msub>
      <msup>
       <mi>z</mi>
       <mrow>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(z)=1-\sum_{k=1}^{p}a_{k}z^{-k}
  </annotation>
 </semantics>
</math>

 can be expressed as 

<math display="inline" id="Line_spectral_pairs:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>0.5</mn>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>Q</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="float">0.5</cn>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <times></times>
        <ci>Q</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(z)=0.5[P(z)+Q(z)]
  </annotation>
 </semantics>
</math>

, where:</p>
<ul>
<li>

<math display="inline" id="Line_spectral_pairs:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>z</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(z)=A(z)+z^{-(p+1)}A(z^{-1})
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Line_spectral_pairs:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>z</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z)=A(z)-z^{-(p+1)}A(z^{-1})
  </annotation>
 </semantics>
</math>


</li>
</ul>

<p>By construction, <em>P</em> is a <strong><a href="palindromic_polynomial" title="wikilink">palindromic polynomial</a></strong> and <em>Q</em> an <strong>antipalindromic polynomial</strong>; physically <em>P</em>(<em>z</em>) corresponds to the vocal tract with the <a class="uri" href="glottis" title="wikilink">glottis</a> closed and <em>Q</em>(<em>z</em>) with the <a class="uri" href="glottis" title="wikilink">glottis</a> open.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> It can be shown that:</p>
<ul>
<li>The <a href="zero_of_a_function" title="wikilink">roots</a> of <em>P</em> and <em>Q</em> lie on the <a href="unit_circle" title="wikilink">unit circle</a> in the complex plane.</li>
<li>The roots of <em>P</em> alternate with those of <em>Q</em> as we travel around the circle.</li>
<li>As the coefficients of <em>P</em> and <em>Q</em> are real, the roots occur in <a href="Complex_conjugate_root_theorem" title="wikilink">conjugate pairs</a></li>
</ul>

<p>The Line Spectral Pair representation of the LP polynomial consists simply of the location of the roots of <em>P</em> and <em>Q</em> (i.e. 

<math display="inline" id="Line_spectral_pairs:4">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Line_spectral_pairs:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>i</mi>
      <mi>ω</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>ω</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>z</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=e^{i\omega},P(z)=0
  </annotation>
 </semantics>
</math>

). As they occur in pairs, only half of the actual roots (conventionally between 0 and 

<math display="inline" id="Line_spectral_pairs:6">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

) need be transmitted. The total number of coefficients for both <em>P</em> and <em>Q</em> is therefore equal to <em>p</em>, the number of original LP coefficients (not counting 

<math display="inline" id="Line_spectral_pairs:7">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}=1
  </annotation>
 </semantics>
</math>

).</p>

<p>A common algorithm for finding these<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> is to evaluate the polynomial at a sequence of closely spaced around the unit circle, observing when the result changes sign; when it does a root must lie between the points tested. Because the roots of <em>P</em> are interspersed with those of <em>Q</em> a single pass is sufficient to find the roots of both polynomials.</p>

<p>To convert back to LPCs, we need to evaluate 

<math display="inline" id="Line_spectral_pairs:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>0.5</mn>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>Q</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="float">0.5</cn>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <times></times>
        <ci>Q</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A(z)=0.5[P(z)+Q(z)]
  </annotation>
 </semantics>
</math>


 by "clocking" an impulse through it <em>N</em> times (order of the filter), yielding the original filter, <em>A</em>(<em>z</em>).</p>
<h2 id="properties">Properties</h2>

<p>Line spectral pairs have several interesting and useful properties. When the roots of <em>P</em>(<em>z</em>) and <em>Q</em>(<em>z</em>) are interleaved, stability of the filter is ensured if and only if the roots are monotonically increasing. Moreover, the closer two roots are, the more resonant the filter is at the corresponding frequency. Because LSPs are not overly sensitive to quantization noise and stability is easily ensured, LSP are widely used for quantizing LPC filters. Line spectral frequencies can be interpolated.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Log_Area_Ratios" title="wikilink">Log Area Ratios</a></li>
</ul>
<h2 id="sources">Sources</h2>
<ul>
<li><a href="http://speex.org/docs/">Speex manual</a> and source code (lsp.c)</li>
<li><a href="http://www.ece.mcgill.ca/~pkabal/papers/1986/Kabal1986.pdf">"The Computation of Line Spectral Frequencies Using Chebyshev Polynomials"</a>/ P. Kabal and R. P. Ramachandran. IEEE Trans. Acoustics, Speech, Signal Processing, vol. 34, no. 6, pp. 1419–1426, Dec. 1986.</li>
</ul>

<p>Includes an overview in relation to LPC.</p>
<ul>
<li><a href="http://www.dspcsp.com/pdf/lsp.pdf">"Line Spectral Pairs" chapter</a> as an online excerpt (pdf) / "Digital Signal Processing - A Computer Science Perspective" (ISBN 0-471-29546-9) <a href="Jonathan_Stein" title="wikilink">Jonathan Stein</a>.</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Lossy_compression_algorithms" title="wikilink">Category:Lossy compression algorithms</a> <a href="Category:Digital_signal_processing" title="wikilink">Category:Digital signal processing</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">See e.g. <a class="uri" href="http://www.work.caltech.edu/~ling/pub/icslp98lsp.pdf">http://www.work.caltech.edu/~ling/pub/icslp98lsp.pdf</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a class="uri" href="http://svr-www.eng.cam.ac.uk/~ajr/SpeechAnalysis/node51.html#SECTION000713000000000000000">http://svr-www.eng.cam.ac.uk/~ajr/SpeechAnalysis/node51.html#SECTION000713000000000000000</a> Tony Robinson: Speech Analysis<a href="#fnref3">↩</a></li>
<li id="fn4">e.g. lsf.c in <a class="uri" href="http://www.ietf.org/rfc/rfc3951.txt">http://www.ietf.org/rfc/rfc3951.txt</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1064">Runge–Kutta methods</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Runge–Kutta methods</h1>
<hr/>

<p>In <a href="numerical_analysis" title="wikilink">numerical analysis</a>, the <strong>Runge–Kutta methods</strong> are an important family of implicit and explicit iterative methods, which are used in <a href="temporal_discretization" title="wikilink">temporal discretization</a> for the approximation of solutions of <a href="ordinary_differential_equation" title="wikilink">ordinary differential equations</a>. These techniques were developed around 1900 by the German mathematicians <a href="Carl_David_Tolmé_Runge" title="wikilink">C. Runge</a> and <a href="Martin_Wilhelm_Kutta" title="wikilink">M. W. Kutta</a>.</p>

<p>See the article on <a href="numerical_ordinary_differential_equations" title="wikilink">numerical methods for ordinary differential equations</a> for more background and other methods. See also <a href="List_of_Runge–Kutta_methods" title="wikilink">List of Runge–Kutta methods</a>.</p>
<h2 id="the-rungekutta-method"><em>The</em> Runge–Kutta method</h2>

<p>One member of the family of Runge–Kutta methods is often referred to as "<strong>RK4</strong>", "<strong>classical Runge–Kutta method</strong>" or simply as "<strong><em>the</em> Runge–Kutta method</strong>".</p>

<p>Let an <a href="initial_value_problem" title="wikilink">initial value problem</a> be specified as follows.</p>

<p>

<math display="block" id="Runge–Kutta_methods:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>y</mi>
      <mo>˙</mo>
     </mover>
     <mo>=</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mi>y</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-˙</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <ci>t</ci>
       <ci>y</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{y}=f(t,y),\quad y(t_{0})=y_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Here, <em>y</em> is an unknown function (scalar or vector) of time <em>t</em> which we would like to approximate; we are told that 

<math display="inline" id="Runge–Kutta_methods:1">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo>˙</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-˙</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{y}
  </annotation>
 </semantics>
</math>

, the rate at which <em>y</em> changes, is a function of <em>t</em> and of <em>y</em> itself. At the initial time 

<math display="inline" id="Runge–Kutta_methods:2">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{0}
  </annotation>
 </semantics>
</math>

 the corresponding <em>y</em>-value is 

<math display="inline" id="Runge–Kutta_methods:3">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}
  </annotation>
 </semantics>
</math>

. The function <em>f</em> and the data 

<math display="inline" id="Runge–Kutta_methods:4">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{0}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Runge–Kutta_methods:5">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}
  </annotation>
 </semantics>
</math>

 are given.</p>

<p>Now pick a step-size <em>h</em>&gt;0 and define</p>

<p>

<math display="inline" id="Runge–Kutta_methods:6">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle y_{n+1}
  </annotation>
 </semantics>
</math>


</p>

<p>for <em>n</em> = 0, 1, 2, 3, . . . , using</p>

<p>

<math display="inline" id="Runge–Kutta_methods:7">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle k_{1}
  </annotation>
 </semantics>
</math>


 <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<dl>
<dd><em>(Note: the above equations have different but equivalent definitions in different texts).</em><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a>
</dd>
</dl>

<p>Here 

<math display="inline" id="Runge–Kutta_methods:8">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}
  </annotation>
 </semantics>
</math>

 is the RK4 approximation of 

<math display="inline" id="Runge–Kutta_methods:9">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>t</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y(t_{n+1})
  </annotation>
 </semantics>
</math>

, and the next value (

<math display="inline" id="Runge–Kutta_methods:10">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}
  </annotation>
 </semantics>
</math>

) is determined by the present value (

<math display="inline" id="Runge–Kutta_methods:11">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n}
  </annotation>
 </semantics>
</math>

) plus the <a href="weighted_average" title="wikilink">weighted average</a> of four increments, where each increment is the product of the size of the interval, <em>h</em>, and an estimated slope specified by function <em>f</em> on the right-hand side of the differential equation.</p>
<ul>
<li>

<math display="inline" id="Runge–Kutta_methods:12">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}
  </annotation>
 </semantics>
</math>

 is the increment based on the slope at the beginning of the interval, using 

<math display="inline" id="Runge–Kutta_methods:13">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {y}
  </annotation>
 </semantics>
</math>

, (<a href="Euler's_method" title="wikilink">Euler's method</a>) ;</li>
<li>

<math display="inline" id="Runge–Kutta_methods:14">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{2}
  </annotation>
 </semantics>
</math>

 is the increment based on the slope at the midpoint of the interval, using 

<math display="inline" id="Runge–Kutta_methods:15">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>+</mo>
   <mrow>
    <mfrac>
     <mi>h</mi>
     <mn>2</mn>
    </mfrac>
    <msub>
     <mi>k</mi>
     <mn>1</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>y</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {y}+\tfrac{h}{2}k_{1}
  </annotation>
 </semantics>
</math>

 ;</li>
<li>

<math display="inline" id="Runge–Kutta_methods:16">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{3}
  </annotation>
 </semantics>
</math>

 is again the increment based on the slope at the midpoint, but now using 

<math display="inline" id="Runge–Kutta_methods:17">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>+</mo>
   <mrow>
    <mfrac>
     <mi>h</mi>
     <mn>2</mn>
    </mfrac>
    <msub>
     <mi>k</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>y</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {y}+\tfrac{h}{2}k_{2}
  </annotation>
 </semantics>
</math>

 ;</li>
<li>

<math display="inline" id="Runge–Kutta_methods:18">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{4}
  </annotation>
 </semantics>
</math>

 is the increment based on the slope at the end of the interval, using 

<math display="inline" id="Runge–Kutta_methods:19">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>+</mo>
   <mrow>
    <mi>h</mi>
    <msub>
     <mi>k</mi>
     <mn>3</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {y}+hk_{3}
  </annotation>
 </semantics>
</math>

 .</li>
</ul>

<p>In averaging the four increments, greater weight is given to the increments at the midpoint. If 

<math display="inline" id="Runge–Kutta_methods:20">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is independent of 

<math display="inline" id="Runge–Kutta_methods:21">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, so that the differential equation is equivalent to a simple integral, then RK4 is <a href="Simpson's_rule" title="wikilink">Simpson's rule</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The RK4 method is a fourth-order method, meaning that the <a href="Truncation_error_(numerical_integration)" title="wikilink">local truncation error</a> is <a href="Big_O_notation" title="wikilink">on the order of</a> 

<math display="inline" id="Runge–Kutta_methods:22">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>5</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(h^{5})
  </annotation>
 </semantics>
</math>

, while the total accumulated error is order 

<math display="inline" id="Runge–Kutta_methods:23">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>4</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(h^{4})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="explicit-rungekutta-methods">Explicit Runge–Kutta methods</h2>

<p>The family of <a href="Explicit_and_implicit_methods" title="wikilink">explicit</a> Runge–Kutta methods is a generalization of the RK4 method mentioned above. It is given by</p>

<p>

<math display="block" id="Runge–Kutta_methods:24">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>s</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>b</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>k</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=y_{n}+h\sum_{i=1}^{s}b_{i}k_{i},
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Runge–Kutta_methods:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>k</mi>
     <mn>1</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mi>n</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>n</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}=f(t_{n},y_{n}),\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Runge–Kutta_methods:26">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>k</mi>
     <mn>2</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
        <mi>h</mi>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <mi>h</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>a</mi>
           <mn>21</mn>
          </msub>
          <msub>
           <mi>k</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <ci>h</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <cn type="integer">21</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{2}=f(t_{n}+c_{2}h,y_{n}+h(a_{21}k_{1})),\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Runge–Kutta_methods:27">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>k</mi>
     <mn>3</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mn>3</mn>
        </msub>
        <mi>h</mi>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <mi>h</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <msub>
            <mi>a</mi>
            <mn>31</mn>
           </msub>
           <msub>
            <mi>k</mi>
            <mn>1</mn>
           </msub>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>a</mi>
            <mn>32</mn>
           </msub>
           <msub>
            <mi>k</mi>
            <mn>2</mn>
           </msub>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">3</cn>
        </apply>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <ci>h</ci>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <cn type="integer">31</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <cn type="integer">32</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{3}=f(t_{n}+c_{3}h,y_{n}+h(a_{31}k_{1}+a_{32}k_{2})),\,
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Runge–Kutta_methods:28">
 <semantics>
  <mi mathvariant="normal">⋮</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-⋮</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vdots
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd>

<math display="inline" id="Runge–Kutta_methods:29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>k</mi>
     <mi>s</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>c</mi>
         <mi>s</mi>
        </msub>
        <mi>h</mi>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mrow>
        <mi>h</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <msub>
            <mi>a</mi>
            <mrow>
             <mi>s</mi>
             <mn>1</mn>
            </mrow>
           </msub>
           <msub>
            <mi>k</mi>
            <mn>1</mn>
           </msub>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>a</mi>
            <mrow>
             <mi>s</mi>
             <mn>2</mn>
            </mrow>
           </msub>
           <msub>
            <mi>k</mi>
            <mn>2</mn>
           </msub>
          </mrow>
          <mo>+</mo>
          <mi mathvariant="normal">⋯</mi>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>a</mi>
            <mrow>
             <mi>s</mi>
             <mo>,</mo>
             <mrow>
              <mi>s</mi>
              <mo>-</mo>
              <mn>1</mn>
             </mrow>
            </mrow>
           </msub>
           <msub>
            <mi>k</mi>
            <mrow>
             <mi>s</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msub>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>s</ci>
        </apply>
        <ci>h</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <ci>h</ci>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <apply>
            <times></times>
            <ci>s</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <apply>
            <times></times>
            <ci>s</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <ci>normal-⋯</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <list>
            <ci>s</ci>
            <apply>
             <minus></minus>
             <ci>s</ci>
             <cn type="integer">1</cn>
            </apply>
           </list>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <apply>
            <minus></minus>
            <ci>s</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{s}=f(t_{n}+c_{s}h,y_{n}+h(a_{s1}k_{1}+a_{s2}k_{2}+\cdots+a_{s,s-1}k_{s-1})).
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a>
</dd>
<dd><em>(Note: the above equations have different but equivalent definitions in different texts).</em><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a>
</dd>
</dl>

<p>To specify a particular method, one needs to provide the integer <em>s</em> (the number of stages), and the coefficients <em>a<sub>ij</sub></em> (for 1 ≤ <em>j</em> i'' (for <em>i</em> = 1, 2, ..., <em>s</em>) and <em>c<sub>i</sub></em> (for <em>i</em> = 2, 3, ..., <em>s</em>). The matrix [<em>a<sub>ij</sub></em>] is called the <em>Runge–Kutta matrix</em>, while the <em>b<sub>i</sub></em> and <em>c<sub>i</sub></em> are known as the <em>weights</em> and the <em>nodes</em>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> These data are usually arranged in a mnemonic device, known as a <em>Butcher tableau</em> (after <a href="John_C._Butcher" title="wikilink">John C. Butcher</a>):</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:30">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{2}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:31">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{3}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:32">
 <semantics>
  <mi mathvariant="normal">⋮</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-⋮</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vdots
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:33">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{s}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>The Runge–Kutta method is consistent if</p>

<p>

<math display="block" id="Runge–Kutta_methods:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mpadded width="+5pt">
       <msub>
        <mi>c</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
      <mpadded width="+5pt">
       <mi>for</mi>
      </mpadded>
      <mi>i</mi>
     </mrow>
     <mo>=</mo>
     <mn>2</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>i</ci>
       </apply>
       <ci>for</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <list>
     <ci>normal-…</ci>
     <ci>s</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{i-1}a_{ij}=c_{i}\ \mathrm{for}\ i=2,\ldots,s.
  </annotation>
 </semantics>
</math>

 There are also accompanying requirements if one requires the method to have a certain order <em>p</em>, meaning that the local truncation error is O(<em>h<sup>p</sup></em><sup>+1</sup>). These can be derived from the definition of the truncation error itself. For example, a two-stage method has order 2 if <em>b</em><sub>1</sub> + <em>b</em><sub>2</sub> = 1, <em>b</em><sub>2</sub><em>c</em><sub>2</sub> = 1/2, and <em>a</em><sub>21</sub> = <em>c</em><sub>2</sub>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>In general, if an explicit 

<math display="inline" id="Runge–Kutta_methods:35">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

-stage Runge-Kutta method has order 

<math display="inline" id="Runge–Kutta_methods:36">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Runge–Kutta_methods:37">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>≥</mo>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>s</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\geq p
  </annotation>
 </semantics>
</math>

, and if 

<math display="inline" id="Runge–Kutta_methods:38">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>≥</mo>
   <mn>5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>p</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\geq 5
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Runge–Kutta_methods:39">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>></mo>
   <mi>p</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>s</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s>p
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The minimum 

<math display="inline" id="Runge–Kutta_methods:40">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 required for an explicit 

<math display="inline" id="Runge–Kutta_methods:41">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

-stage Runge-Kutta method to have order 

<math display="inline" id="Runge–Kutta_methods:42">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is an open problem. Some values which are known are <a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>

<math display="block" id="Runge–Kutta_methods:43">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd class="ltx_border_r" columnalign="center">
     <mi>p</mi>
    </mtd>
    <mtd columnalign="center">
     <mn>1</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>2</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>3</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>4</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>5</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>6</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>7</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>8</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t" columnalign="center">
     <mrow>
      <mi>min</mi>
      <mi>s</mi>
     </mrow>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>1</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>2</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>3</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>4</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>6</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>7</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>9</mn>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>11</mn>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>p</ci>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
     <cn type="integer">4</cn>
     <cn type="integer">5</cn>
     <cn type="integer">6</cn>
     <cn type="integer">7</cn>
     <cn type="integer">8</cn>
    </matrixrow>
    <matrixrow>
     <apply>
      <min></min>
      <ci>s</ci>
     </apply>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
     <cn type="integer">4</cn>
     <cn type="integer">6</cn>
     <cn type="integer">7</cn>
     <cn type="integer">9</cn>
     <cn type="integer">11</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{c|cccccccc}p&1&2&3&4&5&6&7&8\\
\hline\min s&1&2&3&4&6&7&9&11\end{array}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="examples">Examples</h3>

<p>The RK4 method falls in this framework. Its tableau is:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1/2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1/2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>A slight variation of "the" Runge–Kutta method is also due to Kutta in 1901 and is called the 3/8-rule.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> The primary advantage this method has is that almost all of the error coefficients are smaller than the popular method, but it requires slightly more FLOPs (floating point operations) per time step. Its Butcher tableau is given by:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1/3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>2/3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>However, the simplest Runge–Kutta method is the (forward) <a href="Euler_method" title="wikilink">Euler method</a>, given by the formula 

<math display="inline" id="Runge–Kutta_methods:44">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mi>n</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=y_{n}+hf(t_{n},y_{n})
  </annotation>
 </semantics>
</math>

. This is the only consistent explicit Runge–Kutta method with one stage. The corresponding tableau is:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>style="border-right:1px solid; border-bottom:1px solid;" 0</p></td>
<td style="text-align: left;">
<p>style="border-bottom:1px solid;"</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
</tbody>
</table>
<h3 id="second-order-methods-with-two-stages">Second-order methods with two stages</h3>

<p>An example of a second-order method with two stages is provided by the <a href="midpoint_method" title="wikilink">midpoint method</a></p>

<p>

<math display="block" id="Runge–Kutta_methods:45">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mi>n</mi>
        </msub>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mi>n</mi>
        </msub>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mi>h</mi>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>t</mi>
           <mi>n</mi>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mi>n</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>h</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>h</ci>
         <ci>f</ci>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <ci>n</ci>
          </apply>
         </interval>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=y_{n}+hf\left(t_{n}+\frac{1}{2}h,y_{n}+\frac{1}{2}hf(t_{n},y_{n})%
\right).
  </annotation>
 </semantics>
</math>

 The corresponding tableau is:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1/2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>The midpoint method is not the only second-order Runge–Kutta method with two stages; there is a family of such methods, parameterized by α, and given by the formula</p>

<p>

<math display="block" id="Runge–Kutta_methods:46">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo maxsize="120%" minsize="120%">(</mo>
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mstyle displaystyle="false">
            <mfrac>
             <mn>1</mn>
             <mrow>
              <mn>2</mn>
              <mi>α</mi>
             </mrow>
            </mfrac>
           </mstyle>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>t</mi>
           <mi>n</mi>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mi>n</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mn>2</mn>
            <mi>α</mi>
           </mrow>
          </mfrac>
         </mstyle>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>t</mi>
            <mi>n</mi>
           </msub>
           <mo>+</mo>
           <mrow>
            <mi>α</mi>
            <mi>h</mi>
           </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
           <msub>
            <mi>y</mi>
            <mi>n</mi>
           </msub>
           <mo>+</mo>
           <mrow>
            <mi>α</mi>
            <mi>h</mi>
            <mi>f</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>t</mi>
              <mi>n</mi>
             </msub>
             <mo>,</mo>
             <msub>
              <mi>y</mi>
              <mi>n</mi>
             </msub>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo maxsize="120%" minsize="120%">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>α</ci>
          </apply>
         </apply>
        </apply>
        <ci>f</ci>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>n</ci>
         </apply>
        </interval>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>α</ci>
         </apply>
        </apply>
        <ci>f</ci>
        <interval closure="open">
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <times></times>
           <ci>α</ci>
           <ci>h</ci>
          </apply>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <times></times>
           <ci>α</ci>
           <ci>h</ci>
           <ci>f</ci>
           <interval closure="open">
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <ci>n</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <ci>n</ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </interval>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=y_{n}+h\bigl((1-\tfrac{1}{2\alpha})f(t_{n},y_{n})+\tfrac{1}{2\alpha}f(%
t_{n}+\alpha h,y_{n}+\alpha hf(t_{n},y_{n}))\bigr).
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>Its Butcher tableau is</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:47">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>In this family, 

<math display="inline" id="Runge–Kutta_methods:48">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mn>2</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=\tfrac{1}{2}
  </annotation>
 </semantics>
</math>

 gives the midpoint method and 

<math display="inline" id="Runge–Kutta_methods:49">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=1
  </annotation>
 </semantics>
</math>

 is <a href="Heun's_method" title="wikilink">Heun's method</a>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="usage">Usage</h2>

<p>As an example, consider the two-stage second-order Runge–Kutta method with α = 2/3, also known as <a href="Heun's_method#Runge.E2.80.93Kutta_method" title="wikilink">Ralston method</a>. It is given by the tableau</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>2/3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>with the corresponding equations</p>

<p>

<math display="inline" id="Runge–Kutta_methods:50">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle k_{1}
  </annotation>
 </semantics>
</math>


</p>

<p>This method is used to solve the initial-value problem</p>

<p>

<math display="block" id="Runge–Kutta_methods:51">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>y</mi>
     <mo>′</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>tan</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mo rspace="7.5pt">,</mo>
    <mrow>
     <mi>t</mi>
     <mo>∈</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mn>1</mn>
      <mo>,</mo>
      <mn>1.1</mn>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <tan></tan>
       <ci>y</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <in></in>
      <ci>t</ci>
      <interval closure="closed">
       <cn type="integer">1</cn>
       <cn type="float">1.1</cn>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}=\tan(y)+1,\quad y_{0}=1,\ t\in[1,1.1]
  </annotation>
 </semantics>
</math>

 with step size <em>h</em> = 0.025, so the method needs to take four steps.</p>

<p>The method proceeds as follows:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:52">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{0}=1\colon
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:53">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}=1
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:54">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>1</mn>
    </msub>
    <mo>=</mo>
    <mn>1.025</mn>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="float">1.025</cn>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{1}=1.025\colon
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:55">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}=1
  </annotation>
 </semantics>
</math>


</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:56">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>2.557407725</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">2.557407725</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}=2.557407725
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:57">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>4</mn>
        </mfrac>
        <msub>
         <mi>k</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mn>3</mn>
         <mn>4</mn>
        </mfrac>
        <msub>
         <mi>k</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <munder accentunder="true">
    <mn>1.066869388</mn>
    <mo>¯</mo>
   </munder>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">3</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-¯</ci>
      <cn type="float">1.066869388</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1}=y_{0}+h(\tfrac{1}{4}k_{1}+\tfrac{3}{4}k_{2})=\underline{1.066869388}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:58">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>2</mn>
    </msub>
    <mo>=</mo>
    <mn>1.05</mn>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="float">1.05</cn>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{2}=1.05\colon
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:59">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>1.066869388</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">1.066869388</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1}=1.066869388
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:60">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>2.813524695</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">2.813524695</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}=2.813524695
  </annotation>
 </semantics>
</math>


</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:61">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>4</mn>
        </mfrac>
        <msub>
         <mi>k</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mn>3</mn>
         <mn>4</mn>
        </mfrac>
        <msub>
         <mi>k</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <munder accentunder="true">
    <mn>1.141332181</mn>
    <mo>¯</mo>
   </munder>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">3</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-¯</ci>
      <cn type="float">1.141332181</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{2}=y_{1}+h(\tfrac{1}{4}k_{1}+\tfrac{3}{4}k_{2})=\underline{1.141332181}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:62">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>3</mn>
    </msub>
    <mo>=</mo>
    <mn>1.075</mn>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">3</cn>
     </apply>
     <cn type="float">1.075</cn>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{3}=1.075\colon
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:63">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mn>1.141332181</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">2</cn>
    </apply>
    <cn type="float">1.141332181</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{2}=1.141332181
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:64">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>3.183536647</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">3.183536647</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}=3.183536647
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:65">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>2</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>4</mn>
        </mfrac>
        <msub>
         <mi>k</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mn>3</mn>
         <mn>4</mn>
        </mfrac>
        <msub>
         <mi>k</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <munder accentunder="true">
    <mn>1.227417567</mn>
    <mo>¯</mo>
   </munder>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">3</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-¯</ci>
      <cn type="float">1.227417567</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{3}=y_{2}+h(\tfrac{1}{4}k_{1}+\tfrac{3}{4}k_{2})=\underline{1.227417567}
  </annotation>
 </semantics>
</math>


</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:66">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>4</mn>
    </msub>
    <mo>=</mo>
    <mn>1.1</mn>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">4</cn>
     </apply>
     <cn type="float">1.1</cn>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{4}=1.1\colon
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:67">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mn>1.227417567</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">3</cn>
    </apply>
    <cn type="float">1.227417567</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{3}=1.227417567
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:68">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>3.796866512</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="float">3.796866512</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}=3.796866512
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:69">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>4</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>3</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>4</mn>
         </mfrac>
         <msub>
          <mi>k</mi>
          <mn>1</mn>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mn>3</mn>
          <mn>4</mn>
         </mfrac>
         <msub>
          <mi>k</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <munder accentunder="true">
     <mn>1.335079087</mn>
     <mo>¯</mo>
    </munder>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">3</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-¯</ci>
      <cn type="float">1.335079087</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{4}=y_{3}+h(\tfrac{1}{4}k_{1}+\tfrac{3}{4}k_{2})=\underline{1.335079087}.
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>

<p>The numerical solutions correspond to the underlined values.</p>
<h2 id="adaptive-rungekutta-methods">Adaptive Runge–Kutta methods</h2>

<p>The adaptive methods are designed to produce an estimate of the local truncation error of a single Runge–Kutta step. This is done by having two methods in the tableau, one with order 

<math display="inline" id="Runge–Kutta_methods:70">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


 and one with order 

<math display="inline" id="Runge–Kutta_methods:71">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>p</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p-1
  </annotation>
 </semantics>
</math>

.</p>

<p>The lower-order step is given by</p>

<p>

<math display="block" id="Runge–Kutta_methods:72">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>*</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>s</mi>
       </munderover>
       <mrow>
        <msubsup>
         <mi>b</mi>
         <mi>i</mi>
         <mo>*</mo>
        </msubsup>
        <msub>
         <mi>k</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <times></times>
     </apply>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>b</ci>
          <times></times>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{*}_{n+1}=y_{n}+h\sum_{i=1}^{s}b^{*}_{i}k_{i},
  </annotation>
 </semantics>
</math>

 where the 

<math display="inline" id="Runge–Kutta_methods:73">
 <semantics>
  <msub>
   <mi>k</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{i}
  </annotation>
 </semantics>
</math>

 are the same as for the higher-order method. Then the error is</p>

<p>

<math display="block" id="Runge–Kutta_methods:74">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>e</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msubsup>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>*</mo>
     </msubsup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>s</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>b</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <msubsup>
          <mi>b</mi>
          <mi>i</mi>
          <mo>*</mo>
         </msubsup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>k</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <times></times>
       </apply>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>b</ci>
           <times></times>
          </apply>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{n+1}=y_{n+1}-y^{*}_{n+1}=h\sum_{i=1}^{s}(b_{i}-b^{*}_{i})k_{i},
  </annotation>
 </semantics>
</math>

 which is 

<math display="inline" id="Runge–Kutta_methods:75">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mi>p</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(h^{p})
  </annotation>
 </semantics>
</math>


. The Butcher tableau for this kind of method is extended to give the values of 

<math display="inline" id="Runge–Kutta_methods:76">
 <semantics>
  <msubsup>
   <mi>b</mi>
   <mi>i</mi>
   <mo>*</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <times></times>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{*}_{i}
  </annotation>
 </semantics>
</math>

:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:77">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{2}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:78">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{3}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:79">
 <semantics>
  <mi mathvariant="normal">⋮</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-⋮</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vdots
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Runge–Kutta_methods:80">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{s}
  </annotation>
 </semantics>
</math>


</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>The <a href="Runge–Kutta–Fehlberg_method" title="wikilink">Runge–Kutta–Fehlberg method</a> has two methods of orders 5 and 4. Its extended Butcher tableau is:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1/4</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>3/8</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>12/13</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1/2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>However, the simplest adaptive Runge–Kutta method involves combining <a href="Heun's_method" title="wikilink">Heun's method</a>, which is order 2, with the <a href="Euler_method" title="wikilink">Euler method</a>, which is order 1. Its extended Butcher tableau is:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>

<p>The error estimate is used to control the step size.</p>

<p>Other adaptive Runge–Kutta methods are the <a href="Bogacki–Shampine_method" title="wikilink">Bogacki–Shampine method</a> (orders 3 and 2), the <a href="Cash–Karp_method" title="wikilink">Cash–Karp method</a> and the <a href="Dormand–Prince_method" title="wikilink">Dormand–Prince method</a> (both with orders 5 and 4).</p>
<h2 id="nonconfluent-rungekutta-methods">Nonconfluent Runge–Kutta methods</h2>

<p>A Runge–Kutta method is said to be <em>nonconfluent</em> <a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> if all the 

<math display="inline" id="Runge–Kutta_methods:81">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>i</mi>
     </msub>
     <mo rspace="4.2pt">,</mo>
     <mi>i</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>s</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>i</ci>
      </apply>
      <ci>i</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <ci>s</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{i},\,i=1,2,\ldots,s
  </annotation>
 </semantics>
</math>

 are distinct.</p>
<h2 id="implicit-rungekutta-methods">Implicit Runge–Kutta methods</h2>

<p>All Runge–Kutta methods mentioned up to now are <a href="explicit_and_implicit_methods" title="wikilink">explicit methods</a>. Explicit Runge–Kutta methods are generally unsuitable for the solution of <a href="stiff_equation" title="wikilink">stiff equations</a> because their region of absolute stability is small; in particular, it is bounded.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> This issue is especially important in the solution of <a href="Numerical_partial_differential_equations" title="wikilink">partial differential equations</a>.</p>

<p>The instability of explicit Runge–Kutta methods motivates the development of implicit methods. An implicit Runge–Kutta method has the form</p>

<p>

<math display="block" id="Runge–Kutta_methods:82">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>s</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>b</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>k</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=y_{n}+h\sum_{i=1}^{s}b_{i}k_{i},
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Runge–Kutta_methods:83">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>i</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mi>n</mi>
        </msub>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>c</mi>
          <mi>i</mi>
         </msub>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mi>n</mi>
        </msub>
        <mo>+</mo>
        <mrow>
         <mi>h</mi>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mrow>
            <mi>j</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>s</mi>
          </munderover>
          <mrow>
           <msub>
            <mi>a</mi>
            <mrow>
             <mi>i</mi>
             <mi>j</mi>
            </mrow>
           </msub>
           <msub>
            <mi>k</mi>
            <mi>j</mi>
           </msub>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <mi>s</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>i</ci>
         </apply>
         <ci>h</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>j</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>s</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>a</ci>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>j</ci>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>s</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{i}=f\left(t_{n}+c_{i}h,y_{n}+h\sum_{j=1}^{s}a_{ij}k_{j}\right),\quad i=1,%
\ldots,s.
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>The difference with an explicit method is that in an explicit method, the sum over <em>j</em> only goes up to <em>i</em> − 1. This also shows up in the Butcher tableau: the coefficient matrix 

<math display="inline" id="Runge–Kutta_methods:84">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{ij}
  </annotation>
 </semantics>
</math>

 of an explicit method is lower triangular. In an implicit method, the sum over <em>j</em> goes up to <em>s</em> and the coefficient matrix is not triangular, yielding a Butcher tableau of the form<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>

<p>

<math display="block" id="Runge–Kutta_methods:85">
 <semantics>
  <mrow>
   <mtable displaystyle="true">
    <mtr>
     <mtd class="ltx_border_r" columnalign="center">
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mn>11</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mn>12</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">…</mi>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mrow>
        <mn>1</mn>
        <mi>s</mi>
       </mrow>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd class="ltx_border_r" columnalign="center">
      <msub>
       <mi>c</mi>
       <mn>2</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mn>21</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mn>22</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">…</mi>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mrow>
        <mn>2</mn>
        <mi>s</mi>
       </mrow>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd class="ltx_border_r" columnalign="center">
      <mi mathvariant="normal">⋮</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋮</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋮</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋱</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋮</mi>
     </mtd>
    </mtr>
    <mtr>
     <mtd class="ltx_border_r" columnalign="center">
      <msub>
       <mi>c</mi>
       <mi>s</mi>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>s</mi>
        <mn>1</mn>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>s</mi>
        <mn>2</mn>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">…</mi>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>a</mi>
       <mrow>
        <mi>s</mi>
        <mi>s</mi>
       </mrow>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd class="ltx_border_r ltx_border_t">
      <mi></mi>
     </mtd>
     <mtd class="ltx_border_t" columnalign="center">
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
     </mtd>
     <mtd class="ltx_border_t" columnalign="center">
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
     </mtd>
     <mtd class="ltx_border_t" columnalign="center">
      <mi mathvariant="normal">…</mi>
     </mtd>
     <mtd class="ltx_border_t" columnalign="center">
      <msub>
       <mi>b</mi>
       <mi>s</mi>
      </msub>
     </mtd>
    </mtr>
   </mtable>
   <mo>=</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd class="ltx_border_r" columnalign="center">
      <mi>𝐜</mi>
     </mtd>
     <mtd columnalign="center">
      <mi>A</mi>
     </mtd>
    </mtr>
    <mtr>
     <mtd class="ltx_border_r ltx_border_t">
      <mi></mi>
     </mtd>
     <mtd class="ltx_border_t" columnalign="center">
      <msup>
       <mi>𝐛</mi>
       <mi>𝐓</mi>
      </msup>
     </mtd>
    </mtr>
   </mtable>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">11</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">12</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>s</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">21</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">22</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>s</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <ci>normal-⋮</ci>
      <ci>normal-⋮</ci>
      <ci>normal-⋮</ci>
      <ci>normal-⋱</ci>
      <ci>normal-⋮</ci>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>s</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>s</ci>
      </apply>
     </matrixrow>
    </matrix>
    <matrix>
     <matrixrow>
      <ci>𝐜</ci>
      <ci>A</ci>
     </matrixrow>
     <matrixrow>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐛</ci>
       <ci>𝐓</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{c|cccc}c_{1}&a_{11}&a_{12}&\dots&a_{1s}\\
c_{2}&a_{21}&a_{22}&\dots&a_{2s}\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
c_{s}&a_{s1}&a_{s2}&\dots&a_{ss}\\
\hline&b_{1}&b_{2}&\dots&b_{s}\\
\end{array}=\par
\begin{array}[]{c|c}\mathbf{c}&A\\
\hline&\mathbf{b^{T}}\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>The consequence of this difference is that at every step, a system of algebraic equations has to be solved. This increases the computational cost considerably. If a method with <em>s</em> stages is used to solve a differential equation with <em>m</em> components, then the system of algebraic equations has <em>ms</em> components. This can be contrasted with implicit <a href="linear_multistep_method" title="wikilink">linear multistep methods</a> (the other big family of methods for ODEs): an implicit <em>s</em>-step linear multistep method needs to solve a system of algebraic equations with only <em>m</em> components, so the size of the system does not increase as the number of steps increases.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>
<h3 id="examples-1">Examples</h3>

<p>The simplest example of an implicit Runge–Kutta method is the <a href="backward_Euler_method" title="wikilink">backward Euler method</a>:</p>

<p>

<math display="block" id="Runge–Kutta_methods:86">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mi>n</mi>
        </msub>
        <mo>+</mo>
        <mi>h</mi>
       </mrow>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>n</ci>
        </apply>
        <ci>h</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=y_{n}+hf(t_{n}+h,y_{n+1}).\,
  </annotation>
 </semantics>
</math>

</p>

<p>The Butcher tableau for this is simply:</p>

<p>

<math display="block" id="Runge–Kutta_methods:87">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd class="ltx_border_r" columnalign="center">
     <mn>1</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>1</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t">
     <mi></mi>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mn>1</mn>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
    </matrixrow>
    <matrixrow>
     <csymbol cd="latexml">absent</csymbol>
     <cn type="integer">1</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{c|c}1&1\\
\hline&1\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>This Butcher tableau corresponds to the formulae</p>

<p>

<math display="block" id="Runge–Kutta_methods:88">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>t</mi>
          <mi>n</mi>
         </msub>
         <mo>+</mo>
         <mi>h</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
         <msub>
          <mi>y</mi>
          <mi>n</mi>
         </msub>
         <mo>+</mo>
         <mrow>
          <mi>h</mi>
          <msub>
           <mi>k</mi>
           <mn>1</mn>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mtext>and</mtext>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>n</mi>
      </msub>
      <mo>+</mo>
      <mrow>
       <mi>h</mi>
       <msub>
        <mi>k</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
     <list>
      <apply>
       <times></times>
       <ci>f</ci>
       <interval closure="open">
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>n</ci>
         </apply>
         <ci>h</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <ci>h</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </interval>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>h</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}=f(t_{n}+h,y_{n}+hk_{1})\quad\text{and}\quad y_{n+1}=y_{n}+hk_{1},
  </annotation>
 </semantics>
</math>

</p>

<p>which can be re-arranged to get the formula for the backward Euler method listed above.</p>

<p>Another example for an implicit Runge–Kutta method is the <a href="trapezoidal_rule_(differential_equations)" title="wikilink">trapezoidal rule</a>. Its Butcher tableau is:</p>

<p>

<math display="block" id="Runge–Kutta_methods:89">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd class="ltx_border_r" columnalign="center">
     <mn>0</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>0</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>0</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r" columnalign="center">
     <mn>1</mn>
    </mtd>
    <mtd columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mtd>
    <mtd columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t">
     <mi></mi>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{c|cc}0&0&0\\
1&\frac{1}{2}&\frac{1}{2}\\
\hline&\frac{1}{2}&\frac{1}{2}\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>The trapezoidal rule is a <a href="collocation_method" title="wikilink">collocation method</a> (as discussed in that article). All collocation methods are implicit Runge–Kutta methods, but not all implicit Runge–Kutta methods are collocation methods.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>

<p>The <a href="Gauss–Legendre_method" title="wikilink">Gauss–Legendre methods</a> form a family of collocation methods based on <a href="Gauss_quadrature" title="wikilink">Gauss quadrature</a>. A Gauss–Legendre method with <em>s</em> stages has order 2<em>s</em> (thus, methods with arbitrarily high order can be constructed).<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> The method with two stages (and thus order four) has Butcher tableau:</p>

<p>

<math display="block" id="Runge–Kutta_methods:90">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd class="ltx_border_r" columnalign="center">
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>6</mn>
       </mfrac>
       <msqrt>
        <mn>3</mn>
       </msqrt>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>4</mn>
     </mfrac>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>4</mn>
      </mfrac>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>6</mn>
       </mfrac>
       <msqrt>
        <mn>3</mn>
       </msqrt>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r" columnalign="center">
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>6</mn>
       </mfrac>
       <msqrt>
        <mn>3</mn>
       </msqrt>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>4</mn>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>6</mn>
       </mfrac>
       <msqrt>
        <mn>3</mn>
       </msqrt>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>4</mn>
     </mfrac>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_r ltx_border_t">
     <mi></mi>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mtd>
    <mtd class="ltx_border_t" columnalign="center">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
       <apply>
        <root></root>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">4</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{c|cc}\frac{1}{2}-\frac{1}{6}\sqrt{3}&\frac{1}{4}&\frac{1}{4}-%
\frac{1}{6}\sqrt{3}\\
\frac{1}{2}+\frac{1}{6}\sqrt{3}&\frac{1}{4}+\frac{1}{6}\sqrt{3}&\frac{1}{4}\\
\hline&\frac{1}{2}&\frac{1}{2}\end{array}
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>
<h3 id="stability">Stability</h3>

<p>The advantage of implicit Runge–Kutta methods over explicit ones is their greater stability, especially when applied to <a href="stiff_equation" title="wikilink">stiff equations</a>. Consider the linear test equation <em>y</em>' = λ<em>y</em>. A Runge–Kutta method applied to this equation reduces to the iteration 

<math display="inline" id="Runge–Kutta_methods:91">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>h</mi>
      <mi>λ</mi>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>λ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n+1}=r(h\lambda)\,y_{n}
  </annotation>
 </semantics>
</math>

, with <em>r</em> given by</p>

<p>

<math display="block" id="Runge–Kutta_methods:92">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mi>z</mi>
      <msup>
       <mi>b</mi>
       <mi>T</mi>
      </msup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>I</mi>
         <mo>-</mo>
         <mrow>
          <mi>z</mi>
          <mi>A</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>e</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>det</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>I</mi>
         <mo>-</mo>
         <mrow>
          <mi>z</mi>
          <mi>A</mi>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>z</mi>
         <mi>e</mi>
         <msup>
          <mi>b</mi>
          <mi>T</mi>
         </msup>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>det</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>I</mi>
        <mo>-</mo>
        <mrow>
         <mi>z</mi>
         <mi>A</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>r</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>z</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <ci>T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>I</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>A</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>e</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <determinant></determinant>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>I</ci>
         <apply>
          <times></times>
          <ci>z</ci>
          <ci>A</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>z</ci>
         <ci>e</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>b</ci>
          <ci>T</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <determinant></determinant>
       <apply>
        <minus></minus>
        <ci>I</ci>
        <apply>
         <times></times>
         <ci>z</ci>
         <ci>A</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(z)=1+zb^{T}(I-zA)^{-1}e=\frac{\det(I-zA+zeb^{T})}{\det(I-zA)},
  </annotation>
 </semantics>
</math>

 <a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></p>

<p>where <em>e</em> stands for the vector of ones. The function <em>r</em> is called the <em>stability function</em>.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> It follows from the formula that <em>r</em> is the quotient of two polynomials of degree <em>s</em> if the method has <em>s</em> stages. Explicit methods have a strictly lower triangular matrix <em>A</em>, which implies that det(<em>I</em> − <em>zA</em>) = 1 and that the stability function is a polynomial.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>

<p>The numerical solution to the linear test equation decays to zero if | <em>r</em>(<em>z</em>) | </p>

<p>If the method has order <em>p</em>, then the stability function satisfies 

<math display="inline" id="Runge–Kutta_methods:93">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mtext>e</mtext>
     <mi>z</mi>
    </msup>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mi>p</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <mtext>e</mtext>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <plus></plus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r(z)=\textrm{e}^{z}+O(z^{p+1})
  </annotation>
 </semantics>
</math>

 as 

<math display="inline" id="Runge–Kutta_methods:94">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>→</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>z</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z\to 0
  </annotation>
 </semantics>
</math>

. Thus, it is of interest to study quotients of polynomials of given degrees that approximate the exponential function the best. These are known as <a href="Padé_approximant" title="wikilink">Padé approximants</a>. A Padé approximant with numerator of degree <em>m</em> and denominator of degree <em>n</em> is A-stable if and only if <em>m</em> ≤ <em>n</em> ≤ <em>m</em> + 2.<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></p>

<p>The Gauss–Legendre method with <em>s</em> stages has order 2<em>s</em>, so its stability function is the Padé approximant with <em>m</em> = <em>n</em> = <em>s</em>. It follows that the method is A-stable.<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> This shows that A-stable Runge–Kutta can have arbitrarily high order. In contrast, the order of A-stable <a href="linear_multistep_method" title="wikilink">linear multistep methods</a> cannot exceed two.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a></p>
<h2 id="b-stability">B-stability</h2>

<p>The <em>A-stability</em> concept for the solution of differential equations is related to the linear autonomous equation 

<math display="inline" id="Runge–Kutta_methods:95">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}=\lambda y
  </annotation>
 </semantics>
</math>

. Dahlquist proposed the investigation of stability of numerical schemes when applied to nonlinear systems which satisfies a monotonicity condition. The corresponding concepts were defined as <em>G-stability</em> for multistep methods (and the related one-leg methods) and <em>B-stability</em> (Butcher, 1975) for Runge–Kutta methods. A Runge–Kutta method applied to the non-linear system 

<math display="inline" id="Runge–Kutta_methods:96">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}=f(y)
  </annotation>
 </semantics>
</math>

, which verifies 

<math display="inline" id="Runge–Kutta_methods:97">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>y</mi>
     <mo>-</mo>
     <mi>z</mi>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <list>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>y</ci>
      <ci>z</ci>
     </apply>
    </list>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle f(y)-f(z),y-z\rangle<0
  </annotation>
 </semantics>
</math>

, is called <em>B-stable</em>, if this condition implies 

<math display="inline" id="Runge–Kutta_methods:98">
 <semantics>
  <mrow>
   <mrow>
    <mo>∥</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>z</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>∥</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mo>∥</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>z</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>∥</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|y_{n+1}-z_{n+1}\|\leq\|y_{n}-z_{n}\|
  </annotation>
 </semantics>
</math>

 for two numerical solutions.</p>

<p>Let 

<math display="inline" id="Runge–Kutta_methods:99">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Runge–Kutta_methods:100">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Runge–Kutta_methods:101">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 be three 

<math display="inline" id="Runge–Kutta_methods:102">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>×</mo>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\times s
  </annotation>
 </semantics>
</math>

 matrices defined by</p>

<p>

<math display="block" id="Runge–Kutta_methods:103">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>B</mi>
     <mo>=</mo>
     <mrow>
      <mo>diag</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>b</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>b</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>b</mi>
        <mi>s</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">,</mo>
    <mrow>
     <mrow>
      <mi>M</mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>B</mi>
         <mi>A</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>A</mi>
          <mi>T</mi>
         </msup>
         <mi>B</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>b</mi>
        <msup>
         <mi>b</mi>
         <mi>T</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
     <mo rspace="4.2pt">,</mo>
     <mrow>
      <mi>Q</mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi>B</mi>
         <msup>
          <mi>A</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>A</mi>
          <mrow>
           <mo>-</mo>
           <mi>T</mi>
          </mrow>
         </msup>
         <mi>B</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>A</mi>
         <mrow>
          <mo>-</mo>
          <mi>T</mi>
         </mrow>
        </msup>
        <mi>b</mi>
        <msup>
         <mi>b</mi>
         <mi>T</mi>
        </msup>
        <msup>
         <mi>A</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>B</ci>
     <apply>
      <ci>diag</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>M</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>B</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>A</ci>
          <ci>T</ci>
         </apply>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>Q</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>B</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>A</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>A</ci>
          <apply>
           <minus></minus>
           <ci>T</ci>
          </apply>
         </apply>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <apply>
          <minus></minus>
          <ci>T</ci>
         </apply>
        </apply>
        <ci>b</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <ci>T</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>A</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=\operatorname{diag}(b_{1},b_{2},\ldots,b_{s}),\,M=BA+A^{T}B-bb^{T},\,Q=BA^{-%
1}+A^{-T}B-A^{-T}bb^{T}A^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>A Runge–Kutta method is said to be <em>algebraically stable</em> <a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> if the matrices 

<math display="inline" id="Runge–Kutta_methods:104">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Runge–Kutta_methods:105">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 are both non-negative definite. A sufficient condition for <em>B-stability</em> <a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> is

<math display="block" id="Runge–Kutta_methods:106">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Runge–Kutta_methods:107">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 are non-negative definite.</p>
<h2 id="derivation-of-the-rungekutta-fourth-order-method">Derivation of the Runge–Kutta fourth-order method</h2>

<p>In general a Runge–Kutta method of order 

<math display="inline" id="Runge–Kutta_methods:108">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 can be written as:</p>

<p>

<math display="block" id="Runge–Kutta_methods:109">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mi>h</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>t</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mo>⋅</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>s</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>k</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒪</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>h</mi>
        <mrow>
         <mi>s</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <ci>h</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>h</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>s</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝒪</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <apply>
        <plus></plus>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t+h}=y_{t}+h\cdot\sum_{i=1}^{s}a_{i}k_{i}+\mathcal{O}(h^{s+1}),
  </annotation>
 </semantics>
</math>

 where:</p>

<p>

<math display="block" id="Runge–Kutta_methods:110">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>+</mo>
      <mrow>
       <mi>h</mi>
       <mo>⋅</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>s</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>β</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
         <msub>
          <mi>k</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>t</mi>
       <mi>n</mi>
      </msub>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>α</mi>
        <mi>i</mi>
       </msub>
       <mi>h</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <ci>normal-⋅</ci>
        <ci>h</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>j</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>s</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>i</ci>
        </apply>
        <ci>h</ci>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{i}=f\left(y_{t}+h\cdot\sum_{j=1}^{s}\beta_{ij}k_{j},t_{n}+\alpha_{i}h\right)
  </annotation>
 </semantics>
</math>

 are increments obtained evaluating the derivatives of 

<math display="inline" id="Runge–Kutta_methods:111">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}
  </annotation>
 </semantics>
</math>

 at the 

<math display="inline" id="Runge–Kutta_methods:112">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

-th order.</p>

<p>We develop the derivation<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a> for the Runge–Kutta fourth-order method using the general formula with 

<math display="inline" id="Runge–Kutta_methods:113">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=4
  </annotation>
 </semantics>
</math>

 evaluated, as explained above, at the starting point, the midpoint and the end point of any interval 

<math display="inline" id="Runge–Kutta_methods:114">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>t</mi>
   <mo>,</mo>
   <mrow>
    <mi>t</mi>
    <mo>+</mo>
    <mi>h</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>t</ci>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (t,t+h)
  </annotation>
 </semantics>
</math>

, thus we choose:</p>

<p>

<math display="block" id="Runge–Kutta_methods:115">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd class="ltx_border_l ltx_border_r ltx_border_t" columnalign="left">
     <msub>
      <mi>α</mi>
      <mi>i</mi>
     </msub>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="left">
     <msub>
      <mi>β</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_l ltx_border_r ltx_border_t" columnalign="left">
     <mrow>
      <msub>
       <mi>α</mi>
       <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
    </mtd>
    <mtd class="ltx_border_r ltx_border_t" columnalign="left">
     <mrow>
      <msub>
       <mi>β</mi>
       <mn>21</mn>
      </msub>
      <mo>=</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_l ltx_border_r" columnalign="left">
     <mrow>
      <msub>
       <mi>α</mi>
       <mn>2</mn>
      </msub>
      <mo>=</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mtd>
    <mtd class="ltx_border_r" columnalign="left">
     <mrow>
      <msub>
       <mi>β</mi>
       <mn>32</mn>
      </msub>
      <mo>=</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_l ltx_border_r" columnalign="left">
     <mrow>
      <msub>
       <mi>α</mi>
       <mn>3</mn>
      </msub>
      <mo>=</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </mtd>
    <mtd class="ltx_border_r" columnalign="left">
     <mrow>
      <msub>
       <mi>β</mi>
       <mn>43</mn>
      </msub>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd class="ltx_border_b ltx_border_l ltx_border_r" columnalign="left">
     <mrow>
      <msub>
       <mi>α</mi>
       <mn>4</mn>
      </msub>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </mtd>
    <mtd class="ltx_border_b ltx_border_r">
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">21</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">32</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">43</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <cn type="integer">4</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{|l|l|}\hline\alpha_{i}&\beta_{ij}\\
\hline\alpha_{1}=0&\beta_{21}=\frac{1}{2}\\
\alpha_{2}=\frac{1}{2}&\beta_{32}=\frac{1}{2}\\
\alpha_{3}=\frac{1}{2}&\beta_{43}=1\\
\alpha_{4}=1&\\
\hline\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Runge–Kutta_methods:116">
 <semantics>
  <mrow>
   <msub>
    <mi>β</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>β</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{ij}=0
  </annotation>
 </semantics>
</math>

 otherwise. We begin by defining the following quantities:</p>

<p>

<math display="inline" id="Runge–Kutta_methods:117">
 <semantics>
  <msubsup>
   <mi>y</mi>
   <mrow>
    <mi>t</mi>
    <mo>+</mo>
    <mi>h</mi>
   </mrow>
   <mn>1</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle y^{1}_{t+h}
  </annotation>
 </semantics>
</math>


 where 

<math display="inline" id="Runge–Kutta_methods:118">
 <semantics>
  <mrow>
   <msubsup>
    <mi>y</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
    <mn>1</mn>
   </msubsup>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>+</mo>
      <msubsup>
       <mi>y</mi>
       <mrow>
        <mi>t</mi>
        <mo>+</mo>
        <mi>h</mi>
       </mrow>
       <mn>1</mn>
      </msubsup>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <divide></divide>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <plus></plus>
        <ci>t</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{1}_{t+h/2}=\dfrac{y_{t}+y^{1}_{t+h}}{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Runge–Kutta_methods:119">
 <semantics>
  <mrow>
   <msubsup>
    <mi>y</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi>h</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>+</mo>
      <msubsup>
       <mi>y</mi>
       <mrow>
        <mi>t</mi>
        <mo>+</mo>
        <mi>h</mi>
       </mrow>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <divide></divide>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <ci>t</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{2}_{t+h/2}=\dfrac{y_{t}+y^{2}_{t+h}}{2}
  </annotation>
 </semantics>
</math>

 If we define:</p>

<p>

<math display="inline" id="Runge–Kutta_methods:120">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle k_{1}
  </annotation>
 </semantics>
</math>


 and for the previous relations we can show that the following equalities holds up to 

<math display="inline" id="Runge–Kutta_methods:121">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒪</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>h</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒪</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(h^{2})
  </annotation>
 </semantics>
</math>


:</p>

<p>

<math display="inline" id="Runge–Kutta_methods:122">
 <semantics>
  <msub>
   <mi>k</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle k_{2}
  </annotation>
 </semantics>
</math>


 where:</p>

<p>

<math display="block" id="Runge–Kutta_methods:123">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mi>d</mi>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mi>t</mi>
     </msub>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>y</mi>
      </mrow>
     </mfrac>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mover accent="true">
       <mi>y</mi>
       <mo>˙</mo>
      </mover>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>y</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>y</mi>
      <mo>˙</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>t</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mi>t</mi>
      </msub>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo>¨</mo>
    </mover>
    <mi>t</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>t</ci>
       </apply>
       <ci>t</ci>
      </interval>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>y</ci>
        </apply>
       </apply>
       <ci>f</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>y</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
       </apply>
       <ci>f</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>y</ci>
       </apply>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
       <apply>
        <ci>normal-˙</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>t</ci>
       </apply>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>t</ci>
        </apply>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¨</ci>
       <ci>y</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d}{dt}f(y_{t},t)=\frac{\partial}{\partial y}f(y_{t},t)\dot{y}_{t}+\frac{%
\partial}{\partial t}f(y_{t},t)=f_{y}(y_{t},t)\dot{y}+f_{t}(y_{t},t):=\ddot{y}%
_{t}
  </annotation>
 </semantics>
</math>

 is the total derivative of 

<math display="inline" id="Runge–Kutta_methods:124">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 with respect to time.</p>

<p>If we now express the general formula using what we just derived we obtain:</p>

<p>

<math display="inline" id="Runge–Kutta_methods:125">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>t</mi>
    <mo>+</mo>
    <mi>h</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle y_{t+h}
  </annotation>
 </semantics>
</math>


</p>

<p>and comparing this with the <a href="Taylor_series" title="wikilink">Taylor series</a> of 

<math display="inline" id="Runge–Kutta_methods:126">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>t</mi>
    <mo>+</mo>
    <mi>h</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t+h}
  </annotation>
 </semantics>
</math>

 around 

<math display="inline" id="Runge–Kutta_methods:127">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Runge–Kutta_methods:128">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>t</mi>
    <mo>+</mo>
    <mi>h</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle y_{t+h}
  </annotation>
 </semantics>
</math>


</p>

<p>we obtain a system of constraints on the coefficients:</p>

<p>

<math display="block" id="Runge–Kutta_methods:129">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="left">
      <mi></mi>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mi>a</mi>
        <mo>;</mo>
        <mrow>
         <mrow>
          <mo>+</mo>
          <mi>b</mi>
         </mrow>
         <mo>+</mo>
         <mi>c</mi>
         <mo>+</mo>
         <mi>d</mi>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mi></mi>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <mi>b</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <mi>c</mi>
        </mrow>
        <mo>+</mo>
        <mi>d</mi>
       </mrow>
       <mo>=</mo>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mstyle>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mi></mi>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>4</mn>
          </mfrac>
         </mstyle>
         <mi>c</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
         <mi>d</mi>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mn>6</mn>
        </mfrac>
       </mstyle>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mi></mi>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>4</mn>
         </mfrac>
        </mstyle>
        <mi>d</mi>
       </mrow>
       <mo>=</mo>
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mn>24</mn>
        </mfrac>
       </mstyle>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">cases</csymbol>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <eq></eq>
     <list>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <apply>
        <plus></plus>
        <ci>b</ci>
       </apply>
       <ci>c</ci>
       <ci>d</ci>
      </apply>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>c</ci>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>d</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">6</cn>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">4</cn>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">24</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{cases}&a;+b+c+d=1\\
&\frac{1}{2}b+\frac{1}{2}c+d=\frac{1}{2}\\
&\frac{1}{4}c+\frac{1}{2}d=\frac{1}{6}\\
&\frac{1}{4}d=\frac{1}{24}\end{cases}
  </annotation>
 </semantics>
</math>

 which when solved gives 

<math display="inline" id="Runge–Kutta_methods:130">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mn>6</mn>
    </mfrac>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>b</mi>
     <mo>=</mo>
     <mfrac>
      <mn>1</mn>
      <mn>3</mn>
     </mfrac>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mi>c</mi>
      <mo>=</mo>
      <mfrac>
       <mn>1</mn>
       <mn>3</mn>
      </mfrac>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>d</mi>
      <mo>=</mo>
      <mfrac>
       <mn>1</mn>
       <mn>6</mn>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">6</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>b</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <ci>c</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=\frac{1}{6},b=\frac{1}{3},c=\frac{1}{3},d=\frac{1}{6}
  </annotation>
 </semantics>
</math>

 as stated above.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Dynamic_errors_of_numerical_methods_of_ODE_discretization" title="wikilink">Dynamic errors of numerical methods of ODE discretization</a></li>
<li><a href="Euler's_method" title="wikilink">Euler's method</a></li>
<li><a href="List_of_Runge–Kutta_methods" title="wikilink">List of Runge–Kutta methods</a></li>
<li><a href="Numerical_ordinary_differential_equations" title="wikilink">Numerical ordinary differential equations</a></li>
<li><a class="uri" href="PottersWheel" title="wikilink">PottersWheel</a> – Parameter calibration in ODE systems using implicit Runge–Kutta integration</li>
<li><a href="Runge–Kutta_method_(SDE)" title="wikilink">Runge–Kutta method (SDE)</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>(see Chapter 6).</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>. Also, <a href="http://apps.nrbook.com/empanel/index.html#pg=910">Section 17.2. Adaptive Stepsize Control for Runge-Kutta</a>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://www.mathstools.com/section/main/runge_kutta_calculator">On line calculator for Runge-Kutta methods</a> by www.mathstools.com</li>
<li><a href="http://numericalmethods.eng.usf.edu/topics/runge_kutta_4th_method.html">Runge–Kutta 4th-Order Method</a></li>
<li><a href="http://math.fullerton.edu/mathews/n2003/RungeKuttaMod.html">Runge Kutta Method for O.D.E.'s</a></li>
<li><a href="http://www.dotnumerics.com/NumericalLibraries/DifferentialEquations/">DotNumerics: Ordinary Differential Equations for C# and VB.NET</a> — Initial-value problem for nonstiff and stiff ordinary differential equations (explicit Runge–Kutta, implicit Runge–Kutta, Gear's BDF and Adams–Moulton).</li>
<li><a href="http://gafferongames.com/game-physics/integration-basics/">GafferOnGames</a> — A physics resource for computer programmers</li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a> <a href="Category:Runge–Kutta_methods" title="wikilink">Category:Runge–Kutta methods</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">; <a href="#fnref1">↩</a></li>
<li id="fn2">, ,  and  leave out the factor <em>h</em> in the definition of the stages. ,  and  use the <em>y</em>-values as stages.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"> refer to <a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16">; <a href="#fnref16">↩</a></li>
<li id="fn17"></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27">This result is due to .<a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"><a href="http://www.ss.ncu.edu.tw/~lyu/lecture_files_en/lyu_NSSP_Notes/Lyu_NSSP_AppendixC.pdf">PDF</a> reporting this derivation<a href="#fnref30">↩</a></li>
</ol>
</section>
</body>
</html>

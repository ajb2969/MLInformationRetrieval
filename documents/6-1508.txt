   Logarithm of a matrix      Logarithm of a matrix   In mathematics , a logarithm of a matrix is another matrix such that the matrix exponential of the latter matrix equals the original matrix. It is thus a generalization of the scalar logarithm and in some sense an inverse function of the matrix exponential . Not all matrices have a logarithm and those matrices that do have a logarithm may have more than one logarithm. The study of logarithms of matrices leads to Lie theory since when a matrix has a logarithm then it is in a Lie group and the logarithm is the corresponding element of the Lie algebra .  Definition  A matrix B is a logarithm of a given matrix A if the matrix exponential of B is A :        e  B   =  A   .       superscript  e  B   A    e^{B}=A.\,     Example: Logarithm of rotations in the plane  The rotations in the plane give a simple example. A rotation of angle α around the origin is represented by the 2×2-matrix       A  =   (      cos   (  α  )       -   sin   (  α  )          sin   (  α  )       cos   (  α  )       )    .      A      α       α        α     α       A=\begin{pmatrix}\cos(\alpha)&-\sin(\alpha)\\
 \sin(\alpha)&\cos(\alpha)\\
 \end{pmatrix}.     For any integer n , the matrix        B  n   =    (   α  +   2  π  n    )    (     0     -  1       1    0     )     ,       subscript  B  n       α    2  π  n      0    1     1  0       B_{n}=(\alpha+2\pi n)\begin{pmatrix}0&-1\\
 1&0\\
 \end{pmatrix},     is a logarithm of A . Thus, the matrix A has infinitely many logarithms. This corresponds to the fact that the rotation angle is only determined up to multiples of 2π.  In the language of Lie theory, the rotation matrices A are elements of the Lie group SO(2) . The corresponding logarithms B are elements of the Lie algebra so(2), which consists of all skew-symmetric matrices . The matrix      (     0    1       -  1     0     )      0  1      1   0     \begin{pmatrix}0&1\\
 -1&0\\
 \end{pmatrix}     is a generator of the Lie algebra so(2).  Existence  The question of whether a matrix has a logarithm has the easiest answer when considered in the complex setting. A matrix has a logarithm if and only if it is invertible . 1 The logarithm is not unique, but if a matrix has no negative real eigenvalues , then it has a unique logarithm whose eigenvalues lie all in the strip { z ∈ C | −π , Theorem 1.31  The answer is more involved in the real setting. A real matrix has a real logarithm if and only if it is invertible and each Jordan block belonging to a negative eigenvalue occurs an even number of times. 2 If an invertible real matrix does not satisfy the condition with the Jordan blocks, then it has only non-real logarithms. This can already be seen in the scalar case: the logarithm of −1 is a non-real complex number. The existence of real matrix logarithms of real 2 x 2 matrices is considered in a later section.  Properties  If A and B are both positive-definite matrices and A and B commute, i.e., AB = BA , then        A  B   =   e    ln   (  A  )    +   ln   (  B  )       .        A  B    superscript  e      A     B       AB=e^{\ln(A)+\ln(B)}.\,     For any invertible matrix,        A   -  1    =   e   -   ln   (  A  )       .       superscript  A    1     superscript  e      A       A^{-1}=e^{-\ln(A)}.\,     Further example: Logarithm of rotations in 3D space  A rotation   R   R   R   ∈ SO(3) in ℝ³ is given by a 3x3 orthogonal matrix .  The logarithm of such a rotation matrix   R   R   R   can be readily computed from the antisymmetric part of Rodrigues' rotation formula 3 (see also Axis angle ). It yields the logarithm of minimal Frobenius norm , but fails when   R   R   R   has eigenvalues equal to −1 where this is not unique.  Further note that, given rotation matrices A and B ,        d  g    (  A  ,  B  )    :=    ∥   log   (    A  ⊤   B   )    ∥   F      assign     subscript  d  g    A  B     subscript   norm       superscript  A  top   B     F     d_{g}(A,B):=\|\log(A^{\top}B)\|_{F}   is the geodesic distance on the 3D manifold of rotation matrices.  Calculating the logarithm of a diagonalizable matrix  A method for finding ln A for a diagonalizable matrix  A is the following:   Find the matrix V of eigenvectors of A (each column of V is an eigenvector of A ).  Find the inverse  V −1 of V .  Let       A  ′   =    V   -  1    A  V    .       superscript  A  normal-′      superscript  V    1    A  V     A^{\prime}=V^{-1}AV.\,      Then A′ will be a diagonal matrix whose diagonal elements are eigenvalues of A .  Replace each diagonal element of A′ by its (natural) logarithm in order to obtain    ln   A  ′        superscript  A  normal-′     \ln A^{\prime}   .  Then       ln  A   =   V   (   ln   A  ′    )    V   -  1      .        A     V     superscript  A  normal-′     superscript  V    1       \ln A=V(\ln A^{\prime})V^{-1}.\,       That the logarithm of A might be a complex matrix even if A is real then follows from the fact that a matrix with real and positive entries might nevertheless have negative or even complex eigenvalues (this is true for example for rotation matrices ). The non-uniqueness of the logarithm of a matrix follows from the non-uniqueness of the logarithm of a complex number.  The logarithm of a non-diagonalizable matrix  The algorithm illustrated above does not work for non-diagonalizable matrices, such as       [     1    1      0    1     ]   .      1  1    0  1     \begin{bmatrix}1&1\\
 0&1\end{bmatrix}.     For such matrices one needs to find its Jordan decomposition and, rather than computing the logarithm of diagonal entries as above, one would calculate the logarithm of the Jordan blocks .  The latter is accomplished by noticing that one can write a Jordan block as      B  =   (     λ    1    0    0    ⋯    0      0    λ    1    0    ⋯    0      0    0    λ    1    ⋯    0      ⋮    ⋮    ⋮    ⋱    ⋱    ⋮      0    0    0    0    λ    1      0    0    0    0    0    λ     )   =   λ   (     1     λ   -  1      0    0    ⋯    0      0    1     λ   -  1      0    ⋯    0      0    0    1     λ   -  1      ⋯    0      ⋮    ⋮    ⋮    ⋱    ⋱    ⋮      0    0    0    0    1     λ   -  1        0    0    0    0    0    1     )    =   λ   (   I  +  K   )          B    λ  1  0  0  normal-⋯  0    0  λ  1  0  normal-⋯  0    0  0  λ  1  normal-⋯  0    normal-⋮  normal-⋮  normal-⋮  normal-⋱  normal-⋱  normal-⋮    0  0  0  0  λ  1    0  0  0  0  0  λ           λ    1   superscript  λ    1    0  0  normal-⋯  0    0  1   superscript  λ    1    0  normal-⋯  0    0  0  1   superscript  λ    1    normal-⋯  0    normal-⋮  normal-⋮  normal-⋮  normal-⋱  normal-⋱  normal-⋮    0  0  0  0  1   superscript  λ    1      0  0  0  0  0  1            λ    I  K       B=\begin{pmatrix}\lambda&1&0&0&\cdots&0\\
 0&\lambda&1&0&\cdots&0\\
 0&0&\lambda&1&\cdots&0\\
 \vdots&\vdots&\vdots&\ddots&\ddots&\vdots\\
 0&0&0&0&\lambda&1\\
 0&0&0&0&0&\lambda\\
 \end{pmatrix}=\lambda\begin{pmatrix}1&\lambda^{-1}&0&0&\cdots&0\\
 0&1&\lambda^{-1}&0&\cdots&0\\
 0&0&1&\lambda^{-1}&\cdots&0\\
 \vdots&\vdots&\vdots&\ddots&\ddots&\vdots\\
 0&0&0&0&1&\lambda^{-1}\\
 0&0&0&0&0&1\\
 \end{pmatrix}=\lambda(I+K)   where K is a matrix with zeros on and under the main diagonal. (The number λ is nonzero by the assumption that the matrix whose logarithm one attempts to take is invertible.)  Then, by the Mercator series       ln   (   1  +  x   )    =      x  -    x  2   2    +    x  3   3    -    x  4   4    +  ⋯           1  x            x     superscript  x  2   2       superscript  x  3   3       superscript  x  4   4    normal-⋯     \ln(1+x)=x-\frac{x^{2}}{2}+\frac{x^{3}}{3}-\frac{x^{4}}{4}+\cdots     one gets       ln  B   =   ln   (   λ   (   I  +  K   )    )    =    ln   (   λ  I   )    +   ln   (   I  +  K   )     =         (   ln  λ   )   I   +  K   -    K  2   2    +    K  3   3    -    K  4   4    +  ⋯           B       λ    I  K                λ  I        I  K                        λ   I   K      superscript  K  2   2       superscript  K  3   3       superscript  K  4   4    normal-⋯      \ln B=\ln\big(\lambda(I+K)\big)=\ln(\lambda I)+\ln(I+K)=(\ln\lambda)I+K-\frac{%
 K^{2}}{2}+\frac{K^{3}}{3}-\frac{K^{4}}{4}+\cdots     This series in general does not converge for every matrix K , as it would not for any real number with absolute value greater than unity, however, this particular K is a nilpotent matrix , so the series actually has a finite number of terms ( K m is zero if m is the dimension of K ).  Using this approach one finds        ln   [     1    1      0    1     ]    =   [     0    1      0    0     ]    .          1  1    0  1       0  1    0  0      \ln\begin{bmatrix}1&1\\
 0&1\end{bmatrix}=\begin{bmatrix}0&1\\
 0&0\end{bmatrix}.     A functional analysis perspective  A square matrix represents a linear operator on the Euclidean space  R n where n is the dimension of the matrix. Since such a space is finite-dimensional, this operator is actually bounded .  Using the tools of holomorphic functional calculus , given a holomorphic function  f ( z ) defined on an open set in the complex plane and a bounded linear operator T , one can calculate f ( T ) as long as f ( z ) is defined on the spectrum of T .  The function f ( z )=ln z can be defined on any simply connected open set in the complex plane not containing the origin, and it is holomorphic on such a domain. This implies that one can define ln T as long as the spectrum of T does not contain the origin and there is a path going from the origin to infinity not crossing the spectrum of T (as such, if the spectrum of T is a circle with the origin inside of it, it is impossible to define ln T ).  Back to the particular case of a Euclidean space, the spectrum of a linear operator on this space is the set of eigenvalues of its matrix, and so is a finite set. As long as the origin is not in the spectrum (the matrix is invertible), one obviously satisfies the path condition from the previous paragraph, and as such, the theory implies that ln T is well-defined. The non-uniqueness of the matrix logarithm then follows from the fact that one can choose more than one branch of the logarithm which is defined on the set of eigenvalues of a matrix.  A Lie group theory perspective  In the theory of Lie groups , there is an exponential map from a Lie algebra  g to the corresponding Lie group G       exp  :   g  →  G    .     normal-:    normal-→  g  G     \exp:g\rightarrow G.     For matrix Lie groups, the elements of g and G are square matrices and the exponential map is given by the matrix exponential . The inverse map    log  =   exp   -  1          superscript     1      \log=\exp^{-1}   is multivalued and coincides with the matrix logarithm discussed here. The logarithm maps from the Lie group G into the Lie algebra g . Note that the exponential map is a local diffeomorphism between a neighborhood U of the zero matrix     0  ¯   ∈  g       normal-¯  0   g    \underline{0}\in g   and a neighborhood V of the identity matrix     1  ¯   ∈  G       normal-¯  1   G    \underline{1}\in G   . Thus the (matrix) logarithm is well-defined as a map,       log  :   V  ⊂  G  →  U  ⊂  g    .     normal-:       V  G    normal-→    U       g      \log:V\subset G\rightarrow U\subset g.\,     An important corollary of Jacobi's formula then is        log   (   det   (  A  )    )    =   tr   (   log  A   )     .          A      tr    A      \log(\det(A))=\mathrm{tr}(\log A)~{}.     Constraints in the 2 × 2 case  If a 2 x 2 real matrix has a negative determinant , it has no real logarithm. Note first that any 2 × 2 real matrix can be considered one of the three types of the complex number z = x + y ε, where ε² ∈ { −1, 0, +1 }. This z is a point on a complex subplane of the ring of matrices.  The case where the determinant is negative only arises in a plane with ε² =+1, that is a split-complex number plane. Only one quarter of this plane is the image of the exponential map, so the logarithm is only defined on that quarter (quadrant). The other three quadrants are images of this one under the Klein four-group generated by ε and −1.  For example, let a = ln 2 ; then cosh a = 5/4 and sinh a = 3/4. For matrices, this means that      A  =   exp   (     0    a      a    0     )    =   (      cosh  a      sinh  a        sinh  a      cosh  a      )   =   (     1.25    .75      .75    1.25     )         A      0  a    a  0              a     a       a     a            1.25  .75    .75  1.25       A=\exp\begin{pmatrix}0&a\\
 a&0\end{pmatrix}=\begin{pmatrix}\cosh a&\sinh a\\
 \sinh a&\cosh a\end{pmatrix}=\begin{pmatrix}1.25&.75\\
 .75&1.25\end{pmatrix}   . So this last matrix has logarithm       ln  A   =   (     0     ln  2        ln  2     0     )         A     0    2       2   0      \ln A=\begin{pmatrix}0&\ln 2\\
 \ln 2&0\end{pmatrix}   .  These matrices, however, do not have a logarithm:       (      3  /  4      5  /  4        5  /  4      3  /  4      )   ,   (      -   3  /  4       -   5  /  4         -   5  /  4       -   3  /  4       )   ,   (      -   5  /  4       -   3  /  4         -   3  /  4       -   5  /  4       )          3  4     5  4       5  4     3  4           3  4        5  4          5  4        3  4            5  4        3  4          3  4        5  4        \begin{pmatrix}3/4&5/4\\
 5/4&3/4\end{pmatrix},\ \begin{pmatrix}-3/4&-5/4\\
 -5/4&-3/4\end{pmatrix},\ \begin{pmatrix}-5/4&-3/4\\
 -3/4&-5/4\end{pmatrix}   . They represent the three other conjugates by the four-group of the matrix above that does have a logarithm.  A non-singular 2 x 2 matrix does not necessarily have a logarithm, but it is conjugate by the four-group to a matrix that does have a logarithm.  It also follows, that, e.g., a square root of this matrix  A is obtainable directly from exponentiating (ln A )/2,        A   =   (      cosh   (    (   ln  2   )   /  2   )       sinh   (    (   ln  2   )   /  2   )         sinh   (    (   ln  2   )   /  2   )       cosh   (    (   ln  2   )   /  2   )       )   =    (     1.06    .35      .35    1.06     )     .          A           2   2          2   2            2   2          2   2             1.06  .35    .35  1.06       \sqrt{A}=\begin{pmatrix}\cosh((\ln 2)/2)&\sinh((\ln 2)/2)\\
 \sinh((\ln 2)/2)&\cosh((\ln 2)/2)\end{pmatrix}=\begin{pmatrix}1.06&.35\\
 .35&1.06\end{pmatrix}~{}.     For a richer example, start with a pythagorean triple ( p,q,r ) and let    a  =   l  n   (   p  +  r   )   −  l  n  q       a    l  n    p  r   normal-−  l  n  q     a=ln(p+r)−lnq   . Then       e  a   =    p  +  r   q   =    cosh  a   +   sinh  a           superscript  e  a       p  r   q            a     a       e^{a}=\frac{p+r}{q}=\cosh a+\sinh a   .  Now       exp   (     0    a      a    0     )    =   (      r  /  q      p  /  q        p  /  q      r  /  q      )           0  a    a  0         r  q     p  q       p  q     r  q       \exp\begin{pmatrix}0&a\\
 a&0\end{pmatrix}=\begin{pmatrix}r/q&p/q\\
 p/q&r/q\end{pmatrix}   . Thus        1  q     (     r    p      p    r     )         1  q     r  p    p  r      \tfrac{1}{q}\begin{pmatrix}r&p\\
 p&r\end{pmatrix}   has the logarithm matrix      (     0    a      a    0     )      0  a    a  0     \begin{pmatrix}0&a\\
 a&0\end{pmatrix}   , where    a  =   l  n   (   p  +  r   )   −  l  n  q       a    l  n    p  r   normal-−  l  n  q     a=ln(p+r)−lnq   .  See also   Matrix function  Square root of a matrix  Matrix exponential  Baker–Campbell–Hausdorff formula   Notes    References    .   .   .    "  Category:Matrix theory  Category:Inverse functions  Category:Logarithms     , Theorem 1.27 ↩  ↩  Engø (2001) ↩     
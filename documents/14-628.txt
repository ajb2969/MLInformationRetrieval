   Timeâ€“frequency analysis for music signals      Timeâ€“frequency analysis for music signals   Timeâ€“frequency analysis for music signals is one of the applications of timeâ€“frequency analysis . Musical sound can be more complicated than human vocal sound, occupying a wider band of frequency. Music signals are time-varying signals; while the classic Fourier transform is not sufficient to analyze them, timeâ€“frequency analysis is an efficient tool for such use. Timeâ€“frequency analysis is extended from the classic Fourier approach. Short-time Fourier transform (STFT), Gabor transform (GT) and Wigner distribution function (WDF) are famous timeâ€“frequency methods, useful for analyzing music signals such as notes played on a piano, a flute or a guitar.  Knowledge about music signal  Music is a type of sound that has some stable frequencies in a time period. Music can be produced by several methods. For example, the sound of a piano is produced by striking strings , and the sound of a violin is produced by bowing . All musical sounds have their fundamental frequency and overtones. Fundamental frequency is the lowest frequency in harmonic series. In a periodic signal, the fundamental frequency is the inverse of the period length. Overtones are integer multiples of the fundamental frequency.        Table. 1 the fundamental frequency and overtone     Frequency     f = 440Â Hz     f = 880Â Hz     f = 1320Â Hz     f = 1760Â Hz       In musical theory , pitch represents the perceived fundamental frequency of a sound. However the actual fundamental frequency may differ from the perceived fundamental frequency because of overtones.  Short-time Fourier transform  (Figure)  Fig.1 Waveform of the audio file "Chord.wav"   (Figure)  Fig.2 Gabor transform of "Chord.wav"   (Figure)  Fig. 3 Spectrogram of "Chord.wav"   Continuous STFT  Short-time Fourier transform is a basic type of timeâ€“frequency analysis. If there is a continuous signal x ( t ), we can compute the short-time Fourier transform by       ğ’ğ“ğ…ğ“   {   x   (  t  )    }    â‰¡   X   (  t  ,  f  )    =    âˆ«   -  âˆ   âˆ    x   (  Ï„  )   w   (   t  -  Ï„   )     e   -   j  2  Ï€  f  Ï„      d  Ï„            ğ’ğ“ğ…ğ“     x  t       X   t  f           superscript   subscript            x  Ï„  w    t  Ï„    superscript  e      j  2  Ï€  f  Ï„     d  Ï„       \mathbf{STFT}\left\{x(t)\right\}\equiv X(t,f)=\int_{-\infty}^{\infty}x(\tau)w(%
 t-\tau)e^{-j2\pi f\tau}\,d\tau   where w ( t ) is a window function . When the w ( t ) is a rectangular function, the transform is called Rec-STFT. When the w ( t ) is a Gaussian function, the transform is called Gabor transform .  Discrete STFT  However, normally the musical signal we have is not a continuous signal. It is sampled in a sampling frequency. Therefore, we canâ€™t use the formula to compute the Rec-short-time Fourier transform. We change the original form to       X   (    n   Î”  t   ,    m   Î”  f   )    =    âˆ‘   p  =   n  -  Q     n  +  Q     x   (    p   Î”  t   )     e   -   j  2  Ï€  p   m   Î”   t   Î”  f      Î”  t          X     n  normal-Î”  t     m  normal-Î”  f       superscript   subscript     p    n  Q       n  Q      x    p  normal-Î”  t    superscript  e      j  2  Ï€  p  m  normal-Î”  t  normal-Î”  f     normal-Î”  t      X(n\,\Delta t,m\,\Delta f)=\sum_{p=n-Q}^{n+Q}x(p\,\Delta t)e^{-j2\pi pm\,%
 \Delta t\,\Delta f}\,\Delta t   Let    t  =    n   Î”  t       t    n  normal-Î”  t     t=n\,\Delta t   ,    f  =    m   Î”  f       f    m  normal-Î”  f     f=m\,\Delta f   ,    Ï„  =    p   Î”  t       Ï„    p  normal-Î”  t     \tau=p\,\Delta t   and    B  =    Q   Î”  t       B    Q  normal-Î”  t     B=Q\,\Delta t   . There are some constraints of discrete short-time Fourier transform:         Î”   t   Î”  f   =   1  N    ,        normal-Î”  t  normal-Î”  f     1  N     \Delta t\,\Delta f=\frac{1}{N},   where N is an integer.      N  â‰¥    2  Q   +  1       N      2  Q   1     N\geq 2Q+1         Î”  <   1   2   f  max         normal-Î”    1    2   subscript  f        \Delta<\frac{1}{2f_{\max}}   , where    f  max     subscript  f     f_{\max}   is the highest frequency in the signal.   STFT example  Fig.1 shows the waveform of a piano music audio file with 44100Â Hz sampling frequency. And Fig.2 shows the result of short-time Fourier transform (we use Gabor transform here) of the audio file. We can see from the timeâ€“frequency plot, from t =Â 0 to 0.5 second, there is a chord with three notes, and the chord changed at t =Â 0.5, and then changed again at t =Â 1. The fundamental frequency of each note in each chord is shown in the timeâ€“frequency plot.  Spectrogram  Figure 3 shows the spectrogram of the audio file shows in Figure 1. Spectrogram is the square of STFT, time-varying spectral representation. The spectrogram of a signal s ( t ) can be estimated by computing the squared magnitude of the STFT of the signal s ( t ), as shown below:       ğ¬ğ©ğğœğ­ğ«ğ¨ğ ğ«ğšğ¦   (  t  ,  f  )    =    |   ğ’ğ“ğ…ğ“   (  t  ,  f  )    |   2         ğ¬ğ©ğğœğ­ğ«ğ¨ğ ğ«ğšğ¦   t  f     superscript      ğ’ğ“ğ…ğ“   t  f     2     \mathbf{spectrogram}(t,f)=\left|\mathbf{STFT}(t,f)\right|^{2}     Although the spectrogram is profoundly useful, it still has one drawback. It displays frequencies on a uniform scale. However, musical scales are based on a logarithmic scale for frequencies. Therefore, we should describe the frequency in logarithmic scale related to human hearing.  Wigner distribution function  The Wigner distribution function can also be used to analyze music signal. The advantage of Wigner distribution function is the high clarity. However, it needs high calculation and has cross-term problem, so it's more suitable to analyze signal without more than one frequency at the same time.  Formula  The Wigner distribution function     W  x    (  t  ,  f  )        subscript  W  x    t  f     W_{x}(t,f)   is:         ğ–  x    (  t  ,  f  )    =    âˆ«   -  âˆ   âˆ    x   (   t  +   Ï„  /  2    )    x  *    (   t  -   Ï„  /  2    )     e   -   j  2  Ï€   Ï„   f      d  Ï„     ,         subscript  ğ–  x    t  f      superscript   subscript            x    t    Ï„  2     superscript  x      t    Ï„  2     superscript  e      j  2  Ï€  Ï„  f     d  Ï„      \mathbf{W}_{x}(t,f)=\int_{-\infty}^{\infty}x(t+\tau/2)x^{*}(t-\tau/2)e^{-j2\pi%
 \tau\,f}\,d\tau,     where x ( t ) is the signal, and x *( t ) is the conjugate of the signal.  See also   Musical acoustics  Harmonic pitch class profiles (HPCP)  cone-shape distribution function (ZAM)   Sources   Joan Serra, Emilia Gomez, Perfecto Herrera, and Xavier Serra , "Chroma Binary Similarity and Local Alignment Applied to Cover Song Identification," August, 2008  William J. Pielemeier, Gregory H. Wakefield, and Mary H. Simoni, "Timeâ€“frequency Analysis of Musical Signals," September,1996  Jeremy F. Alm and James S. Walker, "Timeâ€“Frequency Analysis of Musical Instruments," 2002  Monika Dorfler, "What Timeâ€“Frequency Analysis Can Do To Music Signals," April,2004  EnShuo Tsau, Namgook Cho and C.-C. Jay Kuo , "Fundamental Frequency Estimation For Music Signals with Modified Hilbertâ€“Huang transform " IEEE International Conference on Multimedia and Expo, 2009.   "  Category:Musical analysis  Musical signal   
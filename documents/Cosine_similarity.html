<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="335">Cosine similarity</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Cosine similarity</h1>
<hr/>

<p><strong>Cosine similarity</strong> is a measure of similarity between two vectors of an <a href="inner_product_space" title="wikilink">inner product space</a> that measures the <a class="uri" href="cosine" title="wikilink">cosine</a> of the angle between them. The cosine of 0¬∞ is 1, and it is less than 1 for any other angle. It is thus a judgment of orientation and not magnitude: two vectors with the same orientation have a cosine similarity of 1, two vectors at 90¬∞ have a similarity of 0, and two vectors diametrically opposed have a similarity of -1, independent of their magnitude. Cosine similarity is particularly used in positive space, where the outcome is neatly bounded in [0,1].</p>

<p>Note that these bounds apply for any number of dimensions, and cosine similarity is most commonly used in high-dimensional positive spaces. For example, in <a href="information_retrieval" title="wikilink">information retrieval</a> and <a href="text_mining" title="wikilink">text mining</a>, each term is notionally assigned a different dimension and a document is characterised by a vector where the value of each dimension corresponds to the number of times that term appears in the document. Cosine similarity then gives a useful measure of how similar two documents are likely to be in terms of their subject matter.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>The technique is also used to measure cohesion within <a href="cluster_(computing)" title="wikilink">clusters</a> in the field of <a href="data_mining" title="wikilink">data mining</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p><em>Cosine distance</em> is a term often used for the complement in positive space, that is

<math display="block" id="Cosine_similarity:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>D</mi>
     <mi>C</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo>,</mo>
     <mi>B</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>S</mi>
      <mi>C</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>C</ci>
     </apply>
     <interval closure="open">
      <ci>A</ci>
      <ci>B</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>C</ci>
      </apply>
      <interval closure="open">
       <ci>A</ci>
       <ci>B</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{C}(A,B)=1-S_{C}(A,B)
  </annotation>
 </semantics>
</math>

. It is important to note, however, that this is not a proper <a href="distance_metric" title="wikilink">distance metric</a> as it does not have the triangle inequality property and it violates the coincidence axiom; to repair the triangle inequality property while maintaining the same ordering, it is necessary to convert to angular distance (see below.)</p>

<p>One of the reasons for the popularity of cosine similarity is that it is very efficient to evaluate, especially for sparse vectors, as only the non-zero dimensions need to be considered.</p>
<h2 id="definition">Definition</h2>

<p>The cosine of two vectors can be derived by using the <a href="Euclidean_vector#Dot_product" title="wikilink">Euclidean dot product</a> formula:</p>

<p>

<math display="block" id="Cosine_similarity:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùêö</mi>
    <mo>‚ãÖ</mo>
    <mi>ùêõ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>‚à•</mo>
     <mi>ùêö</mi>
     <mo>‚à•</mo>
    </mrow>
    <mrow>
     <mo>‚à•</mo>
     <mi>ùêõ</mi>
     <mo>‚à•</mo>
    </mrow>
    <mrow>
     <mi>cos</mi>
     <mi>Œ∏</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <ci>ùêö</ci>
     <ci>ùêõ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>ùêö</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>ùêõ</ci>
     </apply>
     <apply>
      <cos></cos>
      <ci>Œ∏</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{a}\cdot\mathbf{b}=\left\|\mathbf{a}\right\|\left\|\mathbf{b}\right\|\cos\theta
  </annotation>
 </semantics>
</math>

</p>

<p>Given two <a href="Vector_(geometric)" title="wikilink">vectors</a> of attributes, <em>A</em> and <em>B</em>, the cosine similarity, <em>cos(Œ∏)</em>, is represented using a <a href="dot_product" title="wikilink">dot product</a> and <a href="Magnitude_(mathematics)#Euclidean_vector_space" title="wikilink">magnitude</a> as</p>

<p>

<math display="block" id="Cosine_similarity:2">
 <semantics>
  <mrow>
   <mtext>similarity</mtext>
   <mo>=</mo>
   <mrow>
    <mi>cos</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Œ∏</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>A</mi>
     <mo>‚ãÖ</mo>
     <mi>B</mi>
    </mrow>
    <mrow>
     <mrow>
      <mo>‚à•</mo>
      <mi>A</mi>
      <mo>‚à•</mo>
     </mrow>
     <mrow>
      <mo>‚à•</mo>
      <mi>B</mi>
      <mo>‚à•</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>A</mi>
       <mi>i</mi>
      </msub>
      <mo>√ó</mo>
      <msub>
       <mi>B</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <msqrt>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>A</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
     <mo>√ó</mo>
     <msqrt>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>B</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>similarity</mtext>
     <apply>
      <cos></cos>
      <ci>Œ∏</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <root></root>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>A</ci>
           <ci>i</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>B</ci>
           <ci>i</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{similarity}=\cos(\theta)={A\cdot B\over\|A\|\|B\|}=\frac{\sum\limits_{i=%
1}^{n}{A_{i}\times B_{i}}}{\sqrt{\sum\limits_{i=1}^{n}{(A_{i})^{2}}}\times%
\sqrt{\sum\limits_{i=1}^{n}{(B_{i})^{2}}}}
  </annotation>
 </semantics>
</math>

</p>

<p>The resulting similarity ranges from ‚àí1 meaning exactly opposite, to 1 meaning exactly the same, with 0 indicating orthogonality (decorrelation), and in-between values indicating intermediate similarity or dissimilarity.</p>

<p>For text matching, the attribute vectors <em>A</em> and <em>B</em> are usually the <a href="tf-idf" title="wikilink">term frequency</a> vectors of the documents. The cosine similarity can be seen as a method of normalizing document length during comparison.</p>

<p>In the case of <a href="information_retrieval" title="wikilink">information retrieval</a>, the cosine similarity of two documents will range from 0 to 1, since the term frequencies (<a class="uri" href="tf-idf" title="wikilink">tf-idf</a> weights) cannot be negative. The angle between two term frequency vectors cannot be greater than¬†90¬∞.</p>

<p>If the attribute vectors are normalized by subtracting the vector means (e.g., 

<math display="inline" id="Cosine_similarity:3">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>-</mo>
   <mover accent="true">
    <mi>A</mi>
    <mo stretchy="false">¬Ø</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>A</ci>
    <apply>
     <ci>normal-¬Ø</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A-\bar{A}
  </annotation>
 </semantics>
</math>

), the measure is called centered cosine similarity and is equivalent to the <a href="Pearson_product-moment_correlation_coefficient#For_a_sample" title="wikilink">Pearson Correlation Coefficient</a>.</p>
<h3 id="angular-similarity">Angular similarity</h3>

<p>The term "cosine similarity" has also been used on occasion to express a different coefficient, although the most common use is as defined above. Using the same calculation of similarity, the normalised angle between the vectors can be used as a bounded similarity function within [0,1], calculated from the above definition of similarity by:</p>

<p>

<math display="block" id="Cosine_similarity:4">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi>cos</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mtext>similarity</mtext>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mi>œÄ</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cos></cos>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <mtext>similarity</mtext>
     </apply>
     <ci>œÄ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\frac{\cos^{-1}(\text{similarity})}{\pi}
  </annotation>
 </semantics>
</math>

 in a domain where vector coefficients may be positive or negative, or</p>

<p>

<math display="block" id="Cosine_similarity:5">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mfrac>
    <mrow>
     <mn>2</mn>
     <mo>‚ãÖ</mo>
     <mrow>
      <msup>
       <mi>cos</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mtext>similarity</mtext>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mi>œÄ</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <cn type="integer">2</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <mtext>similarity</mtext>
      </apply>
     </apply>
     <ci>œÄ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\frac{2\cdot\cos^{-1}(\text{similarity})}{\pi}
  </annotation>
 </semantics>
</math>

 in a domain where the vector coefficients are always positive.</p>

<p>Although the term "cosine similarity" has been used for this angular distance, the term is oddly used as the cosine of the angle is used only as a convenient mechanism for calculating the angle itself and is no part of the meaning. The advantage of the angular similarity coefficient is that, when used as a difference coefficient (by subtracting it from 1) the resulting function is a proper <a href="distance_metric" title="wikilink">distance metric</a>, which is not the case for the first meaning. However for most uses this is not an important property. For any use where only the relative ordering of similarity or distance within a set of vectors is important, then which function is used is immaterial as the resulting order will be unaffected by the choice.</p>
<h3 id="confusion-with-tanimoto-coefficient">Confusion with "Tanimoto" coefficient</h3>

<p>The cosine similarity may be easily confused with the Tanimoto metric - a specialised form of a similarity coefficient with a similar algebraic form:</p>

<p>

<math display="block" id="Cosine_similarity:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo>,</mo>
     <mi>B</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>A</mi>
     <mo>‚ãÖ</mo>
     <mi>B</mi>
    </mrow>
    <mrow>
     <mrow>
      <msup>
       <mrow>
        <mo>‚à•</mo>
        <mi>A</mi>
        <mo>‚à•</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mrow>
        <mo>‚à•</mo>
        <mi>B</mi>
        <mo>‚à•</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>A</mi>
      <mo>‚ãÖ</mo>
      <mi>B</mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <interval closure="open">
      <ci>A</ci>
      <ci>B</ci>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <ci>A</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <ci>B</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>normal-‚ãÖ</ci>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(A,B)={A\cdot B\over\|A\|^{2}+\|B\|^{2}-A\cdot B}
  </annotation>
 </semantics>
</math>

</p>

<p>In fact, this algebraic form <a href="Jaccard_index#Tanimoto_Similarity_and_Distance" title="wikilink">was first defined by Tanimoto</a> as a mechanism for calculating the <a href="Jaccard_coefficient" title="wikilink">Jaccard coefficient</a> in the case where the sets being compared are represented as <a href="bit_vector" title="wikilink">bit vectors</a>. While the formula extends to vectors in general, it has quite different properties from cosine similarity and bears little relation other than its superficial appearance.</p>
<h3 id="ochiai-coefficient">Ochiai coefficient</h3>

<p>This coefficient is also known in biology as Ochiai coefficient, or Ochiai-Barkman coefficient, or Otsuka-Ochiai coefficient:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Cosine_similarity:7">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>A</mi>
       <mo>‚à©</mo>
       <mi>B</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <msqrt>
     <mrow>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>A</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>√ó</mo>
       <mi>n</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>B</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msqrt>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>K</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <intersect></intersect>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>A</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=\frac{n(A\cap B)}{\sqrt{n(A)\times n(B)}}
  </annotation>
 </semantics>
</math>

 Here, 

<math display="inline" id="Cosine_similarity:8">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cosine_similarity:9">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 are sets, and 

<math display="inline" id="Cosine_similarity:10">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>A</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(A)
  </annotation>
 </semantics>
</math>

 is the number of elements in 

<math display="inline" id="Cosine_similarity:11">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

. If sets are represented as <a href="bit_vector" title="wikilink">bit vectors</a>, the Ochiai coefficient can be seen to be the same as the cosine similarity.</p>
<h2 id="properties">Properties</h2>

<p>Cosine similarity is related to <a href="Euclidean_distance" title="wikilink">Euclidean distance</a> as follows. Denote Euclidean distance by the usual 

<math display="inline" id="Cosine_similarity:12">
 <semantics>
  <mrow>
   <mo>‚à•</mo>
   <mrow>
    <mi>A</mi>
    <mo>-</mo>
    <mi>B</mi>
   </mrow>
   <mo>‚à•</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">norm</csymbol>
    <apply>
     <minus></minus>
     <ci>A</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|A-B\|
  </annotation>
 </semantics>
</math>

, and observe that</p>

<p>

<math display="block" id="Cosine_similarity:13">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>‚à•</mo>
     <mrow>
      <mi>A</mi>
      <mo>-</mo>
      <mi>B</mi>
     </mrow>
     <mo>‚à•</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>A</mi>
       <mo>-</mo>
       <mi>B</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>‚ä§</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mo>-</mo>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo>‚à•</mo>
       <mi>A</mi>
       <mo>‚à•</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo>‚à•</mo>
       <mi>B</mi>
       <mo>‚à•</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>A</mi>
      <mo>‚ä§</mo>
     </msup>
     <mi>B</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>A</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>A</ci>
        <ci>B</ci>
       </apply>
       <csymbol cd="latexml">top</csymbol>
      </apply>
      <apply>
       <minus></minus>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <ci>A</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <ci>B</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <csymbol cd="latexml">top</csymbol>
       </apply>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|A-B\|^{2}=(A-B)^{\top}(A-B)=\|A\|^{2}+\|B\|^{2}-2A^{\top}B
  </annotation>
 </semantics>
</math>

</p>

<p>by <a href="Polynomial_expansion" title="wikilink">expansion</a>. When 

<math display="inline" id="Cosine_similarity:14">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cosine_similarity:15">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 are normalized to unit length, 

<math display="inline" id="Cosine_similarity:16">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>‚à•</mo>
     <mi>A</mi>
     <mo>‚à•</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>‚à•</mo>
     <mi>B</mi>
     <mo>‚à•</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <ci>A</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <ci>B</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|A\|^{2}=\|B\|^{2}=1
  </annotation>
 </semantics>
</math>

 so the previous is equal to</p>

<p>

<math display="block" id="Cosine_similarity:17">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo>,</mo>
       <mi>B</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <cos></cos>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2(1-\cos(A,B))
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Null distribution:</strong> For data which can be negative as well as positive, the <a href="null_distribution" title="wikilink">null distribution</a> for cosine similarity is the distribution of the dot product of two independent random unit vectors. This distribution has a <a class="uri" href="mean" title="wikilink">mean</a> of zero and a <a class="uri" href="variance" title="wikilink">variance</a> of 

<math display="inline" id="Cosine_similarity:18">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/n
  </annotation>
 </semantics>
</math>

 (where 

<math display="inline" id="Cosine_similarity:19">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is the number of dimensions), and although the distribution is bounded between -1 and +1, as 

<math display="inline" id="Cosine_similarity:20">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 grows large the distribution is increasingly well-approximated by the <a href="normal_distribution" title="wikilink">normal distribution</a>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> For other types of data, such as bitstreams (taking values of 0 or 1 only), the null distribution will take a different form, and may have a nonzero mean.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="soft-cosine-measure">Soft cosine measure</h2>

<p>Soft cosine measure is a measure of ‚Äúsoft‚Äù similarity between two vectors, i.e., the measure that considers similarity of pairs of features.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The traditional cosine similarity considers the <a href="vector_space_model" title="wikilink">vector space model</a> (VSM) features as independent or completely different, while the soft cosine measure proposes considering the similarity of features in VSM, which allows generalization of the concepts of cosine measure and also the idea of similarity (soft similarity).</p>

<p>For example, in the field of <a href="natural_language_processing" title="wikilink">natural language processing</a> (NLP) the similarity between features is quite intuitive. Features such as words, n-grams or syntactic n-grams<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> can be quite similar, though formally they are considered as different features in the VSM. For example, words ‚Äúplay‚Äù and ‚Äúgame‚Äù are different words and thus are mapped to different dimensions in VSM; yet it is obvious that they are related semantically. In case of <a class="uri" href="n-grams" title="wikilink">n-grams</a> or syntactic n-grams, <a href="Levenshtein_distance" title="wikilink">Levenshtein distance</a> can be applied (in fact, Levenshtein distance can be applied to words as well).</p>

<p>For calculation of the soft cosine measure, the matrix 

<math display="inline" id="Cosine_similarity:21">
 <semantics>
  <mi>ùê¨</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê¨</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{s}
  </annotation>
 </semantics>
</math>

 of similarity between features is introduced. It can be calculated using Levenshtein distance or other similarity measures, e.g., various <a class="uri" href="WordNet" title="wikilink">WordNet</a> similarity measures. Then we just multiply by this matrix.</p>

<p>Given two 

<math display="inline" id="Cosine_similarity:22">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

-dimension vectors a and b, the soft cosine similarity is calculated as follows:</p>

<p>

<math display="inline" id="Cosine_similarity:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mrow>
       <mi>soft</mi>
       <mi mathvariant="normal">_</mi>
       <mi>cosine</mi>
      </mrow>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo>,</mo>
      <mi>b</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">‚àë</mo>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mi>j</mi>
        </mrow>
        <mi>N</mi>
       </msubsup>
       <mrow>
        <msub>
         <mi>s</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>b</mi>
         <mi>j</mi>
        </msub>
       </mrow>
      </mrow>
      <mrow>
       <msqrt>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">‚àë</mo>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>j</mi>
          </mrow>
          <mi>N</mi>
         </msubsup>
         <mrow>
          <msub>
           <mi>s</mi>
           <mrow>
            <mi>i</mi>
            <mi>j</mi>
           </mrow>
          </msub>
          <msub>
           <mi>a</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>a</mi>
           <mi>j</mi>
          </msub>
         </mrow>
        </mrow>
       </msqrt>
       <msqrt>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">‚àë</mo>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>j</mi>
          </mrow>
          <mi>N</mi>
         </msubsup>
         <mrow>
          <msub>
           <mi>s</mi>
           <mrow>
            <mi>i</mi>
            <mi>j</mi>
           </mrow>
          </msub>
          <msub>
           <mi>b</mi>
           <mi>i</mi>
          </msub>
          <msub>
           <mi>b</mi>
           <mi>j</mi>
          </msub>
         </mrow>
        </mrow>
       </msqrt>
      </mrow>
     </mfrac>
    </mstyle>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <times></times>
       <ci>soft</ci>
       <ci>normal-_</ci>
       <ci>cosine</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <ci>a</ci>
     <ci>b</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <list>
         <ci>i</ci>
         <ci>j</ci>
        </list>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <list>
           <ci>i</ci>
           <ci>j</ci>
          </list>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>s</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <list>
           <ci>i</ci>
           <ci>j</ci>
          </list>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>s</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{soft\_cosine}_{1}(a,b)=\frac{\sum\nolimits_{i,j}^{N%
}s_{ij}a_{i}b_{j}}{\sqrt{\sum\nolimits_{i,j}^{N}s_{ij}a_{i}a_{j}}\sqrt{\sum%
\nolimits_{i,j}^{N}s_{ij}b_{i}b_{j}}},
  </annotation>
 </semantics>
</math>


</p>

<p>where <mtpl> similarity(feature<sub><em>i</em></sub>, feature<sub><em>j</em></sub>)}}</mtpl>.</p>

<p>If there is no similarity between features (<mtpl> 1}}</mtpl>, <mtpl> 0}}</mtpl> for 

<math display="inline" id="Cosine_similarity:24">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mi mathvariant="normal">‚â†</mi>
   <mi>j</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>i</ci>
    <ci>normal-‚â†</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i‚â†j
  </annotation>
 </semantics>
</math>

), the given equation is equivalent to the conventional cosine similarity formula.</p>

<p>The complexity of this measure is quadratic, which makes it perfectly applicable to real world tasks. The complexity can be transformed to subquadratic.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="S√∏rensen_similarity_index" title="wikilink">S√∏rensen's quotient of similarity</a></li>
<li><a href="Hamming_distance" title="wikilink">Hamming distance</a></li>
<li><a class="uri" href="Correlation" title="wikilink">Correlation</a></li>
<li><a href="Dice's_coefficient" title="wikilink">Dice's coefficient</a></li>
<li><a href="Jaccard_index" title="wikilink">Jaccard index</a></li>
<li><a class="uri" href="SimRank" title="wikilink">SimRank</a></li>
<li><a href="Information_retrieval" title="wikilink">Information retrieval</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.appliedsoftwaredesign.com/archives/cosine-similarity-calculator/">Online Cosine Similarity Calculator</a></li>
<li>[<a class="uri" href="http://mathforum.org/kb/message.jspa?messageID=5658016&amp;tstart">http://mathforum.org/kb/message.jspa?messageID=5658016&amp;tstart;</a>;=0 Weighted cosine measure]</li>
<li><a href="http://blog.christianperone.com/?p=2497">A tutorial on cosine similarity using Python</a></li>
</ul>

<p>"</p>

<p><a href="Category:Information_retrieval_techniques" title="wikilink">Category:Information retrieval techniques</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Singhal, Amit (2001). "Modern Information Retrieval: A Brief Overview". Bulletin of the IEEE Computer Society Technical Committee on Data Engineering 24 (4): 35‚Äì43.<a href="#fnref1">‚Ü©</a></li>
<li id="fn2">P.-N. Tan, M. Steinbach &amp; V. Kumar, "Introduction to Data Mining", , Addison-Wesley (2005), ISBN 0-321-32136-7, chapter 8; page 500.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><em>Ochiai A.</em> Zoogeographical studies on the soleoid fishes found Japan and its neighboring regions. II // Bull. Jap. Soc. sci. Fish. 1957. V. 22. ‚Ññ 9. P. 526-530.<a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><em>Barkman J.J.</em> Phytosociology and ecology of cryptogamic epiphytes, including a taxonomic survey and description of their vegetation units in Europe. ‚Äì Assen. Van Gorcum. 1958. 628 p.<a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="http://stats.stackexchange.com/questions/85916/distribution-of-dot-products-between-two-random-unit-vectors-in-mathbbrd">CrossValidated: Distribution of dot products between two random unit vectors in RD</a><a href="#fnref6">‚Ü©</a></li>
<li id="fn7"><a href="#fnref7">‚Ü©</a></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
<li id="fn9"><a href="#fnref9">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

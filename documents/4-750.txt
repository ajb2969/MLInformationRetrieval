   Bayes factor      Bayes factor   In statistics , the use of Bayes factors is a Bayesian alternative to classical hypothesis testing . 1 2  Bayesian model comparison is a method of model selection based on Bayes factors.  Definition  The posterior probability Pr( M | D ) of a model M given data D is given by Bayes' theorem :        Pr   (  M  |  D  )    =     Pr   (  D  |  M  )     Pr   (  M  )      Pr   (  D  )      .       Pr  M  D        Pr  D  M    Pr  M     Pr  D      \Pr(M|D)=\frac{\Pr(D|M)\Pr(M)}{\Pr(D)}.     The key data-dependent term Pr( D | M ) is a likelihood , and represents the probability that some data are produced under the assumption of this model, M ; evaluating it correctly is the key to Bayesian model comparison.  Given a model selection problem in which we have to choose between two models, on the basis of observed data D , the plausibility of the two different models M 1 and M 2 , parametrised by model parameter vectors    θ  1     subscript  θ  1    \theta_{1}   and    θ  2     subscript  θ  2    \theta_{2}   is assessed by the Bayes factor  K given by       K  =    Pr   (  D  |   M  1   )     Pr   (  D  |   M  2   )     =    ∫    Pr   (   θ  1   |   M  1   )     Pr   (  D  |   θ  1   ,   M  1   )    d   θ  1      ∫    Pr   (   θ  2   |   M  2   )     Pr   (  D  |   θ  2   ,   M  2   )    d   θ  2       .        K     Pr  D   subscript  M  1     Pr  D   subscript  M  2                 Pr   subscript  θ  1    subscript  M  1     Pr  D   subscript  θ  1    subscript  M  1    d   subscript  θ  1          Pr   subscript  θ  2    subscript  M  2     Pr  D   subscript  θ  2    subscript  M  2    d   subscript  θ  2         K=\frac{\Pr(D|M_{1})}{\Pr(D|M_{2})}=\frac{\int\Pr(\theta_{1}|M_{1})\Pr(D|%
 \theta_{1},M_{1})\,d\theta_{1}}{\int\Pr(\theta_{2}|M_{2})\Pr(D|\theta_{2},M_{2%
 })\,d\theta_{2}}.     If instead of the Bayes factor integral, the likelihood corresponding to the maximum likelihood estimate of the parameter for each model is used, then the test becomes a classical likelihood-ratio test . Unlike a likelihood-ratio test, this Bayesian model comparison does not depend on any single set of parameters, as it integrates over all parameters in each model (with respect to the respective priors). However, an advantage of the use of Bayes factors is that it automatically, and quite naturally, includes a penalty for including too much model structure. 3 It thus guards against overfitting . For models where an explicit version of the likelihood is not available or too costly to evaluate numerically, approximate Bayesian computation can be used for model selection in a Bayesian framework, 4 with the caveat that approximate-Bayesian estimates of Bayes factors are often biased. 5  Other approaches are:   to treat model comparison as a decision problem , computing the expected value or cost of each model choice;  to use minimum message length (MML).   Interpretation  A value of K > 1 means that M 1 is more strongly supported by the data under consideration than M 2 . Note that classical hypothesis testing gives one hypothesis (or model) preferred status (the 'null hypothesis'), and only considers evidence against it. Harold Jeffreys gave a scale for interpretation of K : 6        K   dHart   bits   Strength of evidence       0      negative (supports M 2 )     10 0 to 10 1/2   0 to 5    0 to 1.6    barely worth mentioning     10 1/2 to 10 1   5 to 10    1.6 to 3.3    substantial     10 1 to 10 3/2   10 to 15    3.3 to 5.0    strong     10 3/2 to 10 2   15 to 20    5.0 to 6.6    very strong     > 10 2   > 20    > 6.6    decisive       The second column gives the corresponding weights of evidence in decihartleys (also known as decibans ); bits are added in the third column for clarity. According to I. J. Good a change in a weight of evidence of 1 deciban or 1/3 of a bit (i.e. a change in an odds ratio from evens to about 5:4) is about as finely as humans can reasonably perceive their degree of belief in a hypothesis in everyday use. 7  An alternative table, widely cited, is provided by Kass and Raftery (1995): 8        2 ln K   K   Strength of evidence       0 to 2   1 to 3    not worth more than a bare mention     2 to 6   3 to 20    positive     6 to 10   20 to 150    strong     >10   >150    very strong       The use of Bayes factors or classical hypothesis testing takes place in the context of inference rather than decision-making under uncertainty . That is, we merely wish to find out which hypothesis is true, rather than actually making a decision on the basis of this information. Frequentist statistics draws a strong distinction between these two because classical hypothesis tests are not coherent in the Bayesian sense. Bayesian procedures, including Bayes factors, are coherent, so there is no need to draw such a distinction. Inference is then simply regarded as a special case of decision-making under uncertainty in which the resulting action is to report a value. For decision-making, Bayesian statisticians might use a Bayes factor combined with a prior distribution and a loss function associated with making the wrong choice. In an inference context the loss function would take the form of a scoring rule . Use of a logarithmic score function for example, leads to the expected utility taking the form of the Kullback–Leibler divergence .  Example  Suppose we have a random variable that produces either a success or a failure. We want to compare a model M 1 where the probability of success is q = ½, and another model M 2 where q is unknown and we take a prior distribution for q that is uniform on [0,1]. We take a sample of 200, and find 115 successes and 85 failures. The likelihood can be calculated according to the binomial distribution :        (     200      115     )    q  115     (   1  -  q   )   85    .       binomial  200  115    superscript  q  115    superscript    1  q   85     {{200\choose 115}q^{115}(1-q)^{85}}.     Thus we have      P   (  X  =  115  ∣   M  1   )   =   (     200      115     )     (   1  2   )   200   =  0.005956...  ,     fragments  P   fragments  normal-(  X   115  normal-∣   subscript  M  1   normal-)     binomial  200  115    superscript   fragments  normal-(    1  2   normal-)   200    0.005956...  normal-,    P(X=115\mid M_{1})={200\choose 115}\left({1\over 2}\right)^{200}=0.005956...,\,     but      P   (  X  =  115  ∣   M  2   )   =   ∫  0  1    (     200      115     )    q  115     (  1  -  q  )   85   d  q  =   1  201   =  0.004975....     fragments  P   fragments  normal-(  X   115  normal-∣   subscript  M  2   normal-)     superscript   subscript   0   1    binomial  200  115    superscript  q  115    superscript   fragments  normal-(  1   q  normal-)   85   d  q     1  201    0.004975....    P(X=115\mid M_{2})=\int_{0}^{1}{200\choose 115}q^{115}(1-q)^{85}dq={1\over 201%
 }=0.004975....     The ratio is then 1.197..., which is "barely worth mentioning" even if it points very slightly towards M 1 .  This is not the same as a classical likelihood-ratio test , which would have found the maximum likelihood estimate for q , namely 115 ⁄ 200 = 0.575, whence    P   (  X  =  115  ∣   M  2   )   =   (      200      115      )    q  115     (  1  -  q  )   85   =  0.056991     fragments  P   fragments  normal-(  X   115  normal-∣   subscript  M  2   normal-)     binomial  200  115    superscript  q  115    superscript   fragments  normal-(  1   q  normal-)   85    0.056991    \textstyle P(X=115\mid M_{2})={{200\choose 115}q^{115}(1-q)^{85}}=0.056991   (rather than averaging over all possible q ). That gives a likelihood ratio of 0.1045, and so pointing towards M 2 .  The modern method of relative likelihood takes into account the number of free parameters in the models, unlike the classical likelihood ratio. The relative likelihood method could be applied as follows. Model M 1 has 0 parameters, and so its AIC value is 2·0 − 2·ln(0.005956) = 10.2467. Model M 2 has 1 parameter, and so its AIC value is 2·1 − 2·ln(0.056991) = 7.7297. Hence M 1 is about exp((7.7297 − 10.2467)/2) = 0.284 times as probable as M 2 to minimize the information loss. Thus M 2 is slightly preferred, but M 1 cannot be excluded.  A frequentist  hypothesis test of M 1 (here considered as a null hypothesis ) would have produced a very different result. Such a test says that M 1 should be rejected at the 5% significance level, since the probability of getting 115 or more successes from a sample of 200 if q = ½ is 0.0200, and as a two-tailed test of getting a figure as extreme as or more extreme than 115 is 0.0400. Note that 115 is more than two standard deviations away from 100.  M 2 is a more complex model than M 1 because it has a free parameter which allows it to model the data more closely. The ability of Bayes factors to take this into account is a reason why Bayesian inference has been put forward as a theoretical justification for and generalisation of Occam's razor , reducing Type I errors . 9  See also   Akaike information criterion  Approximate Bayesian Computation  Bayesian information criterion  Deviance information criterion  Lindley's paradox  Minimum message length  Model selection    Statistical ratios    Odds ratio  Relative risk   Notes  References       Jaynes, E. T. (1994), Probability Theory: the logic of science , chapter 24.     External links   BayesFactor —an R package for computing Bayes factors in common research designs  Bayes Factor Calculators —web-based version of much of the BayesFactor package   "  Factor  Category:Model selection  Category:Statistical ratios     ↩  ↩  ↩  ↩  ↩  p. 432 ↩  ↩   Sharpening Ockham's Razor On a Bayesian Strop ↩     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1965">Tanh-sinh quadrature</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Tanh-sinh quadrature</h1>
<hr/>

<p><strong>Tanh-sinh quadrature</strong> is a method for <a href="numerical_integration" title="wikilink">numerical integration</a> introduced by Hidetosi Takahasi and Masatake Mori in 1974.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> It uses <a href="hyperbolic_function" title="wikilink">hyperbolic functions</a> in the <a href="change_of_variables" title="wikilink">change of variables</a></p>

<p>

<math display="block" id="Tanh-sinh_quadrature:0">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>tanh</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mi>π</mi>
      <mrow>
       <mi>sinh</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <tanh></tanh>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>π</ci>
      <apply>
       <sinh></sinh>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\tanh(\tfrac{1}{2}\pi\sinh t)\,
  </annotation>
 </semantics>
</math>

</p>

<p>to transform an integral on the interval <em>x</em> ∈ (−1, +1) to an integral on the entire <a href="real_line" title="wikilink">real line</a> <em>t</em> ∈ (−∞,+∞). After this transformation, the integrand decays with a <a href="Double_exponential_function" title="wikilink">double exponential</a> rate, and thus, this method is also known as the <strong>double exponential (DE) formula</strong>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>For a given step size <em>h</em>, the integral is approximated by the sum</p>

<p>

<math display="block" id="Tanh-sinh_quadrature:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mo>-</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>k</mi>
      </msub>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>k</ci>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-1}^{1}f(x)\,dx\approx\sum_{k=-\infty}^{\infty}w_{k}f(x_{k}),
  </annotation>
 </semantics>
</math>

</p>

<p>with the <a class="uri" href="abscissas" title="wikilink">abscissas</a></p>

<p>

<math display="block" id="Tanh-sinh_quadrature:2">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>tanh</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mi>π</mi>
      <mrow>
       <mi>sinh</mi>
       <mrow>
        <mi>k</mi>
        <mi>h</mi>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <tanh></tanh>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>π</ci>
      <apply>
       <sinh></sinh>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\tanh(\tfrac{1}{2}\pi\sinh kh)
  </annotation>
 </semantics>
</math>

 and the weights</p>

<p>

<math display="block" id="Tanh-sinh_quadrature:3">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>w</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>h</mi>
      <mi>π</mi>
      <mrow>
       <mi>cosh</mi>
       <mrow>
        <mi>k</mi>
        <mi>h</mi>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <msup>
       <mi>cosh</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mi>π</mi>
        <mrow>
         <mi>sinh</mi>
         <mrow>
          <mi>k</mi>
          <mi>h</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>h</ci>
      <ci>π</ci>
      <apply>
       <cosh></cosh>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cosh></cosh>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>π</ci>
       <apply>
        <sinh></sinh>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>h</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{k}=\frac{\tfrac{1}{2}h\pi\cosh kh}{\cosh^{2}(\tfrac{1}{2}\pi\sinh kh)}.
  </annotation>
 </semantics>
</math>

</p>

<p>Like <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a>, tanh-sinh quadrature is well suited for <a href="arbitrary-precision_arithmetic" title="wikilink">arbitrary-precision</a> integration, where an accuracy of hundreds or even thousands of digits is desired. The <a href="rate_of_convergence" title="wikilink">convergence</a> is exponential (in the discretization sense) for sufficiently well-behaved integrands: doubling the number of evaluation points roughly doubles the number of correct digits.</p>

<p>Tanh-sinh quadrature is less efficient than Gaussian quadrature for smooth integrands, but unlike Gaussian quadrature tends to work equally well with integrands having singularities or infinite derivatives at one or both endpoints of the integration interval. A further advantage is that the abscissas and weights are relatively easy to compute. The cost of calculating abscissa–weight pairs for <em>n</em>-digit accuracy is roughly <em>n</em><sup>2</sup> log<sup>2</sup> <em>n</em> compared to <em>n</em><sup>3</sup> log <em>n</em> for Gaussian quadrature.</p>

<p>Upon comparing the scheme to Gaussian quadrature and <a href="error_function_quadrature" title="wikilink">error function quadrature</a>, Bailey et al. (2005) found that the tanh-sinh scheme "appears to be the best for integrands of the type most often encountered in experimental math research".</p>

<p>Bailey and others have done extensive research on tanh-sinh quadrature, Gaussian quadrature and error function quadrature, as well as several of the classical quadrature methods, and found that the classical methods are not competitive with the first three methods, particularly when high-precision results are required. In a conference paper (July 2004) comparing tanh-sinh quadrature with Gaussian quadrature and error function quadrature, Bailey and Li found: "Overall, the tanh-sinh scheme appears to be the best. It combines uniformly excellent accuracy with fast run times. <em>It is the nearest we have to a truly all-purpose quadrature scheme at the present time.</em>"</p>

<p>Bailey (2006) found that: "The tanh-sinh quadrature scheme <em>is the fastest known high-precision quadrature scheme</em>, especially when the time for computing abscissas and weights is considered. It has been successfully employed for quadrature calculations of up to 20,000-digit precision. It works well for functions with blow-up singularities or infinite derivatives at endpoints."</p>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li><a href="David_H._Bailey" title="wikilink">David H. Bailey</a>, "<a href="http://crd.lbl.gov/~dhbailey/dhbpapers/dhb-tanh-sinh.pdf">Tanh-Sinh High-Precision Quadrature</a>". (2006).</li>
<li>Pascal Molin, <a href="http://tel.archives-ouvertes.fr/tel-00537489/fr/">Intégration numérique et calculs de fonctions L</a> , doctoral thesis (2010).</li>
<li>David H. Bailey, Karthik Jeyabalan, and Xiaoye S. Li, "<a href="http://crd-legacy.lbl.gov/~dhbailey/dhbpapers/quadrature.pdf">A comparison of three high-precision quadrature schemes</a>". <em>Experimental Mathematics</em>, 14.3 (2005).</li>
<li>David H. Bailey, Jonathan M. Borwein, David Broadhurst, and Wadim Zudlin, <a href="http://crd.lbl.gov/~dhbailey/dhbpapers/bbbz-conmath.pdf">Experimental mathematics and mathematical physics</a>, in Gems in Experimental Mathematics (2010), American Mathematical Society, pp. 41–58.</li>
<li><a href="Jonathan_Borwein" title="wikilink">Jonathan Borwein</a>, David H. Bailey, and Roland Girgensohn, <em>Experimentation in Mathematics—Computational Paths to Discovery</em>. A K Peters, 2003. ISBN 1-56881-136-5.</li>
<li>

<p>. This paper is also available from <a href="http://www.kurims.kyoto-u.ac.jp/~okamoto/paper/Publ_RIMS_DE/41-4-38.pdf">here</a>.</p></li>
<li></li>
<li>

<p>. This paper is also available from [<a class="uri" href="http://www.ems-ph.org/journals/show_pdf.php?issn=0034-5318&amp;vol">http://www.ems-ph.org/journals/show_pdf.php?issn=0034-5318&amp;vol;</a>;=9&amp;iss;=3&amp;rank;=12 here].</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>John D. Cook, "<a href="http://www.johndcook.com/double_exponential_integration.html">Double Exponential Integration</a>" with <a href="http://www.codeproject.com/KB/recipes/FastNumericalIntegration.aspx">source code</a>.</li>
<li>Graeme Dennes, "<a href="https://newtonexcelbach.wordpress.com/2014/12/29/numerical-integration-tanh-sinh-quadrature-v-4-3/">Numerical Integration: Tanh-Sinh Quadrature v4.3</a>" A Microsoft Excel workbook containing thirteen quadrature programs for performing Tanh-Sinh, Double-Exponential, <a href="Gauss–Kronrod_quadrature_formula" title="wikilink">Gauss–Kronrod</a>, Recursive Monotone Stable (RMS) and <a href="Romberg's_method" title="wikilink">Romberg</a> numerical integration of functions over the finite interval (<em>a</em>,<em>b</em>), semi-infinite intervals (<em>−∞</em>,<em>b</em>) and (<em>a</em>,<em>∞</em>), and infinite interval (<em>-∞</em>,<em>∞</em>), for periodic and non-periodic functions. Demonstrates the <em>astounding speed and accuracy</em> of the Tanh-Sinh method in particular and the Double-Exponential method in general, all of which are members of the family of Double-Exponential quadrature techniques developed by Takahasi and Mori in 1974. The quadrature programs are demonstrated using an extensive, diverse range of test functions. Full open source code is provided, including extensive documentation.</li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_integration_(quadrature)" title="wikilink">Category:Numerical integration (quadrature)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

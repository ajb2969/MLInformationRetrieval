   Normal-gamma distribution      Normal-gamma distribution   {\Gamma(\alpha)\sqrt{2\pi}} \, \tau^{\alpha-\frac{1}{2}}\,e^{-\beta\tau}\,e^{ -\frac{ \lambda \tau (x- \mu)^2}{2}}|  cdfÂ Â Â Â Â Â Â Â =|  meanÂ Â Â Â Â Â Â = 1        E   (  X  )    =  Î¼   ,    E   (   \Tau   )    =   Î±   Î²   -  1         formulae-sequence     normal-E  X   Î¼      normal-E  \Tau     Î±   superscript  Î²    1        \operatorname{E}(X)=\mu\,\!,\quad\operatorname{E}(\Tau)=\alpha\beta^{-1}    |  medianÂ Â Â Â Â =Â Â |  modeÂ Â Â Â Â Â Â =     (  Î¼  ,    Î±  -   1  2    Î²   )     Î¼      Î±    1  2    Î²     \left(\mu,\frac{\alpha-\frac{1}{2}}{\beta}\right)    |  varianceÂ Â Â = 2        var   (  X  )    =   Î²   Î»   (   Î±  -  1   )      ,    var   (   \Tau   )    =   Î±   Î²   -  2         formulae-sequence     var  X     Î²    Î»    Î±  1         var  \Tau     Î±   superscript  Î²    2        \operatorname{var}(X)=\frac{\beta}{\lambda(\alpha-1)},\quad\operatorname{var}(%
 \Tau)=\alpha\beta^{-2}    |  skewnessÂ Â Â =|  kurtosisÂ Â Â =|  entropyÂ Â Â Â =|  mgfÂ Â Â Â Â Â Â Â =|  charÂ Â Â Â Â Â Â =|  }} In probability theory and statistics , the normal-gamma distribution (or Gaussian-gamma distribution ) is a bivariate four-parameter family of continuous probability distributions . It is the conjugate prior of a normal distribution with unknown mean and precision . 3  Definition  For a pair of random variable , ( X , T ), suppose that the conditional distribution of X given T is given by      X  |  T  âˆ¼  N   (  Î¼  ,  1  /   (  Î»  T  )   )   ,     fragments  X  normal-|  T  similar-to  N   fragments  normal-(  Î¼  normal-,  1    fragments  normal-(  Î»  T  normal-)   normal-)   normal-,    X|T\sim N(\mu,1/(\lambda T))\,\!,     meaning that the conditional distribution is a normal distribution with mean    Î¼   Î¼   \mu   and precision     Î»  T      Î»  T    \lambda T   â€” equivalently, with variance      1  /   (   Î»  T   )    .      1    Î»  T     1/(\lambda T).     Suppose also that the marginal distribution of T is given by      T  |  Î±  ,  Î²  âˆ¼  Gamma   (  Î±  ,  Î²  )   ,     fragments  T  normal-|  Î±  normal-,  Î²  similar-to  Gamma   fragments  normal-(  Î±  normal-,  Î²  normal-)   normal-,    T|\alpha,\beta\sim\mathrm{Gamma}(\alpha,\beta)\!,     where this means that T has a gamma distribution . Here Î», Î± and Î² are parameters of the joint distribution.  Then ( X , T ) has a normal-gamma distribution, and this is denoted by        (  X  ,  T  )   âˆ¼   NormalGamma   (  Î¼  ,  Î»  ,  Î±  ,  Î²  )     .     similar-to   X  T     NormalGamma   Î¼  Î»  Î±  Î²      (X,T)\sim\mathrm{NormalGamma}(\mu,\lambda,\alpha,\beta)\!.     Properties  Probability density function  The joint probability density function of ( X , T ) is      f   (  x  ,  Ï„  |  Î¼  ,  Î»  ,  Î±  ,  Î²  )   =      Î²  Î±    Î»     Î“   (  Î±  )     2  Ï€         Ï„   Î±  -   1  2        e   -   Î²  Ï„       e   -    Î»  Ï„    (   x  -  Î¼   )   2    2        fragments  f   fragments  normal-(  x  normal-,  Ï„  normal-|  Î¼  normal-,  Î»  normal-,  Î±  normal-,  Î²  normal-)         superscript  Î²  Î±     Î»      normal-Î“  Î±      2  Ï€       superscript  Ï„    Î±    1  2      superscript  e      Î²  Ï„      superscript  e        Î»  Ï„   superscript    x  Î¼   2    2       f(x,\tau|\mu,\lambda,\alpha,\beta)=\frac{\beta^{\alpha}\sqrt{\lambda}}{\Gamma(%
 \alpha)\sqrt{2\pi}}\,\tau^{\alpha-\frac{1}{2}}\,e^{-\beta\tau}\,e^{-\frac{%
 \lambda\tau(x-\mu)^{2}}{2}}     Marginal distributions  By construction, the marginal distribution over   Ï„   Ï„   \tau   is a gamma distribution , and the conditional distribution over   x   x   x   given   Ï„   Ï„   \tau   is a Gaussian distribution . The marginal distribution over   x   x   x   is a three-parameter non-standardized Student's t-distribution with parameters     (  Î½  ,  Î¼  ,   Ïƒ  2   )   =   (   2  Î±   ,  Î¼  ,   Î²  /   (   Î»  Î±   )    )        Î½  Î¼   superscript  Ïƒ  2       2  Î±   Î¼    Î²    Î»  Î±       (\nu,\mu,\sigma^{2})=(2\alpha,\mu,\beta/(\lambda\alpha))   .  Exponential family  The normal-gamma distribution is a four-parameter exponential family with natural parameters      Î±  -   1  /  2    ,    -  Î²   -    Î»   Î¼  2    /  2    ,   Î»  Î¼   ,   -   Î»  /  2         Î±    1  2        Î²       Î»   superscript  Î¼  2    2      Î»  Î¼       Î»  2      \alpha-1/2,-\beta-\lambda\mu^{2}/2,\lambda\mu,-\lambda/2   and natural statistics      ln  Ï„   ,  Ï„  ,   Ï„  x   ,   Ï„   x  2         Ï„   Ï„    Ï„  x     Ï„   superscript  x  2      \ln\tau,\tau,\tau x,\tau x^{2}   .  Moments of the natural statistics  The following moments can be easily computed using the moment generating function of the sufficient statistic :       E   (   ln  T   )    =    Ïˆ   (  Î±  )    -   ln  Î²         normal-E    T        Ïˆ  Î±     Î²      \operatorname{E}(\ln T)=\psi\left(\alpha\right)-\ln\beta   , where    Ïˆ   (  Î±  )       Ïˆ  Î±    \psi\left(\alpha\right)   is the digamma function ,       E   (  T  )    =   Î±  Î²        normal-E  T     Î±  Î²     \operatorname{E}(T)=\frac{\alpha}{\beta}   ,       E   (   T  X   )    =   Î¼   Î±  Î²         normal-E    T  X      Î¼    Î±  Î²      \operatorname{E}(TX)=\mu\frac{\alpha}{\beta}   ,       E   (   T   X  2    )    =    1  Î»   +    Î¼  2    Î±  Î²          normal-E    T   superscript  X  2         1  Î»      superscript  Î¼  2     Î±  Î²       \operatorname{E}(TX^{2})=\frac{1}{\lambda}+\mu^{2}\frac{\alpha}{\beta}   .  Scaling  If      (  X  ,  T  )   âˆ¼   NormalGamma   (  Î¼  ,  Î»  ,  Î±  ,  Î²  )     ,     similar-to   X  T     NormalGamma   Î¼  Î»  Î±  Î²      (X,T)\sim\mathrm{NormalGamma}(\mu,\lambda,\alpha,\beta),   then for any b > 0, ( bX , bT ) is distributed as     NormalGamma   (   b  Î¼   ,  Î»  ,  Î±  ,    b  2   Î²   )    .      NormalGamma     b  Î¼   Î»  Î±     superscript  b  2   Î²      {\rm NormalGamma}(b\mu,\lambda,\alpha,b^{2}\beta).     Posterior distribution of the parameters  Assume that x is distributed according to a normal distribution with unknown mean   Î¼   Î¼   \mu   and precision   Ï„   Ï„   \tau   .      x  âˆ¼   ğ’©   (  Î¼  ,   Ï„   -  1    )       similar-to  x    ğ’©   Î¼   superscript  Ï„    1        x\sim\mathcal{N}(\mu,\tau^{-1})   and that the prior distribution on   Î¼   Î¼   \mu   and   Ï„   Ï„   \tau   ,    (  Î¼  ,  Ï„  )     Î¼  Ï„    (\mu,\tau)   , has a normal-gamma distribution        (  Î¼  ,  Ï„  )   âˆ¼   NormalGamma   (   Î¼  0   ,   Î»  0   ,   Î±  0   ,   Î²  0   )     ,     similar-to   Î¼  Ï„     NormalGamma    subscript  Î¼  0    subscript  Î»  0    subscript  Î±  0    subscript  Î²  0       (\mu,\tau)\sim\text{NormalGamma}(\mu_{0},\lambda_{0},\alpha_{0},\beta_{0}),     for which the density Ï€ satisfies        Ï€   (  Î¼  ,  Ï„  )    âˆ     Ï„    Î±  0   -   1  2       exp   [   -    Î²  0   Ï„    ]     exp   [   -     Î»  0   Ï„    (   Î¼  -   Î¼  0    )   2    2    ]      .     proportional-to    Ï€   Î¼  Ï„       superscript  Ï„     subscript  Î±  0     1  2            subscript  Î²  0   Ï„              subscript  Î»  0   Ï„   superscript    Î¼   subscript  Î¼  0    2    2        \pi(\mu,\tau)\propto\tau^{\alpha_{0}-\frac{1}{2}}\,\exp[{-\beta_{0}\tau}]\,%
 \exp[{-\frac{\lambda_{0}\tau(\mu-\mu_{0})^{2}}{2}}].     Given a dataset   ğ—   ğ—   \mathbf{X}   , consisting of   n   n   n    independent and identically distributed random variables (i.i.d),    {   x  1   ,  â€¦  ,   x  n   }      subscript  x  1   normal-â€¦   subscript  x  n     \{x_{1},...,x_{n}\}   , the posterior distribution of   Î¼   Î¼   \mu   and   Ï„   Ï„   \tau   given this dataset can be analytically determined by Bayes' theorem . Explicitly,      ğ   (  Ï„  ,  Î¼  |  ğ—  )   âˆ  ğ‹   (  ğ—  |  Ï„  ,  Î¼  )   Ï€   (  Ï„  ,  Î¼  )      fragments  P   fragments  normal-(  Ï„  normal-,  Î¼  normal-|  X  normal-)   proportional-to  L   fragments  normal-(  X  normal-|  Ï„  normal-,  Î¼  normal-)   Ï€   fragments  normal-(  Ï„  normal-,  Î¼  normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})\propto\mathbf{L}(\mathbf{X}|\tau,\mu)\pi(\tau,\mu)   , where   ğ‹   ğ‹   \mathbf{L}   is the likelihood of the data given the parameters.  Since the data are i.i.d, the likelihood of the entire dataset is equal to the product of the likelihoods of the individual data samples:      ğ‹   (  ğ—  |  Ï„  ,  Î¼  )   =   âˆ   i  =  1   n   ğ‹   (   x  i   |  Ï„  ,  Î¼  )   .     fragments  L   fragments  normal-(  X  normal-|  Ï„  normal-,  Î¼  normal-)     superscript   subscript  product    i  1    n   L   fragments  normal-(   subscript  x  i   normal-|  Ï„  normal-,  Î¼  normal-)   normal-.    \mathbf{L}(\mathbf{X}|\tau,\mu)=\prod_{i=1}^{n}\mathbf{L}(x_{i}|\tau,\mu).     This expression can be simplified as follows:      ğ‹   (  ğ—  |  Ï„  ,  Î¼  )      fragments  L   fragments  normal-(  X  normal-|  Ï„  normal-,  Î¼  normal-)     \displaystyle\mathbf{L}(\mathbf{X}|\tau,\mu)     where     x  Â¯   =    1  n     âˆ‘   i  =  1   n    x  i          normal-Â¯  x       1  n     superscript   subscript     i  1    n    subscript  x  i       \bar{x}=\frac{1}{n}\sum_{i=1}^{n}x_{i}   , the mean of the data samples, and    s  =    1  n     âˆ‘   i  =  1   n     (    x  i   -   x  Â¯    )   2         s      1  n     superscript   subscript     i  1    n    superscript     subscript  x  i    normal-Â¯  x    2       s=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}   , the sample variance.  The posterior distribution of the parameters is proportional to the prior times the likelihood.      ğ   (  Ï„  ,  Î¼  |  ğ—  )      fragments  P   fragments  normal-(  Ï„  normal-,  Î¼  normal-|  X  normal-)     \displaystyle\mathbf{P}(\tau,\mu|\mathbf{X})     The final exponential term is simplified by completing the square.        Î»  0     (   Î¼  -   Î¼  0    )   2    +   n    (    x  Â¯   -  Î¼   )   2           subscript  Î»  0    superscript    Î¼   subscript  Î¼  0    2      n   superscript     normal-Â¯  x   Î¼   2      \displaystyle\lambda_{0}(\mu-\mu_{0})^{2}+n(\bar{x}-\mu)^{2}     On inserting this back into the expression above,      ğ   (  Ï„  ,  Î¼  |  ğ—  )      fragments  P   fragments  normal-(  Ï„  normal-,  Î¼  normal-|  X  normal-)     \displaystyle\mathbf{P}(\tau,\mu|\mathbf{X})     This final expression is in exactly the same form as a Normal-Gamma distribution, i.e.,      ğ   (  Ï„  ,  Î¼  |  ğ—  )   =  NormalGamma   (      Î»  0    Î¼  0    +   n   x  Â¯       Î»  0   +  n    ,   Î»  0   +  n  ,   Î±  0   +   n  2   ,   Î²  0   +   1  2    (  n  s  +     Î»  0   n    (    x  Â¯   -   Î¼  0    )   2      Î»  0   +  n    )   )      fragments  P   fragments  normal-(  Ï„  normal-,  Î¼  normal-|  X  normal-)    NormalGamma   fragments  normal-(         subscript  Î»  0    subscript  Î¼  0      n   normal-Â¯  x        subscript  Î»  0   n    normal-,   subscript  Î»  0    n  normal-,   subscript  Î±  0      n  2   normal-,   subscript  Î²  0      1  2    fragments  normal-(  n  s        subscript  Î»  0   n   superscript     normal-Â¯  x    subscript  Î¼  0    2       subscript  Î»  0   n    normal-)   normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}\left(\frac{\lambda_{0}\mu_{%
 0}+n\bar{x}}{\lambda_{0}+n},\lambda_{0}+n,\alpha_{0}+\frac{n}{2},\beta_{0}+%
 \frac{1}{2}\left(ns+\frac{\lambda_{0}n(\bar{x}-\mu_{0})^{2}}{\lambda_{0}+n}%
 \right)\right)     Interpretation of parameters  The interpretation of parameters in terms of pseudo-observations is as follows:   The new mean takes a weighted average of the old pseudo-mean and the observed mean, weighted by the number of associated (pseudo-)observations.  The precision was estimated from    2  Î±      2  Î±    2\alpha   pseudo-observations (i.e. possibly a different number of pseudo-observations, to allow the variance of the mean and precision to be controlled separately) with sample mean   Î¼   Î¼   \mu   and sample variance    Î²  Î±      Î²  Î±    \frac{\beta}{\alpha}   (i.e. with sum of squared deviations     2  Î²      2  Î²    2\beta   ).  The posterior updates the number of pseudo-observations (    Î»  0     subscript  Î»  0    \lambda_{0}   ) simply by adding up the corresponding number of new observations (   n   n   n   ).  The new sum of squared deviations is computed by adding the previous respective sums of squared deviations. However, a third "interaction term" is needed because the two sets of squared deviations were computed with respect to different means, and hence the sum of the two underestimates the actual total squared deviation.   As a consequence, if one has a prior mean of    Î¼  0     subscript  Î¼  0    \mu_{0}   from    n  Î¼     subscript  n  Î¼    n_{\mu}   samples and a prior precision of    Ï„  0     subscript  Ï„  0    \tau_{0}   from    n  Ï„     subscript  n  Ï„    n_{\tau}   samples, the prior distribution over   Î¼   Î¼   \mu   and   Ï„   Ï„   \tau   is      ğ   (  Ï„  ,  Î¼  |  ğ—  )   =  NormalGamma   (   Î¼  0   ,   n  Î¼   ,    n  Ï„   2   ,    n  Ï„    2   Ï„  0     )      fragments  P   fragments  normal-(  Ï„  normal-,  Î¼  normal-|  X  normal-)    NormalGamma   fragments  normal-(   subscript  Î¼  0   normal-,   subscript  n  Î¼   normal-,     subscript  n  Ï„   2   normal-,     subscript  n  Ï„     2   subscript  Ï„  0     normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}(\mu_{0},n_{\mu},\frac{n_{%
 \tau}}{2},\frac{n_{\tau}}{2\tau_{0}})     and after observing   n   n   n   samples with mean   Î¼   Î¼   \mu   and variance   s   s   s   , the posterior probability is      ğ   (  Ï„  ,  Î¼  |  ğ—  )   =  NormalGamma   (      n  Î¼    Î¼  0    +   n  Î¼      n  Î¼   +  n    ,   n  Î¼   +  n  ,   1  2    (   n  Ï„   +  n  )   ,   1  2    (    n  Ï„    Ï„  0    +  n  s  +     n  Î¼   n    (   Î¼  -   Î¼  0    )   2      n  Î¼   +  n    )   )      fragments  P   fragments  normal-(  Ï„  normal-,  Î¼  normal-|  X  normal-)    NormalGamma   fragments  normal-(         subscript  n  Î¼    subscript  Î¼  0      n  Î¼       subscript  n  Î¼   n    normal-,   subscript  n  Î¼    n  normal-,    1  2    fragments  normal-(   subscript  n  Ï„    n  normal-)   normal-,    1  2    fragments  normal-(     subscript  n  Ï„    subscript  Ï„  0     n  s        subscript  n  Î¼   n   superscript    Î¼   subscript  Î¼  0    2       subscript  n  Î¼   n    normal-)   normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}\left(\frac{n_{\mu}\mu_{0}+n%
 \mu}{n_{\mu}+n},n_{\mu}+n,\frac{1}{2}(n_{\tau}+n),\frac{1}{2}\left(\frac{n_{%
 \tau}}{\tau_{0}}+ns+\frac{n_{\mu}n(\mu-\mu_{0})^{2}}{n_{\mu}+n}\right)\right)     Note that in some programming languages, such as Matlab , the gamma distribution is implemented with the inverse definition of   Î²   Î²   \beta   , so the fourth argument of the Normal-Gamma distribution is     2   Ï„  0    /   n  Ï„         2   subscript  Ï„  0     subscript  n  Ï„     2\tau_{0}/n_{\tau}   .  Generating normal-gamma random variates  Generation of random variates is straightforward:   Sample   Ï„   Ï„   \tau   from a gamma distribution with parameters   Î±   Î±   \alpha   and   Î²   Î²   \beta     Sample   x   x   x   from a normal distribution with mean   Î¼   Î¼   \mu   and variance    1  /   (   Î»  Ï„   )       1    Î»  Ï„     1/(\lambda\tau)      Related distributions   The normal-inverse-gamma distribution is essentially the same distribution parameterized by variance rather than precision  The normal-exponential-gamma distribution   Notes  References   Bernardo, J.M.; Smith, A.F.M. (1993) Bayesian Theory , Wiley. ISBN 0-471-49464-X  Dearden et al. "Bayesian Q-learning" , Proceedings of the Fifteenth National Conference on Artificial Intelligence (AAAI-98) , July 26â€“30, 1998, Madison, Wisconsin, USA.   "  Category:Multivariate continuous distributions  Category:Conjugate prior distributions  Category:Normal distribution  Category:Probability distributions     Bernardo  &  Smith  (1993,  p.434) â†©   Bernardo & Smith (1993, pages 136, 268, 434) â†©     
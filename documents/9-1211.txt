   Normal-gamma distribution      Normal-gamma distribution   {\Gamma(\alpha)\sqrt{2\pi}} \, \tau^{\alpha-\frac{1}{2}}\,e^{-\beta\tau}\,e^{ -\frac{ \lambda \tau (x- \mu)^2}{2}}|  cdf        =|  mean       = 1        E   (  X  )    =  μ   ,    E   (   \Tau   )    =   α   β   -  1         formulae-sequence     normal-E  X   μ      normal-E  \Tau     α   superscript  β    1        \operatorname{E}(X)=\mu\,\!,\quad\operatorname{E}(\Tau)=\alpha\beta^{-1}    |  median     =  |  mode       =     (  μ  ,    α  -   1  2    β   )     μ      α    1  2    β     \left(\mu,\frac{\alpha-\frac{1}{2}}{\beta}\right)    |  variance   = 2        var   (  X  )    =   β   λ   (   α  -  1   )      ,    var   (   \Tau   )    =   α   β   -  2         formulae-sequence     var  X     β    λ    α  1         var  \Tau     α   superscript  β    2        \operatorname{var}(X)=\frac{\beta}{\lambda(\alpha-1)},\quad\operatorname{var}(%
 \Tau)=\alpha\beta^{-2}    |  skewness   =|  kurtosis   =|  entropy    =|  mgf        =|  char       =|  }} In probability theory and statistics , the normal-gamma distribution (or Gaussian-gamma distribution ) is a bivariate four-parameter family of continuous probability distributions . It is the conjugate prior of a normal distribution with unknown mean and precision . 3  Definition  For a pair of random variable , ( X , T ), suppose that the conditional distribution of X given T is given by      X  |  T  ∼  N   (  μ  ,  1  /   (  λ  T  )   )   ,     fragments  X  normal-|  T  similar-to  N   fragments  normal-(  μ  normal-,  1    fragments  normal-(  λ  T  normal-)   normal-)   normal-,    X|T\sim N(\mu,1/(\lambda T))\,\!,     meaning that the conditional distribution is a normal distribution with mean    μ   μ   \mu   and precision     λ  T      λ  T    \lambda T   — equivalently, with variance      1  /   (   λ  T   )    .      1    λ  T     1/(\lambda T).     Suppose also that the marginal distribution of T is given by      T  |  α  ,  β  ∼  Gamma   (  α  ,  β  )   ,     fragments  T  normal-|  α  normal-,  β  similar-to  Gamma   fragments  normal-(  α  normal-,  β  normal-)   normal-,    T|\alpha,\beta\sim\mathrm{Gamma}(\alpha,\beta)\!,     where this means that T has a gamma distribution . Here λ, α and β are parameters of the joint distribution.  Then ( X , T ) has a normal-gamma distribution, and this is denoted by        (  X  ,  T  )   ∼   NormalGamma   (  μ  ,  λ  ,  α  ,  β  )     .     similar-to   X  T     NormalGamma   μ  λ  α  β      (X,T)\sim\mathrm{NormalGamma}(\mu,\lambda,\alpha,\beta)\!.     Properties  Probability density function  The joint probability density function of ( X , T ) is      f   (  x  ,  τ  |  μ  ,  λ  ,  α  ,  β  )   =      β  α    λ     Γ   (  α  )     2  π         τ   α  -   1  2        e   -   β  τ       e   -    λ  τ    (   x  -  μ   )   2    2        fragments  f   fragments  normal-(  x  normal-,  τ  normal-|  μ  normal-,  λ  normal-,  α  normal-,  β  normal-)         superscript  β  α     λ      normal-Γ  α      2  π       superscript  τ    α    1  2      superscript  e      β  τ      superscript  e        λ  τ   superscript    x  μ   2    2       f(x,\tau|\mu,\lambda,\alpha,\beta)=\frac{\beta^{\alpha}\sqrt{\lambda}}{\Gamma(%
 \alpha)\sqrt{2\pi}}\,\tau^{\alpha-\frac{1}{2}}\,e^{-\beta\tau}\,e^{-\frac{%
 \lambda\tau(x-\mu)^{2}}{2}}     Marginal distributions  By construction, the marginal distribution over   τ   τ   \tau   is a gamma distribution , and the conditional distribution over   x   x   x   given   τ   τ   \tau   is a Gaussian distribution . The marginal distribution over   x   x   x   is a three-parameter non-standardized Student's t-distribution with parameters     (  ν  ,  μ  ,   σ  2   )   =   (   2  α   ,  μ  ,   β  /   (   λ  α   )    )        ν  μ   superscript  σ  2       2  α   μ    β    λ  α       (\nu,\mu,\sigma^{2})=(2\alpha,\mu,\beta/(\lambda\alpha))   .  Exponential family  The normal-gamma distribution is a four-parameter exponential family with natural parameters      α  -   1  /  2    ,    -  β   -    λ   μ  2    /  2    ,   λ  μ   ,   -   λ  /  2         α    1  2        β       λ   superscript  μ  2    2      λ  μ       λ  2      \alpha-1/2,-\beta-\lambda\mu^{2}/2,\lambda\mu,-\lambda/2   and natural statistics      ln  τ   ,  τ  ,   τ  x   ,   τ   x  2         τ   τ    τ  x     τ   superscript  x  2      \ln\tau,\tau,\tau x,\tau x^{2}   .  Moments of the natural statistics  The following moments can be easily computed using the moment generating function of the sufficient statistic :       E   (   ln  T   )    =    ψ   (  α  )    -   ln  β         normal-E    T        ψ  α     β      \operatorname{E}(\ln T)=\psi\left(\alpha\right)-\ln\beta   , where    ψ   (  α  )       ψ  α    \psi\left(\alpha\right)   is the digamma function ,       E   (  T  )    =   α  β        normal-E  T     α  β     \operatorname{E}(T)=\frac{\alpha}{\beta}   ,       E   (   T  X   )    =   μ   α  β         normal-E    T  X      μ    α  β      \operatorname{E}(TX)=\mu\frac{\alpha}{\beta}   ,       E   (   T   X  2    )    =    1  λ   +    μ  2    α  β          normal-E    T   superscript  X  2         1  λ      superscript  μ  2     α  β       \operatorname{E}(TX^{2})=\frac{1}{\lambda}+\mu^{2}\frac{\alpha}{\beta}   .  Scaling  If      (  X  ,  T  )   ∼   NormalGamma   (  μ  ,  λ  ,  α  ,  β  )     ,     similar-to   X  T     NormalGamma   μ  λ  α  β      (X,T)\sim\mathrm{NormalGamma}(\mu,\lambda,\alpha,\beta),   then for any b > 0, ( bX , bT ) is distributed as     NormalGamma   (   b  μ   ,  λ  ,  α  ,    b  2   β   )    .      NormalGamma     b  μ   λ  α     superscript  b  2   β      {\rm NormalGamma}(b\mu,\lambda,\alpha,b^{2}\beta).     Posterior distribution of the parameters  Assume that x is distributed according to a normal distribution with unknown mean   μ   μ   \mu   and precision   τ   τ   \tau   .      x  ∼   𝒩   (  μ  ,   τ   -  1    )       similar-to  x    𝒩   μ   superscript  τ    1        x\sim\mathcal{N}(\mu,\tau^{-1})   and that the prior distribution on   μ   μ   \mu   and   τ   τ   \tau   ,    (  μ  ,  τ  )     μ  τ    (\mu,\tau)   , has a normal-gamma distribution        (  μ  ,  τ  )   ∼   NormalGamma   (   μ  0   ,   λ  0   ,   α  0   ,   β  0   )     ,     similar-to   μ  τ     NormalGamma    subscript  μ  0    subscript  λ  0    subscript  α  0    subscript  β  0       (\mu,\tau)\sim\text{NormalGamma}(\mu_{0},\lambda_{0},\alpha_{0},\beta_{0}),     for which the density π satisfies        π   (  μ  ,  τ  )    ∝     τ    α  0   -   1  2       exp   [   -    β  0   τ    ]     exp   [   -     λ  0   τ    (   μ  -   μ  0    )   2    2    ]      .     proportional-to    π   μ  τ       superscript  τ     subscript  α  0     1  2            subscript  β  0   τ              subscript  λ  0   τ   superscript    μ   subscript  μ  0    2    2        \pi(\mu,\tau)\propto\tau^{\alpha_{0}-\frac{1}{2}}\,\exp[{-\beta_{0}\tau}]\,%
 \exp[{-\frac{\lambda_{0}\tau(\mu-\mu_{0})^{2}}{2}}].     Given a dataset   𝐗   𝐗   \mathbf{X}   , consisting of   n   n   n    independent and identically distributed random variables (i.i.d),    {   x  1   ,  …  ,   x  n   }      subscript  x  1   normal-…   subscript  x  n     \{x_{1},...,x_{n}\}   , the posterior distribution of   μ   μ   \mu   and   τ   τ   \tau   given this dataset can be analytically determined by Bayes' theorem . Explicitly,      𝐏   (  τ  ,  μ  |  𝐗  )   ∝  𝐋   (  𝐗  |  τ  ,  μ  )   π   (  τ  ,  μ  )      fragments  P   fragments  normal-(  τ  normal-,  μ  normal-|  X  normal-)   proportional-to  L   fragments  normal-(  X  normal-|  τ  normal-,  μ  normal-)   π   fragments  normal-(  τ  normal-,  μ  normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})\propto\mathbf{L}(\mathbf{X}|\tau,\mu)\pi(\tau,\mu)   , where   𝐋   𝐋   \mathbf{L}   is the likelihood of the data given the parameters.  Since the data are i.i.d, the likelihood of the entire dataset is equal to the product of the likelihoods of the individual data samples:      𝐋   (  𝐗  |  τ  ,  μ  )   =   ∏   i  =  1   n   𝐋   (   x  i   |  τ  ,  μ  )   .     fragments  L   fragments  normal-(  X  normal-|  τ  normal-,  μ  normal-)     superscript   subscript  product    i  1    n   L   fragments  normal-(   subscript  x  i   normal-|  τ  normal-,  μ  normal-)   normal-.    \mathbf{L}(\mathbf{X}|\tau,\mu)=\prod_{i=1}^{n}\mathbf{L}(x_{i}|\tau,\mu).     This expression can be simplified as follows:      𝐋   (  𝐗  |  τ  ,  μ  )      fragments  L   fragments  normal-(  X  normal-|  τ  normal-,  μ  normal-)     \displaystyle\mathbf{L}(\mathbf{X}|\tau,\mu)     where     x  ¯   =    1  n     ∑   i  =  1   n    x  i          normal-¯  x       1  n     superscript   subscript     i  1    n    subscript  x  i       \bar{x}=\frac{1}{n}\sum_{i=1}^{n}x_{i}   , the mean of the data samples, and    s  =    1  n     ∑   i  =  1   n     (    x  i   -   x  ¯    )   2         s      1  n     superscript   subscript     i  1    n    superscript     subscript  x  i    normal-¯  x    2       s=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}   , the sample variance.  The posterior distribution of the parameters is proportional to the prior times the likelihood.      𝐏   (  τ  ,  μ  |  𝐗  )      fragments  P   fragments  normal-(  τ  normal-,  μ  normal-|  X  normal-)     \displaystyle\mathbf{P}(\tau,\mu|\mathbf{X})     The final exponential term is simplified by completing the square.        λ  0     (   μ  -   μ  0    )   2    +   n    (    x  ¯   -  μ   )   2           subscript  λ  0    superscript    μ   subscript  μ  0    2      n   superscript     normal-¯  x   μ   2      \displaystyle\lambda_{0}(\mu-\mu_{0})^{2}+n(\bar{x}-\mu)^{2}     On inserting this back into the expression above,      𝐏   (  τ  ,  μ  |  𝐗  )      fragments  P   fragments  normal-(  τ  normal-,  μ  normal-|  X  normal-)     \displaystyle\mathbf{P}(\tau,\mu|\mathbf{X})     This final expression is in exactly the same form as a Normal-Gamma distribution, i.e.,      𝐏   (  τ  ,  μ  |  𝐗  )   =  NormalGamma   (      λ  0    μ  0    +   n   x  ¯       λ  0   +  n    ,   λ  0   +  n  ,   α  0   +   n  2   ,   β  0   +   1  2    (  n  s  +     λ  0   n    (    x  ¯   -   μ  0    )   2      λ  0   +  n    )   )      fragments  P   fragments  normal-(  τ  normal-,  μ  normal-|  X  normal-)    NormalGamma   fragments  normal-(         subscript  λ  0    subscript  μ  0      n   normal-¯  x        subscript  λ  0   n    normal-,   subscript  λ  0    n  normal-,   subscript  α  0      n  2   normal-,   subscript  β  0      1  2    fragments  normal-(  n  s        subscript  λ  0   n   superscript     normal-¯  x    subscript  μ  0    2       subscript  λ  0   n    normal-)   normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}\left(\frac{\lambda_{0}\mu_{%
 0}+n\bar{x}}{\lambda_{0}+n},\lambda_{0}+n,\alpha_{0}+\frac{n}{2},\beta_{0}+%
 \frac{1}{2}\left(ns+\frac{\lambda_{0}n(\bar{x}-\mu_{0})^{2}}{\lambda_{0}+n}%
 \right)\right)     Interpretation of parameters  The interpretation of parameters in terms of pseudo-observations is as follows:   The new mean takes a weighted average of the old pseudo-mean and the observed mean, weighted by the number of associated (pseudo-)observations.  The precision was estimated from    2  α      2  α    2\alpha   pseudo-observations (i.e. possibly a different number of pseudo-observations, to allow the variance of the mean and precision to be controlled separately) with sample mean   μ   μ   \mu   and sample variance    β  α      β  α    \frac{\beta}{\alpha}   (i.e. with sum of squared deviations     2  β      2  β    2\beta   ).  The posterior updates the number of pseudo-observations (    λ  0     subscript  λ  0    \lambda_{0}   ) simply by adding up the corresponding number of new observations (   n   n   n   ).  The new sum of squared deviations is computed by adding the previous respective sums of squared deviations. However, a third "interaction term" is needed because the two sets of squared deviations were computed with respect to different means, and hence the sum of the two underestimates the actual total squared deviation.   As a consequence, if one has a prior mean of    μ  0     subscript  μ  0    \mu_{0}   from    n  μ     subscript  n  μ    n_{\mu}   samples and a prior precision of    τ  0     subscript  τ  0    \tau_{0}   from    n  τ     subscript  n  τ    n_{\tau}   samples, the prior distribution over   μ   μ   \mu   and   τ   τ   \tau   is      𝐏   (  τ  ,  μ  |  𝐗  )   =  NormalGamma   (   μ  0   ,   n  μ   ,    n  τ   2   ,    n  τ    2   τ  0     )      fragments  P   fragments  normal-(  τ  normal-,  μ  normal-|  X  normal-)    NormalGamma   fragments  normal-(   subscript  μ  0   normal-,   subscript  n  μ   normal-,     subscript  n  τ   2   normal-,     subscript  n  τ     2   subscript  τ  0     normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}(\mu_{0},n_{\mu},\frac{n_{%
 \tau}}{2},\frac{n_{\tau}}{2\tau_{0}})     and after observing   n   n   n   samples with mean   μ   μ   \mu   and variance   s   s   s   , the posterior probability is      𝐏   (  τ  ,  μ  |  𝐗  )   =  NormalGamma   (      n  μ    μ  0    +   n  μ      n  μ   +  n    ,   n  μ   +  n  ,   1  2    (   n  τ   +  n  )   ,   1  2    (    n  τ    τ  0    +  n  s  +     n  μ   n    (   μ  -   μ  0    )   2      n  μ   +  n    )   )      fragments  P   fragments  normal-(  τ  normal-,  μ  normal-|  X  normal-)    NormalGamma   fragments  normal-(         subscript  n  μ    subscript  μ  0      n  μ       subscript  n  μ   n    normal-,   subscript  n  μ    n  normal-,    1  2    fragments  normal-(   subscript  n  τ    n  normal-)   normal-,    1  2    fragments  normal-(     subscript  n  τ    subscript  τ  0     n  s        subscript  n  μ   n   superscript    μ   subscript  μ  0    2       subscript  n  μ   n    normal-)   normal-)     \mathbf{P}(\tau,\mu|\mathbf{X})=\text{NormalGamma}\left(\frac{n_{\mu}\mu_{0}+n%
 \mu}{n_{\mu}+n},n_{\mu}+n,\frac{1}{2}(n_{\tau}+n),\frac{1}{2}\left(\frac{n_{%
 \tau}}{\tau_{0}}+ns+\frac{n_{\mu}n(\mu-\mu_{0})^{2}}{n_{\mu}+n}\right)\right)     Note that in some programming languages, such as Matlab , the gamma distribution is implemented with the inverse definition of   β   β   \beta   , so the fourth argument of the Normal-Gamma distribution is     2   τ  0    /   n  τ         2   subscript  τ  0     subscript  n  τ     2\tau_{0}/n_{\tau}   .  Generating normal-gamma random variates  Generation of random variates is straightforward:   Sample   τ   τ   \tau   from a gamma distribution with parameters   α   α   \alpha   and   β   β   \beta     Sample   x   x   x   from a normal distribution with mean   μ   μ   \mu   and variance    1  /   (   λ  τ   )       1    λ  τ     1/(\lambda\tau)      Related distributions   The normal-inverse-gamma distribution is essentially the same distribution parameterized by variance rather than precision  The normal-exponential-gamma distribution   Notes  References   Bernardo, J.M.; Smith, A.F.M. (1993) Bayesian Theory , Wiley. ISBN 0-471-49464-X  Dearden et al. "Bayesian Q-learning" , Proceedings of the Fifteenth National Conference on Artificial Intelligence (AAAI-98) , July 26–30, 1998, Madison, Wisconsin, USA.   "  Category:Multivariate continuous distributions  Category:Conjugate prior distributions  Category:Normal distribution  Category:Probability distributions     Bernardo  &  Smith  (1993,  p.434) ↩   Bernardo & Smith (1993, pages 136, 268, 434) ↩     
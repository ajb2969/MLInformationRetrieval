   Multinomial distribution      Multinomial distribution   (X_i) = n p_i (1-p_i)     Cov   (   X  i   ,   X  j   )   =  -  n   p  i     p  j     (  i  ≠  j  )      fragments  Cov   fragments  normal-(   subscript  X  i   normal-,   subscript  X  j   normal-)     n   subscript  p  i    subscript  p  j    fragments  normal-(  i   j  normal-)     \textstyle{\mathrm{Cov}}(X_{i},X_{j})=-np_{i}p_{j}~{}~{}(i\neq j)   |  skewness   =|  kurtosis   =|  entropy    =|  mgf        =      (    ∑   i  =  1   k     p  i    e   t  i      )   n     superscript    superscript   subscript     i  1    k      subscript  p  i    superscript  e   subscript  t  i      n    \biggl(\sum_{i=1}^{k}p_{i}e^{t_{i}}\biggr)^{n}    |  char       =      (    ∑   j  =  1   k     p  j    e   i   t  j       )   n     superscript    superscript   subscript     j  1    k      subscript  p  j    superscript  e    i   subscript  t  j       n    \left(\sum_{j=1}^{k}p_{j}e^{it_{j}}\right)^{n}    where      i  2   =   -  1        superscript  i  2     1     i^{2}=-1    |  pgf =        (    ∑   i  =  1   k     p  i    z  i     )   n   for   (   z  1   ,  …  ,   z  k   )    ∈   ℂ  k          superscript    superscript   subscript     i  1    k      subscript  p  i    subscript  z  i     n   for    subscript  z  1   normal-…   subscript  z  k      superscript  ℂ  k     \biggl(\sum_{i=1}^{k}p_{i}z_{i}\biggr)^{n}\text{ for }(z_{1},\ldots,z_{k})\in%
 \mathbb{C}^{k}    |  conjugate  = Dirichlet     Dir   (   α  +  β   )       Dir    α  β     \mathrm{Dir}(\alpha+\beta)    |  }} In probability theory , the multinomial distribution is a generalization of the binomial distribution . For n  independent trials each of which leads to a success for exactly one of k categories, with each category having a given fixed success probability, the multinomial distribution gives the probability of any particular combination of numbers of successes for the various categories.  The binomial distribution is the probability distribution of the number of successes for one of just two categories in n independent Bernoulli trials , with the same probability of success on each trial. In a multinomial distribution, the analog of the Bernoulli distribution is the categorical distribution , where each trial results in exactly one of some fixed finite number k possible outcomes, with probabilities p 1 , ..., p k (so that p i ≥ 0 for i = 1, ..., k and      ∑   i  =  1   k    p  i    =  1        superscript   subscript     i  1    k    subscript  p  i    1    \sum_{i=1}^{k}p_{i}=1   ), and there are n independent trials. Then if the random variables X i indicate the number of times outcome number i is observed over the n trials, the vector X = ( X 1 , ..., X k ) follows a multinomial distribution with parameters n and p , where p = ( p 1 , ..., p k ). Note that while the trials are independent, their outcomes X are dependent because they must be summed to n.  Note that, in some fields, such as natural language processing , the categorical and multinomial distributions are conflated , and it is common to speak of a "multinomial distribution" when a categorical distribution is actually meant. This stems from the fact that it is sometimes convenient to express the outcome of a categorical distribution as a "1-of-K" vector (a vector with one element containing a 1 and all other elements containing a 0) rather than as an integer in the range    1  …  K      1  normal-…  K    1\dots K   ; in this form, a categorical distribution is equivalent to a multinomial distribution over a single trial.  Specification  Probability mass function  Suppose one does an experiment of extracting n balls of k different colours from a bag, replacing the extracted ball after each draw. Balls from the same colour are equivalent. Denote the variable which is the number of extracted balls of colour i ( i = 1, ..., k ) as X i , and denote as p i the probability that a given extraction will be in colour i . The probability mass function of this multinomial distribution is:      f   (   x  1   ,  …  ,   x  k   ;  n  ,   p  1   ,  …  ,   p  k   )       f    subscript  x  1   normal-…   subscript  x  k   n   subscript  p  1   normal-…   subscript  p  k      \displaystyle f(x_{1},\ldots,x_{k};n,p_{1},\ldots,p_{k})     for non-negative integers x 1 , ..., x k .  The probability mass function can be expressed using the gamma function as:        f   (   x  1   ,  …  ,   x  k   ;   p  1   ,  …  ,   p  k   )    =     Γ   (     ∑  i    x  i    +  1   )      ∏  i    Γ   (    x  i   +  1   )        ∏   i  =  1   k    p  i   x  i       .        f    subscript  x  1   normal-…   subscript  x  k    subscript  p  1   normal-…   subscript  p  k           normal-Γ      subscript   i    subscript  x  i    1      subscript  product  i     normal-Γ     subscript  x  i   1        superscript   subscript  product    i  1    k    superscript   subscript  p  i    subscript  x  i        f(x_{1},\dots,x_{k};p_{1},\ldots,p_{k})=\frac{\Gamma(\sum_{i}x_{i}+1)}{\prod_{%
 i}\Gamma(x_{i}+1)}\prod_{i=1}^{k}p_{i}^{x_{i}}.     This form shows its resemblance to the Dirichlet distribution which is its conjugate prior .  Visualization  As slices of generalized Pascal's triangle  Just like one can interpret the binomial distribution as (normalized) 1D slices of Pascal's triangle , so too can one interpret the multinomial distribution as 2D (triangular) slices of Pascal's pyramid , or 3D/4D/+ (pyramid-shaped) slices of higher-dimensional analogs of Pascal's triangle. This reveals an interpretation of the range of the distribution: discretized equilaterial "pyramids" in arbitrary dimension—i.e. a simplex with a grid.  As polynomial coefficients  Similarly, just like one can interpret the binomial distribution as the polynomial coefficients of     (    p   x  1    +    (   1  -  p   )    x  2     )   n     superscript      p   subscript  x  1        1  p    subscript  x  2     n    (px_{1}+(1-p)x_{2})^{n}   when expanded, one can interpret the multinomial distribution as the coefficients of     (     p  1    x  1    +    p  2    x  2    +    p  3    x  3    +  …  +    p  k    x  k     )   n     superscript       subscript  p  1    subscript  x  1       subscript  p  2    subscript  x  2       subscript  p  3    subscript  x  3    normal-…     subscript  p  k    subscript  x  k     n    (p_{1}x_{1}+p_{2}x_{2}+p_{3}x_{3}+...+p_{k}x_{k})^{n}   when expanded. (Note that just like the binomial distribution, the coefficients must sum to 1.) This is the origin of the name " multinomial distribution".  Properties  The expected number of times the outcome i was observed over n trials is        E   (   X  i   )    =   n   p  i     .       normal-E   subscript  X  i      n   subscript  p  i      \operatorname{E}(X_{i})=np_{i}.\,     The covariance matrix is as follows. Each diagonal entry is the variance of a binomially distributed random variable, and is therefore        var   (   X  i   )    =   n   p  i    (   1  -   p  i    )     .       var   subscript  X  i      n   subscript  p  i     1   subscript  p  i       \operatorname{var}(X_{i})=np_{i}(1-p_{i}).\,     The off-diagonal entries are the covariances :       cov   (   X  i   ,   X  j   )    =   -   n   p  i     p  j           cov   subscript  X  i    subscript  X  j        n   subscript  p  i    subscript  p  j       \operatorname{cov}(X_{i},X_{j})=-np_{i}p_{j}\,     for i , j distinct.  All covariances are negative because for fixed n , an increase in one component of a multinomial vector requires a decrease in another component.  This is a k × k  positive-semidefinite matrix of rank k − 1. In the special case where k = n and where the p i are all equal, the covariance matrix is the centering matrix .  The entries of the corresponding correlation matrix are       ρ   (   X  i   ,   X  i   )    =  1.        ρ    subscript  X  i    subscript  X  i     1.    \rho(X_{i},X_{i})=1.           ρ   (   X  i   ,   X  j   )    =    cov   (   X  i   ,   X  j   )       var   (   X  i   )     var   (   X  j   )       =    -    p  i    p  j        p  i    (   1  -   p  i    )    p  j    (   1  -   p  j    )      =   -      p  i    p  j      (   1  -   p  i    )    (   1  -   p  j    )        .          ρ    subscript  X  i    subscript  X  j        cov   subscript  X  i    subscript  X  j         var   subscript  X  i     var   subscript  X  j                   subscript  p  i    subscript  p  j          subscript  p  i     1   subscript  p  i     subscript  p  j     1   subscript  p  j                     subscript  p  i    subscript  p  j        1   subscript  p  i      1   subscript  p  j           \rho(X_{i},X_{j})=\frac{\operatorname{cov}(X_{i},X_{j})}{\sqrt{\operatorname{%
 var}(X_{i})\operatorname{var}(X_{j})}}=\frac{-p_{i}p_{j}}{\sqrt{p_{i}(1-p_{i})%
 p_{j}(1-p_{j})}}=-\sqrt{\frac{p_{i}p_{j}}{(1-p_{i})(1-p_{j})}}.     Note that the sample size drops out of this expression.  Each of the k components separately has a binomial distribution with parameters n and p i , for the appropriate value of the subscript i .  The support of the multinomial distribution is the set       {    (   n  1   ,  …  ,   n  k   )   ∈   ℕ  k    |     n  1   +  ⋯  +   n  k    =  n   }   .     conditional-set      subscript  n  1   normal-…   subscript  n  k     superscript  ℕ  k         subscript  n  1   normal-⋯   subscript  n  k    n     \{(n_{1},\dots,n_{k})\in\mathbb{N}^{k}|n_{1}+\cdots+n_{k}=n\}.\,     Its number of elements is       (       n  +  k   -  1        k  -  1      )   .     binomial      n  k   1     k  1     {n+k-1\choose k-1}.     Example  In a recent three-way election for a large country, candidate A received 20% of the votes, candidate B received 30% of the votes, and candidate C received 50% of the votes. If six voters are selected randomly, what is the probability that there will be exactly one supporter for candidate A, two supporters for candidate B and three supporters for candidate C in the sample?  Note: Since we’re assuming that the voting population is large, it is reasonable and permissible to think of the probabilities as unchanging once a voter is selected for the sample. Technically speaking this is sampling without replacement, so the correct distribution is the multivariate hypergeometric distribution , but the distributions converge as the population grows large.       Pr   (   A  =  1   ,   B  =  2   ,   C  =  3   )    =     6  !     1  !    2  !    3  !      (   0.2  1   )    (   0.3  2   )    (   0.5  3   )    =  0.135         Pr    A  1     B  2     C  3          6       1     2     3      superscript  0.2  1    superscript  0.3  2    superscript  0.5  3         0.135     \Pr(A=1,B=2,C=3)=\frac{6!}{1!2!3!}(0.2^{1})(0.3^{2})(0.5^{3})=0.135     Sampling from a multinomial distribution  First, reorder the parameters     p  1   ,  …  ,   p  k       subscript  p  1   normal-…   subscript  p  k     p_{1},\ldots,p_{k}   such that they are sorted in descending order (this is only to speed up computation and not strictly necessary). Now, for each trial, draw an auxiliary variable X from a uniform (0, 1) distribution. The resulting outcome is the component       j  =   min   {     j  ′   ∈   {  1  ,  …  ,  k  }    :     (    ∑   i  =  1    j  ′     p  i    )   -  X   ≥  0    }     .      j     normal-:     superscript  j  normal-′    1  normal-…  k          superscript   subscript     i  1     superscript  j  normal-′     subscript  p  i    X   0       j=\min\left\{j^{\prime}\in\{1,\dots,k\}:(\sum_{i=1}^{j^{\prime}}p_{i})-X\geq 0%
 \right\}.     { X j = 1, X k = 0 for k ≠ j } is one observation from the multinomial distribution with     p  1   ,  …  ,   p  k       subscript  p  1   normal-…   subscript  p  k     p_{1},\ldots,p_{k}   and n = 1. A sum of independent repetitions of this experiment is an observation from a multinomial distribution with n equal to the number of such repetitions.  To simulate a multinomial distribution  Various methods may be used to simulate a multinomial distribution. A very simple one is to use a random number generator to generate numbers between 0 and 1. First, we divide the interval from 0 to 1 in k subintervals equal in size to the probabilities of the k categories. Then, we generate a random number for each of n trials and use a logical test to classify the virtual measure or observation in one of the categories.  Example  If we have :      Categories   1   2   3   4   5   6     Probabilities   0.15   0.20   0.30   0.16   0.12   0.07     Superior limits of subintervals   0.15   0.35   0.65   0.81   0.93   1.00     Then, with a software like Excel, we may use the following recipe:      Cells :   Ai   Bi   Ci   ...   Gi     Formulae :   Rand()   =If($Ai<0.15;1;0)   =If(And($Ai>=0.15;$Ai<0.35);1;0)   ...  If($Ai>  0.93;1;0)     After that, we will use functions such as SumIf to accumulate the observed results by category and to calculate the estimated covariance matrix for each simulated sample.  Another way is to use a discrete random number generator. In that case, the categories must be labeled or relabeled with numeric values.  In the two cases, the result is a multinomial distribution with k categories without any correlation. This is equivalent, with a continuous random distribution, to simulate k independent standardized normal distributions, or a multinormal distribution N(0,I) having k components identically distributed and statistically independent.  Related distributions   When k = 2, the multinomial distribution is the binomial distribution .  Categorical distribution , the distribution of each trial; for k = 2, this is the Bernoulli distribution .  The Dirichlet distribution is the conjugate prior of the multinomial in Bayesian statistics .  Dirichlet-multinomial distribution .  Beta-binomial model .  Negative multinomial distribution  Hardy–Weinberg principle (it is a trinomial distribution with probabilities    (   θ  2   ,   2  θ   (   1  -  θ   )    ,    (   1  -  θ   )   2   )      superscript  θ  2     2  θ    1  θ     superscript    1  θ   2     (\theta^{2},2\theta(1-\theta),(1-\theta)^{2})   )   References     "  Category:Discrete distributions  Category:Multivariate discrete distributions  Category:Factorial and binomial topics  Category:Exponential family distributions  Category:Probability distributions   
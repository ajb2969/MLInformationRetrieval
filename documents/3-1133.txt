   Pseudo-spectral method      Pseudo-spectral method   Pseudo-spectral methods , 1 also known as discrete variable representation (DVR) methods, are a class of numerical methods used in applied mathematics and scientific computing for the solution of partial differential equations . They are closely related to spectral methods , but complement the basis by an additional pseudo-spectral basis, which allows to represent functions on a quadrature grid. This simplifies the evaluation of certain operators, and can considerably speed up the calculation when using fast algorithms such as the fast Fourier transform .  Motivation with a concrete example  Take the initial-value problem        i   ∂   ∂  t    ψ   (  x  ,  t  )    =    [    -    ∂  2    ∂   x  2      +   V   (  x  )     ]   ψ   (  x  ,  t  )     ,    ψ   (   t  0   )    =   ψ  0       formulae-sequence      i       t    ψ   x  t       delimited-[]         superscript   2      superscript  x  2        V  x     ψ   x  t         ψ   subscript  t  0     subscript  ψ  0      i\frac{\partial}{\partial t}\psi(x,t)=\Bigl[-\frac{\partial^{2}}{\partial x^{2%
 }}+V(x)\Bigr]\psi(x,t),\qquad\qquad\psi(t_{0})=\psi_{0}     with periodic conditions     ψ   (   x  +   2  π    ,  t  )    =   ψ   (  x  ,  t  )          ψ     x    2  π    t      ψ   x  t      \psi(x+2\pi,t)=\psi(x,t)   . This specific example is the Schrödinger equation for a particle in a potential    V   (  x  )       V  x    V(x)   , but the structure is more general. In many practical partial differential equations, one has a term that involves derivatives (such as a kinetic energy contributions), and a multiplication with a function (for example, a potential).  In the spectral method, the solution   ψ   ψ   \psi   is expanded in a suitable set of basis functions, for example plane waves,        ψ   (  x  ,  t  )    =    1    2  π       ∑  n     c  n    (  t  )    e   2  π  i  n  x        .        ψ   x  t        1      2  π       subscript   n      subscript  c  n   t   superscript  e    2  π  i  n  x         \psi(x,t)=\frac{1}{\sqrt{2\pi}}\sum_{n}c_{n}(t)e^{2\pi inx}.     Insertion and equating identical coefficients yields a set of ordinary differential equations for the coefficients,        i   d   d  t     c  n    (  t  )    =      (   2  π  n   )   2    c  n    +    ∑  k     V   n  k     c  k       ,        i    d    d  t     subscript  c  n   t        superscript    2  π  n   2    subscript  c  n      subscript   k      subscript  V    n  k     subscript  c  k        i\frac{d}{dt}c_{n}(t)=(2\pi n)^{2}c_{n}+\sum_{k}V_{nk}c_{k},     where the elements    V   n  k      subscript  V    n  k     V_{nk}   are calculated through the explicit Fourier-transform        V   n  k    =    1   2  π      ∫  0   2  π     V   (  x  )    e   2  π  i   (   k  -  n   )   x    d  x      .       subscript  V    n  k        1    2  π      superscript   subscript   0     2  π      V  x   superscript  e    2  π  i    k  n   x    d  x       V_{nk}=\frac{1}{2\pi}\int_{0}^{2\pi}V(x)\ e^{2\pi i(k-n)x}dx.     The solution would then be obtained by truncating the expansion to   N   N   N   basis functions, and finding a solution for the     c  n    (  t  )        subscript  c  n   t    c_{n}(t)   . In general, this is done by numerical methods , such as Runge–Kutta methods . For the numerical solutions, the right-hand side of the ordinary differential equation has to be evaluated repeatedly at different time steps. At this point, the spectral method has a major problem with the potential term    V   (  x  )       V  x    V(x)   .  In the spectral representation, the multiplication with the function    V   (  x  )       V  x    V(x)   transforms into a vector-matrix multiplication, which scales as    N  2     superscript  N  2    N^{2}   . Also, the matrix elements    V   n  k      subscript  V    n  k     V_{nk}   need to be evaluated explicitly before the differential equation for the coefficients can be solved, which requires an additional step.  In the pseudo-spectral method, this term is evaluated differently. Given the coefficients     c  n    (  t  )        subscript  c  n   t    c_{n}(t)   , an inverse discrete Fourier transform yields the value of the function   ψ   ψ   \psi   at discrete grid points     x  j   =    2  π  j   /  N        subscript  x  j       2  π  j   N     x_{j}=2\pi j/N   . At these grid points, the function is then multiplied,      ψ  ′    (   x  i   ,  t  )    =   V   (   x  i   )   ψ   (   x  i   ,  t  )           superscript  ψ  normal-′     subscript  x  i   t      V   subscript  x  i   ψ    subscript  x  i   t      \psi^{\prime}(x_{i},t)=V(x_{i})\psi(x_{i},t)   , and the result Fourier-transformed back. This yields a new set of coefficients     c  n  ′    (  t  )        subscript   superscript  c  normal-′   n   t    c^{\prime}_{n}(t)   that are used instead of the matrix product     ∑  k     V   n  k     c  k    (  t  )        subscript   k      subscript  V    n  k     subscript  c  k   t     \sum_{k}V_{nk}c_{k}(t)   .  It can be shown that both methods have similar accuracy. However, the pseudo-spectral method allows the use of a fast Fourier transform, which scales as    O   (   N   ln  N    )       O    N    N      O(N\ln N)   , and is therefore significantly more efficient than the matrix multiplication. Also, the function    V   (  x  )       V  x    V(x)   can be used directly without evaluating any additional integrals.  Technical discussion  In a more abstract way, the pseudo-spectral method deals with the multiplication of two functions    V   (  x  )       V  x    V(x)   and    f   (  x  )       f  x    f(x)   as part of a partial differential equation. To simplify the notation, the time-dependence is dropped. Conceptually, it consists of three steps:         f   (  x  )    ,    f  ~    (  x  )     =   V   (  x  )   f   (  x  )           f  x      normal-~  f   x      V  x  f  x     f(x),\tilde{f}(x)=V(x)f(x)   are expanded in a finite set of basis functions (this is the spectral method ).  For a given set of basis functions, a quadrature is sought that converts scalar products of these basis functions into a weighted sum over grid points.  The product is calculated by multiplying    V  ,  f     V  f    V,f   at each grid point.   Expansion in a basis  The functions    f  ,   f  ~      f   normal-~  f     f,\tilde{f}   can be expanded in a finite basis     {   ϕ  n   }    n  =   0  ,  …  ,  N       subscript    subscript  ϕ  n      n   0  normal-…  N      \{\phi_{n}\}_{n=0,\ldots,N}   as       f   (  x  )    =    ∑   n  =  0   N     c  n    ϕ  n    (  x  )           f  x     superscript   subscript     n  0    N      subscript  c  n    subscript  ϕ  n   x      f(x)=\sum_{n=0}^{N}c_{n}\phi_{n}(x)           f  ~    (  x  )    =    ∑   n  =  0   N      c  ~   n    ϕ  n    (  x  )            normal-~  f   x     superscript   subscript     n  0    N      subscript   normal-~  c   n    subscript  ϕ  n   x      \tilde{f}(x)=\sum_{n=0}^{N}\tilde{c}_{n}\phi_{n}(x)     For simplicity, let the basis be orthogonal and normalized,     ⟨   ϕ  n   ,   ϕ  m   ⟩   =   δ   n  m          subscript  ϕ  n    subscript  ϕ  m     subscript  δ    n  m      \langle\phi_{n},\phi_{m}\rangle=\delta_{nm}   using the inner product      ⟨  f  ,  g  ⟩   =    ∫  a  b    f   (  x  )     g   (  x  )    ¯   d  x         f  g     superscript   subscript   a   b     f  x   normal-¯    g  x    d  x      \langle f,g\rangle=\int_{a}^{b}f(x)\overline{g(x)}dx   with appropriate boundaries    a  ,  b     a  b    a,b   . The coefficients are then obtained by       c  n   =   ⟨  f  ,   ϕ  n   ⟩        subscript  c  n    f   subscript  ϕ  n      c_{n}=\langle f,\phi_{n}\rangle           c  ~   n   =   ⟨   f  ~   ,   ϕ  n   ⟩        subscript   normal-~  c   n     normal-~  f    subscript  ϕ  n      \tilde{c}_{n}=\langle\tilde{f},\phi_{n}\rangle     A bit of calculus yields then        c  ~   n   =    ∑   m  =  0   N     V   n  m     c  m          subscript   normal-~  c   n     superscript   subscript     m  0    N      subscript  V    n  m     subscript  c  m       \tilde{c}_{n}=\sum_{m=0}^{N}V_{nm}c_{m}     with     V   n  m    =   ⟨   V   ϕ  m    ,   ϕ  n   ⟩        subscript  V    n  m       V   subscript  ϕ  m     subscript  ϕ  n      V_{nm}=\langle V\phi_{m},\phi_{n}\rangle   . This forms the basis of the spectral method. To distinguish the basis of the    ϕ  n     subscript  ϕ  n    \phi_{n}   from the quadrature basis, the expansion is sometimes called Finite Basis Representation (FBR).  Quadrature  For a given basis    {   ϕ  n   }      subscript  ϕ  n     \{\phi_{n}\}   and number of    N  +  1      N  1    N+1   basis functions, one can try to find a quadrature, i.e., a set of    N  +  1      N  1    N+1   points and weights such that        ⟨   ϕ  n   ,   ϕ  m   ⟩   =     ∑   i  =  0   N     w  i    ϕ  n    (   x  i   )      ϕ  m    (   x  i   )    ¯     n    ,   m  =   0  ,  …  ,  N       formulae-sequence      subscript  ϕ  n    subscript  ϕ  m       superscript   subscript     i  0    N      subscript  w  i    subscript  ϕ  n    subscript  x  i    normal-¯     subscript  ϕ  m    subscript  x  i       n      m   0  normal-…  N      \langle\phi_{n},\phi_{m}\rangle=\sum_{i=0}^{N}w_{i}\phi_{n}(x_{i})\overline{%
 \phi_{m}(x_{i})}\qquad\qquad n,m=0,\ldots,N     Special examples are the Gaussian quadrature for polynomials and the Discrete Fourier Transform for plane waves. It should be stressed that the grid points and weights,     x  i   ,   w  i       subscript  x  i    subscript  w  i     x_{i},w_{i}   are a function of the basis and the number   N   N   N   .  The quadrature allows an alternative numerical representation of the function     f   (  x  )    ,    f  ~    (  x  )         f  x      normal-~  f   x     f(x),\tilde{f}(x)   through their value at the grid points. This representation is sometimes denoted Discrete Variable Representation (DVR), and is completely equivalent to the expansion in the basis.       f   (   x  i   )    =    ∑   n  =  0   N     c  n    ϕ  n    (   x  i   )           f   subscript  x  i      superscript   subscript     n  0    N      subscript  c  n    subscript  ϕ  n    subscript  x  i       f(x_{i})=\sum_{n=0}^{N}c_{n}\phi_{n}(x_{i})          c  n   =   ⟨  f  ,   ϕ  n   ⟩   =    ∑   n  =  0   N     w  i   f   (   x  i   )      ϕ  n    (   x  i   )    ¯            subscript  c  n    f   subscript  ϕ  n           superscript   subscript     n  0    N      subscript  w  i   f   subscript  x  i    normal-¯     subscript  ϕ  n    subscript  x  i          c_{n}=\langle f,\phi_{n}\rangle=\sum_{n=0}^{N}w_{i}f(x_{i})\overline{\phi_{n}(%
 x_{i})}     Multiplication  The multiplication with the function    V   (  x  )       V  x    V(x)   is then done at each grid point,         f  ~    (   x  i   )    =   V   (   x  i   )   f   (   x  i   )     .         normal-~  f    subscript  x  i      V   subscript  x  i   f   subscript  x  i      \tilde{f}(x_{i})=V(x_{i})f(x_{i}).     This generally introduces an additional approximation. To see this, we can calculate one of the coefficients     c  ~   n     subscript   normal-~  c   n    \tilde{c}_{n}   :        c  ~   n   =   ⟨   f  ~   ,   ϕ  n   ⟩   =    ∑  i     w  i    f  ~    (   x  i   )      ϕ  n    (   x  i   )    ¯     =    ∑  i     w  i   V   (   x  i   )   f   (   x  i   )      ϕ  n    (   x  i   )    ¯            subscript   normal-~  c   n     normal-~  f    subscript  ϕ  n           subscript   i      subscript  w  i    normal-~  f    subscript  x  i    normal-¯     subscript  ϕ  n    subscript  x  i              subscript   i      subscript  w  i   V   subscript  x  i   f   subscript  x  i    normal-¯     subscript  ϕ  n    subscript  x  i          \tilde{c}_{n}=\langle\tilde{f},\phi_{n}\rangle=\sum_{i}w_{i}\tilde{f}(x_{i})%
 \overline{\phi_{n}(x_{i})}=\sum_{i}w_{i}V(x_{i})f(x_{i})\overline{\phi_{n}(x_{%
 i})}     However, using the spectral method, the same coefficient would be      c  ~   n   =   ⟨   V  f   ,   ϕ  n   ⟩        subscript   normal-~  c   n      V  f    subscript  ϕ  n      \tilde{c}_{n}=\langle Vf,\phi_{n}\rangle   . The pseudo-spectral method thus introduces the additional approximation        ⟨   V  f   ,   ϕ  n   ⟩   ≈    ∑  i     w  i   V   (   x  i   )   f   (   x  i   )      ϕ  n    (   x  i   )    ¯      .         V  f    subscript  ϕ  n      subscript   i      subscript  w  i   V   subscript  x  i   f   subscript  x  i    normal-¯     subscript  ϕ  n    subscript  x  i         \langle Vf,\phi_{n}\rangle\approx\sum_{i}w_{i}V(x_{i})f(x_{i})\overline{\phi_{%
 n}(x_{i})}.     If the product    V  f      V  f    Vf   can be represented with the given finite set of basis functions, the above equation is exact due to the chosen quadrature.  Special pseudospectral schemes  The Fourier method  If periodic boundary conditions with period    [  0  ,  L  ]     0  L    [0,L]   are imposed on the system, the basis functions can be generated by plane waves,        ϕ  n    (  x  )    =    1   L     e   -   ı   k  n   x             subscript  ϕ  n   x       1    L     superscript  e      ı   subscript  k  n   x        \phi_{n}(x)=\frac{1}{\sqrt{L}}e^{-\imath k_{n}x}     with     k  n   =      (   -  1   )   n    ⌈   n  /  2   ⌉   2  π   /  L        subscript  k  n        superscript    1   n       n  2    2  π   L     k_{n}=(-1)^{n}\lceil n/2\rceil 2\pi/L   , where    ⌈  ⌉      \lceil\rceil   is the ceiling function .  The quadrature for a cut-off at     n  max   =  N       subscript  n  max   N    n_{\text{max}}=N   is given by the discrete Fourier transformation . The grid points are equally spaced,     x  i   =   i  Δ  x        subscript  x  i     i  normal-Δ  x     x_{i}=i\Delta x   with spacing     Δ  x   =   L  /   (   N  +  1   )          normal-Δ  x     L    N  1      \Delta x=L/(N+1)   , and the constant weights are     w  i   =   Δ  x        subscript  w  i     normal-Δ  x     w_{i}=\Delta x   .  For the discussion of the error, note that the product of two plane waves is again a plane wave,      ϕ  a   +   ϕ  b    =   ϕ  c          subscript  ϕ  a    subscript  ϕ  b     subscript  ϕ  c     \phi_{a}+\phi_{b}=\phi_{c}   with    c  ≤   a  +  b       c    a  b     c\leq a+b   . Thus, qualitatively, if the functions     f   (  x  )    ,   V   (  x  )         f  x     V  x     f(x),V(x)   can be represented sufficiently accurately with     N  f   ,   N  V       subscript  N  f    subscript  N  V     N_{f},N_{V}   basis functions, the pseudo-spectral method gives accurate results if     N  f   +   N  V        subscript  N  f    subscript  N  V     N_{f}+N_{V}   basis functions are used.  An expansion in plane waves often has a poor quality and needs many basis functions to converge. However, the transformation between the basis expansion and the grid representation can be done using a Fast Fourier transform , which scales favorably as    N   ln  N       N    N     N\ln N   . As a consequence, plane waves are one of the most common expansion that is encountered with pseudo-spectral methods.  Polynomials  Another common expansion is into classical polynomials. Here, the Gaussian quadrature is used, which states that one can always find weights    w  i     subscript  w  i    w_{i}   and points    x  i     subscript  x  i    x_{i}   such that        ∫  a  b    w   (  x  )   p   (  x  )   d  x    =    ∑   i  =  0   N     w  i   p   (   x  i   )           superscript   subscript   a   b     w  x  p  x  d  x      superscript   subscript     i  0    N      subscript  w  i   p   subscript  x  i       \int_{a}^{b}w(x)p(x)dx=\sum_{i=0}^{N}w_{i}p(x_{i})     holds for any polynomial    p   (  x  )       p  x    p(x)   of degree     2  N   +  1        2  N   1    2N+1   or less. Typically, the weight function    w   (  x  )       w  x    w(x)   and ranges    a  ,  b     a  b    a,b   are chosen for a specific problem, and leads to one of the different forms of the quadrature. To apply this to the pseudo-spectral method, we choose basis functions      ϕ  n    (  x  )    =     w   (  x  )      P  n    (  x  )           subscript  ϕ  n   x         w  x     subscript  P  n   x     \phi_{n}(x)=\sqrt{w(x)}P_{n}(x)   , with    P  n     subscript  P  n    P_{n}   being a polynomial of degree   n   n   n   with the property         ∫  a  b    w   (  x  )    P  n    (  x  )    P  m    (  x  )   d  x    =   δ   m  n     .        superscript   subscript   a   b     w  x   subscript  P  n   x   subscript  P  m   x  d  x     subscript  δ    m  n      \int_{a}^{b}w(x)P_{n}(x)P_{m}(x)dx=\delta_{mn}.     Under these conditions, the    ϕ  n     subscript  ϕ  n    \phi_{n}   form an orthonormal basis with respect to the scalar product     ⟨  f  ,  g  ⟩   =    ∫  a  b    f   (  x  )     g   (  x  )    ¯   d  x         f  g     superscript   subscript   a   b     f  x   normal-¯    g  x    d  x      \langle f,g\rangle=\int_{a}^{b}f(x)\overline{g(x)}dx   . This basis, together with the quadrature points can then be used for the pseudo-spectral method.  For the discussion of the error, note that if   f   f   f   is well represented by    N  f     subscript  N  f    N_{f}   basis functions and   V   V   V   is well represented by a polynomial of degree    N  V     subscript  N  V    N_{V}   , their product can be expanded in the first     N  f   +   N  V        subscript  N  f    subscript  N  V     N_{f}+N_{V}   basis functions, and the pseudo-spectral method will give accurate results for that many basis functions.  Such polynomials occur naturally in several standard problems. For example, the quantum harmonic oscillator is ideally expanded in Hermite polynomials, and Jacobi-polynomials can be used to define the associated Legendre functions typically appearing in rotational problems.  References   Steven A. Orszag (1969) Numerical Methods for the Simulation of Turbulence , Phys. Fluids Supp. II, 12, 250-257  D. Gottlieb and S. Orzag (1977) "Numerical Analysis of Spectral Methods : Theory and Applications", SIAM, Philadelphia, PA  J. Hesthaven, S. Gottlieb and D. Gottlieb (2007) "Spectral methods for time-dependent problems", Cambridge UP, Cambridge, UK  Lloyd N. Trefethen (2000) Spectral Methods in MATLAB. SIAM, Philadelphia, PA  Bengt Fornberg (1996) A Practical Guide to Pseudospectral Methods. Cambridge University Press, Cambridge, UK  Chebyshev and Fourier Spectral Methods by John P. Boyd.  Polynomial Approximation of Differential Equations , by Daniele Funaro, Lecture Notes in Physics, Volume 8, Springer-Verlag, Heidelberg 1992  Javier de Frutos, Julia Novo: A Spectral Element Method for the Navier--Stokes Equations with Improved Accuracy  Canuto C., Hussaini M. Y. , Quarteroni A., and Zang T.A. (2006) Spectral Methods. Fundamentals in Single Domains. Springer-Verlag, Berlin Heidelberg    "  Category:Numerical analysis     ↩     
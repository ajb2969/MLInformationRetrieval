<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="321">Lucas primality test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lucas primality test</h1>
<hr/>

<p>In <a href="computational_number_theory" title="wikilink">computational number theory</a>, the <strong>Lucas test</strong> is a <a href="primality_test" title="wikilink">primality test</a> for a natural number <em>n</em>; it requires that the <a href="prime_number#Prime_divisors" title="wikilink">prime factors</a> of <em>n</em> − 1 be already known.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> It is the basis of the <a href="Pratt_certificate" title="wikilink">Pratt certificate</a> that gives a concise verification that <em>n</em> is prime.</p>
<h2 id="concepts">Concepts</h2>

<p>Let <em>n</em> be a positive integer. If there exists an integer 1 a^{n-1}\ \equiv\ 1 \pmod n \, </p>

<p>and for every prime factor <em>q</em> of <em>n</em> − 1</p>

<p>

<math display="block" id="Lucas_primality_test:0">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <msup>
     <mi>a</mi>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>/</mo>
      <mi>q</mi>
     </mrow>
    </msup>
   </mpadded>
   <mo>≢</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mpadded width="+1.7pt">
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">not-equivalent-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="float">1</cn>
     <apply>
      <ci>pmod</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{({n-1})/q}\ \not\equiv\ 1\;\;(\mathop{{\rm mod}}n)\,
  </annotation>
 </semantics>
</math>

</p>

<p>then <em>n</em> is prime. If no such number <em>a</em> exists, then <em>n</em> is either 1 or <a href="composite_number" title="wikilink">composite</a>.</p>

<p>The reason for the correctness of this claim is as follows: if the first equivalence holds for <em>a</em>, we can deduce that <em>a</em> and <em>n</em> are <a href="coprime#Properties" title="wikilink">coprime</a>. If <em>a</em> also survives the second step, then the <a href="Order_(group_theory)" title="wikilink">order</a> of <em>a</em> in the <a href="Group_(mathematics)" title="wikilink">group</a> (<strong>Z</strong>/<em>n<strong><em>Z<strong>)* is equal to ''n''−1, which means that the order of that group is ''n''−1 (because the order of every element of a group divides the order of the group), implying that ''n'' is <a href="Prime_number" title="wikilink">prime</a>. Conversely, if ''n'' is prime, then there exists a <a href="primitive_root_modulo_n" title="wikilink">primitive root modulo ''n''</a>, or <a href="generating_set_of_a_group" title="wikilink">generator</a> of the group (</strong>Z<strong>/''n</strong></em>Z</strong>)*. Such a generator has order |(<strong>Z</strong>/</em>n<em><strong>Z</strong>)*| = </em>n''−1 and both equivalences will hold for any such primitive root.</p>

<p>Note that if there exists an <em>a</em> 17^{70}\ \equiv\ 1 \pmod {71}.</p>

<p>For all integers <em>a</em> it is known that</p>

<p>

<math display="block" id="Lucas_primality_test:1">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>≡</mo>
   <mn>1</mn>
   <mpadded width="+5pt">
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mpadded>
   <mtext>if and only if  ord</mtext>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>a</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo>-</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <equivalent></equivalent>
    <cn type="integer">1</cn>
    <apply>
     <ci>pmod</ci>
     <ci>n</ci>
    </apply>
    <mtext>if and only if  ord</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">a</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">n</csymbol>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{n-1}\equiv 1\;\;(\mathop{{\rm mod}}n)\ \text{ if and only if }\text{ ord}(a%
)|(n-1).
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore, the multiplicative order of 17 (mod 71) is not necessarily 70 because some factor of 70 may also work above. So check 70 divided by its prime factors:</p>

<p>

<math display="block" id="Lucas_primality_test:2">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <msup>
     <mn>17</mn>
     <mn>35</mn>
    </msup>
   </mpadded>
   <mo>≡</mo>
   <mpadded width="+5pt">
    <mn>70</mn>
   </mpadded>
   <mo>≢</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>71</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">17</cn>
      <cn type="integer">35</cn>
     </apply>
     <cn type="float">70</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">not-equivalent-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">71</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   17^{35}\ \equiv\ 70\ \not\equiv\ 1\;\;(\mathop{{\rm mod}}71)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Lucas_primality_test:3">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <msup>
     <mn>17</mn>
     <mn>14</mn>
    </msup>
   </mpadded>
   <mo>≡</mo>
   <mpadded width="+5pt">
    <mn>25</mn>
   </mpadded>
   <mo>≢</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>71</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">17</cn>
      <cn type="integer">14</cn>
     </apply>
     <cn type="float">25</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">not-equivalent-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">71</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   17^{14}\ \equiv\ 25\ \not\equiv\ 1\;\;(\mathop{{\rm mod}}71)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Lucas_primality_test:4">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <msup>
      <mn>17</mn>
      <mn>10</mn>
     </msup>
    </mpadded>
    <mo>≡</mo>
    <mpadded width="+5pt">
     <mn>1</mn>
    </mpadded>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>71</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">17</cn>
      <cn type="integer">10</cn>
     </apply>
     <cn type="float">1</cn>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">71</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   17^{10}\ \equiv\ 1\ \equiv\ 1\;\;(\mathop{{\rm mod}}71).
  </annotation>
 </semantics>
</math>

</p>

<p>Unfortunately, we get that 17<sup>10</sup>≡1 (mod 71). So we still don't know if 71 is prime or not.</p>

<p>We try another random <em>a</em>, this time choosing <em>a</em> = 11. Now we compute:</p>

<p>

<math display="block" id="Lucas_primality_test:5">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <msup>
      <mn>11</mn>
      <mn>70</mn>
     </msup>
    </mpadded>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>71</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">11</cn>
     <cn type="integer">70</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="float">1</cn>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">71</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   11^{70}\ \equiv\ 1\;\;(\mathop{{\rm mod}}71).
  </annotation>
 </semantics>
</math>

</p>

<p>Again, this does not show that the multiplicative order of 11 (mod 71) is 70 because some factor of 70 may also work. So check 70 divided by its prime factors:</p>

<p>

<math display="block" id="Lucas_primality_test:6">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <msup>
     <mn>11</mn>
     <mn>35</mn>
    </msup>
   </mpadded>
   <mo>≡</mo>
   <mpadded width="+5pt">
    <mn>70</mn>
   </mpadded>
   <mo>≢</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>71</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">11</cn>
      <cn type="integer">35</cn>
     </apply>
     <cn type="float">70</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">not-equivalent-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">71</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   11^{35}\ \equiv\ 70\ \not\equiv\ 1\;\;(\mathop{{\rm mod}}71)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Lucas_primality_test:7">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <msup>
     <mn>11</mn>
     <mn>14</mn>
    </msup>
   </mpadded>
   <mo>≡</mo>
   <mpadded width="+5pt">
    <mn>54</mn>
   </mpadded>
   <mo>≢</mo>
   <mrow>
    <mn>1</mn>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mn>71</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">11</cn>
      <cn type="integer">14</cn>
     </apply>
     <cn type="float">54</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">not-equivalent-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">71</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   11^{14}\ \equiv\ 54\ \not\equiv\ 1\;\;(\mathop{{\rm mod}}71)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Lucas_primality_test:8">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+5pt">
     <msup>
      <mn>11</mn>
      <mn>10</mn>
     </msup>
    </mpadded>
    <mo>≡</mo>
    <mpadded width="+5pt">
     <mn>32</mn>
    </mpadded>
    <mo>≢</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>71</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">11</cn>
      <cn type="integer">10</cn>
     </apply>
     <cn type="float">32</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">not-equivalent-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <cn type="float">1</cn>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">71</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   11^{10}\ \equiv\ 32\ \not\equiv\ 1\;\;(\mathop{{\rm mod}}71).
  </annotation>
 </semantics>
</math>

</p>

<p>So the multiplicative order of 11 (mod 71) is 70, and thus 71 is prime.</p>

<p>(To carry out these <a href="modular_exponentiation" title="wikilink">modular exponentiations</a>, one could use a fast exponentiation algorithm like <a href="Exponentiation_by_squaring" title="wikilink">binary</a> or <a href="addition-chain_exponentiation" title="wikilink">addition-chain exponentiation</a>).</p>
<h2 id="algorithm">Algorithm</h2>

<p>The algorithm can be written in <a class="uri" href="pseudocode" title="wikilink">pseudocode</a> as follows:</p>

<p><strong><code>Input</code></strong><code>: </code><em><code>n</code></em><code> &gt; 2, an odd integer to be tested for primality; </code><em><code>k</code></em><code>, a parameter that determines the accuracy of the test </code><br/>
<strong><code>Output</code></strong><code>: </code><em><code>prime</code></em><code> if </code><em><code>n</code></em><code> is prime, otherwise </code><em><code>composite</code></em><code> or </code><em><code>possibly</code> <code>composite</code></em><code>;</code><br/>
<code>determine the prime factors of </code><em><code>n</code></em><code>−1.</code><br/>
<code>LOOP1: repeat </code><em><code>k</code></em><code> times:</code><br/>
<code>   pick </code><em><code>a</code></em><code> randomly in the range [2, </code><em><code>n</code></em><code> − 1]</code><br/>
<code>      if </code><em><code>a</code></em><sup><code>n-1</code></sup><code> </code>

<math display="inline" id="Lucas_primality_test:9">
 <semantics>
  <mo>≢</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">not-equivalent-to</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \not\equiv
  </annotation>
 </semantics>
</math>

<code> 1 (mod </code><em><code>n</code></em><code>) then return </code><em><code>composite</code></em><br/>
<code>      otherwise </code><br/>
<code>         LOOP2: for all prime factors </code><em><code>q</code></em><code> of </code><em><code>n</code></em><code>−1:</code><br/>
<code>            if </code><em><code>a</code></em><sup><code>(n-1)/q</code></sup><code> </code>

<math display="inline" id="Lucas_primality_test:10">
 <semantics>
  <mo>≢</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">not-equivalent-to</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \not\equiv
  </annotation>
 </semantics>
</math>

<code> 1 (mod </code><em><code>n</code></em><code>) </code><br/>
<code>               if we did not check this equality for all prime factors of </code><em><code>n</code></em><code>−1 </code><br/>
<code>                  then do next LOOP2</code><br/>
<code>               otherwise return </code><em><code>prime</code></em><br/>
<code>            otherwise do next LOOP1</code><br/>
<code>return </code><em><code>possibly</code> <code>composite</code></em><code>.</code></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Édouard_Lucas" title="wikilink">Édouard Lucas</a></li>
<li><a href="Fermat's_little_theorem" title="wikilink">Fermat's little theorem</a></li>
</ul>
<h2 id="notes">Notes</h2>

<p>"</p>

<p><a href="Category:Primality_tests" title="wikilink">Category:Primality tests</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

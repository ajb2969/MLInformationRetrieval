   Price equation      Price equation   The Price equation (also known as Price's equation or Price's theorem ) is a mathematical identity which describes how a trait or gene changes in frequency over time. The equation uses a covariance to give a mathematical description of evolution and natural selection . The Price equation was derived by George R. Price , working in London to re-derive W.D. Hamilton 's work on kin selection . The Price equation also has applications in economics . 1  Price's equation is a theorem ; it is a statement of mathematical fact between certain variables, and its value lies in the insight gained by assigning certain values encountered in evolutionary genetics to the variables. It provides a way to understand the effects that gene transmission and natural selection have on the proportion of genes within each new generation of a population.  Statement  Suppose there is a population of   n   n   n   individuals over which the amount of a particular characteristic varies. Those   n   n   n   individuals can be grouped by the amount of the characteristic that each displays. There can be as few as just one group of all   n   n   n   individuals (consisting of a single shared value of the characteristic) and as many as   n   n   n   groups of one individual each (consisting of   n   n   n   distinct values of the characteristic). Index each group with   i   i   i   so that the number of members in the group is    n  i     subscript  n  i    n_{i}   and the value of the characteristic shared among all members of the group is    z  i     subscript  z  i    z_{i}   . Now assume that having    z  i     subscript  z  i    z_{i}   of the characteristic is associated with having a fitness     w  i     subscript  w  i    w_{i}   where the product     w  i    n  i        subscript  w  i    subscript  n  i     w_{i}n_{i}   represents the number of offspring in the next generation. Denote this number of offspring from group   i   i   i   by    n  i  ′     superscript   subscript  n  i   normal-′    n_{i}^{\prime}   so that     w  i   =    n  i  ′   /   n  i         subscript  w  i      superscript   subscript  n  i   normal-′    subscript  n  i      w_{i}=n_{i}^{\prime}/n_{i}   . Let    z  i  ′     superscript   subscript  z  i   normal-′    z_{i}^{\prime}   be the average amount of the characteristic displayed by the offspring from group   i   i   i   . Denote the amount of change in characteristic in group   i   i   i   by    Δ   z  i       normal-Δ   subscript  z  i     \Delta z_{i}   defined by       Δ    z  i       =  def      z  i  ′   -   z  i        superscript   def     normal-Δ   subscript  z  i       superscript   subscript  z  i   normal-′    subscript  z  i      \Delta{z_{i}}\;\stackrel{\mathrm{def}}{=}\;z_{i}^{\prime}-z_{i}     Now take   z   z   z   to be the average characteristic value in this population and    z  ′     superscript  z  normal-′    z^{\prime}   to be the average characteristic value in the next generation. Define the change in average characteristic by    Δ  z      normal-Δ  z    \Delta{z}   . That is,       Δ   z      =  def      z  ′   -  z       superscript   def     normal-Δ  z      superscript  z  normal-′   z     \Delta{z}\;\stackrel{\mathrm{def}}{=}\;z^{\prime}-z     Note that this is not the average value of    Δ   z  i       normal-Δ   subscript  z  i     \Delta{z_{i}}   (as it is possible that     n  i   ≠   n  i  ′        subscript  n  i    subscript   superscript  n  normal-′   i     n_{i}\neq n^{\prime}_{i}   ). Also take   w   w   w   to be the average fitness of this population. The Price equation states:        w   Δ  z   =    cov   (   w  i   ,   z  i   )    +   E   (     w  i    Δ   z  i    )           w  normal-Δ  z      cov   subscript  w  i    subscript  z  i     normal-E     subscript  w  i   normal-Δ   subscript  z  i        w\,\Delta{z}=\operatorname{cov}(w_{i},z_{i})+\operatorname{E}(w_{i}\,\Delta z_%
 {i})     where the functions   E   normal-E   \operatorname{E}   and   cov   cov   \operatorname{cov}   are respectively defined in Equations (1) and (2) below and are equivalent to the traditional definitions of sample mean and covariance ; however, they are not meant to be statistical estimates of characteristics of a population. In particular, the Price equation is a deterministic difference equation that models the trajectory of the actual mean value of a characteristic along the flow of an actual population of individuals. Assuming that the mean fitness   w   w   w   is not zero, it is often useful to write it as       Δ  z   =     1  w    cov   (   w  i   ,   z  i   )     +    1  w    E   (     w  i    Δ   z  i    )            normal-Δ  z         1  w    cov   subscript  w  i    subscript  z  i         1  w    normal-E     subscript  w  i   normal-Δ   subscript  z  i         \Delta{z}=\frac{1}{w}\operatorname{cov}(w_{i},z_{i})+\frac{1}{w}\operatorname{%
 E}(w_{i}\,\Delta z_{i})     In the specific case that characteristic     z  i   =   w  i        subscript  z  i    subscript  w  i     z_{i}=w_{i}   (i.e., fitness itself is the characteristic of interest), then Price's equation reformulates Fisher's fundamental theorem of natural selection .  Proof of the Price equation  To prove the Price equation, the following definitions are needed. If    n  i     subscript  n  i    n_{i}   is the number of occurrences of a pair of real numbers    x  i     subscript  x  i    x_{i}   and    y  i     subscript  y  i    y_{i}   , then:   The mean of the    x  i     subscript  x  i    x_{i}   values is:              E   (   x  i   )      =  def      1     ∑  i     n  i       ∑  i     x  i    n  i          superscript   def    normal-E   subscript  x  i        1    subscript   i    subscript  n  i       subscript   i      subscript  x  i    subscript  n  i        \operatorname{E}(x_{i})\;\stackrel{\mathrm{def}}{=}\;\frac{1}{\sum_{i}n_{i}}%
 \sum_{i}x_{i}n_{i}          (  1  )    1   (1)           The covariance between the    x  i     subscript  x  i    x_{i}   and    y  i     subscript  y  i    y_{i}   values is:              cov   (   x  i   ,   y  i   )      =  def      1     ∑  i     n  i       ∑  i     n  i    [    x  i   -   E   (   x  i   )     ]    [    y  i   -   E   (   y  i   )     ]      =    E   (    x  i    y  i    )    -    E   (   x  i   )     E   (   y  i   )            superscript   def    cov   subscript  x  i    subscript  y  i        1    subscript   i    subscript  n  i       subscript   i      subscript  n  i    delimited-[]     subscript  x  i    normal-E   subscript  x  i       delimited-[]     subscript  y  i    normal-E   subscript  y  i                 normal-E     subscript  x  i    subscript  y  i        normal-E   subscript  x  i     normal-E   subscript  y  i         \operatorname{cov}(x_{i},y_{i})\;\stackrel{\mathrm{def}}{=}\;\frac{1}{\sum_{i}%
 n_{i}}\sum_{i}n_{i}[x_{i}-\operatorname{E}(x_{i})][y_{i}-\operatorname{E}(y_{i%
 })]=\operatorname{E}(x_{i}y_{i})-\operatorname{E}(x_{i})\operatorname{E}(y_{i})          (  2  )    2   (2)          The notation     ⟨   x  i   ⟩   =   E   (   x  i   )         delimited-⟨⟩   subscript  x  i     normal-E   subscript  x  i      \langle x_{i}\rangle=\operatorname{E}(x_{i})   will also be used when convenient.  Suppose there is a population of organisms all of which have a genetic characteristic described by some real number. For example, high values of the number represent an increased visual acuity over some other organism with a lower value of the characteristic. Groups can be defined in the population which are characterized by having the same value of the characteristic. Let subscript   i   i   i   identify the group with characteristic    z  i     subscript  z  i    z_{i}   and let    n  i     subscript  n  i    n_{i}   be the number of organisms in that group. The total number of organisms is then   n   n   n   where:      n  =    ∑  i    n  i        n    subscript   i    subscript  n  i      n=\sum_{i}n_{i}     The average value of the characteristic is   z   z   z   defined as:             z     =  def     E   (   z  i   )    =    1  n     ∑  i     z  i    n  i            superscript   def   z   normal-E   subscript  z  i             1  n     subscript   i      subscript  z  i    subscript  n  i         z\;\stackrel{\mathrm{def}}{=}\;\operatorname{E}(z_{i})=\frac{1}{n}\sum_{i}z_{i%
 }n_{i}          (  3  )    3   (3)          Now suppose that the population reproduces, all parents are eliminated, and then there is a selection process on the children, by which less fit children are removed from the reproducing population. After reproduction and selection, the population numbers for the child groups will change to n ′ i . Primes will be used to denote child parameters, unprimed variables denote parent parameters.  The total number of children is ''n' '' where:       n  ′   =    ∑  i    n  i  ′         superscript  n  normal-′     subscript   i    subscript   superscript  n  normal-′   i      n^{\prime}=\sum_{i}n^{\prime}_{i}     The fitness of group i will be defined to be the ratio of children to parents:             w  i   =    n  i  ′    n  i         subscript  w  i      superscript   subscript  n  i   normal-′    subscript  n  i      w_{i}=\frac{n_{i}^{\prime}}{n_{i}}          (  4  )    4   (4)\,          with average fitness of the population being             w     =  def     E   (   w  i   )    =    1  n     ∑  i     w  i    n  i      =    1  n     ∑  i      n  i  ′    n  i     n  i      =    1  n     ∑  i    n  i  ′     =    n  ′   n         superscript   def   w   normal-E   subscript  w  i             1  n     subscript   i      subscript  w  i    subscript  n  i               1  n     subscript   i        superscript   subscript  n  i   normal-′    subscript  n  i     subscript  n  i               1  n     subscript   i    superscript   subscript  n  i   normal-′             superscript  n  normal-′   n      w\;\stackrel{\mathrm{def}}{=}\;\operatorname{E}(w_{i})=\frac{1}{n}\sum_{i}w_{i%
 }n_{i}=\frac{1}{n}\sum_{i}\frac{n_{i}^{\prime}}{n_{i}}n_{i}=\frac{1}{n}\sum_{i%
 }n_{i}^{\prime}=\frac{n^{\prime}}{n}          (  5  )    5   (5)          The average value of the child characteristic will be ''z' '' where:             z  ′   =    1   n  ′      ∑  i     z  i  ′    n  i  ′           superscript  z  normal-′       1   superscript  n  normal-′      subscript   i      subscript   superscript  z  normal-′   i    superscript   subscript  n  i   normal-′        z^{\prime}=\frac{1}{n^{\prime}}\sum_{i}z^{\prime}_{i}n_{i}^{\prime}          (  6  )    6   (6)          where z ′ i are the (possibly new) values of the characteristic in the child population. Equation (2) shows that:             cov   (   w  i   ,   z  i   )    =    E   (    w  i    z  i    )    -   w  z         cov   subscript  w  i    subscript  z  i       normal-E     subscript  w  i    subscript  z  i       w  z      \operatorname{cov}(w_{i},z_{i})=\operatorname{E}(w_{i}z_{i})-wz          (  7  )    7   (7)          Call the change in characteristic value from parent to child populations    Δ   z  i       normal-Δ   subscript  z  i     \Delta z_{i}   so that     Δ   z  i    =    z  i  ′   -   z  i          normal-Δ   subscript  z  i       subscript   superscript  z  normal-′   i    subscript  z  i      \Delta z_{i}=z^{\prime}_{i}-z_{i}   . As seen in Equation (1), the expected value operator   E   normal-E   \operatorname{E}   is linear , so             E   (     w  i    Δ   z  i    )    =    E   (    w  i    z  i  ′    )    -   E   (    w  i    z  i    )          normal-E     subscript  w  i   normal-Δ   subscript  z  i        normal-E     subscript  w  i    subscript   superscript  z  normal-′   i      normal-E     subscript  w  i    subscript  z  i        \operatorname{E}(w_{i}\,\Delta z_{i})=\operatorname{E}(w_{i}z^{\prime}_{i})-%
 \operatorname{E}(w_{i}z_{i})          (  8  )    8   (8)          Combining Equations (7) and (8) leads to              cov   (   w  i   ,   z  i   )    +   E   (     w  i    Δ   z  i    )     =    [    E   (    w  i    z  i    )    -   w  z    ]   +   [    E   (    w  i    z  i  ′    )    -   E   (    w  i    z  i    )     ]    =    E   (    w  i    z  i  ′    )    -   w  z             cov   subscript  w  i    subscript  z  i     normal-E     subscript  w  i   normal-Δ   subscript  z  i         delimited-[]     normal-E     subscript  w  i    subscript  z  i       w  z      delimited-[]     normal-E     subscript  w  i    subscript   superscript  z  normal-′   i      normal-E     subscript  w  i    subscript  z  i                normal-E     subscript  w  i    subscript   superscript  z  normal-′   i       w  z       \operatorname{cov}(w_{i},z_{i})+\operatorname{E}(w_{i}\,\Delta z_{i})=\left[%
 \operatorname{E}(w_{i}z_{i})-wz\right]+\left[\operatorname{E}(w_{i}z^{\prime}_%
 {i})-\operatorname{E}(w_{i}z_{i})\right]=\operatorname{E}(w_{i}z^{\prime}_{i})%
 -wz          (  9  )    9   (9)          Now, let's compute the first term in the equality above. From Equation (1), we know that:       E   (    w  i    z  i  ′    )    =    1  n     ∑  i     w  i    z  i  ′    n  i           normal-E     subscript  w  i    subscript   superscript  z  normal-′   i         1  n     subscript   i      subscript  w  i    subscript   superscript  z  normal-′   i    subscript  n  i        \operatorname{E}(w_{i}z^{\prime}_{i})=\frac{1}{n}\sum_{i}w_{i}z^{\prime}_{i}n_%
 {i}     Substituting the definition of fitness,     w  i   =    n  i  ′    n  i         subscript  w  i      subscript   superscript  n  normal-′   i    subscript  n  i      w_{i}=\frac{n^{\prime}_{i}}{n_{i}}   (Equation (4)), we get:             E   (    w  i    z  i  ′    )    =    1  n     ∑  i      n  i  ′    n  i     z  i  ′    n  i      =    1  n     ∑  i     n  i  ′    z  i  ′      =      n  ′   n     1   n  ′      ∑  i     z  i  ′    n  i  ′             normal-E     subscript  w  i    subscript   superscript  z  normal-′   i         1  n     subscript   i        subscript   superscript  n  normal-′   i    subscript  n  i     subscript   superscript  z  normal-′   i    subscript  n  i               1  n     subscript   i      subscript   superscript  n  normal-′   i    subscript   superscript  z  normal-′   i                superscript  n  normal-′   n     1   superscript  n  normal-′      subscript   i      subscript   superscript  z  normal-′   i    subscript   superscript  n  normal-′   i         \operatorname{E}(w_{i}z^{\prime}_{i})=\frac{1}{n}\sum_{i}\frac{n^{\prime}_{i}}%
 {n_{i}}z^{\prime}_{i}n_{i}=\frac{1}{n}\sum_{i}n^{\prime}_{i}z^{\prime}_{i}=%
 \frac{n^{\prime}}{n}~{}\frac{1}{n^{\prime}}\sum_{i}z^{\prime}_{i}n^{\prime}_{i}          (  10  )    10   (10)          Next, substituting the definitions of average fitness (    w  =    n  ′   n       w     superscript  n  normal-′   n     w=\frac{n^{\prime}}{n}   ) from Equation (9), and average child characteristics (    z  ′     superscript  z  normal-′    z^{\prime}   ) from Equation (10) gives the Price Equation:        cov   (   w  i   ,   z  i   )    +   E   (     w  i    Δ   z  i    )     =    w   z  ′    -   w  z    =    w   Δ   z             cov   subscript  w  i    subscript  z  i     normal-E     subscript  w  i   normal-Δ   subscript  z  i          w   superscript  z  normal-′      w  z           w  normal-Δ  z      \operatorname{cov}(w_{i},z_{i})+\operatorname{E}(w_{i}\,\Delta z_{i})=wz^{%
 \prime}-wz=w\,\Delta z\,     Simple Price equation  When the characteristic values z i do not change from the parent to the child generation, the second term in the Price equation becomes zero resulting in a simplified version of the Price equation:        w   Δ  z   =   cov   (   w  i   ,   z  i   )          w  normal-Δ  z    cov   subscript  w  i    subscript  z  i      w\,\Delta z=\operatorname{cov}\left(w_{i},z_{i}\right)     which can be restated as:       Δ  z   =   cov   (   v  i   ,   z  i   )          normal-Δ  z    cov   subscript  v  i    subscript  z  i      \Delta z=\operatorname{cov}\left(v_{i},z_{i}\right)     where v i is the fractional fitness: v i = w i / w .  This simple Price equation can be proven using the definition in Equation (2) above. It makes this fundamental statement about evolution: "If a certain inheritable characteristic is correlated with an increase in fractional fitness, the average value of that characteristic in the child population will be increased over that in the parent population."  Example: Evolution of sight  As an example of the simple Price equation, consider a model for the evolution of sight. Suppose z i is a real number measuring the visual acuity of an organism. An organism with a higher z i will have better sight than one with a lower value of z i . Let us say that the fitness of such an organism is w i = z i which means the more sighted it is, the fitter it is, that is, the more children it will produce. Beginning with the following description of a parent population composed of 3 types: ( i = 0,1,2) with sightedness values z i = 3,2,1:        i   0   1   2       n i   10   20   30     z i   3   2   1       Using Equation (4), the child population (assuming the character z i doesn't change; that is, z i = z i ')        i   0   1   2       n i   30   40   30     z i   3   2   1       We would like to know how much average visual acuity has increased or decreased in the population. From Equation (3), the average sightedness of the parent population is z = 5/3. The average sightedness of the child population is z ' = 2, so that the change in average sightedness is:       Δ   z      =  def      z  ′   -  z   =   1  3         superscript   def     normal-Δ  z      superscript  z  normal-′   z          1  3      \Delta z\;\stackrel{\mathrm{def}}{=}\;z^{\prime}-z=\frac{1}{3}     which indicates that the trait of sightedness is increasing in the population. Applying the Price equation we have (since z ′ i = z i ):       Δ  z   =    1  w    cov   (   w  i   ,   z  i   )     =   1  3           normal-Δ  z       1  w    cov   subscript  w  i    subscript  z  i            1  3      \Delta z=\frac{1}{w}\operatorname{cov}\left(w_{i},z_{i}\right)=\frac{1}{3}     Dynamical sufficiency and the simple Price equation  Sometimes the genetic model being used encodes enough information into the parameters used by the Price equation to allow the calculation of the parameters for all subsequent generations. This property is referred to as dynamical sufficiency. For simplicity, the following looks at dynamical sufficiency for the simple Price equation, but is also valid for the full Price equation.  Referring to the definition in Equation (2), the simple Price equation for the character z can be written:       w   (    z  ′   -  z   )    =    ⟨    w  i    z  i    ⟩   -   w  z          w     superscript  z  normal-′   z       delimited-⟨⟩     subscript  w  i    subscript  z  i       w  z      w(z^{\prime}-z)=\langle w_{i}z_{i}\rangle-wz     For the second generation:        w  ′    (    z  ′′   -   z  ′    )    =    ⟨    w  i  ′    z  i  ′    ⟩   -    w  ′    z  ′            superscript  w  normal-′      superscript  z  ′′    superscript  z  normal-′        delimited-⟨⟩     subscript   superscript  w  normal-′   i    subscript   superscript  z  normal-′   i        superscript  w  normal-′    superscript  z  normal-′       w^{\prime}(z^{\prime\prime}-z^{\prime})=\langle w^{\prime}_{i}z^{\prime}_{i}%
 \rangle-w^{\prime}z^{\prime}     The simple Price equation for z only gives us the value of z '  for the first generation, but does not give us the value of w '  and 〈 w ' i  z ' i 〉 which are needed to calculate z ″ for the second generation. The variables w '  and 〈 w ' i  z ' i 〉 can both be thought of as characteristics of the first generation, so the Price equation can be used to calculate them as well:      w   (    w  ′   -  w   )       w     superscript  w  normal-′   w     \displaystyle w(w^{\prime}-w)     The five 0-generation variables w , z , 〈 w i  z i 〉, 〈 w 2 i 〉, and 〈 w 2 i  z i 〉 which must be known before proceeding to calculate the three first generation variables w ', z ', and 〈 w ' i  z ' i 〉, which are needed to calculate z ″ for the second generation. It can be seen that in general the Price equation cannot be used to propagate forward in time unless there is a way of calculating the higher moments (〈 w n i 〉 and 〈 w n i  z i 〉) from the lower moments in a way that is independent of the generation. Dynamical sufficiency means that such equations can be found in the genetic model, allowing the Price equation to be used alone as a propagator of the dynamics of the model forward in time.  Example: Evolution of sickle cell anemia  (Figure)  An example of autosomal recessive inheritance. In the sickle cell case, the two parents are "carriers" who are resistant to malaria. Their children have one chance in four of inheriting both sickle cell genes and suffering sickle cell anemia, two chances in four of being a carrier themselves, and being resistant to malaria like their parents, and one chance in four of not inheriting the gene from either parent, and being susceptible to malaria.   As an example of dynamical sufficiency, consider the case of sickle cell anemia . Each person has two sets of genes, one set inherited from the father, one from the mother. Sickle cell anemia is a blood disorder which occurs when a particular pair of genes both carry the 'sickle-cell trait'. The reason that the sickle-cell gene has not been eliminated from the human population by selection is because when there is only one of the pair of genes carrying the sickle-cell trait, that individual (a "carrier") is highly resistant to malaria, while a person who has neither gene carrying the sickle-cell trait will be susceptible to malaria. Let's see what the Price equation has to say about this.  Let z i = i be the number of sickle-cell genes that organisms of type i have so that z i = 0 or 1 or 2. Assume the population sexually reproduces and matings are random between type 0 and 1, so that the number of 0–1 matings is n 0 n 1 /( n 0 + n 1 ) and the number of i – i matings is n 2 i /[2( n 0 + n 1 )] where i = 0 or 1. Suppose also that each gene has a 1/2 chance of being passed to any given child and that the initial population is n i =[ n 0 , n 1 , n 2 ]. If b is the birth rate, then after reproduction there will be      b   (      1  2    n  0  2    +    1  2    n  0    n  1    +    1  8    n  1  2       n  0   +   n  1     )       b          1  2    superscript   subscript  n  0   2        1  2    subscript  n  0    subscript  n  1        1  8    superscript   subscript  n  1   2        subscript  n  0    subscript  n  1       b\left(\frac{\frac{1}{2}n_{0}^{2}+\frac{1}{2}n_{0}n_{1}+\frac{1}{8}n_{1}^{2}}{%
 n_{0}+n_{1}}\right)   type 0 children (unaffected)      b   (      1  2    n  0    n  1    +    1  4    n  1  2       n  0   +   n  1     )       b          1  2    subscript  n  0    subscript  n  1        1  4    superscript   subscript  n  1   2        subscript  n  0    subscript  n  1       b\left(\frac{\frac{1}{2}n_{0}n_{1}+\frac{1}{4}n_{1}^{2}}{n_{0}+n_{1}}\right)   type 1 children (carriers)      b   (     1  8    n  1  2      n  0   +   n  1     )       b        1  8    superscript   subscript  n  1   2       subscript  n  0    subscript  n  1       b\left(\frac{\frac{1}{8}n_{1}^{2}}{n_{0}+n_{1}}\right)   type 2 children (affected)  Suppose a fraction a of type 0 reproduce, the loss being due to malaria. Suppose all of type 1 reproduce, since they are resistant to malaria, while none of the type 2 reproduce, since they all have sickle-cell anemia. The fitness coefficients are then:      w  0     subscript  w  0    \displaystyle w_{0}     To find the concentration n 1 of carriers in the population at equilibrium, with the equilibrium condition of Δ z =0, the simple Price equation is used:      0  =   cov   (    w  i   w   ,   z  i   )    =    f   (   2  -   2  a   -   a  f    )      (   1  +  f   )    (    2  a   +   2  f   +   a  f    )           0   cov     subscript  w  i   w    subscript  z  i             f    2    2  a     a  f         1  f       2  a     2  f     a  f         0=\operatorname{cov}\left(\frac{w_{i}}{w},z_{i}\right)=\frac{f(2-2a-af)}{(1+f)%
 (2a+2f+af)}     where f = n 1 / n 0 . At equilibrium then, assuming f is not zero:      f  =    n  1    n  0    =    2   (   1  -  a   )    a         f     subscript  n  1    subscript  n  0             2    1  a    a      f=\frac{n_{1}}{n_{0}}=\frac{2(1-a)}{a}     In other words the ratio of carriers to non-carriers will be equal to the above constant non-zero value. In the absence of malaria, a =1 and f =0 so that the sickle-cell gene is eliminated from the gene pool. For any presence of malaria, a will be smaller than unity and the sickle-cell gene will persist.  The situation has been effectively determined for the infinite (equilibrium) generation. This means that there is dynamical sufficiency with respect to the Price equation, and that there is an equation relating higher moments to lower moments. For example, for the second moments:      ⟨    w  i  2    z  i    ⟩     delimited-⟨⟩     superscript   subscript  w  i   2    subscript  z  i      \displaystyle\langle w_{i}^{2}z_{i}\rangle     Example: sex ratios  In a 2-sex species or deme with sexes 1 and 2 where     z  1   =  1       subscript  z  1   1    z_{1}=1   ,     z  2   =  0       subscript  z  2   0    z_{2}=0   ,   z   z   z   is the relative frequency of sex 1. Since all individuals have one parent of each sex, the fitness of each sex is proportional to the other sex's size. Consider proportionality constants   a   a   a   and   b   b   b   such that     w  1   =   a   (   1  -  z   )         subscript  w  1     a    1  z      w_{1}=a(1-z)   and     w  2   =   b  z        subscript  w  2     b  z     w_{2}=bz   . This gives    w  =    (   a  +  b   )   z   (   1  -  z   )        w      a  b   z    1  z      w=(a+b)z(1-z)   and      c  o  v   (   w  i   ,   z  i   )    +   w  z    =   E   (   w  i   ,   z  i   )    =   a  z   (   1  -  z   )              c  o  v    subscript  w  i    subscript  z  i       w  z      E    subscript  w  i    subscript  z  i            a  z    1  z       cov(w_{i},z_{i})+wz=E(w_{i},z_{i})=az(1-z)   , so     c  o  v   (   w  i   ,   z  i   )    =    a  z   (   1  -  z   )    -    (   a  +  b   )    z  2    (   1  -  z   )     =   z   [   1  -  z   ]    [   a  -    (   a  +  b   )   z    ]            c  o  v    subscript  w  i    subscript  z  i         a  z    1  z        a  b    superscript  z  2     1  z            z   delimited-[]    1  z     delimited-[]    a      a  b   z         cov(w_{i},z_{i})=az(1-z)-(a+b)z^{2}(1-z)=z[1-z][a-(a+b)z]   . Hence,     Δ  z   =    a   a  +  b    -  z         normal-Δ  z       a    a  b    z     \Delta z=\frac{a}{a+b}-z   so that     z  ′   =   a   a  +  b         superscript  z  normal-′     a    a  b      z^{\prime}=\frac{a}{a+b}   .  Full Price equation  The simple Price equation was based on the assumption that the characters z i do not change over one generation. If it is assumed that they do change, with z i being the value of the character in the child population, then the full Price equation must be used. A change in character can come about in a number of ways. The following two examples illustrate two such possibilities, each of which introduces new insight into the Price equation.  Example: Evolution of altruism  To study the evolution of a genetic predisposition to altruism, altruism will be defined as the genetic predisposition to behavior which decreases individual fitness while increasing the average fitness of the group to which the individual belongs. First specifying a simple model, which will only require the simple Price equation. Specify a fitness w i by a model equation:       w  i   =    n  i  ′    n  i    =    k  -   a   z  i     +   b  z           subscript  w  i      subscript   superscript  n  normal-′   i    subscript  n  i             k    a   subscript  z  i       b  z       w_{i}=\frac{n^{\prime}_{i}}{n_{i}}=k-az_{i}+bz     where z i is a measure of altruism, the az i term is the decrease in fitness of an individual due to altruism towards the group and bz is the increase in fitness of an individual due to the altruism of the group towards an individual. Assume that a and b are both greater than zero. From the Price equation:       w  Δ  z   =   -   a   var   (   z  i   )            w  normal-Δ  z       a   var   subscript  z  i        w\Delta z=-a\operatorname{var}\left(z_{i}\right)     where var( z i ) is the variance of z i which is just the covariance of z i with itself:      var   (   z  i   )     =  def    E   (   z  i  2   )   -  E    (   z  i   )   2      fragments  var   fragments  normal-(   subscript  z  i   normal-)    superscript   def   normal-E   fragments  normal-(   superscript   subscript  z  i   2   normal-)    normal-E   superscript   fragments  normal-(   subscript  z  i   normal-)   2     \operatorname{var}(z_{i})\;\stackrel{\mathrm{def}}{=}\;\operatorname{E}(z_{i}^%
 {2})-\operatorname{E}(z_{i})^{2}     It can be seen that, by this model, in order for altruism to persist it must be uniform throughout the group. If there are two altruist types the average altruism of the group will decrease, the more altruistic will lose out to the less altruistic.  Now assuming a hierarchy of groups which will require the full Price equation. The population will be divided into groups, labelled with index i and then each group will have a set of subgroups labelled by index j . Individuals will thus be identified by two indices, i and j , specifying which group and subgroup they belong to. n ij will specify the number of individuals of type ij . Let z ij be the degree of altruism expressed by individual j of group i towards the members of group i . Let's specify the fitness w ij by a model equation:       w   i  j    =    n   i  j   ′    n   i  j     =    k  -   a   z   i  j      +   b   z  i            subscript  w    i  j       subscript   superscript  n  normal-′     i  j     subscript  n    i  j              k    a   subscript  z    i  j        b   subscript  z  i        w_{ij}=\frac{n^{\prime}_{ij}}{n_{ij}}=k-az_{ij}+bz_{i}     The a z ij term is the fitness the organism loses by being altruistic and is proportional to the degree of altruism z ij that it expresses towards members of its own group. The b z i term is the fitness that the organism gains from the altruism of the members of its group, and is proportional to the average altruism z i expressed by the group towards its members. Again, in studying altruistic (rather than spiteful) behavior, it is expected that a and b are positive numbers. Note that the above behavior is altruistic only when az ij > bz i . Defining the group averages:      n  i     subscript  n  i    \displaystyle n_{i}     and global averages:     n   n   \displaystyle n     It can be seen that since the z i and z i are now averages over a particular group, and since these groups are subject to selection, the value of Δ z i = z ′ i − z i will not necessarily be zero, and the full Price equation will be needed.       Δ  z   =    cov   (    w  i   w   ,   z  i   )    +   E   (     w  i    Δ    z  i   w    )           normal-Δ  z      cov     subscript  w  i   w    subscript  z  i     normal-E     subscript  w  i   normal-Δ     subscript  z  i   w        \Delta z=\operatorname{cov}\left(\frac{w_{i}}{w},z_{i}\right)+\operatorname{E}%
 \left(w_{i}\,\Delta\frac{z_{i}}{w}\right)     In this case, the first term isolates the advantage to each group conferred by having altruistic members. The second term isolates the loss of altruistic members from their group due to their altruistic behavior. The second term will be negative. In other words there will be an average loss of altruism due to the in-group loss of altruists, assuming that the altruism is not uniform across the group. The first term is:       cov   (    w  i   w   ,   z  i   )    =    (   b  -  a   )    var   (   z  i   )          cov     subscript  w  i   w    subscript  z  i        b  a    var   subscript  z  i       \operatorname{cov}\left(\frac{w_{i}}{w},z_{i}\right)=\left(b-a\right)%
 \operatorname{var}(z_{i})     In other words, for b > a there may be a positive contribution to the average altruism as a result of a group growing due to its high number of altruists and this growth can offset in-group losses, especially if the variance of the in-group altruism is low. In order for this effect to be significant, there must be a spread in the average altruism of the groups.  Example: Evolution of mutability  Suppose there is an environment containing two kinds of food. Let α be the amount of the first kind of food and β be the amount of the second kind. Suppose an organism has a single allele which allows it to utilize a particular food. The allele has four gene forms: A 0 , A m , B 0 , and B m . If an organism's single food gene is of the A type, then the organism can utilize A -food only, and its survival is proportional to α. Likewise, if an organism's single food gene is of the B type, then the organism can utilize B -food only, and its survival is proportional to β. A 0 and A m are both A -alleles, but organisms with the A 0 gene produce offspring with A 0 -genes only, while organisms with the A m gene produce, among their n offspring, ( n −3 m ) offspring with the A m gene, and m organisms of the remaining three gene types. Likewise, B 0 and B m are both B -alleles, but organisms with the B 0 gene produce offspring with B 0 -genes only, while organisms with the B m gene produce ( n −3 m ) offspring with the B m gene, and m organisms of the remaining three gene types.  Let i =0,1,2,3 be the indices associated with the A 0 , A m , B 0 , and B m genes respectively. Let w ij be the number of viable type- j organisms produced per type- i organism. The w ij matrix is: (with i denoting rows and j denoting columns)      𝐰  =   [     α    0    0    0       m  α       (   n  -   3  m    )   α      m  β      m  β       0    0    β    0       m  α      m  α      m  β       (   n  -   3  m    )   β      ]       𝐰    α  0  0  0      m  α       n    3  m    α     m  β     m  β     0  0  β  0      m  α     m  α     m  β       n    3  m    β       \mathbf{w}=\begin{bmatrix}\alpha&0&0&0\\
 m\alpha&(n-3m)\alpha&m\beta&m\beta\\
 0&0&\beta&0\\
 m\alpha&m\alpha&m\beta&(n-3m)\beta\end{bmatrix}     Mutators are at a disadvantage when the food supplies α and β are constant. They lose every generation compared to the non-mutating genes. But when the food supply varies, even though the mutators lose relative to an A or B non-mutator, they may lose less than them over the long run because, for example, an A type loses a lot when α is low. In this way, "purposeful" mutation may be selected for. This may explain the redundancy in the genetic code, in which some amino acids are encoded by more than one codon in the DNA . Although the codons produce the same amino acids, they have an effect on the mutability of the DNA, which may be selected for or against under certain conditions.  With the introduction of mutability, the question of identity versus lineage arises. Is fitness measured by the number of children an individual has, regardless of the children's genetic makeup, or is fitness the child/parent ratio of a particular genotype?. Fitness is itself a characteristic, and as a result, the Price equation will handle both.  Suppose we want to examine the evolution of mutator genes. Define the z -score as:       z  i   =   [  0  ,  1  ,  0  ,  1  ]        subscript  z  i    0  1  0  1     z_{i}=\left[0,1,0,1\right]     in other words, 0 for non-mutator genes, 1 for mutator genes. There are two cases:  Genotype fitness  We focus on the idea of the fitness of the genotype. The index i indicates the genotype and the number of type i genotypes in the child population is:       n  i  ′   =    ∑  j     w   j  i      n  j           subscript   superscript  n  normal-′   i     subscript   j      subscript  w    j  i     subscript  n  j       n^{\prime}_{i}=\sum_{j}w_{ji}n_{j}\,     which gives fitness:       w  i   =    n  i  ′    n  i         subscript  w  i      subscript   superscript  n  normal-′   i    subscript  n  i      w_{i}=\frac{n^{\prime}_{i}}{n_{i}}     Since the individual mutability z i does not change, the average mutabilities will be:     z   z   \displaystyle z     with these definitions, the simple Price equation now applies.  Lineage fitness  In this case we want to look at the idea that fitness is measured by the number of children an organism has, regardless of their genotype. Note that we now have two methods of grouping, by lineage, and by genotype. It is this complication that will introduce the need for the full Price equation. The number of children an i -type organism has is:       n  i  ′   =    n  i     ∑  j     w   i  j            subscript   superscript  n  normal-′   i      subscript  n  i     subscript   j    subscript  w    i  j        n^{\prime}_{i}=n_{i}\sum_{j}w_{ij}\,     which gives fitness:       w  i   =    n  i  ′    n  i    =    ∑  j    w   i  j            subscript  w  i      subscript   superscript  n  normal-′   i    subscript  n  i           subscript   j    subscript  w    i  j        w_{i}=\frac{n^{\prime}_{i}}{n_{i}}=\sum_{j}w_{ij}     We now have characters in the child population which are the average character of the i -th parent.       z  j  ′   =     ∑  i     n  i    z  i    w   i  j        ∑  i     n  i    w   i  j            subscript   superscript  z  normal-′   j       subscript   i      subscript  n  i    subscript  z  i    subscript  w    i  j        subscript   i      subscript  n  i    subscript  w    i  j         z^{\prime}_{j}=\frac{\sum_{i}n_{i}z_{i}w_{ij}}{\sum_{i}n_{i}w_{ij}}     with global characters:     z   z   \displaystyle z     with these definitions, the full Price equation now applies.  Criticism of the use of the Price equation  A critical discussion of the use of the Price equation can be found in van Veelen (2005) "On the use of the Price equation" 2 and van Veelen et al. (2012) "Group selection and inclusive fitness are not equivalent; the Price equation vs. models and statistics". 3 A discussion of this criticism can be found in Frank (2012) 4  Cultural references  Price's equation features in the plot and title of the 2008 thriller film WΔZ .  The Price equation also features in posters in the computer game BioShock 2 , in which a consumer of a "Brain Boost" tonic is seen deriving the Price equation while simultaneously reading a book. The game is set in the 1950s, substantially before Price's work.  References   In-line references    General references                                             "  Category:Equations  Category:Evolutionary dynamics  Category:Evolutionary biology  Category:Population genetics     ↩  ↩  ↩  ↩     
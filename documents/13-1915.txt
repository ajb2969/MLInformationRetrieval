   Variable kernel density estimation      Variable kernel density estimation   In statistics , adaptive or "variable-bandwidth" kernel density estimation is a form of kernel density estimation in which the size of the kernels used in the estimate are varied depending upon either the location of the samples or the location of the test point. It is a particularly effective technique when the sample space is multi-dimensional. 1  Rationale  Given a set of samples,    {    x  ‚Üí   i   }      subscript   normal-‚Üí  x   i     \{\vec{x}_{i}\}   , we wish to estimate the density,    P   (   x  ‚Üí   )       P   normal-‚Üí  x     P(\vec{x})   , at a test point,    x  ‚Üí     normal-‚Üí  x    \vec{x}   :       P   (   x  ‚Üí   )    ‚âà   W   n   h  D           P   normal-‚Üí  x      W    n   superscript  h  D       P(\vec{x})\approx\frac{W}{nh^{D}}         W  =    ‚àë   i  =  1   n    w  i        W    superscript   subscript     i  1    n    subscript  w  i      W=\sum_{i=1}^{n}w_{i}          w  i   =   K   (     x  ‚Üí   -    x  ‚Üí   i    h   )         subscript  w  i     K       normal-‚Üí  x    subscript   normal-‚Üí  x   i    h      w_{i}=K\left(\frac{\vec{x}-\vec{x}_{i}}{h}\right)     where n is the number of samples, K is the "kernel" , h is its width and D is the number of dimensions in    x  ‚Üí     normal-‚Üí  x    \vec{x}   . The kernel can be thought of as a simple, linear filter .  Using a fixed filter width may mean that in regions of low density, all samples will fall in the tails of the filter with very low weighting, while regions of high density will find an excessive number of samples in the central region with weighting close to unity. To fix this problem, we vary the width of the kernel in different regions of the sample space. There are two methods of doing this: balloon and pointwise estimation. In a balloon estimator, the kernel width is varied depending on the location of the test point. In a pointwise estimator, the kernel width is varied depending on the location of the sample. 2  For multivariate estimators, the parameter, h , can be generalized to vary not just the size, but also the shape of the kernel. This more complicated approach will not be covered here.  Balloon estimators  A common method of varying the kernel width is to make it inversely proportional to the density at the test point:      h  =   k    [   n  P   (   x  ‚Üí   )    ]    1  /  D         h    k   superscript   delimited-[]    n  P   normal-‚Üí  x       1  D       h=\frac{k}{\left[nP(\vec{x})\right]^{1/D}}     where k is a constant. If we back-substitute the estimated PDF, we can show that W is a constant: 3      W  =    k  D     (   2  œÄ   )    D  /  2         W     superscript  k  D    superscript    2  œÄ     D  2       W=k^{D}(2\pi)^{D/2}     This produces a generalization of the k-nearest neighbour algorithm . That is, a uniform kernel function will return the KNN technique. 4  There are two components to the error: a variance term and a bias term. The variance term is given as: 5       e  1   =    P   ‚à´   K  2      n   h  D          subscript  e  1       P     superscript  K  2       n   superscript  h  D       e_{1}=\frac{P\int K^{2}}{nh^{D}}   .  The bias term is found by evaluating the approximated function in the limit as the kernel width becomes much larger than the sample spacing. By using a Taylor expansion for the real function, the bias term drops out:       e  2   =     h  2   n     ‚àá  2   P         subscript  e  2        superscript  h  2   n     superscript  normal-‚àá  2   P      e_{2}=\frac{h^{2}}{n}\nabla^{2}P     An optimal kernel width that minimizes the error of each estimate can thus be derived.  Use for statistical classification  The method is particularly effective when applied to statistical classification . There are two ways we can proceed: the first is to compute the PDFs of each class separately, using different bandwidth parameters, and then compare them as in Taylor. 6 Alternatively, we can divide up the sum based on the class of each sample:       P   (  j  ,   x  ‚Üí   )    ‚âà    1  n     ‚àë    i  =  1   ,    c  i   =  j    n    w  i           P   j   normal-‚Üí  x         1  n     superscript   subscript    formulae-sequence    i  1      subscript  c  i   j     n    subscript  w  i       P(j,\vec{x})\approx\frac{1}{n}\sum_{i=1,c_{i}=j}^{n}w_{i}     where c i is the class of the i th sample. The class of the test point may be estimated through maximum likelihood .  Many kernels, Gaussian for instance, are smooth. Consequently, estimates of joint or conditional probabilities are both continuous and differentiable. This makes it easy to search for a border between two classes by zeroing the difference between the conditional probabilities:      R   (   x  ‚Üí   )   =  P   (  2  |   x  ‚Üí   )   -  P   (  1  |   x  ‚Üí   )   =     P   (  2  ,   x  ‚Üí   )    -   P   (  1  ,   x  ‚Üí   )       P   (  1  ,   x  ‚Üí   )    +   P   (  2  ,   x  ‚Üí   )         fragments  R   fragments  normal-(   normal-‚Üí  x   normal-)    P   fragments  normal-(  2  normal-|   normal-‚Üí  x   normal-)    P   fragments  normal-(  1  normal-|   normal-‚Üí  x   normal-)          P   2   normal-‚Üí  x       P   1   normal-‚Üí  x          P   1   normal-‚Üí  x       P   2   normal-‚Üí  x         R(\vec{x})=P(2|\vec{x})-P(1|\vec{x})=\frac{P(2,\vec{x})-P(1,\vec{x})}{P(1,\vec%
 {x})+P(2,\vec{x})}     For example, we can use a one-dimensional root-finding algorithm to zero R along a line between two samples that straddle the class border. The border can be thus sampled as many times as necessary. The border samples along with estimates of the gradients of R determine the class of a test point through a dot-product:      j  =   arg    min  ùëñ    |     b  i   ‚Üí   -   x  ‚Üí    |         j       i         normal-‚Üí   subscript  b  i     normal-‚Üí  x         j=\arg\underset{i}{\min}|\vec{b_{i}}-\vec{x}|\,         p  =      (    x  ‚Üí   -    b  j   ‚Üí    )   ‚ãÖ    ‚àá   x  ‚Üí    R    |     x  ‚Üí   =    b  j   ‚Üí         p   evaluated-at   normal-‚ãÖ     normal-‚Üí  x    normal-‚Üí   subscript  b  j       subscript  normal-‚àá   normal-‚Üí  x    R       normal-‚Üí  x    normal-‚Üí   subscript  b  j        p=(\vec{x}-\vec{b_{j}})\cdot\nabla_{\vec{x}}R|_{\vec{x}=\vec{b_{j}}}\,         c  =    (   3  +   p  /   |  p  |     )   /   2        c      3    p    p     2     c=(3+p/|p|)/2\,     where    {    b  i   ‚Üí   }      normal-‚Üí   subscript  b  i      \{\vec{b_{i}}\}   sample the class border and c is the estimated class. The value of R , which determines the conditional probabilities, may be extrapolated to the test point:       R   (   x  ‚Üí   )    ‚âà   tanh   p          R   normal-‚Üí  x      p     R(\vec{x})\approx\tanh p\,    7  Two-class classifications are easy to generalize to multiple classes.  External links   libAGF - A library for multivariate, adaptive kernel density estimation.   References    "  *  Category:Statistical classification  Category:Estimation of densities  Category:Non-parametric statistics     ‚Ü©    ‚Ü©   ‚Ü©      
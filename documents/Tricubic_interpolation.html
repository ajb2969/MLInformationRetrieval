<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1127">Tricubic interpolation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Tricubic interpolation</h1>
<hr/>

<p> In the <a class="uri" href="mathematical" title="wikilink">mathematical</a> subfield <a href="numerical_analysis" title="wikilink">numerical analysis</a>, <strong>tricubic interpolation</strong> is a method for obtaining values at arbitrary points in <a href="Three-dimensional_space" title="wikilink">3D space</a> of a function defined on a <a href="regular_grid" title="wikilink">regular grid</a>. The approach involves approximating the function locally by an expression of the form</p>

<p>

<math display="block" id="Tricubic_interpolation:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mn>3</mn>
     </munderover>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mn>3</mn>
      </munderover>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mn>3</mn>
       </munderover>
       <mrow>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
          <mi>k</mi>
         </mrow>
        </msub>
        <msup>
         <mi>x</mi>
         <mi>i</mi>
        </msup>
        <msup>
         <mi>y</mi>
         <mi>j</mi>
        </msup>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>z</ci>
     </vector>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>y</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y,z)=\sum_{i=0}^{3}\sum_{j=0}^{3}\sum_{k=0}^{3}a_{ijk}x^{i}y^{j}z^{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>This form has 64 coefficients 

<math display="inline" id="Tricubic_interpolation:1">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{ijk}
  </annotation>
 </semantics>
</math>

; requiring the function to have a given value or given <a href="directional_derivative" title="wikilink">directional derivative</a> at a point places one linear constraint on the 64 coefficients.</p>

<p>The term <em>tricubic interpolation</em> is used in more than one context; some experiments measure both the value of a function and its spatial derivatives, and it is desirable to interpolate preserving the values and the measured derivatives at the grid points. Those provide 32 constraints on the coefficients, and another 32 constraints can be provided by requiring smoothness of higher derivatives.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>In other contexts, we can obtain the 64 coefficients by considering a 3x3x3 grid of small cubes surrounding the cube inside which we evaluate the function, and fitting the function at the 64 points on the corners of this grid.</p>

<p>The <a href="cubic_interpolation" title="wikilink">cubic interpolation</a> article indicates that the method is equivalent to a sequential application of one-dimensional cubic interpolators. Let 

<math display="inline" id="Tricubic_interpolation:2">
 <semantics>
  <mrow>
   <msub>
    <mi>CINT</mi>
    <mi>x</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>a</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>CINT</ci>
     <ci>x</ci>
    </apply>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">2</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{CINT}_{x}(a_{-1},a_{0},a_{1},a_{2})
  </annotation>
 </semantics>
</math>

 be the value of a monovariable cubic polynomial (e.g. constrained by values, 

<math display="inline" id="Tricubic_interpolation:3">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{-1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Tricubic_interpolation:4">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{0}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Tricubic_interpolation:5">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Tricubic_interpolation:6">
 <semantics>
  <msub>
   <mi>a</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2}
  </annotation>
 </semantics>
</math>

 from consecutive grid points) evaluated at 

<math display="inline" id="Tricubic_interpolation:7">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. In many useful cases, these cubic polynomials have the form 

<math display="inline" id="Tricubic_interpolation:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>CINT</mi>
     <mi>x</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>u</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐯</mi>
     <mi>x</mi>
    </msub>
    <mo>⋅</mo>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>u</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>CINT</ci>
      <ci>x</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
     </vector>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐯</ci>
      <ci>x</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{CINT}_{x}(u_{-1},u_{0},u_{1},u_{2})=\mathbf{v}_{x}\cdot\left(u_{-1},u_%
{0},u_{1},u_{2}\right)
  </annotation>
 </semantics>
</math>

 for some vector 

<math display="inline" id="Tricubic_interpolation:9">
 <semantics>
  <msub>
   <mi>𝐯</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐯</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}_{x}
  </annotation>
 </semantics>
</math>

 which is a function of 

<math display="inline" id="Tricubic_interpolation:10">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 alone. The tricubic interpolator is equivalent to:</p>

<p>

<math display="inline" id="Tricubic_interpolation:11">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>s</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
       <mo>,</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mtext>The value at grid point</mtext>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo>,</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>t</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
       <mo>,</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <msub>
        <mi>CINT</mi>
        <mi>z</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo>,</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo>,</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo>,</mo>
          <mn>1</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo>,</mo>
          <mn>2</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>u</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo>,</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <msub>
        <mi>CINT</mi>
        <mi>y</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>t</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>t</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mn>0</mn>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>t</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mn>1</mn>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>t</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mn>2</mn>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo>,</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <msub>
        <mi>CINT</mi>
        <mi>x</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>u</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo>,</mo>
          <mi>y</mi>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>u</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo>,</mo>
          <mi>y</mi>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>u</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>1</mn>
          <mo>,</mo>
          <mi>y</mi>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>u</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>2</mn>
          <mo>,</mo>
          <mi>y</mi>
          <mo>,</mo>
          <mi>z</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>s</ci>
      <vector>
       <ci>i</ci>
       <ci>j</ci>
       <ci>k</ci>
      </vector>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <mtext>The value at grid point</mtext>
       <vector>
        <ci>i</ci>
        <ci>j</ci>
        <ci>k</ci>
       </vector>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>t</ci>
      <vector>
       <ci>i</ci>
       <ci>j</ci>
       <ci>z</ci>
      </vector>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>CINT</ci>
        <ci>z</ci>
       </apply>
       <vector>
        <apply>
         <times></times>
         <ci>s</ci>
         <vector>
          <ci>i</ci>
          <ci>j</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <vector>
          <ci>i</ci>
          <ci>j</ci>
          <cn type="integer">0</cn>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <vector>
          <ci>i</ci>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <vector>
          <ci>i</ci>
          <ci>j</ci>
          <cn type="integer">2</cn>
         </vector>
        </apply>
       </vector>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>u</ci>
      <vector>
       <ci>i</ci>
       <ci>y</ci>
       <ci>z</ci>
      </vector>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>CINT</ci>
        <ci>y</ci>
       </apply>
       <vector>
        <apply>
         <times></times>
         <ci>t</ci>
         <vector>
          <ci>i</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
          <ci>z</ci>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>t</ci>
         <vector>
          <ci>i</ci>
          <cn type="integer">0</cn>
          <ci>z</ci>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>t</ci>
         <vector>
          <ci>i</ci>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>t</ci>
         <vector>
          <ci>i</ci>
          <cn type="integer">2</cn>
          <ci>z</ci>
         </vector>
        </apply>
       </vector>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>f</ci>
      <vector>
       <ci>x</ci>
       <ci>y</ci>
       <ci>z</ci>
      </vector>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>CINT</ci>
        <ci>x</ci>
       </apply>
       <vector>
        <apply>
         <times></times>
         <ci>u</ci>
         <vector>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
          <ci>y</ci>
          <ci>z</ci>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>u</ci>
         <vector>
          <cn type="integer">0</cn>
          <ci>y</ci>
          <ci>z</ci>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>u</ci>
         <vector>
          <cn type="integer">1</cn>
          <ci>y</ci>
          <ci>z</ci>
         </vector>
        </apply>
        <apply>
         <times></times>
         <ci>u</ci>
         <vector>
          <cn type="integer">2</cn>
          <ci>y</ci>
          <ci>z</ci>
         </vector>
        </apply>
       </vector>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle s(i,j,k)&\displaystyle{}=\text{The value at grid %
point }(i,j,k)\\
\displaystyle t(i,j,z)&\displaystyle{}=\mathrm{CINT}_{z}\left(s(i,j,-1),s(i,j,%
0),s(i,j,1),s(i,j,2)\right)\\
\displaystyle u(i,y,z)&\displaystyle{}=\mathrm{CINT}_{y}\left(t(i,-1,z),t(i,0,%
z),t(i,1,z),t(i,2,z)\right)\\
\displaystyle f(x,y,z)&\displaystyle{}=\mathrm{CINT}_{x}\left(u(-1,y,z),u(0,y,%
z),u(1,y,z),u(2,y,z)\right)\end{aligned}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Tricubic_interpolation:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>,</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>i</ci>
     <ci>j</ci>
     <ci>k</ci>
    </list>
    <set>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i,j,k\in\{-1,0,1,2\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Tricubic_interpolation:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>z</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>x</ci>
     <ci>y</ci>
     <ci>z</ci>
    </list>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,y,z\in[0,1]
  </annotation>
 </semantics>
</math>

.</p>

<p>At first glance, it might seem more convenient to use the 21 calls to 

<math display="inline" id="Tricubic_interpolation:14">
 <semantics>
  <mi>CINT</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>CINT</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{CINT}
  </annotation>
 </semantics>
</math>

 described above instead of the 

<math display="inline" id="Tricubic_interpolation:15">
 <semantics>
  <mrow>
   <mn>64</mn>
   <mo>×</mo>
   <mn>64</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">64</cn>
    <cn type="integer">64</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {64\times 64}
  </annotation>
 </semantics>
</math>

 matrix described in Lekien and Marsden.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> However, a proper implementation using a sparse format for the matrix (that is fairly sparse) makes the latter more efficient. This aspect is even much more pronounced when interpolation is needed at several locations inside the same cube. In this case, the 

<math display="inline" id="Tricubic_interpolation:16">
 <semantics>
  <mrow>
   <mn>64</mn>
   <mo>×</mo>
   <mn>64</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">64</cn>
    <cn type="integer">64</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {64\times 64}
  </annotation>
 </semantics>
</math>

 matrix is used once to compute the interpolation coefficients for the entire cube. The coefficients are then stored and used for interpolation at any location inside the cube. In comparison, sequential use of one-dimensional integrators 

<math display="inline" id="Tricubic_interpolation:17">
 <semantics>
  <msub>
   <mi>CINT</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>CINT</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{CINT}_{x}
  </annotation>
 </semantics>
</math>

 performs extremely poorly for repeated interpolations because each computational step must be repeated for each new location.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Cubic_interpolation" title="wikilink">Cubic interpolation</a></li>
<li><a href="Bicubic_interpolation" title="wikilink">Bicubic interpolation</a></li>
<li><a href="Trilinear_interpolation" title="wikilink">Trilinear interpolation</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.paulinternet.nl/?page=bicubic">Java/C++ implementation of tricubic interpolation</a></li>
<li><a href="http://github.com/deepzot/likely/blob/master/likely/TriCubicInterpolator.h">C++ implementation of tricubic interpolation</a></li>
<li><a href="http://github.com/danielguterding/pytricubic">Python implementation</a></li>
</ul>

<p>"</p>

<p><a href="Category:Multivariate_interpolation" title="wikilink">Category:Multivariate interpolation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.89.7835">Tricubic Interpolation in Three Dimensions (2005), by F. Lekien, J. Marsden, Journal of Numerical Methods and Engineering</a><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.89.7835">Tricubic Interpolation in Three Dimensions (2005), by F. Lekien, J. Marsden, Journal of Numerical Methods and Engineering</a><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

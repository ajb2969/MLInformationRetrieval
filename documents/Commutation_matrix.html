<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1330">Commutation matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Commutation matrix</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, especially in <a href="linear_algebra" title="wikilink">linear algebra</a> and <a href="Matrix_(mathematics)" title="wikilink">matrix theory</a>, the <strong>commutation matrix</strong> is used for transforming the vectorized form of a <a href="matrix_(mathematics)" title="wikilink">matrix</a> into the vectorized form of its <a class="uri" href="transpose" title="wikilink">transpose</a>. Specifically, the commutation matrix <strong>K</strong><sup>(m,n)</sup> is the <em>mn √ó mn</em> matrix which, for any <em>m √ó n</em> matrix <strong>A</strong>, transforms vec(<strong>A</strong>) into vec(<strong>A</strong><sup>T</sup>):</p>
<dl>
<dd><strong>K</strong><sup>(m,n)</sup> vec(<strong>A</strong>) = vec(<strong>A</strong><sup>T</sup>) .
</dd>
</dl>

<p>Here vec(<strong>A</strong>) is the <em>mn √ó 1</em> <a href="column_vector" title="wikilink">column vector</a> obtain by stacking the columns of <strong>A</strong> on top of one another:</p>
<dl>
<dd>vec(<strong>A</strong>) = [ <strong>A</strong><sub>1,1</sub>, ..., <strong>A</strong><sub>m,1</sub>, <strong>A</strong><sub>1,2</sub>, ..., <strong>A</strong><sub>m,2</sub>, ..., <strong>A</strong><sub>1,n</sub>, ..., <strong>A</strong><sub>m,n</sub> ]<sup>T</sup>
</dd>
</dl>

<p>where <strong>A</strong> = [<strong>A</strong><sub>i,j</sub>].</p>

<p>The commutation matrix is a special type of <a href="permutation_matrix" title="wikilink">permutation matrix</a>, and is therefore <a href="orthogonal_matrix" title="wikilink">orthogonal</a>. Replacing <strong>A</strong> with <strong>A</strong><sup>T</sup> in the definition of the commutation matrix shows that <strong>K</strong><sup>(m,n)</sup> = (<strong>K</strong><sup>(n,m)</sup>)<sup>T</sup>. Therefore in the special case of <strong>m = n</strong> the commutation matrix is an <a href="involution_(mathematics)#Linear_Algebra" title="wikilink">involution</a> and <a href="symmetric_matrix" title="wikilink">symmetric</a>.</p>

<p>The main use of the commutation matrix, and the source of its name, is to commute the <a href="Kronecker_product" title="wikilink">Kronecker product</a>: for every <em>m √ó n</em> matrix <strong>A</strong> and every <em>r √ó q</em> matrix <strong>B</strong>,</p>
<dl>
<dd><strong>K</strong><sup>(r,m)</sup>(<strong>A</strong> 

<math display="inline" id="Commutation_matrix:0">
 <semantics>
  <mo>‚äó</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">tensor-product</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \otimes
  </annotation>
 </semantics>
</math>

 <strong>B</strong>)<strong>K</strong><sup>(n,q)</sup> = <strong>B</strong> 

<math display="inline" id="Commutation_matrix:1">
 <semantics>
  <mo>‚äó</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">tensor-product</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \otimes
  </annotation>
 </semantics>
</math>

 <strong>A</strong>.
</dd>
</dl>

<p>An explicit form for the commutation matrix is as follows: if <strong>e</strong><sub>r,j</sub> denotes the j-th canonical vector of dimension <em>r</em> (i.e. the vector with 1 in the j-th coordinate and 0 elsewhere) then</p>
<dl>
<dd><strong>K</strong><sup>(r,m)</sup> = 

<math display="inline" id="Commutation_matrix:2">
 <semantics>
  <msubsup>
   <mo largeop="true" symmetric="true">‚àë</mo>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mi>r</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{r}
  </annotation>
 </semantics>
</math>



<math display="inline" id="Commutation_matrix:3">
 <semantics>
  <msubsup>
   <mo largeop="true" symmetric="true">‚àë</mo>
   <mrow>
    <mi>j</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mi>m</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <eq></eq>
      <ci>j</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=1}^{m}
  </annotation>
 </semantics>
</math>

<strong>e</strong><sub>r,i</sub><strong>e</strong><sub>m,j</sub><sup>T</sup>

<math display="inline" id="Commutation_matrix:4">
 <semantics>
  <mo>‚äó</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">tensor-product</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \otimes
  </annotation>
 </semantics>
</math>

<strong>e</strong><sub>m,j</sub><strong>e</strong><sub>r,i</sub><sup>T</sup>.
</dd>
</dl>
<h2 id="example">Example</h2>

<p>Let <em>M</em> be a 2x2 square matrix.</p>

<p>

<math display="inline" id="Commutation_matrix:5">
 <semantics>
  <mrow>
   <mi>ùêå</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mi>a</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>b</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>c</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>d</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêå</ci>
    <matrix>
     <matrixrow>
      <ci>a</ci>
      <ci>b</ci>
     </matrixrow>
     <matrixrow>
      <ci>c</ci>
      <ci>d</ci>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}=\begin{bmatrix}a&b\\
c&d\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Then we have</p>

<p>

<math display="inline" id="Commutation_matrix:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>v</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêå</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mi>a</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>c</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>b</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>d</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>v</ci>
     <ci>e</ci>
     <ci>c</ci>
     <ci>ùêå</ci>
    </apply>
    <matrix>
     <matrixrow>
      <ci>a</ci>
     </matrixrow>
     <matrixrow>
      <ci>c</ci>
     </matrixrow>
     <matrixrow>
      <ci>b</ci>
     </matrixrow>
     <matrixrow>
      <ci>d</ci>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   vec(\mathbf{M})=\begin{bmatrix}a\\
c\\
b\\
d\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>And <strong>K</strong><sup>(2,2)</sup> is the 4x4 square matrix that will transform vec(<strong>M</strong>) into vec(<strong>M</strong><sup>T</sup>)</p>

<p>

<math display="inline" id="Commutation_matrix:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mo>‚ãÖ</mo>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>c</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>d</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mi>a</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>b</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>c</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>d</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>v</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>ùêå</mi>
      <mi>T</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <ci>a</ci>
       </matrixrow>
       <matrixrow>
        <ci>c</ci>
       </matrixrow>
       <matrixrow>
        <ci>b</ci>
       </matrixrow>
       <matrixrow>
        <ci>d</ci>
       </matrixrow>
      </matrix>
     </apply>
     <matrix>
      <matrixrow>
       <ci>a</ci>
      </matrixrow>
      <matrixrow>
       <ci>b</ci>
      </matrixrow>
      <matrixrow>
       <ci>c</ci>
      </matrixrow>
      <matrixrow>
       <ci>d</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>v</ci>
      <ci>e</ci>
      <ci>c</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùêå</ci>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}1&0&0&0\\
0&0&1&0\\
0&1&0&0\\
0&0&0&1\\
\end{bmatrix}\cdot\begin{bmatrix}a\\
c\\
b\\
d\\
\end{bmatrix}=\begin{bmatrix}a\\
b\\
c\\
d\\
\end{bmatrix}=vec(\mathbf{M}^{T})
  </annotation>
 </semantics>
</math>

</p>
<h2 id="references">References</h2>

<p>Jan R. Magnus and Heinz Neudecker (1988), <em>Matrix Differential Calculus with Applications in Statistics and Econometrics</em>, Wiley.</p>

<p>"</p>

<p><a href="Category:Linear_algebra" title="wikilink">Category:Linear algebra</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a></p>
</body>
</html>

   Partial trace      Partial trace   In linear algebra and functional analysis , the partial trace is a generalization of the trace . Whereas the trace is a scalar valued function on operators, the partial trace is an operator-valued function. The partial trace has applications in quantum information and decoherence which is relevant for quantum measurement and thereby to the decoherent approaches to interpretations of quantum mechanics , including consistent histories and the relative state interpretation .  Details  Suppose   V   V   V   ,   W   W   W   are finite-dimensional vector spaces over a field , with dimensions    m   m   m   and   n   n   n   , respectively. For any space   A   A   A   let    L   (  A  )       L  A    L(A)   denote the space of linear operators on   A   A   A   . The partial trace over   W   W   W   ,     Tr  W   :    L   (   V  ⊗  W   )    →   L   (  V  )        normal-:   subscript  Tr  W    normal-→   normal-L   tensor-product  V  W     normal-L  V      \operatorname{Tr}_{W}:\operatorname{L}(V\otimes W)\to\operatorname{L}(V)   , is a mapping      T  ∈   L   (   V  ⊗  W   )    ↦    Tr  W    (  T  )    ∈   L   (  V  )          T   normal-L   tensor-product  V  W      maps-to      subscript  Tr  W   T         normal-L  V      T\in\operatorname{L}(V\otimes W)\mapsto\operatorname{Tr}_{W}(T)\in%
 \operatorname{L}(V)     It is defined as follows: let       e  1   ,  …  ,   e  m       subscript  e  1   normal-…   subscript  e  m     e_{1},\ldots,e_{m}     and       f  1   ,  …  ,   f  n       subscript  f  1   normal-…   subscript  f  n     f_{1},\ldots,f_{n}     be bases for V and W respectively; then T has a matrix representation         {   a    k  ℓ   ,   i  j     }   1   ≤  k   ,    i  ≤  m   ,    1  ≤  ℓ   ,   j  ≤  n        formulae-sequence       subscript  a     k  normal-ℓ     i  j      1   k    formulae-sequence    i  m    formulae-sequence    1  normal-ℓ     j  n       \{a_{k\ell,ij}\}\quad 1\leq k,i\leq m,\quad 1\leq\ell,j\leq n     relative to the basis       e  k   ⊗   f  ℓ      tensor-product   subscript  e  k    subscript  f  normal-ℓ     e_{k}\otimes f_{\ell}     of      V  ⊗  W     tensor-product  V  W    V\otimes W   .  Now for indices k , i in the range 1, ..., m , consider the sum        b   k  ,  i    =    ∑   j  =  1   n    a    k  j   ,   i  j       .       subscript  b   k  i      superscript   subscript     j  1    n    subscript  a     k  j     i  j        b_{k,i}=\sum_{j=1}^{n}a_{kj,ij}.     This gives a matrix b k , i . The associated linear operator on V is independent of the choice of bases and is by definition the partial trace .  Among physicists, this is often called "tracing out" or "tracing over" W to leave only an operator on V in the context where W and V are Hilbert spaces associated with quantum systems (see below).  Invariant definition  The partial trace operator can be defined invariantly (that is, without reference to a basis) as follows: it is the unique linear operator       Tr  W   :    L   (   V  ⊗  W   )    →   L   (  V  )        normal-:   subscript  Tr  W    normal-→   normal-L   tensor-product  V  W     normal-L  V      \operatorname{Tr}_{W}:\operatorname{L}(V\otimes W)\rightarrow\operatorname{L}(V)   such that          Tr  W    (   R  ⊗  S   )    =    R    Tr   (  S  )         ∀  R   ∈   L   (  V  )       ∀  S   ∈   L   (  W  )       .     formulae-sequence      subscript  Tr  W    tensor-product  R  S      R   Tr  S      formulae-sequence     for-all  R    normal-L  V       for-all  S    normal-L  W       \operatorname{Tr}_{W}(R\otimes S)=R\,\operatorname{Tr}(S)\quad\forall R\in%
 \operatorname{L}(V)\quad\forall S\in\operatorname{L}(W).   To see that the conditions above determine the partial trace uniquely, let     v  1   ,  …  ,   v  m       subscript  v  1   normal-…   subscript  v  m     v_{1},\ldots,v_{m}   form a basis for   V   V   V   , let     w  1   ,  …  ,   w  n       subscript  w  1   normal-…   subscript  w  n     w_{1},\ldots,w_{n}   form a basis for   W   W   W   , let     E   i  j    :   V  →  V      normal-:   subscript  E    i  j     normal-→  V  V     E_{ij}\colon V\to V   be the map that sends    v  i     subscript  v  i    v_{i}   to    v  j     subscript  v  j    v_{j}   (and all other basis elements to zero), and let     F   k  l    :   W  →  W      normal-:   subscript  F    k  l     normal-→  W  W     F_{kl}\colon W\to W   be the map that sends    w  k     subscript  w  k    w_{k}   to    w  l     subscript  w  l    w_{l}   . Since the vectors     v  i   ⊗   w  k      tensor-product   subscript  v  i    subscript  w  k     v_{i}\otimes w_{k}   form a basis for    V  ⊗  W     tensor-product  V  W    V\otimes W   , the maps     E   i  j    ⊗   F   k  l       tensor-product   subscript  E    i  j     subscript  F    k  l      E_{ij}\otimes F_{kl}   form a basis for    L   (   V  ⊗  W   )      normal-L   tensor-product  V  W     \operatorname{L}(V\otimes W)   .  From this abstract definition, the following properties follow:        Tr  W    (   I   V  ⊗  W    )    =   dim    W    I  V           subscript  Tr  W    subscript  I   tensor-product  V  W      dimension    W   subscript  I  V       \operatorname{Tr}_{W}(I_{V\otimes W})=\dim W\ I_{V}             Tr  W    (   T   (    I  V   ⊗  S   )    )    =    Tr  W    (    (    I  V   ⊗  S   )   T   )        ∀  S   ∈   L   (  W  )       ∀  T   ∈   L   (   V  ⊗  W   )       .     formulae-sequence      subscript  Tr  W     T   tensor-product   subscript  I  V   S       subscript  Tr  W      tensor-product   subscript  I  V   S   T      formulae-sequence     for-all  S    normal-L  W       for-all  T    normal-L   tensor-product  V  W        \operatorname{Tr}_{W}(T(I_{V}\otimes S))=\operatorname{Tr}_{W}((I_{V}\otimes S%
 )T)\quad\forall S\in\operatorname{L}(W)\quad\forall T\in\operatorname{L}(V%
 \otimes W).     Category theoretic notion  It is the partial trace of linear transformations that is the subject of Joyal, Street, and Verity's notion of Traced monoidal category . A traced monoidal category is a monoidal category    (  C  ,  ⊗  ,  I  )     C  tensor-product  I    (C,\otimes,I)   together with, for objects X, Y, U in the category, a function of Hom-sets,       Tr   X  ,  Y   U   :     Hom  C    (   X  ⊗  U   ,   Y  ⊗  U   )    →    Hom  C    (  X  ,  Y  )        normal-:   subscript   superscript  Tr  U    X  Y     normal-→    subscript  Hom  C    tensor-product  X  U    tensor-product  Y  U      subscript  Hom  C   X  Y      \operatorname{Tr}^{U}_{X,Y}\colon\operatorname{Hom}_{C}(X\otimes U,Y\otimes U)%
 \to\operatorname{Hom}_{C}(X,Y)   satisfying certain axioms.  Another case of this abstract notion of partial trace takes place in the category of finite sets and bijections between them, in which the monoidal product is disjoint union. One can show that for any finite sets, X,Y,U and bijection     X  +  U   ≅   Y  +  U         X  U     Y  U     X+U\cong Y+U   there exists a corresponding "partially traced" bijection    X  ≅  Y      X  Y    X\cong Y   .  Partial trace for operators on Hilbert spaces  The partial trace generalizes to operators on infinite dimensional Hilbert spaces. Suppose V , W are Hilbert spaces, and let       {   f  i   }    i  ∈  I      subscript    subscript  f  i      i  I     \{f_{i}\}_{i\in I}     be an orthonormal basis for W . Now there is an isometric isomorphism        ⊕   ℓ  ∈  I     (    V  ⊗  ℂ    f  ℓ    )    →   V  ⊗  W      normal-→    subscript  direct-sum    normal-ℓ  I       tensor-product  V  ℂ    subscript  f  normal-ℓ      tensor-product  V  W     \bigoplus_{\ell\in I}(V\otimes\mathbb{C}f_{\ell})\rightarrow V\otimes W     Under this decomposition, any operator    T  ∈   L   (   V  ⊗  W   )        T   normal-L   tensor-product  V  W      T\in\operatorname{L}(V\otimes W)   can be regarded as an infinite matrix of operators on V       [      T  11      T  12     …     T   1  j      …       T  21      T  22     …     T   2  j      …      ⋮    ⋮       ⋮       T   k  1       T   k  2      …     T   k  j      …      ⋮    ⋮       ⋮     ]   ,       subscript  T  11    subscript  T  12   normal-…   subscript  T    1  j    normal-…     subscript  T  21    subscript  T  22   normal-…   subscript  T    2  j    normal-…    normal-⋮  normal-⋮  absent  normal-⋮     subscript  T    k  1     subscript  T    k  2    normal-…   subscript  T    k  j    normal-…    normal-⋮  normal-⋮  absent  normal-⋮     \begin{bmatrix}T_{11}&T_{12}&\ldots&T_{1j}&\ldots\\
 T_{21}&T_{22}&\ldots&T_{2j}&\ldots\\
 \vdots&\vdots&&\vdots\\
 T_{k1}&T_{k2}&\ldots&T_{kj}&\ldots\\
 \vdots&\vdots&&\vdots\end{bmatrix},     where     T   k  ℓ    ∈   L   (  V  )         subscript  T    k  normal-ℓ     normal-L  V     T_{k\ell}\in\operatorname{L}(V)   .  First suppose T is a non-negative operator. In this case, all the diagonal entries of the above matrix are non-negative operators on V . If the sum       ∑  ℓ    T   ℓ  ℓ        subscript   normal-ℓ    subscript  T    normal-ℓ  normal-ℓ      \sum_{\ell}T_{\ell\ell}     converges in the strong operator topology of L( V ), it is independent of the chosen basis of W . The partial trace Tr W ( T ) is defined to be this operator. The partial trace of a self-adjoint operator is defined if and only if the partial traces of the positive and negative parts are defined.  Computing the partial trace  Suppose W has an orthonormal basis, which we denote by ket vector notation as     {   |  ℓ  ⟩   }   ℓ     subscript    ket  normal-ℓ    normal-ℓ    \{|\ell\rangle\}_{\ell}   . Then         Tr  W    (    ∑   k  ,  ℓ        T   k  ℓ     ⊗   |  k  ⟩     ⟨  ℓ  |     )    =    ∑  j    T   j  j      .        subscript  Tr  W     subscript    k  normal-ℓ       tensor-product   subscript  T    k  normal-ℓ     ket  k     bra  normal-ℓ        subscript   j    subscript  T    j  j       \operatorname{Tr}_{W}\left(\sum_{k,\ell}T_{k\ell}\,\otimes\,|k\rangle\langle%
 \ell|\right)=\sum_{j}T_{jj}.     Partial trace and invariant integration  In the case of finite dimensional Hilbert spaces, there is a useful way of looking at partial trace involving integration with respect to a suitably normalized Haar measure μ over the unitary group U( W ) of W . Suitably normalized means that μ is taken to be a measure with total mass dim( W ).  Theorem . Suppose V , W are finite dimensional Hilbert spaces. Then       ∫   U   (  W  )       (    I  V   ⊗   U  *    )   T   (    I  V   ⊗  U   )   d  μ   (  U  )        subscript    normal-U  W       tensor-product   subscript  I  V    superscript  U     T   tensor-product   subscript  I  V   U   d  μ  U     \int_{\operatorname{U}(W)}(I_{V}\otimes U^{*})T(I_{V}\otimes U)\ d\mu(U)     commutes with all operators of the form     I  V   ⊗  S     tensor-product   subscript  I  V   S    I_{V}\otimes S   and hence is uniquely of the form    R  ⊗   I  W      tensor-product  R   subscript  I  W     R\otimes I_{W}   . The operator R is the partial trace of T .  Partial trace as a quantum operation  The partial trace can be viewed as a quantum operation . Consider a quantum mechanical system whose state space is the tensor product     H  A   ⊗   H  B      tensor-product   subscript  H  A    subscript  H  B     H_{A}\otimes H_{B}   of Hilbert spaces. A mixed state is described by a density matrix ρ, that is a non-negative trace-class operator of trace 1 on the tensor product      H  A   ⊗   H  B    .     tensor-product   subscript  H  A    subscript  H  B     H_{A}\otimes H_{B}.   The partial trace of ρ with respect to the system B , denoted by    ρ  A     superscript  ρ  A    \rho^{A}   , is called the reduced state of ρ on system A . In symbols,        ρ  A   =    Tr  B   ρ    .       superscript  ρ  A     subscript  Tr  B   ρ     \rho^{A}=\operatorname{Tr}_{B}\rho.     To show that this is indeed a sensible way to assign a state on the A subsystem to ρ, we offer the following justification. Let M be an observable on the subsystem A , then the corresponding observable on the composite system is    M  ⊗  I     tensor-product  M  I    M\otimes I   . However one chooses to define a reduced state    ρ  A     superscript  ρ  A    \rho^{A}   , there should be consistency of measurement statistics. The expectation value of M after the subsystem A is prepared in    ρ  A     superscript  ρ  A    \rho^{A}   and that of    M  ⊗  I     tensor-product  M  I    M\otimes I   when the composite system is prepared in ρ should be the same, i.e. the following equality should hold:        Tr   (   M  ⋅   ρ  A    )    =   Tr   (    M  ⊗  I   ⋅  ρ   )     .       Tr   normal-⋅  M   superscript  ρ  A      Tr   normal-⋅   tensor-product  M  I   ρ      \operatorname{Tr}(M\cdot\rho^{A})=\operatorname{Tr}(M\otimes I\cdot\rho).     We see that this is satisfied if    ρ  A     superscript  ρ  A    \rho^{A}   is as defined above via the partial trace. Furthermore it is the unique such operation.  Let T(H) be the Banach space of trace-class operators on the Hilbert space H . It can be easily checked that the partial trace, viewed as a map       Tr  B   :    T   (    H  A   ⊗   H  B    )    →   T   (   H  A   )        normal-:   subscript  Tr  B    normal-→    T   tensor-product   subscript  H  A    subscript  H  B       T   subscript  H  A       \operatorname{Tr}_{B}:T(H_{A}\otimes H_{B})\rightarrow T(H_{A})   is completely positive and trace-preserving.  The partial trace map as given above induces a dual map    Tr  B  *     superscript   subscript  Tr  B      \operatorname{Tr}_{B}^{*}   between the C*-algebras of bounded operators on     H   A     subscript  H  A    \;H_{A}   and     H  A   ⊗   H  B      tensor-product   subscript  H  A    subscript  H  B     H_{A}\otimes H_{B}   given by         Tr  B  *    (  A  )    =   A  ⊗  I    .        superscript   subscript  Tr  B     A    tensor-product  A  I     \operatorname{Tr}_{B}^{*}(A)=A\otimes I.       Tr  B  *     superscript   subscript  Tr  B      \operatorname{Tr}_{B}^{*}   maps observables to observables and is the Heisenberg picture representation of    Tr  B     subscript  Tr  B    \operatorname{Tr}_{B}   .  Comparison with classical case  Suppose instead of quantum mechanical systems, the two systems A and B are classical. The space of observables for each system are then abelian C*-algebras. These are of the form C ( X ) and C ( Y ) respectively for compact spaces X , Y . The state space of the composite system is simply          C   (  X  )    ⊗  C    (  Y  )    =   C   (   X  ×  Y   )     .         tensor-product    C  X   C   Y     C    X  Y      C(X)\otimes C(Y)=C(X\times Y).     A state on the composite system is a positive element ρ of the dual of C( X × Y ), which by the Riesz-Markov theorem corresponds to a regular Borel measure on X × Y . The corresponding reduced state is obtained by projecting the measure ρ to X . Thus the partial trace is the quantum mechanical equivalent of this operation.  "  Category:Linear algebra  Category:Functional analysis   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="239">Multislice</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Multislice</h1>
<hr/>

<p>The <strong>multislice</strong> algorithm is a method for the simulation of the interaction of an <a href="electron_beam" title="wikilink">electron beam</a> with matter, including all multiple elastic scattering effects. The method is reviewed in the book by Cowley.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The algorithm is used in the simulation of high resolution <a href="Transmission_electron_microscopy" title="wikilink">Transmission electron microscopy</a> micrographs, and serves as a useful tool for analyzing experimental images.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Here we describe relevant background information, the theoretical basis of the technique, approximations used, and several software packages that implement this technique. Moreover, we delineate some of the advantages and limitations of the technique and important considerations that need to be taken into account for real-world use.</p>
<h2 id="background">Background</h2>

<p>The multislice method has found wide application in electron crystallography. The mapping from a crystal structure to its image or diffraction pattern has been relatively well understood and documented. However, the reverse mapping from electron micrograph images to the crystal structure is generally more complicated. The fact that the images are two-dimensional projections of three-dimensional crystal structure it makes it tedious to compare these projections to all plausible crystal structures. Hence, the use of numerical techniques in simulating results for different crystal structure is integral to the field of electron microscopy and crystallography. Several software packages exist to simulate electron micrographs.</p>

<p>There are two widely used simulation techniques that exist in literature: the Bloch wave method, derived from Hans Bethe's original theoretical treatment of the Davisson-Germer experiment, and the multislice method. In this paper, we will primarily focus on the multislice method for simulation of diffraction patterns, including multiple elastic scattering effects. Most of the packages that exist implement the multislice algorithm along with Fourier analysis to incorporate electron lens aberration effects to determine electron microscope image and address aspects such as phase contract and diffraction contrast. For electron microscope samples in the form of a thin crystalline slab in the transmission geometry, the aim of these software packages is to provide a map of the crystal potential, however this inversion process is greatly complicated by the presence of multiple elastic scattering.</p>

<p>The first description of what is now known as the multislice theory was given in the classic paper by Cowley and Moodie .<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In this work, the authors describe scattering of electrons using a physical optics approach without invoking quantum mechanical arguments. Many other derivations of these iterative equations have since been given using alternative methods, such as Greens functions, differential equations, scattering matrices or path integral methods.</p>

<p>A summary of the development of a computer algorithm from the multislice theory of Cowley and Moodie for numerical computation was reported by Goodman and Moodie.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> They also discussed in detail the relationship of the multislice to the other formulations. Specifically, using Zassenhaus's theorem, this paper gives the mathematical path from multislice to 1. Schroedingers equation (derived from the multislice), 2. Darwin's differential equations, widely used for diffraction contrast TEM image simulations - the Howie-Whelan equations derived from the multislice. 3. Sturkey's scattering matrix method. 4. the free-space propagation case, 5. The phase grating approximation, 6. A new "thick-phase grating" approximation, which has never been used, 7. Moodie's polynomial expression for multiple scattering, 8. The Feynman path-integral formulation, and 9. relationship of multislice to the Born series. The relationship between algorithms is summarized in Section 5.11 of Spence (2013),<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> (see Figure 5.9).</p>
<h2 id="theory">Theory</h2>

<p>The form of multislice algorithm presented here has been adapted from Peng, Dudarev and Whelan 2003.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The multislice algorithm is an approach to solving the Schr√∂dinger wave equation:</p>

<p>

<math display="inline" id="Multislice:0">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mstyle displaystyle="true">
         <mfrac>
          <msup>
           <mi mathvariant="normal">‚Ñè</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mn>2</mn>
           <mi>m</mi>
          </mrow>
         </mfrac>
        </mstyle>
        <mstyle displaystyle="true">
         <mfrac>
          <mrow>
           <mrow>
            <msup>
             <mo>‚àÇ</mo>
             <mn>2</mn>
            </msup>
            <mi mathvariant="normal">Œ®</mi>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mrow>
           <mo>‚àÇ</mo>
           <msup>
            <mi>x</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mfrac>
        </mstyle>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>V</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">Œ®</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mi>E</mi>
       <mi mathvariant="normal">Œ®</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <partialdiff></partialdiff>
            <cn type="integer">2</cn>
           </apply>
           <ci>normal-Œ®</ci>
          </apply>
          <interval closure="open">
           <ci>x</ci>
           <ci>t</ci>
          </interval>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>V</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>t</ci>
       </interval>
       <ci>normal-Œ®</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <ci>E</ci>
       <ci>normal-Œ®</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>t</ci>
       </interval>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle-\frac{\hbar^{2}}{2m}\frac{\partial^{2}\Psi(x,t)}{%
\partial x^{2}}+V(x,t)\Psi(x,t)&\displaystyle=E\Psi(x,t)\end{aligned}
  </annotation>
 </semantics>
</math>


</p>

<p>In 1957, Cowley and Moodie <a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> showed that the Schr√∂dinger equation can be solved analytically to evaluate the amplitudes of diffracted beam. Subsequently, the effects of dynamical diffraction can be calculated and the resulting simulated image will exhibit good similarities with the actual image taken from a microscope under dynamical conditions. Furthermore, the multislice algorithm does not make any assumption about the periodicity of the structure, as a result this method can be used to simulate HREM images of aperiodic systems as well.</p>

<p>The following section will include a mathematical formulation of the Multislice algorithm. The Schr√∂dinger equation can also be represented in the form of incident and scattered wave as:</p>

<p>

<math display="inline" id="Multislice:1">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi mathvariant="normal">Œ®</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùê´</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <msub>
         <mi mathvariant="normal">Œ®</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>ùê´</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mstyle displaystyle="true">
        <mrow>
         <mo largeop="true" symmetric="true">‚à´</mo>
         <mrow>
          <mi>G</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>ùê´</mi>
           <mo>,</mo>
           <msup>
            <mi>ùê´</mi>
            <mo>‚Ä≤</mo>
           </msup>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>V</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msup>
            <mi>ùê´</mi>
            <mo>‚Ä≤</mo>
           </msup>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi mathvariant="normal">Œ®</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msup>
            <mi>ùê´</mi>
            <mo>‚Ä≤</mo>
           </msup>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>d</mi>
          <msup>
           <mi>ùê´</mi>
           <mo>‚Ä≤</mo>
          </msup>
         </mrow>
        </mrow>
       </mstyle>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-Œ®</ci>
      <ci>ùê´</ci>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Œ®</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>ùê´</ci>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <ci>G</ci>
         <interval closure="open">
          <ci>ùê´</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê´</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </interval>
         <ci>V</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùê´</ci>
          <ci>normal-‚Ä≤</ci>
         </apply>
         <ci>normal-Œ®</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùê´</ci>
          <ci>normal-‚Ä≤</ci>
         </apply>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùê´</ci>
          <ci>normal-‚Ä≤</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\Psi({\mathbf{r}})&\displaystyle=\Psi_{0}({\mathbf%
{r}})+\int{G({\mathbf{r,r^{\prime}}})V({\mathbf{r^{\prime}}})\Psi({\mathbf{r^{%
\prime}}})d{\mathbf{r^{\prime}}}}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Multislice:2">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê´</mi>
    <mo>,</mo>
    <msup>
     <mi>ùê´</mi>
     <mo>‚Ä≤</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <ci>ùê´</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùê´</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\mathbf{r,r^{\prime}})
  </annotation>
 </semantics>
</math>

 is the Green‚Äôs function that represents the amplitude of the electron wave function at a point 

<math display="inline" id="Multislice:3">
 <semantics>
  <mi>ùê´</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê´</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r}
  </annotation>
 </semantics>
</math>

 due to a source at point 

<math display="inline" id="Multislice:4">
 <semantics>
  <msup>
   <mi>ùê´</mi>
   <mo>‚Ä≤</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ùê´</ci>
    <ci>normal-‚Ä≤</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r^{\prime}}
  </annotation>
 </semantics>
</math>

.</p>

<p>Hence for an incident plane wave of the form 

<math display="inline" id="Multislice:5">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œ®</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mi>ùê§</mi>
      </mrow>
      <mo>‚ãÖ</mo>
      <mi>ùê´</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Œ®</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>ùê§</ci>
      </apply>
      <ci>ùê´</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi(r)=\exp(i\mathbf{k\cdot r})
  </annotation>
 </semantics>
</math>

 the Schr√∂dinger equation can be written as:</p>

<p>

<math display="inline" id="Multislice:6">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi mathvariant="normal">Œ®</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùê´</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>i</mi>
           <mi>ùê§</mi>
          </mrow>
          <mo>‚ãÖ</mo>
          <mi>ùê´</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mstyle displaystyle="true">
         <mfrac>
          <mi>m</mi>
          <mrow>
           <mn>2</mn>
           <mi>œÄ</mi>
           <msup>
            <mi mathvariant="normal">‚Ñè</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mfrac>
        </mstyle>
        <mstyle displaystyle="true">
         <mrow>
          <mo largeop="true" symmetric="true">‚à´</mo>
          <mrow>
           <mfrac>
            <mrow>
             <mi>exp</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mrow>
                <mi>i</mi>
                <mi>k</mi>
               </mrow>
               <mo>‚ãÖ</mo>
               <mrow>
                <mo stretchy="false">|</mo>
                <mrow>
                 <mi>ùê´</mi>
                 <mo>-</mo>
                 <msup>
                  <mi>ùê´</mi>
                  <mo>‚Ä≤</mo>
                 </msup>
                </mrow>
                <mo stretchy="false">|</mo>
               </mrow>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mrow>
             <mo stretchy="false">|</mo>
             <mrow>
              <mi>ùê´</mi>
              <mo>-</mo>
              <msup>
               <mi>ùê´</mi>
               <mo>‚Ä≤</mo>
              </msup>
             </mrow>
             <mo stretchy="false">|</mo>
            </mrow>
           </mfrac>
           <mi>V</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>ùê´</mi>
             <mo>‚Ä≤</mo>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi mathvariant="normal">Œ®</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>ùê´</mi>
             <mo>‚Ä≤</mo>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi>d</mi>
           <msup>
            <mi>r</mi>
            <mo>‚Ä≤</mo>
           </msup>
          </mrow>
         </mrow>
        </mstyle>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>normal-Œ®</ci>
       <ci>ùê´</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <exp></exp>
        <apply>
         <ci>normal-‚ãÖ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>ùê§</ci>
         </apply>
         <ci>ùê´</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>m</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>œÄ</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <exp></exp>
            <apply>
             <ci>normal-‚ãÖ</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>k</ci>
             </apply>
             <apply>
              <abs></abs>
              <apply>
               <minus></minus>
               <ci>ùê´</ci>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <ci>ùê´</ci>
                <ci>normal-‚Ä≤</ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <abs></abs>
            <apply>
             <minus></minus>
             <ci>ùê´</ci>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>ùê´</ci>
              <ci>normal-‚Ä≤</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê´</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
          <ci>normal-Œ®</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê´</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>r</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\Psi({\mathbf{r}})=\exp(i{\mathbf{k\cdot r}})-%
\frac{m}{2\pi\hbar^{2}}\int\frac{\exp(ik\cdot{\mathbf{|r-r^{\prime}|}})}{{%
\mathbf{|r-r^{\prime}|}}}V({\mathbf{r^{\prime}}})\Psi({\mathbf{r^{\prime}}})dr%
^{\prime}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>We then choose the coordinate axis in such a way that the incident beam hits the sample at (0,0,0) in the 

<math display="inline" id="Multislice:7">
 <semantics>
  <mover accent="true">
   <mi>z</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{z}
  </annotation>
 </semantics>
</math>

-direction. Now we consider wave-function with a modulation function 

<math display="inline" id="Multislice:8">
 <semantics>
  <mrow>
   <mi>œï</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê´</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>œï</ci>
    <ci>ùê´</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi({\mathbf{r}})
  </annotation>
 </semantics>
</math>

 for the amplitude of the wave-function. Hence, the modulation function can be represented as:</p>

<p>

<math display="inline" id="Multislice:9">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>œï</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùê´</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mstyle displaystyle="true">
         <mfrac>
          <mi>m</mi>
          <mrow>
           <mn>2</mn>
           <mi>œÄ</mi>
           <msup>
            <mi mathvariant="normal">‚Ñè</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mfrac>
        </mstyle>
        <mstyle displaystyle="true">
         <mrow>
          <mo largeop="true" symmetric="true">‚à´</mo>
          <mrow>
           <mfrac>
            <mrow>
             <mi>exp</mi>
             <mrow>
              <mo stretchy="false">[</mo>
              <mrow>
               <mrow>
                <mi>i</mi>
                <mi>k</mi>
                <mrow>
                 <mo stretchy="false">|</mo>
                 <mrow>
                  <mi>ùê´</mi>
                  <mo>-</mo>
                  <msup>
                   <mi>ùê´</mi>
                   <mo>‚Ä≤</mo>
                  </msup>
                 </mrow>
                 <mo stretchy="false">|</mo>
                </mrow>
               </mrow>
               <mo>-</mo>
               <mrow>
                <mrow>
                 <mi>i</mi>
                 <mi>ùê§</mi>
                </mrow>
                <mo>‚ãÖ</mo>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <mrow>
                  <mi>ùê´</mi>
                  <mo>-</mo>
                  <msup>
                   <mi>ùê´</mi>
                   <mo>‚Ä≤</mo>
                  </msup>
                 </mrow>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
              <mo stretchy="false">]</mo>
             </mrow>
            </mrow>
            <mrow>
             <mo stretchy="false">|</mo>
             <mrow>
              <mi>ùê´</mi>
              <mo>-</mo>
              <msup>
               <mi>ùê´</mi>
               <mo>‚Ä≤</mo>
              </msup>
             </mrow>
             <mo stretchy="false">|</mo>
            </mrow>
           </mfrac>
           <mi>V</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>ùê´</mi>
             <mo>‚Ä≤</mo>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi>œï</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msup>
             <mi>ùê´</mi>
             <mo>‚Ä≤</mo>
            </msup>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi>d</mi>
           <msup>
            <mi>r</mi>
            <mo>‚Ä≤</mo>
           </msup>
          </mrow>
         </mrow>
        </mstyle>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>œï</ci>
      <ci>ùê´</ci>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <ci>m</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>œÄ</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <exp></exp>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>k</ci>
              <apply>
               <abs></abs>
               <apply>
                <minus></minus>
                <ci>ùê´</ci>
                <apply>
                 <csymbol cd="ambiguous">superscript</csymbol>
                 <ci>ùê´</ci>
                 <ci>normal-‚Ä≤</ci>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply>
              <ci>normal-‚ãÖ</ci>
              <apply>
               <times></times>
               <ci>i</ci>
               <ci>ùê§</ci>
              </apply>
              <apply>
               <minus></minus>
               <ci>ùê´</ci>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <ci>ùê´</ci>
                <ci>normal-‚Ä≤</ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <abs></abs>
            <apply>
             <minus></minus>
             <ci>ùê´</ci>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>ùê´</ci>
              <ci>normal-‚Ä≤</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <ci>V</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê´</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
          <ci>œï</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùê´</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>r</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\phi({\mathbf{r}})&\displaystyle=1-\frac{m}{2\pi%
\hbar^{2}}\int{\frac{\exp[ik|{\mathbf{r-r^{\prime}}}|-i{\mathbf{k}}\cdot({%
\mathbf{r-r^{\prime}}})]}{|{\mathbf{r-r^{\prime}}}|}V({\mathbf{r^{\prime}})%
\phi({\mathbf{r^{\prime}}})}dr^{\prime}}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>Now we make substitutions with regards to the coordinate system we have adhered.</p>

<p>

<math display="inline" id="Multislice:10">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>ùê§</mi>
      <mo>‚ãÖ</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>ùê´</mi>
        <mo>-</mo>
        <msup>
         <mi>ùê´</mi>
         <mo>‚Ä≤</mo>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>z</mi>
           <mo>-</mo>
           <msup>
            <mi>z</mi>
            <mo>‚Ä≤</mo>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>&</mo>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">|</mo>
        <mrow>
         <mi>ùê´</mi>
         <mo>-</mo>
         <msup>
          <mi>ùê´</mi>
          <mo>‚Ä≤</mo>
         </msup>
        </mrow>
        <mo stretchy="false">|</mo>
       </mrow>
       <mo>‚âà</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>z</mi>
          <mo>-</mo>
          <msup>
           <mi>z</mi>
           <mo>‚Ä≤</mo>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mrow>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>ùêó</mi>
             <mo>-</mo>
             <msup>
              <mi>ùêó</mi>
              <mo>‚Ä≤</mo>
             </msup>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>z</mi>
           <mo>-</mo>
           <msup>
            <mi>z</mi>
            <mo>‚Ä≤</mo>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <ci>ùê§</ci>
      <apply>
       <minus></minus>
       <ci>ùê´</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùê´</ci>
        <ci>normal-‚Ä≤</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <csymbol cd="latexml">absent</csymbol>
       <list>
        <apply>
         <times></times>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <ci>z</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </apply>
        </apply>
        <and></and>
       </list>
      </apply>
      <apply>
       <approx></approx>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <ci>ùê´</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ùê´</ci>
          <ci>normal-‚Ä≤</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>z</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>normal-‚Ä≤</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <minus></minus>
            <ci>ùêó</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ùêó</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <minus></minus>
          <ci>z</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle{\mathbf{k}}\cdot({\mathbf{r-r^{\prime}}})&%
\displaystyle=k(z-z^{\prime})\quad\&\quad|{\mathbf{r-r^{\prime}}}|\approx(z-z^%
{\prime})+({\mathbf{X-X^{\prime}}})^{2}/{2(z-z^{\prime})}\end{aligned}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Multislice:11">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>œï</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùê´</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mstyle displaystyle="true">
         <mfrac>
          <mi>œÄ</mi>
          <mrow>
           <mi>E</mi>
           <mi>Œª</mi>
          </mrow>
         </mfrac>
        </mstyle>
        <mstyle displaystyle="true">
         <mrow>
          <mo largeop="true" symmetric="true">‚à´</mo>
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">‚à´</mo>
            <mrow>
             <msup>
              <mi>z</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo>=</mo>
             <mrow>
              <mo>-</mo>
              <mi mathvariant="normal">‚àû</mi>
             </mrow>
            </mrow>
            <mrow>
             <msup>
              <mi>z</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo>=</mo>
             <mi>z</mi>
            </mrow>
           </munderover>
           <mrow>
            <mi>V</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msup>
              <mi>ùêó</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo>,</mo>
             <msup>
              <mi>z</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi>œï</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msup>
              <mi>ùêó</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo>,</mo>
             <msup>
              <mi>z</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo stretchy="false">)</mo>
            </mrow>
            <mfrac>
             <mn>1</mn>
             <mrow>
              <mi>i</mi>
              <mi>Œª</mi>
              <mrow>
               <mo stretchy="false">(</mo>
               <mrow>
                <mi>z</mi>
                <mo>-</mo>
                <msup>
                 <mi>z</mi>
                 <mo>‚Ä≤</mo>
                </msup>
               </mrow>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
            </mfrac>
            <mrow>
             <mi>exp</mi>
             <mrow>
              <mo>(</mo>
              <mrow>
               <mi>i</mi>
               <mi>k</mi>
               <mfrac>
                <msup>
                 <mrow>
                  <mo stretchy="false">|</mo>
                  <mrow>
                   <mi>ùêó</mi>
                   <mo>-</mo>
                   <msup>
                    <mi>ùêó</mi>
                    <mo>‚Ä≤</mo>
                   </msup>
                  </mrow>
                  <mo stretchy="false">|</mo>
                 </mrow>
                 <mn>2</mn>
                </msup>
                <mrow>
                 <mn>2</mn>
                 <mrow>
                  <mo stretchy="false">(</mo>
                  <mrow>
                   <mi>z</mi>
                   <mo>-</mo>
                   <msup>
                    <mi>z</mi>
                    <mo>‚Ä≤</mo>
                   </msup>
                  </mrow>
                  <mo stretchy="false">)</mo>
                 </mrow>
                </mrow>
               </mfrac>
              </mrow>
              <mo>)</mo>
             </mrow>
            </mrow>
            <mi>d</mi>
            <msup>
             <mi>ùêó</mi>
             <mo>‚Ä≤</mo>
            </msup>
            <mi>d</mi>
            <msup>
             <mi>z</mi>
             <mo>‚Ä≤</mo>
            </msup>
           </mrow>
          </mrow>
         </mrow>
        </mstyle>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>œï</ci>
       <ci>ùê´</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <divide></divide>
         <ci>œÄ</ci>
         <apply>
          <times></times>
          <ci>E</ci>
          <ci>Œª</ci>
         </apply>
        </apply>
        <apply>
         <int></int>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <eq></eq>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>z</ci>
              <ci>normal-‚Ä≤</ci>
             </apply>
             <apply>
              <minus></minus>
              <infinity></infinity>
             </apply>
            </apply>
           </apply>
           <apply>
            <eq></eq>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
            <ci>z</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>V</ci>
           <interval closure="open">
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ùêó</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
           </interval>
           <ci>œï</ci>
           <interval closure="open">
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ùêó</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
           </interval>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>Œª</ci>
             <apply>
              <minus></minus>
              <ci>z</ci>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>z</ci>
               <ci>normal-‚Ä≤</ci>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <exp></exp>
            <apply>
             <times></times>
             <ci>i</ci>
             <ci>k</ci>
             <apply>
              <divide></divide>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <abs></abs>
                <apply>
                 <minus></minus>
                 <ci>ùêó</ci>
                 <apply>
                  <csymbol cd="ambiguous">superscript</csymbol>
                  <ci>ùêó</ci>
                  <ci>normal-‚Ä≤</ci>
                 </apply>
                </apply>
               </apply>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <times></times>
               <cn type="integer">2</cn>
               <apply>
                <minus></minus>
                <ci>z</ci>
                <apply>
                 <csymbol cd="ambiguous">superscript</csymbol>
                 <ci>z</ci>
                 <ci>normal-‚Ä≤</ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>ùêó</ci>
            <ci>normal-‚Ä≤</ci>
           </apply>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <ci>normal-‚Ä≤</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\phi({\mathbf{r}})=1-i\frac{\pi}{E\lambda}\int\int%
\limits_{z^{\prime}=-\infty}^{z^{\prime}=z}V({\mathbf{X^{\prime}}},z^{\prime})%
\phi({\mathbf{X^{\prime}}},z^{\prime})\frac{1}{i\lambda(z-z^{\prime})}\exp%
\left(ik\frac{|{\mathbf{X-X^{\prime}}}|^{2}}{2(z-z^{\prime})}\right)d{\mathbf{%
X^{\prime}}}dz^{\prime}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>where, 

<math display="inline" id="Multislice:12">
 <semantics>
  <mrow>
   <mi>Œª</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>œÄ</mi>
    </mrow>
    <mo>/</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œª</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>œÄ</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda=2\pi/k
  </annotation>
 </semantics>
</math>

 is the wavelength of the electrons with energy 

<math display="inline" id="Multislice:13">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>E</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi mathvariant="normal">‚Ñè</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>k</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (E)=\hbar^{2}k^{2}/{2m}
  </annotation>
 </semantics>
</math>

</p>

<p>So far we have set up the mathematical formulation of wave mechanics without addressing the scattering in the material. The interaction constant is defined as</p>

<p>

<math display="inline" id="Multislice:14">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>œÉ</mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mi>œÄ</mi>
        <mo>/</mo>
        <mi>E</mi>
       </mrow>
       <mi>Œª</mi>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <ci>œÉ</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>œÄ</ci>
        <ci>E</ci>
       </apply>
       <ci>Œª</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\sigma=\pi/E\lambda\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>Further we also need to address the transverse spread which is done in terms of Fresnel propagation function</p>

<p>

<math display="inline" id="Multislice:15">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùêó</mi>
        <mo>,</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mstyle displaystyle="true">
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mi>i</mi>
          <mi>z</mi>
          <mi>Œª</mi>
         </mrow>
        </mfrac>
       </mstyle>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
          <mstyle displaystyle="true">
           <mfrac>
            <msup>
             <mi>ùêó</mi>
             <mn>2</mn>
            </msup>
            <mrow>
             <mn>2</mn>
             <mi>z</mi>
            </mrow>
           </mfrac>
          </mstyle>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>p</ci>
       <interval closure="open">
        <ci>ùêó</ci>
        <ci>z</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>z</ci>
         <ci>Œª</ci>
        </apply>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùêó</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle p({\mathbf{X}},z)=\frac{1}{iz\lambda}\exp\left(ik%
\frac{{\mathbf{X}}^{2}}{2z}\right)\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>In multislice simulation the thickness of each slice over which the iteration is performed is usually small and as a result within a slice the potential field can be approximated to be constant 

<math display="inline" id="Multislice:16">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>ùêó</mi>
     <mo>‚Ä≤</mo>
    </msup>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêó</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <ci>z</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V({\mathbf{X^{\prime}}},z)
  </annotation>
 </semantics>
</math>

. Subsequently, the modulation function can be represented as:</p>

<p>

<math display="inline" id="Multislice:17">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>œï</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùêó</mi>
        <mo>,</mo>
        <msub>
         <mi>z</mi>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mstyle displaystyle="true">
       <mrow>
        <mo largeop="true" symmetric="true">‚à´</mo>
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>ùêó</mi>
           <mo>-</mo>
           <msup>
            <mi>ùêó</mi>
            <mo>‚Ä≤</mo>
           </msup>
          </mrow>
          <mo>,</mo>
          <mrow>
           <msub>
            <mi>z</mi>
            <mrow>
             <mi>n</mi>
             <mo>+</mo>
             <mn>1</mn>
            </mrow>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>z</mi>
            <mi>n</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>œï</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>ùêó</mi>
          <mo>,</mo>
          <msub>
           <mi>z</mi>
           <mi>n</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mi>exp</mi>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mo>-</mo>
            <mrow>
             <mi>i</mi>
             <mi>œÉ</mi>
             <mrow>
              <munderover>
               <mo largeop="true" movablelimits="false" symmetric="true">‚à´</mo>
               <msub>
                <mi>z</mi>
                <mi>n</mi>
               </msub>
               <msub>
                <mi>z</mi>
                <mrow>
                 <mi>n</mi>
                 <mo>+</mo>
                 <mn>1</mn>
                </mrow>
               </msub>
              </munderover>
              <mrow>
               <mi>V</mi>
               <mrow>
                <mo stretchy="false">(</mo>
                <msup>
                 <mi>ùêó</mi>
                 <mo>‚Ä≤</mo>
                </msup>
                <mo>,</mo>
                <msup>
                 <mi>z</mi>
                 <mo>‚Ä≤</mo>
                </msup>
                <mo stretchy="false">)</mo>
               </mrow>
               <mi>d</mi>
               <msup>
                <mi>z</mi>
                <mo>‚Ä≤</mo>
               </msup>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mi>d</mi>
         <msup>
          <mi>X</mi>
          <mo>‚Ä≤</mo>
         </msup>
        </mrow>
       </mrow>
      </mstyle>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>œï</ci>
       <interval closure="open">
        <ci>ùêó</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </interval>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <ci>p</ci>
        <interval closure="open">
         <apply>
          <minus></minus>
          <ci>ùêó</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùêó</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>z</ci>
           <apply>
            <plus></plus>
            <ci>n</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>z</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </interval>
        <ci>œï</ci>
        <interval closure="open">
         <ci>ùêó</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <ci>n</ci>
         </apply>
        </interval>
        <apply>
         <exp></exp>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>œÉ</ci>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <int></int>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>z</ci>
               <ci>n</ci>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>z</ci>
              <apply>
               <plus></plus>
               <ci>n</ci>
               <cn type="integer">1</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <times></times>
             <ci>V</ci>
             <interval closure="open">
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>ùêó</ci>
               <ci>normal-‚Ä≤</ci>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>z</ci>
               <ci>normal-‚Ä≤</ci>
              </apply>
             </interval>
             <ci>d</ci>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>z</ci>
              <ci>normal-‚Ä≤</ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-‚Ä≤</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\phi({\mathbf{X}},z_{n+1})=\int p({\mathbf{X}}-{%
\mathbf{X^{\prime}}},z_{n+1}-z_{n})\phi({\mathbf{X}},z_{n})\exp\left(-i\sigma%
\int\limits_{z_{n}}^{z_{n+1}}V({\mathbf{X^{\prime}}},z^{\prime})dz^{\prime}%
\right)dX^{\prime}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>We can therefore represent the modulation function in the next slice</p>

<p>

<math display="inline" id="Multislice:18">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <msub>
       <mi>œï</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>=</mo>
      <mrow>
       <mi>œï</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùêó</mi>
        <mo>,</mo>
        <msub>
         <mi>z</mi>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <msub>
          <mi>q</mi>
          <mi>n</mi>
         </msub>
         <msub>
          <mi>œï</mi>
          <mi>n</mi>
         </msub>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mo>*</mo>
       <msub>
        <mi>p</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œï</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>œï</ci>
        <interval closure="open">
         <ci>ùêó</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </interval>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <share href="#.cmml">
       </share>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>œï</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\phi_{n+1}=\phi({\mathbf{X}},z_{n+1})=[q_{n}\phi_{%
n}]*p_{n}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>where, * represents convolution, 

<math display="inline" id="Multislice:19">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêó</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>z</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <interval closure="open">
      <ci>ùêó</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{n}=p({\mathbf{X}},z_{n+1}-z_{n})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Multislice:20">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <ci>n</ci>
    </apply>
    <ci>ùêó</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{n}({\mathbf{X}})
  </annotation>
 </semantics>
</math>

 defines the transmission function of the slice.</p>

<p>

<math display="inline" id="Multislice:21">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <msub>
        <mi>q</mi>
        <mi>n</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ùêó</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo stretchy="false">{</mo>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>i</mi>
          <mi>œÉ</mi>
          <mrow>
           <mstyle displaystyle="true">
            <munderover>
             <mo largeop="true" movablelimits="false" symmetric="true">‚à´</mo>
             <msub>
              <mi>z</mi>
              <mi>n</mi>
             </msub>
             <msub>
              <mi>z</mi>
              <mrow>
               <mi>n</mi>
               <mo>+</mo>
               <mn>1</mn>
              </mrow>
             </msub>
            </munderover>
           </mstyle>
           <mrow>
            <mi>V</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>ùêó</mi>
             <mo>,</mo>
             <msup>
              <mi>z</mi>
              <mo>‚Ä≤</mo>
             </msup>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi>d</mi>
            <msup>
             <mi>z</mi>
             <mo>‚Ä≤</mo>
            </msup>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">}</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>n</ci>
       </apply>
       <ci>ùêó</ci>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>œÉ</ci>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <int></int>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>z</ci>
             <ci>n</ci>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>z</ci>
            <apply>
             <plus></plus>
             <ci>n</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>V</ci>
           <interval closure="open">
            <ci>ùêó</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
           </interval>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <ci>normal-‚Ä≤</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle q_{n}({\mathbf{X}})=\exp\{-i\sigma\int\limits_{z_%
{n}}^{z_{n+1}}V({\mathbf{X}},z^{\prime})dz^{\prime}\}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>Hence, the iterative application of the aforementioned procedure will provide a full interpretation of the sample in context. Further, it should be reiterated that no assumptions have been made on the periodicity of the sample apart from assuming that the potential 

<math display="inline" id="Multislice:22">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <interval closure="open">
     <ci>ùêó</ci>
     <ci>z</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(\mathbf{X},z)
  </annotation>
 </semantics>
</math>

 is uniform within the slice. As a result, it is evident that this method in principle will work for any system. However, for aperiodic systems in which the potential will vary rapidly along the beam direction, the slice thickness has to be significantly small and hence will result in higher computational expense.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Data Points</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Multislice:23">
 <semantics>
  <msub>
   <mi>ùê•ùê®ùê†</mi>
   <mn>ùüê</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùê•ùê®ùê†</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{log_{2}}
  </annotation>
 </semantics>
</math>

N</p></th>
<th style="text-align: left;">
<p>Discrete FT</p></th>
<th style="text-align: left;">
<p>Fast FT</p></th>
<th style="text-align: left;">
<p>Ratio</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>64</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>4,096</p></td>
<td style="text-align: left;">
<p>384</p></td>
<td style="text-align: left;">
<p>10.7</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>128</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>16,384</p></td>
<td style="text-align: left;">
<p>896</p></td>
<td style="text-align: left;">
<p>18.3</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>256</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>65,536</p></td>
<td style="text-align: left;">
<p>2,048</p></td>
<td style="text-align: left;">
<p>32</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>512</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>262,144</p></td>
<td style="text-align: left;">
<p>4,608</p></td>
<td style="text-align: left;">
<p>56.9</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>1,024</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>1,048,576</p></td>
<td style="text-align: left;">
<p>10,240</p></td>
<td style="text-align: left;">
<p>102.4</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2,048</p></td>
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>4,194,304</p></td>
<td style="text-align: left;">
<p>22,528</p></td>
<td style="text-align: left;">
<p>186.2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Table 1 - Computational efficiency of Discrete Fourier Transform compared to Fast Fourier Transform</p></td>
</tr>
</tbody>
</table>
<h2 id="practical-considerations">Practical Considerations</h2>

<p>The basic premise is to calculate diffraction from each layer of atoms using Fast Fourier Transforms (FFT) and multiplying each by a phase grating term. The wave is then multiplied by a propagator, inverse Fourier Transformed, multiplied by a phase grating term yet again, and the process is repeated. The use of FFTs allows a significant computational advantage over the Bloch Wave method in particular, since the FFT algorithm involves 

<math display="inline" id="Multislice:24">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mrow>
    <mi>log</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <apply>
     <log></log>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\log N
  </annotation>
 </semantics>
</math>

 steps compared to the diagonalization problem of the Bloch wave solution which scales as 

<math display="inline" id="Multislice:25">
 <semantics>
  <msup>
   <mi>N</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>N</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N^{2}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Multislice:26">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the number of atoms in the system. (See Table 1 for comparison of computational time).</p>

<p>The most important step in performing a multislice calculation is setting up the unit cell and determining an appropriate slice thickness. In general, the unit cell usd for simulating images will be different from the unit cell that defines the crystal structure of a particular material. The primary reason for this due to aliasing effects which occur due wraparound errors in FFT calculations. The requirement to add additional ‚Äúpadding‚Äù to the unit cell has earned the nomenclature ‚Äúsuper cell‚Äù and the requirement to add these additional pixels to the basic unit cell comes at a computational price.</p>

<p>To illustrate the effect of choosing a slice thickness that is too thin, let us consider a simple example. The Fresnel propagator describes the propagation of electron waves in the z direction (the direction of the incident beam) in a solid:</p>

<p>

<math display="inline" id="Multislice:27">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>œï</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêÆ</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mover accent="true">
    <mi>œï</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêÆ</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo>=</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>œÄ</mi>
    <mi>i</mi>
    <mi>Œª</mi>
    <msup>
     <mi>ùêÆ</mi>
     <mn>2</mn>
    </msup>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>œï</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <ci>normal-~</ci>
     <ci>œï</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">z</csymbol>
     <eq></eq>
     <cn type="integer">0</cn>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">œÄ</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">Œª</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùêÆ</ci>
      <cn type="integer">2</cn>
     </apply>
     <csymbol cd="unknown">z</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{\phi}(\mathbf{u},z)=\tilde{\phi}(\mathbf{u},z=0)\exp(\pi i\lambda%
\mathbf{u}^{2}z)
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Multislice:28">
 <semantics>
  <mi>ùêÆ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêÆ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{u}
  </annotation>
 </semantics>
</math>

 is the reciprocal lattice coordinate, z is the depth in the sample, and lambda is the wavelength of the electron wave (related to the wave vector by the relation 

<math display="inline" id="Multislice:29">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>œÄ</mi>
    </mrow>
    <mo>/</mo>
    <mi>Œª</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>œÄ</ci>
     </apply>
     <ci>Œª</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=2\pi/\lambda
  </annotation>
 </semantics>
</math>

). Figure [fig:SliceThickness] shows vector diagram of the wave-fronts being diffracted by the atomic planes in the sample. In the case of the small-angle approximation (

<math display="inline" id="Multislice:30">
 <semantics>
  <mrow>
   <mi>Œ∏</mi>
   <mo>‚àº</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <ci>Œ∏</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta\sim
  </annotation>
 </semantics>
</math>

 100 mRad) we can approximate the phase shift as 

<math display="inline" id="Multislice:31">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mo>-</mo>
    <mi>S</mi>
   </mrow>
   <mo>‚âà</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Œî</mi>
      <mi>z</mi>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mi>cos</mi>
      <mi>Œ∏</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi mathvariant="normal">Œî</mi>
     <mi>z</mi>
     <mi>Œ∏</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <minus></minus>
     <ci>d</ci>
     <ci>S</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>normal-Œî</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <cos></cos>
       <ci>Œ∏</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Œî</ci>
      <ci>z</ci>
      <ci>Œ∏</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d-S\approx\Delta z/\cos\theta-\Delta z\theta
  </annotation>
 </semantics>
</math>

. For 100 mRad the difference is fleeting 

<math display="inline" id="Multislice:32">
 <semantics>
  <mrow>
   <mrow>
    <mi>cos</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0.01</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.99995</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <cos></cos>
     <cn type="float">0.01</cn>
    </apply>
    <cn type="float">0.99995</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos(0.01)=0.99995
  </annotation>
 </semantics>
</math>

 so 

<math display="inline" id="Multislice:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Œî</mi>
     <mi>z</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mi>cos</mi>
     <mi>Œ∏</mi>
    </mrow>
   </mrow>
   <mo>‚âà</mo>
   <mrow>
    <mi mathvariant="normal">Œî</mi>
    <mi>z</mi>
    <mi>Œ∏</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Œî</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <cos></cos>
      <ci>Œ∏</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Œî</ci>
     <ci>z</ci>
     <ci>Œ∏</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta z/\cos\theta\approx\Delta z\theta
  </annotation>
 </semantics>
</math>

. For small angles this approximation holds regardless of how many slices there are, although choosing a 

<math display="inline" id="Multislice:34">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Œî</mi>
   <mi>z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Œî</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta z
  </annotation>
 </semantics>
</math>

 greater than the lattice parameter (or half the lattice parameter in the case of perovskites) for a multislice simulation would be rather problematic.</p>
<figure><b>(Figure)</b>
<figcaption>MultisliceThickness</figcaption>
</figure>

<p>Additional practical concerns are how to effectively include effects such as inelastic and diffuse scattering, quantized excitations (e.g. plasmons, phonons, excitons), etc. There was one code that took these things into consideration through a coherence function approach <a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> called Yet Another Multislice (YAMS), but the code is no longer available either for download or purchase.</p>
<h2 id="available-software">Available Software</h2>

<p>There are several software packages available to perform multislice simulations of images. Among these is NCEMSS, NUMIS, MacTempas, and Kirkland . Other programs exist but unfortunately many have not been maintained (e.g. SHRLI81 by Mike O‚ÄôKeefe of Lawrence Berkeley National Lab and Cerius2 of Accerlys). A brief chronology of multislice codes is given in Table 2, although this is by no means exhaustive.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Code Name</p></th>
<th style="text-align: left;">
<p>Author</p></th>
<th style="text-align: left;">
<p>Year Released</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>SHRLI</p></td>
<td style="text-align: left;">
<p>O‚ÄôKeefe</p></td>
<td style="text-align: left;">
<p>1978</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>TEMPAS</p></td>
<td style="text-align: left;">
<p>Kilaas</p></td>
<td style="text-align: left;">
<p>1987</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>NUMIS</p></td>
<td style="text-align: left;">
<p>Marks</p></td>
<td style="text-align: left;">
<p>1987</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>NCEMSS</p></td>
<td style="text-align: left;">
<p>O‚ÄôKeefe &amp; Kilaas</p></td>
<td style="text-align: left;">
<p>1988</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>MacTEMPAS</p></td>
<td style="text-align: left;">
<p>Kilaas</p></td>
<td style="text-align: left;">
<p>1978</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>TEMSIM</p></td>
<td style="text-align: left;">
<p>Kirland</p></td>
<td style="text-align: left;">
<p>1988</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>HREMResearch</p></td>
<td style="text-align: left;">
<p>Ishizuka</p></td>
<td style="text-align: left;">
<p>2001</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>JEMS</p></td>
<td style="text-align: left;">
<p>Stadelmann</p></td>
<td style="text-align: left;">
<p>2004</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>JMULTIS</p></td>
<td style="text-align: left;">
<p>Zuo</p></td>
<td style="text-align: left;">
<p>1990</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Table 2 - Timeline of various Multislice Codes</p></td>
</tr>
</tbody>
</table>
<h2 id="acemjcstem">ACEM/JCSTEM</h2>

<p>This software is developed by Professor Earl Kirkland of Cornell University. This code is freely available as an interactive Java applet and as standalone code written in C/C++. The Java applet is ideal for a quick introduction and simulations under a basic incoherent linear imaging approximation. The ACEM code accompanies an excellent text of the same name by Kirkland which describes the background theory and computational techniques for simulating electron micrographs (including multislice) in detail. The main C/C++ routines use a command line interface (CLI) for automated batching of many simulation. The ACEM package also includes a graphical user interface that is more appropriate for beginners. The atomic scattering factors in ACEM are accurately characterized by a 12-parameter fit of Gaussians and Lorentzians to relativistic Hartree‚ÄìFock calculations. <a class="uri" href="http://people.ccmr.cornell.edu/~kirkland/">http://people.ccmr.cornell.edu/~kirkland/</a></p>
<h2 id="ncemss">NCEMSS</h2>

<p>This package was released from the National Center for High Resolution Electron Microscopy. This program uses a mouse-drive graphical user interface and is written by Dr. Roar Kilaas and Dr. Mike O‚ÄôKeefe of Lawrence Berkeley National Laboratory. While the code is no longer developed, the program is available through the Electron Direct Methods (EDM) package written by Professor Laurence Marks of Northwestern University. Debye-Waller factors can be included in as a parameter to account for diffuse scattering, although the accuracy is unclear (i.e. a good guess of the Debye-Waller factor is needed).</p>

<p><a class="uri" href="http://www.numis.northwestern.edu/edm/">http://www.numis.northwestern.edu/edm/</a></p>
<h2 id="numis">NUMIS</h2>

<p>The Northwestern University Multislice and Imaging System (NUMIS) is a package is written by Professor Laurence Marks of Northwestern University. It uses a command line interface (CLI) and is based in UNIX. A structure file must be provided as input in order to run use this code, which makes it ideal for advanced users. The NUMIS multislice programs use the conventional multislice algorithm by calculating the wavefunction of electrons at the bottom of a crystal and simulating the image taking into account various instrument-specific parameters including 

<math display="inline" id="Multislice:35">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{s}
  </annotation>
 </semantics>
</math>

 and convergence. This program is good to use if one already has structure files for a material that have been used in other calculations (for example, Density Functional Theory). These structure files can be used to general X-Ray structure factors which are then used as input for the PTBV routine in NUMIS. Microscope parameters can be changed through the MICROVB routine.</p>

<p><a class="uri" href="http://www.numis.northwestern.edu/ourwiki/index.php/Multislice">http://www.numis.northwestern.edu/ourwiki/index.php/Multislice</a></p>
<h2 id="mactempas">MacTempas</h2>

<p>This software is specifically developed to run in Mac OS X by Dr. Roar Kilaas of Lawrence Berkeley National Laboratory. It is designed to have a user-friendly user interface and has been well-maintained relative to many other codes (last update May 2013). It is available (for a fee) from <a class="uri" href="http://www.totalresolution.com">http://www.totalresolution.com</a>.</p>
<h2 id="jmultis">JMULTIS</h2>

<p>This is a software for multislice simulation was written in FORTRAN 77 by Dr. J. M. Zuo, while he was a postdoc research fellow at Arizona State University under the guidance of Prof. <a href="John_C._H._Spence" title="wikilink">John C. H. Spence</a>. The source code was published in the book of Electron Microdiffraction.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> A comparison between multislice and Bloch wave simulations for ZnTe was also published in the book. A separate comparison between several multislice algorithms at the year of 2000 was reported in <a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="qstem-quantitative-temstem-simulations">QSTEM: Quantitative TEM/STEM Simulations</h2>

<p>Electron and Ion Microscopy, written by Professor Christopher Koch of Ulm University in Germany. Allows simulation of HAADF, ADF, ABF-STEM, as well as conventional TEM and CBED. The executable and source code is available as a free download at the Koch group website: <a class="uri" href="http://elim.physik.uni-ulm.de/?page_id=834">http://elim.physik.uni-ulm.de/?page_id=834</a></p>
<h2 id="stem-cell">STEM-CELL</h2>

<p>This is a code written by Dr Vincenzo Grillo of the Institute for Nanoscience (CNR) in Italy. This code is essentially a graphical frontend to the multislice code written by Kirkland, with more additional features. These include tools to generate complex crystalline structures, simulate HAADF images and model the STEM probe, as well as modeling of strain in materials. Tools for image analysis (e.g. GPA) and filtering are also available. The code is updated quite often with new features and a user mailing list is maintained. Freely available at <a class="uri" href="http://tem-s3.nano.cnr.it/?page_id=2">http://tem-s3.nano.cnr.it/?page_id=2</a></p>
<h2 id="dr.-probe">DR. PROBE</h2>

<p>Multi-slice image simulations for high-resolution scanning and coherent imaging transmission electron microscopy written by Dr. Juri Barthel from the <a href="Ernst_Ruska-Centre" title="wikilink">Ernst Ruska-Centre</a> at the <a href="J√ºlich_Research_Centre" title="wikilink">J√ºlich Research Centre</a>. The software comprises a graphical user interface version for direct visualization of STEM image calculations, as well as a bundle of command-line modules for more comprehensive calculation tasks. The programs have been written using Visual C++, Fortran 90, and Perl. Executable binaries for Microsoft Windows 32-bit and 64-bit operating systems are available for free from the website: <a class="uri" href="http://www.er-c.org/barthel/drprobe/">http://www.er-c.org/barthel/drprobe/</a></p>
<h2 id="references">References</h2>

<p><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> </p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://people.ccmr.cornell.edu/~kirkland/">Multislice source code</a> (with tutorial) available under the <a href="GNU_General_Public_Licence" title="wikilink">GNU General Public Licence</a></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Microscopy" title="wikilink">Category:Microscopy</a> <a href="Category:Scientific_modeling" title="wikilink">Category:Scientific modeling</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4">P. Goodman and A. F. Moodie, Acta Cryst. 1974, A30, 280<a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
<li id="fn9">Electron Microdiffraction, <a href="John_C._H._Spence" title="wikilink">J.C. H. Spence</a> and J. M. Zuo, Plenum, New York, 1992<a href="#fnref9">‚Ü©</a></li>
<li id="fn10">Koch, C. and J.M. Zuo, ‚ÄúComparison of multislicecomputer programs for electron scattering simulations and the Bloch wavemethod‚Äù, Microscopy and Microanalysis,Vol. 6 Suppl. 2, 126-127, (2000).<a href="#fnref10">‚Ü©</a></li>
<li id="fn11"><a href="#fnref11">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

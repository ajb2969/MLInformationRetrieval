   Root of unity modulo n      Root of unity modulo n   In mathematics , namely ring theory , a k -th root of unity modulo n for positive integers  k , n ‚â•¬†2, is a solution x to the equation (or congruence )     x  k   ‚â°   1     (   mod  n   )         superscript  x  k    annotated  1   pmod  n      x^{k}\equiv 1\;\;(\mathop{{\rm mod}}n)   . If k is the smallest such exponent for x , then x is called a primitive k -th root of unity modulo n . 1 See modular arithmetic for notation and terminology.  Do not confuse this with a primitive element modulo n , where the primitive element must generate all units of the residue class ring      ‚Ñ§  /  n   ‚Ñ§        ‚Ñ§  n   ‚Ñ§    \mathbb{Z}/n\mathbb{Z}   by exponentiation. That is, there are always roots and primitive roots of unity modulo n for n ‚â•¬†2, but for some n there is no primitive element modulo n . Being a root or a primitive root modulo n always depends on the exponent k and the modulus n , whereas being a primitive element modulo n only depends on the modulus n ‚Äî the exponent is automatically    œÜ   (  n  )       œÜ  n    \varphi(n)   .  Roots of unity  Properties   If x is a k -th root of unity, then x is a unit (invertible) whose inverse is    x   k  -  1      superscript  x    k  1     x^{k-1}   . That is, x and n are coprime .  If x is a unit, then it is a (primitive) k -th root of unity modulo n , where k is the multiplicative order of x modulo n .  If x is a k -th root of unity and    x  -  1      x  1    x-1   is not a zero divisor , then      ‚àë   j  =  0    k  -  1     x  j    ‚â°   0     (   mod  n   )          superscript   subscript     j  0      k  1     superscript  x  j     annotated  0   pmod  n      \sum_{j=0}^{k-1}x^{j}\equiv 0\;\;(\mathop{{\rm mod}}n)   , because            (   x  -  1   )   ‚ãÖ    ‚àë   j  =  0    k  -  1     x  j     ‚â°    x  k   -  1   ‚â°   0     (   mod  n   )     .         normal-‚ãÖ    x  1     superscript   subscript     j  0      k  1     superscript  x  j        superscript  x  k   1         annotated  0   pmod  n       (x-1)\cdot\sum_{j=0}^{k-1}x^{j}\equiv x^{k}-1\equiv 0\;\;(\mathop{{\rm mod}}n).        Number of k -th roots  For the lack of a widely accepted symbol, we denote the number of k -th roots of unity modulo n by    f   (  n  ,  k  )       f   n  k     f(n,k)   . It satisfies a number of properties:        f   (  n  ,  1  )    =  1        f   n  1    1    f(n,1)=1   for    n  ‚â•  2      n  2    n\geq 2          f   (  n  ,   Œª   (  n  )    )    =   œÜ   (  n  )          f   n    Œª  n       œÜ  n     f(n,\lambda(n))=\varphi(n)   where Œª denotes the Carmichael function and   œÜ   œÜ   \varphi   denotes Euler's totient function      n  ‚Ü¶   f   (  n  ,  k  )       maps-to  n    f   n  k      n\mapsto f(n,k)   is a multiplicative function      k  ‚à£  l  ‚üπ  f   (  n  ,  k  )   ‚à£  f   (  n  ,  l  )      fragments  k  normal-‚à£  l   f   fragments  normal-(  n  normal-,  k  normal-)   normal-‚à£  f   fragments  normal-(  n  normal-,  l  normal-)     k\mid l\implies f(n,k)\mid f(n,l)   where the bar denotes divisibility       f   (  n  ,   lcm   (  a  ,  b  )    )    =   lcm   (   f   (  n  ,  a  )    ,   f   (  n  ,  b  )    )          f   n    lcm   a  b        lcm     f   n  a      f   n  b        f(n,\mathrm{lcm}(a,b))=\mathrm{lcm}(f(n,a),f(n,b))   where   lcm   lcm   \mathrm{lcm}   denotes the least common multiple  For prime    p   p   p   ,     ‚àÄ  i   ‚àà    ‚Ñï    ‚àÉ  j    ‚àà    ‚Ñï   f   (  n  ,   p  i   )    =   p  j          for-all  i     ‚Ñï    j           ‚Ñï  f   n   superscript  p  i           superscript  p  j      \forall i\in\mathbb{N}\ \exists j\in\mathbb{N}\ f(n,p^{i})=p^{j}   . The precise mapping from   i   i   i   to   j   j   j   is not known. If it were known, then together with the previous law it would yield a way to evaluate   f   f   f   quickly.   Primitive roots of unity  Properties   The maximum possible radix exponent for primitive roots modulo   n   n   n   is    Œª   (  n  )       Œª  n    \lambda(n)   , where Œª denotes the Carmichael function .  A radix exponent for a primitive root of unity is a divisor of    Œª   (  n  )       Œª  n    \lambda(n)   .  Every divisor   k   k   k   of    Œª   (  n  )       Œª  n    \lambda(n)   yields a primitive   k   k   k   -th root of unity. You can obtain one by choosing a    Œª   (  n  )       Œª  n    \lambda(n)   -th primitive root of unity (that must exist by definition of Œª), named   x   x   x   and compute the power    x    Œª   (  n  )    /  k      superscript  x      Œª  n   k     x^{\lambda(n)/k}   .  If x is a primitive k -th root of unity and also a (not necessarily primitive) ‚Ñì-th root of unity, then k is a divisor of ‚Ñì. This is true, because B√©zout's identity yields an integer linear combination of k and ‚Ñì equal to    gcd   (  k  ,  ‚Ñì  )       gcd   k  normal-‚Ñì     \mathrm{gcd}(k,\ell)   . Since k is minimal, it must be    k  =   gcd   (  k  ,  ‚Ñì  )        k    gcd   k  normal-‚Ñì      k=\mathrm{gcd}(k,\ell)   and    gcd   (  k  ,  ‚Ñì  )       gcd   k  normal-‚Ñì     \mathrm{gcd}(k,\ell)   is a divisor of ‚Ñì.   Number of primitive k -th roots  For the lack of a widely accepted symbol, we denote the number of primitive k -th roots of unity modulo n by    g   (  n  ,  k  )       g   n  k     g(n,k)   . It satisfies the following properties:        g   (  n  ,  k  )    =   {       >  0      if  k  ‚à£  Œª   (  n  )   ,       0     otherwise  .             g   n  k     cases    absent  0    fragments  if  k  normal-‚à£  Œª   fragments  normal-(  n  normal-)   normal-,   0  otherwise     g(n,k)=\begin{cases}>0&\text{if }k\mid\lambda(n),\\
 0&\text{otherwise}.\end{cases}     Consequently the function    k  ‚Ü¶   g   (  n  ,  k  )       maps-to  k    g   n  k      k\mapsto g(n,k)   has    d   (   Œª   (  n  )    )       d    Œª  n     d(\lambda(n))   values different from zero, where   d   d   d   computes the number of divisors .       g   (  n  ,  1  )    =  1        g   n  1    1    g(n,1)=1          g   (  4  ,  2  )    =  1        g   4  2    1    g(4,2)=1          g   (   2  n   ,  2  )    =  3        g    superscript  2  n   2    3    g(2^{n},2)=3   for    n  ‚â•  3      n  3    n\geq 3   , since -1 is always a square root of 1.       g   (   2  n   ,   2  k   )    =   2  k         g    superscript  2  n    superscript  2  k      superscript  2  k     g(2^{n},2^{k})=2^{k}   for    k  ‚àà   [  2  ,   n  -  1   )       k   2    n  1      k\in[2,n-1)          g   (  n  ,  2  )    =  1        g   n  2    1    g(n,2)=1   for    n  ‚â•  3      n  3    n\geq 3   and   n   n   n   in        ‚àë   k  ‚àà  ‚Ñï     g   (  n  ,  k  )     =   f   (  n  ,   Œª   (  n  )    )    =   œÜ   (  n  )            subscript     k  ‚Ñï      g   n  k       f   n    Œª  n            œÜ  n      \sum_{k\in\mathbb{N}}g(n,k)=f(n,\lambda(n))=\varphi(n)   with   œÜ   œÜ   \varphi   being Euler's totient function  The connection between   f   f   f   and   g   g   g   can be written in an elegant way using a Dirichlet convolution :         f  =   ùüô  *  g       f    1  g     f=\mathbb{1}*g   , i.e.     f   (  n  ,  k  )    =    ‚àë   d  ‚à£  k     g   (  n  ,  d  )           f   n  k      subscript    fragments  d  normal-‚à£  k      g   n  d       f(n,k)=\sum_{d\mid k}g(n,d)       You can compute values of   g   g   g   recursively from   f   f   f   using this formula, which is equivalent to the M√∂bius inversion formula .   Testing whether x is a primitive k -th root of unity modulo n  By fast exponentiation you can check that     x  k   ‚â°   1     (   mod  n   )         superscript  x  k    annotated  1   pmod  n      x^{k}\equiv 1\;\;(\mathop{{\rm mod}}n)   . If this is true, x is a k -th root of unity modulo n but not necessarily primitive. If it is not a primitive root, then there would be some divisor ‚Ñì of k , with     x  ‚Ñì   ‚â°   1     (   mod  n   )         superscript  x  normal-‚Ñì    annotated  1   pmod  n      x^{\ell}\equiv 1\;\;(\mathop{{\rm mod}}n)   . In order to exclude this possibility, one has only to check for a few ‚Ñì's equal k divided by a prime. That is, what needs to be checked is:         ‚àÄ   p   prime dividing   k    ,   x   k  /  p     ‚â¢   1     (   mod  n   )     .     not-equivalent-to    for-all    p  prime dividing  k     superscript  x    k  p      annotated  1   pmod  n      \forall p\text{ prime dividing}\ k,\quad x^{k/p}\not\equiv 1\;\;(\mathop{{\rm
 mod%
 }}n).     Finding a primitive k -th root of unity modulo n  Among the primitive k -th roots of unity, the primitive    Œª   (  n  )       Œª  n    \lambda(n)   -th roots are most frequent. It is thus recommended to try some integers for being a primitive    Œª   (  n  )       Œª  n    \lambda(n)   -th root, what will succeed quickly. For a primitive    Œª   (  n  )       Œª  n    \lambda(n)   -th root x , the number    x    Œª   (  n  )    /  k      superscript  x      Œª  n   k     x^{\lambda(n)/k}   is a primitive   k   k   k   -th root of unity. If k does not divide    Œª   (  n  )       Œª  n    \lambda(n)   , then there will be no k -th roots of unity, at all.  Finding multiple primitive k -th roots modulo n  Once you have a primitive k -th root of unity x , every power    x  l     superscript  x  l    x^{l}   is a   k   k   k   -th root of unity, but not necessarily a primitive one. The power    x  l     superscript  x  l    x^{l}   is a primitive   k   k   k   -th root of unity if and only if   k   k   k   and   l   l   l   are coprime . The proof is as follows: If    x  l     superscript  x  l    x^{l}   is not primitive, then there exists a divisor   m   m   m   of   k   k   k   with      (   x  l   )   m   ‚â°   1     (   mod  n   )         superscript   superscript  x  l   m    annotated  1   pmod  n      (x^{l})^{m}\equiv 1\;\;(\mathop{{\rm mod}}n)   , and since   k   k   k   and   l   l   l   are coprime, there exists an inverse    l   -  1      superscript  l    1     l^{-1}   of   l   l   l   modulo   k   k   k   . This yields    1  ‚â°    (    (   x  l   )   m   )    l   -  l     ‚â°    x  m      (   mod  n   )          1   superscript   superscript   superscript  x  l   m    superscript  l    l           annotated   superscript  x  m    pmod  n       1\equiv((x^{l})^{m})^{l^{-l}}\equiv x^{m}\;\;(\mathop{{\rm mod}}n)   , which means that   x   x   x   is not a primitive   k   k   k   -th root of unity because there is the smaller exponent   m   m   m   .  That is, by exponentiating x one can obtain    œÜ   (  k  )       œÜ  k    \varphi(k)   different primitive k -th roots of unity, but these may not be all such roots. However, finding all of them is not so easy.  Finding an n with a primitive k -th root of unity modulo n  You may want to know, in what integer residue class rings you have a primitive k -th root of unity. You need it for instance if you want to compute a Discrete Fourier Transform (more precisely a Number theoretic transform ) of a   k   k   k   -dimensional integer vector . In order to perform the inverse transform, you also need to divide by   k   k   k   , that is, k shall also be a unit modulo   n   n   n   .  A simple way to find such an n is to check for primitive k -th roots with respect to the moduli in the arithmetic progression      k  +  1   ,    2  k   +  1   ,    3  k   +  1   ,  ‚Ä¶       k  1       2  k   1       3  k   1   normal-‚Ä¶    k+1,2k+1,3k+1,\dots   . All of these moduli are coprime to k and thus k is a unit. According to Dirichlet's theorem on arithmetic progressions there are infinitely many primes in the progression, and for a prime   p   p   p   it holds     Œª   (  p  )    =   p  -  1         Œª  p     p  1     \lambda(p)=p-1   . Thus if     m  k   +  1        m  k   1    mk+1   is prime then     Œª   (    m  k   +  1   )    =   m  k         Œª      m  k   1      m  k     \lambda(mk+1)=mk   and thus you have primitive k -th roots of unity. But the test for primes is too strong, you may find other appropriate moduli.  Finding an n with multiple primitive roots of unity modulo n  If you want to have a modulus   n   n   n   such that there are primitive    k  1     subscript  k  1    k_{1}   -th,    k  2     subscript  k  2    k_{2}   -th, ...,    k  m     subscript  k  m    k_{m}   -th roots of unity modulo   n   n   n   , the following theorem reduces the problem to a simpler one:   For given   n   n   n   there are primitive    k  1     subscript  k  1    k_{1}   -th, ...,    k  m     subscript  k  m    k_{m}   -th roots of unity modulo   n   n   n   if and only if there is a primitive    lcm   (   k  1   ,  ‚Ä¶  ,   k  m   )       lcm    subscript  k  1   normal-‚Ä¶   subscript  k  m      \mathrm{lcm}(k_{1},...,k_{m})   -th root of unity modulo n .    Proof   Backward direction: If there is a primitive    lcm   (   k  1   ,  ‚Ä¶  ,   k  m   )       lcm    subscript  k  1   normal-‚Ä¶   subscript  k  m      \mathrm{lcm}(k_{1},...,k_{m})   -th root of unity modulo   n   n   n   called   x   x   x   , then    x    lcm   (   k  1   ,  ‚Ä¶  ,   k  m   )    /   k  l       superscript  x      lcm    subscript  k  1   normal-‚Ä¶   subscript  k  m      subscript  k  l      x^{\mathrm{lcm}(k_{1},\dots,k_{m})/k_{l}}   is a    k  l     subscript  k  l    k_{l}   -th root of unity modulo   n   n   n   .  Forward direction: If there are primitive    k  1     subscript  k  1    k_{1}   -th, ...,    k  m     subscript  k  m    k_{m}   -th roots of unity modulo   n   n   n   , then all exponents     k  1   ,  ‚Ä¶  ,   k  m       subscript  k  1   normal-‚Ä¶   subscript  k  m     k_{1},\dots,k_{m}   are divisors of    Œª   (  n  )       Œª  n    \lambda(n)   . This implies    lcm   (   k  1   ,  ‚Ä¶  ,   k  m   )   ‚à£  Œª   (  n  )      fragments  lcm   fragments  normal-(   subscript  k  1   normal-,  normal-‚Ä¶  normal-,   subscript  k  m   normal-)   normal-‚à£  Œª   fragments  normal-(  n  normal-)     \mathrm{lcm}(k_{1},\dots,k_{m})\mid\lambda(n)   and this in turn means there is a primitive    lcm   (   k  1   ,  ‚Ä¶  ,   k  m   )       lcm    subscript  k  1   normal-‚Ä¶   subscript  k  m      \mathrm{lcm}(k_{1},...,k_{m})   -th root of unity modulo   n   n   n   .  See also   Root of unity  Primitive root modulo n   References  "  Category:Modular arithmetic     ‚Ü©     
   Discrete Laplace operator      Discrete Laplace operator    For the discrete equivalent of the Laplace transform , see Z-transform .    In mathematics , the discrete Laplace operator is an analog of the continuous Laplace operator , defined so that it has meaning on a graph or a discrete grid . For the case of a finite-dimensional graph (having a finite number of edges and vertices), the discrete Laplace operator is more commonly called the Laplacian matrix .  The discrete Laplace operator occurs in physics problems such as the Ising model and loop quantum gravity , as well as in the study of discrete dynamical systems . It is also used in numerical analysis as a stand-in for the continuous Laplace operator. Common applications include image processing , where it is known as the Laplace filter , and in machine learning for clustering and semi-supervised learning on neighborhood graphs.  Definitions  Graph Laplacians  There are various definitions of the discrete Laplacian for graphs , differing by sign and scale factor (sometimes one averages over the neighboring vertices, other times one just sums; this makes no difference for a regular graph ). The traditional definition of the graph Laplacian, given below, corresponds to the negative continuous Laplacian on a domain with a free boundary.  Let    G  =   (  V  ,  E  )       G   V  E     G=(V,E)   be a graph with vertices   V   V   \scriptstyle V   and edges   E   E   \scriptstyle E   . Let    œï  :   V  ‚Üí  R      normal-:  œï   normal-‚Üí  V  R     \phi\colon V\to R   be a function of the vertices taking values in a ring . Then, the discrete Laplacian   Œî   normal-Œî   \Delta   acting on   œï   œï   \phi   is defined by        (   Œî  œï   )    (  v  )    =    ‚àë   w  :    d   (  w  ,  v  )    =  1      [    œï   (  v  )    -   œï   (  w  )     ]            normal-Œî  œï   v     subscript    normal-:  w      d   w  v    1      delimited-[]      œï  v     œï  w        (\Delta\phi)(v)=\sum_{w:\,d(w,v)=1}\left[\phi(v)-\phi(w)\right]\,     where    d   (  w  ,  v  )       d   w  v     d(w,v)   is the graph distance between vertices w and v. Thus, this sum is over the nearest neighbors of the vertex v . For a graph with a finite number of edges and vertices, this definition is identical to that of the Laplacian matrix . That is,   œï   œï   \phi   can be written as a column vector; and so    Œî  œï      normal-Œî  œï    \Delta\phi   is the product of the column vector and the Laplacian matrix, while     (   Œî  œï   )    (  v  )         normal-Œî  œï   v    (\Delta\phi)(v)   is just the v 'th entry of the product vector.  If the graph has weighted edges, that is, a weighting function    Œ≥  :   E  ‚Üí  R      normal-:  Œ≥   normal-‚Üí  E  R     \gamma\colon E\to R   is given, then the definition can be generalized to        (    Œî  Œ≥   œï   )    (  v  )    =    ‚àë   w  :    d   (  w  ,  v  )    =  1       Œ≥   w  v     [    œï   (  v  )    -   œï   (  w  )     ]              subscript  normal-Œî  Œ≥   œï   v     subscript    normal-:  w      d   w  v    1        subscript  Œ≥    w  v     delimited-[]      œï  v     œï  w         (\Delta_{\gamma}\phi)(v)=\sum_{w:\,d(w,v)=1}\gamma_{wv}\left[\phi(v)-\phi(w)\right]     where    Œ≥   w  v      subscript  Œ≥    w  v     \gamma_{wv}   is the weight value on the edge     w  v   ‚àà  E        w  v   E    wv\in E   .  Closely related to the discrete Laplacian is the averaging operator :         (   M  œï   )    (  v  )    =    1   deg  v      ‚àë   w  :    d   (  w  ,  v  )    =  1      œï   (  w  )       .          M  œï   v       1   degree  v      subscript    normal-:  w      d   w  v    1       œï  w       (M\phi)(v)=\frac{1}{\deg v}\sum_{w:\,d(w,v)=1}\phi(w).     Mesh Laplacians  In addition to considering the connectivity of nodes and edges in a graph, mesh laplace operators take into account the geometry of a surface (e.g. the angles at the nodes). For triangle meshes, for example, different discretizations exist, some of them are an extension of the graph operator, while other approaches are based on the finite element method (see below) and allow for higher order approximations. An overview on some mesh operators and a comparison is given in. 1  Finite Differences  Approximations of the Laplacian , obtained by the finite difference method or by the finite element method , can also be called Discrete Laplacians . For example, the Laplacian in two dimensions can be approximated using the five-point stencil  finite difference method , resulting in        Œî  f   (  x  ,  y  )    ‚âà      f   (   x  -  h   ,  y  )    +   f   (   x  +  h   ,  y  )    +   f   (  x  ,   y  -  h   )    +   f   (  x  ,   y  +  h   )     -   4  f   (  x  ,  y  )      h  2     ,        normal-Œî  f   x  y            f     x  h   y      f     x  h   y      f   x    y  h       f   x    y  h        4  f   x  y      superscript  h  2      \Delta f(x,y)\approx\frac{f(x-h,y)+f(x+h,y)+f(x,y-h)+f(x,y+h)-4f(x,y)}{h^{2}},\,     where the grid size is h in both dimensions, so that the five point stencil of a point ( x , y ) in the grid is       {   (   x  -  h   ,  y  )   ,   (  x  ,  y  )   ,   (   x  +  h   ,  y  )   ,   (  x  ,   y  -  h   )   ,   (  x  ,   y  +  h   )   }   .        x  h   y    x  y      x  h   y    x    y  h     x    y  h      \{(x-h,y),(x,y),(x+h,y),(x,y-h),(x,y+h)\}.\,     If the grid size h=1 , the result is the negative discrete Laplacian on the graph, which is the square lattice grid . There are no constraints here on the values of the function f(x,y) on the boundary of the lattice grid, thus this is the case of the homogeneous Neumann boundary condition , i.e., free boundary. Other types of boundary conditions, e.g., the homogeneous Dirichlet boundary condition , where f(x,y)=0 on the boundary of the grid, are rarely used for graph Laplacians, but are common in other applications.  Multidimensional discrete Laplacians on rectangular cuboid  regular grids have very special properties, e.g., they are Kronecker sums of one-dimensional discrete Laplacians, see Kronecker sum of discrete Laplacians , in which case all its eigenvalues and eigenvectors can be explicitly calculated.  Finite Element Method  In this approach, the domain is discretized into smaller elements, often triangles or tetrahedra, but other elements such as rectangles or cuboids are possible. The solution space is then approximated using so called form-functions of a pre-defined degree. The differential equation containing the Laplace operator is then transformed into a variational formulation, and a system of equations is constructed (linear or eigenvalue problems). The resulting matrices are usually very sparse and can be solved with iterative methods.  Image Processing  Discrete Laplace operator is often used in image processing e.g. in edge detection and motion estimation applications. The discrete Laplacian is defined as the sum of the second derivatives Laplace operator#Coordinate expressions and calculated as sum of differences over the nearest neighbours of the central pixel.  Implementation in Image Processing  For one, two and three dimensional signals, the discrete Laplacian can be given as convolution with the following kernels:   1D-filter:       D  ‚Üí   x  2   =   [     1     -  2     1     ]        subscript   superscript   normal-‚Üí  D   2   x     1    2   1      \vec{D}^{2}_{x}=\begin{bmatrix}1&-2&1\end{bmatrix}     2D-filter:      ùêÉ   x  y   2   =   [     0    1    0      1     -  4     1      0    1    0     ]        subscript   superscript  ùêÉ  2     x  y      0  1  0    1    4   1    0  1  0      \mathbf{D}^{2}_{xy}=\begin{bmatrix}0&1&0\\
 1&-4&1\\
 0&1&0\end{bmatrix}      or, including the diagonals:   2D-filter:      ùêÉ   x  y   2   =   [     0.5    1    0.5      1     -  6     1      0.5    1    0.5     ]        subscript   superscript  ùêÉ  2     x  y      0.5  1  0.5    1    6   1    0.5  1  0.5      \mathbf{D}^{2}_{xy}=\begin{bmatrix}0.5&1&0.5\\
 1&-6&1\\
 0.5&1&0.5\end{bmatrix}     3D-filter:     ùêÉ   x  y  z   2     subscript   superscript  ùêÉ  2     x  y  z     \mathbf{D}^{2}_{xyz}   is given by: first plane =    [     0    0    0      0    1    0      0    0    0     ]      0  0  0    0  1  0    0  0  0     \begin{bmatrix}0&0&0\\
 0&1&0\\
 0&0&0\end{bmatrix}   ; second plane =    [     0    1    0      1     -  6     1      0    1    0     ]      0  1  0    1    6   1    0  1  0     \begin{bmatrix}0&1&0\\
 1&-6&1\\
 0&1&0\end{bmatrix}   ; third plane =    [     0    0    0      0    1    0      0    0    0     ]      0  0  0    0  1  0    0  0  0     \begin{bmatrix}0&0&0\\
 0&1&0\\
 0&0&0\end{bmatrix}      :    n   n   n   D-filter : For the element    a    x  1   ,   x  2   ,  ‚Ä¶  ,   x  n       subscript  a    subscript  x  1    subscript  x  2   normal-‚Ä¶   subscript  x  n      a_{x_{1},x_{2},\dots,x_{n}}   of the kernel     ùêÉ    x  1   ,   x  2   ,  ‚Ä¶  ,   x  n    2   ,     subscript   superscript  ùêÉ  2     subscript  x  1    subscript  x  2   normal-‚Ä¶   subscript  x  n      \mathbf{D}^{2}_{x_{1},x_{2},\dots,x_{n}},       a_{x_1, x_2, \dots , x_n} = \left\{\begin{array}{ll}     -2n, & \text{if } s = n \\ 1, & \text{if } s = n - 1 \\ 0, & \text{otherwise} \end{array}\right.   where    x  i     subscript  x  i    x_{i}   is the position (either    -  1      1    -1   ,   0   0    or   1   1   1   ) of the element in the kernel in the    i  :   t  h      normal-:  i    t  h     i:th   direction, and   s   s   s   is the number of directions   i   i   i   for which     x  i   =  0       subscript  x  i   0    x_{i}=0   .   Note that the nD version, which is based on the graph generalization of the Laplacian, assumes all neighbors to be at an equal distance, and hence, leads to the following 2D-filter with diagonals included, rather than the version above:   2D-filter:       ùêÉ   x  y   2   =   [     1    1    1      1     -  8     1      1    1    1     ]    .       subscript   superscript  ùêÉ  2     x  y      1  1  1    1    8   1    1  1  1      \mathbf{D}^{2}_{xy}=\begin{bmatrix}1&1&1\\
 1&-8&1\\
 1&1&1\end{bmatrix}.      These kernels are deduced by using discrete differential quotients.  In 2 3 it is shown that the following discrete approximation of the two-dimensional Laplacian operator as a convex combination of difference operators       ‚àá  Œ≥  2   =     (   1  -  Œ≥   )    ‚àá  5  2    +   Œ≥   ‚àá  √ó  2     =     (   1  -  Œ≥   )    [     0    1    0      1     -  4     1      0    1    0     ]    +   Œ≥   [      1  /  2     0     1  /  2       0     -  2     0       1  /  2     0     1  /  2      ]            subscript   superscript  normal-‚àá  2   Œ≥         1  Œ≥    subscript   superscript  normal-‚àá  2   5      Œ≥   subscript   superscript  normal-‚àá  2                  1  Œ≥     0  1  0    1    4   1    0  1  0       Œ≥      1  2   0    1  2     0    2   0      1  2   0    1  2          \nabla^{2}_{\gamma}=(1-\gamma)\nabla^{2}_{5}+\gamma\nabla^{2}_{\times}=(1-%
 \gamma)\begin{bmatrix}0&1&0\\
 1&-4&1\\
 0&1&0\end{bmatrix}+\gamma\begin{bmatrix}1/2&0&1/2\\
 0&-2&0\\
 1/2&0&1/2\end{bmatrix}     for Œ≥ \in [0, 1] is compatible with discrete scale-space properties, where specifically the value Œ≥ = 1/3 gives the best approximation of rotational symmetry. Regarding three-dimensional signals, it is shown in 4 that the Laplacian operator can be approximated by the two-parameter family of difference operators       ‚àá    Œ≥  1   ,   Œ≥  2    2   =   (  1  -   Œ≥  1   -   Œ≥  2   )    ‚àá  7  2   +    Œ≥  1     ‚àá   +  3   2   +    Œ≥  2     ‚àá   √ó  3   2   )     fragments   subscript   superscript  normal-‚àá  2     subscript  Œ≥  1    subscript  Œ≥  2       fragments  normal-(  1    subscript  Œ≥  1     subscript  Œ≥  2   normal-)    superscript   subscript  normal-‚àá  7   2     subscript  Œ≥  1    superscript   subscript  normal-‚àá   superscript   3    2     subscript  Œ≥  2    superscript   subscript  normal-‚àá   superscript   3    2   normal-)    \nabla^{2}_{\gamma_{1},\gamma_{2}}=(1-\gamma_{1}-\gamma_{2})\,\nabla_{7}^{2}+%
 \gamma_{1}\,\nabla_{+^{3}}^{2}+\gamma_{2}\,\nabla_{\times^{3}}^{2})     where        (    ‚àá  7  2   f   )    0  ,  0  ,  0    =     f    -  1   ,  0  ,  0    +   f    +  1   ,  0  ,  0    +   f   0  ,   -  1   ,  0    +   f   0  ,   +  1   ,  0    +   f   0  ,  0  ,   -  1     +   f   0  ,  0  ,   +  1      -   6   f   0  ,  0  ,  0           subscript    superscript   subscript  normal-‚àá  7   2   f    0  0  0         subscript  f     1   0  0     subscript  f     1   0  0     subscript  f   0    1   0     subscript  f   0    1   0     subscript  f   0  0    1      subscript  f   0  0    1        6   subscript  f   0  0  0        (\nabla_{7}^{2}f)_{0,0,0}=f_{-1,0,0}+f_{+1,0,0}+f_{0,-1,0}+f_{0,+1,0}+f_{0,0,-%
 1}+f_{0,0,+1}-6f_{0,0,0}          (    ‚àá   +  3   2   f   )    0  ,  0  ,  0    =    1  4    (     f    -  1   ,   -  1   ,  0    +   f    -  1   ,   +  1   ,  0    +   f    +  1   ,   -  1   ,  0    +   f    +  1   ,   +  1   ,  0    +   f    -  1   ,  0  ,   -  1     +   f    -  1   ,  0  ,   +  1     +   f    +  1   ,  0  ,   -  1     +   f    +  1   ,  0  ,   +  1     +   f   0  ,   -  1   ,   -  1     +   f   0  ,   -  1   ,   +  1     +   f   0  ,   +  1   ,   -  1     +   f   0  ,   +  1   ,   +  1      -   12   f   0  ,  0  ,  0      )     ,       subscript    superscript   subscript  normal-‚àá   superscript   3    2   f    0  0  0        1  4        subscript  f     1     1   0     subscript  f     1     1   0     subscript  f     1     1   0     subscript  f     1     1   0     subscript  f     1   0    1      subscript  f     1   0    1      subscript  f     1   0    1      subscript  f     1   0    1      subscript  f   0    1     1      subscript  f   0    1     1      subscript  f   0    1     1      subscript  f   0    1     1        12   subscript  f   0  0  0         (\nabla_{+^{3}}^{2}f)_{0,0,0}=\frac{1}{4}(f_{-1,-1,0}+f_{-1,+1,0}+f_{+1,-1,0}+%
 f_{+1,+1,0}+f_{-1,0,-1}+f_{-1,0,+1}+f_{+1,0,-1}+f_{+1,0,+1}+f_{0,-1,-1}+f_{0,-%
 1,+1}+f_{0,+1,-1}+f_{0,+1,+1}-12f_{0,0,0}),          (    ‚àá   √ó  3   2   f   )    0  ,  0  ,  0    =    1  4    (     f    -  1   ,   -  1   ,   -  1     +   f    -  1   ,   -  1   ,   +  1     +   f    -  1   ,   +  1   ,   -  1     +   f    -  1   ,   +  1   ,   +  1     +   f    +  1   ,   -  1   ,   -  1     +   f    +  1   ,   -  1   ,   +  1     +   f    +  1   ,   +  1   ,   -  1     +   f    +  1   ,   +  1   ,   +  1      -   8   f   0  ,  0  ,  0      )     .       subscript    superscript   subscript  normal-‚àá   superscript   3    2   f    0  0  0        1  4        subscript  f     1     1     1      subscript  f     1     1     1      subscript  f     1     1     1      subscript  f     1     1     1      subscript  f     1     1     1      subscript  f     1     1     1      subscript  f     1     1     1      subscript  f     1     1     1        8   subscript  f   0  0  0         (\nabla_{\times^{3}}^{2}f)_{0,0,0}=\frac{1}{4}(f_{-1,-1,-1}+f_{-1,-1,+1}+f_{-1%
 ,+1,-1}+f_{-1,+1,+1}+f_{+1,-1,-1}+f_{+1,-1,+1}+f_{+1,+1,-1}+f_{+1,+1,+1}-8f_{0%
 ,0,0}).     Spectrum  The spectrum of the discrete Laplacian is of key interest; since it is a self-adjoint operator , it has a real spectrum. For the convention    Œî  =   I  -  M       normal-Œî    I  M     \Delta=I-M   , the spectrum lies within    [  0  ,  2  ]     0  2    [0,2]   (as the averaging operator has spectral values in    [   -  1   ,  1  ]       1   1    [-1,1]   ). The smallest non-zero eigenvalue is denoted    Œª  1     subscript  Œª  1    \lambda_{1}   and is called the spectral gap . There is also the notion of the spectral radius , commonly taken as the largest eigenvalue.  The eigenvectors don't depend on the convention above (for regular graphs ), and are the same as for the averaging operator (as they differ by adding a multiple of the identity), though the eigenvalues differ according to the convention.  For operators that approximate the underlying continuous Laplacian the eigenvalues are a sequence of positive real numbers. The first eigenvalue is zero, if the domain has a boundary and the Neumann boundary condition is used, or if the shape contains no boundary (e.g. the sphere).  Theorems  If the graph is an infinite square lattice grid , then this definition of the Laplacian can be shown to correspond to the continuous Laplacian in the limit of an infinitely fine grid. Thus, for example, on a one-dimensional grid we have          ‚àÇ  2   F    ‚àÇ   x  2     =    lim   œµ  ‚Üí  0       [    F   (   x  +  œµ   )    -   F   (  x  )     ]   +   [    F   (   x  -  œµ   )    -   F   (  x  )     ]     œµ  2      .          superscript   2   F      superscript  x  2       subscript    normal-‚Üí  œµ  0         delimited-[]      F    x  œµ      F  x      delimited-[]      F    x  œµ      F  x       superscript  œµ  2       \frac{\partial^{2}F}{\partial x^{2}}=\lim_{\epsilon\rightarrow 0}\frac{[F(x+%
 \epsilon)-F(x)]+[F(x-\epsilon)-F(x)]}{\epsilon^{2}}.     This definition of the Laplacian is commonly used in numerical analysis and in image processing . In image processing, it is considered to be a type of digital filter , more specifically an edge filter , called the Laplace filter .  Discrete Schr√∂dinger operator  Let    P  :   V  ‚Üí  R      normal-:  P   normal-‚Üí  V  R     P:V\rightarrow R   be a potential function defined on the graph. Note that P can be considered to be a multiplicative operator acting diagonally on   œï   œï   \phi            (   P  œï   )    (  v  )    =   P   (  v  )   œï   (  v  )     .          P  œï   v     P  v  œï  v     (P\phi)(v)=P(v)\phi(v).\,     Then    H  =   Œî  +  P       H    normal-Œî  P     H=\Delta+P   is the discrete Schr√∂dinger operator , an analog of the continuous Schr√∂dinger operator .  If the number of edges meeting at a vertex is uniformly bounded, and the potential is bounded, then H is bounded and self-adjoint .  The spectral properties of this Hamiltonian can be studied with Stone's theorem ; this is a consequence of the duality between posets and Boolean algebras .  On regular lattices, the operator typically has both traveling-wave as well as Anderson localization solutions, depending on whether the potential is periodic or random.  Discrete Green's function  The Green's function of the discrete Schr√∂dinger operator is given in the resolvent formalism by       G   (  v  ,  w  ;  Œª  )    =   ‚ü®   Œ¥  v   |   1   H  -  Œª    |   Œ¥  w   ‚ü©         G   v  w  Œª     quantum-operator-product   subscript  Œ¥  v     1    H  Œª     subscript  Œ¥  w      G(v,w;\lambda)=\left\langle\delta_{v}\left|\frac{1}{H-\lambda}\right|\delta_{w%
 }\right\rangle   where    Œ¥  w     subscript  Œ¥  w    \delta_{w}   is understood to be the Kronecker delta function on the graph      Œ¥  w    (  v  )    =   Œ¥   w  v           subscript  Œ¥  w   v    subscript  Œ¥    w  v      \delta_{w}(v)=\delta_{wv}   ; that is, it equals 1 if v = w and 0 otherwise.  For fixed    w  ‚àà  V      w  V    w\in V   and   Œª   Œª   \lambda   a complex number, the Green's function considered to be a function of v is the unique solution to         (   H  -  Œª   )   G   (  v  ,  w  ;  Œª  )    =    Œ¥  w    (  v  )     .          H  Œª   G   v  w  Œª       subscript  Œ¥  w   v     (H-\lambda)G(v,w;\lambda)=\delta_{w}(v).\,     ADE classification  Certain equations involving the discrete Laplacian only have solutions on the simply-laced Dynkin diagrams (all edges multiplicity 1), and are an example of the ADE classification . Specifically, the only positive solutions to the homogeneous equation:        Œî  œï   =  œï   ,        normal-Œî  œï   œï    \Delta\phi=\phi,   in words,   "Twice any label is the sum of the labels on adjacent vertices,"   are on the extended (affine) ADE Dynkin diagrams, of which there are 2 infinite families (A and D) and 3 exceptions (E). The resulting numbering is unique up to scale, and if the smallest value is set at 1, the other numbers are integers, ranging up to 6.  The ordinary ADE graphs are the only graphs that admit a positive labeling with the following property:   Twice any label minus two is the sum of the labels on adjacent vertices.   In terms of the Laplacian, the positive solutions to the inhomogeneous equation:       Œî  œï   =   œï  -  2.         normal-Œî  œï     œï  2.     \Delta\phi=\phi-2.   The resulting numbering is unique (scale is specified by the "2"), and consists of integers; for E 8 they range from 58 to 270, and have been observed as early as .  See also   Spectral shape analysis  Electrical network  Kronecker sum of discrete Laplacians   References      T.Sunada , Discrete geometric analysis, Proceedings of Symposia in Pure Mathematics (ed. by P. Exner, J. P. Keating, P. Kuchment, T. Sunada, A. Teplyaev), 77 (2008), 51-86   External links   Definition and application to spectral gap  [ https://docs.google.com/viewer?a=v&pid; ;=sites&srcid;=ZGVmYXVsdGRvbWFpbnxkYXZlZGNsdWJ8Z3g6Mzk2ZTUxYzA4MzI5MzBiNw Layered networks, the discrete Laplacian, and a continued fraction identity], Owen D. Biesel, David V. Ingerman, James A. Morrow, and William T. Shore   "  Category:Operator theory  Category:Graph theory  Category:Numerical differential equations  Category:Finite differences  Category:Feature detection (computer vision)     ‚Ü©  Lindeberg, T., "Scale-space for discrete signals," PAMI(12), No. 3, March 1990, pp. 234-254. ‚Ü©  Lindeberg, T., Scale-Space Theory in Computer Vision, Kluwer Academic Publishers, 1994 , ISBN 0-7923-9418-6 ‚Ü©      
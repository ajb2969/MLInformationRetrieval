   Filter (large eddy simulation)      Filter (large eddy simulation)   Filtering in the context of large eddy simulation (LES) is a mathematical operation intended to remove a range of small scales from the solution to the Navier-Stokes equations . Because the principal difficulty in simulating turbulent flows comes from the wide range of length and time scales, this operation makes turbulent flow simulation cheaper by reducing the range of scales that must be resolved. The LES filter operation is low-pass, meaning it filters out the scales associated with high frequencies.  Homogeneous filters    Definition in physical space  The low-pass filtering operation used in LES can be applied to a spatial and temporal field, for example    Ï•   (  ğ’™  ,  t  )       Ï•   ğ’™  t     \phi(\boldsymbol{x},t)   . The LES filter operation may be spatial, temporal, or both. The filtered field, denoted with a bar, is defined as: 1 2         Ï•   (  ğ’™  ,  t  )    Â¯   =    âˆ«   -  âˆ   âˆ     âˆ«   -  âˆ   âˆ    Ï•   (  ğ’“  ,   t  â€²   )   G   (   ğ’™  -  ğ’“   ,   t  -   t  â€²    )   d   t  â€²   d  ğ’“      ,       normal-Â¯    Ï•   ğ’™  t       superscript   subscript            superscript   subscript            Ï•   ğ’“   superscript  t  normal-â€²    G     ğ’™  ğ’“     t   superscript  t  normal-â€²     d   superscript  t  normal-â€²   d  ğ’“       \overline{\phi(\boldsymbol{x},t)}=\displaystyle{\int_{-\infty}^{\infty}}\int_{%
 -\infty}^{\infty}\phi(\boldsymbol{r},t^{\prime})G(\boldsymbol{x}-\boldsymbol{r%
 },t-t^{\prime})dt^{\prime}d\boldsymbol{r},     where   G   G   G   is a convolution kernel unique to the filter type used. This can be written as a convolution operation:        Ï•  Â¯   =   G  â‹†  Ï•    .       normal-Â¯  Ï•    normal-â‹†  G  Ï•     \overline{\phi}=G\star\phi.     The filter kernel   G   G   G   uses cutoff length and time scales, denoted   Î”   normal-Î”   \Delta   and     Ï„  c   ,     subscript  Ï„  c    \tau_{c},   respectively. Scales smaller than these are eliminated from     Ï•  Â¯   .     normal-Â¯  Ï•    \overline{\phi}.   Using this definition, any field   Ï•   Ï•   \phi   may be split up into a filtered and sub-filtered (denoted with a prime) portion, as       Ï•  =    Ï•  Â¯   +   Ï•  â€²     .      Ï•     normal-Â¯  Ï•    superscript  Ï•  normal-â€²      \phi=\bar{\phi}+\phi^{\prime}.     This can also be written as a convolution operation,        Ï•  â€²   =    (   1  -  G   )   â‹†  Ï•    .       superscript  Ï•  normal-â€²    normal-â‹†    1  G   Ï•     \phi^{\prime}=\left(1-G\right)\star\phi.     Definition in spectral space  The filtering operation removes scales associated with high frequencies, and the operation can accordingly be interpreted in Fourier space . For a scalar field     Ï•   (  ğ’™  ,  t  )    ,      Ï•   ğ’™  t     \phi(\boldsymbol{x},t),   the Fourier transform of   Ï•   Ï•   \phi   is      Ï•  ^    (  ğ’Œ  ,  Ï‰  )    ,       normal-^  Ï•    ğ’Œ  Ï‰     \hat{\phi}(\boldsymbol{k},\omega),   a function of    ğ’Œ  ,    ğ’Œ   \boldsymbol{k},   the spatial wave number, and    Ï‰  ,    Ï‰   \omega,   the temporal frequency.    Ï•  ^     normal-^  Ï•    \hat{\phi}   can be filtered by the corresponding Fourier transform of the filter kernel, denoted      G  ^    (  ğ’Œ  ,  Ï‰  )    :      normal-:     normal-^  G    ğ’Œ  Ï‰    absent    \hat{G}(\boldsymbol{k},\omega):            Ï•  ^   Â¯    (  ğ’Œ  ,  Ï‰  )    =    Ï•  ^    (  ğ’Œ  ,  Ï‰  )    G  ^    (  ğ’Œ  ,  Ï‰  )           normal-Â¯   normal-^  Ï•     ğ’Œ  Ï‰       normal-^  Ï•    ğ’Œ  Ï‰    normal-^  G    ğ’Œ  Ï‰      \overline{\hat{\phi}}(\boldsymbol{k},\omega)=\hat{\phi}(\boldsymbol{k},\omega)%
 \hat{G}(\boldsymbol{k},\omega)     or,         Ï•  ^   Â¯   =    G  ^    Ï•  ^     .       normal-Â¯   normal-^  Ï•       normal-^  G    normal-^  Ï•      \overline{\hat{\phi}}=\hat{G}\hat{\phi}.     The filter width   Î”   normal-Î”   \Delta   has an associated cutoff wave number     k  c   ,     subscript  k  c    k_{c},   and the temporal filter width    Ï„  c     subscript  Ï„  c    \tau_{c}   also has an associated cutoff frequency     Ï‰  c   .     subscript  Ï‰  c    \omega_{c}.   The unfiltered portion of    Ï•  ^     normal-^  Ï•    \hat{\phi}   is:         Ï•  â€²   ^   =    (   1  -   G  ^    )    Ï•  ^     .       normal-^   superscript  Ï•  normal-â€²        1   normal-^  G     normal-^  Ï•      \hat{\phi^{\prime}}=(1-\hat{G})\hat{\phi}.     The spectral interpretation of the filtering operation is essential to the filtering operation in large eddy simulation, as the spectra of turbulent flows is central to LES subgrid-scale models, which reconstruct the effect of the sub-filter scales (the highest frequencies). One of the challenges in subgrid modeling is to effectively mimic the cascade of kinetic energy from low to high frequencies. This makes the spectral properties of the implemented LES filter very important to subgrid modeling efforts.  Homogeneous filter properties  Homogeneous LES filters must satisfy the following set of properties when applied to the Navier-Stokes equations. 3   1. Conservation of constants    The value of a filtered constant must be equal to the constant,          \overline{a} = a,   which implies,          \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} G( \boldsymbol{\xi}, t^{\prime} ) d^3 \boldsymbol{\xi} dt^{\prime} = 1.   2. Linearity          \overline{ \phi + \psi } = \overline{\phi} + \overline{\psi}.   3. Commutation with derivatives          \overline{ \frac{\partial \phi}{\partial s} } = \frac{\partial \overline{\phi} }{\partial s}, \qquad s = \boldsymbol{x}, t.   If notation is introduced for operator commutation    [  f  ,  g  ]     f  g    [f,g]   for two arbitrary operators   f   f   f   and   g   g   g   , where          [f, g] \phi = f \circ g(\phi) - g \circ f(\phi) = f(g(\phi)) - g(f(\phi)),   then this third property can be expressed as          \left[ G \star, \frac{\partial}{\partial s} \right] = 0.  Filters satisfying these properties are generally not Reynolds operators , meaning, first:          Ï•  Â¯   Â¯     â‰       Ï•  Â¯   ,         G  â‹†  G  â‹†  Ï•   =    G  2   Ï•      â‰       G  â‹†  Ï•   ,          normal-Â¯   normal-Â¯  Ï•      normal-Â¯  Ï•        normal-â‹†  G  G  Ï•      superscript  G  2   Ï•      normal-â‹†  G  Ï•      \begin{array}[]{rcl}\overline{\overline{\phi}}&\neq&\overline{\phi},\\
 G\star G\star\phi=G^{2}\phi&\neq&G\star\phi,\end{array}     and second,        Ï•  â€²   Â¯   =   G  â‹†   (   1  -  G   )   â‹†  Ï•   â‰   0.         normal-Â¯   superscript  Ï•  normal-â€²     normal-â‹†  G    1  G   Ï•        0.     \overline{\phi^{\prime}}=G\star(1-G)\star\phi\neq 0.     Inhomogeneous filters  Implementations of filtering operations for all but the simplest flows are inhomogeneous filter operations. This means that the flow either has non-periodic boundaries, causing problems with certain types of filters, or has a non-constant filter width   Î”   normal-Î”   \Delta   , or both. This prevents the filter from commuting with derivatives, and the commutation operation leads to several additional error terms:           [   âˆ‚   âˆ‚  ğ’™    ,  G  â‹†  ]   Ï•     =       âˆ‚   âˆ‚  ğ’™     (   G  â‹†  Ï•   )    -   G  â‹†    âˆ‚  Ï•    âˆ‚  ğ’™           =       âˆ‚   âˆ‚  ğ’™      âˆ«  Î©    G   (   ğ’™  -  ğ’“   ,   Î”   (  ğ’™  ,  t  )    )   Ï•   (  ğ’“  ,  t  )   d  ğ’“     -   G  â‹†    âˆ‚  Ï•    âˆ‚  ğ’™           =       (     âˆ‚  G    âˆ‚  Î”    â‹†  Ï•   )     âˆ‚  Î”    âˆ‚  x     +    âˆ«   d  Î©     G   (   x  -  r   ,   Î”   (  x  ,  t  )    )   Ï•   (  r  ,  t  )   ğ’  d  S        ,       fragments   fragments  normal-[       ğ’™    normal-,  G  normal-â‹†  normal-]   Ï•             ğ’™     normal-â‹†  G  Ï•     normal-â‹†  G      Ï•     ğ’™         missing-subexpression             ğ’™      subscript   normal-Î©     G     ğ’™  ğ’“     normal-Î”   ğ’™  t     Ï•   ğ’“  t   d  ğ’“      normal-â‹†  G      Ï•     ğ’™         missing-subexpression         normal-â‹†      G     normal-Î”    Ï•       normal-Î”     x       subscript     d  normal-Î©      G     x  r     normal-Î”   x  t     Ï•   r  t   ğ’  d  S        \begin{array}[]{rcl}\left[\frac{\partial}{\partial\boldsymbol{x}},G\star\right%
 ]\phi&=&\frac{\partial}{\partial\boldsymbol{x}}\left(G\star\phi\right)-G\star%
 \frac{\partial\phi}{\partial\boldsymbol{x}}\\
 &=&\frac{\partial}{\partial\boldsymbol{x}}\int_{\Omega}G(\boldsymbol{x}-%
 \boldsymbol{r},\Delta(\boldsymbol{x},t))\phi(\boldsymbol{r},t)d\boldsymbol{r}-%
 G\star\frac{\partial\phi}{\partial\boldsymbol{x}}\\
 &=&\left(\frac{\partial G}{\partial\Delta}\star\phi\right)\frac{\partial\Delta%
 }{\partial x}+\int_{d\Omega}G(x-r,\Delta(x,t))\phi(r,t)\boldsymbol{n}dS\end{%
 array},     where   ğ’   ğ’   \boldsymbol{n}   is the vector normal to the surface of the boundary   Î©   normal-Î©   \Omega   and     d  Î©   .      d  normal-Î©    d\Omega.    4  The two terms both appear due to inhomogeneities. The first is due to the spatial variation in the filter size    Î”  ,    normal-Î”   \Delta,   while the second is due to the domain boundary. Similarly, the commutation of the filter   G   G   G   with the temporal derivative leads to an error term resulting from temporal variation in the filter size,       [   âˆ‚   âˆ‚  t    ,  G  â‹†  ]   =   (    âˆ‚  G    âˆ‚  Î”    â‹†  Ï•  )     âˆ‚  Î”    âˆ‚  t    .     fragments   fragments  normal-[       t    normal-,  G  normal-â‹†  normal-]     fragments  normal-(      G     normal-Î”    normal-â‹†  Ï•  normal-)       normal-Î”     t    normal-.    \left[\frac{\partial}{\partial t},G\star\right]=\left(\frac{\partial G}{%
 \partial\Delta}\star\phi\right)\frac{\partial\Delta}{\partial t}.     Several filter operations which eliminate or minimize these error terms have been proposed.  Classic large eddy simulation filters  There are three filters ordinarily used for spatial filtering in large eddy simulation. The definition of    G   (  ğ’™  ,  t  )       G   ğ’™  t     G(\boldsymbol{x},t)   and      G  ^    (  ğ’Œ  ,  Ï‰  )    ,       normal-^  G    ğ’Œ  Ï‰     \hat{G}(\boldsymbol{k},\omega),   and a discussion of important properties, is given. 5  Box filter  The filter kernel in physical space is given by:       G   (   ğ’™  -  ğ’“   )    =   {        1  Î”    ,        if   |   ğ’™  -  ğ’“   |    â‰¤    Î”  2     ,        0  ,      otherwise  .             G    ğ’™  ğ’“     cases    1  normal-Î”       if      ğ’™  ğ’“       normal-Î”  2    0  otherwise     G(\boldsymbol{x}-\boldsymbol{r})=\begin{cases}\frac{1}{\Delta},&\text{if}\left%
 |\boldsymbol{x}-\boldsymbol{r}\right|\leq\frac{\Delta}{2},\\
 0,&\text{otherwise}.\end{cases}     The filter kernel in spectral space is given by:         G  ^    (  ğ’Œ  )    =    sin   (    1  2   k  Î”   )      1  2   k  Î”     .         normal-^  G   ğ’Œ           1  2   k  normal-Î”        1  2   k  normal-Î”      \hat{G}(\boldsymbol{k})=\frac{\sin{(\frac{1}{2}k\Delta)}}{\frac{1}{2}k\Delta}.     Gaussian filter  The filter kernel in physical space is given by:        G   (   ğ’™  -  ğ’“   )    =     (   6   Ï€   Î”  2     )    1  2     exp   (   -    6    (   ğ’™  -  ğ’“   )   2     Î”  2     )      .        G    ğ’™  ğ’“       superscript    6    Ï€   superscript  normal-Î”  2       1  2            6   superscript    ğ’™  ğ’“   2     superscript  normal-Î”  2         G(\boldsymbol{x}-\boldsymbol{r})=\left(\frac{6}{\pi\Delta^{2}}\right)^{\frac{1%
 }{2}}\exp{\left(-\frac{6(\boldsymbol{x-r})^{2}}{\Delta^{2}}\right)}.     The filter kernel in spectral space is given by:         G  ^    (  ğ’Œ  )    =   exp   (   -     ğ’Œ  2    Î”  2    24    )     .         normal-^  G   ğ’Œ            superscript  ğ’Œ  2    superscript  normal-Î”  2    24       \hat{G}(\boldsymbol{k})=\exp{\left(-\frac{\boldsymbol{k}^{2}\Delta^{2}}{24}%
 \right)}.     Sharp spectral filter  The filter kernel in physical space is given by:        G   (   ğ’™  -  ğ’“   )    =    sin   (    Ï€   (   ğ’™  -  ğ’“   )    /  Î”   )     Ï€   (   ğ’™  -  ğ’“   )      .        G    ğ’™  ğ’“            Ï€    ğ’™  ğ’“    normal-Î”      Ï€    ğ’™  ğ’“       G(\boldsymbol{x}-\boldsymbol{r})=\frac{\sin{(\pi(\boldsymbol{x-r})/\Delta)}}{%
 \pi(\boldsymbol{x-r})}.     The filter kernel in spectral space is given by:          G  ^    (  ğ’Œ  )    =   H   (    k  c   -   |  k  |    )     ,    k  c   =   Ï€  Î”     .     formulae-sequence       normal-^  G   ğ’Œ     H     subscript  k  c     k         subscript  k  c     Ï€  normal-Î”      \hat{G}(\boldsymbol{k})=H\left(k_{c}-\left|k\right|\right),\qquad k_{c}=\frac{%
 \pi}{\Delta}.     See also   Computational fluid dynamics  Filter (signal processing)  Fluid mechanics  Fourier transform  Frequency domain  Large eddy simulation  Turbulence   References    "  Category:Turbulence models     â†©  â†©        
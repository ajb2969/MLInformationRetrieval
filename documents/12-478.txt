   Optimal projection equations      Optimal projection equations  In [[co ntrol theory]], optimal projection equations  1 2 3 constitute necessary and sufficient conditions for a locally optimal reduced-order LQG controller. 4  The Linear-Quadratic-Gaussian (LQG) control problem is one of the most fundamental optimal control problems. It concerns uncertain linear systems disturbed by additive white Gaussian noise , incomplete state information (i.e. not all the state variables are measured and available for feedback) also disturbed by additive white Gaussian noise and quadratic costs . Moreover the solution is unique and constitutes a linear dynamic feedback control law that is easily computed and implemented. Finally the LQG controller is also fundamental to the optimal perturbation control of non-linear systems. 5  The LQG controller itself is a dynamic system like the system it controls. Both systems have the same state dimension. Therefore implementing the LQG controller may be problematic if the dimension of the system state is large. The reduced-order LQG problem (fixed-order LQG problem) overcomes this by fixing a-priori the number of states of the LQG controller. This problem is more difficult to solve because it is no longer separable. Also the solution is no longer unique. Despite these facts numerical algorithms are available 6 7 8 9 to solve the associated optimal projection equations.  Mathematical problem formulation and solution  Continuous-time  The reduced-order LQG control problem is almost identical to the conventional full-order LQG control problem . Let      ùê±  ^   r    (  t  )        subscript   normal-^  ùê±   r   t    \hat{\mathbf{x}}_{r}(t)   represent the state of the reduced-order LQG controller. Then the only difference is that the state dimension     n  r   =   d  i  m   (     ùê±  ^   r    (  t  )    )         subscript  n  r     d  i  m     subscript   normal-^  ùê±   r   t      n_{r}=dim(\hat{\mathbf{x}}_{r}(t))   of the LQG controller is a-priori fixed to be smaller than    n  =   d  i  m   (   ùê±   (  t  )    )        n    d  i  m    ùê±  t      n=dim({\mathbf{x}}(t))   , the state dimension of the controlled system.  The reduced-order LQG controller is represented by the following equations:            ùê±  ^   Àô   r    (  t  )    =     A  r    (  t  )     ùê±  ^   r    (  t  )    +    B  r    (  t  )   ùêÆ   (  t  )    +    K  r    (  t  )    (    ùê≤   (  t  )    -    C  r    (  t  )     ùê±  ^   r    (  t  )     )      ,      ùê±  ^   r    (  0  )    =    ùê±  r    (  0  )      ,     formulae-sequence       subscript   normal-Àô   normal-^  ùê±    r   t        subscript  A  r   t   subscript   normal-^  ùê±   r   t      subscript  B  r   t  ùêÆ  t      subscript  K  r   t      ùê≤  t      subscript  C  r   t   subscript   normal-^  ùê±   r   t            subscript   normal-^  ùê±   r   0      subscript  ùê±  r   0      \dot{\hat{\mathbf{x}}}_{r}(t)=A_{r}(t)\hat{\mathbf{x}}_{r}(t)+B_{r}(t){\mathbf%
 {u}}(t)+K_{r}(t)\left({\mathbf{y}}(t)-C_{r}(t)\hat{\mathbf{x}}_{r}(t)\right),%
 \hat{\mathbf{x}}_{r}(0)={\mathbf{x}}_{r}(0),           ùêÆ   (  t  )    =   -    L  r    (  t  )     ùê±  ^   r    (  t  )      .        ùêÆ  t        subscript  L  r   t   subscript   normal-^  ùê±   r   t      {\mathbf{u}}(t)=-L_{r}(t)\hat{\mathbf{x}}_{r}(t).     These equations are deliberately stated in a format that equals that of the conventional full-order LQG controller . For the reduced-order LQG control problem it is convenient to rewrite them as            ùê±  ^   Àô   r    (  t  )    =     F  r    (  t  )     ùê±  ^   r    (  t  )    +    K  r    (  t  )   ùê≤   (  t  )      ,      ùê±  ^   r    (  0  )    =    ùê±  r    (  0  )      ,     formulae-sequence       subscript   normal-Àô   normal-^  ùê±    r   t        subscript  F  r   t   subscript   normal-^  ùê±   r   t      subscript  K  r   t  ùê≤  t          subscript   normal-^  ùê±   r   0      subscript  ùê±  r   0      \dot{\hat{\mathbf{x}}}_{r}(t)=F_{r}(t)\hat{\mathbf{x}}_{r}(t)+K_{r}(t){\mathbf%
 {y}}(t),\hat{\mathbf{x}}_{r}(0)={\mathbf{x}}_{r}(0),           ùêÆ   (  t  )    =   -    L  r    (  t  )     ùê±  ^   r    (  t  )      ,        ùêÆ  t        subscript  L  r   t   subscript   normal-^  ùê±   r   t      {\mathbf{u}}(t)=-L_{r}(t)\hat{\mathbf{x}}_{r}(t),     where         F  r    (  t  )    =     A  r    (  t  )    -    B  r    (  t  )    L  r    (  t  )    -    K  r    (  t  )    C  r    (  t  )      .         subscript  F  r   t        subscript  A  r   t      subscript  B  r   t   subscript  L  r   t      subscript  K  r   t   subscript  C  r   t      {\mathbf{}}F_{r}(t)=A_{r}(t)-B_{r}(t)L_{r}(t)-K_{r}(t)C_{r}(t).     The matrices      F  r    (  t  )    ,    K  r    (  t  )    ,    L  r    (  t  )          subscript  F  r   t      subscript  K  r   t      subscript  L  r   t     {\mathbf{}}F_{r}(t),K_{r}(t),L_{r}(t)   and     ùê±  r    (  0  )        subscript  ùê±  r   0    {\mathbf{x}}_{r}(0)   of the reduced-order LQG controller are determined by the so-called optimal projection equations ( OPE ). 10  The square optimal projection matrix    œÑ   (  t  )       œÑ  t    {\mathbf{}}\tau(t)   with dimension   n   n   {\mathbf{}}n   is central to the OPE . The rank of this matrix is almost everywhere equal to     n  r   .     subscript  n  r    {\mathbf{}}n_{r}.   The associated projection is an oblique projection       œÑ  2    (  t  )    =   œÑ   (  t  )     .         superscript  œÑ  2   t     œÑ  t     {\mathbf{}}\tau^{2}(t)=\tau(t).   The OPE constitute four matrix differential equations. The first two equations listed below are generalizations of the matrix Riccati differential equations associated to the conventional full-order LQG controller . In these equations     œÑ  ‚üÇ    (  t  )        subscript  œÑ  perpendicular-to   t    {\mathbf{}}\tau_{\perp}(t)   denotes     I  n   -   œÑ   (  t  )         subscript  I  n     œÑ  t     {\mathbf{}}I_{n}-\tau(t)   where    I  n     subscript  I  n    {\mathbf{}}I_{n}   is the identity matrix of dimension   n   n   {\mathbf{}}n   .        P  Àô    (  t  )    =      A   (  t  )   P   (  t  )    +   P   (  t  )    A  ‚Ä≤    (  t  )     -   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )   C   (  t  )   P   (  t  )     +   V   (  t  )            normal-Àô  P   t           A  t  P  t     P  t   superscript  A  normal-‚Ä≤   t      P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t  C  t  P  t      V  t      \dot{P}(t)=A(t)P(t)+P(t)A^{\prime}(t)-P(t)C^{\prime}(t)W^{-1}(t)C(t)P(t)+V(t)       +\tau_\perp (t)P(t)C'(t)W^{-1}(t)     C(t)P(t)\tau'_\perp (t),        P   (  0  )    =   E   (   ùê±   (  0  )    ùê±  ‚Ä≤    (  0  )    )     ,        P  0     E    ùê±  0   superscript  ùê±  normal-‚Ä≤   0      P(0)=E\left({\mathbf{x}}(0){\mathbf{x}}^{\prime}(0)\right),          -    S  Àô    (  t  )     =       A  ‚Ä≤    (  t  )   S   (  t  )    +   S   (  t  )   A   (  t  )     -   S   (  t  )   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )     +   Q   (  t  )              normal-Àô  S   t             superscript  A  normal-‚Ä≤   t  S  t     S  t  A  t      S  t  B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t      Q  t      -\dot{S}(t)=A^{\prime}(t)S(t)+S(t)A(t)-S(t)B(t)R^{-1}(t)B^{\prime}(t)S(t)+Q(t)            +    œÑ  ‚üÇ  ‚Ä≤    (  t  )   S   (  t  )   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )    œÑ  ‚üÇ    (  t  )     ,         subscript   superscript  œÑ  normal-‚Ä≤   perpendicular-to   t  S  t  B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t   subscript  œÑ  perpendicular-to   t     +\tau^{\prime}_{\perp}(t)S(t)B(t)R^{-1}(t)B^{\prime}(t)S(t)\tau_{\perp}(t),              S   (  T  )    =  F   .        S  T   F    {\mathbf{}}S(T)=F.     If the dimension of the LQG controller is not reduced, that is if    n  =   n  r       n   subscript  n  r     {\mathbf{}}n=n_{r}   , then      œÑ   (  t  )    =   I  n    ,     œÑ  ‚üÇ    (  t  )    =  0      formulae-sequence      œÑ  t    subscript  I  n         subscript  œÑ  perpendicular-to   t   0     \tau(t)=I_{n},\tau_{\perp}(t)=0   and the two equations above become the uncoupled matrix Riccati differential equations associated to the conventional full-order LQG controller . If    œÑ   (  t  )       œÑ  t    {\mathbf{}}\tau(t)   This reveals why the reduced-order LQG problem is not separable . The oblique projection      Œ®  1    (  t  )    =     (    A   (  t  )    -   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )     )    P  ^    (  t  )    +    P  ^    (  t  )     (    A   (  t  )    -   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )     )   ‚Ä≤            subscript  normal-Œ®  1   t           A  t     B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t     normal-^  P   t      normal-^  P   t   superscript      A  t     B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t    normal-‚Ä≤       \Psi_{1}(t)=(A(t)-B(t)R^{-1}(t)B^{\prime}(t)S(t))\hat{P}(t)+\hat{P}(t)(A(t)-B(%
 t)R^{-1}(t)B^{\prime}(t)S(t))^{\prime}   is determined from two additional matrix differential equations which involve rank conditions . Together with the previous two matrix differential equations these are the OPE . To state the additional two matrix differential equations it is convenient to introduce the following two matrices:       +   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )   C   (  t  )   P   (  t  )     ,        P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t  C  t  P  t     {\mathbf{}}+P(t)C^{\prime}(t)W^{-1}(t)C(t)P(t),             Œ®  2    (  t  )    =      (    A   (  t  )    -   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )   C   (  t  )     )   ‚Ä≤    S  ^    (  t  )    +    S  ^    (  t  )    (    A   (  t  )    -   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )   C   (  t  )     )            subscript  normal-Œ®  2   t        superscript      A  t     P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t  C  t    normal-‚Ä≤    normal-^  S   t      normal-^  S   t      A  t     P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t  C  t        \Psi_{2}(t)=(A(t)-P(t)C^{\prime}(t)W^{-1}(t)C(t))^{\prime}\hat{S}(t)+\hat{S}(t%
 )(A(t)-P(t)C^{\prime}(t)W^{-1}(t)C(t))             +   S   (  t  )   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )     .        S  t  B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t     {\mathbf{}}+S(t)B(t)R^{-1}(t)B^{\prime}(t)S(t).               P  ^   Àô    (  t  )    =    1  /  2    (    œÑ   (  t  )    Œ®  1    (  t  )    +    Œ®  1    (  t  )    œÑ  ‚Ä≤    (  t  )     )     ,      P  ^    (  0  )    =   E   (   ùê±   (  0  )    )   E    (   ùê±   (  0  )    )   ‚Ä≤     ,    r  a  n  k   (    P  ^    (  t  )    )    =   n  r        formulae-sequence       normal-Àô   normal-^  P    t       1  2       œÑ  t   subscript  normal-Œ®  1   t      subscript  normal-Œ®  1   t   superscript  œÑ  normal-‚Ä≤   t       formulae-sequence       normal-^  P   0     E    ùê±  0   E   superscript    ùê±  0   normal-‚Ä≤         r  a  n  k     normal-^  P   t     subscript  n  r       \dot{\hat{P}}(t)=1/2\left(\tau(t)\Psi_{1}(t)+\Psi_{1}(t)\tau^{\prime}(t)\right%
 ),\hat{P}(0)=E({\mathbf{x}}(0))E({\mathbf{x}}(0))^{\prime},rank(\hat{P}(t))=n_%
 {r}        Then the two additional matrix differential equations that complete the OPE are as follows:        -     S  ^   Àô    (  t  )     =    1  /  2    (     œÑ  ‚Ä≤    (  t  )    Œ®  2    (  t  )    +    Œ®  2    (  t  )   œÑ   (  t  )     )     ,      S  ^    (  T  )    =  0   ,    r  a  n  k   (    S  ^    (  t  )    )    =   n  r        formulae-sequence         normal-Àô   normal-^  S    t        1  2        superscript  œÑ  normal-‚Ä≤   t   subscript  normal-Œ®  2   t      subscript  normal-Œ®  2   t  œÑ  t       formulae-sequence       normal-^  S   T   0       r  a  n  k     normal-^  S   t     subscript  n  r       -\dot{\hat{S}}(t)=1/2\left(\tau^{\prime}(t)\Psi_{2}(t)+\Psi_{2}(t)\tau(t)%
 \right),\hat{S}(T)=0,rank(\hat{S}(t))=n_{r}   almost everywhere,        œÑ   (  t  )    =    P  ^    (  t  )    S  ^    (  t  )     (    P  ^    (  t  )    S  ^    (  t  )    )   *     .        œÑ  t      normal-^  P   t   normal-^  S   t   superscript     normal-^  P   t   normal-^  S   t        {\mathbf{}}\tau(t)=\hat{P}(t)\hat{S}(t)\left(\hat{P}(t)\hat{S}(t)\right)^{*}.   almost everywhere,  with        A  *   =   A    (   A  3   )   +   A    .       superscript  A      A   superscript   superscript  A  3     A     {\mathbf{}}A^{*}=A(A^{3})^{+}A.     Here * denotes the group generalized inverse or Drazin inverse that is unique and given by       P   (  t  )    ,   S   (  t  )    ,    P  ^    (  t  )    ,    S  ^    (  t  )         P  t     S  t      normal-^  P   t      normal-^  S   t     {\mathbf{}}P(t),S(t),\hat{P}(t),\hat{S}(t)     where + denotes the Moore-Penrose pseudoinverse .  The matrices      F  r    (  t  )    ,    K  r    (  t  )    ,    L  r    (  t  )          subscript  F  r   t      subscript  K  r   t      subscript  L  r   t     {\mathbf{}}F_{r}(t),K_{r}(t),L_{r}(t)   must all be nonnegative symmetric . Then they constitute a solution of the OPE that determines the reduced-order LQG controller matrices     ùê±  r    (  0  )        subscript  ùê±  r   0    {\mathbf{x}}_{r}(0)   and       F  r    (  t  )    =    H   (  t  )    (    A   (  t  )    -   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )   C   (  t  )    -   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )     )   G   (  t  )    +    H  Àô    (  t  )    G  ‚Ä≤    (  t  )      ,         subscript  F  r   t       H  t      A  t     P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t  C  t     B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t    G  t      normal-Àô  H   t   superscript  G  normal-‚Ä≤   t      {\mathbf{}}F_{r}(t)=H(t)\left(A(t)-P(t)C^{\prime}(t)W^{-1}(t)C(t)-B(t)R^{-1}(t%
 )B^{\prime}(t)S(t)\right)G(t)+\dot{H}(t)G^{\prime}(t),   :         K  r    (  t  )    =   H   (  t  )   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )     ,         subscript  K  r   t     H  t  P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t     {\mathbf{}}K_{r}(t)=H(t)P(t)C^{\prime}(t)W^{-1}(t),            L  r    (  t  )    =    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )    G  ‚Ä≤    (  t  )     ,         subscript  L  r   t      superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t   superscript  G  normal-‚Ä≤   t     {\mathbf{}}L_{r}(t)=R^{-1}(t)B^{\prime}(t)S(t)G^{\prime}(t),            ùê±  r    (  0  )    =   H   (  0  )   E   (   ùê±   (  0  )    )     .         subscript  ùê±  r   0     H  0  E    ùê±  0      {\mathbf{x}}_{r}(0)=H(0)E({\mathbf{x}}(0)).          G   (  t  )    ,   H   (  t  )         G  t     H  t     {\mathbf{}}G(t),H(t)     In the equations above the matrices       G  ‚Ä≤    (  t  )   H   (  t  )    =   œÑ   (  t  )     ,    G   (  t  )    H  ‚Ä≤    (  t  )    =   I   n  r        formulae-sequence       superscript  G  normal-‚Ä≤   t  H  t     œÑ  t        G  t   superscript  H  normal-‚Ä≤   t    subscript  I   subscript  n  r       {\mathbf{}}G^{\prime}(t)H(t)=\tau(t),G(t)H^{\prime}(t)=I_{n_{r}}   are two matrices with the following properties:       P  ^    (  t  )    S  ^    (  t  )        normal-^  P   t   normal-^  S   t    {\mathbf{}}\hat{P}(t)\hat{S}(t)   almost everywhere.  They can be obtained from a projective factorization of      œÑ   (  t  )    P  ^    (  t  )    =    P  ^    (  t  )    œÑ  ‚Ä≤    (  t  )    =    P  ^    (  t  )     ,     œÑ  ‚Ä≤    (  t  )    S  ^    (  t  )    =    S  ^    (  t  )   œÑ   (  t  )    =    S  ^    (  t  )        formulae-sequence        œÑ  t   normal-^  P   t      normal-^  P   t   superscript  œÑ  normal-‚Ä≤   t           normal-^  P   t            superscript  œÑ  normal-‚Ä≤   t   normal-^  S   t      normal-^  S   t  œÑ  t           normal-^  S   t       {\mathbf{}}\tau(t)\hat{P}(t)=\hat{P}(t)\tau^{\prime}(t)=\hat{P}(t),\tau^{%
 \prime}(t)\hat{S}(t)=\hat{S}(t)\tau(t)=\hat{S}(t)   . 11  The OPE can be stated in many different ways that are all equivalent. To identify the equivalent representations the following identities are especially useful:         P  Àô    (  t  )    =      A   (  t  )   P   (  t  )    +   P   (  t  )    A  ‚Ä≤    (  t  )     -   P   (  t  )    C  ‚Ä≤    (  t  )    W   -  1     (  t  )   C   (  t  )   P   (  t  )     +   V   (  t  )    +    œÑ  ‚üÇ    (  t  )    Œ®  1    (  t  )    œÑ  ‚üÇ  ‚Ä≤    (  t  )      ,         normal-Àô  P   t           A  t  P  t     P  t   superscript  A  normal-‚Ä≤   t      P  t   superscript  C  normal-‚Ä≤   t   superscript  W    1    t  C  t  P  t      V  t      subscript  œÑ  perpendicular-to   t   subscript  normal-Œ®  1   t   subscript   superscript  œÑ  normal-‚Ä≤   perpendicular-to   t      \dot{P}(t)=A(t)P(t)+P(t)A^{\prime}(t)-P(t)C^{\prime}(t)W^{-1}(t)C(t)P(t)+V(t)+%
 \tau_{\perp}(t)\Psi_{1}(t)\tau^{\prime}_{\perp}(t),     Using these identities one may for instance rewrite the first two of the optimal projection equations as follows:        P   (  0  )    =   E   (   ùê±   (  0  )    ùê±  ‚Ä≤    (  0  )    )     ,        P  0     E    ùê±  0   superscript  ùê±  normal-‚Ä≤   0      P(0)=E\left({\mathbf{x}}(0){\mathbf{x}}^{\prime}(0)\right),           -    S  Àô    (  t  )     =       A  ‚Ä≤    (  t  )   S   (  t  )    +   S   (  t  )   A   (  t  )     -   S   (  t  )   B   (  t  )    R   -  1     (  t  )    B  ‚Ä≤    (  t  )   S   (  t  )     +   Q   (  t  )    +    œÑ  ‚üÇ  ‚Ä≤    Œ®  2    (  t  )    œÑ  ‚üÇ    (  t  )      ,           normal-Àô  S   t             superscript  A  normal-‚Ä≤   t  S  t     S  t  A  t      S  t  B  t   superscript  R    1    t   superscript  B  normal-‚Ä≤   t  S  t      Q  t      subscript   superscript  œÑ  normal-‚Ä≤   perpendicular-to    subscript  normal-Œ®  2   t   subscript  œÑ  perpendicular-to   t      -\dot{S}(t)=A^{\prime}(t)S(t)+S(t)A(t)-S(t)B(t)R^{-1}(t)B^{\prime}(t)S(t)+Q(t)%
 +\tau^{\prime}_{\perp}\Psi_{2}(t)\tau_{\perp}(t),           S   (  T  )    =  F   .        S  T   F    {\mathbf{}}S(T)=F.        T   T   {\mathbf{}}T     This representation is both relatively simple and suitable for numerical computations.  If all the matrices in the reduced-order LQG problem formulation are time-invariant and if the horizon    +    A  i    P  i    C  i  ‚Ä≤     (     C  i    P  i    C  i  ‚Ä≤    +   W  i    )    -  1     C  i    P  i    A  i  ‚Ä≤           subscript  A  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i     subscript  W  i      1     subscript  C  i    subscript  P  i    subscript   superscript  A  normal-‚Ä≤   i      {\mathbf{}}+A_{i}P_{i}C^{\prime}_{i}(C_{i}P_{i}C^{\prime}_{i}+W_{i})^{-1}C_{i}%
 P_{i}A^{\prime}_{i}   tends to infinity, the optimal reduced-order LQG controller becomes time-invariant and so do the OPE . 12 In that case the derivatives on the left hand side of the OPE are zero.  Discrete-time  Similar to the continuous-time case, in the discrete-time case the difference with the conventional discrete-time full-order LQG problem is the a-priori fixed reduced-order     Œ®   i  +  1   2   =     (    A  i   -    A  i    P  i    C  i  ‚Ä≤     (     C  i    P  i    C  i  ‚Ä≤    +   W  i    )    -  1     C  i     )   ‚Ä≤     S  ^    i  +  1     (    A  i   -    A  i    P  i    C  i  ‚Ä≤     (     C  i    P  i    C  i  ‚Ä≤    +   W  i    )    -  1     C  i     )         subscript   superscript  normal-Œ®  2     i  1       superscript     subscript  A  i      subscript  A  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i     subscript  W  i      1     subscript  C  i     normal-‚Ä≤    subscript   normal-^  S     i  1       subscript  A  i      subscript  A  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i     subscript  W  i      1     subscript  C  i        {\mathbf{}}\Psi^{2}_{i+1}=\left(A_{i}-A_{i}P_{i}C^{\prime}_{i}(C_{i}P_{i}C^{%
 \prime}_{i}+W_{i})^{-1}C_{i}\right)^{\prime}\hat{S}_{i+1}\left(A_{i}-A_{i}P_{i%
 }C^{\prime}_{i}(C_{i}P_{i}C^{\prime}_{i}+W_{i})^{-1}C_{i}\right)           +    A  i  ‚Ä≤    S   i  +  1     B  i     (     B  i  ‚Ä≤    S   i  +  1     B  i    +   R  i    )    -  1     B  i  ‚Ä≤    S   i  +  1     A  i           subscript   superscript  A  normal-‚Ä≤   i    subscript  S    i  1     subscript  B  i    superscript       subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1     subscript  B  i     subscript  R  i      1     subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1     subscript  A  i      {\mathbf{}}+A^{\prime}_{i}S_{i+1}B_{i}(B^{\prime}_{i}S_{i+1}B_{i}+R_{i})^{-1}B%
 ^{\prime}_{i}S_{i+1}A_{i}              P   i  +  1    =     A  i    (    P  i   -    P  i    C  i  ‚Ä≤     (     C  i    P  i    C  i  ‚Ä≤    +   W  i    )    -  1     C  i    P  i     )    A  i  ‚Ä≤    +   V  i   +    œÑ    ‚üÇ   i  +  1      Œ®  i  1    œÑ    ‚üÇ   i  +  1    ‚Ä≤      ,    P  0   =   E   (    ùê±  0    ùê±   ‚Ä≤  0     )        formulae-sequence     subscript  P    i  1         subscript  A  i      subscript  P  i      subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i     subscript  W  i      1     subscript  C  i    subscript  P  i      subscript   superscript  A  normal-‚Ä≤   i     subscript  V  i      subscript  œÑ   perpendicular-to  absent    i  1      subscript   superscript  normal-Œ®  1   i    subscript   superscript  œÑ  normal-‚Ä≤    perpendicular-to  absent    i  1           subscript  P  0     E     subscript  ùê±  0    subscript   superscript  ùê±  normal-‚Ä≤   0        {\mathbf{}}P_{i+1}=A_{i}\left(P_{i}-P_{i}C^{\prime}_{i}\left(C_{i}P_{i}C^{%
 \prime}_{i}+W_{i}\right)^{-1}C_{i}P_{i}\right)A^{\prime}_{i}+V_{i}+\tau_{\perp
 i%
 +1}\Psi^{1}_{i}\tau^{\prime}_{\perp i+1},P_{0}=E\left({\mathbf{x}}_{0}{\mathbf%
 {x^{\prime}}}_{0}\right)             S  i   =     A  i  ‚Ä≤    (    S   i  +  1    -    S   i  +  1     B  i     (     B  i  ‚Ä≤    S   i  +  1     B  i    +   R  i    )    -  1     B  i  ‚Ä≤    S   i  +  1      )    A  i    +   Q  i   +    œÑ    ‚üÇ  i   ‚Ä≤    Œ®   i  +  1   2    œÑ    ‚üÇ  i       ,    S  N   =  F      formulae-sequence     subscript  S  i        subscript   superscript  A  normal-‚Ä≤   i      subscript  S    i  1       subscript  S    i  1     subscript  B  i    superscript       subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1     subscript  B  i     subscript  R  i      1     subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1       subscript  A  i     subscript  Q  i      subscript   superscript  œÑ  normal-‚Ä≤    perpendicular-to  absent  i     subscript   superscript  normal-Œ®  2     i  1     subscript  œÑ   perpendicular-to  absent  i          subscript  S  N   F     {\mathbf{}}S_{i}=A^{\prime}_{i}\left(S_{i+1}-S_{i+1}B_{i}\left(B^{\prime}_{i}S%
 _{i+1}B_{i}+R_{i}\right)^{-1}B^{\prime}_{i}S_{i+1}\right)A_{i}+Q_{i}+\tau^{%
 \prime}_{\perp i}\Psi^{2}_{i+1}\tau_{\perp i},S_{N}=F        Then the discrete-time OPE is         P  ^    i  +  1    =    1  /  2    (     œÑ   i  +  1     Œ®  i  1    +    Œ®  i  1    œÑ   i  +  1   ‚Ä≤     )     ,      P  ^   0   =   E   (   ùê±   (  0  )    )   E    (   ùê±   (  0  )    )   ‚Ä≤     ,    r  a  n  k   (    P  ^   i   )    =   n  r        formulae-sequence     subscript   normal-^  P     i  1        1  2        subscript  œÑ    i  1     superscript   subscript  normal-Œ®  i   1       superscript   subscript  normal-Œ®  i   1    subscript   superscript  œÑ  normal-‚Ä≤     i  1         formulae-sequence     subscript   normal-^  P   0     E    ùê±  0   E   superscript    ùê±  0   normal-‚Ä≤         r  a  n  k   subscript   normal-^  P   i     subscript  n  r       {\mathbf{}}\hat{P}_{i+1}=1/2(\tau_{i+1}\Psi_{i}^{1}+\Psi_{i}^{1}\tau^{\prime}_%
 {i+1}),\hat{P}_{0}=E({\mathbf{x}}(0))E({\mathbf{x}}(0))^{\prime},rank(\hat{P}_%
 {i})=n_{r}   .         S  ^   i   =    1  /  2    (     œÑ  i  ‚Ä≤    Œ®   i  +  1   2    +    Œ®   i  +  1   2    œÑ  i     )     ,      S  ^   N   =  0   ,    r  a  n  k   (    S  ^   i   )    =   n  r        formulae-sequence     subscript   normal-^  S   i       1  2        subscript   superscript  œÑ  normal-‚Ä≤   i    superscript   subscript  normal-Œ®    i  1    2       superscript   subscript  normal-Œ®    i  1    2    subscript  œÑ  i        formulae-sequence     subscript   normal-^  S   N   0       r  a  n  k   subscript   normal-^  S   i     subscript  n  r       {\mathbf{}}\hat{S}_{i}=1/2(\tau^{\prime}_{i}\Psi_{i+1}^{2}+\Psi_{i+1}^{2}\tau_%
 {i}),\hat{S}_{N}=0,rank(\hat{S}_{i})=n_{r}   .        œÑ  i   =     P  ^   i     S  ^   i     (     P  ^   i     S  ^   i    )   *     .       subscript  œÑ  i      subscript   normal-^  P   i    subscript   normal-^  S   i    superscript     subscript   normal-^  P   i    subscript   normal-^  S   i         {\mathbf{}}\tau_{i}=\hat{P}_{i}\hat{S}_{i}\left(\hat{P}_{i}\hat{S}_{i}\right)^%
 {*}.   almost everywhere,       P  i   ,   S  i   ,    P  ^   i   ,    S  ^   i       subscript  P  i    subscript  S  i    subscript   normal-^  P   i    subscript   normal-^  S   i     {\mathbf{}}P_{i},S_{i},\hat{P}_{i},\hat{S}_{i}   almost everywhere.  The oblique projection matrix is given by       F  i  r   ,   K  i  r   ,   L  i  r       superscript   subscript  F  i   r    superscript   subscript  K  i   r    superscript   subscript  L  i   r     {\mathbf{}}F_{i}^{r},K_{i}^{r},L_{i}^{r}     The nonnegative symmetric matrices     ùê±  0  r     superscript   subscript  ùê±  0   r    {\mathbf{x}}_{0}^{r}   that solve the discrete-time OPE determine the reduced-order LQG controller matrices      F  i  r   =    H   i  +  1     (    A  i   -    P  i    C  i  ‚Ä≤     (     C  i    P  i    C  i  ‚Ä≤    +   W  i    )    -  1     C  i    -    B  i     (     B  i  ‚Ä≤    S   i  +  1     B  i    +   R  i    )    -  1     B  i  ‚Ä≤    S   i  +  1      )    G  i  ‚Ä≤     ,       superscript   subscript  F  i   r      subscript  H    i  1       subscript  A  i      subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i     subscript  W  i      1     subscript  C  i       subscript  B  i    superscript       subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1     subscript  B  i     subscript  R  i      1     subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1       subscript   superscript  G  normal-‚Ä≤   i      {\mathbf{}}F_{i}^{r}=H_{i+1}\left(A_{i}-P_{i}C^{\prime}_{i}\left(C_{i}P_{i}C^{%
 \prime}_{i}+W_{i}\right)^{-1}C_{i}-B_{i}\left(B^{\prime}_{i}S_{i+1}B_{i}+R_{i}%
 \right)^{-1}B^{\prime}_{i}S_{i+1}\right)G^{\prime}_{i},   and      K  i  r   =    H   i  +  1     P  i    C  i  ‚Ä≤     (     C  i    P  i    C  i  ‚Ä≤    +   W  i    )    -  1      ,       superscript   subscript  K  i   r      subscript  H    i  1     subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-‚Ä≤   i     subscript  W  i      1       {\mathbf{}}K_{i}^{r}=H_{i+1}P_{i}C^{\prime}_{i}\left(C_{i}P_{i}C^{\prime}_{i}+%
 W_{i}\right)^{-1},   :        L  i  r   =     (     B  i  ‚Ä≤    S   i  +  1     B  i    +   R  i    )    -  1     B  i  ‚Ä≤    S   i  +  1     G  i  ‚Ä≤     ,       superscript   subscript  L  i   r      superscript       subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1     subscript  B  i     subscript  R  i      1     subscript   superscript  B  normal-‚Ä≤   i    subscript  S    i  1     subscript   superscript  G  normal-‚Ä≤   i      {\mathbf{}}L_{i}^{r}=\left(B^{\prime}_{i}S_{i+1}B_{i}+R_{i}\right)^{-1}B^{%
 \prime}_{i}S_{i+1}G^{\prime}_{i},           ùê±  0  r   =    H  0   E   (   ùê±  0   )     .       superscript   subscript  ùê±  0   r      subscript  H  0   E   subscript  ùê±  0      {\mathbf{x}}_{0}^{r}=H_{0}E({\mathbf{x}}_{0}).          G  i   ,   H  i       subscript  G  i    subscript  H  i     {\mathbf{}}G_{i},H_{i}            G  i  ‚Ä≤    H  i    =   œÑ  i    ,     G  i    H  i  ‚Ä≤    =   I   n  r        formulae-sequence       subscript   superscript  G  normal-‚Ä≤   i    subscript  H  i     subscript  œÑ  i         subscript  G  i    subscript   superscript  H  normal-‚Ä≤   i     subscript  I   subscript  n  r       {\mathbf{}}G^{\prime}_{i}H_{i}=\tau_{i},G_{i}H^{\prime}_{i}=I_{n_{r}}     In the equations above the matrices      P  ^   i     S  ^   i        subscript   normal-^  P   i    subscript   normal-^  S   i     {\mathbf{}}\hat{P}_{i}\hat{S}_{i}   are two matrices with the following properties:         œÑ  i     P  ^   i    =     P  ^   i    œÑ  i  ‚Ä≤    =    P  ^   i    ,     œÑ  i  ‚Ä≤     S  ^   i    =     S  ^   i    œÑ  i    =    S  ^   i       formulae-sequence         subscript  œÑ  i    subscript   normal-^  P   i       subscript   normal-^  P   i    subscript   superscript  œÑ  normal-‚Ä≤   i          subscript   normal-^  P   i            subscript   superscript  œÑ  normal-‚Ä≤   i    subscript   normal-^  S   i       subscript   normal-^  S   i    subscript  œÑ  i          subscript   normal-^  S   i       {\mathbf{}}\tau_{i}\hat{P}_{i}=\hat{P}_{i}\tau^{\prime}_{i}=\hat{P}_{i},\tau^{%
 \prime}_{i}\hat{S}_{i}=\hat{S}_{i}\tau_{i}=\hat{S}_{i}   almost everywhere.  They can be obtained from a projective factorization of   N   N   {\mathbf{}}N   . 13 To identify equivalent representations of the discrete-time OPE the following identities are especially useful:  $${\mathbf{}}\tau_i\hat{P}_i=\hat{P}_i\tau'_i=\hat{P}_i, \tau'_i\hat{S}_i=\hat{S}_i\tau_i=\hat{S}_i$$  As in the continuous-time case if all the matrices in the problem formulation are time-invariant and if the horizon ${\mathbf{}}N$ tends to infinity the reduced-order LQG controller becomes time-invariant. Then the discrete-time OPE converge to a steady state solution that determines the time-invariant reduced-order LQG controller. 14  The discrete-time OPE apply also to discrete-time systems with variable state, input and output dimensions (discrete-time systems with time-varying dimensions). 15 Such systems arise in the case of digital controller design if the sampling occurs asynchronously.  References    "  Category:Optimal control  Category:Control theory  Category:Stochastic control     ‚Ü©  ‚Ü©  ‚Ü©   ‚Ü©  [ http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=19948&objectType; ;=file Associated software download from Matlab Central]. ‚Ü©  [ http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=20014&objectType; ;=FILE Associated software download from Matlab Central]. ‚Ü©  ‚Ü©  ‚Ü©           
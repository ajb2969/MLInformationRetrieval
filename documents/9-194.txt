   Binomial inverse theorem      Binomial inverse theorem   In mathematics , the binomial inverse theorem is useful for expressing matrix inverses in different ways.  If A , U , B , V are matrices of sizes p × p , p × q , q × q , q × p , respectively, then        (   𝐀  +  𝐔𝐁𝐕   )    -  1    =    𝐀   -  1    -    𝐀   -  1    𝐔𝐁    (   𝐁  +    𝐁𝐕𝐀   -  1    𝐔𝐁    )    -  1     𝐁𝐕𝐀   -  1           superscript    𝐀  𝐔𝐁𝐕     1       superscript  𝐀    1       superscript  𝐀    1    𝐔𝐁   superscript    𝐁     superscript  𝐁𝐕𝐀    1    𝐔𝐁      1     superscript  𝐁𝐕𝐀    1        \left(\mathbf{A}+\mathbf{UBV}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}%
 \mathbf{UB}\left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}\mathbf{%
 BVA}^{-1}     provided A and B + BVA −1 UB are nonsingular. Nonsingularity of the latter requires that B −1 exist since it equals and the rank of the latter cannot exceed the rank of B . 1  Since B is invertible, the two B terms flanking the parenthetical quantity inverse in the right-hand side can be replaced with which results in         (   𝐀  +  𝐔𝐁𝐕   )    -  1    =    𝐀   -  1    -    𝐀   -  1    𝐔    (    𝐁   -  1    +    𝐕𝐀   -  1    𝐔    )    -  1     𝐕𝐀   -  1       .       superscript    𝐀  𝐔𝐁𝐕     1       superscript  𝐀    1       superscript  𝐀    1    𝐔   superscript     superscript  𝐁    1       superscript  𝐕𝐀    1    𝐔      1     superscript  𝐕𝐀    1        \left(\mathbf{A}+\mathbf{UBV}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}%
 \mathbf{U}\left(\mathbf{B}^{-1}+\mathbf{VA}^{-1}\mathbf{U}\right)^{-1}\mathbf{%
 VA}^{-1}.     This is the Woodbury matrix identity , which can also be derived using matrix blockwise inversion .  A more general formula exists when B is singular and possibly even non-square: 2         (   𝐀  +  𝐔𝐁𝐕   )    -  1    =    𝐀   -  1    -    𝐀   -  1    𝐔    (   𝐈  +    𝐁𝐕𝐀   -  1    𝐔    )    -  1     𝐁𝐕𝐀   -  1       .       superscript    𝐀  𝐔𝐁𝐕     1       superscript  𝐀    1       superscript  𝐀    1    𝐔   superscript    𝐈     superscript  𝐁𝐕𝐀    1    𝐔      1     superscript  𝐁𝐕𝐀    1        (\mathbf{A+UBV})^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}\mathbf{U}(\mathbf{I+BVA}%
 ^{-1}\mathbf{U})^{-1}\mathbf{BVA}^{-1}.     Formulas also exist for certain cases in which A is singular. 3  Verification  First notice that         (   𝐀  +  𝐔𝐁𝐕   )    𝐀   -  1    𝐔𝐁   =   𝐔𝐁  +    𝐔𝐁𝐕𝐀   -  1    𝐔𝐁    =   𝐔   (   𝐁  +    𝐁𝐕𝐀   -  1    𝐔𝐁    )     .            𝐀  𝐔𝐁𝐕    superscript  𝐀    1    𝐔𝐁     𝐔𝐁     superscript  𝐔𝐁𝐕𝐀    1    𝐔𝐁           𝐔    𝐁     superscript  𝐁𝐕𝐀    1    𝐔𝐁        \left(\mathbf{A}+\mathbf{UBV}\right)\mathbf{A}^{-1}\mathbf{UB}=\mathbf{UB}+%
 \mathbf{UBVA}^{-1}\mathbf{UB}=\mathbf{U}\left(\mathbf{B}+\mathbf{BVA}^{-1}%
 \mathbf{UB}\right).     Now multiply the matrix we wish to invert by its alleged inverse:       (   𝐀  +  𝐔𝐁𝐕   )    (    𝐀   -  1    -    𝐀   -  1    𝐔𝐁    (   𝐁  +    𝐁𝐕𝐀   -  1    𝐔𝐁    )    -  1     𝐁𝐕𝐀   -  1      )         𝐀  𝐔𝐁𝐕      superscript  𝐀    1       superscript  𝐀    1    𝐔𝐁   superscript    𝐁     superscript  𝐁𝐕𝐀    1    𝐔𝐁      1     superscript  𝐁𝐕𝐀    1        \left(\mathbf{A}+\mathbf{UBV}\right)\left(\mathbf{A}^{-1}-\mathbf{A}^{-1}%
 \mathbf{UB}\left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}\mathbf{%
 BVA}^{-1}\right)          =     𝐈  p   +   𝐔𝐁𝐕𝐀   -  1     -   𝐔   (   𝐁  +    𝐁𝐕𝐀   -  1    𝐔𝐁    )     (   𝐁  +    𝐁𝐕𝐀   -  1    𝐔𝐁    )    -  1     𝐁𝐕𝐀   -  1          absent       subscript  𝐈  p    superscript  𝐔𝐁𝐕𝐀    1       𝐔    𝐁     superscript  𝐁𝐕𝐀    1    𝐔𝐁     superscript    𝐁     superscript  𝐁𝐕𝐀    1    𝐔𝐁      1     superscript  𝐁𝐕𝐀    1        =\mathbf{I}_{p}+\mathbf{UBVA}^{-1}-\mathbf{U}\left(\mathbf{B}+\mathbf{BVA}^{-1%
 }\mathbf{UB}\right)\left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}%
 \mathbf{BVA}^{-1}          =     𝐈  p   +   𝐔𝐁𝐕𝐀   -  1     -   𝐔𝐁𝐕𝐀   -  1     =    𝐈  p          absent       subscript  𝐈  p    superscript  𝐔𝐁𝐕𝐀    1      superscript  𝐔𝐁𝐕𝐀    1           subscript  𝐈  p      =\mathbf{I}_{p}+\mathbf{UBVA}^{-1}-\mathbf{UBVA}^{-1}=\mathbf{I}_{p}\!     which verifies that it is the inverse.  So we get that if A −1 and     (   𝐁  +    𝐁𝐕𝐀   -  1    𝐔𝐁    )    -  1      superscript    𝐁     superscript  𝐁𝐕𝐀    1    𝐔𝐁      1     \left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}   exist, then     (   𝐀  +  𝐔𝐁𝐕   )    -  1      superscript    𝐀  𝐔𝐁𝐕     1     \left(\mathbf{A}+\mathbf{UBV}\right)^{-1}   exists and is given by the theorem above. 4  Special cases  First  If p = q and U = V = I p is the identity matrix, then         (   𝐀  +  𝐁   )    -  1    =    𝐀   -  1    -    𝐀   -  1    𝐁    (   𝐁  +    𝐁𝐀   -  1    𝐁    )    -  1     𝐁𝐀   -  1       .       superscript    𝐀  𝐁     1       superscript  𝐀    1       superscript  𝐀    1    𝐁   superscript    𝐁     superscript  𝐁𝐀    1    𝐁      1     superscript  𝐁𝐀    1        \left(\mathbf{A}+\mathbf{B}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}\mathbf%
 {B}\left(\mathbf{B}+\mathbf{BA}^{-1}\mathbf{B}\right)^{-1}\mathbf{BA}^{-1}.     Remembering the identity         (  𝐂𝐃  )    -  1    =    𝐃   -  1     𝐂   -  1      ,       superscript  𝐂𝐃    1       superscript  𝐃    1     superscript  𝐂    1       \left(\mathbf{C}\mathbf{D}\right)^{-1}=\mathbf{D}^{-1}\mathbf{C}^{-1},   we can also express the previous equation in the simpler form as         (   𝐀  +  𝐁   )    -  1    =    𝐀   -  1    -    𝐀   -  1      (   𝐈  +   𝐁𝐀   -  1     )    -  1     𝐁𝐀   -  1       .       superscript    𝐀  𝐁     1       superscript  𝐀    1       superscript  𝐀    1     superscript    𝐈   superscript  𝐁𝐀    1       1     superscript  𝐁𝐀    1        \left(\mathbf{A}+\mathbf{B}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}\left(%
 \mathbf{I}+\mathbf{B}\mathbf{A}^{-1}\right)^{-1}\mathbf{B}\mathbf{A}^{-1}.     Second  If B = I q is the identity matrix and q = 1, then U is a column vector, written u , and V is a row vector, written v T . Then the theorem implies the Sherman-Morrison formula :         (   𝐀  +   𝐮𝐯  T    )    -  1    =    𝐀   -  1    -     𝐀   -  1     𝐮𝐯  T    𝐀   -  1      1  +    𝐯  T    𝐀   -  1    𝐮       .       superscript    𝐀   superscript  𝐮𝐯  normal-T      1       superscript  𝐀    1         superscript  𝐀    1     superscript  𝐮𝐯  normal-T    superscript  𝐀    1       1     superscript  𝐯  normal-T    superscript  𝐀    1    𝐮        \left(\mathbf{A}+\mathbf{uv}^{\mathrm{T}}\right)^{-1}=\mathbf{A}^{-1}-\frac{%
 \mathbf{A}^{-1}\mathbf{uv}^{\mathrm{T}}\mathbf{A}^{-1}}{1+\mathbf{v}^{\mathrm{%
 T}}\mathbf{A}^{-1}\mathbf{u}}.     This is useful if one has a matrix A with a known inverse A −1 and one needs to invert matrices of the form A + uv T quickly for various u and v .  Third  If we set A = I p and B = I q , we get         (    𝐈  p   +  𝐔𝐕   )    -  1    =    𝐈  p   -   𝐔    (    𝐈  q   +  𝐕𝐔   )    -  1    𝐕     .       superscript     subscript  𝐈  p   𝐔𝐕     1       subscript  𝐈  p     𝐔   superscript     subscript  𝐈  q   𝐕𝐔     1    𝐕      \left(\mathbf{I}_{p}+\mathbf{UV}\right)^{-1}=\mathbf{I}_{p}-\mathbf{U}\left(%
 \mathbf{I}_{q}+\mathbf{VU}\right)^{-1}\mathbf{V}.     In particular, if q = 1, then         (   𝐈  +   𝐮𝐯  T    )    -  1    =   𝐈  -    𝐮𝐯  T    1  +    𝐯  T   𝐮       ,       superscript    𝐈   superscript  𝐮𝐯  normal-T      1      𝐈     superscript  𝐮𝐯  normal-T     1     superscript  𝐯  normal-T   𝐮        \left(\mathbf{I}+\mathbf{uv}^{\mathrm{T}}\right)^{-1}=\mathbf{I}-\frac{\mathbf%
 {uv}^{\mathrm{T}}}{1+\mathbf{v}^{\mathrm{T}}\mathbf{u}},     which is a particular case of the Sherman-Morrison formula given above.  See also   Invertible matrix  Matrix determinant lemma  Moore-Penrose pseudoinverse#Updating the pseudoinverse   References    "  Category:Linear algebra  Category:Matrix theory  Category:Theorems in algebra     Henderson, H. V., and Searle, S. R. (1981), "On deriving the inverse of a sum of matrices", SIAM Review 23, pp. 53-60. ↩   Kurt S. Riedel, "A Sherman—Morrison—Woodbury Identity for Rank Augmenting Matrices with Application to Centering", SIAM Journal on Matrix Analysis and Applications , 13 (1992)659-662, preprint  ↩  ↩     
   Binomial inverse theorem      Binomial inverse theorem   In mathematics , the binomial inverse theorem is useful for expressing matrix inverses in different ways.  If A , U , B , V are matrices of sizes p Ã— p , p Ã— q , q Ã— q , q Ã— p , respectively, then        (   ğ€  +  ğ”ğğ•   )    -  1    =    ğ€   -  1    -    ğ€   -  1    ğ”ğ    (   ğ  +    ğğ•ğ€   -  1    ğ”ğ    )    -  1     ğğ•ğ€   -  1           superscript    ğ€  ğ”ğğ•     1       superscript  ğ€    1       superscript  ğ€    1    ğ”ğ   superscript    ğ     superscript  ğğ•ğ€    1    ğ”ğ      1     superscript  ğğ•ğ€    1        \left(\mathbf{A}+\mathbf{UBV}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}%
 \mathbf{UB}\left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}\mathbf{%
 BVA}^{-1}     provided A and B + BVA âˆ’1 UB are nonsingular. Nonsingularity of the latter requires that B âˆ’1 exist since it equals and the rank of the latter cannot exceed the rank of B . 1  Since B is invertible, the two B terms flanking the parenthetical quantity inverse in the right-hand side can be replaced with which results in         (   ğ€  +  ğ”ğğ•   )    -  1    =    ğ€   -  1    -    ğ€   -  1    ğ”    (    ğ   -  1    +    ğ•ğ€   -  1    ğ”    )    -  1     ğ•ğ€   -  1       .       superscript    ğ€  ğ”ğğ•     1       superscript  ğ€    1       superscript  ğ€    1    ğ”   superscript     superscript  ğ    1       superscript  ğ•ğ€    1    ğ”      1     superscript  ğ•ğ€    1        \left(\mathbf{A}+\mathbf{UBV}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}%
 \mathbf{U}\left(\mathbf{B}^{-1}+\mathbf{VA}^{-1}\mathbf{U}\right)^{-1}\mathbf{%
 VA}^{-1}.     This is the Woodbury matrix identity , which can also be derived using matrix blockwise inversion .  A more general formula exists when B is singular and possibly even non-square: 2         (   ğ€  +  ğ”ğğ•   )    -  1    =    ğ€   -  1    -    ğ€   -  1    ğ”    (   ğˆ  +    ğğ•ğ€   -  1    ğ”    )    -  1     ğğ•ğ€   -  1       .       superscript    ğ€  ğ”ğğ•     1       superscript  ğ€    1       superscript  ğ€    1    ğ”   superscript    ğˆ     superscript  ğğ•ğ€    1    ğ”      1     superscript  ğğ•ğ€    1        (\mathbf{A+UBV})^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}\mathbf{U}(\mathbf{I+BVA}%
 ^{-1}\mathbf{U})^{-1}\mathbf{BVA}^{-1}.     Formulas also exist for certain cases in which A is singular. 3  Verification  First notice that         (   ğ€  +  ğ”ğğ•   )    ğ€   -  1    ğ”ğ   =   ğ”ğ  +    ğ”ğğ•ğ€   -  1    ğ”ğ    =   ğ”   (   ğ  +    ğğ•ğ€   -  1    ğ”ğ    )     .            ğ€  ğ”ğğ•    superscript  ğ€    1    ğ”ğ     ğ”ğ     superscript  ğ”ğğ•ğ€    1    ğ”ğ           ğ”    ğ     superscript  ğğ•ğ€    1    ğ”ğ        \left(\mathbf{A}+\mathbf{UBV}\right)\mathbf{A}^{-1}\mathbf{UB}=\mathbf{UB}+%
 \mathbf{UBVA}^{-1}\mathbf{UB}=\mathbf{U}\left(\mathbf{B}+\mathbf{BVA}^{-1}%
 \mathbf{UB}\right).     Now multiply the matrix we wish to invert by its alleged inverse:       (   ğ€  +  ğ”ğğ•   )    (    ğ€   -  1    -    ğ€   -  1    ğ”ğ    (   ğ  +    ğğ•ğ€   -  1    ğ”ğ    )    -  1     ğğ•ğ€   -  1      )         ğ€  ğ”ğğ•      superscript  ğ€    1       superscript  ğ€    1    ğ”ğ   superscript    ğ     superscript  ğğ•ğ€    1    ğ”ğ      1     superscript  ğğ•ğ€    1        \left(\mathbf{A}+\mathbf{UBV}\right)\left(\mathbf{A}^{-1}-\mathbf{A}^{-1}%
 \mathbf{UB}\left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}\mathbf{%
 BVA}^{-1}\right)          =     ğˆ  p   +   ğ”ğğ•ğ€   -  1     -   ğ”   (   ğ  +    ğğ•ğ€   -  1    ğ”ğ    )     (   ğ  +    ğğ•ğ€   -  1    ğ”ğ    )    -  1     ğğ•ğ€   -  1          absent       subscript  ğˆ  p    superscript  ğ”ğğ•ğ€    1       ğ”    ğ     superscript  ğğ•ğ€    1    ğ”ğ     superscript    ğ     superscript  ğğ•ğ€    1    ğ”ğ      1     superscript  ğğ•ğ€    1        =\mathbf{I}_{p}+\mathbf{UBVA}^{-1}-\mathbf{U}\left(\mathbf{B}+\mathbf{BVA}^{-1%
 }\mathbf{UB}\right)\left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}%
 \mathbf{BVA}^{-1}          =     ğˆ  p   +   ğ”ğğ•ğ€   -  1     -   ğ”ğğ•ğ€   -  1     =    ğˆ  p          absent       subscript  ğˆ  p    superscript  ğ”ğğ•ğ€    1      superscript  ğ”ğğ•ğ€    1           subscript  ğˆ  p      =\mathbf{I}_{p}+\mathbf{UBVA}^{-1}-\mathbf{UBVA}^{-1}=\mathbf{I}_{p}\!     which verifies that it is the inverse.  So we get that if A âˆ’1 and     (   ğ  +    ğğ•ğ€   -  1    ğ”ğ    )    -  1      superscript    ğ     superscript  ğğ•ğ€    1    ğ”ğ      1     \left(\mathbf{B}+\mathbf{BVA}^{-1}\mathbf{UB}\right)^{-1}   exist, then     (   ğ€  +  ğ”ğğ•   )    -  1      superscript    ğ€  ğ”ğğ•     1     \left(\mathbf{A}+\mathbf{UBV}\right)^{-1}   exists and is given by the theorem above. 4  Special cases  First  If p = q and U = V = I p is the identity matrix, then         (   ğ€  +  ğ   )    -  1    =    ğ€   -  1    -    ğ€   -  1    ğ    (   ğ  +    ğğ€   -  1    ğ    )    -  1     ğğ€   -  1       .       superscript    ğ€  ğ     1       superscript  ğ€    1       superscript  ğ€    1    ğ   superscript    ğ     superscript  ğğ€    1    ğ      1     superscript  ğğ€    1        \left(\mathbf{A}+\mathbf{B}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}\mathbf%
 {B}\left(\mathbf{B}+\mathbf{BA}^{-1}\mathbf{B}\right)^{-1}\mathbf{BA}^{-1}.     Remembering the identity         (  ğ‚ğƒ  )    -  1    =    ğƒ   -  1     ğ‚   -  1      ,       superscript  ğ‚ğƒ    1       superscript  ğƒ    1     superscript  ğ‚    1       \left(\mathbf{C}\mathbf{D}\right)^{-1}=\mathbf{D}^{-1}\mathbf{C}^{-1},   we can also express the previous equation in the simpler form as         (   ğ€  +  ğ   )    -  1    =    ğ€   -  1    -    ğ€   -  1      (   ğˆ  +   ğğ€   -  1     )    -  1     ğğ€   -  1       .       superscript    ğ€  ğ     1       superscript  ğ€    1       superscript  ğ€    1     superscript    ğˆ   superscript  ğğ€    1       1     superscript  ğğ€    1        \left(\mathbf{A}+\mathbf{B}\right)^{-1}=\mathbf{A}^{-1}-\mathbf{A}^{-1}\left(%
 \mathbf{I}+\mathbf{B}\mathbf{A}^{-1}\right)^{-1}\mathbf{B}\mathbf{A}^{-1}.     Second  If B = I q is the identity matrix and q = 1, then U is a column vector, written u , and V is a row vector, written v T . Then the theorem implies the Sherman-Morrison formula :         (   ğ€  +   ğ®ğ¯  T    )    -  1    =    ğ€   -  1    -     ğ€   -  1     ğ®ğ¯  T    ğ€   -  1      1  +    ğ¯  T    ğ€   -  1    ğ®       .       superscript    ğ€   superscript  ğ®ğ¯  normal-T      1       superscript  ğ€    1         superscript  ğ€    1     superscript  ğ®ğ¯  normal-T    superscript  ğ€    1       1     superscript  ğ¯  normal-T    superscript  ğ€    1    ğ®        \left(\mathbf{A}+\mathbf{uv}^{\mathrm{T}}\right)^{-1}=\mathbf{A}^{-1}-\frac{%
 \mathbf{A}^{-1}\mathbf{uv}^{\mathrm{T}}\mathbf{A}^{-1}}{1+\mathbf{v}^{\mathrm{%
 T}}\mathbf{A}^{-1}\mathbf{u}}.     This is useful if one has a matrix A with a known inverse A âˆ’1 and one needs to invert matrices of the form A + uv T quickly for various u and v .  Third  If we set A = I p and B = I q , we get         (    ğˆ  p   +  ğ”ğ•   )    -  1    =    ğˆ  p   -   ğ”    (    ğˆ  q   +  ğ•ğ”   )    -  1    ğ•     .       superscript     subscript  ğˆ  p   ğ”ğ•     1       subscript  ğˆ  p     ğ”   superscript     subscript  ğˆ  q   ğ•ğ”     1    ğ•      \left(\mathbf{I}_{p}+\mathbf{UV}\right)^{-1}=\mathbf{I}_{p}-\mathbf{U}\left(%
 \mathbf{I}_{q}+\mathbf{VU}\right)^{-1}\mathbf{V}.     In particular, if q = 1, then         (   ğˆ  +   ğ®ğ¯  T    )    -  1    =   ğˆ  -    ğ®ğ¯  T    1  +    ğ¯  T   ğ®       ,       superscript    ğˆ   superscript  ğ®ğ¯  normal-T      1      ğˆ     superscript  ğ®ğ¯  normal-T     1     superscript  ğ¯  normal-T   ğ®        \left(\mathbf{I}+\mathbf{uv}^{\mathrm{T}}\right)^{-1}=\mathbf{I}-\frac{\mathbf%
 {uv}^{\mathrm{T}}}{1+\mathbf{v}^{\mathrm{T}}\mathbf{u}},     which is a particular case of the Sherman-Morrison formula given above.  See also   Invertible matrix  Matrix determinant lemma  Moore-Penrose pseudoinverse#Updating the pseudoinverse   References    "  Category:Linear algebra  Category:Matrix theory  Category:Theorems in algebra     Henderson, H. V., and Searle, S. R. (1981), "On deriving the inverse of a sum of matrices", SIAM Review 23, pp. 53-60. â†©   Kurt S. Riedel, "A Shermanâ€”Morrisonâ€”Woodbury Identity for Rank Augmenting Matrices with Application to Centering", SIAM Journal on Matrix Analysis and Applications , 13 (1992)659-662, preprint  â†©  â†©     
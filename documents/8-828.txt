   Naccache–Stern cryptosystem      Naccache–Stern cryptosystem   Note: this is not to be confused with the Naccache–Stern knapsack cryptosystem .  The Naccache–Stern cryptosystem is a homomorphic  public-key cryptosystem whose security rests on the higher residuosity problem . The Naccache–Stern cryptosystem was discovered by David Naccache and Jacques Stern in 1998.  Scheme Definition  Like many public key cryptosystems , this scheme works in the group     (    ℤ  /  n   ℤ   )   *     superscript      ℤ  n   ℤ      (\mathbb{Z}/n\mathbb{Z})^{*}   where n is a product of two large primes . This scheme is homomorphic and hence malleable .  Key Generation   Pick a family of k small distinct primes  p 1 ,..., p k .  Divide the set in half and set    u  =    ∏   i  =  1    k  /  2     p  i        u    superscript   subscript  product    i  1      k  2     subscript  p  i      u=\prod_{i=1}^{k/2}p_{i}   and    v  =    ∏    k  /  2   +  1   k    p  i        v    superscript   subscript  product      k  2   1    k    subscript  p  i      v=\prod_{k/2+1}^{k}p_{i}   .  Set    σ  =   u  v   =    ∏   i  =  1   k    p  i          σ    u  v          superscript   subscript  product    i  1    k    subscript  p  i       \sigma=uv=\prod_{i=1}^{k}p_{i}     Choose large primes a and b such that both p = 2 au +1 and q =2 bv +1 are prime.  Set n = pq .  Choose a random g mod n such that g has order φ( n )/4.   The public key is the numbers σ, n , g and the private key is the pair p , q .  When k =1 this is essentially the Benaloh cryptosystem .  Message Encryption  This system allows encryption of a message m in the group     ℤ  /  σ   ℤ        ℤ  σ   ℤ    \mathbb{Z}/\sigma\mathbb{Z}   .   Pick a random    x  ∈    ℤ  /  n   ℤ       x      ℤ  n   ℤ     x\in\mathbb{Z}/n\mathbb{Z}   .  Calculate     E   (  m  )    =     x  σ    g  m    mod  n         E  m    modulo     superscript  x  σ    superscript  g  m    n     E(m)=x^{\sigma}g^{m}\mod n      Then E(m) is an encryption of the message m .  Message Decryption  To decrypt, we first find m mod p i for each i , and then we apply the Chinese remainder theorem to calculate m mod   σ   σ   \sigma   .  Given a ciphertext c , to decrypt, we calculate        c  i   ≡    c    ϕ   (  n  )    /   p  i     mod  n        subscript  c  i    modulo   superscript  c      ϕ  n    subscript  p  i     n     c_{i}\equiv c^{\phi(n)/p_{i}}\mod n   . Thus          c    ϕ   (  n  )    /   p  i       ≡       x    σ  ϕ   (  n  )    /   p  i      g    m  ϕ   (  n  )    /   p  i      mod  n          ≡      g     (    m  i   +    y  i    p  i     )   ϕ   (  n  )    /   p  i     mod  n          ≡      g     m  i   ϕ   (  n  )    /   p  i     mod  n          superscript  c      ϕ  n    subscript  p  i       modulo     superscript  x      σ  ϕ  n    subscript  p  i      superscript  g      m  ϕ  n    subscript  p  i      n     absent    modulo   superscript  g         subscript  m  i      subscript  y  i    subscript  p  i     ϕ  n    subscript  p  i     n     absent    modulo   superscript  g       subscript  m  i   ϕ  n    subscript  p  i     n      \begin{matrix}c^{\phi(n)/p_{i}}&\equiv&x^{\sigma\phi(n)/p_{i}}g^{m\phi(n)/p_{i%
 }}\mod n\\
 &\equiv&g^{(m_{i}+y_{i}p_{i})\phi(n)/p_{i}}\mod n\\
 &\equiv&g^{m_{i}\phi(n)/p_{i}}\mod n\end{matrix}   where     m  i   ≡   m  mod   p  i         subscript  m  i    modulo  m   subscript  p  i      m_{i}\equiv m\mod p_{i}   .   Since p i is chosen to be small, m i can be recovered by exhaustive search, i.e. by comparing    c  i     subscript  c  i    c_{i}   to    g    j  ϕ   (  n  )    /   p  i       superscript  g      j  ϕ  n    subscript  p  i      g^{j\phi(n)/p_{i}}   for j from 1 to p i -1.  Once m i is known for each i , m can be recovered by a direct application of the Chinese remainder theorem.   Security  The semantic security of the Naccache–Stern cryptosystem rests on an extension of the quadratic residuosity problem known as the higher residuosity problem .  References  "  Category:Public-key encryption schemes   
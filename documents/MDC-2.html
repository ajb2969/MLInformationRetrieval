<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1019">MDC-2</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>MDC-2</h1>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, <strong>MDC-2 (Modification Detection Code 2, sometimes called Meyer-Schilling)</strong> is a <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a>. MDC-2 is a <a href="One-way_compression_function" title="wikilink">hash function based on a block cipher</a> with a proof of security in the ideal-cipher model.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The length of the output hash depends on the underlying block cipher used.</p>
<h2 id="algorithm">Algorithm</h2>

<p>For a given message 

<math display="inline" id="MDC-2:0">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 to hash and a given block cipher encryption function 

<math display="inline" id="MDC-2:1">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

, the MDC-2 algorithm proceeds as follows. Let 

<math display="inline" id="MDC-2:2">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 be the block length, 

<math display="inline" id="MDC-2:3">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>B</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>B</ci>
     <cn type="integer">1</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{1},B_{1}
  </annotation>
 </semantics>
</math>

 two different constants of size 

<math display="inline" id="MDC-2:4">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="MDC-2:5">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>=</mo>
   <msub>
    <mi>M</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <mo>.</mo>
   <mo>.</mo>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>M</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">M</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <ci>normal-.</ci>
    <ci>normal-.</ci>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <ci>m</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M=M_{1}||..||M_{m}
  </annotation>
 </semantics>
</math>

 where each 

<math display="inline" id="MDC-2:6">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{i}
  </annotation>
 </semantics>
</math>

 has size 

<math display="inline" id="MDC-2:7">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, then the hash 

<math display="inline" id="MDC-2:8">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mi>m</mi>
   </msub>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>W</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>m</ci>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>W</ci>
     <ci>m</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{m}||W_{m}
  </annotation>
 </semantics>
</math>

 of the message is given by:</p>
<ul>
<li>for 

<math display="inline" id="MDC-2:9">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="MDC-2:10">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

:
<ul>
<li>

<math display="inline" id="MDC-2:11">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mi>i</mi>
    </msub>
    <mo>⊕</mo>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>M</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>A</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>E</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{i}=M_{i}\oplus E(M_{i},A_{i})
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="MDC-2:12">
 <semantics>
  <mrow>
   <msub>
    <mi>W</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mi>i</mi>
    </msub>
    <mo>⊕</mo>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>M</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>B</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>W</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>E</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <ci>i</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{i}=M_{i}\oplus E(M_{i},B_{i})
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="MDC-2:13">
 <semantics>
  <mrow>
   <msubsup>
    <mi>V</mi>
    <mi>i</mi>
    <mi>L</mi>
   </msubsup>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msubsup>
    <mi>V</mi>
    <mi>i</mi>
    <mi>R</mi>
   </msubsup>
   <mo>=</mo>
   <msub>
    <mi>V</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>i</ci>
     </apply>
     <ci>L</ci>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>i</ci>
     </apply>
     <ci>R</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>i</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{i}^{L}||V_{i}^{R}=V_{i}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="MDC-2:14">
 <semantics>
  <mrow>
   <msubsup>
    <mi>W</mi>
    <mi>i</mi>
    <mi>L</mi>
   </msubsup>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msubsup>
    <mi>W</mi>
    <mi>i</mi>
    <mi>R</mi>
   </msubsup>
   <mo>=</mo>
   <msub>
    <mi>W</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>i</ci>
     </apply>
     <ci>L</ci>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>i</ci>
     </apply>
     <ci>R</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>W</ci>
     <ci>i</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{i}^{L}||W_{i}^{R}=W_{i}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="MDC-2:15">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>V</mi>
    <mi>i</mi>
    <mi>R</mi>
   </msubsup>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msubsup>
    <mi>W</mi>
    <mi>i</mi>
    <mi>L</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>i</ci>
     </apply>
     <ci>R</ci>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>i</ci>
     </apply>
     <ci>L</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i+1}=V_{i}^{R}||W_{i}^{L}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="MDC-2:16">
 <semantics>
  <mrow>
   <msub>
    <mi>B</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>W</mi>
    <mi>i</mi>
    <mi>R</mi>
   </msubsup>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msubsup>
    <mi>V</mi>
    <mi>i</mi>
    <mi>L</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>B</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>i</ci>
     </apply>
     <ci>R</ci>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>i</ci>
     </apply>
     <ci>L</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{i+1}=W_{i}^{R}||V_{i}^{L}
  </annotation>
 </semantics>
</math>

</li>
</ul></li>
<li>return 

<math display="inline" id="MDC-2:17">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>m</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>B</mi>
    <mrow>
     <mi>m</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <plus></plus>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>B</ci>
     <apply>
      <plus></plus>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{m+1}||B_{m+1}
  </annotation>
 </semantics>
</math>

</li>
</ul>
<h2 id="mdc-2des-hashes">MDC-2DES hashes</h2>

<p>When MDC-2 uses the <a href="Data_Encryption_Standard" title="wikilink">DES</a> block cipher, the 128-bit (16-byte) MDC-2 hashes are typically represented as 32-digit <a class="uri" href="hexadecimal" title="wikilink">hexadecimal</a> numbers. The following demonstrates a 43-byte <a class="uri" href="ASCII" title="wikilink">ASCII</a> input and the corresponding MDC-2 hash:</p>

<p><code> MDC2("The quick brown fox jumps over the lazy </code><code>og") </code><br/>
<code>  = 000ed54e093d61679aefbeae05bfe33a</code></p>

<p>Even a small change in the message will (with probability) result in a completely different hash, e.g. changing <code>d</code> to <code>c</code>:</p>

<p><code> MDC2("The quick brown fox jumps over the lazy </code><code>og") </code><br/>
<code>  = 775f59f8e51aec29c57ac6ab850d58e8</code></p>

<p>The hash of the zero-length string is:</p>

<p><code> MDC2("") </code><br/>
<code>  = 52525252525252522525252525252525</code></p>
<h2 id="patent-issues">Patent issues</h2>

<p>MDC-2 was covered by , issued on March 13, 1990 but filed by <a class="uri" href="IBM" title="wikilink">IBM</a> on August 28, 1987.<br/>
For this reason, support for MDC-2 has been disabled in <a class="uri" href="OpenSSL" title="wikilink">OpenSSL</a> on most <a class="uri" href="Linux" title="wikilink">Linux</a> distributions and is not implemented by many other cryptographic libraries.</p>

<p>But the maximum lifespan of 20 years from filing date means that the  could not have lasted beyond August 28, 2007 ; in fact it has expired in 2002,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> because IBM has not paid the renewal fee. The same goes for the Canadian patent. There is no patent for Europe. This means that MDC-2 can be freely used.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="One-way_compression_function" title="wikilink">One-way compression function</a></li>
</ul>
<h2 id="notes">Notes</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Cryptographic_hash_functions" title="wikilink">Category:Cryptographic hash functions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"> (Click on "Bibliographic data".)<a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

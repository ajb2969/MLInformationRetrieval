   Covariance matrix      Covariance matrix   (Figure)  A bivariate Gaussian probability density function centered at (0, 0), with covariance matrix [ 1.00, 0.50 ; 0.50, 1.00 ].   (Figure)  Sample points from a multivariate Gaussian distribution with a standard deviation of 3 in roughly the lower left-upper right direction and of 1 in the orthogonal direction. Because the x and y components co-vary, the variances of x and y do not fully describe the distribution. A 2×2 covariance matrix is needed; the directions of the arrows correspond to the eigenvectors of this covariance matrix and their lengths to the square roots of the eigenvalues .   In probability theory and statistics , a covariance matrix (also known as dispersion matrix or variance–covariance matrix ) is a matrix whose element in the i , j position is the covariance between the i  th and j  th elements of a random vector (that is, of a vector of random variables ). Each element of the vector is a scalar random variable, either with a finite number of observed empirical values or with a finite or infinite number of potential values specified by a theoretical joint probability distribution of all the random variables.  Intuitively, the covariance matrix generalizes the notion of variance to multiple dimensions. As an example, the variation in a collection of random points in two-dimensional space cannot be characterized fully by a single number, nor would the variances in the x and y directions contain all of the necessary information; a 2×2 matrix would be necessary to fully characterize the two-dimensional variation.  Because the covariance of the i  th random variable with itself is simply that random variable's variance, each element on the principal diagonal of the covariance matrix is the variance of one of the random variables. Because the covariance of the i  th random variable with the j  th one is the same thing as the covariance of the j  th random variable with the i  th one, every covariance matrix is symmetric . In addition, every covariance matrix is positive semi-definite .  Definition  Throughout this article, boldfaced unsubscripted X and Y are used to refer to random vectors, and unboldfaced subscripted X i and Y i are used to refer to random scalars.  If the entries in the column vector      𝐗  =   [      X  1       ⋮       X  n      ]       𝐗     subscript  X  1     normal-⋮     subscript  X  n       \mathbf{X}=\begin{bmatrix}X_{1}\\
 \vdots\\
 X_{n}\end{bmatrix}     are random variables , each with finite variance , then the covariance matrix Σ is the matrix whose ( i , j ) entry is the covariance       Σ   i  j    =   cov   (   X  i   ,   X  j   )    =   E   [       (    X  i   -   μ  i    )    (    X  j   -   μ  j    )       ]           subscript  normal-Σ    i  j      cov    subscript  X  i    subscript  X  j            normal-E         subscript  X  i    subscript  μ  i       subscript  X  j    subscript  μ  j           \Sigma_{ij}=\mathrm{cov}(X_{i},X_{j})=\mathrm{E}\begin{bmatrix}(X_{i}-\mu_{i})%
 (X_{j}-\mu_{j})\end{bmatrix}     where       μ  i   =   E   (   X  i   )         subscript  μ  i     normal-E   subscript  X  i      \mu_{i}=\mathrm{E}(X_{i})\,     is the expected value of the i th entry in the vector X . In other words,       Σ  =   [      E   [    (    X  1   -   μ  1    )    (    X  1   -   μ  1    )    ]       E   [    (    X  1   -   μ  1    )    (    X  2   -   μ  2    )    ]      ⋯     E   [    (    X  1   -   μ  1    )    (    X  n   -   μ  n    )    ]              E   [    (    X  2   -   μ  2    )    (    X  1   -   μ  1    )    ]       E   [    (    X  2   -   μ  2    )    (    X  2   -   μ  2    )    ]      ⋯     E   [    (    X  2   -   μ  2    )    (    X  n   -   μ  n    )    ]             ⋮    ⋮    ⋱    ⋮            E   [    (    X  n   -   μ  n    )    (    X  1   -   μ  1    )    ]       E   [    (    X  n   -   μ  n    )    (    X  2   -   μ  2    )    ]      ⋯     E   [    (    X  n   -   μ  n    )    (    X  n   -   μ  n    )    ]       ]    .      normal-Σ      normal-E   delimited-[]       subscript  X  1    subscript  μ  1       subscript  X  1    subscript  μ  1         normal-E   delimited-[]       subscript  X  1    subscript  μ  1       subscript  X  2    subscript  μ  2       normal-⋯    normal-E   delimited-[]       subscript  X  1    subscript  μ  1       subscript  X  n    subscript  μ  n         absent      normal-E   delimited-[]       subscript  X  2    subscript  μ  2       subscript  X  1    subscript  μ  1         normal-E   delimited-[]       subscript  X  2    subscript  μ  2       subscript  X  2    subscript  μ  2       normal-⋯    normal-E   delimited-[]       subscript  X  2    subscript  μ  2       subscript  X  n    subscript  μ  n         absent    normal-⋮  normal-⋮  normal-⋱  normal-⋮    absent      normal-E   delimited-[]       subscript  X  n    subscript  μ  n       subscript  X  1    subscript  μ  1         normal-E   delimited-[]       subscript  X  n    subscript  μ  n       subscript  X  2    subscript  μ  2       normal-⋯    normal-E   delimited-[]       subscript  X  n    subscript  μ  n       subscript  X  n    subscript  μ  n           \Sigma=\begin{bmatrix}\mathrm{E}[(X_{1}-\mu_{1})(X_{1}-\mu_{1})]&\mathrm{E}[(X%
 _{1}-\mu_{1})(X_{2}-\mu_{2})]&\cdots&\mathrm{E}[(X_{1}-\mu_{1})(X_{n}-\mu_{n})%
 ]\\
 \\
 \mathrm{E}[(X_{2}-\mu_{2})(X_{1}-\mu_{1})]&\mathrm{E}[(X_{2}-\mu_{2})(X_{2}-%
 \mu_{2})]&\cdots&\mathrm{E}[(X_{2}-\mu_{2})(X_{n}-\mu_{n})]\\
 \\
 \vdots&\vdots&\ddots&\vdots\\
 \\
 \mathrm{E}[(X_{n}-\mu_{n})(X_{1}-\mu_{1})]&\mathrm{E}[(X_{n}-\mu_{n})(X_{2}-%
 \mu_{2})]&\cdots&\mathrm{E}[(X_{n}-\mu_{n})(X_{n}-\mu_{n})]\end{bmatrix}.     The inverse of this matrix,    Σ   -  1      superscript  normal-Σ    1     \Sigma^{-1}   is the inverse covariance matrix , also known as the concentration matrix or precision matrix ; 1 see precision (statistics) . The elements of the precision matrix have an interpretation in terms of partial correlations and partial variances .  Generalization of the variance  The definition above is equivalent to the matrix equality      Σ  =   E   [    (   𝐗  -   E   [  𝐗  ]     )     (   𝐗  -   E   [  𝐗  ]     )   T    ]        normal-Σ    normal-E   delimited-[]      𝐗    normal-E   delimited-[]  𝐗      superscript    𝐗    normal-E   delimited-[]  𝐗     normal-T        \Sigma=\mathrm{E}\left[\left(\mathbf{X}-\mathrm{E}[\mathbf{X}]\right)\left(%
 \mathbf{X}-\mathrm{E}[\mathbf{X}]\right)^{\rm T}\right]     This form can be seen as a generalization of the scalar-valued variance to higher dimensions. Recall that for a scalar-valued random variable X        σ  2   =   var   (  X  )    =   E   [    (   X  -   E   (  X  )     )   2   ]    =   E   [    (   X  -   E   (  X  )     )   ⋅   (   X  -   E   (  X  )     )    ]     .         superscript  σ  2     var  X          normal-E   delimited-[]   superscript    X    normal-E  X    2            normal-E   delimited-[]   normal-⋅    X    normal-E  X      X    normal-E  X          \sigma^{2}=\mathrm{var}(X)=\mathrm{E}[(X-\mathrm{E}(X))^{2}]=\mathrm{E}[(X-%
 \mathrm{E}(X))\cdot(X-\mathrm{E}(X))].\,     Indeed, the entries on the diagonal of the covariance matrix   Σ   normal-Σ   \Sigma   are the variances of each element of the vector   𝐗   𝐗   \mathbf{X}   .  Correlation matrix  A quantity closely related to the covariance matrix is the correlation matrix, the matrix of Pearson product-moment correlation coefficients between each of the random variables in the random vector   𝐗   𝐗   \mathbf{X}   , which can be written       corr   (  𝐗  )    =      (   diag   (  Σ  )    )    -   1  2       Σ     (   diag   (  Σ  )    )    -   1  2            corr  𝐗      superscript    diag  normal-Σ       1  2     normal-Σ   superscript    diag  normal-Σ       1  2        \text{corr}(\mathbf{X})=\left(\text{diag}(\Sigma)\right)^{-\frac{1}{2}}\,%
 \Sigma\,\left(\text{diag}(\Sigma)\right)^{-\frac{1}{2}}   where    diag   (  Σ  )       diag  normal-Σ    \text{diag}(\Sigma)   is the matrix of the diagonal elements of   Σ   normal-Σ   \Sigma   (i.e., a diagonal matrix of the variances of    X  i     subscript  X  i    X_{i}   for    i  =   1  ,  …  ,  n       i   1  normal-…  n     i=1,\dots,n   ).  Equivalently, the correlation matrix can be seen as the covariance matrix of the standardized random variables       X  i   /  σ    (   X  i   )          subscript  X  i   σ    subscript  X  i     X_{i}/\sigma(X_{i})   for    i  =   1  ,  …  ,  n       i   1  normal-…  n     i=1,\dots,n   .  Each element on the principal diagonal of a correlation matrix is the correlation of a random variable with itself, which always equals 1. Each off-diagonal element is between 1 and –1 inclusive.  Conflicting nomenclatures and notations  Nomenclatures differ. Some statisticians, following the probabilist William Feller , call the matrix   Σ   normal-Σ   \Sigma   the variance of the random vector   X   X   X   , because it is the natural generalization to higher dimensions of the 1-dimensional variance. Others call it the covariance matrix , because it is the matrix of covariances between the scalar components of the vector   X   X   X   . Thus        var   (  𝐗  )    =   cov   (  𝐗  )    =   E   [    (   𝐗  -   E   [  𝐗  ]     )     (   𝐗  -   E   [  𝐗  ]     )   T    ]     .         var  𝐗    cov  𝐗          normal-E   delimited-[]      𝐗    normal-E   delimited-[]  𝐗      superscript    𝐗    normal-E   delimited-[]  𝐗     normal-T         \operatorname{var}(\mathbf{X})=\operatorname{cov}(\mathbf{X})=\mathrm{E}\left[%
 (\mathbf{X}-\mathrm{E}[\mathbf{X}])(\mathbf{X}-\mathrm{E}[\mathbf{X}])^{\rm T}%
 \right].     However, the notation for the cross-covariance  between two vectors is standard:        cov   (  𝐗  ,  𝐘  )    =   E   [    (   𝐗  -   E   [  𝐗  ]     )     (   𝐘  -   E   [  𝐘  ]     )   T    ]     .       cov  𝐗  𝐘     normal-E   delimited-[]      𝐗    normal-E   delimited-[]  𝐗      superscript    𝐘    normal-E   delimited-[]  𝐘     normal-T        \operatorname{cov}(\mathbf{X},\mathbf{Y})=\mathrm{E}\left[(\mathbf{X}-\mathrm{%
 E}[\mathbf{X}])(\mathbf{Y}-\mathrm{E}[\mathbf{Y}])^{\rm T}\right].     The var notation is found in William Feller's two-volume book An Introduction to Probability Theory and Its Applications , 2 but both forms are quite standard and there is no ambiguity between them.  The matrix   Σ   normal-Σ   \Sigma   is also often called the variance-covariance matrix since the diagonal terms are in fact variances.  Properties  For    Σ  =   E   [    (   𝐗  -   E   [  𝐗  ]     )     (   𝐗  -   E   [  𝐗  ]     )   T    ]        normal-Σ    normal-E   delimited-[]      𝐗    normal-E   delimited-[]  𝐗      superscript    𝐗    normal-E   delimited-[]  𝐗     normal-T        \Sigma=\mathrm{E}\left[\left(\mathbf{X}-\mathrm{E}[\mathbf{X}]\right)\left(%
 \mathbf{X}-\mathrm{E}[\mathbf{X}]\right)^{\rm T}\right]   and    𝝁  =   E   (  𝐗  )        𝝁    normal-E  X     \boldsymbol{\mu}=\mathrm{E}(\textbf{X})   , where X is a random p -dimensional variable and Y a random q -dimensional variable, the following basic properties apply: 3       Σ  =    E   (   𝐗𝐗  T   )    -   𝝁   𝝁  T         normal-Σ      normal-E   superscript  𝐗𝐗  normal-T      𝝁   superscript  𝝁  normal-T       \Sigma=\mathrm{E}(\mathbf{XX^{\rm T}})-\boldsymbol{\mu}\boldsymbol{\mu}^{\rm T}         Σ    normal-Σ   \Sigma\,   is positive-semidefinite and symmetric .       cov   (   𝐀𝐗  +  𝐚   )    =    𝐀     cov   (  𝐗  )     𝐀  T          cov    𝐀𝐗  𝐚      𝐀    cov  𝐗    superscript  𝐀  normal-T       \operatorname{cov}(\mathbf{AX}+\mathbf{a})=\mathbf{A}\,\operatorname{cov}(%
 \mathbf{X})\,\mathbf{A^{\rm T}}         cov   (  𝐗  ,  𝐘  )   =  cov    (  𝐘  ,  𝐗  )   T      fragments  cov   fragments  normal-(  X  normal-,  Y  normal-)    cov   superscript   fragments  normal-(  Y  normal-,  X  normal-)   normal-T     \operatorname{cov}(\mathbf{X},\mathbf{Y})=\operatorname{cov}(\mathbf{Y},%
 \mathbf{X})^{\rm T}          cov   (    𝐗  1   +   𝐗  2    ,  𝐘  )    =    cov   (   𝐗  1   ,  𝐘  )    +   cov   (   𝐗  2   ,  𝐘  )          cov     subscript  𝐗  1    subscript  𝐗  2    𝐘      cov   subscript  𝐗  1   𝐘    cov   subscript  𝐗  2   𝐘      \operatorname{cov}(\mathbf{X}_{1}+\mathbf{X}_{2},\mathbf{Y})=\operatorname{cov%
 }(\mathbf{X}_{1},\mathbf{Y})+\operatorname{cov}(\mathbf{X}_{2},\mathbf{Y})     If p = q , then     var   (   𝐗  +  𝐘   )    =    var   (  𝐗  )    +   cov   (  𝐗  ,  𝐘  )    +   cov   (  𝐘  ,  𝐗  )    +   var   (  𝐘  )          var    𝐗  𝐘       var  𝐗    cov  𝐗  𝐘    cov  𝐘  𝐗    var  𝐘      \operatorname{var}(\mathbf{X}+\mathbf{Y})=\operatorname{var}(\mathbf{X})+%
 \operatorname{cov}(\mathbf{X},\mathbf{Y})+\operatorname{cov}(\mathbf{Y},%
 \mathbf{X})+\operatorname{var}(\mathbf{Y})          cov   (   𝐀𝐗  +  𝐚   ,     𝐁  T   𝐘   +  𝐛   )    =    𝐀    cov   (  𝐗  ,  𝐘  )    𝐁        cov    𝐀𝐗  𝐚        superscript  𝐁  normal-T   𝐘   𝐛      𝐀   cov  𝐗  𝐘   𝐁     \operatorname{cov}(\mathbf{AX}+\mathbf{a},\mathbf{B}^{\rm T}\mathbf{Y}+\mathbf%
 {b})=\mathbf{A}\,\operatorname{cov}(\mathbf{X},\mathbf{Y})\,\mathbf{B}     If   𝐗   𝐗   \mathbf{X}   and   𝐘   𝐘   \mathbf{Y}   are independent or uncorrelated, then     cov   (  𝐗  ,  𝐘  )    =  𝟎       cov  𝐗  𝐘   0    \operatorname{cov}(\mathbf{X},\mathbf{Y})=\mathbf{0}      where    𝐗  ,   𝐗  1      𝐗   subscript  𝐗  1     \mathbf{X},\mathbf{X}_{1}   and    𝐗  2     subscript  𝐗  2    \mathbf{X}_{2}   are random p ×1 vectors,   𝐘   𝐘   \mathbf{Y}   is a random q ×1 vector,   𝐚   𝐚   \mathbf{a}   is a q ×1 vector,   𝐛   𝐛   \mathbf{b}   is a p ×1 vector, and   𝐀   𝐀   \mathbf{A}   and   𝐁   𝐁   \mathbf{B}   are q × p matrices.  This covariance matrix is a useful tool in many different areas. From it a transformation matrix can be derived, called a whitening transformation , that allows one to completely decorrelate the data or, from a different point of view, to find an optimal basis for representing the data in a compact way (see Rayleigh quotient for a formal proof and additional properties of covariance matrices). This is called principal components analysis (PCA) and the Karhunen-Loève transform (KL-transform).  Block matrices  The joint mean    𝝁   X  ,  Y      subscript  𝝁   X  Y     \boldsymbol{\mu}_{X,Y}   and joint covariance matrix    𝚺   X  ,  Y      subscript  𝚺   X  Y     \boldsymbol{\Sigma}_{X,Y}   of   𝑿   𝑿   \boldsymbol{X}   and   𝒀   𝒀   \boldsymbol{Y}   can be written in block form        𝝁   X  ,  Y    =   [      𝝁  X        𝝁  Y      ]    ,    𝚺   X  ,  Y    =   [      𝚺  𝑋𝑋      𝚺  𝑋𝑌        𝚺  𝑌𝑋      𝚺  𝑌𝑌      ]       formulae-sequence     subscript  𝝁   X  Y       subscript  𝝁  X      subscript  𝝁  Y         subscript  𝚺   X  Y       subscript  𝚺  𝑋𝑋    subscript  𝚺  𝑋𝑌      subscript  𝚺  𝑌𝑋    subscript  𝚺  𝑌𝑌        \boldsymbol{\mu}_{X,Y}=\begin{bmatrix}\boldsymbol{\mu}_{X}\\
 \boldsymbol{\mu}_{Y}\end{bmatrix},\qquad\boldsymbol{\Sigma}_{X,Y}=\begin{%
 bmatrix}\boldsymbol{\Sigma}_{\mathit{XX}}&\boldsymbol{\Sigma}_{\mathit{XY}}\\
 \boldsymbol{\Sigma}_{\mathit{YX}}&\boldsymbol{\Sigma}_{\mathit{YY}}\end{bmatrix}     where       𝚺   X  X    =   var   (  𝑿  )     ,    𝚺   Y  Y    =   var   (  𝒀  )      ,     formulae-sequence     subscript  𝚺    X  X      var  𝑿       subscript  𝚺    Y  Y      var  𝒀      \boldsymbol{\Sigma}_{XX}=\mbox{var}(\boldsymbol{X}),\boldsymbol{\Sigma}_{YY}=%
 \mbox{var}(\boldsymbol{Y}),   and     𝚺   X  Y    =   𝚺  𝑌𝑋  T   =   cov   (  𝑿  ,  𝒀  )           subscript  𝚺    X  Y     subscript   superscript  𝚺  T   𝑌𝑋          cov   𝑿  𝒀       \boldsymbol{\Sigma}_{XY}=\boldsymbol{\Sigma}^{T}_{\mathit{YX}}=\mbox{cov}(%
 \boldsymbol{X},\boldsymbol{Y})   .      𝚺   X  X      subscript  𝚺    X  X     \boldsymbol{\Sigma}_{XX}   and    𝚺   Y  Y      subscript  𝚺    Y  Y     \boldsymbol{\Sigma}_{YY}   can be identified as the variance matrices of the marginal distributions for   𝑿   𝑿   \boldsymbol{X}   and   𝒀   𝒀   \boldsymbol{Y}   respectively.  If   𝑿   𝑿   \boldsymbol{X}   and   𝒀   𝒀   \boldsymbol{Y}   are jointly normally distributed ,       𝒙  ,  𝒚   ∼   𝒩   (   𝝁   X  ,  Y    ,   𝚺   X  ,  Y    )       similar-to   𝒙  𝒚     𝒩    subscript  𝝁   X  Y     subscript  𝚺   X  Y        \boldsymbol{x},\boldsymbol{y}\sim\ \mathcal{N}(\boldsymbol{\mu}_{X,Y},%
 \boldsymbol{\Sigma}_{X,Y})   , then the conditional distribution for   𝒀   𝒀   \boldsymbol{Y}   given   𝑿   𝑿   \boldsymbol{X}   is given by      𝒚  |  𝒙  ∼  𝒩   (   𝝁   Y  |  X    ,   𝚺   Y  |  X    )      fragments  y  normal-|  x  similar-to  N   fragments  normal-(   subscript  𝝁   fragments  Y  normal-|  X    normal-,   subscript  𝚺   fragments  Y  normal-|  X    normal-)     \boldsymbol{y}|\boldsymbol{x}\sim\ \mathcal{N}(\boldsymbol{\mu}_{Y|X},%
 \boldsymbol{\Sigma}_{Y|X})   , 4 defined by conditional mean       𝝁   Y  |  X    =    𝝁  Y   +    𝚺   Y  X     𝚺   X  X    -  1     (   𝐱  -   𝝁  X    )          subscript  𝝁   fragments  Y  normal-|  X       subscript  𝝁  Y      subscript  𝚺    Y  X     superscript   subscript  𝚺    X  X      1      𝐱   subscript  𝝁  X        \boldsymbol{\mu}_{Y|X}=\boldsymbol{\mu}_{Y}+\boldsymbol{\Sigma}_{YX}%
 \boldsymbol{\Sigma}_{XX}^{-1}\left(\mathbf{x}-\boldsymbol{\mu}_{X}\right)     and conditional variance        𝚺   Y  |  X    =    𝚺   Y  Y    -    𝚺  𝑌𝑋    𝚺  𝑋𝑋   -  1     𝚺  𝑋𝑌      .       subscript  𝚺   fragments  Y  normal-|  X       subscript  𝚺    Y  Y       subscript  𝚺  𝑌𝑋    superscript   subscript  𝚺  𝑋𝑋     1     subscript  𝚺  𝑋𝑌       \boldsymbol{\Sigma}_{Y|X}=\boldsymbol{\Sigma}_{YY}-\boldsymbol{\Sigma}_{%
 \mathit{YX}}\boldsymbol{\Sigma}_{\mathit{XX}}^{-1}\boldsymbol{\Sigma}_{\mathit%
 {XY}}.     The matrix Σ YX Σ XX −1 is known as the matrix of regression coefficients, while in linear algebra Σ Y|X is the Schur complement of Σ XX in Σ X,Y  The matrix of regression coefficients may often be given in transpose form, Σ XX −1 Σ XY , suitable for post-multiplying a row vector of explanatory variables x T rather than pre-multiplying a column vector x . In this form they correspond to the coefficients obtained by inverting the matrix of the normal equations of ordinary least squares (OLS).  As a linear operator  Applied to one vector, the covariance matrix maps a linear combination, c , of the random variables, X , onto a vector of covariances with those variables      𝐜  T   Σ   =   cov   (    𝐜  T   𝐗   ,  𝐗  )           superscript  𝐜  normal-T   normal-Σ    cov     superscript  𝐜  normal-T   𝐗   𝐗     \mathbf{c}^{\rm T}\Sigma=\operatorname{cov}(\mathbf{c}^{\rm T}\mathbf{X},%
 \mathbf{X})   . Treated as a bilinear form , it yields the covariance between the two linear combinations      𝐝  T   Σ  𝐜   =   cov   (    𝐝  T   𝐗   ,    𝐜  T   𝐗   )           superscript  𝐝  normal-T   normal-Σ  𝐜    cov     superscript  𝐝  normal-T   𝐗      superscript  𝐜  normal-T   𝐗      \mathbf{d}^{\rm T}\Sigma\mathbf{c}=\operatorname{cov}(\mathbf{d}^{\rm T}%
 \mathbf{X},\mathbf{c}^{\rm T}\mathbf{X})   . The variance of a linear combination is then     𝐜  T   Σ  𝐜       superscript  𝐜  normal-T   normal-Σ  𝐜    \mathbf{c}^{\rm T}\Sigma\mathbf{c}   , its covariance with itself.  Similarly, the (pseudo-)inverse covariance matrix provides an inner product,    ⟨   c  -  μ   |   Σ  +   |   c  -  μ   ⟩     quantum-operator-product    c  μ    superscript  normal-Σ      c  μ     \langle c-\mu|\Sigma^{+}|c-\mu\rangle   which induces the Mahalanobis distance , a measure of the "unlikelihood" of c .  Which matrices are covariance matrices?  From the identity just above, let   𝐛   𝐛   \mathbf{b}   be a    (   p  ×  1   )      p  1    (p\times 1)   real-valued vector, then        var   (    𝐛  T   𝐗   )    =    𝐛  T     var   (  𝐗  )    𝐛     ,       var     superscript  𝐛  normal-T   𝐗       superscript  𝐛  normal-T     var  𝐗   𝐛      \operatorname{var}(\mathbf{b}^{\rm T}\mathbf{X})=\mathbf{b}^{\rm T}%
 \operatorname{var}(\mathbf{X})\mathbf{b},\,     which must always be nonnegative since it is the variance of a real-valued random variable. From the symmetry of the covariance matrix's definition it follows that only a positive-semidefinite matrix can be a covariance matrix. Conversely, every symmetric positive semi-definite matrix is a covariance matrix. To see this, suppose M is a p × p positive-semidefinite matrix. From the finite-dimensional case of the spectral theorem , it follows that M has a nonnegative symmetric square root , that can be denoted by M 1/2 . Let   𝐗   𝐗   \mathbf{X}   be any p ×1 column vector-valued random variable whose covariance matrix is the p × p identity matrix. Then        var   (    𝐌   1  /  2    𝐗   )    =    𝐌   1  /  2     (   var   (  𝐗  )    )    𝐌   1  /  2     =  𝐌   .         var     superscript  𝐌    1  2    𝐗       superscript  𝐌    1  2     var  𝐗    superscript  𝐌    1  2          𝐌     \operatorname{var}(\mathbf{M}^{1/2}\mathbf{X})=\mathbf{M}^{1/2}(\operatorname{%
 var}(\mathbf{X}))\mathbf{M}^{1/2}=\mathbf{M}.\,     How to find a valid correlation matrix  In some applications (e.g., building data models from only partially observed data) one wants to find the "nearest" correlation matrix to a given symmetric matrix (e.g., of observed covariances). In 2002, Higham 5 formalized the notion of nearness using a weighted Frobenius norm and provided a method for computing the nearest correlation matrix.  Complex random vectors  The variance of a complex scalar-valued random variable with expected value μ is conventionally defined using complex conjugation :       var   (  z  )    =   E   [    (   z  -  μ   )     (   z  -  μ   )   *    ]         var  z    normal-E      z  μ    superscript    z  μ         \operatorname{var}(z)=\operatorname{E}\left[(z-\mu)(z-\mu)^{*}\right]     where the complex conjugate of a complex number   z   z   z   is denoted    z  *     superscript  z     z^{*}   ; thus the variance of a complex number is a real number.  If   Z   Z   Z   is a column-vector of complex-valued random variables, then the conjugate transpose is formed by both transposing and conjugating. In the following expression, the product of a vector with its conjugate transpose results in a square matrix, as its expectation:       E   [    (   Z  -  μ   )     (   Z  -  μ   )   †    ]    ,     normal-E      Z  μ    superscript    Z  μ   normal-†      \operatorname{E}\left[(Z-\mu)(Z-\mu)^{\dagger}\right],     where    Z  †     superscript  Z  normal-†    Z^{\dagger}   denotes the conjugate transpose, which is applicable to the scalar case since the transpose of a scalar is still a scalar. The matrix so obtained will be Hermitian  positive-semidefinite , 6 with real numbers in the main diagonal and complex numbers off-diagonal.  Estimation  If    𝐌  𝐗     subscript  𝐌  𝐗    \mathbf{M}_{\mathbf{X}}   and    𝐌  𝐘     subscript  𝐌  𝐘    \mathbf{M}_{\mathbf{Y}}   are centred data matrices of dimension n -by- p and n-by-q respectively, i.e. with n rows of observations of p and q columns of variables, from which the column means have been subtracted, then, if the column means were estimated from the data, sample correlation matrices    𝐐  𝐗     subscript  𝐐  𝐗    \mathbf{Q}_{\mathbf{X}}   and    𝐐  𝐗𝐘     subscript  𝐐  𝐗𝐘    \mathbf{Q}_{\mathbf{XY}}   can be defined to be        𝐐  𝐗   =    1   n  -  1     𝐌  𝐗  T    𝐌  𝐗     ,    𝐐  𝐗𝐘   =    1   n  -  1     𝐌  𝐗  T    𝐌  𝐘        formulae-sequence     subscript  𝐐  𝐗       1    n  1     superscript   subscript  𝐌  𝐗   T    subscript  𝐌  𝐗        subscript  𝐐  𝐗𝐘       1    n  1     superscript   subscript  𝐌  𝐗   T    subscript  𝐌  𝐘       \mathbf{Q}_{\mathbf{X}}=\frac{1}{n-1}\mathbf{M}_{\mathbf{X}}^{T}\mathbf{M}_{%
 \mathbf{X}},\qquad\mathbf{Q}_{\mathbf{XY}}=\frac{1}{n-1}\mathbf{M}_{\mathbf{X}%
 }^{T}\mathbf{M}_{\mathbf{Y}}   or, if the column means were known a-priori,        𝐐  𝐗   =    1  n    𝐌  𝐗  T    𝐌  𝐗     ,    𝐐  𝐗𝐘   =    1  n    𝐌  𝐗  T    𝐌  𝐘        formulae-sequence     subscript  𝐐  𝐗       1  n    superscript   subscript  𝐌  𝐗   T    subscript  𝐌  𝐗        subscript  𝐐  𝐗𝐘       1  n    superscript   subscript  𝐌  𝐗   T    subscript  𝐌  𝐘       \mathbf{Q}_{\mathbf{X}}=\frac{1}{n}\mathbf{M}_{\mathbf{X}}^{T}\mathbf{M}_{%
 \mathbf{X}},\qquad\mathbf{Q}_{\mathbf{XY}}=\frac{1}{n}\mathbf{M}_{\mathbf{X}}^%
 {T}\mathbf{M}_{\mathbf{Y}}     These empirical sample correlation matrices are the most straightforward and most often used estimators for the correlation matrices, but other estimators also exist, including regularised or shrinkage estimators, which may have better properties.  As a parameter of a distribution  If a vector of n possibly correlated random variables is jointly normally distributed , or more generally elliptically distributed , then its probability density function can be expressed in terms of the covariance matrix.  Applications  In financial economics  The covariance matrix plays a key role in financial economics , especially in portfolio theory and its mutual fund separation theorem and in the capital asset pricing model . The matrix of covariances among various assets' returns is used to determine, under certain assumptions, the relative amounts of different assets that investors should (in a normative analysis ) or are predicted to (in a positive analysis ) choose to hold in a context of diversification .  See also   Covariance mapping  Multivariate statistics  Gramian matrix  Eigenvalue decomposition  Quadratic form (statistics)   References  Further reading       "  Category:Covariance and correlation  Category:Matrices  Category:Summary statistics  Category:Data analysis     ↩  ↩  ↩  ↩  ↩  ↩     
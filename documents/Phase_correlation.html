<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="251">Phase correlation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Phase correlation</h1>
<hr/>

<p>In <a href="image_processing" title="wikilink">image processing</a>, <strong>phase correlation</strong> is a method of <a href="image_registration" title="wikilink">image registration</a>, and uses a fast <a class="uri" href="frequency-domain" title="wikilink">frequency-domain</a> approach to estimate the relative <a href="Translation_(geometry)" title="wikilink">translative</a> offset between two similar <a href="image" title="wikilink">images</a>.</p>
<h2 id="example">Example</h2>

<p>The following image demonstrates the usage of phase correlation to determine relative translative movement between two images corrupted by independent Gaussian noise. The image was translated by (30,33) pixels. Accordingly, one can clearly see a peak in the phase-correlation representation at approximately (30,33).</p>
<figure><b>(Figure)</b>
<figcaption>Phase correlation.png</figcaption>
</figure>
<h2 id="method">Method</h2>

<p>Given two input images 

<math display="inline" id="Phase_correlation:0">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>g</mi>
   </mpadded>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>g</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{a}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Phase_correlation:1">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>g</mi>
   </mpadded>
   <mi>b</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>g</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{b}
  </annotation>
 </semantics>
</math>

:</p>

<p>Apply a <a href="window_function" title="wikilink">window function</a> (e.g., a <a href="Hamming_window" title="wikilink">Hamming window</a>) on both images to reduce edge effects. Then, calculate the discrete 2D <a href="Discrete_Fourier_transform" title="wikilink">Fourier transform</a> of both images.</p>

<p>

<math display="block" id="Phase_correlation:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mpadded lspace="5pt" width="+5pt">
      <mi>𝐆</mi>
     </mpadded>
     <mi>a</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℱ</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>g</mi>
       <mi>a</mi>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="5.3pt">,</mo>
   <mrow>
    <msub>
     <mi>𝐆</mi>
     <mi>b</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℱ</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <msub>
       <mi>g</mi>
       <mi>b</mi>
      </msub>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐆</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ℱ</ci>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </set>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐆</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ℱ</ci>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <ci>b</ci>
       </apply>
      </set>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \mathbf{G}_{a}=\mathcal{F}\{g_{a}\},\;\mathbf{G}_{b}=\mathcal{F}\{g_{b}\}
  </annotation>
 </semantics>
</math>

</p>

<p>Calculate the <a href="Spectral_density#Cross-spectral_density" title="wikilink">cross-power spectrum</a> by taking the <a href="complex_conjugate" title="wikilink">complex conjugate</a> of the second result, multiplying the <a href="Fourier_transform" title="wikilink">Fourier transforms</a> together elementwise, and normalizing this product elementwise.</p>

<p>

<math display="block" id="Phase_correlation:3">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>R</mi>
   </mpadded>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>𝐆</mi>
      <mi>a</mi>
     </msub>
     <mo>∘</mo>
     <msubsup>
      <mi>𝐆</mi>
      <mi>b</mi>
      <mo>*</mo>
     </msubsup>
    </mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <msub>
       <mi>𝐆</mi>
       <mi>a</mi>
      </msub>
      <mo>∘</mo>
      <msubsup>
       <mi>𝐆</mi>
       <mi>b</mi>
       <mo>*</mo>
      </msubsup>
     </mrow>
     <mo stretchy="false">|</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <apply>
     <divide></divide>
     <apply>
      <compose></compose>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐆</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐆</ci>
        <ci>b</ci>
       </apply>
       <times></times>
      </apply>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <compose></compose>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐆</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐆</ci>
         <ci>b</ci>
        </apply>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ R=\frac{\mathbf{G}_{a}\circ\mathbf{G}_{b}^{*}}{|\mathbf{G}_{a}\circ\mathbf{G%
}_{b}^{*}|}
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Phase_correlation:4">
 <semantics>
  <mo>∘</mo>
  <annotation-xml encoding="MathML-Content">
   <compose></compose>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \circ
  </annotation>
 </semantics>
</math>

 is the <a href="Hadamard_product_(matrices)" title="wikilink">Hadamard product</a> (entry-wise product).</p>

<p>Obtain the normalized cross-correlation by applying the inverse Fourier transform.</p>

<p>

<math display="block" id="Phase_correlation:5">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>r</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi class="ltx_font_mathcaligraphic">ℱ</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">{</mo>
     <mi>R</mi>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℱ</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <set>
      <ci>R</ci>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ r=\mathcal{F}^{-1}\{R\}
  </annotation>
 </semantics>
</math>

</p>

<p>Determine the location of the peak in 

<math display="inline" id="Phase_correlation:6">
 <semantics>
  <mpadded lspace="5pt" width="+5pt">
   <mi>r</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ r
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Phase_correlation:7">
 <semantics>
  <mrow>
   <mrow>
    <mo lspace="7.5pt" stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>x</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>y</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>arg</mi>
    <mrow>
     <munder>
      <mi>max</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </munder>
     <mrow>
      <mo stretchy="false">{</mo>
      <mi>r</mi>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>y</ci>
     </apply>
    </interval>
    <apply>
     <arg></arg>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <max></max>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ (\Delta x,\Delta y)=\arg\max_{(x,y)}\{r\}
  </annotation>
 </semantics>
</math>

</p>

<p>Commonly, <a class="uri" href="interpolation" title="wikilink">interpolation</a> methods are used to estimate the peak location to non-<a class="uri" href="integer" title="wikilink">integer</a> values, despite the fact that the data are discrete and is often termed 'subpixel registration'. Because the Fourier representation of the data has already been computed, it is especially convenient to use the <a href="Fourier_shift_theorem" title="wikilink">Fourier shift theorem</a> with <a href="real_number" title="wikilink">real</a>-valued shifts for this purpose. It is also possible to infer the peak location from phase characteristics in Fourier space without the inverse transformation, as noted by Stone <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="rationale">Rationale</h2>

<p>The method is based on the <a href="Discrete_Fourier_transform#Shift_theorem" title="wikilink">Fourier shift theorem</a>. Let the two images 

<math display="inline" id="Phase_correlation:8">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>g</mi>
   </mpadded>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>g</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{a}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Phase_correlation:9">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>g</mi>
   </mpadded>
   <mi>b</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>g</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{b}
  </annotation>
 </semantics>
</math>

 be circularly-shifted versions of each other:</p>

<p>

<math display="block" id="Phase_correlation:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mpadded lspace="5pt" width="+5pt">
      <mi>g</mi>
     </mpadded>
     <mi>b</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mpadded width="+5pt">
    <mover>
     <mo movablelimits="false">=</mo>
     <mi>def</mi>
    </mover>
   </mpadded>
   <mrow>
    <msub>
     <mi>g</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>x</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
      <mi>M</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>y</mi>
        <mo>-</mo>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>y</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>b</ci>
     </apply>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="latexml">modulo</csymbol>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>M</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">modulo</csymbol>
       <apply>
        <minus></minus>
        <ci>y</ci>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>y</ci>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{b}(x,y)\ \stackrel{\mathrm{def}}{=}\ g_{a}((x-\Delta x)\bmod M,(y-\Delta y%
)\bmod N)
  </annotation>
 </semantics>
</math>

</p>

<p>(where the images are 

<math display="inline" id="Phase_correlation:11">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>M</mi>
   </mpadded>
   <mo>×</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>M</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ M\times N
  </annotation>
 </semantics>
</math>

 in size).</p>

<p>Then, the discrete Fourier transforms of the images will be shifted relatively in <a href="phase_(waves)" title="wikilink">phase</a>:</p>

<p>

<math display="block" id="Phase_correlation:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐆</mi>
     <mi>b</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝐆</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
       <mi>i</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mi>u</mi>
           <mi mathvariant="normal">Δ</mi>
           <mi>x</mi>
          </mrow>
          <mi>M</mi>
         </mfrac>
         <mo>+</mo>
         <mfrac>
          <mrow>
           <mi>v</mi>
           <mi mathvariant="normal">Δ</mi>
           <mi>y</mi>
          </mrow>
          <mi>N</mi>
         </mfrac>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐆</ci>
      <ci>b</ci>
     </apply>
     <interval closure="open">
      <ci>u</ci>
      <ci>v</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐆</ci>
      <ci>a</ci>
     </apply>
     <interval closure="open">
      <ci>u</ci>
      <ci>v</ci>
     </interval>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>u</ci>
           <ci>normal-Δ</ci>
           <ci>x</ci>
          </apply>
          <ci>M</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>v</ci>
           <ci>normal-Δ</ci>
           <ci>y</ci>
          </apply>
          <ci>N</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{G}_{b}(u,v)=\mathbf{G}_{a}(u,v)e^{-2\pi i(\frac{u\Delta x}{M}+\frac{v%
\Delta y}{N})}
  </annotation>
 </semantics>
</math>

</p>

<p>One can then calculate the normalized cross-power spectrum to factor out the phase difference:</p>

<p>

<math display="inline" id="Phase_correlation:13">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <interval closure="open">
     <ci>u</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle R(u,v)
  </annotation>
 </semantics>
</math>


 since the magnitude of an <a href="Euler's_formula" title="wikilink">imaginary exponential</a> always is one, and the phase of 

<math display="inline" id="Phase_correlation:14">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="5pt" width="+5pt">
     <mi>𝐆</mi>
    </mpadded>
    <mi>a</mi>
   </msub>
   <msubsup>
    <mi>𝐆</mi>
    <mi>a</mi>
    <mo>*</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐆</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐆</ci>
      <ci>a</ci>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ \mathbf{G}_{a}\mathbf{G}_{a}^{*}
  </annotation>
 </semantics>
</math>

 always is zero.</p>

<p>The inverse Fourier transform of a complex exponential is a <a href="Kronecker_delta" title="wikilink">Kronecker delta</a>, i.e. a single peak:</p>

<p>

<math display="block" id="Phase_correlation:15">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="5pt" width="+5pt">
     <mi>r</mi>
    </mpadded>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>δ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>y</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>r</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>y</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ r(x,y)=\delta(x+\Delta x,y+\Delta y)
  </annotation>
 </semantics>
</math>

</p>

<p>This result could have been obtained by calculating the <a href="cross_correlation" title="wikilink">cross correlation</a> directly. The advantage of this method is that the discrete Fourier transform and its inverse can be performed using the <a href="fast_Fourier_transform" title="wikilink">fast Fourier transform</a>, which is much faster than correlation for large images.</p>
<h3 id="benefits">Benefits</h3>

<p>Unlike many spatial-domain algorithms, the phase correlation method is resilient to noise, occlusions, and other defects typical of medical or satellite images.</p>

<p>The method can be extended to determine rotation and scaling differences between two images by first converting the images to <a href="log-polar_coordinates" title="wikilink">log-polar coordinates</a>. Due to properties of the <a href="Fourier_transform" title="wikilink">Fourier transform</a>, the rotation and scaling parameters can be determined in a manner invariant to translation.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="limitations">Limitations</h3>

<p>In practice, it is more likely that 

<math display="inline" id="Phase_correlation:16">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>g</mi>
   </mpadded>
   <mi>b</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>g</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{b}
  </annotation>
 </semantics>
</math>

 will be a simple linear shift of 

<math display="inline" id="Phase_correlation:17">
 <semantics>
  <msub>
   <mpadded lspace="5pt" width="+5pt">
    <mi>g</mi>
   </mpadded>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>g</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ g_{a}
  </annotation>
 </semantics>
</math>

, rather than a circular shift as required by the explanation above. In such cases, 

<math display="inline" id="Phase_correlation:18">
 <semantics>
  <mpadded lspace="5pt" width="+5pt">
   <mi>r</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ r
  </annotation>
 </semantics>
</math>

 will not be a simple delta function, which will reduce the performance of the method. In such cases, a <a href="window_function" title="wikilink">window function</a> (such as a Gaussian or Tukey window) should be employed during the Fourier transform to reduce edge effects, or the images should be zero padded so that the edge effects can be ignored. If the images consist of a flat background, with all detail situated away from the edges, then a linear shift will be equivalent to a circular shift, and the above derivation will hold exactly. The peak can be sharpened by using edge or vector correlation. <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>For <a href="periodic_function" title="wikilink">periodic</a> images (such as a chessboard), phase correlation may yield ambiguous results with several peaks in the resulting output.</p>
<h2 id="applications">Applications</h2>

<p>Phase correlation is the preferred method for <a href="television_standards_conversion" title="wikilink">television standards conversion</a>, as it leaves the fewest artifacts.</p>
<h2 id="see-also">See also</h2>

<p>General</p>
<ul>
<li><a href="Cross_correlation" title="wikilink">Cross correlation</a></li>
<li><a href="Scaled_Correlation" title="wikilink">Scaled Correlation</a></li>
</ul>

<p>Television</p>
<ul>
<li><a href="Television_standards_conversion" title="wikilink">Television standards conversion</a></li>
<li><a href="Reverse_Standards_Conversion" title="wikilink">Reverse Standards Conversion</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.mathworks.com/products/demos/image/cross_correlation/imreg.html">Using Matlab to perform normalized cross-correlation on images</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computer_vision" title="wikilink">Category:Computer vision</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Harold S. Stone, "A Fast Direct Fourier-Based Algorithm for Subpixel Registration of Images", IEEE Transactions on Geoscience and Remote Sensing, V. 39, No. 10, Oct. 2001, pp.2235-2242.<a href="#fnref1">↩</a></li>
<li id="fn2">E. De Castro and C. Morandi "Registration of Translated and Rotated Images Using Finite Fourier Transforms", IEEE Transactions on pattern analysis and machine intelligence, Sept. 1987<a href="#fnref2">↩</a></li>
<li id="fn3">B. S Reddy and B. N. Chatterji, “An FFT-based technique for translation, rotation, and scale-invariant image registration”, IEEE Transactions on Image Processing 5, no. 8 (1996): 1266–1271.<a href="#fnref3">↩</a></li>
<li id="fn4"><a class="uri" href="http://www.jprr.org/index.php/jprr/article/viewFile/355/148">http://www.jprr.org/index.php/jprr/article/viewFile/355/148</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

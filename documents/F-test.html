<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="15">F-test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>F-test</h1>
<hr/>

<p>An <strong><em>F</em>-test</strong> is any <a href="statistical_test" title="wikilink">statistical test</a> in which the <a href="test_statistic" title="wikilink">test statistic</a> has an <a href="F-distribution" title="wikilink"><em>F</em>-distribution</a> under the <a href="null_hypothesis" title="wikilink">null hypothesis</a>. It is most often used when <a href="model_selection" title="wikilink">comparing statistical models</a> that have been fitted to a <a class="uri" href="data" title="wikilink">data</a> set, in order to identify the model that best fits the <a href="population_(statistics)" title="wikilink">population</a> from which the data were sampled. Exact "<em>F</em>-tests" mainly arise when the models have been fitted to the data using <a href="least_squares" title="wikilink">least squares</a>. The name was coined by <a href="George_W._Snedecor" title="wikilink">George W. Snedecor</a>, in honour of Sir <a href="Ronald_A._Fisher" title="wikilink">Ronald A. Fisher</a>. Fisher initially developed the statistic as the variance ratio in the 1920s.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="common-examples-of-f-tests">Common examples of <em>F</em>-tests</h2>

<p>Common examples of the use of'' F-''tests are, for example, the study of the following cases:</p>
<ul>
<li>The hypothesis that the means of a given set of <a href="normal_distribution" title="wikilink">normally distributed</a> populations, all having the same <a href="standard_deviation" title="wikilink">standard deviation</a>, are equal. This is perhaps the best-known <em>F</em>-test, and plays an important role in the <a href="analysis_of_variance" title="wikilink">analysis of variance</a> (ANOVA).</li>
</ul>
<ul>
<li>The hypothesis that a proposed regression model fits the <a class="uri" href="data" title="wikilink">data</a> well. See <a href="Lack-of-fit_sum_of_squares" title="wikilink">Lack-of-fit sum of squares</a>.</li>
</ul>
<ul>
<li>The hypothesis that a data set in a <a href="regression_analysis" title="wikilink">regression analysis</a> follows the simpler of two proposed linear models that are <a href="Statistical_model#Nested_models" title="wikilink">nested</a> within each other.</li>
</ul>

<p>In addition, some statistical procedures, such as <a href="Scheffé's_method" title="wikilink">Scheffé's method</a> for multiple comparisons adjustment in linear models, also use F-tests.</p>
<h3 id="f-test-of-the-equality-of-two-variances"><em>F</em>-test of the equality of two variances</h3>

<p>The <em>F</em>-test is <a href="robust_statistics" title="wikilink">sensitive</a> to <a href="normal_distribution" title="wikilink">non-normality</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In the <a href="analysis_of_variance" title="wikilink">analysis of variance</a> (ANOVA), alternative tests include <a href="Levene's_test" title="wikilink">Levene's test</a>, <a href="Bartlett's_test" title="wikilink">Bartlett's test</a>, and the <a href="Brown–Forsythe_test" title="wikilink">Brown–Forsythe test</a>. However, when any of these tests are conducted to test the underlying assumption of <a class="uri" href="homoscedasticity" title="wikilink">homoscedasticity</a> (<em>i.e.</em> homogeneity of variance), as a preliminary step to testing for mean effects, there is an increase in the experiment-wise <a href="Type_I_error" title="wikilink">Type I error</a> rate.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="formula-and-calculation">Formula and calculation</h2>

<p>Most <em>F</em>-tests arise by considering a decomposition of the <a href="variance" title="wikilink">variability</a> in a collection of data in terms of <a href="Partition_of_sums_of_squares" title="wikilink">sums of squares</a>. The <a href="test_statistic" title="wikilink">test statistic</a> in an <em>F</em>-test is the ratio of two scaled sums of squares reflecting different sources of variability. These sums of squares are constructed so that the statistic tends to be greater when the null hypothesis is not true. In order for the statistic to follow the <a href="F-distribution" title="wikilink"><em>F</em>-distribution</a> under the null hypothesis, the sums of squares should be <a href="independence_(probability_theory)" title="wikilink">statistically independent</a>, and each should follow a scaled <a href="chi-squared_distribution" title="wikilink">chi-squared distribution</a>. The latter condition is guaranteed if the data values are independent and <a href="normal_distribution" title="wikilink">normally distributed</a> with a common <a class="uri" href="variance" title="wikilink">variance</a>.</p>
<h3 id="multiple-comparison-anova-problems">Multiple-comparison ANOVA problems</h3>

<p>The <em>F</em>-test in one-way analysis of variance is used to assess whether the <a href="expected_value" title="wikilink">expected values</a> of a quantitative variable within several pre-defined groups differ from each other. For example, suppose that a medical trial compares four treatments. The ANOVA <em>F</em>-test can be used to assess whether any of the treatments is on average superior, or inferior, to the others versus the null hypothesis that all four treatments yield the same mean response. This is an example of an "omnibus" test, meaning that a single test is performed to detect any of several possible differences. Alternatively, we could carry out pairwise tests among the treatments (for instance, in the medical trial example with four treatments we could carry out six tests among pairs of treatments). The advantage of the ANOVA <em>F</em>-test is that we do not need to pre-specify which treatments are to be compared, and we do not need to adjust for making <a href="multiple_comparisons" title="wikilink">multiple comparisons</a>. The disadvantage of the ANOVA <em>F</em>-test is that if we reject the <a href="null_hypothesis" title="wikilink">null hypothesis</a>, we do not know which treatments can be said to be significantly different from the others, nor, if the <em>F</em>-test is performed at level α we can state that the treatment pair with the greatest mean difference is significantly different at level α.</p>

<p>The formula for the one-way <strong>ANOVA</strong> <em>F</em>-test <a href="test_statistic" title="wikilink">statistic</a> is</p>

<p>

<math display="block" id="F-test:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mo>=</mo>
    <mfrac>
     <mtext>explained variance</mtext>
     <mtext>unexplained variance</mtext>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>F</ci>
    <apply>
     <divide></divide>
     <mtext>explained variance</mtext>
     <mtext>unexplained variance</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F=\frac{\text{explained variance}}{\text{unexplained variance}},
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="F-test:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mo>=</mo>
    <mfrac>
     <mtext>between-group variability</mtext>
     <mtext>within-group variability</mtext>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>F</ci>
    <apply>
     <divide></divide>
     <mtext>between-group variability</mtext>
     <mtext>within-group variability</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F=\frac{\text{between-group variability}}{\text{within-group variability}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The "explained variance", or "between-group variability" is</p>

<p>

<math display="block" id="F-test:2">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>i</mi>
   </munder>
   <mrow>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>Y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mrow>
          <mi>i</mi>
          <mo>⋅</mo>
         </mrow>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>Y</mi>
         <mo stretchy="false">¯</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>K</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>Y</ci>
         </apply>
         <list>
          <ci>i</ci>
          <ci>normal-⋅</ci>
         </list>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>K</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i}n_{i}(\bar{Y}_{i\cdot}-\bar{Y})^{2}/(K-1)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="F-test:3">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>Y</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mrow>
    <mi>i</mi>
    <mo>⋅</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>Y</ci>
    </apply>
    <list>
     <ci>i</ci>
     <ci>normal-⋅</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{Y}_{i\cdot}
  </annotation>
 </semantics>
</math>

 denotes the <a href="average" title="wikilink">sample mean</a> in the <em>i</em><sup>th</sup> group, <em>n</em><sub><em>i</em></sub> is the number of observations in the <em>i</em><sup>th</sup> group,

<math display="inline" id="F-test:4">
 <semantics>
  <mover accent="true">
   <mi>Y</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{Y}
  </annotation>
 </semantics>
</math>

 denotes the overall mean of the data, and <em>K</em> denotes the number of groups.</p>

<p>The "unexplained variance", or "within-group variability" is</p>

<p>

<math display="block" id="F-test:5">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </munder>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>Y</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>Y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mrow>
          <mi>i</mi>
          <mo>⋅</mo>
         </mrow>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mi>K</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>Y</ci>
        </apply>
        <list>
         <ci>i</ci>
         <ci>normal-⋅</ci>
        </list>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>N</ci>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{ij}(Y_{ij}-\bar{Y}_{i\cdot})^{2}/(N-K),
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>Y</em><sub><em>ij</em></sub> is the <em>j</em><sup>th</sup> observation in the <em>i</em><sup>th</sup> out of <em>K</em> groups and <em>N</em> is the overall sample size. This <em>F</em>-statistic follows the <a href="F-distribution" title="wikilink"><em>F</em>-distribution</a> with <em>K</em>−1, <em>N</em> −<em>K</em> degrees of freedom under the null hypothesis. The statistic will be large if the between-group variability is large relative to the within-group variability, which is unlikely to happen if the <a href="expected_value" title="wikilink">population means</a> of the groups all have the same value.</p>

<p>Note that when there are only two groups for the one-way ANOVA <em>F</em>-test, <em>F</em>=<em>t</em><sup>2</sup> where <em>t</em> is the <a href="Student's_t-test" title="wikilink">Student's <em>t</em> statistic</a>.</p>
<h3 id="regression-problems">Regression problems</h3>

<p>Consider two models, 1 and 2, where model 1 is 'nested' within model 2. Model 1 is the Restricted model, and Model 2 is the Unrestricted one. That is, model 1 has <em>p</em><sub>1</sub> parameters, and model 2 has <em>p</em><sub>2</sub> parameters, where <em>p</em><sub>2</sub> &gt; <em>p</em><sub>1</sub>, and for any choice of parameters in model 1, the same regression curve can be achieved by some choice of the parameters of model 2. (We use the convention that any constant parameter in a model is included when counting the parameters. For instance, the simple linear model <em>y</em> = <em>mx</em> + <em>b</em> has <em>p</em>=2 under this convention.) The model with more parameters will always be able to fit the data at least as well as the model with fewer parameters. Thus typically model 2 will give a better (i.e. lower error) fit to the data than model 1. But one often wants to determine whether model 2 gives a <em>significantly</em> better fit to the data. One approach to this problem is to use an <em>F</em> test.</p>

<p>If there are <em>n</em> data points to estimate parameters of both models from, then one can calculate the <em>F</em> statistic, given by</p>

<p>

<math display="block" id="F-test:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <msub>
         <mtext>RSS</mtext>
         <mn>1</mn>
        </msub>
        <mo>-</mo>
        <msub>
         <mtext>RSS</mtext>
         <mn>2</mn>
        </msub>
       </mrow>
       <mrow>
        <msub>
         <mi>p</mi>
         <mn>2</mn>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>p</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <msub>
        <mtext>RSS</mtext>
        <mn>2</mn>
       </msub>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <msub>
         <mi>p</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>F</ci>
    <apply>
     <divide></divide>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>RSS</mtext>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>RSS</mtext>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>RSS</mtext>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F=\frac{\left(\frac{\text{RSS}_{1}-\text{RSS}_{2}}{p_{2}-p_{1}}\right)}{\left(%
\frac{\text{RSS}_{2}}{n-p_{2}}\right)},
  </annotation>
 </semantics>
</math>

</p>

<p>where RSS<sub><em>i</em></sub> is the <a href="residual_sum_of_squares" title="wikilink">residual sum of squares</a> of model <em>i</em>. If your regression model has been calculated with weights, then replace RSS<sub><em>i</em></sub> with χ<sup>2</sup>, the weighted sum of squared residuals. Under the null hypothesis that model 2 does not provide a significantly better fit than model 1, <em>F</em> will have an <em>F</em> distribution, with (<em>p</em><sub>2</sub>−<em>p</em><sub>1</sub>, <em>n</em>−<em>p</em><sub>2</sub>) <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a>. The null hypothesis is rejected if the <em>F</em> calculated from the data is greater than the critical value of the <a href="F-distribution" title="wikilink"><em>F</em>-distribution</a> for some desired false-rejection probability (e.g. 0.05). The <em>F</em>-test is a <a href="Wald_test" title="wikilink">Wald test</a>.</p>
<h2 id="one-way-anova-example">One-way ANOVA example</h2>

<p>Consider an experiment to study the effect of three different levels of a factor on a response (e.g. three levels of a fertilizer on plant growth). If we had 6 observations for each level, we could write the outcome of the experiment in a table like this, where <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, and <em>a</em><sub>3</sub> are the three levels of the factor being studied.</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><em>a</em><sub>1</sub></p></th>
<th style="text-align: left;">
<p><em>a</em><sub>2</sub></p></th>
<th style="text-align: left;">
<p><em>a</em><sub>3</sub></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>13</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>9</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>11</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>11</p></td>
<td style="text-align: left;">
<p>8</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>7</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>The null hypothesis, denoted H<sub>0</sub>, for the overall <em>F</em>-test for this experiment would be that all three levels of the factor produce the same response, on average. To calculate the <em>F</em>-ratio:</p>

<p><strong>Step 1:</strong> Calculate the mean within each group:</p>

<p>

<math display="inline" id="F-test:7">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>Y</mi>
    <mo>¯</mo>
   </mover>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\overline{Y}_{1}
  </annotation>
 </semantics>
</math>


</p>

<p><strong>Step 2:</strong> Calculate the overall mean:</p>

<p>

<math display="block" id="F-test:8">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>Y</mi>
    <mo>¯</mo>
   </mover>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mi>i</mi>
     </msub>
     <msub>
      <mover accent="true">
       <mi>Y</mi>
       <mo>¯</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mrow>
    <mi>a</mi>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>Y</mi>
       <mo>¯</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <mo>+</mo>
     <msub>
      <mover accent="true">
       <mi>Y</mi>
       <mo>¯</mo>
      </mover>
      <mn>2</mn>
     </msub>
     <mo>+</mo>
     <msub>
      <mover accent="true">
       <mi>Y</mi>
       <mo>¯</mo>
      </mover>
      <mn>3</mn>
     </msub>
    </mrow>
    <mi>a</mi>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>5</mn>
     <mo>+</mo>
     <mn>9</mn>
     <mo>+</mo>
     <mn>10</mn>
    </mrow>
    <mn>3</mn>
   </mfrac>
   <mo>=</mo>
   <mn>8</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¯</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>Y</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>Y</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>Y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>Y</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <cn type="integer">5</cn>
       <cn type="integer">9</cn>
       <cn type="integer">10</cn>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">8</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{Y}=\frac{\sum_{i}\overline{Y}_{i}}{a}=\frac{\overline{Y}_{1}+%
\overline{Y}_{2}+\overline{Y}_{3}}{a}=\frac{5+9+10}{3}=8
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd>where <em>a</em> is the number of groups.
</dd>
</dl>

<p><strong>Step 3:</strong> Calculate the "between-group" sum of squared differences:</p>

<p>

<math display="inline" id="F-test:9">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle S_{B}
  </annotation>
 </semantics>
</math>


</p>

<p>where <em>n</em> is the number of data values per group.</p>

<p>The between-group degrees of freedom is one less than the number of groups</p>

<p>

<math display="block" id="F-test:10">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>b</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">3</cn>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{b}=3-1=2
  </annotation>
 </semantics>
</math>

</p>

<p>so the between-group mean square value is</p>

<p>

<math display="block" id="F-test:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>M</mi>
    <msub>
     <mi>S</mi>
     <mi>B</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>84</mn>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mo>=</mo>
   <mn>42</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>M</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>B</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">84</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">42</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MS_{B}=84/2=42
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Step 4:</strong> Calculate the "within-group" sum of squares. Begin by centering the data in each group</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><em>a</em><sub>1</sub></p></th>
<th style="text-align: left;">
<p><em>a</em><sub>2</sub></p></th>
<th style="text-align: left;">
<p><em>a</em><sub>3</sub></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>6−5=1</p></td>
<td style="text-align: left;">
<p>8−9=−1</p></td>
<td style="text-align: left;">
<p>13−10=3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8−5=3</p></td>
<td style="text-align: left;">
<p>12−9=3</p></td>
<td style="text-align: left;">
<p>9−10=−1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4−5=−1</p></td>
<td style="text-align: left;">
<p>9−9=0</p></td>
<td style="text-align: left;">
<p>11−10=1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5−5=0</p></td>
<td style="text-align: left;">
<p>11−9=2</p></td>
<td style="text-align: left;">
<p>8−10=−2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3−5=−2</p></td>
<td style="text-align: left;">
<p>6−9=−3</p></td>
<td style="text-align: left;">
<p>7−10=−3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4−5=−1</p></td>
<td style="text-align: left;">
<p>8−9=−1</p></td>
<td style="text-align: left;">
<p>12−10=2</p></td>
</tr>
</tbody>
</table>

<p>The within-group sum of squares is the sum of squares of all 18 values in this table</p>

<p>

<math display="inline" id="F-test:12">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>W</mi>
   </msub>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>W</ci>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle S_{W}=
  </annotation>
 </semantics>
</math>


</p>

<p>The within-group degrees of freedom is</p>

<p>

<math display="block" id="F-test:13">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>W</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>6</mn>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>15</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>W</ci>
     </apply>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <apply>
       <minus></minus>
       <cn type="integer">6</cn>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">15</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{W}=a(n-1)=3(6-1)=15
  </annotation>
 </semantics>
</math>

 </p>

<p>Thus the within-group mean square value is</p>

<p>

<math display="block" id="F-test:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>M</mi>
    <msub>
     <mi>S</mi>
     <mi>W</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>W</mi>
    </msub>
    <mo>/</mo>
    <msub>
     <mi>f</mi>
     <mi>W</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>68</mn>
    <mo>/</mo>
    <mn>15</mn>
   </mrow>
   <mo>≈</mo>
   <mn>4.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>M</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>W</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>W</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>W</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">68</cn>
      <cn type="integer">15</cn>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">4.5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   MS_{W}=S_{W}/f_{W}=68/15\approx 4.5
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Step 5:</strong> The <em>F</em>-ratio is</p>

<p>

<math display="block" id="F-test:15">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>M</mi>
     <msub>
      <mi>S</mi>
      <mi>B</mi>
     </msub>
    </mrow>
    <mrow>
     <mi>M</mi>
     <msub>
      <mi>S</mi>
      <mi>W</mi>
     </msub>
    </mrow>
   </mfrac>
   <mo>≈</mo>
   <mrow>
    <mn>42</mn>
    <mo>/</mo>
    <mn>4.5</mn>
   </mrow>
   <mo>≈</mo>
   <mn>9.3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>F</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>M</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>B</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>M</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>W</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">42</cn>
      <cn type="float">4.5</cn>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">9.3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F=\frac{MS_{B}}{MS_{W}}\approx 42/4.5\approx 9.3
  </annotation>
 </semantics>
</math>

</p>

<p>The critical value is the number that the test statistic must exceed to reject the test. In this case, <em>F</em><sub>crit</sub>(2,15) = 3.68 at <em>α</em> = 0.05. Since <em>F</em>=9.3 &gt; 3.68, the results are <a href="Statistical_significance" title="wikilink">significant</a> at the 5% significance level. One would reject the null hypothesis, concluding that there is strong evidence that the expected values in the three groups differ. The <a class="uri" href="p-value" title="wikilink">p-value</a> for this test is 0.002.</p>

<p>After performing the <em>F</em>-test, it is common to carry out some "post-hoc" analysis of the group means. In this case, the first two group means differ by 4 units, the first and third group means differ by 5 units, and the second and third group means differ by only 1 unit. The <a href="standard_error" title="wikilink">standard error</a> of each of these differences is 

<math display="inline" id="F-test:16">
 <semantics>
  <mrow>
   <msqrt>
    <mrow>
     <mrow>
      <mn>4.5</mn>
      <mo>/</mo>
      <mn>6</mn>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>4.5</mn>
      <mo>/</mo>
      <mn>6</mn>
     </mrow>
    </mrow>
   </msqrt>
   <mo>=</mo>
   <mn>1.2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <root></root>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="float">4.5</cn>
       <cn type="integer">6</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="float">4.5</cn>
       <cn type="integer">6</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{4.5/6+4.5/6}=1.2
  </annotation>
 </semantics>
</math>

. Thus the first group is strongly different from the other groups, as the mean difference is more times the standard error, so we can be highly confident that the <a href="expected_value" title="wikilink">population mean</a> of the first group differs from the population means of the other groups. However, there is no evidence that the second and third groups have different population means from each other, as their mean difference of one unit is comparable to the standard error.</p>

<p>Note <em>F</em>(<em>x</em>, <em>y</em>) denotes an <a href="F-distribution" title="wikilink"><em>F</em>-distribution</a> cumulative distribution function with <em>x</em> degrees of freedom in the numerator and <em>y</em> degrees of freedom in the denominator.</p>
<h2 id="anovas-robustness-with-respect-to-type-i-errors-for-departures-from-population-normality">ANOVA's robustness with respect to Type I errors for departures from population normality</h2>

<p>The one-way ANOVA can be generalized to the factorial and multivariate layouts, as well as to the analysis of covariance.</p>

<p>It is often stated in popular literature that none of these <em>F</em>-tests are <a href="robust_statistics" title="wikilink">robust</a> when there are severe violations of the assumption that each population follows the <a href="normal_distribution" title="wikilink">normal distribution</a>, particularly for small alpha levels and unbalanced layouts.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Furthermore, it is also claimed that if the underlying assumption of <a class="uri" href="homoscedasticity" title="wikilink">homoscedasticity</a> is violated, the <a href="Type_I_error" title="wikilink">Type I error</a> properties degenerate much more severely.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>However, this is a misconception, based on work done in the 1950s and earlier. The first comprehensive investigation of the issue by Monte Carlo simulation was Donaldson (1966).<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> He showed that under the usual departures (positive skew, unequal variances) "the <em>F</em>-test is conservative" so is less likely than it should be to find that a variable is significant. However, as either the sample size or the number of cells increases, "the power curves seem to converge to that based on the normal distribution". Tiku (1971) found that "the non-normal theory power of <em>F</em> is found to differ from the normal theory power by a correction term which decreases sharply with increasing sample size."<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The problem of non-normality, especially in large samples, is far less serious than popular articles would suggest.</p>

<p>The current view is that "Monte-Carlo studies were used extensively with normal distribution-based tests to determine how sensitive they are to violations of the assumption of normal distribution of the analyzed variables in the population. The general conclusion from these studies is that the consequences of such violations are less severe than previously thought. Although these conclusions should not entirely discourage anyone from being concerned about the normality assumption, they have increased the overall popularity of the distribution-dependent statistical tests in all areas of research."<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>For nonparametric alternatives in the factorial layout, see Sawilowsky.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> For more discussion see <a href="ANOVA_on_ranks" title="wikilink">ANOVA on ranks</a>.</p>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.public.iastate.edu/~alicia/stat328/Multiple%20regression%20-%20F%20test.pdf">Testing utility of model – <em>F</em>-test</a></li>
<li><a href="http://rkb.home.cern.ch/rkb/AN16pp/node81.html"><em>F</em>-test</a></li>
<li><a href="http://www.itl.nist.gov/div898/handbook/eda/section3/eda3673.htm">Table of <em>F</em>-test critical values</a></li>
<li><a href="http://office.microsoft.com/en-gb/excel-help/ftest-HP005209098.aspx">FTEST in Microsoft Excel which is different</a></li>
<li><a href="http://www.waterlog.info/f-test.htm">Free calculator for <em>F</em>-testing</a></li>
<li><a href="http://facweb.cs.depaul.edu/sjost/csc423/documents/f-test-reg.htm">The <em>F</em>-test for Linear Regression</a></li>
<li><a href="http://www.bodowinter.com/tutorial/bw_anova_general.pdf">The F distribution and the basic principle behind ANOVAs</a></li>
<li>

<p>by <a href="Mark_Thoma" title="wikilink">Mark Thoma</a></p></li>
</ul>

<p>"</p>

<p><a href="Category:Analysis_of_variance" title="wikilink">Category:Analysis of variance</a> <a href="Category:Statistical_ratios" title="wikilink">Category:Statistical ratios</a> <a href="Category:Statistical_tests" title="wikilink">Category:Statistical tests</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><mtpl></mtpl><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a class="uri" href="https://www.statsoft.com/textbook/elementary-statistics-concepts/">https://www.statsoft.com/textbook/elementary-statistics-concepts/</a><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
</ol>
</section>
</body>
</html>

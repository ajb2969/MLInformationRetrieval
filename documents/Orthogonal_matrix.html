<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title offset="257">Orthogonal matrix</title>
   <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js">
    </script>
</head>
<body>
<h1>Orthogonal matrix</h1>
<hr/>
<p>In <a href="linear_algebra" title="wikilink">linear algebra</a>, an <strong>orthogonal matrix</strong> is a <a href="square_matrix" title="wikilink">square matrix</a> with <a href="real_number" title="wikilink">real</a> entries whose columns and rows are <a class="uri" href="orthogonal" title="wikilink">orthogonal</a> <a href="unit_vector" title="wikilink">unit vectors</a> (i.e., <a href="orthonormality" title="wikilink">orthonormal</a> vectors), i.e.</p>
<p><span class="LaTeX">$$Q^\mathrm{T} Q = Q Q^\mathrm{T} = I,$$</span> where <em>I</em> is the <a href="identity_matrix" title="wikilink">identity matrix</a>.</p>
<p>This leads to the equivalent characterization: a matrix <em>Q</em> is orthogonal if its <a class="uri" href="transpose" title="wikilink">transpose</a> is equal to its <a href="inverse_matrix" title="wikilink">inverse</a>:</p>
<p><span class="LaTeX">$$Q^\mathrm{T}=Q^{-1}, \,$$</span></p>
<p>An orthogonal matrix <em>Q</em> is necessarily <a href="Invertible_matrix" title="wikilink">invertible</a> (with inverse <mtpl></mtpl>), <a href="Unitary_matrix" title="wikilink">unitary</a> (<mtpl></mtpl>) and therefore <a href="Normal_matrix" title="wikilink">normal</a> (<mtpl></mtpl>) in the reals. The <a class="uri" href="determinant" title="wikilink">determinant</a> of any orthogonal matrix is either +1 or −1. As a <a href="linear_transformation" title="wikilink">linear transformation</a>, an orthogonal matrix preserves the <a href="dot_product" title="wikilink">dot product</a> of vectors, and therefore acts as an <a class="uri" href="isometry" title="wikilink">isometry</a> of <a href="Euclidean_space" title="wikilink">Euclidean space</a>, such as a <a href="Rotation_(mathematics)" title="wikilink">rotation</a> or <a href="reflection_(mathematics)" title="wikilink">reflection</a>. In other words, it is a <a href="unitary_transformation" title="wikilink">unitary transformation</a>.</p>
<p>The set of  orthogonal matrices forms a <a href="group_(mathematics)" title="wikilink">group</a> O(<em>n</em>), known as the <a href="orthogonal_group" title="wikilink">orthogonal group</a>. The <a class="uri" href="subgroup" title="wikilink">subgroup</a> SO(<em>n</em>) consisting of orthogonal matrices with <a class="uri" href="determinant" title="wikilink">determinant</a> +1 is called the <a href="special_orthogonal_group" title="wikilink">special orthogonal group</a>, and each of its elements is a <strong>special orthogonal matrix</strong>. As a linear transformation, every special orthogonal matrix acts as a rotation.</p>
<p>The <a href="complex_number" title="wikilink">complex</a> analogue of an orthogonal matrix is a <a href="unitary_matrix" title="wikilink">unitary matrix</a>.</p>
<h2 id="overview">Overview</h2>
<p>An orthogonal matrix is the real specialization of a <a href="unitary_matrix" title="wikilink">unitary matrix</a>, and thus always a <a href="normal_matrix" title="wikilink">normal matrix</a>. Although we consider only real matrices here, the definition can be used for matrices with entries from any <a href="field_(mathematics)" title="wikilink">field</a>. However, orthogonal matrices arise naturally from <a href="dot_product" title="wikilink">dot products</a>, and for matrices of complex numbers that leads instead to the unitary requirement. Orthogonal matrices preserve the dot product,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> so, for vectors <strong>u</strong>, <strong>v</strong> in an <em>n</em>-dimensional real <a href="Euclidean_space" title="wikilink">Euclidean space</a></p>
<p><span class="LaTeX">$${\bold u} \cdot {\bold v} = \left(Q {\bold u}\right) \cdot \left(Q {\bold v}\right) \,$$</span></p>
<p>where <em>Q</em> is an orthogonal matrix. To see the inner product connection, consider a vector <strong>v</strong> in an <em>n</em>-dimensional real <a href="Euclidean_space" title="wikilink">Euclidean space</a>. Written with respect to an orthonormal basis, the squared length of <strong>v</strong> is <strong>v</strong><sup>T</sup><strong>v</strong>. If a linear transformation, in matrix form <em>Q</em><strong>v</strong>, preserves vector lengths, then</p>
<p><span class="LaTeX">$${\bold v}^\mathrm{T}{\bold v} = (Q{\bold v})^\mathrm{T}(Q{\bold v}) = {\bold v}^\mathrm{T} Q^\mathrm{T} Q {\bold v} .$$</span></p>
<p>Thus <a href="dimension_(vector_space)" title="wikilink">finite-dimensional</a> linear <a href="isometry" title="wikilink">isometries</a>—rotations, reflections, and their combinations—produce orthogonal matrices. The converse is also true: orthogonal matrices imply orthogonal transformations. However, <a href="linear_algebra" title="wikilink">linear algebra</a> includes orthogonal transformations between spaces which may be neither finite-dimensional nor of the same dimension, and these have no orthogonal matrix equivalent.</p>
<p>Orthogonal matrices are important for a number of reasons, both theoretical and practical. The <em>n</em>×<em>n</em> orthogonal matrices form a <a href="group_(mathematics)" title="wikilink">group</a> under matrix multiplication, the <a href="orthogonal_group" title="wikilink">orthogonal group</a> denoted by O(<em>n</em>), which—with its subgroups—is widely used in mathematics and the physical sciences. For example, the <a href="point_group" title="wikilink">point group</a> of a molecule is a subgroup of O(3). Because floating point versions of orthogonal matrices have advantageous properties, they are key to many algorithms in numerical <a href="linear_algebra" title="wikilink">linear algebra</a>, such as <a href="QR_decomposition" title="wikilink">QR decomposition</a>. As another example, with appropriate normalization the <a href="discrete_cosine_transform" title="wikilink">discrete cosine transform</a> (used in <a class="uri" href="MP3" title="wikilink">MP3</a> compression) is represented by an orthogonal matrix.</p>
<h2 id="examples">Examples</h2>
<p>Below are a few examples of small orthogonal matrices and possible interpretations.</p>
<ul>
<li><math></math></li>
</ul>
<p>\begin{bmatrix} 1 & 0 \\ 0 & 1 \\ \end{bmatrix} \qquad (\text{identity transformation})</p>
<p>An instance of a 2×2 <a href="rotation_matrix" title="wikilink">rotation matrix</a>:</p>
<ul>
<li><math></math></li>
</ul>
<p>R(16.26^\circ ) = \begin{bmatrix} \cos \theta & -\sin \theta \\ \sin \theta & \cos \theta \\ \end{bmatrix} = \begin{bmatrix} 0.96 & -0.28 \\ 0.28 & \;\;\,0.96 \\ \end{bmatrix} \qquad (\text{rotation by }16.26^\circ )</p>
<ul>
<li><math></math></li>
</ul>
<p>\begin{bmatrix} 1 & 0 \\ 0 & -1 \\ \end{bmatrix} \qquad (\text{reflection across }x\text{-axis})</p>
<ul>
<li><math></math></li>
</ul>
<p>\begin{bmatrix} 0 & -0.80 & -0.60 \\ 0.80 & -0.36 & \;\;\,0.48 \\ 0.60 & \;\;\,0.48 & -0.64 \end{bmatrix} \qquad \left( \begin{align}&\text{rotoinversion:} \\&\text{axis }(0,-3/5,4/5),\text{ angle }90^{\circ}\end{align}\right)</p>
<ul>
<li><math></math></li>
</ul>
<p>\begin{bmatrix} 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \end{bmatrix} \qquad (\text{permutation of coordinate axes})</p>
<h2 id="elementary-constructions">Elementary constructions</h2>
<h3 id="lower-dimensions">Lower dimensions</h3>
<p>The simplest orthogonal matrices are the 1×1 matrices [1] and [−1] which we can interpret as the identity and a reflection of the real line across the origin.</p>
<p>The  matrices have the form</p>
<p><span class="LaTeX">$$\begin{bmatrix}
p & t\\
q & u
\end{bmatrix},$$</span></p>
<p>which orthogonality demands satisfy the three equations</p>
<p><span class="LaTeX">$$\begin{align}
1 & = p^2+t^2, \\
1 & = q^2+u^2, \\
0 & = pq+tu.
\end{align}$$</span></p>
<p>In consideration of the first equation, without loss of generality let , ; then either ,  or , . We can interpret the first case as a rotation by <em>θ</em> (where  is the identity), and the second as a reflection across a line at an angle of <em>θ</em>/2.</p>
<p><span class="LaTeX">$$\begin{bmatrix}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta \\
\end{bmatrix}\text{ (rotation), }\qquad
\begin{bmatrix}
\cos \theta & \sin \theta \\
\sin \theta & -\cos \theta \\
\end{bmatrix}\text{ (reflection)}$$</span></p>
<p>The special case of the reflection matrix with  generates a reflection about the line at 45° given by  and therefore exchanges <em>x</em> and <em>y</em>; it is a <a href="permutation_matrix" title="wikilink">permutation matrix</a>, with a single 1 in each column and row (and otherwise 0):</p>
<p><span class="LaTeX">$$\begin{bmatrix}
0 & 1\\
1 & 0
\end{bmatrix}.$$</span></p>
<p>The identity is also a permutation matrix.</p>
<p>A reflection is <a href="Involutory_matrix" title="wikilink">its own inverse</a>, which implies that a reflection matrix is <a href="symmetric_matrix" title="wikilink">symmetric</a> (equal to its transpose) as well as orthogonal. The product of two rotation matrices is a rotation matrix, and the product of two reflection matrices is also a rotation matrix.</p>
<h3 id="higher-dimensions">Higher dimensions</h3>
<p>Regardless of the dimension, it is always possible to classify orthogonal matrices as purely rotational or not, but for  matrices and larger the non-rotational matrices can be more complicated than reflections. For example,</p>
<p><span class="LaTeX">$$\begin{bmatrix}
-1 & 0 & 0\\
0 & -1 & 0\\
0 & 0 & -1
\end{bmatrix}\text{ and }
\begin{bmatrix}
0 & -1 & 0\\
1 & 0 & 0\\
0 & 0 & -1
\end{bmatrix}$$</span></p>
<p>represent an <em><a href="Inversion_in_a_point" title="wikilink">inversion</a></em> through the origin and a <em><a href="improper_rotation" title="wikilink">rotoinversion</a></em> about the <em>z</em> axis.</p>
<p><span class="LaTeX">$$\begin{bmatrix}
\cos (\alpha)\cos (\gamma)-\sin (\alpha)\sin (\beta)\sin (\gamma) & -\sin (\alpha)\cos (\beta) & -\cos (\alpha)\sin (\gamma)-\sin (\alpha)\sin (\beta)\cos (\gamma) \\ 
\cos (\alpha)\sin (\beta)\sin (\gamma)+\sin (\alpha)\cos (\gamma) & \cos (\alpha)\cos (\beta)  & \cos (\alpha)\sin (\beta )\cos (\gamma )-\sin (\alpha )\sin (\gamma) \\ 
\cos (\beta)\sin (\gamma) & -\sin (\beta)  & \cos (\beta)\cos (\gamma)
\end{bmatrix}$$</span></p>
<p>Rotations become more complicated in higher dimensions; they can no longer be completely characterized by one angle, and may affect more than one planar subspace. It is common to describe a  rotation matrix in terms of an <a href="axis_and_angle" title="wikilink">axis and angle</a>, but this only works in three dimensions. Above three dimensions two or more angles are needed, each associated with a <a href="plane_of_rotation" title="wikilink">plane of rotation</a>.</p>
<p>However, we have elementary building blocks for permutations, reflections, and rotations that apply in general.</p>
<h3 id="primitives">Primitives</h3>
<p>The most elementary permutation is a transposition, obtained from the identity matrix by exchanging two rows. Any <em>n</em>×<em>n</em> permutation matrix can be constructed as a product of no more than  transpositions.</p>
<p>A <a href="Householder_reflection" title="wikilink">Householder reflection</a> is constructed from a non-null vector <strong>v</strong> as</p>
<p><span class="LaTeX">$$Q = I - 2 {{\bold v}{\bold v}^\mathrm{T} \over {\bold v}^\mathrm{T}{\bold v}} .$$</span></p>
<p>Here the numerator is a symmetric matrix while the denominator is a number, the squared magnitude of <strong>v</strong>. This is a reflection in the hyperplane perpendicular to <strong>v</strong> (negating any vector component parallel to <strong>v</strong>). If <strong>v</strong> is a unit vector, then <mtpl></mtpl> suffices. A Householder reflection is typically used to simultaneously zero the lower part of a column. Any orthogonal matrix of size  can be constructed as a product of at most <em>n</em> such reflections.</p>
<p>A <a href="Givens_rotation" title="wikilink">Givens rotation</a> acts on a two-dimensional (planar) subspace spanned by two coordinate axes, rotating by a chosen angle. It is typically used to zero a single subdiagonal entry. Any rotation matrix of size <em>n</em>×<em>n</em> can be constructed as a product of at most  such rotations. In the case of  matrices, three such rotations suffice; and by fixing the sequence we can thus describe all  rotation matrices (though not uniquely) in terms of the three angles used, often called <a href="Euler_angles" title="wikilink">Euler angles</a>.</p>
<p>A <a href="Jacobi_rotation" title="wikilink">Jacobi rotation</a> has the same form as a Givens rotation, but is used to zero both off-diagonal entries of a  symmetric submatrix.</p>
<h2 id="properties">Properties</h2>
<h3 id="matrix-properties">Matrix properties</h3>
<p>A real square matrix is orthogonal <a href="if_and_only_if" title="wikilink">if and only if</a> its columns form an <a href="orthonormal_basis" title="wikilink">orthonormal basis</a> of the <a href="Euclidean_space" title="wikilink">Euclidean space</a> <strong>R</strong><sup><em>n</em></sup> with the ordinary Euclidean <a href="dot_product" title="wikilink">dot product</a>, which is the case if and only if its rows form an orthonormal basis of <strong>R</strong><sup><em>n</em></sup>. It might be tempting to suppose a matrix with orthogonal (not orthonormal) columns would be called an orthogonal matrix, but such matrices have no special interest and no special name; they only satisfy <mtpl></mtpl>, with <em>D</em> a <a href="diagonal_matrix" title="wikilink">diagonal matrix</a>.</p>
<p>The <a class="uri" href="determinant" title="wikilink">determinant</a> of any orthogonal matrix is +1 or −1. This follows from basic facts about determinants, as follows:</p>
<p><span class="LaTeX">$$1=\det(I)=\det(Q^\mathrm{T}Q)=\det(Q^\mathrm{T})\det(Q)=(\det(Q))^2 .$$</span></p>
<p>The converse is not true; having a determinant of +1 is no guarantee of orthogonality, even with orthogonal columns, as shown by the following counterexample.</p>
<p><span class="LaTeX">$$\begin{bmatrix}
2 & 0 \\
0 & \frac{1}{2}
\end{bmatrix}$$</span></p>
<p>With permutation matrices the determinant matches the <a href="even_and_odd_permutations" title="wikilink">signature</a>, being +1 or −1 as the parity of the permutation is even or odd, for the determinant is an alternating function of the rows.</p>
<p>Stronger than the determinant restriction is the fact that an orthogonal matrix can always be <a href="diagonalizable_matrix" title="wikilink">diagonalized</a> over the <a href="complex_number" title="wikilink">complex numbers</a> to exhibit a full set of <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvalues</a>, all of which must have (complex) <a href="absolute_value" title="wikilink">modulus</a> 1.</p>
<h3 id="group-properties">Group properties</h3>
<p>The inverse of every orthogonal matrix is again orthogonal, as is the matrix product of two orthogonal matrices. In fact, the set of all  orthogonal matrices satisfies all the axioms of a <a href="group_(mathematics)" title="wikilink">group</a>. It is a <a href="compact_space" title="wikilink">compact</a> <a href="Lie_group" title="wikilink">Lie group</a> of dimension , called the <a href="orthogonal_group" title="wikilink">orthogonal group</a> and denoted by O(<em>n</em>).</p>
<p>The orthogonal matrices whose determinant is +1 form a <a href="connected_space" title="wikilink">path-connected</a> <a href="normal_subgroup" title="wikilink">normal subgroup</a> of O(<em>n</em>) of <a href="index_of_a_subgroup" title="wikilink">index</a> 2, the <a href="special_orthogonal_group" title="wikilink">special orthogonal group</a> SO(<em>n</em>) of <a href="rotation" title="wikilink">rotations</a>. The <a href="quotient_group" title="wikilink">quotient group</a> O(<em>n</em>)/SO(<em>n</em>) is isomorphic to O(1), with the projection map choosing [+1] or [−1] according to the determinant. Orthogonal matrices with determinant −1 do not include the identity, and so do not form a subgroup but only a <a class="uri" href="coset" title="wikilink">coset</a>; it is also (separately) connected. Thus each orthogonal group falls into two pieces; and because the projection map <a href="exact_sequence" title="wikilink">splits</a>, O(<em>n</em>) is a <a href="semidirect_product" title="wikilink">semidirect product</a> of SO(<em>n</em>) by O(1). In practical terms, a comparable statement is that any orthogonal matrix can be produced by taking a rotation matrix and possibly negating one of its columns, as we saw with 2×2 matrices. If <em>n</em> is odd, then the semidirect product is in fact a <a href="direct_product_of_groups" title="wikilink">direct product</a>, and any orthogonal matrix can be produced by taking a rotation matrix and possibly negating all of its columns. This follows from the property of determinants that negating a column negates the determinant, and thus negating an odd (but not even) number of columns negates the determinant.</p>
<p>Now consider  orthogonal matrices with bottom right entry equal to 1. The remainder of the last column (and last row) must be zeros, and the product of any two such matrices has the same form. The rest of the matrix is an  orthogonal matrix; thus O(<em>n</em>) is a subgroup of  (and of all higher groups).</p>
<p><span class="LaTeX">$$\begin{bmatrix}
  &      & & 0\\
  & O(n) & & \vdots\\
  &      & & 0\\
0 & \cdots & 0 & 1
\end{bmatrix}$$</span></p>
<p>Since an elementary reflection in the form of a <a href="Householder_matrix" title="wikilink">Householder matrix</a> can reduce any orthogonal matrix to this constrained form, a series of such reflections can bring any orthogonal matrix to the identity; thus an orthogonal group is a <a href="reflection_group" title="wikilink">reflection group</a>. The last column can be fixed to any unit vector, and each choice gives a different copy of O(<em>n</em>) in ; in this way  is a <a href="fiber_bundle" title="wikilink">bundle</a> over the unit sphere <em>S</em><sup><em>n</em></sup> with fiber O(<em>n</em>).</p>
<p>Similarly, SO(<em>n</em>) is a subgroup of ; and any special orthogonal matrix can be generated by Givens plane rotations using an analogous procedure. The bundle structure persists: <mtpl></mtpl>. A single rotation can produce a zero in the first row of the last column, and series of <em>n</em>−1 rotations will zero all but the last row of the last column of an  rotation matrix. Since the planes are fixed, each rotation has only one degree of freedom, its angle. By induction, SO(<em>n</em>) therefore has</p>
<p><span class="LaTeX">$$(n-1) + (n-2) + \cdots + 1 = n(n-1)/2$$</span></p>
<p>degrees of freedom, and so does O(<em>n</em>).</p>
<p>Permutation matrices are simpler still; they form, not a Lie group, but only a finite group, the order <em>n</em>! <a href="symmetric_group" title="wikilink">symmetric group</a> S<sub><em>n</em></sub>. By the same kind of argument, S<sub><em>n</em></sub> is a subgroup of S<sub><em>n</em>+1</sub>. The even permutations produce the subgroup of permutation matrices of determinant +1, the order <em>n</em>!/2 <a href="alternating_group" title="wikilink">alternating group</a>.</p>
<h3 id="canonical-form">Canonical form</h3>
<p>More broadly, the effect of any orthogonal matrix separates into independent actions on orthogonal two-dimensional subspaces. That is, if <em>Q</em> is special orthogonal then one can always find an orthogonal matrix <em>P</em>, a (rotational) change of basis, that brings <em>Q</em> into block diagonal form:</p>
<p><span class="LaTeX">$$P^\mathrm{T}QP = \begin{bmatrix}
R_1 & & \\ & \ddots & \\ & & R_k
\end{bmatrix}\ (n\text{ even}),\ P^\mathrm{T}QP = \begin{bmatrix}
R_1 & & & \\ & \ddots & & \\ & & R_k & \\ & & & 1
\end{bmatrix}\ (n\text{ odd}).$$</span></p>
<p>where the matrices <em>R</em><sub>1</sub>, ..., <em>R</em><sub><em>k</em></sub> are  rotation matrices, and with the remaining entries zero. Exceptionally, a rotation block may be diagonal, ±<em>I</em>. Thus, negating one column if necessary, and noting that a  reflection diagonalizes to a +1 and −1, any orthogonal matrix can be brought to the form</p>
<p><span class="LaTeX">$$P^\mathrm{T}QP = \begin{bmatrix}
\begin{matrix}R_1 & & \\ & \ddots & \\ & & R_k\end{matrix} & 0 \\
0 & \begin{matrix}\pm 1 & & \\ & \ddots & \\ & & \pm 1\end{matrix} \\
\end{bmatrix},$$</span></p>
<p>The matrices <em>R</em><sub>1</sub>, ..., <em>R</em><sub><em>k</em></sub> give conjugate pairs of eigenvalues lying on the unit circle in the <a href="complex_number" title="wikilink">complex plane</a>; so this decomposition confirms that all <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvalues</a> have <a href="absolute_value" title="wikilink">absolute value</a> 1. If <em>n</em> is odd, there is at least one real eigenvalue, +1 or −1; for a  rotation, the eigenvector associated with +1 is the rotation axis.</p>
<h3 id="lie-algebra">Lie algebra</h3>
<p>Suppose the entries of <em>Q</em> are differentiable functions of <em>t</em>, and that  gives . Differentiating the orthogonality condition</p>
<p><span class="LaTeX">$$Q^\mathrm{T} Q = I$$</span></p>
<p>yields</p>
<p><span class="LaTeX">$$\dot{Q}^\mathrm{T} Q + Q^\mathrm{T} \dot{Q} = 0$$</span></p>
<p>Evaluation at  () then implies</p>
<p><span class="LaTeX">$$\dot{Q}^\mathrm{T} = -\dot{Q} .$$</span></p>
<p>In Lie group terms, this means that the <a href="Lie_algebra" title="wikilink">Lie algebra</a> of an orthogonal matrix group consists of <a href="skew-symmetric_matrix" title="wikilink">skew-symmetric matrices</a>. Going the other direction, the <a href="matrix_exponential" title="wikilink">matrix exponential</a> of any skew-symmetric matrix is an orthogonal matrix (in fact, special orthogonal).</p>
<p>For example, the three-dimensional object physics calls <a href="angular_velocity" title="wikilink">angular velocity</a> is a differential rotation, thus a vector in the Lie algebra <span class="LaTeX">$\mathfrak{so}(3)$</span> tangent to SO(3). Given , with  being a unit vector, the correct skew-symmetric matrix form of <strong>ω</strong> is</p>
<p><span class="LaTeX">$$\Omega = \begin{bmatrix}
0 & -z\theta & y\theta \\
z\theta & 0 & -x\theta \\
-y\theta & x\theta & 0
\end{bmatrix} .$$</span></p>
<p>The exponential of this is the orthogonal matrix for rotation around axis <strong>v</strong> by angle <em>θ</em>; setting , ,</p>
<p><span class="LaTeX">$$\exp(\Omega) = 
\begin{bmatrix}
1  -  2s^2  +  2x^2 s^2  &  2xy s^2  -  2z sc  &  2xz s^2  +  2y sc\\
2xy s^2  +  2z sc  &  1  -  2s^2  +  2y^2 s^2  &  2yz s^2  -  2x sc\\
2xz s^2  -  2y sc  &  2yz s^2  +  2x sc  &  1  -  2s^2  +  2z^2 s^2   
\end{bmatrix}
.$$</span></p>
<h2 id="numerical-linear-algebra">Numerical linear algebra</h2>
<h3 id="benefits">Benefits</h3>
<p><a href="Numerical_analysis" title="wikilink">Numerical analysis</a> takes advantage of many of the properties of orthogonal matrices for numerical <a href="linear_algebra" title="wikilink">linear algebra</a>, and they arise naturally. For example, it is often desirable to compute an orthonormal basis for a space, or an orthogonal change of bases; both take the form of orthogonal matrices. Having determinant ±1 and all eigenvalues of magnitude 1 is of great benefit for <a href="numeric_stability" title="wikilink">numeric stability</a>. One implication is that the <a href="condition_number" title="wikilink">condition number</a> is 1 (which is the minimum), so errors are not magnified when multiplying with an orthogonal matrix. Many algorithms use orthogonal matrices like <a href="Householder_reflection" title="wikilink">Householder reflections</a> and <a href="Givens_rotation" title="wikilink">Givens rotations</a> for this reason. It is also helpful that, not only is an orthogonal matrix invertible, but its inverse is available essentially free, by exchanging indices.</p>
<p>Permutations are essential to the success of many algorithms, including the workhorse <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a> with <a href="Pivot_element#Partial_and_complete_pivoting" title="wikilink">partial pivoting</a> (where permutations do the pivoting). However, they rarely appear explicitly as matrices; their special form allows more efficient representation, such as a list of <em>n</em> indices.</p>
<p>Likewise, algorithms using Householder and Givens matrices typically use specialized methods of multiplication and storage. For example, a Givens rotation affects only two rows of a matrix it multiplies, changing a full <a href="matrix_multiplication" title="wikilink">multiplication</a> of order <em>n</em><sup>3</sup> to a much more efficient order <em>n</em>. When uses of these reflections and rotations introduce zeros in a matrix, the space vacated is enough to store sufficient data to reproduce the transform, and to do so robustly. (Following , we do <em>not</em> store a rotation angle, which is both expensive and badly behaved.)</p>
<h3 id="decompositions">Decompositions</h3>
<p>A number of important <a href="matrix_decomposition" title="wikilink">matrix decompositions</a>  involve orthogonal matrices, including especially:</p>
<p>:;<a href="QR_decomposition" title="wikilink">QR decomposition</a>: , <em>Q</em> orthogonal, <em>R</em> upper triangular</p>
<p>:;<a href="Singular_value_decomposition" title="wikilink">Singular value decomposition</a>: <mtpl></mtpl>, <em>U</em> and <em>V</em> orthogonal, <em>Σ</em> non-negative diagonal</p>
<p>:;<a href="Eigendecomposition_of_a_matrix" title="wikilink">Eigendecomposition of a symmetric matrix</a> (decomposition according to the <a href="spectral_theorem" title="wikilink">spectral theorem</a>): <mtpl></mtpl>, <em>S</em> symmetric, <em>Q</em> orthogonal, <em>Λ</em> diagonal</p>
<p>:;<a href="Polar_decomposition" title="wikilink">Polar decomposition</a>: , <em>Q</em> orthogonal, <em>S</em> symmetric non-negative definite</p>
<h4 id="examples-1">Examples</h4>
<p>Consider an <a href="overdetermined_system_of_linear_equations" title="wikilink">overdetermined system of linear equations</a>, as might occur with repeated measurements of a physical phenomenon to compensate for experimental errors. Write , where <em>A</em> is , . A QR decomposition reduces <em>A</em> to upper triangular <em>R</em>. For example, if <em>A</em> is  then <em>R</em> has the form</p>
<p><span class="LaTeX">$$R = \begin{bmatrix}
\star & \star & \star \\
0 & \star & \star \\
0 & 0 & \star \\
0 & 0 & 0 \\
0 & 0 & 0
\end{bmatrix}.$$</span></p>
<p>The <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> problem is to find the <strong>x</strong> that minimizes , which is equivalent to projecting <strong>b</strong> to the subspace spanned by the columns of <em>A</em>. Assuming the columns of <em>A</em> (and hence <em>R</em>) are independent, the projection solution is found from <mtpl></mtpl>. Now <em>A</em><sup>T</sup><em>A</em> is square () and invertible, and also equal to <em>R</em><sup>T</sup><em>R</em>. But the lower rows of zeros in <em>R</em> are superfluous in the product, which is thus already in lower-triangular upper-triangular factored form, as in <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a> (<a href="Cholesky_decomposition" title="wikilink">Cholesky decomposition</a>). Here orthogonality is important not only for reducing <mtpl></mtpl> to <em>R</em><sup>T</sup><em>R</em>, but also for allowing solution without magnifying numerical problems.</p>
<p>In the case of a linear system which is underdetermined, or an otherwise non-<a href="invertible_matrix" title="wikilink">invertible matrix</a>, singular value decomposition (SVD) is equally useful. With <em>A</em> factored as <em>UΣV</em><sup>T</sup>, a satisfactory solution uses the Moore-Penrose <a class="uri" href="pseudoinverse" title="wikilink">pseudoinverse</a>, <em>VΣ</em><sup>+</sup><em>U</em><sup>T</sup>, where <em>Σ</em><sup>+</sup> merely replaces each non-zero diagonal entry with its reciprocal. Set <strong>x</strong> to <em>VΣ</em><sup>+</sup><em>U</em><sup>T</sup><strong>b</strong>.</p>
<p>The case of a square invertible matrix also holds interest. Suppose, for example, that <em>A</em> is a  rotation matrix which has been computed as the composition of numerous twists and turns. Floating point does not match the mathematical ideal of real numbers, so <em>A</em> has gradually lost its true orthogonality. A <a href="Gram-Schmidt_process" title="wikilink">Gram-Schmidt process</a> could <a href="orthogonalization" title="wikilink">orthogonalize</a> the columns, but it is not the most reliable, nor the most efficient, nor the most invariant method. The <a href="polar_decomposition" title="wikilink">polar decomposition</a> factors a matrix into a pair, one of which is the unique <em>closest</em> orthogonal matrix to the given matrix, or one of the closest if the given matrix is singular. (Closeness can be measured by any <a href="matrix_norm" title="wikilink">matrix norm</a> invariant under an orthogonal change of basis, such as the spectral norm or the Frobenius norm.) For a near-orthogonal matrix, rapid convergence to the orthogonal factor can be achieved by a "<a href="Newton's_method" title="wikilink">Newton's method</a>" approach due to  (<a href="#CITEREFHigham1990" title="wikilink">1990</a>), repeatedly averaging the matrix with its inverse transpose.  has published an accelerated method with a convenient convergence test.</p>
<p>For example, consider a non-orthogonal matrix for which the simple averaging algorithm takes seven steps</p>
<p><span class="LaTeX">$$\begin{bmatrix}3 & 1\\7 & 5\end{bmatrix}
\rightarrow
\begin{bmatrix}1.8125 & 0.0625\\3.4375 & 2.6875\end{bmatrix}
\rightarrow \cdots \rightarrow
\begin{bmatrix}0.8 & -0.6\\0.6 & 0.8\end{bmatrix}$$</span></p>
<p>and which acceleration trims to two steps (with γ = 0.353553, 0.565685).</p>
<p><span class="LaTeX">$$\begin{bmatrix}3 & 1\\7 & 5\end{bmatrix}
\rightarrow
\begin{bmatrix}1.41421 & -1.06066\\1.06066 & 1.41421\end{bmatrix}
\rightarrow
\begin{bmatrix}0.8 & -0.6\\0.6 & 0.8\end{bmatrix}$$</span></p>
<p>Gram-Schmidt yields an inferior solution, shown by a Frobenius distance of 8.28659 instead of the minimum 8.12404.</p>
<p><span class="LaTeX">$$\begin{bmatrix}3 & 1\\7 & 5\end{bmatrix}
\rightarrow
\begin{bmatrix}0.393919 & -0.919145\\0.919145 & 0.393919\end{bmatrix}$$</span></p>
<h3 id="randomization">Randomization</h3>
<p>Some numerical applications, such as <a href="Monte_Carlo_method" title="wikilink">Monte Carlo methods</a> and exploration of high-dimensional data spaces, require generation of <a href="uniform_distribution_(continuous)" title="wikilink">uniformly distributed</a> random orthogonal matrices. In this context, "uniform" is defined in terms of <a href="Haar_measure" title="wikilink">Haar measure</a>, which essentially requires that the distribution not change if multiplied by any freely chosen orthogonal matrix. Orthogonalizing matrices with <a href="statistical_independence" title="wikilink">independent</a> uniformly distributed random entries does not result in uniformly distributed orthogonal matrices, but the <a href="QR_decomposition" title="wikilink">QR decomposition</a> of independent <a href="normal_distribution" title="wikilink">normally distributed</a> random entries does, as long as the diagonal of <em>R</em> contains only positive entries.  replaced this with a more efficient idea that  later generalized as the "subgroup algorithm" (in which form it works just as well for permutations and rotations). To generate an  orthogonal matrix, take an  one and a uniformly distributed unit vector of dimension . Construct a Householder reflection from the vector, then apply it to the smaller matrix (embedded in the larger size with a 1 at the bottom right corner).</p>
<h3 id="nearest-orthogonal-matrix">Nearest orthogonal matrix</h3>
<p>The problem of finding the orthogonal matrix <span class="LaTeX">$Q$</span> nearest a given matrix <span class="LaTeX">$M$</span> is related to the <a href="Orthogonal_Procrustes_problem" title="wikilink">Orthogonal Procrustes problem</a>. There are several different ways to get the unique solution, the simplest of which is taking the <a href="singular_value_decomposition" title="wikilink">singular value decomposition</a> of <span class="LaTeX">$M$</span> and replacing the singular values with ones. Another method expresses the <span class="LaTeX">$R$</span> explicitly but requires the use of a <a href="matrix_square_root" title="wikilink">matrix square root</a>:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<p><span class="LaTeX">$$Q = M (M^\mathrm{T} M)^{-\frac 1 2}$$</span></p>
<p>This may be combined with the Babylonian method for extracting the square root of a matrix to give a recurrence which converges to an orthogonal matrix quadratically:</p>
<p><span class="LaTeX">$$Q_{n + 1} = 2 M (Q_n^{-1} M + M^\mathrm{T} Q_n)^{-1}$$</span></p>
<p>where <span class="LaTeX">$Q_0 = M$</span>. These iterations are stable provided the <a href="condition_number" title="wikilink">condition number</a> of <span class="LaTeX">$M$</span> is less than three.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="spin-and-pin">Spin and pin</h2>
<p>A subtle technical problem afflicts some uses of orthogonal matrices. Not only are the group components with determinant +1 and −1 not <a href="Connected_space" title="wikilink">connected</a> to each other, even the +1 component, SO(<em>n</em>), is not <a href="simply_connected_space" title="wikilink">simply connected</a> (except for SO(1), which is trivial). Thus it is sometimes advantageous, or even necessary, to work with a <a href="covering_map" title="wikilink">covering group</a> of SO(<em>n</em>), the <a href="spinor_group" title="wikilink">spin group</a>, Spin(<em>n</em>). Likewise, O(<em>n</em>) has covering groups, the <a href="pin_group" title="wikilink">pin groups</a>, Pin(<em>n</em>). For , Spin(<em>n</em>) is simply connected and thus the universal covering group for SO(<em>n</em>). By far the most famous example of a spin group is Spin(3), which is nothing but SU(2), or the group of unit <a href="quaternion" title="wikilink">quaternions</a>.</p>
<p>The Pin and Spin groups are found within <a href="Clifford_algebra" title="wikilink">Clifford algebras</a>, which themselves can be built from orthogonal matrices.</p>
<h2 id="rectangular-matrices">Rectangular matrices</h2>
<p>If <em>Q</em> is not a square matrix, then the conditions <mtpl></mtpl> and <mtpl></mtpl> are not equivalent. The condition <mtpl></mtpl> says that the columns of <em>Q</em> are orthonormal. This can only happen if <em>Q</em> is an  matrix with . Similarly, <mtpl></mtpl> says that the rows of <em>Q</em> are orthonormal, which requires .</p>
<p>There is no standard terminology for these matrices. They are sometimes called "orthonormal matrices", sometimes "orthogonal matrices", and sometimes simply "matrices with orthonormal rows/columns".</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Orthogonal_group" title="wikilink">Orthogonal group</a></li>
<li><a href="Rotation_(mathematics)" title="wikilink">Rotation (mathematics)</a></li>
<li><a href="Skew-symmetric_matrix" title="wikilink">Skew-symmetric matrix</a>, a matrix whose transpose is its negative</li>
<li><a href="Symplectic_matrix" title="wikilink">Symplectic matrix</a></li>
<li><a href="Unitary_matrix" title="wikilink">Unitary matrix</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li>
<p><a href="http://www.ma.man.ac.uk/~higham/pap-mf.html">1</a></p></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://people.revoledu.com/kardi/tutorial/LinearAlgebra/MatrixOrthogonal.html">Tutorial and Interactive Program on Orthogonal Matrix</a></li>
</ul>
<p>"</p>
<p><a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://tutorial.math.lamar.edu/Classes/LinAlg/OrthogonalMatrix.aspx">"Paul's online math notes"</a>, Paul Dawkins, <a href="Lamar_University" title="wikilink">Lamar University</a>, 2008. Theorem 3(c)<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://people.csail.mit.edu/bkph/articles/Nearest_Orthonormal_Matrix.pdf">"Finding the Nearest Orthonormal Matrix"</a>, Berthold K. P. Horn, <a class="uri" href="MIT" title="wikilink">MIT</a>.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="http://www.maths.manchester.ac.uk/~nareports/narep91.pdf">"Newton's Method for the Matrix Square Root"</a>, Nicholas J. Higham, Mathematics of Computation, Volume 46, Number 174, 1986.<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

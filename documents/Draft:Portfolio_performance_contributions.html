<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1357">Draft:Portfolio performance contributions</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Draft:Portfolio performance contributions</h1>
<hr/>

<p><strong>Portfolio performance contributions</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> form a summable set of measures which explains and breaks down the different sources of a portfolio global performance in presence of external flows. Portfolio external flows are movements of value in or out of the portfolio such as transfers of cash, securities or other instruments, with no equal simultaneous movement of value in the opposite direction, and which are not income (such as interest, coupons or dividends) or outcome (such as fees) from the investments in the portfolio. The sum of the performance contribution of all the portfolio components (such as securities performance, currencies performance, fees or other portfolio internal sources of performance) equals the total portfolio performance (i.e. portfolio performance contributions are additive).</p>
<h2 id="formula">Formula</h2>

<p>The portfolio performance contributions computation algorithm, developed by <a href="R._Barbanneau" title="wikilink">R. Barbanneau</a>, is as follows:</p>
<h3 id="introduction">Introduction</h3>
<h4 id="inputs">Inputs</h4>

<p>Let,</p>
<ul>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:0">
 <semantics>
  <msub>
   <mi mathvariant="normal">Π</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Π</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pi_{t}
  </annotation>
 </semantics>
</math>

 the portfolio total net asset value at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:1">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:2">
 <semantics>
  <msub>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\Epsilon</mtext>
   </merror>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>\Epsilon</mtext>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Epsilon_{t}
  </annotation>
 </semantics>
</math>

 the portfolio net external cash flow at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:3">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Draft:Portfolio_performance_contributions:4">
 <semantics>
  <mrow>
   <msub>
    <merror class="ltx_ERROR undefined undefined">
     <mtext>\Epsilon</mtext>
    </merror>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <mtext>\Epsilon</mtext>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Epsilon_{0}=0
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:5">
 <semantics>
  <msub>
   <mi>m</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{k,t}
  </annotation>
 </semantics>
</math>

 the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:6">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 movement quantity (i.e. traded quantity) at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:7">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Draft:Portfolio_performance_contributions:8">
 <semantics>
  <msub>
   <mi>m</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <list>
     <ci>k</ci>
     <cn type="integer">0</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{k,0}
  </annotation>
 </semantics>
</math>

 the quantity held at the beginning of the period, at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:9">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=0
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:10">
 <semantics>
  <msub>
   <mi>p</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k,t}
  </annotation>
 </semantics>
</math>

 the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:11">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 price at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:12">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:13">
 <semantics>
  <msub>
   <mi>d</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{k,t}
  </annotation>
 </semantics>
</math>

 the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:14">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 dividend payment at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:15">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Draft:Portfolio_performance_contributions:16">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <list>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </list>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{k,0}=0
  </annotation>
 </semantics>
</math>

,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:17">
 <semantics>
  <msub>
   <mi>f</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k,t}
  </annotation>
 </semantics>
</math>

 the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:18">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 currency exchange rate (against the portfolio <em>base</em> currency) at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:19">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

.</li>
</ul>
<h4 id="traded-quantity-adjusted-currency-exchange-rate">Traded quantity adjusted currency exchange rate</h4>

<p>The performance contributions inherited from the currency contribution of portfolio components are evaluated by computing the weighted average traded quantity currency exchange rate for each portfolio component at each time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:20">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 (other valuation methodologies can be used for computation, such as <a href="FIFO_and_LIFO_accounting" title="wikilink">FIFO and LIFO accounting</a>). Let 

<math display="inline" id="Draft:Portfolio_performance_contributions:21">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k,t}
  </annotation>
 </semantics>
</math>

 the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:22">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 weighted average traded quantity currency exchange rate (against the portfolio <em>base</em> currency) at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:23">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:24">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mrow>
      <msub>
       <mi>α</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
      <mo>⋅</mo>
      <mstyle displaystyle="true">
       <mfrac>
        <mn>1</mn>
        <msub>
         <mi>f</mi>
         <mrow>
          <mi>k</mi>
          <mo>,</mo>
          <mi>t</mi>
         </mrow>
        </msub>
       </mfrac>
      </mstyle>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msub>
         <mi>α</mi>
         <mrow>
          <mi>k</mi>
          <mo>,</mo>
          <mi>t</mi>
         </mrow>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>⋅</mo>
      <mstyle displaystyle="true">
       <mfrac>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>0</mn>
          </mrow>
          <mrow>
           <mi>t</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </munderover>
         <mstyle displaystyle="true">
          <mfrac>
           <msub>
            <mi>m</mi>
            <mrow>
             <mi>k</mi>
             <mo>,</mo>
             <mi>i</mi>
            </mrow>
           </msub>
           <msub>
            <mi>ϕ</mi>
            <mrow>
             <mi>k</mi>
             <mo>,</mo>
             <mi>i</mi>
            </mrow>
           </msub>
          </mfrac>
         </mstyle>
        </mrow>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>0</mn>
          </mrow>
          <mrow>
           <mi>t</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </munderover>
         <msub>
          <mi>m</mi>
          <mrow>
           <mi>k</mi>
           <mo>,</mo>
           <mi>i</mi>
          </mrow>
         </msub>
        </mrow>
       </mfrac>
      </mstyle>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <list>
      <ci>k</ci>
      <ci>t</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">continued-fraction</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <list>
         <ci>k</ci>
         <ci>t</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="latexml">continued-fraction</csymbol>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <list>
          <ci>k</ci>
          <ci>t</ci>
         </list>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <list>
          <ci>k</ci>
          <ci>t</ci>
         </list>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">continued-fraction</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <ci>t</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">continued-fraction</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <list>
            <ci>k</ci>
            <ci>i</ci>
           </list>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ϕ</ci>
           <list>
            <ci>k</ci>
            <ci>i</ci>
           </list>
          </apply>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <ci>t</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <list>
           <ci>k</ci>
           <ci>i</ci>
          </list>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k,t}=\cfrac{1}{\alpha_{k,t}\cdot\cfrac{1}{f_{k,t}}+(1-\alpha_{k,t})\cdot%
\cfrac{\sum\limits_{i=0}^{t-1}\cfrac{m_{k,i}}{\phi_{k,i}}}{\sum\limits_{i=0}^{%
t-1}m_{k,i}}}
  </annotation>
 </semantics>
</math>

</p>

<p>With,</p>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:25">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>f</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <list>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <list>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k,0}=f_{k,0}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:26">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>t</mi>
     </mrow>
    </msub>
    <mtext>if</mtext>
    <msub>
     <mi>m</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>t</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mtext>or</mtext>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </munderover>
     <msub>
      <mi>m</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <list>
       <ci>k</ci>
       <ci>t</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <list>
        <ci>k</ci>
        <ci>t</ci>
       </list>
      </apply>
      <mtext>if</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <list>
        <ci>k</ci>
        <ci>t</ci>
       </list>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">0</cn>
      <mtext>or</mtext>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <list>
         <ci>k</ci>
         <ci>i</ci>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{k,t}=f_{k,t}\text{ if }m_{k,t}=0\text{ or }\sum\limits_{i=0}^{t-1}m_{k,i%
}=0
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Draft:Portfolio_performance_contributions:27">
 <semantics>
  <msub>
   <mi>α</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{k,t}
  </annotation>
 </semantics>
</math>

 is the proportion of the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:28">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 traded quantity at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:29">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 impacting the weighted average traded quantity currency exchange rate of component 

<math display="inline" id="Draft:Portfolio_performance_contributions:30">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:31">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>max</mi>
    <mrow>
     <mo>{</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mrow>
      <mi>min</mi>
      <mrow>
       <mo>{</mo>
       <mn>1</mn>
       <mo>,</mo>
       <mfrac>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>0</mn>
          </mrow>
          <mi>t</mi>
         </munderover>
         <msub>
          <mi>m</mi>
          <mrow>
           <mi>k</mi>
           <mo>,</mo>
           <mi>i</mi>
          </mrow>
         </msub>
        </mrow>
        <msub>
         <mi>m</mi>
         <mrow>
          <mi>k</mi>
          <mo>,</mo>
          <mi>t</mi>
         </mrow>
        </msub>
       </mfrac>
       <mo>}</mo>
      </mrow>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <list>
      <ci>k</ci>
      <ci>t</ci>
     </list>
    </apply>
    <apply>
     <max></max>
     <cn type="integer">0</cn>
     <apply>
      <min></min>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="latexml">continued-fraction</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <list>
          <ci>k</ci>
          <ci>i</ci>
         </list>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <list>
         <ci>k</ci>
         <ci>t</ci>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{k,t}=\max\left\{0,\min\left\{1,\cfrac{\sum\limits_{i=0}^{t}m_{k,i}}{m_%
{k,t}}\right\}\right\}
  </annotation>
 </semantics>
</math>

</p>
<h4 id="adjustement-factor">Adjustement factor</h4>

<p>Each external cash flow has an impact on the performance contributions computation, both at the portfolio level and the portfolio components level. External inflows dilute the performance whereas external outflows concentrate the performance.</p>
<ul>
<li>Let 

<math display="inline" id="Draft:Portfolio_performance_contributions:32">
 <semantics>
  <msub>
   <mi mathvariant="normal">Λ</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Λ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Lambda_{t}
  </annotation>
 </semantics>
</math>

 the portfolio adjustement factor (i.e. the performance dilution or concentration measurement at the portfolio level) at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:33">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

,</li>
</ul>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:34">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Λ</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>t</mi>
    </munderover>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <msub>
         <merror class="ltx_ERROR undefined undefined">
          <mtext>\Epsilon</mtext>
         </merror>
         <mi>i</mi>
        </msub>
        <msub>
         <mi mathvariant="normal">Π</mi>
         <mi>i</mi>
        </msub>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mtext>with</mtext>
     <msub>
      <mi mathvariant="normal">Λ</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Λ</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="latexml">continued-fraction</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <mtext>\Epsilon</mtext>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Π</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <mtext>with</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Λ</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Lambda_{t}=\prod_{i=1}^{t}\left(1-\cfrac{\Epsilon_{i}}{\Pi_{i}}\right)\text{ %
with }\Lambda_{0}=1
  </annotation>
 </semantics>
</math>

</p>
<ul>
<li>Let 

<math display="inline" id="Draft:Portfolio_performance_contributions:35">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{k,t}
  </annotation>
 </semantics>
</math>

 the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:36">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 adjustement factor (i.e. the performance dilution or concentration measurement at the portfolio component 

<math display="inline" id="Draft:Portfolio_performance_contributions:37">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 level) at time step 

<math display="inline" id="Draft:Portfolio_performance_contributions:38">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

,</li>
</ul>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:39">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>t</mi>
    </munderover>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <msub>
         <merror class="ltx_ERROR undefined undefined">
          <mtext>\Epsilon</mtext>
         </merror>
         <mi>i</mi>
        </msub>
        <mrow>
         <msub>
          <mi mathvariant="normal">Π</mi>
          <mi>i</mi>
         </msub>
         <mo>+</mo>
         <munder>
          <munder accentunder="true">
           <mrow>
            <munderover>
             <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
             <mrow>
              <mi>j</mi>
              <mo movablelimits="false">=</mo>
              <mn>1</mn>
             </mrow>
             <mi>i</mi>
            </munderover>
            <mrow>
             <msub>
              <mi>m</mi>
              <mrow>
               <mi>k</mi>
               <mo movablelimits="false">,</mo>
               <mi>j</mi>
              </mrow>
             </msub>
             <mrow>
              <mo movablelimits="false">(</mo>
              <mrow>
               <msub>
                <mi>p</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mi>i</mi>
                </mrow>
               </msub>
               <mo movablelimits="false">-</mo>
               <msub>
                <mi>p</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mi>j</mi>
                </mrow>
               </msub>
              </mrow>
              <mo movablelimits="false">)</mo>
             </mrow>
             <mrow>
              <mo movablelimits="false">(</mo>
              <mrow>
               <mstyle displaystyle="true">
                <mfrac>
                 <mn>1</mn>
                 <msub>
                  <mi>ϕ</mi>
                  <mrow>
                   <mi>k</mi>
                   <mo movablelimits="false">,</mo>
                   <mi>j</mi>
                  </mrow>
                 </msub>
                </mfrac>
               </mstyle>
               <mo movablelimits="false">-</mo>
               <mstyle displaystyle="true">
                <mfrac>
                 <mn>1</mn>
                 <msub>
                  <mi>f</mi>
                  <mrow>
                   <mi>k</mi>
                   <mo movablelimits="false">,</mo>
                   <mi>i</mi>
                  </mrow>
                 </msub>
                </mfrac>
               </mstyle>
              </mrow>
              <mo movablelimits="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
           <mo movablelimits="false">⏟</mo>
          </munder>
          <mtext>price adjustement factor</mtext>
         </munder>
         <mo>+</mo>
         <munder>
          <munder accentunder="true">
           <mrow>
            <munderover>
             <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
             <mrow>
              <mi>j</mi>
              <mo movablelimits="false">=</mo>
              <mn>1</mn>
             </mrow>
             <mi>i</mi>
            </munderover>
            <mrow>
             <munderover>
              <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
              <mrow>
               <mi>l</mi>
               <mo movablelimits="false">=</mo>
               <mn>0</mn>
              </mrow>
              <mrow>
               <mi>j</mi>
               <mo movablelimits="false">-</mo>
               <mn>1</mn>
              </mrow>
             </munderover>
             <mrow>
              <msub>
               <mi>m</mi>
               <mrow>
                <mi>k</mi>
                <mo movablelimits="false">,</mo>
                <mi>l</mi>
               </mrow>
              </msub>
              <msub>
               <mi>d</mi>
               <mrow>
                <mi>k</mi>
                <mo movablelimits="false">,</mo>
                <mi>j</mi>
               </mrow>
              </msub>
              <mrow>
               <mo movablelimits="false">(</mo>
               <mrow>
                <mstyle displaystyle="true">
                 <mfrac>
                  <mn>1</mn>
                  <msub>
                   <mi>ϕ</mi>
                   <mrow>
                    <mi>k</mi>
                    <mo movablelimits="false">,</mo>
                    <mi>l</mi>
                   </mrow>
                  </msub>
                 </mfrac>
                </mstyle>
                <mo movablelimits="false">-</mo>
                <mstyle displaystyle="true">
                 <mfrac>
                  <mn>1</mn>
                  <msub>
                   <mi>f</mi>
                   <mrow>
                    <mi>k</mi>
                    <mo movablelimits="false">,</mo>
                    <mi>i</mi>
                   </mrow>
                  </msub>
                 </mfrac>
                </mstyle>
               </mrow>
               <mo movablelimits="false">)</mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo movablelimits="false">⏟</mo>
          </munder>
          <mtext>dividend adjustement factor</mtext>
         </munder>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mtext>with</mtext>
     <msub>
      <mi>λ</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mn>0</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <list>
       <ci>k</ci>
       <ci>t</ci>
      </list>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="latexml">continued-fraction</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <mtext>\Epsilon</mtext>
          <ci>i</ci>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>normal-Π</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-⏟</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <sum></sum>
               <apply>
                <eq></eq>
                <ci>j</ci>
                <cn type="integer">1</cn>
               </apply>
              </apply>
              <ci>i</ci>
             </apply>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>m</ci>
               <list>
                <ci>k</ci>
                <ci>j</ci>
               </list>
              </apply>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>p</ci>
                <list>
                 <ci>k</ci>
                 <ci>i</ci>
                </list>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>p</ci>
                <list>
                 <ci>k</ci>
                 <ci>j</ci>
                </list>
               </apply>
              </apply>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="latexml">continued-fraction</csymbol>
                <cn type="integer">1</cn>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>ϕ</ci>
                 <list>
                  <ci>k</ci>
                  <ci>j</ci>
                 </list>
                </apply>
               </apply>
               <apply>
                <csymbol cd="latexml">continued-fraction</csymbol>
                <cn type="integer">1</cn>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>f</ci>
                 <list>
                  <ci>k</ci>
                  <ci>i</ci>
                 </list>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <mtext>price adjustement factor</mtext>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-⏟</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <sum></sum>
               <apply>
                <eq></eq>
                <ci>j</ci>
                <cn type="integer">1</cn>
               </apply>
              </apply>
              <ci>i</ci>
             </apply>
             <apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <sum></sum>
                <apply>
                 <eq></eq>
                 <ci>l</ci>
                 <cn type="integer">0</cn>
                </apply>
               </apply>
               <apply>
                <minus></minus>
                <ci>j</ci>
                <cn type="integer">1</cn>
               </apply>
              </apply>
              <apply>
               <times></times>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>m</ci>
                <list>
                 <ci>k</ci>
                 <ci>l</ci>
                </list>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>d</ci>
                <list>
                 <ci>k</ci>
                 <ci>j</ci>
                </list>
               </apply>
               <apply>
                <minus></minus>
                <apply>
                 <csymbol cd="latexml">continued-fraction</csymbol>
                 <cn type="integer">1</cn>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>ϕ</ci>
                  <list>
                   <ci>k</ci>
                   <ci>l</ci>
                  </list>
                 </apply>
                </apply>
                <apply>
                 <csymbol cd="latexml">continued-fraction</csymbol>
                 <cn type="integer">1</cn>
                 <apply>
                  <csymbol cd="ambiguous">subscript</csymbol>
                  <ci>f</ci>
                  <list>
                   <ci>k</ci>
                   <ci>i</ci>
                  </list>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <mtext>dividend adjustement factor</mtext>
          </apply>
         </apply>
        </apply>
       </apply>
       <mtext>with</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <list>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{k,t}=\prod_{i=1}^{t}\left(1-\cfrac{\Epsilon_{i}}{\Pi_{i}+\underbrace{%
\sum\limits_{j=1}^{i}m_{k,j}\left(p_{k,i}-p_{k,j}\right)\left(\cfrac{1}{\phi_{%
k,j}}-\cfrac{1}{f_{k,i}}\right)}_{\text{price adjustement factor}}+\underbrace%
{\sum\limits_{j=1}^{i}\sum\limits_{l=0}^{j-1}m_{k,l}d_{k,j}\left(\cfrac{1}{%
\phi_{k,l}}-\cfrac{1}{f_{k,i}}\right)}_{\text{dividend adjustement factor}}}%
\right)\text{ with }\lambda_{k,0}=1
  </annotation>
 </semantics>
</math>

</p>
<h3 id="global-portfolio-performance">Global portfolio performance</h3>

<p>Let,</p>
<ul>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:40">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}
  </annotation>
 </semantics>
</math>

 the global portfolio performance,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:41">
 <semantics>
  <msub>
   <mi>r</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <list>
     <ci>k</ci>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{k,t}
  </annotation>
 </semantics>
</math>

 the performance contribution of the 

<math display="inline" id="Draft:Portfolio_performance_contributions:42">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-th portfolio component for 

<math display="inline" id="Draft:Portfolio_performance_contributions:43">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>k</ci>
    <interval closure="closed">
     <cn type="integer">1</cn>
     <ci>n</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\in[1,n]
  </annotation>
 </semantics>
</math>

,</li>
</ul>

<p>Each component is decomposed into two sources of performance contribution,</p>
<ul>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:44">
 <semantics>
  <msubsup>
   <mi>r</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
   <mtext>base</mtext>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <list>
      <ci>k</ci>
      <ci>t</ci>
     </list>
    </apply>
    <mtext>base</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{k,t}^{\text{base}}
  </annotation>
 </semantics>
</math>

 the performance contribution of the 

<math display="inline" id="Draft:Portfolio_performance_contributions:45">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-th portfolio component hedged continuously against the currency variations,</li>
<li>

<math display="inline" id="Draft:Portfolio_performance_contributions:46">
 <semantics>
  <msubsup>
   <mi>r</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
   <mtext>crcy</mtext>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <list>
      <ci>k</ci>
      <ci>t</ci>
     </list>
    </apply>
    <mtext>crcy</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{k,t}^{\text{crcy}}
  </annotation>
 </semantics>
</math>

 the performance contribution of the currency variations of the 

<math display="inline" id="Draft:Portfolio_performance_contributions:47">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-th portfolio component,</li>
</ul>

<p>Hence,</p>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:48">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <munder>
     <munder accentunder="true">
      <mrow>
       <mo movablelimits="false">(</mo>
       <mrow>
        <msubsup>
         <mi>r</mi>
         <mrow>
          <mi>k</mi>
          <mo movablelimits="false">,</mo>
          <mi>t</mi>
         </mrow>
         <mtext>base</mtext>
        </msubsup>
        <mo movablelimits="false">+</mo>
        <msubsup>
         <mi>r</mi>
         <mrow>
          <mi>k</mi>
          <mo movablelimits="false">,</mo>
          <mi>t</mi>
         </mrow>
         <mtext>crcy</mtext>
        </msubsup>
       </mrow>
       <mo movablelimits="false">)</mo>
      </mrow>
      <mo movablelimits="false">⏟</mo>
     </munder>
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <msub>
       <mi>r</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
     </mrow>
    </munder>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-⏟</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <list>
           <ci>k</ci>
           <ci>t</ci>
          </list>
         </apply>
         <mtext>base</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <list>
           <ci>k</ci>
           <ci>t</ci>
          </list>
         </apply>
         <mtext>crcy</mtext>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <list>
         <ci>k</ci>
         <ci>t</ci>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}=\sum\limits_{k=1}^{n}\underbrace{\left(r_{k,t}^{\text{base}}+r_{k,t}^{%
\text{crcy}}\right)}_{=r_{k,t}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="performance-contribution-of-portfolio-components">Performance contribution of portfolio components</h3>

<p>For every 

<math display="inline" id="Draft:Portfolio_performance_contributions:49">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi>n</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>k</ci>
    <interval closure="closed">
     <cn type="integer">1</cn>
     <ci>n</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\in[1,n]
  </annotation>
 </semantics>
</math>

, the performance contribution of the 

<math display="inline" id="Draft:Portfolio_performance_contributions:50">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-th portfolio component is computed as follows,</p>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:51">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msub>
      <mi mathvariant="normal">Π</mi>
      <mn>0</mn>
     </msub>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>t</mi>
     </munderover>
     <mrow>
      <msub>
       <mi mathvariant="normal">Λ</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <munder accentunder="true">
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
            <mrow>
             <mi>j</mi>
             <mo movablelimits="false">=</mo>
             <mn>0</mn>
            </mrow>
            <mrow>
             <mi>i</mi>
             <mo movablelimits="false">-</mo>
             <mn>1</mn>
            </mrow>
           </munderover>
           <mrow>
            <msub>
             <mi>m</mi>
             <mrow>
              <mi>k</mi>
              <mo movablelimits="false">,</mo>
              <mi>j</mi>
             </mrow>
            </msub>
            <mrow>
             <mo movablelimits="false">(</mo>
             <mrow>
              <mfrac>
               <mrow>
                <msub>
                 <mi>p</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>i</mi>
                 </mrow>
                </msub>
                <mo movablelimits="false">-</mo>
                <msub>
                 <mi>p</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>j</mi>
                 </mrow>
                </msub>
               </mrow>
               <msub>
                <mi>f</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mi>i</mi>
                </mrow>
               </msub>
              </mfrac>
              <mo movablelimits="false">-</mo>
              <mfrac>
               <mrow>
                <msub>
                 <mi>p</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mrow>
                   <mi>i</mi>
                   <mo movablelimits="false">-</mo>
                   <mn>1</mn>
                  </mrow>
                 </mrow>
                </msub>
                <mo movablelimits="false">-</mo>
                <msub>
                 <mi>p</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>j</mi>
                 </mrow>
                </msub>
               </mrow>
               <msub>
                <mi>f</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mrow>
                  <mi>i</mi>
                  <mo movablelimits="false">-</mo>
                  <mn>1</mn>
                 </mrow>
                </mrow>
               </msub>
              </mfrac>
             </mrow>
             <mo movablelimits="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo movablelimits="false">⏟</mo>
         </munder>
         <mtext>price</mtext>
        </munder>
        <mo>+</mo>
        <munder>
         <munder accentunder="true">
          <mrow>
           <munder>
            <munder accentunder="true">
             <mrow>
              <munderover>
               <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
               <mrow>
                <mi>j</mi>
                <mo movablelimits="false">=</mo>
                <mn>1</mn>
               </mrow>
               <mrow>
                <mi>i</mi>
                <mo movablelimits="false">-</mo>
                <mn>1</mn>
               </mrow>
              </munderover>
              <mrow>
               <munderover>
                <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                <mrow>
                 <mi>l</mi>
                 <mo movablelimits="false">=</mo>
                 <mn>0</mn>
                </mrow>
                <mrow>
                 <mi>j</mi>
                 <mo movablelimits="false">-</mo>
                 <mn>1</mn>
                </mrow>
               </munderover>
               <mrow>
                <msub>
                 <mi>m</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>l</mi>
                 </mrow>
                </msub>
                <msub>
                 <mi>d</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>j</mi>
                 </mrow>
                </msub>
                <mrow>
                 <mo movablelimits="false">(</mo>
                 <mrow>
                  <mfrac>
                   <mn>1</mn>
                   <msub>
                    <mi>f</mi>
                    <mrow>
                     <mi>k</mi>
                     <mo movablelimits="false">,</mo>
                     <mi>i</mi>
                    </mrow>
                   </msub>
                  </mfrac>
                  <mo movablelimits="false">-</mo>
                  <mfrac>
                   <mn>1</mn>
                   <msub>
                    <mi>f</mi>
                    <mrow>
                     <mi>k</mi>
                     <mo movablelimits="false">,</mo>
                     <mrow>
                      <mi>i</mi>
                      <mo movablelimits="false">-</mo>
                      <mn>1</mn>
                     </mrow>
                    </mrow>
                   </msub>
                  </mfrac>
                 </mrow>
                 <mo movablelimits="false">)</mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
             <mo movablelimits="false">⏟</mo>
            </munder>
            <mtext>paid</mtext>
           </munder>
           <mo movablelimits="false">+</mo>
           <munder>
            <munder accentunder="true">
             <mrow>
              <munderover>
               <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
               <mrow>
                <mi>j</mi>
                <mo movablelimits="false">=</mo>
                <mn>0</mn>
               </mrow>
               <mrow>
                <mi>i</mi>
                <mo movablelimits="false">-</mo>
                <mn>1</mn>
               </mrow>
              </munderover>
              <mrow>
               <msub>
                <mi>m</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mi>j</mi>
                </mrow>
               </msub>
               <mfrac>
                <msub>
                 <mi>d</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>i</mi>
                 </mrow>
                </msub>
                <msub>
                 <mi>f</mi>
                 <mrow>
                  <mi>k</mi>
                  <mo movablelimits="false">,</mo>
                  <mi>i</mi>
                 </mrow>
                </msub>
               </mfrac>
              </mrow>
             </mrow>
             <mo movablelimits="false">⏟</mo>
            </munder>
            <mtext>to be paid</mtext>
           </munder>
          </mrow>
          <mo movablelimits="false">⏟</mo>
         </munder>
         <mtext>dividend</mtext>
        </munder>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <list>
      <ci>k</ci>
      <ci>t</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">continued-fraction</csymbol>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Π</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Λ</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-⏟</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>j</ci>
              <cn type="integer">0</cn>
             </apply>
            </apply>
            <apply>
             <minus></minus>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>m</ci>
             <list>
              <ci>k</ci>
              <ci>j</ci>
             </list>
            </apply>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="latexml">continued-fraction</csymbol>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>p</ci>
                <list>
                 <ci>k</ci>
                 <ci>i</ci>
                </list>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>p</ci>
                <list>
                 <ci>k</ci>
                 <ci>j</ci>
                </list>
               </apply>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>f</ci>
               <list>
                <ci>k</ci>
                <ci>i</ci>
               </list>
              </apply>
             </apply>
             <apply>
              <csymbol cd="latexml">continued-fraction</csymbol>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>p</ci>
                <list>
                 <ci>k</ci>
                 <apply>
                  <minus></minus>
                  <ci>i</ci>
                  <cn type="integer">1</cn>
                 </apply>
                </list>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>p</ci>
                <list>
                 <ci>k</ci>
                 <ci>j</ci>
                </list>
               </apply>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>f</ci>
               <list>
                <ci>k</ci>
                <apply>
                 <minus></minus>
                 <ci>i</ci>
                 <cn type="integer">1</cn>
                </apply>
               </list>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
         <mtext>price</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-⏟</ci>
          <apply>
           <plus></plus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-⏟</ci>
             <apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <sum></sum>
                <apply>
                 <eq></eq>
                 <ci>j</ci>
                 <cn type="integer">1</cn>
                </apply>
               </apply>
               <apply>
                <minus></minus>
                <ci>i</ci>
                <cn type="integer">1</cn>
               </apply>
              </apply>
              <apply>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <sum></sum>
                 <apply>
                  <eq></eq>
                  <ci>l</ci>
                  <cn type="integer">0</cn>
                 </apply>
                </apply>
                <apply>
                 <minus></minus>
                 <ci>j</ci>
                 <cn type="integer">1</cn>
                </apply>
               </apply>
               <apply>
                <times></times>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>m</ci>
                 <list>
                  <ci>k</ci>
                  <ci>l</ci>
                 </list>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>d</ci>
                 <list>
                  <ci>k</ci>
                  <ci>j</ci>
                 </list>
                </apply>
                <apply>
                 <minus></minus>
                 <apply>
                  <csymbol cd="latexml">continued-fraction</csymbol>
                  <cn type="integer">1</cn>
                  <apply>
                   <csymbol cd="ambiguous">subscript</csymbol>
                   <ci>f</ci>
                   <list>
                    <ci>k</ci>
                    <ci>i</ci>
                   </list>
                  </apply>
                 </apply>
                 <apply>
                  <csymbol cd="latexml">continued-fraction</csymbol>
                  <cn type="integer">1</cn>
                  <apply>
                   <csymbol cd="ambiguous">subscript</csymbol>
                   <ci>f</ci>
                   <list>
                    <ci>k</ci>
                    <apply>
                     <minus></minus>
                     <ci>i</ci>
                     <cn type="integer">1</cn>
                    </apply>
                   </list>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
            <mtext>paid</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-⏟</ci>
             <apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <sum></sum>
                <apply>
                 <eq></eq>
                 <ci>j</ci>
                 <cn type="integer">0</cn>
                </apply>
               </apply>
               <apply>
                <minus></minus>
                <ci>i</ci>
                <cn type="integer">1</cn>
               </apply>
              </apply>
              <apply>
               <times></times>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>m</ci>
                <list>
                 <ci>k</ci>
                 <ci>j</ci>
                </list>
               </apply>
               <apply>
                <csymbol cd="latexml">continued-fraction</csymbol>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>d</ci>
                 <list>
                  <ci>k</ci>
                  <ci>i</ci>
                 </list>
                </apply>
                <apply>
                 <csymbol cd="ambiguous">subscript</csymbol>
                 <ci>f</ci>
                 <list>
                  <ci>k</ci>
                  <ci>i</ci>
                 </list>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
            <mtext>to be paid</mtext>
           </apply>
          </apply>
         </apply>
         <mtext>dividend</mtext>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{k,t}=\cfrac{1}{\Pi_{0}}\sum\limits_{i=1}^{t}\Lambda_{i-1}\left(\underbrace{%
\sum\limits_{j=0}^{i-1}m_{k,j}\left(\cfrac{p_{k,i}-p_{k,j}}{f_{k,i}}-\cfrac{p_%
{k,i-1}-p_{k,j}}{f_{k,i-1}}\right)}_{\text{price}}+\underbrace{\underbrace{%
\sum\limits_{j=1}^{i-1}\sum\limits_{l=0}^{j-1}m_{k,l}d_{k,j}\left(\cfrac{1}{f_%
{k,i}}-\cfrac{1}{f_{k,i-1}}\right)}_{\text{paid}}+\underbrace{\sum\limits_{j=0%
}^{i-1}m_{k,j}\cfrac{d_{k,i}}{f_{k,i}}}_{\text{to be paid}}}_{\text{dividend}}\right)
  </annotation>
 </semantics>
</math>

</p>
<h4 id="base-contribution">Base contribution</h4>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:52">
 <semantics>
  <mrow>
   <msubsup>
    <mi>r</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
    <mtext>base</mtext>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <msub>
      <mi mathvariant="normal">Π</mi>
      <mn>0</mn>
     </msub>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>t</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>λ</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <munder accentunder="true">
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
            <mrow>
             <mi>j</mi>
             <mo movablelimits="false">=</mo>
             <mn>0</mn>
            </mrow>
            <mrow>
             <mi>i</mi>
             <mo movablelimits="false">-</mo>
             <mn>1</mn>
            </mrow>
           </munderover>
           <mrow>
            <msub>
             <mi>m</mi>
             <mrow>
              <mi>k</mi>
              <mo movablelimits="false">,</mo>
              <mi>j</mi>
             </mrow>
            </msub>
            <mfrac>
             <mrow>
              <mo movablelimits="false">(</mo>
              <mrow>
               <msub>
                <mi>p</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mi>i</mi>
                </mrow>
               </msub>
               <mo movablelimits="false">-</mo>
               <msub>
                <mi>p</mi>
                <mrow>
                 <mi>k</mi>
                 <mo movablelimits="false">,</mo>
                 <mrow>
                  <mi>i</mi>
                  <mo movablelimits="false">-</mo>
                  <mn>1</mn>
                 </mrow>
                </mrow>
               </msub>
              </mrow>
              <mo movablelimits="false">)</mo>
             </mrow>
             <msub>
              <mi>ϕ</mi>
              <mrow>
               <mi>k</mi>
               <mo movablelimits="false">,</mo>
               <mi>j</mi>
              </mrow>
             </msub>
            </mfrac>
           </mrow>
          </mrow>
          <mo movablelimits="false">⏟</mo>
         </munder>
         <mtext>price</mtext>
        </munder>
        <mo>+</mo>
        <munder>
         <munder accentunder="true">
          <mrow>
           <munderover>
            <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
            <mrow>
             <mi>j</mi>
             <mo movablelimits="false">=</mo>
             <mn>0</mn>
            </mrow>
            <mrow>
             <mi>i</mi>
             <mo movablelimits="false">-</mo>
             <mn>1</mn>
            </mrow>
           </munderover>
           <mrow>
            <msub>
             <mi>m</mi>
             <mrow>
              <mi>k</mi>
              <mo movablelimits="false">,</mo>
              <mi>j</mi>
             </mrow>
            </msub>
            <mfrac>
             <msub>
              <mi>d</mi>
              <mrow>
               <mi>k</mi>
               <mo movablelimits="false">,</mo>
               <mi>i</mi>
              </mrow>
             </msub>
             <msub>
              <mi>ϕ</mi>
              <mrow>
               <mi>k</mi>
               <mo movablelimits="false">,</mo>
               <mi>j</mi>
              </mrow>
             </msub>
            </mfrac>
           </mrow>
          </mrow>
          <mo movablelimits="false">⏟</mo>
         </munder>
         <mtext>dividend</mtext>
        </munder>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <list>
       <ci>k</ci>
       <ci>t</ci>
      </list>
     </apply>
     <mtext>base</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">continued-fraction</csymbol>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Π</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>λ</ci>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </list>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-⏟</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>j</ci>
              <cn type="integer">0</cn>
             </apply>
            </apply>
            <apply>
             <minus></minus>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>m</ci>
             <list>
              <ci>k</ci>
              <ci>j</ci>
             </list>
            </apply>
            <apply>
             <csymbol cd="latexml">continued-fraction</csymbol>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>p</ci>
               <list>
                <ci>k</ci>
                <ci>i</ci>
               </list>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>p</ci>
               <list>
                <ci>k</ci>
                <apply>
                 <minus></minus>
                 <ci>i</ci>
                 <cn type="integer">1</cn>
                </apply>
               </list>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>ϕ</ci>
              <list>
               <ci>k</ci>
               <ci>j</ci>
              </list>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
         <mtext>price</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-⏟</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>j</ci>
              <cn type="integer">0</cn>
             </apply>
            </apply>
            <apply>
             <minus></minus>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>m</ci>
             <list>
              <ci>k</ci>
              <ci>j</ci>
             </list>
            </apply>
            <apply>
             <csymbol cd="latexml">continued-fraction</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>d</ci>
              <list>
               <ci>k</ci>
               <ci>i</ci>
              </list>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>ϕ</ci>
              <list>
               <ci>k</ci>
               <ci>j</ci>
              </list>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
         <mtext>dividend</mtext>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{k,t}^{\text{base}}=\cfrac{1}{\Pi_{0}}\sum\limits_{i=1}^{t}\lambda_{k,i-1}%
\left(\underbrace{\sum\limits_{j=0}^{i-1}m_{k,j}\cfrac{\left(p_{k,i}-p_{k,i-1}%
\right)}{\phi_{k,j}}}_{\text{price}}+\underbrace{\sum\limits_{j=0}^{i-1}m_{k,j%
}\cfrac{d_{k,i}}{\phi_{k,j}}}_{\text{dividend}}\right)
  </annotation>
 </semantics>
</math>

</p>
<h4 id="currency-contribution">Currency contribution</h4>

<p>

<math display="block" id="Draft:Portfolio_performance_contributions:53">
 <semantics>
  <mrow>
   <msubsup>
    <mi>r</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
    <mtext>crcy</mtext>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>r</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>-</mo>
    <msubsup>
     <mi>r</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>t</mi>
     </mrow>
     <mtext>base</mtext>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <list>
       <ci>k</ci>
       <ci>t</ci>
      </list>
     </apply>
     <mtext>crcy</mtext>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <list>
       <ci>k</ci>
       <ci>t</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <list>
        <ci>k</ci>
        <ci>t</ci>
       </list>
      </apply>
      <mtext>base</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{k,t}^{\text{crcy}}=r_{k,t}-r_{k,t}^{\text{base}}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="interpretation">Interpretation</h2>

<p>The portfolio performance contributions algorithm evaluates over a period of time the different sources of performance of a portfolio. By decomposing the contribution of each portfolio component into a base and a currency part, the algorithm allows the computation of contributions to the performance of currencies over a portfolio. Furthermore, the performance contribution of specific portfolio components computation, such as compensatory fees, can be derived from the method by weighting each amount at each time step by the portfolio adjustement factor.</p>
<h2 id="algorithm">Algorithm</h2>
<h3 id="vba">VBA</h3>
<pre><code>Public Function PortfolioPerformanceContributions( _
    t As Integer, _
    n As Integer, _
    TNAV() As Double, _
    E() As Double, _
    m() As Double, _
    p() As Double, _
    d() As Double, _
    f() As Double) As Double()
    
    ' Function inputs
    ' ================================================================
    ' t : time steps 0 to t
    ' n : portfolio components 1 to n
    ' TNAV(i) : portfolio total net asset at time step i as [0, t]
    ' E(i) : portfolio net external cash flow at time step i as [0, t]
    ' m(k,i) : portfolio component k movement quantity at time step i as [1, n]x[0, t]
    ' p(k,i) : portfolio component k price at time step i as [1, n]x[0, t]
    ' d(k,i) : portfolio component k dividend at time step i as [1, n]x[0, t]
    ' f(k,i) : portfolio component k currency exchange rate at time step i as [1, n]x[0, t]
    
    ' Function outputs
    ' ================================================================
    ' r(k,part) : portfolio component k performance contributions
    '             with 0 = component
    '                  1 = base component part
    '                  2 = currency component part
    Dim r() As Double: ReDim r(1 To n, 0 To 2)
    
    ' Variables
    ' ================================================================
    Dim i As Integer, j As Integer, k As Integer, l As Integer
    Dim var1 As Double, var2 As Double, var3 As Double
    
    Dim phi() As Double: ReDim phi(1 To n, 0 To t)
    
    Dim lambda_ptf() As Double: ReDim lambda_ptf(0 To t)
    Dim lambda() As Double: ReDim lambda(1 To n, 0 To t)
    
    ' Computation
    ' ================================================================
    ' Portfolio lambda adjustement factor
    lambda_ptf(0) = 1
    For i = 1 To t
        lambda_ptf(i) = lambda_ptf(i - 1) * (1 - E(i) / TNAV(i))
    Next i
    
    ' Components weighted average movements currency exchange rate
    For k = 1 To n
        phi(k, 0) = f(k, 0)
        For i = 1 To t
            If m(k, i) = 0 Then
                phi(k, i) = f(k, i)
            Else
                var1 = 0
                For j = 0 To i - 1
                    var1 = var1 + m(k, j)
                Next j
                If var1 = 0 Then
                    phi(k, i) = f(k, i)
                Else
                    With Application.WorksheetFunction
                        var2 = .Max(0, .Min(1, (var1 + m(k, i)) / m(k, i)))
                    End With
                    var3 = 0
                    For j = 0 To i - 1
                        var3 = var3 + m(k, j) / phi(k, j)
                    Next j
                    phi(k, i) = 1 / (var2 / f(k, i) + (1 - var2) * var3 / var1)
                End If
            End If
        Next i
    Next k
    
    ' Components lambda adjustement factor
    For k = 1 To n
        lambda(k, 0) = 1
        For i = 1 To t
            var1 = 0
            For j = 0 To i
                var1 = var1 + m(k, j) * (p(k, i) - p(k, j)) * (1 / phi(k, j) - 1 / f(k, i))
            Next j
            var2 = 0
            For j = 1 To i
                For l = 0 To j - 1
                    var2 = var2 + d(k, j) * m(k, l) * (1 / phi(k, l) - 1 / f(k, i))
                Next l
            Next j
            lambda(k, i) = lambda(k, i - 1) * (1 - E(i) / (TNAV(i) + var1 + var2))
        Next i
    Next k
    
    ' Performance contributions
    For k = 1 To n
        ' Component performance contributions
        r(k, 0) = 0
        For i = 1 To t
            var1 = 0
            For j = 0 To i - 1
                var1 = var1 + m(k, j) * ((p(k, i) - p(k, j)) / f(k, i) - (p(k, i - 1) - p(k, j)) / f(k, i - 1))
            Next j
            var2 = 0
            For j = 0 To i - 1
                var2 = var2 + m(k, j) * d(k, i) / f(k, i)
            Next j
            var3 = 0
            For j = 1 To i - 1
                For l = 0 To j - 1
                    var3 = var3 + d(k, j) * m(k, l) * (1 / f(k, i) - 1 / f(k, i - 1))
                Next l
            Next j
            r(k, 0) = r(k, 0) + lambda_ptf(i - 1) * (var1 + var2 + var3)
        Next i
        r(k, 0) = r(k, 0) / TNAV(0)
        
        ' Base component part performance contributions
        r(k, 1) = 0
        For i = 1 To t
            var1 = 0
            For j = 0 To i - 1
                var1 = var1 + m(k, j) * (p(k, i) - p(k, i - 1)) / phi(k, j)
            Next j
            var2 = 0
            For j = 0 To i - 1
                var2 = var2 + m(k, j) * d(k, i) / phi(k, j)
            Next j
            r(k, 1) = r(k, 1) + lambda(k, i - 1) * (var1 + var2)
        Next i
        r(k, 1) = r(k, 1) / TNAV(0)
        
        ' Currency component part performance contributions
        r(k, 2) = r(k, 0) - r(k, 1)
    Next k

    PortfolioPerformanceContributions = r
End Function</code></pre>

<p>The above VBA algorithm is designed to be used with Excel.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Time-weighted_return" title="wikilink">Time-weighted return</a></li>
<li><a href="Modified_Dietz_method" title="wikilink">Modified Dietz method</a></li>
<li><a href="Simple_Dietz_method" title="wikilink">Simple Dietz method</a></li>
<li><a href="Performance_attribution" title="wikilink">Performance attribution</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li>"
</li>
</ul>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2611971">Barbanneau, Rodolphe. <em>Portfolio Performance Contributions Computation Algorithm</em>, 2014</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

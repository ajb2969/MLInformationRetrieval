   Onsager–Machlup function      Onsager–Machlup function   The Onsager–Machlup function is a function that summarizes the dynamics of a continuous stochastic process . It is used to define a probability density for a stochastic process, and it is similar to the Lagrangian of a dynamical system . It is named after Lars Onsager and S. Machlup who were the first to consider such probability densities. 1  The dynamics of a continuous stochastic process   X   X   X   from time    t  =  0      t  0    t=0   to    t  =  T      t  T    t=T   in one dimension, satisfying a stochastic differential equation       d   X  t    =    b   (   X  t   )   d  t   +   σ   (   X  t   )   d   W  t           d   subscript  X  t        b   subscript  X  t   d  t     σ   subscript  X  t   d   subscript  W  t       dX_{t}=b(X_{t})\,dt+\sigma(X_{t})\,dW_{t}     where   W   W   W   is a Wiener process , can in approximation be described by the probability density function of its value at a finite number of points in time :       p   (   x  1   ,  …  ,   x  n   )    =    (    ∏   i  =  1    n  -  1     1    2  π  σ    (   x  i   )   2   Δ   t  i       )    exp   (   -    ∑   i  =  1    n  -  1     L   (   x  i   ,     x   i  +  1    -   x  i     Δ   t  i     )   Δ   t  i      )           p    subscript  x  1   normal-…   subscript  x  n         subscript   superscript  product    n  1      i  1      1      2  π  σ   superscript   subscript  x  i   2   normal-Δ   subscript  t  i             subscript   superscript     n  1      i  1      L    subscript  x  i        subscript  x    i  1     subscript  x  i      normal-Δ   subscript  t  i      normal-Δ   subscript  t  i          p(x_{1},\ldots,x_{n})=\left(\prod^{n-1}_{i=1}\frac{1}{\sqrt{2\pi\sigma(x_{i})^%
 {2}\Delta t_{i}}}\right)\exp\left(-\sum^{n-1}_{i=1}L\left(x_{i},\frac{x_{i+1}-%
 x_{i}}{\Delta t_{i}}\right)\,\Delta t_{i}\right)     where       L   (  x  ,  v  )    =    1  2     (    v  -   b   (  x  )     σ   )   2          L   x  v        1  2    superscript      v    b  x    σ   2      L(x,v)=\frac{1}{2}\left(\frac{v-b(x)}{\sigma}\right)^{2}     and  t i +1 − t i > 0}} , 0}} and  T }} . A similar approximation is possible for processes in higher dimensions. The approximation is more accurate for smaller time step sizes , but in the limit the probability density function becomes ill defined, one reason being that the product of terms      1    2  π  σ    (   x  i   )   2   Δ   t  i         1      2  π  σ   superscript   subscript  x  i   2   normal-Δ   subscript  t  i       \frac{1}{\sqrt{2\pi\sigma(x_{i})^{2}\Delta t_{i}}}     diverges to infinity . In order to nevertheless define a density for the continuous stochastic process   X   X   X   , ratios of probabilities of   X   X   X   lying within a small distance   ε   ε   ε   from smooth curves and are considered: 2        P   (  |   X  t   -   φ  1    (  t  )   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   )     P   (  |   X  t   -   φ  2    (  t  )   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   )     →   exp   (    -    ∫  0  T    L   (    φ  1    (  t  )    ,     φ  ˙   1    (  t  )    )   d  t     +    ∫  0  T    L   (    φ  2    (  t  )    ,     φ  ˙   2    (  t  )    )   d  t     )       normal-→     fragments  P   fragments  normal-(  normal-|   subscript  X  t     subscript  φ  1    fragments  normal-(  t  normal-)   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)     fragments  P   fragments  normal-(  normal-|   subscript  X  t     subscript  φ  2    fragments  normal-(  t  normal-)   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)             subscript   superscript   T   0     L      subscript  φ  1   t      subscript   normal-˙  φ   1   t    d  t       subscript   superscript   T   0     L      subscript  φ  2   t      subscript   normal-˙  φ   2   t    d  t        \frac{P\left(\left|X_{t}-\varphi_{1}(t)\right|\leq\varepsilon\text{ for every %
 }t\in[0,T]\right)}{P\left(\left|X_{t}-\varphi_{2}(t)\right|\leq\varepsilon%
 \text{ for every }t\in[0,T]\right)}\to\exp\left(-\int^{T}_{0}L\left(\varphi_{1%
 }(t),\dot{\varphi}_{1}(t)\right)\,dt+\int^{T}_{0}L\left(\varphi_{2}(t),\dot{%
 \varphi}_{2}(t)\right)\,dt\right)     as    ε  →  0      ε  normal-→  0    ε→0   , where   L   L   L   is the Onsager–Machlup function .  Definition  Consider a   d   d   d   -dimensional Riemannian manifold    M   M   M   and a diffusion process on   M   M   M   with infinitesimal generator  , where is the Laplace–Beltrami operator and   b   b   b   is a vector field . For any two smooth curves ,        lim   ε  ↓  0      P   (  ρ   (   X  t   ,   φ  1    (  t  )   )   ≤  ε  for every  t  ∈   [  0  ,  T  ]   )     P   (  ρ   (   X  t   ,   φ  2    (  t  )   )   ≤  ε  for every  t  ∈   [  0  ,  T  ]   )      =   exp   (    -    ∫  0  T    L   (    φ  1    (  t  )    ,     φ  ˙   1    (  t  )    )   d  t     +    ∫  0  T    L   (    φ  2    (  t  )    ,     φ  ˙   2    (  t  )    )   d  t     )          subscript    normal-↓  ε  0       fragments  P   fragments  normal-(  ρ   fragments  normal-(   subscript  X  t   normal-,   subscript  φ  1    fragments  normal-(  t  normal-)   normal-)    ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)     fragments  P   fragments  normal-(  ρ   fragments  normal-(   subscript  X  t   normal-,   subscript  φ  2    fragments  normal-(  t  normal-)   normal-)    ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)              subscript   superscript   T   0     L      subscript  φ  1   t      subscript   normal-˙  φ   1   t    d  t       subscript   superscript   T   0     L      subscript  φ  2   t      subscript   normal-˙  φ   2   t    d  t        \lim_{\varepsilon\downarrow 0}\frac{P\left(\rho(X_{t},\varphi_{1}(t))\leq%
 \varepsilon\text{ for every }t\in[0,T]\right)}{P\left(\rho(X_{t},\varphi_{2}(t%
 ))\leq\varepsilon\text{ for every }t\in[0,T]\right)}=\exp\left(-\int^{T}_{0}L%
 \left(\varphi_{1}(t),\dot{\varphi}_{1}(t)\right)\,dt+\int^{T}_{0}L\left(%
 \varphi_{2}(t),\dot{\varphi}_{2}(t)\right)\,dt\right)     where   ρ   ρ   ρ   is the Riemannian distance ,      φ  ˙   1   ,    φ  ˙   2       subscript   normal-˙  φ   1    subscript   normal-˙  φ   2     \scriptstyle\dot{\varphi}_{1},\dot{\varphi}_{2}   denote the first derivatives of , and   L   L   L   is called the Onsager–Machlup function .  The Onsager–Machlup function is given by 3 4 5        L   (  x  ,  v  )    =       1  2      ∥   v  -   b   (  x  )     ∥   x  2    +     1  2     div  b    (  x  )     -     1  12    R   (  x  )      ,        L   x  v            1  2    superscript   subscript   norm    v    b  x     x   2        1  2    div  b   x        1  12   R  x      L(x,v)=\tfrac{1}{2}\|v-b(x)\|_{x}^{2}+\tfrac{1}{2}\operatorname{div}\,b(x)-%
 \tfrac{1}{12}R(x),     where ⋅ {{!!}} x }} is the Riemannian norm in the tangent space  at   x   x   x   ,    d  i  v  b   (  x  )       d  i  v  b  x    divb(x)   is the divergence of   b   b   b   at   x   x   x   , and    R   (  x  )       R  x    R(x)   is the scalar curvature at   x   x   x   .  Examples  The following examples give explicit expressions for the Onsager–Machlup function of a continuous stochastic processes.  Wiener process on the real line  The Onsager–Machlup function of a Wiener process on the real line    𝐑   𝐑   \mathbf{R}   is given by 6        L   (  x  ,  v  )    =     1  2      |  v  |   2     .        L   x  v        1  2    superscript    v   2      L(x,v)=\tfrac{1}{2}|v|^{2}.       [Proof]    Let  be a Wiener process on   𝐑   𝐑   \mathbf{R}   and let    φ  :   0  ,   T  →  𝐑       normal-:  φ   0    T  normal-→  𝐑      φ:0,T→\mathbf{R}   be a twice differentiable curve such that  X 0 }} . Define another process  by  X t − φ ( t )}} and a measure  by        P  φ   =    exp   (     ∫  0  T     φ  ˙    (  t  )   d   X  t  φ     +    ∫  0  T      1  2       |    φ  ˙    (  t  )    |   2    d  t     )    d  P    .       superscript  P  φ           subscript   superscript   T   0      normal-˙  φ   t  d   subscript   superscript  X  φ   t       subscript   superscript   T   0       1  2    superscript       normal-˙  φ   t    2   d  t      d  P     P^{\varphi}=\exp\left(\int^{T}_{0}\dot{\varphi}(t)\,dX^{\varphi}_{t}+\int^{T}_%
 {0}\tfrac{1}{2}\left|\dot{\varphi}(t)\right|^{2}\,dt\right)\,dP.     For every    ε  >  0      ε  0    ε>0   , the probability that X t − φ ( t ){{!}} ≤ ε }} for every     t  ∈  0   ,  T       t  normal-∈  0   T    t∈0,T   satisfies      P   (  |   X  t   -  φ   (  t  )   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   )      fragments  P   fragments  normal-(  normal-|   subscript  X  t    φ   fragments  normal-(  t  normal-)   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)     \displaystyle P\left(\left|X_{t}-\varphi(t)\right|\leq\varepsilon\text{ for %
 every }t\in[0,T]\right)     By Girsanov's theorem , the distribution of under equals the distribution of   X   X   X   under   P   P   P   , hence the latter can be substituted by the former:      P   (  |   X  t   -  φ   (  t  )   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   )   =   ∫   {  |   X  t  φ   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   }    exp   (  -   ∫  0  T    φ  ˙    (  t  )   d   X  t   -   ∫  0  T     1  2    |   φ  ˙    (  t  )     |  2    d  t  )   d  P  .     fragments  P   fragments  normal-(  normal-|   subscript  X  t    φ   fragments  normal-(  t  normal-)   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)     subscript    fragments  normal-{  normal-|   subscript   superscript  X  φ   t   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-}      fragments  normal-(    subscript   superscript   T   0    normal-˙  φ    fragments  normal-(  t  normal-)   d   subscript  X  t     subscript   superscript   T   0     1  2   normal-|   normal-˙  φ    fragments  normal-(  t  normal-)    superscript  normal-|  2   d  t  normal-)   d  P  normal-.    P(|X_{t}-\varphi(t)|\leq\varepsilon\text{ for every }t\in[0,T])=\int_{\left\{%
 \left|X^{\varphi}_{t}\right|\leq\varepsilon\text{ for every }t\in[0,T]\right\}%
 }\exp\left(-\int^{T}_{0}\dot{\varphi}(t)\,dX_{t}-\int^{T}_{0}\tfrac{1}{2}|\dot%
 {\varphi}(t)|^{2}\,dt\right)\,dP.     By Itō's lemma it holds that         ∫  0  T     φ  ˙    (  t  )   d   X  t     =     φ  ˙    (  T  )    X  T    -    ∫  0  T     φ  ¨    (  t  )     X  t    d  t      ,        subscript   superscript   T   0      normal-˙  φ   t  d   subscript  X  t          normal-˙  φ   T   subscript  X  T      subscript   superscript   T   0      normal-¨  φ   t   subscript  X  t   d  t       \int^{T}_{0}\dot{\varphi}(t)\,dX_{t}=\dot{\varphi}(T)X_{T}-\int^{T}_{0}\ddot{%
 \varphi}(t)X_{t}\,dt,     where    φ  ¨     normal-¨  φ    \scriptstyle\ddot{\varphi}   is the second derivative of   φ   φ   φ   , and so this term is of order   ε   ε   ε   on the event where X t {{!}} ≤ ε}} for every     t  ∈  0   ,  T       t  normal-∈  0   T    t∈0,T   and will disappear in the limit    ε  →  0      ε  normal-→  0    ε→0   , hence         lim   ε  ↓  0      P   (  |   X  t   -  φ   (  t  )   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   )     P   (  |   X  t   |  ≤  ε  for every  t  ∈   [  0  ,  T  ]   )      =   exp   (   -    ∫  0  T      1  2       |    φ  ˙    (  t  )    |   2    d  t     )     .        subscript    normal-↓  ε  0       fragments  P   fragments  normal-(  normal-|   subscript  X  t    φ   fragments  normal-(  t  normal-)   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)     fragments  P   fragments  normal-(  normal-|   subscript  X  t   normal-|   ε  for every  t    fragments  normal-[  0  normal-,  T  normal-]   normal-)            subscript   superscript   T   0       1  2    superscript       normal-˙  φ   t    2   d  t        \lim_{\varepsilon\downarrow 0}\frac{P(|X_{t}-\varphi(t)|\leq\varepsilon\text{ %
 for every }t\in[0,T])}{P(|X_{t}|\leq\varepsilon\text{ for every }t\in[0,T])}=%
 \exp\left(-\int^{T}_{0}\tfrac{1}{2}|\dot{\varphi}(t)|^{2}\,dt\right).       Diffusion processes with constant diffusion coefficient on Euclidean space  The Onsager–Machlup function in the one-dimensional case with constant diffusion coefficient    σ   σ   σ   is given by 7        L   (  x  ,  v  )    =     1  2     |    v  -   b   (  x  )     σ   |   2    +    1  2     d  b    d  x     (  x  )      .        L   x  v          1  2    superscript        v    b  x    σ    2        1  2       d  b     d  x    x      L(x,v)=\frac{1}{2}\left|\frac{v-b(x)}{\sigma}\right|^{2}+\frac{1}{2}\frac{db}{%
 dx}(x).     In the   d   d   d   -dimensional case, with   σ   σ   σ   equal to the unit matrix, it is given by 8        L   (  x  ,  v  )    =     1  2     ∥   v  -   b   (  x  )     ∥   2    +    1  2    (   div  b   )    (  x  )      ,        L   x  v          1  2    superscript   norm    v    b  x     2        1  2    div  b   x      L(x,v)=\frac{1}{2}\|v-b(x)\|^{2}+\frac{1}{2}(\operatorname{div}\,b)(x),     where    !  !  ⋅  !  !     fragments    ⋅      {{!!}}⋅{{!!}}   is the Euclidean norm and         (   div  b   )    (  x  )    =    ∑   i  =  1   d     1  2    ∂   ∂   x  i      b  i    (  x  )      .         div  b   x     superscript   subscript     i  1    d       1  2         subscript  x  i      subscript  b  i   x      (\operatorname{div}\,b)(x)=\sum_{i=1}^{d}\frac{1}{2}\frac{\partial}{\partial x%
 _{i}}b_{i}(x).     Generalizations  Generalizations have been obtained by weakening the differentiability condition on the curve   φ   φ   φ   . 9 Rather than taking the maximum distance between the stochastic process and the curve over a time interval, other conditions have been considered such as distances based on completely convex norms 10 and Hölder, Besov and Sobolev type norms. 11  Applications  The Onsager–Machlup function can be used for purposes of reweighting and sampling trajectories, 12 as well as for determining the most probable trajectory of a diffusion process. 13 14  See also   Lagrangian  Functional integration   References  Bibliography                     External links   Onsager–Machlup function. Encyclopedia of Mathematics. URL: http://www.encyclopediaofmath.org/index.php?title=Onsager-Machlup_function&oldid; ;=22857   "  Category:Functional analysis  Category:Functions and mappings  Category:Stochastic processes     Onsager, L. and Machlup, S. (1953) ↩  Stratonovich, R. (1971) ↩  Takahashi, Y. and Watanabe, S. (1980) ↩  Fujita, T. and Kotani, S. (1982) ↩  Wittich, Olaf ↩  Ikeda, N. and Watanabe, S. (1980), Chapter VI, Section 9 ↩  Dürr, D. and Bach, A. (1978) ↩  Ikeda, N. and Watanabe, S. (1980), Chapter VI, Section 9 ↩  Zeitouni, O. (1989) ↩  Shepp, L. and Zeitouni, O. (1993) ↩  Capitaine, M. (1995) ↩  Adib, A.B. (2008). ↩  Adib, A.B. (2008). ↩  Dürr, D. and Bach, A. (1978). ↩     
   Heat kernel signature      Heat kernel signature   A heat kernel signature (HKS) is a feature descriptor for use in deformable shape analysis and belongs to the group of spectral shape analysis methods. For each point in the shape, HKS defines its feature vector representing the point's local and global geometric properties. Applications include segmentation, classification, structure discovery, shape matching and shape retrieval.  HKS was introduced in 2009 by Jian Sun, Maks Ovsjanikov and Leonidas Guibas . 1 It is based on heat kernel , which is a fundamental solution to the heat equation . HKS is one of the many recently introduced shape descriptors which are based on the Laplace–Beltrami operator associated with the shape. 2  Overview  Shape analysis is the field of automatic digital analysis of shapes, e.g., 3D objects. For many shape analysis tasks (such as shape matching/retrieval), feature vectors for certain key points are used instead of using the complete 3D model of the shape. An important requirement of such feature descriptors is for them to be invariant under certain transformations. For rigid transformations , commonly used feature descriptors include shape context , spin images, integral volume descriptors and multiscale local features, among others. 3 HKS allows isometric transformations which generalizes rigid transformations.  HKS is based on the concept of heat diffusion over a surface. Given an initial heat distribution     u  0    (  x  )        subscript  u  0   x    u_{0}(x)   over the surface, the heat kernel     h  t    (  x  ,  y  )        subscript  h  t    x  y     h_{t}(x,y)   relates the amount of heat transferred from   x   x   x   to   y   y   y   after time   t   t   t   . The heat kernel is invariant under isometric transformations and stable under small perturbations to the isometry. 4 In addition, the heat kernel fully characterizes shapes up to an isometry and represents increasingly global properties of the shape with increasing time. 5 Since     h  t    (  x  ,  y  )        subscript  h  t    x  y     h_{t}(x,y)   is defined for a pair of points over a temporal domain, using heat kernels directly as features would lead to a high complexity. HKS instead restricts itself to just the temporal domain by considering only     h  t    (  x  ,  x  )        subscript  h  t    x  x     h_{t}(x,x)   . HKS inherits most of the properties of heat kernels under certain conditions. 6  Technical details  The heat diffusion equation over a compact  Riemannian manifold    M   M   M   (possibly with a boundary) is given by,        (   Δ  +   ∂   ∂  t     )   u   (  x  ,  t  )    =  0          normal-Δ       t     u   x  t    0    \left(\Delta+\frac{\partial}{\partial t}\right)u(x,t)=0   where   Δ   normal-Δ   \Delta   is the Laplace–Beltrami operator and    u   (  x  ,  t  )       u   x  t     u(x,t)   is the heat distribution at a point   x   x   x   at time   t   t   t   . The solution to this equation can be expressed as, 7        u   (  x  ,  t  )    =   ∫    h  t    (  x  ,  y  )    u  0    (  y  )   d  y     .        u   x  t         subscript  h  t    x  y    subscript  u  0   y  d  y      u(x,t)=\int h_{t}(x,y)u_{0}(y)dy.   The eigen decomposition of the heat kernel is expressed as,        h  t    (  x  ,  y  )    =    ∑   i  =  0   ∞     exp   (   -    λ  i   t    )     ϕ  i    (  x  )    ϕ  i    (  y  )            subscript  h  t    x  y      superscript   subscript     i  0               subscript  λ  i   t      subscript  ϕ  i   x   subscript  ϕ  i   y      h_{t}(x,y)=\sum_{i=0}^{\infty}\exp(-\lambda_{i}t)\phi_{i}(x)\phi_{i}(y)   where    λ  i     subscript  λ  i    \lambda_{i}   and    ϕ  i     subscript  ϕ  i    \phi_{i}   are the    i   t  h      superscript  i    t  h     i^{th}   eigenvalue and eigenfunction of   Δ   normal-Δ   \Delta   . The heat kernel fully characterizes a surface up to an isometry: For any surjective map     T  :   M  →  N      normal-:  T   normal-→  M  N     T:M\rightarrow N   between two Riemannian manifolds   M   M   M   and   N   N   N   , if      h  t    (  x  ,  y  )    =    h  t    (   T   (  x  )    ,   T   (  y  )    )           subscript  h  t    x  y       subscript  h  t      T  x     T  y       h_{t}(x,y)=h_{t}(T(x),T(y))   then   T   T   T   is an isometry, and vice versa. 8 For a concise feature descriptor, HKS restricts the heat kernel only to the temporal domain,         h  t    (  x  ,  x  )    =    ∑   i  =  0   ∞     exp   (   -    λ  i   t    )     ϕ  i  2    (  x  )      .         subscript  h  t    x  x      superscript   subscript     i  0               subscript  λ  i   t      superscript   subscript  ϕ  i   2   x      h_{t}(x,x)=\sum_{i=0}^{\infty}\exp(-\lambda_{i}t)\phi_{i}^{2}(x).   HKS, similar to the heat kernel, characterizes surfaces under the condition that the eigenvalues of   Δ   normal-Δ   \Delta   for   M   M   M   and   N   N   N   are non-repeating. The terms    exp   (   -    λ  i   t    )            subscript  λ  i   t      \exp(-\lambda_{i}t)   can be intuited as a bank of low-pass filters, with    λ  i     subscript  λ  i    \lambda_{i}   determining the cutoff frequencies. 9  Practical considerations  Since     h  t    (  x  ,  x  )        subscript  h  t    x  x     h_{t}(x,x)   is, in general, a non-parametric continuous function, HKS is in practice represented as a discrete sequence of    {    h   t  1     (  x  ,  x  )    ,  …  ,    h   t  n     (  x  ,  x  )    }        subscript  h   subscript  t  1     x  x    normal-…     subscript  h   subscript  t  n     x  x      \{h_{t_{1}}(x,x),\ldots,h_{t_{n}}(x,x)\}   values sampled at times     t  1   ,  …  ,   t  n       subscript  t  1   normal-…   subscript  t  n     t_{1},\ldots,t_{n}   .  In most applications, the underlying manifold for an object is not known. The HKS can be computed if a mesh representation of the manifold is available, by using a discrete approximation to   Δ   normal-Δ   \Delta   and using the discrete analogue of the heat equation. In the discrete case, the Laplace–Beltrami operator is a sparse matrix and can be written as, 10      L  =    A   -  1    W       L     superscript  A    1    W     L=A^{-1}W   where   A   A   A   is a positive diagonal matrix with entries    A   (  i  ,  i  )       A   i  i     A(i,i)   corresponding to the area of the triangles in the mesh sharing the vertex   i   i   i   , and   W   W   W   is a symmetric semi-definite weighting matrix.   L   L   L   can be decomposed into    L  =   Φ  Λ   Φ  T   A       L    normal-Φ  normal-Λ   superscript  normal-Φ  T   A     L=\Phi\Lambda\Phi^{T}A   , where   Λ   normal-Λ   \Lambda   is a diagonal matrix of the eigenvalues of   L   L   L   arranged in the ascending order, and   Φ   normal-Φ   \Phi   is the matrix with the corresponding orthonormal eigenvectors. The discrete heat kernel is the matrix given by,        K  t   =   Φ   exp   (   -   t  Λ    )     Φ  T     .       subscript  K  t     normal-Φ        t  normal-Λ      superscript  normal-Φ  T      K_{t}=\Phi\exp(-t\Lambda)\Phi^{T}.   The elements     k  t    (  i  ,  j  )        subscript  k  t    i  j     k_{t}(i,j)   represents the heat diffusion between vertices   i   i   i   and   j   j   j   after time   t   t   t   . The HKS is then given by the diagonal entries of this matrix, sampled at discrete time intervals. Similar to the continuous case, the discrete HKS is robust to noise. 11  Limitations  Non-repeating eigenvalues  The main property that characterizes surfaces using HKS up to an isometry holds only when the eigenvalues of the surfaces are non-repeating. There are certain surfaces (especially those with symmetry) where this condition is violated. A sphere is a simple example of such a surface.  Time parameter selection  The time parameter in the HKS is closely related to the scale of global information. However, there is no direct way to choose the time discretization. The existing method chooses time samples logarithmically which is a heuristic with no guarantees 12  Time complexity  The discrete heat kernel requires eigendecomposition of a matrix of size    n  ×  n      n  n    n\times n   , where   n   n   n   is the number of vertices in the mesh representation of the manifold. Computing the eigendecomposition is an expensive operation, especially as   n   n   n   increases. Note, however, that because of the inverse exponential dependence on the eigenvalue, typically only a small (less than 100) eigenvectors are sufficient to obtain a good approximation of the HKS.  Non-isometric transformations  The performance guarantees for HKS only hold for truly isometric transformations. However, deformations for real shapes are often not isometric. A simple example of such transformation is closing of the fist by a person, where the geodesic distances between two fingers changes.  Relation with other methods 13  Curvature  The (continuous) HKS at a point   x   x   x   ,     h  t    (  x  ,  x  )        subscript  h  t    x  x     h_{t}(x,x)   on the Riemannian manifold is related to the scalar curvature     s   (  x  )       s  x    s(x)   by,         h  t    (  x  ,  x  )    =    1   4  π  t    +    s   (  x  )     12  π    +   O   (  t  )      .         subscript  h  t    x  x        1    4  π  t        s  x     12  π      O  t      h_{t}(x,x)=\frac{1}{4\pi t}+\frac{s(x)}{12\pi}+O(t).   Hence, HKS can as be interpreted as the curvature of   x   x   x   at scale   t   t   t   .  Wave kernel signature (WKS)  The WKS 14 follows a similar idea to the HKS, replacing the heat equation with the Schrödinger wave equation ,        (    i  Δ   +   ∂   ∂  t     )   ψ   (  x  ,  t  )    =  0            i  normal-Δ        t     ψ   x  t    0    \left(i\Delta+\frac{\partial}{\partial t}\right)\psi(x,t)=0   where    ψ   (  x  ,  t  )       ψ   x  t     \psi(x,t)   is the complex wave function. The average probability of measuring the particle at a point   x   x   x   is given by,       p   (  x  )    =    ∑   i  =  0   ∞     f  2    (   λ  i   )    ϕ  i  2    (  x  )           p  x     superscript   subscript     i  0         superscript  f  2    subscript  λ  i    superscript   subscript  ϕ  i   2   x      p(x)=\sum_{i=0}^{\infty}f^{2}(\lambda_{i})\phi_{i}^{2}(x)   where   f   f   f   is the initial energy distribution. By fixing a family of this energy distributions     f  i    (  x  )        subscript  f  i   x    f_{i}(x)   , the WKS can be obtained as a discrete sequence    {    p   f  1     (  x  )    ,  …  ,    p   f  n     (  x  )    }        subscript  p   subscript  f  1    x   normal-…     subscript  p   subscript  f  n    x     \{p_{f_{1}}(x),\ldots,p_{f_{n}}(x)\}   . Unlike HKS, the WKS can be intuited as a set of band-pass filters leading to better feature localization. However, the WKS does not represent large-scale features well (as they are filtered out) yielding poor performance at shape matching applications.  Global point signature (GPS)  Similar to the HKS, the GPS 15 is based on the Laplace-Beltrami operator. GPS at a point   x   x   x   is a vector of scaled eigenfunctions of the Laplace–Beltrami operator computed at   x   x   x   . The GPS is a global feature whereas the scale of the HKS can be varied by varying the time parameter for heat diffusion. Hence, the HKS can be used in partial shape matching applications whereas the GPS cannot.  Extensions  Scale invariance  Even though the HKS represents the shape at multiple scales, it is not inherently scale invariant. For example, the HKS for a shape and its scaled version are not the same without pre-normalization. A simple way to ensure scale invariance is by pre-scaling each shape to have the same surface area (e.g. 1). Using the notation above, this means:        s      =     ∑  j     A  j         A      =   A  /  s         λ  i       =   s   λ  i   for each  i         ϕ  i       =    s    ϕ  i   for each  i          s    absent    subscript   j    subscript  A  j       A    absent    A  s       subscript  λ  i     absent    s   subscript  λ  i   for each  i       subscript  ϕ  i     absent      s    subscript  ϕ  i   for each  i       \begin{aligned}\displaystyle s&\displaystyle=\sum_{j}A_{j}\\
 \displaystyle A&\displaystyle=A/s\\
 \displaystyle\lambda_{i}&\displaystyle=s\lambda_{i}\text{ for each }i\\
 \displaystyle\phi_{i}&\displaystyle=\sqrt{s}\phi_{i}\text{ for each }i\\
 \end{aligned}     Alternatively, scale-invariant version of the HKS can also be constructed by generating a Scale space representation . 16 In the scale-space, the HKS of a scaled shape corresponds to a translation up to a multiplicative factor. The fourier transform of this HKS changes the time-translation into the complex plane, and the dependency on translation can be eliminated by considering the modulus of the transform.  Volumetric HKS  The HKS is defined for a boundary surface of a 3D shape, represented as a 2D Riemannian manifold. Instead of considering only the boundary, the entire volume of the 3D shape can be considered to define the volumetric version of the HKS. 17 The Volumetric HKS is defined analogous to the normal HKS by considering the heat equation over the entire volume (as a 3-submanifold) and defining a Neumann boundary condition over the 2-manifold boundary of the shape. Volumetric HKS characterizes transformations up to a volume isometry, which represent the transformation for real 3D objects more faithfully than boundary isometry. 18  Shape Search  The scale-invariant HKS features can be used in the bag-of-features model for shape retrieval applications. 19 The features are used to construct geometric words by taking into account their spatial relations, from which shapes can be constructed (analogous to using features as words and shapes as sentences). Shapes themselves are represented using compact binary codes to form an indexed collection. Given a query shape, similar shapes in the index with possibly isometric transformations can be retrieved by using the Hamming distance of the code as the nearness-measure.  References    "  Category:Image processing  Category:Heat transfer  Category:Digital geometry  Category:Topology  Category:Differential geometry     ↩  ↩    ↩        ↩    ↩  ↩  ↩   ↩     
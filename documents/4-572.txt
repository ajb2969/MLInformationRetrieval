   Method of characteristics      Method of characteristics   In mathematics , the method of characteristics is a technique for solving partial differential equations . Typically, it applies to first-order equations , although more generally the method of characteristics is valid for any hyperbolic partial differential equation . The method is to reduce a partial differential equation to a family of ordinary differential equations along which the solution can be integrated from some initial data given on a suitable hypersurface .  Characteristics of first-order partial differential equation  For a first-order PDE ( partial differential equation ), the method of characteristics discovers curves (called characteristic curves or just characteristics) along which the PDE becomes an ordinary differential equation (ODE). Once the ODE is found, it can be solved along the characteristic curves and transformed into a solution for the original PDE.  For the sake of motivation, we confine our attention to the case of a function of two independent variables x and y for the moment. Consider a quasilinear PDE of the form  Suppose that a solution z is known, and consider the surface graph z = z ( x , y ) in R 3 . A normal vector to this surface is given by       (     ∂  z    ∂  x     (  x  ,  y  )    ,     ∂  z    ∂  y     (  x  ,  y  )    ,   -  1   )   .           z     x     x  y          z     y     x  y      1     \left(\frac{\partial z}{\partial x}(x,y),\frac{\partial z}{\partial y}(x,y),-1%
 \right).\,     As a result, 1 equation () is equivalent to the geometrical statement that the vector field      (   a   (  x  ,  y  ,  z  )    ,   b   (  x  ,  y  ,  z  )    ,   c   (  x  ,  y  ,  z  )    )       a   x  y  z      b   x  y  z      c   x  y  z      (a(x,y,z),b(x,y,z),c(x,y,z))\,     is tangent to the surface z = z ( x , y ) at every point, for the dot product of this vector field with the above normal vector is zero. In other words, the graph of the solution must be a union of integral curves of this vector field. These integral curves are called the characteristic curves of the original partial differential equation.  The equations of the characteristic curve may be expressed invariantly by the Lagrange-Charpit equations 2         d  x    a   (  x  ,  y  ,  z  )     =    d  y    b   (  x  ,  y  ,  z  )     =    d  z    c   (  x  ,  y  ,  z  )      ,            d  x     a   x  y  z         d  y     b   x  y  z              d  z     c   x  y  z        \frac{dx}{a(x,y,z)}=\frac{dy}{b(x,y,z)}=\frac{dz}{c(x,y,z)},     or, if a particular parametrization t of the curves is fixed, then these equations may be written as a system of ordinary differential equations for x ( t ), y ( t ), z ( t ):          d  x    d  t      =     a  ;   (  x  ,  y  ,  z  )          d  y    d  t      =     b  ;   (  x  ,  y  ,  z  )          d  z    d  t      =      c  ;   (  x  ,  y  ,  z  )    .             d  x     d  t      a   x  y  z          d  y     d  t      b   x  y  z          d  z     d  t      c   x  y  z       \begin{array}[]{rcl}\frac{dx}{dt}&=&a(x,y,z)\\
 \frac{dy}{dt}&=&b(x,y,z)\\
 \frac{dz}{dt}&=&c(x,y,z).\end{array}     These are the characteristic equations for the original system.  Linear and quasilinear cases  Consider now a PDE of the form         ∑   i  =  1   n     a  i    (   x  1   ,  …  ,   x  n   ,  u  )     ∂  u    ∂   x  i       =   c   (   x  1   ,  …  ,   x  n   ,  u  )     .        superscript   subscript     i  1    n      subscript  a  i     subscript  x  1   normal-…   subscript  x  n   u       u      subscript  x  i         c    subscript  x  1   normal-…   subscript  x  n   u      \sum_{i=1}^{n}a_{i}(x_{1},\dots,x_{n},u)\frac{\partial u}{\partial x_{i}}=c(x_%
 {1},\dots,x_{n},u).     For this PDE to be linear , the coefficients a i may be functions of the spatial variables only, and independent of u . For it to be quasilinear , a i may also depend on the value of the function, but not on any derivatives. The distinction between these two cases is inessential for the discussion here.  For a linear or quasilinear PDE, the characteristic curves are given parametrically by       (   x  1   ,  …  ,   x  n   ,  u  )   =   (    x  1    (  s  )    ,  …  ,    x  n    (  s  )    ,   u   (  s  )    )         subscript  x  1   normal-…   subscript  x  n   u       subscript  x  1   s   normal-…     subscript  x  n   s     u  s      (x_{1},\dots,x_{n},u)=(x_{1}(s),\dots,x_{n}(s),u(s))     such that the following system of ODEs is satisfied  Equations () and () give the characteristics of the PDE.  Fully nonlinear case  Consider the partial differential equation   where the variables p i are shorthand for the partial derivatives        p  i   =    ∂  u    ∂   x  i      .       subscript  p  i       u      subscript  x  i       p_{i}=\frac{\partial u}{\partial x_{i}}.     Let ( x i ( s ), u ( s ), p i ( s )) be a curve in R 2n+1 . Suppose that u is any solution, and that        u   (  s  )    =   u   (    x  1    (  s  )    ,  …  ,    x  n    (  s  )    )     .        u  s     u      subscript  x  1   s   normal-…     subscript  x  n   s       u(s)=u(x_{1}(s),\dots,x_{n}(s)).     Along a solution, differentiating () with respect to s gives         ∑  i     (    F   x  i    +    F  u    p  i     )     x  ˙   i     +    ∑  i     F   p  i      p  ˙   i      =  0          subscript   i        subscript  F   subscript  x  i       subscript  F  u    subscript  p  i      subscript   normal-˙  x   i       subscript   i      subscript  F   subscript  p  i     subscript   normal-˙  p   i      0    \sum_{i}(F_{x_{i}}+F_{u}p_{i})\dot{x}_{i}+\sum_{i}F_{p_{i}}\dot{p}_{i}=0           u  ˙   -    ∑  i     p  i     x  ˙   i      =  0         normal-˙  u     subscript   i      subscript  p  i    subscript   normal-˙  x   i      0    \dot{u}-\sum_{i}p_{i}\dot{x}_{i}=0           ∑  i    (      x  ˙   i   d   p  i    -     p  ˙   i   d   x  i     )    =  0.        subscript   i        subscript   normal-˙  x   i   d   subscript  p  i       subscript   normal-˙  p   i   d   subscript  x  i      0.    \sum_{i}(\dot{x}_{i}dp_{i}-\dot{p}_{i}dx_{i})=0.     The second equation follows from applying the chain rule to a solution u , and the third follows by taking an exterior derivative of the relation      d  u   -    ∑  i      p  i    d   x  i      =  0          d  u     subscript   i      subscript  p  i   d   subscript  x  i      0    du-\sum_{i}p_{i}\,dx_{i}=0   . Manipulating these equations gives         x  ˙   i   =   λ   F   p  i      ,      p  ˙   i   =   -   λ   (    F   x  i    +    F  u    p  i     )      ,    u  ˙   =   λ    ∑  i     p  i    F   p  i            formulae-sequence     subscript   normal-˙  x   i     λ   subscript  F   subscript  p  i       formulae-sequence     subscript   normal-˙  p   i       λ     subscript  F   subscript  x  i       subscript  F  u    subscript  p  i           normal-˙  u     λ    subscript   i      subscript  p  i    subscript  F   subscript  p  i           \dot{x}_{i}=\lambda F_{p_{i}},\quad\dot{p}_{i}=-\lambda(F_{x_{i}}+F_{u}p_{i}),%
 \quad\dot{u}=\lambda\sum_{i}p_{i}F_{p_{i}}     where λ is a constant. Writing these equations more symmetrically, one obtains the Lagrange-Charpit equations for the characteristic          x  ˙   i    F   p  i     =   -     p  ˙   i     F   x  i    +    F  u    p  i       =    u  ˙    ∑    p  i    F   p  i        .           subscript   normal-˙  x   i    subscript  F   subscript  p  i          subscript   normal-˙  p   i      subscript  F   subscript  x  i       subscript  F  u    subscript  p  i               normal-˙  u        subscript  p  i    subscript  F   subscript  p  i          \frac{\dot{x}_{i}}{F_{p_{i}}}=-\frac{\dot{p}_{i}}{F_{x_{i}}+F_{u}p_{i}}=\frac{%
 \dot{u}}{\sum p_{i}F_{p_{i}}}.     Geometrically, the method of characteristics in the fully nonlinear case can be interpreted as requiring that the Monge cone of the differential equation should everywhere be tangent to the graph of the solution.  Example  As an example, consider the advection equation (this example assumes familiarity with PDE notation, and solutions to basic ODEs).        a    ∂  u    ∂  x     +    ∂  u    ∂  t     =   0           a      u     x         u     t     0    a\frac{\partial u}{\partial x}+\frac{\partial u}{\partial t}=0\,     where    a    a   a\,   is constant and    u    u   u\,   is a function of    x    x   x\,   and    t    t   t\,   . We want to transform this linear first-order PDE into an ODE along the appropriate curve; i.e. something of the form        d   d  s    u   (   x   (  s  )    ,   t   (  s  )    )    =   F   (  u  ,   x   (  s  )    ,   t   (  s  )    )            d    d  s    u     x  s     t  s       F   u    x  s     t  s       \frac{d}{ds}u(x(s),t(s))=F(u,x(s),t(s))   ,  where    (   x   (  s  )    ,   t   (  s  )    )       x  s     t  s     (x(s),t(s))\,   is a characteristic line. First, we find        d   d  s    u   (   x   (  s  )    ,   t   (  s  )    )    =      ∂  u    ∂  x      d  x    d  s     +     ∂  u    ∂  t      d  t    d  s              d    d  s    u     x  s     t  s             u     x        d  x     d  s           u     t        d  t     d  s        \frac{d}{ds}u(x(s),t(s))=\frac{\partial u}{\partial x}\frac{dx}{ds}+\frac{%
 \partial u}{\partial t}\frac{dt}{ds}     by the chain rule. Now, if we set      d  x    d  s    =  a          d  x     d  s    a    \frac{dx}{ds}=a   and      d  t    d  s    =  1          d  t     d  s    1    \frac{dt}{ds}=1   we get       a    ∂  u    ∂  x     +     ∂  u    ∂  t           a      u     x         u     t      a\frac{\partial u}{\partial x}+\frac{\partial u}{\partial t}\,     which is the left hand side of the PDE we started with. Thus        d   d  s    u   =    a    ∂  u    ∂  x     +    ∂  u    ∂  t     =  0.            d    d  s    u       a      u     x         u     t          0.     \frac{d}{ds}u=a\frac{\partial u}{\partial x}+\frac{\partial u}{\partial t}=0.     So, along the characteristic line    (   x   (  s  )    ,   t   (  s  )    )       x  s     t  s     (x(s),t(s))\,   , the original PDE becomes the ODE     u  s   =   F   (  u  ,   x   (  s  )    ,   t   (  s  )    )    =   0          subscript  u  s     F   u    x  s     t  s          0     u_{s}=F(u,x(s),t(s))=0\,   . That is to say that along the characteristics, the solution is constant. Thus,     u   (   x  s   ,   t  s   )    =   u   (   x  0   ,  0  )          u    subscript  x  s    subscript  t  s       u    subscript  x  0   0      u(x_{s},t_{s})=u(x_{0},0)\,   where    (   x  s   ,   t  s   )      subscript  x  s    subscript  t  s     (x_{s},t_{s})\,   and    (   x  0   ,  0  )      subscript  x  0   0    (x_{0},0)\,   lie on the same characteristic. So to determine the general solution, it is enough to find the characteristics by solving the characteristic system of ODEs:         d  t    d  s    =  1          d  t     d  s    1    \frac{dt}{ds}=1   , letting     t   (  0  )    =   0         t  0   0    t(0)=0\,   we know    t  =   s       t  s    t=s\,   ,        d  x    d  s    =  a          d  x     d  s    a    \frac{dx}{ds}=a   , letting     x   (  0  )    =    x  0          x  0    subscript  x  0     x(0)=x_{0}\,   we know    x  =    a  s   +   x  0    =    a  t   +    x  0           x      a  s    subscript  x  0             a  t    subscript  x  0       x=as+x_{0}=at+x_{0}\,   ,        d  u    d  s    =  0          d  u     d  s    0    \frac{du}{ds}=0   , letting     u   (  0  )    =   f   (   x  0   )          u  0     f   subscript  x  0      u(0)=f(x_{0})\,   we know     u   (   x   (  t  )    ,  t  )    =   f   (   x  0   )    =   f   (   x  -   a  t    )            u     x  t   t      f   subscript  x  0           f    x    a  t        u(x(t),t)=f(x_{0})=f(x-at)\,   .   In this case, the characteristic lines are straight lines with slope    a    a   a\,   , and the value of    u    u   u\,   remains constant along any characteristic line.  Characteristics of linear differential operators  Let X be a differentiable manifold and P a linear differential operator      P  :     C  ∞    (  X  )    →    C  ∞    (  X  )        normal-:  P   normal-→     superscript  C    X      superscript  C    X      P:C^{\infty}(X)\to C^{\infty}(X)   of order k . In a local coordinate system x i ,      P  =    ∑    |  α  |   ≤  k      P  α    (  x  )    ∂   ∂   x  α           P    subscript       α   k       superscript  P  α   x        superscript  x  α         P=\sum_{|\alpha|\leq k}P^{\alpha}(x)\frac{\partial}{\partial x^{\alpha}}   in which α denotes a multi-index . The principal symbol of P , denoted σ P , is the function on the cotangent bundle T ∗ X defined in these local coordinates by        σ  P    (  x  ,  ξ  )    =    ∑    |  α  |   =  k      P  α    (  x  )    ξ  α            subscript  σ  P    x  ξ      subscript       α   k       superscript  P  α   x   subscript  ξ  α       \sigma_{P}(x,\xi)=\sum_{|\alpha|=k}P^{\alpha}(x)\xi_{\alpha}     where the ξ i are the fiber coordinates on the cotangent bundle induced by the coordinate differentials d x i . Although this is defined using a particular coordinate system, the transformation law relating the ξ i and the x i ensures that σ P is a well-defined function on the cotangent bundle.  The function σ P is homogeneous of degree k in the ξ variable. The zeros of σ P , away from the zero section of T ∗ X , are the characteristics of P . A hypersurface of X defined by the equation F ( x ) = c is called a characteristic hypersurface at x if        σ  P    (  x  ,   d  F   (  x  )    )    =  0.         subscript  σ  P    x    d  F  x     0.    \sigma_{P}(x,dF(x))=0.   Invariantly, a characteristic hypersurface is a hypersurface whose conormal bundle is in the characteristic set of P .  Qualitative analysis of characteristics  Characteristics are also a powerful tool for gaining qualitative insight into a PDE.  One can use the crossings of the characteristics to find shock waves for potential flow in a compressible fluid. Intuitively, we can think of each characteristic line implying a solution to    u    u   u\,   along itself. Thus, when two characteristics cross, the function becomes multi-valued resulting in a non-physical solution. Physically, this contradiction is removed by the formation of a shock wave, a tangential discontinuity or a weak discontinuity and can result in non-potential flow, violating the initial assumptions.  Characteristics may fail to cover part of the domain of the PDE. This is called a rarefaction , and indicates the solution typically exists only in a weak, i.e. integral equation , sense.  The direction of the characteristic lines indicate the flow of values through the solution, as the example above demonstrates. This kind of knowledge is useful when solving PDEs numerically as it can indicate which finite difference scheme is best for the problem.  See also   Method of quantum characteristics   Notes  References          .    External links   Prof. Scott Sarra tutorial on Method of Characteristics  Prof. Alan Hood tutorial on Method of Characteristics   "  Category:Partial differential equations     ↩  ↩     
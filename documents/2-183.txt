   Lagrange inversion theorem      Lagrange inversion theorem   In mathematical analysis , the Lagrange inversion theorem , also known as the Lagrange–Bürmann formula , gives the Taylor series expansion of the inverse function of an analytic function .  Theorem statement  Suppose z is defined as a function of w by an equation of the form       f   (  w  )    =   z         f  w   z    f(w)=z\,     where f is analytic at a point a and f '( a ) ≠ 0. Then it is possible to invert or solve the equation for w :      w  =   g   (  z  )        w    g  z     w=g(z)\,     on a neighbourhood of f(a) , where g is analytic at the point f ( a ). This is also called reversion of series .  The series expansion of g is given by 1        g   (  z  )    =   a  +    ∑   n  =  1   ∞    (    lim   w  →  a     (      (   z  -   f   (  a  )     )   n    n  !      d    n   -  1     d   w    n   -  1        (    w  -  a     f   (  w  )    -   f   (  a  )      )   n    )    )      .        g  z     a    superscript   subscript     n  1        subscript    normal-→  w  a         superscript    z    f  a    n     n       superscript  normal-d    n  1      normal-d   superscript  w    n  1       superscript      w  a       f  w     f  a     n         g(z)=a+\sum_{n=1}^{\infty}\left(\lim_{w\to a}\left({\frac{(z-f(a))^{n}}{n!}}%
 \frac{\mathrm{d}^{\,n-1}}{\mathrm{d}w^{\,n-1}}\left(\frac{w-a}{f(w)-f(a)}%
 \right)^{n}\right)\right).     The formula is also valid for formal power series and can be generalized in various ways. It can be formulated for functions of several variables, it can be extended to provide a ready formula for F ( g ( z )) for any analytic function F , and it can be generalized to the case f '( a ) = 0, where the inverse g is a multivalued function.  The theorem was proved by Lagrange 2 and generalized by Hans Heinrich Bürmann , 3 4 5 both in the late 18th century. There is a straightforward derivation 6 using complex analysis and contour integration ; the complex formal power series version is clearly a consequence of knowing the formula for polynomials , so the theory of analytic functions may be applied. Actually, the machinery from analytic function theory enters only in a formal way in this proof, in that what is really needed is just some property of the formal residue , and a more direct formal proof is available.  Applications  Lagrange–Bürmann formula  There is a special case of Lagrange inversion theorem that is used in combinatorics and applies when     f   (  w  )    =    w  /  ϕ    (  w  )          f  w       w  ϕ   w     f(w)=w/\phi(w)   and     ϕ   (  0  )    ≠  0.        ϕ  0   0.    \phi(0)\neq 0.   Take    a  =  0      a  0    a=0   to obtain    b  =   f   (  0  )    =  0.        b    f  0        0.     b=f(0)=0.   We have       g   (  z  )    =    ∑   n  =  1   ∞    (    lim   w  →  0      (     d   n  -  1     d   w   n  -  1        (   w    w  /  ϕ    (  w  )     )   n    )     z  n    n  !      )          g  z     superscript   subscript     n  1        subscript    normal-→  w  0           superscript  normal-d    n  1      normal-d   superscript  w    n  1       superscript    w      w  ϕ   w    n       superscript  z  n     n         g(z)=\sum_{n=1}^{\infty}\left(\lim_{w\to 0}\left(\frac{\mathrm{d}^{n-1}}{%
 \mathrm{d}w^{n-1}}\left(\frac{w}{w/\phi(w)}\right)^{n}\right)\frac{z^{n}}{n!}\right)           =    ∑   n  =  1   ∞     1  n    (    1    (   n  -  1   )   !      lim   w  →  0     (     d   n  -  1     d   w   n  -  1      ϕ    (  w  )   n    )     )    z  n      ,      absent    superscript   subscript     n  1          1  n       1      n  1       subscript    normal-→  w  0         superscript  normal-d    n  1      normal-d   superscript  w    n  1      ϕ   superscript  w  n       superscript  z  n       =\sum_{n=1}^{\infty}\frac{1}{n}\left(\frac{1}{(n-1)!}\lim_{w\to 0}\left(\frac{%
 \mathrm{d}^{n-1}}{\mathrm{d}w^{n-1}}\phi(w)^{n}\right)\right)z^{n},     which can be written alternatively as         [   z  n   ]   g   (  z  )    =    1  n    [   w   n  -  1    ]   ϕ    (  w  )   n     ,         delimited-[]   superscript  z  n    g  z       1  n    delimited-[]   superscript  w    n  1     ϕ   superscript  w  n      [z^{n}]g(z)=\frac{1}{n}[w^{n-1}]\phi(w)^{n},     where    [   w  r   ]     delimited-[]   superscript  w  r     [w^{r}]   is an operator which extracts the coefficient of    w  r     superscript  w  r    w^{r}   in the Taylor series of a function of w.  A useful generalization of the formula is known as the Lagrange–Bürmann formula :        [   z  n   ]   H   (   g   (  z  )    )    =    1  n    [   w   n  -  1    ]    (    H  ′    (  w  )   ϕ    (  w  )   n    )           delimited-[]   superscript  z  n    H    g  z        1  n    delimited-[]   superscript  w    n  1        superscript  H  normal-′   w  ϕ   superscript  w  n       [z^{n}]H(g(z))=\frac{1}{n}[w^{n-1}](H^{\prime}(w)\phi(w)^{n})     where   H   H   H   can be an arbitrary analytic function, e.g.  w k }} .  Lambert W function  The Lambert W function is the function    W   (  z  )       W  z    W(z)   that is implicitly defined by the equation        W   (  z  )    e   W   (  z  )      =  z   .        W  z   superscript  e    W  z     z    W(z)e^{W(z)}=z.\,     We may use the theorem to compute the Taylor series of    W   (  z  )       W  z    W(z)   at    z  =  0.      z  0.    z=0.   We take     f   (  w  )    =   w   e  w          f  w     w   superscript  normal-e  w      f(w)=w\mathrm{e}^{w}   and    a  =  b  =  0.        a  b       0.     a=b=0.   Recognizing that          d  n    d   x  n        e    α   x      =     α  n     e    α   x              superscript  normal-d  n     normal-d   superscript  x  n      superscript  normal-e    α  x        superscript  α  n    superscript  normal-e    α  x       \frac{\mathrm{d}^{n}}{\mathrm{d}x^{n}}\ \mathrm{e}^{\alpha\,x}\,=\,\alpha^{n}%
 \,\mathrm{e}^{\alpha\,x}   this gives        W   (  z  )    =    ∑   n  =  1   ∞     lim   w  →  0      (      d    n   -  1     d   w    n   -  1        e   -   n  w      )      z  n    n  !        =    ∑   n  =  1   ∞       (   -  n   )    n  -  1       z  n    n  !      =      z  -   z  2    +    3  2    z  3     -    8  3    z  4     +   O   (   z  5   )      .          W  z     superscript   subscript     n  1        subscript    normal-→  w  0           superscript  normal-d    n  1      normal-d   superscript  w    n  1       superscript  normal-e      n  w         superscript  z  n     n              superscript   subscript     n  1         superscript    n     n  1       superscript  z  n     n                   z   superscript  z  2        3  2    superscript  z  3         8  3    superscript  z  4       O   superscript  z  5        W(z)=\sum_{n=1}^{\infty}\lim_{w\to 0}\left(\frac{\mathrm{d}^{\,n-1}}{\mathrm{d%
 }w^{\,n-1}}\ \mathrm{e}^{-nw}\right){\frac{z^{n}}{n!}}\,=\,\sum_{n=1}^{\infty}%
 (-n)^{n-1}\,\frac{z^{n}}{n!}=z-z^{2}+\frac{3}{2}z^{3}-\frac{8}{3}z^{4}+O(z^{5}).     The radius of convergence of this series is    e   -  1      superscript  e    1     e^{-1}   (this example refers to the principal branch of the Lambert function).  A series that converges for larger z (though not for all z ) can also be derived by series inversion. The function     f   (  z  )    =    W   (   e  z   )    -   1          f  z       W   superscript  e  z    1     f(z)=W(e^{z})-1\,   satisfies the equation        1  +   f   (  z  )    +   ln   (   1  +   f   (  z  )     )     =  z   .        1    f  z       1    f  z      z    1+f(z)+\ln(1+f(z))=z.\,     Then    z  +   ln   (   1  +  z   )        z      1  z      z+\ln(1+z)\,   can be expanded into a power series and inverted. This gives a series for     f   (   z  +  1   )    =    W   (   e   z  +  1    )    -   1          f    z  1        W   superscript  e    z  1     1     f(z+1)=W(e^{z+1})-1\,   :        W   (   e   1  +  z    )    =       1  +   z  2   +    z  2   16    -    z  3   192   -    z  4   3072    +    13   z  5    61440    -    47   z  6    1474560   -    73   z  7    41287680    +    2447   z  8    1321205760   +   O   (   z  9   )      .        W   superscript  e    1  z               1    z  2      superscript  z  2   16       superscript  z  3   192      superscript  z  4   3072        13   superscript  z  5    61440        47   superscript  z  6    1474560       73   superscript  z  7    41287680        2447   superscript  z  8    1321205760     O   superscript  z  9       W(e^{1+z})=1+\frac{z}{2}+\frac{z^{2}}{16}-\frac{z^{3}}{192}-\frac{z^{4}}{3072}%
 +\frac{13z^{5}}{61440}-\frac{47z^{6}}{1474560}-\frac{73z^{7}}{41287680}+\frac{%
 2447z^{8}}{1321205760}+O(z^{9}).       W   (  x  )       W  x    W(x)\,   can be computed by substituting     ln  x   -   1         x   1    \ln x-1\,   for z in the above series. For example, substituting −1 for z gives the value of     W   (  1  )    =   0.567143         W  1   0.567143    W(1)=0.567143\,   .  Binary trees  Consider the set   ℬ   ℬ   \mathcal{B}   of unlabelled binary trees . An element of   ℬ   ℬ   \mathcal{B}   is either a leaf of size zero, or a root node with two subtrees. Denote by    B  n     subscript  B  n    B_{n}   the number of binary trees on n nodes.  Note that removing the root splits a binary tree into two trees of smaller size. This yields the functional equation on the generating function     B   (  z  )    =    ∑   n  =  0   ∞     B  n    z  n           B  z     superscript   subscript     n  0         subscript  B  n    superscript  z  n       B(z)=\sum_{n=0}^{\infty}B_{n}z^{n}   :        B   (  z  )    =   1  +   z  B    (  z  )   2      .        B  z     1    z  B   superscript  z  2       B(z)=1+zB(z)^{2}.     Now let     C   (  z  )    =    B   (  z  )    -  1         C  z       B  z   1     C(z)=B(z)-1   and rewrite this equation as follows:       z  =    C   (  z  )      (    C   (  z  )    +  1   )   2     .      z      C  z    superscript      C  z   1   2      z=\frac{C(z)}{(C(z)+1)^{2}}.     Now apply the theorem with      ϕ   (  w  )    =    (   w  +  1   )   2    :      normal-:      ϕ  w    superscript    w  1   2    absent    \phi(w)=(w+1)^{2}:           B  n   =    [   z  n   ]   C   (  z  )    =    1  n    [   w   n  -  1    ]     (   w  +  1   )    2  n     =    1  n    (      2  n        n  -  1      )    =    1   n  +  1     (      2  n       n     )     .         subscript  B  n      delimited-[]   superscript  z  n    C  z            1  n    delimited-[]   superscript  w    n  1      superscript    w  1     2  n              1  n    binomial    2  n     n  1              1    n  1     binomial    2  n   n       B_{n}=[z^{n}]C(z)=\frac{1}{n}[w^{n-1}](w+1)^{2n}=\frac{1}{n}{2n\choose n-1}=%
 \frac{1}{n+1}{2n\choose n}.     We conclude that    B  n     subscript  B  n    B_{n}   is the Catalan number .  See also   Faà di Bruno's formula gives coefficients of the composition of two formal power series in terms of the coefficients of those two series. Equivalently, it is a formula for the n th derivative of a composite function.  Lagrange reversion theorem for another theorem sometimes called the inversion theorem  Formal power series#The Lagrange inversion formula   References  External links     Bürmann–Lagrange series at Springer EOM   "  Category:Inverse functions  Category:Theorems in real analysis  Category:Theorems in complex analysis     ↩  (Note: Although Lagrange submitted this article in 1768, it was not published until 1770.) ↩  Bürmann, Hans Heinrich, “Essai de calcul fonctionnaire aux constantes ad-libitum,” submitted in 1796 to the Institut National de France. For a summary of this article, see: ↩  Bürmann, Hans Heinrich, "Formules du développement, de retour et d'integration," submitted to the Institut National de France. Bürmann's manuscript survives in the archives of the École Nationale des Ponts et Chaussées [National School of Bridges and Roads] in Paris. (See ms. 1715.) ↩  A report on Bürmann's theorem by Joseph-Louis Lagrange and Adrien-Marie Legendre appears in: "Rapport sur deux mémoires d'analyse du professeur Burmann,"  Mémoires de l'Institut National des Sciences et Arts: Sciences Mathématiques et Physiques , vol. 2, pages 13–17 (1799). ↩  *E. T. Whittaker and G. N. Watson. A Course of Modern Analysis . Cambridge University Press; 4th edition (January 2, 1927), pp. 129–130 ↩     
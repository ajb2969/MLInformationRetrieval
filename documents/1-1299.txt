   Group delay and phase delay      Group delay and phase delay   In signal processing , group delay is a measure of the time delay of the amplitude envelopes of the various sinusoidal  components of a signal through a device under test , and is a function of frequency for each component. Phase delay is similar, however it is a measure of the time delay of the phase as opposed to the time delay of the amplitude envelope .  All frequency components of a signal are delayed when passed through a device such as an amplifier, a loudspeaker, or propagating through space or a medium, such as air. This signal delay will be different for the various frequencies unless the device has the property of being linear phase . (Linear phase and minimum phase are often confused. They are quite different.) The delay variation means that signals consisting of multiple frequency components will suffer distortion because these components are not delayed by the same amount of time at the output of the device. This changes the shape of the signal in addition to any constant delay or scale change. A sufficiently large delay variation can cause problems such as poor fidelity in audio or intersymbol interference (ISI) in the demodulation of digital information from an analog  carrier signal . High speed modems use adaptive equalizers to compensate for non-constant group delay.  Introduction  Group delay is a useful measure of time distortion, and is calculated by differentiating , with respect to frequency, the phase response of the device under test (DUT): the group delay is a measure of the slope of the phase response at any given frequency. Variations in group delay cause signal distortion, just as deviations from linear phase cause distortion.  In linear time-invariant (LTI) system theory , control theory , and in digital or analog  signal processing , the relationship between the input signal,    x   (  t  )       x  t    \displaystyle x(t)   , to output signal,    y   (  t  )       y  t    \displaystyle y(t)   , of an LTI system is governed by a convolution operation:       y   (  t  )    =    (   h  *  x   )    (  t  )      =  def      ∫   -  ∞   ∞    x   (  u  )   h   (   t  -  u   )   d  u            y  t       h  x   t      superscript   def       superscript   subscript            x  u  h    t  u   d  u       y(t)=(h*x)(t)\ \stackrel{\mathrm{def}}{=}\ \int_{-\infty}^{\infty}x(u)h(t-u)\,du     Or, in the frequency domain ,       Y   (  s  )    =   H   (  s  )   X   (  s  )          Y  s     H  s  X  s     Y(s)=H(s)X(s)\,     where       X   (  s  )    =   ℒ   {   x   (  t  )    }      =  def      ∫   -  ∞   ∞    x   (  t  )     e   -   s  t      d  t            X  s     ℒ     x  t        superscript   def       superscript   subscript            x  t   superscript  e      s  t     d  t       X(s)=\mathcal{L}\left\{x(t)\right\}\ \stackrel{\mathrm{def}}{=}\ \int_{-\infty%
 }^{\infty}x(t)e^{-st}\,dt          Y   (  s  )    =   ℒ   {   y   (  t  )    }      =  def      ∫   -  ∞   ∞    y   (  t  )     e   -   s  t      d  t            Y  s     ℒ     y  t        superscript   def       superscript   subscript            y  t   superscript  e      s  t     d  t       Y(s)=\mathcal{L}\left\{y(t)\right\}\ \stackrel{\mathrm{def}}{=}\ \int_{-\infty%
 }^{\infty}y(t)e^{-st}\,dt     and       H   (  s  )    =   ℒ   {   h   (  t  )    }      =  def      ∫   -  ∞   ∞    h   (  t  )     e   -   s  t      d  t            H  s     ℒ     h  t        superscript   def       superscript   subscript            h  t   superscript  e      s  t     d  t       H(s)=\mathcal{L}\left\{h(t)\right\}\ \stackrel{\mathrm{def}}{=}\ \int_{-\infty%
 }^{\infty}h(t)e^{-st}\,dt   .  Here    h   (  t  )       h  t    \displaystyle h(t)   is the time-domain impulse response of the LTI system and    X   (  s  )       X  s    \displaystyle X(s)   ,    Y   (  s  )       Y  s    \displaystyle Y(s)   ,    H   (  s  )       H  s    \displaystyle H(s)   , are the Laplace transforms of the input    x   (  t  )       x  t    \displaystyle x(t)   , output    y   (  t  )       y  t    \displaystyle y(t)   , and impulse response    h   (  t  )       h  t    \displaystyle h(t)   , respectively.    H   (  s  )       H  s    \displaystyle H(s)   is called the transfer function of the LTI system and, like the impulse response    h   (  t  )       h  t    \displaystyle h(t)   , fully defines the input-output characteristics of the LTI system.  Suppose that such a system is driven by a quasi-sinusoidal signal, that is, a sinusoid whose amplitude envelope    a   (  t  )       a  t    \displaystyle a(t)   is slowly-changing relative to the phase frequency   ω   ω   \displaystyle\omega   of the sinusoid. Mathematically, this means that the driving signal has the form       x   (  t  )    =   a   (  t  )    cos   (    ω  t   +  θ   )           x  t     a  t        ω  t   θ       x(t)=a(t)\cos(\omega t+\theta)     subject to the assumption        |    d   log   (   a   (  t  )    )      d  t    |   ≪   ω    .     much-less-than        d      a  t       d  t     ω    \left|\frac{d\log\left(a(t)\right)}{dt}\right|\ll\omega\;.     Then the output of such an LTI system is very well approximated as        y   (  t  )    =    |   H   (   i  ω   )    |   a   (   t  -   τ  g    )    cos   (    ω   (   t  -   τ  ϕ    )    +  θ   )      .        y  t         H    i  ω     a    t   subscript  τ  g          ω    t   subscript  τ  ϕ     θ       y(t)=|H(i\omega)|\ a(t-\tau_{g})\cos\left(\omega(t-\tau_{\phi})+\theta\right)\;.     Here    τ  g     subscript  τ  g    \displaystyle\tau_{g}   and    τ  ϕ     subscript  τ  ϕ    \displaystyle\tau_{\phi}   , the group delay and phase delay respectively, are given by the expressions below (and potentially are functions of the angular frequency    ω   ω   \displaystyle\omega   ).  In a linear phase system (with non-inverting gain), both    τ  g     subscript  τ  g    \displaystyle\tau_{g}   and    τ  ϕ     subscript  τ  ϕ    \displaystyle\tau_{\phi}   are constant (i.e. independent of ω) and equal, and their common value equals the overall delay of the system; and the unwrapped phase shift of the system (namely -ωτ φ ) is negative, with magnitude increasing linearly with frequency   ω   ω   \displaystyle\omega   .  More generally, it can be shown that for an LTI system with transfer function    H   (  s  )       H  s    \displaystyle H(s)   driven by a complex sinusoid of unit amplitude,       x   (  t  )    =   e   i  ω  t          x  t    superscript  e    i  ω  t      x(t)=e^{i\omega t}     the output is      y   (  t  )       y  t    \displaystyle y(t)     where the phase shift   ϕ   ϕ   \displaystyle\phi   is        ϕ   (  ω  )      =  def     arg   {   H   (   i  ω   )    }     .      superscript   def     ϕ  ω       H    i  ω       \phi(\omega)\ \stackrel{\mathrm{def}}{=}\ \arg\left\{H(i\omega)\right\}\;.     Additionally, it can be shown that the group delay,    τ  g     subscript  τ  g    \displaystyle\tau_{g}   , and phase delay,    τ  ϕ     subscript  τ  ϕ    \displaystyle\tau_{\phi}   , are frequency-dependent, and they can be computed from the phase shift   ϕ   ϕ   \displaystyle\phi   by        τ  g    (  ω  )    =   -    d  ϕ   (  ω  )     d  ω            subscript  τ  g   ω         d  ϕ  ω     d  ω       \tau_{g}(\omega)=-\frac{d\phi(\omega)}{d\omega}           τ  ϕ    (  ω  )    =   -    ϕ   (  ω  )    ω           subscript  τ  ϕ   ω         ϕ  ω   ω      \tau_{\phi}(\omega)=-\frac{\phi(\omega)}{\omega}   .  Group delay in optics  In physics , and in particular in optics , the term group delay has the following meanings:   1. The rate of change of the total phase shift with respect to angular frequency ,      τ  g   =   -    d  ϕ    d  ω          subscript  τ  g         d  ϕ     d  ω       \tau_{g}=-\frac{d\phi}{d\omega}      through a device or transmission medium , where   ϕ   ϕ   \phi   is the total phase shift in radians , and   ω   ω   \omega   is the angular frequency in radians per unit time, equal to    2  π  f      2  π  f    2\pi f   , where   f   f   f   is the frequency ( hertz if group delay is measured in seconds).    2. In an optical fiber , the transit time required for optical power , traveling at a given mode 's group velocity , to travel a given distance.    Note: For optical fiber dispersion measurement purposes, the quantity of interest is group delay per unit length, which is the reciprocal of the group velocity of a particular mode. The measured group delay of a signal through an optical fiber exhibits a wavelength dependence due to the various dispersion mechanisms present in the fiber.   It is often desirable for the group delay to be constant across all frequencies; otherwise there is temporal smearing of the signal. Because group delay is      τ  g    (  ω  )    =   -    d  ϕ    d  ω            subscript  τ  g   ω         d  ϕ     d  ω       \tau_{g}(\omega)=-\frac{d\phi}{d\omega}   , as defined in (1), it therefore follows that a constant group delay can be achieved if the transfer function of the device or medium has a linear phase response (i.e.,     ϕ   (  ω  )    =    ϕ   (  0  )    -    τ  g   ω          ϕ  ω       ϕ  0      subscript  τ  g   ω      \phi(\omega)=\phi(0)-\tau_{g}\omega   where the group delay    τ  g     subscript  τ  g    \tau_{g}   is a constant). The degree of nonlinearity of the phase indicates the deviation of the group delay from a constant.  Group delay in audio  Group delay has some importance in the audio field and especially in the sound reproduction field. Many components of an audio reproduction chain, notably loudspeakers and multiway loudspeaker crossover networks , introduce group delay in the audio signal. It is therefore important to know the threshold of audibility of group delay with respect to frequency, especially if the audio chain is supposed to provide high fidelity reproduction. The best thresholds of audibility table has been provided by .      Frequency   Threshold       500 Hz   3.2 ms     1 kHz   2 ms     2 kHz   1 ms     4 kHz   1.5 ms     8 kHz   2 ms     Flanagan, Moore and Stone conclude that at 1, 2 and 4 kHz, a group delay of about 1.6 ms is audible with headphones in a non-reverberant condition. 1  See also   Audio system measurements  Bessel filter  Eye pattern  Group velocity -- "The group velocity of light in a medium is the inverse of the group delay per unit length." 2  Spectral phase -- "The group delay can be defined as the derivative of the spectral phase with respect to angular frequency." 3   References       External links   Discussion of Group Delay in Loudspeakers  Group Delay Explanations and Applications   "  Category:Optics  Category:Waves  Category:Signal processing     ↩  http://www.rp-photonics.com/group_delay.html ↩  http://www.rp-photonics.com/spectral_phase.html ↩     
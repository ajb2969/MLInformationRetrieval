<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="344">Geometric integrator</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Geometric integrator</h1>
<hr/>

<p>In the mathematical field of <a href="numerical_ordinary_differential_equations" title="wikilink">numerical ordinary differential equations</a>, a <strong>geometric integrator</strong> is a numerical method that preserves geometric properties of the exact <a href="Vector_field#Flow_curves" title="wikilink">flow</a> of a differential equation.</p>
<h2 id="pendulum-example">Pendulum example</h2>

<p>We can motivate the study of geometric integrators by considering the motion of a <a href="simple_pendulum" title="wikilink">pendulum</a>.</p>

<p>Assume that we have a pendulum whose bob has mass 

<math display="inline" id="Geometric_integrator:0">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=1
  </annotation>
 </semantics>
</math>

 and whose rod is massless of length 

<math display="inline" id="Geometric_integrator:1">
 <semantics>
  <mrow>
   <mi mathvariant="normal">‚Ñì</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-‚Ñì</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell=1
  </annotation>
 </semantics>
</math>

. Take the acceleration due to gravity to be 

<math display="inline" id="Geometric_integrator:2">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>g</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g=1
  </annotation>
 </semantics>
</math>

. Denote by 

<math display="inline" id="Geometric_integrator:3">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>q</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(t)
  </annotation>
 </semantics>
</math>


 the angular displacement of the rod from the vertical, and by 

<math display="inline" id="Geometric_integrator:4">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(t)
  </annotation>
 </semantics>
</math>

 the pendulum's momentum. The <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian</a> of the system, the sum of its <a href="kinetic_energy" title="wikilink">kinetic</a> and <a href="potential_energy" title="wikilink">potential</a> energies, is</p>

<p>

<math display="block" id="Geometric_integrator:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>q</mi>
      <mo>,</mo>
      <mi>p</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>T</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>p</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>U</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>q</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>cos</mi>
      <mi>q</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>H</ci>
      <interval closure="open">
       <ci>q</ci>
       <ci>p</ci>
      </interval>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <ci>U</ci>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <cos></cos>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(q,p)=T(p)+U(q)=\frac{1}{2}p^{2}-\cos q,
  </annotation>
 </semantics>
</math>

</p>

<p>which gives <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a></p>

<p>

<math display="block" id="Geometric_integrator:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>q</mi>
      <mo>Àô</mo>
     </mover>
     <mo>,</mo>
     <mover accent="true">
      <mi>p</mi>
      <mo>Àô</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>sin</mi>
       <mi>q</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <apply>
      <ci>normal-Àô</ci>
      <ci>q</ci>
     </apply>
     <apply>
      <ci>normal-Àô</ci>
      <ci>p</ci>
     </apply>
    </interval>
    <interval closure="open">
     <ci>p</ci>
     <apply>
      <minus></minus>
      <apply>
       <sin></sin>
       <ci>q</ci>
      </apply>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\dot{q},\dot{p})=(p,-\sin q).\,
  </annotation>
 </semantics>
</math>

</p>

<p>It is natural to take the <a href="configuration_space" title="wikilink">configuration space</a> 

<math display="inline" id="Geometric_integrator:7">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 of all 

<math display="inline" id="Geometric_integrator:8">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>


 to be the unit circle 

<math display="inline" id="Geometric_integrator:9">
 <semantics>
  <msup>
   <mi>ùïä</mi>
   <mn>1</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ùïä</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{S}^{1}
  </annotation>
 </semantics>
</math>

, so that 

<math display="inline" id="Geometric_integrator:10">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mi>p</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>q</ci>
    <ci>p</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (q,p)
  </annotation>
 </semantics>
</math>

 lies on the cylinder 

<math display="inline" id="Geometric_integrator:11">
 <semantics>
  <mrow>
   <msup>
    <mi>ùïä</mi>
    <mn>1</mn>
   </msup>
   <mo>√ó</mo>
   <mi>‚Ñù</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ùïä</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>‚Ñù</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{S}^{1}\times\mathbb{R}
  </annotation>
 </semantics>
</math>

. However, we will take 

<math display="inline" id="Geometric_integrator:12">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>q</mi>
    <mo>,</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>‚àà</mo>
   <msup>
    <mi>‚Ñù</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <interval closure="open">
     <ci>q</ci>
     <ci>p</ci>
    </interval>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>‚Ñù</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (q,p)\in\mathbb{R}^{2}
  </annotation>
 </semantics>
</math>

, simply because 

<math display="inline" id="Geometric_integrator:13">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mi>p</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>q</ci>
    <ci>p</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (q,p)
  </annotation>
 </semantics>
</math>


-space is then easier to plot. Define 

<math display="inline" id="Geometric_integrator:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>z</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>q</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>t</ci>
      </apply>
     </interval>
     <ci>normal-T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z(t)=(q(t),p(t))^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Geometric_integrator:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>sin</mi>
       <mi>q</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <interval closure="open">
      <ci>p</ci>
      <apply>
       <minus></minus>
       <apply>
        <sin></sin>
        <ci>q</ci>
       </apply>
      </apply>
     </interval>
     <ci>normal-T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(z)=(p,-\sin q)^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

. Let us experiment by using some simple numerical methods to integrate this system. As usual, we select a constant step size, 

<math display="inline" id="Geometric_integrator:16">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

, and for an aribtrary non-negative integer 

<math display="inline" id="Geometric_integrator:17">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 we write 

<math display="inline" id="Geometric_integrator:18">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>k</mi>
   </msub>
   <mo>:=</mo>
   <mrow>
    <mi>z</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>k</mi>
      <mi>h</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <ci>z</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>h</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{k}:=z(kh)
  </annotation>
 </semantics>
</math>


. We use the following methods.</p>

<p>

<math display="block" id="Geometric_integrator:19">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>k</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>z</mi>
       <mi>k</mi>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{k+1}=z_{k}+hf(z_{k})\,
  </annotation>
 </semantics>
</math>

 (<a href="Euler_method" title="wikilink">explicit Euler</a>),</p>

<p>

<math display="block" id="Geometric_integrator:20">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>k</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{k+1}=z_{k}+hf(z_{k+1})\,
  </annotation>
 </semantics>
</math>

 (<a href="implicit_Euler_method" title="wikilink">implicit Euler</a>),</p>

<p>

<math display="block" id="Geometric_integrator:21">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>k</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>q</mi>
       <mi>k</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>p</mi>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{k+1}=z_{k}+hf(q_{k},p_{k+1})\,
  </annotation>
 </semantics>
</math>

 (<a href="Euler‚ÄìCromer_algorithm" title="wikilink">symplectic Euler</a>),</p>

<p>

<math display="block" id="Geometric_integrator:22">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>k</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>h</mi>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>z</mi>
          <mrow>
           <mi>k</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>z</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>f</ci>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{k+1}=z_{k}+hf((z_{k+1}+z_{k})/2)\,
  </annotation>
 </semantics>
</math>

 (<a href="implicit_midpoint_rule" title="wikilink">implicit midpoint rule</a>).</p>

<p>(Note that the symplectic Euler method treats <em>q</em> by the explicit and 

<math display="inline" id="Geometric_integrator:23">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>


 by the implicit Euler method.)</p>

<p>The observation that 

<math display="inline" id="Geometric_integrator:24">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 is constant along the solution curves of the Hamilton's equations allows us to describe the exact trajectories of the system: they are the <a href="level_set" title="wikilink">level curves</a> of 

<math display="inline" id="Geometric_integrator:25">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mi>cos</mi>
    <mi>q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <cos></cos>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}/2-\cos q
  </annotation>
 </semantics>
</math>

. We plot, in 

<math display="inline" id="Geometric_integrator:26">
 <semantics>
  <msup>
   <mi>‚Ñù</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>‚Ñù</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}^{2}
  </annotation>
 </semantics>
</math>

, the exact trajectories and the numerical solutions of the system. For the explicit and implicit Euler methods we take 

<math display="inline" id="Geometric_integrator:27">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>=</mo>
   <mn>0.2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>h</ci>
    <cn type="float">0.2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=0.2
  </annotation>
 </semantics>
</math>

, and <em>z</em><sub>0</sub>¬†=¬†(0.5,¬†0) and (1.5,¬†0) respectively; for the other two methods we take 

<math display="inline" id="Geometric_integrator:28">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>=</mo>
   <mn>0.3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>h</ci>
    <cn type="float">0.3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h=0.3
  </annotation>
 </semantics>
</math>

, and <em>z</em><sub>0</sub>¬†=¬†(0,¬†0.7), (0,¬†1.4) and (0,¬†2.1).  The explicit (resp. implicit) Euler method spirals out from (resp. in to) the origin. The other two methods show the correct qualitative behaviour, with the implicit midpoint rule agreeing with the exact solution to a greater degree than the symplectic Euler method.</p>

<p>Recall that the exact flow 

<math display="inline" id="Geometric_integrator:29">
 <semantics>
  <msub>
   <mi>œï</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>œï</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{t}
  </annotation>
 </semantics>
</math>

 of a Hamiltonian system with one degree of freedom is area-preserving, in the sense that</p>

<p>

<math display="block" id="Geometric_integrator:30">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mfrac>
     <mrow>
      <mo>‚àÇ</mo>
      <msub>
       <mi>œï</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>‚àÇ</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>q</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>p</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <determinant></determinant>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>œï</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det\frac{\partial\phi_{t}}{\partial(q_{0},p_{0})}=1
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Geometric_integrator:31">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

. This formula is easily verified by hand. For our pendulum example we see that the numerical flow 

<math display="inline" id="Geometric_integrator:32">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Œ¶</mi>
    <mrow>
     <mi>eE</mi>
     <mo>,</mo>
     <mi>h</mi>
    </mrow>
   </msub>
   <mo>:</mo>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>k</mi>
    </msub>
    <mo>‚Ü¶</mo>
    <msub>
     <mi>z</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Œ¶</ci>
     <list>
      <ci>eE</ci>
      <ci>h</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">maps-to</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi_{{\mathrm{eE}},h}:z_{k}\mapsto z_{k+1}
  </annotation>
 </semantics>
</math>

 of the explicit Euler method is <strong>not</strong> area-preserving; viz.,</p>

<p>

<math display="block" id="Geometric_integrator:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <mfrac>
       <mo>‚àÇ</mo>
       <mrow>
        <mo>‚àÇ</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>q</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>p</mi>
          <mn>0</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <msub>
       <mi mathvariant="normal">Œ¶</mi>
       <mrow>
        <mi>eE</mi>
        <mo>,</mo>
        <mi>h</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>z</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>|</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>h</mi>
         <mo>;</mo>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>h</mi>
          <mrow>
           <mi>cos</mi>
           <msub>
            <mi>q</mi>
            <mn>0</mn>
           </msub>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>|</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>h</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mi>cos</mi>
       <msub>
        <mi>q</mi>
        <mn>0</mn>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <determinant></determinant>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Œ¶</ci>
        <list>
         <ci>eE</ci>
         <ci>h</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <determinant></determinant>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <ci>h</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>h</ci>
          <apply>
           <cos></cos>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>q</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det\frac{\partial}{\partial(q_{0},p_{0})}\Phi_{{\mathrm{eE}},h}(z_{0})=\begin%
{vmatrix}1&h;\\
-h\cos q_{0}&1\end{vmatrix}=1+h^{2}\cos q_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>A similar calculation can be carried out for the implicit Euler method, where the determinant is</p>

<p>

<math display="block" id="Geometric_integrator:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <mfrac>
       <mo>‚àÇ</mo>
       <mrow>
        <mo>‚àÇ</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>q</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>p</mi>
          <mn>0</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <msub>
       <mi mathvariant="normal">Œ¶</mi>
       <mrow>
        <mi>iE</mi>
        <mo>,</mo>
        <mi>h</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>z</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>h</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mi>cos</mi>
         <msub>
          <mi>q</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <determinant></determinant>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Œ¶</ci>
       <list>
        <ci>iE</ci>
        <ci>h</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det\frac{\partial}{\partial(q_{0},p_{0})}\Phi_{{\mathrm{iE}},h}(z_{0})=(1+h^{%
2}\cos q_{1})^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>However, the symplectic Euler method <strong>is</strong> area-preserving:</p>

<p>

<math display="block" id="Geometric_integrator:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mi>h</mi>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mo>‚àÇ</mo>
      <mrow>
       <mo>‚àÇ</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>q</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>p</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <msub>
      <mi mathvariant="normal">Œ¶</mi>
      <mrow>
       <mi>sE</mi>
       <mo>,</mo>
       <mi>h</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>z</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>h</mi>
          <mrow>
           <mi>cos</mi>
           <msub>
            <mi>q</mi>
            <mn>0</mn>
           </msub>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>h</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <apply>
      <divide></divide>
      <partialdiff></partialdiff>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Œ¶</ci>
      <list>
       <ci>sE</ci>
       <ci>h</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>h</ci>
        <apply>
         <cos></cos>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}1&-h\\
0&1\end{pmatrix}\frac{\partial}{\partial(q_{0},p_{0})}\Phi_{{\mathrm{sE}},h}(z%
_{0})=\begin{pmatrix}1&0\\
-h\cos q_{0}&1\end{pmatrix},
  </annotation>
 </semantics>
</math>

</p>

<p>thus 

<math display="inline" id="Geometric_integrator:36">
 <semantics>
  <mrow>
   <mrow>
    <mo>det</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo>‚àÇ</mo>
       <msub>
        <mi mathvariant="normal">Œ¶</mi>
        <mrow>
         <mi>sE</mi>
         <mo>,</mo>
         <mi>h</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>/</mo>
      <mrow>
       <mo>‚àÇ</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>q</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>p</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <determinant></determinant>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Œ¶</ci>
        <list>
         <ci>sE</ci>
         <ci>h</ci>
        </list>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(\partial\Phi_{{\mathrm{sE}},h}/\partial(q_{0},p_{0}))=1
  </annotation>
 </semantics>
</math>

. The implicit midpoint rule has similar geometric properties.</p>

<p>To summarize: the pendulum example shows that, besides the explicit and implicit Euler methods not being good choices of method to solve the problem, the symplectic Euler method and implicit midpoint rule agree well with the exact flow of the system, with the midpoint rule agreeing more closely. Furthermore, these latter two methods are area-preserving, just as the exact flow is; they are two examples of geometric (in fact, <a href="symplectic_integrator" title="wikilink">symplectic</a>) integrators.</p>
<h2 id="moving-frame-method">Moving frame method</h2>

<p>The <a href="moving_frame" title="wikilink">moving frame</a> method can be used to construct numerical methods which preserve <a href="Lie_group" title="wikilink">Lie</a> <a href="Symmetry_group" title="wikilink">symmetries</a> of the ODE. Existing methods such as <a class="uri" href="Runge-Kutta" title="wikilink">Runge-Kutta</a> can be modified using moving frame method to produce invariant versions.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Energy_drift" title="wikilink">Energy drift</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<ul>
<li>Ernst Hairer, Christian Lubich and Gerhard Wanner, <em>Geometric Numerical Integration: Structure-Preserving Algorithms for Ordinary Differential Equations.</em> Springer, Berlin, 2002. ISBN 3-540-43003-2.</li>
<li>Ben Leimkuhler and Sebastian Reich, <em>Simulating Hamiltonian Dynamics.</em> Cambridge University Press, 2005. ISBN 0-521-77290-7.</li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://www.math.ohio-state.edu/~pwkim/invode.pdf">Invariantization of Numerical Schemes Using Moving Frames</a>, Pilwon Kim, 2006, BIT Numerical Mathematics, 2007 ‚Äì Springer<a href="#fnref1">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

   Montgomery curve      Montgomery curve   In mathematics the Montgomery curve is a form of elliptic curve , different from the usual Weierstrass form , introduced by Peter L. Montgomery in 1987. 1 It is used for certain computations, and in particular in different cryptography applications.  Definition  A Montgomery curve over a field    K   K   K   is defined by the equation :      M   A  ,  B      subscript  M   A  B     M_{A,B}        B   y  2    =    x  3   +   A   x  2    +  x         B   superscript  y  2       superscript  x  3     A   superscript  x  2    x     By^{2}=x^{3}+Ax^{2}+x     for certain    A  ,   B  ∈  K      A    B  normal-∈  K     A,B∈K   and with .  Generally this curve is considered over a finite field  K (for example over a finite field of   q   q   q    elements , ) with characteristic different from 2 and with   but they are also considered over the rationals with the same restrictions for   A   A   A   and   B   B   B   .  Montgomery arithmetic  It is possible to do some "operations" between the points of an elliptic curve: "adding" two points    P  ,  Q     P  Q    P,Q   consists on finding a third one   R   R   R   such that    R  =   P  +  Q       R    P  Q     R=P+Q   ; "doubling" a point consists on computing      [  2  ]   P   =   P  +  P          delimited-[]  2   P     P  P     [2]P=P+P   (For more information about operations see The group law ) and below.  A point    P  =   (  x  ,  y  )       P   x  y     P=(x,y)   on the elliptic curve in the Montgomery form     B   y  2    =    x  3   +   A   x  2    +  x         B   superscript  y  2       superscript  x  3     A   superscript  x  2    x     By^{2}=x^{3}+Ax^{2}+x   can be represented in Montgomery coordinates    P  =   (  X  :  Z  )      fragments  P    fragments  normal-(  X  normal-:  Z  normal-)     P=(X:Z)   , where    P  =   (  X  :  Z  )      fragments  P    fragments  normal-(  X  normal-:  Z  normal-)     P=(X:Z)   are projective coordinates and    x  =   X  /  Z       x    X  Z     x=X/Z   for    Z  ≠  0      Z  0    Z\neq 0   .  Notice that this kind of representation for a point loses information: indeed, in this case, there is no distinction between the affine points     (  x  ,  y  )     x  y    (x,y)   and    (  x  ,   -  y   )     x    y     (x,-y)   because they are both given by the point    (   X  :  Z   )     normal-:  X  Z    (X:Z)   . However, with this representation it is possible to obtain multiples of points, that is, given    P  =   (  X  :  Z  )      fragments  P    fragments  normal-(  X  normal-:  Z  normal-)     P=(X:Z)   , to compute     [  n  ]   P  =   (   X  n   :   Z  n   )      fragments   fragments  normal-[  n  normal-]   P    fragments  normal-(   subscript  X  n   normal-:   subscript  Z  n   normal-)     [n]P=(X_{n}:Z_{n})   .  Now, considering the two points     P  n   =   [  n  ]   P  =   (   X  n   :   Z  n   )      fragments   subscript  P  n     fragments  normal-[  n  normal-]   P    fragments  normal-(   subscript  X  n   normal-:   subscript  Z  n   normal-)     P_{n}=[n]P=(X_{n}:Z_{n})   and     P  m   =   [  m  ]   P  =   (   X  m   :   Z  m   )      fragments   subscript  P  m     fragments  normal-[  m  normal-]   P    fragments  normal-(   subscript  X  m   normal-:   subscript  Z  m   normal-)     P_{m}=[m]P=(X_{m}:Z_{m})   : their sum is given by the point     P   m  +  n    =   P  m   +   P  n   =   (   X   m  +  n    :   Z   m  +  n    )      fragments   subscript  P    m  n      subscript  P  m     subscript  P  n     fragments  normal-(   subscript  X    m  n    normal-:   subscript  Z    m  n    normal-)     P_{m+n}=P_{m}+P_{n}=(X_{m+n}:Z_{m+n})   whose coordinates are:       X   m  +  n    =    Z   m  -  n      (     (    X  m   -   Z  m    )    (    X  n   +   Z  n    )    +    (    X  m   +   Z  m    )    (    X  n   -   Z  n    )     )   2         subscript  X    m  n       subscript  Z    m  n     superscript         subscript  X  m    subscript  Z  m       subscript  X  n    subscript  Z  n          subscript  X  m    subscript  Z  m       subscript  X  n    subscript  Z  n      2      X_{m+n}=Z_{m-n}((X_{m}-Z_{m})(X_{n}+Z_{n})+(X_{m}+Z_{m})(X_{n}-Z_{n}))^{2}        Z   m  +  n    =    X   m  -  n      (     (    X  m   -   Z  m    )    (    X  n   +   Z  n    )    -    (    X  m   +   Z  m    )    (    X  n   -   Z  n    )     )   2         subscript  Z    m  n       subscript  X    m  n     superscript         subscript  X  m    subscript  Z  m       subscript  X  n    subscript  Z  n          subscript  X  m    subscript  Z  m       subscript  X  n    subscript  Z  n      2      Z_{m+n}=X_{m-n}((X_{m}-Z_{m})(X_{n}+Z_{n})-(X_{m}+Z_{m})(X_{n}-Z_{n}))^{2}     If    m  =  n      m  n    m=n   , then the operation becomes a "doubling"; the coordinates of     [  2  ]    P  n   =   P  n   +   P  n   =   P   2  n    =   (   X   2  n    :   Z   2  n    )      fragments   fragments  normal-[  2  normal-]    subscript  P  n     subscript  P  n     subscript  P  n     subscript  P    2  n      fragments  normal-(   subscript  X    2  n    normal-:   subscript  Z    2  n    normal-)     [2]P_{n}=P_{n}+P_{n}=P_{2n}=(X_{2n}:Z_{2n})   are given by the following equations:       4   X  n    Z  n    =     (    X  n   +   Z  n    )   2   -    (    X  n   -   Z  n    )   2          4   subscript  X  n    subscript  Z  n       superscript     subscript  X  n    subscript  Z  n    2    superscript     subscript  X  n    subscript  Z  n    2      4X_{n}Z_{n}=(X_{n}+Z_{n})^{2}-(X_{n}-Z_{n})^{2}        X   2  n    =     (    X  n   +   Z  n    )   2     (    X  n   -   Z  n    )   2         subscript  X    2  n       superscript     subscript  X  n    subscript  Z  n    2    superscript     subscript  X  n    subscript  Z  n    2      X_{2n}=(X_{n}+Z_{n})^{2}(X_{n}-Z_{n})^{2}        Z   2  n    =    (   4   X  n    Z  n    )    (     (    X  n   -   Z  n    )   2   +    (    (   A  +  2   )   /  4   )    (   4   X  n    Z  n    )     )         subscript  Z    2  n        4   subscript  X  n    subscript  Z  n       superscript     subscript  X  n    subscript  Z  n    2         A  2   4     4   subscript  X  n    subscript  Z  n         Z_{2n}=(4X_{n}Z_{n})((X_{n}-Z_{n})^{2}+((A+2)/4)(4X_{n}Z_{n}))     The first operation considered above ( addition ) has a time-cost of 3 M +2 S , where M denotes the multiplication between two general elements of the field on which the elliptic curve is defined, while S denotes squaring of a general element of the field.  The second operation (doubling) has a time-cost of 2 M +2 S +1 D , where D denotes the multiplication of a general element by a constant ; notice that the constant is     (   A  +  2   )   /  4        A  2   4    (A+2)/4   , so   A   A   A   can be chosen in order to have a small D .  Algorithm and example  The following algorithm represents a doubling of a point     P  1   =   (   X  1   :   Z  1   )      fragments   subscript  P  1     fragments  normal-(   subscript  X  1   normal-:   subscript  Z  1   normal-)     P_{1}=(X_{1}:Z_{1})   on an elliptic curve in the Montgomery form.  It is assumed that     Z  1   =  1       subscript  Z  1   1    Z_{1}=1   . The cost of this implementation is 1M + 2S + 1*A + 3add + 1*4. Here M denotes the multiplications required, S indicates the squarings, and a refers to the multiplication by A.       X   X  1    =    X  1  2          X   subscript  X  1     superscript   subscript  X  1   2     XX_{1}=X_{1}^{2}\,          X  3   =     (    X   X  1    -  1   )   2         subscript  X  3    superscript      X   subscript  X  1    1   2     X_{3}=(XX_{1}-1)^{2}\,          Z  3   =   4   X  1    (    X   X  1    +   a   X  1    +  1   )         subscript  Z  3     4   subscript  X  1       X   subscript  X  1      a   subscript  X  1    1      Z_{3}=4X_{1}(XX_{1}+aX_{1}+1)\,     Example  Let     P  1   =   (  2  ,   3   )        subscript  P  1    2    3      P_{1}=(2,\sqrt{3})   be a point on the curve     2   y  2    =     x  3   -   x  2    +  x         2   superscript  y  2         superscript  x  3    superscript  x  2    x     2y^{2}=x^{3}-x^{2}+x   . In coordinates    (    X  1   :   Z  1    )     normal-:   subscript  X  1    subscript  Z  1     (X_{1}:Z_{1})   , with     x  1   =    X  1   /   Z  1         subscript  x  1      subscript  X  1    subscript  Z  1      x_{1}=X_{1}/Z_{1}   ,     P  1   =   (  2  :  1  )      fragments   subscript  P  1     fragments  normal-(  2  normal-:  1  normal-)     P_{1}=(2:1)   .  Then:       X   X  1    =   X  1  2   =   4           X   subscript  X  1     superscript   subscript  X  1   2        4     XX_{1}=X_{1}^{2}=4\,          X  3   =    (    X   X  1    -  1   )   2   =   9          subscript  X  3    superscript      X   subscript  X  1    1   2        9     X_{3}=(XX_{1}-1)^{2}=9\,          Z  3   =   4   X  1    (    X   X  1    +   A   X  1    +  1   )    =   24          subscript  Z  3     4   subscript  X  1       X   subscript  X  1      A   subscript  X  1    1         24     Z_{3}=4X_{1}(XX_{1}+AX_{1}+1)=24\,     The result is the point     P  3   =   (   X  3   :   Z  3   )   =   (  9  :  24  )      fragments   subscript  P  3     fragments  normal-(   subscript  X  3   normal-:   subscript  Z  3   normal-)     fragments  normal-(  9  normal-:  24  normal-)     P_{3}=(X_{3}:Z_{3})=(9:24)   such that     P  3   =   2   P  1         subscript  P  3     2   subscript  P  1      P_{3}=2P_{1}   .  Addition  Given two points     P  1   =   (   x  1   ,   y  1   )        subscript  P  1     subscript  x  1    subscript  y  1      P_{1}=(x_{1},y_{1})   ,     P  2   =   (   x  2   ,   y  2   )        subscript  P  2     subscript  x  2    subscript  y  2      P_{2}=(x_{2},y_{2})   on the Montgomery curve    M   A  ,  B      subscript  M   A  B     M_{A,B}   in affine coordinates, the point     P  3   =    P  1   +   P  2         subscript  P  3      subscript  P  1    subscript  P  2      P_{3}=P_{1}+P_{2}   represents, geometrically the third point of intersection between    M   A  ,  B      subscript  M   A  B     M_{A,B}   and the line passing through    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   . It is possible to find the coordinates    (   x  3   ,   y  3   )      subscript  x  3    subscript  y  3     (x_{3},y_{3})   of    P  3     subscript  P  3    P_{3}   , in the following way:  1) consider a generic line     y   =    l  x   +  m       y      l  x   m     ~{}y=lx+m   in the affine plane and let it pass through    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   (impose the condition), in this way, one obtains    l  =     y  2   -   y  1      x  2   -   x  1         l       subscript  y  2    subscript  y  1       subscript  x  2    subscript  x  1       l=\frac{y_{2}-y_{1}}{x_{2}-x_{1}}   and    m  =    y  1   -    (     y  2   -   y  1      x  2   -   x  1     )    x  1         m     subscript  y  1          subscript  y  2    subscript  y  1       subscript  x  2    subscript  x  1      subscript  x  1       m=y_{1}-\left(\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\right)x_{1}   ;  2) intersect the line with the curve    M   A  ,  B      subscript  M   A  B     M_{A,B}   , substituting the    y    y   ~{}y   variable in the curve equation with     y   =    l  x   +  m       y      l  x   m     ~{}y=lx+m   ; the following equation of third degree is obtained:         x  3   +    (   A  -   B   l  2     )    x  2    +    (   1  -   2  B  l  m    )   x    -   B   m  2     =  0           superscript  x  3       A    B   superscript  l  2      superscript  x  2        1    2  B  l  m    x      B   superscript  m  2     0    x^{3}+(A-Bl^{2})x^{2}+(1-2Blm)x-Bm^{2}=0   .  As it has been observed before, this equation has three solutions that correspond to the    x    x   ~{}x   coordinates of    P  1     subscript  P  1    P_{1}   ,    P  2     subscript  P  2    P_{2}   and    P  3     subscript  P  3    P_{3}   . In particular this equation can be re-written as:        (   x  -   x  1    )    (   x  -   x  2    )    (   x  -   x  3    )    =  0          x   subscript  x  1      x   subscript  x  2      x   subscript  x  3     0    (x-x_{1})(x-x_{2})(x-x_{3})=0     3) Comparing the coefficients of the two identical equations given above, in particular the coefficients of the terms of second degree, one gets:        -   x  1    -   x  2   -   x  3    =   A  -   B   l  2              subscript  x  1     subscript  x  2    subscript  x  3      A    B   superscript  l  2       -x_{1}-x_{2}-x_{3}=A-Bl^{2}   .  So,    x  3     subscript  x  3    x_{3}   can be written in terms of    x  1     subscript  x  1    x_{1}   ,    y  1     subscript  y  1    y_{1}   ,    x  2     subscript  x  2    x_{2}   ,    y  2     subscript  y  2    y_{2}   , as:       x  3   =    B    (     y  2   -   y  1      x  2   -   x  1     )   2    -  A  -   x  1   -   x  2         subscript  x  3       B   superscript       subscript  y  2    subscript  y  1       subscript  x  2    subscript  x  1     2    A   subscript  x  1    subscript  x  2      x_{3}=B\left(\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\right)^{2}-A-x_{1}-x_{2}   .  4) To find the    y    y   ~{}y   coordinate of the point    P  3     subscript  P  3    P_{3}   it is sufficient to substitute the value    x  3     subscript  x  3    x_{3}   in the line     y   =    l  x   +  m       y      l  x   m     ~{}y=lx+m   . Notice that this will not give the point    P  3     subscript  P  3    P_{3}   directly. Indeed, with this method one find the coordinates of the point    R    R   ~{}R   such that     R  +   P  1   +   P  2    =   P  ∞         R   subscript  P  1    subscript  P  2     subscript  P      R+P_{1}+P_{2}=P_{\infty}   , but if one needs the resulting point of the sum between    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   , then it is necessary to observe that     R  +   P  1   +   P  2    =   P  ∞         R   subscript  P  1    subscript  P  2     subscript  P      R+P_{1}+P_{2}=P_{\infty}   if and only if     -  R   =    P  1   +   P  2          R      subscript  P  1    subscript  P  2      -R=P_{1}+P_{2}   . So, given the point    R    R   ~{}R   , it is necessary to find    -  R      R    ~{}-R   , but this can be done easily by changing the sign to the    y    y   ~{}y   coordinate of    R    R   ~{}R   . In other words, it will be necessary to change the sign of the    y    y   ~{}y   coordinate obtained by substituting the value    x  3     subscript  x  3    x_{3}   in the equation of the line.  Resuming, the coordinates of the point     P  3   =   (   x  3   ,   y  3   )        subscript  P  3     subscript  x  3    subscript  y  3      P_{3}=(x_{3},y_{3})   ,     P  3   =    P  1   +   P  2         subscript  P  3      subscript  P  1    subscript  P  2      P_{3}=P_{1}+P_{2}   are:       x  3   =     B    (    y  2   -   y  1    )   2      (    x  2   -   x  1    )   2    -  A  -   x  1   -   x  2    =    B    (     x  2    y  1    -    x  1    y  2     )   2      x  1    x  2     (    x  2   -   x  1    )   2            subscript  x  3         B   superscript     subscript  y  2    subscript  y  1    2     superscript     subscript  x  2    subscript  x  1    2    A   subscript  x  1    subscript  x  2             B   superscript       subscript  x  2    subscript  y  1       subscript  x  1    subscript  y  2     2       subscript  x  1    subscript  x  2    superscript     subscript  x  2    subscript  x  1    2        x_{3}=\frac{B(y_{2}-y_{1})^{2}}{(x_{2}-x_{1})^{2}}-A-x_{1}-x_{2}=\frac{B(x_{2}%
 y_{1}-x_{1}y_{2})^{2}}{x_{1}x_{2}(x_{2}-x_{1})^{2}}        y  3   =      (    2   x  1    +   x  2   +  A   )    (    y  2   -   y  1    )      x  2   -   x  1     -    B    (    y  2   -   y  1    )   3      (    x  2   -   x  1    )   3    -   y  1         subscript  y  3             2   subscript  x  1     subscript  x  2   A      subscript  y  2    subscript  y  1        subscript  x  2    subscript  x  1         B   superscript     subscript  y  2    subscript  y  1    3     superscript     subscript  x  2    subscript  x  1    3     subscript  y  1      y_{3}=\frac{(2x_{1}+x_{2}+A)(y_{2}-y_{1})}{x_{2}-x_{1}}-\frac{B(y_{2}-y_{1})^{%
 3}}{(x_{2}-x_{1})^{3}}-y_{1}     Doubling  Given a point    P  1     subscript  P  1    P_{1}   on the Montgomery curve    M   A  ,  B      subscript  M   A  B     M_{A,B}   , the point     [  2  ]    P  1        delimited-[]  2    subscript  P  1     [2]P_{1}   represents geometrically the third point of intersection between the curve and the line tangent to    P  1     subscript  P  1    P_{1}   ; so, to find the coordinates of the point     P  3   =   2   P  1         subscript  P  3     2   subscript  P  1      P_{3}=2P_{1}   it is sufficient to follow the same method given in the addition formula; however, in this case, the line y=lx+m has to be tangent to the curve at    P  1     subscript  P  1    P_{1}   , so, if     M   A  ,  B    :    f   (  x  ,  y  )    =  0      normal-:   subscript  M   A  B        f   x  y    0     M_{A,B}:f(x,y)=0   with       f   (  x  ,  y  )    =     x  3   +   A   x  2    +  x   -   B   y  2           f   x  y         superscript  x  3     A   superscript  x  2    x     B   superscript  y  2       f(x,y)=x^{3}+Ax^{2}+x-By^{2}   ,  then the value of l , which represents the slope of the line, is given by:      l  =   -     ∂  f    ∂  x      ∂  f    ∂  y          l          f     x        f     y        l=-\frac{\frac{\partial f}{\partial x}}{\frac{\partial f}{\partial y}}     by the implicit function theorem .  So    l  =     3   x  1  2    +   2  A   x  1    +  1    2  B   y  1         l        3   superscript   subscript  x  1   2      2  A   subscript  x  1    1     2  B   subscript  y  1       l=\frac{3x_{1}^{2}+2Ax_{1}+1}{2By_{1}}   and the coordinates of the point    P  3     subscript  P  3    P_{3}   ,     P  3   =   2   P  1         subscript  P  3     2   subscript  P  1      P_{3}=2P_{1}   are:       x  3   =    B   l  2    -  A  -   x  1   -   x  1    =     B    (    3   x  1  2    +   2  A   x  1    +  1   )   2      (   2  B   y  1    )   2    -  A  -   x  1   -   x  1    =     (    x  1  2   -  1   )   2    4  B   y  1  2     =     (    x  1  2   -  1   )   2    4   x  1    (    x  1  2   +   A   x  1    +  1   )            subscript  x  3       B   superscript  l  2    A   subscript  x  1    subscript  x  1               B   superscript      3   superscript   subscript  x  1   2      2  A   subscript  x  1    1   2     superscript    2  B   subscript  y  1    2    A   subscript  x  1    subscript  x  1            superscript     superscript   subscript  x  1   2   1   2     4  B   superscript   subscript  y  1   2             superscript     superscript   subscript  x  1   2   1   2     4   subscript  x  1      superscript   subscript  x  1   2     A   subscript  x  1    1        x_{3}=Bl^{2}-A-x_{1}-x_{1}=\frac{B(3x_{1}^{2}+2Ax_{1}+1)^{2}}{(2By_{1})^{2}}-A%
 -x_{1}-x_{1}=\frac{(x_{1}^{2}-1)^{2}}{4By_{1}^{2}}=\frac{(x_{1}^{2}-1)^{2}}{4x%
 _{1}(x_{1}^{2}+Ax_{1}+1)}        y  3   =     (    2   x  1    +   x  1   +  A   )   l   -   B   l  3    -   y  1    =      (    2   x  1    +   x  1   +  A   )    (    3   x  1    2    +   2  A   x  1    +  1   )     2  B   y  1     -    B    (    3   x  1    2    +   2  A   x  1    +  1   )   3      (   2  B   y  1    )   3    -   y  1           subscript  y  3           2   subscript  x  1     subscript  x  1   A   l     B   superscript  l  3     subscript  y  1                   2   subscript  x  1     subscript  x  1   A       3   superscript   subscript  x  1   2      2  A   subscript  x  1    1      2  B   subscript  y  1         B   superscript      3   superscript   subscript  x  1   2      2  A   subscript  x  1    1   3     superscript    2  B   subscript  y  1    3     subscript  y  1       y_{3}=(2x_{1}+x_{1}+A)l-Bl^{3}-y_{1}=\frac{(2x_{1}+x_{1}+A)(3{x_{1}}^{2}+2Ax_{%
 1}+1)}{2By_{1}}-\frac{B(3{x_{1}}^{2}+2Ax_{1}+1)^{3}}{(2By_{1})^{3}}-y_{1}   .  Equivalence with twisted Edwards curves  Let   K   K   K   be a field with characteristic different from 2.  Let    M   A  ,  B      subscript  M   A  B     M_{A,B}   be an elliptic curve in the Montgomery form:      M   A  ,  B      subscript  M   A  B     M_{A,B}        B   v  2    =    u  3   +   A   u  2    +  u         B   superscript  v  2       superscript  u  3     A   superscript  u  2    u     Bv^{2}=u^{3}+Au^{2}+u     with    A  ∈   K  \   {   -  2   ,  2  }        A   normal-\  K     2   2      A\in K\backslash\{-2,2\}   ,    B  ∈   K  \   {  0  }        B   normal-\  K   0      B\in K\backslash\{0\}     and let    E   a  ,  d      subscript  E   a  d     E_{a,d}   be an elliptic curve in the twisted Edwards form:         E   a  ,  d     :     a   x  2    +   y  2    =   1  +   d   x  2    y  2       ,     normal-:   subscript  E   a  d          a   superscript  x  2     superscript  y  2      1    d   superscript  x  2    superscript  y  2        E_{a,d}\ :\ ax^{2}+y^{2}=1+dx^{2}y^{2},\,     with     a  ,  d   ∈   K  \   {  0  }         a  d    normal-\  K   0      a,d\in K\backslash\{0\}   ,    a  ≠  d      a  d    a\neq d   .  The following theorem shows the birational equivalence between Montgomery curves and twisted Edwards curves: 2  Theorem (i) Every twisted Edwards curve is birationally equivalent to a Montgomery curve over   K   K   K   . In particular, the twisted Edwards curve    E   a  ,  d      subscript  E   a  d     E_{a,d}   is birationally equivalent to the Montgomery curve    M   A  ,  B      subscript  M   A  B     M_{A,B}   where    A  =    2   (   a  +  d   )     a  -  d        A      2    a  d      a  d      A=\frac{2(a+d)}{a-d}   , and    B  =   4   a  -  d        B    4    a  d      B=\frac{4}{a-d}   .  The map :       ψ   :    E   a  ,  d    →   M   A  ,  B        normal-:  ψ   normal-→   subscript  E   a  d     subscript  M   A  B       \psi\,:\,E_{a,d}\rightarrow M_{A,B}          (  x  ,  y  )   ↦   (  u  ,  v  )   =   (    1  +  y    1  -  y    ,    1  +  y     (   1  -  y   )   x    )        maps-to   x  y    u  v             1  y     1  y        1  y       1  y   x        (x,y)\mapsto(u,v)=\left(\frac{1+y}{1-y},\frac{1+y}{(1-y)x}\right)     is a birational equivalence from    E   a  ,  d      subscript  E   a  d     E_{a,d}   to    M   A  ,  B      subscript  M   A  B     M_{A,B}   , with inverse:      ψ   -  1      superscript  ψ    1     \psi^{-1}        M   A  ,  B    →   E   a  ,  d       normal-→   subscript  M   A  B     subscript  E   a  d      M_{A,B}\rightarrow E_{a,d}           (  u  ,  v  )   ↦   (  x  ,  y  )   =   (   u  v   ,    u  -  1    u  +  1    )    ,    a  =    A  +  2   B    ,   d  =    A  -  2   B        formulae-sequence     maps-to   u  v    x  y           u  v       u  1     u  1        formulae-sequence    a      A  2   B      d      A  2   B       (u,v)\mapsto(x,y)=\left(\frac{u}{v},\frac{u-1}{u+1}\right),a=\frac{A+2}{B},d=%
 \frac{A-2}{B}     Notice that this equivalence between the two curves is not valid everywhere: indeed the map   ψ   ψ   \psi   is not defined at the points    v  =  0      v  0    v=0   or     u  +  1   =  0        u  1   0    u+1=0   of the    M   A  ,  B      subscript  M   A  B     M_{A,B}   .  Equivalence with Weierstrass curves  Any elliptic curve can be written in Weierstrass form.  So, the elliptic curve in the Montgomery form      M   A  ,  B      subscript  M   A  B     M_{A,B}        B   y  2    =    x  3   +   A   x  2    +  x         B   superscript  y  2       superscript  x  3     A   superscript  x  2    x     By^{2}=x^{3}+Ax^{2}+x   ,  can be transformed in the following way: divide each term of the equation for    M   A  ,  B      subscript  M   A  B     M_{A,B}   by    B  3     superscript  B  3    B^{3}   , and substitute the variables x and y , with    u  =   x  B       u    x  B     u=\frac{x}{B}   and    v  =   y  B       v    y  B     v=\frac{y}{B}   respectively, to get the equation       v  2   =    u  3   +    A  B    u  2    +    1   B  2    u         superscript  v  2      superscript  u  3       A  B    superscript  u  2        1   superscript  B  2    u      v^{2}=u^{3}+\frac{A}{B}u^{2}+\frac{1}{B^{2}}u   .  To obtain a short Weierstrass form from here, it is sufficient to replace u with the variable    t  -   A   3  B        t    A    3  B      t-\frac{A}{3B}   :       v  2   =     (   t  -   A   3  B     )   3   +    A  B     (   t  -   A   3  B     )   2    +    1   B  2     (   t  -   A   3  B     )          superscript  v  2      superscript    t    A    3  B     3       A  B    superscript    t    A    3  B     2        1   superscript  B  2      t    A    3  B         v^{2}=\left(t-\frac{A}{3B}\right)^{3}+\frac{A}{B}\left(t-\frac{A}{3B}\right)^{%
 2}+\frac{1}{B^{2}}\left(t-\frac{A}{3B}\right)   ;  finally, this gives the equation:       v  2   =    t  3   +    (    3  -   A  2     3   B  2     )   t   +   (     2   A  3    -   9  A     27   B  3     )         superscript  v  2      superscript  t  3         3   superscript  A  2      3   superscript  B  2     t         2   superscript  A  3      9  A      27   superscript  B  3        v^{2}=t^{3}+\left(\frac{3-A^{2}}{3B^{2}}\right)t+\left(\frac{2A^{3}-9A}{27B^{3%
 }}\right)   .  Hence the mapping is given as     ψ   ψ   \psi        M   A  ,  B    →  E     normal-→   subscript  M   A  B    E    M_{A,B}\rightarrow E           (  x  ,  y  )   ↦   (  u  ,  v  )   =   (    x  B   +   A   3  B     ,   y  B   )    ,    a  =    3  -   A  2     3   B  2      ,   b  =     2   A  3    -   9  A     27   B  3          formulae-sequence     maps-to   x  y    u  v             x  B     A    3  B       y  B       formulae-sequence    a      3   superscript  A  2      3   superscript  B  2        b        2   superscript  A  3      9  A      27   superscript  B  3         (x,y)\mapsto(u,v)=\left(\frac{x}{B}+\frac{A}{3B},\frac{y}{B}\right),a=\frac{3-%
 A^{2}}{3B^{2}},b=\frac{2A^{3}-9A}{27B^{3}}     See also   Curve25519  Table of costs of operations in elliptic curves , information about the running-time required in a specific case   Notes  References       External links   Genus-1 curves over large-characteristic fields   "  Category:Elliptic curves  Category:Elliptic curve cryptography     ↩  ↩     
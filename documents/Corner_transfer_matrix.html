<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1536">Corner transfer matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Corner transfer matrix</h1>
<hr/>

<p>In <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>, the <strong>corner transfer matrix</strong> describes the effect of adding a quadrant to a lattice. Introduced by <a href="Rodney_Baxter" title="wikilink">Rodney Baxter</a> in 1968 as an extension of the Kramers-Wannier row-to-row transfer matrix, it provides a powerful method of studying lattice models. Calculations with corner transfer matrices led Baxter to the exact solution of the <a href="hard_hexagon_model" title="wikilink">hard hexagon model</a> in 1980.</p>
<h2 id="definition">Definition</h2>

<p>Consider an IRF (interaction-round-a-face) model, i.e. a square lattice model with a <a href="Spin_(physics)" title="wikilink">spin</a> σ<sub><em>i</em></sub> assigned to each site <em>i</em> and interactions limited to spins around a common face. Let the total energy be given by</p>

<p>

<math display="block" id="Corner_transfer_matrix:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mrow>
           <mi>a</mi>
           <mi>l</mi>
           <mi>l</mi>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mi>f</mi>
           <mi>a</mi>
           <mi>c</mi>
           <mi>e</mi>
           <mi>s</mi>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
     </munder>
     <mrow>
      <mi>ϵ</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>σ</mi>
        <mi>i</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>σ</mi>
        <mi>j</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>σ</mi>
        <mi>k</mi>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>σ</mi>
        <mi>l</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <ci>STACKED</ci>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>l</ci>
        <ci>l</ci>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <ci>a</ci>
        <ci>c</ci>
        <ci>e</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>ϵ</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>l</ci>
       </apply>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=\sum_{all\atop faces}\epsilon\left(\sigma_{i},\sigma_{j},\sigma_{k},\sigma_{%
l}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where for each face the surrounding sites <em>i</em>, <em>j</em>, <em>k</em> and <em>l</em> are arranged as follows:</p>
<figure><b>(Figure)</b>
<figcaption>Arrangement of sites around a face</figcaption>
</figure>

<p>For a lattice with <em>N</em> sites, the <a href="Partition_function_(statistical_mechanics)" title="wikilink">partition function</a> is</p>

<p>

<math display="block" id="Corner_transfer_matrix:1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Z</mi>
     <mi>N</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mrow>
           <mi>a</mi>
           <mi>l</mi>
           <mi>l</mi>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mi>s</mi>
           <mi>p</mi>
           <mi>i</mi>
           <mi>n</mi>
           <mi>s</mi>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
     </munder>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mrow>
            <mi>a</mi>
            <mi>l</mi>
            <mi>l</mi>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <mi>f</mi>
            <mi>a</mi>
            <mi>c</mi>
            <mi>e</mi>
            <mi>s</mi>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
      </munder>
      <mrow>
       <mi>w</mi>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>σ</mi>
         <mi>i</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>σ</mi>
         <mi>j</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>σ</mi>
         <mi>k</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>σ</mi>
         <mi>l</mi>
        </msub>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <ci>N</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <ci>STACKED</ci>
       <apply>
        <times></times>
        <ci>a</ci>
        <ci>l</ci>
        <ci>l</ci>
       </apply>
       <apply>
        <times></times>
        <ci>s</ci>
        <ci>p</ci>
        <ci>i</ci>
        <ci>n</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <ci>STACKED</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>l</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <ci>a</ci>
         <ci>c</ci>
         <ci>e</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>w</ci>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>l</ci>
        </apply>
       </vector>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{N}=\sum_{all\atop spins}\prod_{all\atop faces}w\left(\sigma_{i},\sigma_{j},%
\sigma_{k},\sigma_{l}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where the sum is over all possible spin configurations and <em>w</em> is the Boltzmann weight</p>

<p>

<math display="block" id="Corner_transfer_matrix:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>j</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>k</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>l</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mrow>
         <mrow>
          <mi>ϵ</mi>
          <mrow>
           <mo>(</mo>
           <msub>
            <mi>σ</mi>
            <mi>i</mi>
           </msub>
           <mo>,</mo>
           <msub>
            <mi>σ</mi>
            <mi>j</mi>
           </msub>
           <mo>,</mo>
           <msub>
            <mi>σ</mi>
            <mi>k</mi>
           </msub>
           <mo>,</mo>
           <msub>
            <mi>σ</mi>
            <mi>l</mi>
           </msub>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>/</mo>
         <msub>
          <mi>k</mi>
          <mi>B</mi>
         </msub>
        </mrow>
        <mi>T</mi>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>w</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>l</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>ϵ</ci>
         <vector>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>j</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>l</ci>
          </apply>
         </vector>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w\left(\sigma_{i},\sigma_{j},\sigma_{k},\sigma_{l}\right)=\exp\left(-\epsilon%
\left(\sigma_{i},\sigma_{j},\sigma_{k},\sigma_{l}\right)/k_{B}T\right).
  </annotation>
 </semantics>
</math>

</p>

<p>To simplify the notation, we use a <a href="Ising_model" title="wikilink">ferromagnetic Ising-type lattice</a> where each spin has the value +1 or −1, and the ground state is given by all spins up (i.e. the total energy is minimised when all spins on the lattice have the value +1). We also assume the lattice has 4-fold rotational symmetry (up to boundary conditions) and is reflection-invariant. These simplifying assumptions are not crucial, and extending the definition to the general case is relatively straightforward.</p>

<p>Now consider the lattice quadrant shown below:</p>
<figure><b>(Figure)</b>
<figcaption>Lattice quadrant with ½m(m+1) faces</figcaption>
</figure>

<p>The outer boundary sites, marked by triangles, are assigned their ground state spins (+1 in this case). The sites marked by open circles form the inner boundaries of the quadrant; their associated spin sets are labelled {σ<sub>1</sub>,…,σ<sub><em>m</em></sub>} and {σ'<sub>1</sub>,…,σ'<sub><em>m</em></sub>}, where σ<sub>1</sub> = σ'<sub>1</sub>. There are 2<sup><em>m</em></sup> possible configurations for each inner boundary, so we define a 2<sup><em>m</em></sup>×2<sup><em>m</em></sup> matrix entry-wise by</p>

<p>

<math display="block" id="Corner_transfer_matrix:3">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <msup>
       <mi>σ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>1</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mrow>
            <mi>i</mi>
            <mi>n</mi>
            <mi>t</mi>
            <mi>e</mi>
            <mi>r</mi>
            <mi>i</mi>
            <mi>o</mi>
            <mi>r</mi>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <mi>s</mi>
            <mi>p</mi>
            <mi>i</mi>
            <mi>n</mi>
            <mi>s</mi>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
      </munder>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
        <mstyle scriptlevel="+1">
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mrow>
             <mi>a</mi>
             <mi>l</mi>
             <mi>l</mi>
            </mrow>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mrow>
             <mi>f</mi>
             <mi>a</mi>
             <mi>c</mi>
             <mi>e</mi>
             <mi>s</mi>
            </mrow>
           </mtd>
          </mtr>
         </mtable>
        </mstyle>
       </munder>
       <mrow>
        <mi>w</mi>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>σ</mi>
          <mi>i</mi>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>σ</mi>
          <mi>j</mi>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>σ</mi>
          <mi>k</mi>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>σ</mi>
          <mi>l</mi>
         </msub>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">σ</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <ci>normal-′</ci>
      </apply>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <ci>STACKED</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>n</ci>
         <ci>t</ci>
         <ci>e</ci>
         <ci>r</ci>
         <ci>i</ci>
         <ci>o</ci>
         <ci>r</ci>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <ci>p</ci>
         <ci>i</ci>
         <ci>n</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <ci>STACKED</ci>
         <apply>
          <times></times>
          <ci>a</ci>
          <ci>l</ci>
          <ci>l</ci>
         </apply>
         <apply>
          <times></times>
          <ci>f</ci>
          <ci>a</ci>
          <ci>c</ci>
          <ci>e</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>w</ci>
        <vector>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>j</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>l</ci>
         </apply>
        </vector>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{\sigma|\sigma^{\prime}}=\delta\left(\sigma_{1},\sigma_{1}^{\prime}\right)%
\sum_{interior\atop spins}\prod_{all\atop faces}w\left(\sigma_{i},\sigma_{j},%
\sigma_{k},\sigma_{l}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix <em>A</em>, then, is the corner transfer matrix for the given lattice quadrant. Since the outer boundary spins are fixed and the sum is over all interior spins, each entry of <em>A</em> is a function of the inner boundary spins. The Kronecker delta in the expression ensures that σ<sub>1</sub> = σ'<sub>1</sub>, so by ordering the configurations appropriately we may cast <em>A</em> as a block diagonal matrix:</p>

<p>

<math display="block" id="Corner_transfer_matrix:4">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd></mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msubsup>
          <mi>σ</mi>
          <mn>1</mn>
          <mo>′</mo>
         </msubsup>
         <mo>=</mo>
         <mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mrow>
       </mtd>
       <mtd></mtd>
       <mtd></mtd>
       <mtd></mtd>
       <mtd columnalign="center">
        <mrow>
         <msubsup>
          <mi>σ</mi>
          <mn>1</mn>
          <mo>′</mo>
         </msubsup>
         <mo>=</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="center">
     <mi>A</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
       </mtr>
       <mtr>
        <mtd></mtd>
        <mtd columnalign="center">
         <msub>
          <mi>A</mi>
          <mo>+</mo>
         </msub>
        </mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd></mtd>
       </mtr>
       <mtr>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mo>-</mo>
        </mtd>
        <mtd columnalign="center">
         <mo>-</mo>
        </mtd>
        <mtd columnalign="center">
         <mo>-</mo>
        </mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd columnalign="center">
         <mo>-</mo>
        </mtd>
        <mtd columnalign="center">
         <mo>-</mo>
        </mtd>
        <mtd columnalign="center">
         <mo>-</mo>
        </mtd>
       </mtr>
       <mtr>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
       </mtr>
       <mtr>
        <mtd></mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <msub>
          <mi>A</mi>
          <mo>-</mo>
         </msub>
        </mtd>
        <mtd></mtd>
       </mtr>
       <mtr>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd columnalign="center">
         <mo stretchy="false">|</mo>
        </mtd>
        <mtd></mtd>
        <mtd></mtd>
        <mtd></mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>σ</mi>
          <mn>1</mn>
         </msub>
         <mo>=</mo>
         <mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msub>
          <mi>σ</mi>
          <mn>1</mn>
         </msub>
         <mo>=</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <matrix>
      <matrixrow>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <ci>A</ci>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <ci>normal-|</ci>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
       </matrixrow>
       <matrixrow>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <plus></plus>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <ci>normal-|</ci>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cn type="integer">0</cn>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
       </matrixrow>
       <matrixrow>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <ci>normal-|</ci>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
       </matrixrow>
       <matrixrow>
        <minus></minus>
        <minus></minus>
        <minus></minus>
        <ci>normal-|</ci>
        <minus></minus>
        <minus></minus>
        <minus></minus>
       </matrixrow>
       <matrixrow>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <ci>normal-|</ci>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
       </matrixrow>
       <matrixrow>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cn type="integer">0</cn>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <ci>normal-|</ci>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <minus></minus>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
       </matrixrow>
       <matrixrow>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <ci>normal-|</ci>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">missing-subexpression</csymbol>
        </cerror>
       </matrixrow>
      </matrix>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
      </matrixrow>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
      </matrixrow>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
      </matrixrow>
      <matrixrow>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{cccc}&&\begin{array}[]{ccccc}\sigma_{1}^{\prime}=+1&&&&\sigma_%
{1}^{\prime}=-1\end{array}\\
A&=&\left[\begin{array}[]{ccccccc}&&&|\\
&A_{+}&&|&&0\\
&&&|\\
-&-&-&|&-&-&-\\
&&&|\\
&0&&|&&A_{-}\\
&&&|\end{array}\right]&\begin{array}[]{c}\sigma_{1}=+1\\
\\
\\
\\
\sigma_{1}=-1\end{array}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Corner transfer matrices are related to the partition function in a simple way. In our simplified example, we construct the full lattice from four rotated copies of the lattice quadrant, where the inner boundary spin sets σ, σ', σ" and σ'" are allowed to differ:</p>
<figure><b>(Figure)</b>
<figcaption>Full lattice with 2m(m+1) faces</figcaption>
</figure>

<p>The partition function is then written in terms of the corner transfer matrix <em>A</em> as</p>

<p>

<math display="block" id="Corner_transfer_matrix:5">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Z</mi>
     <mi>N</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>σ</mi>
       <mo>,</mo>
       <msup>
        <mi>σ</mi>
        <mo>′</mo>
       </msup>
       <mo>,</mo>
       <msup>
        <mi>σ</mi>
        <mi>′′</mi>
       </msup>
       <mo>,</mo>
       <msup>
        <mi>σ</mi>
        <mi>′′′</mi>
       </msup>
      </mrow>
     </munder>
     <mrow>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi>σ</mi>
        <mo stretchy="false">|</mo>
        <msup>
         <mi>σ</mi>
         <mo>′</mo>
        </msup>
       </mrow>
      </msub>
      <msub>
       <mi>A</mi>
       <mrow>
        <msup>
         <mi>σ</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">|</mo>
        <msup>
         <mi>σ</mi>
         <mi>′′</mi>
        </msup>
       </mrow>
      </msub>
      <msub>
       <mi>A</mi>
       <mrow>
        <msup>
         <mi>σ</mi>
         <mi>′′</mi>
        </msup>
        <mo stretchy="false">|</mo>
        <msup>
         <mi>σ</mi>
         <mi>′′′</mi>
        </msup>
       </mrow>
      </msub>
      <msub>
       <mi>A</mi>
       <mrow>
        <msup>
         <mi>σ</mi>
         <mi>′′′</mi>
        </msup>
        <mo stretchy="false">|</mo>
        <mi>σ</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mtext>tr</mtext>
     <msup>
      <mi>A</mi>
      <mn>4</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Z</ci>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>σ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>σ</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>σ</ci>
         <ci>′′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>σ</ci>
         <ci>′′′</ci>
        </apply>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">σ</csymbol>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <ci>normal-′</ci>
         </apply>
        </cerror>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <ci>′′</ci>
         </apply>
        </cerror>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <ci>′′</ci>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <ci>′′′</ci>
         </apply>
        </cerror>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>σ</ci>
          <ci>′′′</ci>
         </apply>
         <ci>normal-|</ci>
         <csymbol cd="unknown">σ</csymbol>
        </cerror>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <mtext>tr</mtext>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{N}=\sum_{\sigma,\sigma^{\prime},\sigma^{\prime\prime},\sigma^{\prime\prime%
\prime}}A_{\sigma|\sigma^{\prime}}A_{\sigma^{\prime}|\sigma^{\prime\prime}}A_{%
\sigma^{\prime\prime}|\sigma^{\prime\prime\prime}}A_{\sigma^{\prime\prime%
\prime}|\sigma}=\textrm{tr}A^{4}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="discussion">Discussion</h2>
<h3 id="recursion-relation">Recursion relation</h3>

<p>A corner transfer matrix <em>A</em><sub>2<sup><em>m</em></sup></sub> (defined for an <em>m</em>×<em>m</em> quadrant) may be expressed in terms of smaller corner transfer matrices <em>A</em><sub>2<sup><em>m</em>-1</sup></sub> and <em>A</em><sub>2<sup><em>m</em>-2</sup></sub> (defined for reduced (<em>m</em>-1)×(<em>m</em>-1) and (<em>m</em>-2)×(<em>m</em>-2) quadrants respectively). This recursion relation allows, in principle, the iterative calculation of the corner transfer matrix for any lattice quadrant of finite size.</p>

<p>Like their row-to-row counterparts, corner transfer matrices may be factored into face transfer matrices, which correspond to adding a single face to the lattice. For the lattice quadrant given earlier, the face transfer matrices are of size 2<sup><em>m</em></sup>×2<sup><em>m</em></sup> and defined entry-wise by</p>

<p>

<math display="block" id="Corner_transfer_matrix:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>U</mi>
       <mi>i</mi>
      </msub>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <msup>
       <mi>σ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>1</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mi>i</mi>
       <mo>′</mo>
      </msubsup>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>m</mi>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mi>m</mi>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <ci>i</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">σ</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <ci>normal-′</ci>
      </apply>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>normal-⋯</ci>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>w</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </vector>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>normal-⋯</ci>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>m</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(U_{i}\right)_{\sigma|\sigma^{\prime}}=\delta\left(\sigma_{1},\sigma_{1}^%
{\prime}\right)\cdots\delta\left(\sigma_{i-1},\sigma_{i-1}^{\prime}\right)w%
\left(\sigma_{i},\sigma_{i+1},\sigma_{i}^{\prime},\sigma_{i-1}\right)\delta%
\left(\sigma_{i+1},\sigma_{i+1}^{\prime}\right)\cdots\delta\left(\sigma_{m},%
\sigma_{m}^{\prime}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where 2 ≤ <em>i</em> ≤ <em>m</em>+1. Near the outer boundary, specifically, we have</p>

<p>

<math display="block" id="Corner_transfer_matrix:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>U</mi>
       <mi>m</mi>
      </msub>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <msup>
       <mi>σ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>1</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>m</mi>
      </msub>
      <mo>,</mo>
      <mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mi>m</mi>
       <mo>′</mo>
      </msubsup>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <ci>m</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">σ</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <ci>normal-′</ci>
      </apply>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>normal-⋯</ci>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>w</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>m</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(U_{m}\right)_{\sigma|\sigma^{\prime}}=\delta\left(\sigma_{1},\sigma_{1}^%
{\prime}\right)\cdots\delta\left(\sigma_{m-1},\sigma_{m-1}^{\prime}\right)w%
\left(\sigma_{m},+1,\sigma_{m}^{\prime},\sigma_{m-1}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>U</mi>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <msup>
       <mi>σ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>1</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi mathvariant="normal">⋯</mi>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>m</mi>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mi>m</mi>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>m</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">σ</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <ci>normal-′</ci>
      </apply>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>normal-⋯</ci>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>m</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>w</ci>
     <vector>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>m</ci>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(U_{m+1}\right)_{\sigma|\sigma^{\prime}}=\delta\left(\sigma_{1},\sigma_{1%
}^{\prime}\right)\cdots\delta\left(\sigma_{m},\sigma_{m}^{\prime}\right)w\left%
(+1,+1,+1,\sigma_{m}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>So the corner transfer matrix <em>A</em> factorises as</p>

<p>

<math display="block" id="Corner_transfer_matrix:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mn>2</mn>
     </msub>
     <mi mathvariant="normal">⋯</mi>
     <msub>
      <mi>F</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=F_{2}\cdots F_{m+1},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Corner_transfer_matrix:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>F</mi>
     <mi>j</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>U</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mi mathvariant="normal">⋯</mi>
     <msub>
      <mi>U</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{j}=U_{m+1}\cdots U_{j}.
  </annotation>
 </semantics>
</math>

</p>

<p>Graphically, this corresponds to:</p>
<figure><b>(Figure)</b>
<figcaption>Graphical representation of factorisation</figcaption>
</figure>

<p>We also require the 2<sup><em>m</em></sup>×2<sup><em>m</em></sup> matrices <em>A</em>* and <em>A</em>**, defined entry-wise by</p>

<p>

<math display="block" id="Corner_transfer_matrix:11">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>A</mi>
       <mo>*</mo>
      </msup>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <msup>
       <mi>σ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>1</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <msub>
        <mi>σ</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>σ</mi>
        <mi>m</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>σ</mi>
        <mn>2</mn>
        <mo>′</mo>
       </msubsup>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msubsup>
        <mi>σ</mi>
        <mi>m</mi>
        <mo>′</mo>
       </msubsup>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <times></times>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">σ</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <ci>normal-′</ci>
      </apply>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>m</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>m</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
      </cerror>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(A^{*}\right)_{\sigma|\sigma^{\prime}}=\delta\left(\sigma_{1},\sigma_{1}^%
{\prime}\right)A_{\sigma_{2},\ldots,\sigma_{m}|\sigma_{2}^{\prime},\ldots,%
\sigma_{m}^{\prime}},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>(</mo>
      <msup>
       <mi>A</mi>
       <mrow>
        <mi></mi>
        <mo>*</mo>
        <mo>*</mo>
       </mrow>
      </msup>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>σ</mi>
      <mo stretchy="false">|</mo>
      <msup>
       <mi>σ</mi>
       <mo>′</mo>
      </msup>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>1</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi>δ</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <msubsup>
       <mi>σ</mi>
       <mn>2</mn>
       <mo>′</mo>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <msub>
        <mi>σ</mi>
        <mn>3</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>σ</mi>
        <mi>m</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>σ</mi>
        <mn>3</mn>
        <mo>′</mo>
       </msubsup>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msubsup>
        <mi>σ</mi>
        <mi>m</mi>
        <mo>′</mo>
       </msubsup>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <csymbol cd="latexml">absent</csymbol>
       <times></times>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">σ</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <ci>normal-′</ci>
      </apply>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <ci>δ</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
     </interval>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>m</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">3</cn>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>m</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
      </cerror>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(A^{**}\right)_{\sigma|\sigma^{\prime}}=\delta\left(\sigma_{1},\sigma_{1}%
^{\prime}\right)\delta\left(\sigma_{2},\sigma_{2}^{\prime}\right)A_{\sigma_{3}%
,\ldots,\sigma_{m}|\sigma_{3}^{\prime},\ldots,\sigma_{m}^{\prime}},
  </annotation>
 </semantics>
</math>

</p>

<p>where the <em>A</em> matrices whose entries appear on the RHS are of size 2<sup><em>m</em>-1</sup>×2<sup><em>m</em>-1</sup> and 2<sup><em>m</em>-2</sup>×2<sup><em>m</em>-2</sup> respectively. This is more clearly written as</p>

<p>

<math display="block" id="Corner_transfer_matrix:13">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>A</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>I</mi>
      <mn>2</mn>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>A</mi>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <ci>A</ci>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <ci>A</ci>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{*}=I_{2}\otimes A_{2^{m-1}}=\left[\begin{array}[]{cc}A&0\\
0&A\end{array}\right],
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:14">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mi></mi>
      <mo>*</mo>
      <mo>*</mo>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>I</mi>
      <mn>2</mn>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>I</mi>
      <mn>2</mn>
     </msub>
     <mo>⊗</mo>
     <msub>
      <mi>A</mi>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mi>A</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <csymbol cd="latexml">absent</csymbol>
       <times></times>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <matrix>
       <matrixrow>
        <ci>A</ci>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <ci>A</ci>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <ci>A</ci>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <ci>A</ci>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{**}=I_{2}\otimes I_{2}\otimes A_{2^{m-2}}=\left[\begin{array}[]{cccc}A&0&0&%
0\\
0&A&0&0\\
0&0&A&0\\
0&0&0&A\end{array}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>Now from the definitions of <em>A</em>, <em>A</em>*, <em>A</em>**, <em>U</em><sub><em>i</em></sub> and <em>F</em><sub><em>j</em></sub>, we have</p>

<p>

<math display="block" id="Corner_transfer_matrix:15">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>A</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mn>3</mn>
     </msub>
     <mi mathvariant="normal">⋯</mi>
     <msub>
      <mi>F</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mi></mi>
      <mo>*</mo>
      <mo>*</mo>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mn>4</mn>
     </msub>
     <mi mathvariant="normal">⋯</mi>
     <msub>
      <mi>F</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <times></times>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <csymbol cd="latexml">absent</csymbol>
       <times></times>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{*}=F_{3}\cdots F_{m+1},A^{**}=F_{4}\cdots F_{m+1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:16">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>⇒</mo>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>A</mi>
      <mo>*</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mn>3</mn>
     </msub>
     <msup>
      <mi>A</mi>
      <mrow>
       <mi></mi>
       <mo>*</mo>
       <mo>*</mo>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <ci>normal-⇒</ci>
      <csymbol cd="latexml">absent</csymbol>
      <ci>A</ci>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>F</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <times></times>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <apply>
        <times></times>
        <csymbol cd="latexml">absent</csymbol>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Rightarrow A=F_{2}A^{*},A^{*}=F_{3}A^{**}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:17">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>⇒</mo>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>A</mi>
      <mo>*</mo>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>A</mi>
        <mrow>
         <mi></mi>
         <mo>*</mo>
         <mo>*</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msub>
      <mi>U</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>A</mi>
      <mo>*</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-⇒</ci>
     <csymbol cd="latexml">absent</csymbol>
     <ci>A</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <apply>
         <times></times>
         <csymbol cd="latexml">absent</csymbol>
         <times></times>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>U</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Rightarrow A=A^{*}\left(A^{**}\right)^{-1}U_{2}A^{*},
  </annotation>
 </semantics>
</math>

</p>

<p>which gives the recursion relation for <em>A</em><sub>2<sup><em>m</em></sup></sub> in terms of <em>A</em><sub>2<sup><em>m</em>-1</sup></sub> and <em>A</em><sub>2<sup><em>m</em>-2</sup></sub>.</p>
<h3 id="diagonal-form">Diagonal form</h3>

<p>When using corner transfer matrices to perform calculations, it is both analytically and numerically convenient to work with their diagonal forms instead. To facilitate this, the recursion relation may be rewritten directly in terms of the diagonal forms and eigenvector matrices of <em>A</em>, <em>A</em>* and <em>A</em>**.</p>

<p>Recalling that the lattice in our example is reflection-invariant, in the sense that</p>

<p>

<math display="block" id="Corner_transfer_matrix:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>j</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>k</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>l</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>k</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>j</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>l</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>σ</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>l</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>k</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>σ</mi>
       <mi>j</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>w</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>l</ci>
       </apply>
      </vector>
     </apply>
     <apply>
      <times></times>
      <ci>w</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>l</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>w</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>l</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>j</ci>
       </apply>
      </vector>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w\left(\sigma_{i},\sigma_{j},\sigma_{k},\sigma_{l}\right)=w\left(\sigma_{k},%
\sigma_{j},\sigma_{i},\sigma_{l}\right)=w\left(\sigma_{i},\sigma_{l},\sigma_{k%
},\sigma_{j}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>we see that <em>A</em> is a symmetric matrix (i.e. it is diagonalisable by an <a href="orthogonal_matrix" title="wikilink">orthogonal matrix</a>). So we write</p>

<p>

<math display="block" id="Corner_transfer_matrix:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>α</mi>
      <mi>m</mi>
     </msub>
     <mi>P</mi>
     <msub>
      <mi>A</mi>
      <mi>d</mi>
     </msub>
     <msup>
      <mi>P</mi>
      <mi>T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <ci>m</ci>
     </apply>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\alpha_{m}PA_{d}P^{T},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em><sub><em>d</em></sub> is a diagonal matrix (normalised such that its numerically largest entry is 1), <em>α</em><sub><em>m</em></sub> is the largest eigenvalue of <em>A</em>, and <em>P</em><sup><em>T</em></sup><em>P</em> = <em>I</em>. Likewise for <em>A</em>* and <em>A</em>**, we have</p>

<p>

<math display="block" id="Corner_transfer_matrix:20">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>A</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>α</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <msup>
      <mi>P</mi>
      <mo>*</mo>
     </msup>
     <msubsup>
      <mi>A</mi>
      <mi>d</mi>
      <mo>*</mo>
     </msubsup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>P</mi>
        <mo>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <times></times>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <apply>
       <minus></minus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>d</ci>
      </apply>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <times></times>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{*}=\alpha_{m-1}P^{*}A_{d}^{*}\left(P^{*}\right)^{T},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:21">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mi></mi>
      <mo>*</mo>
      <mo>*</mo>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>α</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
     <msup>
      <mi>P</mi>
      <mrow>
       <mi></mi>
       <mo>*</mo>
       <mo>*</mo>
      </mrow>
     </msup>
     <msubsup>
      <mi>A</mi>
      <mi>d</mi>
      <mrow>
       <mi></mi>
       <mo>*</mo>
       <mo>*</mo>
      </mrow>
     </msubsup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>P</mi>
        <mrow>
         <mi></mi>
         <mo>*</mo>
         <mo>*</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <csymbol cd="latexml">absent</csymbol>
      <times></times>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <apply>
       <minus></minus>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <apply>
       <times></times>
       <csymbol cd="latexml">absent</csymbol>
       <times></times>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <times></times>
       <csymbol cd="latexml">absent</csymbol>
       <times></times>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <apply>
        <times></times>
        <csymbol cd="latexml">absent</csymbol>
        <times></times>
       </apply>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{**}=\alpha_{m-2}P^{**}A_{d}^{**}\left(P^{**}\right)^{T},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em><sub><em>d</em></sub>*, <em>A</em><sub><em>d</em></sub>**, <em>P</em>* and <em>P</em>** are defined in an analogous fashion to <em>A</em>* and <em>A</em>**, i.e. in terms of the smaller (normalised) diagonal forms and (orthogonal) eigenvector matrices of <em>A</em><sub>2<sup><em>m</em>-1</sup></sub> and <em>A</em><sub>2<sup><em>m</em>-2</sup></sub>.</p>

<p>By substituting these diagonalisations into the recursion relation, we obtain</p>

<p>

<math display="block" id="Corner_transfer_matrix:22">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>κ</mi>
     <mi>R</mi>
     <msub>
      <mi>A</mi>
      <mi>d</mi>
     </msub>
     <msup>
      <mi>R</mi>
      <mi>T</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>κ</ci>
     <ci>R</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{t}=\kappa RA_{d}R^{T},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Corner_transfer_matrix:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>α</mi>
       <mi>m</mi>
      </msub>
      <msub>
       <mi>α</mi>
       <mrow>
        <mi>m</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <msubsup>
      <mi>α</mi>
      <mrow>
       <mi>m</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>κ</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <apply>
        <minus></minus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=\frac{\alpha_{m}\alpha_{m-2}}{\alpha_{m-1}^{2}},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:24">
 <semantics>
  <mrow>
   <mrow>
    <mi>R</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>P</mi>
        <mo>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
     <mi>P</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>R</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <times></times>
      </apply>
      <ci>T</ci>
     </apply>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R=\left(P^{*}\right)^{T}P,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Corner_transfer_matrix:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>A</mi>
      <mi>d</mi>
      <mo>*</mo>
     </msubsup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>R</mi>
        <mo>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
      <mi>T</mi>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>A</mi>
        <mi>d</mi>
        <mrow>
         <mi></mi>
         <mo>*</mo>
         <mo>*</mo>
        </mrow>
       </msubsup>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msub>
      <mi>U</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>R</mi>
      <mo>*</mo>
     </msup>
     <msubsup>
      <mi>A</mi>
      <mi>d</mi>
      <mo>*</mo>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>d</ci>
      </apply>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>R</ci>
       <times></times>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <times></times>
        <csymbol cd="latexml">absent</csymbol>
        <times></times>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <times></times>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>d</ci>
      </apply>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{t}=A_{d}^{*}\left(R^{*}\right)^{T}\left(A_{d}^{**}\right)^{-1}U_{2}R^{*}A_{%
d}^{*}.
  </annotation>
 </semantics>
</math>

</p>

<p>Now <em>A</em><sub><em>t</em></sub> is also symmetric, and may be calculated if <em>A</em><sub><em>d</em></sub>*, <em>A</em><sub><em>d</em></sub>** and <em>R</em>* are known; diagonalising <em>A</em><sub><em>t</em></sub> then yields its normalised diagonal form <em>A</em><sub><em>d</em></sub>, its largest eigenvalue <em>κ</em>, and its orthogonal eigenvector matrix <em>R</em>.</p>
<h2 id="applications">Applications</h2>
<h3 id="spin-expectation-value">Spin expectation value</h3>

<p>Corner transfer matrices (or their diagonal forms) may be used to calculate quantities such as the spin <a href="Expected_value" title="wikilink">expectation value</a> at a particular site deep inside the lattice. For the full lattice given earlier, the spin expectation value at the central site is given by</p>

<p>

<math display="block" id="Corner_transfer_matrix:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>⟨</mo>
     <msub>
      <mi>σ</mi>
      <mn>1</mn>
     </msub>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>Z</mi>
       <mi>N</mi>
      </msub>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mrow>
            <mi>a</mi>
            <mi>l</mi>
            <mi>l</mi>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <mi>s</mi>
            <mi>p</mi>
            <mi>i</mi>
            <mi>n</mi>
            <mi>s</mi>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
      </munder>
      <mrow>
       <msub>
        <mi>σ</mi>
        <mn>1</mn>
       </msub>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
         <mstyle scriptlevel="+1">
          <mtable columnspacing="0.4em" rowspacing="0.2ex">
           <mtr>
            <mtd>
             <mrow>
              <mi>a</mi>
              <mi>l</mi>
              <mi>l</mi>
             </mrow>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mrow>
              <mi>f</mi>
              <mi>a</mi>
              <mi>c</mi>
              <mi>e</mi>
              <mi>s</mi>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
         </mstyle>
        </munder>
        <mrow>
         <mi>w</mi>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>σ</mi>
           <mi>i</mi>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>σ</mi>
           <mi>j</mi>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>σ</mi>
           <mi>k</mi>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>σ</mi>
           <mi>l</mi>
          </msub>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Z</ci>
       <ci>N</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <ci>STACKED</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>l</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <ci>p</ci>
         <ci>i</ci>
         <ci>n</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <ci>STACKED</ci>
          <apply>
           <times></times>
           <ci>a</ci>
           <ci>l</ci>
           <ci>l</ci>
          </apply>
          <apply>
           <times></times>
           <ci>f</ci>
           <ci>a</ci>
           <ci>c</ci>
           <ci>e</ci>
           <ci>s</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>w</ci>
         <vector>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>j</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>l</ci>
          </apply>
         </vector>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\sigma_{1}\right\rangle=\frac{1}{Z_{N}}\sum_{all\atop spins}\sigma%
_{1}\prod_{all\atop faces}w\left(\sigma_{i},\sigma_{j},\sigma_{k},\sigma_{l}%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>With the configurations ordered such that <em>A</em> is block diagonal as before, we may define a 2<sup><em>m</em></sup>×2<sup><em>m</em></sup> diagonal matrix</p>

<p>

<math display="block" id="Corner_transfer_matrix:27">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>I</mi>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mi>I</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <ci>I</ci>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>I</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\left[\begin{array}[]{cc}I&0\\
0&-I\end{array}\right],
  </annotation>
 </semantics>
</math>

</p>

<p>such that</p>

<p>

<math display="block" id="Corner_transfer_matrix:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>⟨</mo>
     <msub>
      <mi>σ</mi>
      <mn>1</mn>
     </msub>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mtext>tr</mtext>
      <mi>S</mi>
      <msup>
       <mi>A</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mrow>
      <mtext>tr</mtext>
      <msup>
       <mi>A</mi>
       <mn>4</mn>
      </msup>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mtext>tr</mtext>
      <msubsup>
       <mi>α</mi>
       <mi>m</mi>
       <mn>4</mn>
      </msubsup>
      <mi>P</mi>
      <mi>S</mi>
      <msup>
       <mi>A</mi>
       <mn>4</mn>
      </msup>
      <msup>
       <mi>P</mi>
       <mi>T</mi>
      </msup>
     </mrow>
     <mrow>
      <mtext>tr</mtext>
      <msubsup>
       <mi>α</mi>
       <mi>m</mi>
       <mn>4</mn>
      </msubsup>
      <mi>P</mi>
      <msup>
       <mi>A</mi>
       <mn>4</mn>
      </msup>
      <msup>
       <mi>P</mi>
       <mi>T</mi>
      </msup>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mtext>tr</mtext>
      <mi>S</mi>
      <msubsup>
       <mi>A</mi>
       <mi>d</mi>
       <mn>4</mn>
      </msubsup>
     </mrow>
     <mrow>
      <mtext>tr</mtext>
      <msubsup>
       <mi>A</mi>
       <mi>d</mi>
       <mn>4</mn>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <mtext>tr</mtext>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <mtext>tr</mtext>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <mtext>tr</mtext>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>m</ci>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <ci>P</ci>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>P</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <mtext>tr</mtext>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>m</ci>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <ci>P</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>P</ci>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <mtext>tr</mtext>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>d</ci>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <mtext>tr</mtext>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>d</ci>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\sigma_{1}\right\rangle=\frac{\textrm{tr}SA^{4}}{\textrm{tr}A^{4}}%
=\frac{\textrm{tr}\alpha_{m}^{4}PSA^{4}P^{T}}{\textrm{tr}\alpha_{m}^{4}PA^{4}P%
^{T}}=\frac{\textrm{tr}SA_{d}^{4}}{\textrm{tr}A_{d}^{4}}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="partition-function-per-site">Partition function per site</h3>

<p>Another important quantity for lattice models is the partition function per site, evaluated in the <a href="thermodynamic_limit" title="wikilink">thermodynamic limit</a> and written as</p>

<p>

<math display="block" id="Corner_transfer_matrix:29">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <mi>N</mi>
       <mo>→</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </munder>
     <msup>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>Z</mi>
        <mi>N</mi>
       </msub>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mi>N</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>κ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>N</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Z</ci>
       <ci>N</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=\lim_{N\rightarrow\infty}\left(Z_{N}\right)^{1/N}.
  </annotation>
 </semantics>
</math>

</p>

<p>In our example, this reduces to</p>

<p>

<math display="block" id="Corner_transfer_matrix:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <mi>N</mi>
       <mo>→</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </munder>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mi>α</mi>
         <mi>m</mi>
         <mn>4</mn>
        </msubsup>
        <mtext>tr</mtext>
        <msubsup>
         <mi>A</mi>
         <mi>d</mi>
         <mn>4</mn>
        </msubsup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mi>N</mi>
      </mrow>
     </msup>
    </mrow>
    <mo>∼</mo>
    <msubsup>
     <mi>α</mi>
     <mi>m</mi>
     <mrow>
      <mn>4</mn>
      <mo>/</mo>
      <mi>N</mi>
     </mrow>
    </msubsup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>κ</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-→</ci>
        <ci>N</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>α</ci>
          <ci>m</ci>
         </apply>
         <cn type="integer">4</cn>
        </apply>
        <mtext>tr</mtext>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>A</ci>
          <ci>d</ci>
         </apply>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">4</cn>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=\lim_{N\rightarrow\infty}\left(\alpha_{m}^{4}\textrm{tr}A_{d}^{4}\right%
)^{1/N}\sim\alpha_{m}^{4/N},
  </annotation>
 </semantics>
</math>

</p>

<p>since tr <em>A</em><sub><em>d</em></sub><sup>4</sup> is a convergent sum as <em>m</em> → ∞ and <em>A</em><sub><em>d</em></sub> becomes infinite-dimensional. Furthermore, the number of faces 2<em>m</em>(<em>m</em>+1) approaches the number of sites <em>N</em> in the thermodynamic limit, so we have</p>

<p>

<math display="block" id="Corner_transfer_matrix:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>α</mi>
     <mi>m</mi>
    </msub>
    <mo>∼</mo>
    <msup>
     <mi>κ</mi>
     <mrow>
      <mrow>
       <mi>m</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>m</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>κ</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{m}\sim\kappa^{m\left(m+1\right)/2},
  </annotation>
 </semantics>
</math>

</p>

<p>which is consistent with the earlier equation giving <em>κ</em> as the largest eigenvalue for <em>A</em><sub><em>t</em></sub>. In other words, the partition function per site is given exactly by the diagonalised recursion relation for corner transfer matrices in the thermodynamic limit; this allows <em>κ</em> to be approximated via the iterative process of calculating <em>A</em><sub><em>d</em></sub> for a large lattice.</p>

<p>The matrices involved grow exponentially in size, however, and in actual numerical calculations they must be truncated at each step. One way of doing this is to keep the <em>n</em> largest eigenvalues at each step, for some fixed <em>n</em>. In most cases, the sequence of approximations obtained by taking <em>n</em> = 1,2,3,… converges rapidly, and to the exact value (for an exactly solvable model).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Transfer-matrix_method" title="wikilink">Transfer-matrix method</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Exactly_solvable_models" title="wikilink">Category:Exactly solvable models</a> <a href="Category:Lattice_models" title="wikilink">Category:Lattice models</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a href="Category:Statistical_mechanics" title="wikilink">Category:Statistical mechanics</a></p>
</body>
</html>

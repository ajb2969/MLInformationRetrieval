<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="139">Naive Bayes classifier</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Naive Bayes classifier</h1>
<hr/>

<p>In <a href="machine_learning" title="wikilink">machine learning</a>, <strong>naive Bayes classifiers</strong> are a family of simple <a href="probabilistic_classifier" title="wikilink">probabilistic classifiers</a> based on applying <a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a> with strong (naive) <a href="statistical_independence" title="wikilink">independence</a> assumptions between the features.</p>

<p>Naive Bayes has been studied extensively since the 1950s. It was introduced under a different name into the <a href="information_retrieval" title="wikilink">text retrieval</a> community in the early 1960s,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and remains a popular (baseline) method for <a href="text_categorization" title="wikilink">text categorization</a>, the problem of judging documents as belonging to one category or the other (such as <a href="spam_filtering" title="wikilink">spam or legitimate</a>, sports or politics, etc.) with <a href="bag_of_words" title="wikilink">word frequencies</a> as the features. With appropriate preprocessing, it is competitive in this domain with more advanced methods including <a href="support_vector_machine" title="wikilink">support vector machines</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> It also finds application in automatic <a href="medical_diagnosis" title="wikilink">medical diagnosis</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Naive Bayes classifiers are highly scalable, requiring a number of parameters linear in the number of variables (features/predictors) in a learning problem. <a href="Maximum-likelihood_estimation" title="wikilink">Maximum-likelihood</a> training can be done by evaluating a <a href="closed-form_expression" title="wikilink">closed-form expression</a>,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> which takes <a href="linear_time" title="wikilink">linear time</a>, rather than by expensive <a href="Iterative_method" title="wikilink">iterative approximation</a> as used for many other types of classifiers.</p>

<p>In the <a class="uri" href="statistics" title="wikilink">statistics</a> and <a href="computer_science" title="wikilink">computer science</a> literature, Naive Bayes models are known under a variety of names, including <strong>simple Bayes</strong> and <strong>independence Bayes</strong>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> All these names reference the use of Bayes' theorem in the classifier's decision rule, but naive Bayes is not (necessarily) a <a href="Bayesian_probability" title="wikilink">Bayesian</a> method;<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> <a href="Artificial_Intelligence:_A_Modern_Approach" title="wikilink">Russell and Norvig</a> note that "[naive Bayes] is sometimes called a <strong>Bayesian classifier</strong>, a somewhat careless usage that has prompted true Bayesians to call it the <strong>idiot Bayes</strong> model."<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="introduction">Introduction</h2>

<p>Naive Bayes is a simple technique for constructing classifiers: models that assign class labels to problem instances, represented as vectors of <a href="feature_vector" title="wikilink">feature</a> values, where the class labels are drawn from some finite set. It is not a single <a class="uri" href="algorithm" title="wikilink">algorithm</a> for training such classifiers, but a family of algorithms based on a common principle: all naive Bayes classifiers assume that the value of a particular feature is <a href="Independence_(probability_theory)" title="wikilink">independent</a> of the value of any other feature, given the class variable. For example, a fruit may be considered to be an apple if it is red, round, and about 10 cm in diameter. A naive Bayes classifier considers each of these features to contribute independently to the probability that this fruit is an apple, regardless of any possible <a href="Correlation_and_dependence" title="wikilink">correlations</a> between the color, roundness and diameter features.</p>

<p>For some types of probability models, naive Bayes classifiers can be trained very efficiently in a <a href="supervised_learning" title="wikilink">supervised learning</a> setting. In many practical applications, parameter estimation for naive Bayes models uses the method of <a href="maximum_likelihood" title="wikilink">maximum likelihood</a>; in other words, one can work with the naive Bayes model without accepting <a href="Bayesian_probability" title="wikilink">Bayesian probability</a> or using any Bayesian methods.</p>

<p>Despite their naive design and apparently oversimplified assumptions, naive Bayes classifiers have worked quite well in many complex real-world situations. In 2004, an analysis of the Bayesian classification problem showed that there are sound theoretical reasons for the apparently implausible <a class="uri" href="efficacy" title="wikilink">efficacy</a> of naive Bayes classifiers.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> Still, a comprehensive comparison with other classification algorithms in 2006 showed that Bayes classification is outperformed by other approaches, such as <a href="boosted_trees" title="wikilink">boosted trees</a> or <a href="random_forests" title="wikilink">random forests</a>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>An advantage of naive Bayes is that it only requires a small amount of training data to estimate the parameters necessary for classification.</p>
<h2 id="probabilistic-model">Probabilistic model</h2>

<p>Abstractly, naive Bayes is a conditional probability model: given a problem instance to be classified, represented by a vector 

<math display="inline" id="Naive_Bayes_classifier:0">
 <semantics>
  <mrow>
   <mi>ùê±</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê±</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}=(x_{1},\dots,x_{n})
  </annotation>
 </semantics>
</math>

 representing some 

<math display="inline" id="Naive_Bayes_classifier:1">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 features (independent variables), it assigns to this instance probabilities</p>

<p>

<math display="block" id="Naive_Bayes_classifier:2">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-‚Ä¶</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C_{k}|x_{1},\dots,x_{n})\,
  </annotation>
 </semantics>
</math>

</p>

<p>for each of 

<math display="inline" id="Naive_Bayes_classifier:3">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 possible outcomes or <em>classes</em>.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>The problem with the above formulation is that if the number of features 

<math display="inline" id="Naive_Bayes_classifier:4">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is large or if a feature can take on a large number of values, then basing such a model on probability tables is infeasible. We therefore reformulate the model to make it more tractable. Using <a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a>, the conditional probability can be decomposed as</p>

<p>

<math display="block" id="Naive_Bayes_classifier:5">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>C</mi>
       <mi>k</mi>
      </msub>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùê±</mi>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>C</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùê±</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo rspace="4.2pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>ùê±</ci>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C_{k}|\mathbf{x})=\frac{p(C_{k})\ p(\mathbf{x}|C_{k})}{p(\mathbf{x})}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>In plain English, using <a href="Bayesian_probability" title="wikilink">Bayesian probability</a> terminology, the above equation can be written as</p>

<p>

<math display="block" id="Naive_Bayes_classifier:6">
 <semantics>
  <mrow>
   <mrow>
    <mtext>posterior</mtext>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mtext>prior</mtext>
      <mo>√ó</mo>
      <mtext>likelihood</mtext>
     </mrow>
     <mtext>evidence</mtext>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>posterior</mtext>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <mtext>prior</mtext>
      <mtext>likelihood</mtext>
     </apply>
     <mtext>evidence</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{posterior}=\frac{\mbox{prior}\times\mbox{likelihood}}{\mbox{evidence}}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>In practice, there is interest only in the numerator of that fraction, because the denominator does not depend on 

<math display="inline" id="Naive_Bayes_classifier:7">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 and the values of the features 

<math display="inline" id="Naive_Bayes_classifier:8">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}
  </annotation>
 </semantics>
</math>

 are given, so that the denominator is effectively constant. The numerator is equivalent to the <a href="joint_probability" title="wikilink">joint probability</a> model</p>

<p>

<math display="block" id="Naive_Bayes_classifier:9">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C_{k},x_{1},\dots,x_{n})\,
  </annotation>
 </semantics>
</math>

</p>

<p>which can be rewritten as follows, using the <a href="Chain_rule_(probability)" title="wikilink">chain rule</a> for repeated applications of the definition of <a href="conditional_probability" title="wikilink">conditional probability</a>:</p>

<p>

<math display="inline" id="Naive_Bayes_classifier:10">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(C_{k},x_{1},\dots,x_{n})
  </annotation>
 </semantics>
</math>


</p>

<p>Now the "naive" <a href="conditional_independence" title="wikilink">conditional independence</a> assumptions come into play: assume that each feature 

<math display="inline" id="Naive_Bayes_classifier:11">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}
  </annotation>
 </semantics>
</math>

 is conditionally <a href="statistical_independence" title="wikilink">independent</a> of every other feature 

<math display="inline" id="Naive_Bayes_classifier:12">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{j}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Naive_Bayes_classifier:13">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>‚â†</mo>
   <mi>i</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>j</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j\neq i
  </annotation>
 </semantics>
</math>

, given the category 

<math display="inline" id="Naive_Bayes_classifier:14">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

. This means that</p>

<p>

<math display="block" id="Naive_Bayes_classifier:15">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{i}|C_{k},x_{j})=p(x_{i}|C_{k})\,
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Naive_Bayes_classifier:16">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>j</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{i}|C_{k},x_{j},x_{k})=p(x_{i}|C_{k})\,
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Naive_Bayes_classifier:17">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>j</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>l</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{i}|C_{k},x_{j},x_{k},x_{l})=p(x_{i}|C_{k})\,
  </annotation>
 </semantics>
</math>

,</p>

<p>and so on, for 

<math display="inline" id="Naive_Bayes_classifier:18">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>‚â†</mo>
   <mrow>
    <mi>j</mi>
    <mo>,</mo>
    <mi>k</mi>
    <mo>,</mo>
    <mi>l</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>i</ci>
    <list>
     <ci>j</ci>
     <ci>k</ci>
     <ci>l</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\neq j,k,l
  </annotation>
 </semantics>
</math>

. Thus, the joint model can be expressed as</p>

<p>

<math display="inline" id="Naive_Bayes_classifier:19">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-‚Ä¶</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(C_{k}|x_{1},\dots,x_{n})
  </annotation>
 </semantics>
</math>


</p>

<p>This means that under the above independence assumptions, the conditional distribution over the class variable 

<math display="inline" id="Naive_Bayes_classifier:20">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

 is:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:21">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>Z</mi>
   </mfrac>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-‚Ä¶</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>Z</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C_{k}|x_{1},\dots,x_{n})=\frac{1}{Z}p(C_{k})\prod_{i=1}^{n}p(x_{i}|C_{k})
  </annotation>
 </semantics>
</math>

</p>

<p>where the evidence 

<math display="inline" id="Naive_Bayes_classifier:22">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùê±</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Z</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>ùê±</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z=p(\mathbf{x})
  </annotation>
 </semantics>
</math>

 is a scaling factor dependent only on 

<math display="inline" id="Naive_Bayes_classifier:23">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},\dots,x_{n}
  </annotation>
 </semantics>
</math>

, that is, a constant if the values of the feature variables are known.</p>
<h3 id="constructing-a-classifier-from-the-probability-model">Constructing a classifier from the probability model</h3>

<p>The discussion so far has derived the independent feature model, that is, the naive Bayes <a href="probability_model" title="wikilink">probability model</a>. The naive Bayes <a href="Statistical_classification" title="wikilink">classifier</a> combines this model with a <a href="decision_rule" title="wikilink">decision rule</a>. One common rule is to pick the hypothesis that is most probable; this is known as the <em><a href="maximum_a_posteriori" title="wikilink">maximum a posteriori</a></em> or <em>MAP</em> decision rule. The corresponding classifier, a <a href="Bayes_classifier" title="wikilink">Bayes classifier</a>, is the function that assigns a class label 

<math display="inline" id="Naive_Bayes_classifier:24">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <msub>
    <mi>C</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{y}=C_{k}
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="Naive_Bayes_classifier:25">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 as follows:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:26">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mpadded width="+5pt">
    <munder accentunder="true">
     <mo>argmax</mo>
     <mrow>
      <mi>k</mi>
      <mo>‚àà</mo>
      <mrow>
       <mo stretchy="false">{</mo>
       <mn>1</mn>
       <mo>,</mo>
       <mi mathvariant="normal">‚Ä¶</mi>
       <mo>,</mo>
       <mi>K</mi>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
    </munder>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>y</ci>
    </apply>
    <eq></eq>
    <apply>
     <apply>
      <in></in>
      <ci>k</ci>
      <set>
       <cn type="integer">1</cn>
       <ci>normal-‚Ä¶</ci>
       <ci>K</ci>
      </set>
     </apply>
     <ci>argmax</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{y}=\underset{k\in\{1,\dots,K\}}{\operatorname{argmax}}\ p(C_{k})%
\displaystyle\prod_{i=1}^{n}p(x_{i}|C_{k}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="parameter-estimation-and-event-models">Parameter estimation and event models</h2>

<p>A class' prior may be calculated by assuming equiprobable classes (i.e., priors = 1 / (number of classes)), or by calculating an estimate for the class probability from the training set (i.e., (prior for a given class) = (number of samples in the class) / (total number of samples)). To estimate the parameters for a feature's distribution, one must assume a distribution or generate <a class="uri" href="nonparametric" title="wikilink">nonparametric</a> models for the features from the training set.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>The assumptions on distributions of features are called the <em>event model</em> of the Naive Bayes classifier. For discrete features like the ones encountered in document classification (include spam filtering), <a href="Multinomial_distribution" title="wikilink">multinomial</a> and <a href="Bernoulli_distribution" title="wikilink">Bernoulli</a> distributions are popular. These assumptions lead to two distinct models, which are often confused.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h3 id="gaussian-naive-bayes">Gaussian naive Bayes</h3>

<p>When dealing with continuous data, a typical assumption is that the continuous values associated with each class are distributed according to a <a href="Normal_distribution" title="wikilink">Gaussian</a> distribution. For example, suppose the training data contain a continuous attribute, 

<math display="inline" id="Naive_Bayes_classifier:27">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. We first segment the data by the class, and then compute the mean and <a href="Variance#Estimating_the_variance" title="wikilink">variance</a> of 

<math display="inline" id="Naive_Bayes_classifier:28">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 in each class. Let 

<math display="inline" id="Naive_Bayes_classifier:29">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{c}
  </annotation>
 </semantics>
</math>

 be the mean of the values in 

<math display="inline" id="Naive_Bayes_classifier:30">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 associated with class <em>c</em>, and let 

<math display="inline" id="Naive_Bayes_classifier:31">
 <semantics>
  <msubsup>
   <mi>œÉ</mi>
   <mi>c</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œÉ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{c}
  </annotation>
 </semantics>
</math>

 be the variance of the values in 

<math display="inline" id="Naive_Bayes_classifier:32">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 associated with class <em>c</em>. Then, the probability <em>distribution</em> of some value given a class, 

<math display="inline" id="Naive_Bayes_classifier:33">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>=</mo>
    <mi>v</mi>
    <mo stretchy="false">|</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <eq></eq>
     <csymbol cd="unknown">v</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">c</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x=v|c)
  </annotation>
 </semantics>
</math>

, can be computed by plugging 

<math display="inline" id="Naive_Bayes_classifier:34">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 into the equation for a <a href="Normal_distribution" title="wikilink">Normal distribution</a> parameterized by 

<math display="inline" id="Naive_Bayes_classifier:35">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{c}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Naive_Bayes_classifier:36">
 <semantics>
  <msubsup>
   <mi>œÉ</mi>
   <mi>c</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œÉ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{c}
  </annotation>
 </semantics>
</math>

. That is,</p>

<p>

<math display="block" id="Naive_Bayes_classifier:37">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>=</mo>
    <mi>v</mi>
    <mo stretchy="false">|</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mn>1</mn>
     <msqrt>
      <mrow>
       <mn>2</mn>
       <mi>œÄ</mi>
       <msubsup>
        <mi>œÉ</mi>
        <mi>c</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mpadded>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>v</mi>
         <mo>-</mo>
         <msub>
          <mi>Œº</mi>
          <mi>c</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mn>2</mn>
       <msubsup>
        <mi>œÉ</mi>
        <mi>c</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </mfrac>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <eq></eq>
     <csymbol cd="unknown">v</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">c</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>œÄ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>œÉ</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>v</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Œº</ci>
          <ci>c</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>œÉ</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>c</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x=v|c)=\frac{1}{\sqrt{2\pi\sigma^{2}_{c}}}\,e^{-\frac{(v-\mu_{c})^{2}}{2%
\sigma^{2}_{c}}}
  </annotation>
 </semantics>
</math>

</p>

<p>Another common technique for handling continuous values is to use binning to <a href="Discretization_of_continuous_features" title="wikilink">discretize</a> the feature values, to obtain a new set of Bernoulli-distributed features; some literature in fact suggests that this is necessary to apply naive Bayes, but it is not, and the discretization may <a href="Discretization_error" title="wikilink">throw away discriminative information</a>.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h3 id="multinomial-naive-bayes">Multinomial naive Bayes</h3>

<p>With a multinomial event model, samples (feature vectors) represent the frequencies with which certain events have been generated by a <a href="Multinomial_distribution" title="wikilink">multinomial</a> 

<math display="inline" id="Naive_Bayes_classifier:38">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>p</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>p</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p_{1},\dots,p_{n})
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Naive_Bayes_classifier:39">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{i}
  </annotation>
 </semantics>
</math>

 is the probability that event 

<math display="inline" id="Naive_Bayes_classifier:40">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 occurs (or 

<math display="inline" id="Naive_Bayes_classifier:41">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 such multinomials in the multiclass case). A feature vector 

<math display="inline" id="Naive_Bayes_classifier:42">
 <semantics>
  <mrow>
   <mi>ùê±</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê±</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}=(x_{1},\dots,x_{n})
  </annotation>
 </semantics>
</math>

 is then a <a class="uri" href="histogram" title="wikilink">histogram</a>, with 

<math display="inline" id="Naive_Bayes_classifier:43">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 counting the number of times event 

<math display="inline" id="Naive_Bayes_classifier:44">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 was observed in a particular instance. This is the event model typically used for document classification, with events representing the occurrence of a word in a single document (see <a href="bag_of_words" title="wikilink">bag of words</a> assumption). The likelihood of observing a histogram 

<math display="inline" id="Naive_Bayes_classifier:45">
 <semantics>
  <mi>ùê±</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê±</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Naive_Bayes_classifier:46">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">‚àë</mo>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">‚àè</mo>
      <mi>i</mi>
     </msub>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mrow>
   </mfrac>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mi>i</mi>
   </munder>
   <mmultiscripts>
    <mi>p</mi>
    <mrow>
     <mi>k</mi>
     <mi>i</mi>
    </mrow>
    <none></none>
    <none></none>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </mmultiscripts>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <ci>i</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{x}|C_{k})=\frac{(\sum_{i}x_{i})!}{\prod_{i}x_{i}!}\prod_{i}{p_{ki}}^%
{x_{i}}
  </annotation>
 </semantics>
</math>

</p>

<p>The multinomial naive Bayes classifier becomes a <a href="linear_classifier" title="wikilink">linear classifier</a> when expressed in log-space:<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>

<math display="inline" id="Naive_Bayes_classifier:47">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <log></log>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\log p(C_{k}|\mathbf{x})
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Naive_Bayes_classifier:48">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mi>p</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>C</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <times></times>
     <apply>
      <log></log>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=\log p(C_{k})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Naive_Bayes_classifier:49">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>k</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>log</mi>
    <msub>
     <mi>p</mi>
     <mrow>
      <mi>k</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <log></log>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{ki}=\log p_{ki}
  </annotation>
 </semantics>
</math>

.</p>

<p>If a given class and feature value never occur together in the training data, then the frequency-based probability estimate will be zero. This is problematic because it will wipe out all information in the other probabilities when they are multiplied. Therefore, it is often desirable to incorporate a small-sample correction, called <a class="uri" href="pseudocount" title="wikilink">pseudocount</a>, in all probability estimates such that no probability is ever set to be exactly zero. This way of <a href="regularization_(mathematics)" title="wikilink">regularizing</a> naive Bayes is called <a href="Laplace_smoothing" title="wikilink">Laplace smoothing</a> when the pseudocount is one, and <a href="Lidstone_smoothing" title="wikilink">Lidstone smoothing</a> in the general case.</p>

<p>Rennie <em>et al.</em> discuss problems with the multinomial assumption in the context of document classification and possible ways to alleviate those problems, including the use of <a class="uri" href="tf‚Äìidf" title="wikilink">tf‚Äìidf</a> weights instead of raw term frequencies and document length normalization, to produce a naive Bayes classifier that is competitive with <a href="support_vector_machine" title="wikilink">support vector machines</a>.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>
<h3 id="bernoulli-naive-bayes">Bernoulli naive Bayes</h3>

<p>In the multivariate <a href="Bernoulli_distribution" title="wikilink">Bernoulli</a> event model, features are independent <a href="boolean_data_type" title="wikilink">booleans</a> (binary variables) describing inputs. Like the multinomial model, this model is popular for document classification tasks,<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> where binary term occurrence features are used rather than term frequencies. If 

<math display="inline" id="Naive_Bayes_classifier:50">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 is a boolean expressing the occurrence or absence of the 

<math display="inline" id="Naive_Bayes_classifier:51">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

'th term from the vocabulary, then the likelihood of a document given a class 

<math display="inline" id="Naive_Bayes_classifier:52">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{k}
  </annotation>
 </semantics>
</math>

 is given by<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>

<math display="block" id="Naive_Bayes_classifier:53">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>k</mi>
     <mi>i</mi>
    </mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </msubsup>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo>-</mo>
     <msub>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cn type="integer">1</cn>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathbf{x}|C_{k})=\prod_{i=1}^{n}p_{ki}^{x_{i}}(1-p_{ki})^{(1-x_{i})}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Naive_Bayes_classifier:54">
 <semantics>
  <msub>
   <mi>p</mi>
   <mrow>
    <mi>k</mi>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <apply>
     <times></times>
     <ci>k</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{ki}
  </annotation>
 </semantics>
</math>

 is the probability of class 

<math display="inline" id="Naive_Bayes_classifier:55">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{k}
  </annotation>
 </semantics>
</math>

 generating the term 

<math display="inline" id="Naive_Bayes_classifier:56">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}
  </annotation>
 </semantics>
</math>

. This event model is especially popular for classifying short texts. It has the benefit of explicitly modelling the absence of terms. Note that a naive Bayes classifier with a Bernoulli event model is not the same as a multinomial NB classifier with frequency counts truncated to one.</p>
<h3 id="semi-supervised-parameter-estimation">Semi-supervised parameter estimation</h3>

<p>Given a way to train a naive Bayes classifier from labeled data, it's possible to construct a <a href="semi-supervised_learning" title="wikilink">semi-supervised</a> training algorithm that can learn from a combination of labeled and unlabeled data by running the supervised learning algorithm in a loop:<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>
<dl>
<dd>Given a collection 

<math display="inline" id="Naive_Bayes_classifier:57">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mo>‚äé</mo>
    <mi>U</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <apply>
     <ci>normal-‚äé</ci>
     <ci>L</ci>
     <ci>U</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=L\uplus U
  </annotation>
 </semantics>
</math>

 of labeled samples 

<math display="inline" id="Naive_Bayes_classifier:58">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 and unlabeled samples 

<math display="inline" id="Naive_Bayes_classifier:59">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

, start by training a naive Bayes classifier on 

<math display="inline" id="Naive_Bayes_classifier:60">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

.
</dd>
<dd>Until convergence, do:
<dl>
<dd>Predict class probabilities 

<math display="inline" id="Naive_Bayes_classifier:61">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">|</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(C|x)
  </annotation>
 </semantics>
</math>

 for all examples 

<math display="inline" id="Naive_Bayes_classifier:62">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 in 

<math display="inline" id="Naive_Bayes_classifier:63">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

.
</dd>
<dd>Re-train the model based on the <em>probabilities</em> (not the labels) predicted in the previous step.
</dd>
</dl>
</dd>
</dl>

<p>Convergence is determined based on improvement to the model likelihood 

<math display="inline" id="Naive_Bayes_classifier:64">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">|</mo>
    <mi>Œ∏</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">Œ∏</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(D|\theta)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Naive_Bayes_classifier:65">
 <semantics>
  <mi>Œ∏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ∏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 denotes the parameters of the naive Bayes model.</p>

<p>This training algorithm is an instance of the more general <a href="expectation‚Äìmaximization_algorithm" title="wikilink">expectation‚Äìmaximization algorithm</a> (EM): the prediction step inside the loop is the <em>E</em>-step of EM, while the re-training of naive Bayes is the <em>M</em>-step. The algorithm is formally justified by the assumption that the data are generated by a <a href="mixture_model" title="wikilink">mixture model</a>, and the components of this mixture model are exactly the classes of the classification problem.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p>
<h2 id="discussion">Discussion</h2>

<p>Despite the fact that the far-reaching independence assumptions are often inaccurate, the naive Bayes classifier has several properties that make it surprisingly useful in practice. In particular, the decoupling of the class conditional feature distributions means that each distribution can be independently estimated as a one-dimensional distribution. This helps alleviate problems stemming from the <a href="curse_of_dimensionality" title="wikilink">curse of dimensionality</a>, such as the need for data sets that scale exponentially with the number of features. While naive Bayes often fails to produce a good estimate for the correct class probabilities,<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> this may not be a requirement for many applications. For example, the naive Bayes classifier will make the correct MAP decision rule classification so long as the correct class is more probable than any other class. This is true regardless of whether the probability estimate is slightly, or even grossly inaccurate. In this manner, the overall classifier can be robust enough to ignore serious deficiencies in its underlying naive probability model.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> Other reasons for the observed success of the naive Bayes classifier are discussed in the literature cited below.</p>
<h3 id="relation-to-logistic-regression">Relation to logistic regression</h3>

<p>In the case of discrete inputs (indicator or frequency features for discrete events), naive Bayes classifiers form a <em>generative-discriminative</em> pair with (<a href="multinomial_logistic_regression" title="wikilink">multinomial</a>) <a href="logistic_regression" title="wikilink">logistic regression</a> classifiers: each naive Bayes classifier can be considered a way of fitting a probability model that optimizes the joint likelihood 

<math display="inline" id="Naive_Bayes_classifier:66">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo>,</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <interval closure="open">
     <ci>C</ci>
     <ci>ùê±</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C,\mathbf{x})
  </annotation>
 </semantics>
</math>

, while logistic regression fits the same probability model to optimize the conditional 

<math display="inline" id="Naive_Bayes_classifier:67">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C|\mathbf{x})
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>

<p>The link between the two can be seen by observing that the decision function for naive Bayes (in the binary case) can be rewritten as "predict class 

<math display="inline" id="Naive_Bayes_classifier:68">
 <semantics>
  <msub>
   <mi>C</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{1}
  </annotation>
 </semantics>
</math>

 if the <a class="uri" href="odds" title="wikilink">odds</a> of 

<math display="inline" id="Naive_Bayes_classifier:69">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C_{1}|\mathbf{x})
  </annotation>
 </semantics>
</math>

 exceed those of 

<math display="inline" id="Naive_Bayes_classifier:70">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C_{2}|\mathbf{x})
  </annotation>
 </semantics>
</math>

". Expressing this in log-space gives:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:71">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>C</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>ùê±</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>C</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>ùê±</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mi>log</mi>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <mi>log</mi>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>C</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <log></log>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">x</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <eq></eq>
    <log></log>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <log></log>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <gt></gt>
    <cn type="integer">0</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log\frac{p(C_{1}|\mathbf{x})}{p(C_{2}|\mathbf{x})}=\log p(C_{1}|\mathbf{x})-%
\log p(C_{2}|\mathbf{x})>0
  </annotation>
 </semantics>
</math>

</p>

<p>The left-hand side of this equation is the log-odds, or <em><a class="uri" href="logit" title="wikilink">logit</a></em>, the quantity predicted by the linear model that underlies logistic regression. Since naive Bayes is also a linear model for the two "discrete" event models, it can be reparametrised as a linear function 

<math display="inline" id="Naive_Bayes_classifier:72">
 <semantics>
  <mrow>
   <mrow>
    <mi>b</mi>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>ùê∞</mi>
      <mo>‚ä§</mo>
     </msup>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <plus></plus>
     <ci>b</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùê∞</ci>
       <csymbol cd="latexml">top</csymbol>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b+\mathbf{w}^{\top}x>0
  </annotation>
 </semantics>
</math>

. Obtaining the probabilities is then a matter of applying the <a href="logistic_function" title="wikilink">logistic function</a> to 

<math display="inline" id="Naive_Bayes_classifier:73">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>+</mo>
   <mrow>
    <msup>
     <mi>ùê∞</mi>
     <mo>‚ä§</mo>
    </msup>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>b</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùê∞</ci>
      <csymbol cd="latexml">top</csymbol>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b+\mathbf{w}^{\top}x
  </annotation>
 </semantics>
</math>

, or in the multiclass case, the <a href="softmax_function" title="wikilink">softmax function</a>.</p>

<p>Discriminative classifiers have lower asymptotic error than generative ones; however, research by <a href="Andrew_Ng" title="wikilink">Ng</a> and <a href="Michael_I._Jordan" title="wikilink">Jordan</a> has shown that in some practical cases naive Bayes can outperform logistic regression because it reaches its asymptotic error faster.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>
<h2 id="examples">Examples</h2>
<h3 id="sex-classification">Sex classification</h3>

<p>Problem: classify whether a given person is a male or a female based on the measured features. The features include height, weight, and foot size.</p>
<h4 id="training">Training</h4>

<p>Example training set below.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>sex</p></th>
<th style="text-align: left;">
<p>height (feet)</p></th>
<th style="text-align: left;">
<p>weight (lbs)</p></th>
<th style="text-align: left;">
<p>foot size(inches)</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>180</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>5.92 (5'11")</p></td>
<td style="text-align: left;">
<p>190</p></td>
<td style="text-align: left;">
<p>11</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>5.58 (5'7")</p></td>
<td style="text-align: left;">
<p>170</p></td>
<td style="text-align: left;">
<p>12</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>5.92 (5'11")</p></td>
<td style="text-align: left;">
<p>165</p></td>
<td style="text-align: left;">
<p>10</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>100</p></td>
<td style="text-align: left;">
<p>6</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>5.5 (5'6")</p></td>
<td style="text-align: left;">
<p>150</p></td>
<td style="text-align: left;">
<p>8</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>5.42 (5'5")</p></td>
<td style="text-align: left;">
<p>130</p></td>
<td style="text-align: left;">
<p>7</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>5.75 (5'9")</p></td>
<td style="text-align: left;">
<p>150</p></td>
<td style="text-align: left;">
<p>9</p></td>
</tr>
</tbody>
</table>

<p>The classifier created from the training set using a Gaussian distribution assumption would be (given variances are <em>unbiased</em> <a href="Variance#Population_variance_and_sample_variance" title="wikilink">sample variances</a>):</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>sex</p></th>
<th style="text-align: left;">
<p>mean (height)</p></th>
<th style="text-align: left;">
<p>variance (height)</p></th>
<th style="text-align: left;">
<p>mean (weight)</p></th>
<th style="text-align: left;">
<p>variance (weight)</p></th>
<th style="text-align: left;">
<p>mean (foot size)</p></th>
<th style="text-align: left;">
<p>variance (foot size)</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>5.855</p></td>
<td style="text-align: left;">
<p>3.5033e-02</p></td>
<td style="text-align: left;">
<p>176.25</p></td>
<td style="text-align: left;">
<p>1.2292e+02</p></td>
<td style="text-align: left;">
<p>11.25</p></td>
<td style="text-align: left;">
<p>9.1667e-01</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>5.4175</p></td>
<td style="text-align: left;">
<p>9.7225e-02</p></td>
<td style="text-align: left;">
<p>132.5</p></td>
<td style="text-align: left;">
<p>5.5833e+02</p></td>
<td style="text-align: left;">
<p>7.5</p></td>
<td style="text-align: left;">
<p>1.6667e+00</p></td>
</tr>
</tbody>
</table>

<p>Let's say we have equiprobable classes so P(male)= P(female) = 0.5. This prior probability distribution might be based on our knowledge of frequencies in the larger population, or on frequency in the training set.</p>
<h4 id="testing">Testing</h4>

<p>Below is a sample to be classified as a male or female.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>sex</p></th>
<th style="text-align: left;">
<p>height (feet)</p></th>
<th style="text-align: left;">
<p>weight (lbs)</p></th>
<th style="text-align: left;">
<p>foot size(inches)</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>sample</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>130</p></td>
<td style="text-align: left;">
<p>8</p></td>
</tr>
</tbody>
</table>

<p>We wish to determine which posterior is greater, male or female. For the classification as male the posterior is given by</p>

<p>

<math display="block" id="Naive_Bayes_classifier:74">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mi>o</mi>
    <mi>s</mi>
    <mi>t</mi>
    <mi>e</mi>
    <mi>r</mi>
    <mi>i</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>h</mi>
      <mi>e</mi>
      <mi>i</mi>
      <mi>g</mi>
      <mi>h</mi>
      <mi>t</mi>
      <mo stretchy="false">|</mo>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mi>e</mi>
      <mi>i</mi>
      <mi>g</mi>
      <mi>h</mi>
      <mi>t</mi>
      <mo stretchy="false">|</mo>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mi>o</mi>
      <mi>o</mi>
      <mi>t</mi>
      <mi>s</mi>
      <mi>i</mi>
      <mi>z</mi>
      <mi>e</mi>
      <mo stretchy="false">|</mo>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>e</mi>
     <mi>v</mi>
     <mi>i</mi>
     <mi>d</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>c</mi>
     <mi>e</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>o</ci>
     <ci>s</ci>
     <ci>t</ci>
     <ci>e</ci>
     <ci>r</ci>
     <ci>i</ci>
     <ci>o</ci>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>l</ci>
      <ci>e</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">h</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">g</csymbol>
       <csymbol cd="unknown">h</csymbol>
       <csymbol cd="unknown">t</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">w</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">g</csymbol>
       <csymbol cd="unknown">h</csymbol>
       <csymbol cd="unknown">t</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">f</csymbol>
       <csymbol cd="unknown">o</csymbol>
       <csymbol cd="unknown">o</csymbol>
       <csymbol cd="unknown">t</csymbol>
       <csymbol cd="unknown">s</csymbol>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">z</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>v</ci>
      <ci>i</ci>
      <ci>d</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>c</ci>
      <ci>e</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   posterior(male)=\frac{P(male)\,p(height|male)\,p(weight|male)\,p(footsize|male%
)}{evidence}
  </annotation>
 </semantics>
</math>

</p>

<p>For the classification as female the posterior is given by</p>

<p>

<math display="block" id="Naive_Bayes_classifier:75">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mi>o</mi>
    <mi>s</mi>
    <mi>t</mi>
    <mi>e</mi>
    <mi>r</mi>
    <mi>i</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>f</mi>
      <mi>e</mi>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mi>e</mi>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>h</mi>
      <mi>e</mi>
      <mi>i</mi>
      <mi>g</mi>
      <mi>h</mi>
      <mi>t</mi>
      <mo stretchy="false">|</mo>
      <mi>f</mi>
      <mi>e</mi>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mi>e</mi>
      <mi>i</mi>
      <mi>g</mi>
      <mi>h</mi>
      <mi>t</mi>
      <mo stretchy="false">|</mo>
      <mi>f</mi>
      <mi>e</mi>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>f</mi>
      <mi>o</mi>
      <mi>o</mi>
      <mi>t</mi>
      <mi>s</mi>
      <mi>i</mi>
      <mi>z</mi>
      <mi>e</mi>
      <mo stretchy="false">|</mo>
      <mi>f</mi>
      <mi>e</mi>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>e</mi>
     <mi>v</mi>
     <mi>i</mi>
     <mi>d</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>c</mi>
     <mi>e</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>o</ci>
     <ci>s</ci>
     <ci>t</ci>
     <ci>e</ci>
     <ci>r</ci>
     <ci>i</ci>
     <ci>o</ci>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>e</ci>
      <ci>m</ci>
      <ci>a</ci>
      <ci>l</ci>
      <ci>e</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">P</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">f</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">h</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">g</csymbol>
       <csymbol cd="unknown">h</csymbol>
       <csymbol cd="unknown">t</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">f</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">w</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">g</csymbol>
       <csymbol cd="unknown">h</csymbol>
       <csymbol cd="unknown">t</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">f</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">f</csymbol>
       <csymbol cd="unknown">o</csymbol>
       <csymbol cd="unknown">o</csymbol>
       <csymbol cd="unknown">t</csymbol>
       <csymbol cd="unknown">s</csymbol>
       <csymbol cd="unknown">i</csymbol>
       <csymbol cd="unknown">z</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">f</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <csymbol cd="unknown">m</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <csymbol cd="unknown">l</csymbol>
       <csymbol cd="unknown">e</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>v</ci>
      <ci>i</ci>
      <ci>d</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>c</ci>
      <ci>e</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   posterior(female)=\frac{P(female)\,p(height|female)\,p(weight|female)\,p(%
footsize|female)}{evidence}
  </annotation>
 </semantics>
</math>

</p>

<p>The evidence (also termed normalizing constant) may be calculated:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:76">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mi>v</mi>
   <mi>i</mi>
   <mi>d</mi>
   <mi>e</mi>
   <mi>n</mi>
   <mi>c</mi>
   <mi>e</mi>
   <mo>=</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mi>e</mi>
    <mi>i</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>t</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mi>e</mi>
    <mi>i</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>t</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mi>o</mi>
    <mi>o</mi>
    <mi>t</mi>
    <mi>s</mi>
    <mi>i</mi>
    <mi>z</mi>
    <mi>e</mi>
    <mo stretchy="false">|</mo>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">e</csymbol>
    <csymbol cd="unknown">v</csymbol>
    <csymbol cd="unknown">i</csymbol>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">e</csymbol>
    <csymbol cd="unknown">n</csymbol>
    <csymbol cd="unknown">c</csymbol>
    <csymbol cd="unknown">e</csymbol>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">h</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">g</csymbol>
     <csymbol cd="unknown">h</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">w</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">g</csymbol>
     <csymbol cd="unknown">h</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">f</csymbol>
     <csymbol cd="unknown">o</csymbol>
     <csymbol cd="unknown">o</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <csymbol cd="unknown">s</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">z</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   evidence=P(male)\,p(height|male)\,p(weight|male)\,p(footsize|male)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:77">
 <semantics>
  <mrow>
   <mo>+</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mi>e</mi>
    <mi>i</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>t</mi>
    <mo stretchy="false">|</mo>
    <mi>f</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mi>e</mi>
    <mi>i</mi>
    <mi>g</mi>
    <mi>h</mi>
    <mi>t</mi>
    <mo stretchy="false">|</mo>
    <mi>f</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mi>o</mi>
    <mi>o</mi>
    <mi>t</mi>
    <mi>s</mi>
    <mi>i</mi>
    <mi>z</mi>
    <mi>e</mi>
    <mo stretchy="false">|</mo>
    <mi>f</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>a</mi>
    <mi>l</mi>
    <mi>e</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <plus></plus>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">f</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">h</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">g</csymbol>
     <csymbol cd="unknown">h</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">f</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">w</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">g</csymbol>
     <csymbol cd="unknown">h</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">f</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">f</csymbol>
     <csymbol cd="unknown">o</csymbol>
     <csymbol cd="unknown">o</csymbol>
     <csymbol cd="unknown">t</csymbol>
     <csymbol cd="unknown">s</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">z</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">f</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <csymbol cd="unknown">m</csymbol>
     <csymbol cd="unknown">a</csymbol>
     <csymbol cd="unknown">l</csymbol>
     <csymbol cd="unknown">e</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   +P(female)\,p(height|female)\,p(weight|female)\,p(footsize|female)
  </annotation>
 </semantics>
</math>

</p>

<p>However, given the sample the evidence is a constant and thus scales both posteriors equally. It therefore does not affect classification and can be ignored. We now determine the probability distribution for the sex of the sample.</p>

<p>

<math display="block" id="Naive_Bayes_classifier:78">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>m</mi>
      <mi>a</mi>
      <mi>l</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>l</ci>
      <ci>e</ci>
     </apply>
    </apply>
    <cn type="float">0.5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(male)=0.5
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:79">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>height</mtext>
    <mo stretchy="false">|</mo>
    <mtext>male</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>œÄ</mi>
      <msup>
       <mi>œÉ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msqrt>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mo>-</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>6</mn>
         <mo>-</mo>
         <mi>Œº</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>œÉ</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>‚âà</mo>
   <mn>1.5789</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>height</mtext>
     <ci>normal-|</ci>
     <mtext>male</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>œÄ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>œÉ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
         <ci>Œº</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>œÉ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <approx></approx>
    <cn type="float">1.5789</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mbox{height}|\mbox{male})=\frac{1}{\sqrt{2\pi\sigma^{2}}}\exp\left(\frac{-(%
6-\mu)^{2}}{2\sigma^{2}}\right)\approx 1.5789
  </annotation>
 </semantics>
</math>

,</p>

<p>where 

<math display="inline" id="Naive_Bayes_classifier:80">
 <semantics>
  <mrow>
   <mi>Œº</mi>
   <mo>=</mo>
   <mn>5.855</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œº</ci>
    <cn type="float">5.855</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=5.855
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Naive_Bayes_classifier:81">
 <semantics>
  <mrow>
   <msup>
    <mi>œÉ</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mn>3.5033</mn>
    <mo>‚ãÖ</mo>
    <msup>
     <mn>10</mn>
     <mrow>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œÉ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <cn type="float">3.5033</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">10</cn>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}=3.5033\cdot 10^{-2}
  </annotation>
 </semantics>
</math>

 are the parameters of normal distribution which have been previously determined from the training set. Note that a value greater than 1 is OK here ‚Äì it is a probability density rather than a probability, because height is a continuous variable.</p>

<p>

<math display="block" id="Naive_Bayes_classifier:82">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>weight</mtext>
    <mo stretchy="false">|</mo>
    <mtext>male</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>5.9881</mn>
   <mo>‚ãÖ</mo>
   <msup>
    <mn>10</mn>
    <mrow>
     <mo>-</mo>
     <mn>6</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>weight</mtext>
     <ci>normal-|</ci>
     <mtext>male</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="float">5.9881</cn>
    <ci>normal-‚ãÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <apply>
      <minus></minus>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mbox{weight}|\mbox{male})=5.9881\cdot 10^{-6}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:83">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>foot size</mtext>
    <mo stretchy="false">|</mo>
    <mtext>male</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1.3112</mn>
   <mo>‚ãÖ</mo>
   <msup>
    <mn>10</mn>
    <mrow>
     <mo>-</mo>
     <mn>3</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>foot size</mtext>
     <ci>normal-|</ci>
     <mtext>male</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="float">1.3112</cn>
    <ci>normal-‚ãÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <apply>
      <minus></minus>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mbox{foot size}|\mbox{male})=1.3112\cdot 10^{-3}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:84">
 <semantics>
  <mrow>
   <mtext>posterior numerator (male)</mtext>
   <mo>=</mo>
   <mtext>their product</mtext>
   <mo>=</mo>
   <mrow>
    <mn>6.1984</mn>
    <mo>‚ãÖ</mo>
    <msup>
     <mn>10</mn>
     <mrow>
      <mo>-</mo>
      <mn>9</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>posterior numerator (male)</mtext>
     <mtext>their product</mtext>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <cn type="float">6.1984</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">10</cn>
       <apply>
        <minus></minus>
        <cn type="integer">9</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{posterior numerator (male)}=\mbox{their product}=6.1984\cdot 10^{-9}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:85">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mtext>female</mtext>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <mtext>female</mtext>
    </apply>
    <cn type="float">0.5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mbox{female})=0.5
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:86">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>height</mtext>
    <mo stretchy="false">|</mo>
    <mtext>female</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>2.2346</mn>
   <mo>‚ãÖ</mo>
   <msup>
    <mn>10</mn>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>height</mtext>
     <ci>normal-|</ci>
     <mtext>female</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="float">2.2346</cn>
    <ci>normal-‚ãÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mbox{height}|\mbox{female})=2.2346\cdot 10^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:87">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>weight</mtext>
    <mo stretchy="false">|</mo>
    <mtext>female</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>1.6789</mn>
   <mo>‚ãÖ</mo>
   <msup>
    <mn>10</mn>
    <mrow>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>weight</mtext>
     <ci>normal-|</ci>
     <mtext>female</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="float">1.6789</cn>
    <ci>normal-‚ãÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <apply>
      <minus></minus>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mbox{weight}|\mbox{female})=1.6789\cdot 10^{-2}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:88">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mtext>foot size</mtext>
    <mo stretchy="false">|</mo>
    <mtext>female</mtext>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mn>2.8669</mn>
   <mo>‚ãÖ</mo>
   <msup>
    <mn>10</mn>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>foot size</mtext>
     <ci>normal-|</ci>
     <mtext>female</mtext>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="float">2.8669</cn>
    <ci>normal-‚ãÖ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">10</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mbox{foot size}|\mbox{female})=2.8669\cdot 10^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:89">
 <semantics>
  <mrow>
   <mtext>posterior numerator (female)</mtext>
   <mo>=</mo>
   <mtext>their product</mtext>
   <mo>=</mo>
   <mrow>
    <mn>5.3778</mn>
    <mo>‚ãÖ</mo>
    <msup>
     <mn>10</mn>
     <mrow>
      <mo>-</mo>
      <mn>4</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>posterior numerator (female)</mtext>
     <mtext>their product</mtext>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>normal-‚ãÖ</ci>
      <cn type="float">5.3778</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">10</cn>
       <apply>
        <minus></minus>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{posterior numerator (female)}=\mbox{their product}=5.3778\cdot 10^{-4}
  </annotation>
 </semantics>
</math>

</p>

<p>Since posterior numerator is greater in the female case, we predict the sample is female.</p>
<h3 id="document-classification">Document classification</h3>

<p>Here is a worked example of naive Bayesian classification to the <a href="document_classification" title="wikilink">document classification</a> problem. Consider the problem of classifying documents by their content, for example into <a href="spamming" title="wikilink">spam</a> and non-spam <a href="e-mail" title="wikilink">e-mails</a>. Imagine that documents are drawn from a number of classes of documents which can be modelled as sets of words where the (independent) probability that the i-th word of a given document occurs in a document from class <em>C</em> can be written as</p>

<p>

<math display="block" id="Naive_Bayes_classifier:90">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>C</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(w_{i}|C)\,
  </annotation>
 </semantics>
</math>

</p>

<p>(For this treatment, we simplify things further by assuming that words are randomly distributed in the document - that is, words are not dependent on the length of the document, position within the document with relation to other words, or other document-context.)</p>

<p>Then the probability that a given document <em>D</em> contains all of the words 

<math display="inline" id="Naive_Bayes_classifier:91">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}
  </annotation>
 </semantics>
</math>

, given a class <em>C</em>, is</p>

<p>

<math display="block" id="Naive_Bayes_classifier:92">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">|</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mi>i</mi>
   </munder>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>C</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(D|C)=\prod_{i}p(w_{i}|C)\,
  </annotation>
 </semantics>
</math>

</p>

<p>The question that we desire to answer is: "what is the probability that a given document <em>D</em> belongs to a given class <em>C</em>?" In other words, what is 

<math display="inline" id="Naive_Bayes_classifier:93">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C|D)\,
  </annotation>
 </semantics>
</math>

?</p>

<p>Now <a href="Conditional_probability" title="wikilink">by definition</a></p>

<p>

<math display="block" id="Naive_Bayes_classifier:94">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">|</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>D</mi>
       <mo>‚à©</mo>
       <mi>C</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>C</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <intersect></intersect>
       <ci>D</ci>
       <ci>C</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>C</ci>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(D|C)={p(D\cap C)\over p(C)}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Naive_Bayes_classifier:95">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>D</mi>
       <mo>‚à©</mo>
       <mi>C</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>D</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <intersect></intersect>
       <ci>D</ci>
       <ci>C</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>D</ci>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C|D)={p(D\cap C)\over p(D)}
  </annotation>
 </semantics>
</math>

</p>

<p>Bayes' theorem manipulates these into a statement of probability in terms of <a class="uri" href="likelihood" title="wikilink">likelihood</a>.</p>

<p>

<math display="block" id="Naive_Bayes_classifier:96">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>C</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>C</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">|</mo>
    <mi>C</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>C</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">C</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(C|D)={p(C)\over p(D)}\,p(D|C)
  </annotation>
 </semantics>
</math>

</p>

<p>Assume for the moment that there are only two mutually exclusive classes, <em>S</em> and ¬¨<em>S</em> (e.g. spam and not spam), such that every element (email) is in either one or the other;</p>

<p>

<math display="block" id="Naive_Bayes_classifier:97">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">|</mo>
    <mi>S</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mi>i</mi>
   </munder>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>S</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(D|S)=\prod_{i}p(w_{i}|S)\,
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Naive_Bayes_classifier:98">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>D</mi>
    <mo stretchy="false">|</mo>
    <mi mathvariant="normal">¬¨</mi>
    <mi>S</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mi>i</mi>
   </munder>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi mathvariant="normal">¬¨</mi>
    <mi>S</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <not></not>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <not></not>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(D|\neg S)=\prod_{i}p(w_{i}|\neg S)\,
  </annotation>
 </semantics>
</math>

</p>

<p>Using the Bayesian result above, we can write:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:99">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>S</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>S</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mi>i</mi>
   </munder>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>S</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(S|D)={p(S)\over p(D)}\,\prod_{i}p(w_{i}|S)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naive_Bayes_classifier:100">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">¬¨</mi>
    <mi>S</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">¬¨</mi>
        <mi>S</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mi>i</mi>
   </munder>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <mi mathvariant="normal">¬¨</mi>
    <mi>S</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <not></not>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>p</ci>
      <apply>
       <times></times>
       <not></not>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>D</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <not></not>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\neg S|D)={p(\neg S)\over p(D)}\,\prod_{i}p(w_{i}|\neg S)
  </annotation>
 </semantics>
</math>

</p>

<p>Dividing one by the other gives:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:101">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>S</mi>
      <mo stretchy="false">|</mo>
      <mi>D</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">¬¨</mi>
      <mi>S</mi>
      <mo stretchy="false">|</mo>
      <mi>D</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>S</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
      <mi>i</mi>
     </munder>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mi>S</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">¬¨</mi>
      <mi>S</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <msub>
      <mo largeop="true" symmetric="true">‚àè</mo>
      <mi>i</mi>
     </msub>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mi mathvariant="normal">¬¨</mi>
      <mi>S</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">D</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <not></not>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">D</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <ci>i</ci>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-|</ci>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <not></not>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <ci>i</ci>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-|</ci>
       <not></not>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {p(S|D)\over p(\neg S|D)}={p(S)\,\prod_{i}p(w_{i}|S)\over p(\neg S)\,\prod_{i}%
p(w_{i}|\neg S)}
  </annotation>
 </semantics>
</math>

</p>

<p>Which can be re-factored as:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:102">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>S</mi>
      <mo stretchy="false">|</mo>
      <mi>D</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">¬¨</mi>
      <mi>S</mi>
      <mo stretchy="false">|</mo>
      <mi>D</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi mathvariant="normal">¬¨</mi>
         <mi>S</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
      <mi>i</mi>
     </munder>
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>w</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">|</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>w</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">|</mo>
        <mi mathvariant="normal">¬¨</mi>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">D</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <not></not>
       <csymbol cd="unknown">S</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">D</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>S</ci>
      </apply>
      <apply>
       <times></times>
       <ci>p</ci>
       <apply>
        <times></times>
        <not></not>
        <ci>S</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <ci>i</ci>
      </apply>
      <apply>
       <divide></divide>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>i</ci>
         </apply>
         <ci>normal-|</ci>
         <csymbol cd="unknown">S</csymbol>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>i</ci>
         </apply>
         <ci>normal-|</ci>
         <not></not>
         <csymbol cd="unknown">S</csymbol>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {p(S|D)\over p(\neg S|D)}={p(S)\over p(\neg S)}\,\prod_{i}{p(w_{i}|S)\over p(w%
_{i}|\neg S)}
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, the probability ratio p(<em>S</em> | <em>D</em>) / p(¬¨<em>S</em> | <em>D</em>) can be expressed in terms of a series of <a href="likelihood_function" title="wikilink">likelihood ratios</a>. The actual probability p(<em>S</em> | <em>D</em>) can be easily computed from log (p(<em>S</em> | <em>D</em>) / p(¬¨<em>S</em> | <em>D</em>)) based on the observation that p(<em>S</em> | <em>D</em>) + p(¬¨<em>S</em> | <em>D</em>) = 1.</p>

<p>Taking the <a class="uri" href="logarithm" title="wikilink">logarithm</a> of all these ratios, we have:</p>

<p>

<math display="block" id="Naive_Bayes_classifier:103">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>S</mi>
       <mo stretchy="false">|</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">¬¨</mi>
       <mi>S</mi>
       <mo stretchy="false">|</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi mathvariant="normal">¬¨</mi>
         <mi>S</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <mi>ln</mi>
      <mfrac>
       <mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>w</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy="false">|</mo>
         <mi>S</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>w</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy="false">|</mo>
         <mi mathvariant="normal">¬¨</mi>
         <mi>S</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ln></ln>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <csymbol cd="unknown">S</csymbol>
        <ci>normal-|</ci>
        <csymbol cd="unknown">D</csymbol>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <not></not>
        <csymbol cd="unknown">S</csymbol>
        <ci>normal-|</ci>
        <csymbol cd="unknown">D</csymbol>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ln></ln>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>S</ci>
       </apply>
       <apply>
        <times></times>
        <ci>p</ci>
        <apply>
         <times></times>
         <not></not>
         <ci>S</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">p</csymbol>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <ci>normal-(</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <ci>i</ci>
          </apply>
          <ci>normal-|</ci>
          <csymbol cd="unknown">S</csymbol>
          <ci>normal-)</ci>
         </cerror>
        </cerror>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">p</csymbol>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <ci>normal-(</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <ci>i</ci>
          </apply>
          <ci>normal-|</ci>
          <not></not>
          <csymbol cd="unknown">S</csymbol>
          <ci>normal-)</ci>
         </cerror>
        </cerror>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln{p(S|D)\over p(\neg S|D)}=\ln{p(S)\over p(\neg S)}+\sum_{i}\ln{p(w_{i}|S)%
\over p(w_{i}|\neg S)}
  </annotation>
 </semantics>
</math>

</p>

<p>(This technique of "<a href="log-likelihood_ratio" title="wikilink">log-likelihood ratios</a>" is a common technique in statistics. In the case of two mutually exclusive alternatives (such as this example), the conversion of a log-likelihood ratio to a probability takes the form of a <a href="sigmoid_curve" title="wikilink">sigmoid curve</a>: see <a class="uri" href="logit" title="wikilink">logit</a> for details.)</p>

<p>Finally, the document can be classified as follows. It is spam if 

<math display="inline" id="Naive_Bayes_classifier:104">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>S</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>></mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">¬¨</mi>
    <mi>S</mi>
    <mo stretchy="false">|</mo>
    <mi>D</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <gt></gt>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <not></not>
     <csymbol cd="unknown">S</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(S|D)>p(\neg S|D)
  </annotation>
 </semantics>
</math>

 (i.e., 

<math display="inline" id="Naive_Bayes_classifier:105">
 <semantics>
  <mrow>
   <mrow>
    <mi>ln</mi>
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>S</mi>
       <mo stretchy="false">|</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">¬¨</mi>
       <mi>S</mi>
       <mo stretchy="false">|</mo>
       <mi>D</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <ln></ln>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <csymbol cd="unknown">S</csymbol>
        <ci>normal-|</ci>
        <csymbol cd="unknown">D</csymbol>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <not></not>
        <csymbol cd="unknown">S</csymbol>
        <ci>normal-|</ci>
        <csymbol cd="unknown">D</csymbol>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln{p(S|D)\over p(\neg S|D)}>0
  </annotation>
 </semantics>
</math>

), otherwise it is not spam.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="AODE" title="wikilink">AODE</a></li>
<li><a href="Bayesian_spam_filtering" title="wikilink">Bayesian spam filtering</a></li>
<li><a href="Bayesian_network" title="wikilink">Bayesian network</a></li>
<li><a href="Random_naive_Bayes" title="wikilink">Random naive Bayes</a></li>
<li><a href="Linear_classifier" title="wikilink">Linear classifier</a></li>
<li><a href="Logistic_regression" title="wikilink">Logistic regression</a></li>
<li><a class="uri" href="Perceptron" title="wikilink">Perceptron</a></li>
<li><a href="Take-the-best_heuristic" title="wikilink">Take-the-best heuristic</a></li>
</ul>
<h2 id="references">References</h2>
<h3 id="further-reading">Further reading</h3>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://nlp.stanford.edu/IR-book/html/htmledition/naive-bayes-text-classification-1.html">Book Chapter: Naive Bayes text classification, Introduction to Information Retrieval</a></li>
<li><a href="http://www.cs.waikato.ac.nz/~eibe/pubs/FrankAndBouckaertPKDD06new.pdf">Naive Bayes for Text Classification with Unbalanced Classes</a></li>
<li>[<a class="uri" href="http://tunedit.org/results?d=UCI/&amp;a">http://tunedit.org/results?d=UCI/&amp;a;</a>;=bayes Benchmark results of Naive Bayes implementations]</li>
<li><a href="http://www.biomedcentral.com/1471-2105/7/514">Hierarchical Naive Bayes Classifiers for uncertain data</a> (an extension of the Naive Bayes classifier).</li>
</ul>
<dl>
<dt>Software</dt>
</dl>
<ul>
<li>Naive Bayes classifiers are available in many general-purpose machine learning and NLP packages, including <a href="Apache_Mahout" title="wikilink">Apache Mahout</a>, <a href="http://mallet.cs.umass.edu/">Mallet</a>, <a class="uri" href="NLTK" title="wikilink">NLTK</a>, <a href="Orange_(software)" title="wikilink">Orange</a>, <a class="uri" href="scikit-learn" title="wikilink">scikit-learn</a> and <a href="Weka_(machine_learning)" title="wikilink">Weka</a>.</li>
<li><a href="IMSL_Numerical_Libraries" title="wikilink">IMSL Numerical Libraries</a> Collections of math and statistical algorithms available in C/C++, Fortran, Java and C#/.NET. Data mining routines in the IMSL Libraries include a Naive Bayes classifier.</li>
<li><a href="http://doc.winnowtag.org/open-source">Winnow content recommendation</a> Open source Naive Bayes text classifier works with very small training and unbalanced training sets. High performance, C, any Unix.</li>
<li>An interactive <a href="Microsoft_Excel" title="wikilink">Microsoft Excel</a> spreadsheet <a href="http://downloads.sourceforge.net/naivebayesclass/NaiveBayesDemo.xls?use_mirror=osdn">Naive Bayes implementation</a> using <a href="Visual_Basic_for_Applications" title="wikilink">VBA</a> (requires enabled macros) with viewable source code.</li>
<li><a href="http://jbnc.sourceforge.net/">jBNC - Bayesian Network Classifier Toolbox</a></li>
<li><a href="http://cmp.felk.cvut.cz/cmp/software/stprtool/">Statistical Pattern Recognition Toolbox for Matlab</a>.</li>
<li><a href="http://people.csail.mit.edu/jrennie/ifile/">ifile</a> - the first freely available (Naive) Bayesian mail/spam filter</li>
<li><a href="http://nclassifier.sourceforge.net/">NClassifier</a> - NClassifier is a .NET library that supports text classification and text summarization. It is a port of Classifier4J.</li>
<li><a href="http://classifier4j.sourceforge.net/">Classifier4J</a> - Classifier4J is a Java library designed to do text classification. It comes with an implementation of a Bayesian classifier.</li>
</ul>

<p>"</p>

<p><a href="Category:Classification_algorithms" title="wikilink">Category:Classification algorithms</a> <a href="Category:Statistical_classification" title="wikilink">Category:Statistical classification</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">‚Ü©</a></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
<li id="fn9"><a href="#fnref9">‚Ü©</a></li>
<li id="fn10"><a href="#fnref10">‚Ü©</a></li>
<li id="fn11"><a href="#fnref11">‚Ü©</a></li>
<li id="fn12"><a href="#fnref12">‚Ü©</a></li>
<li id="fn13"><a href="#fnref13">‚Ü©</a></li>
<li id="fn14"></li>
<li id="fn15"><a href="#fnref15">‚Ü©</a></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"></li>
<li id="fn19"></li>
<li id="fn20"><a href="#fnref20">‚Ü©</a></li>
<li id="fn21"><a href="#fnref21">‚Ü©</a></li>
<li id="fn22"></li>
<li id="fn23"><a href="#fnref23">‚Ü©</a></li>
<li id="fn24"></li>
</ol>
</section>
</body>
</html>

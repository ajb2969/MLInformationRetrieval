<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="489">Particle filter</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Particle filter</h1>
<hr/>

<p><strong>Particle filters</strong> or <strong>Sequential Monte Carlo</strong> (SMC) methods are a set of <a href="Genetic_algorithm" title="wikilink">genetic</a>-type particle <a href="Monte_Carlo_method" title="wikilink">Monte Carlo methodologies</a> to solve <a href="Filtering_problem_(stochastic_processes)" title="wikilink">the filtering problem</a>. The term "particle filters" was first coined in 1996 by Del Moral<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> in reference to <a href="mean_field_particle_methods" title="wikilink">mean field interacting particle methods</a> used in fluid mechanics since the beginning of the 1960s. The terminology "sequential Monte Carlo" was proposed by Liu and Chen in 1998.</p>

<p>From the statistical and probabilistic point of view, particle filters can be interpreted as <a href="Mean_field_particle_methods" title="wikilink">mean field particle</a> interpretations of <a href="Feynman–Kac_formula" title="wikilink">Feynman-Kac</a> probability measures.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> These particle integration techniques were developed in <a href="molecular_chemistry" title="wikilink">molecular chemistry</a> and computational physics by <a href="Ted_Harris_(mathematician)" title="wikilink">Theodore E. Harris</a> and Herman Kahn in 1951, Marshall. N. Rosenbluth and Arianna. W. Rosenbluth in 1955<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> and more recently by Jack H. Hetherington in 1984.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> In computational physics, these Feynman-Kac type path particle integration methods are also used in <a href="Quantum_Monte_Carlo" title="wikilink">Quantum Monte Carlo</a>, and more specifically <a href="Diffusion_Monte_Carlo" title="wikilink">Diffusion Monte Carlo methods</a>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Feynman-Kac interacting particle methods are also strongly related to mutation-selection <a href="genetic_algorithm" title="wikilink">genetic algorithms</a> currently used in <a href="Evolutionary_computation" title="wikilink">evolutionary computing</a> to solve complex optimization problems.</p>

<p>The particle filter methodology is used to solve <a href="Hidden_Markov_model" title="wikilink">Hidden Markov Chain</a> (HMM) and <a href="nonlinear_filter" title="wikilink">nonlinear filtering</a> problems arising in <a href="signal_processing" title="wikilink">signal processing</a> and <a href="Bayesian_inference" title="wikilink">Bayesian statistical inference</a>. The <strong><a href="Filtering_problem_(stochastic_processes)" title="wikilink">filtering problem</a></strong> consists in estimating the internal states in dynamical systems when partial observations are made, and random perturbations are present in the sensors as well as in the dynamical system. The objective is to compute the conditional probability (a.k.a. posterior distributions) of the states of some <a href="Markov_process" title="wikilink">Markov process</a>, given some noisy and partial observations. With the notable exception of linear-Gaussian signal-observation models (<a href="Kalman_filter" title="wikilink">Kalman filter)</a> or wider classes of models (Benes filter<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a>) Mireille Chaleyat-Maurel and Dominique Michel proved in 1984 that the sequence of posterior distributions of the random states of the signal given the observations (a.k.a. optimal filter) have no finitely recursive recursion.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> Various numerical methods based on fixed grid approximations, <a href="Markov_chain_Monte_Carlo" title="wikilink">Markov Chain Monte Carlo</a> techniques (MCMC), conventional linearization, <a href="extended_Kalman_filter" title="wikilink">extended Kalman filters</a>, or determining the best linear system (in expect cost-error sense) have never really coped with large scale systems, unstable processes or when the nonlinearities are not sufficiently smooth.</p>

<p>Particle filtering methodology uses a <a href="Genetic_algorithm" title="wikilink">genetic type mutation-selection</a> sampling approach, with a set of particles (also called individuals, or samples) to represent the <a href="posterior_distribution" title="wikilink">posterior distribution</a> of some <a href="stochastic_process" title="wikilink">stochastic process</a> given some noisy and/or partial observations. The state-space model can be nonlinear and the initial state and noise distributions can take any form required. Particle filter techniques provide a well-established methodology<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a><a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> for generating samples from the required distribution without requiring assumptions about the state-space model or the state distributions. However, these methods do not perform well when applied to very high-dimensional systems.</p>

<p>Particle filters implement the <strong>prediction-updating</strong> transitions of the filtering equation directly by using a genetic type <strong>mutation-selection</strong> particle algorithm. The samples from the distribution are represented by a set of particles; each particle has a likelihood weight assigned to it that represents the probability of that particle being sampled from the probability density function. Weight disparity leading to weight collapse is a common issue encountered in these filtering algorithms; however it can be mitigated by including a resampling step before the weights become too uneven. Several adaptive resampling criteria can be used, including the variance of the weights and the relative entropy w.r.t. the uniform distribution.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> In the resampling step, the particles with negligible weights are replaced by new particles in the proximity of the particles with higher weights.</p>

<p>Particle filters and Feynman-Kac particle methodologies find application in <a href="signal_processing" title="wikilink">signal and image processing,</a> <a href="Bayesian_inference" title="wikilink">Bayesian inference</a>, <a href="machine_learning" title="wikilink">machine learning</a>, <a href="Rare_Event_Sampling" title="wikilink">risk analysis and rare event sampling,</a> <a class="uri" href="engineering" title="wikilink">engineering</a> <a href="robotics" title="wikilink">and robotics</a>, <a href="artificial_intelligence" title="wikilink">artificial intelligence</a>, <a class="uri" href="bioinformatics" title="wikilink">bioinformatics</a>, <a class="uri" href="phylogenetics" title="wikilink">phylogenetics</a>, <a href="computational_science" title="wikilink">computational science</a>, <a class="uri" href="Economics" title="wikilink">Economics</a> <a href="financial_mathematics" title="wikilink">and</a> <a href="mathematical_finance" title="wikilink">mathematical finance</a>, <a href="molecular_chemistry" title="wikilink">molecular chemistry</a>, <a href="computational_physics" title="wikilink">computational physics</a>, <a href="Pharmacokinetics" title="wikilink">pharmacokinetic</a> and other fields.</p>
<h2 id="history">History</h2>
<h3 id="heuristic-like-algorithms">Heuristic like algorithms</h3>

<p>From the statistical and probabilistic viewpoint, particle filters belong to the class of <a href="Branching_process" title="wikilink">branching</a>/<a href="genetic_algorithms" title="wikilink">genetic type algorithms</a>, and <a href="Mean_field_particle_methods" title="wikilink">mean field type interacting particle methodologies.</a> The interpretations of these particle methods depends on the scientific discipline. In <a href="Evolutionary_computation" title="wikilink">Evolutionary Computing</a>, m<a href="Mean_field_particle_methods" title="wikilink">ean field genetic type particle</a> methodologies are often used as a heuristic and natural search algorithms (a.k.a. <a class="uri" href="Metaheuristic" title="wikilink">Metaheuristic</a>). In <a href="computational_physics" title="wikilink">computational physics</a> and <a href="molecular_chemistry" title="wikilink">molecular chemistry</a> they are used to solve Feynman-Kac path integration problems, or the compute Boltzmann-Gibbs measures, top eigenvalues and ground states of <a href="Schrödinger_equation" title="wikilink">Schrödinger</a> operators. In <a class="uri" href="Biology" title="wikilink">Biology</a> and <a class="uri" href="Genetics" title="wikilink">Genetics</a> they also represent the evolution of a population of individuals or genes in some environment.</p>

<p>The origins of mean field type evolutionary computational techniques can be traced to 1950 and 1954 with the seminal work of <a href="Alan_Turing" title="wikilink">Alan Turing</a> on genetic type mutation-selection learning machines <a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> and the articles by <a href="Nils_Aall_Barricelli" title="wikilink">Nils Aall Barricelli</a> at the <a href="Institute_for_Advanced_Study" title="wikilink">Institute for Advanced Study</a> in <a href="Princeton,_New_Jersey" title="wikilink">Princeton, New Jersey</a>.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> The first trace of particle filters in <a href="Statistics" title="wikilink">statistical methodology</a> dates back to the mid-50's; the 'Poor Man's Monte Carlo',<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> that was proposed by Hammersley et al., in 1954, contained hints of the genetic type particle filtering methods used today. In 1963, <a href="Nils_Aall_Barricelli" title="wikilink">Nils Aall Barricelli</a> simulated a genetic type algorithm to mimic the ability of individuals to play a simple game.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> In <a href="Evolutionary_computation" title="wikilink">evolutionary computing</a> literature, genetic type mutation-selection algorithms became popular through the seminal work of John Holland in the early 1970s, and particularly his book<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> published in 1975.</p>

<p>In Biology and <a href="Genetics" title="wikilink">Genetics,</a> the Australian geneticist <a href="Alex_Fraser_(scientist)" title="wikilink">Alex Fraser</a> also published in 1957 a series of papers on the genetic type simulation of <a href="artificial_selection" title="wikilink">artificial selection</a> of organisms.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> The computer simulation of evolution by biologists became more common in the early 1960s, and the methods were described in books by Fraser and Burnell (1970)<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> and Crosby (1973).<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> Fraser's simulations included all of the essential elements of modern mutation-selection genetic particle algorithms.</p>

<p>From the mathematical viewpoint, the conditional distribution of the random states of a signal given some partial and noisy observations is described by a Feynman-Kac probability on the random trajectories of the signal weighted by a sequence of likelihood potential functions.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a><a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> <a href="Quantum_Monte_Carlo" title="wikilink">Quantum Monte Carlo</a>, and more specifically <a href="Diffusion_Monte_Carlo" title="wikilink">Diffusion Monte Carlo methods</a> can also be interpreted as a mean field genetic type particle approximation of Feynman-Kac path integrals.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a><a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a><a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a><a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a><a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a><a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a><a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a> The origins of Quantum Monte Carlo methods are often attributed to Enrico Fermi and Robert Richtmyer who developed in 1948 a mean field particle interpretation of neutron-chain reactions,<a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a> but the first heuristic-like and genetic type particle algorithm (a.k.a. Resampled or Reconfiguration Monte Carlo methods) for estimating ground state energies of quantum systems (in reduced matrix models) is due to Jack H. Hetherington in 1984.<a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a> We also quote an earlier seminal works of <a href="Ted_Harris_(mathematician)" title="wikilink">Theodore E. Harris</a> and Herman Kahn in particle physics, published in 1951, using mean field but heuristic-like genetic methods for estimating particle transmission energies.<a class="footnoteRef" href="#fn38" id="fnref38"><sup>38</sup></a> In molecular chemistry, the use of genetic heuristic-like particle methodologies (a.k.a. pruning and enrichment strategies) can be traced back to 1955 with the seminal work of Marshall. N. Rosenbluth and Arianna. W. Rosenbluth.<a class="footnoteRef" href="#fn39" id="fnref39"><sup>39</sup></a> The use of <a href="Genetic_algorithm" title="wikilink">genetic particle algorithms</a> in advanced <a href="signal_processing" title="wikilink">signal processing</a> and <a href="Bayesian_inference" title="wikilink">Bayesian inference</a> is more recent. It was in 1993, that Gordon et al., published in their seminal work<a class="footnoteRef" href="#fn40" id="fnref40"><sup>40</sup></a> the first application of genetic type algorithm in Bayesian statistical inference. The authors named their algorithm 'the bootstrap filter', and demonstrated that compared to other filtering methods, their bootstrap algorithm does not require any assumption about that state-space or the noise of the system. We also quote another pioneering article in this field of Genshiro Kitagawa on a related "Monte Carlo filter",<a class="footnoteRef" href="#fn41" id="fnref41"><sup>41</sup></a> and the ones by Pierre Del Moral<a class="footnoteRef" href="#fn42" id="fnref42"><sup>42</sup></a> and Himilcon Carvalho, Pierre Del Moral, André Monin and Gérard Salut<a class="footnoteRef" href="#fn43" id="fnref43"><sup>43</sup></a> on particle filters published in the mid-1990s. Particle filters were also developed in signal processing in the early 1989-1992 by P. Del Moral, J.C. Noyer, G. Rigal, and G. Salut in the LAAS-CNRS in a series of restricted and classified research reports with STCAN (Service Technique des Constructions et Armes Navales), the IT company DIGILOG, and the <a href="https://www.laas.fr/public/en">LAAS-CNRS</a> (the Laboratory for Analysis and Architecture of Systems) on RADAR/SONAR and GPS signal processing problems.<a class="footnoteRef" href="#fn44" id="fnref44"><sup>44</sup></a><a class="footnoteRef" href="#fn45" id="fnref45"><sup>45</sup></a><a class="footnoteRef" href="#fn46" id="fnref46"><sup>46</sup></a><a class="footnoteRef" href="#fn47" id="fnref47"><sup>47</sup></a><a class="footnoteRef" href="#fn48" id="fnref48"><sup>48</sup></a><a class="footnoteRef" href="#fn49" id="fnref49"><sup>49</sup></a></p>
<h3 id="mathematical-foundations">Mathematical foundations</h3>

<p>From 1950 to 1996, all the publications on particle filters, genetic algorithms, including the pruning and resample Monte Carlo methods introduced in computational physics and molecular chemistry, present natural and heuristic-like algorithms applied to different situations without a single proof of their consistency, nor a discussion on the bias of the estimates and on genealogical and ancestral tree based algorithms.</p>

<p>The mathematical foundations and the first rigorous analysis of these particle algorithms are due to Pierre Del Moral<a class="footnoteRef" href="#fn50" id="fnref50"><sup>50</sup></a><a class="footnoteRef" href="#fn51" id="fnref51"><sup>51</sup></a> in 1996. The article<a class="footnoteRef" href="#fn52" id="fnref52"><sup>52</sup></a> also contains a proof of the unbiased properties of a particle approximations of likelihood functions and unnormalized conditional probability measures. The unbiased particle estimator of the likelihood functions presented in this article is currently used today in Bayesian statistical inference.</p>

<p>Branching type particle methodologies with varying population sizes were also developed in the end of the 1990s by Dan Crisan, Jessica Gaines and Terry Lyons,<a class="footnoteRef" href="#fn53" id="fnref53"><sup>53</sup></a><a class="footnoteRef" href="#fn54" id="fnref54"><sup>54</sup></a><a class="footnoteRef" href="#fn55" id="fnref55"><sup>55</sup></a> and by Dan Crisan, Pierre Del Moral and Terry Lyons.<a class="footnoteRef" href="#fn56" id="fnref56"><sup>56</sup></a> Further developments in this field were developed in 2000 by P. Del Moral, A. Guionnet and L. Miclo.<a class="footnoteRef" href="#fn57" id="fnref57"><sup>57</sup></a><a class="footnoteRef" href="#fn58" id="fnref58"><sup>58</sup></a><a class="footnoteRef" href="#fn59" id="fnref59"><sup>59</sup></a> The first central limit theorems are due to Pierre Del Moral and Alice Guionnet<a class="footnoteRef" href="#fn60" id="fnref60"><sup>60</sup></a> in 1999 and Pierre Del Moral and Laurent Miclo<a class="footnoteRef" href="#fn61" id="fnref61"><sup>61</sup></a> in 2000. The first uniform convergence results with respect to the time parameter for particle filters were developed in the end of the 1990s by Pierre Del Moral and Alice Guionnet.<a class="footnoteRef" href="#fn62" id="fnref62"><sup>62</sup></a><a class="footnoteRef" href="#fn63" id="fnref63"><sup>63</sup></a> The first rigorous analysis of genealogical tree based particle filter smoothers is due to P. Del Moral and L. Miclo in 2001<a class="footnoteRef" href="#fn64" id="fnref64"><sup>64</sup></a></p>

<p>The theory on Feynman-Kac particle methodologies and related particle filters algorithms has been developed in 2000 and 2004 in the books.<a class="footnoteRef" href="#fn65" id="fnref65"><sup>65</sup></a><a class="footnoteRef" href="#fn66" id="fnref66"><sup>66</sup></a> These abstract probabilistic models encapsulate genetic type algorithms, particle and bootstrap filters, interacting Kalman filters (a.k.a. Rao–Blackwellized particle filter <a class="footnoteRef" href="#fn67" id="fnref67"><sup>67</sup></a>), importance sampling and resampling style particle filter techniques, including genealogical tree based and particle backward methodologies for solving filtering and smoothing problems. Other classes of particle filtering methodologies includes genealogical tree based models,<a class="footnoteRef" href="#fn68" id="fnref68"><sup>68</sup></a><a class="footnoteRef" href="#fn69" id="fnref69"><sup>69</sup></a><a class="footnoteRef" href="#fn70" id="fnref70"><sup>70</sup></a> backward Markov particle models,<a class="footnoteRef" href="#fn71" id="fnref71"><sup>71</sup></a><a class="footnoteRef" href="#fn72" id="fnref72"><sup>72</sup></a> adaptive mean field particle models,<a class="footnoteRef" href="#fn73" id="fnref73"><sup>73</sup></a> island type particle models,<a class="footnoteRef" href="#fn74" id="fnref74"><sup>74</sup></a><a class="footnoteRef" href="#fn75" id="fnref75"><sup>75</sup></a> and particle Markov chain Monte Carlo methodologies.<a class="footnoteRef" href="#fn76" id="fnref76"><sup>76</sup></a><a class="footnoteRef" href="#fn77" id="fnref77"><sup>77</sup></a></p>
<h2 id="the-filtering-problem">The filtering problem</h2>
<h3 id="objective">Objective</h3>

<p>The objective of a particle filter is to estimate the posterior density of the state variables given the observation variables. The particle filter is designed for a <a href="hidden_Markov_Model" title="wikilink">hidden Markov Model</a>, where the system consists of hidden and observable variables. The observable variables (observation process) are related to the hidden variables (state-process) by some functional form that is known. Similarly the dynamical system describing the evolution of the state variables is also known probabilistically.</p>

<p>A generic particle filter estimates the posterior distribution of the hidden states using the observation measurement process. Consider a state-space shown in the diagram below.</p>

<p>

<math display="inline" id="Particle_filter:0">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <msub>
      <mi>X</mi>
      <mn>0</mn>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>→</mo>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>X</mi>
      <msub>
       <mo>;</mo>
       <mn>1</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>→</mo>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>X</mi>
      <msub>
       <mo>;</mo>
       <mn>2</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>→</mo>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>X</mi>
      <msub>
       <mo>;</mo>
       <mn>3</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>→</mo>
    </mtd>
    <mtd columnalign="center">
     <mi mathvariant="normal">…</mi>
    </mtd>
    <mtd columnalign="center">
     <mtext>signal</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="center">
     <mo>↓</mo>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>↓</mo>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>↓</mo>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>↓</mo>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mi mathvariant="normal">…</mi>
    </mtd>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="center">
     <msub>
      <mi>Y</mi>
      <mn>0</mn>
     </msub>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>Y</mi>
      <msub>
       <mo>;</mo>
       <mn>1</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>Y</mi>
      <msub>
       <mo>;</mo>
       <mn>2</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>Y</mi>
      <msub>
       <mo>;</mo>
       <mn>3</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd></mtd>
    <mtd columnalign="center">
     <mi mathvariant="normal">…</mi>
    </mtd>
    <mtd columnalign="center">
     <mtext>observation</mtext>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-→</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">X</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">1</cn>
      </apply>
     </cerror>
     <ci>normal-→</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">X</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">2</cn>
      </apply>
     </cerror>
     <ci>normal-→</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">X</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">3</cn>
      </apply>
     </cerror>
     <ci>normal-→</ci>
     <ci>normal-…</ci>
     <mtext>signal</mtext>
    </matrixrow>
    <matrixrow>
     <ci>normal-↓</ci>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <ci>normal-↓</ci>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <ci>normal-↓</ci>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <ci>normal-↓</ci>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <ci>normal-…</ci>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">Y</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">1</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">Y</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">2</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">Y</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">3</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <ci>normal-…</ci>
     <mtext>observation</mtext>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{cccccccccc}X_{0}&\rightarrow&X;_{1}&\rightarrow&X;_{2}&%
\rightarrow&X;_{3}&\rightarrow&\ldots&\mbox{signal}\\
\downarrow&&\downarrow&&\downarrow&&\downarrow&&\ldots&\\
Y_{0}&&Y;_{1}&&Y;_{2}&&Y;_{3}&&\ldots&\mbox{observation}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>The filtering problem is to estimate <strong>sequentially</strong> the values of the hidden states 

<math display="inline" id="Particle_filter:1">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>


, given the values of the observation process <strong><em></em></strong> 

<math display="inline" id="Particle_filter:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>Y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>k</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0},\ldots,Y_{k}~{},
  </annotation>
 </semantics>
</math>

 at any time step k.</p>

<p>All Bayesian estimates of 

<math display="inline" id="Particle_filter:3">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

 follow from the <a href="Posterior_probability" title="wikilink">posterior density</a> <em>p</em>(<em>x</em><sub><em>k</em></sub> | <em>y</em><sub>0</sub>,<em>y</em><sub>1</sub>,…,<em>y</em><sub><em>k</em></sub>). The particle filter methodology provides an approximation of these conditional probabilities using the empirical measure associated with a <a href="genetic_algorithm" title="wikilink">genetic type particle algorithm</a>. In contrast, the <a href="Markov_chain_Monte_Carlo" title="wikilink">MCMC</a> or <a href="importance_sampling" title="wikilink">importance sampling</a> approach would model the full posterior <em>p</em>(<em>x</em><sub>0</sub>,<em>x</em><sub>1</sub>,…,<em>x</em><sub><em>k</em></sub> | <em>y</em><sub>0</sub>,<em>y</em><sub>1</sub>,…,<em>y</em><sub><em>k</em></sub>).</p>
<h3 id="an-illustration-in-tracking-and-radar-processing">An illustration in Tracking and RADAR processing</h3>

<p>In a 3d-simplified Singer's tracking model<a class="footnoteRef" href="#fn78" id="fnref78"><sup>78</sup></a> the target is represented by a Markov chain with 3 coordinates

<math display="inline" id="Particle_filter:4">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <msubsup>
        <mi>X</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msubsup>
        <mi>X</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>2</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msubsup>
        <mi>X</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>3</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>n</ci>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}=\left(\begin{array}[]{c}X^{(1)}_{n}\\
X^{(2)}_{n}\\
X^{(3)}_{n}\end{array}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>The first coordinate 

<math display="inline" id="Particle_filter:5">
 <semantics>
  <msubsup>
   <mi>X</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{(1)}_{n}
  </annotation>
 </semantics>
</math>


 represents the acceleration of the target at time 

<math display="inline" id="Particle_filter:6">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, the second and the third 

<math display="inline" id="Particle_filter:7">
 <semantics>
  <mrow>
   <msubsup>
    <mi>X</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo rspace="5.8pt">,</mo>
   <msubsup>
    <mi>X</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{(2)}_{n},~{}X^{(3)}_{n}
  </annotation>
 </semantics>
</math>

 stands for the speed and the position of the target at time .</p>

<p>The maneuver equation are often derived from a time discretization of a continuous time model given by the equations</p>

<p>

<math display="inline" id="Particle_filter:8">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mtable>
    <mtr>
     <mtd columnalign="right">
      <msubsup>
       <mi>X</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mi>X</mi>
       <msubsup>
        <mo>;</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mo>+</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>ϵ</mi>
         <mi>n</mi>
        </msub>
       </mpadded>
       <msub>
        <mi>W</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <msubsup>
       <mi>X</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>2</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mrow>
           <mpadded width="+3.3pt">
            <mi>α</mi>
           </mpadded>
           <mi mathvariant="normal">Δ</mi>
          </mrow>
         </mrow>
         <mo rspace="5.8pt" stretchy="false">)</mo>
        </mrow>
        <msubsup>
         <mi>X</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>2</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mpadded width="+3.3pt">
         <mi>β</mi>
        </mpadded>
        <mpadded width="+3.3pt">
         <mi mathvariant="normal">Δ</mi>
        </mpadded>
        <msubsup>
         <mi>X</mi>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>1</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <msubsup>
       <mi>X</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>3</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mi>X</mi>
       <msubsup>
        <mo>;</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>3</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mo>+</mo>
       <mpadded width="+3.3pt">
        <mi mathvariant="normal">Δ</mi>
       </mpadded>
       <msubsup>
        <mi>X</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>2</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">cases</csymbol>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <eq></eq>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">X</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-;</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>W</ci>
        <ci>n</ci>
       </apply>
      </cerror>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <eq></eq>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <ci>α</ci>
          <ci>normal-Δ</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>n</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <eq></eq>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">X</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-;</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <plus></plus>
       <csymbol cd="unknown">Δ</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </cerror>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{\begin{array}[]{rcl}X_{n}^{(1)}&=&X;_{n-1}^{(1)}+\epsilon_{n}~{}W_{n}\\
X_{n}^{(2)}&=&(1-\alpha~{}\Delta)~{}X_{n-1}^{(2)}+\beta~{}\Delta~{}X_{n}^{(1)}%
\\
X_{n}^{(3)}&=&X;_{n-1}^{(3)}+\Delta~{}X_{n}^{(2)}\end{array}\right.
  </annotation>
 </semantics>
</math>

for some viscosity coefficients 

<math display="inline" id="Particle_filter:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mo rspace="5.8pt">,</mo>
    <mpadded width="+3.3pt">
     <mi>β</mi>
    </mpadded>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <list>
     <ci>α</ci>
     <ci>β</ci>
    </list>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha,~{}\beta~{}>0
  </annotation>
 </semantics>
</math>


, some time step 

<math display="inline" id="Particle_filter:10">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>normal-Δ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta>0
  </annotation>
 </semantics>
</math>

. In the above display, the unknown acceleration jump times are modeled by a sequence of independent and identically distributed 

<math display="inline" id="Particle_filter:11">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">0</cn>
    <cn type="integer">1</cn>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{0,1\}
  </annotation>
 </semantics>
</math>

-valued Bernoulli variables 

<math display="inline" id="Particle_filter:12">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{n}
  </annotation>
 </semantics>
</math>

. The unknown speed-up changes are modeled by a sequence of independent and identically distributed variables 

<math display="inline" id="Particle_filter:13">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{n}
  </annotation>
 </semantics>
</math>

. The RADAR sensor delivers at each time step some noisy information on the position of the target. This observation model is given the equation</p>

<p>

<math display="inline" id="Particle_filter:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∀</mo>
     <mi>n</mi>
    </mrow>
    <mo>≥</mo>
    <mn>0</mn>
   </mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>X</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>3</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>+</mo>
     <mrow>
      <mpadded width="+3.3pt">
       <mi mathvariant="normal">Δ</mi>
      </mpadded>
      <msub>
       <mi>V</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <geq></geq>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <ci>n</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \forall n\geq 0\,\qquad Y_{n}=X_{n}^{(3)}+\Delta~{}V_{n}
  </annotation>
 </semantics>
</math>

The random perturbations of the sensors coming from the thermic noise of the uncertainty of the model are represented by a sequence of independent random variable 

<math display="inline" id="Particle_filter:15">
 <semantics>
  <msub>
   <mi>V</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{n}
  </annotation>
 </semantics>
</math>

 with a prescribed probability density. The objective of the filtering problem consists of computing sequentially the conditional distribution of the signal 

<math display="inline" id="Particle_filter:16">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}~{}
  </annotation>
 </semantics>
</math>

 given an observation sequence 

<math display="inline" id="Particle_filter:17">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0}=y_{0},\ldots,Y_{n}=y_{n}~{}
  </annotation>
 </semantics>
</math>

, at any time step 

<math display="inline" id="Particle_filter:18">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n.
  </annotation>
 </semantics>
</math>

 A more complex problem is to compute the conditional distribution of the random paths of the signal 

<math display="inline" id="Particle_filter:19">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
   <mo rspace="5.8pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>n</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{0},\ldots,X_{n})~{}
  </annotation>
 </semantics>
</math>

 given an observation sequence 

<math display="inline" id="Particle_filter:20">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0}=y_{0},\ldots,Y_{n}=y_{n}~{}
  </annotation>
 </semantics>
</math>

, at any time step 

<math display="inline" id="Particle_filter:21">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n.
  </annotation>
 </semantics>
</math>

 In filtering literature, these state estimation problems can be given different names:</p>
<ul>
<li><em>The optimal filter</em> is the conditional probability distribution of the signal 

<math display="inline" id="Particle_filter:22">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}~{}
  </annotation>
 </semantics>
</math>

 given the observation sequence 

<math display="inline" id="Particle_filter:23">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>Y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>=</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>Y</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mpadded width="+3.3pt">
      <msub>
       <mi>y</mi>
       <mi>n</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0}=y_{0},\ldots,Y_{n-1}=y_{n-1},Y_{n}=y_{n}~{}
  </annotation>
 </semantics>
</math>

.</li>
<li><em>The one step optimal predictor</em> is the conditional probability distribution of the signal 

<math display="inline" id="Particle_filter:24">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}~{}
  </annotation>
 </semantics>
</math>

 given the observation sequence 

<math display="inline" id="Particle_filter:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0}=y_{0},\ldots,Y_{n-1}=y_{n-1}
  </annotation>
 </semantics>
</math>

.</li>
<li><em>The smoothing problem</em> consists of estimating the conditional probability distribution of the signal 

<math display="inline" id="Particle_filter:26">
 <semantics>
  <mpadded width="+3.3pt">
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}~{}
  </annotation>
 </semantics>
</math>

 given the observation sequence 

<math display="inline" id="Particle_filter:27">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>Y</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>Y</mi>
      <mi>m</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mi>m</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>n</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>m</ci>
      </apply>
     </list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0}=y_{0},\ldots,Y_{n}:y_{n},\ldots,Y_{m}=y_{m}
  </annotation>
 </semantics>
</math>

, for some 

<math display="inline" id="Particle_filter:28">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>></mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m>n
  </annotation>
 </semantics>
</math>

.</li>
</ul>
<h3 id="the-signal-observation-model">The Signal-Observation Model</h3>

<p>Particle methods often assume 

<math display="inline" id="Particle_filter:29">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

 and the observations 

<math display="inline" id="Particle_filter:30">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{k}
  </annotation>
 </semantics>
</math>

 can be modeled in this form:</p>
<ul>
<li>

<math display="inline" id="Particle_filter:31">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>X</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{0},X_{1},\ldots
  </annotation>
 </semantics>
</math>

 is a <a href="Markov_process" title="wikilink">Markov process</a> on 

<math display="inline" id="Particle_filter:32">
 <semantics>
  <msup>
   <mi>ℝ</mi>
   <msub>
    <mi>d</mi>
    <mi>x</mi>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ℝ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}^{d_{x}}
  </annotation>
 </semantics>
</math>

 (for some 

<math display="inline" id="Particle_filter:33">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mi>x</mi>
   </msub>
   <mo>≥</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{x}\geq 1
  </annotation>
 </semantics>
</math>

) that evolves according to the transition probability density 

<math display="inline" id="Particle_filter:34">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}|x_{k-1})
  </annotation>
 </semantics>
</math>

. This model is also often written in a synthetic way as
<dl>
<dd>

<math display="inline" id="Particle_filter:35">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>∼</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>k</ci>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}|X_{k-1}=x_{k-1}\sim p(x_{k}|x_{k-1})
  </annotation>
 </semantics>
</math>

with an initial probability density 

<math display="inline" id="Particle_filter:36">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{0})
  </annotation>
 </semantics>
</math>

.
</dd>
</dl></li>
</ul>
<ul>
<li>The observations 

<math display="inline" id="Particle_filter:37">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0},Y_{1},\ldots
  </annotation>
 </semantics>
</math>

 take values in some state space on 

<math display="inline" id="Particle_filter:38">
 <semantics>
  <msup>
   <mi>ℝ</mi>
   <msub>
    <mi>d</mi>
    <mi>y</mi>
   </msub>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ℝ</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}^{d_{y}}
  </annotation>
 </semantics>
</math>

 (for some 

<math display="inline" id="Particle_filter:39">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mi>y</mi>
   </msub>
   <mo>≥</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <ci>y</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{y}\geq 1
  </annotation>
 </semantics>
</math>

) are conditionally independent provided that 

<math display="inline" id="Particle_filter:40">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>X</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{0},X_{1},\ldots
  </annotation>
 </semantics>
</math>

 are known. In other words, each 

<math display="inline" id="Particle_filter:41">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{k}
  </annotation>
 </semantics>
</math>

 only depends on 

<math display="inline" id="Particle_filter:42">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

. In addition, we assume conditional distribution for 

<math display="inline" id="Particle_filter:43">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{k}
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="Particle_filter:44">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}=x_{k}
  </annotation>
 </semantics>
</math>

 are absolutely continuous, and in a synthetic way we have</li>
<li>

<math display="inline" id="Particle_filter:45">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>k</mi>
   </msub>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>∼</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>k</ci>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>k</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{k}|X_{k}=x_{k}\sim p(y_{k}|x_{k})
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>An example of system with these properties is:</p>

<p>

<math display="block" id="Particle_filter:46">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>X</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>W</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}=g(X_{k-1})+W_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Particle_filter:47">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>X</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>V</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{k}=h(X_{k})+V_{k}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where both 

<math display="inline" id="Particle_filter:48">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:49">
 <semantics>
  <msub>
   <mi>V</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{k}
  </annotation>
 </semantics>
</math>

 are mutually independent sequences with known <a href="probability_density_function" title="wikilink">probability density functions</a> and 

<math display="inline" id="Particle_filter:50">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(\cdot)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:51">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(\cdot)
  </annotation>
 </semantics>
</math>

 are known functions. These two equations can be viewed as <a href="state_space_(controls)" title="wikilink">state space</a> equations and look similar to the state space equations for the Kalman filter. If the functions 

<math display="inline" id="Particle_filter:52">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(\cdot)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:53">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(\cdot)
  </annotation>
 </semantics>
</math>

 in the above example are linear, and if both 

<math display="inline" id="Particle_filter:54">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:55">
 <semantics>
  <msub>
   <mi>V</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{k}
  </annotation>
 </semantics>
</math>

 are <a class="uri" href="Gaussian" title="wikilink">Gaussian</a>, the Kalman filter finds the exact Bayesian filtering distribution. If not, Kalman filter based methods are a first-order approximation (<a href="Extended_Kalman_filter" title="wikilink">EKF</a>) or a second-order approximation (UKF in general, but if probability distribution is Gaussian a third-order approximation is possible).</p>

<p><em>The assumption that the initial distribution and the transitions of the Markov chain are absolutely continuous with respect to the Lebesgue measure can be relaxed.</em> <strong>To design a particle filter we simply need to assume that we can sample the transitions 

<math display="inline" id="Particle_filter:56">
 <semantics>
  <mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mpadded>
   <mo rspace="5.8pt">→</mo>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k-1}~{}\rightarrow~{}X_{k}
  </annotation>
 </semantics>
</math>

 of the Markov chain 

<math display="inline" id="Particle_filter:57">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>k</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k},
  </annotation>
 </semantics>
</math>

 and to compute the likelihood function 

<math display="inline" id="Particle_filter:58">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>↦</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}\mapsto p(y_{k}|x_{k})
  </annotation>
 </semantics>
</math>

 (see for instance the genetic selection mutation description of the particle filter given below).</strong> The absolutely continuous assumption on the Markov transitions of 

<math display="inline" id="Particle_filter:59">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

 are only used to derive in an informal (and rather abusive) way different formulae between posterior distributions using the Bayes' rule for conditional densities.</p>
<h3 id="approximate-bayesian-computation-models"><a href="Approximate_Bayesian_computation" title="wikilink">Approximate Bayesian Computation models</a></h3>

<p>In some important problems, the conditional distribution of the observations given the random states of the signal may fail to have a density or may be impossible or too complex to compute. In this situation, we need to resort to an additional level of approximation. One strategy is to replace the signal 

<math display="inline" id="Particle_filter:60">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

 by the Markov chain 

<math display="inline" id="Particle_filter:61">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒳</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>Y</mi>
     <mi>k</mi>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒳</ci>
     <ci>k</ci>
    </apply>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>k</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{X}_{k}=\left(X_{k},Y_{k}\right)
  </annotation>
 </semantics>
</math>

 and to introduce a virtual observation of the form</p>

<p>

<math display="inline" id="Particle_filter:62">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒴</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>Y</mi>
       <mi>k</mi>
      </msub>
      <mo>+</mo>
      <mrow>
       <mpadded width="+3.3pt">
        <mi>ϵ</mi>
       </mpadded>
       <msub>
        <mi class="ltx_font_mathcaligraphic">𝒱</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mrow>
     <mtext>for some parameter</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mi>ϵ</mi>
    <mo>∈</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒴</ci>
      <ci>k</ci>
     </apply>
     <list>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <ci>ϵ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝒱</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <mtext>for some parameter</mtext>
     </list>
    </apply>
    <apply>
     <in></in>
     <ci>ϵ</ci>
     <interval closure="closed">
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Y}_{k}=Y_{k}+\epsilon~{}\mathcal{V}_{k}\quad\mbox{for some parameter}%
\quad\epsilon\in[0,1]
  </annotation>
 </semantics>
</math>

</p>

<p>for some sequence of independent sequences with known <a href="probability_density_function" title="wikilink">probability density functions</a>. The central idea is to observe that</p>

<p>

<math display="inline" id="Particle_filter:63">
 <semantics>
  <mrow>
   <mtext>Law</mtext>
   <mrow>
    <mo>(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒴</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒴</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo>)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>ϵ</mi>
      <mo>↓</mo>
      <mn>0</mn>
     </mrow>
    </msub>
   </mpadded>
   <mtext>Law</mtext>
   <mrow>
    <mo>(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>Y</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>Law</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒴</ci>
      <cn type="integer">0</cn>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒴</ci>
      <ci>k</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↓</ci>
      <ci>ϵ</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <mtext>Law</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>k</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{Law}\left(X_{k}~{}|~{}\mathcal{Y}_{0}=y_{0},\ldots,\mathcal{Y}_{k}=y_{k}%
\right)\approx_{\epsilon\downarrow 0}~{}\mbox{Law}\left(X_{k}~{}|~{}Y_{0}=y_{0%
},\ldots,Y_{k}=y_{k}\right)
  </annotation>
 </semantics>
</math>

The particle filter associated with the Markov process 

<math display="inline" id="Particle_filter:64">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒳</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>Y</mi>
     <mi>k</mi>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒳</ci>
     <ci>k</ci>
    </apply>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>k</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{X}_{k}=\left(X_{k},Y_{k}\right)
  </annotation>
 </semantics>
</math>

 given the partial observations 

<math display="inline" id="Particle_filter:65">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒴</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒴</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒴</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒴</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Y}_{0}=y_{0},\ldots,\mathcal{Y}_{k}=y_{k}
  </annotation>
 </semantics>
</math>

 , is defined in terms of particles evolving in 

<math display="inline" id="Particle_filter:66">
 <semantics>
  <msup>
   <mi>ℝ</mi>
   <mrow>
    <msub>
     <mi>d</mi>
     <mi>x</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>d</mi>
     <mi>y</mi>
    </msub>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ℝ</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}^{d_{x}+d_{y}}
  </annotation>
 </semantics>
</math>

 with a likelihood function given with some obvious abusive notation by 

<math display="inline" id="Particle_filter:67">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi class="ltx_font_mathcaligraphic">𝒴</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi class="ltx_font_mathcaligraphic">𝒳</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒴</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒳</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\mathcal{Y}_{k}~{}|~{}\mathcal{X}_{k})
  </annotation>
 </semantics>
</math>

. These probabilistic techniques are closely related to <a href="Approximate_Bayesian_Computation" title="wikilink">Approximate Bayesian Computation</a> (ABC). In the context of particle filters, these ABC particle filtering techniques were introduced in 1998 by P. Del Moral, J. Jacod and P. Protter in the article.<a class="footnoteRef" href="#fn79" id="fnref79"><sup>79</sup></a> They were further developed by P. Del Moral, A. Doucet and A. Jasra.<a class="footnoteRef" href="#fn80" id="fnref80"><sup>80</sup></a><a class="footnoteRef" href="#fn81" id="fnref81"><sup>81</sup></a></p>
<h3 id="the-nonlinear-filtering-equation">The nonlinear filtering equation</h3>

<p>The conditional probability densities <em>p</em>(<em>x</em><sub>0</sub>,<em>x</em><sub>1</sub>,…,<em>x</em><sub><em>k</em></sub> | <em>y</em><sub>0</sub>,<em>y</em><sub>1</sub>,…,<em>y</em><sub><em>k</em></sub>) are given by the Bayes' rule</p>

<p>

<math display="inline" id="Particle_filter:68">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>×</mo>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mtext>with</mtext>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mi mathvariant="normal">…</mi>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <times></times>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <times></times>
      <ci>p</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <ci></ci>
    <mtext>with</mtext>
    <ci></ci>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{0},...,x_{k}|y_{0},\dots,y_{k})=\frac{p(y_{0},\dots,y_{k}|x_{0},...,x_{k}%
)\times p(x_{0},...,x_{k})}{p(y_{0},\dots,y_{k})}\quad\mbox{with}\quad p(y_{0}%
,\dots,y_{k})=\int p(y_{0},\dots,y_{k}|x_{0},...,x_{k})~{}p(x_{0},...,x_{k})~{%
}dx_{0}\ldots dx_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>and the likelihood functions are defined by the product formulae</p>

<p>

<math display="inline" id="Particle_filter:69">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo largeop="true" symmetric="true">∏</mo>
    <mrow>
     <mn>0</mn>
     <mo>≤</mo>
     <mi>l</mi>
     <mo>≤</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mtext>with</mtext>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>p</mi>
    <mn>0</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mo largeop="true" symmetric="true">∏</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>l</mi>
     <mo>≤</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>l</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">0</cn>
       <ci>l</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>l</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>l</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>italic-</ci>
    <mtext>with</mtext>
    <ci>italic-</ci>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cn type="integer">0</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>l</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>l</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>l</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{0},\dots,y_{k}|x_{0},...,x_{k})=\prod_{0\leq l\leq k}p(y_{l}|x_{l})\qquad%
\mbox{with}\qquad p(x_{0},...,x_{k})=p_{0}(x_{0})\prod_{1\leq l\leq k}p(x_{l}|%
x_{l-1})
  </annotation>
 </semantics>
</math>

</p>

<p>Particle filters are also an approximation, but with enough particles they can be much more accurate<a class="footnoteRef" href="#fn82" id="fnref82"><sup>82</sup></a><a class="footnoteRef" href="#fn83" id="fnref83"><sup>83</sup></a><a class="footnoteRef" href="#fn84" id="fnref84"><sup>84</sup></a><a class="footnoteRef" href="#fn85" id="fnref85"><sup>85</sup></a><a class="footnoteRef" href="#fn86" id="fnref86"><sup>86</sup></a><sup>.</sup>. The nonlinear filtering equation is given by the recursion</p>

<p>{-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!\longrightarrow}~~~ p(x_k|y_0,\ldots,y_{k})=\displaystyle\frac{p(y_k|x_k)p(x_k|y_0,\ldots,y_{k-1})}{\int p(y_k|x'_k)p(x'_k|y_0,\ldots,y_{k-1})dx'_k}~~\stackrel{\mbox{prediction}}{-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!\longrightarrow}~~~p(x_{k+1}|y_0,\ldots,y_{k})=\int~p(x_{k+1}|x_k)~p(x_k|y_0,\ldots,y_{k})~dx_k |Eq. 1}} with the convention 

<math display="inline" id="Particle_filter:70">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{0}|y_{0},\ldots,y_{-1})=p(x_{0})
  </annotation>
 </semantics>
</math>

 for k=0. The nonlinear filtering problem consists in computing sequentially these sequence of conditional distributions.</p>
<h3 id="feynman-kac-formulation"><a href="Feynman–Kac_formula" title="wikilink">Feynman-Kac formulation</a></h3>

<p>We fix a time horizon n and a sequence of observations 

<math display="inline" id="Particle_filter:71">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0}=y_{0},\ldots,Y_{n}=y_{n}
  </annotation>
 </semantics>
</math>

, and we set 

<math display="inline" id="Particle_filter:72">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mpadded width="+3.3pt">
    <mtext>for each</mtext>
   </mpadded>
   <mi>k</mi>
   <mo>=</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <mtext>for each</mtext>
    <csymbol cd="unknown">k</csymbol>
    <eq></eq>
    <cn type="integer">0</cn>
    <ci>normal-,</ci>
    <ci>normal-…</ci>
    <ci>normal-,</ci>
    <csymbol cd="unknown">n</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{k}(x_{k})=p(y_{k}|x_{k}),~{}\mbox{for each}~{}k=0,\ldots,n
  </annotation>
 </semantics>
</math>

. In this notation, for any bounded function F(.) on the set of trajectories of 

<math display="inline" id="Particle_filter:73">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

 from the origin k=0 up to time k=n, we have the Feynman-Kac formula</p>

<p>

<math display="inline" id="Particle_filter:74">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mstyle displaystyle="true">
       <mo largeop="true" symmetric="true">∫</mo>
      </mstyle>
      <mi>F</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mi>F</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo rspace="5.8pt" stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo>{</mo>
         <msub>
          <mo largeop="true" symmetric="true">∏</mo>
          <mrow>
           <mn>0</mn>
           <mo>≤</mo>
           <mi>k</mi>
           <mo>≤</mo>
           <mi>n</mi>
          </mrow>
         </msub>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>y</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">|</mo>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>}</mo>
        </mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo rspace="5.8pt" stretchy="false">)</mo>
        </mrow>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mi mathvariant="normal">…</mi>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mrow>
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
        <mrow>
         <mo>{</mo>
         <msub>
          <mo largeop="true" symmetric="true">∏</mo>
          <mrow>
           <mn>0</mn>
           <mo>≤</mo>
           <mi>k</mi>
           <mo>≤</mo>
           <mi>n</mi>
          </mrow>
         </msub>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>y</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">|</mo>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo>}</mo>
        </mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo rspace="5.8pt" stretchy="false">)</mo>
        </mrow>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mi mathvariant="normal">…</mi>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mstyle>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd></mtd>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>F</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>X</mi>
            <mn>0</mn>
           </msub>
           <mo>,</mo>
           <mi mathvariant="normal">…</mi>
           <mo>,</mo>
           <msub>
            <mi>X</mi>
            <mi>n</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
          <mrow>
           <msub>
            <mo largeop="true" symmetric="true">∏</mo>
            <mrow>
             <mn>0</mn>
             <mo>≤</mo>
             <mi>k</mi>
             <mo>≤</mo>
             <mi>n</mi>
            </mrow>
           </msub>
           <mrow>
            <msub>
             <mi>G</mi>
             <mi>k</mi>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>X</mi>
              <mi>k</mi>
             </msub>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mo largeop="true" symmetric="true">∏</mo>
           <mrow>
            <mn>0</mn>
            <mo>≤</mo>
            <mi>k</mi>
            <mo>≤</mo>
            <mi>n</mi>
           </mrow>
          </msub>
          <mrow>
           <msub>
            <mi>G</mi>
            <mi>k</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>X</mi>
             <mi>k</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mstyle>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">F</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">d</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
      <csymbol cd="unknown">d</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </cerror>
     <eq></eq>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <int></int>
       <csymbol cd="unknown">F</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-{</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">0</cn>
           <ci>k</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>k</ci>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <ci>normal-}</ci>
       </cerror>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-…</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <int></int>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-{</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">0</cn>
           <ci>k</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>k</ci>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <ci>normal-}</ci>
       </cerror>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-…</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </cerror>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <times></times>
        <ci>F</ci>
        <vector>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>n</ci>
         </apply>
        </vector>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <csymbol cd="latexml">product</csymbol>
          <apply>
           <and></and>
           <apply>
            <leq></leq>
            <cn type="integer">0</cn>
            <ci>k</ci>
           </apply>
           <apply>
            <leq></leq>
            <share href="#.cmml">
            </share>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>G</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>X</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">0</cn>
           <ci>k</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>G</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}\displaystyle\int F(x_{0},\ldots,x_{n})~{}p(x_{0},\ldots,x%
_{n}|y_{0},\ldots,y_{n})~{}dx_{0}\ldots dx_{n}&=&\displaystyle\frac{\int F(x_{%
0},\ldots,x_{n})~{}\left\{\prod_{0\leq k\leq n}p(y_{k}|x_{k})\right\}p(x_{0},%
\ldots,x_{n})~{}dx_{0}\ldots dx_{n}}{\int~{}\left\{\prod_{0\leq k\leq n}p(y_{k%
}|x_{k})\right\}p(x_{0},\ldots,x_{n})~{}dx_{0}\ldots dx_{n}}\\
&&\\
&=&\displaystyle\frac{E\left(F(X_{0},\ldots,X_{n})\prod_{0\leq k\leq n}G_{k}(X%
_{k})\right)}{E\left(\prod_{0\leq k\leq n}G_{k}(X_{k})\right)}\end{array}
  </annotation>
 </semantics>
</math>

These Feynman-Kac path integration models arise a variety of scientific disciplines, including in computational physics, biology, information theory and computer sciences.<a class="footnoteRef" href="#fn87" id="fnref87"><sup>87</sup></a><a class="footnoteRef" href="#fn88" id="fnref88"><sup>88</sup></a><a class="footnoteRef" href="#fn89" id="fnref89"><sup>89</sup></a> Their interpretations depend on the application domain. For instance, if we choose the indicator function 

<math display="inline" id="Particle_filter:75">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>G</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mn>1</mn>
     <mi>A</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <cn type="integer">1</cn>
      <ci>A</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{n}(x_{n})=1_{A}(x_{n})
  </annotation>
 </semantics>
</math>

 of some subset of the state space, they represent the conditional distribution of a Markov chain given it stays in a given tube; that is, we have that</p>

<p>

<math display="inline" id="Particle_filter:76">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo>(</mo>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>X</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>0</mn>
    </msub>
    <mo>∈</mo>
    <mi>A</mi>
    <mo rspace="5.8pt">,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>n</mi>
    </msub>
    <mo>∈</mo>
    <mi>A</mi>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>E</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>F</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>X</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>X</mi>
          <mi>n</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∏</mo>
          <mrow>
           <mn>0</mn>
           <mo>≤</mo>
           <mi>k</mi>
           <mo>≤</mo>
           <mi>n</mi>
          </mrow>
         </msub>
         <mrow>
          <msub>
           <mi>G</mi>
           <mi>k</mi>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>X</mi>
            <mi>k</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>E</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">∏</mo>
         <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>k</mi>
          <mo>≤</mo>
          <mi>n</mi>
         </mrow>
        </msub>
        <mrow>
         <msub>
          <mi>G</mi>
          <mi>k</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>X</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mstyle>
   <mtext>and</mtext>
   <mi>P</mi>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>0</mn>
    </msub>
    <mo>∈</mo>
    <mi>A</mi>
    <mo rspace="5.8pt">,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>n</mi>
    </msub>
    <mo>∈</mo>
    <mi>A</mi>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mi>E</mi>
   <mrow>
    <mo>(</mo>
    <mstyle displaystyle="true">
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mn>0</mn>
       <mo>≤</mo>
       <mi>k</mi>
       <mo>≤</mo>
       <mi>n</mi>
      </mrow>
     </munder>
    </mstyle>
    <msub>
     <mi>G</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>X</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">F</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">0</cn>
     </apply>
     <in></in>
     <csymbol cd="unknown">A</csymbol>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>n</ci>
     </apply>
     <in></in>
     <csymbol cd="unknown">A</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <times></times>
       <ci>F</ci>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>n</ci>
        </apply>
       </vector>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">0</cn>
           <ci>k</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>G</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <and></and>
         <apply>
          <leq></leq>
          <cn type="integer">0</cn>
          <ci>k</ci>
         </apply>
         <apply>
          <leq></leq>
          <share href="#.cmml">
          </share>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci></ci>
    <mtext>and</mtext>
    <ci></ci>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">0</cn>
     </apply>
     <in></in>
     <csymbol cd="unknown">A</csymbol>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>n</ci>
     </apply>
     <in></in>
     <csymbol cd="unknown">A</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <and></and>
       <apply>
        <leq></leq>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </apply>
       <apply>
        <leq></leq>
        <share href="#.cmml">
        </share>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <ci>k</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E\left(F(X_{0},\ldots,X_{n})~{}|~{}X_{0}\in A,~{}\ldots,X_{n}\in A\right)=%
\displaystyle\frac{E\left(F(X_{0},\ldots,X_{n})\prod_{0\leq k\leq n}G_{k}(X_{k%
})\right)}{E\left(\prod_{0\leq k\leq n}G_{k}(X_{k})\right)}\quad\mbox{and}%
\quad P\left(X_{0}\in A,~{}\ldots,X_{n}\in A\right)=E\left(\prod_{0\leq k\leq n%
}G_{k}(X_{k})\right)
  </annotation>
 </semantics>
</math>

as soon as the normalizing constant is strictly positive.</p>
<h2 id="particle-filters">Particle filters</h2>
<h3 id="a-genetic-type-particle-algorithm"><a href="Genetic_algorithm" title="wikilink">A Genetic type particle algorithm</a></h3>

<p>Initially we start with 

<math display="inline" id="Particle_filter:77">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>


 independent random variable 

<math display="inline" id="Particle_filter:78">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mn>0</mn>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
    <mo>≤</mo>
    <mi>N</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\xi^{i}_{0}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

 with common probability density 

<math display="inline" id="Particle_filter:79">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{0})
  </annotation>
 </semantics>
</math>

 . The genetic algorithm selection-mutation transitions</p>

<p>

<math display="inline" id="Particle_filter:80">
 <semantics>
  <mrow>
   <msub>
    <mi>ξ</mi>
    <mi>k</mi>
   </msub>
   <mo>:=</mo>
   <msub>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>ξ</mi>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mpadded width="+3.3pt">
    <mover>
     <mrow>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false">⟶</mo>
     </mrow>
     <mtext>selection</mtext>
    </mover>
   </mpadded>
   <msub>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>:=</mo>
   <msub>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mpadded width="+3.3pt">
    <mover>
     <mrow>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false" rspace="0pt">-</mo>
      <mo movablelimits="false">⟶</mo>
     </mrow>
     <mtext>mutation</mtext>
    </mover>
   </mpadded>
   <msub>
    <mi>ξ</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>:=</mo>
   <msub>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ξ</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <and></and>
       <apply>
        <leq></leq>
        <cn type="integer">1</cn>
        <ci>i</ci>
       </apply>
       <apply>
        <leq></leq>
        <share href="#.cmml">
        </share>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <ci>normal-⟶</ci>
      </list>
      <mtext>selection</mtext>
     </apply>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ξ</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <and></and>
       <apply>
        <leq></leq>
        <cn type="integer">1</cn>
        <ci>i</ci>
       </apply>
       <apply>
        <leq></leq>
        <share href="#.cmml">
        </share>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <list>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <minus></minus>
       <ci>normal-⟶</ci>
      </list>
      <mtext>mutation</mtext>
     </apply>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ξ</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <and></and>
       <apply>
        <leq></leq>
        <cn type="integer">1</cn>
        <ci>i</ci>
       </apply>
       <apply>
        <leq></leq>
        <share href="#.cmml">
        </share>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{k}:=\left(\xi^{i}_{k}\right)_{1\leq i\leq N}\stackrel{\mbox{selection}}{-%
\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!%
\!-\!\!\!\!\longrightarrow}~{}\widehat{\xi}_{k}:=\left(\widehat{\xi}^{i}_{k}%
\right)_{1\leq i\leq N}\stackrel{\mbox{mutation}}{-\!\!\!\!-\!\!\!\!-\!\!\!\!-%
\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!-\!\!\!\!\longrightarrow}%
~{}\xi_{k+1}:=\left(\xi^{i}_{k+1}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

</p>

<p>mimic/approximate the updating-prediction transitions of the optimal filter evolution ():</p>
<ul>
<li><strong>During the selection-updating transition</strong> we sample N (conditionally) independent random variables 

<math display="inline" id="Particle_filter:81">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mo>:=</mo>
   <msub>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>ξ</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}_{k}:=\left(\widehat{\xi}^{i}_{k}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

 with common (conditional) distribution

<math display="inline" id="Particle_filter:82">
 <semantics>
  <mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </msub>
   </mpadded>
   <mrow>
    <mpadded width="+3.3pt">
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mi>k</mi>
         <mi>i</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mstyle displaystyle="false">
        <msub>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <mn>1</mn>
          <mo>≤</mo>
          <mi>j</mi>
          <mo>≤</mo>
          <mi>N</mi>
         </mrow>
        </msub>
       </mstyle>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mi>k</mi>
         <mi>j</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
    <msub>
     <mi>δ</mi>
     <msubsup>
      <mi>ξ</mi>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ξ</ci>
          <ci>i</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <and></and>
         <apply>
          <leq></leq>
          <cn type="integer">1</cn>
          <ci>j</ci>
         </apply>
         <apply>
          <leq></leq>
          <share href="#.cmml">
          </share>
          <ci>N</ci>
         </apply>
        </apply>
       </apply>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ξ</ci>
          <ci>j</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{1\leq i\leq N}~{}\frac{p(y_{k}~{}|~{}\xi^{i}_{k})}{\sum_{1\leq j\leq N}p%
(y_{k}~{}|~{}\xi^{j}_{k})}~{}\delta_{\xi^{i}_{k}}(dx_{k})
  </annotation>
 </semantics>
</math>


</li>
<li><strong>During the mutation-prediction transition,</strong> from each selected particle 

<math display="inline" id="Particle_filter:83">
 <semantics>
  <msubsup>
   <mover accent="true">
    <mi>ξ</mi>
    <mo>^</mo>
   </mover>
   <mi>k</mi>
   <mi>i</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>ξ</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}^{i}_{k}
  </annotation>
 </semantics>
</math>

 we sample independently a transition 

<math display="inline" id="Particle_filter:84">
 <semantics>
  <mrow>
   <mpadded width="+3.3pt">
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </mpadded>
   <mo>⟶</mo>
   <mpadded width="+6.6pt">
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mi>i</mi>
    </msubsup>
   </mpadded>
   <mo rspace="9.1pt">∼</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <ci>normal-⟶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}^{i}_{k}~{}\longrightarrow\xi^{i}_{k+1}~{}~{}\sim~{}~{}p(x_{k+1}|%
\widehat{\xi}^{i}_{k})
  </annotation>
 </semantics>
</math>

 , for 

<math display="inline" id="Particle_filter:85">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,N.
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>In the above displayed formulae 

<math display="inline" id="Particle_filter:86">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k}~{}|~{}\xi^{i}_{k})
  </annotation>
 </semantics>
</math>

 stands for the likelihood function 

<math display="inline" id="Particle_filter:87">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>↦</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}\mapsto p(y_{k}~{}|~{}x_{k})
  </annotation>
 </semantics>
</math>


 evaluated at 

<math display="inline" id="Particle_filter:88">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\xi^{i}_{k}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Particle_filter:89">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k+1}~{}|~{}\widehat{\xi}^{i}_{k})
  </annotation>
 </semantics>
</math>

 stands for the conditional density 

<math display="inline" id="Particle_filter:90">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k+1}~{}|~{}x_{k})
  </annotation>
 </semantics>
</math>

 evaluated at 

<math display="inline" id="Particle_filter:91">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\widehat{\xi}^{i}_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>At each time k, we have the particle approximations</p>

<p>

<math display="inline" id="Particle_filter:92">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mpadded width="+3.3pt">
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </msub>
   </mpadded>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msubsup>
        <mi>ξ</mi>
        <mi>k</mi>
        <mi>i</mi>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="false">
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>j</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
      </mstyle>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msubsup>
        <mi>ξ</mi>
        <mi>k</mi>
        <mi>j</mi>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}~{}|~{}y_{0},\ldots,y_{k}):=\frac{1}{N}\sum_{1\leq i\leq N}%
\delta_{\widehat{\xi}^{i}_{k}}(dx_{k})~{}~{}\approx_{N\uparrow\infty}~{}~{}p(%
dx_{k}~{}|~{}y_{0},\ldots,y_{k})~{}~{}\approx_{N\uparrow\infty}~{}~{}\sum_{1%
\leq i\leq N}~{}\frac{p(y_{k}~{}|~{}\xi^{i}_{k})}{\sum_{1\leq j\leq N}p(y_{k}~%
{}|~{}\xi^{j}_{k})}~{}\delta_{\xi^{i}_{k}}(dx_{k})
  </annotation>
 </semantics>
</math>

and</p>

<p>

<math display="inline" id="Particle_filter:93">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}~{}|~{}y_{0},\ldots,y_{k-1}):=\frac{1}{N}\sum_{1\leq i\leq N%
}\delta_{\xi^{i}_{k}}(dx_{k})~{}~{}\approx_{N\uparrow\infty}~{}~{}p(dx_{k}~{}|%
~{}y_{0},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

</p>

<p>A detailed proof of these convergence results can be found in,<a class="footnoteRef" href="#fn90" id="fnref90"><sup>90</sup></a><a class="footnoteRef" href="#fn91" id="fnref91"><sup>91</sup></a> see also the more recent developments provided in the books.<a class="footnoteRef" href="#fn92" id="fnref92"><sup>92</sup></a><a class="footnoteRef" href="#fn93" id="fnref93"><sup>93</sup></a> In <a href="Genetic_algorithms" title="wikilink">Genetic algorithms</a> and <a href="Evolutionary_computing" title="wikilink">Evolutionary computing</a> community, the mutation-selection</p>

<p>Markov chain described above is often called the genetic algorithm with proportional selection. Several branching variants, including with random population sizes have also been proposed in the articles.<a class="footnoteRef" href="#fn94" id="fnref94"><sup>94</sup></a><a class="footnoteRef" href="#fn95" id="fnref95"><sup>95</sup></a><a class="footnoteRef" href="#fn96" id="fnref96"><sup>96</sup></a></p>
<h3 id="monte-carlo-principles"><a href="Monte_Carlo_method" title="wikilink">Monte Carlo principles</a></h3>

<p>Particle methods, like all sampling-based approaches (e.g., <a href="Markov_chain_Monte_Carlo" title="wikilink">MCMC</a>), generate a set of samples that approximate the filtering density 

<math display="inline" id="Particle_filter:94">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}|y_{0},\dots,y_{k})
  </annotation>
 </semantics>
</math>

. For example, we may have 

<math display="inline" id="Particle_filter:95">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 samples from the approximate posterior distribution of 

<math display="inline" id="Particle_filter:96">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

, where the samples are labeled with superscripts as 

<math display="inline" id="Particle_filter:97">
 <semantics>
  <mrow>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mn>1</mn>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mn>2</mn>
   </msubsup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mi>N</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}_{k}^{1},\widehat{\xi}_{k}^{2},\ldots,\widehat{\xi}_{k}^{N}
  </annotation>
 </semantics>
</math>

. Then, expectations with respect to the filtering distribution are approximated by </p>

<p>In the above display 

<math display="inline" id="Particle_filter:98">
 <semantics>
  <msub>
   <mi>δ</mi>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>δ</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{a}
  </annotation>
 </semantics>
</math>

 stands for the <b role="presentation"><a href="Dirac_measure" title="wikilink">Dirac measure</a></b> at a given state a. The function 

<math display="inline" id="Particle_filter:99">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cdot)
  </annotation>
 </semantics>
</math>

, in the usual way for Monte Carlo, can give all the <a href="moment_(mathematics)" title="wikilink">moments</a> etc. of the distribution up to some degree of approximation. When the approximation equation () is satisfied for any bounded function 

<math display="inline" id="Particle_filter:100">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cdot)
  </annotation>
 </semantics>
</math>

 we write</p>

<p>

<math display="inline" id="Particle_filter:101">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mpadded width="+3.3pt">
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
   </mpadded>
   <msub>
    <mo>≈</mo>
    <mrow>
     <mi>N</mi>
     <mo>↑</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(dx_{k}|y_{0},\dots,y_{k}):=p(x_{k}|y_{0},\dots,y_{k})~{}dx_{k}~{}\approx_{N%
\uparrow\infty}\widehat{p}(dx_{k}|y_{0},\dots,y_{k})=\frac{1}{N}\sum_{1\leq i%
\leq N}\delta_{\widehat{\xi}^{i}_{k}}(dx_{k})
  </annotation>
 </semantics>
</math>

</p>

<p>Particle filters can be interpreted as a genetic type particle algorithm evolving with mutation and selection transitions. We can keep track of the ancestral lines 

<math display="inline" id="Particle_filter:102">
 <semantics>
  <mrow>
   <mo>(</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <cn type="integer">0</cn>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <cn type="integer">1</cn>
      <ci>k</ci>
     </list>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <ci>k</ci>
      <ci>k</ci>
     </list>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\widehat{\xi}^{i}_{0,k},\widehat{\xi}^{i}_{1,k},...,\widehat{\xi}^{i}_{k%
-1,k},\widehat{\xi}^{i}_{k,k}\right)
  </annotation>
 </semantics>
</math>

 of the particles 

<math display="inline" id="Particle_filter:103">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,...,N
  </annotation>
 </semantics>
</math>

. The random states 

<math display="inline" id="Particle_filter:104">
 <semantics>
  <msubsup>
   <mover accent="true">
    <mi>ξ</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mi>l</mi>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
   <mi>i</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>ξ</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <list>
     <ci>l</ci>
     <ci>k</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}^{i}_{l,k}
  </annotation>
 </semantics>
</math>

 , with the lower indices l=0,...,k, stands for the ancestor of the individual 

<math display="inline" id="Particle_filter:105">
 <semantics>
  <mrow>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <ci>k</ci>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}^{i}_{k,k}=\widehat{\xi}^{i}_{k}
  </annotation>
 </semantics>
</math>

 at level l=0,...,k. In his situation, we have the approximation formula </p>

<p>Here F stands for any founded function on the path space of the signal. In a more synthetic form () is equivalent to</p>

<p>

<math display="inline" id="Particle_filter:106">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mi mathvariant="normal">…</mi>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <msub>
    <mo>≈</mo>
    <mrow>
     <mi>N</mi>
     <mo>↑</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>,</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ξ</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ξ</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </list>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ξ</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <list>
        <ci>k</ci>
        <ci>k</ci>
       </list>
      </apply>
     </vector>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(d(x_{0},...,x_{k})|y_{0},\dots,y_{k}):=p(x_{0},...,x_{k}|y_{0},\dots,y_{k})%
\,dx_{0}...dx_{k}\approx_{N\uparrow\infty}\widehat{p}(d(x_{0},\ldots,x_{k})|y_%
{0},\dots,y_{k}):=\frac{1}{N}\sum_{1\leq i\leq N}\delta_{\left(\widehat{\xi}^{%
i}_{0,k},\widehat{\xi}^{i}_{1,k},\ldots,\widehat{\xi}^{i}_{k,k}\right)}(d(x_{0%
},\ldots,x_{k}))
  </annotation>
 </semantics>
</math>

Particle filters can be interpreted in many different ways. From the probabilistic point of view they coincide with a <a href="Mean_field_particle_methods" title="wikilink">mean field particle</a> interpretation of the nonlinear filtering equation. The updating-prediction transitions of the optimal filter evolution can also be interpreted as the classical genetic type selection-mutation transitions of individuals. The sequential importance resampling technique provides another interpretation of the filtering transitions coupling importance sampling with the bootstrap resampling step. Last, but not least, particle filters can be seen as an acceptance-rejection methodology equipped with a recycling mechanism.<a class="footnoteRef" href="#fn97" id="fnref97"><sup>97</sup></a><a class="footnoteRef" href="#fn98" id="fnref98"><sup>98</sup></a></p>
<h3 id="mean-field-particle-simulation"><a href="Mean_field_particle_methods" title="wikilink">Mean field particle simulation</a></h3>
<h4 id="the-general-probabilistic-principle">The general probabilistic principle</h4>

<p>The nonlinear filtering evolution can be interpreted as a dynamical system in the set of probability measures of the following form

<math display="inline" id="Particle_filter:107">
 <semantics>
  <mrow>
   <msub>
    <mi>η</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>η</mi>
      <mi>n</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>η</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{n+1}=\Phi_{n+1}\left(\eta_{n}\right)
  </annotation>
 </semantics>
</math>

where 

<math display="inline" id="Particle_filter:108">
 <semantics>
  <msub>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Φ</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi_{n+1}
  </annotation>
 </semantics>
</math>

 stands for some mapping from the set of probability distribution into itself. For instance, the evolution of the one-step optimal predictor 

<math display="inline" id="Particle_filter:109">
 <semantics>
  <mrow>
   <msub>
    <mi>η</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>η</ci>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{n}(dx_{n})=p(x_{n}|y_{0},\ldots,y_{n-1})dx_{n}
  </annotation>
 </semantics>
</math>

 satisfies a nonlinear evolution starting with the probability distribution 

<math display="inline" id="Particle_filter:110">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>η</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{0}(dx_{0})=p(x_{0})dx_{0}
  </annotation>
 </semantics>
</math>

 . One of the simplest way to approximate these probability measures is to start with 

<math display="inline" id="Particle_filter:111">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 independent random variables 

<math display="inline" id="Particle_filter:112">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mn>0</mn>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
    <mo>≤</mo>
    <mi>N</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\xi^{i}_{0}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

 with common probability distribution 

<math display="inline" id="Particle_filter:113">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>η</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{0}(dx_{0})=p(x_{0})dx_{0}
  </annotation>
 </semantics>
</math>

 . Suppose we have defined a sequence of 

<math display="inline" id="Particle_filter:114">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 random variables 

<math display="inline" id="Particle_filter:115">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>n</mi>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
    <mo>≤</mo>
    <mi>N</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\xi^{i}_{n}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Particle_filter:116">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>i</mi>
       <mo>≤</mo>
       <mi>N</mi>
      </mrow>
     </msub>
     <mrow>
      <msub>
       <mi>δ</mi>
       <msubsup>
        <mi>ξ</mi>
        <mi>n</mi>
        <mi>i</mi>
       </msubsup>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mrow>
    <msub>
     <mi>η</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>i</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ξ</ci>
          <ci>i</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{N}\sum_{1\leq i\leq N}\delta_{\xi^{i}_{n}}(dx_{n})~{}\approx_{N%
\uparrow\infty}~{}\eta_{n}(dx_{n})
  </annotation>
 </semantics>
</math>

 At the next step we sample 

<math display="inline" id="Particle_filter:117">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 (conditionally) independent random variables 

<math display="inline" id="Particle_filter:118">
 <semantics>
  <mrow>
   <msub>
    <mi>ξ</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>:=</mo>
   <msub>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ξ</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi_{n+1}:=\left(\xi^{i}_{n+1}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

 with common law .</p>

<p>

<math display="inline" id="Particle_filter:119">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>N</mi>
      </mfrac>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>i</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
       <msub>
        <mi>δ</mi>
        <msubsup>
         <mi>ξ</mi>
         <mi>n</mi>
         <mi>i</mi>
        </msubsup>
       </msub>
      </mrow>
     </mrow>
     <mo rspace="5.8pt">)</mo>
    </mrow>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mrow>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>η</mi>
      <mi>n</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>η</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <approx></approx>
      <apply>
       <ci>normal-↑</ci>
       <ci>N</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>N</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">1</cn>
           <ci>i</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>δ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ξ</ci>
           <ci>i</ci>
          </apply>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>η</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>η</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi_{n+1}\left(\frac{1}{N}\sum_{1\leq i\leq N}\delta_{\xi^{i}_{n}}\right)~{}%
\approx_{N\uparrow\infty}~{}\Phi_{n+1}\left(\eta_{n}\right)=\eta_{n+1}
  </annotation>
 </semantics>
</math>

</p>
<h4 id="a-particle-interpretation-of-the-filtering-equation">A particle interpretation of the filtering equation</h4>

<p>We illustrate this mean field particle principle in the context of the evolution of the one step optimal predictors</p>

<p> |Eq. 4}}</p>

<p>For k=0 we use the convention 

<math display="inline" id="Particle_filter:120">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{0}|y_{0},\dots,y_{-1}):=p(x_{0})
  </annotation>
 </semantics>
</math>

.</p>

<p>By the law of large numbers, we have</p>

<p>

<math display="inline" id="Particle_filter:121">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>p</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>d</mi>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mn>1</mn>
        <mo>≤</mo>
        <mi>i</mi>
        <mo>≤</mo>
        <mi>N</mi>
       </mrow>
      </msub>
      <mrow>
       <msub>
        <mi>δ</mi>
        <msubsup>
         <mi>ξ</mi>
         <mn>0</mn>
         <mi>i</mi>
        </msubsup>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mpadded width="+3.3pt">
     <msub>
      <mo>≈</mo>
      <mrow>
       <mi>N</mi>
       <mo>↑</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </msub>
    </mpadded>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <mtext>in the sense that</mtext>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mn>1</mn>
        <mo>≤</mo>
        <mi>i</mi>
        <mo>≤</mo>
        <mi>N</mi>
       </mrow>
      </msub>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>ξ</mi>
         <mn>0</mn>
         <mi>i</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <ci>normal-^</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>N</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">1</cn>
           <ci>i</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>δ</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>ξ</ci>
            <ci>i</ci>
           </apply>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <approx></approx>
       <apply>
        <ci>normal-↑</ci>
        <ci>N</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <ci>p</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <list>
       <mtext>in the sense that</mtext>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <ci>normal-^</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </list>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>N</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <and></and>
          <apply>
           <leq></leq>
           <cn type="integer">1</cn>
           <ci>i</ci>
          </apply>
          <apply>
           <leq></leq>
           <share href="#.cmml">
           </share>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ξ</ci>
           <ci>i</ci>
          </apply>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <approx></approx>
       <apply>
        <ci>normal-↑</ci>
        <ci>N</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <share href="#.cmml">
      </share>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>p</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{0})=\frac{1}{N}\sum_{1\leq i\leq N}\delta_{\xi^{i}_{0}}(dx_{0}%
)\approx_{N\uparrow\infty}~{}p(x_{0})dx_{0}\quad\mbox{in the sense that}\quad%
\int f(x_{0})\widehat{p}(dx_{0})=\frac{1}{N}\sum_{1\leq i\leq N}f(\xi^{i}_{0})%
\approx_{N\uparrow\infty}\int f(x_{0})p(dx_{0})dx_{0}
  </annotation>
 </semantics>
</math>

for any bounded function 

<math display="inline" id="Particle_filter:122">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

. We further assume that we have constructed a sequence of particles 

<math display="inline" id="Particle_filter:123">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
    <mo>≤</mo>
    <mi>N</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\xi^{i}_{k}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

 at some rank k such that</p>

<p>

<math display="inline" id="Particle_filter:124">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}|y_{0},\ldots,y_{k-1}):=\frac{1}{N}\sum_{1\leq i\leq N}%
\delta_{\xi^{i}_{k}}(dx_{k})\approx_{N\uparrow\infty}~{}p(x_{k}~{}|~{}y_{0},%
\ldots,y_{k-1})dx_{k}
  </annotation>
 </semantics>
</math>

in the sense that for any bounded function 

<math display="inline" id="Particle_filter:125">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 we have

<math display="inline" id="Particle_filter:126">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mo>≈</mo>
    <mrow>
     <mi>N</mi>
     <mo>↑</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int f(x_{k})\widehat{p}(dx_{k}~{}|~{}y_{0},\ldots,y_{k-1})=\frac{1}{N}\sum_{1%
\leq i\leq N}f(\xi^{i}_{k})\approx_{N\uparrow\infty}\int f(x_{k})p(dx_{k}|y_{0%
},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

In this situation, '''replacing 

<math display="inline" id="Particle_filter:127">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mo>≈</mo>
    <mrow>
     <mi>N</mi>
     <mo>↑</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>x</mi>
     <mi>k</mi>
     <mo>′</mo>
    </msubsup>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mo>′</mo>
       </msubsup>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mo>′</mo>
       </msubsup>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mpadded width="+3.3pt">
       <mstyle displaystyle="true">
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
       </mstyle>
      </mpadded>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>′′</mi>
       </msubsup>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>′′</mi>
       </msubsup>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>′′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>′′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k+1}|y_{0},\ldots,y_{k})\approx_{N\uparrow\infty}\int~{}p(x_{k+1}|x^{%
\prime}_{k})~{}\displaystyle\frac{p(y_{k}|x_{k}^{\prime})~{}\widehat{p}(dx^{%
\prime}_{k}|y_{0},\dots,y_{k-1})}{\displaystyle\int~{}p(y_{k}|x^{\prime\prime}%
_{k})~{}\widehat{p}(dx^{\prime\prime}_{k}|y_{0},\ldots,y_{k-1})}
  </annotation>
 </semantics>
</math>

</p></body></html>"&gt;p(x_k~|~y_0,\ldots,y_{k-1})~dx_k$ by the <a href="empirical_measure" title="wikilink">empirical measure</a> 

<math display="inline" id="Particle_filter:128">
 <semantics>
  <mrow>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>x</mi>
     <mi>k</mi>
     <mo>′</mo>
    </msubsup>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mo>′</mo>
       </msubsup>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mo>′</mo>
       </msubsup>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mpadded width="+3.3pt">
       <mstyle displaystyle="true">
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
       </mstyle>
      </mpadded>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>′′</mi>
       </msubsup>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>′′</mi>
       </msubsup>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mpadded width="+3.3pt">
    <mstyle displaystyle="true">
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>i</mi>
       <mo>≤</mo>
       <mi>N</mi>
      </mrow>
     </munder>
    </mstyle>
   </mpadded>
   <mpadded width="+6.6pt">
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mi>k</mi>
         <mi>i</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>j</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mi>k</mi>
         <mi>j</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>:</mo>
   <mover accent="true">
    <mi>q</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>′′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>′′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>normal-:</ci>
    <apply>
     <ci>normal-^</ci>
     <ci>q</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int~{}p(x_{k+1}|x^{\prime}_{k})~{}\displaystyle\frac{p(y_{k}|x_{k}^{\prime})~%
{}\widehat{p}(dx^{\prime}_{k}|y_{0},\dots,y_{k-1})}{\displaystyle\int~{}p(y_{k%
}|x^{\prime\prime}_{k})~{}\widehat{p}(dx^{\prime\prime}_{k}|y_{0},\ldots,y_{k-%
1})}=\sum_{1\leq i\leq N}~{}\frac{p(y_{k}~{}|~{}\xi^{i}_{k})}{\sum_{1\leq j%
\leq N}p(y_{k}~{}|~{}\xi^{j}_{k})}~{}~{}p(x_{k+1}~{}|~{}\xi^{i}_{k})=:\widehat%
{q}(x_{k+1}|y_{0},\ldots,y_{k})
  </annotation>
 </semantics>
</math>

"&gt;\widehat{p}(dx_k~|~y_0,\ldots,y_{k-1})$ in the evolution equation of the one-step optimal filter stated in () we find that

<p>

<math display="inline" id="Particle_filter:129">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k}~{}|~{}\xi^{i}_{k})
  </annotation>
 </semantics>
</math>

Notice that the right hand side in the above formula is a weighted probability mixture</p>

<p>

<math display="inline" id="Particle_filter:130">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k}~{}|~{}x_{k})
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Particle_filter:131">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\xi^{i}_{k}
  </annotation>
 </semantics>
</math>

 stands for the density 

<math display="inline" id="Particle_filter:132">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k+1}~{}|~{}\xi^{i}_{k})
  </annotation>
 </semantics>
</math>

 evaluated at 

<math display="inline" id="Particle_filter:133">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k+1}~{}|~{}x_{k})
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Particle_filter:134">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\xi^{i}_{k}
  </annotation>
 </semantics>
</math>

 stands for the density 

<math display="inline" id="Particle_filter:135">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,N.
  </annotation>
 </semantics>
</math>

 evaluated at 

<math display="inline" id="Particle_filter:136">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

, for 

<math display="inline" id="Particle_filter:137">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mn>1</mn>
    <mo>≤</mo>
    <mi>i</mi>
    <mo>≤</mo>
    <mi>N</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\xi^{i}_{k+1}\right)_{1\leq i\leq N}
  </annotation>
 </semantics>
</math>

</p>

<p>Then, we sample 

<math display="inline" id="Particle_filter:138">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>q</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>q</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{q}(x_{k+1}|y_{0},\ldots,y_{k})
  </annotation>
 </semantics>
</math>

 independent random variable 

<math display="inline" id="Particle_filter:139">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mover accent="true">
    <mi>q</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>q</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k+1}|y_{0},\ldots,y_{k}):=\frac{1}{N}\sum_{1\leq i\leq N}%
\delta_{\xi^{i}_{k+1}}(dx_{k+1})\approx_{N\uparrow\infty}~{}\widehat{q}(x_{k+1%
}~{}|~{}y_{0},\ldots,y_{k})dx_{k+1}\approx_{N\uparrow\infty}~{}p(x_{k+1}~{}|~{%
}y_{0},\ldots,y_{k})dx_{k+1}
  </annotation>
 </semantics>
</math>

 with common probability density 

<math display="inline" id="Particle_filter:140">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}|y_{0},\ldots,y_{k-1}):=\frac{1}{N}\sum_{1\leq i\leq N}%
\delta_{\xi^{i}_{k}}(dx_{k})\approx_{N\uparrow\infty}~{}p(dx_{k}~{}|~{}y_{0},%
\ldots,y_{k-1}):=p(x_{k}~{}|~{}y_{0},\ldots,y_{k-1})dx_{k}
  </annotation>
 </semantics>
</math>

 so that</p>

<p>

<math display="inline" id="Particle_filter:141">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="true">
       <mo largeop="true" symmetric="true">∫</mo>
      </mstyle>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mo>′</mo>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mo>′</mo>
       </msubsup>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mpadded width="+3.3pt">
    <mstyle displaystyle="true">
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>i</mi>
       <mo>≤</mo>
       <mi>N</mi>
      </mrow>
     </munder>
    </mstyle>
   </mpadded>
   <mpadded width="+3.3pt">
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mi>k</mi>
         <mi>i</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>j</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mi>k</mi>
         <mi>j</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
   </mpadded>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(dx_{k}|y_{0},\ldots,y_{k})~{}\approx_{N\uparrow\infty}~{}\displaystyle\frac{%
p(y_{k}|x_{k})~{}\widehat{p}(dx_{k}|y_{0},\ldots,y_{k-1})}{\displaystyle\int p%
(y_{k}|x^{\prime}_{k})\widehat{p}(dx^{\prime}_{k}|y_{0},\ldots,y_{k-1})}=\sum_%
{1\leq i\leq N}~{}\frac{p(y_{k}~{}|~{}\xi^{i}_{k})}{\sum_{1\leq j\leq N}p(y_{k%
}~{}|~{}\xi^{j}_{k})}~{}\delta_{\xi^{i}_{k}}(dx_{k})
  </annotation>
 </semantics>
</math>

Iterating this procedure, we design a Markov chain such that</p>

<p>

<math display="inline" id="Particle_filter:142">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(dx_{k}~{}|~{}y_{0},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

</p>

<p>Notice that the optimal filter is approximated at each time step k using the Bayes' formulae</p>

<p>

<math display="inline" id="Particle_filter:143">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}~{}|~{}y_{0},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

<strong>The terminology "mean field approximation" comes from the fact that we replace at each time step the probability measure</strong> <strong>

<math display="inline" id="Particle_filter:144">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <msub>
    <mover accent="true">
     <mi>I</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">f</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <int></int>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>I</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">f</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <int></int>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{k}(f):=\int f(x_{k})~{}p(dx_{k}|y_{0},\ldots,y_{k-1})~{}\approx_{N\uparrow%
\infty}~{}\widehat{I}_{k}(f):=\int f(x_{k})~{}\widehat{p}(dx_{k}|y_{0},\ldots,%
y_{k-1})~{}
  </annotation>
 </semantics>
</math>

</strong> <strong>by the empirical approximation</strong> <strong>

<math display="inline" id="Particle_filter:145">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>sup</mo>
      <mrow>
       <mi>k</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </msub>
     <mrow>
      <mo>|</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mover accent="true">
            <mi>I</mi>
            <mo>^</mo>
           </mover>
           <mi>k</mi>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>f</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>I</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
      <mo>/</mo>
      <mi>N</mi>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>sup</mo>
      <mrow>
       <mi>k</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </msub>
     <mrow>
      <mi>E</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mrow>
           <msub>
            <mover accent="true">
             <mi>I</mi>
             <mo>^</mo>
            </mover>
            <mi>k</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>f</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <msub>
            <mi>I</mi>
            <mi>k</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>f</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
     <mo>/</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">supremum</csymbol>
       <apply>
        <geq></geq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>E</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-^</ci>
            <ci>I</ci>
           </apply>
           <ci>k</ci>
          </apply>
          <ci>f</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>k</ci>
         </apply>
         <ci>f</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <list>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>N</ci>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">supremum</csymbol>
       <apply>
        <geq></geq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>E</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-^</ci>
             <ci>I</ci>
            </apply>
            <ci>k</ci>
           </apply>
           <ci>f</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>I</ci>
            <ci>k</ci>
           </apply>
           <ci>f</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sup_{k\geq 0}\left|E\left(\widehat{I}_{k}(f)\right)-I_{k}(f)\right|\leq{c_{1}%
}/{N}\quad\mbox{and}\quad\sup_{k\geq 0}E\left(\left[\widehat{I}_{k}(f)-I_{k}(f%
)\right]^{2}\right)\leq{c_{2}}/{N}
  </annotation>
 </semantics>
</math>

</strong>. The mean field particle approximation of the filtering problem is far from being unique. Several strategies are developed in the books.<a class="footnoteRef" href="#fn99" id="fnref99"><sup>99</sup></a><a class="footnoteRef" href="#fn100" id="fnref100"><sup>100</sup></a></p>
<h3 id="some-convergence-results">Some convergence results</h3>

<p>The analysis of the convergence of particle filters has been started in 1996<a class="footnoteRef" href="#fn101" id="fnref101"><sup>101</sup></a><a class="footnoteRef" href="#fn102" id="fnref102"><sup>102</sup></a> and in 2000 in the book<a class="footnoteRef" href="#fn103" id="fnref103"><sup>103</sup></a> and the series of articles.<a class="footnoteRef" href="#fn104" id="fnref104"><sup>104</sup></a><a class="footnoteRef" href="#fn105" id="fnref105"><sup>105</sup></a><a class="footnoteRef" href="#fn106" id="fnref106"><sup>106</sup></a><a class="footnoteRef" href="#fn107" id="fnref107"><sup>107</sup></a><a class="footnoteRef" href="#fn108" id="fnref108"><sup>108</sup></a><a class="footnoteRef" href="#fn109" id="fnref109"><sup>109</sup></a><a class="footnoteRef" href="#fn110" id="fnref110"><sup>110</sup></a> More recent developments can be found in the books,<a class="footnoteRef" href="#fn111" id="fnref111"><sup>111</sup></a><a class="footnoteRef" href="#fn112" id="fnref112"><sup>112</sup></a> When the filtering equation is stable (in the sense that it corrects any erroneous initial condition), the bias and the variance of the particle particle estimates</p>

<p>

<math display="inline" id="Particle_filter:146">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo><</mo>
    <mpadded width="+3.3pt">
     <mi mathvariant="normal">∞</mi>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </list>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1},c_{2}<\infty~{}.
  </annotation>
 </semantics>
</math>

 are controlled by the non asymptotic uniform estimates

<math display="inline" id="Particle_filter:147">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\geq 0
  </annotation>
 </semantics>
</math>

for any function f(.) bounded by 1, and for some finite constants 

<math display="inline" id="Particle_filter:148">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>I</mi>
         <mo>^</mo>
        </mover>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>I</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>f</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mrow>
       <mpadded width="+3.3pt">
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mfrac>
        <mi>x</mi>
        <mi>N</mi>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mpadded width="+3.3pt">
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
       </mpadded>
       <msqrt>
        <mfrac>
         <mi>x</mi>
         <mi>N</mi>
        </mfrac>
       </msqrt>
      </mrow>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>sup</mo>
      <mrow>
       <mn>0</mn>
       <mo>≤</mo>
       <mi>k</mi>
       <mo>≤</mo>
       <mi>n</mi>
      </mrow>
     </msub>
     <mrow>
      <mo>|</mo>
      <mrow>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>I</mi>
          <mo>^</mo>
         </mover>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>I</mi>
         <mi>k</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mi>c</mi>
     </mpadded>
     <msqrt>
      <mfrac>
       <mrow>
        <mi>x</mi>
        <mrow>
         <mi>log</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>n</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mi>N</mi>
      </mfrac>
     </msqrt>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>I</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>f</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>k</ci>
        </apply>
        <ci>f</ci>
       </apply>
      </apply>
     </apply>
     <list>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <divide></divide>
         <ci>x</ci>
         <ci>N</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <root></root>
         <apply>
          <divide></divide>
          <ci>x</ci>
          <ci>N</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">supremum</csymbol>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">0</cn>
         <ci>k</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>I</ci>
          </apply>
          <ci>k</ci>
         </apply>
         <ci>f</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>k</ci>
         </apply>
         <ci>f</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>x</ci>
         <apply>
          <log></log>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\widehat{I}_{k}(f)-I_{k}(f)\right|\leq c_{1}~{}\frac{x}{N}+c_{2}~{}\sqrt%
{\frac{x}{N}}\quad\mbox{and}\quad\sup_{0\leq k\leq n}\left|\widehat{I}_{k}(f)-%
I_{k}(f)\right|\leq c~{}\sqrt{\frac{x\log(n)}{N}}
  </annotation>
 </semantics>
</math>

 In addition, for any 

<math display="inline" id="Particle_filter:149">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-e^{-x}
  </annotation>
 </semantics>
</math>

, the probability that

<math display="inline" id="Particle_filter:150">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+3.3pt">
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
    </mpadded>
    <mpadded width="+3.3pt">
     <mtext>and</mtext>
    </mpadded>
    <msub>
     <mi>c</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo><</mo>
   <mpadded width="+3.3pt">
    <mi mathvariant="normal">∞</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <mtext>and</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1}~{}\mbox{and}~{}c_{2}<\infty~{}
  </annotation>
 </semantics>
</math>

is larger than 

<math display="inline" id="Particle_filter:151">
 <semantics>
  <mrow>
   <mo>(</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <cn type="integer">0</cn>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <cn type="integer">1</cn>
      <ci>k</ci>
     </list>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <list>
      <ci>k</ci>
      <ci>k</ci>
     </list>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\widehat{\xi}^{i}_{0,k},\widehat{\xi}^{i}_{1,k},\ldots,\widehat{\xi}^{i}%
_{k-1,k},\widehat{\xi}^{i}_{k,k}\right)
  </annotation>
 </semantics>
</math>

 , for some finite constants 

<math display="inline" id="Particle_filter:152">
 <semantics>
  <mrow>
   <mo>(</mo>
   <msubsup>
    <mi>ξ</mi>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <msubsup>
    <mi>ξ</mi>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msubsup>
    <mi>ξ</mi>
    <mrow>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
   <mo>,</mo>
   <msub>
    <mi>ξ</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <list>
      <cn type="integer">0</cn>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <list>
      <cn type="integer">1</cn>
      <ci>k</ci>
     </list>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <list>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>k</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ξ</ci>
     <list>
      <ci>k</ci>
      <ci>k</ci>
     </list>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\xi^{i}_{0,k},\xi^{i}_{1,k},\ldots,\xi^{i}_{k-1,k},\xi_{k,k}\right)
  </annotation>
 </semantics>
</math>

 related to the asymptotic bias and variance of the particle estimate, and some finite constant c. The same results are satisfied if we replace the one step optimal predictor by the optimal filter approximation.</p>
<h2 id="genealogical-trees-and-unbiasedness-properties">Genealogical trees and Unbiasedness properties</h2>
<h3 id="genealogical-tree-based-particle-smoothing">Genealogical tree based particle smoothing</h3>

<p>Tracing back in time the ancestral lines 

<math display="inline" id="Particle_filter:153">
 <semantics>
  <mrow>
   <msubsup>
    <mover accent="true">
     <mi>ξ</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi></mi>
     <mo>=</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ξ</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <list>
       <ci>k</ci>
       <ci>k</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\xi}^{i}_{k}\left(=\widehat{\xi}^{i}_{k,k}\right)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:154">
 <semantics>
  <mrow>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
   <mspace width="veryverythickmathspace">
   </mspace>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi></mi>
     <mo>=</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">annotated</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <ci>k</ci>
       <ci>k</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\xi}^{i}_{k}\left(={\xi}^{i}_{k,k}\right)
  </annotation>
 </semantics>
</math>

 of the individuals 

<math display="inline" id="Particle_filter:155">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msubsup>
      <mover accent="true">
       <mi>ξ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ξ</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </list>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-^</ci>
         <ci>ξ</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </list>
      </apply>
     </vector>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k}):=\frac{1}{N}\sum_{%
1\leq i\leq N}\delta_{\left(\widehat{\xi}^{i}_{0,k},\ldots,\widehat{\xi}^{i}_{%
0,k}\right)}(d(x_{0},\ldots,x_{k}))~{}~{}\approx_{N\uparrow\infty}~{}~{}p(d(x_%
{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:156">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mpadded width="+3.3pt">
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </msub>
   </mpadded>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msubsup>
        <mi>ξ</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
        <mi>i</mi>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="false">
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>j</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
      </mstyle>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msubsup>
        <mi>ξ</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
        <mi>j</mi>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <list>
         <ci>k</ci>
         <ci>k</ci>
        </list>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <list>
         <ci>k</ci>
         <ci>k</ci>
        </list>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </list>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </list>
      </apply>
     </vector>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k})~{}\approx_{N\uparrow\infty}~%
{}~{}\sum_{1\leq i\leq N}~{}\frac{p(y_{k}~{}|~{}\xi^{i}_{k,k})}{\sum_{1\leq j%
\leq N}p(y_{k}~{}|~{}\xi^{j}_{k,k})}~{}\delta_{\left(\xi^{i}_{0,k},\ldots,\xi^%
{i}_{0,k}\right)}(d(x_{0},\ldots,x_{k}))
  </annotation>
 </semantics>
</math>

 at every time step k, we also have the particle approximations</p>

<p>

<math display="inline" id="Particle_filter:157">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msubsup>
      <mi>ξ</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
      <mi>i</mi>
     </msubsup>
     <mo>)</mo>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <ci>k</ci>
       </list>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <list>
        <ci>k</ci>
        <ci>k</ci>
       </list>
      </apply>
     </vector>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-,</ci>
    <ci>normal-…</ci>
    <ci>normal-,</ci>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k-1}):=\frac{1}{N}\sum%
_{1\leq i\leq N}\delta_{\left(\xi^{i}_{0,k},\ldots,\xi^{i}_{k,k}\right)}(d(x_{%
0},\ldots,x_{k}))~{}~{}\approx_{N\uparrow\infty}~{}~{}p(d(x_{0},\ldots,x_{k})~%
{}|~{}y_{0},\ldots,y_{k-1}):=p(x_{0},\ldots,x_{k}~{}|~{}y_{0},\ldots,y_{k-1})~%
{}dx_{0},\ldots,dx_{k}
  </annotation>
 </semantics>
</math>

and</p>

<p>

<math display="inline" id="Particle_filter:158">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msubsup>
     <mover accent="true">
      <mi>ξ</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo rspace="9.1pt">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <list>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ξ</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <list>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int F(x_{0},\ldots,x_{n})~{}\widehat{p}(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},%
\ldots,y_{k}):=\frac{1}{N}\sum_{1\leq i\leq N}F\left(\widehat{\xi}^{i}_{0,k},%
\ldots,\widehat{\xi}^{i}_{0,k}\right)~{}~{}\approx_{N\uparrow\infty}~{}~{}\int%
~{}F(x_{0},\ldots,x_{n})~{}p(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k})
  </annotation>
 </semantics>
</math>

and finally</p>

<p>

<math display="inline" id="Particle_filter:159">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mpadded width="+3.3pt">
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </msub>
   </mpadded>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msubsup>
        <mi>ξ</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
        <mi>i</mi>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="false">
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>j</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
      </mstyle>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msubsup>
        <mi>ξ</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
        <mi>j</mi>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <list>
         <ci>k</ci>
         <ci>k</ci>
        </list>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <list>
         <ci>k</ci>
         <ci>k</ci>
        </list>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <ci>k</ci>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int F(x_{0},\ldots,x_{n})~{}p(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k})%
~{}\approx_{N\uparrow\infty}~{}~{}\sum_{1\leq i\leq N}~{}\frac{p(y_{k}~{}|~{}%
\xi^{i}_{k,k})}{\sum_{1\leq j\leq N}p(y_{k}~{}|~{}\xi^{j}_{k,k})}~{}F\left(\xi%
^{i}_{0,k},\xi^{i}_{1,k},\ldots,\xi^{i}_{k,k}\right)
  </annotation>
 </semantics>
</math>

These empirical approximations are equivalent to the particle integral approximations</p>

<p>

<math display="inline" id="Particle_filter:160">
 <semantics>
  <mrow>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo rspace="9.1pt">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <ci>k</ci>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int~{}F(x_{0},\ldots,x_{n})~{}\widehat{p}(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},%
\ldots,y_{k-1}):=\frac{1}{N}\sum_{1\leq i\leq N}F\left(\xi^{i}_{0,k},\ldots,%
\xi^{i}_{k,k}\right)~{}~{}\approx_{N\uparrow\infty}~{}~{}\int~{}F(x_{0},\ldots%
,x_{n})~{}p(d(x_{0},\ldots,x_{k})~{}|~{}y_{0},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

and</p>

<p>

<math display="inline" id="Particle_filter:161">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo largeop="true" symmetric="true">∏</mo>
    <mrow>
     <mn>0</mn>
     <mo>≤</mo>
     <mi>k</mi>
     <mo>≤</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mtext>with</mtext>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <mtext>with</mtext>
    <ci></ci>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{0},\ldots,y_{n})=\prod_{0\leq k\leq n}p(y_{k}|y_{0},\ldots,y_{k-1})\quad%
\mbox{with}\quad p(y_{k}|y_{0},\ldots,y_{k-1})=\int~{}p(y_{k}|x_{k})~{}p(dx_{k%
}|y_{0},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

and finally</p>

<p>

<math display="inline" id="Particle_filter:162">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{0}|y_{0},\ldots,y_{-1})=p(y_{0})
  </annotation>
 </semantics>
</math>

</p>

<p>for any bounded function F on the random trajectories of the signal. As shown in<a class="footnoteRef" href="#fn113" id="fnref113"><sup>113</sup></a> the evolution of the genealogical tree coincides with a mean field particle interpretation of the evolution equations associated with the posterior densities of the signal trajectories. For more details on these path space models, we refer to the books.<a class="footnoteRef" href="#fn114" id="fnref114"><sup>114</sup></a><a class="footnoteRef" href="#fn115" id="fnref115"><sup>115</sup></a></p>
<h3 id="unbiased-particle-estimates-of-likelihood-functions">Unbiased particle estimates of likelihood functions</h3>

<p>We use the product formula

<math display="inline" id="Particle_filter:163">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{0}|y_{0},\ldots,y_{-1})=p(x_{0})
  </annotation>
 </semantics>
</math>

with the conventions 

<math display="inline" id="Particle_filter:164">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}|y_{0},\ldots,y_{k-1})dx_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:165">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}~{}|~{}y_{0},\ldots,y_{k-1}):=\frac{1}{N}\sum_{1\leq i\leq N%
}\delta_{\xi^{i}_{k}}(dx_{k})~{}~{}\approx_{N\uparrow\infty}~{}~{}p(dx_{k}~{}|%
~{}y_{0},\ldots,y_{k-1})
  </annotation>
 </semantics>
</math>

 , for k=0. Replacing 

<math display="inline" id="Particle_filter:166">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="9.1pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+6.6pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo largeop="true" symmetric="true">∏</mo>
    <mrow>
     <mn>0</mn>
     <mo>≤</mo>
     <mi>k</mi>
     <mo>≤</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mtext>with</mtext>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <mpadded width="+3.3pt">
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">product</csymbol>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <mtext>with</mtext>
    <ci></ci>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{0},\ldots,y_{n})~{}~{}\approx_{N\uparrow\infty}~{}~{}\widehat{p}(y_{0},%
\ldots,y_{n})=\prod_{0\leq k\leq n}\widehat{p}(y_{k}|y_{0},\ldots,y_{k-1})%
\quad\mbox{with}\quad\widehat{p}(y_{k}|y_{0},\ldots,y_{k-1})=\int~{}p(y_{k}|x_%
{k})~{}\widehat{p}(dx_{k}|y_{0},\ldots,y_{k-1})=\frac{1}{N}\sum_{1\leq i\leq N%
}~{}p(y_{k}|\xi^{i}_{k})
  </annotation>
 </semantics>
</math>

 by the <a href="empirical_measure" title="wikilink">empirical</a> approximation</p>

<p>

<math display="inline" id="Particle_filter:167">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k}~{}|~{}\xi^{i}_{k})
  </annotation>
 </semantics>
</math>

in the above displayed formula, we design the following unbiased particle approximation of the likelihood function</p>

<p>

<math display="inline" id="Particle_filter:168">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>y</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k}~{}|~{}x_{k})
  </annotation>
 </semantics>
</math>

where 

<math display="inline" id="Particle_filter:169">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\xi^{i}_{k}
  </annotation>
 </semantics>
</math>

 stands for the density 

<math display="inline" id="Particle_filter:170">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
        <mo rspace="5.8pt" stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mo>=</mo>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mo>×</mo>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="9.1pt" stretchy="false">)</mo>
      </mrow>
      <mpadded width="+6.6pt">
       <mi mathvariant="normal">…</mi>
      </mpadded>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <eq></eq>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <times></times>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-…</ci>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{l}p((x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))\\
\\
=p(x_{n}~{}|~{}(y_{0},\ldots,y_{n-1}))~{}p(x_{n-1}~{}|~{}x_{n},(y_{0},\ldots,y%
_{n-1}))~{}\times p(x_{n-2}~{}|~{}x_{n-1},(y_{0},\ldots,y_{n-2}))~{}~{}\ldots~%
{}~{}p(x_{1}~{}|~{}x_{2},(y_{0},y_{1}))~{}p(x_{0}~{}|~{}x_{1},y_{0})\end{array}
  </annotation>
 </semantics>
</math>

 evaluated at 

<math display="inline" id="Particle_filter:171">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mtext>and</mtext>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∝</mo>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mpadded width="+3.3pt">
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mpadded>
     <mo rspace="5.8pt" stretchy="false">|</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <mtext>and</mtext>
    <ci></ci>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="latexml">proportional-to</csymbol>
     <csymbol cd="unknown">p</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="unknown">p</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-|</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k-1}~{}|~{}x_{k},(y_{0},\ldots,y_{k-1}))\propto p(x_{k}~{}|~{}x_{k-1})~{}%
p(x_{k-1}~{}|~{}(y_{0},\ldots,y_{k-1}))\quad\mbox{and}\quad p(x_{k-1}~{}|~{}(y%
_{0},\ldots,y_{k-1})\propto p(y_{k-1}|x_{k-1})~{}p(x_{k-1}~{}|~{}(y_{0},\ldots%
,y_{k-2})
  </annotation>
 </semantics>
</math>

. The design of this particle estimate and the unbiasedness property has been proved in 1996 in the article.<a class="footnoteRef" href="#fn116" id="fnref116"><sup>116</sup></a> Refined variance estimates can be found in<a class="footnoteRef" href="#fn117" id="fnref117"><sup>117</sup></a> and.<a class="footnoteRef" href="#fn118" id="fnref118"><sup>118</sup></a></p>
<h3 id="backward-particle-smoothers">Backward particle smoothers</h3>

<p>Using Bayes' rule, we have the formula</p>

<p>

<math display="inline" id="Particle_filter:172">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mpadded width="+3.3pt">
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
      </mpadded>
      <mo rspace="5.8pt" stretchy="false">|</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mpadded width="+3.3pt">
      <mstyle scriptlevel="-1">
       <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
      </mstyle>
     </mpadded>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
      <msubsup>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>′</mo>
      </msubsup>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mpadded width="+3.3pt">
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
      </mpadded>
      <mo rspace="5.8pt" stretchy="false">|</mo>
      <msubsup>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>′</mo>
      </msubsup>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>′</mo>
      </msubsup>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <msubsup>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">d</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </cerror>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k-1}~{}|~{}x_{k},(y_{0},\ldots,y_{k-1}))=\frac{p(y_{k-1}|x_{k-1})~{}p(x_{%
k}~{}|~{}x_{k-1})~{}p(x_{k-1}|y_{0},\ldots,y_{k-2})}{\int~{}p(y_{k-1}|x^{%
\prime}_{k-1})~{}p(x_{k}~{}|~{}x^{\prime}_{k-1})~{}p(x^{\prime}_{k-1}|y_{0},%
\ldots,y_{k-2})~{}dx^{\prime}_{k-1}}
  </annotation>
 </semantics>
</math>

Notice that</p>

<p>

<math display="inline" id="Particle_filter:173">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k-1}~{}|~{}(y_{0},\ldots,y_{k-2}))dx_{k-1}
  </annotation>
 </semantics>
</math>

This implies that</p>

<p>

<math display="inline" id="Particle_filter:174">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo>(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mo>≈</mo>
      <mrow>
       <mi>N</mi>
       <mo>↑</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </msub>
    </mpadded>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>d</mi>
     <mpadded width="+3.3pt">
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mpadded>
     <mo rspace="5.8pt" stretchy="false">|</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>:=</mo>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mpadded width="+3.3pt">
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mpadded>
     <mo rspace="5.8pt" stretchy="false">|</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <approx></approx>
      <apply>
       <ci>normal-↑</ci>
       <ci>N</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <csymbol cd="unknown">p</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">d</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-|</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="latexml">assign</csymbol>
     <csymbol cd="unknown">p</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-|</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-,</ci>
       <ci>normal-…</ci>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k-1}~{}|~{}(y_{0},\ldots,y_{k-2}))=\frac{1}{N}\sum_{1\leq i%
\leq N}\delta_{\xi^{i}_{k-1}}(dx_{k-1})~{}\left(\approx_{N\uparrow\infty}~{}{p%
}(dx_{k-1}~{}|~{}(y_{0},\ldots,y_{k-2})):={p}(x_{k-1}~{}|~{}(y_{0},\ldots,y_{k%
-2}))~{}dx_{k-1}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Replacing the one-step optimal predictors 

<math display="inline" id="Particle_filter:175">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mtable align="top">
    <mtr>
     <mtd columnalign="right">
      <mrow>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>d</mi>
        <mpadded width="+3.3pt">
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>k</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo>,</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>y</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>k</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi></mi>
       <mo>:</mo>
       <mo>=</mo>
      </mrow>
     </mtd>
     <mtd columnalign="left">
      <mstyle displaystyle="true">
       <mfrac>
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>y</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo stretchy="false">|</mo>
          <msub>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo rspace="5.8pt" stretchy="false">)</mo>
         </mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mpadded width="+3.3pt">
           <msub>
            <mi>x</mi>
            <mi>k</mi>
           </msub>
          </mpadded>
          <mo rspace="5.8pt" stretchy="false">|</mo>
          <msub>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo rspace="5.8pt" stretchy="false">)</mo>
         </mrow>
         <mover accent="true">
          <mi>p</mi>
          <mo>^</mo>
         </mover>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>d</mi>
          <msub>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo stretchy="false">|</mo>
          <msub>
           <mi>y</mi>
           <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">…</mi>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>2</mn>
           </mrow>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mrow>
         <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>y</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo stretchy="false">|</mo>
          <msubsup>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo>′</mo>
          </msubsup>
          <mo rspace="5.8pt" stretchy="false">)</mo>
         </mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mpadded width="+3.3pt">
           <msub>
            <mi>x</mi>
            <mi>k</mi>
           </msub>
          </mpadded>
          <mo rspace="5.8pt" stretchy="false">|</mo>
          <msubsup>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo>′</mo>
          </msubsup>
          <mo rspace="5.8pt" stretchy="false">)</mo>
         </mrow>
         <mover accent="true">
          <mi>p</mi>
          <mo>^</mo>
         </mover>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>d</mi>
          <msubsup>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo>′</mo>
          </msubsup>
          <mo stretchy="false">|</mo>
          <msub>
           <mi>y</mi>
           <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">…</mi>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>2</mn>
           </mrow>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mstyle>
     </mtd>
    </mtr>
    <mtr>
     <mtd></mtd>
     <mtd></mtd>
     <mtd></mtd>
    </mtr>
    <mtr>
     <mtd></mtd>
     <mtd columnalign="center">
      <mo>=</mo>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mstyle displaystyle="true">
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mn>1</mn>
          <mo>≤</mo>
          <mi>i</mi>
          <mo>≤</mo>
          <mi>N</mi>
         </mrow>
        </munder>
       </mstyle>
       <mrow>
        <mpadded width="+3.3pt">
         <mstyle displaystyle="true">
          <mfrac>
           <mrow>
            <mi>p</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>y</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msub>
             <mo stretchy="false">|</mo>
             <msubsup>
              <mi>ξ</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
              <mi>i</mi>
             </msubsup>
             <mo rspace="5.8pt" stretchy="false">)</mo>
            </mrow>
            <mi>p</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mpadded width="+3.3pt">
              <msub>
               <mi>x</mi>
               <mi>k</mi>
              </msub>
             </mpadded>
             <mo rspace="5.8pt" stretchy="false">|</mo>
             <msubsup>
              <mi>ξ</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
              <mi>i</mi>
             </msubsup>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mrow>
            <msub>
             <mo largeop="true" symmetric="true">∑</mo>
             <mrow>
              <mn>1</mn>
              <mo>≤</mo>
              <mi>j</mi>
              <mo>≤</mo>
              <mi>N</mi>
             </mrow>
            </msub>
            <mi>p</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>y</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
             </msub>
             <mo stretchy="false">|</mo>
             <msubsup>
              <mi>ξ</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
              <mi>j</mi>
             </msubsup>
             <mo rspace="5.8pt" stretchy="false">)</mo>
            </mrow>
            <mi>p</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mpadded width="+3.3pt">
              <msub>
               <mi>x</mi>
               <mi>k</mi>
              </msub>
             </mpadded>
             <mo rspace="5.8pt" stretchy="false">|</mo>
             <msubsup>
              <mi>ξ</mi>
              <mrow>
               <mi>k</mi>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
              <mi>j</mi>
             </msubsup>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mfrac>
         </mstyle>
        </mpadded>
        <msub>
         <mi>δ</mi>
         <msubsup>
          <mi>ξ</mi>
          <mrow>
           <mi>k</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mi>i</mi>
         </msubsup>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>x</mi>
           <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>p</ci>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <csymbol cd="unknown">d</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-,</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-,</ci>
         <ci>normal-…</ci>
         <ci>normal-,</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
      <apply>
       <ci>normal-:</ci>
       <csymbol cd="latexml">absent</csymbol>
       <eq></eq>
      </apply>
      <apply>
       <divide></divide>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <apply>
         <ci>normal-^</ci>
         <ci>p</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <csymbol cd="unknown">d</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-,</ci>
         <ci>normal-…</ci>
         <ci>normal-,</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <int></int>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <apply>
         <ci>normal-^</ci>
         <ci>p</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <csymbol cd="unknown">d</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>normal-|</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-,</ci>
         <ci>normal-…</ci>
         <ci>normal-,</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
      </apply>
     </matrixrow>
     <matrixrow>
      <cerror>
       <csymbol cd="ambiguous">missing-subexpression</csymbol>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">missing-subexpression</csymbol>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">missing-subexpression</csymbol>
      </cerror>
     </matrixrow>
     <matrixrow>
      <cerror>
       <csymbol cd="ambiguous">missing-subexpression</csymbol>
      </cerror>
      <eq></eq>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <and></and>
         <apply>
          <leq></leq>
          <cn type="integer">1</cn>
          <ci>i</ci>
         </apply>
         <apply>
          <leq></leq>
          <share href="#.cmml">
          </share>
          <ci>N</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <csymbol cd="unknown">p</csymbol>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <ci>normal-(</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>normal-|</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ξ</ci>
             <ci>i</ci>
            </apply>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>normal-)</ci>
          </cerror>
          <csymbol cd="unknown">p</csymbol>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <ci>normal-(</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>k</ci>
           </apply>
           <ci>normal-|</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ξ</ci>
             <ci>i</ci>
            </apply>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>normal-)</ci>
          </cerror>
         </cerror>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <and></and>
            <apply>
             <leq></leq>
             <cn type="integer">1</cn>
             <ci>j</ci>
            </apply>
            <apply>
             <leq></leq>
             <share href="#.cmml">
             </share>
             <ci>N</ci>
            </apply>
           </apply>
          </apply>
          <csymbol cd="unknown">p</csymbol>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <ci>normal-(</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>normal-|</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ξ</ci>
             <ci>j</ci>
            </apply>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>normal-)</ci>
          </cerror>
          <csymbol cd="unknown">p</csymbol>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <ci>normal-(</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>k</ci>
           </apply>
           <ci>normal-|</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ξ</ci>
             <ci>j</ci>
            </apply>
            <apply>
             <minus></minus>
             <ci>k</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>normal-)</ci>
          </cerror>
         </cerror>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>δ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ξ</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(dx_{k-1}~{}|~{}x_{k},(y_{0},\ldots,y_{k-1}))\approx_{N\uparrow\infty}~{}%
\begin{array}[t]{rcl}\widehat{p}(dx_{k-1}~{}|~{}x_{k},(y_{0},\ldots,y_{k-1}))&%
:=&\displaystyle\frac{p(y_{k-1}|x_{k-1})~{}p(x_{k}~{}|~{}x_{k-1})~{}\widehat{p%
}(dx_{k-1}|y_{0},\ldots,y_{k-2})}{\int~{}p(y_{k-1}|x^{\prime}_{k-1})~{}p(x_{k}%
~{}|~{}x^{\prime}_{k-1})~{}\widehat{p}(dx^{\prime}_{k-1}|y_{0},\ldots,y_{k-2})%
}\\
&&\\
&=&\displaystyle\sum_{1\leq i\leq N}\frac{p(y_{k-1}|\xi^{i}_{k-1})~{}p(x_{k}~{%
}|~{}\xi^{i}_{k-1})}{\sum_{1\leq j\leq N}p(y_{k-1}|\xi^{j}_{k-1})~{}p(x_{k}~{}%
|~{}\xi^{j}_{k-1})}~{}\delta_{\xi^{i}_{k-1}}(dx_{k-1})\end{array}
  </annotation>
 </semantics>
</math>

 by the particle <a href="empirical_measure" title="wikilink">empirical measures</a> 

<math display="inline" id="Particle_filter:176">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mo>≈</mo>
    <mrow>
     <mi>N</mi>
     <mo>↑</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>b</mi>
     <mi>a</mi>
     <mi>c</mi>
     <mi>k</mi>
     <mi>w</mi>
     <mi>a</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>a</ci>
      <ci>c</ci>
      <ci>k</ci>
      <ci>w</ci>
      <ci>a</ci>
      <ci>r</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))\approx_{N\uparrow\infty}%
\widehat{p}_{backward}(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))
  </annotation>
 </semantics>
</math>

 we find that</p>

<p>

<math display="inline" id="Particle_filter:177">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mi>b</mi>
        <mi>a</mi>
        <mi>c</mi>
        <mi>k</mi>
        <mi>w</mi>
        <mi>a</mi>
        <mi>r</mi>
        <mi>d</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
        <mo rspace="5.8pt" stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mo>=</mo>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mo>×</mo>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="9.1pt" stretchy="false">)</mo>
      </mrow>
      <mpadded width="+6.6pt">
       <mi mathvariant="normal">…</mi>
      </mpadded>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>a</ci>
        <ci>c</ci>
        <ci>k</ci>
        <ci>w</ci>
        <ci>a</ci>
        <ci>r</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <eq></eq>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-…</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{l}\widehat{p}_{backward}(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},%
\ldots,y_{n-1}))\\
\\
=\widehat{p}(dx_{n}~{}|~{}(y_{0},\ldots,y_{n-1}))~{}\widehat{p}(dx_{n-1}~{}|~{%
}x_{n},(y_{0},\ldots,y_{n-1}))~{}\times\widehat{p}(dx_{n-2}~{}|~{}x_{n-1},(y_{%
0},\ldots,y_{n-2}))~{}~{}\ldots~{}~{}\widehat{p}(dx_{1}~{}|~{}x_{2},(y_{0},y_{%
1}))~{}\widehat{p}(dx_{0}~{}|~{}x_{1},y_{0})\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>We conclude that

<math display="inline" id="Particle_filter:178">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>b</mi>
     <mi>a</mi>
     <mi>c</mi>
     <mi>k</mi>
     <mi>w</mi>
     <mi>a</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>a</ci>
      <ci>c</ci>
      <ci>k</ci>
      <ci>w</ci>
      <ci>a</ci>
      <ci>r</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}_{backward}(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))
  </annotation>
 </semantics>
</math>

with the backward particle approximation</p>

<p>

<math display="inline" id="Particle_filter:179">
 <semantics>
  <msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>𝕏</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>n</mi>
     </mrow>
     <mi mathvariant="normal">♭</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <mi>k</mi>
    <mo>≤</mo>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝕏</ci>
      <ci>normal-♭</ci>
     </apply>
     <list>
      <ci>k</ci>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">0</cn>
      <ci>k</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\mathbb{X}^{\flat}_{k,n}\right)_{0\leq k\leq n}
  </annotation>
 </semantics>
</math>

</p>

<p>The probability measure 

<math display="inline" id="Particle_filter:180">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msubsup>
       <mi>ξ</mi>
       <mi>k</mi>
       <mi>i</mi>
      </msubsup>
      <mo rspace="5.8pt">,</mo>
      <mrow>
       <mpadded width="+3.3pt">
        <mtext>with</mtext>
       </mpadded>
       <mi>i</mi>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ξ</ci>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <mtext>with</mtext>
       <ci>i</ci>
      </apply>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi^{i}_{k},~{}\mbox{with}~{}i=1,\ldots,N.
  </annotation>
 </semantics>
</math>

 is the probability of the random paths of a Markov chain 

<math display="inline" id="Particle_filter:181">
 <semantics>
  <msubsup>
   <mi>𝕏</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
   <mi mathvariant="normal">♭</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝕏</ci>
     <ci>normal-♭</ci>
    </apply>
    <list>
     <ci>n</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{X}^{\flat}_{n,n}
  </annotation>
 </semantics>
</math>

running backward in time from time k=n to time k=0, and evolving at each time step k in the state space associated with the population of particles 

<math display="inline" id="Particle_filter:182">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mi>n</mi>
     <mi>i</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{n}~{}|~{}(y_{0},\ldots,y_{n-1}))=\frac{1}{N}\sum_{1\leq i\leq N%
}\delta_{\xi^{i}_{n}}(dx_{n})
  </annotation>
 </semantics>
</math>

</p>
<ul>
<li>Initially (at time k=n) the chain 

<math display="inline" id="Particle_filter:183">
 <semantics>
  <mrow>
   <msubsup>
    <mi>𝕏</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>n</mi>
    </mrow>
    <mi mathvariant="normal">♭</mi>
   </msubsup>
   <mo>=</mo>
   <mpadded width="+3.3pt">
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <mtext>for some</mtext>
    </mpadded>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝕏</ci>
      <ci>normal-♭</ci>
     </apply>
     <list>
      <ci>k</ci>
      <ci>n</ci>
     </list>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <mtext>for some</mtext>
     <csymbol cd="unknown">i</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">N</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{X}^{\flat}_{k,n}=\xi^{i}_{k}~{}(\mbox{for some}~{}i=1,\ldots,N)
  </annotation>
 </semantics>
</math>

 chooses randomly a state with the distribution

<math display="inline" id="Particle_filter:184">
 <semantics>
  <msubsup>
   <mi>𝕏</mi>
   <mrow>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
   <mi mathvariant="normal">♭</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝕏</ci>
     <ci>normal-♭</ci>
    </apply>
    <list>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{X}^{\flat}_{k-1,n}
  </annotation>
 </semantics>
</math>

</li>
<li>From time k to the time (k-1), the chain starting at some state 

<math display="inline" id="Particle_filter:185">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>j</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </munder>
   </mstyle>
   <mpadded width="+3.3pt">
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mi>j</mi>
        </msubsup>
        <mo rspace="5.8pt" stretchy="false">)</mo>
       </mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msubsup>
          <mi>ξ</mi>
          <mi>k</mi>
          <mi>i</mi>
         </msubsup>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mi>j</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mstyle displaystyle="true">
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mn>1</mn>
          <mo>≤</mo>
          <mi>l</mi>
          <mo>≤</mo>
          <mi>N</mi>
         </mrow>
        </munder>
       </mstyle>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mi>l</mi>
        </msubsup>
        <mo rspace="5.8pt" stretchy="false">)</mo>
       </mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mpadded width="+3.3pt">
         <msubsup>
          <mi>ξ</mi>
          <mi>k</mi>
          <mi>i</mi>
         </msubsup>
        </mpadded>
        <mo rspace="5.8pt" stretchy="false">|</mo>
        <msubsup>
         <mi>ξ</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mi>l</mi>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
   </mpadded>
   <msub>
    <mi>δ</mi>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>j</mi>
    </msubsup>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>j</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>l</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k-1}~{}|~{}\xi^{i}_{k},(y_{0},\ldots,y_{k-1}))=\displaystyle%
\sum_{1\leq j\leq N}\frac{p(y_{k-1}|\xi^{j}_{k-1})~{}p(\xi^{i}_{k}~{}|~{}\xi^{%
j}_{k-1})}{\displaystyle\sum_{1\leq l\leq N}p(y_{k-1}|\xi^{l}_{k-1})~{}p(\xi^{%
i}_{k}~{}|~{}\xi^{l}_{k-1})}~{}\delta_{\xi^{j}_{k-1}}(dx_{k-1})
  </annotation>
 </semantics>
</math>

 at time k moves at time (k-1) to a random state 

<math display="inline" id="Particle_filter:186">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k-1}~{}|~{}\xi^{i}_{k},(y_{0},\ldots,y_{k-1}))
  </annotation>
 </semantics>
</math>

 chosen with the discrete weighted probability

<math display="inline" id="Particle_filter:187">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-,</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k-1}~{}|~{}x_{k},(y_{0},\ldots,y_{k-1}))
  </annotation>
 </semantics>
</math>

In the above displayed formula, 

<math display="inline" id="Particle_filter:188">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\xi^{i}_{k}
  </annotation>
 </semantics>
</math>

 stands for the conditional distribution 

<math display="inline" id="Particle_filter:189">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>j</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k-1}|\xi^{j}_{k-1})
  </annotation>
 </semantics>
</math>

 evaluated at 

<math display="inline" id="Particle_filter:190">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msubsup>
      <mi>ξ</mi>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>j</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\xi^{i}_{k}~{}|~{}\xi^{j}_{k-1})
  </annotation>
 </semantics>
</math>

. In the same vein, 

<math display="inline" id="Particle_filter:191">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k-1}|x_{k-1})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:192">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+3.3pt">
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mpadded>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}~{}|~{}x_{k-1})
  </annotation>
 </semantics>
</math>

 stand for the conditional densities 

<math display="inline" id="Particle_filter:193">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>ξ</mi>
    <mi>k</mi>
    <mi>i</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}=\xi^{i}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:194">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>j</mi>
    </msubsup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ξ</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k-1}=\xi^{j}_{k-1}.
  </annotation>
 </semantics>
</math>

 evaluated at 

<math display="inline" id="Particle_filter:195">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p((x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Particle_filter:196">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>.</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <ci>normal-.</ci>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k}(.)
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>These models allows to reduce integration with respect to the densities 

<math display="inline" id="Particle_filter:197">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mpadded width="+3.3pt">
       <mstyle displaystyle="true">
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
       </mstyle>
      </mpadded>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
        <mo rspace="5.8pt" stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mpadded width="+3.3pt">
       <msub>
        <mo lspace="5.8pt">≈</mo>
        <mrow>
         <mi>N</mi>
         <mo>↑</mo>
         <mi mathvariant="normal">∞</mi>
        </mrow>
       </msub>
      </mpadded>
      <mstyle displaystyle="true">
       <mo largeop="true" symmetric="true">∫</mo>
      </mstyle>
      <msub>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mi>b</mi>
        <mi>a</mi>
        <mi>c</mi>
        <mi>k</mi>
        <mi>w</mi>
        <mi>a</mi>
        <mi>r</mi>
        <mi>d</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
        <mo rspace="5.8pt" stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mo>=</mo>
      <mpadded width="+3.3pt">
       <mstyle displaystyle="true">
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
       </mstyle>
      </mpadded>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <mo>×</mo>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="9.1pt" stretchy="false">)</mo>
      </mrow>
      <mpadded width="+6.6pt">
       <mi mathvariant="normal">…</mi>
      </mpadded>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mpadded width="+3.3pt">
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mo rspace="5.8pt" stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <munder>
        <munder accentunder="true">
         <mrow>
          <mo movablelimits="false">[</mo>
          <mfrac>
           <mn>1</mn>
           <mi>N</mi>
          </mfrac>
          <mo movablelimits="false">,</mo>
          <mi mathvariant="normal">…</mi>
          <mo movablelimits="false">,</mo>
          <mfrac>
           <mn>1</mn>
           <mi>N</mi>
          </mfrac>
          <mo movablelimits="false">]</mo>
         </mrow>
         <mo movablelimits="false">⏟</mo>
        </munder>
        <mtext>N times</mtext>
       </munder>
       <msub>
        <mi>𝕄</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <msub>
        <mi>𝕄</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </msub>
       <mi mathvariant="normal">…</mi>
       <msub>
        <mi>𝕄</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo>[</mo>
        <mtable>
         <mtr>
          <mtd columnalign="center">
           <mrow>
            <msub>
             <mi>f</mi>
             <mi>k</mi>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <msubsup>
              <mi>ξ</mi>
              <mi>k</mi>
              <mn>1</mn>
             </msubsup>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mi mathvariant="normal">⋮</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mrow>
            <msub>
             <mi>f</mi>
             <mi>k</mi>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <msubsup>
              <mi>ξ</mi>
              <mi>k</mi>
              <mi>N</mi>
             </msubsup>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <approx></approx>
       <apply>
        <ci>normal-↑</ci>
        <ci>N</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <int></int>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>a</ci>
        <ci>c</ci>
        <ci>k</ci>
        <ci>w</ci>
        <ci>a</ci>
        <ci>r</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <eq></eq>
      <int></int>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-|</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-…</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-,</ci>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-,</ci>
        <ci>normal-…</ci>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-⏟</ci>
         <list>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <ci>N</ci>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <ci>N</ci>
          </apply>
         </list>
        </apply>
        <mtext>N times</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝕄</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝕄</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝕄</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <matrix>
         <matrixrow>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>k</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ξ</ci>
             <cn type="integer">1</cn>
            </apply>
            <ci>k</ci>
           </apply>
          </apply>
         </matrixrow>
         <matrixrow>
          <ci>normal-⋮</ci>
         </matrixrow>
         <matrixrow>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>k</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>ξ</ci>
             <ci>N</ci>
            </apply>
            <ci>k</ci>
           </apply>
          </apply>
         </matrixrow>
        </matrix>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{l}\displaystyle\int~{}p(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},%
\ldots,y_{n-1}))~{}f_{k}(x_{k})\\
\\
~{}\approx_{N\uparrow\infty}~{}\displaystyle\int\widehat{p}_{backward}(d(x_{0}%
,\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))~{}f_{k}(x_{k})\\
\\
=\displaystyle\int~{}\widehat{p}(dx_{n}~{}|~{}(y_{0},\ldots,y_{n-1}))~{}%
\widehat{p}(dx_{n-1}~{}|~{}x_{n},(y_{0},\ldots,y_{n-1}))~{}\times\widehat{p}(%
dx_{n-2}~{}|~{}x_{n-1},(y_{0},\ldots,y_{n-2}))~{}~{}\ldots~{}~{}\widehat{p}(dx%
_{k}~{}|~{}x_{k+1},(y_{0},\ldots,y_{k}))~{}f_{k}(x_{k})\\
\\
=\underbrace{\left[\frac{1}{N},\ldots,\frac{1}{N}\right]}_{\mbox{N times}}%
\mathbb{M}_{n-1}\mathbb{M}_{n-2}\ldots\mathbb{M}_{k}\left[\begin{array}[]{c}f_%
{k}(\xi^{1}_{k})\\
\vdots\\
f_{k}(\xi^{N}_{k})\end{array}\right]\end{array}
  </annotation>
 </semantics>
</math>

 in terms of matrix operations with respect to the Markov transitions of the chain described above.<a class="footnoteRef" href="#fn119" id="fnref119"><sup>119</sup></a> For instance, for any function 

<math display="inline" id="Particle_filter:198">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>N</mi>
    <mo>×</mo>
    <mi>N</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (N\times N)
  </annotation>
 </semantics>
</math>

 we have the particle estimates</p>

<p>

<math display="inline" id="Particle_filter:199">
 <semantics>
  <mrow>
   <msub>
    <mi>𝕄</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>𝕄</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>j</mi>
      <mo>≤</mo>
      <mi>N</mi>
     </mrow>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝕄</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝕄</ci>
       <ci>k</ci>
      </apply>
      <interval closure="open">
       <ci>i</ci>
       <ci>j</ci>
      </interval>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <ci>j</ci>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{M}_{k}=\left(\mathbb{M}_{k}(i,j)\right)_{1\leq i,j\leq N}
  </annotation>
 </semantics>
</math>

with the 

<math display="inline" id="Particle_filter:200">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝕄</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mpadded width="+3.3pt">
       <msubsup>
        <mi>ξ</mi>
        <mi>k</mi>
        <mi>i</mi>
       </msubsup>
      </mpadded>
      <mo rspace="5.8pt" stretchy="false">|</mo>
      <msubsup>
       <mi>ξ</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mi>j</mi>
      </msubsup>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
      <msubsup>
       <mi>ξ</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mi>j</mi>
      </msubsup>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mpadded width="+3.3pt">
      <mstyle displaystyle="true">
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>l</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </munder>
      </mstyle>
     </mpadded>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mpadded width="+3.3pt">
       <msubsup>
        <mi>ξ</mi>
        <mi>k</mi>
        <mi>i</mi>
       </msubsup>
      </mpadded>
      <mo rspace="5.8pt" stretchy="false">|</mo>
      <msubsup>
       <mi>ξ</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mi>l</mi>
      </msubsup>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">|</mo>
      <msubsup>
       <mi>ξ</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mi>l</mi>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝕄</ci>
      <ci>k</ci>
     </apply>
     <interval closure="open">
      <ci>i</ci>
      <ci>j</ci>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>l</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{M}_{k}(i,j)=\frac{p(\xi^{i}_{k}~{}|~{}\xi^{j}_{k-1})~{}p(y_{k-1}|\xi^{%
j}_{k-1})~{}}{\displaystyle\sum_{1\leq l\leq N}~{}p(\xi^{i}_{k}~{}|~{}\xi^{l}_%
{k-1})~{}p(y_{k-1}|\xi^{l}_{k-1})}
  </annotation>
 </semantics>
</math>

-matrices 

<math display="inline" id="Particle_filter:201">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>F</mi>
     <mo>¯</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mn>0</mn>
        <mo>≤</mo>
        <mi>k</mi>
        <mo>≤</mo>
        <mi>n</mi>
       </mrow>
      </msub>
      <mrow>
       <msub>
        <mi>f</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>⟹</mo>
    <mtable align="top">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mpadded width="+3.3pt">
         <mstyle displaystyle="true">
          <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
         </mstyle>
        </mpadded>
        <mover accent="true">
         <mi>F</mi>
         <mo>¯</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo rspace="5.8pt" stretchy="false">)</mo>
        </mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>d</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>x</mi>
           <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">…</mi>
          <mo>,</mo>
          <msub>
           <mi>x</mi>
           <mi>n</mi>
          </msub>
          <mo rspace="5.8pt" stretchy="false">)</mo>
         </mrow>
         <mo rspace="5.8pt" stretchy="false">|</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>y</mi>
           <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">…</mi>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mpadded width="+3.3pt">
         <msub>
          <mo lspace="5.8pt">≈</mo>
          <mrow>
           <mi>N</mi>
           <mo>↑</mo>
           <mi mathvariant="normal">∞</mi>
          </mrow>
         </msub>
        </mpadded>
        <mstyle displaystyle="true">
         <mo largeop="true" symmetric="true">∫</mo>
        </mstyle>
        <mover accent="true">
         <mi>F</mi>
         <mo>¯</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo rspace="5.8pt" stretchy="false">)</mo>
        </mrow>
        <msub>
         <mover accent="true">
          <mi>p</mi>
          <mo>^</mo>
         </mover>
         <mrow>
          <mi>b</mi>
          <mi>a</mi>
          <mi>c</mi>
          <mi>k</mi>
          <mi>w</mi>
          <mi>a</mi>
          <mi>r</mi>
          <mi>d</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>d</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>x</mi>
           <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">…</mi>
          <mo>,</mo>
          <msub>
           <mi>x</mi>
           <mi>n</mi>
          </msub>
          <mo rspace="5.8pt" stretchy="false">)</mo>
         </mrow>
         <mo rspace="5.8pt" stretchy="false">|</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>y</mi>
           <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi mathvariant="normal">…</mi>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd></mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mi></mi>
        <mo>=</mo>
        <mrow>
         <mstyle displaystyle="true">
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mi>n</mi>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
          </mfrac>
         </mstyle>
         <mrow>
          <mstyle displaystyle="true">
           <munder>
            <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
            <mrow>
             <mn>0</mn>
             <mo>≤</mo>
             <mi>k</mi>
             <mo>≤</mo>
             <mi>n</mi>
            </mrow>
           </munder>
          </mstyle>
          <mrow>
           <munder>
            <munder accentunder="true">
             <mrow>
              <mo movablelimits="false">[</mo>
              <mstyle displaystyle="true">
               <mfrac>
                <mn>1</mn>
                <mi>N</mi>
               </mfrac>
              </mstyle>
              <mo movablelimits="false">,</mo>
              <mi mathvariant="normal">…</mi>
              <mo movablelimits="false">,</mo>
              <mstyle displaystyle="true">
               <mfrac>
                <mn>1</mn>
                <mi>N</mi>
               </mfrac>
              </mstyle>
              <mo movablelimits="false">]</mo>
             </mrow>
             <mo movablelimits="false">⏟</mo>
            </munder>
            <mtext>N times</mtext>
           </munder>
           <msub>
            <mi>𝕄</mi>
            <mrow>
             <mi>n</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msub>
           <msub>
            <mi>𝕄</mi>
            <mrow>
             <mi>n</mi>
             <mo>-</mo>
             <mn>2</mn>
            </mrow>
           </msub>
           <mi mathvariant="normal">…</mi>
           <msub>
            <mi>𝕄</mi>
            <mi>k</mi>
           </msub>
           <mrow>
            <mo>[</mo>
            <mtable>
             <mtr>
              <mtd columnalign="center">
               <mrow>
                <msub>
                 <mi>f</mi>
                 <mi>k</mi>
                </msub>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <msubsup>
                  <mi>ξ</mi>
                  <mi>k</mi>
                  <mn>1</mn>
                 </msubsup>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mtd>
             </mtr>
             <mtr>
              <mtd columnalign="center">
               <mi mathvariant="normal">⋮</mi>
              </mtd>
             </mtr>
             <mtr>
              <mtd columnalign="center">
               <mrow>
                <msub>
                 <mi>f</mi>
                 <mi>k</mi>
                </msub>
                <mrow>
                 <mo stretchy="false">(</mo>
                 <msubsup>
                  <mi>ξ</mi>
                  <mi>k</mi>
                  <mi>N</mi>
                 </msubsup>
                 <mo stretchy="false">)</mo>
                </mrow>
               </mrow>
              </mtd>
             </mtr>
            </mtable>
            <mo>]</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¯</ci>
      <ci>F</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </vector>
    </apply>
    <list>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <and></and>
         <apply>
          <leq></leq>
          <cn type="integer">0</cn>
          <ci>k</ci>
         </apply>
         <apply>
          <leq></leq>
          <share href="#.cmml">
          </share>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⟹</ci>
     <matrix>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <int></int>
        <apply>
         <ci>normal-¯</ci>
         <ci>F</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-,</ci>
         <ci>normal-…</ci>
         <ci>normal-,</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <csymbol cd="unknown">p</csymbol>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <csymbol cd="unknown">d</csymbol>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <ci>normal-(</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>normal-,</ci>
          <ci>normal-…</ci>
          <ci>normal-,</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>n</ci>
          </apply>
          <ci>normal-)</ci>
         </cerror>
         <ci>normal-|</ci>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <ci>normal-(</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>normal-,</ci>
          <ci>normal-…</ci>
          <ci>normal-,</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <apply>
            <minus></minus>
            <ci>n</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>normal-)</ci>
         </cerror>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
      </matrixrow>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
      </matrixrow>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <approx></approx>
         <apply>
          <ci>normal-↑</ci>
          <ci>N</ci>
          <infinity></infinity>
         </apply>
        </apply>
        <int></int>
        <apply>
         <ci>normal-¯</ci>
         <ci>F</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>normal-,</ci>
         <ci>normal-…</ci>
         <ci>normal-,</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
         <ci>normal-)</ci>
        </cerror>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <times></times>
          <ci>b</ci>
          <ci>a</ci>
          <ci>c</ci>
          <ci>k</ci>
          <ci>w</ci>
          <ci>a</ci>
          <ci>r</ci>
          <ci>d</ci>
         </apply>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-(</ci>
         <csymbol cd="unknown">d</csymbol>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <ci>normal-(</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>normal-,</ci>
          <ci>normal-…</ci>
          <ci>normal-,</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>n</ci>
          </apply>
          <ci>normal-)</ci>
         </cerror>
         <ci>normal-|</ci>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <ci>normal-(</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <cn type="integer">0</cn>
          </apply>
          <ci>normal-,</ci>
          <ci>normal-…</ci>
          <ci>normal-,</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <apply>
            <minus></minus>
            <ci>n</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>normal-)</ci>
         </cerror>
         <ci>normal-)</ci>
        </cerror>
       </cerror>
      </matrixrow>
      <matrixrow>
       <cerror>
        <csymbol cd="ambiguous">missing-subexpression</csymbol>
       </cerror>
      </matrixrow>
      <matrixrow>
       <apply>
        <eq></eq>
        <csymbol cd="latexml">absent</csymbol>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <and></and>
            <apply>
             <leq></leq>
             <cn type="integer">0</cn>
             <ci>k</ci>
            </apply>
            <apply>
             <leq></leq>
             <share href="#.cmml">
             </share>
             <ci>n</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <ci>normal-⏟</ci>
             <list>
              <apply>
               <divide></divide>
               <cn type="integer">1</cn>
               <ci>N</ci>
              </apply>
              <ci>normal-…</ci>
              <apply>
               <divide></divide>
               <cn type="integer">1</cn>
               <ci>N</ci>
              </apply>
             </list>
            </apply>
            <mtext>N times</mtext>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝕄</ci>
            <apply>
             <minus></minus>
             <ci>n</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝕄</ci>
            <apply>
             <minus></minus>
             <ci>n</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <ci>normal-…</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝕄</ci>
            <ci>k</ci>
           </apply>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <matrix>
             <matrixrow>
              <apply>
               <times></times>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>f</ci>
                <ci>k</ci>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <apply>
                 <csymbol cd="ambiguous">superscript</csymbol>
                 <ci>ξ</ci>
                 <cn type="integer">1</cn>
                </apply>
                <ci>k</ci>
               </apply>
              </apply>
             </matrixrow>
             <matrixrow>
              <ci>normal-⋮</ci>
             </matrixrow>
             <matrixrow>
              <apply>
               <times></times>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>f</ci>
                <ci>k</ci>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <apply>
                 <csymbol cd="ambiguous">superscript</csymbol>
                 <ci>ξ</ci>
                 <ci>N</ci>
                </apply>
                <ci>k</ci>
               </apply>
              </apply>
             </matrixrow>
            </matrix>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{F}(x_{0},\ldots,x_{n}):=\frac{1}{n+1}\sum_{0\leq k\leq n}f_{k}(x_{k}%
)\quad\Longrightarrow\quad\begin{array}[t]{l}\displaystyle\int~{}\overline{F}(%
x_{0},\ldots,x_{n})~{}p(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1}))\\
\\
~{}\approx_{N\uparrow\infty}~{}\displaystyle\int\overline{F}(x_{0},\ldots,x_{n%
})~{}\widehat{p}_{backward}(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{n-1})%
)\\
\\
\displaystyle=\frac{1}{n+1}\sum_{0\leq k\leq n}\underbrace{\left[\frac{1}{N},%
\ldots,\frac{1}{N}\right]}_{\mbox{N times}}\mathbb{M}_{n-1}\mathbb{M}_{n-2}%
\ldots\mathbb{M}_{k}\left[\begin{array}[]{c}f_{k}(\xi^{1}_{k})\\
\vdots\\
f_{k}(\xi^{N}_{k})\end{array}\right]\end{array}
  </annotation>
 </semantics>
</math>

 with entries

<math display="inline" id="Particle_filter:202">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mi>n</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo>(</mo>
      <msup>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mfrac>
          <mrow>
           <mover accent="true">
            <mi>p</mi>
            <mo>^</mo>
           </mover>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>y</mi>
             <mn>0</mn>
            </msub>
            <mo>,</mo>
            <mi mathvariant="normal">…</mi>
            <mo>,</mo>
            <msub>
             <mi>y</mi>
             <mi>n</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mrow>
           <mi>p</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>y</mi>
             <mn>0</mn>
            </msub>
            <mo>,</mo>
            <mi mathvariant="normal">…</mi>
            <mo>,</mo>
            <msub>
             <mi>y</mi>
             <mi>n</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mfrac>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>]</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mpadded width="+3.3pt">
       <mi>c</mi>
      </mpadded>
      <mi>n</mi>
     </mrow>
     <mo>/</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-^</ci>
        <ci>p</ci>
       </apply>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
       </vector>
      </apply>
     </apply>
     <list>
      <apply>
       <times></times>
       <ci>p</ci>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
       </vector>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <ci>normal-^</ci>
            <ci>p</ci>
           </apply>
           <vector>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <cn type="integer">0</cn>
            </apply>
            <ci>normal-…</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <ci>n</ci>
            </apply>
           </vector>
          </apply>
          <apply>
           <times></times>
           <ci>p</ci>
           <vector>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <cn type="integer">0</cn>
            </apply>
            <ci>normal-…</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>y</ci>
             <ci>n</ci>
            </apply>
           </vector>
          </apply>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E\left(\widehat{p}(y_{0},\ldots,y_{n})\right)=p(y_{0},\ldots,y_{n})\quad\mbox{%
and}\quad E\left(\left[\frac{\widehat{p}(y_{0},\ldots,y_{n})}{p(y_{0},\ldots,y%
_{n})}-1\right]^{2}\right)\leq{c}~{}n/{N}
  </annotation>
 </semantics>
</math>

This also show that</p>

<p>

<math display="inline" id="Particle_filter:203">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\geq 0
  </annotation>
 </semantics>
</math>

</p>
<h3 id="some-convergence-results-1">Some convergence results</h3>

<p>We shall assume that filtering equation is stable, in the sense that it corrects any erroneous initial condition.</p>

<p>In this situation, the <strong>particle approximations of the likelihood functions</strong> are unbiased and the relative variance is controlled by</p>

<p>

<math display="inline" id="Particle_filter:204">
 <semantics>
  <mrow>
   <mrow>
    <mo>|</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>n</mi>
      </mfrac>
      <mrow>
       <mi>log</mi>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>n</mi>
      </mfrac>
      <mrow>
       <mi>log</mi>
       <mover accent="true">
        <mi>p</mi>
        <mo>^</mo>
       </mover>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>|</mo>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mpadded width="+3.3pt">
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
     </mpadded>
     <mfrac>
      <mi>x</mi>
      <mi>N</mi>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <msub>
       <mi>c</mi>
       <mn>2</mn>
      </msub>
     </mpadded>
     <msqrt>
      <mfrac>
       <mi>x</mi>
       <mi>N</mi>
      </mfrac>
     </msqrt>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
       <apply>
        <log></log>
        <apply>
         <ci>normal-^</ci>
         <ci>p</ci>
        </apply>
       </apply>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
       </vector>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>n</ci>
       </apply>
       <apply>
        <log></log>
        <apply>
         <ci>normal-^</ci>
         <ci>p</ci>
        </apply>
       </apply>
       <vector>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
       </vector>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>x</ci>
       <ci>N</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <ci>x</ci>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\frac{1}{n}\log{\widehat{p}(y_{0},\ldots,y_{n})}-\frac{1}{n}\log{%
\widehat{p}(y_{0},\ldots,y_{n})}\right|\leq c_{1}~{}\frac{x}{N}+c_{2}~{}\sqrt{%
\frac{x}{N}}
  </annotation>
 </semantics>
</math>

for some finite constant c. In addition, for any 

<math display="inline" id="Particle_filter:205">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-e^{-x}
  </annotation>
 </semantics>
</math>


, the probability that

<math display="inline" id="Particle_filter:206">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+3.3pt">
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
    </mpadded>
    <mpadded width="+3.3pt">
     <mtext>and</mtext>
    </mpadded>
    <msub>
     <mi>c</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo><</mo>
   <mpadded width="+3.3pt">
    <mi mathvariant="normal">∞</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <mtext>and</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1}~{}\mbox{and}~{}c_{2}<\infty~{}
  </annotation>
 </semantics>
</math>

is larger than 

<math display="inline" id="Particle_filter:207">
 <semantics>
  <mrow>
   <msubsup>
    <mi>I</mi>
    <mi>k</mi>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>h</mi>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <msubsup>
    <mover accent="true">
     <mi>I</mi>
     <mo>^</mo>
    </mover>
    <mi>k</mi>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>h</mi>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>F</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msubsup>
     <mi>ξ</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
     <mi>i</mi>
    </msubsup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>I</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">F</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>I</ci>
      </apply>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">F</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <int></int>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ξ</ci>
       <ci>i</ci>
      </apply>
      <list>
       <ci>k</ci>
       <ci>k</ci>
      </list>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I^{path}_{k}(F):=\int F(x_{0},\ldots,x_{k})~{}p(d(x_{0},\ldots,x_{k})|y_{0},%
\ldots,y_{k-1})~{}\approx_{N\uparrow\infty}~{}\widehat{I}^{path}_{k}(F):=\int F%
(x_{0},\ldots,x_{k})~{}\widehat{p}(d(x_{0},\ldots,x_{k})|y_{0},\ldots,y_{k-1})%
~{}=\frac{1}{N}\sum_{1\leq i\leq N}F\left(\xi^{i}_{0,k},\ldots,\xi^{i}_{k,k}\right)
  </annotation>
 </semantics>
</math>

 , for some finite constants 

<math display="inline" id="Particle_filter:208">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mrow>
       <mi>E</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msubsup>
          <mover accent="true">
           <mi>I</mi>
           <mo>^</mo>
          </mover>
          <mi>k</mi>
          <mrow>
           <mi>p</mi>
           <mi>a</mi>
           <mi>t</mi>
           <mi>h</mi>
          </mrow>
         </msubsup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>F</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>I</mi>
        <mi>k</mi>
        <mrow>
         <mi>p</mi>
         <mi>a</mi>
         <mi>t</mi>
         <mi>h</mi>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>F</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mrow>
       <mpadded width="+3.3pt">
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mi>k</mi>
      </mrow>
      <mo>/</mo>
      <mi>N</mi>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo>(</mo>
      <msup>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mrow>
          <msubsup>
           <mover accent="true">
            <mi>I</mi>
            <mo>^</mo>
           </mover>
           <mi>k</mi>
           <mrow>
            <mi>p</mi>
            <mi>a</mi>
            <mi>t</mi>
            <mi>h</mi>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>F</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msubsup>
           <mi>I</mi>
           <mi>k</mi>
           <mrow>
            <mi>p</mi>
            <mi>a</mi>
            <mi>t</mi>
            <mi>h</mi>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>F</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mpadded width="+3.3pt">
       <msub>
        <mi>c</mi>
        <mn>2</mn>
       </msub>
      </mpadded>
      <mi>k</mi>
     </mrow>
     <mo>/</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>E</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <ci>normal-^</ci>
            <ci>I</ci>
           </apply>
           <apply>
            <times></times>
            <ci>p</ci>
            <ci>a</ci>
            <ci>t</ci>
            <ci>h</ci>
           </apply>
          </apply>
          <ci>k</ci>
         </apply>
         <ci>F</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <times></times>
          <ci>p</ci>
          <ci>a</ci>
          <ci>t</ci>
          <ci>h</ci>
         </apply>
        </apply>
        <ci>F</ci>
       </apply>
      </apply>
     </apply>
     <list>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>N</ci>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-^</ci>
             <ci>I</ci>
            </apply>
            <apply>
             <times></times>
             <ci>p</ci>
             <ci>a</ci>
             <ci>t</ci>
             <ci>h</ci>
            </apply>
           </apply>
           <ci>k</ci>
          </apply>
          <ci>F</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>I</ci>
            <ci>k</ci>
           </apply>
           <apply>
            <times></times>
            <ci>p</ci>
            <ci>a</ci>
            <ci>t</ci>
            <ci>h</ci>
           </apply>
          </apply>
          <ci>F</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>k</ci>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|E\left(\widehat{I}^{path}_{k}(F)\right)-I_{k}^{path}(F)\right|\leq{c_{1}%
}~{}k/{N}\quad\mbox{and}\quad E\left(\left[\widehat{I}^{path}_{k}(F)-I_{k}^{%
path}(F)\right]^{2}\right)\leq{c_{2}}~{}k/{N}
  </annotation>
 </semantics>
</math>

 related to the asymptotic bias and variance of the particle estimate, and for some finite constant c.</p>

<p>The bias and the variance of <strong>the particle particle estimates based on the ancestral lines of the genealogical trees</strong></p>

<p>

<math display="inline" id="Particle_filter:209">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>c</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo><</mo>
    <mpadded width="+3.3pt">
     <mi mathvariant="normal">∞</mi>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </list>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1},c_{2}<\infty~{}.
  </annotation>
 </semantics>
</math>

 are controlled by the non asymptotic uniform estimates

<math display="inline" id="Particle_filter:210">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\geq 0
  </annotation>
 </semantics>
</math>


for any function F(.) bounded by 1, and for some finite constants 

<math display="inline" id="Particle_filter:211">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mover accent="true">
         <mi>I</mi>
         <mo>^</mo>
        </mover>
        <mi>k</mi>
        <mrow>
         <mi>p</mi>
         <mi>a</mi>
         <mi>t</mi>
         <mi>h</mi>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>F</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>I</mi>
        <mi>k</mi>
        <mrow>
         <mi>p</mi>
         <mi>a</mi>
         <mi>t</mi>
         <mi>h</mi>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>F</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mrow>
       <mpadded width="+3.3pt">
        <msub>
         <mi>c</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mfrac>
        <mrow>
         <mpadded width="+3.3pt">
          <mi>k</mi>
         </mpadded>
         <mi>x</mi>
        </mrow>
        <mi>N</mi>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mpadded width="+3.3pt">
        <msub>
         <mi>c</mi>
         <mn>2</mn>
        </msub>
       </mpadded>
       <msqrt>
        <mfrac>
         <mrow>
          <mpadded width="+3.3pt">
           <mi>k</mi>
          </mpadded>
          <mi>x</mi>
         </mrow>
         <mi>N</mi>
        </mfrac>
       </msqrt>
      </mrow>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>sup</mo>
      <mrow>
       <mn>0</mn>
       <mo>≤</mo>
       <mi>k</mi>
       <mo>≤</mo>
       <mi>n</mi>
      </mrow>
     </msub>
     <mrow>
      <mo>|</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mover accent="true">
          <mi>I</mi>
          <mo>^</mo>
         </mover>
         <mi>k</mi>
         <mrow>
          <mi>p</mi>
          <mi>a</mi>
          <mi>t</mi>
          <mi>h</mi>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>F</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msubsup>
         <mi>I</mi>
         <mi>k</mi>
         <mrow>
          <mi>p</mi>
          <mi>a</mi>
          <mi>t</mi>
          <mi>h</mi>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>F</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mi>c</mi>
     </mpadded>
     <msqrt>
      <mfrac>
       <mrow>
        <mpadded width="+3.3pt">
         <mi>x</mi>
        </mpadded>
        <mpadded width="+3.3pt">
         <mi>n</mi>
        </mpadded>
        <mrow>
         <mi>log</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>n</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mi>N</mi>
      </mfrac>
     </msqrt>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <ci>normal-^</ci>
           <ci>I</ci>
          </apply>
          <apply>
           <times></times>
           <ci>p</ci>
           <ci>a</ci>
           <ci>t</ci>
           <ci>h</ci>
          </apply>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>F</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <times></times>
          <ci>p</ci>
          <ci>a</ci>
          <ci>t</ci>
          <ci>h</ci>
         </apply>
        </apply>
        <ci>F</ci>
       </apply>
      </apply>
     </apply>
     <list>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>x</ci>
         </apply>
         <ci>N</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <root></root>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>k</ci>
           <ci>x</ci>
          </apply>
          <ci>N</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">supremum</csymbol>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">0</cn>
         <ci>k</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <ci>normal-^</ci>
            <ci>I</ci>
           </apply>
           <ci>k</ci>
          </apply>
          <apply>
           <times></times>
           <ci>p</ci>
           <ci>a</ci>
           <ci>t</ci>
           <ci>h</ci>
          </apply>
         </apply>
         <ci>F</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>I</ci>
           <apply>
            <times></times>
            <ci>p</ci>
            <ci>a</ci>
            <ci>t</ci>
            <ci>h</ci>
           </apply>
          </apply>
          <ci>k</ci>
         </apply>
         <ci>F</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>n</ci>
         <apply>
          <log></log>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\widehat{I}^{path}_{k}(F)-I_{k}^{path}(F)\right|\leq c_{1}~{}\frac{k~{}x%
}{N}+c_{2}~{}\sqrt{\frac{k~{}x}{N}}\quad\mbox{and}\quad\sup_{0\leq k\leq n}%
\left|\widehat{I}_{k}^{path}(F)-I^{path}_{k}(F)\right|\leq c~{}\sqrt{\frac{x~{%
}n~{}\log(n)}{N}}
  </annotation>
 </semantics>
</math>

 In addition, for any 

<math display="inline" id="Particle_filter:212">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mi>x</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-e^{-x}
  </annotation>
 </semantics>
</math>

, the probability that

<math display="inline" id="Particle_filter:213">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+3.3pt">
     <msub>
      <mi>c</mi>
      <mn>1</mn>
     </msub>
    </mpadded>
    <mpadded width="+3.3pt">
     <mtext>and</mtext>
    </mpadded>
    <msub>
     <mi>c</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo><</mo>
   <mpadded width="+3.3pt">
    <mi mathvariant="normal">∞</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <mtext>and</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1}~{}\mbox{and}~{}c_{2}<\infty~{}
  </annotation>
 </semantics>
</math>

is larger than 

<math display="inline" id="Particle_filter:214">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>F</mi>
    <mo>¯</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mfrac>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>0</mn>
     <mo>≤</mo>
     <mi>k</mi>
     <mo>≤</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <msub>
    <mi>f</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mtext>with</mtext>
   <msubsup>
    <mi>I</mi>
    <mi>n</mi>
    <mrow>
     <mi>p</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>h</mi>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>F</mi>
     <mo>¯</mo>
    </mover>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≈</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <msubsup>
    <mi>I</mi>
    <mi>n</mi>
    <mrow>
     <mi mathvariant="normal">♭</mi>
     <mo>,</mo>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <mi>t</mi>
      <mi>h</mi>
     </mrow>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>F</mi>
     <mo>¯</mo>
    </mover>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>:=</mo>
   <mstyle displaystyle="true">
    <mo largeop="true" symmetric="true">∫</mo>
   </mstyle>
   <mover accent="true">
    <mi>F</mi>
    <mo>¯</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>b</mi>
     <mi>a</mi>
     <mi>c</mi>
     <mi>k</mi>
     <mi>w</mi>
     <mi>a</mi>
     <mi>r</mi>
     <mi>d</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>F</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <mtext>with</mtext>
    <ci></ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>I</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>F</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <approx></approx>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>I</ci>
      <list>
       <ci>normal-♭</ci>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>a</ci>
        <ci>t</ci>
        <ci>h</ci>
       </apply>
      </list>
     </apply>
     <ci>n</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>F</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <int></int>
    <apply>
     <ci>normal-¯</ci>
     <ci>F</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>a</ci>
      <ci>c</ci>
      <ci>k</ci>
      <ci>w</ci>
      <ci>a</ci>
      <ci>r</ci>
      <ci>d</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-|</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-,</ci>
      <ci>normal-…</ci>
      <ci>normal-,</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{F}(x_{0},\ldots,x_{n}):=\frac{1}{n+1}\sum_{0\leq k\leq n}f_{k}(x_{k}%
)\quad\mbox{with}\quad I^{path}_{n}(\overline{F})~{}\approx_{N\uparrow\infty}~%
{}I^{\flat,path}_{n}(\overline{F}):=\displaystyle\int\overline{F}(x_{0},\ldots%
,x_{n})~{}\widehat{p}_{backward}(d(x_{0},\ldots,x_{n})~{}|~{}(y_{0},\ldots,y_{%
n-1}))
  </annotation>
 </semantics>
</math>

 , for some finite constants 

<math display="inline" id="Particle_filter:215">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>.</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>k</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <ci>normal-.</ci>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{k}(.)
  </annotation>
 </semantics>
</math>

 related to the asymptotic bias and variance of the particle estimate, and for some finite constant c. The same type of bias and variance estimates hold for the backward particle smoothers. For additive functionals of the form</p>

<p>

<math display="inline" id="Particle_filter:216">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>sup</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </msub>
     <mrow>
      <mo>|</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msubsup>
           <mover accent="true">
            <mi>I</mi>
            <mo>^</mo>
           </mover>
           <mi>n</mi>
           <mrow>
            <mi mathvariant="normal">♭</mi>
            <mo>,</mo>
            <mrow>
             <mi>p</mi>
             <mi>a</mi>
             <mi>t</mi>
             <mi>h</mi>
            </mrow>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mover accent="true">
            <mi>F</mi>
            <mo>¯</mo>
           </mover>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msubsup>
         <mi>I</mi>
         <mi>n</mi>
         <mrow>
          <mi>p</mi>
          <mi>a</mi>
          <mi>t</mi>
          <mi>h</mi>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mover accent="true">
          <mi>F</mi>
          <mo>¯</mo>
         </mover>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="5.8pt">|</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>1</mn>
      </msub>
      <mo>/</mo>
      <mi>N</mi>
     </mrow>
     <mtext>and</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo>(</mo>
      <msup>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mrow>
          <msubsup>
           <mover accent="true">
            <mi>I</mi>
            <mo>^</mo>
           </mover>
           <mi>n</mi>
           <mrow>
            <mi mathvariant="normal">♭</mi>
            <mo>,</mo>
            <mrow>
             <mi>p</mi>
             <mi>a</mi>
             <mi>t</mi>
             <mi>h</mi>
            </mrow>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>F</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msubsup>
           <mi>I</mi>
           <mi>n</mi>
           <mrow>
            <mi>p</mi>
            <mi>a</mi>
            <mi>t</mi>
            <mi>h</mi>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>F</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>2</mn>
      </msub>
      <mo>/</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mn>3</mn>
      </msub>
      <mo>/</mo>
      <msup>
       <mi>N</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">supremum</csymbol>
       <apply>
        <geq></geq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>E</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-^</ci>
             <ci>I</ci>
            </apply>
            <list>
             <ci>normal-♭</ci>
             <apply>
              <times></times>
              <ci>p</ci>
              <ci>a</ci>
              <ci>t</ci>
              <ci>h</ci>
             </apply>
            </list>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <ci>normal-¯</ci>
           <ci>F</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>n</ci>
          </apply>
          <apply>
           <times></times>
           <ci>p</ci>
           <ci>a</ci>
           <ci>t</ci>
           <ci>h</ci>
          </apply>
         </apply>
         <apply>
          <ci>normal-¯</ci>
          <ci>F</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <list>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>N</ci>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <leq></leq>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-^</ci>
             <ci>I</ci>
            </apply>
            <list>
             <ci>normal-♭</ci>
             <apply>
              <times></times>
              <ci>p</ci>
              <ci>a</ci>
              <ci>t</ci>
              <ci>h</ci>
             </apply>
            </list>
           </apply>
           <ci>n</ci>
          </apply>
          <ci>F</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>I</ci>
            <ci>n</ci>
           </apply>
           <apply>
            <times></times>
            <ci>p</ci>
            <ci>a</ci>
            <ci>t</ci>
            <ci>h</ci>
           </apply>
          </apply>
          <ci>F</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sup_{n\geq 0}{\left|E\left(\widehat{I}^{\flat,path}_{n}(\overline{F})\right)-%
I_{n}^{path}(\overline{F})\right|}~{}\leq{c_{1}}/{N}\quad\mbox{and}\quad E%
\left(\left[\widehat{I}^{\flat,path}_{n}(F)-I_{n}^{path}(F)\right]^{2}\right)%
\leq{c_{2}}/{(nN)}+{c_{3}}/{N^{2}}
  </annotation>
 </semantics>
</math>

with functions 

<math display="inline" id="Particle_filter:217">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>c</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>c</mi>
     <mn>3</mn>
    </msub>
   </mrow>
   <mo><</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">3</cn>
     </apply>
    </list>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1},c_{2},c_{3}<\infty
  </annotation>
 </semantics>
</math>

 bounded by 1, we have</p>

<p>

<math display="inline" id="Particle_filter:218">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}|y_{0},\ldots,y_{k})
  </annotation>
 </semantics>
</math>

for some finite constants 

<math display="block" id="Particle_filter:219">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi>w</mi>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>,</mo>
     <msubsup>
      <mi>x</mi>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
    <mo rspace="5.8pt">:</mo>
    <mrow>
     <mi>i</mi>
     <mo>∈</mo>
     <mrow>
      <mo stretchy="false">{</mo>
      <mn>1</mn>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <mi>N</mi>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">conditional-set</csymbol>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </interval>
    <apply>
     <in></in>
     <ci>i</ci>
     <set>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>N</ci>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{(w^{(i)}_{k},x^{(i)}_{k})~{}:~{}i\in\{1,\ldots,N\}\}.
  </annotation>
 </semantics>
</math>

. More refined estimates including exponentially small probability of errors are developed in.<a class="footnoteRef" href="#fn120" id="fnref120"><sup>120</sup></a></p>
<h2 id="sequential-importance-resampling-sir">Sequential importance resampling (SIR)</h2>
<h3 id="the-bootstrap-filter">The bootstrap filter</h3>

<p><em>Sequential importance <a href="Resampling_(statistics)" title="wikilink">resampling</a> (SIR)</em>, the original bootstrap filtering algorithm (Gordon et al. 1993), is also very commonly used filtering algorithm, which approximates the filtering probability density 

<math display="inline" id="Particle_filter:220">
 <semantics>
  <msubsup>
   <mi>w</mi>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w^{(i)}_{k}
  </annotation>
 </semantics>
</math>

 by a weighted set of N samples</p>

<p>

<math display="inline" id="Particle_filter:221">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </msubsup>
    <msubsup>
     <mi>w</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{N}w^{(i)}_{k}=1
  </annotation>
 </semantics>
</math>

</p>

<p>The <em>importance weights</em> 

<math display="inline" id="Particle_filter:222">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cdot)
  </annotation>
 </semantics>
</math>

 are approximations to the relative posterior probabilities (or densities) of the samples such that 

<math display="block" id="Particle_filter:223">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>≈</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </munderover>
   <msubsup>
    <mi>w</mi>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>x</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>k</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int f(x_{k})p(x_{k}|y_{0},\dots,y_{k})dx_{k}\approx\sum_{i=1}^{N}w_{k}^{(i)}f%
(x_{k}^{(i)}).
  </annotation>
 </semantics>
</math>

.</p>

<p>SIR is a sequential (i.e., recursive) version of <a href="importance_sampling" title="wikilink">importance sampling</a>. As in importance sampling, the expectation of a function 

<math display="block" id="Particle_filter:224">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(x_{k}|x_{0:k-1},y_{0:k})\,
  </annotation>
 </semantics>
</math>

 can be approximated as a weighted average</p>

<p>

<math display="block" id="Particle_filter:225">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="4.2pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">d</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </cerror>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(x_{k}|x_{0:k-1},y_{0:k})=p(x_{k}|x_{k-1},y_{k})=\frac{p(y_{k}|x_{k})}{\int%
~{}p(y_{k}|x_{k})p(x_{k}|x_{k-1})dx_{k}}~{}p(x_{k}|x_{k-1}).\,
  </annotation>
 </semantics>
</math>

</p>

<p>For a finite set of samples, the algorithm performance is dependent on the choice of the <em>proposal distribution</em></p>

<p>

<math display="inline" id="Particle_filter:226">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}|x_{k-1},y_{k})
  </annotation>
 </semantics>
</math>

.</p>

<p>The "<em>optimal" proposal distribution</em> is given as the <em>target distribution</em></p>

<p>

<math display="inline" id="Particle_filter:227">
 <semantics>
  <mrow>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mpadded width="+3.3pt">
       <mstyle scriptlevel="-1">
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
       </mstyle>
      </mpadded>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <msub>
    <mo>≃</mo>
    <mrow>
     <mi>N</mi>
     <mo>↑</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
   </msub>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mpadded width="+3.3pt">
       <mstyle scriptlevel="-1">
        <mo largeop="true" rspace="5.8pt" symmetric="true">∫</mo>
       </mstyle>
      </mpadded>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>N</mi>
    </mrow>
   </msub>
   <mpadded width="+3.3pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>X</mi>
        <mi>k</mi>
        <mi>i</mi>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="false">
       <msub>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mn>1</mn>
         <mo>≤</mo>
         <mi>j</mi>
         <mo>≤</mo>
         <mi>N</mi>
        </mrow>
       </msub>
      </mstyle>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi>X</mi>
        <mi>k</mi>
        <mi>j</mi>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <msub>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mi>X</mi>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">d</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </cerror>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">similar-to-or-equals</csymbol>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <int></int>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <ci>normal-^</ci>
       <ci>p</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">d</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <and></and>
        <apply>
         <leq></leq>
         <cn type="integer">1</cn>
         <ci>j</ci>
        </apply>
        <apply>
         <leq></leq>
         <share href="#.cmml">
         </share>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>j</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{p(y_{k}|x_{k})}{\int~{}p(y_{k}|x_{k})p(x_{k}|x_{k-1})dx_{k}}~{}p(x_{k}|x%
_{k-1})dx_{k}\simeq_{N\uparrow\infty}\frac{p(y_{k}|x_{k})}{\int~{}p(y_{k}|x_{k%
})\widehat{p}(dx_{k}|x_{k-1})}~{}\widehat{p}(dx_{k}|x_{k-1})=\sum_{1\leq i\leq
N%
}\frac{p(y_{k}|X^{i}_{k}(x_{k-1}))}{\sum_{1\leq j\leq N}p(y_{k}|X^{j}_{k}(x_{k%
-1}))}~{}\delta_{X^{i}_{k}(x_{k-1})}(dx_{k})
  </annotation>
 </semantics>
</math>

</p>

<p>This particular choice of proposal transition has been proposed by P. Del Moral in <a class="footnoteRef" href="#fn121" id="fnref121"><sup>121</sup></a> in 1996 and 1998. When it is difficult to sample transitions according to the distribution 

<math display="inline" id="Particle_filter:228">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>p</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </msubsup>
   <msub>
    <mi>δ</mi>
    <mrow>
     <msubsup>
      <mi>X</mi>
      <mi>k</mi>
      <mi>i</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>d</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mpadded width="+3.3pt">
    <msub>
     <mo>≃</mo>
     <mrow>
      <mi>N</mi>
      <mo>↑</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </msub>
   </mpadded>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>p</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>δ</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">d</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">similar-to-or-equals</csymbol>
     <apply>
      <ci>normal-↑</ci>
      <ci>N</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{p}(dx_{k}|x_{k-1})=\frac{1}{N}\sum_{i=1}^{N}\delta_{X^{i}_{k}(x_{k-1}%
)}(dx_{k})~{}\simeq_{N\uparrow\infty}~{}p(x_{k}|x_{k-1})dx_{k}
  </annotation>
 </semantics>
</math>

 one natural strategy is to use the following particle approximation</p>

<p>

<math display="inline" id="Particle_filter:229">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

</p>

<p>with the empirical approximation</p>

<p>

<math display="inline" id="Particle_filter:230">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msubsup>
       <mi>X</mi>
       <mi>k</mi>
       <mi>i</mi>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="5.8pt">,</mo>
     <mi>i</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>i</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>i</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{i}_{k}(x_{k-1}),~{}i=1,...,N
  </annotation>
 </semantics>
</math>

</p>

<p>associated with 

<math display="inline" id="Particle_filter:231">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k}
  </annotation>
 </semantics>
</math>

 (or any other large number of samples) independent random samples 

<math display="inline" id="Particle_filter:232">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{k-1}=x_{k-1}
  </annotation>
 </semantics>
</math>

with the conditional distribution of the random state 

<math display="inline" id="Particle_filter:233">
 <semantics>
  <msub>
   <mi>δ</mi>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>δ</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{a}
  </annotation>
 </semantics>
</math>

 given 

<math display="block" id="Particle_filter:234">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="4.2pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(x_{k}|x_{0:k-1},y_{0:k})=p(x_{k}|x_{k-1}).\,
  </annotation>
 </semantics>
</math>

. The consistency of the resulting particle filter of this approximation and other extensions are developed in.<a class="footnoteRef" href="#fn122" id="fnref122"><sup>122</sup></a> In the above display 

<math display="inline" id="Particle_filter:235">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,N
  </annotation>
 </semantics>
</math>

 stands for the <b role="presentation"><a href="Dirac_measure" title="wikilink">Dirac measure</a></b> at a given state a.</p>

<p>However, the transition prior probability distribution is often used as importance function, since it is easier to draw particles (or samples) and perform subsequent importance weight calculations:</p>

<p>

<math display="inline" id="Particle_filter:236">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,N
  </annotation>
 </semantics>
</math>

 <em>Sequential Importance Resampling</em> (SIR) filters with transition prior probability distribution as importance function are commonly known as <a href="Resampling_(statistics)#Bootstrap" title="wikilink">bootstrap filter</a> and <a href="condensation_algorithm" title="wikilink">condensation algorithm</a>.</p>

<p><em>Resampling</em> is used to avoid the problem of degeneracy of the algorithm, that is, avoiding the situation that all but one of the importance weights are close to zero. The performance of the algorithm can be also affected by proper choice of resampling method. The <em><a href="stratified_sampling" title="wikilink">stratified sampling</a></em> proposed by Kitagawa (1996) is optimal in terms of variance.</p>

<p>A single step of sequential importance resampling is as follows:</p>
<dl>
<dd>1) For 

<math display="block" id="Particle_filter:237">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mover accent="true">
      <mi>w</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>w</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>i</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mfrac>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">|</mo>
        <msubsup>
         <mi>x</mi>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>x</mi>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mo stretchy="false">|</mo>
        <msubsup>
         <mi>x</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>π</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>x</mi>
         <mi>k</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mo stretchy="false">|</mo>
        <msubsup>
         <mi>x</mi>
         <mrow>
          <mn>0</mn>
          <mo>:</mo>
          <mrow>
           <mi>k</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mn>0</mn>
          <mo>:</mo>
          <mi>k</mi>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>w</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>normal-)</ci>
       </cerror>
       <csymbol cd="unknown">p</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">π</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-(</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <ci>normal-|</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-:</ci>
          <cn type="integer">0</cn>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <ci>normal-,</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <ci>normal-:</ci>
          <cn type="integer">0</cn>
          <ci>k</ci>
         </apply>
        </apply>
        <ci>normal-)</ci>
       </cerror>
      </cerror>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{w}^{(i)}_{k}=w^{(i)}_{k-1}\frac{p(y_{k}|x^{(i)}_{k})p(x^{(i)}_{k}|x^{(i)}%
_{k-1})}{\pi(x_{k}^{(i)}|x^{(i)}_{0:k-1},y_{0:k})}.
  </annotation>
 </semantics>
</math>

 draw samples from the <em>proposal distribution</em>
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>x^{(i)}_k \sim \pi(x_k|x^{(i)}_{0:k-1},y_{0:k}) </p>
<dl>
<dd>2) For 

<math display="inline" id="Particle_filter:238">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>x</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>x</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mn>0</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi>x</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">π</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">0</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(x_{k}^{(i)}|x^{(i)}_{0:k-1},y_{0:k})=p(x^{(i)}_{k}|x^{(i)}_{k-1})
  </annotation>
 </semantics>
</math>

 update the importance weights up to a normalizing constant:
</dd>
</dl>

<p>

<math display="block" id="Particle_filter:239">
 <semantics>
  <mrow>
   <msubsup>
    <mover accent="true">
     <mi>w</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mi>w</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msubsup>
     <mi>x</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>w</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{w}^{(i)}_{k}=w^{(i)}_{k-1}p(y_{k}|x^{(i)}_{k}),
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>Note that when we use the transition prior probability distribution as the importance function, 

<math display="inline" id="Particle_filter:240">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,N
  </annotation>
 </semantics>
</math>

, this simplifies to the following :

<p>

<math display="inline" id="Particle_filter:241">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>N</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>𝑒𝑓𝑓</mi>
   </msub>
   <mo><</mo>
   <msub>
    <mi>N</mi>
    <mrow>
     <mi>t</mi>
     <mi>h</mi>
     <mi>r</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>N</ci>
     </apply>
     <ci>𝑒𝑓𝑓</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <apply>
      <times></times>
      <ci>t</ci>
      <ci>h</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{N}_{\mathit{eff}}<N_{thr}
  </annotation>
 </semantics>
</math>

</p>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd>3) For 

<math display="inline" id="Particle_filter:242">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 compute the normalized importance weights:
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>w^{(i)}_k = \frac{\hat{w}^{(i)}_k}{\sum_{j=1}^N \hat{w}^{(j)}_k} </p>
<dl>
<dd>4) Compute an estimate of the effective number of particles as
</dd>
</dl>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\hat{N}_\mathit{eff} = \frac{1}{\sum_{i=1}^N\left(w^{(i)}_k\right)^2}  This criteria reflects the variance of the weights, other criteria can be found in the article,<a class="footnoteRef" href="#fn123" id="fnref123"><sup>123</sup></a> including their rigorous analysis and central limit theorems.</p>
<dl>
<dd>5) If the effective number of particles is less than a given threshold 

<math display="inline" id="Particle_filter:243">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,\ldots,N
  </annotation>
 </semantics>
</math>

, then perform resampling:
</dd>
</dl>
<dl>
<dd><dl>
<dd>a) Draw 

<math display="inline" id="Particle_filter:244">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>w</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>N</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mi>N</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <ci>N</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w^{(N)}_{k}=1/N.
  </annotation>
 </semantics>
</math>

 particles from the current particle set with probabilities proportional to their weights. Replace the current particle set with this new one.
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>b) For 

<math display="inline" id="Particle_filter:245">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 set 

<math display="inline" id="Particle_filter:246">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>The term <em>Sampling Importance Resampling</em> is also sometimes used when referring to SIR filters.</p>
<h3 id="sequential-importance-sampling-sis">Sequential importance sampling (SIS)</h3>
<ul>
<li>Is the same as sequential importance resampling, but without the resampling stage.</li>
</ul>
<h3 id="direct-version-algorithm">"direct version" algorithm</h3>

<p>The "direct version" algorithm  is rather simple (compared to other particle filtering algorithms) and it uses composition and rejection. To generate a single sample 

<math display="inline" id="Particle_filter:247">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mn>1</mn>
       <mo>:</mo>
       <mi>k</mi>
      </mrow>
     </msub>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>y</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <apply>
        <ci>normal-:</ci>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </apply>
      </apply>
     </cerror>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{x_{k}|y_{1:k}}(x|y_{1:k})
  </annotation>
 </semantics>
</math>

 at 

<math display="inline" id="Particle_filter:248">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mi>N</mi>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <ci>N</ci>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{1,...,N\}
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Particle_filter:249">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{x}
  </annotation>
 </semantics>
</math>

:</p>
<dl>
<dd>1) Set n=0 (This will count the number of particles generated so far)
</dd>
</dl>
<dl>
<dd>2) <a href="Uniform_distribution_(discrete)" title="wikilink">Uniformly</a> choose an index i from the range 

<math display="inline" id="Particle_filter:250">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mpadded width="+3.3pt">
    <mtext>with</mtext>
   </mpadded>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>x</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
     <mo stretchy="false">|</mo>
     <mi>k</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <mtext>with</mtext>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">k</csymbol>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>normal-|</ci>
       <csymbol cd="unknown">k</csymbol>
       <minus></minus>
       <cn type="integer">1</cn>
      </cerror>
     </apply>
     <ci>i</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x_{k}|x_{k-1}),~{}\mbox{with}~{}x_{k-1}=x_{k-1|k-1}^{(i)}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<dl>
<dd>3) Generate a test 

<math display="inline" id="Particle_filter:251">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{y}
  </annotation>
 </semantics>
</math>

 from the distribution 

<math display="inline" id="Particle_filter:252">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{x}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<dl>
<dd>4) Generate the probability of 

<math display="inline" id="Particle_filter:253">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mpadded width="+3.3pt">
    <mtext>with</mtext>
   </mpadded>
   <msub>
    <mi>x</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">^</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <mtext>with</mtext>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>x</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{k}|x_{k}),~{}\mbox{with}~{}x_{k}=\hat{x}
  </annotation>
 </semantics>
</math>

 using 

<math display="inline" id="Particle_filter:254">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{k}
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Particle_filter:255">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mn>0</mn>
   <mo>,</mo>
   <msub>
    <mi>m</mi>
    <mi>k</mi>
   </msub>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <cn type="integer">0</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>k</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [0,m_{k}]
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Particle_filter:256">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mo>sup</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
   </msub>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>k</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">supremum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{k}=\sup_{x_{k}}p(y_{k}|x_{k})
  </annotation>
 </semantics>
</math>

 is the measured value
</dd>
</dl>
<dl>
<dd>5) Generate another <a href="Uniform_distribution_(continuous)" title="wikilink">uniform</a> u from 

<math display="inline" id="Particle_filter:257">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo>(</mo>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <apply>
     <ci>normal-^</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\left(\hat{y}\right)
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Particle_filter:258">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{x}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<dl>
<dd>6) Compare u and 

<math display="inline" id="Particle_filter:259">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mrow>
    <mi>k</mi>
    <mo stretchy="false">|</mo>
    <mi>k</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">k</csymbol>
      <ci>normal-|</ci>
      <csymbol cd="unknown">k</csymbol>
     </cerror>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k|k}^{(i)}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
<dl>
<dd><dl>
<dd>6a) If u is larger then repeat from step 2
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>6b) If u is smaller then save 

<math display="inline" id="Particle_filter:260">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 as 

<math display="inline" id="Particle_filter:261">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 and increment n
</dd>
</dl>
</dd>
</dl>
<dl>
<dd>7) If n == N then quit
</dd>
</dl>

<p>The goal is to generate P "particles" at 

<math display="inline" id="Particle_filter:262">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 using only the particles from 

<math display="inline" id="Particle_filter:263">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k-1}
  </annotation>
 </semantics>
</math>

. This requires that a Markov equation can be written (and computed) to generate a 

<math display="inline" id="Particle_filter:264">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 based only upon 

<math display="inline" id="Particle_filter:265">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

. This algorithm uses composition of the P particles from 

<math display="inline" id="Particle_filter:266">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 to generate a particle at 

<math display="inline" id="Particle_filter:267">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and repeats (steps 2–6) until P particles are generated at 

<math display="inline" id="Particle_filter:268">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

.</p>

<p>This can be more easily visualized if 

<math display="inline" id="Particle_filter:269">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <interval closure="open">
     <ci>k</ci>
     <ci>i</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(k,i)
  </annotation>
 </semantics>
</math>

 is viewed as a two-dimensional array. One dimension is 

<math display="inline" id="Particle_filter:270">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 and the other dimensions is the particle number. For example, 

<math display="inline" id="Particle_filter:271">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}^{(i)}
  </annotation>
 </semantics>
</math>

 would be the i<sup>th</sup> particle at 

<math display="inline" id="Particle_filter:272">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 and can also be written 

<math display="inline" id="Particle_filter:273">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k-1}^{(i)}
  </annotation>
 </semantics>
</math>

 (as done above in the algorithm). Step 3 generates a <em>potential</em> 

<math display="inline" id="Particle_filter:274">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 based on a randomly chosen particle (

<math display="inline" id="Particle_filter:275">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

) at time 

<math display="inline" id="Particle_filter:276">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mi>k</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <apply>
     <minus></minus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k-1}
  </annotation>
 </semantics>
</math>

 and rejects or accepts it in step 6. In other words, the <span class="LaTeX">$x_k$</span> values are generated using the previously generated <span class="LaTeX">$x_{k-1}$</span>.</p>
<h2 id="other-particle-filters">Other particle filters</h2>
<ul>
<li><a href="Auxiliary_particle_filter" title="wikilink">Auxiliary particle filter</a> <a class="footnoteRef" href="#fn124" id="fnref124"><sup>124</sup></a></li>
<li><a href="Regularized_auxiliary_particle_filter" title="wikilink">Regularized auxiliary particle filter</a> <a class="footnoteRef" href="#fn125" id="fnref125"><sup>125</sup></a></li>
<li>Gaussian particle filter</li>
<li>Unscented particle filter</li>
<li>Gauss–Hermite particle filter</li>
<li>Cost Reference particle filter</li>
<li>Hierarchical/Scalable particle filter <a class="footnoteRef" href="#fn126" id="fnref126"><sup>126</sup></a></li>
<li>Rao–Blackwellized particle filter <a class="footnoteRef" href="#fn127" id="fnref127"><sup>127</sup></a></li>
<li><a href="Rejection_sampling" title="wikilink">Rejection-sampling</a> based optimal particle filter <ref name="optrj2008"></ref></li>
</ul>

<p><a class="footnoteRef" href="#fn128" id="fnref128"><sup>128</sup></a></p>
<ul>
<li>Feynman-Kac and mean field particle methodologies<a class="footnoteRef" href="#fn129" id="fnref129"><sup>129</sup></a><a class="footnoteRef" href="#fn130" id="fnref130"><sup>130</sup></a><a class="footnoteRef" href="#fn131" id="fnref131"><sup>131</sup></a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Mean_field_particle_methods" title="wikilink">Mean field particle methods</a></li>
<li><a href="Genetic_algorithm" title="wikilink">Genetic algorithms</a></li>
<li><a href="Ensemble_Kalman_filter" title="wikilink">Ensemble Kalman filter</a></li>
<li><a href="Generalized_filtering" title="wikilink">Generalized filtering</a></li>
<li><a href="Moving_horizon_estimation" title="wikilink">Moving horizon estimation</a></li>
<li><a href="Recursive_Bayesian_estimation" title="wikilink">Recursive Bayesian estimation</a></li>
<li><a href="Monte_Carlo_localization" title="wikilink">Monte Carlo localization</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="bibliography">Bibliography</h2>
<ul>
<li>Del Moral, Pierre (1996). "Non Linear Filtering: Interacting Particle Solution." <a href="http://web.maths.unsw.edu.au/~peterdel-moral/mprfs.pdf">1</a>. <em>Markov Processes and Related Fields</em> <strong>2</strong> (4): 555–580.</li>
<li>Del Moral, Pierre (2004). <em><a href="http://www.springer.com/us/book/9780387202686#reviews">Feynman-Kac formulae. Genealogical and interacting particle approximations</a></em>. Springer. p. 575. <q>Series: Probability and Applications</q></li>
<li>Del Moral, Pierre (2013). <em><a href="https://www.crcpress.com/product/isbn/9781466504059">Mean field simulation for Monte Carlo integration</a></em><a href="https://www.crcpress.com/product/isbn/9781466504059">.</a> Chapman &amp; Hall/CRC Press. p. 626. <q>Monographs on Statistics &amp; Applied Probability</q></li>
<li></li>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://web.maths.unsw.edu.au/~peterdel-moral/simulinks.html">Feynman–Kac models and interacting particle algorithms (a.k.a. Particle Filtering)</a> Theoretical aspects and a list of application domains of particle filters</li>
<li><a href="http://www-sigproc.eng.cam.ac.uk/smc/">Sequential Monte Carlo Methods (Particle Filtering)</a> homepage on University of Cambridge</li>
<li><a href="http://www.cs.washington.edu/ai/Mobile_Robotics/mcl/">Dieter Fox's MCL Animations</a></li>
<li><a href="http://blogs.oregonstate.edu/hess/code/particles/">Rob Hess' free software</a></li>
<li><a href="http://www.jstatsoft.org/v30/i06/">SMCTC: A Template Class for Implementing SMC algorithms in C++</a></li>
<li><a href="http://www.oursland.net/projects/particlefilter/">Java applet on particle filtering</a></li>
<li><a href="http://zhouyan.github.io/vSMC/">vSMC : Vectorized Sequential Monte Carlo</a></li>
</ul>

<p>"</p>

<p><a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Monte_Carlo_methods" title="wikilink">Category:Monte Carlo methods</a> <a href="Category:Computational_statistics" title="wikilink">Category:Computational statistics</a> <a href="Category:Control_theory" title="wikilink"> </a> <a href="Category:Nonlinear_filters" title="wikilink">Category:Nonlinear filters</a> <a href="Category:Robot_control" title="wikilink">Category:Robot control</a> <a href="Category:Numerical_analysis" title="wikilink">Category:Numerical analysis</a> <a href="Category:Statistical_mechanics" title="wikilink">Category:Statistical mechanics</a> <a href="Category:Sampling_techniques" title="wikilink">Category:Sampling techniques</a> <a href="Category:Stochastic_simulation" title="wikilink">Category:Stochastic simulation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"></li>
<li id="fn28"></li>
<li id="fn29"></li>
<li id="fn30"></li>
<li id="fn31"></li>
<li id="fn32"><a href="#fnref32">↩</a></li>
<li id="fn33"></li>
<li id="fn34"><a href="#fnref34">↩</a></li>
<li id="fn35"><a href="#fnref35">↩</a></li>
<li id="fn36"><a href="#fnref36">↩</a></li>
<li id="fn37"></li>
<li id="fn38"><a href="#fnref38">↩</a></li>
<li id="fn39"></li>
<li id="fn40"><a href="#fnref40">↩</a></li>
<li id="fn41"><a href="#fnref41">↩</a></li>
<li id="fn42"></li>
<li id="fn43"><a href="#fnref43">↩</a></li>
<li id="fn44">P. Del Moral, G. Rigal, and G. Salut. Estimation and nonlinear optimal control : An unified framework for particle solutions<br/>
LAAS-CNRS, Toulouse, Research Report no. 91137, DRET-DIGILOG- LAAS/CNRS contract, April (1991).<a href="#fnref44">↩</a></li>
<li id="fn45">P. Del Moral, G. Rigal, and G. Salut. Nonlinear and non Gaussian particle filters applied to inertial platform repositioning.<br/>
LAAS-CNRS, Toulouse, Research Report no. 92207, STCAN/DIGILOG-LAAS/CNRS Convention STCAN no. A.91.77.013, (94p.) September (1991).<a href="#fnref45">↩</a></li>
<li id="fn46">P. Del Moral, G. Rigal, and G. Salut. Estimation and nonlinear optimal control : Particle resolution in filtering and estimation. Experimental results.<br/>
Convention DRET no. 89.34.553.00.470.75.01, Research report no.2 (54p.), January (1992).<a href="#fnref46">↩</a></li>
<li id="fn47">P. Del Moral, G. Rigal, and G. Salut. Estimation and nonlinear optimal control : Particle resolution in filtering and estimation. Theoretical results<br/>
Convention DRET no. 89.34.553.00.470.75.01, Research report no.3 (123p.), October (1992).<a href="#fnref47">↩</a></li>
<li id="fn48">P. Del Moral, J.-Ch. Noyer, G. Rigal, and G. Salut. Particle filters in radar signal processing : detection, estimation and air targets recognition.<br/>
LAAS-CNRS, Toulouse, Research report no. 92495, December (1992).<a href="#fnref48">↩</a></li>
<li id="fn49">P. Del Moral, G. Rigal, and G. Salut. Estimation and nonlinear optimal control : Particle resolution in filtering and estimation.<br/>
Studies on: Filtering, optimal control, and maximum likelihood estimation. Convention DRET no. 89.34.553.00.470.75.01. Research report no.4 (210p.), January (1993).<a href="#fnref49">↩</a></li>
<li id="fn50"></li>
<li id="fn51"></li>
<li id="fn52"></li>
<li id="fn53"><a href="#fnref53">↩</a></li>
<li id="fn54"><a href="#fnref54">↩</a></li>
<li id="fn55"><a href="#fnref55">↩</a></li>
<li id="fn56"><a href="#fnref56">↩</a></li>
<li id="fn57"></li>
<li id="fn58"></li>
<li id="fn59"></li>
<li id="fn60"><a href="#fnref60">↩</a></li>
<li id="fn61"></li>
<li id="fn62"><a href="#fnref62">↩</a></li>
<li id="fn63"><a href="#fnref63">↩</a></li>
<li id="fn64"><a href="#fnref64">↩</a></li>
<li id="fn65"></li>
<li id="fn66"></li>
<li id="fn67"><a href="#fnref67">↩</a></li>
<li id="fn68"><a href="#fnref68">↩</a></li>
<li id="fn69"></li>
<li id="fn70"><a href="#fnref70">↩</a></li>
<li id="fn71"></li>
<li id="fn72"><a href="#fnref72">↩</a></li>
<li id="fn73"></li>
<li id="fn74"><a href="#fnref74">↩</a></li>
<li id="fn75"><a href="#fnref75">↩</a></li>
<li id="fn76"><a href="#fnref76">↩</a></li>
<li id="fn77"><a href="#fnref77">↩</a></li>
<li id="fn78"><a href="#fnref78">↩</a></li>
<li id="fn79"><a href="#fnref79">↩</a></li>
<li id="fn80"><a href="#fnref80">↩</a></li>
<li id="fn81"><a href="#fnref81">↩</a></li>
<li id="fn82"></li>
<li id="fn83"></li>
<li id="fn84"></li>
<li id="fn85"></li>
<li id="fn86"></li>
<li id="fn87"></li>
<li id="fn88"></li>
<li id="fn89"></li>
<li id="fn90"></li>
<li id="fn91"></li>
<li id="fn92"></li>
<li id="fn93"></li>
<li id="fn94"></li>
<li id="fn95"></li>
<li id="fn96"></li>
<li id="fn97"></li>
<li id="fn98"></li>
<li id="fn99"></li>
<li id="fn100"></li>
<li id="fn101"></li>
<li id="fn102"></li>
<li id="fn103"></li>
<li id="fn104"></li>
<li id="fn105"></li>
<li id="fn106"></li>
<li id="fn107"></li>
<li id="fn108"></li>
<li id="fn109"><a href="#fnref109">↩</a></li>
<li id="fn110"><a href="#fnref110">↩</a></li>
<li id="fn111"></li>
<li id="fn112"></li>
<li id="fn113"></li>
<li id="fn114"></li>
<li id="fn115"></li>
<li id="fn116"></li>
<li id="fn117"></li>
<li id="fn118"></li>
<li id="fn119"></li>
<li id="fn120"></li>
<li id="fn121"></li>
<li id="fn122"></li>
<li id="fn123"></li>
<li id="fn124"><a href="#fnref124">↩</a></li>
<li id="fn125"><a href="#fnref125">↩</a></li>
<li id="fn126"><a href="#fnref126">↩</a></li>
<li id="fn127"></li>
<li id="fn128"><a href="#fnref128">↩</a></li>
<li id="fn129"></li>
<li id="fn130"></li>
<li id="fn131"></li>
</ol>
</section>



   Design matrix      Design matrix   In statistics , a design matrix is a matrix of values of explanatory variables , often denoted by X , that is used in certain statistical models , e.g., the general linear model . 1 2 It can contain indicator variables (ones and zeros) that indicate group membership in an ANOVA , or it can contain values of continuous variables .  The design matrix contains data on the independent variables (also called explanatory variables) in statistical models which attempt to explain observed data on a response variable (often called a dependent variable ) in terms of the explanatory variables. The theory relating to such models makes substantial use of matrix manipulations involving the design matrix: see for example linear regression . A notable feature of the concept of a design matrix is that it is able to represent a number of different experimental designs and statistical models, e.g., ANOVA , ANCOVA , and linear regression .  Definition  In a regression model, written in matrix-vector form as       y  =    X  β   +  ϵ    ,      y      X  β   ϵ     y=X\beta+\epsilon,   the matrix X is the design matrix, while y is the vector of observations on the dependent variable,   β   β   \beta   is a vector of response coefficients (one for each explanatory variable) and   ϵ   ϵ   \epsilon   is a vector containing the values of the model's error term for the various observations. In the design matrix, each column is a vector of observations on one of the explanatory variables.  Examples  Simple Regression  This section gives an example of simple linear regression —that is, regression with only a single explanatory variable—with seven observations. The seven data points are { y i , x i }, for i = 1, 2, …, 7. The simple linear regression model is        y  i   =    β  0   +    β  1    x  i    +   ϵ  i     ,       subscript  y  i      subscript  β  0      subscript  β  1    subscript  x  i     subscript  ϵ  i      y_{i}=\beta_{0}+\beta_{1}x_{i}+\epsilon_{i},\,   where    β  0     subscript  β  0    \beta_{0}   is the y-intercept and    β  1     subscript  β  1    \beta_{1}   is the slope of the regression line. This model can be represented in matrix form as       [      y  1        y  2        y  3        y  4        y  5        y  6        y  7      ]   =     [     1     x  1       1     x  2       1     x  3       1     x  4       1     x  5       1     x  6       1     x  7      ]    [      β  0        β  1      ]    +   [      ϵ  1        ϵ  2        ϵ  3        ϵ  4        ϵ  5        ϵ  6        ϵ  7      ]           subscript  y  1      subscript  y  2      subscript  y  3      subscript  y  4      subscript  y  5      subscript  y  6      subscript  y  7           1   subscript  x  1     1   subscript  x  2     1   subscript  x  3     1   subscript  x  4     1   subscript  x  5     1   subscript  x  6     1   subscript  x  7        subscript  β  0      subscript  β  1         subscript  ϵ  1      subscript  ϵ  2      subscript  ϵ  3      subscript  ϵ  4      subscript  ϵ  5      subscript  ϵ  6      subscript  ϵ  7        \begin{bmatrix}y_{1}\\
 y_{2}\\
 y_{3}\\
 y_{4}\\
 y_{5}\\
 y_{6}\\
 y_{7}\end{bmatrix}=\begin{bmatrix}1&x_{1}\\
 1&x_{2}\\
 1&x_{3}\\
 1&x_{4}\\
 1&x_{5}\\
 1&x_{6}\\
 1&x_{7}\end{bmatrix}\begin{bmatrix}\beta_{0}\\
 \beta_{1}\end{bmatrix}+\begin{bmatrix}\epsilon_{1}\\
 \epsilon_{2}\\
 \epsilon_{3}\\
 \epsilon_{4}\\
 \epsilon_{5}\\
 \epsilon_{6}\\
 \epsilon_{7}\end{bmatrix}   where the first column of ones in the design matrix allows estimation of the y -intercept while the second column contains the x -values associated with the corresponding y -values.  Multiple Regression  This section contains an example of multiple regression with two covariates (explanatory variables): w and x . Again suppose that the data consist of seven observations, and that for each observed value to be predicted (    y  i     subscript  y  i    y_{i}   ), values w i and x i of the two covariates are also observed. The model to be considered is       y  i   =    β  0   +    β  1    w  i    +    β  2    x  i    +   ϵ  i         subscript  y  i      subscript  β  0      subscript  β  1    subscript  w  i       subscript  β  2    subscript  x  i     subscript  ϵ  i      y_{i}=\beta_{0}+\beta_{1}w_{i}+\beta_{2}x_{i}+\epsilon_{i}   This model can be written in matrix terms as       [      y  1        y  2        y  3        y  4        y  5        y  6        y  7      ]   =     [     1     w  1      x  1       1     w  2      x  2       1     w  3      x  3       1     w  4      x  4       1     w  5      x  5       1     w  6      x  6       1     w  7      x  7      ]    [      β  0        β  1        β  2      ]    +   [      ϵ  1        ϵ  2        ϵ  3        ϵ  4        ϵ  5        ϵ  6        ϵ  7      ]           subscript  y  1      subscript  y  2      subscript  y  3      subscript  y  4      subscript  y  5      subscript  y  6      subscript  y  7           1   subscript  w  1    subscript  x  1     1   subscript  w  2    subscript  x  2     1   subscript  w  3    subscript  x  3     1   subscript  w  4    subscript  x  4     1   subscript  w  5    subscript  x  5     1   subscript  w  6    subscript  x  6     1   subscript  w  7    subscript  x  7        subscript  β  0      subscript  β  1      subscript  β  2         subscript  ϵ  1      subscript  ϵ  2      subscript  ϵ  3      subscript  ϵ  4      subscript  ϵ  5      subscript  ϵ  6      subscript  ϵ  7        \begin{bmatrix}y_{1}\\
 y_{2}\\
 y_{3}\\
 y_{4}\\
 y_{5}\\
 y_{6}\\
 y_{7}\end{bmatrix}=\begin{bmatrix}1&w_{1}&x_{1}\\
 1&w_{2}&x_{2}\\
 1&w_{3}&x_{3}\\
 1&w_{4}&x_{4}\\
 1&w_{5}&x_{5}\\
 1&w_{6}&x_{6}\\
 1&w_{7}&x_{7}\end{bmatrix}\begin{bmatrix}\beta_{0}\\
 \beta_{1}\\
 \beta_{2}\end{bmatrix}+\begin{bmatrix}\epsilon_{1}\\
 \epsilon_{2}\\
 \epsilon_{3}\\
 \epsilon_{4}\\
 \epsilon_{5}\\
 \epsilon_{6}\\
 \epsilon_{7}\end{bmatrix}     Here the 7×3 matrix on the right side is the design matrix.  One-way ANOVA (Cell Means Model)  This section contains an example with a one-way analysis of variance ( ANOVA ) with three groups and seven observations. The given data set has the first three observations belonging to the first group, the following two observations belonging to the second group and the final two observations belonging to the third group. If the model to be fit is just the mean of each group, then the model is       y   i  j    =    μ  i   +   ϵ   i  j          subscript  y    i  j       subscript  μ  i    subscript  ϵ    i  j       y_{ij}=\mu_{i}+\epsilon_{ij}   which can be written       [      y  1        y  2        y  3        y  4        y  5        y  6        y  7      ]   =     [     1    0    0      1    0    0      1    0    0      0    1    0      0    1    0      0    0    1      0    0    1     ]    [      μ  1        μ  2        μ  3      ]    +   [      ϵ  1        ϵ  2        ϵ  3        ϵ  4        ϵ  5        ϵ  6        ϵ  7      ]           subscript  y  1      subscript  y  2      subscript  y  3      subscript  y  4      subscript  y  5      subscript  y  6      subscript  y  7           1  0  0    1  0  0    1  0  0    0  1  0    0  1  0    0  0  1    0  0  1       subscript  μ  1      subscript  μ  2      subscript  μ  3         subscript  ϵ  1      subscript  ϵ  2      subscript  ϵ  3      subscript  ϵ  4      subscript  ϵ  5      subscript  ϵ  6      subscript  ϵ  7        \begin{bmatrix}y_{1}\\
 y_{2}\\
 y_{3}\\
 y_{4}\\
 y_{5}\\
 y_{6}\\
 y_{7}\end{bmatrix}=\begin{bmatrix}1&0&0\\
 1&0&0\\
 1&0&0\\
 0&1&0\\
 0&1&0\\
 0&0&1\\
 0&0&1\end{bmatrix}\begin{bmatrix}\mu_{1}\\
 \mu_{2}\\
 \mu_{3}\end{bmatrix}+\begin{bmatrix}\epsilon_{1}\\
 \epsilon_{2}\\
 \epsilon_{3}\\
 \epsilon_{4}\\
 \epsilon_{5}\\
 \epsilon_{6}\\
 \epsilon_{7}\end{bmatrix}   It should be emphasized that in this model    μ  i     subscript  μ  i    \mu_{i}   represents the mean of the   i   i   i   th group.  One-way ANOVA (offset from reference group)  The ANOVA model could be equivalently written as each group parameter    τ  i     subscript  τ  i    \tau_{i}   being an offset from some overall reference. Typically this reference point is taken to be one of the groups under consideration. This makes sense in the context of comparing multiple treatment groups to a control group and the control group is considered the "reference". In this example, group 1 was chosen to be the reference group. As such the model to be fit is       y   i  j    =   μ  +   τ  i   +   ϵ   i  j          subscript  y    i  j      μ   subscript  τ  i    subscript  ϵ    i  j       y_{ij}=\mu+\tau_{i}+\epsilon_{ij}   with the constraint that    τ  1     subscript  τ  1    \tau_{1}   is zero.       [      y  1        y  2        y  3        y  4        y  5        y  6        y  7      ]   =     [     1    0    0      1    0    0      1    0    0      1    1    0      1    1    0      1    0    1      1    0    1     ]    [     μ       τ  2        τ  3      ]    +   [      ϵ  1        ϵ  2        ϵ  3        ϵ  4        ϵ  5        ϵ  6        ϵ  7      ]           subscript  y  1      subscript  y  2      subscript  y  3      subscript  y  4      subscript  y  5      subscript  y  6      subscript  y  7           1  0  0    1  0  0    1  0  0    1  1  0    1  1  0    1  0  1    1  0  1      μ     subscript  τ  2      subscript  τ  3         subscript  ϵ  1      subscript  ϵ  2      subscript  ϵ  3      subscript  ϵ  4      subscript  ϵ  5      subscript  ϵ  6      subscript  ϵ  7        \begin{bmatrix}y_{1}\\
 y_{2}\\
 y_{3}\\
 y_{4}\\
 y_{5}\\
 y_{6}\\
 y_{7}\end{bmatrix}=\begin{bmatrix}1&0&0\\
 1&0&0\\
 1&0&0\\
 1&1&0\\
 1&1&0\\
 1&0&1\\
 1&0&1\end{bmatrix}\begin{bmatrix}\mu\\
 \tau_{2}\\
 \tau_{3}\end{bmatrix}+\begin{bmatrix}\epsilon_{1}\\
 \epsilon_{2}\\
 \epsilon_{3}\\
 \epsilon_{4}\\
 \epsilon_{5}\\
 \epsilon_{6}\\
 \epsilon_{7}\end{bmatrix}   In this model   μ   μ   \mu   is the mean of the reference group and    τ  i     subscript  τ  i    \tau_{i}   is the difference from group   i   i   i   to the reference group.    τ  1     subscript  τ  1    \tau_{1}   is not included in the matrix because its difference from the reference group (itself) is necessarily zero.  See also   Hat matrix  Jacobian matrix and determinant   References    "  Category:Matrices  Category:Regression analysis  Category:Statistical terminology     Everitt, B. S. (2002). Cambridge Dictionary of Statistics (2nd edition). Cambridge, UK: Cambridge University Press. ISBN 0-521-81099-X ↩  Box, G. E. P. ; Tiao, G. C. (1992) [1973]. Bayesian Inference in Statistical Analysis . New York: John Wiley and Sons. ISBN 0-471-57428-7. (Section 8.1.1) ↩     
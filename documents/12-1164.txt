   Variational integrator      Variational integrator   Variational integrators are numerical integrators for Hamiltonian systems derived from the Euler‚ÄìLagrange equations of a discretized Hamilton's principle . Variational integrators are momentum-preserving and symplectic .  Derivation of a Simple Variational Integrator  Consider a mechanical system with a single particle degree of freedom described by the Lagrangian       L   (  t  ,  q  ,  v  )    =     1  2   m   v  2    -   V   (  q  )           L   t  q  v          1  2   m   superscript  v  2      V  q      L(t,q,v)=\frac{1}{2}mv^{2}-V(q)   ,  where   m   m   m   is the mass of the particle, and   V   V   V   is a potential. To construct a variational integrator for this system, we begin by forming the discrete Lagrangian . The discrete Lagrangian approximates the action for the system over a short time interval:        L  d    (   t  0   ,   t  1   ,   q  0   ,   q  1   )    =      t  1   -   t  0    2    [    L   (   t  0   ,   q  0   ,     q  1   -   q  0      t  1   -   t  0     )    +   L   (   t  1   ,   q  1   ,     q  1   -   q  0      t  1   -   t  0     )     ]    ‚âà    ‚à´   t  0    t  1     d   t   L   (  t  ,   q   (  t  )    ,   v   (  t  )    )              subscript  L  d     subscript  t  0    subscript  t  1    subscript  q  0    subscript  q  1            subscript  t  1    subscript  t  0    2    delimited-[]      L    subscript  t  0    subscript  q  0        subscript  q  1    subscript  q  0       subscript  t  1    subscript  t  0         L    subscript  t  1    subscript  q  1        subscript  q  1    subscript  q  0       subscript  t  1    subscript  t  0                 superscript   subscript    subscript  t  0     subscript  t  1      d  t  L   t    q  t     v  t         L_{d}\left(t_{0},t_{1},q_{0},q_{1}\right)=\frac{t_{1}-t_{0}}{2}\left[L\left(t_%
 {0},q_{0},\frac{q_{1}-q_{0}}{t_{1}-t_{0}}\right)+L\left(t_{1},q_{1},\frac{q_{1%
 }-q_{0}}{t_{1}-t_{0}}\right)\right]\approx\int_{t_{0}}^{t_{1}}dt\,L(t,q(t),v(t))   .  Here we have chosen to approximate the time integral using the trapezoid method, and we use a linear approximation to the trajectory,       q   (  t  )    ‚âà       q  1   -   q  0      t  1   -   t  0      (   t  -   t  0    )    +   q  0          q  t            subscript  q  1    subscript  q  0       subscript  t  1    subscript  t  0       t   subscript  t  0      subscript  q  0      q(t)\approx\frac{q_{1}-q_{0}}{t_{1}-t_{0}}\left(t-t_{0}\right)+q_{0}     between    t  0     subscript  t  0    t_{0}   and    t  1     subscript  t  1    t_{1}   , resulting in a constant velocity    v  ‚âà    (    q  1   -   q  0    )   /   (    t  1   -   t  0    )        v       subscript  q  1    subscript  q  0       subscript  t  1    subscript  t  0       v\approx\left(q_{1}-q_{0}\right)/\left(t_{1}-t_{0}\right)   . Different choices for the approximation to the trajectory and the time integral give different variational integrators. The order of accuracy of the integrator is controlled by the accuracy of our approximation to the action; since        L  d    (   t  0   ,   t  1   ,   q  0   ,   q  1   )    =     ‚à´   t  0    t  1     d   t   L   (  t  ,   q   (  t  )    ,   v   (  t  )    )     +   ùí™    (    t  1   -   t  0    )   3            subscript  L  d     subscript  t  0    subscript  t  1    subscript  q  0    subscript  q  1         superscript   subscript    subscript  t  0     subscript  t  1      d  t  L   t    q  t     v  t        ùí™   superscript     subscript  t  1    subscript  t  0    3       L_{d}\left(t_{0},t_{1},q_{0},q_{1}\right)=\int_{t_{0}}^{t_{1}}dt\,L(t,q(t),v(t%
 ))+\mathcal{O}\left(t_{1}-t_{0}\right)^{3}   ,  our integrator will be second-order accurate.  Evolution equations for the discrete system can be derived from a stationary-action principle. The discrete action over an extended time interval is a sum of discrete Lagrangians over many sub-intervals:       S  d   =     L  d    (   t  0   ,   t  1   ,   q  0   ,   q  1   )    +    L  d    (   t  1   ,   t  2   ,   q  1   ,   q  2   )    +  ‚Ä¶        subscript  S  d        subscript  L  d     subscript  t  0    subscript  t  1    subscript  q  0    subscript  q  1        subscript  L  d     subscript  t  1    subscript  t  2    subscript  q  1    subscript  q  2     normal-‚Ä¶     S_{d}=L_{d}\left(t_{0},t_{1},q_{0},q_{1}\right)+L_{d}\left(t_{1},t_{2},q_{1},q%
 _{2}\right)+\ldots   .  The principle of stationary action states that the action is stationary with respect to variations of coordinates that leave the endpoints of the trajectory fixed. So, varying the coordinate    q  1     subscript  q  1    q_{1}   , we have        ‚àÇ   S  d     ‚àÇ   q  1     =  0  =     ‚àÇ   ‚àÇ   q  1      L  d    (   t  0   ,   t  1   ,   q  0   ,   q  1   )    +    ‚àÇ   ‚àÇ   q  1      L  d    (   t  1   ,   t  2   ,   q  1   ,   q  2   )                subscript  S  d       subscript  q  1     0                 subscript  q  1      subscript  L  d     subscript  t  0    subscript  t  1    subscript  q  0    subscript  q  1             subscript  q  1      subscript  L  d     subscript  t  1    subscript  t  2    subscript  q  1    subscript  q  2         \frac{\partial S_{d}}{\partial q_{1}}=0=\frac{\partial}{\partial q_{1}}L_{d}%
 \left(t_{0},t_{1},q_{0},q_{1}\right)+\frac{\partial}{\partial q_{1}}L_{d}\left%
 (t_{1},t_{2},q_{1},q_{2}\right)   .  Given an initial condition    (   q  0   ,   q  1   )      subscript  q  0    subscript  q  1     (q_{0},q_{1})   , and a sequence of times    (   t  0   ,   t  1   ,   t  2   )      subscript  t  0    subscript  t  1    subscript  t  2     (t_{0},t_{1},t_{2})   this provides a relation that can be solved for    q  2     subscript  q  2    q_{2}   . The solution is       q  2   =     q  1   +      t  2   -   t  1      t  1   -   t  0      (    q  1   -   q  0    )     -      (    t  2   -   t  0    )    (    t  2   -   t  1    )     2  m     d   d   q  1     V   (   q  1   )          subscript  q  2        subscript  q  1          subscript  t  2    subscript  t  1       subscript  t  1    subscript  t  0        subscript  q  1    subscript  q  0               subscript  t  2    subscript  t  0       subscript  t  2    subscript  t  1       2  m      d    d   subscript  q  1     V   subscript  q  1       q_{2}=q_{1}+\frac{t_{2}-t_{1}}{t_{1}-t_{0}}\left(q_{1}-q_{0}\right)-\frac{%
 \left(t_{2}-t_{0}\right)\left(t_{2}-t_{1}\right)}{2m}\frac{d}{dq_{1}}V\left(q_%
 {1}\right)   .  We can write this in a simpler form if we define the discrete momenta,       p  0   ‚â°   -    ‚àÇ   ‚àÇ   q  0      L  d    (   t  0   ,   t  1   ,   q  0   ,   q  1   )          subscript  p  0             subscript  q  0      subscript  L  d     subscript  t  0    subscript  t  1    subscript  q  0    subscript  q  1        p_{0}\equiv-\frac{\partial}{\partial q_{0}}L_{d}\left(t_{0},t_{1},q_{0},q_{1}\right)     and       p  1   ‚â°    ‚àÇ   ‚àÇ   q  1      L  d    (   t  0   ,   t  1   ,   q  0   ,   q  1   )         subscript  p  1           subscript  q  1      subscript  L  d     subscript  t  0    subscript  t  1    subscript  q  0    subscript  q  1       p_{1}\equiv\frac{\partial}{\partial q_{1}}L_{d}\left(t_{0},t_{1},q_{0},q_{1}\right)   .  Given an initial condition    (   q  0   ,   p  0   )      subscript  q  0    subscript  p  0     (q_{0},p_{0})   , the stationary action condition is equivalent to solving the first of these equations for    q  1     subscript  q  1    q_{1}   , and then determining    p  1     subscript  p  1    p_{1}   using the second equation. This evolution scheme gives       q  1   =     q  0   +      t  1   -   t  0    m    p  0     -      (    t  1   -   t  0    )   2    2  m     d   d   q  0     V   (   q  0   )          subscript  q  1        subscript  q  0          subscript  t  1    subscript  t  0    m    subscript  p  0          superscript     subscript  t  1    subscript  t  0    2     2  m      d    d   subscript  q  0     V   subscript  q  0       q_{1}=q_{0}+\frac{t_{1}-t_{0}}{m}p_{0}-\frac{\left(t_{1}-t_{0}\right)^{2}}{2m}%
 \frac{d}{dq_{0}}V\left(q_{0}\right)     and       p  1   =    m     q  1   -   q  0      t  1   -   t  0      -      t  1   -   t  0    2    d   d   q  1     V   (   q  1   )          subscript  p  1       m       subscript  q  1    subscript  q  0       subscript  t  1    subscript  t  0             subscript  t  1    subscript  t  0    2     d    d   subscript  q  1     V   subscript  q  1       p_{1}=m\frac{q_{1}-q_{0}}{t_{1}-t_{0}}-\frac{t_{1}-t_{0}}{2}\frac{d}{dq_{1}}V%
 \left(q_{1}\right)   .  This is a leapfrog integration scheme for the system; two steps of this evolution are equivalent to the formula above for    q  2     subscript  q  2    q_{2}     References   E. Hairer, C. Lubich, and G. Wanner. Geometric Numerical Integration . Springer, 2002.  J. Marsden and M. West. Discrete mechanics and variational integrators . Acta Numerica, 2001, pp.¬†357‚Äì514.   "  Category:Numerical differential equations   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="492">Rietveld refinement</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Rietveld refinement</h1>
<hr/>

<p><strong>Rietveld refinement</strong> is a technique devised by <a href="Hugo_Rietveld" title="wikilink">Hugo Rietveld</a> for use in the characterisation of <a href="crystal" title="wikilink">crystalline</a> materials. The <a href="neutron_diffraction" title="wikilink">neutron</a> and <a href="x-ray_crystallography" title="wikilink">x-ray</a> diffraction of powder samples results in a pattern characterised by reflections (peaks in intensity) at certain positions. The height, width and position of these reflections can be used to determine many aspects of the material's structure.</p>

<p>The Rietveld method uses a <a href="least_squares" title="wikilink">least squares</a> approach to refine a theoretical line profile until it matches the measured profile. The introduction of this technique was a significant step forward in the diffraction analysis of powder samples as, unlike other techniques at that time, it was able to deal reliably with strongly overlapping reflections.</p>

<p>The method was first reported for the diffraction of monochromatic neutrons where the reflection-position is reported in terms of the Bragg angle 2<em>θ</em>. This terminology will be used here although the technique is equally applicable to alternative scales such as x-ray energy or neutron time-of-flight. The only wavelength and technique independent scale is in <a href="reciprocal_space" title="wikilink">reciprocal space</a> units or <a href="momentum_transfer" title="wikilink">momentum transfer</a> <em>Q</em>, which is historically rarely used in powder diffraction but very common in all other diffraction and optics techniques. The relation is</p>

<p>

<math display="block" id="Rietveld_refinement:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mn>4</mn>
      <mi>π</mi>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo>(</mo>
        <mi>θ</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mi>λ</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>π</ci>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
     </apply>
     <ci>λ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=\frac{4\pi\sin\left(\theta\right)}{\lambda}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="peak-shape">Peak shape</h2>

<p>The shape of a <a href="powder_diffraction" title="wikilink">powder diffraction</a> reflection is influenced by the characteristics of the beam, the experimental arrangement, and the sample size and shape. In the case of monochromatic neutron sources the convolution of the various effects has been found to result in a reflex almost exactly Gaussian in shape. If this distribution is assumed then the contribution of a given reflection to the profile y<sub>i</sub> at position 2<em>θ</em><sub>i</sub> is:</p>

<p>

<math display="inline" id="Rietveld_refinement:1">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>4</mn>
          <mrow>
           <mi>ln</mi>
           <mrow>
            <mo>(</mo>
            <mn>2</mn>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <msubsup>
         <mi>H</mi>
         <mi>k</mi>
         <mn>2</mn>
        </msubsup>
       </mfrac>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <msub>
            <mi>θ</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>2</mn>
           <msub>
            <mi>θ</mi>
            <mi>k</mi>
           </msub>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">4</cn>
          <apply>
           <ln></ln>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>k</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>θ</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>θ</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}=I_{k}\exp\left[\frac{-4\ln\left(2\right)}{H_{k}^{2}}\left(2\theta_{i}-2%
\theta_{k}\right)^{2}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>H</em><sub>k</sub> is the full width at half peak height (full-width half-maximum), 2<em>θ</em><sub>k</sub> is the centre of the reflex, and I<sub>k</sub> is the calculated intensity of the reflex (determined from the <a href="structure_factor" title="wikilink">structure factor</a>, the Lorentz factor, and <a href="Multiplicity_(mathematics)" title="wikilink">multiplicity</a> of the reflection)</p>

<p>At very low diffraction angles the reflections may acquire an asymmetry due to the vertical divergence of the beam. Rietveld used a semi-empirical correction factor, A<sub>s</sub> to account for this asymmetry</p>

<p>

<math display="inline" id="Rietveld_refinement:2">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mo>[</mo>
     <mfrac>
      <mrow>
       <mi>s</mi>
       <mi>P</mi>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <msub>
            <mi>θ</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>2</mn>
           <msub>
            <mi>θ</mi>
            <mi>k</mi>
           </msub>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <mi>tan</mi>
       <msub>
        <mi>θ</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>s</ci>
        <ci>P</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>θ</ci>
            <ci>i</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>θ</ci>
            <ci>k</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <tan></tan>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{s}=1-\left[\frac{sP\left(2\theta_{i}-2\theta_{k}\right)^{2}}{\tan\theta_{k}%
}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where P is the asymmetry factor and s is +1,0,-1 depending on the difference 2θ<sub>i</sub>-2θ<sub>k</sub> being positive, zero or negative respectively.</p>

<p>At a given position more than one diffraction peak may contribute to the profile. The intensity is simply the sum of all reflections contributing at the point 2θ<sub>i</sub>.</p>
<h2 id="peak-width">Peak width</h2>

<p>The width of the diffraction peaks are found to broaden at higher Bragg angles. This angular dependency was originally represented by</p>

<p>

<math display="inline" id="Rietveld_refinement:3">
 <semantics>
  <mrow>
   <msubsup>
    <mi>H</mi>
    <mi>k</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>U</mi>
     <mrow>
      <msup>
       <mi>tan</mi>
       <mn>2</mn>
      </msup>
      <msub>
       <mi>θ</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mi>tan</mi>
      <msub>
       <mi>θ</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mi>W</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>k</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>U</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <tan></tan>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <apply>
       <tan></tan>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <ci>W</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{k}^{2}=U\tan^{2}\theta_{k}+V\tan\theta_{k}+W
  </annotation>
 </semantics>
</math>

</p>

<p>where U, V and W are the halfwidth parameters and may be refined during the fit.</p>
<h2 id="preferred-orientation">Preferred orientation</h2>

<p>In powder samples there is a tendency for plate- or rod-like crystallites to align themselves along the axis of a cylindrical sample holder. In solid polycrystalline samples the production of the material may result in greater volume fraction of certain crystal orientations (commonly referred to as <a href="Texture_(crystalline)" title="wikilink">texture</a>). In such cases the reflex intensities will vary from that predicted for a completely random distribution. Rietveld allowed for moderate cases of the former by introducing a correction factor:</p>

<p>

<math display="inline" id="Rietveld_refinement:4">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mrow>
     <mi>c</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>r</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mrow>
      <mi>o</mi>
      <mi>b</mi>
      <mi>s</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>G</mi>
        <msup>
         <mi>α</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>o</ci>
      <ci>r</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <apply>
       <times></times>
       <ci>o</ci>
       <ci>b</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{corr}=I_{obs}\exp\left(-G\alpha^{2}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where I<sub>obs</sub> is the intensity expected for a random sample, G is the preferred orientation parameter and α is the acute angle between the scattering vector and the normal of the crystallites.</p>
<h2 id="refinement">Refinement</h2>

<p>The principle of the Rietveld Method is to minimise a function M which analyzes the difference between a calculated profile y(calc) and the observed data y(obs). Rietveld defined such an equation as:</p>

<p>

<math display="inline" id="Rietveld_refinement:5">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>i</mi>
    </msub>
    <mrow>
     <msub>
      <mi>W</mi>
      <mi>i</mi>
     </msub>
     <msup>
      <mrow>
       <mo>{</mo>
       <mrow>
        <msubsup>
         <mi>y</mi>
         <mi>i</mi>
         <mrow>
          <mi>o</mi>
          <mi>b</mi>
          <mi>s</mi>
         </mrow>
        </msubsup>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mi>c</mi>
         </mfrac>
         <msubsup>
          <mi>y</mi>
          <mi>i</mi>
          <mrow>
           <mi>c</mi>
           <mi>a</mi>
           <mi>l</mi>
           <mi>c</mi>
          </mrow>
         </msubsup>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>M</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>W</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <set>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <times></times>
           <ci>o</ci>
           <ci>b</ci>
           <ci>s</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <ci>c</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>i</ci>
           </apply>
           <apply>
            <times></times>
            <ci>c</ci>
            <ci>a</ci>
            <ci>l</ci>
            <ci>c</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </set>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M=\sum_{i}W_{i}\left\{y_{i}^{obs}-\frac{1}{c}y_{i}^{calc}\right\}^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>where W<sub>i</sub> is the statistical weight and c is an overall scale factor such that 

<math display="inline" id="Rietveld_refinement:6">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mrow>
     <mi>c</mi>
     <mi>a</mi>
     <mi>l</mi>
     <mi>c</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>c</mi>
    <msup>
     <mi>y</mi>
     <mrow>
      <mi>o</mi>
      <mi>b</mi>
      <mi>s</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>a</ci>
      <ci>l</ci>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <apply>
       <times></times>
       <ci>o</ci>
       <ci>b</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{calc}=cy^{obs}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://home.kpn.nl/rietv025/">The Rietveld Method</a> - the story.</li>
<li><a href="http://www.ing.unitn.it/~maud/">The MAUD program</a> - software for Rietveld refinement.</li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Crystallography" title="wikilink">Category:Crystallography</a> <a class="uri" href="Category:Diffraction" title="wikilink">Category:Diffraction</a> <a href="Category:Neutron-related_techniques" title="wikilink">Category:Neutron-related techniques</a></p>
</body>
</html>

   Sylvester equation      Sylvester equation   In mathematics , in the field of control theory , a Sylvester equation is a matrix  equation of the form: 1         A  X   +   X  B    =  C   .          A  X     X  B    C    AX+XB=C.   Then given matrices A , B , and C , the problem is to find the possible matrices X that obey this equation. All matrices are assumed to have coefficients in the complex numbers . For the equation to make sense, the matrices must have appropriate sizes, for example they could all be square matrices of the same size. But more generally, we could take A and B must be square matrices of sizes n and m respectively, and then X and C both have n rows and m columns.  A Sylvester equation has a unique solution for X exactly when there are no common eigenvalues of A and -B . More generally, the equation AX + XB = C has been considered as an equation of bounded operators on a (possibly infinite-dimensional) Banach space . In this case, the condition for the uniqueness of a solution X is almost the same: There exists a unique solution X exactly when the spectra of A and -B are disjoint . 2  Existence and uniqueness of the solutions  Using the Kronecker product notation and the vectorization operator    vec   vec   \operatorname{vec}   , we can rewrite Sylvester's equation in the form         (     I  n   ⊗  A   +    B  T   ⊗   I  n     )    vec  X    =   vec  C    ,           tensor-product   subscript  I  n   A    tensor-product   superscript  B  T    subscript  I  n      vec  X     vec  C     (I_{n}\otimes A+B^{T}\otimes I_{n})\operatorname{vec}X=\operatorname{vec}C,   where    I  n     subscript  I  n    I_{n}   is the    n  ×  n      n  n    n\times n    identity matrix . In this form, the equation can be seen as a linear system of dimension     n  2   ×   n  2        superscript  n  2    superscript  n  2     n^{2}\times n^{2}   . 3  Proposition.  Given complex    n  ×  n      n  n    n\times n   matrices   A   A   A   and   B   B   B   , Sylvester's equation has a unique solution   X   X   X   for all   C   C   C   if and only if   A   A   A   and    -  B      B    -B   have no common eigenvalues.  Proof. Consider the linear transformation    S  :    M  n   →   M  n       normal-:  S   normal-→   subscript  M  n    subscript  M  n      S:M_{n}\rightarrow M_{n}   given by    X  ↦    A  X   +   X  B       maps-to  X      A  X     X  B      X\mapsto AX+XB   .  (i) Suppose that   A   A   A   and    -  B      B    -B   have no common eigenvalues. Then their characteristic polynomials    f   (  z  )       f  z    f(z)   and    g   (  z  )       g  z    g(z)   have highest common factor   1   1   1   . Hence there exist complex polynomials    p   (  z  )       p  z    p(z)   and    q   (  z  )       q  z    q(z)   such that      p   (  z  )   f   (  z  )    +   q   (  z  )   g   (  z  )     =  1          p  z  f  z     q  z  g  z    1    p(z)f(z)+q(z)g(z)=1   . By the Cayley–Hamilton theorem,     f   (  A  )    =  0  =   g   (   -  B   )            f  A   0         g    B       f(A)=0=g(-B)   ; hence     g   (  A  )   q   (  A  )    =  I        g  A  q  A   I    g(A)q(A)=I   . Let   X   X   X   be any solution of     S   (  X  )    =  0        S  X   0    S(X)=0   ; so     A  X   =   -   X  B          A  X       X  B      AX=-XB   and repeating this one sees that    X  =   q   (  A  )   g   (  A  )   X   =   q   (  A  )   X  g   (   -  B   )    =  0        X    q  A  g  A  X          q  A  X  g    B         0     X=q(A)g(A)X=q(A)Xg(-B)=0   . Hence by the rank plus nullity theorem   S   S   S   is invertible, so for all   C   C   C   there exists a unique solution   X   X   X   .  (ii) Conversely, suppose that   s   s   s   is a common eigenvalue of   A   A   A   and    -  B      B    -B   . Note that   s   s   s   is also an eigenvalue of the transpose    A  T     superscript  A  T    A^{T}   . Then there exist non-zero vectors   v   v   v   and   w   w   w   such that      A  T   w   =   s  w          superscript  A  T   w     s  w     A^{T}w=sw   and     B  v   =   -   s  v          B  v       s  v      Bv=-sv   . Choose   C   C   C   such that     C  v   =   w  ¯         C  v    normal-¯  w     Cv=\overline{w}   , the vector whose entries are the complex conjugates of   w   w   w   . Then      A  X   +   X  B    =  C          A  X     X  B    C    AX+XB=C   has no solution   X   X   X   , as is clear from the complex bilinear pairing    [     A    C      0    B     ]      A  C    0  B     \begin{bmatrix}A&C\\
 0&B\end{bmatrix}   ; the right-hand side is positive whereas the left is zero.  Roth's removal rule  Given two square complex matrices A and B , of size n and m , and a matrix C of size n by m , then one can ask when the following two square matrices of size n+m are similar to each other    [     A    0      0     B  ;      ]      A  0    0  B     \begin{bmatrix}A&0\\
 0&B\end{bmatrix}   and       [      I  n     X      0     I  m      ]    [     A     C  ;       0     B  ;      ]    [      I  n      -  X       0     I  m      ]    =   [     A    0      0     B  ;      ]    .           subscript  I  n   X    0   subscript  I  m       A  C    0  B       subscript  I  n     X     0   subscript  I  m        A  0    0  B      \begin{bmatrix}I_{n}&X\\
 0&I_{m}\end{bmatrix}\begin{bmatrix}A&C\\
 0&B\end{bmatrix}\begin{bmatrix}I_{n}&-X\\
 0&I_{m}\end{bmatrix}=\begin{bmatrix}A&0\\
 0&B\end{bmatrix}.   . The answer is that these two matrices are similar exactly when there exists a matrix X such that AX - XB = C . In other words, X is a solution to a Sylvester equation. This is known as Roth's removal rule . 4  One easily checks one direction: If AX - XB = C then     A   A   A   Roth's removal rule does not generalize to infinite-dimensional bounded operators on a Banach space. 5  Numerical solutions  A classical algorithm for the numerical solution of the Sylvester equation is the Bartels–Stewart algorithm, which consists of transforming   B   B   B   and    (   n  3   )     superscript  n  3    (n^{3})   into Schur form by a QR algorithm , and then solving the resulting triangular system via back-substitution . This algorithm, whose computational cost is O $(n^3)$ arithmetical operations, is used, among others, by LAPACK and the lyap function in GNU Octave . See also the syl function in that language.  See also   Lyapunov equation  Algebraic Riccati equation   Notes  References         External links   Online solver for arbitrary sized matrices.  Mathematica function to solve the Sylvester equation  MATLAB function to solve the Sylvester equation   "  Category:Matrices  Category:Control theory     This equation is also commonly written in the equivalent form of AX-XB=C . ↩  Bhatia and Rosenthal, 1997 ↩  However, rewriting the equation in this form is not advised for the numerical solution since this version is costly to solve and can be ill-conditioned . ↩  ↩  Bhatia and Rosenthal, p.3 ↩     
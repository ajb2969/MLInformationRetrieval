   Heun's method      Heun's method   In mathematics and computational science , Heun's method may refer to the improved 1 or modified Euler's method (that is, the explicit trapezoidal rule 2 ), or a similar two-stage Runge–Kutta method . It is named after Karl Heun and is a numerical procedure for solving ordinary differential equations (ODEs) with a given initial value . Both variants can be seen as extensions of the Euler method into two-stage second-order Runge–Kutta methods.  The procedure for calculating the numerical solution to the initial value problem via the improved Euler's method is:          y  ′    (  t  )    =   f   (  t  ,   y   (  t  )    )     ,    y   (   t  0   )    =   y  0     ,     formulae-sequence       superscript  y  normal-′   t     f   t    y  t          y   subscript  t  0     subscript  y  0      y^{\prime}(t)=f(t,y(t)),\qquad\qquad y(t_{0})=y_{0},   by way of Heun's method, is to first calculate the intermediate value     y  ~    i  +  1      subscript   normal-~  y     i  1     \tilde{y}_{i+1}   and then the final approximation    y   i  +  1      subscript  y    i  1     y_{i+1}   at the next integration point.        y  ~    i  +  1    =    y  i   +   h  f   (   t  i   ,   y  i   )          subscript   normal-~  y     i  1       subscript  y  i     h  f    subscript  t  i    subscript  y  i        \tilde{y}_{i+1}=y_{i}+hf(t_{i},y_{i})           y   i  +  1    =    y  i   +    h  2    [    f   (   t  i   ,   y  i   )    +   f   (   t   i  +  1    ,    y  ~    i  +  1    )     ]      ,       subscript  y    i  1       subscript  y  i       h  2    delimited-[]      f    subscript  t  i    subscript  y  i       f    subscript  t    i  1     subscript   normal-~  y     i  1            y_{i+1}=y_{i}+\frac{h}{2}[f(t_{i},y_{i})+f(t_{i+1},\tilde{y}_{i+1})],   where   h   h   h   is the step size and     t   i  +  1    =    t  i   +  h        subscript  t    i  1       subscript  t  i   h     t_{i+1}=t_{i}+h   .  Description  Euler’s method is used as the foundation for Heun’s method. Euler's method uses the line tangent to the function at the beginning of the interval as an estimate of the slope of the function over the interval, assuming that if the step size is small, the error will be small. However, even when extremely small step sizes are used, over a large number of steps the error starts to accumulate and the estimate diverges from the actual functional value.  Where the solution curve is concave up, its tangent line will underestimate the vertical coordinate of the next point and vice versa for a concave down solution. The ideal prediction line would hit the curve at its next predicted point. In reality, there is no way to know whether the solution is concave-up or concave-down, and hence if the next predicted point will overestimate or underestimate its vertical value. The concavity of the curve cannot be guaranteed to remain consistent either and the prediction may overestimate and underestimate at different points in the domain of the solution. Heun’s Method addresses this problem by considering the interval spanned by the tangent line segment as a whole. Taking a concave-up example, the left tangent prediction line underestimates the slope of the curve for the entire width of the interval from the current point to the next predicted point. If the tangent line at the right end point is considered (which can be estimated using Euler’s Method), it has the opposite problem 3 The points along the tangent line of the left end point have vertical coordinates which all underestimate those that lie on the solution curve, including the right end point of the interval under consideration. The solution is to make the slope greater by some amount. Heun’s Method considers the tangent lines to the solution curve at both ends of the interval, one which overestimates , and one which underestimates the ideal vertical coordinates. A prediction line must be constructed based on the right end point tangent’s slope alone, approximated using Euler's Method. If this slope is passed through the left end point of the interval, the result is evidently too steep to be used as an ideal prediction line and overestimates the ideal point. Therefore, the ideal point lies approximately half way between the erroneous overestimation and underestimation, the average of the two slopes.  Euler’s Method is used to roughly estimate the coordinates of the next point in the solution, and with this knowledge, the original estimate is re-predicted or corrected . 4 Assuming that the quantity    f   (  x  ,  y  )       f   x  y     \textstyle f(x,y)   on the right hand side of the equation can be thought of as the slope of the solution sought at any point    (  x  ,  y  )     x  y    \textstyle(x,y)   , this can be combined with the Euler estimate of the next point to give the slope of the tangent line at the right end-point. Next the average of both slopes is used to find the corrected coordinates of the right end interval.  Derivation       Slope  left   =   f   (   x  i   ,   y  i   )         subscript  Slope  left     f    subscript  x  i    subscript  y  i       \textstyle\text{Slope}_{\text{left}}=f(x_{i},y_{i})          Slope  right   =   f   (    x  i   +  h   ,    y  i   +   h  f   (   x  i   ,   y  i   )     )         subscript  Slope  right     f      subscript  x  i   h      subscript  y  i     h  f    subscript  x  i    subscript  y  i          \textstyle\text{Slope}_{\text{right}}=f(x_{i}+h,y_{i}+hf(x_{i},y_{i}))          Slope  ideal   =    (   1  /  2   )    (    Slope  left   +   Slope  right    )         subscript  Slope  ideal       1  2      subscript  Slope  left    subscript  Slope  right       \textstyle\text{Slope}_{\text{ideal}}=(1/2)(\text{Slope}_{\text{left}}+\text{%
 Slope}_{\text{right}})     Using the principle that the slope of a line equates to the rise/run, the coordinates at the end of the interval can be found using the following formula:       Slope  ideal   =   (    Δ  y   /  h   )        subscript  Slope  ideal       normal-Δ  y   h     \textstyle\text{Slope}_{\text{ideal}}=(\Delta y/h)          Δ  y   =   h   (   Slope  ideal   )          normal-Δ  y     h   subscript  Slope  ideal      \textstyle\Delta y=h(\text{Slope}_{\text{ideal}})          x   i  +  1    =    x  i   +  h        subscript  x    i  1       subscript  x  i   h     \textstyle x_{i+1}=x_{i}+h   ,     y   i  +  1    =    y  i   +   Δ  y         subscript  y    i  1       subscript  y  i     normal-Δ  y      \textstyle y_{i+1}=y_{i}+\Delta y          y   i  +  1    =    y  i   +   h   Slope  ideal          subscript  y    i  1       subscript  y  i     h   subscript  Slope  ideal       \textstyle y_{i+1}=y_{i}+h\text{Slope}_{\text{ideal}}          y   i  +  1    =    y  i   +    1  2   h   (    Slope  left   +   Slope  right    )          subscript  y    i  1       subscript  y  i       1  2   h     subscript  Slope  left    subscript  Slope  right        y_{i+1}=y_{i}+\frac{1}{2}h(\text{Slope}_{\text{left}}+\text{Slope}_{\text{%
 right}})          y   i  +  1    =    y  i   +    h  2    (    f   (   x  i   ,   y  i   )    +   f   (    x  i   +  h   ,    y  i   +   h  f   (   x  i   ,   y  i   )     )     )          subscript  y    i  1       subscript  y  i       h  2       f    subscript  x  i    subscript  y  i       f      subscript  x  i   h      subscript  y  i     h  f    subscript  x  i    subscript  y  i             y_{i+1}=y_{i}+\frac{h}{2}(f(x_{i},y_{i})+f(x_{i}+h,y_{i}+hf(x_{i},y_{i})))     The accuracy of the Euler method improves only linearly with the step size is decreased, whereas the Heun Method improves accuracy quadratically . 5 The scheme can be compared with the implicit  trapezoidal method , but with    f   (   t   i  +  1    ,   y   i  +  1    )       f    subscript  t    i  1     subscript  y    i  1       f(t_{i+1},y_{i+1})   replaced by    f   (   t   i  +  1    ,    y  ~    i  +  1    )       f    subscript  t    i  1     subscript   normal-~  y     i  1       f(t_{i+1},\tilde{y}_{i+1})   in order to make it explicit.     y  ~    i  +  1      subscript   normal-~  y     i  1     \tilde{y}_{i+1}   is the result of one step of Euler's method on the same initial value problem. So, Heun's method is a predictor-corrector method with forward Euler's method as predictor and trapezoidal method as corrector.  Runge–Kutta method  The improved Euler's method is a two-stage Runge–Kutta method , and can be written using the Butcher tableau (after John C. Butcher ):       0      1         The other method referred to as Heun's method (also known as Ralston's method) has the Butcher table: 6       0      2/3         This method minimizes the truncation error.  References    "  Category:Numerical differential equations  Category:Runge–Kutta methods     . ↩  . ↩  ↩  . ↩  ↩  . ↩     
   Liouville's formula      Liouville's formula   In mathematics , Liouville's formula , also known as the Abel-Jacobi-Liouville Identity, is an equation that expresses the determinant of a square-matrix solution of a first-order system of homogeneous linear differential equations in terms of the sum of the diagonal coefficients of the system. The formula is named after the French  mathematician  Joseph Liouville . Jacobi's formula provides another representation of the same mathematical relationship.  Liouville's formula is a generalization of Abel's identity and can be used to prove it. Since Liouville's formula relates the different linearly independent solutions of the system of differential equations, it can help to find one solution from the other(s), see the example application below.  Statement of Liouville's formula  Consider the   n   n   n   -dimensional first-order homogeneous linear differential equation       y  ′   =   A   (  x  )    y         superscript  y  normal-′     A  x  y     y^{\prime}=A(x)y\,     on an interval    I   I   I   of the real line , where    A   (  x  )       A  x    A(x)   for    x  ∈  I      x  normal-∈  I    x∈I   denotes a square matrix of dimension   n   n   n   with real or complex entries. Let   Φ   normal-Φ   Φ   denote a matrix-valued solution on   I   I   I   , meaning that each    Φ   (  x  )       normal-Φ  x    Φ(x)   is a square matrix of dimension   n   n   n   with real or complex entries and the derivative satisfies          Φ  ′    (  x  )    =   A   (  x  )   Φ   (  x  )     ,   x  ∈  I    .     formulae-sequence       superscript  normal-Φ  normal-′   x     A  x  normal-Φ  x      x  I     \Phi^{\prime}(x)=A(x)\Phi(x),\qquad x\in I.     Let          tr   A   (  ξ  )    =    ∑   i  =  1   n     a   i  ,  i     (  ξ  )      ,   ξ  ∈  I    ,     formulae-sequence      tr  A  ξ     superscript   subscript     i  1    n      subscript  a   i  i    ξ       ξ  I     \mathrm{tr}\,A(\xi)=\sum_{i=1}^{n}a_{i,i}(\xi),\qquad\xi\in I,     denote the trace of , the sum of its diagonal entries. If the trace of   A   A   A   is a continuous function , then the determinant of   Φ   normal-Φ   Φ   satisfies       det   Φ   (  x  )     =   det   Φ   (   x  0   )    exp   (    ∫   x  0   x     tr   A   (  ξ  )   d  ξ    )              normal-Φ  x        normal-Φ   subscript  x  0       superscript   subscript    subscript  x  0    x     tr  A  ξ  d  ξ         \det\Phi(x)=\det\Phi(x_{0})\,\exp\biggl(\int_{x_{0}}^{x}\mathrm{tr}\,A(\xi)\,%
 \textrm{d}\xi\biggr)     for all   x   x   x   and in   I   I   I   .  Example application  This example illustrates how Liouville's formula can help to find the general solution of a first-order system of homogeneous linear differential equations. Consider       y  ′   =      (     1     -   1  /  x         1  +  x      -  1      )   ⏟     =   A   (  x  )      y        superscript  y  normal-′      subscript   normal-⏟    1      1  x        1  x     1        absent    A  x     y     y^{\prime}=\underbrace{\begin{pmatrix}1&-1/x\\
 1+x&-1\end{pmatrix}}_{=\,A(x)}y     on the open interval    I  =       I  absent    I=       (  0  ,    ∞   )     0    normal-  normal-∞     (0, ∞)   . Assume that the easy solution         y   (  x  )    =   (     1      x     )    ,   x  ∈  I    ,     formulae-sequence      y  x     1    x       x  I     y(x)=\begin{pmatrix}1\\
 x\end{pmatrix},\qquad x\in I,     is already found. Let       y   (  x  )    =   (       y  1    (  x  )          y  2    (  x  )       )         y  x        subscript  y  1   x        subscript  y  2   x       y(x)=\begin{pmatrix}y_{1}(x)\\
 y_{2}(x)\end{pmatrix}     denote another solution, then         Φ   (  x  )    =   (       y  1    (  x  )      1        y  2    (  x  )       x  ;      )    ,   x  ∈  I    ,     formulae-sequence      normal-Φ  x        subscript  y  1   x   1       subscript  y  2   x   x       x  I     \Phi(x)=\begin{pmatrix}y_{1}(x)&1\\
 y_{2}(x)&x\end{pmatrix},\qquad x\in I,     is a square-matrix-valued solution of the above differential equation. Since the trace of    A   (  x  )       A  x    A(x)   is zero for all    x  ∈  I      x  normal-∈  I    x∈I   , Liouville's formula implies that the determinant   is actually a constant independent of   x   x   x   . Writing down the first component of the differential equation for   y   y   y   , we obtain using () that          y  1  ′    (  x  )    =     y  1    (  x  )    -     y  2    (  x  )    x    =      x    y  1    (  x  )    -    y  2    (  x  )     x   =    c  1   x    ,   x  ∈  I    .     formulae-sequence         subscript   superscript  y  normal-′   1   x        subscript  y  1   x        subscript  y  2   x   x               x   subscript  y  1   x      subscript  y  2   x    x           subscript  c  1   x       x  I     y^{\prime}_{1}(x)=y_{1}(x)-\frac{y_{2}(x)}{x}=\frac{x\,y_{1}(x)-y_{2}(x)}{x}=%
 \frac{c_{1}}{x},\qquad x\in I.     Therefore, by integration, we see that          y  1    (  x  )    =     c  1    ln  x    +   c  2     ,   x  ∈  I    ,     formulae-sequence       subscript  y  1   x        subscript  c  1     x     subscript  c  2       x  I     y_{1}(x)=c_{1}\ln x+c_{2},\qquad x\in I,     involving the natural logarithm and the constant of integration  . Solving equation () for and substituting for gives          y  2    (  x  )    =     x    y  1    (  x  )    -   c  1    =      c  1   x   ln  x    +    c  2   x    -   c  1     ,   x  ∈  I    ,     formulae-sequence         subscript  y  2   x       x   subscript  y  1   x    subscript  c  1                subscript  c  1   x    x       subscript  c  2   x     subscript  c  1        x  I     y_{2}(x)=x\,y_{1}(x)-c_{1}=\,c_{1}x\ln x+c_{2}x-c_{1},\qquad x\in I,     which is the general solution for   y   y   y   . With the special choice 0}} and 1}} we recover the easy solution we started with, the choice 1}} and 0}} yields a linearly independent solution. Therefore,         Φ   (  x  )    =   (      ln  x     1        x   ln  x    -  1      x  ;      )    ,   x  ∈  I    ,     formulae-sequence      normal-Φ  x       x   1        x    x    1   x       x  I     \Phi(x)=\begin{pmatrix}\ln x&1\\
 x\ln x-1&x\end{pmatrix},\qquad x\in I,     is a so-called fundamental solution of the system.  Proof of Liouville's formula  We omit the argument   x   x   x   for brevity. By the Leibniz formula for determinants , the derivative of the determinant of  can be calculated by differentiating one row at a time and taking the sum, i.e.  Since the matrix-valued solution   Φ   normal-Φ   Φ   satisfies the equation    Φ  =   A  Φ       normal-Φ    A  normal-Φ     Φ=AΦ   , we have for every entry of the matrix   Φ   normal-Φ   Φ            Φ   i  ,  k   ′   =     ∑   j  =  1   n     a   i  ,  j      Φ   j  ,  k       ,  i    ,   k  ∈   {  1  ,  …  ,  n  }     ,     formulae-sequence     subscript   superscript  normal-Φ  normal-′    i  k       superscript   subscript     j  1    n      subscript  a   i  j     subscript  normal-Φ   j  k      i      k   1  normal-…  n      \Phi^{\prime}_{i,k}=\sum_{j=1}^{n}a_{i,j}\Phi_{j,k}\,,\qquad i,k\in\{1,\ldots,%
 n\},     or for the entire row         (   Φ   i  ,  1   ′   ,  …  ,   Φ   i  ,  n   ′   )   =    ∑   j  =  1   n     a   i  ,  j     (   Φ   j  ,  1    ,  …  ,   Φ   j  ,  n    )      ,   i  ∈   {  1  ,  …  ,  n  }     .     formulae-sequence      subscript   superscript  normal-Φ  normal-′    i  1    normal-…   subscript   superscript  normal-Φ  normal-′    i  n       superscript   subscript     j  1    n      subscript  a   i  j      subscript  normal-Φ   j  1    normal-…   subscript  normal-Φ   j  n          i   1  normal-…  n      (\Phi^{\prime}_{i,1},\dots,\Phi^{\prime}_{i,n})=\sum_{j=1}^{n}a_{i,j}(\Phi_{j,%
 1},\ldots,\Phi_{j,n}),\qquad i\in\{1,\ldots,n\}.     When we subtract from the   i   i   i    th row the linear combination        ∑       j  =  1        j  ≠  i       n     a   i  ,  j     (   Φ   j  ,  1    ,  …  ,   Φ   j  ,  n    )     ,      superscript   subscript    STACKED    j  1     j  i     n      subscript  a   i  j      subscript  normal-Φ   j  1    normal-…   subscript  normal-Φ   j  n        \sum_{\scriptstyle j=1\atop\scriptstyle j\not=i}^{n}a_{i,j}(\Phi_{j,1},\ldots,%
 \Phi_{j,n}),     of all the other rows, then the value of the determinant remains unchanged, hence       det   (      Φ   1  ,  1       Φ   1  ,  2      ⋯     Φ   1  ,  n        ⋮    ⋮       ⋮       Φ   i  ,  1   ′      Φ   i  ,  2   ′     ⋯     Φ   i  ,  n   ′       ⋮    ⋮       ⋮       Φ   n  ,  1       Φ   n  ,  2      ⋯     Φ   n  ,  n       )    =   det   (      Φ   1  ,  1       Φ   1  ,  2      ⋯     Φ   1  ,  n        ⋮    ⋮       ⋮        a   i  ,  i     Φ   i  ,  1        a   ;   i  ,  i     Φ   i  ,  2       ⋯     a   ;   i  ,  i     Φ   i  ,  n         ⋮    ⋮       ⋮       Φ   n  ,  1       Φ   n  ,  2      ⋯     Φ   n  ,  n       )    =    a   i  ,  i     det  Φ               subscript  normal-Φ   1  1     subscript  normal-Φ   1  2    normal-⋯   subscript  normal-Φ   1  n      normal-⋮  normal-⋮  absent  normal-⋮     subscript   superscript  normal-Φ  normal-′    i  1     subscript   superscript  normal-Φ  normal-′    i  2    normal-⋯   subscript   superscript  normal-Φ  normal-′    i  n      normal-⋮  normal-⋮  absent  normal-⋮     subscript  normal-Φ   n  1     subscript  normal-Φ   n  2    normal-⋯   subscript  normal-Φ   n  n            subscript  normal-Φ   1  1     subscript  normal-Φ   1  2    normal-⋯   subscript  normal-Φ   1  n      normal-⋮  normal-⋮  absent  normal-⋮       subscript  a   i  i     subscript  normal-Φ   i  1      fragments  a   subscript  normal-;   i  i     subscript  normal-Φ   i  2     normal-⋯   fragments  a   subscript  normal-;   i  i     subscript  normal-Φ   i  n       normal-⋮  normal-⋮  absent  normal-⋮     subscript  normal-Φ   n  1     subscript  normal-Φ   n  2    normal-⋯   subscript  normal-Φ   n  n               subscript  a   i  i      normal-Φ       \det\begin{pmatrix}\Phi_{1,1}&\Phi_{1,2}&\cdots&\Phi_{1,n}\\
 \vdots&\vdots&&\vdots\\
 \Phi^{\prime}_{i,1}&\Phi^{\prime}_{i,2}&\cdots&\Phi^{\prime}_{i,n}\\
 \vdots&\vdots&&\vdots\\
 \Phi_{n,1}&\Phi_{n,2}&\cdots&\Phi_{n,n}\end{pmatrix}=\det\begin{pmatrix}\Phi_{%
 1,1}&\Phi_{1,2}&\cdots&\Phi_{1,n}\\
 \vdots&\vdots&&\vdots\\
 a_{i,i}\Phi_{i,1}&a_{i,i}\Phi_{i,2}&\cdots&a_{i,i}\Phi_{i,n}\\
 \vdots&\vdots&&\vdots\\
 \Phi_{n,1}&\Phi_{n,2}&\cdots&\Phi_{n,n}\end{pmatrix}=a_{i,i}\det\Phi     for every } by the linearity of the determinant with respect to every row. Hence  by () and the definition of the trace. It remains to show that this representation of the derivative implies Liouville's formula.  Fix . Since the trace of   A   A   A   is assumed to be continuous function on   I   I   I   , it is bounded on every closed and bounded subinterval of   I   I   I   and therefore integrable, hence         g   (  x  )    :=   det   Φ   (  x  )    exp   (   -    ∫   x  0   x     tr   A   (  ξ  )   d  ξ     )       ,   x  ∈  I    ,     formulae-sequence   assign    g  x       normal-Φ  x        superscript   subscript    subscript  x  0    x     tr  A  ξ  d  ξ           x  I     g(x):=\det\Phi(x)\exp\left(-\int_{x_{0}}^{x}\mathrm{tr}\,A(\xi)\,\textrm{d}\xi%
 \right),\qquad x\in I,     is a well defined function. Differentiating both sides, using the product rule, the chain rule , the derivative of the exponential function and the fundamental theorem of calculus , we obtain          g  ′    (  x  )    =    (     (   det   Φ   (  x  )     )   ′   -   det   Φ   (  x  )    tr   A   (  x  )      )    exp   (   -    ∫   x  0   x     tr   A   (  ξ  )   d  ξ     )     =  0   ,   x  ∈  I    ,     formulae-sequence         superscript  g  normal-′   x        superscript      normal-Φ  x    normal-′       normal-Φ  x  tr  A  x           superscript   subscript    subscript  x  0    x     tr  A  ξ  d  ξ            0      x  I     g^{\prime}(x)=\bigl((\det\Phi(x))^{\prime}-\det\Phi(x)\,\mathrm{tr}\,A(x)\bigr%
 )\exp\biggl(-\int_{x_{0}}^{x}\mathrm{tr}\,A(\xi)\,\textrm{d}\xi\biggr)=0,%
 \qquad x\in I,     due to the derivative in (). Therefore,   g   g   g   has to be constant on   I   I   I   , because otherwise we would obtain a contradiction to the mean value theorem (applied separately to the real and imaginary part in the complex-valued case). Since det Φ( x 0 )}} , Liouville's formula follows by solving the definition of   g   g   g   for    d  e  t  Φ   (  x  )       d  e  t  normal-Φ  x    detΦ(x)   .  References      "  Category:Mathematical identities  Category:Ordinary differential equations  Category:Articles containing proofs   
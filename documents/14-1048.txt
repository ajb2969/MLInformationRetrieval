   Hamiltonian optics      Hamiltonian optics   Lagrangian optics 1 and Hamiltonian optics 2 are two formulations of geometrical optics which share much of the mathematical formalism with Lagrangian mechanics and Hamiltonian mechanics .  Hamilton's principle  In physics , Hamilton's principle states that the evolution of a system    (    q  1    (  σ  )    ,  ⋯  ,    q  N    (  σ  )    )        subscript  q  1   σ   normal-⋯     subscript  q  N   σ     \left(q_{1}\left(\sigma\right),\cdots,q_{N}\left(\sigma\right)\right)   described by   N   N   N    generalized coordinates between two specified states at two specified parameters σ A and σ B is a stationary point (a point where the variation is zero), of the action  functional , or       δ  S   =   δ    ∫   σ  A    σ  B     L   (   q  1   ,  ⋯  ,   q  N   ,    q  ˙   1   ,  ⋯  ,    q  ˙   N   ,  σ  )   d  σ     =  0          δ  S     δ    superscript   subscript    subscript  σ  A     subscript  σ  B      L    subscript  q  1   normal-⋯   subscript  q  N    subscript   normal-˙  q   1   normal-⋯   subscript   normal-˙  q   N   σ   d  σ          0     \delta S=\delta\int_{\sigma_{A}}^{\sigma_{B}}L\left(q_{1},\cdots,q_{N},\dot{q}%
 _{1},\cdots,\dot{q}_{N},\sigma\right)\,d\sigma=0     where      q  ˙   k   =     d   q  k    /  d   σ        subscript   normal-˙  q   k         d   subscript  q  k    d   σ     \dot{q}_{k}=dq_{k}/d\sigma   . Condition     δ  S   =  0        δ  S   0    \delta S=0   is valid if and only if the Euler-Lagrange equations are satisfied         ∂  L    ∂   q  k     -    d   d  σ      ∂  L    ∂    q  ˙   k       =  0            L      subscript  q  k         d    d  σ        L      subscript   normal-˙  q   k       0    \frac{\partial L}{\partial q_{k}}-\frac{d}{d\sigma}\frac{\partial L}{\partial%
 \dot{q}_{k}}=0     with    k  =   1  ,  ⋯  ,  N       k   1  normal-⋯  N     k=1,\cdots,N   .  The momentum is defined as       p  k   =    ∂  L    ∂    q  ˙   k          subscript  p  k       L      subscript   normal-˙  q   k       p_{k}=\frac{\partial L}{\partial\dot{q}_{k}}     and the Euler-Lagrange equations can then be rewritten as        p  ˙   k   =    ∂  L    ∂   q  k          subscript   normal-˙  p   k       L      subscript  q  k       \dot{p}_{k}=\frac{\partial L}{\partial q_{k}}     where      p  ˙   k   =     d   p  k    /  d   σ        subscript   normal-˙  p   k         d   subscript  p  k    d   σ     \dot{p}_{k}=dp_{k}/d\sigma   .  A different approach to solving this problem consists in defining a Hamiltonian (taking a Legendre transform of the Lagrangian ) as      H  =     ∑  k      q  ˙   k    p  k     -  L       H      subscript   k      subscript   normal-˙  q   k    subscript  p  k     L     H=\sum_{k}{\dot{q}_{k}}p_{k}-L     for which a new set of differential equations can be derived by looking at how the total differential of the Lagrangian depends on parameter σ , positions     q  i      subscript  q  i    q_{i}\,   and their derivatives     q  ˙   i     subscript   normal-˙  q   i    \dot{q}_{i}   relative to σ . This derivation is the same as in Hamiltonian mechanics, only with time t now replaced by a general parameter σ . Those differential equations are the Hamilton's equations          ∂  H    ∂   q  k     =   -     p  ˙   k      ,      ∂  H    ∂   p  k     =     q  ˙   k     ,     ∂  H    ∂  σ    =   -     ∂  L    ∂  σ         .     formulae-sequence        H      subscript  q  k        subscript   normal-˙  p   k      formulae-sequence        H      subscript  p  k      subscript   normal-˙  q   k          H     σ          L     σ         \frac{\partial H}{\partial q_{k}}=-\dot{p}_{k}\,,\quad\frac{\partial H}{%
 \partial p_{k}}=\dot{q}_{k}\,,\quad\frac{\partial H}{\partial\sigma}=-{%
 \partial L\over\partial\sigma}\,.     with    k  =   1  ,  ⋯  ,  N       k   1  normal-⋯  N     k=1,\cdots,N   . Hamilton's equations are first-order differential equations , while Euler-Lagrange's equations are second-order.  Lagrangian and Hamiltonian optics  The general results presented above for Hamilton's principle can be applied to optics. 3 4 In 3D  euclidean space the generalized coordinates are now the coordinates of euclidean space .  Fermat's principle  Fermat's principle states that the optical length of the path followed by light between two fixed points, A and B , is a stationary point. It may be a maximum, a minimum, constant or an inflection point . In general, as light travels, it moves in a medium of variable refractive index which is a scalar field of position in space, that is,    n  =   n   (   x  1   ,   x  2   ,   x  3   )        n    n    subscript  x  1    subscript  x  2    subscript  x  3       n=n\left(x_{1},x_{2},x_{3}\right)   in 3D  euclidean space . Assuming now that light travels along the x 3 axis, the path of a light ray may be parametrized as    s  =   (    x  1    (   x  3   )    ,    x  2    (   x  3   )    ,   x  3   )       s      subscript  x  1    subscript  x  3       subscript  x  2    subscript  x  3     subscript  x  3      s=\left(x_{1}\left(x_{3}\right),x_{2}\left(x_{3}\right),x_{3}\right)   starting at a point    𝐀  =   (    x  1    (   x   3  A    )    ,    x  2    (   x   3  A    )    ,   x   3  A    )       𝐀      subscript  x  1    subscript  x    3  A        subscript  x  2    subscript  x    3  A      subscript  x    3  A       \mathbf{A}=\left(x_{1}\left(x_{3A}\right),x_{2}\left(x_{3A}\right),x_{3A}\right)   and ending at a point    𝐁  =   (    x  1    (   x   3  B    )    ,    x  2    (   x   3  B    )    ,   x   3  B    )       𝐁      subscript  x  1    subscript  x    3  B        subscript  x  2    subscript  x    3  B      subscript  x    3  B       \mathbf{B}=\left(x_{1}\left(x_{3B}\right),x_{2}\left(x_{3B}\right),x_{3B}\right)   . In this case, when compared to Hamilton's principle above, coordinates    x  1     subscript  x  1    x_{1}   and    x  2     subscript  x  2    x_{2}   take the role of the generalized coordinates    q  k     subscript  q  k    q_{k}   while    x  3     subscript  x  3    x_{3}   takes the role of parameter   σ   σ   \sigma   , that is, parameter σ = x 3 and N =2.  In the context of calculus of variations this can be written as 5       δ  S   =   δ    ∫  𝐀  𝐁     n   d  s     =   δ    ∫   x   3  A     x   3  B      n     d  s    d   x  3      d   x  3      =   δ    ∫   x   3  A     x   3  B      L   (   x  1   ,   x  2   ,    x  ˙   1   ,    x  ˙   2   ,   x  3   )   d   x  3      =  0          δ  S     δ    superscript   subscript   𝐀   𝐁     n  d  s            δ    superscript   subscript    subscript  x    3  A      subscript  x    3  B       n      d  s     d   subscript  x  3     d   subscript  x  3             δ    superscript   subscript    subscript  x    3  A      subscript  x    3  B       L    subscript  x  1    subscript  x  2    subscript   normal-˙  x   1    subscript   normal-˙  x   2    subscript  x  3    d   subscript  x  3           0     \delta S=\delta\int_{\mathbf{A}}^{\mathbf{B}}n\,ds=\delta\int_{x_{3A}}^{x_{3B}%
 }n\frac{ds}{dx_{3}}\,dx_{3}=\delta\int_{x_{3A}}^{x_{3B}}L\left(x_{1},x_{2},%
 \dot{x}_{1},\dot{x}_{2},x_{3}\right)\,dx_{3}=0     where ds is an infinitesimal displacement along the ray given by     d  s   =     d   x  1  2    +   d   x  2  2    +   d   x  3  2            d  s         d   superscript   subscript  x  1   2      d   superscript   subscript  x  2   2      d   superscript   subscript  x  3   2        ds=\sqrt{dx_{1}^{2}+dx_{2}^{2}+dx_{3}^{2}}   and      L  =   n    d  s    d   x  3      =   n   (   x  1   ,   x  2   ,   x  3   )     1  +    x  ˙   1  2   +    x  ˙   2  2            L    n      d  s     d   subscript  x  3             n    subscript  x  1    subscript  x  2    subscript  x  3        1   superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2         L=n\frac{ds}{dx_{3}}=n\left(x_{1},x_{2},x_{3}\right)\sqrt{1+\dot{x}_{1}^{2}+%
 \dot{x}_{2}^{2}}     is the optical Lagrangian and      x  ˙   k   =     d   x  k    /  d    x  3         subscript   normal-˙  x   k         d   subscript  x  k    d    subscript  x  3      \dot{x}_{k}=dx_{k}/dx_{3}   .  The optical path length (OPL) is defined as      S  =    ∫  𝐀  𝐁     n   d  s    =    ∫  𝐀  𝐁     L   d   x  3           S    superscript   subscript   𝐀   𝐁     n  d  s           superscript   subscript   𝐀   𝐁     L  d   subscript  x  3        S=\int_{\mathbf{A}}^{\mathbf{B}}n\,ds=\int_{\mathbf{A}}^{\mathbf{B}}L\,dx_{3}     where n is the local refractive index as a function of position along the path between points A and B .  The Euler-Lagrange equations  The general results presented above for Hamilton's principle can be applied to optics using the Lagrangian defined in Fermat's principle . The Euler-Lagrange equations with parameter σ = x 3 and N =2 applied to Fermat's principle result in         ∂  L    ∂   x  k     -    d   d   x  3       ∂  L    ∂    x  ˙   k       =  0            L      subscript  x  k         d    d   subscript  x  3         L      subscript   normal-˙  x   k       0    \frac{\partial L}{\partial x_{k}}-\frac{d}{dx_{3}}\frac{\partial L}{\partial%
 \dot{x}_{k}}=0     with k =1,2 and where L is the optical Lagrangian and      x  ˙   k   =     d   x  k    /  d    x  3         subscript   normal-˙  x   k         d   subscript  x  k    d    subscript  x  3      \dot{x}_{k}=dx_{k}/dx_{3}   .  Optical momentum  The optical momentum is defined as       p  k   =    ∂  L    ∂    x  ˙   k          subscript  p  k       L      subscript   normal-˙  x   k       p_{k}=\frac{\partial L}{\partial\dot{x}_{k}}     and from the definition of the optical Lagrangian    L  =   n    1  +    x  ˙   1  2   +    x  ˙   2  2          L    n      1   superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2        L=n\sqrt{1+\dot{x}_{1}^{2}+\dot{x}_{2}^{2}}   this expression can be rewritten as       p  k   =   n     x  ˙   k       x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2       =   n    d   x  k       d   x  1  2    +   d   x  2  2    +   d   x  3  2        =   n    d   x  k     d  s            subscript  p  k     n     subscript   normal-˙  x   k        superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2              n      d   subscript  x  k          d   superscript   subscript  x  1   2      d   superscript   subscript  x  2   2      d   superscript   subscript  x  3   2               n      d   subscript  x  k      d  s        p_{k}=n\frac{\dot{x}_{k}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2%
 }}}=n\frac{dx_{k}}{\sqrt{dx_{1}^{2}+dx_{2}^{2}+dx_{3}^{2}}}=n\frac{dx_{k}}{ds}     (Figure)  Optical momentum   or in vector form      𝐩  =   n   𝐝𝐬   d  s     =   (   p  1   ,   p  2   ,   p  3   )         𝐩    n    𝐝𝐬    d  s            subscript  p  1    subscript  p  2    subscript  p  3       \mathbf{p}=n\frac{\mathbf{ds}}{ds}=\left(p_{1},p_{2},p_{3}\right)          =   (   n   cos   α  1     ,   n   cos   α  2     ,   n   cos   α  3     )   =   n   𝐞  ^          absent     n     subscript  α  1       n     subscript  α  2       n     subscript  α  3             n   normal-^  𝐞       =\left(n\cos\alpha_{1},n\cos\alpha_{2},n\cos\alpha_{3}\right)=n\mathbf{\hat{e}}     where    𝐞  ^     normal-^  𝐞    \mathbf{\hat{e}}   is a unit vector and angles α 1 , α 2 and α 3 are the angles p makes to axis x 1 , x 2 and x 3 respectively, as shown in figure "optical momentum". Therefore the optical momentum is a vector of norm       ∥  𝐩  ∥   =     p  1  2   +   p  2  2   +   p  3  2     =  n         norm  𝐩        superscript   subscript  p  1   2    superscript   subscript  p  2   2    superscript   subscript  p  3   2          n     \|\mathbf{p}\|=\sqrt{p_{1}^{2}+p_{2}^{2}+p_{3}^{2}}=n     where n is the refractive index at which p is calculated. Vector p points in the direction of propagation of light. If light is propagating in a gradient index optic the path of the light ray is curved and vector p is tangent to the light ray.  The expression for the optical path length can also be written as a function of the optical momentum. Having in consideration that      x  ˙   3   =     d   x  3    /  d    x  3    =  1         subscript   normal-˙  x   3         d   subscript  x  3    d    subscript  x  3         1     \dot{x}_{3}=dx_{3}/dx_{3}=1   the expression for the optical Lagrangian can be rewritten as      L  =   n      x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2      =      x  ˙   1     n    x  ˙   1        x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2       +     x  ˙   2     n    x  ˙   2        x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2       +    n    x  ˙   3        x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2             L    n       superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2                subscript   normal-˙  x   1       n   subscript   normal-˙  x   1         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2          subscript   normal-˙  x   2       n   subscript   normal-˙  x   2         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2           n   subscript   normal-˙  x   3         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2          L=n\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}=\dot{x}_{1}\frac{n%
 \dot{x}_{1}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+\dot{x}_{%
 2}\frac{n\dot{x}_{2}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+%
 \frac{n\dot{x}_{3}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}          =      x  ˙   1    p  1    +     x  ˙   2    p  2    +     x  ˙   3    p  3     =      x  ˙   1    p  1    +     x  ˙   2    p  2    +   p  3          absent       subscript   normal-˙  x   1    subscript  p  1       subscript   normal-˙  x   2    subscript  p  2       subscript   normal-˙  x   3    subscript  p  3               subscript   normal-˙  x   1    subscript  p  1       subscript   normal-˙  x   2    subscript  p  2     subscript  p  3       =\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+\dot{x}_{3}p_{3}=\dot{x}_{1}p_{1}+\dot{x}_{%
 2}p_{2}+p_{3}     and the expression for the optical path length is      S  =   ∫    L   d   x  3     =   ∫    𝐩  ⋅  d   𝐬          S      L  d   subscript  x  3               normal-⋅  𝐩  d   𝐬       S=\int L\,dx_{3}=\int\mathbf{p}\cdot d\mathbf{s}     Hamilton's equations  Similarly to what happens in Hamiltonian mechanics , also in optics the Hamiltonian is defined by the expression given above for N =2 corresponding to functions     x  1    (   x  3   )        subscript  x  1    subscript  x  3     x_{1}\left(x_{3}\right)   and     x  2    (   x  3   )        subscript  x  2    subscript  x  3     x_{2}\left(x_{3}\right)   to be determined      H  =       x  ˙   1    p  1    +     x  ˙   2    p  2     -  L       H         subscript   normal-˙  x   1    subscript  p  1       subscript   normal-˙  x   2    subscript  p  2     L     H=\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}-L     Comparing this expression with    L  =      x  ˙   1    p  1    +     x  ˙   2    p  2    +   p  3        L       subscript   normal-˙  x   1    subscript  p  1       subscript   normal-˙  x   2    subscript  p  2     subscript  p  3      L=\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+p_{3}   for the Lagrangian results in      H  =   -   p  3    =   -     n  2   -   p  1  2   -   p  2  2            H     subscript  p  3                superscript  n  2    superscript   subscript  p  1   2    superscript   subscript  p  2   2         H=-p_{3}=-\sqrt{n^{2}-p_{1}^{2}-p_{2}^{2}}     And the corresponding Hamilton's equations with parameter σ = x 3 and k =1,2 applied to optics are 6 7         ∂  H    ∂   x  k     =   -     p  ˙   k      ,     ∂  H    ∂   p  k     =    x  ˙   k       formulae-sequence        H      subscript  x  k        subscript   normal-˙  p   k           H      subscript  p  k      subscript   normal-˙  x   k      \frac{\partial H}{\partial x_{k}}=-\dot{p}_{k}\,,\quad\frac{\partial H}{%
 \partial p_{k}}=\dot{x}_{k}     with      x  ˙   k   =     d   x  k    /  d    x  3         subscript   normal-˙  x   k         d   subscript  x  k    d    subscript  x  3      \dot{x}_{k}=dx_{k}/dx_{3}   and      p  ˙   k   =     d   p  k    /  d    x  3         subscript   normal-˙  p   k         d   subscript  p  k    d    subscript  x  3      \dot{p}_{k}=dp_{k}/dx_{3}   .  Applications  It is assumed that light travels along the x 3 axis, in Hamilton's principle above, coordinates    x  1     subscript  x  1    x_{1}   and    x  2     subscript  x  2    x_{2}   take the role of the generalized coordinates    q  k     subscript  q  k    q_{k}   while    x  3     subscript  x  3    x_{3}   takes the role of parameter   σ   σ   \sigma   , that is, parameter σ = x 3 and N =2.  Refraction and reflection  If plane x 1 x 2 separates two media of refractive index n A below and n B above it, the refractive index is given by a step function       n   (   x  3   )    =   {      n  A       if   x  3    <  0        n  B       if   x  3    >  0             n   subscript  x  3     cases   subscript  n  A       if   subscript  x  3    0    subscript  n  B       if   subscript  x  3    0      n(x_{3})=\begin{cases}n_{A}&\mbox{if }x_{3}<0\\
 n_{B}&\mbox{if }x_{3}>0\\
 \end{cases}     and from Hamilton's equations        ∂  H    ∂   x  k     =   -    ∂   ∂   x  k        n    (   x  3   )   2    -   p  1  2   -   p  2  2       =  0            H      subscript  x  k               subscript  x  k           n   superscript   subscript  x  3   2     superscript   subscript  p  1   2    superscript   subscript  p  2   2            0     \frac{\partial H}{\partial x_{k}}=-\frac{\partial}{\partial x_{k}}\sqrt{n(x_{3%
 })^{2}-p_{1}^{2}-p_{2}^{2}}=0     and therefore      p  ˙   k   =  0       subscript   normal-˙  p   k   0    \dot{p}_{k}=0   or     p  k   =  Constant       subscript  p  k   Constant    p_{k}=\text{Constant}   for k =1,2.  An incoming light ray has momentum p A before refraction (below plane x 1 x 2 ) and momentum p B after refraction (above plane x 1 x 2 ). The light ray makes an angle θ A with axis x 3 (the normal to the refractive surface) before refraction and an angle θ B with axis x 3 after refraction. Since the p 1 and p 2 components of the momentum are constant, only p 3 changes from p 3 A to p 3 B .  (Figure)  Refraction   Figure "refraction" shows the geometry of this refraction from which    d  =    ∥   𝐩  A   ∥    sin   θ  A     =    ∥   𝐩  B   ∥    sin   θ  B           d     norm   subscript  𝐩  A       subscript  θ  A             norm   subscript  𝐩  B       subscript  θ  B        d=\|\mathbf{p}_{A}\|\sin\theta_{A}=\|\mathbf{p}_{B}\|\sin\theta_{B}   . Since     ∥   𝐩  A   ∥   =   n  A        norm   subscript  𝐩  A     subscript  n  A     \|\mathbf{p}_{A}\|=n_{A}   and     ∥   𝐩  B   ∥   =   n  B        norm   subscript  𝐩  B     subscript  n  B     \|\mathbf{p}_{B}\|=n_{B}   , this last expression can be written as        n  A    sin   θ  A     =    n  B    sin   θ  B            subscript  n  A      subscript  θ  A        subscript  n  B      subscript  θ  B       n_{A}\sin\theta_{A}=n_{B}\sin\theta_{B}     which is Snell's law of refraction .  In figure "refraction", the normal to the refractive surface points in the direction of axis x 3 , and also of vector    𝐯  =    𝐩  A   -   𝐩  B        𝐯     subscript  𝐩  A    subscript  𝐩  B      \mathbf{v}=\mathbf{p}_{A}-\mathbf{p}_{B}   . A unit normal    𝐧  =   𝐯  /   ∥  𝐯  ∥        𝐧    𝐯   norm  𝐯      \mathbf{n}=\mathbf{v}/\|\mathbf{v}\|   to the refractive surface can then be obtained from the momenta of the incoming and outgoing rays by      𝐧  =     𝐩  A   -   𝐩  B     ∥    𝐩  A   -   𝐩  B    ∥    =      n  A   𝐢   -    n  B   𝐫     ∥     n  A   𝐢   -    n  B   𝐫    ∥          𝐧       subscript  𝐩  A    subscript  𝐩  B     norm     subscript  𝐩  A    subscript  𝐩  B                  subscript  n  A   𝐢      subscript  n  B   𝐫     norm       subscript  n  A   𝐢      subscript  n  B   𝐫         \mathbf{n}=\frac{\mathbf{p}_{A}-\mathbf{p}_{B}}{\|\mathbf{p}_{A}-\mathbf{p}_{B%
 }\|}=\frac{n_{A}\mathbf{i}-n_{B}\mathbf{r}}{\|n_{A}\mathbf{i}-n_{B}\mathbf{r}\|}     where i and r are a unit vectors in the directions of the incident and refracted rays. Also, the outgoing ray (in the direction of    𝐩  B     subscript  𝐩  B    \mathbf{p}_{B}   ) is contained in the plane defined by the incoming ray (in the direction of    𝐩  A     subscript  𝐩  A    \mathbf{p}_{A}   ) and the normal   𝐧   𝐧   \mathbf{n}   to the surface.  A similar argument can be used for reflection in deriving the law of specular reflection , only now with n A = n B , resulting in θ A = θ B . Also, if i and r are unit vectors in the directions of the incident and refracted ray respectively, the corresponding normal to the surface is given by the same expression as for refraction, only with n A = n B      𝐧  =    𝐢  -  𝐫    ∥   𝐢  -  𝐫   ∥        𝐧      𝐢  𝐫    norm    𝐢  𝐫       \mathbf{n}=\frac{\mathbf{i}-\mathbf{r}}{\|\mathbf{i}-\mathbf{r}\|}     In vector form, if i is a unit vector pointing in the direction of the incident ray and n is the unit normal to the surface, the direction r of the refracted ray is given by: 8      𝐫  =      n  A    n  B    𝐢   +    (    -    (   𝐢  ⋅  𝐧   )     n  A    n  B      +   Δ    )   𝐧        𝐫         subscript  n  A    subscript  n  B    𝐢            normal-⋅  𝐢  𝐧      subscript  n  A    subscript  n  B        normal-Δ    𝐧      \mathbf{r}=\frac{n_{A}}{n_{B}}\mathbf{i}+\left(-\left(\mathbf{i}\cdot\mathbf{n%
 }\right)\frac{n_{A}}{n_{B}}+\sqrt{\Delta}\right)\mathbf{n}     with      Δ  =   1  -     (    n  A    n  B    )   2    (   1  -    (   𝐢  ⋅  𝐧   )   2    )         normal-Δ    1     superscript     subscript  n  A    subscript  n  B    2     1   superscript   normal-⋅  𝐢  𝐧   2        \Delta=1-\left(\frac{n_{A}}{n_{B}}\right)^{2}\left(1-\left(\mathbf{i}\cdot%
 \mathbf{n}\right)^{2}\right)     If i · n \Delta , light suffers total internal reflection and the expression for the reflected ray is that of reflection:      𝐫  =   𝐢  -   2   (   𝐢  ⋅  𝐧   )   𝐧        𝐫    𝐢    2   normal-⋅  𝐢  𝐧   𝐧      \mathbf{r}=\mathbf{i}-2\left(\mathbf{i}\cdot\mathbf{n}\right)\mathbf{n}     Rays and wavefronts  From the definition of optical path length    S  =   ∫    L   d   x  3         S      L  d   subscript  x  3       S=\int L\,dx_{3}           ∂  S    ∂   x  k     =   ∫      ∂  L    ∂   x  k      d   x  3     =   ∫      d   p  k     d   x  3      d   x  3     =   p  k             S      subscript  x  k             L      subscript  x  k     d   subscript  x  3                  d   subscript  p  k      d   subscript  x  3     d   subscript  x  3           subscript  p  k      \frac{\partial S}{\partial x_{k}}=\int\frac{\partial L}{\partial x_{k}}\,dx_{3%
 }=\int\frac{dp_{k}}{dx_{3}}\,dx_{3}=p_{k}     (Figure)  Rays and wavefronts   with k =1,2 where the Euler-Lagrange equations       ∂  L   /   ∂   x  k     =     d   p  k    /  d    x  3            L      subscript  x  k           d   subscript  p  k    d    subscript  x  3      \partial L/\partial x_{k}=dp_{k}/dx_{3}   with k =1,2 were used. Also, from the last of Hamilton's equations       ∂  H   /   ∂   x  3     =   -    ∂  L   /   ∂   x  3              H      subscript  x  3           L      subscript  x  3        \partial H/\partial x_{3}=-\partial L/\partial x_{3}   and from    H  =   -   p  3        H     subscript  p  3      H=-p_{3}    above        ∂  S    ∂   x  3     =   ∫      ∂  L    ∂   x  3      d   x  3     =   ∫      d   p  3     d   x  3      d   x  3     =   p  3             S      subscript  x  3             L      subscript  x  3     d   subscript  x  3                  d   subscript  p  3      d   subscript  x  3     d   subscript  x  3           subscript  p  3      \frac{\partial S}{\partial x_{3}}=\int\frac{\partial L}{\partial x_{3}}\,dx_{3%
 }=\int\frac{dp_{3}}{dx_{3}}\,dx_{3}=p_{3}     combining the equations for the components of momentum p results in      𝐩  =   ∇  S       𝐩   normal-∇  S     \mathbf{p}=\nabla S     Since p is a vector tangent to the light rays, surfaces S =Constant must be perpendicular to those light rays. These surfaces are called wavefronts . Figure "rays and wavefronts" illustrates this relationship. Also shown is optical momentum p , tangent to a light ray and perpendicular to the wavefront.  Vector field    𝐩  =   ∇  S       𝐩   normal-∇  S     \mathbf{p}=\nabla S   is conservative vector field . The gradient theorem can then be applied to the optical path length (as given above ) resulting in      S  =    ∫  𝐀  𝐁     𝐩  ⋅  d   𝐬    =    ∫  𝐀  𝐁    ∇    S  ⋅  d   𝐬     =    S   (  𝐁  )    -   S   (  𝐀  )           S    superscript   subscript   𝐀   𝐁      normal-⋅  𝐩  d   𝐬           superscript   subscript   𝐀   𝐁    normal-∇     normal-⋅  S  d   𝐬              S  𝐁     S  𝐀       S=\int_{\mathbf{A}}^{\mathbf{B}}\mathbf{p}\cdot d\mathbf{s}=\int_{\mathbf{A}}^%
 {\mathbf{B}}\nabla S\cdot d\mathbf{s}=S(\mathbf{B})-S(\mathbf{A})     and the optical path length S calculated along a curve C between points A and B is a function of only its end points A and B and not the shape of the curve between them. In particular, if the curve is closed, it starts and ends at the same point, or A = B so that      S  =   ∮   ∇    S  ⋅  d   𝐬     =  0        S   contour-integral   normal-∇     normal-⋅  S  d   𝐬          0     S=\oint\nabla S\cdot d\mathbf{s}=0     This result may be applied to a closed path ABCDA as in figure "optical path length"      S  =     ∫  𝐀  𝐁     𝐩  ⋅  d   𝐬    +    ∫  𝐁  𝐂     𝐩  ⋅  d   𝐬    +    ∫  𝐂  𝐃     𝐩  ⋅  d   𝐬    +    ∫  𝐃  𝐀     𝐩  ⋅  d   𝐬     =  0        S      superscript   subscript   𝐀   𝐁      normal-⋅  𝐩  d   𝐬      superscript   subscript   𝐁   𝐂      normal-⋅  𝐩  d   𝐬      superscript   subscript   𝐂   𝐃      normal-⋅  𝐩  d   𝐬      superscript   subscript   𝐃   𝐀      normal-⋅  𝐩  d   𝐬          0     S=\int_{\mathbf{A}}^{\mathbf{B}}\mathbf{p}\cdot d\mathbf{s}+\int_{\mathbf{B}}^%
 {\mathbf{C}}\mathbf{p}\cdot d\mathbf{s}+\int_{\mathbf{C}}^{\mathbf{D}}\mathbf{%
 p}\cdot d\mathbf{s}+\int_{\mathbf{D}}^{\mathbf{A}}\mathbf{p}\cdot d\mathbf{s}=0     (Figure)  Optical path length   for curve segment AB the optical momentum p is perpendicular to a displacement d s along curve AB , or      𝐩  ⋅  d   𝐬   =  0         normal-⋅  𝐩  d   𝐬   0    \mathbf{p}\cdot d\mathbf{s}=0   . The same is true for segment CD . For segment BC the optical momentum p has the same direction as displacement d s and      𝐩  ⋅  d   𝐬   =   n  d  s          normal-⋅  𝐩  d   𝐬     n  d  s     \mathbf{p}\cdot d\mathbf{s}=nds   . For segment DA the optical momentum p has the opposite direction to displacement d s and      𝐩  ⋅  d   𝐬   =   -    n   d  s           normal-⋅  𝐩  d   𝐬       n  d  s      \mathbf{p}\cdot d\mathbf{s}=-n\,ds   . However inverting the direction of the integration so that the integral is taken from A to D , d s inverts direction and      𝐩  ⋅  d   𝐬   =    n   d  s          normal-⋅  𝐩  d   𝐬     n  d  s     \mathbf{p}\cdot d\mathbf{s}=n\,ds   . From these considerations        ∫  𝐁  𝐂     n   d  s    =    ∫  𝐀  𝐃     n   d  s          superscript   subscript   𝐁   𝐂     n  d  s      superscript   subscript   𝐀   𝐃     n  d  s      \int_{\mathbf{B}}^{\mathbf{C}}n\,ds=\int_{\mathbf{A}}^{\mathbf{D}}n\,ds     or       S  𝐁𝐂   =   S  𝐀𝐃        subscript  S  𝐁𝐂    subscript  S  𝐀𝐃     S_{\mathbf{BC}}=S_{\mathbf{AD}}     and the optical path length S BC between points B and C along the ray connecting them is the same as the optical path length S AD between points A and D along the ray connecting them. The optical path length is constant between wavefronts.  Phase space  Figure "2D phase space" shows at the top some light rays in a two-dimensional space. Here x 2 =0 and p 2 =0 so light travels on the plane x 1 x 3 in directions of increasing x 3 values. In this case      p  1  2   +   p  3  2    =   n  2          superscript   subscript  p  1   2    superscript   subscript  p  3   2     superscript  n  2     p_{1}^{2}+p_{3}^{2}=n^{2}   and the direction of a light ray is completely specified by the p 1 component of momentum    𝐩  =   (   p  1   ,   p  3   )       𝐩    subscript  p  1    subscript  p  3      \mathbf{p}=(p_{1},p_{3})   since p 2 =0. If p 1 is given, p 3 may be calculated (given the value of the refractive index n ) and therefore p 1 suffices to determine the direction of the light ray. The refractive index of the medium the ray is traveling in is determined by     ∥  𝐩  ∥   =  n       norm  𝐩   n    \|\mathbf{p}\|=n   .  (Figure)  2D phase space   For example, ray r C crosses axis x 1 at coordinate x B with an optical momentum p C , which has its tip on a circle of radius n centered at position x B . Coordinate x B and the horizontal coordinate p 1 C of momentum p C completely define ray r C as it crosses axis x 1 . This ray may then be defined by a point r C =( x B , p 1 C ) in space x 1 p 1 as shown at the bottom of the figure. Space x 1 p 1 is called phase space and different light rays may be represented by different points in this space.  As such, ray r D shown at the top is represented by a point r D in phase space at the bottom. All rays crossing axis x 1 at coordinate x B contained between rays r C and r D are represented by a vertical line connecting points r C and r D in phase space. Accordingly, all rays crossing axis x 1 at coordinate x A contained between rays r A and r B are represented by a vertical line connecting points r A and r B in phase space. In general, all rays crossing axis x 1 between x L and x R are represented by a volume R in phase space. The rays at the boundary ∂ R of volume R are called edge rays. For example, at position x A of axis x 1 , rays r A and r B are the edge rays since all other rays are contained between these two.  In three-dimensional geometry the optical momentum is given by    𝐩  =   (   p  1   ,   p  2   ,   p  3   )       𝐩    subscript  p  1    subscript  p  2    subscript  p  3      \mathbf{p}=(p_{1},p_{2},p_{3})   with      p  1  2   +   p  2  2   +   p  3  2    =   n  2          superscript   subscript  p  1   2    superscript   subscript  p  2   2    superscript   subscript  p  3   2     superscript  n  2     p_{1}^{2}+p_{2}^{2}+p_{3}^{2}=n^{2}   . If p 1 and p 2 are given, p 3 may be calculated (given the value of the refractive index n ) and therefore p 1 and p 2 suffice to determine the direction of the light ray. A ray traveling along axis x 3 is then defined by a point ( x 1 , x 2 ) in plane x 1 x 2 and a direction ( p 1 , p 2 ). It may then be defined by a point in four-dimensional phase space  x 1 x 2 p 1 p 2 .  Conservation of etendue  Figure "volume variation" shows a volume V bound by an area A . Over time, if the boundary A moves, the volume of V may vary. In particular, an infinitesimal area dA with outward pointing unit normal n moves with a velocity v .  (Figure)  Volume variation   This leads to a volume variation     d  V   =   d  A   (   𝐯  ⋅  𝐧   )   d  t         d  V     d  A   normal-⋅  𝐯  𝐧   d  t     dV=dA(\mathbf{v}\cdot\mathbf{n})dt   . Making use of Gauss's theorem , the variation in time of the total volume V volume moving in space is        d  V    d  t    =    ∫  A     𝐯  ⋅   𝐧    d  A    =    ∫  V     ∇  ⋅   𝐯    d  V              d  V     d  t      subscript   A      normal-⋅  𝐯  𝐧   d  A           subscript   V      normal-⋅  normal-∇  𝐯   d  V       \frac{dV}{dt}=\int_{A}\mathbf{v}\cdot\mathbf{n}\,dA=\int_{V}\nabla\cdot\mathbf%
 {v}\,dV     The rightmost term is a volume integral over the volume V and the middle term is the surface integral over the boundary A of the volume V . Also, v is the velocity with which the points in V are moving.  In optics coordinate    x  3     subscript  x  3    x_{3}   takes the role of time. In phase space a light ray is identified by a point    (   x  1   ,   x  2   ,   p  1   ,   p  2   )      subscript  x  1    subscript  x  2    subscript  p  1    subscript  p  2     (x_{1},x_{2},p_{1},p_{2})   which moves with a " velocity "    𝐯  =   (    x  ˙   1   ,    x  ˙   2   ,    p  ˙   1   ,    p  ˙   2   )       𝐯    subscript   normal-˙  x   1    subscript   normal-˙  x   2    subscript   normal-˙  p   1    subscript   normal-˙  p   2      \mathbf{v}=(\dot{x}_{1},\dot{x}_{2},\dot{p}_{1},\dot{p}_{2})   where the dot represents a derivative relative to    x  3     subscript  x  3    x_{3}   . A set of light rays spreading over    d   x  1       d   subscript  x  1     dx_{1}   in coordinate    x  1     subscript  x  1    x_{1}   ,    d   x  2       d   subscript  x  2     dx_{2}   in coordinate    x  2     subscript  x  2    x_{2}   ,    d   p  1       d   subscript  p  1     dp_{1}   in coordinate    p  1     subscript  p  1    p_{1}   and    d   p  2       d   subscript  p  2     dp_{2}   in coordinate    p  2     subscript  p  2    p_{2}   occupies a volume     d  V   =   d   x  1   d   x  2   d   p  1   d   p  2          d  V     d   subscript  x  1   d   subscript  x  2   d   subscript  p  1   d   subscript  p  2      dV=dx_{1}dx_{2}dp_{1}dp_{2}   in phase space. In general, a large set of rays occupies a large volume   V   V   V   in phase space to which Gauss's theorem may be applied        d  V    d   x  3     =    ∫  V     ∇  ⋅   𝐯    d  V            d  V     d   subscript  x  3       subscript   V      normal-⋅  normal-∇  𝐯   d  V      \frac{dV}{dx_{3}}=\int_{V}\nabla\cdot\mathbf{v}\,dV     and using Hamilton's equations       ∇  ⋅  𝐯   =     ∂    x  ˙   1     ∂   x  1     +    ∂    x  ˙   2     ∂   x  2     +    ∂    p  ˙   1     ∂   p  1     +    ∂    p  ˙   2     ∂   p  2      =      ∂   ∂   x  1       ∂  H    ∂   p  1      +    ∂   ∂   x  2       ∂  H    ∂   p  2       -    ∂   ∂   p  1       ∂  H    ∂   x  1      -    ∂   ∂   p  2       ∂  H    ∂   x  2       =  0         normal-⋅  normal-∇  𝐯          subscript   normal-˙  x   1       subscript  x  1          subscript   normal-˙  x   2       subscript  x  2          subscript   normal-˙  p   1       subscript  p  1          subscript   normal-˙  p   2       subscript  p  2                       subscript  x  1         H      subscript  p  1              subscript  x  2         H      subscript  p  2               subscript  p  1         H      subscript  x  1              subscript  p  2         H      subscript  x  2            0     \nabla\cdot\mathbf{v}=\frac{\partial\dot{x}_{1}}{\partial x_{1}}+\frac{%
 \partial\dot{x}_{2}}{\partial x_{2}}+\frac{\partial\dot{p}_{1}}{\partial p_{1}%
 }+\frac{\partial\dot{p}_{2}}{\partial p_{2}}=\frac{\partial}{\partial x_{1}}%
 \frac{\partial H}{\partial p_{1}}+\frac{\partial}{\partial x_{2}}\frac{%
 \partial H}{\partial p_{2}}-\frac{\partial}{\partial p_{1}}\frac{\partial H}{%
 \partial x_{1}}-\frac{\partial}{\partial p_{2}}\frac{\partial H}{\partial x_{2%
 }}=0     or       d  V   /  d    x  3    =  0            d  V   d    subscript  x  3    0    dV/dx_{3}=0   and     d  V   =   d   x  1   d   x  2   d   p  1   d   p  2    =  Constant          d  V     d   subscript  x  1   d   subscript  x  2   d   subscript  p  1   d   subscript  p  2         Constant     dV=dx_{1}dx_{2}dp_{1}dp_{2}=\text{Constant}   which means that the phase space volume is conserved as light travels along an optical system.  The volume occupied by a set of rays in phase space is called etendue , which is conserved as light rays progress in the optical system along direction x 3 . This corresponds to Liouville's theorem , which also applies to Hamiltonian mechanics .  Imaging and nonimaging optics  Figure "conservation of etendue" shows on the left a diagrammatic two-dimensional optical system in which x 2 =0 and p 2 =0 so light travels on the plane x 1 x 3 in directions of increasing x 3 values.  (Figure)  Conservation of etendue   Light rays crossing the input aperture of the optic at point x 1 = x I are contained between edge rays r A and r B represented by a vertical line between points r A and r B at the phase space of the input aperture (right, bottom corner of the figure). All rays crossing the input aperture are represented in phase space by a region R I .  Also, light rays crossing the output aperture of the optic at point x 1 = x O are contained between edge rays r A and r B represented by a vertical line between points r A and r B at the phase space of the output aperture (right, top corner of the figure). All rays crossing the output aperture are represented in phase space by a region R O .  Conservation of etendue in the optical system means that the volume (or area in this two-dimensional case) in phase space occupied by R I at the input aperture must be the same as the volume in phase space occupied by R O at the output aperture.  In imaging optics, all light rays crossing the input aperture at x 1 = x I are redirected by it towards the output aperture at x 1 = x O where x I = m x O . This ensures that an image of the input of formed at the output with a magnification m . In phase space, this means that vertical lines in the phase space at the input are transformed into vertical lines at the output. That would be the case of vertical line r A  r B in R I transformed to vertical line r A  r B in R O .  In nonimaging optics , the goal is not to form an image but simply to transfer all light from the input aperture to the output aperture. This is accomplished by transforming the edge rays ∂ R I of R I to edge rays ∂ R O of R O . This is known as the edge ray principle .  Generalizations  Above it was assumed that light travels along the x 3 axis, in Hamilton's principle above, coordinates    x  1     subscript  x  1    x_{1}   and    x  2     subscript  x  2    x_{2}   take the role of the generalized coordinates    q  k     subscript  q  k    q_{k}   while    x  3     subscript  x  3    x_{3}   takes the role of parameter   σ   σ   \sigma   , that is, parameter σ = x 3 and N =2. However, different parametrizations of the light rays are possible, as well as the use of generalized coordinates .  General ray parametrization  A more general situation can be considered in which the path of a light ray is parametrized as    s  =   (    x  1    (  σ  )    ,    x  2    (  σ  )    ,    x  3    (  σ  )    )       s      subscript  x  1   σ      subscript  x  2   σ      subscript  x  3   σ      s=\left(x_{1}\left(\sigma\right),x_{2}\left(\sigma\right),x_{3}\left(\sigma%
 \right)\right)   in which σ is a general parameter. In this case, when compared to Hamilton's principle above, coordinates    x  1     subscript  x  1    x_{1}   ,    x  2     subscript  x  2    x_{2}   and    x  3     subscript  x  3    x_{3}   take the role of the generalized coordinates    q  k     subscript  q  k    q_{k}   with N =3. Applying Hamilton's principle to optics in this case leads to       δ  S   =   δ    ∫  𝐀  𝐁     n   d  s     =   δ    ∫   σ  A    σ  B     n     d  s    d  σ     d  σ             δ  S     δ    superscript   subscript   𝐀   𝐁     n  d  s            δ    superscript   subscript    subscript  σ  A     subscript  σ  B      n      d  s     d  σ    d  σ        \delta S=\delta\int_{\mathbf{A}}^{\mathbf{B}}n\,ds=\delta\int_{\sigma_{A}}^{%
 \sigma_{B}}n\frac{ds}{d\sigma}\,d\sigma          =   δ    ∫   σ  A    σ  B     L   (   x  1   ,   x  2   ,   x  3   ,    x  ˙   1   ,    x  ˙   2   ,    x  ˙   3   ,  σ  )   d  σ     =  0        absent    δ    superscript   subscript    subscript  σ  A     subscript  σ  B      L    subscript  x  1    subscript  x  2    subscript  x  3    subscript   normal-˙  x   1    subscript   normal-˙  x   2    subscript   normal-˙  x   3   σ   d  σ          0     =\delta\int_{\sigma_{A}}^{\sigma_{B}}L\left(x_{1},x_{2},x_{3},\dot{x}_{1},\dot%
 {x}_{2},\dot{x}_{3},\sigma\right)\,d\sigma=0     where now    L  =     n  d  s   /  d   σ       L        n  d  s   d   σ     L=nds/d\sigma   and      x  ˙   k   =     d   x  k    /  d   σ        subscript   normal-˙  x   k         d   subscript  x  k    d   σ     \dot{x}_{k}=dx_{k}/d\sigma   and for which the Euler-Lagrange equations applied to this form of Fermat's principle result in         ∂  L    ∂   x  k     -    d   d  σ      ∂  L    ∂    x  ˙   k       =  0            L      subscript  x  k         d    d  σ        L      subscript   normal-˙  x   k       0    \frac{\partial L}{\partial x_{k}}-\frac{d}{d\sigma}\frac{\partial L}{\partial%
 \dot{x}_{k}}=0     with k =1,2,3 and where L is the optical Lagrangian. Also in this case the optical momentum is defined as       p  k   =    ∂  L    ∂    x  ˙   k          subscript  p  k       L      subscript   normal-˙  x   k       p_{k}=\frac{\partial L}{\partial\dot{x}_{k}}     and the Hamiltonian P is defined by the expression given above for N =3 corresponding to functions     x  1    (  σ  )        subscript  x  1   σ    x_{1}\left(\sigma\right)   ,     x  2    (  σ  )        subscript  x  2   σ    x_{2}\left(\sigma\right)   and     x  3    (  σ  )        subscript  x  3   σ    x_{3}\left(\sigma\right)   to be determined      P  =       x  ˙   1    p  1    +     x  ˙   2    p  2    +     x  ˙   3    p  3     -  L       P         subscript   normal-˙  x   1    subscript  p  1       subscript   normal-˙  x   2    subscript  p  2       subscript   normal-˙  x   3    subscript  p  3     L     P=\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+\dot{x}_{3}p_{3}-L     And the corresponding Hamilton's equations with k =1,2,3 applied optics are         ∂  H    ∂   x  k     =   -     p  ˙   k      ,     ∂  H    ∂   p  k     =    x  ˙   k       formulae-sequence        H      subscript  x  k        subscript   normal-˙  p   k           H      subscript  p  k      subscript   normal-˙  x   k      \frac{\partial H}{\partial x_{k}}=-\dot{p}_{k}\,,\quad\frac{\partial H}{%
 \partial p_{k}}=\dot{x}_{k}     with      x  ˙   k   =     d   x  k    /  d   σ        subscript   normal-˙  x   k         d   subscript  x  k    d   σ     \dot{x}_{k}=dx_{k}/d\sigma   and      p  ˙   k   =     d   p  k    /  d   σ        subscript   normal-˙  p   k         d   subscript  p  k    d   σ     \dot{p}_{k}=dp_{k}/d\sigma   .  The optical Lagrangian is given by      L  =   n    d  s    d  σ     =   n   (   x  1   ,   x  2   ,   x  3   )       x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2      =   L   (   x  1   ,   x  2   ,   x  3   ,    x  ˙   1   ,    x  ˙   2   ,    x  ˙   3   )          L    n      d  s     d  σ            n    subscript  x  1    subscript  x  2    subscript  x  3         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2             L    subscript  x  1    subscript  x  2    subscript  x  3    subscript   normal-˙  x   1    subscript   normal-˙  x   2    subscript   normal-˙  x   3        L=n\frac{ds}{d\sigma}=n\left(x_{1},x_{2},x_{3}\right)\sqrt{\dot{x}_{1}^{2}+%
 \dot{x}_{2}^{2}+\dot{x}_{3}^{2}}=L\left(x_{1},x_{2},x_{3},\dot{x}_{1},\dot{x}_%
 {2},\dot{x}_{3}\right)     and does not explicitly depend on parameter σ . For that reason not all solutions of the Euler-Lagrange equations will be possible light rays, since their derivation assumed an explicit dependence of L on σ which does not happen in optics.  The optical momentum components can be obtained from       p  k   =   n     x  ˙   k       x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2       =   n    d   x  k       d   x  1  2    +   d   x  2  2    +   d   x  3  2        =   n    d   x  k     d  s            subscript  p  k     n     subscript   normal-˙  x   k        superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2              n      d   subscript  x  k          d   superscript   subscript  x  1   2      d   superscript   subscript  x  2   2      d   superscript   subscript  x  3   2               n      d   subscript  x  k      d  s        p_{k}=n\frac{\dot{x}_{k}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2%
 }}}=n\frac{dx_{k}}{\sqrt{dx_{1}^{2}+dx_{2}^{2}+dx_{3}^{2}}}=n\frac{dx_{k}}{ds}     where      x  ˙   k   =     d   x  k    /  d   σ        subscript   normal-˙  x   k         d   subscript  x  k    d   σ     \dot{x}_{k}=dx_{k}/d\sigma   . The expression for the Lagrangian can be rewritten as      L  =   n      x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2      =      x  ˙   1     n    x  ˙   1        x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2       +     x  ˙   2     n    x  ˙   2        x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2       +     x  ˙   3     n    x  ˙   3        x  ˙   1  2   +    x  ˙   2  2   +    x  ˙   3  2              L    n       superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2                subscript   normal-˙  x   1       n   subscript   normal-˙  x   1         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2          subscript   normal-˙  x   2       n   subscript   normal-˙  x   2         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2          subscript   normal-˙  x   3       n   subscript   normal-˙  x   3         superscript   subscript   normal-˙  x   1   2    superscript   subscript   normal-˙  x   2   2    superscript   subscript   normal-˙  x   3   2           L=n\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}=\dot{x}_{1}\frac{n%
 \dot{x}_{1}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+\dot{x}_{%
 2}\frac{n\dot{x}_{2}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{3}^{2}}}+%
 \dot{x}_{3}\frac{n\dot{x}_{3}}{\sqrt{\dot{x}_{1}^{2}+\dot{x}_{2}^{2}+\dot{x}_{%
 3}^{2}}}          =      x  ˙   1    p  1    +     x  ˙   2    p  2    +     x  ˙   3    p  3         absent       subscript   normal-˙  x   1    subscript  p  1       subscript   normal-˙  x   2    subscript  p  2       subscript   normal-˙  x   3    subscript  p  3       =\dot{x}_{1}p_{1}+\dot{x}_{2}p_{2}+\dot{x}_{3}p_{3}     Comparing this expression for L with that for the Hamiltonian P it can be concluded that      P  =  0      P  0    P=0     From the expressions for the components    p  k     subscript  p  k    p_{k}   of the optical momentum results         p  1  2   +   p  2  2   +   p  3  2    -    n  2    (   x  1   ,   x  2   ,   x  3   )     =  0           superscript   subscript  p  1   2    superscript   subscript  p  2   2    superscript   subscript  p  3   2       superscript  n  2     subscript  x  1    subscript  x  2    subscript  x  3      0    p_{1}^{2}+p_{2}^{2}+p_{3}^{2}-n^{2}\left(x_{1},x_{2},x_{3}\right)=0     The optical Hamiltonian is chosen as      P  =     p  1  2   +   p  2  2   +   p  3  2    -    n  2    (   x  1   ,   x  2   ,   x  3   )     =  0        P       superscript   subscript  p  1   2    superscript   subscript  p  2   2    superscript   subscript  p  3   2       superscript  n  2     subscript  x  1    subscript  x  2    subscript  x  3           0     P=p_{1}^{2}+p_{2}^{2}+p_{3}^{2}-n^{2}\left(x_{1},x_{2},x_{3}\right)=0     although other choices could be made. 9 10 The Hamilton's equations with k =1,2,3 defined above together with    P  =  0      P  0    P=0   define the possible light rays.  Generalized coordinates  As in Hamiltonian mechanics , it is also possible to write the equations of Hamiltonian optics in terms of generalized coordinates     (    q  1    (  σ  )    ,    q  2    (  σ  )    ,    q  3    (  σ  )    )        subscript  q  1   σ      subscript  q  2   σ      subscript  q  3   σ     \left(q_{1}\left(\sigma\right),q_{2}\left(\sigma\right),q_{3}\left(\sigma%
 \right)\right)   , generalized momenta    (    u  1    (  σ  )    ,    u  2    (  σ  )    ,    u  3    (  σ  )    )        subscript  u  1   σ      subscript  u  2   σ      subscript  u  3   σ     \left(u_{1}\left(\sigma\right),u_{2}\left(\sigma\right),u_{3}\left(\sigma%
 \right)\right)   and Hamiltonian P as 11 12         d   q  1     d  σ    =    ∂  P    ∂   u  1         d   u  1     d  σ    =   -    ∂  P    ∂   q  1          formulae-sequence        d   subscript  q  1      d  σ        P      subscript  u  1            d   subscript  u  1      d  σ          P      subscript  q  1         \frac{dq_{1}}{d\sigma}=\frac{\partial P}{\partial u_{1}}\quad\quad\frac{du_{1}%
 }{d\sigma}=-\frac{\partial P}{\partial q_{1}}            d   q  2     d  σ    =    ∂  P    ∂   u  2         d   u  2     d  σ    =   -    ∂  P    ∂   q  2          formulae-sequence        d   subscript  q  2      d  σ        P      subscript  u  2            d   subscript  u  2      d  σ          P      subscript  q  2         \frac{dq_{2}}{d\sigma}=\frac{\partial P}{\partial u_{2}}\quad\quad\frac{du_{2}%
 }{d\sigma}=-\frac{\partial P}{\partial q_{2}}            d   q  3     d  σ    =    ∂  P    ∂   u  3         d   u  3     d  σ    =   -    ∂  P    ∂   q  3          formulae-sequence        d   subscript  q  3      d  σ        P      subscript  u  3            d   subscript  u  3      d  σ          P      subscript  q  3         \frac{dq_{3}}{d\sigma}=\frac{\partial P}{\partial u_{3}}\quad\quad\frac{du_{3}%
 }{d\sigma}=-\frac{\partial P}{\partial q_{3}}         P  =    𝐩  ⋅  𝐩   -   n  2    =  0        P     normal-⋅  𝐩  𝐩    superscript  n  2         0     P=\mathbf{p}\cdot\mathbf{p}-n^{2}=0     where the optical momentum is given by      𝐩  =     u  1    ∇   q  1     +    u  2    ∇   q  2     +    u  3    ∇   q  3          𝐩       subscript  u  1    normal-∇   subscript  q  1        subscript  u  2    normal-∇   subscript  q  2        subscript  u  3    normal-∇   subscript  q  3        \mathbf{p}=u_{1}\nabla q_{1}+u_{2}\nabla q_{2}+u_{3}\nabla q_{3}          =    u  1    ∥    ∇    q  1    ∥     ∇   q  1     ∥   ∇   q  1    ∥    +   u  2    ∥      ∇    q  2    ∥     ∇   q  2     ∥   ∇   q  2    ∥    +   u  3    ∥      ∇   q  3     ∥     ∇   q  3     ∥   ∇   q  3    ∥         absent     subscript  u  1    norm     normal-∇     subscript  q  1    norm       normal-∇   subscript  q  1     norm   normal-∇   subscript  q  1       subscript  u  2        normal-∇     subscript  q  2    norm       normal-∇   subscript  q  2     norm   normal-∇   subscript  q  2       subscript  u  3        normal-∇   subscript  q  3         normal-∇   subscript  q  3     norm   normal-∇   subscript  q  3         =u_{1}\|\nabla q_{1}\|\frac{\nabla q_{1}}{\|\nabla q_{1}\|}+u_{2}\|\nabla q_{2%
 }\|\frac{\nabla q_{2}}{\|\nabla q_{2}\|}+u_{3}\|\nabla q_{3}\|\frac{\nabla q_{%
 3}}{\|\nabla q_{3}\|}          =     u  1    a  1     𝐞  ^   1    +    u  2    a  2     𝐞  ^   2    +    u  3    a  3     𝐞  ^   3         absent       subscript  u  1    subscript  a  1    subscript   normal-^  𝐞   1       subscript  u  2    subscript  a  2    subscript   normal-^  𝐞   2       subscript  u  3    subscript  a  3    subscript   normal-^  𝐞   3       =u_{1}a_{1}\mathbf{\hat{e}}_{1}+u_{2}a_{2}\mathbf{\hat{e}}_{2}+u_{3}a_{3}%
 \mathbf{\hat{e}}_{3}     and     𝐞  ^   1     subscript   normal-^  𝐞   1    \mathbf{\hat{e}}_{1}   ,     𝐞  ^   2     subscript   normal-^  𝐞   2    \mathbf{\hat{e}}_{2}   and     𝐞  ^   3     subscript   normal-^  𝐞   3    \mathbf{\hat{e}}_{3}   are unit vectors . A particular case is obtained when these vectors form an orthonormal basis , that is, they are all perpendicular to each other. In that case,      u  k    a  k    /  n         subscript  u  k    subscript  a  k    n    u_{k}a_{k}/n   is the cosine of the angle the optical momentum   𝐩   𝐩   \mathbf{p}   makes to unit vector     𝐞  ^   k     subscript   normal-^  𝐞   k    \mathbf{\hat{e}}_{k}   .  See also   Hamiltonian mechanics  Calculus of variations   References  "  Category:Optics     Vasudevan Lakshminarayanan et al., Lagrangian Optics , Springer Netherlands, 2011 [ISBN 978-0792375821] ↩  H. A. Buchdahl, An Introduction to Hamiltonian Optics , Dover Publications, 1993 [ISBN 978-0486675978] ↩  Julio Chaves, Introduction to Nonimaging Optics , CRC Press, 2008 [ISBN 978-1420054293] ↩  Roland Winston et al., Nonimaging Optics , Academic Press, 2004 [ISBN 978-0127597515] ↩   Dietrich Marcuse, Light Transmission Optics , Van Nostrand Reinhold Company, New York, 1972 [ISBN 978-0894643057] ↩  Rudolf Karl Luneburg, Mathematical Theory of Optics , University of California Press, Berkeley, CA, 1964, p. 90. ↩          
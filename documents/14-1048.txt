


Hamiltonian optics




Hamiltonian optics

Lagrangian optics1 and Hamiltonian optics2 are two formulations of geometrical optics which share much of the mathematical formalism with Lagrangian mechanics and Hamiltonian mechanics.
Hamilton's principle
In physics, Hamilton's principle states that the evolution of a system 
 
 
 
  described by 
 
 
generalized coordinates between two specified states at two specified parameters σA and σB is a stationary point (a point where the variation is zero), of the action functional, or



where 
 
 
 
 . Condition 
 
 
 
  is valid if and only if the Euler-Lagrange equations are satisfied



with 
 
 
 
 .
The momentum is defined as



and the Euler-Lagrange equations can then be rewritten as



where 
 
 
 
 .
A different approach to solving this problem consists in defining a Hamiltonian (taking a Legendre transform of the Lagrangian) as



for which a new set of differential equations can be derived by looking at how the total differential of the Lagrangian depends on parameter σ, positions 
 
 
 
  and their derivatives 
 
 
 
  relative to σ. This derivation is the same as in Hamiltonian mechanics, only with time t now replaced by a general parameter σ. Those differential equations are the Hamilton's equations



with 
 
 
 
 . Hamilton's equations are first-order differential equations, while Euler-Lagrange's equations are second-order.
Lagrangian and Hamiltonian optics
The general results presented above for Hamilton's principle can be applied to optics.34 In 3D euclidean space the generalized coordinates are now the coordinates of euclidean space.
Fermat's principle
Fermat's principle states that the optical length of the path followed by light between two fixed points, A and B, is a stationary point. It may be a maximum, a minimum, constant or an inflection point. In general, as light travels, it moves in a medium of variable refractive index which is a scalar field of position in space, that is, 
 
 
 
  in 3D euclidean space. Assuming now that light travels along the x3 axis, the path of a light ray may be parametrized as 
 
 
 
  starting at a point 
 
 
 
  and ending at a point 
 
 
 
 . In this case, when compared to Hamilton's principle above, coordinates 
 
 
 
  and 
 
 
 
  take the role of the generalized coordinates 
 
 
 
  while 
 
 
 
  takes the role of parameter 
 
 
 
 , that is, parameter σ =x3 and N=2.
In the context of calculus of variations this can be written as5



where ds is an infinitesimal displacement along the ray given by 
 
 
 
  and



is the optical Lagrangian and 
 
 
 
 .
The optical path length (OPL) is defined as



where n is the local refractive index as a function of position along the path between points A and B.
The Euler-Lagrange equations
The general results presented above for Hamilton's principle can be applied to optics using the Lagrangian defined in Fermat's principle. The Euler-Lagrange equations with parameter σ =x3 and N=2 applied to Fermat's principle result in



with k=1,2 and where L is the optical Lagrangian and 
 
 
 
 
 .
Optical momentum
The optical momentum is defined as



and from the definition of the optical Lagrangian 
 
 
 
  this expression can be rewritten as



(Figure)
Optical momentum

or in vector form






where 
 
 
 
  is a unit vector and angles α1, α2 and α3 are the angles p makes to axis x1, x2 and x3 respectively, as shown in figure "optical momentum". Therefore the optical momentum is a vector of norm



where n is the refractive index at which p is calculated. Vector p points in the direction of propagation of light. If light is propagating in a gradient index optic the path of the light ray is curved and vector p is tangent to the light ray.
The expression for the optical path length can also be written as a function of the optical momentum. Having in consideration that 
 
 
 
  the expression for the optical Lagrangian can be rewritten as






and the expression for the optical path length is



Hamilton's equations
Similarly to what happens in Hamiltonian mechanics, also in optics the Hamiltonian is defined by the expression given above for N=2 corresponding to functions 
 
 
 
  and 
 
 
 
  to be determined



Comparing this expression with 
 
 
 
  for the Lagrangian results in



And the corresponding Hamilton's equations with parameter σ =x3 and k=1,2 applied to optics are67



with 
 
 
 
  and 
 
 
 
 .
Applications
It is assumed that light travels along the x3 axis, in Hamilton's principle above, coordinates 
 
 
 
  and 
 
 
 
  take the role of the generalized coordinates 
 
 
 
  while 
 
 
 
  takes the role of parameter 
 
 
 
 , that is, parameter σ =x3 and N=2.
Refraction and reflection
If plane x1x2 separates two media of refractive index nA below and nB above it, the refractive index is given by a step function



and from Hamilton's equations



and therefore 
 
 
 
  or 
 
 
 
  for k=1,2.
An incoming light ray has momentum pA before refraction (below plane x1x2) and momentum pB after refraction (above plane x1x2). The light ray makes an angle θA with axis x3 (the normal to the refractive surface) before refraction and an angle θB with axis x3 after refraction. Since the p1 and p2 components of the momentum are constant, only p3 changes from p3A to p3B.
(Figure)
Refraction

Figure "refraction" shows the geometry of this refraction from which 
 
 
 
 . Since 
 
 
 
  and 
 
 
 
 , this last expression can be written as



which is Snell's law of refraction.
In figure "refraction", the normal to the refractive surface points in the direction of axis x3, and also of vector 
 
 
 
 . A unit normal 
 
 
 
  to the refractive surface can then be obtained from the momenta of the incoming and outgoing rays by



where i and r are a unit vectors in the directions of the incident and refracted rays. Also, the outgoing ray (in the direction of 
 
 
 
 ) is contained in the plane defined by the incoming ray (in the direction of 
 
 
 
 ) and the normal 
 
 
 
  to the surface.
A similar argument can be used for reflection in deriving the law of specular reflection, only now with nA=nB, resulting in θA=θB. Also, if i and r are unit vectors in the directions of the incident and refracted ray respectively, the corresponding normal to the surface is given by the same expression as for refraction, only with nA=nB



In vector form, if i is a unit vector pointing in the direction of the incident ray and n is the unit normal to the surface, the direction r of the refracted ray is given by:8



with



If i·n\Delta , light suffers total internal reflection and the expression for the reflected ray is that of reflection:



Rays and wavefronts
From the definition of optical path length 
 
 




(Figure)
Rays and wavefronts

with k=1,2 where the Euler-Lagrange equations

 
  with k=1,2 were used. Also, from the last of Hamilton's equations

 
  and from 
 
 
above



combining the equations for the components of momentum p results in



Since p is a vector tangent to the light rays, surfaces S=Constant must be perpendicular to those light rays. These surfaces are called wavefronts. Figure "rays and wavefronts" illustrates this relationship. Also shown is optical momentum p, tangent to a light ray and perpendicular to the wavefront.
Vector field 
 
 
 
  is conservative vector field. The gradient theorem can then be applied to the optical path length (as given above) resulting in



and the optical path length S calculated along a curve C between points A and B is a function of only its end points A and B and not the shape of the curve between them. In particular, if the curve is closed, it starts and ends at the same point, or A=B so that



This result may be applied to a closed path ABCDA as in figure "optical path length"



(Figure)
Optical path length

for curve segment AB the optical momentum p is perpendicular to a displacement ds along curve AB, or 
 
 
 
 . The same is true for segment CD. For segment BC the optical momentum p has the same direction as displacement ds and 
 
 
 
 . For segment DA the optical momentum p has the opposite direction to displacement ds and 
 
 
 
 . However inverting the direction of the integration so that the integral is taken from A to D, ds inverts direction and 
 
 
 
 . From these considerations



or



and the optical path length SBC between points B and C along the ray connecting them is the same as the optical path length SAD between points A and D along the ray connecting them. The optical path length is constant between wavefronts.
Phase space
Figure "2D phase space" shows at the top some light rays in a two-dimensional space. Here x2=0 and p2=0 so light travels on the plane x1x3 in directions of increasing x3 values. In this case 
 
 
 
  and the direction of a light ray is completely specified by the p1 component of momentum 
 
 
 
  since p2=0. If p1 is given, p3 may be calculated (given the value of the refractive index n) and therefore p1 suffices to determine the direction of the light ray. The refractive index of the medium the ray is traveling in is determined by 
 
 
 
 .
(Figure)
2D phase space

For example, ray rC crosses axis x1 at coordinate xB with an optical momentum pC, which has its tip on a circle of radius n centered at position xB. Coordinate xB and the horizontal coordinate p1C of momentum pC completely define ray rC as it crosses axis x1. This ray may then be defined by a point rC=(xB,p1C) in space x1p1 as shown at the bottom of the figure. Space x1p1 is called phase space and different light rays may be represented by different points in this space.
As such, ray rD shown at the top is represented by a point rD in phase space at the bottom. All rays crossing axis x1 at coordinate xB contained between rays rC and rD are represented by a vertical line connecting points rC and rD in phase space. Accordingly, all rays crossing axis x1 at coordinate xA contained between rays rA and rB are represented by a vertical line connecting points rA and rB in phase space. In general, all rays crossing axis x1 between xL and xR are represented by a volume R in phase space. The rays at the boundary ∂R of volume R are called edge rays. For example, at position xA of axis x1, rays rA and rB are the edge rays since all other rays are contained between these two.
In three-dimensional geometry the optical momentum is given by 
 
 
 
 
  with 
 
 
 
 . If p1 and p2 are given, p3 may be calculated (given the value of the refractive index n) and therefore p1 and p2 suffice to determine the direction of the light ray. A ray traveling along axis x3 is then defined by a point (x1,x2) in plane x1x2 and a direction (p1,p2). It may then be defined by a point in four-dimensional phase space x1x2p1p2.
Conservation of etendue
Figure "volume variation" shows a volume V bound by an area A. Over time, if the boundary A moves, the volume of V may vary. In particular, an infinitesimal area dA with outward pointing unit normal n moves with a velocity v.
(Figure)
Volume variation

This leads to a volume variation 
 
 
 
 . Making use of Gauss's theorem, the variation in time of the total volume V volume moving in space is



The rightmost term is a volume integral over the volume V and the middle term is the surface integral over the boundary A of the volume V. Also, v is the velocity with which the points in V are moving.
In optics coordinate 
 
 
 
  takes the role of time. In phase space a light ray is identified by a point 
 
 
 
 
  which moves with a "velocity" 
 
 
 
  where the dot represents a derivative relative to 
 
 
 
 . A set of light rays spreading over 
 
 
 
  in coordinate 
 
 
 
 , 
 
 
 
 
  in coordinate 
 
 
 
 , 
 
 
 
  in coordinate 
 
 
 
  and 
 
 
 
  in coordinate 
 
 
 
 
  occupies a volume 
 
 
 
  in phase space. In general, a large set of rays occupies a large volume 
 
 
 
  in phase space to which Gauss's theorem may be applied



and using Hamilton's equations



or 
 
 
 
  and 
 
 
 
  which means that the phase space volume is conserved as light travels along an optical system.
The volume occupied by a set of rays in phase space is called etendue, which is conserved as light rays progress in the optical system along direction x3. This corresponds to Liouville's theorem, which also applies to Hamiltonian mechanics. 
Imaging and nonimaging optics
Figure "conservation of etendue" shows on the left a diagrammatic two-dimensional optical system in which x2=0 and p2=0 so light travels on the plane x1x3 in directions of increasing x3 values.
(Figure)
Conservation of etendue

Light rays crossing the input aperture of the optic at point x1=xI are contained between edge rays rA and rB represented by a vertical line between points rA and rB at the phase space of the input aperture (right, bottom corner of the figure). All rays crossing the input aperture are represented in phase space by a region RI.
Also, light rays crossing the output aperture of the optic at point x1=xO are contained between edge rays rA and rB represented by a vertical line between points rA and rB at the phase space of the output aperture (right, top corner of the figure). All rays crossing the output aperture are represented in phase space by a region RO.
Conservation of etendue in the optical system means that the volume (or area in this two-dimensional case) in phase space occupied by RI at the input aperture must be the same as the volume in phase space occupied by RO at the output aperture.
In imaging optics, all light rays crossing the input aperture at x1=xI are redirected by it towards the output aperture at x1=xO where xI=m xO. This ensures that an image of the input of formed at the output with a magnification m. In phase space, this means that vertical lines in the phase space at the input are transformed into vertical lines at the output. That would be the case of vertical line rA rB in RI transformed to vertical line rA rB in RO.
In nonimaging optics, the goal is not to form an image but simply to transfer all light from the input aperture to the output aperture. This is accomplished by transforming the edge rays ∂RI of RI to edge rays ∂RO of RO. This is known as the edge ray principle.
Generalizations
Above it was assumed that light travels along the x3 axis, in Hamilton's principle above, coordinates 
 
 
 
  and 
 
 
 
  take the role of the generalized coordinates 
 
 
 
  while 
 
 
 
  takes the role of parameter 
 
 
 
 , that is, parameter σ =x3 and N=2. However, different parametrizations of the light rays are possible, as well as the use of generalized coordinates.
General ray parametrization
A more general situation can be considered in which the path of a light ray is parametrized as 
 
 
 
  in which σ is a general parameter. In this case, when compared to Hamilton's principle above, coordinates 
 
 
 
 , 
 
 
 
  and 
 
 
 
  take the role of the generalized coordinates 
 
 
 
  with N=3. Applying Hamilton's principle to optics in this case leads to






where now 
 
 
 
  and 
 
 
 
  and for which the Euler-Lagrange equations applied to this form of Fermat's principle result in



with k=1,2,3 and where L is the optical Lagrangian. Also in this case the optical momentum is defined as



and the Hamiltonian P is defined by the expression given above for N=3 corresponding to functions 
 
 
 
 
 , 
 
 
 
  and 
 
 
 
  to be determined



And the corresponding Hamilton's equations with k=1,2,3 applied optics are



with 
 
 
 
 
  and 
 
 
 
 .
The optical Lagrangian is given by



and does not explicitly depend on parameter σ. For that reason not all solutions of the Euler-Lagrange equations will be possible light rays, since their derivation assumed an explicit dependence of L on σ which does not happen in optics.
The optical momentum components can be obtained from



where 
 
 
 
 . The expression for the Lagrangian can be rewritten as






Comparing this expression for L with that for the Hamiltonian P it can be concluded that



From the expressions for the components 
 
 
 
  of the optical momentum results



The optical Hamiltonian is chosen as



although other choices could be made.910 The Hamilton's equations with k=1,2,3 defined above together with 
 
 
 
  define the possible light rays.
Generalized coordinates
As in Hamiltonian mechanics, it is also possible to write the equations of Hamiltonian optics in terms of generalized coordinates

 
 , generalized momenta 
 
 
 
  and Hamiltonian P as1112












where the optical momentum is given by









and 
 
 
 
 , 
 
 
 
  and 
 
 
 
  are unit vectors. A particular case is obtained when these vectors form an orthonormal basis, that is, they are all perpendicular to each other. In that case, 
 
 
 
  is the cosine of the angle the optical momentum 
 
 
 
  makes to unit vector 
 
 
 
 .
See also

Hamiltonian mechanics
Calculus of variations

References
"
Category:Optics



Vasudevan Lakshminarayanan et al., Lagrangian Optics, Springer Netherlands, 2011 [ISBN 978-0792375821]
H. A. Buchdahl, An Introduction to Hamiltonian Optics, Dover Publications, 1993 [ISBN 978-0486675978]
Julio Chaves, Introduction to Nonimaging Optics, CRC Press, 2008 [ISBN 978-1420054293]
Roland Winston et al., Nonimaging Optics, Academic Press, 2004 [ISBN 978-0127597515]

Dietrich Marcuse, Light Transmission Optics, Van Nostrand Reinhold Company, New York, 1972 [ISBN 978-0894643057]
Rudolf Karl Luneburg,Mathematical Theory of Optics, University of California Press, Berkeley, CA, 1964, p. 90.










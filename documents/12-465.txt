   Multiple-try Metropolis      Multiple-try Metropolis   Multiple-try Metropolis is a sampling method that is a modified form of the Metropolis-Hastings method, first presented by Liu, Liang, and Wong in 2000. It is designed to help the sampling trajectory converge faster, by increasing both the step size and the acceptance rate.  Background  Problems with Metropolis-Hastings  In Markov chain Monte Carlo , the Metropolisâ€“Hastings algorithm (MH) can be used to sample from a probability distribution which is difficult to sample from directly. However, the MH algorithm requires the user to supply a proposal distribution, which can be relatively arbitrary. In many cases, one uses a Gaussian distribution centered on the current point in the probability space, of the form     Q   (   x  â€²   ;   x  t   )    =   ğ’©   (   x  t   ;    Ïƒ  2   I   )          Q    superscript  x  normal-â€²    superscript  x  t       ğ’©    superscript  x  t      superscript  Ïƒ  2   I       Q(x^{\prime};x^{t})=\mathcal{N}(x^{t};\sigma^{2}I)\,   . This proposal distribution is convenient to sample from and may be the best choice if one has little knowledge about the target distribution,    Ï€   (  x  )       Ï€  x    \pi(x)\,   . If desired, one can use the more general multivariate normal distribution ,     Q   (   x  â€²   ;   x  t   )    =   ğ’©   (   x  t   ;  ğšº  )          Q    superscript  x  normal-â€²    superscript  x  t       ğ’©    superscript  x  t   ğšº      Q(x^{\prime};x^{t})=\mathcal{N}(x^{t};\mathbf{\Sigma})   , where   ğšº   ğšº   \mathbf{\Sigma}   is the covariance matrix which the user believes is similar to the target distribution.  Although this method must converge to the stationary distribution in the limit of infinite sample size, in practice the progress can be exceedingly slow. If     Ïƒ  2      superscript  Ïƒ  2    \sigma^{2}\,   is too large, almost all steps under the MH algorithm will be rejected. On the other hand, if     Ïƒ  2      superscript  Ïƒ  2    \sigma^{2}\,   is too small, almost all steps will be accepted, and the Markov chain will be similar to a random walk through the probability space. In the simpler case of     Q   (   x  â€²   ;   x  t   )    =   ğ’©   (   x  t   ;  I  )          Q    superscript  x  normal-â€²    superscript  x  t       ğ’©    superscript  x  t   I      Q(x^{\prime};x^{t})=\mathcal{N}(x^{t};I)\,   , we see that    N    N   N\,   steps only takes us a distance of     N       N    \sqrt{N}\,   . In this event, the Markov Chain will not fully explore the probability space in any reasonable amount of time. Thus the MH algorithm requires reasonable tuning of the scale parameter (     Ïƒ  2      superscript  Ïƒ  2    \sigma^{2}\,   or   ğšº   ğšº   \mathbf{\Sigma}   ).  Problems with high dimensionality  Even if the scale parameter is well-tuned, as the dimensionality of the problem increases, progress can still remain exceedingly slow. To see this, again consider     Q   (   x  â€²   ;   x  t   )    =   ğ’©   (   x  t   ;  I  )          Q    superscript  x  normal-â€²    superscript  x  t       ğ’©    superscript  x  t   I      Q(x^{\prime};x^{t})=\mathcal{N}(x^{t};I)\,   . In one dimension, this corresponds to a Gaussian distribution with mean 0 and variance 1. For one dimension, this distribution has a mean step of zero, however the mean squared step size is given by       âŸ¨   x  2   âŸ©   =    âˆ«   -  âˆ   âˆ     x  2    1    2  Ï€      e   -    x  2   2       =  1         delimited-âŸ¨âŸ©   superscript  x  2      superscript   subscript             superscript  x  2     1      2  Ï€      superscript  e       superscript  x  2   2            1     \langle x^{2}\rangle=\int_{-\infty}^{\infty}x^{2}\frac{1}{\sqrt{2\pi}}e^{-%
 \frac{x^{2}}{2}}=1     As the number of dimensions increases, the expected step size becomes larger and larger. In    N    N   N\,   dimensions, the probability of moving a radial distance     P  n    (  r  )        subscript  P  n   r    P_{n}(r)\,   is related to the Chi distribution , and is given by        P  n    (  r  )    âˆ    r   n  -  1     e   -    r  2   /  2         proportional-to     subscript  P  n   r      superscript  r    n  1     superscript  e       superscript  r  2   2        P_{n}(r)\propto r^{n-1}e^{-r^{2}/2}     This distribution is peaked at    r  =     N  -  1         r      N  1      r=\sqrt{N-1}\,   which is     â‰ˆ    N        absent    N     \approx\sqrt{N}\,   for large    N    N   N\,   . This means that the step size will increase as the roughly the square root of the number of dimensions. For the MH algorithm, large steps will almost always land in regions of low probability, and therefore be rejected.  If we now add the scale parameter     Ïƒ  2      superscript  Ïƒ  2    \sigma^{2}\,   back in, we find that to retain a reasonable acceptance rate, we must make the transformation     Ïƒ  2   â†’    Ïƒ  2   /  N      normal-â†’   superscript  Ïƒ  2      superscript  Ïƒ  2   N     \sigma^{2}\rightarrow\sigma^{2}/N   . In this situation, the acceptance rate can now be made reasonable, but the exploration of the probability space becomes increasingly slow. To see this, consider a slice along any one dimension of the problem. By making the scale transformation above, the expected step size is any one dimension is not    Ïƒ    Ïƒ   \sigma\,   but instead is    Ïƒ  /   N       Ïƒ    N     \sigma/\sqrt{N}   . As this step size is much smaller than the "true" scale of the probability distribution (assuming that    Ïƒ    Ïƒ   \sigma\,   is somehow known a priori, which is the best possible case), the algorithm executes a random walk along every parameter.  The Multiple-try Metropolis algorithm  Suppose    Q   (  ğ±  ,  ğ²  )       Q   ğ±  ğ²     Q(\mathbf{x},\mathbf{y})   is an arbitrary proposal function . We require that     Q   (  ğ±  ,  ğ²  )    >  0        Q   ğ±  ğ²    0    Q(\mathbf{x},\mathbf{y})>0   only if     Q   (  ğ²  ,  ğ±  )    >  0        Q   ğ²  ğ±    0    Q(\mathbf{y},\mathbf{x})>0   . Additionally,    Ï€   (  ğ±  )       Ï€  ğ±    \pi(\mathbf{x})   is the likelihood function.  Define     w   (  ğ±  ,  ğ²  )    =   Ï€   (  ğ±  )   Q   (  ğ±  ,  ğ²  )   Î»   (  ğ±  ,  ğ²  )          w   ğ±  ğ²      Ï€  ğ±  Q   ğ±  ğ²   Î»   ğ±  ğ²      w(\mathbf{x},\mathbf{y})=\pi(\mathbf{x})Q(\mathbf{x},\mathbf{y})\lambda(%
 \mathbf{x},\mathbf{y})   where    Î»   (  ğ±  ,  ğ²  )       Î»   ğ±  ğ²     \lambda(\mathbf{x},\mathbf{y})   is a non-negative symmetric function in   ğ±   ğ±   \mathbf{x}   and   ğ²   ğ²   \mathbf{y}   that can be chosen by the user.  Now suppose the current state is   ğ±   ğ±   \mathbf{x}   . The MTM algorithm is as follows:  1) Draw k independent trial proposals     ğ²  1   ,  â€¦  ,   ğ²  k       subscript  ğ²  1   normal-â€¦   subscript  ğ²  k     \mathbf{y}_{1},\ldots,\mathbf{y}_{k}   from    Q   (  ğ±  ,  .  )      fragments  Q   fragments  normal-(  x  normal-,  normal-.  normal-)     Q(\mathbf{x},.)   . Compute the weights    w   (   ğ²  j   ,  ğ±  )       w    subscript  ğ²  j   ğ±     w(\mathbf{y}_{j},\mathbf{x})   for each of these.  2) Select   ğ²   ğ²   \mathbf{y}   from the    ğ²  i     subscript  ğ²  i    \mathbf{y}_{i}   with probability proportional to the weights.  3) Now produce a reference set by drawing     ğ±  1   ,  â€¦  ,   ğ±   k  -  1        subscript  ğ±  1   normal-â€¦   subscript  ğ±    k  1      \mathbf{x}_{1},\ldots,\mathbf{x}_{k-1}   from the distribution    Q   (  ğ²  ,  .  )      fragments  Q   fragments  normal-(  y  normal-,  normal-.  normal-)     Q(\mathbf{y},.)   . Set     ğ±  k   =  ğ±       subscript  ğ±  k   ğ±    \mathbf{x}_{k}=\mathbf{x}   (the current point).  4) Accept   ğ²   ğ²   \mathbf{y}   with probability      r  =   min   (  1  ,     w   (   ğ²  1   ,  ğ±  )    +  â€¦  +   w   (   ğ²  k   ,  ğ±  )       w   (   ğ±  1   ,  ğ²  )    +  â€¦  +   w   (   ğ±  k   ,  ğ²  )      )        r    min   1        w    subscript  ğ²  1   ğ±    normal-â€¦    w    subscript  ğ²  k   ğ±         w    subscript  ğ±  1   ğ²    normal-â€¦    w    subscript  ğ±  k   ğ²          r=\text{min}\left(1,\frac{w(\mathbf{y}_{1},\mathbf{x})+\ldots+w(\mathbf{y}_{k}%
 ,\mathbf{x})}{w(\mathbf{x}_{1},\mathbf{y})+\ldots+w(\mathbf{x}_{k},\mathbf{y})%
 }\right)     It can be shown that this method satisfies the detailed balance property and therefore produces a reversible Markov chain with    Ï€   (  ğ±  )       Ï€  ğ±    \pi(\mathbf{x})   as the stationary distribution.  If    Q   (  ğ±  ,  ğ²  )       Q   ğ±  ğ²     Q(\mathbf{x},\mathbf{y})   is symmetric (as is the case for the multivariate normal distribution ), then one can choose     Î»   (  ğ±  ,  ğ²  )    =   1   Q   (  ğ±  ,  ğ²  )           Î»   ğ±  ğ²      1    Q   ğ±  ğ²       \lambda(\mathbf{x},\mathbf{y})=\frac{1}{Q(\mathbf{x},\mathbf{y})}   which gives     w   (  ğ±  ,  ğ²  )    =   Ï€   (  ğ±  )          w   ğ±  ğ²      Ï€  ğ±     w(\mathbf{x},\mathbf{y})=\pi(\mathbf{x})     Disadvantages  Multiple-try Metropolis needs to compute the energy of     2  k   -  1        2  k   1    2k-1   other states at every step. If the slow part of the process is calculating the energy, then this method can be slower. If the slow part of the process is finding neighbors of a given point, or generating random numbers, then again this method can be slower. It can be argued that this method only appears faster because it puts much more computation into a "single step" than Metropolis-Hastings does.  See also   Markov chain Monte Carlo  Metropolisâ€“Hastings algorithm  Detailed balance   References   Liu, J. S., Liang, F. and Wong, W. H. (2000). The multiple-try method and local optimization in Metropolis sampling, Journal of the American Statistical Association , 95 (449): 121-134 JSTOR   "  Category:Monte Carlo methods  Category:Markov chain Monte Carlo   
   Truncated normal distribution      Truncated normal distribution   In probability and statistics, the truncated normal distribution is the probability distribution of a normally distributed random variable whose value is either bounded below or above (or both). The truncated normal distribution has wide applications in statistics and econometrics . For example, it is used to model the probabilities of the binary outcomes in the probit model and to model censored data in the Tobit model .  Definition  Suppose    X  ∼   N   (  μ  ,   σ  2   )       similar-to  X    N   μ   superscript  σ  2       X\sim N(\mu,\sigma^{2})\!   has a normal distribution and lies within the interval     X  ∈   (  a  ,  b  )    ,    -  ∞   ≤  a  <  b  ≤  ∞      formulae-sequence    X   a  b            a       b            X\in(a,b),\;-\infty\leq a   . Then   X   X   X   conditional on    a  <  X  <  b        a  X       b     a   has a truncated normal distribution.  Its probability density function , ƒ, for    a  ≤  x  ≤  b        a  x       b     a\leq x\leq b   , is given by       f   (  x  ;  μ  ,  σ  ,  a  ,  b  )    =     1  σ   ϕ   (    x  -  μ   σ   )      Φ   (    b  -  μ   σ   )    -   Φ   (    a  -  μ   σ   )            f   x  μ  σ  a  b          1  σ   ϕ      x  μ   σ        normal-Φ      b  μ   σ      normal-Φ      a  μ   σ        f(x;\mu,\sigma,a,b)=\frac{\frac{1}{\sigma}\phi(\frac{x-\mu}{\sigma})}{\Phi(%
 \frac{b-\mu}{\sigma})-\Phi(\frac{a-\mu}{\sigma})}     and by ƒ=0 otherwise.  Here,     ϕ   (  ξ  )    =     1    2  π       exp   (   -     1  2     ξ  2     )           ϕ  ξ       1      2  π             1  2    superscript  ξ  2         \scriptstyle{\phi(\xi)=\frac{1}{\sqrt{2\pi}}\exp{(-\frac{1}{2}\xi^{2}})}   is the probability density function of the standard normal distribution and    Φ   (  ⋅  )       normal-Φ  normal-⋅    \scriptstyle{\Phi(\cdot)}   is its cumulative distribution function . There is an understanding that if    b  =  ∞      b     \scriptstyle{b=\infty}   , then     Φ   (     b  -  μ   σ    )    =  1        normal-Φ      b  μ   σ    1    \scriptstyle{\Phi(\frac{b-\mu}{\sigma})=1}   , and similarly, if    a  =   -  ∞       a        \scriptstyle{a=-\infty}   , then     Φ   (     a  -  μ   σ    )    =  0        normal-Φ      a  μ   σ    0    \scriptstyle{\Phi(\frac{a-\mu}{\sigma})=0}   .  Moments  Two sided truncation: 1        Var   (   X   ∣  X  >   a   )    =    σ  2    [   1  -   δ   (  α  )     ]     ,       Var    X   ket  X   a       superscript  σ  2    delimited-[]    1    δ  α        \operatorname{Var}(X\mid X>a)=\sigma^{2}[1-\delta(\alpha)],\!          α  =    (   a  -  μ   )   /  σ    ,    λ   (  α  )    =    ϕ   (  α  )    /   [   1  -   Φ   (  α  )     ]        formulae-sequence    α      a  μ   σ        λ  α       ϕ  α    delimited-[]    1    normal-Φ  α         \alpha=(a-\mu)/\sigma,\;\lambda(\alpha)=\phi(\alpha)/[1-\Phi(\alpha)]\;   where      δ    (  α  )    =   λ   (  α  )    [    λ   (  α  )    -  α   ]          δ  α     λ  α   delimited-[]      λ  α   α       \;\delta(\alpha)=\lambda(\alpha)[\lambda(\alpha)-\alpha]   and    {       σ  2    f  ′    (  x  )    +   f   (  x  )    (   x  -  μ   )     =  0   ,    f   (  0  )    =      2  π     e   -    μ  2    2   σ  2         σ   (    erf   (    μ  -  a     2   σ    )    -   erf   (    μ  -  b     2   σ    )     )       }      formulae-sequence         superscript  σ  2    superscript  f  normal-′   x     f  x    x  μ     0       f  0           2  π     superscript  e       superscript  μ  2     2   superscript  σ  2          σ      erf      μ  a       2   σ       erf      μ  b       2   σ            \left\{\sigma^{2}f^{\prime}(x)+f(x)(x-\mu)=0,f(0)=\frac{\sqrt{\frac{2}{\pi}}e^%
 {-\frac{\mu^{2}}{2\sigma^{2}}}}{\sigma\left(\text{erf}\left(\frac{\mu-a}{\sqrt%
 {2}\sigma}\right)-\text{erf}\left(\frac{\mu-b}{\sqrt{2}\sigma}\right)\right)}\right\}   .  One sided truncation (lower tail):      x  =     Φ   -  1     (    Φ   (  α  )    +   U  ⋅   (    Φ   (  β  )    -   Φ   (  α  )     )     )   σ   +  μ       x       superscript  normal-Φ    1        normal-Φ  α    normal-⋅  U      normal-Φ  β     normal-Φ  α      σ   μ     x=\Phi^{-1}(\Phi(\alpha)+U\cdot(\Phi(\beta)-\Phi(\alpha)))\sigma+\mu     Barr and Sherrill (1999) give a simpler expression for the variance of one sided truncations. Their formula is in terms of the chi-square CDF, which is implemented in standard software libraries. Bebu and Mathew (2009) provide formulas for (generalized) confidence intervals around the truncated moments.   Differential equation      Φ   normal-Φ   \Phi      A recursive formula   As for the non-truncated case, there is a neat recursive formula for the truncated moments. See. 2  Simulating  A random variate x defined as    Φ   -  1      superscript  normal-Φ    1     \Phi^{-1}   with   U   U   U   the cumulative distribution function and    (  0  ,  1  )     0  1    (0,1)   its inverse,    (  a  ,  b  )     a  b    (a,b)   a uniform random number on   Φ   normal-Φ   \Phi   , follows the distribution truncated to the range    Φ   -  1      superscript  normal-Φ    1     \Phi^{-1}   . This method is theoretically the best, however the simulation of random variables from $\Phi$ and $\Phi^{-1}$ may imply numerical errors; thus practically one has to find other implementations.  For more on simulating a draw from the truncated normal distribution, see Robert (1995), Lynch (2007) Section 8.1.3 (pages 200–206), Devroye (1986). The MSM package in R has a function, rtnorm , that calculates draws from a truncated normal. The truncnorm package in R also has functions to draw from a truncated normal.  Chopin proposed an algorithm inspired from the Ziggurat algorithm of Marsaglia and Tsang (1984, 2000), which is usually considered as the fastest Gaussian sampler, and is also very close to Ahrens’s algorithm (1995). Implementations can be found in C , C++ , Matlab and Python .  Sampling from the multivariate truncated normal distribution is considerably more difficult. Damien and Walker (2001) introduce a general methodology for sampling truncated densities within a Gibbs sampling framework. Their algorithm introduces one latent variable and is more computationally efficient than the algorithm of Robert (1995).  See also   Normal distribution  Truncated distribution   References      Norman L. Johnson and Samuel Kotz (1970). Continuous univariate distributions-1 , chapter 13. John Wiley & Sons.       Nicolas Chopin, "Fast simulation of truncated Gaussian distributions". Statistics and Computing  21 (2): 275-288.   fr:Loi tronquée#Loi normale tronquée "  Category:Continuous distributions  Category:Normal distribution  Category:Probability distributions     Johnson, N.L., Kotz, S., Balakrishnan, N. (1994) Continuous Univariate Distributions, Volume 1 , Wiley. ISBN 0-471-58495-9 (Section 10.1) ↩  Document by Eric Orjebin, " http://www.smp.uq.edu.au/people/YoniNazarathy/teaching_projects/studentWork/EricOrjebin_TruncatedNormalMoments.pdf " ↩     
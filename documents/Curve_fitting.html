<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1624">Curve fitting</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Curve fitting</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Fitting of a noisy curve by an asymmetrical peak model, with an iterative process (<a href="Gauss–Newton_algorithm" title="wikilink">Gauss–Newton algorithm</a> with variable damping factor α).<br/>
 Top: raw data and model.<br/>
 Bottom: evolution of the normalised sum of the squares of the errors.</figcaption>
</figure>

<p><strong>Curve fitting</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> is the process of constructing a <a class="uri" href="curve" title="wikilink">curve</a>, or <a href="function_(mathematics)" title="wikilink">mathematical function</a>, that has the best fit to a series of <a class="uri" href="data" title="wikilink">data</a> points,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> possibly subject to constraints.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Curve fitting can involve either <a class="uri" href="interpolation" title="wikilink">interpolation</a>,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> where an exact fit to the data is required, or <a class="uri" href="smoothing" title="wikilink">smoothing</a>,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> in which a "smooth" function is constructed that approximately fits the data. A related topic is <a href="regression_analysis" title="wikilink">regression analysis</a>,<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> which focuses more on questions of <a href="statistical_inference" title="wikilink">statistical inference</a> such as how much uncertainty is present in a curve that is fit to data observed with random errors. Fitted curves can be used as an aid for data visualization,<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> to infer values of a function where no data are available,<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> and to summarize the relationships among two or more variables.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> <a class="uri" href="Extrapolation" title="wikilink">Extrapolation</a> refers to the use of a fitted curve beyond the <a href="range_(mathematics)" title="wikilink">range</a> of the observed data,<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> and is subject to a <a href="Uncertainty" title="wikilink">degree of uncertainty</a><a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> since it may reflect the method used to construct the curve as much as it reflects the observed data.</p>
<h2 id="different-types-of-curve-fitting">Different types of curve fitting</h2>
<h3 id="fitting-lines-and-polynomial-curves-to-data-points">Fitting lines and polynomial curves to data points</h3>

<p> Starting with a first degree <a class="uri" href="polynomial" title="wikilink">polynomial</a> equation:</p>

<p>

<math display="block" id="Curve_fitting:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mpadded width="+2.8pt">
      <mi>b</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <ci>x</ci>
     </apply>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=ax+b\;.
  </annotation>
 </semantics>
</math>

</p>

<p>This is a line with <a class="uri" href="slope" title="wikilink">slope</a> <em>a</em>. A line will connect any two points, so a first degree polynomial equation is an exact fit through any two points with distinct x coordinates.</p>

<p>If the order of the equation is increased to a second degree polynomial, the following results:</p>

<p>

<math display="block" id="Curve_fitting:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mpadded width="+2.8pt">
      <mi>c</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>x</ci>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=ax^{2}+bx+c\;.
  </annotation>
 </semantics>
</math>

</p>

<p>This will exactly fit a simple curve to three points.</p>

<p>If the order of the equation is increased to a third degree polynomial, the following is obtained:</p>

<p>

<math display="block" id="Curve_fitting:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <msup>
       <mi>x</mi>
       <mn>3</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>b</mi>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>c</mi>
      <mi>x</mi>
     </mrow>
     <mo>+</mo>
     <mpadded width="+2.8pt">
      <mi>d</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>x</ci>
     </apply>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=ax^{3}+bx^{2}+cx+d\;.
  </annotation>
 </semantics>
</math>

</p>

<p>This will exactly fit four points.</p>

<p>A more general statement would be to say it will exactly fit four <strong>constraints</strong>. Each constraint can be a point, <a class="uri" href="angle" title="wikilink">angle</a>, or <a class="uri" href="curvature" title="wikilink">curvature</a> (which is the reciprocal of the radius of an <a href="osculating_circle" title="wikilink">osculating circle</a>). Angle and curvature constraints are most often added to the ends of a curve, and in such cases are called <strong>end conditions</strong>. Identical end conditions are frequently used to ensure a smooth transition between polynomial curves contained within a single <a href="spline_(mathematics)" title="wikilink">spline</a>. Higher-order constraints, such as "the change in the rate of curvature", could also be added. This, for example, would be useful in highway <a href="Cloverleaf_interchange" title="wikilink">cloverleaf</a> design to understand the rate of change of the forces applied to a car (see <a href="Jerk_(physics)" title="wikilink">jerk</a>), as it follows the cloverleaf, and to set reasonable speed limits, accordingly.</p>

<p>The first degree polynomial equation could also be an exact fit for a single point and an angle while the third degree polynomial equation could also be an exact fit for two points, an angle constraint, and a curvature constraint. Many other combinations of constraints are possible for these and for higher order polynomial equations.</p>

<p>If there are more than <em>n</em> + 1 constraints (<em>n</em> being the degree of the polynomial), the polynomial curve can still be run through those constraints. An exact fit to all constraints is not certain (but might happen, for example, in the case of a first degree polynomial exactly fitting three <a href="collinear_points" title="wikilink">collinear points</a>). In general, however, some method is then needed to evaluate each approximation. The <a href="least_squares" title="wikilink">least squares</a> method is one way to compare the deviations.</p>

<p>There are several reasons given to get an approximate fit when it is possible to simply increase the degree of the polynomial equation and get an exact match.:</p>
<ul>
<li>Even if an exact match exists, it does not necessarily follow that it can be readily discovered. Depending on the algorithm used there may be a divergent case, where the exact fit cannot be calculated, or it might take too much computer time to find the solution. This situation might require an approximate solution.</li>
</ul>
<ul>
<li>The effect of averaging out questionable data points in a sample, rather than distorting the curve to fit them exactly, may be desirable.</li>
</ul>
<ul>
<li><a href="Runge's_phenomenon" title="wikilink">Runge's phenomenon</a>: high order polynomials can be highly oscillatory. If a curve runs through two points <em>A</em> and <em>B</em>, it would be expected that the curve would run somewhat near the midpoint of <em>A</em> and <em>B</em>, as well. This may not happen with high-order polynomial curves; they may even have values that are very large in positive or negative <a href="magnitude_(mathematics)" title="wikilink">magnitude</a>. With low-order polynomials, the curve is more likely to fall near the midpoint (it's even guaranteed to exactly run through the midpoint on a first degree polynomial).</li>
</ul>
<ul>
<li>Low-order polynomials tend to be smooth and high order polynomial curves tend to be "lumpy". To define this more precisely, the maximum number of <a href="inflection_point" title="wikilink">inflection points</a> possible in a polynomial curve is <em>n-2</em>, where <em>n</em> is the order of the polynomial equation. An inflection point is a location on the curve where it switches from a positive radius to negative. We can also say this is where it transitions from "holding water" to "shedding water". Note that it is only "possible" that high order polynomials will be lumpy; they could also be smooth, but there is no guarantee of this, unlike with low order polynomial curves. A fifteenth degree polynomial could have, at most, thirteen inflection points, but could also have twelve, eleven, or any number down to zero.</li>
</ul>

<p>The degree of the polynomial curve being higher than needed for an exact fit is undesirable for all the reasons listed previously for high order polynomials, but also leads to a case where there are an infinite number of solutions. For example, a first degree polynomial (a line) constrained by only a single point, instead of the usual two, would give an infinite number of solutions. This brings up the problem of how to compare and choose just one solution, which can be a problem for software and for humans, as well. For this reason, it is usually best to choose as low a degree as possible for an exact match on all constraints, and perhaps an even lower degree, if an approximate fit is acceptable.</p>
<h3 id="fitting-other-curves-to-data-points">Fitting other curves to data points</h3>

<p>Other types of curves, such as <a href="conic_sections" title="wikilink">conic sections</a> (circular, elliptical, parabolic, and hyperbolic arcs) or <a href="trigonometric_functions" title="wikilink">trigonometric functions</a> (such as sine and cosine), may also be used, in certain cases. For example, trajectories of objects under the influence of gravity follow a parabolic path, when air resistance is ignored. Hence, matching trajectory data points to a parabolic curve would make sense. Tides follow sinusoidal patterns, hence tidal data points should be matched to a sine wave, or the sum of two sine waves of different periods, if the effects of the Moon and Sun are both considered.</p>

<p>In spectroscopy, curves may be fitted with <a href="Normal_distribution" title="wikilink">Gaussian</a>, <a href="Cauchy_distribution" title="wikilink">Lorentzian</a>, <a href="Voigt_function" title="wikilink">Voigt</a> and related functions.</p>
<h3 id="algebraic-fit-versus-geometric-fit-for-curves">Algebraic fit versus geometric fit for curves</h3>

<p>For algebraic analysis of data, "fitting" usually means trying to find the curve that minimizes the vertical (<em>y</em>-axis) displacement of a point from the curve (e.g., <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a>). However for graphical and image applications geometric fitting seeks to provide the best visual fit; which usually means trying to minimize the orthogonal distance to the curve (e.g., <a href="total_least_squares" title="wikilink">total least squares</a>), or to otherwise include both axes of displacement of a point from the curve. Geometric fits are not popular because they usually require non-linear and/or iterative calculations, although they have the advantage of a more aesthetic and geometrically accurate result.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a><a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p>
<h3 id="fitting-a-circle-by-geometric-fit">Fitting a circle by geometric fit</h3>
<figure><b>(Figure)</b>
<figcaption>Circle fitting with the Coope method, the points describing a circle arc, centre (1 ; 1), radius 4.</figcaption>
</figure>
<figure><b>(Figure)</b>
<figcaption>different models of ellipse fitting</figcaption>
</figure>
<figure><b>(Figure)</b>
<figcaption>Ellipse fitting minimising the algebraic distance (Fitzgibbon method).</figcaption>
</figure>

<p>Coope<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> approaches the problem of trying to find the best visual fit of circle to a set of 2D data points. The method elegantly transforms the ordinarily non-linear problem into a linear problem that can be solved without using iterative numerical methods, and is hence an order of magnitude faster than previous techniques.</p>
<h3 id="fitting-an-ellipse-by-geometric-fit">Fitting an ellipse by geometric fit</h3>

<p>The above technique is extended to general ellipses<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> by adding a non-linear step, resulting in a method that is fast, yet finds visually pleasing ellipses of arbitrary orientation and displacement.</p>
<h3 id="application-to-surfaces">Application to surfaces</h3>

<p>Note that while this discussion was in terms of 2D curves, much of this logic also extends to 3D surfaces, each patch of which is defined by a net of curves in two parametric directions, typically called <strong>u</strong> and <strong>v</strong>. A surface may be composed of one or more surface patches in each direction.</p>
<h2 id="software">Software</h2>

<p>Many <a href="List_of_statistical_packages" title="wikilink">statistical packages</a> such as <a href="R_(programming_language)" title="wikilink">R</a> and <a href="List_of_numerical_analysis_software" title="wikilink">numerical software</a> such as the <a href="GNU_Scientific_Library" title="wikilink">GNU Scientific Library</a>, <a class="uri" href="DataMelt" title="wikilink">DataMelt</a> <a href="Maple_(software)" title="wikilink">Maple</a>, <a class="uri" href="MATLAB" title="wikilink">MATLAB</a>, <a class="uri" href="SciPy" title="wikilink">SciPy</a> and <a class="uri" href="OpenOpt" title="wikilink">OpenOpt</a> include commands for doing curve fitting in a variety of scenarios. There are also programs specifically written to do curve fitting; they can be found in the <a href="List_of_statistical_packages" title="wikilink">lists of statistical</a> and <a href="List_of_numerical_analysis_software" title="wikilink">numerical analysis programs</a> as well as in <a href=":Category:Regression_and_curve_fitting_software" title="wikilink">:Category:Regression and curve fitting software</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Adjustment_of_observations" title="wikilink">Adjustment of observations</a></li>
<li><a href="Levenberg–Marquardt_algorithm" title="wikilink">Levenberg–Marquardt algorithm</a></li>
<li><a href="Nonlinear_regression" title="wikilink">Nonlinear regression</a></li>
<li><a href="Distribution_fitting" title="wikilink">Probability distribution fitting</a></li>
<li><a class="uri" href="Smoothing" title="wikilink">Smoothing</a></li>
<li><a href="Total_least_squares" title="wikilink">Total least squares</a></li>
<li><a class="uri" href="Overfitting" title="wikilink">Overfitting</a></li>
<li><a href="Curve-fitting_compaction" title="wikilink">Curve-fitting compaction</a></li>
<li><a href="Function_approximation" title="wikilink">Function approximation</a></li>
<li><a href="Estimation_theory" title="wikilink">Estimation theory</a></li>
<li><a href="Time_series" title="wikilink">Time series</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Numerical_analysis" title="wikilink">Category:Numerical analysis</a> <a class="uri" href="Category:Interpolation" title="wikilink">Category:Interpolation</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Sandra Lach Arlinghaus, PHB Practical Handbook of Curve Fitting. CRC Press, 1994.<a href="#fnref1">↩</a></li>
<li id="fn2">William M. Kolb. Curve Fitting for Programmable Calculators. Syntec, Incorporated, 1984.<a href="#fnref2">↩</a></li>
<li id="fn3">S.S. Halli, K.V. Rao. 1992. Advanced Techniques of Population Analysis. isbn 0306439972 Page 165 (<em>cf</em>. ... functions are fulfilled if we have a good to moderate fit for the observed data.)<a href="#fnref3">↩</a></li>
<li id="fn4">[<a class="uri" href="http://books.google.com/books?id=SI-VqAT4_hYC">http://books.google.com/books?id=SI-VqAT4_hYC</a> <em><a href="The_Signal_and_the_Noise" title="wikilink">The Signal and the Noise</a>]: Why So Many Predictions Fail-but Some Don't.</em> By Nate Silver<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="http://books.google.com/books?id=hhdVr9F-JfAC">Data Preparation for Data Mining</a>: Text. By Dorian Pyle.<a href="#fnref5">↩</a></li>
<li id="fn6">Numerical Methods in Engineering with MATLAB®. By <a href="Jaan_Kiusalaas" title="wikilink">Jaan Kiusalaas</a>. Page 24.<a href="#fnref6">↩</a></li>
<li id="fn7">Numerical Methods in Engineering with Python 3. By Jaan Kiusalaas. Page 21.<a href="#fnref7">↩</a></li>
<li id="fn8">Numerical Methods of Curve Fitting. By P. G. Guest, Philip George Guest. Page 349.<a href="#fnref8">↩</a></li>
<li id="fn9">See also: <a class="uri" href="Mollifier" title="wikilink">Mollifier</a><a href="#fnref9">↩</a></li>
<li id="fn10">Fitting Models to Biological Data Using Linear and Nonlinear Regression. By Harvey Motulsky, Arthur Christopoulos.<a href="#fnref10">↩</a></li>
<li id="fn11">Regression Analysis By Rudolf J. Freund, William J. Wilson, Ping Sa. Page 269.<a href="#fnref11">↩</a></li>
<li id="fn12">Visual Informatics. Edited by Halimah Badioze Zaman, Peter Robinson, Maria Petrou, Patrick Olivier, Heiko Schröder. Page 689.<a href="#fnref12">↩</a></li>
<li id="fn13">Numerical Methods for Nonlinear Engineering Models. By John R. Hauser. Page 227.<a href="#fnref13">↩</a></li>
<li id="fn14">Methods of Experimental Physics: Spectroscopy, Volume 13, Part 1. By Claire Marton. Page 150.<a href="#fnref14">↩</a></li>
<li id="fn15">Encyclopedia of Research Design, Volume 1. Edited by Neil J. Salkind. Page 266.<a href="#fnref15">↩</a></li>
<li id="fn16">Community Analysis and Planning Techniques. By Richard E. Klosterman. Page 1.<a href="#fnref16">↩</a></li>
<li id="fn17">An Introduction to Risk and Uncertainty in the Evaluation of Environmental Investments. DIANE Publishing. [<a class="uri" href="http://books.google.com/books?id=rJ23LWaZAqsC&amp;pg">http://books.google.com/books?id=rJ23LWaZAqsC&amp;pg;</a>;=PA69 Pg 69]<a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22">Paul Sheer, A software assistant for manual stereo photometrology, M.Sc. thesis, 1997<a href="#fnref22">↩</a></li>
</ol>
</section>
</body>
</html>

   Trilinear interpolation      Trilinear interpolation   Trilinear interpolation is a method of multivariate interpolation on a 3-dimensional  regular grid . It approximates the value of an intermediate point    (  x  ,  y  ,  z  )     x  y  z    (x,y,z)   within the local axial rectangular prism linearly, using data on the lattice points. For an arbitrary, unstructured mesh (as used in finite element analysis), other methods of interpolation must be used; if all the mesh elements are tetrahedra (3D simplices ), then barycentric coordinates provide a straightforward procedure.  Trilinear interpolation is frequently used in numerical analysis , data analysis , and computer graphics .  Compared to linear and bilinear interpolation  Trilinear interpolation is the extension of linear interpolation , which operates in spaces with dimension     D  =  1      D  1    D=1   , and bilinear interpolation , which operates with dimension    D  =  2      D  2    D=2   , to dimension    D  =  3      D  3    D=3   . The order of accuracy is 1 for all these interpolation schemes, and it requires      (   1  +  n   )   D   =  8       superscript    1  n   D   8    (1+n)^{D}=8   adjacent pre-defined values surrounding the interpolation point. There are several ways to arrive at trilinear interpolation, it is equivalent to 3-dimensional tensor  B-spline interpolation of order 1, and the trilinear interpolation operator is also a tensor product of 3 linear interpolation operators.  Method    On a periodic and cubic lattice, let    x  d     subscript  x  d    x_{d}   ,    y  d     subscript  y  d    y_{d}   , and    z  d     subscript  z  d    z_{d}   be the differences between each of   x   x   x   ,   y   y   y   ,   z   z   z   and the smaller coordinate related, that is:        x   d   =    (   x  -   x  0    )   /   (    x  1   -   x  0    )         subscript  x  d       x   subscript  x  0       subscript  x  1    subscript  x  0       \ x_{d}=(x-x_{0})/(x_{1}-x_{0})           y   d   =    (   y  -   y  0    )   /   (    y  1   -   y  0    )         subscript  y  d       y   subscript  y  0       subscript  y  1    subscript  y  0       \ y_{d}=(y-y_{0})/(y_{1}-y_{0})           z   d   =    (   z  -   z  0    )   /   (    z  1   -   z  0    )         subscript  z  d       z   subscript  z  0       subscript  z  1    subscript  z  0       \ z_{d}=(z-z_{0})/(z_{1}-z_{0})     where    x  0     subscript  x  0    x_{0}   indicates the lattice point below   x   x   x   , and    x  1     subscript  x  1    x_{1}   indicates the lattice point above   x   x   x   and similarly for     y  0   ,   y  1   ,   z  0       subscript  y  0    subscript  y  1    subscript  z  0     y_{0},y_{1},z_{0}   and    z  1     subscript  z  1    z_{1}   .  First we interpolate along   x   x   x   (imagine we are pushing the front face of the cube to the back), giving:        c   00   =    V   [   x  0   ,   y  0   ,   z  0   ]    (   1  -   x  d    )    +   V   [   x  1   ,   y  0   ,   z  0   ]    x  d          subscript  c  00       V    subscript  x  0    subscript  y  0    subscript  z  0      1   subscript  x  d       V    subscript  x  1    subscript  y  0    subscript  z  0     subscript  x  d       \ c_{00}=V[x_{0},y_{0},z_{0}](1-x_{d})+V[x_{1},y_{0},z_{0}]x_{d}           c   10   =    V   [   x  0   ,   y  1   ,   z  0   ]    (   1  -   x  d    )    +   V   [   x  1   ,   y  1   ,   z  0   ]    x  d          subscript  c  10       V    subscript  x  0    subscript  y  1    subscript  z  0      1   subscript  x  d       V    subscript  x  1    subscript  y  1    subscript  z  0     subscript  x  d       \ c_{10}=V[x_{0},y_{1},z_{0}](1-x_{d})+V[x_{1},y_{1},z_{0}]x_{d}           c   01   =    V   [   x  0   ,   y  0   ,   z  1   ]    (   1  -   x  d    )    +   V   [   x  1   ,   y  0   ,   z  1   ]    x  d          subscript  c  01       V    subscript  x  0    subscript  y  0    subscript  z  1      1   subscript  x  d       V    subscript  x  1    subscript  y  0    subscript  z  1     subscript  x  d       \ c_{01}=V[x_{0},y_{0},z_{1}](1-x_{d})+V[x_{1},y_{0},z_{1}]x_{d}           c   11   =    V   [   x  0   ,   y  1   ,   z  1   ]    (   1  -   x  d    )    +   V   [   x  1   ,   y  1   ,   z  1   ]    x  d          subscript  c  11       V    subscript  x  0    subscript  y  1    subscript  z  1      1   subscript  x  d       V    subscript  x  1    subscript  y  1    subscript  z  1     subscript  x  d       \ c_{11}=V[x_{0},y_{1},z_{1}](1-x_{d})+V[x_{1},y_{1},z_{1}]x_{d}     Where    V   [   x  0   ,   y  0   ,   z  0   ]       V    subscript  x  0    subscript  y  0    subscript  z  0      V[x_{0},y_{0},z_{0}]   means the function value of     (   x  0   ,   y  0   ,   z  0   )   .      subscript  x  0    subscript  y  0    subscript  z  0     (x_{0},y_{0},z_{0}).   Then we interpolate these values (along   y   y   y   , as we were pushing the top edge to the bottom), giving:        c   0   =     c  00    (   1  -   y  d    )    +    c  10    y  d          subscript  c  0        subscript  c  00     1   subscript  y  d        subscript  c  10    subscript  y  d       \ c_{0}=c_{00}(1-y_{d})+c_{10}y_{d}           c   1   =     c  01    (   1  -   y  d    )    +    c  11    y  d          subscript  c  1        subscript  c  01     1   subscript  y  d        subscript  c  11    subscript  y  d       \ c_{1}=c_{01}(1-y_{d})+c_{11}y_{d}     Finally we interpolate these values along   z   z   z   (walking through a line):        c   =     c  0    (   1  -   z  d    )    +    c  1    z  d      .      c       subscript  c  0     1   subscript  z  d        subscript  c  1    subscript  z  d       \ c=c_{0}(1-z_{d})+c_{1}z_{d}.     This gives us a predicted value for the point.  The result of trilinear interpolation is independent of the order of the interpolation steps along the three axes: any other order, for instance along   x   x   x   , then along   y   y   y   , and finally along   z   z   z   , produces the same value.  The above operations can be visualized as follows: First we find the eight corners of a cube that surround our point of interest. These corners have the values C000, C100, C010, C110, C001, C101, C011, C111.  Next, we perform linear interpolation between C000 and C100 to find C00, C001 and C101 to find C01, C011 and C111 to find C11, C010 and C110 to find C10.  Now we do interpolation between C00 and C10 to find C0, C01 and C11 to find C1. Finally, we calculate the value C via linear interpolation of C0 and C1  In practice, a trilinear interpolation is identical to three successive linear interpolations , or a bilinear interpolation combined with a linear interpolation:      C  â‰ˆ   l   (   b   (   C  000   ,   C  010   ,   C  100   ,   C  110   )    ,   b   (   C  001   ,   C  011   ,   C  101   ,   C  111   )    )        C    l     b    subscript  C  000    subscript  C  010    subscript  C  100    subscript  C  110       b    subscript  C  001    subscript  C  011    subscript  C  101    subscript  C  111         C\approx\ l(b(C_{000},C_{010},C_{100},C_{110}),b(C_{001},C_{011},C_{101},C_{11%
 1}))     See also   Linear interpolation  Bilinear interpolation  Tricubic interpolation  Radial interpolation  Tetrahedral interpolation   External links   pseudo-code from NASA , describes an iterative inverse trilinear interpolation (given the vertices and the value of C find Xd, Yd and Zd).  Paul Bourke, Interpolation methods , 1999. Contains a very clever and simple method to find trilinear interpolation that is based on binary logic and can be extended to any dimension (Tetralinear, Pentalinear, ...).   "  Category:Multivariate interpolation   
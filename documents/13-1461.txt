   Barnsley fern      Barnsley fern   The Barnsley Fern is a fractal named after the British mathematician  Michael Barnsley who first described it in his book Fractals Everywhere . 1 He made it to resemble the Black Spleenwort, Asplenium adiantum-nigrum .  History  The fern is one of the basic examples of self-similar sets, i.e. it is a mathematically generated pattern that can be reproducible at any magnification or reduction. Like the Sierpinski triangle , the Barnsley fern shows how graphically beautiful structures can be built from repetitive uses of mathematical formulas with computers. Barnsley's book about fractals is based on the course which he taught for undergraduate and graduate students in the School of Mathematics, Georgia Institute of Technology , called Fractal Geometry . After publishing the book, a second course was developed, called Fractal Measure Theory . 2 Barnsley's work has been a source of inspiration to graphic artists attempting to imitate nature with mathematical models.  The fern code developed by Barnsley is an example of an iterated function system (IFS) to create a fractal. He has used fractals to model a diverse range of phenomena in science and technology, but most specifically plant structures.  —Michael Barnsley et al. 3  Construction  (Figure)  Real lady ferns.   Barnsley's fern uses four affine transformations . The formula for one transformation is the following:       f   (  x  ,  y  )    =     [     a    b      c    d     ]    [     x      y     ]    +   [     e      f     ]          f   x  y          a  b    c  d      x    y       e    f       f(x,y)=\begin{bmatrix}a&b;\\
 c&d;\end{bmatrix}\begin{bmatrix}x\\
 y\end{bmatrix}+\begin{bmatrix}e\\
 f\end{bmatrix}   Barnsley shows the IFS code for his Black Spleenwort fern fractal as a matrix of values shown in a table. 4 In the table, the columns "a" through "f" are the coefficients of the equation, and "p" represents the probability factor.      w   a   b   c   d   e   f   p   Portion generated       ƒ 1   0   0   0   0.16   0   0   0.01   Stem     ƒ 2   0.85   0.04   −0.04   0.85   0   1.60   0.85   Successively smaller leaflets     ƒ 3   0.20   −0.26   0.23   0.22   0   1.60   0.07   Largest left-hand leaflet     ƒ 4   −0.15   0.28   0.26   0.24   0   0.44   0.07   Largest right-hand leaflet     These correspond to the following transformations:       f   (  x  ,  y  )    =    [     0.00    0.00      0.00    0.16     ]    [      x       y     ]          f   x  y        0.00  0.00    0.00  0.16      x    y       f(x,y)=\begin{bmatrix}\ 0.00&\ 0.00\\
 0.00&\ 0.16\end{bmatrix}\begin{bmatrix}\ x\\
 y\end{bmatrix}          f   (  x  ,  y  )    =     [     0.85    0.04       -  0.04     0.85     ]    [      x       y     ]    +   [     0.00      1.60     ]          f   x  y          0.85  0.04      0.04   0.85      x    y       0.00    1.60       f(x,y)=\begin{bmatrix}\ 0.85&\ 0.04\\
 -0.04&\ 0.85\end{bmatrix}\begin{bmatrix}\ x\\
 y\end{bmatrix}+\begin{bmatrix}\ 0.00\\
 1.60\end{bmatrix}          f   (  x  ,  y  )    =     [     0.20     -  0.26       0.23    0.22     ]    [      x       y     ]    +   [     0.00      1.60     ]          f   x  y          0.20    0.26     0.23  0.22      x    y       0.00    1.60       f(x,y)=\begin{bmatrix}\ 0.20&\ -0.26\\
 0.23&\ 0.22\end{bmatrix}\begin{bmatrix}\ x\\
 y\end{bmatrix}+\begin{bmatrix}\ 0.00\\
 1.60\end{bmatrix}          f   (  x  ,  y  )    =     [      -  0.15     0.28      0.26    0.24     ]    [      x       y     ]    +   [     0.00      0.44     ]          f   x  y            0.15   0.28    0.26  0.24      x    y       0.00    0.44       f(x,y)=\begin{bmatrix}\ -0.15&\ 0.28\\
 0.26&\ 0.24\end{bmatrix}\begin{bmatrix}\ x\\
 y\end{bmatrix}+\begin{bmatrix}\ 0.00\\
 0.44\end{bmatrix}     Computer generation  Though Barnsley's fern could in theory be plotted by hand with a pen and graph paper, the number of iterations necessary runs into the tens of thousands, which makes use of a computer practically mandatory. Many different computer models of Barnsley's fern are popular with contemporary mathematicians. As long as the math is programmed correctly using Barnsley's matrix of constants, the same fern shape will be produced.  The first point drawn is at the origin ( x 0 = 0, y 0 = 0) and then the new points are iteratively computed by randomly applying one of the following four coordinate transformations: 5 6  ƒ 1   x n + 1 = 0    y n + 1 = 0.16 y n .   This coordinate transformation is chosen 1% of the time and just maps any point to a point in the first line segment at the base of the stem. This part of the figure is the first to be completed in during the course of iterations.  ƒ 2   x n + 1 = 0.85 x n + 0.04 y n     y n + 1 = −0.04 x n + 0.85 y n + 1.6.   This coordinate transformation is chosen 85% of the time and maps any point inside the leaflet represented by the red triangle to a point inside the opposite, smaller leaflet represented by the blue triangle in the figure.  ƒ 3   x n + 1 = 0.2 x n − 0.26 y n     y n + 1 = 0.23 x n + 0.22 y n + 1.6.   This coordinate transformation is chosen 7% of the time and maps any point inside the leaflet (or pinna ) represented by the blue triangle to a point inside the alternating corresponding triangle across the stem (it flips it).  ƒ 4   x n + 1 = −0.15 x n + 0.28 y n     y n + 1 = 0.26 x n + 0.24 y n + 0.44.   This coordinate transformation is chosen 7% of the time and maps any point inside the leaflet (or pinna ) represented by the blue triangle to a point inside the alternating corresponding triangle across the stem (without flipping it).  The first coordinate transformation draws the stem. The second generates successive copies of the stem and bottom fronds to make the complete fern. The third draws the bottom frond on the left. The fourth draws the bottom frond on the right. The recursive nature of the IFS guarantees that the whole is a larger replica of each frond. Note that the complete fern is within the range −2.1820  One experimenter has come up with a table of coefficients to produce another remarkably naturally looking fern however, resembling the Cyclosorus or Thelypteridaceae fern. These are: 7 8      w   a   b   c   d   e   f   p       ƒ 1   0   0   0   0.25   0   −0.4   0.02     ƒ 2   0.95   0.005   −0.005   0.93   −0.002   0.5   0.84     ƒ 3   0.035   −0.2   0.16   0.04   −0.09   0.02   0.07     ƒ 4   −0.04   0.2   0.16   0.04   0.083   0.12   0.07     References  "  Category:Affine geometry  Category:Fractals     [ http://books.google.nl/books?id=oh7NoePgmOIC&dq; ; Fractals Everywhere], Boston, MA: Academic Press, 1993, ISBN 0-12-079062-9 ↩   Michael Barnsley , et al. , ↩  Fractals Everywhere , table III.3, IFS code for a fern. ↩  ↩  ↩  Other fern varieties with supplied coefficients, retrieved 2010-1-7 ↩  A Barnsley fern generator ↩     
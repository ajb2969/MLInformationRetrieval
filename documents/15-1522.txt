   TP model transformation in control theory      TP model transformation in control theory   Baranyi and Yam proposed the TP model transformation  1 2 3 as a new concept in quasi-LPV (qLPV) based control, which plays a central role in the highly desirable bridging between identification and polytopic systems theories. It is uniquely effective in manipulating the convex hull of polytopic forms , and, hence, has revealed and proved the fact that convex hull manipulation is a necessary and crucial step in achieving optimal solutions and decreasing conservativeness in modern linear matrix inequality based control theory . Thus, although it is a transformation in a mathematical sense, it has established a conceptually new direction in control theory and has laid the ground for further new approaches towards optimality.  For details please visit: TP model transformation  Key features for control analysis and design   The TP model transformation transforms a given qLPV model into a (tensor product type) polytopic form, irrespective of whether the model is given in the form of analytical equations resulting from physical considerations, or as an outcome of soft computing based identification techniques (such as neural networks or fuzzy logic based methods, or as a result of a black-box identification).  Further the TP model transformation is capable of manipulating the convex hull defined by the polytopic form that is a necessary step in polytopic qLPV model based control analysis and design theories.   Related definitions   Linear Parameter-Varying (LPV) state-space model:          \begin{pmatrix}  {{\mathbf{{\dot{x}}}}}(t)Â \\  {\mathbf{y}}(t)  \end{pmatrix}={\mathbf{S}}({\mathbf{p}}(t))\begin{pmatrix}  {\mathbf{x}}(t)Â \\  {\mathbf{u}}(t)  \end{pmatrix},  with input    ğ®   (  t  )       ğ®  t    {\mathbf{u}}(t)   , output    ğ²   (  t  )       ğ²  t    {\mathbf{y}}(t)   and state vector    ğ±   (  t  )       ğ±  t    {\mathbf{x}}(t)   . The system matrix     ğ’   (   ğ©   (  t  )    )    âˆˆ    \R     L  1   Ã—   L  2           ğ’    ğ©  t     superscript  \R     subscript  L  1    subscript  L  2       {\mathbf{S}}({\mathbf{p}}(t))\in\R^{L_{1}\times L_{2}}   is a parameter-varying object, where     ğ©   (  t  )    âˆˆ  Î©        ğ©  t   normal-Î©    {\mathbf{p}}(t)\in\Omega   is a time varying   N   N   N   -dimensional parameter vector which is an element of closed hypercube    Î©  =    [   a  1   ,   b  1   ]   Ã—   [   a  2   ,   b  2   ]   Ã—  â‹¯  Ã—   [   a  N   ,   b  N   ]    âŠ‚    \R   N         normal-Î©      subscript  a  1    subscript  b  1      subscript  a  2    subscript  b  2    normal-â‹¯    subscript  a  N    subscript  b  N           superscript  \R  N      \Omega=[a_{1},b_{1}]\times[a_{2},b_{2}]\times\cdots\times[a_{N},b_{N}]\subset%
 \R^{N}   . As a matter of fact, further parameter dependent channels can be inserted to    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     {\mathbf{S}}({\mathbf{p}}(t))   that represent various control performance requirements.   quasi Linear Parameter-Varying (qLPV) state-space model:       ğ©   (  t  )       ğ©  t    {\mathbf{p}}(t)   in the above LPV model can also include some elements of the state vector    ğ±   (  t  )       ğ±  t    {\mathbf{x}}(t)   , and, hence this model belongs to the class of non-linear systems, and is also referred to as a quasi LPV (qLPV) model.   TP type polytopic Linear Parameter-Varying (LPV) state-space model:          \begin{pmatrix}  {{\mathbf{{\dot{x}}}}}(t)Â \\  {\mathbf{y}}(t)  \end{pmatrix}=\mathcal{S}\boxtimes_{n=1}^N\mathbf{w}_n(p_n(t))\begin{pmatrix}  {\mathbf{x}}(t)Â \\  {\mathbf{u}}(t)  \end{pmatrix},  with input    ğ®   (  t  )       ğ®  t    {\mathbf{u}}(t)   , output    ğ²   (  t  )       ğ²  t    {\mathbf{y}}(t)   and state vector    ğ±   (  t  )       ğ±  t    {\mathbf{x}}(t)   . The system matrix     ğ’   (   ğ©   (  t  )    )    =    ğ’®   âŠ    n  =  1   N   ğ°    (    p  n    (  t  )    )    âˆˆ    \R     L  1   Ã—   L  2             ğ’    ğ©  t        superscript   subscript  normal-âŠ     n  1    N   ğ’®  ğ°      subscript  p  n   t          superscript  \R     subscript  L  1    subscript  L  2        {\mathbf{S}}({\mathbf{p}}(t))=\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}(p_{n}(t%
 ))\in\R^{L_{1}\times L_{2}}   is a parameter-varying object, where     ğ©   (  t  )    âˆˆ  Î©        ğ©  t   normal-Î©    {\mathbf{p}}(t)\in\Omega   is a time varying   N   N   N   -dimensional parameter vector which is an element of closed hypercube    Î©  =    [   a  1   ,   b  1   ]   Ã—   [   a  2   ,   b  2   ]   Ã—  â‹¯  Ã—   [   a  N   ,   b  N   ]    âŠ‚    \R   N         normal-Î©      subscript  a  1    subscript  b  1      subscript  a  2    subscript  b  2    normal-â‹¯    subscript  a  N    subscript  b  N           superscript  \R  N      \Omega=[a_{1},b_{1}]\times[a_{2},b_{2}]\times\cdots\times[a_{N},b_{N}]\subset%
 \R^{N}   , and the weighting functions      w   n  ,   i  n      (    p  n    (  t  )    )    âˆˆ   [  0  ,  1  ]          subscript  w   n   subscript  i  n        subscript  p  n   t     0  1     w_{n,i_{n}}(p_{n}(t))\in[0,1]   are the elements of vector     ğ°  n    (    p  n    (  t  )    )        subscript  ğ°  n      subscript  p  n   t     \mathbf{w}_{n}(p_{n}(t))   . Core tensor contains elements    ğ’    i  1   ,   i  2   ,  â€¦  ,   i  N       subscript  ğ’    subscript  i  1    subscript  i  2   normal-â€¦   subscript  i  N      \mathbf{S}_{i_{1},i_{2},\ldots,i_{N}}   which are the vertexes of the system. As a matter of fact, further parameter dependent channels can be inserted to    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     {\mathbf{S}}({\mathbf{p}}(t))   that represent various control performance requirements. Here         âˆ€  n   :     âˆ‘    i  n   =  1    I  n      w   n  ,   i  n      (    p  n    (  t  )    )     =  1.      normal-:   for-all  n       superscript   subscript      subscript  i  n   1     subscript  I  n       subscript  w   n   subscript  i  n        subscript  p  n   t     1.     \forall n:\sum_{i_{n}=1}^{I_{n}}w_{n,i_{n}}(p_{n}(t))=1.   and       w   n  ,   i  n      (    p  n    (  t  )    )    âˆˆ   [  0  ,  1  ]    .         subscript  w   n   subscript  i  n        subscript  p  n   t     0  1     w_{n,i_{n}}(p_{n}(t))\in[0,1].        This means that    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     \mathbf{S}({\mathbf{p}}(t))   is within the vertexes    ğ’    i  1   ,   i  2   ,  â€¦  ,   i  N       subscript  ğ’    subscript  i  1    subscript  i  2   normal-â€¦   subscript  i  N      \mathbf{S}_{i_{1},i_{2},\ldots,i_{N}}   of the system (within the convex hull defined by the vertexes) for all     ğ©   (  t  )    âˆˆ  Î©        ğ©  t   normal-Î©    \mathbf{p}(t)\in\Omega   . Note that the TP type polytopic model can always be given in the form          ğ’   (   ğ©   (  t  )    )    =    âˆ‘   r  =  1   R     ğ’  r    w  r    (   ğ©   (  t  )    )      ,        ğ’    ğ©  t      superscript   subscript     r  1    R      subscript  ğ’  r    subscript  w  r     ğ©  t       \mathbf{S}(\mathbf{p}(t))=\sum_{r=1}^{R}\mathbf{S}_{r}w_{r}(\mathbf{p}(t)),        where the vertexes are the same as in the TP type polytopic form and the multi variable weighting functions are the product of the one variable weighting functions according to the TP type polytopic form, and r is the linear index equivalent of the multi-linear indexing     i  1   ,   i  2   ,   â€¦   i  N        subscript  i  1    subscript  i  2     normal-â€¦   subscript  i  N      i_{1},i_{2},\ldots i_{N}   .   TP model transformation for qLPV models:   Assume a given qLPV model    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     \mathbf{S}(\mathbf{p}(t))   , where     ğ©   (  t  )    âˆˆ  Î©  âŠ‚   R  N           ğ©  t   normal-Î©        superscript  R  N      \mathbf{p}(t)\in\Omega\subset R^{N}   , whose TP polytopic structure may be unknown (e.g. it is given by neural networks). The TP model transformation determines its TP polytopic structure as         ğ’   (   ğ©   (  t  )    )    =    ğ’®   âŠ    n  =  1   N    ğ°  n     (    p  n    (  t  )    )          ğ’    ğ©  t        superscript   subscript  normal-âŠ     n  1    N   ğ’®   subscript  ğ°  n       subscript  p  n   t      \mathbf{S}(\mathbf{p}(t))=\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(p_{n}(t))   ,     namely it generates core tensor   ğ’®   ğ’®   \mathcal{S}   and weighting functions of     ğ°  n    (    p  n    (  t  )    )        subscript  ğ°  n      subscript  p  n   t     \mathbf{w}_{n}(p_{n}(t))   for all    n  =   1  â€¦  N       n    1  normal-â€¦  N     n=1\ldots N   . Its free MATLAB implementation is downloadable at 1 or at MATLAB Central 2 .  If the given model does not have (finite element) TP polytopic structure, then the TP model transformation determines its approximation:          ğ’   (   ğ©   (  t  )    )    â‰ˆ    ğ’®   âŠ    n  =  1   N    ğ°  n     (    p  n    (  t  )    )     ,        ğ’    ğ©  t        superscript   subscript  normal-âŠ     n  1    N   ğ’®   subscript  ğ°  n       subscript  p  n   t      \mathbf{S}(\mathbf{p}(t))\approx\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(p%
 _{n}(t)),        where trade-off is offered by the TP model transformation between complexity (number of vertexes stored in the core tensor or the number of weighting functions) and the approximation accuracy. 4 The TP model can be generated according to various constrains. Typical TP models generated by the TP model transformation are:   HOSVD canonical form of qLPV models,  Various kinds of TP type polytopic form (this feature is very important in control performance optimization).   TP model based control design   Key methodology:   Since the TP type polytopic model is a subset of the polytopic model representations, the analysis and design methodologies developed for polytopic representations are applicable for the TP type polytopic models as well. One typical way is to search the nonlinear controller in the form:         u  =   -   ğ…   (   ğ©   (  t  )    )   ğ±   (  t  )     =   -    âˆ‘   r  =  1   R     F  r    w  r    (   ğ©   (  t  )    )   ğ±   (  t  )       ,        u      ğ…    ğ©  t   ğ±  t             superscript   subscript     r  1    R      subscript  F  r    subscript  w  r     ğ©  t   ğ±  t        u=-\mathbf{F}(\mathbf{p}(t))\mathbf{x}(t)=-\sum_{r=1}^{R}F_{r}w_{r}(\mathbf{p}%
 (t))\mathbf{x}(t),        where the vertexes    ğ…  r     subscript  ğ…  r    \mathbf{F}_{r}   of the controller is calculated from    ğ’  r     subscript  ğ’  r    \mathbf{S}_{r}   . Typically, the vertexes    ğ’  r     subscript  ğ’  r    \mathbf{S}_{r}   are substituted into Linear Matrix Inequalities in order to determine    ğ…  r     subscript  ğ…  r    \mathbf{F}_{r}   .  In TP type polytopic form the controller is:         u  =   -   ğ…   (   ğ©   (  t  )    )   ğ±   (  t  )     =   -    â„±   âŠ    n  =  1   N    ğ°  n     (    p  n    (  t  )    )   ğ±   (  t  )      ,        u      ğ…    ğ©  t   ğ±  t               superscript   subscript  normal-âŠ     n  1    N   â„±   subscript  ğ°  n       subscript  p  n   t   ğ±  t       u=-\mathbf{F}(\mathbf{p}(t))\mathbf{x}(t)=-\mathcal{F}\boxtimes_{n=1}^{N}%
 \mathbf{w}_{n}(p_{n}(t))\mathbf{x}(t),        where the vertexes    ğ…    i  1   ,   i  2   ,  â€¦  ,   i  N       subscript  ğ…    subscript  i  1    subscript  i  2   normal-â€¦   subscript  i  N      \mathbf{F}_{i_{1},i_{2},\ldots,i_{N}}   stored in the core tensor   â„±   â„±   \mathcal{F}   are determined from the vertexes    ğ’    i  1   ,   i  2   ,  â€¦  ,   i  N       subscript  ğ’    subscript  i  1    subscript  i  2   normal-â€¦   subscript  i  N      \mathbf{S}_{i_{1},i_{2},\ldots,i_{N}}   stored in   ğ’®   ğ’®   \mathcal{S}   . Note that the polytopic observer or other components can be generated in similar way, such as these vertexes are also generated from   ğ’®   ğ’®   \mathcal{S}   .   Convex hull manipulation based optimization:   The polytopic representation of a given qLPV model is not invariant. I.e. a given    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     \mathbf{S}(\mathbf{p}(t))   has    Z  =  âˆ      Z     Z=\infty   number of different representation as:          ğ’   (   ğ©   (  t  )    )    =     ğ’®  z    âŠ    n  =  1   N    ğ°   z  ,  n      (    p  n    (  t  )    )     ,        ğ’    ğ©  t        superscript   subscript  normal-âŠ     n  1    N    subscript  ğ’®  z    subscript  ğ°   z  n        subscript  p  n   t      \mathbf{S}(\mathbf{p}(t))=\mathcal{S}_{z}\boxtimes_{n=1}^{N}\mathbf{w}_{z,n}(p%
 _{n}(t)),        where    z  =   1  â€¦  Z       z    1  normal-â€¦  Z     z=1\ldots Z   . In order to generate an optimal control of the given model    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     \mathbf{S}(\mathbf{p}(t))   we apply, for instance LMIs. Thus, if we apply the selected LMIs to the above polytopic model we arrive at:          u  z   =   -    ğ…  z    (   ğ©   (  t  )    )   ğ±   (  t  )     =   -     â„±  z    âŠ    n  =  1   N    ğ°   z  ,  n      (    p  n    (  t  )    )   ğ±   (  t  )      .         subscript  u  z        subscript  ğ…  z     ğ©  t   ğ±  t               superscript   subscript  normal-âŠ     n  1    N    subscript  â„±  z    subscript  ğ°   z  n        subscript  p  n   t   ğ±  t       u_{z}=-\mathbf{F}_{z}(\mathbf{p}(t))\mathbf{x}(t)=-\mathcal{F}_{z}\boxtimes_{n%
 =1}^{N}\mathbf{w}_{z,n}(p_{n}(t))\mathbf{x}(t).        Since the LMIs realize a non-linear mapping between the vertexes in   ğ’®   ğ’®   \mathcal{S}   and   â„±   â„±   \mathcal{F}   we may find very different controllers for each    z  =   1  â€¦  Z       z    1  normal-â€¦  Z     z=1\ldots Z   . This means that we have   Z   Z   Z   different number of "optimal" controllers to the same system    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     \mathbf{S}(\mathbf{p}(t))   . Thus, the question is: which one of the "optimal" controllers is really the optimal one. The TP model transformation let us to manipulate the weighting functions systematically that is equivalent to the manipulation of the vertexes. The geometrical meaning of this manipulation is the manipulation of the convex hull defined by the vertexes. We can easily demonstrate the following facts:   Tightening the convex hull typically decreases the conservativeness of the solution, so as may lead to better control performance. For instance, if we have a polytopic representation           ğ’   (   ğ©   (  t  )    )    =    ğ’®   âŠ    n  =  1   N    ğ°  n     (    p  n    (  t  )    )     ,        ğ’    ğ©  t        superscript   subscript  normal-âŠ     n  1    N   ğ’®   subscript  ğ°  n       subscript  p  n   t      \mathbf{S}(\mathbf{p}(t))=\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(p_{n}(t%
 )),        of a given model    ğ’   (   ğ©   (  t  )    )       ğ’    ğ©  t     \mathbf{S}(\mathbf{p}(t))   , then we can generate a controller as         u  =   -    â„±   âŠ    n  =  1   N    ğ°  n     (    p  n    (  t  )    )   ğ±   (  t  )      ,      u        superscript   subscript  normal-âŠ     n  1    N   â„±   subscript  ğ°  n       subscript  p  n   t   ğ±  t      u=-\mathcal{F}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(p_{n}(t))\mathbf{x}(t),        then we solved the control problem of all systems    k  =   1  â€¦  K   =  âˆ        k    1  normal-â€¦  K            k=1\ldots K=\infty   that can be given by the same vertexes, but with different weighting functions as:           ğ’  k    (   ğ©   (  t  )    )    =    ğ’®   âŠ    n  =  1   N    ğ°   k  ,  n      (    p  n    (  t  )    )     ,         subscript  ğ’  k     ğ©  t        superscript   subscript  normal-âŠ     n  1    N   ğ’®   subscript  ğ°   k  n        subscript  p  n   t      \mathbf{S}_{k}(\mathbf{p}(t))=\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{k,n}(p%
 _{n}(t)),        where          u  k   =   -    â„±   âŠ    n  =  1   N    ğ°   k  ,  n      (    p  n    (  t  )    )   ğ±   (  t  )      .       subscript  u  k         superscript   subscript  normal-âŠ     n  1    N   â„±   subscript  ğ°   k  n        subscript  p  n   t   ğ±  t      u_{k}=-\mathcal{F}\boxtimes_{n=1}^{N}\mathbf{w}_{k,n}(p_{n}(t))\mathbf{x}(t).        If one of these systems are very hardly controllable (or even uncontrollable) then we arrive at a very conservative solution (or unfeasible LMIs). Therefore we expect that during tightening the convex hull we exclude such problematic systems.   It can also be easily demonstrated that the observer design is typically needs large convex hull. So, as when we design controller and observer we need to find the optimal convex hull between the tight one and the large one. Same papers also demonstrate that using different convex hulls (if the separation principal is applicable) for observer and controller may lead to even better solution.   Properties of the TP model transformation in qLPV theories   It can be executed uniformly (irrespective of whether the model is given in the form of analytical equations resulting from physical considerations, or as an outcome of soft computing based identification techniques (such as neural networks or fuzzy logic based methods, or as a result of a black-box identification), without analytical interaction, within a reasonable amount of time. Thus, the transformation replaces the analytical and in many cases complex and not obvious conversions to numerical, tractable, straightforward operations that can be carried out in a routine fashion.    It generates the HOSVD-based canonical form of qLPV models, which is a unique representation. This form extracts the unique structure of a given qLPV model in the same sense as the HOSVD does for tensors and matrices, in a way such that:   :* the number of LTI components are minimized;  :* the weighting functions are one variable functions of the parameter vector in an orthonormed system for each parameter (singular functions);  :* the LTI components (vertex components) are also in orthogonal positions;  :* the LTI systems and the weighting functions are ordered according to the higher-order singular values of the parameter vector;  :* it has a unique form (except for some special cases);  :* introduces and defines the rank of the qLPV model by the dimensions of the parameter vector;   The core step of the TP model transformation was extended to generate different types of convex polytopic models, in order to focus on the systematic (numerical and automatic) modification of the convex hull instead of developing new LMI equations for feasible controller design (this is the widely adopted approach). It is worth noting that both the TP model transformation and the LMI-based control design methods are numerically executable one after the other, and this makes the resolution of a wide class of problems possible in a straightforward and tractable, numerical way.    Based on the higher-order singular values (which express the rank properties of the given qLPV model, see above, for each element of the parameter vector in    L  2     subscript  L  2    L_{2}   norm), the TP model transformation offers a trade-off between the complexity of the TP model (polytopic form), 5 hence, the LMI design and the accuracy of the resulting TP model.    The TP model transformation is executed before utilizing the LMI design. This means that when we start the LMI design we already have the global weighting functions and during control we do not need to determine a local weighting of the LTI systems for feedback gains to compute the control value at every point of the hyperspace the system should go through. Having predefined continuous weighting functions also ensures that there is no friction in the weighting during control.   References    '  Category:Control theory     P. Baranyi (April 2004). "TP model transformation as a way to LMI based controller design". IEEE Transaction on Industrial Electronics 51 (2): 387â€“400. â†©  P. Baranyi and D. Tikk and Y. Yam and R. J. Patton (2003). "From Differential Equations to PDC Controller Design via Numerical Transformation". Computers in Industry, Elsevier Science 51: 281â€“297. â†©  â†©  â†©      
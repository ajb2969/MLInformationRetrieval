<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="484">Charge amplifier</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Charge amplifier</h1>
<hr/>

<p>A <strong>charge amplifier</strong> is a <strong>current <a class="uri" href="integrator" title="wikilink">integrator</a></strong> that produces a voltage output proportional to the integrated value of the input current. The amplifier offsets the input charge using a feedback reference capacitor, and produces an output voltage inversely proportional to the value of the reference capacitor but proportional to the total input charge flowing during the specified time period; hence the circuit acts as a charge-to-voltage converter. The gain of the circuit depends on the value of the feedback capacitor.</p>
<h2 id="applications">Applications</h2>

<p>Common applications include amplification of signals from such as <a href="piezoelectric_sensor" title="wikilink">piezoelectric sensors</a> and <a href="photodiode" title="wikilink">photodiodes</a>, in which the charge output from the transducer is converted into a voltage.</p>

<p>Charge amplifiers are also used extensively in instruments measuring <a href="ionizing_radiation" title="wikilink">ionizing radiation</a>, such as the <a href="proportional_counter" title="wikilink">proportional counter</a> or the <a href="scintillation_counter" title="wikilink">scintillation counter</a>, where the energy of each pulse of detected radiation due to a ionising event must be measured. Integrating the charge pulses from the detector gives a translation of input pulse energy to a peak voltage output, which can then be measured for each pulse. Normally this then goes to discrimination circuits or a <a href="gamma_spectroscopy" title="wikilink">multi channel analyser</a>.</p>

<p>Charge amplifiers are also used in the readout circuitry of <a href="Charge-coupled_device" title="wikilink">CCD</a> imagers and flat-panel <a class="uri" href="X-ray" title="wikilink">X-ray</a> detector arrays. The objective is to measure the very small charge stored within an in-pixel capacitor.</p>

<p>Advantages of charge amplifiers include:</p>
<ul>
<li>Enables quasi-static measurements in certain situations, such as constant pressures on a piezo lasting several minutes<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></li>
<li>Piezo element transducer can be used in much hotter environments than those with internal electronics<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></li>
<li>Gain is dependent only on the feedback capacitor, unlike voltage amplifiers, which are affected greatly by the input capacitance of the amplifier and the parallel capacitance of the cable<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></li>
</ul>
<h2 id="design">Design</h2>

<p>Charge amplifiers are usually constructed using an <a href="operational_amplifier" title="wikilink">operational amplifier</a> or other high gain semiconductor circuit with a <a href="negative_feedback" title="wikilink">negative feedback</a> capacitor. The input current is offset by a negative feedback current flowing in the capacitor, which is generated by an increase in output voltage of the amplifier. The output voltage is therefore dependent on the value of input current it has to offset and the inverse of the value of the feedback capacitor. The greater the capacitor value, the less output voltage has to be generated to produce a particular feedback current flow.</p>

<p>The input impedance of the circuit is almost zero because of the <a href="Miller_effect" title="wikilink">Miller effect</a>. Hence all the stray capacitances (the cable capacitance, the amplifier input capacitance, etc.) are virtually grounded and they have no influence on the output signal.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h3 id="ideal-circuit">Ideal circuit</h3>

<p>An "ideal circuit" for analysing charge amplifier operation is shown below:</p>
<figure><b>(Figure)</b>
<figcaption>Integrator circuit</figcaption>
</figure>

<p>The circuit operates by passing a current that charges or discharges the <a class="uri" href="capacitor" title="wikilink">capacitor</a> C<sub>f</sub> during the time under consideration, which strives to retain the <a href="virtual_ground" title="wikilink">virtual ground</a> condition at the input by off-setting the effect of the input current. Referring to the above diagram, if the op-amp is assumed to be <a href="Operational_amplifier#Ideal_op-amps" title="wikilink">ideal</a>, nodes <em>v<sub>1</sub></em> and <em>v<sub>2</sub></em> are held equal, and so <em>v<sub>2</sub></em> is a virtual ground. The input voltage passes a current 

<math display="inline" id="Charge_amplifier:0">
 <semantics>
  <mfrac>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>i</mi>
     <mi>n</mi>
    </mrow>
   </msub>
   <msub>
    <mi>R</mi>
    <mn>1</mn>
   </msub>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{v_{in}}{R_{1}}
  </annotation>
 </semantics>
</math>

 through the <a class="uri" href="resistor" title="wikilink">resistor</a> producing a compensating current flow through the series capacitor to maintain the virtual ground. This charges or discharges the capacitor over time. Because the resistor and capacitor are connected to a virtual ground, the input current does not vary with capacitor charge and a <a href="linearity" title="wikilink">linear</a> integration of output is achieved.</p>

<p>The circuit can be analyzed by applying <a href="Kirchhoff's_current_law" title="wikilink">Kirchhoff's current law</a> at the node <em>v<sub>2</sub></em>, keeping ideal op-amp behaviour in mind.</p>

<p>

<math display="block" id="Charge_amplifier:1">
 <semantics>
  <mrow>
   <msub>
    <mi>i</mi>
    <mtext>1</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mtext>B</mtext>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>i</mi>
     <mtext>F</mtext>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>i</ci>
     <mtext>1</mtext>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <mtext>B</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>i</ci>
      <mtext>F</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{\text{1}}=I_{\text{B}}+i_{\text{F}}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Charge_amplifier:2">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mtext>B</mtext>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <mtext>B</mtext>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{\text{B}}=0
  </annotation>
 </semantics>
</math>

 in an ideal op-amp, so:</p>

<p>

<math display="block" id="Charge_amplifier:3">
 <semantics>
  <mrow>
   <msub>
    <mi>i</mi>
    <mtext>1</mtext>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>i</mi>
    <mtext>F</mtext>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>i</ci>
     <mtext>1</mtext>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>i</ci>
     <mtext>F</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{\text{1}}=i_{\text{F}}
  </annotation>
 </semantics>
</math>

</p>

<p>Furthermore, the capacitor has a voltage-current relationship governed by the equation:</p>

<p>

<math display="block" id="Charge_amplifier:4">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mtext>C</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>V</mi>
       <mtext>c</mtext>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <mtext>C</mtext>
    </apply>
    <apply>
     <times></times>
     <ci>C</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <mtext>c</mtext>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{\text{C}}=C\frac{dV_{\text{c}}}{dt}
  </annotation>
 </semantics>
</math>

</p>

<p>Substituting the appropriate variables:</p>

<p>

<math display="block" id="Charge_amplifier:5">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msub>
      <mi>v</mi>
      <mtext>in</mtext>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>v</mi>
      <mtext>2</mtext>
     </msub>
    </mrow>
    <msub>
     <mi>R</mi>
     <mtext>1</mtext>
    </msub>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mtext>F</mtext>
    </msub>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>v</mi>
         <mtext>2</mtext>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>v</mi>
         <mtext>o</mtext>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <mtext>in</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <mtext>2</mtext>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <mtext>1</mtext>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <mtext>F</mtext>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <mtext>2</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <mtext>o</mtext>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{v_{\text{in}}-v_{\text{2}}}{R_{\text{1}}}=C_{\text{F}}\frac{d(v_{\text{2%
}}-v_{\text{o}})}{dt}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Charge_amplifier:6">
 <semantics>
  <mrow>
   <msub>
    <mi>v</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>v</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{2}=v_{1}=0
  </annotation>
 </semantics>
</math>

 in an ideal op-amp, resulting in:</p>

<p>

<math display="block" id="Charge_amplifier:7">
 <semantics>
  <mrow>
   <mfrac>
    <msub>
     <mi>v</mi>
     <mtext>in</mtext>
    </msub>
    <msub>
     <mi>R</mi>
     <mtext>1</mtext>
    </msub>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>C</mi>
      <mtext>F</mtext>
     </msub>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <msub>
        <mi>v</mi>
        <mtext>o</mtext>
       </msub>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <mtext>in</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <mtext>1</mtext>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <mtext>F</mtext>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <mtext>o</mtext>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{v_{\text{in}}}{R_{\text{1}}}=-C_{\text{F}}\frac{dv_{\text{o}}}{dt}
  </annotation>
 </semantics>
</math>

</p>

<p>Integrating both sides with respect to time:</p>

<p>

<math display="block" id="Charge_amplifier:8">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mi>t</mi>
    </msubsup>
    <mrow>
     <mpadded width="+5pt">
      <mfrac>
       <msub>
        <mi>v</mi>
        <mtext>in</mtext>
       </msub>
       <msub>
        <mi>R</mi>
        <mtext>1</mtext>
       </msub>
      </mfrac>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+5pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>t</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>C</mi>
       <mtext>F</mtext>
      </msub>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>v</mi>
          <mtext>o</mtext>
         </msub>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>t</mi>
        </mrow>
       </mfrac>
      </mpadded>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <mtext>in</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>1</mtext>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <mtext>F</mtext>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <mtext>o</mtext>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{t}\frac{v_{\text{in}}}{R_{\text{1}}}\ dt\ =-\int_{0}^{t}C_{\text{F}}%
\frac{dv_{\text{o}}}{dt}\,dt
  </annotation>
 </semantics>
</math>

</p>

<p>If the initial value of <em>v<sub>o</sub></em> is assumed to be 0 V, this results in a DC error of:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>

<math display="block" id="Charge_amplifier:9">
 <semantics>
  <mrow>
   <msub>
    <mi>v</mi>
    <mtext>o</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <msub>
        <mi>R</mi>
        <mtext>1</mtext>
       </msub>
       <msub>
        <mi>C</mi>
        <mtext>F</mtext>
       </msub>
      </mrow>
     </mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi>t</mi>
      </msubsup>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>v</mi>
         <mtext>in</mtext>
        </msub>
       </mpadded>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <mtext>o</mtext>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <mtext>1</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <mtext>F</mtext>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <mtext>in</mtext>
        </apply>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{\text{o}}=-\frac{1}{R_{\text{1}}C_{\text{F}}}\int_{0}^{t}v_{\text{in}}\,dt
  </annotation>
 </semantics>
</math>

</p>
<h3 id="practical-circuit">Practical circuit</h3>

<p>The ideal circuit is not a practical integrator design for a number of reasons. Practical op-amps have a finite <a href="open-loop_gain" title="wikilink">open-loop gain</a>, an <a href="input_offset_voltage" title="wikilink">input offset voltage</a> and input bias currents (

<math display="inline" id="Charge_amplifier:10">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{B}
  </annotation>
 </semantics>
</math>

). This can cause several issues for the ideal design; most importantly, if 

<math display="inline" id="Charge_amplifier:11">
 <semantics>
  <mrow>
   <msub>
    <mi>v</mi>
    <mtext>in</mtext>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <mtext>in</mtext>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{\text{in}}=0
  </annotation>
 </semantics>
</math>

, both the output offset voltage and the input bias current 

<math display="inline" id="Charge_amplifier:12">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{B}
  </annotation>
 </semantics>
</math>

 can cause current to pass through the capacitor, causing the output voltage to drift over time until the op-amp saturates. Similarly, if 

<math display="inline" id="Charge_amplifier:13">
 <semantics>
  <msub>
   <mi>v</mi>
   <mtext>in</mtext>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <mtext>in</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{\text{in}}
  </annotation>
 </semantics>
</math>

 were a signal centered about zero volts (i.e. without a <a href="direct_current" title="wikilink">DC</a> component), no drift would be expected in an ideal circuit, but may occur in a real circuit. To negate the effect of the input bias current, it is necessary to set:</p>

<p>

<math display="inline" id="Charge_amplifier:14">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mtext>on</mtext>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>R</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>R</mi>
    <mi>f</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <mtext>on</mtext>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>f</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\text{on}}=R_{1}||R_{f}
  </annotation>
 </semantics>
</math>

.</p>

<p>The error voltage then becomes:</p>

<p>

<math display="block" id="Charge_amplifier:15">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mtext>E</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <msub>
        <mi>R</mi>
        <mtext>f</mtext>
       </msub>
       <msub>
        <mi>R</mi>
        <mn>1</mn>
       </msub>
      </mfrac>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>I</mi>
      <mi>O</mi>
      <mi>S</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <mtext>E</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <mtext>f</mtext>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>I</ci>
       <ci>O</ci>
       <ci>S</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{\text{E}}=\left(\frac{R_{\text{f}}}{R_{1}}+1\right)V_{IOS}
  </annotation>
 </semantics>
</math>

</p>

<p>The input bias current thus causes the same voltage drops at both the positive and negative terminals. A practical circuit is shown below.</p>

<p><br/>
 Also, in a DC steady state, the capacitor acts as an open circuit. The DC gain of the ideal circuit is therefore infinite (or in practice, the open-loop gain of a non-ideal op-amp). To counter this, a large resistor 

<math display="inline" id="Charge_amplifier:16">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>F</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>F</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{F}
  </annotation>
 </semantics>
</math>

 is inserted in parallel with the <a href="Feedback#Electronic_engineering" title="wikilink">feedback</a> capacitor, as shown in the figure above. This limits the DC gain of the circuit to a finite value, and hence changes the output drift into a finite, preferably small, DC error. Referring to the above daigram:</p>

<p>

<math display="block" id="Charge_amplifier:17">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mtext>E</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <msub>
      <mi>R</mi>
      <mtext>f</mtext>
     </msub>
     <msub>
      <mi>R</mi>
      <mn>1</mn>
     </msub>
    </mfrac>
    <mo>+</mo>
    <mn>1</mn>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>I</mi>
      <mi>O</mi>
      <mi>S</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>I</mi>
     <mrow>
      <mi>B</mi>
      <mi>I</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>R</mi>
      <mtext>f</mtext>
     </msub>
     <mo>∥</mo>
     <msub>
      <mi>R</mi>
      <mn>1</mn>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <mtext>E</mtext>
    </apply>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>f</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>I</ci>
       <ci>O</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <ci>I</ci>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <mtext>f</mtext>
      </apply>
      <csymbol cd="latexml">parallel-to</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{\text{E}}=\left(\frac{R_{\text{f}}}{R_{1}}+1\right)\left(V_{IOS}+I_{BI}%
\left(R_{\text{f}}\parallel R_{1}\right)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Charge_amplifier:18">
 <semantics>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>I</mi>
    <mi>O</mi>
    <mi>S</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <apply>
     <times></times>
     <ci>I</ci>
     <ci>O</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{IOS}
  </annotation>
 </semantics>
</math>

 is the input offset voltage and 

<math display="inline" id="Charge_amplifier:19">
 <semantics>
  <msub>
   <mi>I</mi>
   <mrow>
    <mi>B</mi>
    <mi>I</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <apply>
     <times></times>
     <ci>B</ci>
     <ci>I</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{BI}
  </annotation>
 </semantics>
</math>

 is the input bias current on the inverting terminal. 

<math display="inline" id="Charge_amplifier:20">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>f</mi>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>R</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>f</ci>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">1</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{f}\parallel R_{1}
  </annotation>
 </semantics>
</math>

 indicates two resistance values in parallel.</p>
<h2 id="applications-1">Applications</h2>
<ul>
<li><a class="uri" href="Accelerometer" title="wikilink">Accelerometer</a> <a href="signal_conditioning" title="wikilink">signal conditioning</a></li>
<li><a href="Guitar_pickup" title="wikilink">Guitar pickup</a> amplifiers</li>
<li><a href="Oscillation" title="wikilink">Vibration</a> <a class="uri" href="transducers" title="wikilink">transducers</a></li>
<li><a href="Proportional_counter" title="wikilink">Proportional counter</a> - measurement of ionizing radiation</li>
<li><a href="Scintillation_counter" title="wikilink">Scintillation counter</a>- measurement of ionizing radiation</li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Miller_theorem#zeroed" title="wikilink">Obtaining virtual zero impedance by applying Miller theorem</a></li>
<li><a href="Charge_transfer_amplifier" title="wikilink">Charge Transfer Amplifier</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://tclutherie.hypermart.net/interface/">Interface Circuits</a> for <a href="Polyvinylidene_fluoride" title="wikilink">Polyvinylidene fluoride</a> film</li>
<li><a href="http://www.scopeboy.com/elec/chargeamp.gif">Schematic diagram</a></li>
</ul>

<p>"</p>

<p><a href="Category:Electronic_amplifiers" title="wikilink">Category:Electronic amplifiers</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="http://www.mmf.de/instrumentation.htm">Transducers with Charge Output</a><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

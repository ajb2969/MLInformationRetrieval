   Multivariate normal distribution      Multivariate normal distribution   |\boldsymbol\Sigma|^{-\frac{1}{2}}\, e^{ -\frac{1}{2}(\mathbf{x}-\boldsymbol\mu)'\boldsymbol\Sigma^{-1}(\mathbf{x}-\boldsymbol\mu) }, exists only when Σ is positive-definite  | cdf        = (no analytic expression)  | mean       = μ  | median     =  | mode       = μ  | variance   = Σ  | skewness   =  | kurtosis   =  | entropy    =       k  2    (   1  +   ln   (   2  π   )     )    +    1  2    ln   |  𝚺  |             k  2     1      2  π          1  2       𝚺       \frac{k}{2}(1+\ln(2\pi))+\frac{1}{2}\ln|\boldsymbol{\Sigma}|     | mgf        =      exp    (     𝝁  ′   𝐭   +    1  2    𝐭  ′   𝚺  𝐭    )            superscript  𝝁  normal-′   𝐭       1  2    superscript  𝐭  normal-′   𝚺  𝐭      \exp\!\Big(\boldsymbol{\mu}^{\prime}\mathbf{t}+\tfrac{1}{2}\mathbf{t}^{\prime}%
 \boldsymbol{\Sigma}\mathbf{t}\Big)     | char       =      exp    (    i   𝝁  ′   𝐭   -    1  2    𝐭  ′   𝚺  𝐭    )           i   superscript  𝝁  normal-′   𝐭       1  2    superscript  𝐭  normal-′   𝚺  𝐭      \exp\!\Big(i\boldsymbol{\mu}^{\prime}\mathbf{t}-\tfrac{1}{2}\mathbf{t}^{\prime%
 }\boldsymbol{\Sigma}\mathbf{t}\Big)     }}  In probability theory and statistics , the multivariate normal distribution or multivariate Gaussian distribution , is a generalization of the one-dimensional ( univariate ) normal distribution to higher dimensions. One possible definition is that a random vector is said to be k -variate normally distributed if every linear combination of its k components has a univariate normal distribution. Its importance derives mainly from the multivariate central limit theorem . The multivariate normal distribution is often used to describe, at least approximately, any set of (possibly) correlated real-valued random variables each of which clusters around a mean value.  Notation and parametrization  The multivariate normal distribution of a k -dimensional random vector [ X 1 , X 2 , …, X k ]}} can be written in the following notation:        𝐱   ∼   𝒩   (  𝝁  ,  𝚺  )     ,     similar-to  𝐱    𝒩   𝝁  𝚺      \mathbf{x}\ \sim\ \mathcal{N}(\boldsymbol{\mu},\,\boldsymbol{\Sigma}),   or to make it explicitly known that X is k -dimensional,        𝐱   ∼    𝒩  k    (  𝝁  ,  𝚺  )     .     similar-to  𝐱     subscript  𝒩  k    𝝁  𝚺      \mathbf{x}\ \sim\ \mathcal{N}_{k}(\boldsymbol{\mu},\,\boldsymbol{\Sigma}).   with k -dimensional mean vector      𝝁  =   [   E   [   X  1   ]    ,   E   [   X  2   ]    ,  …  ,   E   [   X  k   ]    ]       𝝁    normal-E   subscript  X  1     normal-E   subscript  X  2    normal-…   normal-E   subscript  X  k       \boldsymbol{\mu}=[\operatorname{E}[X_{1}],\operatorname{E}[X_{2}],\ldots,%
 \operatorname{E}[X_{k}]]   and    k  ×  k      k  k    k\times k    covariance matrix       𝚺  =   [   Cov   [   X  i   ,   X  j   ]    ]    ,    i  =   1  ,  2  ,  …  ,  k    ;   j  =   1  ,  2  ,  …  ,  k        formulae-sequence    𝚺   delimited-[]   Cov   subscript  X  i    subscript  X  j       formulae-sequence    i   1  2  normal-…  k      j   1  2  normal-…  k       \boldsymbol{\Sigma}=[\operatorname{Cov}[X_{i},X_{j}]],i=1,2,\ldots,k;j=1,2,%
 \ldots,k     Definition  A random vector  is said to have the multivariate normal distribution if it satisfies the following equivalent conditions. 1   Every linear combination of its components Y = a 1 X 1 + … + a k X k is normally distributed . That is, for any constant vector , the random variable  has a univariate normal distribution, where a univariate normal distribution with zero variance is a point mass on its mean.    There exists a random ℓ -vector z , whose components are independent standard normal random variables, a k -vector μ , and a k×ℓ  matrix  A , such that . Here ℓ is the rank of the covariance matrix . Especially in the case of full rank, see the section below on Geometric interpretation .    There is a k -vector μ and a symmetric, nonnegative-definite  k×k matrix Σ , such that the characteristic function of x is          \varphi_\mathbf{x}(\mathbf{u}) = \exp\Big( i\mathbf{u}'\boldsymbol\mu - \tfrac{1}{2} \mathbf{u}'\boldsymbol\Sigma \mathbf{u} \Big).    The covariance matrix is allowed to be singular (in which case the corresponding distribution has no density). This case arises frequently in statistics ; for example, in the distribution of the vector of residuals in the ordinary least squares regression. Note also that the X i are in general not independent; they can be seen as the result of applying the matrix A to a collection of independent Gaussian variables z .  Properties  Density function  (Figure)  Bivariate normal joint density   Non-degenerate case  The multivariate normal distribution is said to be "non-degenerate" when the symmetric covariance matrix   𝚺   𝚺   \boldsymbol{\Sigma}   is positive definite . In this case the distribution has density 2         f  𝐱    (   x  1   ,  …  ,   x  k   )    =    1      (   2  π   )   k    |  𝚺  |       exp   (   -    1  2     (   𝐱  -  𝝁   )   T    𝚺   -  1     (   𝐱  -  𝝁   )     )      ,         subscript  f  𝐱     subscript  x  1   normal-…   subscript  x  k         1       superscript    2  π   k     𝚺              1  2    superscript    𝐱  𝝁   normal-T    superscript  𝚺    1      𝐱  𝝁         f_{\mathbf{x}}(x_{1},\ldots,x_{k})=\frac{1}{\sqrt{(2\pi)^{k}|\boldsymbol{%
 \Sigma}|}}\exp\left(-\frac{1}{2}({\mathbf{x}}-{\boldsymbol{\mu}})^{\mathrm{T}}%
 {\boldsymbol{\Sigma}}^{-1}({\mathbf{x}}-{\boldsymbol{\mu}})\right),     where   𝐱   𝐱   {\mathbf{x}}   is a real k -dimensional column vector and    |  𝚺  |      𝚺    |\boldsymbol{\Sigma}|   is the determinant of   𝚺   𝚺   \boldsymbol{\Sigma}   . Note how the equation above reduces to that of the univariate normal distribution if   𝚺   𝚺   \boldsymbol{\Sigma}   is a    1  ×  1      1  1    1\times 1   matrix (i.e. a single real number).  Note that the circularly-symmetric version of the complex normal distribution has a slightly different form.  Each iso-density locus—the locus of points in k -dimensional space each of which gives the same particular value of the density—is an ellipse or its higher-dimensional generalization; hence the multivariate normal is a special case of the elliptical distributions .  The descriptive statistic      (   𝐱  -  𝝁   )   T    𝚺   -  1     (   𝐱  -  𝝁   )        superscript    𝐱  𝝁   normal-T    superscript  𝚺    1      𝐱  𝝁     ({\mathbf{x}}-{\boldsymbol{\mu}})^{\mathrm{T}}{\boldsymbol{\Sigma}}^{-1}({%
 \mathbf{x}}-{\boldsymbol{\mu}})   in the non-degenerate multivariate normal distribution equation is known as the square of the Mahalanobis distance , which represents the distance of the test point   𝐱   𝐱   {\mathbf{x}}   from the mean   𝝁   𝝁   {\boldsymbol{\mu}}   . Note that in case when    k  =  1      k  1    k=1   , the distribution reduces to a univariate normal distribution and the Mahalanobis distance reduces to the standard score .   Bivariate case   In the 2-dimensional nonsingular case (), the probability density function of a vector  is:       f   (  x  ,  y  )        =     1   2  π   σ  X    σ  Y     1  -   ρ  2         exp   (   -     1   2   (   1  -   ρ  2    )       [        (   x  -   μ  X    )   2    σ  X  2     +      (   y  -   μ  Y    )   2    σ  Y  2      -     2  ρ   (   x  -   μ  X    )    (   y  -   μ  Y    )      σ  X    σ  Y       ]     )              =     1   2  π   σ  X    σ  Y     1  -   ρ  2         exp   (   -     1   2   (   1  -   ρ  2    )        [      x  -   μ  X     σ  X     -     y  -   μ  Y     σ  Y      ]   2     )      ,           f   x  y      absent      1    2  π   subscript  σ  X    subscript  σ  Y       1   superscript  ρ  2               1    2    1   superscript  ρ  2       delimited-[]         superscript    x   subscript  μ  X    2    superscript   subscript  σ  X   2       superscript    y   subscript  μ  Y    2    superscript   subscript  σ  Y   2         2  ρ    x   subscript  μ  X      y   subscript  μ  Y        subscript  σ  X    subscript  σ  Y               missing-subexpression     absent      1    2  π   subscript  σ  X    subscript  σ  Y       1   superscript  ρ  2               1    2    1   superscript  ρ  2       superscript   delimited-[]        x   subscript  μ  X     subscript  σ  X        y   subscript  μ  Y     subscript  σ  Y      2           \begin{aligned}\displaystyle f(x,y)&\displaystyle=\frac{1}{2\pi\sigma_{X}%
 \sigma_{Y}\sqrt{1-\rho^{2}}}\exp\left(-\frac{1}{2(1-\rho^{2})}\left[\frac{(x-%
 \mu_{X})^{2}}{\sigma_{X}^{2}}+\frac{(y-\mu_{Y})^{2}}{\sigma_{Y}^{2}}-\frac{2%
 \rho(x-\mu_{X})(y-\mu_{Y})}{\sigma_{X}\sigma_{Y}}\right]\right)\\
 &\displaystyle=\frac{1}{2\pi\sigma_{X}\sigma_{Y}\sqrt{1-\rho^{2}}}\exp\left(-%
 \frac{1}{2(1-\rho^{2})}\left[\frac{x-\mu_{X}}{\sigma_{X}}-\frac{y-\mu_{Y}}{%
 \sigma_{Y}}\right]^{2}\right),\\
 \end{aligned}     where ρ is the correlation between X and Y and where     σ  X   >  0       subscript  σ  X   0    \sigma_{X}>0   and     σ  Y   >  0       subscript  σ  Y   0    \sigma_{Y}>0   . In this case,        𝝁  =   (      μ  X        μ  Y      )    ,   𝚺  =   (      σ  X  2      ρ   σ  X    σ  Y         ρ   σ  X    σ  Y       σ  Y  2      )     .     formulae-sequence    𝝁     subscript  μ  X      subscript  μ  Y        𝚺     superscript   subscript  σ  X   2     ρ   subscript  σ  X    subscript  σ  Y        ρ   subscript  σ  X    subscript  σ  Y     superscript   subscript  σ  Y   2        \boldsymbol{\mu}=\begin{pmatrix}\mu_{X}\\
 \mu_{Y}\end{pmatrix},\quad\boldsymbol{\Sigma}=\begin{pmatrix}\sigma_{X}^{2}&%
 \rho\sigma_{X}\sigma_{Y}\\
 \rho\sigma_{X}\sigma_{Y}&\sigma_{Y}^{2}\end{pmatrix}.   In the bivariate case, the first equivalent condition for multivariate normality can be made less restrictive: it is sufficient to verify that countably many distinct linear combinations of X and Y are normal in order to conclude that the vector  is bivariate normal. 3  The bivariate iso-density loci plotted in the x,y -plane are ellipses. As the correlation parameter ρ increases, these loci appear to be squeezed to the following line :        y   (  x  )    =    sgn    (  ρ  )     σ  Y    σ  X     (   x  -   μ  X    )     +   μ  Y     .        y  x      sgn    ρ     subscript  σ  Y    subscript  σ  X      x   subscript  μ  X       subscript  μ  Y      y(x)=\mathop{\rm sgn}(\rho)\frac{\sigma_{Y}}{\sigma_{X}}(x-\mu_{X})+\mu_{Y}.     This is because the above expression - but without ρ being inside a signum function - is the best linear unbiased prediction of Y given a value of X . 4  Degenerate case  If the covariance matrix   𝚺   𝚺   \boldsymbol{\Sigma}   is not full rank, then the multivariate normal distribution is degenerate and does not have a density. More precisely, it does not have a density with respect to k -dimensional Lebesgue measure (which is the usual measure assumed in calculus-level probability courses). Only random vectors whose distributions are absolutely continuous with respect to a measure are said to have densities (with respect to that measure). To talk about densities but avoid dealing with measure-theoretic complications it can be simpler to restrict attention to a subset of    rank   (  𝚺  )      rank  𝚺    \operatorname{rank}(\boldsymbol{\Sigma})   of the coordinates of   𝐱   𝐱   \mathbf{x}   such that the covariance matrix for this subset is positive definite; then the other coordinates may be thought of as an affine function of the selected coordinates.  To talk about densities meaningfully in the singular case, then, we must select a different base measure. Using the disintegration theorem we can define a restriction of Lebesgue measure to the    rank   (  𝚺  )      rank  𝚺    \operatorname{rank}(\boldsymbol{\Sigma})   -dimensional affine subspace of    ℝ  k     superscript  ℝ  k    \mathbb{R}^{k}   where the Gaussian distribution is supported, i.e.    {   𝝁  +    𝚺   𝟏  /  𝟐    𝐯    :   𝐯  ∈   ℝ  k    }     conditional-set    𝝁     superscript  𝚺    1  2    𝐯      𝐯   superscript  ℝ  k      \{\boldsymbol{\mu}+\boldsymbol{\Sigma^{1/2}}\mathbf{v}:\mathbf{v}\in\mathbb{R}%
 ^{k}\}   . With respect to this measure the distribution has density:       f   (  𝐱  )    =      (    det  *    (   2  π  𝚺   )    )    -   1  2       e   -    1  2     (   𝐱  -  𝝁   )   ′    𝚺  +    (   𝐱  -  𝝁   )             f  𝐱      superscript    superscript       2  π  𝚺        1  2      superscript  e        1  2    superscript    𝐱  𝝁   normal-′    superscript  𝚺      𝐱  𝝁         f(\mathbf{x})=\left(\det^{*}(2\pi\boldsymbol{\Sigma})\right)^{-\frac{1}{2}}\,e%
 ^{-\frac{1}{2}(\mathbf{x}-\boldsymbol{\mu})^{\prime}\boldsymbol{\Sigma}^{+}(%
 \mathbf{x}-\boldsymbol{\mu})}     where    𝚺  +     superscript  𝚺     \boldsymbol{\Sigma}^{+}   is the generalized inverse and det* is the pseudo-determinant . 5  Higher moments  The k th-order moments of x are defined by        μ   1  ,  …  ,  N     (  𝐱  )      =  def      μ    r  1   ,  …  ,   r  N      (  𝐱  )      =  def     E   [    ∏   j  =  1   N    x  j   r  j     ]          superscript   def      subscript  μ   1  normal-…  N    𝐱      subscript  μ    subscript  r  1   normal-…   subscript  r  N     𝐱      superscript   def       E   delimited-[]    superscript   subscript  product    j  1    N    superscript   subscript  x  j    subscript  r  j          \mu_{1,\dots,N}(\mathbf{x})\ \stackrel{\mathrm{def}}{=}\ \mu_{r_{1},\dots,r_{N%
 }}(\mathbf{x})\ \stackrel{\mathrm{def}}{=}\ E\left[\prod\limits_{j=1}^{N}x_{j}%
 ^{r_{j}}\right]     where  k .}}  The central k -order central moments are given as follows  (a) If k is odd, 0}} .  (b) If k is even with , then        μ   1  ,  …  ,   2  λ      (   𝐱  -  𝝁   )    =   ∑   (    Σ   i  j     Σ   k  ℓ    ⋯   Σ   X  Z     )           subscript  μ   1  normal-…    2  λ       𝐱  𝝁         subscript  normal-Σ    i  j     subscript  normal-Σ    k  normal-ℓ    normal-⋯   subscript  normal-Σ    X  Z        \mu_{1,\dots,2\lambda}(\mathbf{x}-\boldsymbol{\mu})=\sum\left(\Sigma_{ij}%
 \Sigma_{k\ell}\cdots\Sigma_{XZ}\right)     where the sum is taken over all allocations of the set    {  1  ,  …  ,   2  λ   }     1  normal-…    2  λ     \left\{1,\dots,2\lambda\right\}   into λ (unordered) pairs. That is, if you have a k th () central moment, you will be summing the products of  covariances (the - μ notation has been dropped in the interests of parsimony):      E   [    x  1    x  2    x  3    x  4    x  5    x  6    ]       E   delimited-[]     subscript  x  1    subscript  x  2    subscript  x  3    subscript  x  4    subscript  x  5    subscript  x  6       \displaystyle{}E[x_{1}x_{2}x_{3}x_{4}x_{5}x_{6}]     This yields      (    2  λ   -  1   )   !   /   (    2   λ  -  1      (   λ  -  1   )   !    )             2  λ   1       superscript  2    λ  1        λ  1       (2\lambda-1)!/(2^{\lambda-1}(\lambda-1)!)   terms in the sum (15 in the above case), each being the product of λ (in this case 3) covariances. For fourth order moments (four variables) there are three terms. For sixth-order moments there are 3 × 5 = 15 terms, and for eighth-order moments there are 3 × 5 × 7 = 105 terms.  The covariances are then determined by replacing the terms of the list    [  1  ,  …  ,   2  λ   ]     1  normal-…    2  λ     \left[1,\dots,2\lambda\right]   by the corresponding terms of the list consisting of r 1 ones, then r 2 twos, etc.. To illustrate this, examine the following 4th-order central moment case:       E   [   x  i  4   ]    =   3   Σ   i  i   2          E   delimited-[]   superscript   subscript  x  i   4       3   superscript   subscript  normal-Σ    i  i    2      E\left[x_{i}^{4}\right]=3\Sigma_{ii}^{2}          E   [    x  i  3    x  j    ]    =   3   Σ   i  i     Σ   i  j           E   delimited-[]     superscript   subscript  x  i   3    subscript  x  j        3   subscript  normal-Σ    i  i     subscript  normal-Σ    i  j       E\left[x_{i}^{3}x_{j}\right]=3\Sigma_{ii}\Sigma_{ij}          E   [    x  i  2    x  j  2    ]    =     Σ   i  i     Σ   j  j     +   2    (   Σ   i  j    )   2           E   delimited-[]     superscript   subscript  x  i   2    superscript   subscript  x  j   2           subscript  normal-Σ    i  i     subscript  normal-Σ    j  j       2   superscript   subscript  normal-Σ    i  j    2       E\left[x_{i}^{2}x_{j}^{2}\right]=\Sigma_{ii}\Sigma_{jj}+2\left(\Sigma_{ij}%
 \right)^{2}          E   [    x  i  2    x  j    x  k    ]    =     Σ   i  i     Σ   j  k     +   2   Σ   i  j     Σ   i  k            E   delimited-[]     superscript   subscript  x  i   2    subscript  x  j    subscript  x  k           subscript  normal-Σ    i  i     subscript  normal-Σ    j  k       2   subscript  normal-Σ    i  j     subscript  normal-Σ    i  k        E\left[x_{i}^{2}x_{j}x_{k}\right]=\Sigma_{ii}\Sigma_{jk}+2\Sigma_{ij}\Sigma_{ik}           E   [    x  i    x  j    x  k    x  n    ]    =     Σ   i  j     Σ   k  n     +    Σ   i  k     Σ   j  n     +    Σ   i  n     Σ   j  k       .        E   delimited-[]     subscript  x  i    subscript  x  j    subscript  x  k    subscript  x  n           subscript  normal-Σ    i  j     subscript  normal-Σ    k  n        subscript  normal-Σ    i  k     subscript  normal-Σ    j  n        subscript  normal-Σ    i  n     subscript  normal-Σ    j  k        E\left[x_{i}x_{j}x_{k}x_{n}\right]=\Sigma_{ij}\Sigma_{kn}+\Sigma_{ik}\Sigma_{%
 jn}+\Sigma_{in}\Sigma_{jk}.     where    Σ   i  j      subscript  normal-Σ    i  j     \Sigma_{ij}   is the covariance of x i and x j . The idea with the above method is you first find the general case for a k th moment where you have k different x variables -    E   [    x  i    x  j    x  k    x  n    ]       E   delimited-[]     subscript  x  i    subscript  x  j    subscript  x  k    subscript  x  n       E\left[x_{i}x_{j}x_{k}x_{n}\right]   and then you can simplify this accordingly. Say, you have    E   [    x  i  2    x  k    x  n    ]       E   delimited-[]     superscript   subscript  x  i   2    subscript  x  k    subscript  x  n       E\left[x_{i}^{2}x_{k}x_{n}\right]   then you simply let  x j }} and realise that .  Likelihood function  If the mean and variance matrix are unknown, a suitable log likelihood function for a single observation x would be:       ln   (  L  )    =    -    1  2    ln   (   |  𝚺  |   )      -    1  2     (   𝐱  -  𝝁   )   T    𝚺   -  1     (   𝐱  -  𝝁   )    -    k  2    ln   (   2  π   )            L           1  2       𝚺          1  2    superscript    𝐱  𝝁   normal-T    superscript  𝚺    1      𝐱  𝝁        k  2       2  π        \ln(L)=-\frac{1}{2}\ln(|\boldsymbol{\Sigma}|\,)-\frac{1}{2}(\mathbf{x}-%
 \boldsymbol{\mu})^{\rm T}\boldsymbol{\Sigma}^{-1}(\mathbf{x}-\boldsymbol{\mu})%
 -\frac{k}{2}\ln(2\pi)     where x is a vector of real numbers. The circularly-symmetric version of the complex case, where z is a vector of complex numbers, would be       ln   (  L  )    =    -   ln   (   |  𝚺  |   )     -     (   𝐳  -  𝝁   )   †    𝚺   -  1     (   𝐳  -  𝝁   )    -   k   ln   (  π  )            L           𝚺        superscript    𝐳  𝝁   normal-†    superscript  𝚺    1      𝐳  𝝁      k    π       \ln(L)=-\ln(|\boldsymbol{\Sigma}|\,)-(\mathbf{z}-\boldsymbol{\mu})^{\dagger}%
 \boldsymbol{\Sigma}^{-1}(\mathbf{z}-\boldsymbol{\mu})-k\ln(\pi)     i.e. with the conjugate transpose (indicated by   †   normal-†   \dagger   ) replacing the normal transpose (indicated by     T     normal-T    {}^{\rm T}   ). This is slightly different than in the real case, because the circularly-symmetric version of the complex normal distribution has a slightly different form.  A similar notation is used for multiple linear regression . 6  Entropy  The differential entropy of the multivariate normal distribution is 7      h   (  f  )       h  f    \displaystyle h\left(f\right)   where the bars denote the matrix determinant .  Kullback–Leibler divergence  The Kullback–Leibler divergence from     𝒩  0    (   𝝁  0   ,   𝚺  0   )        subscript  𝒩  0     subscript  𝝁  0    subscript  𝚺  0      \mathcal{N}_{0}(\boldsymbol{\mu}_{0},\boldsymbol{\Sigma}_{0})   to     𝒩  1    (   𝝁  1   ,   𝚺  1   )        subscript  𝒩  1     subscript  𝝁  1    subscript  𝚺  1      \mathcal{N}_{1}(\boldsymbol{\mu}_{1},\boldsymbol{\Sigma}_{1})   , for non-singular matrices Σ 0 and Σ 1 , is: 8       D  KL    (   𝒩  0   ∥   𝒩  1   )   =   1  2    {  tr   (   𝚺  1   -  1     𝚺  0   )   +    (   𝝁  1   -   𝝁  0   )   T    𝚺  1   -  1     (   𝝁  1   -   𝝁  0   )   -  K  +  ln    |   𝚺  1   |    |   𝚺  0   |    }   ,     fragments   subscript  D  KL    fragments  normal-(   subscript  𝒩  0   parallel-to   subscript  𝒩  1   normal-)      1  2    fragments  normal-{  tr   fragments  normal-(   superscript   subscript  𝚺  1     1     subscript  𝚺  0   normal-)     superscript   fragments  normal-(   subscript  𝝁  1     subscript  𝝁  0   normal-)   normal-T    superscript   subscript  𝚺  1     1     fragments  normal-(   subscript  𝝁  1     subscript  𝝁  0   normal-)    K         subscript  𝚺  1       subscript  𝚺  0     normal-}   normal-,    D_{\text{KL}}(\mathcal{N}_{0}\|\mathcal{N}_{1})={1\over 2}\left\{\mathrm{tr}%
 \left(\boldsymbol{\Sigma}_{1}^{-1}\boldsymbol{\Sigma}_{0}\right)+\left(%
 \boldsymbol{\mu}_{1}-\boldsymbol{\mu}_{0}\right)^{\rm T}\boldsymbol{\Sigma}_{1%
 }^{-1}(\boldsymbol{\mu}_{1}-\boldsymbol{\mu}_{0})-K+\ln{|\boldsymbol{\Sigma}_{%
 1}|\over|\boldsymbol{\Sigma}_{0}|}\right\},   where   K   K   K   is the dimension of the vector space.  The logarithm must be taken to base e since the two terms following the logarithm are themselves base- e logarithms of expressions that are either factors of the density function or otherwise arise naturally. The equation therefore gives a result measured in nats . Dividing the entire expression above by log e 2 yields the divergence in bits .  Cumulative distribution function  The notion of cumulative distribution function (cdf) in dimension 1 can be extended in two ways to the multidimensional case. The first way is to define the cumulative distribution function    F   (  r  )       F  r    F(r)   as the probability that a sample falls inside the ellipsoid determined by its Mahalanobis distance    r   r   r   from the Gaussian, a direct generalization of the standard deviation . 9 In order to compute the values of this function, closed analytic formulae exist. 10  Another way to extend the notion of cumulative distribution function is to define the cumulative distribution function (cdf) F ( x 0 ) of a random vector x as the probability that all components of x are less than or equal to the corresponding values in the vector x 0 . Though there is no closed form for F ( x ), there are a number of algorithms that estimate it numerically. 11  Prediction Interval  The prediction interval for the multivariate normal distribution yields a region consisting of those vectors x satisfying          (   𝐱  -  𝝁   )   T    𝚺   -  1     (   𝐱  -  𝝁   )    ≤    χ  k  2    (  p  )     .         superscript    𝐱  𝝁   T    superscript  𝚺    1      𝐱  𝝁       subscript   superscript  χ  2   k   p     ({\mathbf{x}}-{\boldsymbol{\mu}})^{T}{\boldsymbol{\Sigma}}^{-1}({\mathbf{x}}-{%
 \boldsymbol{\mu}})\leq\chi^{2}_{k}(p).     Here   𝐱   𝐱   {\mathbf{x}}   is a   k   k   k   -dimensional vector,   𝝁   𝝁   {\boldsymbol{\mu}}   is the known   k   k   k   -dimensional mean vector,   𝚺   𝚺   \boldsymbol{\Sigma}   is the known covariance matrix and     χ  k  2    (  p  )        subscript   superscript  χ  2   k   p    \chi^{2}_{k}(p)   is the quantile function for probability   p   p   p   of the chi-squared distribution with   k   k   k   degrees of freedom. 12  When     k  =  2   ,      k  2    k=2,   the expression defines the interior of an ellipse and the chi-squared distribution simplifies to an exponential distribution with mean equal to two.  Joint normality  Normally distributed and independent  If X and Y are normally distributed and independent , this implies they are "jointly normally distributed", i.e., the pair ( X , Y ) must have multivariate normal distribution. However, a pair of jointly normally distributed variables need not be independent (would only be so if uncorrelated,    ρ  =  0      ρ  0    \rho=0   ).  Two normally distributed random variables need not be jointly bivariate normal  The fact that two random variables X and Y both have a normal distribution does not imply that the pair ( X , Y ) has a joint normal distribution. A simple example is one in which X has a normal distribution with expected value 0 and variance 1, and Y = X if | X | > c and Y = − X if | X |  0. There are similar counterexamples for more than two random variables. In general, they sum to a mixture model .  Correlations and independence  In general, random variables may be uncorrelated but statistically dependent. But if a random vector has a multivariate normal distribution then any two or more of its components that are uncorrelated are independent . This implies that any two or more of its components that are pairwise independent are independent.  But it is not true that two random variables that are (separately, marginally) normally distributed and uncorrelated are independent. Two random variables that are normally distributed may fail to be jointly normally distributed, i.e., the vector whose components they are may fail to have a multivariate normal distribution. In the preceding example, clearly X and Y are not independent, yet choosing c to be 1.54 makes them uncorrelated.  Conditional distributions  If N-dimensional x is partitioned as follows      𝐱  =    [      𝐱  1        𝐱  2      ]   with sizes   [      q  ×  1         (   N  -  q   )   ×  1      ]        𝐱       subscript  𝐱  1      subscript  𝐱  2     with sizes      q  1         N  q   1        \mathbf{x}=\begin{bmatrix}\mathbf{x}_{1}\\
 \mathbf{x}_{2}\end{bmatrix}\text{ with sizes }\begin{bmatrix}q\times 1\\
 (N-q)\times 1\end{bmatrix}     and accordingly μ and Σ are partitioned as follows      𝝁  =    [      𝝁  1        𝝁  2      ]   with sizes   [      q  ×  1         (   N  -  q   )   ×  1      ]        𝝁       subscript  𝝁  1      subscript  𝝁  2     with sizes      q  1         N  q   1        \boldsymbol{\mu}=\begin{bmatrix}\boldsymbol{\mu}_{1}\\
 \boldsymbol{\mu}_{2}\end{bmatrix}\text{ with sizes }\begin{bmatrix}q\times 1\\
 (N-q)\times 1\end{bmatrix}         𝚺  =    [      𝚺  11      𝚺  12        𝚺  21      𝚺  22      ]   with sizes   [      q  ×  q      q  ×   (   N  -  q   )          (   N  -  q   )   ×  q       (   N  -  q   )   ×   (   N  -  q   )       ]        𝚺       subscript  𝚺  11    subscript  𝚺  12      subscript  𝚺  21    subscript  𝚺  22     with sizes      q  q     q    N  q          N  q   q       N  q     N  q         \boldsymbol{\Sigma}=\begin{bmatrix}\boldsymbol{\Sigma}_{11}&\boldsymbol{\Sigma%
 }_{12}\\
 \boldsymbol{\Sigma}_{21}&\boldsymbol{\Sigma}_{22}\end{bmatrix}\text{ with %
 sizes }\begin{bmatrix}q\times q&q\times(N-q)\\
 (N-q)\times q&(N-q)\times(N-q)\end{bmatrix}     then, the distribution of x 1 conditional on x 2 = a is multivariate normal x 2 {{=}} a ) ~ N ( μ , Σ )}} where       𝝁  ¯   =    𝝁  1   +    𝚺  12    𝚺  22   -  1     (   𝐚  -   𝝁  2    )          normal-¯  𝝁      subscript  𝝁  1      subscript  𝚺  12    superscript   subscript  𝚺  22     1      𝐚   subscript  𝝁  2        \bar{\boldsymbol{\mu}}=\boldsymbol{\mu}_{1}+\boldsymbol{\Sigma}_{12}%
 \boldsymbol{\Sigma}_{22}^{-1}\left(\mathbf{a}-\boldsymbol{\mu}_{2}\right)     and covariance matrix        𝚺  ¯   =    𝚺  11   -    𝚺  12    𝚺  22   -  1     𝚺  21      .       normal-¯  𝚺      subscript  𝚺  11      subscript  𝚺  12    superscript   subscript  𝚺  22     1     subscript  𝚺  21       \overline{\boldsymbol{\Sigma}}=\boldsymbol{\Sigma}_{11}-\boldsymbol{\Sigma}_{1%
 2}\boldsymbol{\Sigma}_{22}^{-1}\boldsymbol{\Sigma}_{21}.    13  This matrix is the Schur complement of Σ 22 in Σ . This means that to calculate the conditional covariance matrix, one inverts the overall covariance matrix, drops the rows and columns corresponding to the variables being conditioned upon, and then inverts back to get the conditional covariance matrix. Here    𝚺  22   -  1      superscript   subscript  𝚺  22     1     \boldsymbol{\Sigma}_{22}^{-1}   is the generalized inverse of    𝚺  22     subscript  𝚺  22    \boldsymbol{\Sigma}_{22}   .  Note that knowing that  a }} alters the variance, though the new variance does not depend on the specific value of a ; perhaps more surprisingly, the mean is shifted by     𝚺  12    𝚺  22   -  1     (   𝐚  -   𝝁  2    )        subscript  𝚺  12    superscript   subscript  𝚺  22     1      𝐚   subscript  𝝁  2      \boldsymbol{\Sigma}_{12}\boldsymbol{\Sigma}_{22}^{-1}\left(\mathbf{a}-%
 \boldsymbol{\mu}_{2}\right)   ; compare this with the situation of not knowing the value of a , in which case x 1 would have distribution     𝒩  q    (   𝝁  1   ,   𝚺  11   )        subscript  𝒩  q     subscript  𝝁  1    subscript  𝚺  11      \mathcal{N}_{q}\left(\boldsymbol{\mu}_{1},\boldsymbol{\Sigma}_{11}\right)   .  An interesting fact derived in order to prove this result, is that the random vectors    𝐱  2     subscript  𝐱  2    \mathbf{x}_{2}   and     𝐲  1   =    𝐱  1   -    𝚺  12    𝚺  22   -  1     𝐱  2          subscript  𝐲  1      subscript  𝐱  1      subscript  𝚺  12    superscript   subscript  𝚺  22     1     subscript  𝐱  2       \mathbf{y}_{1}=\mathbf{x}_{1}-\boldsymbol{\Sigma}_{12}\boldsymbol{\Sigma}_{22}%
 ^{-1}\mathbf{x}_{2}   are independent.  The matrix Σ 12 Σ 22 −1 is known as the matrix of regression coefficients.  Bivariate case  In the bivariate case where x is partitioned into X 1 and X 2 , the conditional distribution of X 1 given X 2 is 14       X  1   |   X  2   =    x  2    ∼  𝒩   (   μ  1   +    σ  1    σ  2    ρ   (   x  2   -   μ  2   )   ,   (  1  -   ρ  2   )    σ  1  2   )   .     fragments   subscript  X  1   normal-|   subscript  X  2     subscript  x  2   similar-to  N   fragments  normal-(   subscript  μ  1       subscript  σ  1    subscript  σ  2    ρ   fragments  normal-(   subscript  x  2     subscript  μ  2   normal-)   normal-,   fragments  normal-(  1    superscript  ρ  2   normal-)    superscript   subscript  σ  1   2   normal-)   normal-.    X_{1}|X_{2}=x_{2}\ \sim\ \mathcal{N}\left(\mu_{1}+\frac{\sigma_{1}}{\sigma_{2}%
 }\rho(x_{2}-\mu_{2}),\,(1-\rho^{2})\sigma_{1}^{2}\right).     where   ρ   ρ   \rho   is the correlation coefficient between X 1 and X 2 .  Bivariate conditional expectation  In the general case       (      X  1        X  2      )   ∼   𝒩   (   (      μ  1        μ  2      )   ,   (      σ  1  2      ρ   σ  1    σ  2         ρ   σ  1    σ  2       σ  2  2      )   )       similar-to     subscript  X  1      subscript  X  2       𝒩      subscript  μ  1      subscript  μ  2        subscript   superscript  σ  2   1     ρ   subscript  σ  1    subscript  σ  2        ρ   subscript  σ  1    subscript  σ  2     subscript   superscript  σ  2   2         \begin{pmatrix}X_{1}\\
 X_{2}\end{pmatrix}\sim\mathcal{N}\left(\begin{pmatrix}\mu_{1}\\
 \mu_{2}\end{pmatrix},\begin{pmatrix}\sigma^{2}_{1}&\rho\sigma_{1}\sigma_{2}\\
 \rho\sigma_{1}\sigma_{2}&\sigma^{2}_{2}\end{pmatrix}\right)     The conditional expectation of X 1 given X 2 is:       E   (   X  1   |    X  2   =   x  2    )    =    μ  1   +   ρ    σ  1    σ  2     (    x  2   -   μ  2    )          normal-E   subscript  X  1      subscript  X  2    subscript  x  2        subscript  μ  1     ρ     subscript  σ  1    subscript  σ  2       subscript  x  2    subscript  μ  2        \operatorname{E}(X_{1}|X_{2}=x_{2})=\mu_{1}+\rho\frac{\sigma_{1}}{\sigma_{2}}(%
 x_{2}-\mu_{2})     Proof: the result is simply obtained taking the expectation of the conditional distribution     X  1   |   X  2      fragments   subscript  X  1   normal-|   subscript  X  2     X_{1}|X_{2}   above.  In the case of unit variances       (      X  1        X  2      )   ∼   𝒩   (   (     0      0     )   ,   (     1    ρ      ρ    1     )   )       similar-to     subscript  X  1      subscript  X  2       𝒩     0    0      1  ρ    ρ  1        \begin{pmatrix}X_{1}\\
 X_{2}\end{pmatrix}\sim\mathcal{N}\left(\begin{pmatrix}0\\
 0\end{pmatrix},\begin{pmatrix}1&\rho\\
 \rho&1\end{pmatrix}\right)     The conditional expectation of X 1 given X 2 is:       E   (   X  1   ∣    X  2   =   x  2    )    =   ρ   x  2         normal-E   subscript  X  1      subscript  X  2    subscript  x  2       ρ   subscript  x  2      \operatorname{E}(X_{1}\mid X_{2}=x_{2})=\rho x_{2}     and the conditional expectation of X 1 given that X 2 is smaller/bigger than z is (Maddala 1983, p. 367 15 ) :        E   (   X  1   ∣    X  2   <  z   )    =   -   ρ    ϕ   (  z  )     Φ   (  z  )        ,       normal-E   subscript  X  1      subscript  X  2   z        ρ      ϕ  z     normal-Φ  z        \operatorname{E}(X_{1}\mid X_{2}           E   (    X  1    ∣   X  2   >   z   )    =   ρ    ϕ   (  z  )     (   1  -   Φ   (  z  )     )      ,       normal-E     subscript  X  1    ket   subscript  X  2    z      ρ      ϕ  z     1    normal-Φ  z        \operatorname{E}(X_{1}\mid X_{2}>z)=\rho{\phi(z)\over(1-\Phi(z))},     where the final ratio here is called the inverse Mills ratio .  Proof: the last two results are obtained using the result     E   (   X  1   ∣    X  2   =   x  2    )    =   ρ   x  2         normal-E   subscript  X  1      subscript  X  2    subscript  x  2       ρ   subscript  x  2      \operatorname{E}(X_{1}\mid X_{2}=x_{2})=\rho x_{2}   , so that      E   (   X  1   ∣   X  2   <  z  )   =  ρ  E   (   X  2   ∣   X  2   <  z  )      fragments  normal-E   fragments  normal-(   subscript  X  1   normal-∣   subscript  X  2    z  normal-)    ρ  E   fragments  normal-(   subscript  X  2   normal-∣   subscript  X  2    z  normal-)     \operatorname{E}(X_{1}\mid X_{2}   and then using the properties of the expectation of a truncated normal distribution .  Marginal distributions  To obtain the marginal distribution over a subset of multivariate normal random variables, one only needs to drop the irrelevant variables (the variables that one wants to marginalize out) from the mean vector and the covariance matrix. The proof for this follows from the definitions of multivariate normal distributions and linear algebra. 16  Example  Let [ X 1 , X 2 , X 3 ]}} be multivariate normal random variables with mean vector [ μ 1 , μ 2 , μ 3 ]}} and covariance matrix Σ (standard parametrization for multivariate normal distributions). Then the joint distribution of [ X 1 , X 3 ]}} is multivariate normal with mean vector [ μ 1 , μ 3 ]}} and covariance matrix     𝚺  ′   =   [      𝚺  11      𝚺  13        𝚺  31      𝚺  33      ]        superscript  𝚺  normal-′      subscript  𝚺  11    subscript  𝚺  13      subscript  𝚺  31    subscript  𝚺  33       \boldsymbol{\Sigma}^{\prime}=\begin{bmatrix}\boldsymbol{\Sigma}_{11}&%
 \boldsymbol{\Sigma}_{13}\\
 \boldsymbol{\Sigma}_{31}&\boldsymbol{\Sigma}_{33}\end{bmatrix}   .  Affine transformation  If  is an affine transformation of      𝐱   ∼   𝒩   (  𝝁  ,  𝚺  )     ,     similar-to  𝐱    𝒩   𝝁  𝚺      \mathbf{x}\ \sim\mathcal{N}(\boldsymbol{\mu},\boldsymbol{\Sigma}),   where c is an    M  ×  1      M  1    M\times 1   vector of constants and B is a constant    M  ×  N      M  N    M\times N   matrix, then y has a multivariate normal distribution with expected value  and variance BΣB T i.e.,    𝐲  ∼   𝒩   (   𝐜  +   𝐁  𝝁    ,   𝐁  𝚺   𝐁  T    )       similar-to  𝐲    𝒩     𝐜    𝐁  𝝁      𝐁  𝚺   superscript  𝐁  normal-T        \mathbf{y}\sim\mathcal{N}\left(\mathbf{c}+\mathbf{B}\boldsymbol{\mu},\mathbf{B%
 }\boldsymbol{\Sigma}\mathbf{B}^{\rm T}\right)   . In particular, any subset of the x i has a marginal distribution that is also multivariate normal. To see this, consider the following example: to extract the subset ( x 1 , x 2 , x 4 ) T , use      𝐁  =   [     1    0    0    0    0    …    0      0    1    0    0    0    …    0      0    0    0    1    0    …    0     ]       𝐁    1  0  0  0  0  normal-…  0    0  1  0  0  0  normal-…  0    0  0  0  1  0  normal-…  0      \mathbf{B}=\begin{bmatrix}1&0&0&0&0&\ldots&0\\
 0&1&0&0&0&\ldots&0\\
 0&0&0&1&0&\ldots&0\end{bmatrix}     which extracts the desired elements directly.  Another corollary is that the distribution of , where b is a constant vector of the same length as x and the dot indicates a vector product, is univariate Gaussian with    Z  ∼   𝒩   (   𝐛  ⋅  𝝁   ,    𝐛  T   𝚺  𝐛   )       similar-to  Z    𝒩    normal-⋅  𝐛  𝝁      superscript  𝐛  normal-T   𝚺  𝐛       Z\sim\mathcal{N}\left(\mathbf{b}\cdot\boldsymbol{\mu},\mathbf{b}^{\rm T}%
 \boldsymbol{\Sigma}\mathbf{b}\right)   . This result follows by using       𝐁  =   [      b  1      b  2     …     b  n      ]   =   𝐛  T    .        𝐁     subscript  b  1    subscript  b  2   normal-…   subscript  b  n           superscript  𝐛  normal-T      \mathbf{B}=\begin{bmatrix}b_{1}&b_{2}&\ldots&b_{n}\end{bmatrix}=\mathbf{b}^{%
 \rm T}.   Observe how the positive-definiteness of Σ implies that the variance of the dot product must be positive.  An affine transformation of x such as 2 x is not the same as the sum of two independent realisations of x .  Geometric interpretation  The equidensity contours of a non-singular multivariate normal distribution are ellipsoids (i.e. linear transformations of hyperspheres ) centered at the mean. 17 Hence the multivariate normal distribution is an example of the class of elliptical distributions . The directions of the principal axes of the ellipsoids are given by the eigenvectors of the covariance matrix Σ . The squared relative lengths of the principal axes are given by the corresponding eigenvalues.  If  UΛU T {{=}} UΛ 1/2 ( UΛ 1/2 ) T }} is an eigendecomposition where the columns of U are unit eigenvectors and Λ is a diagonal matrix of the eigenvalues, then we have           𝐱   ∼   𝒩   (  𝝁  ,  𝚺  )     ⇔    𝐱   ∼   𝝁  +   𝐔   𝚲   1  /  2    𝒩   (  0  ,  𝐈  )      ⇔    𝐱   ∼   𝝁  +   𝐔  𝒩   (  0  ,  𝚲  )       .       iff   similar-to  𝐱    𝒩   𝝁  𝚺      similar-to  𝐱    𝝁    𝐔   superscript  𝚲    1  2    𝒩   0  𝐈        iff     similar-to  𝐱    𝝁    𝐔  𝒩   0  𝚲         \mathbf{x}\ \sim\mathcal{N}(\boldsymbol{\mu},\boldsymbol{\Sigma})\iff\mathbf{x%
 }\ \sim\boldsymbol{\mu}+\mathbf{U}\boldsymbol{\Lambda}^{1/2}\mathcal{N}(0,%
 \mathbf{I})\iff\mathbf{x}\ \sim\boldsymbol{\mu}+\mathbf{U}\mathcal{N}(0,%
 \boldsymbol{\Lambda}).        Moreover, U can be chosen to be a rotation matrix , as inverting an axis does not have any effect on N (0, Λ ), but inverting a column changes the sign of U 's determinant. The distribution N ( μ , Σ ) is in effect N (0, I ) scaled by Λ 1/2 , rotated by U and translated by μ .  Conversely, any choice of μ , full rank matrix U , and positive diagonal entries Λ i yields a non-singular multivariate normal distribution. If any Λ i is zero and U is square, the resulting covariance matrix UΛU T is singular . Geometrically this means that every contour ellipsoid is infinitely thin and has zero volume in n -dimensional space, as at least one of the principal axes has length of zero.  Estimation of parameters  The derivation of the maximum-likelihood  estimator of the covariance matrix of a multivariate normal distribution is perhaps surprisingly subtle and elegant. See estimation of covariance matrices .  In short, the probability density function (pdf) of a multivariate normal is       f   (  𝐱  )    =    1      (   2  π   )   k    |  𝚺  |       exp   (   -    1  2     (   𝐱  -  𝝁   )   T    𝚺   -  1     (   𝐱  -  𝝁   )     )           f  𝐱       1       superscript    2  π   k     𝚺              1  2    superscript    𝐱  𝝁   normal-T    superscript  𝚺    1      𝐱  𝝁         f(\mathbf{x})=\frac{1}{\sqrt{(2\pi)^{k}|\boldsymbol{\Sigma}|}}\exp\left(-{1%
 \over 2}(\mathbf{x}-\boldsymbol{\mu})^{\rm T}\boldsymbol{\Sigma}^{-1}({\mathbf%
 {x}}-\boldsymbol{\mu})\right)     and the ML estimator of the covariance matrix from a sample of n observations is       𝚺  ^   =    1  n     ∑   i  =  1   n     (    𝐱  i   -   𝐱  ¯    )     (    𝐱  i   -   𝐱  ¯    )   T           normal-^  𝚺       1  n     superscript   subscript     i  1    n        subscript  𝐱  i    normal-¯  𝐱     superscript     subscript  𝐱  i    normal-¯  𝐱    T        \widehat{\boldsymbol{\Sigma}}={1\over n}\sum_{i=1}^{n}({\mathbf{x}}_{i}-%
 \overline{\mathbf{x}})({\mathbf{x}}_{i}-\overline{\mathbf{x}})^{T}     which is simply the sample covariance matrix . This is a biased estimator whose expectation is        E   [   𝚺  ^   ]    =     n  -  1   n   𝚺    .        E   delimited-[]   normal-^  𝚺           n  1   n   𝚺     E[\widehat{\boldsymbol{\Sigma}}]=\frac{n-1}{n}\boldsymbol{\Sigma}.     An unbiased sample covariance is        𝚺  ^   =    1   n  -  1      ∑   i  =  1   n     (    𝐱  i   -   𝐱  ¯    )     (    𝐱  i   -   𝐱  ¯    )   T       .       normal-^  𝚺       1    n  1      superscript   subscript     i  1    n        subscript  𝐱  i    normal-¯  𝐱     superscript     subscript  𝐱  i    normal-¯  𝐱    normal-T        \widehat{\boldsymbol{\Sigma}}={1\over n-1}\sum_{i=1}^{n}(\mathbf{x}_{i}-%
 \overline{\mathbf{x}})(\mathbf{x}_{i}-\overline{\mathbf{x}})^{\rm T}.     The Fisher information matrix for estimating the parameters of a multivariate normal distribution has a closed form expression. This can be used, for example, to compute the Cramér–Rao bound for parameter estimation in this setting. See Fisher information for more details.  Bayesian inference  In Bayesian statistics , the conjugate prior of the mean vector is another multivariate normal distribution, and the conjugate prior of the covariance matrix is an inverse-Wishart distribution     𝒲   -  1      superscript  𝒲    1     \mathcal{W}^{-1}   . Suppose then that n observations have been made      𝐗  =   {   𝐱  1   ,  …  ,   𝐱  n   }   ∼   𝒩   (  𝝁  ,  𝚺  )          𝐗    subscript  𝐱  1   normal-…   subscript  𝐱  n      similar-to      𝒩   𝝁  𝚺       \mathbf{X}=\{\mathbf{x}_{1},\dots,\mathbf{x}_{n}\}\sim\mathcal{N}(\boldsymbol{%
 \mu},\boldsymbol{\Sigma})   and that a conjugate prior has been assigned, where      p   (  𝝁  ,  𝚺  )   =  p   (  𝝁  ∣  𝚺  )   p   (  𝚺  )   ,     fragments  p   fragments  normal-(  μ  normal-,  Σ  normal-)    p   fragments  normal-(  μ  normal-∣  Σ  normal-)   p   fragments  normal-(  Σ  normal-)   normal-,    p(\boldsymbol{\mu},\boldsymbol{\Sigma})=p(\boldsymbol{\mu}\mid\boldsymbol{%
 \Sigma})\ p(\boldsymbol{\Sigma}),   where      p   (  𝝁  ∣  𝚺  )   ∼  𝒩   (   𝝁  0   ,   m   -  1    𝚺  )   ,     fragments  p   fragments  normal-(  μ  normal-∣  Σ  normal-)   similar-to  N   fragments  normal-(   subscript  𝝁  0   normal-,   superscript  m    1    Σ  normal-)   normal-,    p(\boldsymbol{\mu}\mid\boldsymbol{\Sigma})\sim\mathcal{N}(\boldsymbol{\mu}_{0}%
 ,m^{-1}\boldsymbol{\Sigma}),   and        p   (  𝚺  )    ∼    𝒲   -  1     (  𝚿  ,   n  0   )     .     similar-to    p  𝚺      superscript  𝒲    1     𝚿   subscript  n  0       p(\boldsymbol{\Sigma})\sim\mathcal{W}^{-1}(\boldsymbol{\Psi},n_{0}).     Then,         p   (  𝝁  ∣  𝚺  ,  𝐗  )      ∼      𝒩   (     n   𝐱  ¯    +   m   𝝁  0      n  +  m    ,    1   n  +  m    𝚺   )    ,        p   (  𝚺  ∣  𝐗  )      ∼       𝒲   -  1     (   𝚿  +   n  𝐒   +     n  m    n  +  m     (    𝐱  ¯   -   𝝁  0    )     (    𝐱  ¯   -   𝝁  0    )   ′     ,   n  +   n  0    )    ,          fragments  p   fragments  normal-(  μ  normal-∣  Σ  normal-,  X  normal-)    similar-to    𝒩         n   normal-¯  𝐱      m   subscript  𝝁  0       n  m        1    n  m    𝚺        fragments  p   fragments  normal-(  Σ  normal-∣  X  normal-)    similar-to     superscript  𝒲    1       𝚿    n  𝐒         n  m     n  m       normal-¯  𝐱    subscript  𝝁  0     superscript     normal-¯  𝐱    subscript  𝝁  0    normal-′       n   subscript  n  0         \begin{array}[]{rcl}p(\boldsymbol{\mu}\mid\boldsymbol{\Sigma},\mathbf{X})&\sim%
 &\mathcal{N}\left(\frac{n\bar{\mathbf{x}}+m\boldsymbol{\mu}_{0}}{n+m},\frac{1}%
 {n+m}\boldsymbol{\Sigma}\right),\\
 p(\boldsymbol{\Sigma}\mid\mathbf{X})&\sim&\mathcal{W}^{-1}\left(\boldsymbol{%
 \Psi}+n\mathbf{S}+\frac{nm}{n+m}(\bar{\mathbf{x}}-\boldsymbol{\mu}_{0})(\bar{%
 \mathbf{x}}-\boldsymbol{\mu}_{0})^{\prime},n+n_{0}\right),\end{array}   where         𝐱  ¯     =       n   -  1      ∑   i  =  1   n    𝐱  i     ,       𝐒    =       n   -  1      ∑   i  =  1   n     (    𝐱  i   -   𝐱  ¯    )     (    𝐱  i   -   𝐱  ¯    )   ′      .          normal-¯  𝐱       superscript  n    1      superscript   subscript     i  1    n    subscript  𝐱  i       𝐒      superscript  n    1      superscript   subscript     i  1    n        subscript  𝐱  i    normal-¯  𝐱     superscript     subscript  𝐱  i    normal-¯  𝐱    normal-′         \begin{array}[]{rcl}\bar{\mathbf{x}}&=&n^{-1}\sum_{i=1}^{n}\mathbf{x}_{i},\\
 \mathbf{S}&=&n^{-1}\sum_{i=1}^{n}(\mathbf{x}_{i}-\bar{\mathbf{x}})(\mathbf{x}_%
 {i}-\bar{\mathbf{x}})^{\prime}.\end{array}     Multivariate normality tests  Multivariate normality tests check a given set of data for similarity to the multivariate normal distribution . The null hypothesis is that the data set is similar to the normal distribution, therefore a sufficiently small p -value indicates non-normal data. Multivariate normality tests include the Cox-Small test 18 and Smith and Jain's adaptation 19 of the Friedman-Rafsky test. 20  Mardia's test 21 is based on multivariate extensions of skewness and kurtosis measures. For a sample { x 1 , ..., x n } of k -dimensional vectors we compute       𝚺  ^   =     1  n       ∑   j  =  1   n      (    𝐱  j   -   𝐱  ¯    )     (    𝐱  j   -   𝐱  ¯    )   T           normal-^  𝚺       1  n     superscript   subscript     j  1    n        subscript  𝐱  j    normal-¯  𝐱     superscript     subscript  𝐱  j    normal-¯  𝐱    T        \displaystyle\widehat{\boldsymbol{\Sigma}}={1\over n}\sum_{j=1}^{n}\left(%
 \mathbf{x}_{j}-\bar{\mathbf{x}}\right)\left(\mathbf{x}_{j}-\bar{\mathbf{x}}%
 \right)^{T}   Under the null hypothesis of multivariate normality, the statistic A will have approximately a chi-squared distribution with  degrees of freedom, and B will be approximately standard normal  N (0,1).  Mardia's kurtosis statistic is skewed and converges very slowly to the limiting normal distribution. For medium size samples    (   50  ≤  n  <  400   )        50  n       400     (50\leq n<400)   , the parameters of the asymptotic distribution of the kurtosis statistic are modified 22 For small sample tests (    n  <  50      n  50    n<50   ) empirical critical values are used. Tables of critical values for both statistics are given by Rencher 23 for k =2,3,4.  Mardia's tests are affine invariant but not consistent. For example, the multivariate skewness test is not consistent against symmetric non-normal alternatives. 24  The BHEP test 25 computes the norm of the difference between the empirical characteristic function and the theoretical characteristic function of the normal distribution. Calculation of the norm is performed in the L 2 ( μ ) space of square-integrable functions with respect to the Gaussian weighting function      μ  β    (  𝐭  )    =     (   2  π   β  2    )    -   k  /  2      e   -     |  𝐭  |   2   /   (   2   β  2    )              subscript  μ  β   𝐭      superscript    2  π   superscript  β  2        k  2      superscript  e       superscript    𝐭   2     2   superscript  β  2          \scriptstyle\mu_{\beta}(\mathbf{t})=(2\pi\beta^{2})^{-k/2}e^{-|\mathbf{t}|^{2}%
 /(2\beta^{2})}   . The test statistic is      T  β     subscript  T  β    \displaystyle T_{\beta}   The limiting distribution of this test statistic is a weighted sum of chi-squared random variables, 26 however in practice it is more convenient to compute the sample quantiles using the Monte-Carlo simulations.  A detailed survey of these and other test procedures is available. 27  Drawing values from the distribution  A widely used method for drawing (sampling) a random vector x from the N -dimensional multivariate normal distribution with mean vector μ and covariance matrix  Σ works as follows: 28   Find any real matrix A such that  Σ }} . When Σ is positive-definite, the Cholesky decomposition is typically used, and the extended form of this decomposition can always be used (as the covariance matrix may be only positive semi-definite) in both cases a suitable matrix A is obtained. An alternative is to use the matrix A = UΛ ½ obtained from a spectral decomposition  Σ = UΛU T of Σ . The former approach is more computationally straightforward but the matrices A change for different orderings of the elements of the random vector, while the latter approach gives matrices that are related by simple re-orderings. In theory both approaches give equally good ways of determining a suitable matrix A , but there are differences in computation time.  Let ( z 1 , …, z N ) T }} be a vector whose components are N  independent  standard normal variates (which can be generated, for example, by using the Box–Muller transform ).  Let x be . This has the desired distribution due to the affine transformation property.   See also   Chi distribution , the pdf of the 2-norm (or Euclidean norm ) of a multivariate normally distributed vector (centered at zero).  Complex normal distribution , for the generalization to complex valued random variables.  Copula , for the definition of the Gaussian or normal copula model.  Multivariate stable distribution extension of the multivariate normal distribution, when the index (exponent in the characteristic function) is between zero to two.  Mahalanobis distance  Wishart distribution   References  Literature     "  Category:Continuous distributions  Category:Multivariate continuous distributions  Category:Normal distribution  Category:Exponential family distributions  Category:Stable distributions  Category:Probability distributions     Gut, Allan (2009) An Intermediate Course in Probability , Springer. ISBN 9781441901613 (Chapter 5) ↩  UIUC, Lecture 21. The Multivariate Normal Distribution , 21.5:"Finding the Density". ↩     Tong, T. (2010) Multiple Linear Regression : MLE and Its Distributional Results , Lecture Notes ↩  ↩  J. Duchi, Derivations for Linear Algebra and Optimization 1 . pp. 13 ↩  Bensimhoun Michael, N-Dimensional Cumulative Function, And Other Useful Facts About Gaussians and Normal Densities (2006) ↩   ↩   ↩  ↩  ↩  The formal proof for marginal distribution is shown here http://fourier.eng.hmc.edu/e161/lectures/gaussianprocess/node7.html ↩  ↩  ↩  ↩  ↩   Rencher (1995), pages 112-113. ↩  Rencher (1995), pages 493-495. ↩  ↩         
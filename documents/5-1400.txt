   Matrix calculus      Matrix calculus   In mathematics , matrix calculus is a specialized notation for doing multivariable calculus , especially over spaces of matrices . It collects the various partial derivatives of a single function with respect to many variables, and/or of a multivariate function with respect to a single variable, into vectors and matrices that can be treated as single entities. This greatly simplifies operations such as finding the maximum or minimum of a multivariate function and solving systems of differential equations . The notation used here is commonly used in statistics and engineering , while the tensor index notation is preferred in physics .  Two competing notational conventions split the field of matrix calculus into two separate groups. The two groups can be distinguished by whether they write the derivative of a scalar with respect to a vector as a column vector or a row vector. Both of these conventions are possible even when the common assumption is made that vectors should be treated as column vectors when combined with matrices (rather than row vectors ). A single convention can be somewhat standard throughout a single field that commonly use matrix calculus (e.g. econometrics , statistics , estimation theory and machine learning ). However, even within a given field different authors can be found using competing conventions. Authors of both groups often write as though their specific convention is standard. Serious mistakes can result when combining results from different authors without carefully verifying that compatible notations are used. Therefore great care should be taken to ensure notational consistency. Definitions of these two conventions and comparisons between them are collected in the layout conventions section.  Scope  Matrix calculus refers to a number of different notations that use matrices and vectors to collect the derivative of each component of the dependent variable with respect to each component of the independent variable. In general, the independent variable can be a scalar, a vector, or a matrix while the dependent variable can be any of these as well. Each different situation will lead to a different set of rules, or a separate calculus , using the broader sense of the term. Matrix notation serves as a convenient way to collect the many derivatives in an organized way.  As a first example, consider the gradient from vector calculus . For a scalar function of three independent variables,    f   (   x  1   ,   x  2   ,   x  3   )       f    subscript  x  1    subscript  x  2    subscript  x  3      f(x_{1},x_{2},x_{3})   , the gradient is given by the vector equation       ‚àá  f   =      ‚àÇ  f    ‚àÇ   x  1       x  1   ^    +     ‚àÇ  f    ‚àÇ   x  2       x  2   ^    +     ‚àÇ  f    ‚àÇ   x  3       x  3   ^          normal-‚àá  f           f      subscript  x  1      normal-^   subscript  x  1           f      subscript  x  2      normal-^   subscript  x  2           f      subscript  x  3      normal-^   subscript  x  3        \nabla f=\frac{\partial f}{\partial x_{1}}\hat{x_{1}}+\frac{\partial f}{%
 \partial x_{2}}\hat{x_{2}}+\frac{\partial f}{\partial x_{3}}\hat{x_{3}}   , where     x  i   ^     normal-^   subscript  x  i     \hat{x_{i}}   represents a unit vector in the    x  i     subscript  x  i    x_{i}   direction for    1  ‚â§  i  ‚â§  3        1  i       3     1\leq i\leq 3   . This type of generalized derivative can be seen as the derivative of a scalar, f , with respect to a vector,   ùê±   ùê±   \mathbf{x}   and its result can be easily collected in vector form.        ‚àá  f   =    ‚àÇ  f    ‚àÇ  ùê±    =   [        ‚àÇ  f    ‚àÇ   x  1           ‚àÇ  f    ‚àÇ   x  2           ‚àÇ  f    ‚àÇ   x  3         ]    .         normal-‚àá  f       f     ùê±               f      subscript  x  1         f      subscript  x  2         f      subscript  x  3          \nabla f=\frac{\partial f}{\partial\mathbf{x}}=\begin{bmatrix}\frac{\partial f%
 }{\partial x_{1}}&\frac{\partial f}{\partial x_{2}}&\frac{\partial f}{\partial
 x%
 _{3}}\\
 \end{bmatrix}.   More complicated examples include the derivative of a scalar function with respect to a matrix, known as the gradient matrix , which collects the derivative with respect to each matrix element in the corresponding position in the resulting matrix. In that case the scalar must be a function of each of the independent variables in the matrix. As another example, if we have an n -vector of dependent variables, or functions, of m independent variables we might consider the derivative of the dependent vector with respect to the independent vector. The result could be collected in an m√ón matrix consisting of all of the possible derivative combinations. There are, of course, a total of nine possibilities using scalars, vectors, and matrices. Notice that as we consider higher numbers of components in each of the independent and dependent variables we can be left with a very large number of possibilities.  The six kinds of derivatives that can be most neatly organized in matrix form are collected in the following table. 1      Types of Matrix Derivatives   Types   Scalar   Vector   Matrix     Scalar        ‚àÇ  y    ‚àÇ  x         y     x     \frac{\partial y}{\partial x}           ‚àÇ  ùê≤    ‚àÇ  x         ùê≤     x     \frac{\partial\mathbf{y}}{\partial x}           ‚àÇ  ùêò    ‚àÇ  x         ùêò     x     \frac{\partial\mathbf{Y}}{\partial x}        Vector        ‚àÇ  y    ‚àÇ  ùê±         y     ùê±     \frac{\partial y}{\partial\mathbf{x}}           ‚àÇ  ùê≤    ‚àÇ  ùê±         ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}}         Matrix        ‚àÇ  y    ‚àÇ  ùêó         y     ùêó     \frac{\partial y}{\partial\mathbf{X}}          Here, we have used the term "matrix" in its most general sense, recognizing that vectors and scalars are simply matrices with one column and then one row respectively. Moreover, we have used bold letters to indicate vectors and bold capital letters for matrices. This notation is used throughout.  Notice that we could also talk about the derivative of a vector with respect to a matrix, or any of the other unfilled cells in our table. However, these derivatives are most naturally organized in a tensor of rank higher than 2, so that they do not fit neatly into a matrix. In the following three sections we will define each one of these derivatives and relate them to other branches of mathematics. See the layout conventions section for a more detailed table.  Relation to other derivatives  The matrix derivative is a convenient notation for keeping track of partial derivatives for doing calculations. The Fr√©chet derivative is the standard way in the setting of functional analysis to take derivatives with respect to vectors. In the case that a matrix function of a matrix is Fr√©chet differentiable, the two derivatives will agree up to translation of notations. As is the case in general for partial derivatives , some formulae may extend under weaker analytic conditions than the existence of the derivative as approximating linear mapping.  Usages  Matrix calculus is used for deriving optimal stochastic estimators, often involving the use of Lagrange multipliers . This includes the derivation of:   Kalman filter  Wiener filter  Expectation-maximization algorithm for Gaussian mixture   Notation  The vector and matrix derivatives presented in the sections to follow take full advantage of matrix notation , using a single variable to represent a large number of variables. In what follows we will distinguish scalars, vectors and matrices by their typeface. We will let M ( n , m ) denote the space of real  n√óm matrices with n rows and m columns. Such matrices will be denoted using bold capital letters: A , X , Y , etc. An element of M ( n ,1), that is, a column vector , is denoted with a boldface lowercase letter: a , x , y , etc. An element of M (1,1) is a scalar, denoted with lowercase italic typeface: a , t , x , etc. X T denotes matrix transpose , tr( X ) is the trace , and det( X ) is the determinant . All functions are assumed to be of differentiability class  C 1 unless otherwise noted. Generally letters from first half of the alphabet (a, b, c, ‚Ä¶) will be used to denote constants, and from the second half (t, x, y, ‚Ä¶) to denote variables.  NOTE : As mentioned above, there are competing notations for laying out systems of partial derivatives in vectors and matrices, and no standard appears to be emerging yet. The next two introductory sections use the numerator layout convention simply for the purposes of convenience, to avoid overly complicating the discussion. The section after them discusses layout conventions in more detail. It is important to realize the following:   Despite the use of the terms "numerator layout" and "denominator layout", there are actually more than two possible notational choices involved. The reason is that the choice of numerator vs. denominator (or in some situations, numerator vs. mixed) can be made independently for scalar-by-vector, vector-by-scalar, vector-by-vector, and scalar-by-matrix derivatives, and a number of authors mix and match their layout choices in various ways.  The choice of numerator layout in the introductory sections below does not imply that this is the "correct" or "superior" choice. There are advantages and disadvantages to the various layout types. Serious mistakes can result from carelessly combining formulas written in different layouts, and converting from one layout to another requires care to avoid errors. As a result, when working with existing formulas the best policy is probably to identify whichever layout is used and maintain consistency with it, rather than attempting to use the same layout in all situations.   Alternatives  The tensor index notation with its Einstein summation convention is very similar to the matrix calculus, except one writes only a single component at a time. It has the advantage that one can easily manipulate arbitrarily high rank tensors, whereas tensors of rank higher than two are quite unwieldy with matrix notation. All of the work here can be done in this notation without use of the single-variable matrix notation. However, many problems in estimation theory and other areas of applied mathematics would result in too many indices to properly keep track of, pointing in favor of matrix calculus in those areas. Also, Einstein notation can be very useful in proving the identities presented here, as an alternative to typical element notation, which can become cumbersome when the explicit sums are carried around. Note that a matrix can be considered a tensor of rank two.  Derivatives with vectors  Because vectors are matrices with only one column, the simplest matrix derivatives are vector derivatives.  The notations developed here can accommodate the usual operations of vector calculus by identifying the space M ( n ,1) of n -vectors with the Euclidean space  R n , and the scalar M (1,1) is identified with R . The corresponding concept from vector calculus is indicated at the end of each subsection.  NOTE : The discussion in this section assumes the numerator layout convention for pedagogical purposes. Some authors use different conventions. The section on layout conventions discusses this issue in greater detail. The identities given further down are presented in forms that can be used in conjunction with all common layout conventions.  Vector-by-scalar  The derivative of a vector     ùê≤  =   [      y  1        y  2       ‚ãÆ       y  m      ]       ùê≤     subscript  y  1      subscript  y  2     normal-‚ãÆ     subscript  y  m       \mathbf{y}=\begin{bmatrix}y_{1}\\
 y_{2}\\
 \vdots\\
 y_{m}\\
 \end{bmatrix}   , by a scalar  x is written (in numerator layout notation ) as         ‚àÇ  ùê≤    ‚àÇ  x    =   [        ‚àÇ   y  1     ‚àÇ  x            ‚àÇ   y  2     ‚àÇ  x         ‚ãÆ         ‚àÇ   y  m     ‚àÇ  x        ]    .          ùê≤     x           subscript  y  1      x           subscript  y  2      x      normal-‚ãÆ         subscript  y  m      x        \frac{\partial\mathbf{y}}{\partial x}=\begin{bmatrix}\frac{\partial y_{1}}{%
 \partial x}\\
 \frac{\partial y_{2}}{\partial x}\\
 \vdots\\
 \frac{\partial y_{m}}{\partial x}\\
 \end{bmatrix}.     In vector calculus the derivative of a vector y with respect to a scalar x is known as the tangent vector of the vector y ,     ‚àÇ  ùê≤    ‚àÇ  x         ùê≤     x     \frac{\partial\mathbf{y}}{\partial x}   . Notice here that y : R    ‚Üí   normal-‚Üí   \rightarrow    R m .  Example Simple examples of this include the velocity vector in Euclidean space , which is the tangent vector of the position vector (considered as a function of time). Also, the acceleration is the tangent vector of the velocity.  Scalar-by-vector  The derivative of a scalar  y by a vector    ùê±  =   [      x  1        x  2       ‚ãÆ       x  n      ]       ùê±     subscript  x  1      subscript  x  2     normal-‚ãÆ     subscript  x  n       \mathbf{x}=\begin{bmatrix}x_{1}\\
 x_{2}\\
 \vdots\\
 x_{n}\\
 \end{bmatrix}   , is written (in numerator layout notation ) as         ‚àÇ  y    ‚àÇ  ùê±    =   [    ‚àÇ  y    ‚àÇ   x  1       ‚àÇ  y    ‚àÇ   x  2     ‚ãØ    ‚àÇ  y    ‚àÇ   x  n     ]    .          y     ùê±         y      subscript  x  1         y      subscript  x  2     normal-‚ãØ      y      subscript  x  n        \frac{\partial y}{\partial\mathbf{x}}=\left[\frac{\partial y}{\partial x_{1}}%
 \ \ \frac{\partial y}{\partial x_{2}}\ \ \cdots\ \ \frac{\partial y}{\partial x%
 _{n}}\right].     In vector calculus , the gradient of a scalar field y in the space R n (whose independent coordinates are the components of x ) is the derivative of a scalar by a vector. In physics, the electric field is the vector gradient of the electric potential .  The directional derivative of a scalar function f ( x ) of the space vector x in the direction of the unit vector u is defined using the gradient as follows.         ‚àá  ùï¶   f    (  ùï©  )    =     ‚àá  f    (  ùï©  )    ‚ãÖ  ùï¶           subscript  normal-‚àá  ùï¶   f   ùï©    normal-‚ãÖ     normal-‚àá  f   ùï©   ùï¶     \nabla_{\mathbb{u}}{f}(\mathbb{x})=\nabla f(\mathbb{x})\cdot\mathbb{u}   Using the notation just defined for the derivative of a scalar with respect to a vector we can re-write the directional derivative as       ‚àá  ùêÆ   f   =     ‚àÇ  f    ‚àÇ  ùê±    ùêÆ    .        subscript  normal-‚àá  ùêÆ   f         f     ùê±    ùêÆ     \nabla_{\mathbf{u}}f=\frac{\partial f}{\partial\mathbf{x}}\mathbf{u}.   This type of notation will be nice when proving product rules and chain rules that come out looking similar to what we are familiar with for the scalar derivative .  Vector-by-vector  Each of the previous two cases can be considered as an application of the derivative of a vector with respect to a vector, using a vector of size one appropriately. Similarly we will find that the derivatives involving matrices will reduce to derivatives involving vectors in a corresponding way.  The derivative of a vector function (a vector whose components are functions)    ùê≤  =   [      y  1        y  2       ‚ãÆ       y  m      ]       ùê≤     subscript  y  1      subscript  y  2     normal-‚ãÆ     subscript  y  m       \mathbf{y}=\begin{bmatrix}y_{1}\\
 y_{2}\\
 \vdots\\
 y_{m}\\
 \end{bmatrix}   , with respect to an input vector,    ùê±  =   [      x  1        x  2       ‚ãÆ       x  n      ]       ùê±     subscript  x  1      subscript  x  2     normal-‚ãÆ     subscript  x  n       \mathbf{x}=\begin{bmatrix}x_{1}\\
 x_{2}\\
 \vdots\\
 x_{n}\\
 \end{bmatrix}   , is written (in numerator layout notation ) as         ‚àÇ  ùê≤    ‚àÇ  ùê±    =   [        ‚àÇ   y  1     ‚àÇ   x  1           ‚àÇ   y  1     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  1     ‚àÇ   x  n             ‚àÇ   y  2     ‚àÇ   x  1           ‚àÇ   y  2     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  2     ‚àÇ   x  n          ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ   y  m     ‚àÇ   x  1           ‚àÇ   y  m     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  m     ‚àÇ   x  n         ]    .          ùê≤     ùê±           subscript  y  1       subscript  x  1          subscript  y  1       subscript  x  2     normal-‚ãØ       subscript  y  1       subscript  x  n            subscript  y  2       subscript  x  1          subscript  y  2       subscript  x  2     normal-‚ãØ       subscript  y  2       subscript  x  n       normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ         subscript  y  m       subscript  x  1          subscript  y  m       subscript  x  2     normal-‚ãØ       subscript  y  m       subscript  x  n         \frac{\partial\mathbf{y}}{\partial\mathbf{x}}=\begin{bmatrix}\frac{\partial y_%
 {1}}{\partial x_{1}}&\frac{\partial y_{1}}{\partial x_{2}}&\cdots&\frac{%
 \partial y_{1}}{\partial x_{n}}\\
 \frac{\partial y_{2}}{\partial x_{1}}&\frac{\partial y_{2}}{\partial x_{2}}&%
 \cdots&\frac{\partial y_{2}}{\partial x_{n}}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y_{m}}{\partial x_{1}}&\frac{\partial y_{m}}{\partial x_{2}}&%
 \cdots&\frac{\partial y_{m}}{\partial x_{n}}\\
 \end{bmatrix}.     In vector calculus , the derivative of a vector function y with respect to a vector x whose components represent a space is known as the pushforward or differential , or the Jacobian matrix .  The pushforward along a vector function f with respect to vector v in R m is given by       d   ùêü   (  ùêØ  )    =     ‚àÇ  ùêü    ‚àÇ  ùê±    ùêØ    .        d  ùêü  ùêØ         ùêü     ùê±    ùêØ     d\,\mathbf{f}(\mathbf{v})=\frac{\partial\mathbf{f}}{\partial\mathbf{x}}\mathbf%
 {v}.     Derivatives with matrices  There are two types of derivatives with matrices that can be organized into a matrix of the same size. These are the derivative of a matrix by a scalar and the derivative of a scalar by a matrix respectively. These can be useful in minimization problems found many areas of applied mathematics and have adopted the names tangent matrix and gradient matrix respectively after their analogs for vectors.  NOTE : The discussion in this section assumes the numerator layout convention for pedagogical purposes. Some authors use different conventions. The section on layout conventions discusses this issue in greater detail. The identities given further down are presented in forms that can be used in conjunction with all common layout conventions.  Matrix-by-scalar  The derivative of a matrix function Y by a scalar x is known as the tangent matrix and is given (in numerator layout notation ) by         ‚àÇ  ùêò    ‚àÇ  x    =   [        ‚àÇ   y  11     ‚àÇ  x          ‚àÇ   y  12     ‚àÇ  x       ‚ãØ       ‚àÇ   y   1  n      ‚àÇ  x            ‚àÇ   y  21     ‚àÇ  x          ‚àÇ   y  22     ‚àÇ  x       ‚ãØ       ‚àÇ   y   2  n      ‚àÇ  x         ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ   y   m  1      ‚àÇ  x          ‚àÇ   y   m  2      ‚àÇ  x       ‚ãØ       ‚àÇ   y   m  n      ‚àÇ  x        ]    .          ùêò     x           subscript  y  11      x         subscript  y  12      x    normal-‚ãØ       subscript  y    1  n       x           subscript  y  21      x         subscript  y  22      x    normal-‚ãØ       subscript  y    2  n       x      normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ         subscript  y    m  1       x         subscript  y    m  2       x    normal-‚ãØ       subscript  y    m  n       x        \frac{\partial\mathbf{Y}}{\partial x}=\begin{bmatrix}\frac{\partial y_{11}}{%
 \partial x}&\frac{\partial y_{12}}{\partial x}&\cdots&\frac{\partial y_{1n}}{%
 \partial x}\\
 \frac{\partial y_{21}}{\partial x}&\frac{\partial y_{22}}{\partial x}&\cdots&%
 \frac{\partial y_{2n}}{\partial x}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y_{m1}}{\partial x}&\frac{\partial y_{m2}}{\partial x}&\cdots&%
 \frac{\partial y_{mn}}{\partial x}\\
 \end{bmatrix}.     Scalar-by-matrix  The derivative of a scalar y function of a matrix X of independent variables, with respect to the matrix X , is given (in numerator layout notation ) by         ‚àÇ  y    ‚àÇ  ùêó    =   [        ‚àÇ  y    ‚àÇ   x  11           ‚àÇ  y    ‚àÇ   x  21        ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  1              ‚àÇ  y    ‚àÇ   x  12           ‚àÇ  y    ‚àÇ   x  22        ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  2           ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ  y    ‚àÇ   x   1  q            ‚àÇ  y    ‚àÇ   x   2  q         ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  q          ]    .          y     ùêó          y      subscript  x  11         y      subscript  x  21     normal-‚ãØ      y      subscript  x    p  1            y      subscript  x  12         y      subscript  x  22     normal-‚ãØ      y      subscript  x    p  2        normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ        y      subscript  x    1  q          y      subscript  x    2  q      normal-‚ãØ      y      subscript  x    p  q          \frac{\partial y}{\partial\mathbf{X}}=\begin{bmatrix}\frac{\partial y}{%
 \partial x_{11}}&\frac{\partial y}{\partial x_{21}}&\cdots&\frac{\partial y}{%
 \partial x_{p1}}\\
 \frac{\partial y}{\partial x_{12}}&\frac{\partial y}{\partial x_{22}}&\cdots&%
 \frac{\partial y}{\partial x_{p2}}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y}{\partial x_{1q}}&\frac{\partial y}{\partial x_{2q}}&\cdots&%
 \frac{\partial y}{\partial x_{pq}}\\
 \end{bmatrix}.     Notice that the indexing of the gradient with respect to X is transposed as compared with the indexing of X . Important examples of scalar functions of matrices include the trace of a matrix and the determinant .  In analog with vector calculus this derivative is often written as the following.         ‚àá  ùêó   y    (  ùêó  )    =     ‚àÇ  y    (  ùêó  )     ‚àÇ  ùêó            subscript  normal-‚àá  ùêó   y   ùêó         y   ùêó     ùêó      \nabla_{\mathbf{X}}y(\mathbf{X})=\frac{\partial y(\mathbf{X})}{\partial\mathbf%
 {X}}   Also in analog with vector calculus , the directional derivative of a scalar f ( X ) of a matrix X in the direction of matrix Y is given by         ‚àá  ùêò   f   =   tr   (     ‚àÇ  f    ‚àÇ  ùêó    ùêò   )     .        subscript  normal-‚àá  ùêò   f    tr        f     ùêó    ùêò      \nabla_{\mathbf{Y}}f=\operatorname{tr}\left(\frac{\partial f}{\partial\mathbf{%
 X}}\mathbf{Y}\right).     It is the gradient matrix, in particular, that finds many uses in minimization problems in estimation theory , particularly in the derivation of the Kalman filter algorithm, which is of great importance in the field.  Other matrix derivatives  The three types of derivatives that have not been considered are those involving vectors-by-matrices, matrices-by-vectors, and matrices-by-matrices. These are not as widely considered and a notation is not widely agreed upon. As for vectors, the other two types of higher matrix derivatives can be seen as applications of the derivative of a matrix by a matrix by using a matrix with one column in the correct place. For this reason, in this subsection we consider only how one can write the derivative of a matrix by another matrix.  The differential or the matrix derivative of a matrix function F ( X ) that maps from n √ó m matrices to p √ó q matrices, F : M ( n , m )   ‚Üí   normal-‚Üí   \to    M ( p , q ), is an element of M ( p , q ) ? M ( m , n ), a fourth-rank  tensor (the reversal of m and n here indicates the dual space of M ( n , m )). In short it is an m √ó n matrix each of whose entries is a p √ó q matrix.         ‚àÇ  ùêÖ    ‚àÇ  ùêó    =   [        ‚àÇ  ùêÖ    ‚àÇ   X   1  ,  1         ‚ãØ       ‚àÇ  ùêÖ    ‚àÇ   X   n  ,  1           ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ  ùêÖ    ‚àÇ   X   1  ,  m         ‚ãØ       ‚àÇ  ùêÖ    ‚àÇ   X   n  ,  m          ]    ,          ùêÖ     ùêó          ùêÖ      subscript  X   1  1      normal-‚ãØ      ùêÖ      subscript  X   n  1        normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ        ùêÖ      subscript  X   1  m      normal-‚ãØ      ùêÖ      subscript  X   n  m          \frac{\partial\mathbf{F}}{\partial\mathbf{X}}=\begin{bmatrix}\frac{\partial%
 \mathbf{F}}{\partial X_{1,1}}&\cdots&\frac{\partial\mathbf{F}}{\partial X_{n,1%
 }}\\
 \vdots&\ddots&\vdots\\
 \frac{\partial\mathbf{F}}{\partial X_{1,m}}&\cdots&\frac{\partial\mathbf{F}}{%
 \partial X_{n,m}}\\
 \end{bmatrix},   and note that each     ‚àÇ  ùêÖ    ‚àÇ   ùêó   i  j           ùêÖ      subscript  ùêó    i  j       \frac{\partial\mathbf{F}}{\partial\mathbf{X}_{ij}}   is a p √ó q matrix defined as above. Note also that this matrix has its indexing transposed; m rows and n columns. The pushforward along F of an n √ó m matrix Y in M ( n , m ) is then        d  ùêÖ   (  ùêò  )    =   tr   (     ‚àÇ  ùêÖ    ‚àÇ  ùêó    ùêò   )     ,        d  ùêÖ  ùêò    tr        ùêÖ     ùêó    ùêò      d\mathbf{F}(\mathbf{Y})=\operatorname{tr}\left(\frac{\partial\mathbf{F}}{%
 \partial\mathbf{X}}\mathbf{Y}\right),   as formal block matrices. Note that this definition encompasses all of the preceding definitions as special cases.  According to Jan R. Magnus and Heinz Neudecker, the following notations are both unsuitable, as the determinant of the second resulting matrix would have "no interpretation" and "a useful chain rule does not exist" if these notations are being used: 2   Given   œï   œï   \phi   , a differentiable function of an    n  √ó  m      n  m    n\times m   matrix    ùêó  =   (   x   i  ,  j    )       ùêó   subscript  x   i  j      \mathbf{X}=(x_{i,j})   , : \frac{\partial \mathbf\phi(\mathbf X)} {\partial \mathbf{X}}=    \begin{bmatrix}  \frac{\partial¬†\mathbf\phi}{\partial¬†x_{1,1}}¬†&¬†\cdots¬†&¬†\frac{\partial¬†\mathbf\phi}{\partial¬†x_{1,q}}\\  \vdots¬†&¬†\ddots¬†&¬†\vdots\\  \frac{\partial¬†\mathbf\phi}{\partial¬†x_{n,1}}¬†&¬†\cdots¬†&¬†\frac{\partial¬†\mathbf\phi}{\partial¬†x_{n,q}}\\  \end{bmatrix}   Given    ùêÖ  =   (   f   s  ,  t    )       ùêÖ   subscript  f   s  t      \mathbf{F}=(f_{s,t})   , a differentiable    m  √ó  n      m  n    m\times n   function of an    n  √ó  m      n  m    n\times m   matrix   ùêó   ùêó   \mathbf{X}   , : \frac{\partial \mathbf F (\mathbf X)} {\partial \mathbf{X}}=    \begin{bmatrix}  \frac{\partial¬†f_{1,1}}{\partial¬†\mathbf¬†X}¬†&¬†\cdots¬†&¬†\frac{\partial¬†f_{1,p}}{\partial¬†\mathbf¬†X}\\  \vdots¬†&¬†\ddots¬†&¬†\vdots\\  \frac{\partial¬†f_{m,1}}{\partial¬†\mathbf¬†X}¬†&¬†\cdots¬†&¬†\frac{\partial¬†f_{m,p}}{\partial¬†\mathbf¬†X}\\  \end{bmatrix}  The Jacobian matrix , according to Magnus and Neudecker, 3 is         D   ùêÖ   (  ùêó  )    =     ‚àÇ    vec   ùêÖ     (  ùêó  )     ‚àÇ    (   vec   ùêó  )   ‚Ä≤      .        normal-D  ùêÖ  ùêó           vec  ùêÖ    ùêó    fragments    superscript   fragments  normal-(  vec  X  normal-)   normal-‚Ä≤       \mathrm{D}\,\mathbf{F}\left(\mathbf{X}\right)=\frac{\partial\,\mathrm{vec}\ %
 \mathbf{F}\left(\mathbf{X}\right)}{\partial\left(\mathrm{vec}\ \mathbf{X}%
 \right)^{\prime}}.     Layout conventions  This section discusses the similarities and differences between notational conventions that are used in the various fields that take advantage of matrix calculus. Although there are largely two consistent conventions, some authors find it convenient to mix the two conventions in forms that are discussed below. After this section equations will be listed in both competing forms separately.  The fundamental issue is that the derivative of a vector with respect to a vector, i.e.     ‚àÇ  ùê≤    ‚àÇ  ùê±         ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}}   , is often written in two competing ways. If the numerator y is of size m and the denominator x of size n , then the result can be laid out as either an m√ón matrix or n√óm matrix, i.e. the elements of y laid out in columns and the elements of x laid out in rows, or vice versa. This leads to the following possibilities:   Numerator layout , i.e. lay out according to y and x T (i.e. contrarily to x ). This is sometimes known as the Jacobian formulation .  Denominator layout , i.e. lay out according to y T and x (i.e. contrarily to y ). This is sometimes known as the Hessian formulation . Some authors term this layout the gradient , in distinction to the Jacobian (numerator layout), which is its transpose. (However, " gradient " more commonly means the derivative      ‚àÇ  y    ‚àÇ  ùê±    ,        y     ùê±     \frac{\partial y}{\partial\mathbf{x}},   regardless of layout.)  A third possibility sometimes seen is to insist on writing the derivative as      ‚àÇ  ùê≤    ‚àÇ   ùê±  ‚Ä≤     ,        ùê≤      superscript  ùê±  normal-‚Ä≤      \frac{\partial\mathbf{y}}{\partial\mathbf{x}^{\prime}},   (i.e. the derivative is taken with respect to the transpose of x ) and follow the numerator layout. This makes it possible to claim that the matrix is laid out according to both numerator and denominator. In practice this produces results the same as the numerator layout.   When handling the gradient      ‚àÇ  y    ‚àÇ  ùê±         y     ùê±     \frac{\partial y}{\partial\mathbf{x}}   and the opposite case      ‚àÇ  ùê≤    ‚àÇ  x    ,        ùê≤     x     \frac{\partial\mathbf{y}}{\partial x},   we have the same issues. To be consistent, we should do one of the following:   If we choose numerator layout for      ‚àÇ  ùê≤    ‚àÇ  ùê±    ,        ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}},   we should lay out the gradient      ‚àÇ  y    ‚àÇ  ùê±         y     ùê±     \frac{\partial y}{\partial\mathbf{x}}   as a row vector, and     ‚àÇ  ùê≤    ‚àÇ  x         ùê≤     x     \frac{\partial\mathbf{y}}{\partial x}   as a column vector.  If we choose denominator layout for      ‚àÇ  ùê≤    ‚àÇ  ùê±    ,        ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}},   we should lay out the gradient      ‚àÇ  y    ‚àÇ  ùê±         y     ùê±     \frac{\partial y}{\partial\mathbf{x}}   as a column vector, and     ‚àÇ  ùê≤    ‚àÇ  x         ùê≤     x     \frac{\partial\mathbf{y}}{\partial x}   as a row vector.  In the third possibility above, we write     ‚àÇ  y    ‚àÇ   ùê±  ‚Ä≤          y      superscript  ùê±  normal-‚Ä≤      \frac{\partial y}{\partial\mathbf{x}^{\prime}}   and      ‚àÇ  ùê≤    ‚àÇ  x    ,        ùê≤     x     \frac{\partial\mathbf{y}}{\partial x},   and use numerator layout.   Not all math textbooks and papers are consistent in this respect throughout the entire paper. That is, sometimes different conventions are used in different contexts within the same paper. For example, some choose denominator layout for gradients (laying them out as column vectors), but numerator layout for the vector-by-vector derivative      ‚àÇ  ùê≤    ‚àÇ  ùê±    .        ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}}.     Similarly, when it comes to scalar-by-matrix derivatives     ‚àÇ  y    ‚àÇ  ùêó         y     ùêó     \frac{\partial y}{\partial\mathbf{X}}   and matrix-by-scalar derivatives      ‚àÇ  ùêò    ‚àÇ  x    ,        ùêò     x     \frac{\partial\mathbf{Y}}{\partial x},   then consistent numerator layout lays out according to Y and X T , while consistent denominator layout lays out according to Y T and X . In practice, however, following a denominator layout for      ‚àÇ  ùêò    ‚àÇ  x    ,        ùêò     x     \frac{\partial\mathbf{Y}}{\partial x},   and laying the result out according to Y T , is rarely seen because it makes for ugly formulas that do not correspond to the scalar formulas. As a result, the following layouts can often be found:   Consistent numerator layout , which lays out     ‚àÇ  ùêò    ‚àÇ  x         ùêò     x     \frac{\partial\mathbf{Y}}{\partial x}   according to Y and     ‚àÇ  y    ‚àÇ  ùêó         y     ùêó     \frac{\partial y}{\partial\mathbf{X}}   according to X T .  Mixed layout , which lays out     ‚àÇ  ùêò    ‚àÇ  x         ùêò     x     \frac{\partial\mathbf{Y}}{\partial x}   according to Y and     ‚àÇ  y    ‚àÇ  ùêó         y     ùêó     \frac{\partial y}{\partial\mathbf{X}}   according to X .  Use the notation      ‚àÇ  y    ‚àÇ   ùêó  ‚Ä≤     ,        y      superscript  ùêó  normal-‚Ä≤      \frac{\partial y}{\partial\mathbf{X}^{\prime}},   with results the same as consistent numerator layout.   In the following formulas, we handle the five possible combinations      ‚àÇ  y    ‚àÇ  ùê±    ,    ‚àÇ  ùê≤    ‚àÇ  x    ,    ‚àÇ  ùê≤    ‚àÇ  ùê±    ,    ‚àÇ  y    ‚àÇ  ùêó           y     ùê±        ùê≤     x        ùê≤     ùê±        y     ùêó      \frac{\partial y}{\partial\mathbf{x}},\frac{\partial\mathbf{y}}{\partial x},%
 \frac{\partial\mathbf{y}}{\partial\mathbf{x}},\frac{\partial y}{\partial%
 \mathbf{X}}   and     ‚àÇ  ùêò    ‚àÇ  x         ùêò     x     \frac{\partial\mathbf{Y}}{\partial x}   separately. We also handle cases of scalar-by-scalar derivatives that involve an intermediate vector or matrix. (This can arise, for example, if a multi-dimensional parametric curve is defined in terms of a scalar variable, and then a derivative of a scalar function of the curve is taken with respect to the scalar that parameterizes the curve.) For each of the various combinations, we give numerator-layout and denominator-layout results, except in the cases above where denominator layout rarely occurs. In cases involving matrices where it makes sense, we give numerator-layout and mixed-layout results. As noted above, cases where vector and matrix denominators are written in transpose notation are equivalent to numerator layout with the denominators written without the transpose.  Keep in mind that various authors use different combinations of numerator and denominator layouts for different types of derivatives, and there is no guarantee that an author will consistently use either numerator or denominator layout for all types. Match up the formulas below with those quoted in the source to determine the layout used for that particular type of derivative, but be careful not to assume that derivatives of other types necessarily follow the same kind of layout.  When taking derivatives with an aggregate (vector or matrix) denominator in order to find a maximum or minimum of the aggregate, it should be kept in mind that using numerator layout will produce results that are transposed with respect to the aggregate. For example, in attempting to find the maximum likelihood estimate of a multivariate normal distribution using matrix calculus, if the domain is a k x1 column vector, then the result using the numerator layout will be in the form of a 1x k row vector. Thus, either the results should be transposed at the end or the denominator layout (or mixed layout) should be used.        Result of differentiating various kinds of aggregates with other kinds of aggregates    Scalar y   Vector y (size m )   Matrix Y (size m √ó n )     Notation   Type   Notation   Type   Notation     Scalar x        ‚àÇ  y    ‚àÇ  x         y     x     \frac{\partial y}{\partial x}      scalar        ‚àÇ  ùê≤    ‚àÇ  x         ùê≤     x     \frac{\partial\mathbf{y}}{\partial x}      (numerator layout) size- m  column vector (denominator layout) size- m  row vector      Vector x (size n )        ‚àÇ  y    ‚àÇ  ùê±         y     ùê±     \frac{\partial y}{\partial\mathbf{x}}      (numerator layout) size- n  row vector (denominator layout) size- n  column vector         ‚àÇ  ùê≤    ‚àÇ  ùê±         ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}}      (numerator layout) m √ó n matrix (denominator layout) n √ó m matrix      Matrix X (size p √ó q )        ‚àÇ  y    ‚àÇ  ùêó         y     ùêó     \frac{\partial y}{\partial\mathbf{X}}      (numerator layout) q √ó p matrix (denominator layout) p √ó q matrix         ‚àÇ  ùê≤    ‚àÇ  ùêó         ùê≤     ùêó     \frac{\partial\mathbf{y}}{\partial\mathbf{X}}      ?       The results of operations will be transposed when switching between numerator-layout and denominator-layout notation.  Numerator-layout notation  Using numerator-layout notation, we have: 4         ‚àÇ  y    ‚àÇ  ùê±    =   [     ‚àÇ  y    ‚àÇ   x  1       ‚àÇ  y    ‚àÇ   x  2     ‚ãØ    ‚àÇ  y    ‚àÇ   x  n      ]    .          y     ùê±     delimited-[]        y      subscript  x  1         y      subscript  x  2     normal-‚ãØ      y      subscript  x  n         \frac{\partial y}{\partial\mathbf{x}}=\left[\frac{\partial y}{\partial x_{1}}%
 \frac{\partial y}{\partial x_{2}}\cdots\frac{\partial y}{\partial x_{n}}\right].            ‚àÇ  ùê≤    ‚àÇ  x    =   [        ‚àÇ   y  1     ‚àÇ  x            ‚àÇ   y  2     ‚àÇ  x         ‚ãÆ         ‚àÇ   y  m     ‚àÇ  x        ]    .          ùê≤     x           subscript  y  1      x           subscript  y  2      x      normal-‚ãÆ         subscript  y  m      x        \frac{\partial\mathbf{y}}{\partial x}=\begin{bmatrix}\frac{\partial y_{1}}{%
 \partial x}\\
 \frac{\partial y_{2}}{\partial x}\\
 \vdots\\
 \frac{\partial y_{m}}{\partial x}\\
 \end{bmatrix}.            ‚àÇ  ùê≤    ‚àÇ  ùê±    =   [        ‚àÇ   y  1     ‚àÇ   x  1           ‚àÇ   y  1     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  1     ‚àÇ   x  n             ‚àÇ   y  2     ‚àÇ   x  1           ‚àÇ   y  2     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  2     ‚àÇ   x  n          ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ   y  m     ‚àÇ   x  1           ‚àÇ   y  m     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  m     ‚àÇ   x  n         ]    .          ùê≤     ùê±           subscript  y  1       subscript  x  1          subscript  y  1       subscript  x  2     normal-‚ãØ       subscript  y  1       subscript  x  n            subscript  y  2       subscript  x  1          subscript  y  2       subscript  x  2     normal-‚ãØ       subscript  y  2       subscript  x  n       normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ         subscript  y  m       subscript  x  1          subscript  y  m       subscript  x  2     normal-‚ãØ       subscript  y  m       subscript  x  n         \frac{\partial\mathbf{y}}{\partial\mathbf{x}}=\begin{bmatrix}\frac{\partial y_%
 {1}}{\partial x_{1}}&\frac{\partial y_{1}}{\partial x_{2}}&\cdots&\frac{%
 \partial y_{1}}{\partial x_{n}}\\
 \frac{\partial y_{2}}{\partial x_{1}}&\frac{\partial y_{2}}{\partial x_{2}}&%
 \cdots&\frac{\partial y_{2}}{\partial x_{n}}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y_{m}}{\partial x_{1}}&\frac{\partial y_{m}}{\partial x_{2}}&%
 \cdots&\frac{\partial y_{m}}{\partial x_{n}}\\
 \end{bmatrix}.            ‚àÇ  y    ‚àÇ  ùêó    =   [        ‚àÇ  y    ‚àÇ   x  11           ‚àÇ  y    ‚àÇ   x  21        ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  1              ‚àÇ  y    ‚àÇ   x  12           ‚àÇ  y    ‚àÇ   x  22        ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  2           ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ  y    ‚àÇ   x   1  q            ‚àÇ  y    ‚àÇ   x   2  q         ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  q          ]    .          y     ùêó          y      subscript  x  11         y      subscript  x  21     normal-‚ãØ      y      subscript  x    p  1            y      subscript  x  12         y      subscript  x  22     normal-‚ãØ      y      subscript  x    p  2        normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ        y      subscript  x    1  q          y      subscript  x    2  q      normal-‚ãØ      y      subscript  x    p  q          \frac{\partial y}{\partial\mathbf{X}}=\begin{bmatrix}\frac{\partial y}{%
 \partial x_{11}}&\frac{\partial y}{\partial x_{21}}&\cdots&\frac{\partial y}{%
 \partial x_{p1}}\\
 \frac{\partial y}{\partial x_{12}}&\frac{\partial y}{\partial x_{22}}&\cdots&%
 \frac{\partial y}{\partial x_{p2}}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y}{\partial x_{1q}}&\frac{\partial y}{\partial x_{2q}}&\cdots&%
 \frac{\partial y}{\partial x_{pq}}\\
 \end{bmatrix}.     The following definitions are only provided in numerator-layout notation:         ‚àÇ  ùêò    ‚àÇ  x    =   [        ‚àÇ   y  11     ‚àÇ  x          ‚àÇ   y  12     ‚àÇ  x       ‚ãØ       ‚àÇ   y   1  n      ‚àÇ  x            ‚àÇ   y  21     ‚àÇ  x          ‚àÇ   y  22     ‚àÇ  x       ‚ãØ       ‚àÇ   y   2  n      ‚àÇ  x         ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ   y   m  1      ‚àÇ  x          ‚àÇ   y   m  2      ‚àÇ  x       ‚ãØ       ‚àÇ   y   m  n      ‚àÇ  x        ]    .          ùêò     x           subscript  y  11      x         subscript  y  12      x    normal-‚ãØ       subscript  y    1  n       x           subscript  y  21      x         subscript  y  22      x    normal-‚ãØ       subscript  y    2  n       x      normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ         subscript  y    m  1       x         subscript  y    m  2       x    normal-‚ãØ       subscript  y    m  n       x        \frac{\partial\mathbf{Y}}{\partial x}=\begin{bmatrix}\frac{\partial y_{11}}{%
 \partial x}&\frac{\partial y_{12}}{\partial x}&\cdots&\frac{\partial y_{1n}}{%
 \partial x}\\
 \frac{\partial y_{21}}{\partial x}&\frac{\partial y_{22}}{\partial x}&\cdots&%
 \frac{\partial y_{2n}}{\partial x}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y_{m1}}{\partial x}&\frac{\partial y_{m2}}{\partial x}&\cdots&%
 \frac{\partial y_{mn}}{\partial x}\\
 \end{bmatrix}.           d  ùêó   =   [      d   x  11       d   x  12      ‚ãØ     d   x   1  n          d   x  21       d   x  22      ‚ãØ     d   x   2  n         ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ       d   x   m  1        d   x   m  2       ‚ãØ     d   x   m  n        ]    .        d  ùêó       d   subscript  x  11      d   subscript  x  12    normal-‚ãØ    d   subscript  x    1  n         d   subscript  x  21      d   subscript  x  22    normal-‚ãØ    d   subscript  x    2  n       normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ      d   subscript  x    m  1       d   subscript  x    m  2     normal-‚ãØ    d   subscript  x    m  n         d\mathbf{X}=\begin{bmatrix}dx_{11}&dx_{12}&\cdots&dx_{1n}\\
 dx_{21}&dx_{22}&\cdots&dx_{2n}\\
 \vdots&\vdots&\ddots&\vdots\\
 dx_{m1}&dx_{m2}&\cdots&dx_{mn}\\
 \end{bmatrix}.     Denominator-layout notation  Using denominator-layout notation, we have: 5         ‚àÇ  y    ‚àÇ  ùê±    =   [        ‚àÇ  y    ‚àÇ   x  1             ‚àÇ  y    ‚àÇ   x  2          ‚ãÆ         ‚àÇ  y    ‚àÇ   x  n         ]    .          y     ùê±          y      subscript  x  1           y      subscript  x  2       normal-‚ãÆ        y      subscript  x  n         \frac{\partial y}{\partial\mathbf{x}}=\begin{bmatrix}\frac{\partial y}{%
 \partial x_{1}}\\
 \frac{\partial y}{\partial x_{2}}\\
 \vdots\\
 \frac{\partial y}{\partial x_{n}}\\
 \end{bmatrix}.            ‚àÇ  ùê≤    ‚àÇ  x    =   [     ‚àÇ   y  1     ‚àÇ  x      ‚àÇ   y  2     ‚àÇ  x    ‚ãØ    ‚àÇ   y  m     ‚àÇ  x     ]    .          ùê≤     x     delimited-[]         subscript  y  1      x         subscript  y  2      x    normal-‚ãØ       subscript  y  m      x        \frac{\partial\mathbf{y}}{\partial x}=\left[\frac{\partial y_{1}}{\partial x}%
 \frac{\partial y_{2}}{\partial x}\cdots\frac{\partial y_{m}}{\partial x}\right].            ‚àÇ  ùê≤    ‚àÇ  ùê±    =   [        ‚àÇ   y  1     ‚àÇ   x  1           ‚àÇ   y  2     ‚àÇ   x  1        ‚ãØ       ‚àÇ   y  m     ‚àÇ   x  1             ‚àÇ   y  1     ‚àÇ   x  2           ‚àÇ   y  2     ‚àÇ   x  2        ‚ãØ       ‚àÇ   y  m     ‚àÇ   x  2          ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ   y  1     ‚àÇ   x  n           ‚àÇ   y  2     ‚àÇ   x  n        ‚ãØ       ‚àÇ   y  m     ‚àÇ   x  n         ]    .          ùê≤     ùê±           subscript  y  1       subscript  x  1          subscript  y  2       subscript  x  1     normal-‚ãØ       subscript  y  m       subscript  x  1            subscript  y  1       subscript  x  2          subscript  y  2       subscript  x  2     normal-‚ãØ       subscript  y  m       subscript  x  2       normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ         subscript  y  1       subscript  x  n          subscript  y  2       subscript  x  n     normal-‚ãØ       subscript  y  m       subscript  x  n         \frac{\partial\mathbf{y}}{\partial\mathbf{x}}=\begin{bmatrix}\frac{\partial y_%
 {1}}{\partial x_{1}}&\frac{\partial y_{2}}{\partial x_{1}}&\cdots&\frac{%
 \partial y_{m}}{\partial x_{1}}\\
 \frac{\partial y_{1}}{\partial x_{2}}&\frac{\partial y_{2}}{\partial x_{2}}&%
 \cdots&\frac{\partial y_{m}}{\partial x_{2}}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y_{1}}{\partial x_{n}}&\frac{\partial y_{2}}{\partial x_{n}}&%
 \cdots&\frac{\partial y_{m}}{\partial x_{n}}\\
 \end{bmatrix}.            ‚àÇ  y    ‚àÇ  ùêó    =   [        ‚àÇ  y    ‚àÇ   x  11           ‚àÇ  y    ‚àÇ   x  12        ‚ãØ       ‚àÇ  y    ‚àÇ   x   1  q              ‚àÇ  y    ‚àÇ   x  21           ‚àÇ  y    ‚àÇ   x  22        ‚ãØ       ‚àÇ  y    ‚àÇ   x   2  q           ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ         ‚àÇ  y    ‚àÇ   x   p  1            ‚àÇ  y    ‚àÇ   x   p  2         ‚ãØ       ‚àÇ  y    ‚àÇ   x   p  q          ]    .          y     ùêó          y      subscript  x  11         y      subscript  x  12     normal-‚ãØ      y      subscript  x    1  q            y      subscript  x  21         y      subscript  x  22     normal-‚ãØ      y      subscript  x    2  q        normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ        y      subscript  x    p  1          y      subscript  x    p  2      normal-‚ãØ      y      subscript  x    p  q          \frac{\partial y}{\partial\mathbf{X}}=\begin{bmatrix}\frac{\partial y}{%
 \partial x_{11}}&\frac{\partial y}{\partial x_{12}}&\cdots&\frac{\partial y}{%
 \partial x_{1q}}\\
 \frac{\partial y}{\partial x_{21}}&\frac{\partial y}{\partial x_{22}}&\cdots&%
 \frac{\partial y}{\partial x_{2q}}\\
 \vdots&\vdots&\ddots&\vdots\\
 \frac{\partial y}{\partial x_{p1}}&\frac{\partial y}{\partial x_{p2}}&\cdots&%
 \frac{\partial y}{\partial x_{pq}}\\
 \end{bmatrix}.     Identities  As noted above, in general, the results of operations will be transposed when switching between numerator-layout and denominator-layout notation.  To help make sense of all the identities below, keep in mind the most important rules: the chain rule , product rule and sum rule . The sum rule applies universally, and the product rule applies in most of the cases below, provided that the order of matrix products is maintained, since matrix products are not commutative. The chain rule applies in some of the cases, but unfortunately does not apply in matrix-by-scalar derivatives or scalar-by-matrix derivatives (in the latter case, mostly involving the trace operator applied to matrices). In the latter case, the product rule can't quite be applied directly, either, but the equivalent can be done with a bit more work using the differential identities.  Vector-by-vector identities  This is presented first because all of the operations that apply to vector-by-vector differentiation apply directly to vector-by-scalar or scalar-by-vector differentiation simply by reducing the appropriate vector in the numerator or denominator to a scalar.        Identities: vector-by-vector     ‚àÇ  ùê≤    ‚àÇ  ùê±         ùê≤     ùê±     \frac{\partial\mathbf{y}}{\partial\mathbf{x}}      scope="col" Condition   scope="col" Expression   scope="col" Numerator layout, i.e. by y and x T   scope="col" Denominator layout, i.e. by y T and x     a is not a function of x         ‚àÇ  ùêö    ‚àÇ  ùê±    =           ùêö     ùê±    absent    \frac{\partial\mathbf{a}}{\partial\mathbf{x}}=         ùüé   0   \mathbf{0}               ‚àÇ  ùê±    ‚àÇ  ùê±    =           ùê±     ùê±    absent    \frac{\partial\mathbf{x}}{\partial\mathbf{x}}=         ùêà   ùêà   \mathbf{I}        A is not a function of x         ‚àÇ  ùêÄùê±    ‚àÇ  ùê±    =           ùêÄùê±     ùê±    absent    \frac{\partial\mathbf{A}\mathbf{x}}{\partial\mathbf{x}}=         ùêÄ   ùêÄ   \mathbf{A}          ùêÄ  ‚ä§     superscript  ùêÄ  top    \mathbf{A}^{\top}        A is not a function of x         ‚àÇ    ùê±  ‚ä§   ùêÄ     ‚àÇ  ùê±    =              superscript  ùê±  top   ùêÄ      ùê±    absent    \frac{\partial\mathbf{x}^{\top}\mathbf{A}}{\partial\mathbf{x}}=          ùêÄ  ‚ä§     superscript  ùêÄ  top    \mathbf{A}^{\top}         ùêÄ   ùêÄ   \mathbf{A}        a is not a function of x ,  u = u ( x )         ‚àÇ   a  ùêÆ     ‚àÇ  ùê±    =             a  ùêÆ      ùê±    absent    \frac{\partial a\mathbf{u}}{\partial\,\mathbf{x}}=          a    ‚àÇ  ùêÆ    ‚àÇ  ùê±        a      ùêÆ     ùê±      a\frac{\partial\mathbf{u}}{\partial\mathbf{x}}        a = a ( x ), u = u ( x )         ‚àÇ   a  ùêÆ     ‚àÇ  ùê±    =             a  ùêÆ      ùê±    absent    \frac{\partial a\mathbf{u}}{\partial\mathbf{x}}=           a    ‚àÇ  ùêÆ    ‚àÇ  ùê±     +   ùêÆ    ‚àÇ  a    ‚àÇ  ùê±           a      ùêÆ     ùê±       ùêÆ      a     ùê±       a\frac{\partial\mathbf{u}}{\partial\mathbf{x}}+\mathbf{u}\frac{\partial a}{%
 \partial\mathbf{x}}           a    ‚àÇ  ùêÆ    ‚àÇ  ùê±     +     ‚àÇ  a    ‚àÇ  ùê±     ùêÆ  ‚ä§          a      ùêÆ     ùê±           a     ùê±     superscript  ùêÆ  top      a\frac{\partial\mathbf{u}}{\partial\mathbf{x}}+\frac{\partial a}{\partial%
 \mathbf{x}}\mathbf{u}^{\top}        A is not a function of x ,  u = u ( x )         ‚àÇ  ùêÄùêÆ    ‚àÇ  ùê±    =           ùêÄùêÆ     ùê±    absent    \frac{\partial\mathbf{A}\mathbf{u}}{\partial\mathbf{x}}=          ùêÄ    ‚àÇ  ùêÆ    ‚àÇ  ùê±        ùêÄ      ùêÆ     ùê±      \mathbf{A}\frac{\partial\mathbf{u}}{\partial\mathbf{x}}            ‚àÇ  ùêÆ    ‚àÇ  ùê±     ùêÄ  ‚ä§           ùêÆ     ùê±     superscript  ùêÄ  top     \frac{\partial\mathbf{u}}{\partial\mathbf{x}}\mathbf{A}^{\top}        u = u ( x ), v = v ( x )         ‚àÇ   (   ùêÆ  +  ùêØ   )     ‚àÇ  ùê±    =             ùêÆ  ùêØ      ùê±    absent    \frac{\partial(\mathbf{u}+\mathbf{v})}{\partial\mathbf{x}}=            ‚àÇ  ùêÆ    ‚àÇ  ùê±    +    ‚àÇ  ùêØ    ‚àÇ  ùê±            ùêÆ     ùê±        ùêØ     ùê±      \frac{\partial\mathbf{u}}{\partial\mathbf{x}}+\frac{\partial\mathbf{v}}{%
 \partial\mathbf{x}}        u = u ( x )          ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùê±    =             ùê†   ùêÆ     ùê±    absent    \frac{\partial\mathbf{g(u)}}{\partial\mathbf{x}}=             ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ      ‚àÇ  ùêÆ    ‚àÇ  ùê±              ùê†   ùêÆ     ùêÆ        ùêÆ     ùê±      \frac{\partial\mathbf{g(u)}}{\partial\mathbf{u}}\frac{\partial\mathbf{u}}{%
 \partial\mathbf{x}}            ‚àÇ  ùêÆ    ‚àÇ  ùê±       ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ            ùêÆ     ùê±          ùê†   ùêÆ     ùêÆ      \frac{\partial\mathbf{u}}{\partial\mathbf{x}}\frac{\partial\mathbf{g(u)}}{%
 \partial\mathbf{u}}        u = u ( x )          ‚àÇ  ùêü    (   ùê†   (  ùêÆ  )    )     ‚àÇ  ùê±    =             ùêü     ùê†  ùêÆ      ùê±    absent    \frac{\partial\mathbf{f(g(u))}}{\partial\mathbf{x}}=             ‚àÇ  ùêü    (  ùê†  )     ‚àÇ  ùê†       ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ      ‚àÇ  ùêÆ    ‚àÇ  ùê±              ùêü   ùê†     ùê†          ùê†   ùêÆ     ùêÆ        ùêÆ     ùê±      \frac{\partial\mathbf{f(g)}}{\partial\mathbf{g}}\frac{\partial\mathbf{g(u)}}{%
 \partial\mathbf{u}}\frac{\partial\mathbf{u}}{\partial\mathbf{x}}            ‚àÇ  ùêÆ    ‚àÇ  ùê±       ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ       ‚àÇ  ùêü    (  ùê†  )     ‚àÇ  ùê†            ùêÆ     ùê±          ùê†   ùêÆ     ùêÆ          ùêü   ùê†     ùê†      \frac{\partial\mathbf{u}}{\partial\mathbf{x}}\frac{\partial\mathbf{g(u)}}{%
 \partial\mathbf{u}}\frac{\partial\mathbf{f(g)}}{\partial\mathbf{g}}          Scalar-by-vector identities  The fundamental identities are placed above the thick black line.        Identities: scalar-by-vector      ‚àÇ  y    ‚àÇ  ùê±    =    ‚àá  ùê±   y           y     ùê±      subscript  normal-‚àá  ùê±   y     \frac{\partial y}{\partial\mathbf{x}}=\nabla_{\mathbf{x}}y      scope="col" Condition   scope="col" Expression   scope="col" Numerator layout, i.e. by x T ; result is row vector   scope="col" Denominator layout, i.e. by x ; result is column vector     a is not a function of x         ‚àÇ  a    ‚àÇ  ùê±    =           a     ùê±    absent    \frac{\partial a}{\partial\mathbf{x}}=          ùüé  ‚ä§     superscript  0  top    \mathbf{0}^{\top}    6      ùüé   0   \mathbf{0}    7     a is not a function of x ,  u = u ( x )         ‚àÇ   a  u     ‚àÇ  ùê±    =             a  u      ùê±    absent    \frac{\partial au}{\partial\mathbf{x}}=          a    ‚àÇ  u    ‚àÇ  ùê±        a      u     ùê±      a\frac{\partial u}{\partial\mathbf{x}}        u = u ( x ), v = v ( x )         ‚àÇ   (   u  +  v   )     ‚àÇ  ùê±    =             u  v      ùê±    absent    \frac{\partial(u+v)}{\partial\mathbf{x}}=            ‚àÇ  u    ‚àÇ  ùê±    +    ‚àÇ  v    ‚àÇ  ùê±            u     ùê±        v     ùê±      \frac{\partial u}{\partial\mathbf{x}}+\frac{\partial v}{\partial\mathbf{x}}        u = u ( x ), v = v ( x )         ‚àÇ   u  v     ‚àÇ  ùê±    =             u  v      ùê±    absent    \frac{\partial uv}{\partial\mathbf{x}}=           u    ‚àÇ  v    ‚àÇ  ùê±     +   v    ‚àÇ  u    ‚àÇ  ùê±           u      v     ùê±       v      u     ùê±       u\frac{\partial v}{\partial\mathbf{x}}+v\frac{\partial u}{\partial\mathbf{x}}        u = u ( x )          ‚àÇ  g    (  u  )     ‚àÇ  ùê±    =             g   u     ùê±    absent    \frac{\partial g(u)}{\partial\mathbf{x}}=             ‚àÇ  g    (  u  )     ‚àÇ  u      ‚àÇ  u    ‚àÇ  ùê±              g   u     u        u     ùê±      \frac{\partial g(u)}{\partial u}\frac{\partial u}{\partial\mathbf{x}}        u = u ( x )          ‚àÇ  f    (   g   (  u  )    )     ‚àÇ  ùê±    =             f     g  u      ùê±    absent    \frac{\partial f(g(u))}{\partial\mathbf{x}}=             ‚àÇ  f    (  g  )     ‚àÇ  g       ‚àÇ  g    (  u  )     ‚àÇ  u      ‚àÇ  u    ‚àÇ  ùê±              f   g     g          g   u     u        u     ùê±      \frac{\partial f(g)}{\partial g}\frac{\partial g(u)}{\partial u}\frac{\partial
 u%
 }{\partial\mathbf{x}}        u = u ( x ), v = v ( x )         ‚àÇ   (   ùêÆ  ‚ãÖ  ùêØ   )     ‚àÇ  ùê±    =    ‚àÇ    ùêÆ  ‚ä§   ùêØ     ‚àÇ  ùê±    =              normal-‚ãÖ  ùêÆ  ùêØ      ùê±           superscript  ùêÆ  top   ùêØ      ùê±         absent     \frac{\partial(\mathbf{u}\cdot\mathbf{v})}{\partial\mathbf{x}}=\frac{\partial%
 \mathbf{u}^{\top}\mathbf{v}}{\partial\mathbf{x}}=            ùêÆ  ‚ä§     ‚àÇ  ùêØ    ‚àÇ  ùê±     +    ùêØ  ‚ä§     ‚àÇ  ùêÆ    ‚àÇ  ùê±            superscript  ùêÆ  top       ùêØ     ùê±        superscript  ùêØ  top       ùêÆ     ùê±       \mathbf{u}^{\top}\frac{\partial\mathbf{v}}{\partial\mathbf{x}}+\mathbf{v}^{%
 \top}\frac{\partial\mathbf{u}}{\partial\mathbf{x}}      assumes numerator layout¬†of      ‚àÇ  ùêÆ    ‚àÇ  ùê±    ,    ‚àÇ  ùêØ    ‚àÇ  ùê±           ùêÆ     ùê±        ùêØ     ùê±      \frac{\partial\mathbf{u}}{\partial\mathbf{x}},\frac{\partial\mathbf{v}}{%
 \partial\mathbf{x}}              ‚àÇ  ùêÆ    ‚àÇ  ùê±    ùêØ   +     ‚àÇ  ùêØ    ‚àÇ  ùê±    ùêÆ             ùêÆ     ùê±    ùêØ         ùêØ     ùê±    ùêÆ     \frac{\partial\mathbf{u}}{\partial\mathbf{x}}\mathbf{v}+\frac{\partial\mathbf{%
 v}}{\partial\mathbf{x}}\mathbf{u}      assumes denominator layout¬†of      ‚àÇ  ùêÆ    ‚àÇ  ùê±    ,    ‚àÇ  ùêØ    ‚àÇ  ùê±           ùêÆ     ùê±        ùêØ     ùê±      \frac{\partial\mathbf{u}}{\partial\mathbf{x}},\frac{\partial\mathbf{v}}{%
 \partial\mathbf{x}}         u = u ( x ), v = v ( x ),  A is not a function of x         ‚àÇ   (   ùêÆ  ‚ãÖ  ùêÄùêØ   )     ‚àÇ  ùê±    =    ‚àÇ    ùêÆ  ‚ä§   ùêÄùêØ     ‚àÇ  ùê±    =              normal-‚ãÖ  ùêÆ  ùêÄùêØ      ùê±           superscript  ùêÆ  top   ùêÄùêØ      ùê±         absent     \frac{\partial(\mathbf{u}\cdot\mathbf{A}\mathbf{v})}{\partial\mathbf{x}}=\frac%
 {\partial\mathbf{u}^{\top}\mathbf{A}\mathbf{v}}{\partial\mathbf{x}}=            ùêÆ  ‚ä§   ùêÄ    ‚àÇ  ùêØ    ‚àÇ  ùê±     +    ùêØ  ‚ä§    ùêÄ  ‚ä§     ‚àÇ  ùêÆ    ‚àÇ  ùê±            superscript  ùêÆ  top   ùêÄ      ùêØ     ùê±        superscript  ùêØ  top    superscript  ùêÄ  top       ùêÆ     ùê±       \mathbf{u}^{\top}\mathbf{A}\frac{\partial\mathbf{v}}{\partial\mathbf{x}}+%
 \mathbf{v}^{\top}\mathbf{A}^{\top}\frac{\partial\mathbf{u}}{\partial\mathbf{x}}      assumes numerator layout¬†of      ‚àÇ  ùêÆ    ‚àÇ  ùê±    ,    ‚àÇ  ùêØ    ‚àÇ  ùê±           ùêÆ     ùê±        ùêØ     ùê±      \frac{\partial\mathbf{u}}{\partial\mathbf{x}},\frac{\partial\mathbf{v}}{%
 \partial\mathbf{x}}              ‚àÇ  ùêÆ    ‚àÇ  ùê±    ùêÄùêØ   +     ‚àÇ  ùêØ    ‚àÇ  ùê±     ùêÄ  ‚ä§   ùêÆ             ùêÆ     ùê±    ùêÄùêØ         ùêØ     ùê±     superscript  ùêÄ  top   ùêÆ     \frac{\partial\mathbf{u}}{\partial\mathbf{x}}\mathbf{A}\mathbf{v}+\frac{%
 \partial\mathbf{v}}{\partial\mathbf{x}}\mathbf{A}^{\top}\mathbf{u}      assumes denominator layout¬†of      ‚àÇ  ùêÆ    ‚àÇ  ùê±    ,    ‚àÇ  ùêØ    ‚àÇ  ùê±           ùêÆ     ùê±        ùêØ     ùê±      \frac{\partial\mathbf{u}}{\partial\mathbf{x}},\frac{\partial\mathbf{v}}{%
 \partial\mathbf{x}}         a is not a function of x         ‚àÇ   (   ùêö  ‚ãÖ  ùê±   )     ‚àÇ  ùê±    =    ‚àÇ   (   ùê±  ‚ãÖ  ùêö   )     ‚àÇ  ùê±    =              normal-‚ãÖ  ùêö  ùê±      ùê±         normal-‚ãÖ  ùê±  ùêö      ùê±         absent     \frac{\partial(\mathbf{a}\cdot\mathbf{x})}{\partial\mathbf{x}}=\frac{\partial(%
 \mathbf{x}\cdot\mathbf{a})}{\partial\mathbf{x}}=           ‚àÇ    ùêö  ‚ä§   ùê±     ‚àÇ  ùê±    =    ‚àÇ    ùê±  ‚ä§   ùêö     ‚àÇ  ùê±    =                superscript  ùêö  top   ùê±      ùê±           superscript  ùê±  top   ùêö      ùê±         absent     \frac{\partial\mathbf{a}^{\top}\mathbf{x}}{\partial\mathbf{x}}=\frac{\partial%
 \mathbf{x}^{\top}\mathbf{a}}{\partial\mathbf{x}}=          ùêö  ‚ä§     superscript  ùêö  top    \mathbf{a}^{\top}         ùêö   ùêö   \mathbf{a}        A is not a function of x  b is not a function of x         ‚àÇ    ùêõ  ‚ä§   ùêÄùê±     ‚àÇ  ùê±    =              superscript  ùêõ  top   ùêÄùê±      ùê±    absent    \frac{\partial\mathbf{b}^{\top}\mathbf{A}\mathbf{x}}{\partial\mathbf{x}}=           ùêõ  ‚ä§   ùêÄ       superscript  ùêõ  top   ùêÄ    \mathbf{b}^{\top}\mathbf{A}           ùêÄ  ‚ä§   ùêõ       superscript  ùêÄ  top   ùêõ    \mathbf{A}^{\top}\mathbf{b}        A is not a function of x         ‚àÇ    ùê±  ‚ä§   ùêÄùê±     ‚àÇ  ùê±    =              superscript  ùê±  top   ùêÄùê±      ùê±    absent    \frac{\partial\mathbf{x}^{\top}\mathbf{A}\mathbf{x}}{\partial\mathbf{x}}=           ùê±  ‚ä§    (   ùêÄ  +   ùêÄ  ‚ä§    )        superscript  ùê±  top     ùêÄ   superscript  ùêÄ  top      \mathbf{x}^{\top}(\mathbf{A}+\mathbf{A}^{\top})           (   ùêÄ  +   ùêÄ  ‚ä§    )   ùê±        ùêÄ   superscript  ùêÄ  top    ùê±    (\mathbf{A}+\mathbf{A}^{\top})\mathbf{x}        A is not a function of x  A is symmetric         ‚àÇ    ùê±  ‚ä§   ùêÄùê±     ‚àÇ  ùê±    =              superscript  ùê±  top   ùêÄùê±      ùê±    absent    \frac{\partial\mathbf{x}^{\top}\mathbf{A}\mathbf{x}}{\partial\mathbf{x}}=          2   ùê±  ‚ä§   ùêÄ      2   superscript  ùê±  top   ùêÄ    2\mathbf{x}^{\top}\mathbf{A}          2  ùêÄùê±      2  ùêÄùê±    2\mathbf{A}\mathbf{x}        A is not a function of x          ‚àÇ  2     ùê±  ‚ä§   ùêÄùê±     ‚àÇ   ùê±  2     =           superscript   2      superscript  ùê±  top   ùêÄùê±       superscript  ùê±  2     absent    \frac{\partial^{2}\mathbf{x}^{\top}\mathbf{A}\mathbf{x}}{\partial\mathbf{x}^{2%
 }}=          ùêÄ  +   ùêÄ  ‚ä§       ùêÄ   superscript  ùêÄ  top     \mathbf{A}+\mathbf{A}^{\top}        A is not a function of x  A is symmetric          ‚àÇ  2     ùê±  ‚ä§   ùêÄùê±     ‚àÇ   ùê±  2     =           superscript   2      superscript  ùê±  top   ùêÄùê±       superscript  ùê±  2     absent    \frac{\partial^{2}\mathbf{x}^{\top}\mathbf{A}\mathbf{x}}{\partial\mathbf{x}^{2%
 }}=          2  ùêÄ      2  ùêÄ    2\mathbf{A}               ‚àÇ   (   ùê±  ‚ãÖ  ùê±   )     ‚àÇ  ùê±    =    ‚àÇ    ùê±  ‚ä§   ùê±     ‚àÇ  ùê±    =              normal-‚ãÖ  ùê±  ùê±      ùê±           superscript  ùê±  top   ùê±      ùê±         absent     \frac{\partial(\mathbf{x}\cdot\mathbf{x})}{\partial\mathbf{x}}=\frac{\partial%
 \mathbf{x}^{\top}\mathbf{x}}{\partial\mathbf{x}}=          2   ùê±  ‚ä§       2   superscript  ùê±  top     2\mathbf{x}^{\top}          2  ùê±      2  ùê±    2\mathbf{x}        a is not a function of x ,  u = u ( x )         ‚àÇ   (   ùêö  ‚ãÖ  ùêÆ   )     ‚àÇ  ùê±    =    ‚àÇ    ùêö  ‚ä§   ùêÆ     ‚àÇ  ùê±    =              normal-‚ãÖ  ùêö  ùêÆ      ùê±           superscript  ùêö  top   ùêÆ      ùê±         absent     \frac{\partial(\mathbf{a}\cdot\mathbf{u})}{\partial\mathbf{x}}=\frac{\partial%
 \mathbf{a}^{\top}\mathbf{u}}{\partial\mathbf{x}}=           ùêö  ‚ä§     ‚àÇ  ùêÆ    ‚àÇ  ùê±         superscript  ùêö  top       ùêÆ     ùê±      \mathbf{a}^{\top}\frac{\partial\mathbf{u}}{\partial\mathbf{x}}      assumes numerator layout¬†of     ‚àÇ  ùêÆ    ‚àÇ  ùê±         ùêÆ     ùê±     \frac{\partial\mathbf{u}}{\partial\mathbf{x}}             ‚àÇ  ùêÆ    ‚àÇ  ùê±    ùêö          ùêÆ     ùê±    ùêö    \frac{\partial\mathbf{u}}{\partial\mathbf{x}}\mathbf{a}      assumes denominator layout¬†of     ‚àÇ  ùêÆ    ‚àÇ  ùê±         ùêÆ     ùê±     \frac{\partial\mathbf{u}}{\partial\mathbf{x}}         a , b are not functions of x         ‚àÇ    ùêö  ‚ä§     ùê±  ùê±   ‚ä§   ùêõ     ‚àÇ  ùê±    =              superscript  a  top    superscript  xx  top   b      x    absent    \frac{\partial\;\textbf{a}^{\top}\textbf{x}\textbf{x}^{\top}\textbf{b}}{%
 \partial\;\textbf{x}}=           ùê±  ‚ä§    (     ùêö  ùêõ   ‚ä§   +    ùêõ  ùêö   ‚ä§    )        superscript  x  top      superscript  ab  top    superscript  ba  top      \textbf{x}^{\top}(\textbf{a}\textbf{b}^{\top}+\textbf{b}\textbf{a}^{\top})           (     ùêö  ùêõ   ‚ä§   +    ùêõ  ùêö   ‚ä§    )   ùê±         superscript  ab  top    superscript  ba  top    x    (\textbf{a}\textbf{b}^{\top}+\textbf{b}\textbf{a}^{\top})\textbf{x}        A , b , C , D , e are not functions of x         ‚àÇ    (   ùêÄ  ùê±   +  ùêõ  )   ‚ä§   ùêÇ   (   ùêÉ  ùê±   +  ùêû  )     ‚àÇ  ùê±    =          fragments    superscript   fragments  normal-(  Ax   b  normal-)   top   C   fragments  normal-(  Dx   e  normal-)      x    absent    \frac{\partial\;(\textbf{A}\textbf{x}+\textbf{b})^{\top}\textbf{C}(\textbf{D}%
 \textbf{x}+\textbf{e})}{\partial\;\textbf{x}}=             (    ùêÉ  ùê±   +  ùêû   )   ‚ä§    ùêÇ  ‚ä§   ùêÄ   +     (    ùêÄ  ùê±   +  ùêõ   )   ‚ä§    ùêÇ  ùêÉ           superscript    Dx  e   top    superscript  C  top   A      superscript    Ax  b   top   CD     (\textbf{D}\textbf{x}+\textbf{e})^{\top}\textbf{C}^{\top}\textbf{A}+(\textbf{A%
 }\textbf{x}+\textbf{b})^{\top}\textbf{C}\textbf{D}            ùêÉ  ‚ä§    ùêÇ  ‚ä§    (    ùêÄ  ùê±   +  ùêõ   )    +    ùêÄ  ‚ä§   ùêÇ   (    ùêÉ  ùê±   +  ùêû   )           superscript  D  top    superscript  C  top     Ax  b       superscript  A  top   C    Dx  e      \textbf{D}^{\top}\textbf{C}^{\top}(\textbf{A}\textbf{x}+\textbf{b})+\textbf{A}%
 ^{\top}\textbf{C}(\textbf{D}\textbf{x}+\textbf{e})        a is not a function of x         ‚àÇ   ‚à•   ùê±  -  ùêö   ‚à•     ‚àÇ  ùê±    =            norm    ùê±  ùêö       ùê±    absent    \frac{\partial\;\|\mathbf{x}-\mathbf{a}\|}{\partial\;\mathbf{x}}=            (   ùê±  -  ùêö   )   ‚ä§    ‚à•   ùê±  -  ùêö   ‚à•        superscript    ùê±  ùêö   top    norm    ùê±  ùêö      \frac{(\mathbf{x}-\mathbf{a})^{\top}}{\|\mathbf{x}-\mathbf{a}\|}           ùê±  -  ùêö    ‚à•   ùê±  -  ùêö   ‚à•         ùê±  ùêö    norm    ùê±  ùêö      \frac{\mathbf{x}-\mathbf{a}}{\|\mathbf{x}-\mathbf{a}\|}          Vector-by-scalar identities        Identities: vector-by-scalar     ‚àÇ  ùê≤    ‚àÇ  x         ùê≤     x     \frac{\partial\mathbf{y}}{\partial x}      scope="col" Condition   scope="col" Expression   scope="col" Numerator layout, i.e. by y , result is column vector   scope="col" Denominator layout, i.e. by y T , result is row vector     a is not a function of x         ‚àÇ  ùêö    ‚àÇ  x    =           ùêö     x    absent    \frac{\partial\mathbf{a}}{\partial x}=         ùüé   0   \mathbf{0}    8     a is not a function of x ,  u = u ( x )         ‚àÇ   a  ùêÆ     ‚àÇ  x    =             a  ùêÆ      x    absent    \frac{\partial a\mathbf{u}}{\partial x}=          a    ‚àÇ  ùêÆ    ‚àÇ  x        a      ùêÆ     x      a\frac{\partial\mathbf{u}}{\partial x}        A is not a function of x ,  u = u ( x )         ‚àÇ  ùêÄùêÆ    ‚àÇ  x    =           ùêÄùêÆ     x    absent    \frac{\partial\mathbf{A}\mathbf{u}}{\partial x}=          ùêÄ    ‚àÇ  ùêÆ    ‚àÇ  x        ùêÄ      ùêÆ     x      \mathbf{A}\frac{\partial\mathbf{u}}{\partial x}            ‚àÇ  ùêÆ    ‚àÇ  x     ùêÄ  ‚ä§           ùêÆ     x     superscript  ùêÄ  top     \frac{\partial\mathbf{u}}{\partial x}\mathbf{A}^{\top}        u = u ( x )         ‚àÇ   ùêÆ  ‚ä§     ‚àÇ  x    =            superscript  ùêÆ  top      x    absent    \frac{\partial\mathbf{u}^{\top}}{\partial x}=           (    ‚àÇ  ùêÆ    ‚àÇ  x    )   ‚ä§     superscript      ùêÆ     x    top    \left(\frac{\partial\mathbf{u}}{\partial x}\right)^{\top}        u = u ( x ), v = v ( x )         ‚àÇ   (   ùêÆ  +  ùêØ   )     ‚àÇ  x    =             ùêÆ  ùêØ      x    absent    \frac{\partial(\mathbf{u}+\mathbf{v})}{\partial x}=            ‚àÇ  ùêÆ    ‚àÇ  x    +    ‚àÇ  ùêØ    ‚àÇ  x            ùêÆ     x        ùêØ     x      \frac{\partial\mathbf{u}}{\partial x}+\frac{\partial\mathbf{v}}{\partial x}        u = u ( x ), v = v ( x )         ‚àÇ   (   ùêÆ  √ó  ùêØ   )     ‚àÇ  x    =             ùêÆ  ùêØ      x    absent    \frac{\partial(\mathbf{u}\times\mathbf{v})}{\partial x}=           ùêÆ  √ó    ‚àÇ  ùêØ    ‚àÇ  x     +     ‚àÇ  ùêÆ    ‚àÇ  x    √ó  ùêØ         ùêÆ      ùêØ     x           ùêÆ     x    ùêØ     \mathbf{u}\times\frac{\partial\mathbf{v}}{\partial x}+\frac{\partial\mathbf{u}%
 }{\partial x}\times\mathbf{v}        u = u ( x )          ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  x    =             ùê†   ùêÆ     x    absent    \frac{\partial\mathbf{g(u)}}{\partial x}=             ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ      ‚àÇ  ùêÆ    ‚àÇ  x              ùê†   ùêÆ     ùêÆ        ùêÆ     x      \frac{\partial\mathbf{g(u)}}{\partial\mathbf{u}}\frac{\partial\mathbf{u}}{%
 \partial x}            ‚àÇ  ùêÆ    ‚àÇ  x       ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ            ùêÆ     x          ùê†   ùêÆ     ùêÆ      \frac{\partial\mathbf{u}}{\partial x}\frac{\partial\mathbf{g(u)}}{\partial%
 \mathbf{u}}        Assumes consistent matrix layout; see below.     u = u ( x )          ‚àÇ  ùêü    (   ùê†   (  ùêÆ  )    )     ‚àÇ  x    =             ùêü     ùê†  ùêÆ      x    absent    \frac{\partial\mathbf{f(g(u))}}{\partial x}=             ‚àÇ  ùêü    (  ùê†  )     ‚àÇ  ùê†       ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ      ‚àÇ  ùêÆ    ‚àÇ  x              ùêü   ùê†     ùê†          ùê†   ùêÆ     ùêÆ        ùêÆ     x      \frac{\partial\mathbf{f(g)}}{\partial\mathbf{g}}\frac{\partial\mathbf{g(u)}}{%
 \partial\mathbf{u}}\frac{\partial\mathbf{u}}{\partial x}            ‚àÇ  ùêÆ    ‚àÇ  x       ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ       ‚àÇ  ùêü    (  ùê†  )     ‚àÇ  ùê†            ùêÆ     x          ùê†   ùêÆ     ùêÆ          ùêü   ùê†     ùê†      \frac{\partial\mathbf{u}}{\partial x}\frac{\partial\mathbf{g(u)}}{\partial%
 \mathbf{u}}\frac{\partial\mathbf{f(g)}}{\partial\mathbf{g}}        Assumes consistent matrix layout; see below.       NOTE : The formulas involving the vector-by-vector derivatives      ‚àÇ  ùê†    (  ùêÆ  )     ‚àÇ  ùêÆ           ùê†   ùêÆ     ùêÆ     \frac{\partial\mathbf{g(u)}}{\partial\mathbf{u}}   and      ‚àÇ  ùêü    (  ùê†  )     ‚àÇ  ùê†           ùêü   ùê†     ùê†     \frac{\partial\mathbf{f(g)}}{\partial\mathbf{g}}   (whose outputs are matrices) assume the matrices are laid out consistent with the vector layout, i.e. numerator-layout matrix when numerator-layout vector and vice versa; otherwise, transpose the vector-by-vector derivatives.  Scalar-by-matrix identities  Note that exact equivalents of the scalar product rule and chain rule do not exist when applied to matrix-valued functions of matrices. However, the product rule of this sort does apply to the differential form (see below), and this is the way to derive many of the identities below involving the trace function, combined with the fact that the trace function allows transposing and cyclic permutation, i.e.:       tr   (  ùêÄ  )    =   tr   (   ùêÄ  ‚ä§   )          tr  ùêÄ     tr   superscript  ùêÄ  top      {\rm tr}(\mathbf{A})={\rm tr}(\mathbf{A^{\top}})          tr   (  ùêÄùêÅùêÇùêÉ  )    =   tr   (  ùêÅùêÇùêÉùêÄ  )    =   tr   (  ùêÇùêÉùêÄùêÅ  )    =   tr   (  ùêÉùêÄùêÅùêÇ  )            tr  ùêÄùêÅùêÇùêÉ     tr  ùêÅùêÇùêÉùêÄ          tr  ùêÇùêÉùêÄùêÅ          tr  ùêÉùêÄùêÅùêÇ      {\rm tr}(\mathbf{ABCD})={\rm tr}(\mathbf{BCDA})={\rm tr}(\mathbf{CDAB})={\rm tr%
 }(\mathbf{DABC})     For example, to compute       ‚àÇ  tr    (    ùêÄùêóùêÅùêó  ‚ä§   ùêÇ   )     ‚àÇ  ùêó    :      normal-:        tr      superscript  ùêÄùêóùêÅùêó  top   ùêÇ      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{AXBX^{\top}C})}{\partial\mathbf{X}}:          d   tr   (    ùêÄùêóùêÅùêó  ‚ä§   ùêÇ   )       d  tr     superscript  ùêÄùêóùêÅùêó  top   ùêÇ     \displaystyle d\,{\rm tr}(\mathbf{AXBX^{\top}C})     Therefore,          ‚àÇ  tr    (    ùêÄùêóùêÅùêó  ‚ä§   ùêÇ   )     ‚àÇ  ùêó    =     ùêÅ  ‚ä§    ùêó  ‚ä§    ùêÄ  ‚ä§    ùêÇ  ‚ä§    +    ùêÅùêó  ‚ä§   ùêÇùêÄ     .            tr      superscript  ùêÄùêóùêÅùêó  top   ùêÇ      ùêó         superscript  ùêÅ  top    superscript  ùêó  top    superscript  ùêÄ  top    superscript  ùêÇ  top       superscript  ùêÅùêó  top   ùêÇùêÄ      \frac{\partial{\rm tr}(\mathbf{AXBX^{\top}C})}{\partial\mathbf{X}}=\mathbf{B^{%
 \top}X^{\top}A^{\top}C^{\top}}+\mathbf{BX^{\top}}\mathbf{CA}.     (For the last step, see the `Conversion from differential to derivative form' section.)        Identities: scalar-by-matrix     ‚àÇ  y    ‚àÇ  ùêó         y     ùêó     \frac{\partial y}{\partial\mathbf{X}}      scope="col" Condition   scope="col" Expression   scope="col" Numerator layout, i.e. by X T   scope="col" Denominator layout, i.e. by X     a is not a function of X         ‚àÇ  a    ‚àÇ  ùêó    =           a     ùêó    absent    \frac{\partial a}{\partial\mathbf{X}}=          ùüé  ‚ä§     superscript  0  top    \mathbf{0}^{\top}    9      ùüé   0   \mathbf{0}    10     a is not a function of X , u = u ( X )         ‚àÇ   a  u     ‚àÇ  ùêó    =             a  u      ùêó    absent    \frac{\partial au}{\partial\mathbf{X}}=          a    ‚àÇ  u    ‚àÇ  ùêó        a      u     ùêó      a\frac{\partial u}{\partial\mathbf{X}}        u = u ( X ), v = v ( X )         ‚àÇ   (   u  +  v   )     ‚àÇ  ùêó    =             u  v      ùêó    absent    \frac{\partial(u+v)}{\partial\mathbf{X}}=            ‚àÇ  u    ‚àÇ  ùêó    +    ‚àÇ  v    ‚àÇ  ùêó            u     ùêó        v     ùêó      \frac{\partial u}{\partial\mathbf{X}}+\frac{\partial v}{\partial\mathbf{X}}        u = u ( X ), v = v ( X )         ‚àÇ   u  v     ‚àÇ  ùêó    =             u  v      ùêó    absent    \frac{\partial uv}{\partial\mathbf{X}}=           u    ‚àÇ  v    ‚àÇ  ùêó     +   v    ‚àÇ  u    ‚àÇ  ùêó           u      v     ùêó       v      u     ùêó       u\frac{\partial v}{\partial\mathbf{X}}+v\frac{\partial u}{\partial\mathbf{X}}        u = u ( X )          ‚àÇ  g    (  u  )     ‚àÇ  ùêó    =             g   u     ùêó    absent    \frac{\partial g(u)}{\partial\mathbf{X}}=             ‚àÇ  g    (  u  )     ‚àÇ  u      ‚àÇ  u    ‚àÇ  ùêó              g   u     u        u     ùêó      \frac{\partial g(u)}{\partial u}\frac{\partial u}{\partial\mathbf{X}}        u = u ( X )          ‚àÇ  f    (   g   (  u  )    )     ‚àÇ  ùêó    =             f     g  u      ùêó    absent    \frac{\partial f(g(u))}{\partial\mathbf{X}}=             ‚àÇ  f    (  g  )     ‚àÇ  g       ‚àÇ  g    (  u  )     ‚àÇ  u      ‚àÇ  u    ‚àÇ  ùêó              f   g     g          g   u     u        u     ùêó      \frac{\partial f(g)}{\partial g}\frac{\partial g(u)}{\partial u}\frac{\partial
 u%
 }{\partial\mathbf{X}}        U = U ( X )   11        ‚àÇ  g    (  ùêî  )     ‚àÇ   X   i  j      =             g   ùêî      subscript  X    i  j      absent    \frac{\partial g(\mathbf{U})}{\partial X_{ij}}=      |    tr   (      ‚àÇ  g    (  ùêî  )     ‚àÇ  ùêî      ‚àÇ  ùêî    ‚àÇ   X   i  j       )       tr          g   ùêî     ùêî        ùêî      subscript  X    i  j         {\rm tr}\left(\frac{\partial g(\mathbf{U})}{\partial\mathbf{U}}\frac{\partial%
 \mathbf{U}}{\partial X_{ij}}\right)      |    tr   (     (     ‚àÇ  g    (  ùêî  )     ‚àÇ  ùêî    )   ‚ä§     ‚àÇ  ùêî    ‚àÇ   X   i  j       )       tr     superscript        g   ùêî     ùêî    top       ùêî      subscript  X    i  j         {\rm tr}\left(\left(\frac{\partial g(\mathbf{U})}{\partial\mathbf{U}}\right)^{%
 \top}\frac{\partial\mathbf{U}}{\partial X_{ij}}\right)        Both forms assume numerator layout for      ‚àÇ  ùêî    ‚àÇ   X   i  j      ,        ùêî      subscript  X    i  j       \frac{\partial\mathbf{U}}{\partial X_{ij}},    i.e. mixed layout if denominator layout for X is being used.             ‚àÇ  tr    (  ùêó  )     ‚àÇ  ùêó    =             tr   ùêó     ùêó    absent    \frac{\partial{\rm tr}(\mathbf{X})}{\partial\mathbf{X}}=         ùêà   ùêà   \mathbf{I}        U = U ( X ), V = V ( X )          ‚àÇ  tr    (   ùêî  +  ùêï   )     ‚àÇ  ùêó    =             tr     ùêî  ùêï      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{U}+\mathbf{V})}{\partial\mathbf{X}}=             ‚àÇ  tr    (  ùêî  )     ‚àÇ  ùêó    +     ‚àÇ  tr    (  ùêï  )     ‚àÇ  ùêó              tr   ùêî     ùêó          tr   ùêï     ùêó      \frac{\partial{\rm tr}(\mathbf{U})}{\partial\mathbf{X}}+\frac{\partial{\rm tr}%
 (\mathbf{V})}{\partial\mathbf{X}}        a is not a function of X ,  U = U ( X )          ‚àÇ  tr    (   a  ùêî   )     ‚àÇ  ùêó    =             tr     a  ùêî      ùêó    absent    \frac{\partial{\rm tr}(a\mathbf{U})}{\partial\mathbf{X}}=          a     ‚àÇ  tr    (  ùêî  )     ‚àÇ  ùêó        a        tr   ùêî     ùêó      a\frac{\partial{\rm tr}(\mathbf{U})}{\partial\mathbf{X}}        g ( X ) is any polynomial with scalar coefficients, or any matrix function defined by an infinite polynomial series (e.g. e X , sin( X ), cos( X ), ln( X ), etc. using a Taylor series ); g ( x ) is the equivalent scalar function, g ‚Ä≤ ( x ) is its derivative, and g ‚Ä≤ ( X ) is the corresponding matrix function          ‚àÇ  tr    (   ùê†   (  ùêó  )    )     ‚àÇ  ùêó    =             tr     ùê†  ùêó      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{g(X)})}{\partial\mathbf{X}}=           ùê†  ‚Ä≤    (  ùêó  )        superscript  ùê†  normal-‚Ä≤   ùêó    \mathbf{g}^{\prime}(\mathbf{X})           (    ùê†  ‚Ä≤    (  ùêó  )    )   ‚ä§     superscript     superscript  ùê†  normal-‚Ä≤   ùêó   top    (\mathbf{g}^{\prime}(\mathbf{X}))^{\top}        A is not a function of X   12       ‚àÇ  ‚ä§   (  ùêÄùêó  )     ‚àÇ  ùêó    =     ‚àÇ  tr    (  ùêóùêÄ  )     ‚àÇ  ùêó    =            top   ùêÄùêó     ùêó          tr   ùêóùêÄ     ùêó         absent     \frac{\partial\top(\mathbf{AX})}{\partial\mathbf{X}}=\frac{\partial{\rm tr}(%
 \mathbf{XA})}{\partial\mathbf{X}}=         ùêÄ   ùêÄ   \mathbf{A}          ùêÄ  ‚ä§     superscript  ùêÄ  top    \mathbf{A}^{\top}        A is not a function of X   13        ‚àÇ  tr    (   ùêÄùêó  ‚ä§   )     ‚àÇ  ùêó    =     ‚àÇ  tr    (    ùêó  ‚ä§   ùêÄ   )     ‚àÇ  ùêó    =               tr    superscript  ùêÄùêó  top      ùêó          tr      superscript  ùêó  top   ùêÄ      ùêó         absent     \frac{\partial{\rm tr}(\mathbf{AX^{\top}})}{\partial\mathbf{X}}=\frac{\partial%
 {\rm tr}(\mathbf{X^{\top}A})}{\partial\mathbf{X}}=          ùêÄ  ‚ä§     superscript  ùêÄ  top    \mathbf{A}^{\top}         ùêÄ   ùêÄ   \mathbf{A}        A is not a function of X   14        ‚àÇ  tr    (    ùêó  ‚ä§   ùêÄùêó   )     ‚àÇ  ùêó    =             tr      superscript  ùêó  top   ùêÄùêó      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{X^{\top}AX})}{\partial\mathbf{X}}=           ùêó  ‚ä§    (   ùêÄ  +   ùêÄ  ‚ä§    )        superscript  ùêó  top     ùêÄ   superscript  ùêÄ  top      \mathbf{X}^{\top}(\mathbf{A}+\mathbf{A}^{\top})           (   ùêÄ  +   ùêÄ  ‚ä§    )   ùêó        ùêÄ   superscript  ùêÄ  top    ùêó    (\mathbf{A}+\mathbf{A}^{\top})\mathbf{X}        A is not a function of X   15        ‚àÇ  tr    (    ùêó   -  ùüè    ùêÄ   )     ‚àÇ  ùêó    =             tr      superscript  ùêó    1    ùêÄ      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{X^{-1}A})}{\partial\mathbf{X}}=          -     (   ùêó   -  1    )   ‚ä§   ùêÄ    (   ùêó   -  1    )   ‚ä§           superscript   superscript  ùêó    1    top   ùêÄ   superscript   superscript  ùêó    1    top      -(\mathbf{X}^{-1})^{\top}\mathbf{A}(\mathbf{X}^{-1})^{\top}          -    ùêó   -  1     ùêÄ  ‚ä§    ùêó   -  1            superscript  ùêó    1     superscript  ùêÄ  top    superscript  ùêó    1       -\mathbf{X}^{-1}\mathbf{A}^{\top}\mathbf{X}^{-1}        A , B are not functions of X          ‚àÇ  tr    (  ùêÄùêóùêÅ  )     ‚àÇ  ùêó    =     ‚àÇ  tr    (  ùêÅùêÄùêó  )     ‚àÇ  ùêó    =               tr   ùêÄùêóùêÅ     ùêó          tr   ùêÅùêÄùêó     ùêó         absent     \frac{\partial{\rm tr}(\mathbf{AXB})}{\partial\mathbf{X}}=\frac{\partial{\rm tr%
 }(\mathbf{BAX})}{\partial\mathbf{X}}=         ùêÅùêÄ   ùêÅùêÄ   \mathbf{BA}           ùêÄ  ‚ä§    ùêÅ  ‚ä§        superscript  ùêÄ  top    superscript  ùêÅ  top     \mathbf{A^{\top}B^{\top}}        A , B , C are not functions of X          ‚àÇ  tr    (    ùêÄùêóùêÅùêó  ‚ä§   ùêÇ   )     ‚àÇ  ùêó    =             tr      superscript  ùêÄùêóùêÅùêó  top   ùêÇ      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{AXBX^{\top}C})}{\partial\mathbf{X}}=            ùêÅùêó  ‚ä§   ùêÇùêÄ   +    ùêÅ  ‚ä§    ùêó  ‚ä§    ùêÄ  ‚ä§    ùêÇ  ‚ä§           superscript  ùêÅùêó  top   ùêÇùêÄ      superscript  ùêÅ  top    superscript  ùêó  top    superscript  ùêÄ  top    superscript  ùêÇ  top      \mathbf{BX^{\top}CA}+\mathbf{B^{\top}X^{\top}A^{\top}C^{\top}}            ùêÄ  ‚ä§    ùêÇ  ‚ä§    ùêóùêÅ  ‚ä§    +  ùêÇùêÄùêóùêÅ         superscript  ùêÄ  top    superscript  ùêÇ  top    superscript  ùêóùêÅ  top    ùêÇùêÄùêóùêÅ    \mathbf{A^{\top}C^{\top}XB^{\top}}+\mathbf{CAXB}        n is a positive integer   16        ‚àÇ  tr    (   ùêó  n   )     ‚àÇ  ùêó    =             tr    superscript  ùêó  n      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{X}^{n})}{\partial\mathbf{X}}=          n   ùêó   n  -  1        n   superscript  ùêó    n  1      n\mathbf{X}^{n-1}          n    (   ùêó   n  -  1    )   ‚ä§       n   superscript   superscript  ùêó    n  1    top     n(\mathbf{X}^{n-1})^{\top}        A is not a function of X ,  n is a positive integer   17        ‚àÇ  tr    (   ùêÄùêó  n   )     ‚àÇ  ùêó    =             tr    superscript  ùêÄùêó  n      ùêó    absent    \frac{\partial{\rm tr}(\mathbf{A}\mathbf{X}^{n})}{\partial\mathbf{X}}=           ‚àë   i  =  0    n  -  1      ùêó  i    ùêÄùêó   n  -  i  -  1         superscript   subscript     i  0      n  1       superscript  ùêó  i    superscript  ùêÄùêó    n  i  1       \sum_{i=0}^{n-1}\mathbf{X}^{i}\mathbf{A}\mathbf{X}^{n-i-1}           ‚àë   i  =  0    n  -  1      (    ùêó  i    ùêÄùêó   n  -  i  -  1     )   ‚ä§       superscript   subscript     i  0      n  1     superscript     superscript  ùêó  i    superscript  ùêÄùêó    n  i  1     top     \sum_{i=0}^{n-1}(\mathbf{X}^{i}\mathbf{A}\mathbf{X}^{n-i-1})^{\top}         18        ‚àÇ  tr    (   e  ùêó   )     ‚àÇ  ùêó    =             tr    superscript  e  ùêó      ùêó    absent    \frac{\partial{\rm tr}(e^{\mathbf{X}})}{\partial\mathbf{X}}=          e  ùêó     superscript  e  ùêó    e^{\mathbf{X}}           (   e  ùêó   )   ‚ä§     superscript   superscript  e  ùêó   top    (e^{\mathbf{X}})^{\top}         19        ‚àÇ  tr    (   sin   (  ùêó  )    )     ‚àÇ  ùêó    =             tr     ùêó      ùêó    absent    \frac{\partial{\rm tr}(\sin(\mathbf{X}))}{\partial\mathbf{X}}=          cos   (  ùêó  )       ùêó    \cos(\mathbf{X})           (   cos   (  ùêó  )    )   ‚ä§     superscript    ùêó   top    (\cos(\mathbf{X}))^{\top}         20       ‚àÇ   |  ùêó  |     ‚àÇ  ùêó    =             ùêó      ùêó    absent    \frac{\partial|\mathbf{X}|}{\partial\mathbf{X}}=          cofactor    (  X  )   ‚ä§   =  |  ùêó  |   ùêó   -  1       fragments  cofactor   superscript   fragments  normal-(  X  normal-)   top    normal-|  X  normal-|   superscript  ùêó    1      \operatorname{cofactor}(X)^{\top}=|\mathbf{X}|\mathbf{X}^{-1}           cofactor   (  X  )    =    |  ùêó  |     (   ùêó   -  1    )   ‚ä§         cofactor  X       ùêó    superscript   superscript  ùêó    1    top      \operatorname{cofactor}(X)=|\mathbf{X}|(\mathbf{X}^{-1})^{\top}        a is not a function of X   21        ‚àÇ  ln    |   a  ùêó   |     ‚àÇ  ùêó    =                  a  ùêó       ùêó    absent    \frac{\partial\ln|a\mathbf{X}|}{\partial\mathbf{X}}=    The constant a disappears in the result. This is intentional. In general,          d    ln   a  u      d  x    =    1   a  u      d   (   a  u   )     d  x     =    1   a  u    a    d  u    d  x     =    1  u     d  u    d  x     =     d    ln  u     d  x     .            d      a  u       d  x        1    a  u        d    a  u      d  x              1    a  u    a      d  u     d  x              1  u       d  u     d  x              d    u      d  x       \frac{d\,\ln au}{dx}=\frac{1}{au}\frac{d(au)}{dx}=\frac{1}{au}a\frac{du}{dx}=%
 \frac{1}{u}\frac{du}{dx}=\frac{d\,\ln u}{dx}.      |    ùêó   -  1      superscript  ùêó    1     \mathbf{X}^{-1}           (   ùêó   -  1    )   ‚ä§     superscript   superscript  ùêó    1    top    (\mathbf{X}^{-1})^{\top}        A , B are not functions of X   22       ‚àÇ   |  ùêÄùêóùêÅ  |     ‚àÇ  ùêó    =             ùêÄùêóùêÅ      ùêó    absent    \frac{\partial|\mathbf{AXB}|}{\partial\mathbf{X}}=           |  ùêÄùêóùêÅ  |    ùêó   -  1          ùêÄùêóùêÅ    superscript  ùêó    1      |\mathbf{AXB}|\mathbf{X}^{-1}           |  ùêÄùêóùêÅ  |     (   ùêó   -  1    )   ‚ä§         ùêÄùêóùêÅ    superscript   superscript  ùêó    1    top     |\mathbf{AXB}|(\mathbf{X}^{-1})^{\top}        n is a positive integer   23       ‚àÇ   |   ùêó  n   |     ‚àÇ  ùêó    =              superscript  ùêó  n       ùêó    absent    \frac{\partial|\mathbf{X}^{n}|}{\partial\mathbf{X}}=          n   |   ùêó  n   |    ùêó   -  1        n     superscript  ùêó  n     superscript  ùêó    1      n|\mathbf{X}^{n}|\mathbf{X}^{-1}          n   |   ùêó  n   |     (   ùêó   -  1    )   ‚ä§       n     superscript  ùêó  n     superscript   superscript  ùêó    1    top     n|\mathbf{X}^{n}|(\mathbf{X}^{-1})^{\top}        (see pseudo-inverse )   24        ‚àÇ  ln    |    ùêó  ‚ä§   ùêó   |     ‚àÇ  ùêó    =                   superscript  ùêó  top   ùêó       ùêó    absent    \frac{\partial\ln|\mathbf{X}^{\top}\mathbf{X}|}{\partial\mathbf{X}}=          2   ùêó  +       2   superscript  ùêó      2\mathbf{X}^{+}          2    (   ùêó  +   )   ‚ä§       2   superscript   superscript  ùêó    top     2(\mathbf{X}^{+})^{\top}        (see pseudo-inverse )   25        ‚àÇ  ln    |    ùêó  ‚ä§   ùêó   |     ‚àÇ   ùêó  +     =                   superscript  ùêó  top   ùêó        superscript  ùêó      absent    \frac{\partial\ln|\mathbf{X}^{\top}\mathbf{X}|}{\partial\mathbf{X}^{+}}=          -   2  ùêó         2  ùêó     -2\mathbf{X}          -   2   ùêó  ‚ä§          2   superscript  ùêó  top      -2\mathbf{X}^{\top}        A is not a function of X ,  X is square and invertible         ‚àÇ   |    ùêó  ‚ä§   ùêÄùêó   |     ‚àÇ  ùêó    =                superscript  ùêó  top   ùêÄùêó       ùêó    absent    \frac{\partial|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|}{\partial\mathbf{X}}=          2   |    ùêó  ‚ä§   ùêÄùêó   |    ùêó   -  1        2       superscript  ùêó  top   ùêÄùêó     superscript  ùêó    1      2|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|\mathbf{X}^{-1}          2   |    ùêó  ‚ä§   ùêÄùêó   |     (   ùêó   -  1    )   ‚ä§       2       superscript  ùêó  top   ùêÄùêó     superscript   superscript  ùêó    1    top     2|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|(\mathbf{X}^{-1})^{\top}        A is not a function of X ,  X is non-square,  A is symmetric         ‚àÇ   |    ùêó  ‚ä§   ùêÄùêó   |     ‚àÇ  ùêó    =                superscript  ùêó  top   ùêÄùêó       ùêó    absent    \frac{\partial|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|}{\partial\mathbf{X}}=          2   |    ùêó  ‚ä§   ùêÄùêó   |     (    ùêó  ‚ä§    ùêÄ  ‚ä§   ùêó   )    -  1     ùêó  ‚ä§    ùêÄ  ‚ä§       2       superscript  ùêó  top   ùêÄùêó     superscript     superscript  ùêó  top    superscript  ùêÄ  top   ùêó     1     superscript  ùêó  top    superscript  ùêÄ  top     2|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|(\mathbf{X^{\top}A^{\top}X})^{-1}%
 \mathbf{X^{\top}A^{\top}}          2   |    ùêó  ‚ä§   ùêÄùêó   |   ùêÄùêó    (    ùêó  ‚ä§   ùêÄùêó   )    -  1        2       superscript  ùêó  top   ùêÄùêó    ùêÄùêó   superscript     superscript  ùêó  top   ùêÄùêó     1      2|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|\mathbf{AX}(\mathbf{X^{\top}AX})^{-1}        A is not a function of X ,  X is non-square,  A is non-symmetric         ‚àÇ   |    ùêó  ‚ä§   ùêÄùêó   |     ‚àÇ  ùêó    =                superscript  ùêó  top   ùêÄùêó       ùêó    absent    \frac{\partial|\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|}{\partial\mathbf{X}}=      |    |   ùêó  ‚ä§   ùêÄùêó  |   (    (   ùêó  ‚ä§   ùêÄùêó  )    -  1     ùêó  ‚ä§   ùêÄ      fragments  normal-|   superscript  ùêó  top   AX  normal-|   fragments  normal-(   superscript   fragments  normal-(   superscript  ùêó  top   AX  normal-)     1     superscript  ùêó  top   A     |\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|((\mathbf{X^{\top}AX})^{-1}\mathbf{X^{%
 \top}A}           +    (   ùêó  ‚ä§    ùêÄ  ‚ä§   ùêó  )    -  1     ùêó  ‚ä§    ùêÄ  ‚ä§   )     fragments    superscript   fragments  normal-(   superscript  ùêó  top    superscript  ùêÄ  top   X  normal-)     1     superscript  ùêó  top    superscript  ùêÄ  top   normal-)    +(\mathbf{X^{\top}A^{\top}X})^{-1}\mathbf{X^{\top}A^{\top}})         |    |   ùêó  ‚ä§   ùêÄùêó  |   (  ùêÄùêó    (   ùêó  ‚ä§   ùêÄùêó  )    -  1        fragments  normal-|   superscript  ùêó  top   AX  normal-|   fragments  normal-(  AX   superscript   fragments  normal-(   superscript  ùêó  top   AX  normal-)     1       |\mathbf{X^{\top}}\mathbf{A}\mathbf{X}|(\mathbf{AX}(\mathbf{X^{\top}AX})^{-1}           +   ùêÄ  ‚ä§   ùêó    (   ùêó  ‚ä§    ùêÄ  ‚ä§   ùêó  )    -  1    )     fragments    superscript  ùêÄ  top   X   superscript   fragments  normal-(   superscript  ùêó  top    superscript  ùêÄ  top   X  normal-)     1    normal-)    +\mathbf{A^{\top}X}(\mathbf{X^{\top}A^{\top}X})^{-1})             Matrix-by-scalar identities        Identities: matrix-by-scalar     ‚àÇ  ùêò    ‚àÇ  x         ùêò     x     \frac{\partial\mathbf{Y}}{\partial x}      scope="col" Condition   scope="col" Expression   scope="col" Numerator layout, i.e. by Y     U = U ( x )         ‚àÇ   a  ùêî     ‚àÇ  x    =             a  ùêî      x    absent    \frac{\partial a\mathbf{U}}{\partial x}=          a    ‚àÇ  ùêî    ‚àÇ  x        a      ùêî     x      a\frac{\partial\mathbf{U}}{\partial x}        A , B are not functions of x ,  U = U ( x )         ‚àÇ  ùêÄùêîùêÅ    ‚àÇ  x    =           ùêÄùêîùêÅ     x    absent    \frac{\partial\mathbf{AUB}}{\partial x}=          ùêÄ    ‚àÇ  ùêî    ‚àÇ  x    ùêÅ      ùêÄ      ùêî     x    ùêÅ    \mathbf{A}\frac{\partial\mathbf{U}}{\partial x}\mathbf{B}        U = U ( x ), V = V ( x )         ‚àÇ   (   ùêî  +  ùêï   )     ‚àÇ  x    =             ùêî  ùêï      x    absent    \frac{\partial(\mathbf{U}+\mathbf{V})}{\partial x}=            ‚àÇ  ùêî    ‚àÇ  x    +    ‚àÇ  ùêï    ‚àÇ  x            ùêî     x        ùêï     x      \frac{\partial\mathbf{U}}{\partial x}+\frac{\partial\mathbf{V}}{\partial x}        U = U ( x ), V = V ( x )         ‚àÇ   (  ùêîùêï  )     ‚àÇ  x    =           ùêîùêï     x    absent    \frac{\partial(\mathbf{U}\mathbf{V})}{\partial x}=           ùêî    ‚àÇ  ùêï    ‚àÇ  x     +     ‚àÇ  ùêî    ‚àÇ  x    ùêï         ùêî      ùêï     x           ùêî     x    ùêï     \mathbf{U}\frac{\partial\mathbf{V}}{\partial x}+\frac{\partial\mathbf{U}}{%
 \partial x}\mathbf{V}        U = U ( x ), V = V ( x )         ‚àÇ   (   ùêî  ‚äó  ùêï   )     ‚àÇ  x    =            tensor-product  ùêî  ùêï      x    absent    \frac{\partial(\mathbf{U}\otimes\mathbf{V})}{\partial x}=           ùêî  ‚äó    ‚àÇ  ùêï    ‚àÇ  x     +     ‚àÇ  ùêî    ‚àÇ  x    ‚äó  ùêï        tensor-product  ùêî      ùêï     x      tensor-product      ùêî     x    ùêï     \mathbf{U}\otimes\frac{\partial\mathbf{V}}{\partial x}+\frac{\partial\mathbf{U%
 }}{\partial x}\otimes\mathbf{V}        U = U ( x ), V = V ( x )         ‚àÇ   (   ùêî  ‚àò  ùêï   )     ‚àÇ  x    =             ùêî  ùêï      x    absent    \frac{\partial(\mathbf{U}\circ\mathbf{V})}{\partial x}=           ùêî  ‚àò    ‚àÇ  ùêï    ‚àÇ  x     +     ‚àÇ  ùêî    ‚àÇ  x    ‚àò  ùêï         ùêî      ùêï     x           ùêî     x    ùêï     \mathbf{U}\circ\frac{\partial\mathbf{V}}{\partial x}+\frac{\partial\mathbf{U}}%
 {\partial x}\circ\mathbf{V}        U = U ( x )         ‚àÇ   ùêî   -  1      ‚àÇ  x    =            superscript  ùêî    1       x    absent    \frac{\partial\mathbf{U}^{-1}}{\partial x}=          -    ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x     ùêî   -  1            superscript  ùêî    1        ùêî     x     superscript  ùêî    1       -\mathbf{U}^{-1}\frac{\partial\mathbf{U}}{\partial x}\mathbf{U}^{-1}        U = U ( x,y )          ‚àÇ  2    ùêî   -  1       ‚àÇ  x    ‚àÇ  y     =           superscript   2    superscript  ùêî    1         x     y     absent    \frac{\partial^{2}\mathbf{U}^{-1}}{\partial x\partial y}=           ùêî   -  1     (       ‚àÇ  ùêî    ‚àÇ  x     ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  y     -     ‚àÇ  2   ùêî     ‚àÇ  x    ‚àÇ  y      +     ‚àÇ  ùêî    ‚àÇ  y     ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x      )    ùêî   -  1         superscript  ùêî    1              ùêî     x     superscript  ùêî    1        ùêî     y         superscript   2   ùêî       x     y            ùêî     y     superscript  ùêî    1        ùêî     x       superscript  ùêî    1      \mathbf{U}^{-1}\left(\frac{\partial\mathbf{U}}{\partial x}\mathbf{U}^{-1}\frac%
 {\partial\mathbf{U}}{\partial y}-\frac{\partial^{2}\mathbf{U}}{\partial x%
 \partial y}+\frac{\partial\mathbf{U}}{\partial y}\mathbf{U}^{-1}\frac{\partial%
 \mathbf{U}}{\partial x}\right)\mathbf{U}^{-1}        A is not a function of x , g ( X ) is any polynomial with scalar coefficients, or any matrix function defined by an infinite polynomial series (e.g. e X , sin( X ), cos( X ), ln( X ), etc.); g ( x ) is the equivalent scalar function, g ‚Ä≤ ( x ) is its derivative, and g ‚Ä≤ ( X ) is the corresponding matrix function          ‚àÇ  ùê†    (   x  ùêÄ   )     ‚àÇ  x    =             ùê†     x  ùêÄ      x    absent    \frac{\partial\,\mathbf{g}(x\mathbf{A})}{\partial x}=            ùêÄùê†  ‚Ä≤    (   x  ùêÄ   )    =    ùê†  ‚Ä≤    (   x  ùêÄ   )   ùêÄ          superscript  ùêÄùê†  normal-‚Ä≤     x  ùêÄ       superscript  ùê†  normal-‚Ä≤     x  ùêÄ   ùêÄ     \mathbf{A}\mathbf{g}^{\prime}(x\mathbf{A})=\mathbf{g}^{\prime}(x\mathbf{A})%
 \mathbf{A}        A is not a function of x         ‚àÇ   e   x  ùêÄ      ‚àÇ  x    =            superscript  e    x  ùêÄ       x    absent    \frac{\partial e^{x\mathbf{A}}}{\partial x}=           ùêÄ   e   x  ùêÄ     =    e   x  ùêÄ    ùêÄ         ùêÄ   superscript  e    x  ùêÄ        superscript  e    x  ùêÄ    ùêÄ     \mathbf{A}e^{x\mathbf{A}}=e^{x\mathbf{A}}\mathbf{A}          Further see Derivative of the exponential map .  Scalar-by-scalar identities  With vectors involved        Identities: scalar-by-scalar, with vectors involved   scope="col" Condition   scope="col" Expression   scope="col" Any layout (assumes dot product ignores row vs. column layout)     u = u ( x )          ‚àÇ  g    (  ùêÆ  )     ‚àÇ  x    =             g   ùêÆ     x    absent    \frac{\partial g(\mathbf{u})}{\partial x}=             ‚àÇ  g    (  ùêÆ  )     ‚àÇ  ùêÆ    ‚ãÖ    ‚àÇ  ùêÆ    ‚àÇ  x       normal-‚ãÖ        g   ùêÆ     ùêÆ        ùêÆ     x      \frac{\partial g(\mathbf{u})}{\partial\mathbf{u}}\cdot\frac{\partial\mathbf{u}%
 }{\partial x}        u = u ( x ), v = v ( x )         ‚àÇ   (   ùêÆ  ‚ãÖ  ùêØ   )     ‚àÇ  x    =            normal-‚ãÖ  ùêÆ  ùêØ      x    absent    \frac{\partial(\mathbf{u}\cdot\mathbf{v})}{\partial x}=           ùêÆ  ‚ãÖ    ‚àÇ  ùêØ    ‚àÇ  x     +     ‚àÇ  ùêÆ    ‚àÇ  x    ‚ãÖ  ùêØ        normal-‚ãÖ  ùêÆ      ùêØ     x      normal-‚ãÖ      ùêÆ     x    ùêØ     \mathbf{u}\cdot\frac{\partial\mathbf{v}}{\partial x}+\frac{\partial\mathbf{u}}%
 {\partial x}\cdot\mathbf{v}          With matrices involved        Identities: scalar-by-scalar, with matrices involved 26   scope="col" Condition   scope="col" Expression   scope="col" Consistent numerator layout, i.e. by Y and X T   scope="col" Mixed layout, i.e. by Y and X     U = U ( x )         ‚àÇ   |  ùêî  |     ‚àÇ  x    =             ùêî      x    absent    \frac{\partial|\mathbf{U}|}{\partial x}=           |  ùêî  |   tr   (    ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x     )         ùêî   tr     superscript  ùêî    1        ùêî     x       |\mathbf{U}|{\rm tr}\left(\mathbf{U}^{-1}\frac{\partial\mathbf{U}}{\partial x}\right)        U = U ( x )          ‚àÇ  ln    |  ùêî  |     ‚àÇ  x    =                ùêî      x    absent    \frac{\partial\ln|\mathbf{U}|}{\partial x}=          tr   (    ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x     )       tr     superscript  ùêî    1        ùêî     x       {\rm tr}\left(\mathbf{U}^{-1}\frac{\partial\mathbf{U}}{\partial x}\right)        U = U ( x )          ‚àÇ  2    |  ùêî  |     ‚àÇ   x  2     =           superscript   2     ùêî       superscript  x  2     absent    \frac{\partial^{2}|\mathbf{U}|}{\partial x^{2}}=           |  ùêî  |    [     tr   (    ùêî   -  1       ‚àÇ  2   ùêî    ‚àÇ   x  2      )    +    (   tr   (    ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x     )    )   2    -   tr   (    (    ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x     )    (    ùêî   -  1      ‚àÇ  ùêî    ‚àÇ  x     )    )     ]         ùêî    delimited-[]        tr     superscript  ùêî    1        superscript   2   ùêî      superscript  x  2        superscript    tr     superscript  ùêî    1        ùêî     x      2      tr       superscript  ùêî    1        ùêî     x        superscript  ùêî    1        ùêî     x           |\mathbf{U}|\left[{\rm tr}\left(\mathbf{U}^{-1}\frac{\partial^{2}\mathbf{U}}{%
 \partial x^{2}}\right)+\left({\rm tr}\left(\mathbf{U}^{-1}\frac{\partial%
 \mathbf{U}}{\partial x}\right)\right)^{2}-{\rm tr}\left(\left(\mathbf{U}^{-1}%
 \frac{\partial\mathbf{U}}{\partial x}\right)\left(\mathbf{U}^{-1}\frac{%
 \partial\mathbf{U}}{\partial x}\right)\right)\right]        U = U ( x )          ‚àÇ  g    (  ùêî  )     ‚àÇ  x    =             g   ùêî     x    absent    \frac{\partial g(\mathbf{U})}{\partial x}=          tr   (      ‚àÇ  g    (  ùêî  )     ‚àÇ  ùêî      ‚àÇ  ùêî    ‚àÇ  x     )       tr          g   ùêî     ùêî        ùêî     x       {\rm tr}\left(\frac{\partial g(\mathbf{U})}{\partial\mathbf{U}}\frac{\partial%
 \mathbf{U}}{\partial x}\right)      |    tr   (     (     ‚àÇ  g    (  ùêî  )     ‚àÇ  ùêî    )   ‚ä§     ‚àÇ  ùêî    ‚àÇ  x     )       tr     superscript        g   ùêî     ùêî    top       ùêî     x       {\rm tr}\left(\left(\frac{\partial g(\mathbf{U})}{\partial\mathbf{U}}\right)^{%
 \top}\frac{\partial\mathbf{U}}{\partial x}\right)        A is not a function of x , g ( X ) is any polynomial with scalar coefficients, or any matrix function defined by an infinite polynomial series (e.g. e X , sin( X ), cos( X ), ln( X ), etc.); g ( x ) is the equivalent scalar function, g ‚Ä≤ ( x ) is its derivative, and g ‚Ä≤ ( X ) is the corresponding matrix function.          ‚àÇ  tr    (   ùê†   (   x  ùêÄ   )    )     ‚àÇ  x    =             tr     ùê†    x  ùêÄ       x    absent    \frac{\partial\,{\rm tr}(\mathbf{g}(x\mathbf{A}))}{\partial x}=          tr   (    ùêÄùê†  ‚Ä≤    (   x  ùêÄ   )    )       tr     superscript  ùêÄùê†  normal-‚Ä≤     x  ùêÄ      {\rm tr}(\mathbf{A}\mathbf{g}^{\prime}(x\mathbf{A}))        A is not a function of x          ‚àÇ  tr    (   e   x  ùêÄ    )     ‚àÇ  x    =             tr    superscript  e    x  ùêÄ       x    absent    \frac{\partial\,{\rm tr}(e^{x\mathbf{A}})}{\partial x}=          tr   (   ùêÄ   e   x  ùêÄ     )       tr    ùêÄ   superscript  e    x  ùêÄ       {\rm tr}(\mathbf{A}e^{x\mathbf{A}})          Identities in differential form  It is often easier to work in differential form and then convert back to normal derivatives. This only works well using the numerator layout. In these rules, "a" is a scalar.        Differential identities: scalar involving matrix 27 28   Condition   Expression   Result (numerator layout)           d   (   tr   (  ùêó  )    )    =         d    tr  ùêó    absent    d({\rm tr}(\mathbf{X}))=          tr   (   d  ùêó   )       tr    d  ùêó     {\rm tr}(d\mathbf{X})              d   (   |  ùêó  |   )    =         d    ùêó    absent    d(|\mathbf{X}|)=           |  ùêó  |   tr   (    ùêó   -  1    d  ùêó   )         ùêó   tr     superscript  ùêó    1    d  ùêó     |\mathbf{X}|{\rm tr}(\mathbf{X}^{-1}d\mathbf{X})              d   (   ln   |  ùêó  |    )    =         d      ùêó     absent    d(\ln|\mathbf{X}|)=          tr   (    ùêó   -  1    d  ùêó   )       tr     superscript  ùêó    1    d  ùêó     {\rm tr}(\mathbf{X}^{-1}d\mathbf{X})                Differential identities: matrix 29 30   Condition   Expression   Result (numerator layout)     A is not a function of X        d   (  ùêÄ  )    =         d  ùêÄ   absent    d(\mathbf{A})=         0   0         a is not a function of X        d   (   a  ùêó   )    =         d    a  ùêó    absent    d(a\mathbf{X})=           a   d  ùêó      a  d  ùêó    a\,d\mathbf{X}              d   (   ùêó  +  ùêò   )    =         d    ùêó  ùêò    absent    d(\mathbf{X}+\mathbf{Y})=           d  ùêó   +   d  ùêò         d  ùêó     d  ùêò     d\mathbf{X}+d\mathbf{Y}              d   (  ùêóùêò  )    =         d  ùêóùêò   absent    d(\mathbf{X}\mathbf{Y})=            (   d  ùêó   )   ùêò   +   ùêó   (   d  ùêò   )            d  ùêó   ùêò     ùêó    d  ùêò      (d\mathbf{X})\mathbf{Y}+\mathbf{X}(d\mathbf{Y})        ( Kronecker product )        d   (   ùêó  ‚äó  ùêò   )    =         d   tensor-product  ùêó  ùêò    absent    d(\mathbf{X}\otimes\mathbf{Y})=            (   d  ùêó   )   ‚äó  ùêò   +   ùêó  ‚äó   (   d  ùêò   )         tensor-product    d  ùêó   ùêò    tensor-product  ùêó    d  ùêò      (d\mathbf{X})\otimes\mathbf{Y}+\mathbf{X}\otimes(d\mathbf{Y})        ( Hadamard product )        d   (   ùêó  ‚àò  ùêò   )    =         d    ùêó  ùêò    absent    d(\mathbf{X}\circ\mathbf{Y})=            (   d  ùêó   )   ‚àò  ùêò   +   ùêó  ‚àò   (   d  ùêò   )            d  ùêó   ùêò     ùêó    d  ùêò      (d\mathbf{X})\circ\mathbf{Y}+\mathbf{X}\circ(d\mathbf{Y})              d   (   ùêó  ‚ä§   )    =         d   superscript  ùêó  top    absent    d(\mathbf{X}^{\top})=           (   d  ùêó   )   ‚ä§     superscript    d  ùêó   top    (d\mathbf{X})^{\top}        ( conjugate transpose )        d   (   ùêó  H   )    =         d   superscript  ùêó  normal-H    absent    d(\mathbf{X}^{\rm H})=           (   d  ùêó   )   H     superscript    d  ùêó   normal-H    (d\mathbf{X})^{\rm H}          To convert to normal derivative form, first convert it to one of the following canonical forms, and then use these identities:        Conversion from differential to derivative form 31   Canonical differential form   Equivalent derivative form          d  y   =    a   d  x         d  y     a  d  x     dy=a\,dx            d  y    d  x    =  a          d  y     d  x    a    \frac{dy}{dx}=a             d  y   =    ùêö   d  ùê±         d  y     ùêö  d  ùê±     dy=\mathbf{a}\,d\mathbf{x}            d  y    d  ùê±    =  ùêö          d  y     d  ùê±    ùêö    \frac{dy}{d\mathbf{x}}=\mathbf{a}             d  y   =   tr   (    ùêÄ   d  ùêó   )          d  y     tr    ùêÄ  d  ùêó      dy={\rm tr}(\mathbf{A}\,d\mathbf{X})            d  y    d  ùêó    =  ùêÄ          d  y     d  ùêó    ùêÄ    \frac{dy}{d\mathbf{X}}=\mathbf{A}             d  ùê≤   =    ùêö   d  x         d  ùê≤     ùêö  d  x     d\mathbf{y}=\mathbf{a}\,dx            d  ùê≤    d  x    =  ùêö          d  ùê≤     d  x    ùêö    \frac{d\mathbf{y}}{dx}=\mathbf{a}             d  ùê≤   =    ùêÄ   d  ùê±         d  ùê≤     ùêÄ  d  ùê±     d\mathbf{y}=\mathbf{A}\,d\mathbf{x}            d  ùê≤    d  ùê±    =  ùêÄ          d  ùê≤     d  ùê±    ùêÄ    \frac{d\mathbf{y}}{d\mathbf{x}}=\mathbf{A}             d  ùêò   =    ùêÄ   d  x         d  ùêò     ùêÄ  d  x     d\mathbf{Y}=\mathbf{A}\,dx            d  ùêò    d  x    =  ùêÄ          d  ùêò     d  x    ùêÄ    \frac{d\mathbf{Y}}{dx}=\mathbf{A}          See also   Derivative (generalizations)  Product integral   Notes    External links   Linear Algebra: Determinants, Inverses, Rank appendix D from Introduction to Finite Element Methods book on University of Colorado at Boulder . Uses the Hessian ( transpose to Jacobian ) definition of vector and matrix derivatives.  Matrix Reference Manual , Mike Brookes, Imperial College London .  The Matrix Cookbook (2006) , with a derivatives chapter. Uses the Hessian definition.  The Matrix Cookbook (2012) , an updated version of the Matrix Cookbook.  Linear Algebra and its Applications (author information page; see Chapter 9 of book), Peter Lax , Courant Institute .  Matrix Differentiation (and some other stuff) , Randal J. Barnes, Department of Civil Engineering, University of Minnesota.  Notes on Matrix Calculus , Paul L. Fackler, North Carolina State University .  Matrix Differential Calculus (slide presentation), Zhang Le, University of Edinburgh .  Introduction to Vector and Matrix Differentiation (notes on matrix differentiation, in the context of Econometrics ), Heino Bohn Nielsen.  A note on differentiating matrices (notes on matrix differentiation), Pawel Koval, from Munich Personal RePEc Archive.  Vector/Matrix Calculus More notes on matrix differentiation.  Matrix Identities (notes on matrix differentiation), Sam Roweis. ( needs user login )   "  Category:Matrix theory  Category:Linear algebra  Category:Multivariable calculus      ‚Ü©   Minka, Thomas P. "Old and New Matrix Algebra Useful for Statistics." December 28, 2000. 1 ‚Ü©  2 ‚Ü©  Here,   ùüé   0   \mathbf{0}   refers to a column vector of all 0's, of size n , where n is the length of x . ‚Ü©   Here,   ùüé   0   \mathbf{0}   refers to a column vector of all 0's, of size n , where n is the length of a . ‚Ü©  Here,   ùüé   0   \mathbf{0}   refers to a matrix of all 0's, of the same shape as X . ‚Ü©    ‚Ü©         See Determinant#Derivative for the derivation. ‚Ü©       Petersen, Kaare Brandt and Michael Syskind Pedersen. The Matrix Cookbook. November 14, 2008. http://matrixcookbook.com . 3 This book uses a mixed layout, i.e. by Y in      ‚àÇ  ùêò    ‚àÇ  x    ,        ùêò     x     \frac{\partial\mathbf{Y}}{\partial x},   by X in      ‚àÇ  y    ‚àÇ  ùêó    .        y     ùêó     \frac{\partial y}{\partial\mathbf{X}}.    ‚Ü©          
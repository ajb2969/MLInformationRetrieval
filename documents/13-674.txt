   Lagrangian mechanics      Lagrangian mechanics   Lagrangian mechanics is a re-formulation of classical mechanics using the principle of stationary action (also called the principle of least action). 1 It is not as general as the principle of stationary action because it is restricted to equilibrium problems. 2 Lagrangian mechanics applies to systems whether or not they conserve energy or momentum, and it provides conditions under which energy, momentum or both are conserved. 3 It was introduced by the Italian-French mathematician Joseph-Louis Lagrange in 1788.  In Lagrangian mechanics, the trajectory of a system of particles is derived by solving the Lagrange equations in one of two forms, either the Lagrange equations of the first kind , 4 which treat constraints explicitly as extra equations, often using Lagrange multipliers ; 5 6 or the Lagrange equations of the second kind , which incorporate the constraints directly by judicious choice of generalized coordinates . 7 8 The fundamental lemma of the calculus of variations shows that solving the Lagrange equations is equivalent to finding the path for which the action functional is stationary, a quantity that is the integral of the Lagrangian over time.  The use of generalized coordinates may considerably simplify a system's analysis . For example, consider a small frictionless bead traveling in a groove. If one is tracking the bead as a particle, calculation of the motion of the bead using Newtonian mechanics would require solving for the time-varying constraint force required to keep the bead in the groove. For the same problem using Lagrangian mechanics, one looks at the path of the groove and chooses a set of independent generalized coordinates that completely characterize the possible motion of the bead. This choice eliminates the need for the constraint force to enter into the resultant system of equations. There are fewer equations since one is not directly calculating the influence of the groove on the bead at a given moment.  Lagrangian mechanics ability to work in generalized coordinate systems makes it suitable for use in special relativity which coordinate systems change for different observers. It is used as the standard language of particle physics to express the standard model in terms of Lagrangians.  The Lagrangian , L , of a dynamical system is a mathematical function that summarizes the dynamics of the system. For a simple mechanical system, it is the value given by the kinetic energy of the particle minus the potential energy of the particle but it may be generalized to more complex systems. It is used primarily as a key component in the Euler-Lagrange equations to find the path of a particle according to the principle of least action .  The Lagrangian is named after Italian mathematician and astronomer Joseph Louis Lagrange . The concept of a Lagrangian was introduced in a reformulation of classical mechanics introduced by Lagrange known as Lagrangian mechanics in 1788. This reformulation was needed in order to explore mechanics in alternative systems to Cartesian coordinates such as polar , cylindrical and spherical coordinates, and where the coordinates do not necessarily refer to position, for which Newton's formulation of classical mechanics is not convenient.  The Lagrangian has since been used in a method to find the acceleration of a particle in a Newtonian gravitational field and to derive the Einstein field equations . This led to its use in applying electromagnetism to curved spacetime and in describing charged black holes . It also has additional uses in Mathematical formalism to find the functional derivative of an action, and in engineering for the analysis and optimisation of dynamic systems.  Conceptual framework  Generalized coordinates  For one particle acted on by external forces, Newton's second law forms a set of 3 second-order ordinary differential equations , one for each dimension. Therefore, the motion of the particle can be completely described by 6 independent variables: 3 initial position coordinates and 3 initial velocity coordinates. Given these, the general solutions to Newton's second law become particular solutions that determine the time evolution of the particle's behaviour after its initial state ( t = 0).  The most familiar set of variables for position r = ( r 1 , r 2 , r 3 ) and velocity      ğ«  Ë™   j   =   (    r  Ë™   1   ,    r  Ë™   2   ,    r  Ë™   3   )        subscript   normal-Ë™  ğ«   j     subscript   normal-Ë™  r   1    subscript   normal-Ë™  r   2    subscript   normal-Ë™  r   3      \mathbf{\dot{r}}_{j}=(\dot{r}_{1},\dot{r}_{2},\dot{r}_{3})   are Cartesian coordinates and their time derivatives (i.e. position ( x, y, z ) and velocity ( v x , v y , v z ) components). Determining forces in terms of standard coordinates can be complicated, and usually requires much labour.  An alternative and more efficient approach is to use only as many coordinates as are needed to define the position of the particle, at the same time incorporating the constraints on the system, and writing down kinetic and potential energies. In other words, to determine the number of degrees of freedom the particle has, i.e. the number of possible ways the system can move subject to the constraints (forces that prevent it moving in certain paths). Energies are much easier to write down and calculate than forces, since energy is a scalar while forces are vectors.  These coordinates are generalized coordinates , denoted    q  j     subscript  q  j    q_{j}   , and there is one for each degree of freedom. Their corresponding time derivatives are the generalized velocities ,     q  j   Ë™     normal-Ë™   subscript  q  j     \dot{q_{j}}   . The number of degrees of freedom is usually not equal to the number of spatial dimensions: multi-body systems in 3-dimensional space (such as Barton's Pendulums , planets in the solar system , or atoms in molecules ) can have many more degrees of freedom incorporating rotations as well as translations. This contrasts the number of spatial coordinates used with Newton's laws above.  The position vector r in a standard coordinate system (like Cartesian, spherical etc.), is related to the generalized coordinates by some transformation equation :       ğ•£  =   ğ•£   (   q  i   ,  t  )     .      ğ•£    ğ•£    subscript  q  i   t      \mathbb{r}=\mathbb{r}(q_{i},t).\,     where there are as many q i as needed (number of degrees of freedom in the system). Likewise for velocity and generalized velocities.  For example, for a simple pendulum of length â„“ , there is the constraint of the pendulum bob's suspension (rod/wire/string etc.). The position r depends on the x and y coordinates at time t , that is, r ( t )=( x ( t ), y ( t )), however x and y are coupled to each other in a constraint equation (if x changes y must change, and vice versa). A logical choice for a generalized coordinate is the angle of the pendulum from vertical, Î¸, so we have r = ( x (Î¸), y (Î¸)) = r (Î¸), in which Î¸ = Î¸( t ). Then the transformation equation would be       ğ•£   (   Î¸   (  t  )    )    =   (   â„“   sin  Î¸    ,   -   â„“   cos  Î¸     )         ğ•£    Î¸  t       normal-â„“    Î¸        normal-â„“    Î¸        \mathbb{r}(\theta(t))=(\ell\sin\theta,-\ell\cos\theta)     and so        ğ•£  Ë™    (   Î¸   (  t  )    ,    Î¸  Ë™    (  t  )    )    =   (    â„“    Î¸  Ë™    cos  Î¸    ,    â„“    Î¸  Ë™    sin  Î¸    )          normal-Ë™  ğ•£      Î¸  t      normal-Ë™  Î¸   t        normal-â„“   normal-Ë™  Î¸     Î¸      normal-â„“   normal-Ë™  Î¸     Î¸       \mathbb{\dot{r}}(\theta(t),\dot{\theta}(t))=(\ell\,\dot{\theta}\cos\theta,\ell%
 \,\dot{\theta}\sin\theta)     which corresponds to the one degree of freedom the pendulum has. The term "generalized coordinates" is really a holdover from the period when Cartesian coordinates were the default coordinate system.  In general, from m independent generalized coordinates  q j , the following transformation equations hold for a system composed of n particles: 9         ğ«  1     =      ğ«  1    (   q  1   ,   q  2   ,  â‹¯  ,   q  m   ,  t  )         ğ«  2     =      ğ«  2    (   q  1   ,   q  2   ,  â‹¯  ,   q  m   ,  t  )         â‹®        ğ«  n     =      ğ«  n    (   q  1   ,   q  2   ,  â‹¯  ,   q  m   ,  t  )           subscript  ğ«  1       subscript  ğ«  1     subscript  q  1    subscript  q  2   normal-â‹¯   subscript  q  m   t       subscript  ğ«  2       subscript  ğ«  2     subscript  q  1    subscript  q  2   normal-â‹¯   subscript  q  m   t       missing-subexpression   normal-â‹®   missing-subexpression      subscript  ğ«  n       subscript  ğ«  n     subscript  q  1    subscript  q  2   normal-â‹¯   subscript  q  m   t       \begin{array}[]{r c l}\mathbf{r}_{1}&=&\mathbf{r}_{1}(q_{1},q_{2},\cdots,q_{m}%
 ,t)\\
 \mathbf{r}_{2}&=&\mathbf{r}_{2}(q_{1},q_{2},\cdots,q_{m},t)\\
 &\vdots&\\
 \mathbf{r}_{n}&=&\mathbf{r}_{n}(q_{1},q_{2},\cdots,q_{m},t)\end{array}     where m indicates the total number of generalized coordinates. An expression for the virtual displacement (infinitesimal), Î´ r i of the system for time-independent constraints or "velocity-dependent constraints" is the same form as a total differential 10        Î´   ğ«  i    =    âˆ‘   j  =  1   m      âˆ‚   ğ«  i     âˆ‚   q  j     Î´   q  j      ,        Î´   subscript  ğ«  i      superscript   subscript     j  1    m          subscript  ğ«  i       subscript  q  j     Î´   subscript  q  j       \delta\mathbf{r}_{i}=\sum_{j=1}^{m}\frac{\partial\mathbf{r}_{i}}{\partial q_{j%
 }}\delta q_{j},   where j is an integer label corresponding to a generalized coordinate.  The generalized coordinates form a discrete set of variables that define the configuration of a system. The continuum analogue for defining a field are field variables, say Ï• ( r, t ), which represents density function varying with position and time.  D'Alembert's principle and generalized forces  D'Alembert's principle introduces the concept of virtual work due to applied forces F i and inertial forces, acting on a three-dimensional accelerating system of n particles whose motion is consistent with its constraints, 11  Mathematically, the virtual work Î´W done on a particle of mass m i through a virtual displacement Î´ r i (consistent with the constraints) is:  where a i are the accelerations of the particles in the system and i = 1, 2,..., n simply labels the particles. In terms of generalized coordinates       Î´  W   =    âˆ‘   j  =  1   m     âˆ‘   i  =  1   n      (    ğ…  i   -    m  i    ğš  i     )   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j      Î´   q  j      =  0.          Î´  W     superscript   subscript     j  1    m     superscript   subscript     i  1    n      normal-â‹…     subscript  ğ…  i      subscript  m  i    subscript  ğš  i          subscript  ğ«  i       subscript  q  j      Î´   subscript  q  j           0.     \delta W=\sum_{j=1}^{m}\sum_{i=1}^{n}(\mathbf{F}_{i}-m_{i}\mathbf{a}_{i})\cdot%
 \frac{\partial\mathbf{r}_{i}}{\partial q_{j}}\delta q_{j}=0.     this expression suggests that the applied forces may be expressed as generalized forces , Q j . Dividing by Î´q j gives the definition of a generalized force: 12        Q  j   =    Î´  W    Î´   q  j     =    âˆ‘   i  =  1   n     ğ…  i   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j        .         subscript  Q  j       Î´  W     Î´   subscript  q  j            superscript   subscript     i  1    n    normal-â‹…   subscript  ğ…  i        subscript  ğ«  i       subscript  q  j          Q_{j}=\frac{\delta W}{\delta q_{j}}=\sum_{i=1}^{n}\mathbf{F}_{i}\cdot\frac{%
 \partial\mathbf{r}_{i}}{\partial q_{j}}.     If the forces F i are conservative , there is a scalar potential field V in which the gradient of V is the force: 13        ğ…  i   =   -   âˆ‡  V    â‡’   Q  j   =   -    âˆ‘   i  =  1   n    âˆ‡   V  â‹…    âˆ‚   ğ«  i     âˆ‚   q  j         =   -    âˆ‚  V    âˆ‚   q  j       .         subscript  ğ…  i      normal-âˆ‡  V      normal-â‡’     subscript  Q  j            superscript   subscript     i  1    n    normal-âˆ‡   normal-â‹…  V       subscript  ğ«  i       subscript  q  j                    V      subscript  q  j         \mathbf{F}_{i}=-\nabla V\Rightarrow Q_{j}=-\sum_{i=1}^{n}\nabla V\cdot\frac{%
 \partial\mathbf{r}_{i}}{\partial q_{j}}=-\frac{\partial V}{\partial q_{j}}.     i.e. generalized forces can be reduced to a potential gradient in terms of generalized coordinates. The previous result may be easier to see by recognizing that V is a function of the r i , which are in turn functions of q j , and then applying the chain rule to the derivative of   V   V   V   with respect to q j .  Kinetic energy relations  The kinetic energy , T , for the system of particles is defined by 14       T  =    1  2     âˆ‘   i  =  1   n      m  i     ğ«  Ë™   i    â‹…    ğ«  Ë™   i       .      T      1  2     superscript   subscript     i  1    n    normal-â‹…     subscript  m  i    subscript   normal-Ë™  ğ«   i     subscript   normal-Ë™  ğ«   i        T=\frac{1}{2}\sum_{i=1}^{n}m_{i}\mathbf{\dot{r}}_{i}\cdot\mathbf{\dot{r}}_{i}.     In terms of the kinetic energy, the equations of motion in a set of generalized coordinates can be written:  {\mathrm{d}t} \left ( \frac {\partial T}{\partial \dot{q}_j} \right ) - \frac {\partial T}{\partial q_j} |cellpadding= 6 |border |border colour = #0073CF |background colour=#F5FFFA}}  Newton's laws are contained in it, yet there is no need to find the constraint forces because virtual work and generalized coordinates (which account for constraints) are used. This equation in itself is not actually used in practice, but is a step towards deriving Lagrange's equations (see below). 15        Derivation of the generalized equations of motion       The partial derivatives of T with respect to the generalized coordinates q j and generalized velocities     q  Ë™   j     subscript   normal-Ë™  q   j    \dot{q}_{j}   are: 16        âˆ‚  T    âˆ‚   q  j     =    âˆ‘   i  =  1   n      m  i     ğ«  Ë™   i    â‹…    âˆ‚    ğ«  Ë™   i     âˆ‚   q  j               T      subscript  q  j       superscript   subscript     i  1    n    normal-â‹…     subscript  m  i    subscript   normal-Ë™  ğ«   i         subscript   normal-Ë™  ğ«   i       subscript  q  j         \frac{\partial T}{\partial q_{j}}=\sum_{i=1}^{n}m_{i}\mathbf{\dot{r}}_{i}\cdot%
 \frac{\partial\mathbf{\dot{r}}_{i}}{\partial q_{j}}             âˆ‚  T    âˆ‚    q  Ë™   j      =    âˆ‘   i  =  1   n      m  i     ğ«  Ë™   i    â‹…    âˆ‚    ğ«  Ë™   i     âˆ‚    q  Ë™   j        .          T      subscript   normal-Ë™  q   j       superscript   subscript     i  1    n    normal-â‹…     subscript  m  i    subscript   normal-Ë™  ğ«   i         subscript   normal-Ë™  ğ«   i       subscript   normal-Ë™  q   j         \quad\frac{\partial T}{\partial\dot{q}_{j}}=\sum_{i=1}^{n}m_{i}\mathbf{\dot{r}%
 }_{i}\cdot\frac{\partial\mathbf{\dot{r}}_{i}}{\partial\dot{q}_{j}}.   it can be shown that         âˆ‚    ğ«  Ë™   i     âˆ‚    q  j   Ë™     =    âˆ‚   ğ«  i     âˆ‚   q  j      .           subscript   normal-Ë™  ğ«   i       normal-Ë™   subscript  q  j           subscript  ğ«  i       subscript  q  j       \frac{\partial\mathbf{\dot{r}}_{i}}{\partial\dot{q_{j}}}=\frac{\partial\mathbf%
 {r}_{i}}{\partial q_{j}}.   Then:          âˆ‚  T    âˆ‚    q  Ë™   j      =    âˆ‘   i  =  1   n      m  i     ğ«  Ë™   i    â‹…     âˆ‚   ğ«  i     âˆ‚   q  j         .          T      subscript   normal-Ë™  q   j       superscript   subscript     i  1    n    normal-â‹…     subscript  m  i    subscript   normal-Ë™  ğ«   i         subscript  ğ«  i       subscript  q  j         \quad\frac{\partial T}{\partial\dot{q}_{j}}=\sum_{i=1}^{n}m_{i}\mathbf{\dot{r}%
 }_{i}\cdot\frac{\partial\mathbf{r}_{i}}{\partial q_{j}}\ .   The total time derivative of this equation is         d   d  t      âˆ‚  T    âˆ‚    q  Ë™   j      =     âˆ‘   i  =  1   n      m  i     ğ«  Â¨   i    â‹…    âˆ‚   ğ«  i     âˆ‚   q  j       +    âˆ‘   i  =  1   n      m  i     ğ«  Ë™   i    â‹…    âˆ‚    ğ«  Ë™   i     âˆ‚   q  j        =    Q  j   +     âˆ‚  T    âˆ‚   q  j        .            normal-d    normal-d  t        T      subscript   normal-Ë™  q   j          superscript   subscript     i  1    n    normal-â‹…     subscript  m  i    subscript   normal-Â¨  ğ«   i         subscript  ğ«  i       subscript  q  j         superscript   subscript     i  1    n    normal-â‹…     subscript  m  i    subscript   normal-Ë™  ğ«   i         subscript   normal-Ë™  ğ«   i       subscript  q  j                subscript  Q  j       T      subscript  q  j         \frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\partial\dot{q}_{j}}=\sum_{i=1%
 }^{n}m_{i}\mathbf{\ddot{r}}_{i}\cdot\frac{\partial\mathbf{r}_{i}}{\partial q_{%
 j}}+\sum_{i=1}^{n}m_{i}\mathbf{\dot{r}}_{i}\cdot\frac{\partial\mathbf{\dot{r}}%
 _{i}}{\partial q_{j}}=Q_{j}+\frac{\partial T}{\partial q_{j}}\ .   resulting in the generalized equations of motion.       Lagrangian and action  The core element of Lagrangian mechanics is the Lagrangian function, which summarizes the dynamics of the entire system in a very simple expression. The physics of analyzing a system is reduced to choosing the most convenient set of generalized coordinates, determining the kinetic and potential energies of the constituents of the system, then writing down the equation for the Lagrangian to use in Lagrange's equations. It is defined by 17      L  =   T  -   V        L    T  V     L=T-V\,     where T is the total kinetic energy and V is the total potential energy of the system.  The next fundamental element is the action    ğ’®   ğ’®   \mathcal{S}   , defined as the time integral of the Lagrangian: 18       ğ’®  =    âˆ«   t  1    t  2      L   d  t     .      ğ’®    superscript   subscript    subscript  t  1     subscript  t  2      L  normal-d  t      \mathcal{S}=\int_{t_{1}}^{t_{2}}L\,\mathrm{d}t.     This also contains the dynamics of the system, and has deep theoretical implications (discussed below). Technically, the action is a functional , that is, it is a function that maps the full Lagrangian function for all times between t 1 and t 2 to a scalar value for the action. Its dimensions are the same as angular momentum .  In classical field theory , the physical system is not a set of discrete particles, but rather a continuous field defined over a region of 3d space. Associated with the field is a Lagrangian density     â„’   (  ğ«  ,  t  )       â„’   ğ«  t     \mathcal{L}(\mathbf{r},t)   defined in terms of the field and its derivatives at a location   ğ«   ğ«   \mathbf{r}   . The total Lagrangian is then the integral of the Lagrangian density over 3d space (see volume integral ):       L   (  t  )    =   âˆ«   â„’   (  ğ«  ,  t  )    d  3    ğ«           L  t       â„’   ğ«  t    superscript  normal-d  3   ğ«      L(t)=\int\mathcal{L}(\mathbf{r},t)\mathrm{d}^{3}\mathbf{r}\,     where d 3 r is a 3d differential  volume element , must be used instead. The action becomes an integral over space and time:       ğ’®  =    âˆ«   t  1    t  2     âˆ«   â„’   (  ğ«  ,  t  )    d  3   ğ«  d  t      .      ğ’®    superscript   subscript    subscript  t  1     subscript  t  2        â„’   ğ«  t    superscript  normal-d  3   ğ«  normal-d  t       \mathcal{S}=\int_{t_{1}}^{t_{2}}\int\mathcal{L}(\mathbf{r},t)\mathrm{d}^{3}%
 \mathbf{r}\mathrm{d}t.     Hamilton's principle of stationary action  Let q 0 and q 1 be the coordinates at respective initial and final times t 0 and t 1 . Using the calculus of variations , it can be shown that Lagrange's equations are equivalent to Hamilton's principle :   The trajectory of the system between t 0 and t 1 has a stationary action S.    By stationary , we mean that the action does not vary to first-order from infinitesimal deformations of the trajectory, with the end-points ( q 0 , t 0 ) and ( q 1 , t 1 ) fixed. Hamilton's principle can be written as:       Î´  ğ’®   =  0.        Î´  ğ’®   0.    \delta\mathcal{S}=0.\,\!     Thus, instead of thinking about particles accelerating in response to applied forces, one might think of them picking out the path with a stationary action.  Hamilton's principle is sometimes referred to as the principle of least action , however the action functional need only be stationary , not necessarily a maximum or a minimum value. Any variation of the functional gives an increase in the functional integral of the action.  We can use this principle instead of Newton's Laws as the fundamental principle of mechanics, this allows us to use an integral principle (Newton's Laws are based on differential equations so they are a differential principle) as the basis for mechanics. However it is not widely stated that Hamilton's principle is a variational principle only with holonomic constraints , if we are dealing with nonholonomic systems then the variational principle should be replaced with one involving d'Alembert principle of virtual work . Working only with holonomic constraints is the price we have to pay for using an elegant variational formulation of mechanics.  Illustration  The trajectory of a thrown ball is characterized by the sum of the Lagrangian values at each time being a (local) minimum.  The Lagrangian L can be calculated at several instants of time t , and a graph of L against t can be drawn. The area under the curve is the action . Any different path between the initial and final positions leads to a larger action than that chosen by nature. Nature chooses the smallest action â€“ this is the Principle of Least Action .   Using only the principle of least action and the Lagrangian we can deduce the correct trajectory, by trial and error or the calculus of variations .  Lagrange's equations of the first kind  Lagrange introduced an analytical method for finding stationary points using the method of Lagrange multipliers , and also applied it to mechanics.  For a system subject to the (holonomic) constraint equation on the generalized coordinates:       F   (   r  1   ,   r  2   ,   r  3   )    =  A        F    subscript  r  1    subscript  r  2    subscript  r  3     A    F(r_{1},r_{2},r_{3})=A     where A is a constant, then Lagrange's equations of the first kind are:        [     âˆ‚  L    âˆ‚   r  j     -    d   d  t     (    âˆ‚  L    âˆ‚    r  Ë™   j     )     ]   +   Î»    âˆ‚  F    âˆ‚   r  j       =  0         delimited-[]        L      subscript  r  j         normal-d    normal-d  t        L      subscript   normal-Ë™  r   j          Î»      F      subscript  r  j       0    \left[\frac{\partial L}{\partial r_{j}}-\frac{\mathrm{d}}{\mathrm{d}t}\left(%
 \frac{\partial L}{\partial\dot{r}_{j}}\right)\right]+\lambda\frac{\partial F}{%
 \partial r_{j}}=0     where Î» is the Lagrange multiplier. By analogy with the mathematical procedure, we can write:         Î´  L    Î´   r  j     +   Î»    âˆ‚  F    âˆ‚   r  j       =  0            Î´  L     Î´   subscript  r  j       Î»      F      subscript  r  j       0    \frac{\delta L}{\delta r_{j}}+\lambda\frac{\partial F}{\partial r_{j}}=0     where        Î´  L    Î´   r  j     =     âˆ‚  L    âˆ‚   r  j     -    d   d  t     (    âˆ‚  L    âˆ‚    r  Ë™   j     )             Î´  L     Î´   subscript  r  j           L      subscript  r  j         normal-d    normal-d  t        L      subscript   normal-Ë™  r   j         \frac{\delta L}{\delta r_{j}}=\frac{\partial L}{\partial r_{j}}-\frac{\mathrm{%
 d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{r}_{j}}\right)     denotes the variational derivative .  For e constraint equations F 1 , F 2 ,..., F e , there is a Lagrange multiplier for each constraint equation, and Lagrange's equations of the first kind generalize to:  This procedure does increase the number of equations, but there are enough to solve for all of the multipliers. The number of equations generated is the number of constraint equations plus the number of coordinates, i.e. e + m . The advantage of the method is that (potentially complicated) substitution and elimination of variables linked by constraint equations can be bypassed.  There is a connection between the constraint equations F j and the constraint forces N j acting in the conservative system (forces are conservative):       N  j   =    âˆ‘   i  =  1   e     Î»  i     âˆ‚   F  i     âˆ‚   r  j            subscript  N  j     superscript   subscript     i  1    e      subscript  Î»  i        subscript  F  i       subscript  r  j         N_{j}=\sum_{i=1}^{e}\lambda_{i}\frac{\partial F_{i}}{\partial r_{j}}     which is derived below.        Derivation of connection between constraint equations and forces       The generalized constraint forces are given by (using the definition of generalized force above):       N  j   =    âˆ‘   i  =  1   n     ğ  i   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j            subscript  N  j     superscript   subscript     i  1    n    normal-â‹…   subscript  ğ  i        subscript  ğ«  i       subscript  q  j         N_{j}=\sum_{i=1}^{n}\mathbf{N}_{i}\cdot\frac{\partial\mathbf{r}_{i}}{\partial q%
 _{j}}   and using the kinetic energy equation of motion (blue box above):        Q  j   =     d   d  t     (    âˆ‚  T    âˆ‚    q  Ë™   j     )    -    âˆ‚  T    âˆ‚   q  j      =   -    Î´  T    Î´   q  j      =    âˆ‘   i  =  1   n     ğ…  i   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j        ,         subscript  Q  j         normal-d    normal-d  t        T      subscript   normal-Ë™  q   j          T      subscript  q  j                 Î´  T     Î´   subscript  q  j             superscript   subscript     i  1    n    normal-â‹…   subscript  ğ…  i        subscript  ğ«  i       subscript  q  j          Q_{j}=\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial T}{\partial\dot{q}_{j%
 }}\right)-\frac{\partial T}{\partial q_{j}}=-\frac{\delta T}{\delta q_{j}}=%
 \sum_{i=1}^{n}\mathbf{F}_{i}\cdot\frac{\partial\mathbf{r}_{i}}{\partial q_{j}},   For conservative systems (see below)        ğ…  i   =    -   âˆ‡   V  i     +   ğ  i     ,       subscript  ğ…  i        normal-âˆ‡   subscript  V  i      subscript  ğ  i      \mathbf{F}_{i}=-\nabla V_{i}+\mathbf{N}_{i},   so        Î´  T    Î´   q  j     =    âˆ‘   i  =  1   n     ğ…  i   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j       =    âˆ‘   i  =  1   n     (    -   âˆ‡   V  i     +   ğ  i    )   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j       =    -    âˆ‘   i  =  1   n    âˆ‡    V  i   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j         +    âˆ‘   i  =  1   n     ğ  i   â‹…    âˆ‚   ğ«  i     âˆ‚   q  j        =    -    âˆ‚  V    âˆ‚   q  j      +   N  j              Î´  T     Î´   subscript  q  j       superscript   subscript     i  1    n    normal-â‹…   subscript  ğ…  i        subscript  ğ«  i       subscript  q  j              superscript   subscript     i  1    n    normal-â‹…       normal-âˆ‡   subscript  V  i      subscript  ğ  i         subscript  ğ«  i       subscript  q  j                  superscript   subscript     i  1    n    normal-âˆ‡   normal-â‹…   subscript  V  i        subscript  ğ«  i       subscript  q  j           superscript   subscript     i  1    n    normal-â‹…   subscript  ğ  i        subscript  ğ«  i       subscript  q  j                     V      subscript  q  j       subscript  N  j       \frac{\delta T}{\delta q_{j}}=\sum_{i=1}^{n}\mathbf{F}_{i}\cdot\frac{\partial%
 \mathbf{r}_{i}}{\partial q_{j}}=\sum_{i=1}^{n}(-\nabla V_{i}+\mathbf{N}_{i})%
 \cdot\frac{\partial\mathbf{r}_{i}}{\partial q_{j}}=-\sum_{i=1}^{n}\nabla V_{i}%
 \cdot\frac{\partial\mathbf{r}_{i}}{\partial q_{j}}+\sum_{i=1}^{n}\mathbf{N}_{i%
 }\cdot\frac{\partial\mathbf{r}_{i}}{\partial q_{j}}=-\frac{\partial V}{%
 \partial q_{j}}+N_{j}   and        Î´  T    Î´   q  j     =     d   d  t     (    âˆ‚   (   L  +  V   )     âˆ‚    q  Ë™   j     )    -    âˆ‚   (   L  +  V   )     âˆ‚   q  j      =    -    Î´  L    Î´    q  Ë™   j      -    âˆ‚  V    âˆ‚   q  j                Î´  T     Î´   subscript  q  j           normal-d    normal-d  t          L  V       subscript   normal-Ë™  q   j            L  V       subscript  q  j                   Î´  L     Î´   subscript   normal-Ë™  q   j          V      subscript  q  j         \frac{\delta T}{\delta q_{j}}=\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{%
 \partial(L+V)}{\partial\dot{q}_{j}}\right)-\frac{\partial(L+V)}{\partial q_{j}%
 }=-\frac{\delta L}{\delta\dot{q}_{j}}-\frac{\partial V}{\partial q_{j}}   equating leads to       N  j   =   -    Î´  L    Î´    q  Ë™   j           subscript  N  j         Î´  L     Î´   subscript   normal-Ë™  q   j        N_{j}=-\frac{\delta L}{\delta\dot{q}_{j}}   and finally equating to Lagrange's equations of the first kind implies:       N  j   =    âˆ‘   i  =  1   e     Î»  i     âˆ‚   F  i     âˆ‚   r  j            subscript  N  j     superscript   subscript     i  1    e      subscript  Î»  i        subscript  F  i       subscript  r  j         N_{j}=\sum_{i=1}^{e}\lambda_{i}\frac{\partial F_{i}}{\partial r_{j}}   So each constraint equation corresponds to a constraint force (in a conservative system).       Lagrange equations of the second kind  If the Lagrangian of a system is known, then the equations of motion of the system may be obtained by a direct substitution of the expression for the Lagrangian into the Eulerâ€“Lagrange equation . The Lagrangian of a given system is not unique, and two Lagrangians describing the same system can differ by the total derivative (not partial ) with respect to time of some function f ( q , t )  , that is       L  â€²   =   L  +    d  f   (  q  ,  t  )     d  t          superscript  L  normal-â€²     L      normal-d  f   q  t      normal-d  t       L^{\prime}=L+\frac{\mathrm{d}f(q,t)}{\mathrm{d}t}     However, solving any equivalent Lagrangians will give the same equations of motion. 19 20  The Lagrangian in many classical systems is a function of generalized coordinates q i and their velocities d q i /d t . These coordinates and velocities are, in their turn, parametric functions of time t :      L   (    q  1    (  t  )    ,    q  2    (  t  )    ,  â€¦  ,   â€¦   q  1    (  t  )    ,   â€¦   q  2    (  t  )    ,  â€¦  ,  t  )       L      subscript  q  1   t      subscript  q  2   t   normal-â€¦    normal-â€¦   subscript  q  1   t     normal-â€¦   subscript  q  2   t   normal-â€¦  t     L(q_{1}(t),q_{2}(t),\ldots,\dots{q}_{1}(t),\dots{q}_{2}(t),\ldots,t)     In the classical view, time is an independent variable and q i (and d q i /d t ) are dependent variables as is often seen in phase space explanations of systems.  Eulerâ€“Lagrange equations  For any system with m degrees of freedom, the Lagrange equations include m generalized coordinates and m generalized velocities. Below, we sketch out the derivation of the Lagrange equations of the second kind. In this context, V is used rather than U for potential energy and T replaces K for kinetic energy . See the references for more detailed and more general derivations.  The equations of motion in Lagrangian mechanics are the Lagrange equations of the second kind , also known as the Eulerâ€“Lagrange equations : 21 22  {\mathrm{d}t} \left ( \frac {\partial L}{\partial \dot{q}_j} \right ) = \frac {\partial L}{\partial q_j}  |cellpadding |border |border colour = #50C878 |background colour = #ECFCF4}}  where j = 1, 2,... m represents the j th degree of freedom, q j are the generalized coordinates , and     q  Ë™   j     subscript   normal-Ë™  q   j    \dot{q}_{j}   are the generalized velocities .  Although the mathematics required for Lagrange's equations appears significantly more complicated than Newton's laws, this does point to deeper insights into classical mechanics than Newton's laws alone: in particular, symmetry and conservation. In practice it's often easier to solve a problem using the Lagrange equations than Newton's laws, because the minimum generalized coordinates q i can be chosen by convenience to exploit symmetries in the system, and constraint forces are incorporated into the geometry of the problem. There is one Lagrange equation for each generalized coordinate q i .  For a system of many particles, each particle can have different numbers of degrees of freedom from the others. In each of the Lagrange equations, T is the total kinetic energy of the system, and V the total potential energy.  Dissipation function  In a more general formulation, the forces could be both conservative and viscous . If an appropriate transformation can be found from the F i , Rayleigh suggests using a dissipation function, D , of the following form: 23       D  =    1  2     âˆ‘   j  =  1   m     âˆ‘   k  =  1   m     C   j  k      q  Ë™   j     q  Ë™   k        .      D      1  2     superscript   subscript     j  1    m     superscript   subscript     k  1    m      subscript  C    j  k     subscript   normal-Ë™  q   j    subscript   normal-Ë™  q   k         D=\frac{1}{2}\sum_{j=1}^{m}\sum_{k=1}^{m}C_{jk}\dot{q}_{j}\dot{q}_{k}.   where C jk are constants that are related to the damping coefficients in the physical system, though not necessarily equal to them  If D is defined this way, then 24       Q  j   =    -    âˆ‚  V    âˆ‚   q  j      -    âˆ‚  D    âˆ‚    q  Ë™   j           subscript  Q  j           V      subscript  q  j          D      subscript   normal-Ë™  q   j        Q_{j}=-\frac{\partial V}{\partial q_{j}}-\frac{\partial D}{\partial\dot{q}_{j}}   and       0  =      d   d  t     (    âˆ‚  L    âˆ‚    q  Ë™   j     )    -    âˆ‚  L    âˆ‚   q  j      +    âˆ‚  D    âˆ‚    q  Ë™   j       .      0          normal-d    normal-d  t        L      subscript   normal-Ë™  q   j          L      subscript  q  j          D      subscript   normal-Ë™  q   j        0=\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}_{j}}%
 \right)-\frac{\partial L}{\partial q_{j}}+\frac{\partial D}{\partial\dot{q}_{j%
 }}.     Derivations of Lagrange's equations of the second kind  D-Alembert's principle and action in the Lagrangian formulation  The importance of the Lagrangian is derived from D'Alembert's principle , which asserts that the virtual work of any reversible variations subject to the constraints of the system is zero:        âˆ‘  i      (    ğ…  i   -    m  i    ğš  i     )   â‹…  Î´    ğ«  i     =  0        subscript   i      normal-â‹…     subscript  ğ…  i      subscript  m  i    subscript  ğš  i     Î´    subscript  ğ«  i     0    \sum_{i}(\mathbf{F}_{i}-m_{i}\mathbf{a}_{i})\cdot\delta\mathbf{r}_{i}=0     The integration of this principle over time for a conservative force is           âˆ«   t  1    t  2        âˆ‘  i       (    ğ…  i   -    m  i    ğš  i     )   â‹…  Î´     ğ«  i    d  t         =      âˆ«   t  1    t  2      Î´   (    -  V   +     1  2       âˆ‘  i      m  i    v  i  2       )   d  t    -    [     âˆ‘  i        m  i    ğ¯  i    â‹…  Î´    ğ«  i     ]    t  1    t  2             =    Î´     âˆ«   t  1    t  2       L   d  t     -    [     âˆ‘  i        m  i    ğ¯  i    â‹…  Î´    ğ«  i     ]    t  1    t  2              superscript   subscript    subscript  t  1     subscript  t  2      subscript   i      normal-â‹…     subscript  ğ…  i      subscript  m  i    subscript  ğš  i     Î´    subscript  ğ«  i   d  t       absent      superscript   subscript    subscript  t  1     subscript  t  2      Î´      V       1  2     subscript   i      subscript  m  i    superscript   subscript  v  i   2       d  t     superscript   subscript   delimited-[]    subscript   i      normal-â‹…     subscript  m  i    subscript  ğ¯  i    Î´    subscript  ğ«  i       subscript  t  1     subscript  t  2         missing-subexpression     absent      Î´    superscript   subscript    subscript  t  1     subscript  t  2      L  d  t      superscript   subscript   delimited-[]    subscript   i      normal-â‹…     subscript  m  i    subscript  ğ¯  i    Î´    subscript  ğ«  i       subscript  t  1     subscript  t  2         \begin{aligned}\displaystyle\int_{t_{1}}^{t_{2}}\sum_{i}(\mathbf{F}_{i}-m_{i}%
 \mathbf{a}_{i})\cdot\delta\mathbf{r}_{i}\,dt&\displaystyle=\int_{t_{1}}^{t_{2}%
 }\delta\left(-V+\frac{1}{2}\sum_{i}m_{i}v_{i}^{2}\right)\,dt-\left[\sum_{i}m_{%
 i}\mathbf{v}_{i}\cdot\delta\mathbf{r}_{i}\right]_{t_{1}}^{t_{2}}\\
 &\displaystyle=\delta\int_{t_{1}}^{t_{2}}L\,dt-\left[\sum_{i}m_{i}\mathbf{v}_{%
 i}\cdot\delta\mathbf{r}_{i}\right]_{t_{1}}^{t_{2}}\end{aligned}     If the endpoints are fixed, then the last term vanishes, and we have arrived at Hamilton's principle :       Î´    âˆ«   t  1    t  2      L   d  t     =  0.        Î´    superscript   subscript    subscript  t  1     subscript  t  2      L  d  t     0.    \delta\int_{t_{1}}^{t_{2}}L\,dt=0.     Hamilton's principle  The Eulerâ€“Lagrange equations follow directly from Hamilton's principle, and are mathematically equivalent. From the calculus of variations , any functional of the form:      J  =    âˆ«   x  1    x  2     F   (  x  ,  y  ,   y  â€²   )   d  x        J    superscript   subscript    subscript  x  1     subscript  x  2      F   x  y   superscript  y  normal-â€²    normal-d  x      J=\int_{x_{1}}^{x_{2}}F(x,y,y^{\prime})\mathrm{d}x     leads to the general Eulerâ€“Lagrange equation for stationary value of J. (see main article for derivation):        d   d  x      âˆ‚  F    âˆ‚   y  â€²      =    âˆ‚  F    âˆ‚  y            normal-d    normal-d  x        F      superscript  y  normal-â€²          F     y      \frac{\mathrm{d}}{\mathrm{d}x}\frac{\partial F}{\partial y^{\prime}}=\frac{%
 \partial F}{\partial y}     Then making the replacements:       x  â†’  t   ,    y  â†’  q   ,     y  â€²   â†’   q  Ë™    ,    F  â†’  L   ,   J  â†’  ğ’®         formulae-sequence   normal-â†’  x  t    formulae-sequence   normal-â†’  y  q    formulae-sequence   normal-â†’   superscript  y  normal-â€²    normal-Ë™  q     formulae-sequence   normal-â†’  F  L    normal-â†’  J  ğ’®        x\rightarrow t,\quad y\rightarrow q,\quad y^{\prime}\rightarrow\dot{q},\quad F%
 \rightarrow L,\quad J\rightarrow\mathcal{S}     yields the Lagrange equations for mechanics. Since mathematically Hamilton's equations can be derived from Lagrange's equations (by a Legendre transformation ) and Lagrange's equations can be derived from Newton's laws, all of which are equivalent and summarize classical mechanics, this means classical mechanics is fundamentally ruled by a variation principle (Hamilton's principle above).  Generalized forces  For a conservative system, since the potential field is only a function of position, not velocity, Lagrange's equations also follow directly from the equation of motion above:        Q  j   =     d   d  t     (    âˆ‚   (   L  +  V   )     âˆ‚    q  Ë™   j     )    -    âˆ‚   (   L  +  V   )     âˆ‚   q  j      =    [     d   d  t     (    âˆ‚  L    âˆ‚    q  Ë™   j     )    +  0   ]   -   [     âˆ‚  L    âˆ‚   q  j     +    âˆ‚  V    âˆ‚   q  j      ]    =      d   d  t     (    âˆ‚  L    âˆ‚    q  Ë™   j     )    -    âˆ‚  L    âˆ‚   q  j      +   Q  j     .         subscript  Q  j         normal-d    normal-d  t          L  V       subscript   normal-Ë™  q   j            L  V       subscript  q  j              delimited-[]        normal-d    normal-d  t        L      subscript   normal-Ë™  q   j      0     delimited-[]        L      subscript  q  j         V      subscript  q  j                     normal-d    normal-d  t        L      subscript   normal-Ë™  q   j          L      subscript  q  j       subscript  Q  j       Q_{j}=\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial\mathcal{(}L+V)}{%
 \partial\dot{q}_{j}}\right)-\frac{\partial\mathcal{(}L+V)}{\partial q_{j}}=%
 \left[\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}_{j%
 }}\right)+0\right]-\left[\frac{\partial L}{\partial q_{j}}+\frac{\partial V}{%
 \partial q_{j}}\right]=\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{%
 \partial\dot{q}_{j}}\right)-\frac{\partial L}{\partial q_{j}}+Q_{j}.     simplifying to        d   d  t     (    âˆ‚  L    âˆ‚    q  Ë™   j     )    =    âˆ‚  L    âˆ‚   q  j             normal-d    normal-d  t        L      subscript   normal-Ë™  q   j          L      subscript  q  j       \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{q}_{j}}%
 \right)=\frac{\partial L}{\partial q_{j}}     This is consistent with the results derived above and may be seen by differentiating the right side of the Lagrangian with respect to     q  Ë™   j     subscript   normal-Ë™  q   j    \dot{q}_{j}   and time, and solely with respect to q j , adding the results and associating terms with the equations for F i and Q j .  Newton's laws  As the following derivation shows, no new physics is introduced, so the Lagrange equations can describe the dynamics of a classical system equivalently as Newton's laws, but not equivalency with Newton's 2nd law by itself which would allow for nonconservative forces such as friction. 25        Derivation of Lagrange's equations from Newton's 2nd law and D'Alembert's principle       Force and work done (on the particle)   Consider a single particle with mass  m and position vector  r , moving under an applied conservative force  F , which can be expressed as the gradient of a scalar  potential energy function V ( r , t):       ğ”½  =   -   âˆ‡  V     .      ğ”½     normal-âˆ‡  V      \mathbb{F}=-\mathbb{\nabla}V.\,   Such a force is independent of third- or higher-order derivatives of r . Consider an arbitrary displacement Î´ r of the particle. The work done by the applied force F is        Î´  W   =    ğ”½  â‹…  Î´   ğ•£    .        Î´  W      normal-â‹…  ğ”½  Î´   ğ•£     \delta W=\mathbb{F}\cdot\delta\mathbb{r}.   Using Newton's second law:         ğ”½  â‹…  Î´   ğ•£   =     m   ğ•£  Â¨    â‹…  Î´   ğ•£    .         normal-â‹…  ğ”½  Î´   ğ•£      normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     \mathbb{F}\cdot\delta\mathbb{r}=m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}.   Since work is a physical scalar quantity, we should be able to rewrite this equation in terms of the generalized coordinates and velocities. On the left hand side,         ğ”½  â‹…  Î´   ğ•£   =   -    âˆ‡  V   â‹…    âˆ‘  i      âˆ‚  ğ•£    âˆ‚   q  i     Î´   q  i       =   -    âˆ‘   i  ,  j       âˆ‚  V    âˆ‚   r  j       âˆ‚   r  j     âˆ‚   q  i     Î´   q  i      =   -    âˆ‘  i      âˆ‚  V    âˆ‚   q  i     Î´   q  i       .           normal-â‹…  ğ”½  Î´   ğ•£      normal-â‹…   normal-âˆ‡  V     subscript   i         ğ•£      subscript  q  i     Î´   subscript  q  i                subscript    i  j          V      subscript  r  j          subscript  r  j       subscript  q  i     Î´   subscript  q  i               subscript   i         V      subscript  q  i     Î´   subscript  q  i         \mathbb{F}\cdot\mathbb{\delta}\mathbb{r}=-\mathbb{\nabla}V\cdot\displaystyle%
 \sum_{i}{\partial\mathbb{r}\over\partial q_{i}}\delta q_{i}=-\displaystyle\sum%
 _{i,j}{\partial V\over\partial r_{j}}{\partial r_{j}\over\partial q_{i}}\delta
 q%
 _{i}=-\displaystyle\sum_{i}{\partial V\over\partial q_{i}}\delta q_{i}.   On the right hand side, carrying out a change of coordinates to generalized coordinates, we obtain:         m   ğ•£  Â¨    â‹…  Î´   ğ•£   =   m    âˆ‘  j     [    âˆ‘  i      r  i   Â¨     âˆ‚   r  i     âˆ‚   q  j       ]   Î´   q  j             normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     m    subscript   j      delimited-[]    subscript   i      normal-Â¨   subscript  r  i         subscript  r  i       subscript  q  j        Î´   subscript  q  j        m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}=m\sum_{j}\left[\sum_{i}\ddot{r_{i}}{%
 \partial r_{i}\over\partial q_{j}}\right]\delta q_{j}   Now integrating by parts the summand with respect to t , then differentiating with respect to t :        d   d  t     âˆ«     r  i   Â¨     âˆ‚   r  i     âˆ‚   q  j     d  t     =     d   d  t     (     âˆ‚   r  i     âˆ‚   q  j       r  Ë™   i    )    -    d   d  t     âˆ«    d   d  t     (    âˆ‚   r  i     âˆ‚   q  j     )     r  Ë™   i   d  t      =     d   d  t     (     r  Ë™   i     âˆ‚   r  i     âˆ‚   q  j      )    -     r  Ë™   i    d   d  t     (    âˆ‚   r  i     âˆ‚   q  j     )               normal-d    normal-d  t         normal-Â¨   subscript  r  i         subscript  r  i       subscript  q  j     normal-d  t           normal-d    normal-d  t           subscript  r  i       subscript  q  j      subscript   normal-Ë™  r   i         normal-d    normal-d  t          normal-d    normal-d  t         subscript  r  i       subscript  q  j      subscript   normal-Ë™  r   i   normal-d  t                 normal-d    normal-d  t       subscript   normal-Ë™  r   i        subscript  r  i       subscript  q  j          subscript   normal-Ë™  r   i     normal-d    normal-d  t         subscript  r  i       subscript  q  j          \frac{\mathrm{d}}{\mathrm{d}t}\int\ddot{r_{i}}{\partial r_{i}\over\partial q_{%
 j}}\mathrm{d}t=\frac{\mathrm{d}}{\mathrm{d}t}\left({\partial r_{i}\over%
 \partial q_{j}}\dot{r}_{i}\right)-\frac{\mathrm{d}}{\mathrm{d}t}\int\frac{%
 \mathrm{d}}{\mathrm{d}t}\left({\partial r_{i}\over\partial q_{j}}\right)\dot{r%
 }_{i}\mathrm{d}t=\frac{\mathrm{d}}{\mathrm{d}t}\left(\dot{r}_{i}{\partial r_{i%
 }\over\partial q_{j}}\right)-\dot{r}_{i}\frac{\mathrm{d}}{\mathrm{d}t}\left({%
 \partial r_{i}\over\partial q_{j}}\right)   allows the sum to be written as:         m   ğ•£  Â¨    â‹…  Î´   ğ•£   =   m    âˆ‘  j     [    âˆ‘  i    [     d   d  t     (     r  i   Ë™     âˆ‚   r  i     âˆ‚   q  j      )    -     r  i   Ë™    d   d  t     (    âˆ‚   r  i     âˆ‚   q  j     )     ]    ]   Î´   q  j             normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     m    subscript   j      delimited-[]    subscript   i    delimited-[]        normal-d    normal-d  t       normal-Ë™   subscript  r  i         subscript  r  i       subscript  q  j          normal-Ë™   subscript  r  i      normal-d    normal-d  t         subscript  r  i       subscript  q  j          Î´   subscript  q  j        m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}=m\sum_{j}\left[\sum_{i}\left[{\mathrm{%
 d}\over\mathrm{d}t}\left(\dot{r_{i}}{\partial r_{i}\over\partial q_{j}}\right)%
 -\dot{r_{i}}{\mathrm{d}\over\mathrm{d}t}\left({\partial r_{i}\over\partial q_{%
 j}}\right)\right]\right]\delta q_{j}   Recognizing that          d   d  t      âˆ‚   r  j     âˆ‚   q  i      =    âˆ‚    r  j   Ë™     âˆ‚   q  i      ,     âˆ‚   r  j     âˆ‚   q  i     =    âˆ‚    r  j   Ë™     âˆ‚    q  i   Ë™       ,     formulae-sequence        normal-d    normal-d  t         subscript  r  j       subscript  q  i           normal-Ë™   subscript  r  j        subscript  q  i             subscript  r  j       subscript  q  i          normal-Ë™   subscript  r  j        normal-Ë™   subscript  q  i         {\mathrm{d}\over\mathrm{d}t}{\partial r_{j}\over\partial q_{i}}={\partial\dot{%
 r_{j}}\over\partial q_{i}},\quad{\partial r_{j}\over\partial q_{i}}={\partial%
 \dot{r_{j}}\over\partial\dot{q_{i}}},   we obtain:         m   ğ•£  Â¨    â‹…  Î´   ğ•£   =   m    âˆ‘  j     [    âˆ‘  i    [     d   d  t     (     r  i   Ë™     âˆ‚    r  i   Ë™     âˆ‚    q  j   Ë™      )    -     r  i   Ë™     âˆ‚    r  i   Ë™     âˆ‚   q  j       ]    ]   Î´   q  j             normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     m    subscript   j      delimited-[]    subscript   i    delimited-[]        normal-d    normal-d  t       normal-Ë™   subscript  r  i         normal-Ë™   subscript  r  i        normal-Ë™   subscript  q  j           normal-Ë™   subscript  r  i         normal-Ë™   subscript  r  i        subscript  q  j          Î´   subscript  q  j        m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}=m\sum_{j}\left[\sum_{i}\left[{\mathrm{%
 d}\over\mathrm{d}t}\left(\dot{r_{i}}{\partial\dot{r_{i}}\over\partial\dot{q_{j%
 }}}\right)-\dot{r_{i}}{\partial\dot{r_{i}}\over\partial q_{j}}\right]\right]%
 \delta q_{j}      Kinetic and potential energy   Now, by changing the order of differentiation, we obtain:         m   ğ•£  Â¨    â‹…  Î´   ğ•£   =   m    âˆ‘  j     [    âˆ‘  i    [     d   d  t     âˆ‚   âˆ‚    q  j   Ë™      (    1  2      r  i   Ë™   2    )    -    âˆ‚   âˆ‚   q  j      (    1  2      r  i   Ë™   2    )     ]    ]   Î´   q  j             normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     m    subscript   j      delimited-[]    subscript   i    delimited-[]        normal-d    normal-d  t          normal-Ë™   subscript  q  j          1  2    superscript   normal-Ë™   subscript  r  i    2             subscript  q  j         1  2    superscript   normal-Ë™   subscript  r  i    2         Î´   subscript  q  j        m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}=m\sum_{j}\left[\sum_{i}\left[{\mathrm{%
 d}\over\mathrm{d}t}{\partial\over\partial\dot{q_{j}}}\left(\frac{1}{2}\dot{r_{%
 i}}^{2}\right)-{\partial\over\partial q_{j}}\left(\frac{1}{2}\dot{r_{i}}^{2}%
 \right)\right]\right]\delta q_{j}   Finally, we change the order of summation:         m   ğ•£  Â¨    â‹…  Î´   ğ•£   =    âˆ‘  j     [     d   d  t     âˆ‚   âˆ‚    q  j   Ë™      (    âˆ‘  i     1  2   m     r  i   Ë™   2     )    -    âˆ‚   âˆ‚   q  j      (    âˆ‘  i     1  2   m     r  i   Ë™   2     )     ]   Î´   q  j            normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     subscript   j      delimited-[]        normal-d    normal-d  t          normal-Ë™   subscript  q  j        subscript   i       1  2   m   superscript   normal-Ë™   subscript  r  i    2              subscript  q  j       subscript   i       1  2   m   superscript   normal-Ë™   subscript  r  i    2        Î´   subscript  q  j       m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}=\sum_{j}\left[{\mathrm{d}\over\mathrm{%
 d}t}{\partial\over\partial\dot{q_{j}}}\left(\sum_{i}\frac{1}{2}m\dot{r_{i}}^{2%
 }\right)-{\partial\over\partial q_{j}}\left(\sum_{i}\frac{1}{2}m\dot{r_{i}}^{2%
 }\right)\right]\delta q_{j}   Which is equivalent to:         m   ğ•£  Â¨    â‹…  Î´   ğ•£   =    âˆ‘  i     [     d   d  t      âˆ‚  T    âˆ‚    q  i   Ë™      -    âˆ‚  T    âˆ‚   q  i      ]   Î´   q  i            normal-â‹…    m   normal-Â¨  ğ•£    Î´   ğ•£     subscript   i      delimited-[]        normal-d    normal-d  t        T      normal-Ë™   subscript  q  i           T      subscript  q  i       Î´   subscript  q  i       m\ddot{\mathbb{r}}\cdot\delta\mathbb{r}=\sum_{i}\left[{\mathrm{d}\over\mathrm{%
 d}t}{\partial T\over\partial\dot{q_{i}}}-{\partial T\over\partial q_{i}}\right%
 ]\delta q_{i}   where T is total kinetic energy of the system.   Applying D'Alembert's principle   The equation for the work done becomes          m   ğ«  Â¨    â‹…  Î´   ğ«   -    ğ…  â‹…  Î´   ğ«    =    âˆ‘  i     [     d   d  t      âˆ‚  T    âˆ‚    q  i   Ë™      -    âˆ‚   (   T  -  V   )     âˆ‚   q  i      ]   Î´   q  i     =  0.             normal-â‹…    m   normal-Â¨  ğ«    Î´   ğ«      normal-â‹…  ğ…  Î´   ğ«      subscript   i      delimited-[]        normal-d    normal-d  t        T      normal-Ë™   subscript  q  i             T  V       subscript  q  i       Î´   subscript  q  i          0.     m\mathbf{\ddot{r}}\cdot\delta\mathbf{r}-\mathbf{F}\cdot\delta\mathbf{r}=\sum_{%
 i}\left[{\mathrm{d}\over\mathrm{d}t}{\partial{T}\over\partial{\dot{q_{i}}}}-{%
 \partial{(T-V)}\over\partial q_{i}}\right]\delta q_{i}=0.   However, this must be true for any set of generalized displacements Î´q i , so we must have       [     d   d  t      âˆ‚  T    âˆ‚    q  i   Ë™      -    âˆ‚   (   T  -  V   )     âˆ‚   q  i      ]   =  0       delimited-[]        normal-d    normal-d  t        T      normal-Ë™   subscript  q  i             T  V       subscript  q  i       0    \left[{\mathrm{d}\over\mathrm{d}t}{\partial{T}\over\partial{\dot{q_{i}}}}-{%
 \partial{(T-V)}\over\partial q_{i}}\right]=0   for each generalized coordinate Î´q i . We can further simplify this by noting that V is a function solely of r and t , and r is a function of the generalized coordinates and t . Therefore, V is independent of the generalized velocities:        d   d  t      âˆ‚  V    âˆ‚    q  i   Ë™      =  0.          normal-d    normal-d  t        V      normal-Ë™   subscript  q  i       0.    {\mathrm{d}\over\mathrm{d}t}{\partial{V}\over\partial{\dot{q_{i}}}}=0.   Inserting this into the preceding equation and substituting L = T âˆ’ V , called the Lagrangian, we obtain Lagrange's equations:         âˆ‚  L    âˆ‚   q  i     =    d   d  t      âˆ‚  L    âˆ‚    q  i   Ë™       .          L      subscript  q  i         normal-d    normal-d  t        L      normal-Ë™   subscript  q  i         {\partial{L}\over\partial q_{i}}={\mathrm{d}\over\mathrm{d}t}{\partial{L}\over%
 \partial{\dot{q_{i}}}}.          When q i = r i (i.e. the generalized coordinates are simply the Cartesian coordinates), it is straightforward to check that Lagrange's equations reduce to Newton's second law.  Advantages of the Lagrangian formulation  Importance  The Lagrangian formulation of mechanics is important not just for its broad applications, but also for its role in advancing deep understanding of physics . Although Lagrange only sought to describe classical mechanics , the action principle that is used to derive the Lagrange equation was later recognized to be applicable to quantum mechanics as well.  Physical action and quantum-mechanical phase are related via Planck's constant , and the principle of stationary action can be understood in terms of constructive interference of wave functions .  The same principle, and the Lagrangian formalism, are tied closely to Noether's theorem , which connects physical conserved quantities to continuous symmetries of a physical system.  Lagrangian mechanics and Noether's theorem together yield a natural formalism for first quantization by including commutators between certain terms of the Lagrangian equations of motion for a physical system.  Advantages over other methods   The formulation is not tied to any one coordinate system â€“ rather, any convenient variables may be used to describe the system; these variables are called " generalized coordinates " q i and may be any quantitative attributes of the system (for example, strength of the magnetic field at a particular location; angle of a pulley; position of a particle in space; or degree of excitation of a particular eigenmode in a complex system) which are functions of the independent variable (s). This trait makes it easy to incorporate constraints into a theory by defining coordinates that only describe states of the system that satisfy the constraints.    If the Lagrangian is invariant under a symmetry, then the resulting equations of motion are also invariant under that symmetry. This characteristic is very helpful in showing that theories are consistent with either special relativity or general relativity .   Cyclic coordinates and conservation laws  An important property of the Lagrangian is that conservation laws can easily be read off from it. For example, if the Lagrangian   L   L   \scriptstyle L   does not depend on    q  i     subscript  q  i    \scriptstyle q_{i}   itself (    q  i     subscript  q  i    \scriptstyle q_{i}   representing a set of generalized coordinates ), then the generalized momentum (    p  i     subscript  p  i    \scriptstyle p_{i}   ), given by:        p  i   =    âˆ‚  L    âˆ‚    q  Ë™   i      ,       subscript  p  i       L      subscript   normal-Ë™  q   i       p_{i}=\frac{\partial L}{\partial\dot{q}_{i}},   is a conserved quantity, because of Lagrange's equations :        p  Ë™   i   =    d   d  t      âˆ‚  L    âˆ‚    q  Ë™   i      =    âˆ‚  L    âˆ‚   q  i     =  0.         subscript   normal-Ë™  p   i       d    d  t        L      subscript   normal-Ë™  q   i               L      subscript  q  i          0.     \dot{p}_{i}=\frac{d}{dt}\frac{\partial L}{\partial\dot{q}_{i}}=\frac{\partial L%
 }{\partial q_{i}}=0.     It doesn't matter if   L   L   \scriptstyle L   depends on the time derivative      q  Ë™   i     subscript   normal-Ë™  q   i    \scriptstyle\dot{q}_{i}   of that generalized coordinate, since the Lagrangian independence of the coordinate always makes the above partial derivative zero. This is a special case of Noether's theorem . Such coordinates are called "cyclic" or "ignorable".  For example, the conservation of the generalized momentum,        p  2   =    âˆ‚  L    âˆ‚    q  Ë™   2      ,       subscript  p  2       L      subscript   normal-Ë™  q   2       p_{2}=\frac{\partial L}{\partial\dot{q}_{2}},   say, can be directly seen if the Lagrangian of the system is of the form       L   (   q  1   ,   q  3   ,   q  4   ,  â€¦  ;    q  Ë™   1   ,    q  Ë™   2   ,    q  Ë™   3   ,    q  Ë™   4   ,  â€¦  ;  t  )    .      L    subscript  q  1    subscript  q  3    subscript  q  4   normal-â€¦   subscript   normal-Ë™  q   1    subscript   normal-Ë™  q   2    subscript   normal-Ë™  q   3    subscript   normal-Ë™  q   4   normal-â€¦  t     L(q_{1},q_{3},q_{4},\dots;\dot{q}_{1},\dot{q}_{2},\dot{q}_{3},\dot{q}_{4},%
 \dots;t)\,.     Also, if the time t , does not appear in L , then the Hamiltonian , which is related to the Lagrangian by a Legendre transformation , is conserved. This is the energy conservation unless the potential energy depends on velocity, as in electrodynamics . 26 27  Examples  The following examples apply Lagrange's equations of the second kind to mechanical problems.  Falling mass  Consider a point mass m falling freely from rest. By gravity a force F = mg is exerted on the mass (assuming g constant during the motion). Filling in the force in Newton's law, we find     x  Â¨   =  g       normal-Â¨  x   g    \ddot{x}=g   from which the solution       x   (  t  )    =    1  2   g   t  2          x  t       1  2   g   superscript  t  2      x(t)=\frac{1}{2}gt^{2}   follows (by taking the antiderivative of the antiderivative, and choosing the origin as the starting point). This result can also be derived through the Lagrangian formalism. Take x to be the coordinate, which is 0 at the starting point. The kinetic energy is T =    1  /  2      1  2    {1}/{2}    mv 2 and the potential energy is V = âˆ’ mgx ; hence,       L  =   T  -  V   =     1  2   m    x  Ë™   2    +   m  g  x     .        L    T  V              1  2   m   superscript   normal-Ë™  x   2      m  g  x       L=T-V=\frac{1}{2}m\dot{x}^{2}+mgx.   Then         âˆ‚  L    âˆ‚  x    -    d   d  t      âˆ‚  L    âˆ‚   x  Ë™       =  0  =    m  g   -   m    d   x  Ë™     d  t                  L     x        normal-d    normal-d  t        L      normal-Ë™  x       0           m  g     m      normal-d   normal-Ë™  x      normal-d  t         \frac{\partial L}{\partial x}-\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{%
 \partial\dot{x}}=0=mg-m\frac{\mathrm{d}\dot{x}}{\mathrm{d}t}   which can be rewritten as     x  Â¨   =  g       normal-Â¨  x   g    \ddot{x}=g   , yielding the same result as earlier.  Harmonic oscillator  (Figure)  A simple harmonic oscillator; a mass m attached to a spring obeying Hooke's law with spring constant k .   Consider a spring fixed at one end but free to oscillate on the other in one dimension, with a mass m attached to the free end, neglecting gravity or any damping forces, and the spring obeys Hooke's law with spring constant k , Let x be the coordinate, a point along the direction of oscillation, chosen to be zero at the equilibrium point, and the mass can oscillate either side. The kinetic and potential energies are        T  =    1  2   m     x  Ë™   2      ,   V  =    1  2   k    x  2       ,     formulae-sequence    T      1  2   m   superscript   normal-Ë™  x   2       V      1  2   k   superscript  x  2       T=\frac{1}{2}m\dot{x}^{2}\,,\quad V=\frac{1}{2}kx^{2}\,,     hence the Lagrangian is      L  =   T  -  V   =     1  2   m    x  Ë™   2    -    1  2   k   x  2           L    T  V              1  2   m   superscript   normal-Ë™  x   2        1  2   k   superscript  x  2        L=T-V=\frac{1}{2}m\dot{x}^{2}-\frac{1}{2}kx^{2}     and the equation of motion is that of simple harmonic motion ,          d   d  t      âˆ‚  L    âˆ‚   x  Ë™      =     âˆ‚  L    âˆ‚  x    â‡’      m   x  Â¨    =   -   k   x       ,     formulae-sequence        d    d  t        L      normal-Ë™  x           L     x    normal-â‡’        m   normal-Â¨  x        k  x       \frac{d}{dt}\frac{\partial L}{\partial\dot{x}}=\frac{\partial L}{\partial x}%
 \quad\Rightarrow\quad m\ddot{x}=-kx\,,     or         x  Â¨   =   -    Ï‰  2    x      ,   Ï‰  =     k  /  m       ,     formulae-sequence     normal-Â¨  x        superscript  Ï‰  2   x       Ï‰      k  m       \ddot{x}=-\omega^{2}x\,,\quad\omega=\sqrt{k/m}\,,     where Ï‰ is the angular frequency of the oscillation. The solutions are sinusoidal oscillations:       x   (  t  )    =    A   sin   (   Ï‰  t   )     +   B   cos   (   Ï‰  t   )            x  t       A      Ï‰  t       B      Ï‰  t        x(t)=A\sin(\omega t)+B\cos(\omega t)     with A and B are arbitrary constants to be determined from the initial conditions (which have not been specified above). For a harmonic oscillator in higher dimensions, oscillating along a straight line, one can just choose the coordinate along the direction of oscillation and the solution is exactly the same as shown.  There are many complicated and interesting variants of this simple system, which can be solved efficiently using Lagrange's method as shown (although the many degrees of freedom which arise prompt use of the mass matrix ). There could be one or many coupled simple harmonic oscillators, with or without damping, with or without some driving force, and in higher dimensions. For example, coupled springs in a mechanical system, the vibrational modes of a molecule, or vibrations of atoms in a crystal. See normal mode for more on this topic.  Pendulum on a movable support  Consider a pendulum of mass m and length â„“ , which is attached to a support with mass M , which can move along a line in the x -direction. Let x be the coordinate along the line of the support, and let us denote the position of the pendulum by the angle Î¸ from the vertical.  (Figure)  Sketch of the situation with definition of the coordinates (click to enlarge)   The kinetic energy can then be shown to be        T    =       1  2   M    x  Ë™   2    +    1  2   m   (     x  Ë™   pend  2   +    y  Ë™   pend  2    )          =        1  2   M    x  Ë™   2    +    1  2   m   [     (    x  Ë™   +   â„“   Î¸  Ë™    cos  Î¸     )   2   +    (   â„“   Î¸  Ë™    sin  Î¸    )   2    ]     ,         T         1  2   M   superscript   normal-Ë™  x   2        1  2   m     superscript   subscript   normal-Ë™  x   pend   2    superscript   subscript   normal-Ë™  y   pend   2         missing-subexpression          1  2   M   superscript   normal-Ë™  x   2        1  2   m   delimited-[]     superscript     normal-Ë™  x     normal-â„“   normal-Ë™  Î¸     Î¸     2    superscript    normal-â„“   normal-Ë™  Î¸     Î¸    2          \begin{array}[]{rcl}T&=&\frac{1}{2}M\dot{x}^{2}+\frac{1}{2}m\left(\dot{x}_{%
 \mathrm{pend}}^{2}+\dot{y}_{\mathrm{pend}}^{2}\right)\\
 &=&\frac{1}{2}M\dot{x}^{2}+\frac{1}{2}m\left[\left(\dot{x}+\ell\dot{\theta}%
 \cos\theta\right)^{2}+\left(\ell\dot{\theta}\sin\theta\right)^{2}\right],\end{array}     and the potential energy of the system is       V  =   m  g   y  pend    =   -   m  g  â„“   cos  Î¸      .        V    m  g   subscript  y  pend             m  g  normal-â„“    Î¸        V=mgy_{\mathrm{pend}}=-mg\ell\cos\theta.     The Lagrangian is therefore        L    =     T  -  V        =       1  2   M    x  Ë™   2    +    1  2   m   [     (    x  Ë™   +   â„“   Î¸  Ë™    cos  Î¸     )   2   +    (   â„“   Î¸  Ë™    sin  Î¸    )   2    ]    +   m  g  â„“   cos  Î¸          =       1  2    (   M  +  m   )     x  Ë™   2    +   m   x  Ë™   â„“   Î¸  Ë™    cos  Î¸    +    1  2   m   â„“  2     Î¸  Ë™   2    +   m  g  â„“   cos  Î¸           L     T  V      missing-subexpression          1  2   M   superscript   normal-Ë™  x   2        1  2   m   delimited-[]     superscript     normal-Ë™  x     normal-â„“   normal-Ë™  Î¸     Î¸     2    superscript    normal-â„“   normal-Ë™  Î¸     Î¸    2        m  g  normal-â„“    Î¸        missing-subexpression          1  2     M  m    superscript   normal-Ë™  x   2      m   normal-Ë™  x   normal-â„“   normal-Ë™  Î¸     Î¸        1  2   m   superscript  normal-â„“  2    superscript   normal-Ë™  Î¸   2      m  g  normal-â„“    Î¸        \begin{array}[]{rcl}L&=&T-V\\
 &=&\frac{1}{2}M\dot{x}^{2}+\frac{1}{2}m\left[\left(\dot{x}+\ell\dot{\theta}%
 \cos\theta\right)^{2}+\left(\ell\dot{\theta}\sin\theta\right)^{2}\right]+mg%
 \ell\cos\theta\\
 &=&\frac{1}{2}\left(M+m\right)\dot{x}^{2}+m\dot{x}\ell\dot{\theta}\cos\theta+%
 \frac{1}{2}m\ell^{2}\dot{\theta}^{2}+mg\ell\cos\theta\end{array}     Now carrying out the differentiations gives for the support coordinate x         d   d  t     [     (   M  +  m   )    x  Ë™    +   m  â„“   Î¸  Ë™    cos  Î¸     ]    =  0   ,          normal-d    normal-d  t     delimited-[]        M  m    normal-Ë™  x      m  normal-â„“   normal-Ë™  Î¸     Î¸       0    \frac{\mathrm{d}}{\mathrm{d}t}\left[(M+m)\dot{x}+m\ell\dot{\theta}\cos\theta%
 \right]=0,     therefore:          (   M  +  m   )    x  Â¨    +   m  â„“   Î¸  Â¨    cos  Î¸     -   m  â„“    Î¸  Ë™   2    sin  Î¸     =  0              M  m    normal-Â¨  x      m  normal-â„“   normal-Â¨  Î¸     Î¸       m  normal-â„“   superscript   normal-Ë™  Î¸   2     Î¸     0    (M+m)\ddot{x}+m\ell\ddot{\theta}\cos\theta-m\ell\dot{\theta}^{2}\sin\theta=0     indicating the presence of a constant of motion. Performing the same procedure for the variable   Î¸   Î¸   \theta   yields:          d   d  t     [   m   (     x  Ë™   â„“   cos  Î¸    +    â„“  2    Î¸  Ë™     )    ]    +   m  â„“   (     x  Ë™    Î¸  Ë™    +  g   )    sin  Î¸     =  0   ;            normal-d    normal-d  t     delimited-[]    m       normal-Ë™  x   normal-â„“    Î¸       superscript  normal-â„“  2    normal-Ë™  Î¸          m  normal-â„“       normal-Ë™  x    normal-Ë™  Î¸    g     Î¸     0    \frac{\mathrm{d}}{\mathrm{d}t}\left[m(\dot{x}\ell\cos\theta+\ell^{2}\dot{%
 \theta})\right]+m\ell(\dot{x}\dot{\theta}+g)\sin\theta=0;     therefore        Î¸  Â¨   +     x  Â¨   â„“    cos  Î¸    +    g  â„“    sin  Î¸     =   0.          normal-Â¨  Î¸        normal-Â¨  x   normal-â„“     Î¸        g  normal-â„“     Î¸     0.    \ddot{\theta}+\frac{\ddot{x}}{\ell}\cos\theta+\frac{g}{\ell}\sin\theta=0.\,     These equations may look quite complicated, but finding them with Newton's laws would have required carefully identifying all forces, which would have been much more laborious and prone to errors. By considering limit cases, the correctness of this system can be verified: For example,     x  Â¨   â†’  0     normal-â†’   normal-Â¨  x   0    \ddot{x}\to 0   should give the equations of motion for a pendulum that is at rest in some inertial frame , while     Î¸  Â¨   â†’  0     normal-â†’   normal-Â¨  Î¸   0    \ddot{\theta}\to 0   should give the equations for a pendulum in a constantly accelerating system, etc. Furthermore, it is trivial to obtain the results numerically, given suitable starting conditions and a chosen time step, by stepping through the results iteratively .  Two-body central force problem  The basic problem is that of two bodies in orbit about each other attracted by a central force. The Jacobi coordinates are introduced; namely, the location of the center of mass R and the separation of the bodies r (the relative position). The Lagrangian is then 28 29     L   L   \displaystyle L     where M is the total mass, Î¼ is the reduced mass , and U the potential of the radial force. The Lagrangian is divided into a center-of-mass term and a relative motion term. The R equation from the Eulerâ€“Lagrange system is simply:        M   ğ‘  Â¨    =  0   ,        M   normal-Â¨  ğ‘    0    M\ddot{\mathbf{R}}=0,\,     resulting in simple motion of the center of mass in a straight line at constant velocity. The relative motion is expressed in polar coordinates ( r , Î¸ ):       L  =     1  2   Î¼   (     r  Ë™   2   +    r  2     Î¸  Ë™   2     )    -   U   (  r  )      ,      L        1  2   Î¼     superscript   normal-Ë™  r   2      superscript  r  2    superscript   normal-Ë™  Î¸   2        U  r      L=\frac{1}{2}\mu\left(\dot{r}^{2}+r^{2}\dot{\theta}^{2}\right)-U(r),     which does not depend upon Î¸ , therefore an ignorable coordinate. The Lagrange equation for Î¸ is then:         âˆ‚  L    âˆ‚   Î¸  Ë™     =   Î¼   r  2    Î¸  Ë™    =  constant  =  â„“   ,            L      normal-Ë™  Î¸       Î¼   superscript  r  2    normal-Ë™  Î¸         constant       normal-â„“     \frac{\partial L}{\partial\dot{\theta}}=\mu r^{2}\dot{\theta}=\mathrm{constant%
 }=\ell,\,     where â„“ is the conserved angular momentum. The Lagrange equation for r is:         âˆ‚  L    âˆ‚  r    =    d   d  t      âˆ‚  L    âˆ‚   r  Ë™       ,          L     r        normal-d    normal-d  t        L      normal-Ë™  r        \frac{\partial L}{\partial r}=\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{%
 \partial\dot{r}},\,     or:         Î¼  r    Î¸  Ë™   2    -    d  U    d  r     =   Î¼   r  Â¨     .          Î¼  r   superscript   normal-Ë™  Î¸   2        d  U     d  r       Î¼   normal-Â¨  r      \mu r\dot{\theta}^{2}-\frac{dU}{dr}=\mu\ddot{r}.\,     This equation is identical to the radial equation obtained using Newton's laws in a co-rotating reference frame, that is, a frame rotating with the reduced mass so it appears stationary. If the angular velocity is replaced by its value in terms of the angular momentum,        Î¸  Ë™   =   â„“   Î¼   r  2      ,       normal-Ë™  Î¸     normal-â„“    Î¼   superscript  r  2       \dot{\theta}=\frac{\ell}{\mu r^{2}},\,     the radial equation becomes: 30        Î¼   r  Â¨    =    -    d  U    d  r     +    â„“  2    Î¼   r  3       .        Î¼   normal-Â¨  r            d  U     d  r        superscript  normal-â„“  2     Î¼   superscript  r  3        \mu\ddot{r}=-\frac{dU}{dr}+\frac{\ell^{2}}{\mu r^{3}}.\,     which is the equation of motion for a one-dimensional problem in which a particle of mass Î¼ is subjected to the inward central force âˆ’d U /d r and a second outward force, called in this context the centrifugal force :        F  cf   =   Î¼  r    Î¸  Ë™   2    =    â„“  2    Î¼   r  3      .         subscript  F  cf     Î¼  r   superscript   normal-Ë™  Î¸   2            superscript  normal-â„“  2     Î¼   superscript  r  3        F_{\mathrm{cf}}=\mu r\dot{\theta}^{2}=\frac{\ell^{2}}{\mu r^{3}}.\,     Of course, if one remains entirely within the one-dimensional formulation, â„“ enters only as some imposed parameter of the external outward force, and its interpretation as angular momentum depends upon the more general two-dimensional problem from which the one-dimensional problem originated.  If one arrives at this equation using Newtonian mechanics in a co-rotating frame, the interpretation is evident as the centrifugal force in that frame due to the rotation of the frame itself. If one arrives at this equation directly by using the generalized coordinates ( r , Î¸ ) and simply following the Lagrangian formulation without thinking about frames at all, the interpretation is that the centrifugal force is an outgrowth of using polar coordinates . As Hildebrand says: 31 "Since such quantities are not true physical forces, they are often called inertia forces . Their presence or absence depends, not upon the particular problem at hand, but upon the coordinate system chosen ." In particular, if Cartesian coordinates are chosen, the centrifugal force disappears, and the formulation involves only the central force itself, which provides the centripetal force for a curved motion.  This viewpoint, that fictitious forces originate in the choice of coordinates, often is expressed by users of the Lagrangian method. This view arises naturally in the Lagrangian approach, because the frame of reference is (possibly unconsciously) selected by the choice of coordinates.  For example, see  for a comparison of Lagrangians in an inertial and in a noninertial frame of reference. See also the discussion of "total" and "updated" Lagrangian formulations in   Unfortunately, this usage of "inertial force" conflicts with the Newtonian idea of an inertial force. In the Newtonian view, an inertial force originates in the acceleration of the frame of observation (the fact that it is not an inertial frame of reference ), not in the choice of coordinate system. To keep matters clear, it is safest to refer to the Lagrangian inertial forces as generalized inertial forces, to distinguish them from the Newtonian vector inertial forces. That is, one should avoid following Hildebrand when he says (p.Â 155) "we deal always with generalized forces, velocities accelerations, and momenta. For brevity, the adjective "generalized" will be omitted frequently."  It is known that the Lagrangian of a system is not unique. Within the Lagrangian formalism the Newtonian fictitious forces can be identified by the existence of alternative Lagrangians in which the fictitious forces disappear, sometimes found by exploiting the symmetry of the system. 32  Examples in specific coordinate systems  In Cartesian coordinates  Suppose we have a three-dimensional space in which a particle of mass m moves under the influence of a conservative force    ğ…   ğ…   \mathbf{F}   . Since the force is conservative, it corresponds to a potential energy function    V   (  ğ±  )       V  ğ±    V(\mathbf{x})   given by    ğ…  =   -    âˆ‡  V    (  ğ±  )         ğ…       normal-âˆ‡  V   ğ±      \mathbf{F}=-\nabla V(\mathbf{x})   . The Lagrangian of the particle can be written        L   (  ğ±  ,   ğ±  Ë™   )    =     1  2   m    ğ±  Ë™   2    -   V   (  ğ±  )      .        L   ğ±   normal-Ë™  ğ±           1  2   m   superscript   normal-Ë™  ğ±   2      V  ğ±      L(\mathbf{x},\dot{\mathbf{x}})=\frac{1}{2}m\dot{\mathbf{x}}^{2}-V(\mathbf{x}).     The equations of motion for the particle are found by applying the Eulerâ€“Lagrange equation          d   d  t     (    âˆ‚  L    âˆ‚    x  Ë™   i     )    -    âˆ‚  L    âˆ‚   x  i      =  0   ,            normal-d    normal-d  t        L      subscript   normal-Ë™  x   i          L      subscript  x  i      0    \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{x}_{i}}%
 \right)-\frac{\partial L}{\partial x_{i}}=0,   where i = 1, 2, 3.  Then         âˆ‚  L    âˆ‚   x  i     =   -    âˆ‚  V    âˆ‚   x  i       ,          L      subscript  x  i           V      subscript  x  i        \frac{\partial L}{\partial x_{i}}=-\frac{\partial V}{\partial x_{i}},            âˆ‚  L    âˆ‚    x  Ë™   i     =    âˆ‚   âˆ‚    x  Ë™   i      (    1  2   m    ğ±  Ë™   2    )    =    1  2   m   âˆ‚   âˆ‚    x  Ë™   i      (    x  Ë™   i  2   )    =   m    x  Ë™   i     ,            L      subscript   normal-Ë™  x   i             subscript   normal-Ë™  x   i         1  2   m   superscript   normal-Ë™  ğ±   2              1  2   m        subscript   normal-Ë™  x   i      superscript   subscript   normal-Ë™  x   i   2           m   subscript   normal-Ë™  x   i       \frac{\partial L}{\partial\dot{x}_{i}}=\frac{\partial~{}}{\partial\dot{x}_{i}}%
 \left(\frac{1}{2}m\dot{\mathbf{x}}^{2}\right)=\frac{1}{2}m\frac{\partial~{}}{%
 \partial\dot{x}_{i}}\left(\dot{x}_{i}^{2}\right)=m\dot{x}_{i},   and         d   d  t     (    âˆ‚  L    âˆ‚    x  Ë™   i     )    =   m    x  Â¨   i     .          normal-d    normal-d  t        L      subscript   normal-Ë™  x   i        m   subscript   normal-Â¨  x   i      \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial\dot{x}_{i}}%
 \right)=m\ddot{x}_{i}.     Thus         m   ğ±  Â¨    +   âˆ‡  V    =  0   ,          m   normal-Â¨  ğ±     normal-âˆ‡  V    0    m\ddot{\mathbf{x}}+\nabla V=0,   which is Newton's second law of motion for a particle subject to a conservative force. Here the time derivative is written conventionally as a dot above the quantity being differentiated, and âˆ‡ is the del operator .  In spherical coordinates  Suppose we have a three-dimensional space using spherical coordinates ( r, Î¸, Ï† ) with the Lagrangian       L  =     m  2    (     r  Ë™   2   +    r  2     Î¸  Ë™   2    +    r  2     sin  2     Î¸     Ï†  Ë™   2       )    -   V   (  r  )      .      L        m  2      superscript   normal-Ë™  r   2      superscript  r  2    superscript   normal-Ë™  Î¸   2       superscript  r  2     superscript   2     Î¸   superscript   normal-Ë™  Ï†   2          V  r      L=\frac{m}{2}(\dot{r}^{2}+r^{2}\dot{\theta}^{2}+r^{2}\sin^{2}\theta\,\dot{%
 \varphi}^{2})-V(r).     Then the Eulerâ€“Lagrange equations are:          m   r  Â¨    -   m  r   (     Î¸  Ë™   2   +    sin  2     Î¸     Ï†  Ë™   2      )     +   V  â€²    =  0   ,            m   normal-Â¨  r      m  r     superscript   normal-Ë™  Î¸   2     superscript   2     Î¸   superscript   normal-Ë™  Ï†   2         superscript  V  normal-â€²    0    m\ddot{r}-mr(\dot{\theta}^{2}+\sin^{2}\theta\,\dot{\varphi}^{2})+V^{\prime}=0,             d   d  t     (   m   r  2    Î¸  Ë™    )    -   m   r  2    sin  Î¸    cos    Î¸     Ï†  Ë™   2       =  0   ,            normal-d    normal-d  t      m   superscript  r  2    normal-Ë™  Î¸       m   superscript  r  2     Î¸       Î¸   superscript   normal-Ë™  Ï†   2       0    \frac{\mathrm{d}}{\mathrm{d}t}(mr^{2}\dot{\theta})-mr^{2}\sin\theta\cos\theta%
 \,\dot{\varphi}^{2}=0,           d   d  t     (   m   r  2     sin  2     Î¸    Ï†  Ë™      )    =  0.          normal-d    normal-d  t      m   superscript  r  2     superscript   2     Î¸   normal-Ë™  Ï†       0.    \frac{\mathrm{d}}{\mathrm{d}t}(mr^{2}\sin^{2}\theta\,\dot{\varphi})=0.     Here the set of parameters s i is just the time t , and the dynamical variables Ï• i ( s ) are the trajectories     x  â†’    (  t  )        normal-â†’  x   t    \scriptstyle\vec{x}(t)   of the particle.  Despite the use of standard variables such as x , the Lagrangian allows the use of any coordinates, which do not need to be orthogonal . These are " generalized coordinates ".  Test particles in fields  A test particle is a particle whose mass and charge are assumed to be so small that its effect on external system is insignificant. It is often a hypothetical simplified point particle with no properties other than mass and charge. Real particles like electrons and up quarks are more complex and have additional terms in their Lagrangians.  Classical test particle with Newtonian gravity  Suppose we are given a particle with mass m kilograms, and position   ğ±   ğ±   \mathbf{x}   meters in a Newtonian gravitation field with potential Î¦ in JÂ·kg âˆ’1 . The particle's world line is parameterized by time t seconds. The particle's kinetic energy is:       T   (  t  )    =     1  2    m    |    ğ±  Ë™    (  t  )    |   2          T  t       1  2   m   superscript       normal-Ë™  ğ±   t    2      T(t)={\tfrac{1}{2}}m\left|\dot{\mathbf{x}}(t)\right|^{2}     and the particle's gravitational potential energy is:        V   (  t  )    =   m  Î¦   (   ğ±   (  t  )    ,  t  )     .        V  t     m  normal-Î¦     ğ±  t   t      V(t)=m\Phi(\mathbf{x}(t),t).     Then its Lagrangian is L joules, where        L   (  t  )    =    T   (  t  )    -   V   (  t  )     =      1  2    m    |    ğ±  Ë™    (  t  )    |   2    -   m  Î¦   (   ğ±   (  t  )    ,  t  )      .          L  t       T  t     V  t               1  2   m   superscript       normal-Ë™  ğ±   t    2      m  normal-Î¦     ğ±  t   t        L(t)=T(t)-V(t)={\tfrac{1}{2}}m\left|\dot{\mathbf{x}}(t)\right|^{2}-m\Phi(%
 \mathbf{x}(t),t).     Varying   ğ±   ğ±   \mathbf{x}   in the integral (equivalent to the Eulerâ€“Lagrange differential equation), we get      0  =   Î´   âˆ«   L   (  t  )   d  t     =   âˆ«   Î´  L   (  t  )   d  t          0    Î´      L  t  normal-d  t              Î´  L  t  normal-d  t       0=\delta\int{L(t)\,\mathrm{d}t}=\int{\delta L(t)\,\mathrm{d}t}           =   âˆ«    (      m   ğ±  Ë™    (  t  )    â‹…    Î´  ğ±   Ë™     (  t  )    -     m   âˆ‡  Î¦    (   ğ±   (  t  )    ,  t  )    â‹…  Î´   ğ±   (  t  )     )   d  t     .      absent           normal-â‹…    m   normal-Ë™  ğ±   t    normal-Ë™    Î´  ğ±     t      normal-â‹…    m   normal-âˆ‡  normal-Î¦      ğ±  t   t    Î´   ğ±  t    normal-d  t      =\int{(m\dot{\mathbf{x}}(t)\cdot\dot{\delta\mathbf{x}}(t)-m\nabla\Phi(\mathbf{%
 x}(t),t)\cdot\delta\mathbf{x}(t))\,\mathrm{d}t}.     Integrate the first term by parts and discard the total integral. Then divide out the variation to get      0  =    -   m   ğ±  Â¨    (  t  )     -   m   âˆ‡  Î¦    (   ğ±   (  t  )    ,  t  )         0        m   normal-Â¨  ğ±   t      m   normal-âˆ‡  normal-Î¦      ğ±  t   t       0=-m\ddot{\mathbf{x}}(t)-m\nabla\Phi(\mathbf{x}(t),t)     and thus  (t) = - m \nabla \Phi (\mathbf{x}(t),t)  | 1 }}  is the equation of motion â€“ two different expressions for the force.  Special relativistic test particle with electromagnetism  In special relativity, the energy (rest energy plus kinetic energy) of a free test particle is        m   c  2     d  t    d  Ï„     =    m   c  2      1  -     v  2    (  t  )     c  2       =    +   m   c  2     +    1  2   m   v  2    (  t  )    +    3  8   m     v  4    (  t  )     c  2     +   â€¦     .          m   superscript  c  2       d  t     d  Ï„         m   superscript  c  2        1       superscript  v  2   t    superscript  c  2                  m   superscript  c  2         1  2   m   superscript  v  2   t       3  8   m       superscript  v  4   t    superscript  c  2     normal-â€¦      mc^{2}\frac{dt}{d\tau}=\frac{mc^{2}}{\sqrt{1-\frac{v^{2}(t)}{c^{2}}}}=+mc^{2}+%
 {1\over 2}mv^{2}(t)+{3\over 8}m\frac{v^{4}(t)}{c^{2}}+\dots\,.     However, the term in the Lagrangian that gives rise to the derivative of the momentum is no longer the kinetic energy.  One possible Lagrangian       -   m   c  2     d  Ï„   (  t  )     d  t      =   -   m   c  2     1  -     v  2    (  t  )     c  2        =    -   m   c  2     +    1  2   m   v  2    (  t  )    +    1  8   m     v  4    (  t  )     c  2     +  â€¦             m   superscript  c  2       d  Ï„  t     d  t          m   superscript  c  2       1       superscript  v  2   t    superscript  c  2                   m   superscript  c  2         1  2   m   superscript  v  2   t       1  8   m       superscript  v  4   t    superscript  c  2     normal-â€¦      -mc^{2}\frac{d\tau(t)}{dt}=-mc^{2}\sqrt{1-\frac{v^{2}(t)}{c^{2}}}=-mc^{2}+{1%
 \over 2}mv^{2}(t)+{1\over 8}m\frac{v^{4}(t)}{c^{2}}+\dots     where c is the vacuum speed of light in mÂ·s âˆ’1 , Ï„ is the proper time in seconds (i.e. time measured by a clock moving with the particle) and       v  2    (  t  )    =      ğ±  Ë™    (  t  )    â‹…   ğ±  Ë™     (  t  )     .         superscript  v  2   t      normal-â‹…     normal-Ë™  ğ±   t    normal-Ë™  ğ±    t     \scriptstyle v^{2}(t)=\dot{\mathbf{x}}(t)\cdot\dot{\mathbf{x}}(t).   The second term in the series is just the classical kinetic energy. Suppose the particle has electrical charge q coulombs and is in an electromagnetic field with scalar potential Ï• volts (a volt is a joule per coulomb) and vector potential    ğ€   ğ€   \scriptstyle\mathbf{A}   VÂ·sÂ·m âˆ’1 . The Lagrangian of a special relativistic test particle in an electromagnetic field is:        L   (  t  )    =     -   m   c  2     1  -     v  2    (  t  )     c  2        -   q  Ï•   (   ğ±   (  t  )    ,  t  )     +     q   ğ±  Ë™    (  t  )    â‹…  ğ€    (   ğ±   (  t  )    ,  t  )      .        L  t           m   superscript  c  2       1       superscript  v  2   t    superscript  c  2          q  Ï•     ğ±  t   t        normal-â‹…    q   normal-Ë™  ğ±   t   ğ€      ğ±  t   t       L(t)=-mc^{2}\sqrt{1-\frac{v^{2}(t)}{c^{2}}}-q\phi(\mathbf{x}(t),t)+q\dot{%
 \mathbf{x}}(t)\cdot\mathbf{A}(\mathbf{x}(t),t).     Varying this with respect to   ğ±   ğ±   \mathbf{x}   , we get      0  =     -    d   d  t     (    m   ğ±  Ë™    (  t  )      1  -     v  2    (  t  )     c  2       )     -   q   âˆ‡  Ï•    (   ğ±   (  t  )    ,  t  )    -   q     âˆ‚  ğ€    (   ğ±   (  t  )    ,  t  )     âˆ‚  t     -     q   ğ±  Ë™    (  t  )    â‹…   âˆ‡  ğ€     (   ğ±   (  t  )    ,  t  )     +     q   âˆ‡  ğ€    (   ğ±   (  t  )    ,  t  )    â‹…   ğ±  Ë™     (  t  )         0            d    d  t        m   normal-Ë™  ğ±   t       1       superscript  v  2   t    superscript  c  2           q   normal-âˆ‡  Ï•      ğ±  t   t      q        ğ€      ğ±  t   t      t        normal-â‹…    q   normal-Ë™  ğ±   t    normal-âˆ‡  ğ€       ğ±  t   t        normal-â‹…    q   normal-âˆ‡  ğ€      ğ±  t   t     normal-Ë™  ğ±    t      0=-\frac{d}{dt}\left(\frac{m\dot{\mathbf{x}}(t)}{\sqrt{1-\frac{v^{2}(t)}{c^{2}%
 }}}\right)-q\nabla\phi(\mathbf{x}(t),t)-q\frac{\partial\mathbf{A}(\mathbf{x}(t%
 ),t)}{\partial t}-q\dot{\mathbf{x}}(t)\cdot\nabla\mathbf{A}(\mathbf{x}(t),t)+q%
 \nabla{\mathbf{A}}(\mathbf{x}(t),t)\cdot\dot{\mathbf{x}}(t)     which is        d   d  t     (    m   ğ±  Ë™    (  t  )      1  -     v  2    (  t  )     c  2       )    =    q  ğ„   (   ğ±   (  t  )    ,  t  )    +     q   ğ±  Ë™    (  t  )    Ã—  ğ    (   ğ±   (  t  )    ,  t  )             d    d  t        m   normal-Ë™  ğ±   t       1       superscript  v  2   t    superscript  c  2            q  ğ„     ğ±  t   t          q   normal-Ë™  ğ±   t   ğ      ğ±  t   t       \frac{d}{dt}\left(\frac{m\dot{\mathbf{x}}(t)}{\sqrt{1-\frac{v^{2}(t)}{c^{2}}}}%
 \right)=q\mathbf{E}(\mathbf{x}(t),t)+q\dot{\mathbf{x}}(t)\times\mathbf{B}(%
 \mathbf{x}(t),t)     which is the equation for the Lorentz force , where:       ğ„   (  ğ±  ,  t  )    =    -    âˆ‡  Ï•    (  ğ±  ,  t  )     -     âˆ‚  ğ€    (  ğ±  ,  t  )     âˆ‚  t           ğ„   ğ±  t           normal-âˆ‡  Ï•    ğ±  t           ğ€    ğ±  t      t       \mathbf{E}(\mathbf{x},t)=-\nabla\phi(\mathbf{x},t)-\frac{\partial\mathbf{A}(%
 \mathbf{x},t)}{\partial t}          ğ   (  ğ±  ,  t  )    =    âˆ‡  Ã—  ğ€    (  ğ±  ,  t  )          ğ   ğ±  t        normal-âˆ‡  ğ€    ğ±  t      \mathbf{B}(\mathbf{x},t)=\nabla\times\mathbf{A}(\mathbf{x},t)     are the fields and potentials.  An alternative Lagrangian for a special relativistic test particle is       L   (  Ï„  )    =     1  2   m   u  Î¼    (  Ï„  )    u  Î¼    (  Ï„  )    +   q   u  Î¼    (  Ï„  )    A  Î¼    (  x  )           L  Ï„         1  2   m   superscript  u  Î¼   Ï„   subscript  u  Î¼   Ï„     q   superscript  u  Î¼   Ï„   subscript  A  Î¼   x      L(\tau)=\frac{1}{2}mu^{\mu}(\tau)u_{\mu}(\tau)+qu^{\mu}(\tau)A_{\mu}(x)     where u Î¼ = dx Î¼ / dÏ„ is the four-velocity of the test particle.  The Euler-Lagrange equations         âˆ‚  L    âˆ‚   x  Î½     -    d   d  Ï„      âˆ‚  L    âˆ‚   u  Î½       =  0            L      superscript  x  Î½         d    d  Ï„        L      superscript  u  Î½       0    \frac{\partial L}{\partial x^{\nu}}-\frac{d}{d\tau}\frac{\partial L}{\partial u%
 ^{\nu}}=0     become       q   u  Î¼     âˆ‚   A  Î¼     âˆ‚   x  Î½      =    d   d  Ï„     (    m   u  Î½    +   q   A  Î½     )          q   superscript  u  Î¼        subscript  A  Î¼       superscript  x  Î½          d    d  Ï„        m   subscript  u  Î½      q   subscript  A  Î½        qu^{\mu}\frac{\partial A_{\mu}}{\partial x^{\nu}}=\frac{d}{d\tau}(mu_{\nu}+qA_%
 {\nu})     General relativistic test particle  In general relativity , the first term generalizes (includes) both the classical kinetic energy and the interaction with the gravitational field. It becomes: 33 34        -   m   c  2     d  Ï„   (  t  )     d  t      =   -   m   c  2     -    c   -  2     g   Î¼  Î½     (   x   (  t  )    )     d   x  Î¼    (  t  )     d  t      d   x  Î½    (  t  )     d  t          .          m   superscript  c  2       d  Ï„  t     d  t          m   superscript  c  2          superscript  c    2     subscript  g    Î¼  Î½      x  t       d   superscript  x  Î¼   t     d  t        d   superscript  x  Î½   t     d  t           -mc^{2}\frac{d\tau(t)}{dt}=-mc^{2}\sqrt{-c^{-2}g_{\mu\nu}(x(t))\frac{dx^{\mu}(%
 t)}{dt}\frac{dx^{\nu}(t)}{dt}}.     The Lagrangian of a general relativistic test particle in an electromagnetic field is:        L   (  t  )    =    -   m   c  2     -    c   -  2     g   Î¼  Î½     (   x   (  t  )    )     d   x  Î¼    (  t  )     d  t      d   x  Î½    (  t  )     d  t         +   q    d   x  Î¼    (  t  )     d  t     A  Î¼    (   x   (  t  )    )      .        L  t         m   superscript  c  2          superscript  c    2     subscript  g    Î¼  Î½      x  t       d   superscript  x  Î¼   t     d  t        d   superscript  x  Î½   t     d  t           q      d   superscript  x  Î¼   t     d  t     subscript  A  Î¼     x  t       L(t)=-mc^{2}\sqrt{-c^{-2}g_{\mu\nu}(x(t))\frac{dx^{\mu}(t)}{dt}\frac{dx^{\nu}(%
 t)}{dt}}+q\frac{dx^{\mu}(t)}{dt}A_{\mu}(x(t)).     If the four spacetime coordinates x Âµ are given in arbitrary units (i.e. unitless), then g ÂµÎ½ in m 2 is the rank 2 symmetric metric tensor which is also the gravitational potential. Also, A Âµ in VÂ·s is the electromagnetic 4-vector potential.  More generally, suppose the Lagrangian is that of a single particle plus an interaction term L I       L  =    -   m   c  2     d  Ï„    d  t      +    L  I      .      L        m   superscript  c  2       d  Ï„     d  t       subscript  L  I      L=-mc^{2}\frac{d\tau}{dt}+L_{I}\,.     Varying this with respect to the position of the particle x Î± as a function of time t gives        Î´  L   =    m    d  t    2  d  Ï„    Î´   (    g   Î¼  Î½      d   x  Î¼     d  t      d   x  Î½     d  t     )    +   Î´    L  I       .        Î´  L       m      d  t     2  d  Ï„    Î´     subscript  g    Î¼  Î½        d   superscript  x  Î¼      d  t        d   superscript  x  Î½      d  t        Î´   subscript  L  I       \delta L=m\frac{dt}{2d\tau}\delta\left(g_{\mu\nu}\frac{dx^{\mu}}{dt}\frac{dx^{%
 \nu}}{dt}\right)+\delta L_{I}\,.           Î´  L   =    m    d  t    2  d  Ï„     (     g    Î¼  Î½   ,  Î±    Î´   x  Î±     d   x  Î¼     d  t      d   x  Î½     d  t     +   2   g   Î±  Î½      d  Î´   x  Î±     d  t      d   x  Î½     d  t      )    +     âˆ‚   L  I     âˆ‚   x  Î±     Î´   x  Î±    +     âˆ‚   L  I     âˆ‚    d   x  Î±     d  t         d  Î´   x  Î±     d  t        .        Î´  L       m      d  t     2  d  Ï„         subscript  g     Î¼  Î½   Î±    Î´   superscript  x  Î±       d   superscript  x  Î¼      d  t        d   superscript  x  Î½      d  t       2   subscript  g    Î±  Î½        d  Î´   superscript  x  Î±      d  t        d   superscript  x  Î½      d  t              subscript  L  I       superscript  x  Î±     Î´   superscript  x  Î±           subscript  L  I          d   superscript  x  Î±      d  t          d  Î´   superscript  x  Î±      d  t        \delta L=m\frac{dt}{2d\tau}\left(g_{\mu\nu,\alpha}\delta x^{\alpha}\frac{dx^{%
 \mu}}{dt}\frac{dx^{\nu}}{dt}+2g_{\alpha\nu}\frac{d\delta x^{\alpha}}{dt}\frac{%
 dx^{\nu}}{dt}\right)+\frac{\partial L_{I}}{\partial x^{\alpha}}\delta x^{%
 \alpha}+\frac{\partial L_{I}}{\partial\frac{dx^{\alpha}}{dt}}\frac{d\delta x^{%
 \alpha}}{dt}\,.           Î´  L   =        1  2   m   g    Î¼  Î½   ,  Î±    Î´   x  Î±     d   x  Î¼     d  Ï„      d   x  Î½     d  t     -    d   d  t     (   m   g   Î±  Î½      d   x  Î½     d  Ï„     )   Î´   x  Î±     +     âˆ‚   L  I     âˆ‚   x  Î±     Î´   x  Î±     -    d   d  t     (    âˆ‚   L  I     âˆ‚    d   x  Î±     d  t      )   Î´   x  Î±     +     d   (  â€¦  )     d  t       .        Î´  L               1  2   m   subscript  g     Î¼  Î½   Î±    Î´   superscript  x  Î±       d   superscript  x  Î¼      d  Ï„        d   superscript  x  Î½      d  t         d    d  t      m   subscript  g    Î±  Î½        d   superscript  x  Î½      d  Ï„     Î´   superscript  x  Î±            subscript  L  I       superscript  x  Î±     Î´   superscript  x  Î±         d    d  t         subscript  L  I          d   superscript  x  Î±      d  t      Î´   superscript  x  Î±         d  normal-â€¦     d  t       \delta L=\frac{1}{2}mg_{\mu\nu,\alpha}\delta x^{\alpha}\frac{dx^{\mu}}{d\tau}%
 \frac{dx^{\nu}}{dt}-\frac{d}{dt}\left(mg_{\alpha\nu}\frac{dx^{\nu}}{d\tau}%
 \right)\delta x^{\alpha}+\frac{\partial L_{I}}{\partial x^{\alpha}}\delta x^{%
 \alpha}-\frac{d}{dt}\left(\frac{\partial L_{I}}{\partial\frac{dx^{\alpha}}{dt}%
 }\right)\delta x^{\alpha}+\frac{d(...)}{dt}\,.     This gives the equation of motion      0  =      1  2   m   g    Î¼  Î½   ,  Î±      d   x  Î¼     d  Ï„      d   x  Î½     d  t     -    d   d  t     (   m   g   Î±  Î½      d   x  Î½     d  Ï„     )     +   f  Î±        0          1  2   m   subscript  g     Î¼  Î½   Î±        d   superscript  x  Î¼      d  Ï„        d   superscript  x  Î½      d  t         d    d  t      m   subscript  g    Î±  Î½        d   superscript  x  Î½      d  Ï„        subscript  f  Î±      0=\frac{1}{2}mg_{\mu\nu,\alpha}\frac{dx^{\mu}}{d\tau}\frac{dx^{\nu}}{dt}-\frac%
 {d}{dt}\left(mg_{\alpha\nu}\frac{dx^{\nu}}{d\tau}\right)+f_{\alpha}   where       f  Î±   =     âˆ‚   L  I     âˆ‚   x  Î±     -    d   d  t     (    âˆ‚   L  I     âˆ‚    d   x  Î±     d  t      )          subscript  f  Î±          subscript  L  I       superscript  x  Î±         d    d  t         subscript  L  I          d   superscript  x  Î±      d  t          f_{\alpha}=\frac{\partial L_{I}}{\partial x^{\alpha}}-\frac{d}{dt}\left(\frac{%
 \partial L_{I}}{\partial\frac{dx^{\alpha}}{dt}}\right)   is the non-gravitational force on the particle. (For m to be independent of time, we must have      f  Î±     d   x  Î±     d  t     =  0         subscript  f  Î±       d   superscript  x  Î±      d  t     0    f_{\alpha}\tfrac{dx^{\alpha}}{dt}=0   .)  Rearranging gets the force equation        d   d  t     (   m    d   x  Î½     d  Ï„     )    =    -   m   Î“   Î¼  Ïƒ   Î½     d   x  Î¼     d  Ï„      d   x  Ïƒ     d  t      +    g   Î½  Î±     f  Î±             d    d  t      m      d   superscript  x  Î½      d  Ï„            m   subscript   superscript  normal-Î“  Î½     Î¼  Ïƒ        d   superscript  x  Î¼      d  Ï„        d   superscript  x  Ïƒ      d  t         superscript  g    Î½  Î±     subscript  f  Î±       \frac{d}{dt}\left(m\frac{dx^{\nu}}{d\tau}\right)=-m\Gamma^{\nu}_{\mu\sigma}%
 \frac{dx^{\mu}}{d\tau}\frac{dx^{\sigma}}{dt}+g^{\nu\alpha}f_{\alpha}   where Î“ is the Christoffel symbol which is the gravitational force field.  If we let       p  Î½   =   m    d   x  Î½     d  Ï„          superscript  p  Î½     m      d   superscript  x  Î½      d  Ï„       p^{\nu}=m\frac{dx^{\nu}}{d\tau}   be the (kinetic) linear momentum for a particle with mass, then        d   p  Î½     d  t    =    -    Î“   Î¼  Ïƒ   Î½    p  Î¼     d   x  Ïƒ     d  t      +    g   Î½  Î±     f  Î±             d   superscript  p  Î½      d  t           subscript   superscript  normal-Î“  Î½     Î¼  Ïƒ     superscript  p  Î¼       d   superscript  x  Ïƒ      d  t         superscript  g    Î½  Î±     subscript  f  Î±       \frac{dp^{\nu}}{dt}=-\Gamma^{\nu}_{\mu\sigma}p^{\mu}\frac{dx^{\sigma}}{dt}+g^{%
 \nu\alpha}f_{\alpha}   and        d   x  Î½     d  t    =    p  Î½    p  0            d   superscript  x  Î½      d  t       superscript  p  Î½    superscript  p  0      \frac{dx^{\nu}}{dt}=\frac{p^{\nu}}{p^{0}}   hold even for a massless particle.  Lagrangian mechanics in other contexts  The Hamiltonian , denoted by H , is obtained by performing a Legendre transformation on the Lagrangian, which introduces new variables, canonically conjugate to the original variables. This doubles the number of variables, but makes differential equations first order. The Hamiltonian is the basis for an alternative formulation of classical mechanics known as Hamiltonian mechanics . It is a particularly ubiquitous quantity in quantum mechanics (see Hamiltonian (quantum mechanics) ).  In 1948, Feynman discovered the path integral formulation extending the principle of least action to quantum mechanics for electrons and photons . In this formulation, particles travel every possible path between the initial and final states; the probability of a specific final state is obtained by summing over all possible trajectories leading to it. In the classical regime, the path integral formulation cleanly reproduces Hamilton's principle, and Fermat's principle in optics .  Dissipation (i.e. non-conservative systems) can also be treated with an effective Lagrangian formulated by a certain doubling of the degrees of freedom; see. 35 36 37 38  Uses in Engineering  Circa 1963 Lagrangians were a general part of the engineering curriculum, but a quarter of a century later, even with the ascendency of dynamical systems , they were dropped as requirements for some engineering programs, and are generally considered to be the domain of theoretical dynamics. Circa 2003 this changed dramatically, and Lagrangians are not only a required part of many ME and EE graduate-level curricula, but also find applications in finance, economics, and biology, mainly as the basis of the formulation of various path integral schemes to facilitate the solution of parabolic partial differential equations via random walks.  Circa 2013, Lagrangians find their way into hundreds of direct engineering solutions, including robotics , turbulent flow analysis ( Lagrangian and Eulerian specification of the flow field ), signal processing , microscopic component contact and nanotechnology (superlinear convergent augmented Lagrangians), gyroscopic forcing and dissipation, semi-infinite supercomputing (which also involve Lagrange multipliers in the subfield of semi-infinite programming ), chemical engineering (specific heat linear Lagrangian interpolation in reaction planning), civil engineering (dynamic analysis of traffic flows), optics engineering and design (Lagrangian and Hamiltonian optics ) aerospace (Lagrangian interpolation), force stepping integrators, and even airbag deployment (coupled Eulerian-Lagrangians as well as SELMâ€”the stochastic Eulerian Lagrangian method ). 39  See also   Canonical coordinates  Functional derivative  Generalized coordinates  Hamiltonian mechanics  Hamiltonian optics  Lagrangian analysis (applications of Lagrangian mechanics)  Lagrangian point  Lagrangian systemâ€  Non-autonomous mechanics  Restricted three-body problem  Plateau's problem   References  Further reading   Landau, L.D. and Lifshitz, E.M.  Mechanics , Pergamon Press.  Gupta, Kiran Chandra, Classical mechanics of particles and rigid bodies (Wiley, 1988).  Goldstein, Herbert, Classical Mechanics , Addison Wesley .  Cassel, Kevin W.: Variational Methods with Applications in Science and Engineering, Cambridge University Press, 2013.   External links   Tong, David, Classical Dynamics Cambridge lecture notes  Principle of least action interactive Excellent interactive explanation/webpage  Joseph Louis de Lagrange - Å’uvres complÃ¨tes (Gallica-Math)   "  *  Category:Concepts in physics  Category:Lagrangian mechanics  Category:Dynamical systems  Category:Mathematical and quantitative methods (economics)     â†©  http://williamhoover.info/Scans1990s/1995-10.pdf â†©  â†©  â†©  â†©  â†©   â†©    â†©     Analytical Mechanics, L.N. Hand, J.D. Finch, Cambridge University Press, 2008, ISBN 978-0-521-57572-0 â†©   Torby1984, p.270 â†©   â†©  â†©   The Road to Reality, Roger Penrose, Vintage books, 2007, ISBN 0-679-77631-1 â†©    "The Principle of Least Action" Richard Feynman â†©  Classical Mechanics, T.W.B. Kibble, European Physics Series, McGraw-Hill (UK), 1973, ISBN 0-07-084018-0 â†©  Analytical Mechanics, L.N. Hand, J.D. Finch, Cambridge University Press, 2008, ISBN 978-0-521-57572-0 â†©  â†©  The Lagrangian also can be written explicitly for a rotating frame. See â†©  â†©  â†©  â†©  Lev Davidovich Landau & Evgeny Mikhailovich Lifshitz , The Classical Theory of Fields , (1975), Elsevier Ltd., ISBN 978-0-7506-2768-9, page 26 â†©  Noel A. Doughty, Lagrangian Interaction , (1990), Addison-Wesley Publishers Ltd., ISBN 0-201-41625-5, pages 310 â†©  â†©  â†©  â†©  â†©  â†©     
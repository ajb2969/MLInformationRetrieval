<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="440">Dirichlet-multinomial distribution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Dirichlet-multinomial distribution</h1>
<hr/>

<p>In <a href="probability_and_statistics" title="wikilink">probability and statistics</a>, the <strong>Dirichlet-multinomial distribution</strong> is a <a href="probability_distribution" title="wikilink">probability distribution</a> for a multivariate <a href="discrete_random_variable" title="wikilink">discrete random variable</a>. It is also called the <strong>Dirichlet compound multinomial distribution (DCM)</strong> or <strong>multivariate P√≥lya distribution</strong> (after <a href="George_P√≥lya" title="wikilink">George P√≥lya</a>). It is a <a href="compound_probability_distribution" title="wikilink">compound probability distribution</a>, where a probability vector <strong>p</strong> is drawn from a <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a> with parameter vector 

<math display="inline" id="Dirichlet-multinomial_distribution:0">
 <semantics>
  <mi>ùú∂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùú∂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\alpha}
  </annotation>
 </semantics>
</math>

, and a set of discrete samples is drawn from the <a href="categorical_distribution" title="wikilink">categorical distribution</a> with probability vector <strong>p</strong>. The compounding corresponds to a <a href="Polya_urn_scheme" title="wikilink">Polya urn scheme</a>. In <a href="document_classification" title="wikilink">document classification</a>, for example, the distribution is used to represent the distributions of word counts for different document types.</p>
<h2 id="probability-mass-function">Probability mass function</h2>

<p>Conceptually, we are doing <em>N</em> independent draws from a categorical distribution with <em>K</em> categories. Let us represent the independent draws as random categorical variables 

<math display="inline" id="Dirichlet-multinomial_distribution:1">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{n}
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Dirichlet-multinomial_distribution:2">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-‚Ä¶</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=1\dots N
  </annotation>
 </semantics>
</math>

. Let us denote the number of times a particular category 

<math display="inline" id="Dirichlet-multinomial_distribution:3">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>


 has been seen (for 

<math display="inline" id="Dirichlet-multinomial_distribution:4">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mi>K</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>normal-‚Ä¶</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1\dots K
  </annotation>
 </semantics>
</math>

) among all the categorical variables as 

<math display="inline" id="Dirichlet-multinomial_distribution:5">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{k}
  </annotation>
 </semantics>
</math>

. Note that 

<math display="inline" id="Dirichlet-multinomial_distribution:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">‚àë</mo>
     <mi>k</mi>
    </msub>
    <msub>
     <mi>n</mi>
     <mi>k</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{k}n_{k}=N
  </annotation>
 </semantics>
</math>

. Then, we have two separate views onto this problem:</p>
<ol>
<li>A set of 

<math display="inline" id="Dirichlet-multinomial_distribution:7">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 categorical variables 

<math display="inline" id="Dirichlet-multinomial_distribution:8">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mi>N</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1},\dots,z_{N}
  </annotation>
 </semantics>
</math>


.</li>
<li>A single vector-valued variable 

<math display="inline" id="Dirichlet-multinomial_distribution:9">
 <semantics>
  <mrow>
   <mi>ùê±</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>n</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>n</mi>
     <mi>K</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê±</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>K</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}=(n_{1},\dots,n_{K})
  </annotation>
 </semantics>
</math>

, distributed according to a <a href="multinomial_distribution" title="wikilink">multinomial distribution</a>.</li>
</ol>

<p>The former case is a set of random variables specifying each <em>individual</em> outcome, while the latter is a variable specifying the <em>number</em> of outcomes of each of the <em>K</em> categories. The distinction is important, as the two cases have correspondingly different probability distributions.</p>

<p>The parameter of the categorical distribution is 

<math display="inline" id="Dirichlet-multinomial_distribution:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùê©</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>p</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">‚Ä¶</mi>
     <mo>,</mo>
     <msub>
      <mi>p</mi>
      <mi>K</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê©</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>K</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}=(p_{1},p_{2},\dots,p_{K}),
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Dirichlet-multinomial_distribution:11">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}
  </annotation>
 </semantics>
</math>

 is the probability to draw value 

<math display="inline" id="Dirichlet-multinomial_distribution:12">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

; 

<math display="inline" id="Dirichlet-multinomial_distribution:13">
 <semantics>
  <mi>ùê©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>


 is likewise the parameter of the multinomial distribution 

<math display="inline" id="Dirichlet-multinomial_distribution:14">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùê±</mi>
    <mo stretchy="false">|</mo>
    <mi>ùê©</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">p</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mathbf{x}|\mathbf{p})
  </annotation>
 </semantics>
</math>

. Rather than specifying 

<math display="inline" id="Dirichlet-multinomial_distribution:15">
 <semantics>
  <mi>ùê©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

 directly, we give it a <a href="conjugate_prior_distribution" title="wikilink">conjugate prior distribution</a>, and hence it is drawn from a Dirichlet distribution with parameter vector 

<math display="inline" id="Dirichlet-multinomial_distribution:16">
 <semantics>
  <mrow>
   <mi>ùú∂</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>Œ±</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>Œ±</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>Œ±</mi>
     <mi>K</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùú∂</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <ci>K</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\alpha}=(\alpha_{1},\alpha_{2},\ldots,\alpha_{K})
  </annotation>
 </semantics>
</math>

.</p>

<p>By integrating out 

<math display="inline" id="Dirichlet-multinomial_distribution:17">
 <semantics>
  <mi>ùê©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

, we obtain a compound distribution. However, the form of the distribution is different depending on which view we take.</p>
<h3 id="for-a-set-of-individual-outcomes">For a set of individual outcomes</h3>
<h4 id="joint-distribution">Joint distribution</h4>

<p>For categorical variables 

<math display="inline" id="Dirichlet-multinomial_distribution:18">
 <semantics>
  <mrow>
   <mi>‚Ñ§</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>z</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mi>N</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>‚Ñ§</ci>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>N</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}=z_{1},\dots,z_{N}
  </annotation>
 </semantics>
</math>


, the <a href="marginal_distribution" title="wikilink">marginal</a> <a href="joint_distribution" title="wikilink">joint distribution</a> is obtained by integrating out 

<math display="inline" id="Dirichlet-multinomial_distribution:19">
 <semantics>
  <mi>ùê©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùê©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{p}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>‚Ñ§</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">‚à´</mo>
     <mi>ùê©</mi>
    </msub>
    <mrow>
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>‚Ñ§</mi>
       <mo>‚à£</mo>
       <mi>ùê©</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùê©</mi>
       <mo>‚à£</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mtext>d</mtext>
     <mi>ùê©</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>‚Ñ§</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>ùê©</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>Pr</ci>
       <ci>‚Ñ§</ci>
       <ci>ùê©</ci>
      </apply>
      <apply>
       <ci>Pr</ci>
       <ci>ùê©</ci>
       <ci>ùú∂</ci>
      </apply>
      <mtext>d</mtext>
      <ci>ùê©</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbb{Z}\mid\boldsymbol{\alpha})=\int_{\mathbf{p}}\Pr(\mathbb{Z}\mid%
\mathbf{p})\Pr(\mathbf{p}\mid\boldsymbol{\alpha})\textrm{d}\mathbf{p}
  </annotation>
 </semantics>
</math>

</p>

<p>which results in the following explicit formula:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>‚Ñ§</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi mathvariant="normal">Œì</mi>
      <mrow>
       <mo>(</mo>
       <mi>A</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Œì</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>N</mi>
        <mo>+</mo>
        <mi>A</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <mfrac>
      <mrow>
       <mi mathvariant="normal">Œì</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>n</mi>
          <mi>k</mi>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>Œ±</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi mathvariant="normal">Œì</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>Œ±</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>‚Ñ§</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>normal-Œì</ci>
       <ci>A</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Œì</ci>
       <apply>
        <plus></plus>
        <ci>N</ci>
        <ci>A</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>normal-Œì</ci>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Œ±</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Œì</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Œ±</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbb{Z}\mid\boldsymbol{\alpha})=\frac{\Gamma\left(A\right)}{\Gamma\left%
(N+A\right)}\prod_{k=1}^{K}\frac{\Gamma(n_{k}+\alpha_{k})}{\Gamma(\alpha_{k})}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Dirichlet-multinomial_distribution:22">
 <semantics>
  <mi mathvariant="normal">Œì</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œì</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma
  </annotation>
 </semantics>
</math>

 is the <a href="gamma_function" title="wikilink">gamma function</a>, with</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:23">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mi>k</mi>
    </munder>
    <mrow>
     <msub>
      <mi>Œ±</mi>
      <mi>k</mi>
     </msub>
     <mtext>and</mtext>
     <mi>N</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mi>k</mi>
    </munder>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>k</mi>
     </msub>
     <mtext>, and where</mtext>
     <msub>
      <mi>n</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mtext>number of</mtext>
    <msub>
     <mi>z</mi>
     <mi>n</mi>
    </msub>
    <mtext>‚Äôs with the value</mtext>
    <mi>k</mi>
    <mtext>.</mtext>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>A</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
       <mtext>and</mtext>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <mtext>, and where</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <mtext>number of</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
      <mtext>‚Äôs with the value</mtext>
      <ci>k</ci>
      <mtext>.</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\sum_{k}\alpha_{k}\text{ and }N=\sum_{k}n_{k}\text{, and where }n_{k}=\text{%
number of }z_{n}\text{'s with the value }k\text{.}
  </annotation>
 </semantics>
</math>

</p>

<p>Note that, although the variables 

<math display="inline" id="Dirichlet-multinomial_distribution:24">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mi>N</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1},\dots,z_{N}
  </annotation>
 </semantics>
</math>

 do not appear explicitly in the above formula, they enter in through the 

<math display="inline" id="Dirichlet-multinomial_distribution:25">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{k}
  </annotation>
 </semantics>
</math>

 values.</p>
<h4 id="conditional-distribution">Conditional distribution</h4>

<p>Another useful formula, particularly in the context of <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a>, asks what the conditional density of a given variable 

<math display="inline" id="Dirichlet-multinomial_distribution:26">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{n}
  </annotation>
 </semantics>
</math>

 is, conditioned on all the other variables (which we will denote 

<math display="inline" id="Dirichlet-multinomial_distribution:27">
 <semantics>
  <msup>
   <mi>‚Ñ§</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>‚Ñ§</ci>
    <apply>
     <minus></minus>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}^{(-n)}
  </annotation>
 </semantics>
</math>

). It turns out to have an extremely simple form:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:28">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>z</mi>
       <mi>n</mi>
      </msub>
      <mo>=</mo>
      <mi>k</mi>
     </mrow>
     <mo>‚à£</mo>
     <msup>
      <mi>‚Ñ§</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>,</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>‚àù</mo>
   <mrow>
    <msubsup>
     <mi>n</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <msub>
     <mi>Œ±</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <ci>Pr</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>‚Ñ§</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(z_{n}=k\mid\mathbb{Z}^{(-n)},\boldsymbol{\alpha})\propto n_{k}^{(-n)}+%
\alpha_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Dirichlet-multinomial_distribution:29">
 <semantics>
  <msubsup>
   <mi>n</mi>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{k}^{(-n)}
  </annotation>
 </semantics>
</math>

 specifies the number of counts of category 

<math display="inline" id="Dirichlet-multinomial_distribution:30">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 seen in all variables other than 

<math display="inline" id="Dirichlet-multinomial_distribution:31">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>It may be useful to show how to derive this formula. In general, <a href="conditional_distribution" title="wikilink">conditional distributions</a> are proportional to the corresponding <a href="joint_distribution" title="wikilink">joint distributions</a>, so we simply start with the above formula for the joint distribution of all the 

<math display="inline" id="Dirichlet-multinomial_distribution:32">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mi>N</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1},\dots,z_{N}
  </annotation>
 </semantics>
</math>

 values and then eliminate any factors not dependent on the particular 

<math display="inline" id="Dirichlet-multinomial_distribution:33">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{n}
  </annotation>
 </semantics>
</math>

 in question. To do this, we make use of the notation 

<math display="inline" id="Dirichlet-multinomial_distribution:34">
 <semantics>
  <msubsup>
   <mi>n</mi>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{k}^{(-n)}
  </annotation>
 </semantics>
</math>

 defined above, and note that</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:35">
 <semantics>
  <mrow>
   <msub>
    <mi>n</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msubsup>
         <mi>n</mi>
         <mi>j</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mi>n</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>j</mi>
        </mrow>
        <mo>‚â†</mo>
        <mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <msubsup>
          <mi>n</mi>
          <mi>j</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mi>n</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </msubsup>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>j</mi>
        </mrow>
        <mo>=</mo>
        <mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <neq></neq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>j</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>j</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>j</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{j}=\begin{cases}n_{j}^{(-n)},&\text{if }j\not=k\\
n_{j}^{(-n)}+1,&\text{if }j=k\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>We also use the fact that</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:36">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œì</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mi mathvariant="normal">Œì</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Œì</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>normal-Œì</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(n+1)=n\Gamma(n)
  </annotation>
 </semantics>
</math>

</p>

<p>Then:</p>

<p>

<math display="inline" id="Dirichlet-multinomial_distribution:37">
 <semantics>
  <mrow>
   <mi>Pr</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>z</mi>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mi>k</mi>
    </mrow>
    <mo>‚à£</mo>
    <msup>
     <mi>‚Ñ§</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>,</mo>
    <mi>ùú∂</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>Pr</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <ci>n</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>‚Ñ§</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>ùú∂</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Pr(z_{n}=k\mid\mathbb{Z}^{(-n)},\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>


</p>

<p>In general, it is not necessary to worry about the <a href="normalizing_constant" title="wikilink">normalizing constant</a> at the time of deriving the equations for conditional distributions. The normalizing constant will be determined as part of the algorithm for sampling from the distribution (see <a href="Categorical_distribution#Sampling" title="wikilink">Categorical distribution#Sampling</a>). However, when the conditional distribution is written in the simple form above, it turns out that the normalizing constant assumes a simple form:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:38">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mi>k</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msubsup>
       <mi>n</mi>
       <mi>k</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mo>+</mo>
      <msub>
       <mi>Œ±</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mi>k</mi>
     </munder>
     <msubsup>
      <mi>n</mi>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mo>+</mo>
     <mi>N</mi>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <ci>A</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <ci>A</ci>
       <ci>N</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{k}\left(n_{k}^{(-n)}+\alpha_{k}\right)=A+\sum_{k}n_{k}^{(-n)}=A+N-1
  </annotation>
 </semantics>
</math>

</p>

<p>Hence</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:39">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>z</mi>
       <mi>n</mi>
      </msub>
      <mo>=</mo>
      <mi>k</mi>
     </mrow>
     <mo>‚à£</mo>
     <msup>
      <mi>‚Ñ§</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>,</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msubsup>
      <mi>n</mi>
      <mi>k</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>+</mo>
     <msub>
      <mi>Œ±</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mrow>
     <mrow>
      <mi>A</mi>
      <mo>+</mo>
      <mi>N</mi>
     </mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>‚Ñ§</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ±</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <ci>A</ci>
       <ci>N</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(z_{n}=k\mid\mathbb{Z}^{(-n)},\boldsymbol{\alpha})=\frac{n_{k}^{(-n)}+%
\alpha_{k}}{A+N-1}
  </annotation>
 </semantics>
</math>

</p>

<p>This formula is closely related to the <a href="Chinese_restaurant_process" title="wikilink">Chinese restaurant process</a>, which results from taking the limit as 

<math display="inline" id="Dirichlet-multinomial_distribution:40">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>‚Üí</mo>
   <mi mathvariant="normal">‚àû</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <ci>K</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K\to\infty
  </annotation>
 </semantics>
</math>


.</p>
<h4 id="in-a-bayesian-network">In a Bayesian network</h4>

<p>In a larger <a href="Bayesian_network" title="wikilink">Bayesian network</a> in which categorical (or so-called "multinomial") distributions occur with <a href="Dirichlet_distribution" title="wikilink">Dirichlet distribution</a> priors as part of a larger network, all Dirichlet priors can be collapsed provided that the only nodes depending on them are categorical distributions. The collapsing happens for each Dirichlet-distribution node separately from the others, and occurs regardless of any other nodes that may depend on the categorical distributions. It also occurs regardless of whether the categorical distributions depend on nodes additional to the Dirichlet priors (although in such a case, those other nodes must remain as additional conditioning factors). Essentially, all of the categorical distributions depending on a given Dirichlet-distribution node become connected into a single Dirichlet-multinomial joint distribution defined by the above formula. The joint distribution as defined this way will depend on the parent(s) of the integrated-out Dirichet prior nodes, as well as any parent(s) of the categorical nodes other than the Dirichlet prior nodes themselves.</p>

<p>In the following sections, we discuss different configurations commonly found in Bayesian networks. We repeat the probability density from above, and define it using the symbol 

<math display="inline" id="Dirichlet-multinomial_distribution:41">
 <semantics>
  <mrow>
   <mo>DirMult</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>‚Ñ§</mi>
    <mo>‚à£</mo>
    <mi>ùú∂</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>DirMult</ci>
    <ci>‚Ñ§</ci>
    <ci>ùú∂</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{DirMult}(\mathbb{Z}\mid\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:42">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>‚Ñ§</mi>
    <mo>‚à£</mo>
    <mi>ùú∂</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>DirMult</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>‚Ñ§</mi>
    <mo>‚à£</mo>
    <mi>ùú∂</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Œì</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mo largeop="true" symmetric="true">‚àë</mo>
        <mi>k</mi>
       </msub>
       <msub>
        <mi>Œ±</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Œì</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">‚àë</mo>
         <mi>k</mi>
        </msub>
        <msub>
         <mi>n</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <msub>
        <mi>Œ±</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
    <mrow>
     <mi>k</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>K</mi>
   </munderover>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Œì</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>k</mi>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>Œ±</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Œì</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>Œ±</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <csymbol cd="unknown">r</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-‚à£</ci>
     <csymbol cd="unknown">Œ±</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>DirMult</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-‚à£</ci>
     <csymbol cd="unknown">Œ±</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Œì</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Œì</ci>
      <apply>
       <plus></plus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>K</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Œì</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Œì</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ±</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Pr(\mathbb{Z}\mid\boldsymbol{\alpha})=\operatorname{DirMult}(\mathbb{Z}\mid%
\boldsymbol{\alpha})=\frac{\Gamma\left(\sum_{k}\alpha_{k}\right)}{\Gamma\left(%
\sum_{k}n_{k}+\alpha_{k}\right)}\prod_{k=1}^{K}\frac{\Gamma(n_{k}+\alpha_{k})}%
{\Gamma(\alpha_{k})}
  </annotation>
 </semantics>
</math>

</p>
<h5 id="multiple-dirichlet-priors-with-the-same-hyperprior">Multiple Dirichlet priors with the same hyperprior</h5>

<p>Imagine we have a hierarchical model as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:43">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∂</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>some distribution</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>ùúΩ</mi>
      <mrow>
       <mi>d</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>M</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>z</mi>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <mi>M</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <msub>
          <mi>N</mi>
          <mi>d</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ùúΩ</mi>
        <mi>d</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>ùú∂</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>some distribution</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùúΩ</ci>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>M</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>K</ci>
      </apply>
      <ci>ùú∂</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùúΩ</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\boldsymbol{\alpha}&\sim&\text{some distribution}\\
\boldsymbol{\theta}_{d=1\dots M}&\sim&\operatorname{Dirichlet}_{K}(\boldsymbol%
{\alpha})\\
z_{d=1\dots M,n=1\dots N_{d}}&\sim&\operatorname{Categorical}_{K}(\boldsymbol{%
\theta}_{d})\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>In cases like this, we have multiple Dirichet priors, each of which generates some number of categorical observations (possibly a different number for each prior). The fact that they are all dependent on the same hyperprior, even if this is a random variable as above, makes no difference. The effect of integrating out a Dirichlet prior links the categorical variables attached to that prior, whose joint distribution simply inherits any conditioning factors of the Dirichlet prior. The fact that multiple priors may share a hyperprior makes no difference:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>‚Ñ§</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
     <mi>d</mi>
    </munder>
    <mrow>
     <mo>DirMult</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>‚Ñ§</mi>
       <mi>d</mi>
      </msub>
      <mo>‚à£</mo>
      <mi>ùú∂</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>‚Ñ§</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>d</ci>
     </apply>
     <apply>
      <ci>DirMult</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>‚Ñ§</ci>
       <ci>d</ci>
      </apply>
      <ci>ùú∂</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbb{Z}\mid\boldsymbol{\alpha})=\prod_{d}\operatorname{DirMult}(\mathbb%
{Z}_{d}\mid\boldsymbol{\alpha})
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Dirichlet-multinomial_distribution:45">
 <semantics>
  <msub>
   <mi>‚Ñ§</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>‚Ñ§</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{d}
  </annotation>
 </semantics>
</math>

 is simply the collection of categorical variables dependent on prior <em>d</em>.</p>

<p>Accordingly, the conditional probability distribution can be written as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:46">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
      <mo>=</mo>
      <mi>k</mi>
     </mrow>
     <mo>‚à£</mo>
     <msup>
      <mi>‚Ñ§</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>,</mo>
     <mi>ùú∂</mi>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">‚àù</mo>
   <mrow>
    <msubsup>
     <mi>n</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>d</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <msub>
     <mi>Œ±</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <ci>Pr</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>‚Ñ§</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <list>
        <ci>k</ci>
        <ci>d</ci>
       </list>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(z_{dn}=k\mid\mathbb{Z}^{(-dn)},\boldsymbol{\alpha})\ \propto\ n_{k,d}^{(-n%
)}+\alpha_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Dirichlet-multinomial_distribution:47">
 <semantics>
  <msubsup>
   <mi>n</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>d</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <list>
      <ci>k</ci>
      <ci>d</ci>
     </list>
    </apply>
    <apply>
     <minus></minus>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{k,d}^{(-n)}
  </annotation>
 </semantics>
</math>

 specifically means the number of variables <em>among the set</em> 

<math display="inline" id="Dirichlet-multinomial_distribution:48">
 <semantics>
  <msub>
   <mi>‚Ñ§</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>‚Ñ§</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{d}
  </annotation>
 </semantics>
</math>

, excluding 

<math display="inline" id="Dirichlet-multinomial_distribution:49">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>


 itself, that have the value 

<math display="inline" id="Dirichlet-multinomial_distribution:50">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 .</p>

<p>Note in particular that we need to count <strong>only</strong> the variables having the value <em>k</em> that are tied together to the variable in question through having the same prior. We do <strong>not</strong> want to count any other variables also having the value <em>k</em>.</p>
<h5 id="multiple-dirichlet-priors-with-the-same-hyperprior-with-dependent-children">Multiple Dirichlet priors with the same hyperprior, with dependent children</h5>

<p>Now imagine a slightly more complicated hierarchical model as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:51">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∂</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>some distribution</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>ùúΩ</mi>
      <mrow>
       <mi>d</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>M</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>z</mi>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <mi>M</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <msub>
          <mi>N</mi>
          <mi>d</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ùúΩ</mi>
        <mi>d</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mi mathvariant="bold-italic">œï</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>some other distribution</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>w</mi>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <mi>M</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <msub>
          <mi>N</mi>
          <mi>d</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mo>F</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>w</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo>‚à£</mo>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo>,</mo>
       <mi mathvariant="bold-italic">œï</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>ùú∂</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>some distribution</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùúΩ</ci>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>M</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>K</ci>
      </apply>
      <ci>ùú∂</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùúΩ</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <ci>bold-italic-œï</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>some other distribution</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <ci>normal-F</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>bold-italic-œï</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\boldsymbol{\alpha}&\sim&\text{some distribution}\\
\boldsymbol{\theta}_{d=1\dots M}&\sim&\operatorname{Dirichlet}_{K}(\boldsymbol%
{\alpha})\\
z_{d=1\dots M,n=1\dots N_{d}}&\sim&\operatorname{Categorical}_{K}(\boldsymbol{%
\theta}_{d})\\
\boldsymbol{\phi}&\sim&\text{some other distribution}\\
w_{d=1\dots M,n=1\dots N_{d}}&\sim&\operatorname{F}(w_{dn}\mid z_{dn},%
\boldsymbol{\phi})\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>This model is the same as above, but in addition, each of the categorical variables has a child variable dependent on it. This is typical of a <a href="mixture_model" title="wikilink">mixture model</a>.</p>

<p>Again, in the joint distribution, only the categorical variables dependent on the same prior are linked into a single Dirichlet-multinomial:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:52">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>‚Ñ§</mi>
     <mo>,</mo>
     <mi>ùïé</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo>,</mo>
     <mi mathvariant="bold-italic">œï</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
     <mi>d</mi>
    </munder>
    <mrow>
     <mrow>
      <mo>DirMult</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>‚Ñ§</mi>
        <mi>d</mi>
       </msub>
       <mo>‚à£</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>M</mi>
      </munderover>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
        <mrow>
         <mi>n</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <msub>
         <mi>N</mi>
         <mi>d</mi>
        </msub>
       </munderover>
       <mrow>
        <mo>F</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>w</mi>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </msub>
         <mo>‚à£</mo>
         <msub>
          <mi>z</mi>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </msub>
         <mo>,</mo>
         <mi mathvariant="bold-italic">œï</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>‚Ñ§</ci>
     <ci>ùïé</ci>
     <ci>ùú∂</ci>
     <ci>bold-italic-œï</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>d</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>DirMult</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>‚Ñ§</ci>
        <ci>d</ci>
       </apply>
       <ci>ùú∂</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>d</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>M</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <csymbol cd="latexml">product</csymbol>
          <apply>
           <eq></eq>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
        <apply>
         <ci>normal-F</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>z</ci>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <ci>bold-italic-œï</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbb{Z},\mathbb{W}\mid\boldsymbol{\alpha},\boldsymbol{\phi})=\prod_{d}%
\operatorname{DirMult}(\mathbb{Z}_{d}\mid\boldsymbol{\alpha})\prod_{d=1}^{M}%
\prod_{n=1}^{N_{d}}\operatorname{F}(w_{dn}\mid z_{dn},\boldsymbol{\phi})
  </annotation>
 </semantics>
</math>

</p>

<p>The conditional distribution of the categorical variables dependent only on their parents and ancestors would have the identical form as above in the simpler case. However, in Gibbs sampling it is necessary to determine the conditional distribution of a given node 

<math display="inline" id="Dirichlet-multinomial_distribution:53">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>

 dependent not only on 

<math display="inline" id="Dirichlet-multinomial_distribution:54">
 <semantics>
  <msup>
   <mi>‚Ñ§</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>d</mi>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>‚Ñ§</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}^{(-dn)}
  </annotation>
 </semantics>
</math>

 and ancestors such as 

<math display="inline" id="Dirichlet-multinomial_distribution:55">
 <semantics>
  <mi>Œ±</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ±</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 but on <em>all</em> the other parameters.</p>

<p>Note however that we derived the simplified expression for the conditional distribution above simply by rewriting the expression for the joint probability and removing constant factors. Hence, the same simplification would apply in a larger joint probability expression such as the one in this model, composed of Dirichlet-multinomial densities plus factors for many other random variables dependent on the values of the categorical variables.</p>

<p>This yields the following:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:56">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
      <mo>=</mo>
      <mi>k</mi>
     </mrow>
     <mo>‚à£</mo>
     <msup>
      <mi>‚Ñ§</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>,</mo>
     <mi>ùïé</mi>
     <mo>,</mo>
     <mi>ùú∂</mi>
     <mo>,</mo>
     <mi mathvariant="bold-italic">œï</mi>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">‚àù</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mi>n</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>d</mi>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mi>n</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mo>+</mo>
      <msub>
       <mi>Œ±</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>F</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
      <mo>‚à£</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
      <mo>,</mo>
      <mi mathvariant="bold-italic">œï</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <ci>Pr</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>‚Ñ§</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>ùïé</ci>
     <ci>ùú∂</ci>
     <ci>bold-italic-œï</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <list>
         <ci>k</ci>
         <ci>d</ci>
        </list>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ±</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-F</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>bold-italic-œï</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(z_{dn}=k\mid\mathbb{Z}^{(-dn)},\mathbb{W},\boldsymbol{\alpha},\boldsymbol{%
\phi})\ \propto\ (n_{k,d}^{(-n)}+\alpha_{k})\operatorname{F}(w_{dn}\mid z_{dn}%
,\boldsymbol{\phi})
  </annotation>
 </semantics>
</math>

</p>

<p>Here the probability density of 

<math display="inline" id="Dirichlet-multinomial_distribution:57">
 <semantics>
  <mo>F</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{F}
  </annotation>
 </semantics>
</math>

 appears directly. To do <a href="pseudo-random_number_sampling" title="wikilink">random sampling</a> over 

<math display="inline" id="Dirichlet-multinomial_distribution:58">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>

, we would compute the unnormalized probabilities for all <em>K</em> possibilities for 

<math display="inline" id="Dirichlet-multinomial_distribution:59">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>

 using the above formula, then normalize them and proceed as normal using the algorithm described in the <a href="categorical_distribution" title="wikilink">categorical distribution</a> article.</p>

<p><strong>NOTE</strong>: Correctly speaking, the additional factor that appears in the conditional distribution is derived not from the model specification but directly from the joint distribution. This distinction is important when considering models where a given node with Dirichlet-prior parent has multiple dependent children, particularly when those children are dependent on each other (e.g. if they share a parent that is collapsed out). This is discussed more below.</p>
<h5 id="multiple-dirichlet-priors-with-shifting-prior-membership">Multiple Dirichlet priors with shifting prior membership</h5>

<p>Now imagine we have a hierarchical model as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:60">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>ùúΩ</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>some distribution</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>z</mi>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>N</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùúΩ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∂</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>some distribution</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi mathvariant="bold-italic">œï</mi>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>K</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>w</mi>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>N</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi mathvariant="bold-italic">œï</mi>
        <msub>
         <mi>z</mi>
         <mi>n</mi>
        </msub>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>ùúΩ</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>some distribution</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>K</ci>
      </apply>
      <ci>ùúΩ</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <ci>ùú∂</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>some distribution</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>bold-italic-œï</ci>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>K</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>V</ci>
      </apply>
      <ci>ùú∂</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>V</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>bold-italic-œï</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\boldsymbol{\theta}&\sim&\text{some distribution}\\
z_{n=1\dots N}&\sim&\operatorname{Categorical}_{K}(\boldsymbol{\theta})\\
\boldsymbol{\alpha}&\sim&\text{some distribution}\\
\boldsymbol{\phi}_{k=1\dots K}&\sim&\operatorname{Dirichlet}_{V}(\boldsymbol{%
\alpha})\\
w_{n=1\dots N}&\sim&\operatorname{Categorical}_{V}(\boldsymbol{\phi}_{z_{n}})%
\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Here we have a tricky situation where we have multiple Dirichlet priors as before and a set of dependent categorical variables, but the relationship between the priors and dependent variables isn't fixed, unlike before. Instead, the choice of which prior to use is dependent on another random categorical variable. This occurs, for example, in topic models, and indeed the names of the variables above are meant to correspond to those in <a href="latent_Dirichlet_allocation" title="wikilink">latent Dirichlet allocation</a>. In this case, the set 

<math display="inline" id="Dirichlet-multinomial_distribution:61">
 <semantics>
  <mi>ùïé</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùïé</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{W}
  </annotation>
 </semantics>
</math>

 is a set of words, each of which is drawn from one of 

<math display="inline" id="Dirichlet-multinomial_distribution:62">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 possible topics, where each topic is a Dirichlet prior over a vocabulary of 

<math display="inline" id="Dirichlet-multinomial_distribution:63">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 possible words, specifying the frequency of different words in the topic. However, the topic membership of a given word isn't fixed; rather, it's determined from a set of <a href="latent_variable" title="wikilink">latent variables</a> 

<math display="inline" id="Dirichlet-multinomial_distribution:64">
 <semantics>
  <mi>‚Ñ§</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñ§</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}
  </annotation>
 </semantics>
</math>

. There is one latent variable per word, a 

<math display="inline" id="Dirichlet-multinomial_distribution:65">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 -dimensional <a href="categorical_variable" title="wikilink">categorical variable</a> specifying the topic the word belongs to.</p>

<p>In this case, all variables dependent on a given prior are tied together (i.e. <a class="uri" href="correlated" title="wikilink">correlated</a>) in a group, as before ‚Äî specifically, all words belonging to a given topic are linked. In this case, however, the group membership shifts, in that the words are not fixed to a given topic but the topic depends on the value of a latent variable associated with the word. However, note that the definition of the Dirichlet-multinomial density doesn't actually depend on the number of categorical variables in a group (i.e. the number of words in the document generated from a given topic), but only on the counts of how many variables in the group have a given value (i.e. among all the word tokens generated from a given topic, how many of them are a given word). Hence, we can still write an explicit formula for the joint distribution:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:66">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùïé</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo>,</mo>
     <mi>‚Ñ§</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>K</mi>
    </munderover>
    <mrow>
     <mo>DirMult</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ùïé</mi>
       <mi>k</mi>
      </msub>
      <mo>‚à£</mo>
      <mi>‚Ñ§</mi>
      <mo>,</mo>
      <mi>ùú∂</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>K</mi>
    </munderover>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi mathvariant="normal">Œì</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mo largeop="true" symmetric="true">‚àë</mo>
           <mi>v</mi>
          </msub>
          <msub>
           <mi>Œ±</mi>
           <mi>v</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi mathvariant="normal">Œì</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <msub>
            <mo largeop="true" symmetric="true">‚àë</mo>
            <mi>v</mi>
           </msub>
           <msubsup>
            <mi>n</mi>
            <mi>v</mi>
            <mi>k</mi>
           </msubsup>
          </mrow>
          <mo>+</mo>
          <msub>
           <mi>Œ±</mi>
           <mi>v</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
        <mrow>
         <mi>v</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>V</mi>
       </munderover>
       <mfrac>
        <mrow>
         <mi mathvariant="normal">Œì</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msubsup>
            <mi>n</mi>
            <mi>v</mi>
            <mi>k</mi>
           </msubsup>
           <mo>+</mo>
           <msub>
            <mi>Œ±</mi>
            <mi>v</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mrow>
         <mi mathvariant="normal">Œì</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>Œ±</mi>
           <mi>v</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>Pr</ci>
      <ci>ùïé</ci>
      <ci>ùú∂</ci>
      <ci>‚Ñ§</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <ci>DirMult</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùïé</ci>
        <ci>k</ci>
       </apply>
       <ci>‚Ñ§</ci>
       <ci>ùú∂</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>normal-Œì</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <ci>v</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>Œ±</ci>
            <ci>v</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>normal-Œì</ci>
          <apply>
           <plus></plus>
           <apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <ci>v</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>n</ci>
              <ci>v</ci>
             </apply>
             <ci>k</ci>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>Œ±</ci>
            <ci>v</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <csymbol cd="latexml">product</csymbol>
           <apply>
            <eq></eq>
            <ci>v</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>V</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>normal-Œì</ci>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>n</ci>
              <ci>v</ci>
             </apply>
             <ci>k</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>Œ±</ci>
             <ci>v</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>normal-Œì</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>Œ±</ci>
            <ci>v</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbb{W}\mid\boldsymbol{\alpha},\mathbb{Z})=\prod_{k=1}^{K}\operatorname%
{DirMult}(\mathbb{W}_{k}\mid\mathbb{Z},\boldsymbol{\alpha})=\prod_{k=1}^{K}%
\left[\frac{\Gamma\left(\sum_{v}\alpha_{v}\right)}{\Gamma\left(\sum_{v}n_{v}^{%
k}+\alpha_{v}\right)}\prod_{v=1}^{V}\frac{\Gamma(n_{v}^{k}+\alpha_{v})}{\Gamma%
(\alpha_{v})}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>Here we use the notation 

<math display="inline" id="Dirichlet-multinomial_distribution:67">
 <semantics>
  <msubsup>
   <mi>n</mi>
   <mi>v</mi>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>v</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{v}^{k}
  </annotation>
 </semantics>
</math>

 to denote the number of word tokens whose value is word symbol <em>v</em> and which belong to topic <em>k</em>.</p>

<p>The conditional distribution still has the same form:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:68">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>n</mi>
      </msub>
      <mo>=</mo>
      <mi>v</mi>
     </mrow>
     <mo>‚à£</mo>
     <msup>
      <mi>ùïé</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>,</mo>
     <mi>‚Ñ§</mi>
     <mo>,</mo>
     <mi>ùú∂</mi>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">‚àù</mo>
   <mrow>
    <msubsup>
     <mi>n</mi>
     <mi>v</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <msub>
     <mi>Œ±</mi>
     <mi>v</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">proportional-to</csymbol>
    <apply>
     <ci>Pr</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>n</ci>
      </apply>
      <ci>v</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùïé</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>‚Ñ§</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>v</ci>
      </apply>
      <list>
       <ci>k</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
       </apply>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <ci>v</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(w_{n}=v\mid\mathbb{W}^{(-n)},\mathbb{Z},\boldsymbol{\alpha})\ \propto\ n_{%
v}^{k,(-n)}+\alpha_{v}
  </annotation>
 </semantics>
</math>

</p>

<p>Here again, <strong>only</strong> the categorical variables for words belonging to a given topic are linked (even though this linking will depend on the assignments of the latent variables), and hence the word counts need to be over <strong>only</strong> the words generated by a given topic. Hence the symbol 

<math display="inline" id="Dirichlet-multinomial_distribution:69">
 <semantics>
  <msubsup>
   <mi>n</mi>
   <mi>v</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>v</ci>
    </apply>
    <list>
     <ci>k</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{v}^{k,(-n)}
  </annotation>
 </semantics>
</math>

, which is the count of words tokens having the word symbol <em>v</em>, but <strong>only</strong> among those generated by topic <em>k</em>, and excluding the word itself whose distribution is being described.</p>

<p>(Note that the reason why excluding the word itself is necessary, and why it even makes sense at all, is that in a <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a> context, we repeatedly resample the values of each random variable, after having run through and sampled all previous variables. Hence the variable will already have a value, and we need to exclude this existing value from the various counts that we make use of.)</p>
<h5 id="a-combined-example-lda-topic-models">A combined example: LDA topic models</h5>

<p>We now show how to combine some of the above scenarios to demonstrate how to <a href="Gibbs_sampling" title="wikilink">Gibbs sample</a> a real-world model, specifically a smoothed <a href="latent_Dirichlet_allocation" title="wikilink">latent Dirichlet allocation</a> (LDA) <a href="topic_model" title="wikilink">topic model</a>.</p>

<p>The model is as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:70">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∂</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∑</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>ùúΩ</mi>
      <mrow>
       <mi>d</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>M</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi mathvariant="bold-italic">œï</mi>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>K</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∑</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>z</mi>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <mi>M</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <msub>
          <mi>N</mi>
          <mi>d</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ùúΩ</mi>
        <mi>d</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>w</mi>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <mi>M</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <msub>
          <mi>N</mi>
          <mi>d</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi mathvariant="bold-italic">œï</mi>
        <msub>
         <mi>z</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>ùú∂</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </matrixrow>
    <matrixrow>
     <ci>ùú∑</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùúΩ</ci>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>M</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>K</ci>
      </apply>
      <ci>ùú∂</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>bold-italic-œï</ci>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>K</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>V</ci>
      </apply>
      <ci>ùú∑</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùúΩ</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>V</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>bold-italic-œï</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\boldsymbol{\alpha}&\sim&\text{A Dirichlet hyperprior, %
either a constant or a random variable}\\
\boldsymbol{\beta}&\sim&\text{A Dirichlet hyperprior, either a constant or a %
random variable}\\
\boldsymbol{\theta}_{d=1\dots M}&\sim&\operatorname{Dirichlet}_{K}(\boldsymbol%
{\alpha})\\
\boldsymbol{\phi}_{k=1\dots K}&\sim&\operatorname{Dirichlet}_{V}(\boldsymbol{%
\beta})\\
z_{d=1\dots M,n=1\dots N_{d}}&\sim&\operatorname{Categorical}_{K}(\boldsymbol{%
\theta}_{d})\\
w_{d=1\dots M,n=1\dots N_{d}}&\sim&\operatorname{Categorical}_{V}(\boldsymbol{%
\phi}_{z_{dn}})\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Essentially we combine the previous three scenarios: We have categorical variables dependent on multiple priors sharing a hyperprior; we have categorical variables with dependent children (the <a href="latent_variable" title="wikilink">latent variable</a> topic identities); and we have categorical variables with shifting membership in multiple priors sharing a hyperprior. Note also that in the standard LDA model, the words are completely observed, and hence we never need to resample them. (However, Gibbs sampling would equally be possible if only some or none of the words were observed. In such a case, we would want to initialize the distribution over the words in some reasonable fashion ‚Äî e.g. from the output of some process that generates sentences, such as a <a href="machine_translation" title="wikilink">machine translation</a> model ‚Äî in order for the resulting <a href="posterior_distribution" title="wikilink">posterior</a> latent variable distributions to make any sense.)</p>

<p>Using the above formulas, we can write down the conditional probabilities directly:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:71">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>w</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>=</mo>
        <mi>v</mi>
       </mrow>
       <mo>‚à£</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>,</mo>
       <mi>‚Ñ§</mi>
       <mo>,</mo>
       <mi>ùú∑</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àù</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi mathvariant="normal">#</mi>
       <msubsup>
        <mi>ùïé</mi>
        <mi>v</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>Œ≤</mi>
       <mi>v</mi>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>=</mo>
        <mi>k</mi>
       </mrow>
       <mo>‚à£</mo>
       <msup>
        <mi>‚Ñ§</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>w</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>=</mo>
        <mi>v</mi>
       </mrow>
       <mo>,</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>,</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àù</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi mathvariant="normal">#</mi>
         <msubsup>
          <mi>‚Ñ§</mi>
          <mi>k</mi>
          <mrow>
           <mi>d</mi>
           <mo>,</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>d</mi>
              <mi>n</mi>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>Œ±</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>Pr</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>w</mi>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </msub>
         <mo>=</mo>
         <mi>v</mi>
        </mrow>
        <mo>‚à£</mo>
        <msup>
         <mi>ùïé</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
        <mo>,</mo>
        <mi>‚Ñ§</mi>
        <mo>,</mo>
        <mi>ùú∑</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <ci>Pr</ci>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùïé</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>‚Ñ§</ci>
      <ci>ùú∑</ci>
     </apply>
     <csymbol cd="latexml">proportional-to</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>normal-#</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ùïé</ci>
         <ci>v</ci>
        </apply>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ≤</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <ci>Pr</ci>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>‚Ñ§</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùïé</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>ùú∂</ci>
     </apply>
     <csymbol cd="latexml">proportional-to</csymbol>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-#</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>‚Ñ§</ci>
          <ci>k</ci>
         </apply>
         <list>
          <ci>d</ci>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <ci>d</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </list>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <ci>Pr</ci>
       <apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>w</ci>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>v</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <ci>‚Ñ§</ci>
       <ci>ùú∑</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\Pr(w_{dn}=v\mid\mathbb{W}^{(-dn)},\mathbb{Z},\boldsymbol{%
\beta})&\propto&\#\mathbb{W}_{v}^{k,(-dn)}+\beta_{v}\\
\Pr(z_{dn}=k\mid\mathbb{Z}^{(-dn)},w_{dn}=v,\mathbb{W}^{(-dn)},\boldsymbol{%
\alpha})&\propto&(\#\mathbb{Z}_{k}^{d,(-dn)}+\alpha_{k})\Pr(w_{dn}=v\mid%
\mathbb{W}^{(-dn)},\mathbb{Z},\boldsymbol{\beta})\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Here we have defined the counts more explicitly to clearly separate counts of words and counts of topics:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:72">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi mathvariant="normal">#</mi>
      <msubsup>
       <mi>ùïé</mi>
       <mi>v</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msubsup>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mtext>number of words having value</mtext>
      <mi>v</mi>
      <mtext>among topic</mtext>
      <mi>k</mi>
      <mtext>excluding</mtext>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi mathvariant="normal">#</mi>
      <msubsup>
       <mi>‚Ñ§</mi>
       <mi>k</mi>
       <mrow>
        <mi>d</mi>
        <mo>,</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msubsup>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mtext>number of topics having value</mtext>
      <mi>k</mi>
      <mtext>among document</mtext>
      <mi>d</mi>
      <mtext>excluding</mtext>
      <msub>
       <mi>z</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-#</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùïé</ci>
        <ci>v</ci>
       </apply>
       <list>
        <ci>k</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>number of words having value</mtext>
      <ci>v</ci>
      <mtext>among topic</mtext>
      <ci>k</ci>
      <mtext>excluding</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-#</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>‚Ñ§</ci>
        <ci>k</ci>
       </apply>
       <list>
        <ci>d</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>number of topics having value</mtext>
      <ci>k</ci>
      <mtext>among document</mtext>
      <ci>d</ci>
      <mtext>excluding</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\#\mathbb{W}_{v}^{k,(-dn)}&=&\text{number of words having %
value }v\text{ among topic }k\text{ excluding }w_{dn}\\
\#\mathbb{Z}_{k}^{d,(-dn)}&=&\text{number of topics having value }k\text{ %
among document }d\text{ excluding }z_{dn}\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Note that, as in the scenario above with categorical variables with dependent children, the conditional probability of those dependent children appears in the definition of the parent's conditional probability. In this case, each latent variable has only a single dependent child word, so only one such term appears. (If there were multiple dependent children, all would have to appear in the parent's conditional probability, regardless of whether there was overlap between different parents and the same children, i.e. regardless of whether the dependent children of a given parent also have other parents. In a case where a child has multiple parents, the conditional probability for that child appears in the conditional probability definition of each of its parents.)</p>

<p>Note, critically, however, that the definition above specifies only the <em>unnormalized</em> conditional probability of the words, while the topic conditional probability requires the <em>actual</em> (i.e. normalized) probability. Hence we have to normalize by summing over all word symbols:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:73">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>=</mo>
        <mi>k</mi>
       </mrow>
       <mo>‚à£</mo>
       <msup>
        <mi>‚Ñ§</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>,</mo>
       <mrow>
        <msub>
         <mi>w</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>=</mo>
        <mi>v</mi>
       </mrow>
       <mo>,</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>,</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àù</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mo maxsize="120%" minsize="120%">(</mo>
       <mrow>
        <mrow>
         <mi mathvariant="normal">#</mi>
         <msubsup>
          <mi>‚Ñ§</mi>
          <mi>k</mi>
          <mrow>
           <mi>d</mi>
           <mo>,</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>d</mi>
              <mi>n</mi>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>Œ±</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo maxsize="120%" minsize="120%">)</mo>
      </mrow>
      <mfrac>
       <mrow>
        <mrow>
         <mi mathvariant="normal">#</mi>
         <msubsup>
          <mi>ùïé</mi>
          <mi>v</mi>
          <mrow>
           <mi>k</mi>
           <mo>,</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>d</mi>
              <mi>n</mi>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>Œ≤</mi>
         <mi>v</mi>
        </msub>
       </mrow>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">‚àë</mo>
         <mrow>
          <msup>
           <mi>v</mi>
           <mo>‚Ä≤</mo>
          </msup>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>V</mi>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi mathvariant="normal">#</mi>
           <msubsup>
            <mi>ùïé</mi>
            <msup>
             <mi>v</mi>
             <mo>‚Ä≤</mo>
            </msup>
            <mrow>
             <mi>k</mi>
             <mo>,</mo>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mo>-</mo>
               <mrow>
                <mi>d</mi>
                <mi>n</mi>
               </mrow>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </msubsup>
          </mrow>
          <mo>+</mo>
          <msub>
           <mi>Œ≤</mi>
           <msup>
            <mi>v</mi>
            <mo>‚Ä≤</mo>
           </msup>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd></mtd>
    <mtd></mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mo maxsize="120%" minsize="120%">(</mo>
       <mrow>
        <mrow>
         <mi mathvariant="normal">#</mi>
         <msubsup>
          <mi>‚Ñ§</mi>
          <mi>k</mi>
          <mrow>
           <mi>d</mi>
           <mo>,</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>d</mi>
              <mi>n</mi>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>Œ±</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo maxsize="120%" minsize="120%">)</mo>
      </mrow>
      <mfrac>
       <mrow>
        <mrow>
         <mi mathvariant="normal">#</mi>
         <msubsup>
          <mi>ùïé</mi>
          <mi>v</mi>
          <mrow>
           <mi>k</mi>
           <mo>,</mo>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>d</mi>
              <mi>n</mi>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>Œ≤</mi>
         <mi>v</mi>
        </msub>
       </mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi mathvariant="normal">#</mi>
          <msup>
           <mi>ùïé</mi>
           <mi>k</mi>
          </msup>
         </mrow>
         <mo>+</mo>
         <mi>B</mi>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <ci>Pr</ci>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>‚Ñ§</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùïé</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>ùú∂</ci>
     </apply>
     <csymbol cd="latexml">proportional-to</csymbol>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-#</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>‚Ñ§</ci>
          <ci>k</ci>
         </apply>
         <list>
          <ci>d</ci>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <ci>d</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </list>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>normal-#</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ùïé</ci>
           <ci>v</ci>
          </apply>
          <list>
           <ci>k</ci>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <ci>d</ci>
             <ci>n</ci>
            </apply>
           </apply>
          </list>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Œ≤</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>v</ci>
            <ci>normal-‚Ä≤</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>V</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>normal-#</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ùïé</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>v</ci>
             <ci>normal-‚Ä≤</ci>
            </apply>
           </apply>
           <list>
            <ci>k</ci>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <ci>d</ci>
              <ci>n</ci>
             </apply>
            </apply>
           </list>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Œ≤</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>v</ci>
           <ci>normal-‚Ä≤</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-#</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>‚Ñ§</ci>
          <ci>k</ci>
         </apply>
         <list>
          <ci>d</ci>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <ci>d</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </list>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œ±</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>normal-#</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ùïé</ci>
           <ci>v</ci>
          </apply>
          <list>
           <ci>k</ci>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <ci>d</ci>
             <ci>n</ci>
            </apply>
           </apply>
          </list>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Œ≤</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>normal-#</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ùïé</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <ci>B</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}\Pr(z_{dn}=k\mid\mathbb{Z}^{(-dn)},w_{dn}=v,\mathbb{W}^{(-%
dn)},\boldsymbol{\alpha})&\propto&\bigl(\#\mathbb{Z}_{k}^{d,(-dn)}+\alpha_{k}%
\bigr)\dfrac{\#\mathbb{W}_{v}^{k,(-dn)}+\beta_{v}}{\sum_{v^{\prime}=1}^{V}(\#%
\mathbb{W}_{v^{\prime}}^{k,(-dn)}+\beta_{v^{\prime}})}\\
&&\\
&=&\bigl(\#\mathbb{Z}_{k}^{d,(-dn)}+\alpha_{k}\bigr)\dfrac{\#\mathbb{W}_{v}^{k%
,(-dn)}+\beta_{v}}{\#\mathbb{W}^{k}+B-1}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:74">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi mathvariant="normal">#</mi>
      <msup>
       <mi>ùïé</mi>
       <mi>k</mi>
      </msup>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mtext>number of words generated by topic</mtext>
      <mi>k</mi>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mi>B</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>v</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>V</mi>
      </munderover>
      <msub>
       <mi>Œ≤</mi>
       <mi>v</mi>
      </msub>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-#</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùïé</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>number of words generated by topic</mtext>
      <ci>k</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <ci>B</ci>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>v</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>V</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ≤</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\#\mathbb{W}^{k}&=&\text{number of words generated by %
topic }k\\
B&=&\sum_{v=1}^{V}\beta_{v}\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>It's also worth making another point in detail, which concerns the second factor above in the conditional probability. Remember that the conditional distribution in general is derived from the joint distribution, and simplified by removing terms not dependent on the domain of the conditional (the part on the left side of the vertical bar). When a node 

<math display="inline" id="Dirichlet-multinomial_distribution:75">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 has dependent children, there will be one or more factors 

<math display="inline" id="Dirichlet-multinomial_distribution:76">
 <semantics>
  <mrow>
   <mo>F</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>‚à£</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-F</ci>
    <ci>normal-‚Ä¶</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{F}(\dots\mid z)
  </annotation>
 </semantics>
</math>

 in the joint distribution that are dependent on 

<math display="inline" id="Dirichlet-multinomial_distribution:77">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

. <em>Usually</em> there is one factor for each dependent node, and it has the same density function as the distribution appearing the mathematical definition. However, if a dependent node has another parent as well (a co-parent), and that co-parent is collapsed out, then the node will become dependent on all other nodes sharing that co-parent, and in place of multiple terms for each such node, the joint distribution will have only one joint term. We have exactly that situation here. Even though 

<math display="inline" id="Dirichlet-multinomial_distribution:78">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>

 has only one child 

<math display="inline" id="Dirichlet-multinomial_distribution:79">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{dn}
  </annotation>
 </semantics>
</math>

, that child has a Dirichlet co-parent that we have collapsed out, which induces a Dirichlet-multinomial over the entire set of nodes 

<math display="inline" id="Dirichlet-multinomial_distribution:80">
 <semantics>
  <msup>
   <mi>ùïé</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ùïé</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{W}^{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>It happens in this case that this issue does not cause major problems, precisely because of the one-to-one relationship between 

<math display="inline" id="Dirichlet-multinomial_distribution:81">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Dirichlet-multinomial_distribution:82">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{dn}
  </annotation>
 </semantics>
</math>

. We can rewrite the joint distribution as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:83">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>ùïé</mi>
        <mi>k</mi>
       </msup>
       <mo>‚à£</mo>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>w</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo>‚à£</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mo>,</mo>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mo>‚à£</mo>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>w</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo>‚à£</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mo>,</mo>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>w</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo>‚à£</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msup>
       <mo>,</mo>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>d</mi>
         <mi>n</mi>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-‚à£</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <eq></eq>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-‚à£</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
       <ci>normal-‚à£</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-‚à£</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <csymbol cd="latexml">similar-to</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-‚à£</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ùïé</ci>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
       <ci>normal-,</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}p(\mathbb{W}^{k}\mid z_{dn})&=&p(w_{dn}\mid\mathbb{W}^{k,(%
-dn)},z_{dn})\,p(\mathbb{W}^{k,(-dn)}\mid z_{dn})\\
&=&p(w_{dn}\mid\mathbb{W}^{k,(-dn)},z_{dn})\,p(\mathbb{W}^{k,(-dn)})\\
&\sim&p(w_{dn}\mid\mathbb{W}^{k,(-dn)},z_{dn})\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>where we note that in the set 

<math display="inline" id="Dirichlet-multinomial_distribution:84">
 <semantics>
  <msup>
   <mi>ùïé</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>d</mi>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ùïé</ci>
    <list>
     <ci>k</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{W}^{k,(-dn)}
  </annotation>
 </semantics>
</math>

 (i.e. the set of nodes 

<math display="inline" id="Dirichlet-multinomial_distribution:85">
 <semantics>
  <msup>
   <mi>ùïé</mi>
   <mi>k</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ùïé</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{W}^{k}
  </annotation>
 </semantics>
</math>

 excluding 

<math display="inline" id="Dirichlet-multinomial_distribution:86">
 <semantics>
  <msub>
   <mi>w</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{dn}
  </annotation>
 </semantics>
</math>

 ), none of the nodes have 

<math display="inline" id="Dirichlet-multinomial_distribution:87">
 <semantics>
  <msub>
   <mi>z</mi>
   <mrow>
    <mi>d</mi>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{dn}
  </annotation>
 </semantics>
</math>

 as a parent. Hence it can be eliminated as a conditioning factor (line 2), meaning that the entire factor can be eliminated from the conditional distribution (line 3).</p>
<h5 id="a-second-example-naive-bayes-document-clustering">A second example: Naive Bayes document clustering</h5>

<p>Here is another model, with a different set of issues. This is an implementation of an unsupervised <a href="Naive_Bayes" title="wikilink">Naive Bayes</a> model for document clustering. That is, we would like to <a href="document_classification" title="wikilink">classify documents</a> into multiple categories (e.g. "<a href="spam_(electronic)" title="wikilink">spam</a>" or "non-spam", or "scientific journal article", "newspaper article about finance", "newspaper article about politics", "love letter") based on textual content. However, we don't already know the correct category of any documents; instead, we want to <a href="document_clustering" title="wikilink">cluster</a> them based on mutual similarities. (For example, a set of scientific articles will tend to be similar to each other in word use but very different from a set of love letters.) This is a type of <a href="unsupervised_learning" title="wikilink">unsupervised learning</a>. (The same technique can be used for doing <a href="semi-supervised_learning" title="wikilink">semi-supervised learning</a>, i.e. where we know the correct category of some fraction of the documents and would like to use this knowledge to help in clustering the remaining documents.)</p>

<p>The model is as follows:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:88">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∂</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mi>ùú∑</mi>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>ùúΩ</mi>
      <mrow>
       <mi>d</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>M</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi mathvariant="bold-italic">œï</mi>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>K</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Dirichlet</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùú∑</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>z</mi>
      <mrow>
       <mi>d</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mi mathvariant="normal">‚Ä¶</mi>
        <mi>M</mi>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>K</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>ùúΩ</mi>
        <mi>d</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>w</mi>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <mi>M</mi>
        </mrow>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mi mathvariant="normal">‚Ä¶</mi>
         <msub>
          <mi>N</mi>
          <mi>d</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àº</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mo>Categorical</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi mathvariant="bold-italic">œï</mi>
        <msub>
         <mi>z</mi>
         <mi>d</mi>
        </msub>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>ùú∂</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </matrixrow>
    <matrixrow>
     <ci>ùú∑</ci>
     <csymbol cd="latexml">similar-to</csymbol>
     <mtext>A Dirichlet hyperprior, either a constant or a random variable</mtext>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùúΩ</ci>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>M</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>K</ci>
      </apply>
      <ci>ùú∂</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>bold-italic-œï</ci>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>K</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Dirichlet</ci>
       <ci>V</ci>
      </apply>
      <ci>ùú∑</ci>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <apply>
       <eq></eq>
       <ci>d</ci>
       <apply>
        <times></times>
        <cn type="integer">1</cn>
        <ci>normal-‚Ä¶</ci>
        <ci>M</ci>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>K</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ùúΩ</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>d</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <ci>M</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <apply>
         <times></times>
         <cn type="integer">1</cn>
         <ci>normal-‚Ä¶</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Categorical</ci>
       <ci>V</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>bold-italic-œï</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\boldsymbol{\alpha}&\sim&\text{A Dirichlet hyperprior, %
either a constant or a random variable}\\
\boldsymbol{\beta}&\sim&\text{A Dirichlet hyperprior, either a constant or a %
random variable}\\
\boldsymbol{\theta}_{d=1\dots M}&\sim&\operatorname{Dirichlet}_{K}(\boldsymbol%
{\alpha})\\
\boldsymbol{\phi}_{k=1\dots K}&\sim&\operatorname{Dirichlet}_{V}(\boldsymbol{%
\beta})\\
z_{d=1\dots M}&\sim&\operatorname{Categorical}_{K}(\boldsymbol{\theta}_{d})\\
w_{d=1\dots M,n=1\dots N_{d}}&\sim&\operatorname{Categorical}_{V}(\boldsymbol{%
\phi}_{z_{d}})\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>In many ways, this model is very similar to the <a href="latent_Dirichlet_allocation" title="wikilink">LDA</a> <a href="topic_model" title="wikilink">topic model</a> described above, but it assumes one topic per document rather than one topic per word, with a document consisting of a mixture of topics. This can be seen clearly in the above model, which is identical to the LDA model except that there is only one <a href="latent_variable" title="wikilink">latent variable</a> per document instead of one per word. Once again, we assume that we are collapsing all of the Dirichlet priors.</p>

<p>The conditional probability for a given word is almost identical to the LDA case. Once again, all words generated by the same Dirichlet prior are interdependent. In this case, this means the words of all documents having a given label ‚Äî again, this can vary depending on the label assignments, but all we care about is the total counts. Hence:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:89">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>w</mi>
         <mrow>
          <mi>d</mi>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>=</mo>
        <mi>v</mi>
       </mrow>
       <mo>‚à£</mo>
       <msup>
        <mi>ùïé</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <mo>,</mo>
       <mi>‚Ñ§</mi>
       <mo>,</mo>
       <mi>ùú∑</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>‚àù</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi mathvariant="normal">#</mi>
       <msubsup>
        <mi>ùïé</mi>
        <mi>v</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>d</mi>
            <mi>n</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>Œ≤</mi>
       <mi>v</mi>
      </msub>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <ci>Pr</ci>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>v</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùïé</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>‚Ñ§</ci>
      <ci>ùú∑</ci>
     </apply>
     <csymbol cd="latexml">proportional-to</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>normal-#</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ùïé</ci>
         <ci>v</ci>
        </apply>
        <list>
         <ci>k</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ≤</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\Pr(w_{dn}=v\mid\mathbb{W}^{(-dn)},\mathbb{Z},\boldsymbol{%
\beta})&\propto&\#\mathbb{W}_{v}^{k,(-dn)}+\beta_{v}\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:90">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi mathvariant="normal">#</mi>
      <msubsup>
       <mi>ùïé</mi>
       <mi>v</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>d</mi>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msubsup>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mtext>number of words having value</mtext>
      <mi>v</mi>
      <mtext>among documents with label</mtext>
      <mi>k</mi>
      <mtext>excluding</mtext>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>d</mi>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>normal-#</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ùïé</ci>
        <ci>v</ci>
       </apply>
       <list>
        <ci>k</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <mtext>number of words having value</mtext>
      <ci>v</ci>
      <mtext>among documents with label</mtext>
      <ci>k</ci>
      <mtext>excluding</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}\#\mathbb{W}_{v}^{k,(-dn)}&=&\text{number of words having %
value }v\text{ among documents with label }k\text{ excluding }w_{dn}\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>However, there is a critical difference in the conditional distribution of the latent variables for the label assignments, which is that a given label variable has multiple children nodes instead of just one ‚Äî in particular, the nodes for all the words in the label's document. This relates closely to the discussion above about the factor 

<math display="inline" id="Dirichlet-multinomial_distribution:91">
 <semantics>
  <mrow>
   <mo>F</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>‚à£</mo>
    <msub>
     <mi>z</mi>
     <mi>d</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-F</ci>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{F}(\dots\mid z_{d})
  </annotation>
 </semantics>
</math>

 that stems from the joint distribution. In this case, the joint distribution needs to be taken over all words in all documents containing a label assignment equal to the value of 

<math display="inline" id="Dirichlet-multinomial_distribution:92">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{d}
  </annotation>
 </semantics>
</math>

, and has the value of a Dirichlet-multinomial distribution. Furthermore, we cannot reduce this joint distribution down to a conditional distribution over a single word. Rather, we can reduce it down only to a smaller joint conditional distribution over the words in the document for the label in question, and hence we cannot simplify it using the trick above that yields a simple sum of expected count and prior. Although it is in fact possible to rewrite it as a product of such individual sums, the number of factors is very large, and is not clearly more efficient than directly computing the Dirichlet-multinomial distribution probability.</p>
<h3 id="for-a-multinomial-distribution-over-category-counts">For a multinomial distribution over category counts</h3>

<p>For a random vector of category counts 

<math display="inline" id="Dirichlet-multinomial_distribution:93">
 <semantics>
  <mrow>
   <mi>ùê±</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>n</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>n</mi>
     <mi>K</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê±</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>K</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}=(n_{1},\dots,n_{K})
  </annotation>
 </semantics>
</math>

, distributed according to a <a href="multinomial_distribution" title="wikilink">multinomial distribution</a>, the <a href="marginal_distribution" title="wikilink">marginal distribution</a> is obtained by integrating out <strong>p</strong>:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:94">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùê±</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">‚à´</mo>
     <mi>ùê©</mi>
    </msub>
    <mrow>
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùê±</mi>
       <mo>‚à£</mo>
       <mi>ùê©</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>Pr</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ùê©</mi>
       <mo>‚à£</mo>
       <mi>ùú∂</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mtext>d</mtext>
     <mi>ùê©</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>ùê±</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>ùê©</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>Pr</ci>
       <ci>ùê±</ci>
       <ci>ùê©</ci>
      </apply>
      <apply>
       <ci>Pr</ci>
       <ci>ùê©</ci>
       <ci>ùú∂</ci>
      </apply>
      <mtext>d</mtext>
      <ci>ùê©</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbf{x}\mid\boldsymbol{\alpha})=\int_{\mathbf{p}}\Pr(\mathbf{x}\mid%
\mathbf{p})\Pr(\mathbf{p}\mid\boldsymbol{\alpha})\textrm{d}\mathbf{p}
  </annotation>
 </semantics>
</math>

</p>

<p>which results in the following explicit formula:</p>

<p>

<math display="block" id="Dirichlet-multinomial_distribution:95">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùê±</mi>
     <mo>‚à£</mo>
     <mi>ùú∂</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>N</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">‚àè</mo>
       <mi>k</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>n</mi>
         <mi>k</mi>
        </msub>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mfrac>
     <mrow>
      <mi mathvariant="normal">Œì</mi>
      <mrow>
       <mo>(</mo>
       <mi>A</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Œì</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>N</mi>
        <mo>+</mo>
        <mi>A</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àè</mo>
      <mi>k</mi>
     </munder>
     <mfrac>
      <mrow>
       <mi mathvariant="normal">Œì</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>n</mi>
          <mi>k</mi>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>Œ±</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi mathvariant="normal">Œì</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>Œ±</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>ùê±</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <factorial></factorial>
       <ci>N</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <ci>k</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>normal-Œì</ci>
       <ci>A</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Œì</ci>
       <apply>
        <plus></plus>
        <ci>N</ci>
        <ci>A</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <ci>k</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>normal-Œì</ci>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Œ±</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Œì</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Œ±</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbf{x}\mid\boldsymbol{\alpha})=\frac{N!}{\prod_{k}\left(n_{k}!\right)}%
\frac{\Gamma\left(A\right)}{\Gamma\left(N+A\right)}\prod_{k}\frac{\Gamma(n_{k}%
+\alpha_{k})}{\Gamma(\alpha_{k})}
  </annotation>
 </semantics>
</math>

</p>

<p>where A is defined as the sum 

<math display="inline" id="Dirichlet-multinomial_distribution:96">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">‚àë</mo>
    <msub>
     <mi>Œ±</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <sum></sum>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œ±</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\sum\alpha_{k}
  </annotation>
 </semantics>
</math>

. Note that this differs crucially from the above formula in having an extra term at the front that looks like the factor at the front of a multinomial distribution. Another form for this same compound distribution, written more compactly in terms of the <a href="beta_function" title="wikilink">beta function</a>, <em>B</em>, is as follows:</p>

<p>

<math display="inline" id="Dirichlet-multinomial_distribution:97">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Pr</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùê±</mi>
      <mo>‚à£</mo>
      <mi>ùú∂</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>N</mi>
      <mi>B</mi>
      <mrow>
       <mo>(</mo>
       <mi>A</mi>
       <mo>,</mo>
       <mi>N</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mstyle displaystyle="false">
       <msub>
        <mo largeop="true" symmetric="true">‚àè</mo>
        <mrow>
         <mi>k</mi>
         <mo>:</mo>
         <mrow>
          <msub>
           <mi>n</mi>
           <mi>k</mi>
          </msub>
          <mo>></mo>
          <mn>0</mn>
         </mrow>
        </mrow>
       </msub>
      </mstyle>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>k</mi>
       </msub>
       <mi>B</mi>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>Œ±</mi>
         <mi>k</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>n</mi>
         <mi>k</mi>
        </msub>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>ùê±</ci>
     <ci>ùú∂</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>N</ci>
      <ci>B</ci>
      <interval closure="open">
       <ci>A</ci>
       <ci>N</ci>
      </interval>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <ci>normal-:</ci>
        <ci>k</ci>
        <apply>
         <gt></gt>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>k</ci>
         </apply>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <ci>B</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Œ±</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>k</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(\mathbf{x}\mid\boldsymbol{\alpha})=\frac{NB\left(A,N\right)}{\prod_{k:n_{k%
}>0}n_{k}B\left(\alpha_{k},n_{k}\right)}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="related-distributions">Related distributions</h2>

<p>The one-dimensional version of the multivariate P√≥lya distribution is known as the <a href="Beta-binomial_distribution" title="wikilink">Beta-binomial distribution</a>.</p>
<h2 id="uses">Uses</h2>

<p>The multivariate P√≥lya distribution is used in automated document classification and clustering, <a class="uri" href="genetics" title="wikilink">genetics</a>, <a class="uri" href="economy" title="wikilink">economy</a>, combat modeling, and quantitative marketing.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Beta-binomial_distribution" title="wikilink">Beta-binomial distribution</a></li>
<li><a href="Chinese_restaurant_process" title="wikilink">Chinese restaurant process</a></li>
<li><a href="Dirichlet_process" title="wikilink">Dirichlet process</a></li>
<li><a href="Generalized_Dirichlet_distribution" title="wikilink">Generalized Dirichlet distribution</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Elkan, C. (2006) <a href="http://www-cse.ucsd.edu/users/elkan/edcm.pdf">Clustering documents with an exponential-family approximation of the Dirichlet compound multinomial distribution</a>. ICML, 289-296</li>
<li>Johnson, N. L., Kotz, S. and Balakrishnan, N. (1997) Discrete multivariate distributions (Vol. 165). New York: Wiley.</li>
<li>Kvam, P. and Day, D. (2001) The multivariate Polya distribution in combat modeling. Naval Research Logistics, 48, 1-17</li>
<li>Madsen, RE., Kauchak, D. and Elkan, C. (2005) <a href="http://www.cse.ucsd.edu/~dkauchak/kauchak05modeling.pdf">Modeling Word Burstiness Using the Dirichlet Distribution</a>. ICML, 545-552</li>
<li>Minka, T. (2003) <a href="http://research.microsoft.com/~minka/papers/dirichlet/">Estimating a Dirichlet distribution</a>. Technical report Microsoft Research. Includes Matlab code for fitting distributions to data.</li>
<li>Mosimann, J. E. (1962) <a href="http://www.jstor.org/stable/2333468">On the compound multinomial distribution, the multivariate Œ≤-distribution, and correlations among proportions</a>. Biometrika, 49(1-2), 65-82.</li>
<li>Wagner, U. and Taudes, A. (1986) A Multivariate Polya Model of Brand Choice and Purchase Incidence. Marketing Science, 5(3), 219-244.</li>
</ul>

<p>"</p>

<p><a href="Category:Multivariate_discrete_distributions" title="wikilink">Category:Multivariate discrete distributions</a> <a href="Category:Probability_distributions" title="wikilink">Category:Probability distributions</a> <a href="Category:Discrete_distributions" title="wikilink">Category:Discrete distributions</a></p>
</body>
</html>

   Cross entropy      Cross entropy   In information theory , the cross entropy between two probability distributions over the same underlying set of events measures the average number of bits needed to identify an event drawn from the set, if a coding scheme is used that is optimized for an "unnatural" probability distribution   q   q   q   , rather than the "true" distribution   p   p   p   .  The cross entropy for the distributions   p   p   p   and   q   q   q   over a given set is defined as follows:      H   (  p  ,  q  )   =   E  p    [  -  log  q  ]   =  H   (  p  )   +   D  KL    (  p  ‚à•  q  )   ,     fragments  H   fragments  normal-(  p  normal-,  q  normal-)     subscript  normal-E  p    fragments  normal-[    q  normal-]    H   fragments  normal-(  p  normal-)     subscript  D  KL    fragments  normal-(  p  parallel-to  q  normal-)   normal-,    H(p,q)=\operatorname{E}_{p}[-\log q]=H(p)+D_{\mathrm{KL}}(p\|q),\!     where    H   (  p  )       H  p    H(p)   is the entropy of   p   p   p   , and     D  KL    (  p  |  |  q  )      fragments   subscript  D  KL    fragments  normal-(  p  normal-|  normal-|  q  normal-)     D_{\mathrm{KL}}(p||q)   is the Kullback‚ÄìLeibler divergence of   q   q   q   from   p   p   p   (also known as the relative entropy of p with respect to q ‚Äî note the reversal of emphasis).  For discrete    p   p   p   and   q   q   q   this means        H   (  p  ,  q  )    =   -    ‚àë  x    p   (  x  )    log  q    (  x  )       .        H   p  q        subscript   x     p  x    q   x       H(p,q)=-\sum_{x}p(x)\,\log q(x).\!     The situation for continuous distributions is analogous:       -    ‚à´  X    p   (  x  )    log  q    (  x  )   d  x     .        subscript   X     p  x    q   x  d  x      -\int_{X}p(x)\,\log q(x)\,dx.\!     NB: The notation    H   (  p  ,  q  )       H   p  q     H(p,q)   is also used for a different concept, the joint entropy of   p   p   p   and   q   q   q   .  Motivation  In information theory, the Kraft‚ÄìMcMillan theorem establishes that any directly decodable coding scheme for coding a message to identify one value    x  i     subscript  x  i    x_{i}   out of a set of possibilities   X   X   X   can be seen as representing an implicit probability distribution     q   (   x  i   )    =   2   -   l  i           q   subscript  x  i     superscript  2     subscript  l  i       q(x_{i})=2^{-l_{i}}   over   X   X   X   , where    l  i     subscript  l  i    l_{i}   is the length of the code for    x  i     subscript  x  i    x_{i}   in bits. Therefore, cross entropy can be interpreted as the expected message-length per datum when a wrong distribution   Q   Q   Q   is assumed, however the data actually follows a distribution   P   P   P   ‚Äî that is why the expectation is taken over the probability distribution   P   P   P   and not   Q   Q   Q   .       H   (  p  ,  q  )    =    E  p    [   l  i   ]    =    E  p    [   log   1   q   (   x  i   )      ]            H   p  q      subscript  normal-E  p    subscript  l  i           subscript  normal-E  p       1    q   subscript  x  i          H(p,q)=\operatorname{E}_{p}[l_{i}]=\operatorname{E}_{p}\left[\log\frac{1}{q(x_%
 {i})}\right]          H   (  p  ,  q  )    =    ‚àë   x  i     p   (   x  i   )    log    1   q   (   x  i   )               H   p  q      subscript    subscript  x  i      p   subscript  x  i       1    q   subscript  x  i          H(p,q)=\sum_{x_{i}}p(x_{i})\,\log\frac{1}{q(x_{i})}\!           H   (  p  ,  q  )    =   -    ‚àë  x    p   (  x  )    log  q    (  x  )       .        H   p  q        subscript   x     p  x    q   x       H(p,q)=-\sum_{x}p(x)\,\log q(x).\!     Estimation  There are many situations where cross-entropy needs to be measured but the distribution of   p   p   p   is unknown. An example is language modeling , where a model is created based on a training set   T   T   T   , and then its cross-entropy is measured on a test set to assess how accurate the model is in predicting the test data. In this example,   p   p   p   is the true distribution of words in any corpus, and   q   q   q   is the distribution of words as predicted by the model. Since the true distribution is unknown, cross-entropy cannot be directly calculated. In these cases, an estimate of cross-entropy is calculated using the following formula:       H   (  T  ,  q  )    =   -    ‚àë   i  =  1   N     1  N     log  2   q    (   x  i   )            H   T  q        superscript   subscript     i  1    N       1  N     subscript   2   q    subscript  x  i        H(T,q)=-\sum_{i=1}^{N}\frac{1}{N}\log_{2}q(x_{i})     where   N   N   N   is the size of the test set, and    q   (  x  )       q  x    q(x)   is the probability of event   x   x   x   estimated from the training set. The sum is calculated over   N   N   N   . This is a Monte Carlo estimate of the true cross entropy, where the training set is treated as samples from    p   (  x  )       p  x    p(x)   .  Cross-entropy minimization  Cross-entropy minimization is frequently used in optimization and rare-event probability estimation; see the cross-entropy method .  When comparing a distribution   q   q   q   against a fixed reference distribution   p   p   p   , cross entropy and KL divergence are identical up to an additive constant (since   p   p   p   is fixed): both take on their minimal values when    p  =  q      p  q    p=q   , which is   0   0    for KL divergence, and    H   (  p  )       normal-H  p    \mathrm{H}(p)   for cross entropy. In the engineering literature, the principle of minimising KL Divergence (Kullback's " Principle of Minimum Discrimination Information ") is often called the Principle of Minimum Cross-Entropy (MCE), or Minxent .  However, as discussed in the article Kullback‚ÄìLeibler divergence , sometimes the distribution   q   q   q   is the fixed prior reference distribution, and the distribution   p   p   p   is optimised to be as close to   q   q   q   as possible, subject to some constraint. In this case the two minimisations are not equivalent. This has led to some ambiguity in the literature, with some authors attempting to resolve the inconsistency by redefining cross-entropy to be     D  KL    (  p  ‚à•  q  )      fragments   subscript  D  KL    fragments  normal-(  p  parallel-to  q  normal-)     D_{\mathrm{KL}}(p\|q)   , rather than    H   (  p  ,  q  )       H   p  q     H(p,q)   .  Cross-entropy error function and logistic regression  Cross entropy can be used to define loss function in machine learning and optimization. The true probability    p  i     subscript  p  i    p_{i}   is the true label, and the given distribution    q  i     subscript  q  i    q_{i}   is the predicted value of the current model.  More specifically, let us consider logistic regression , which (in its most basic guise) deals with classifying a given set of data points into two possible classes generically labelled   0   0    and   1   1   1   . The logistic regression model thus predicts an output    y  ‚àà   {  0  ,  1  }       y   0  1     y\in\{0,1\}   , given an input vector   ùê±   ùê±   \mathbf{x}   . The probability is modeled using the logistic function      g   (  z  )    =   1  /   (   1  +   e   -  z     )          g  z     1    1   superscript  e    z        g(z)=1/(1+e^{-z})   . Namely, the probability of finding the output    y  =  1      y  1    y=1   is given by         q   y  =  1     =    y  ^    ‚â°   g   (   ùê∞  ‚ãÖ  ùê±   )     ,         subscript  q    y  1     normal-^  y          g   normal-‚ãÖ  ùê∞  ùê±       q_{y=1}\ =\ \hat{y}\ \equiv\ g(\mathbf{w}\cdot\mathbf{x})\,,   where the vector of weights   ùê∞   ùê∞   \mathbf{w}   is learned through some appropriate algorithm such as gradient descent . Similarly, the conjugate probability of finding the output    y  =  0      y  0    y=0   is simply given by        q   y  =  0     =   1  -   y  ^         subscript  q    y  0      1   normal-^  y      q_{y=0}\ =\ 1-\hat{y}   The true (observed) probabilities can be expressed similarly as     p   y  =  1    =  y       subscript  p    y  1    y    p_{y=1}=y   and     p   y  =  0    =   1  -  y        subscript  p    y  0      1  y     p_{y=0}=1-y   .  Having set up our notation,    p  ‚àà   {  y  ,   1  -  y   }       p   y    1  y      p\in\{y,1-y\}   and    q  ‚àà   {   y  ^   ,   1  -   y  ^    }       q    normal-^  y     1   normal-^  y       q\in\{\hat{y},1-\hat{y}\}   , we can use cross entropy to get a measure for similarity between   p   p   p   and   q   q   q   :       H   (  p  ,  q  )    =   -    ‚àë  i     p  i    log    q  i        =    -   y   log   y  ^      -    (   1  -  y   )    log   (   1  -   y  ^    )              H   p  q        subscript   i      subscript  p  i      subscript  q  i                  y     normal-^  y          1  y       1   normal-^  y          H(p,q)\ =\ -\sum_{i}p_{i}\log q_{i}\ =\ -y\log\hat{y}-(1-y)\log(1-\hat{y})     The typical loss function that one uses in logistic regression is computed by taking the average of all cross-entropies in the sample. For specifically, suppose we have   N   N   N   samples with each sample labeled by    n  =   1  ,  ‚Ä¶  ,  N       n   1  normal-‚Ä¶  N     n=1,\dots,N   . The loss function is then given by:      L   (  ùê∞  )       L  ùê∞    \displaystyle L(\mathbf{w})     where      y  ^   n   ‚â°   g   (   ùê∞  ‚ãÖ   ùê±  n    )         subscript   normal-^  y   n     g   normal-‚ãÖ  ùê∞   subscript  ùê±  n       \hat{y}_{n}\equiv g(\mathbf{w}\cdot\mathbf{x}_{n})   , with    g   (  z  )       g  z    g(z)   the logistic function as before.  The logistic loss is sometimes called cross-entropy loss. It's also known as log loss (In this case, the binary label is often denoted by {-1,+1}). 1  References  De Boer, Pieter-Tjerk, et al. "A tutorial on the cross-entropy method." Annals of operations research 134.1 (2005): 19-67.  See also   Cross-entropy method  Logistic regression  Conditional entropy   External links   What is cross-entropy, and why use it?   "  Category:Entropy and information     ‚Ü©     
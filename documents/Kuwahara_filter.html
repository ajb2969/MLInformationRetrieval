<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="352">Kuwahara filter</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kuwahara filter</h1>
<hr/>

<p>The <strong>Kuwahara filter</strong> is a non-linear smoothing filter used in <a href="image_processing" title="wikilink">image processing</a> for adaptive noise reduction. Most filters that are used for image smoothing are linear <a href="low-pass_filters" title="wikilink">low-pass filters</a> that effectively reduce noise but also blur out the edges. However the Kuwahara filter is able to apply smoothing on the image while preserving the edges.<a href="File:Kuwa_iwias3.jpg" title="wikilink">thumb|upright=1.9|The modified for color images Kuwhara filter effectively reducing noise without blurring the edges.</a></p>
<h2 id="the-kuwahara-operator">The Kuwahara Operator</h2>

<p><a href="File:Kuwahara.jpg" title="wikilink">thumb|upright=0.9|Window used by a Kuwahara filter. It is divided into 4 square regions a,b,c,d with the pixels located on the central row and column belonging to more than one region.</a> Suppose that 

<math display="inline" id="Kuwahara_filter:0">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>I</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I(x,y)
  </annotation>
 </semantics>
</math>

 is a grey scale image and that we take a square window of size 

<math display="inline" id="Kuwahara_filter:1">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>a</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>a</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2a+1
  </annotation>
 </semantics>
</math>

 centered around a point 

<math display="inline" id="Kuwahara_filter:2">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 in the image. This square can be divided in to four smaller square regions 

<math display="inline" id="Kuwahara_filter:3">
 <semantics>
  <msub>
   <mi>Q</mi>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mi mathvariant="normal">⋯</mi>
     <mn>4</mn>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Q</ci>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <ci>normal-⋯</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{i=1\cdots 4}
  </annotation>
 </semantics>
</math>

 each of which will be <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Kuwahara_filter:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Q</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>[</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>a</mi>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mo>×</mo>
        <mrow>
         <mo>[</mo>
         <mi>y</mi>
         <mo>,</mo>
         <mrow>
          <mi>y</mi>
          <mo>+</mo>
          <mi>a</mi>
         </mrow>
         <mo>]</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <mi>a</mi>
         </mrow>
         <mo>,</mo>
         <mi>x</mi>
         <mo>]</mo>
        </mrow>
        <mo>×</mo>
        <mrow>
         <mo>[</mo>
         <mi>y</mi>
         <mo>,</mo>
         <mrow>
          <mi>y</mi>
          <mo>+</mo>
          <mi>a</mi>
         </mrow>
         <mo>]</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <mi>a</mi>
         </mrow>
         <mo>,</mo>
         <mi>x</mi>
         <mo>]</mo>
        </mrow>
        <mo>×</mo>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <mi>a</mi>
         </mrow>
         <mo>,</mo>
         <mi>y</mi>
         <mo>]</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mn>3</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo>[</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mrow>
          <mi>x</mi>
          <mo>+</mo>
          <mi>a</mi>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mo>×</mo>
        <mrow>
         <mo>[</mo>
         <mrow>
          <mi>y</mi>
          <mo>-</mo>
          <mi>a</mi>
         </mrow>
         <mo>,</mo>
         <mi>y</mi>
         <mo>]</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mn>4</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Q</ci>
      <ci>i</ci>
     </apply>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <interval closure="closed">
       <ci>x</ci>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
      </interval>
      <interval closure="closed">
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>y</ci>
        <ci>a</ci>
       </apply>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <interval closure="closed">
       <apply>
        <minus></minus>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
       <ci>x</ci>
      </interval>
      <interval closure="closed">
       <ci>y</ci>
       <apply>
        <plus></plus>
        <ci>y</ci>
        <ci>a</ci>
       </apply>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <interval closure="closed">
       <apply>
        <minus></minus>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
       <ci>x</ci>
      </interval>
      <interval closure="closed">
       <apply>
        <minus></minus>
        <ci>y</ci>
        <ci>a</ci>
       </apply>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <times></times>
      <interval closure="closed">
       <ci>x</ci>
       <apply>
        <plus></plus>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
      </interval>
      <interval closure="closed">
       <apply>
        <minus></minus>
        <ci>y</ci>
        <ci>a</ci>
       </apply>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>i</ci>
      </apply>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{i}(x,y)=\begin{cases}\left[x,x+a\right]\times\left[y,y+a\right]&\mbox{ if }%
i=1\\
\left[x-a,x\right]\times\left[y,y+a\right]&\mbox{ if }i=2\\
\left[x-a,x\right]\times\left[y-a,y\right]&\mbox{ if }i=3\\
\left[x,x+a\right]\times\left[y-a,y\right]&\mbox{ if }i=4\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Kuwahara_filter:5">
 <semantics>
  <mo>×</mo>
  <annotation-xml encoding="MathML-Content">
   <times></times>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \times
  </annotation>
 </semantics>
</math>

 is the <a href="cartesian_product" title="wikilink">cartesian product</a>. It must be noted that pixels located on the borders between two regions belong to both regions so there is a slight overlap between subregions.</p>

<p>The <a href="arithmetic_mean" title="wikilink">arithmetic mean</a> 

<math display="inline" id="Kuwahara_filter:6">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>i</ci>
    </apply>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{i}(x,y)
  </annotation>
 </semantics>
</math>

 and <a href="standard_deviation" title="wikilink">standard deviation</a> 

<math display="inline" id="Kuwahara_filter:7">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>i</ci>
    </apply>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i}(x,y)
  </annotation>
 </semantics>
</math>

 of the four regions centered around a pixel (x,y) are calculated and used to determine the value of the central pixel. The output of the kuwahara filter 

<math display="inline" id="Kuwahara_filter:8">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Φ</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi(x,y)
  </annotation>
 </semantics>
</math>

 for any point 

<math display="inline" id="Kuwahara_filter:9">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 is then given by <a href="File:Example_kuwahara.jpg" title="wikilink">thumb|right|upright=0.5|The behaiviour of the Kuwahara filter for 2 cases.</a></p>

<p>

<math display="inline" id="Kuwahara_filter:10">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>σ</mi>
          <mn>1</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mi>m</mi>
         <mi>i</mi>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
         <mrow></mrow>
         <msub>
          <mi>σ</mi>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>σ</mi>
          <mn>2</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mi>m</mi>
         <mi>i</mi>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
         <mrow></mrow>
         <msub>
          <mi>σ</mi>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>3</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>σ</mi>
          <mn>3</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mi>m</mi>
         <mi>i</mi>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
         <mrow></mrow>
         <msub>
          <mi>σ</mi>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>4</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo>,</mo>
         <mi>y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <msub>
          <mi>σ</mi>
          <mn>4</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
         <mi>m</mi>
         <mi>i</mi>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
         <mrow></mrow>
         <msub>
          <mi>σ</mi>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
       <mtext></mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
       <mtext></mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">3</cn>
      </apply>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">3</cn>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
       <mtext></mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">4</cn>
      </apply>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">4</cn>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
       <mtext></mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi(x,y)=\begin{cases}m_{1}(x,y)&\mbox{ if }\sigma_{1}(x,y)=min_{i}\mbox{ }%
\sigma_{i}(x,y)\\
m_{2}(x,y)&\mbox{ if }\sigma_{2}(x,y)=min_{i}\mbox{ }\sigma_{i}(x,y)\\
m_{3}(x,y)&\mbox{ if }\sigma_{3}(x,y)=min_{i}\mbox{ }\sigma_{i}(x,y)\\
m_{4}(x,y)&\mbox{ if }\sigma_{4}(x,y)=min_{i}\mbox{ }\sigma_{i}(x,y)\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p><a href="File:Kuwahara_varying_window_sizes.jpg" title="wikilink">thumb|upright=0.9|The effect of using a kuwahara filter on an original image(top left) using windows with sides 5,9 and 15 pixels.</a></p>

<p>This means that the central pixel will take the mean value of the area that is most homogenous. The location of the pixel in relation to an edge plays a great role in determining which region will have the greater standard deviation. If for example the pixel is located on a dark side of an edge it will most probably take the mean value of the dark region. On the other hand should the pixel be on the lighter side of an edge it will most probably take a light value. On the event that the pixel is located on the edge it will take the value of the more smooth, least textured region. The fact that the filter takes into account the homogeneity of the regions ensures that it will preserve the edges while using the mean creates the blurring effect.</p>

<p>Similarly to the <a href="Median_filter" title="wikilink">Median filter</a> the Kuwahara filter uses a sliding window approach to access every pixel in the image. The size of the window is chosen in advance and may vary depending on the desired level of blur in the final image. Bigger windows typically result in the creation of more abstract images whereas small windows produce images that retain their detail. Typically windows are chose to be square with sides that have an odd number of pixels for symmetry. However, there are variations of the Kuwahara filter that use rectangular windows. Additionally, the subregions do not need to overlap or have the same size as long as they cover all of the window.</p>
<h2 id="color-images">Color Images</h2>

<p>Obviously the Normal filter can't be used for color images by applying the filter to each RGB channel separately and then using the three resulting channels to compose the image. The main problem with this is that the sub regions will have different variances for each of the channels. For example, a region with the lowest variance in the red channel might have the highest variance in the green channel. This once again causes abiguity which would result in the color of the central pixel to be determined by several regions, which might also result in blurrier edges.</p>

<p>To overcome this problem in colored images a slightly modified Kuwahara filtered must be used. This filter must also take into account the "brightness" (the Value coordinate in the <a href="HSV_color_model" title="wikilink">HSV color model</a>) of each pixel in the region. This time only the variance of the "brightness" of each subregion is calculated along with the mean for each color channel. The filter will produce an output for each channel which will correspond to the mean of that channel for the subregion with the lowest variance in "brightness". This ensures that only one region will determine the <a class="uri" href="RGB" title="wikilink">RGB</a> values of the central pixel.</p>
<h2 id="applications">Applications</h2>

<p> Originally the Kuwahara filter was proposed for use in processing RI-angiocardiographic images of the cardiovascular system.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The fact that any edges are preserved when smoothing makes it especially useful for <a href="feature_extraction" title="wikilink">feature extraction</a> and segmentation and explains why it is used in <a href="medical_imaging" title="wikilink">medical imaging</a>.</p>

<p>The kuwahara filter however also finds many applications in artistic imaging and <a href="fine-art_photography" title="wikilink">fine-art photography</a> due to its ability to remove textures and sharpen the edges of photographs. The level of abstraction helps create a desireble painting-like effect in artistic photographs especially in the case of the colored image version of the filter. These applications have known great success and have encouraged similar research in the field of image processing for the arts.</p>

<p>Although the vast majority of applications have been in the field of image processing there have been cases that use modifications of the Kuwahara filter for machine learning tasks such as clustering.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The Kuwahara filter has been implemented in <a class="uri" href="CVIPtools" title="wikilink">CVIPtools</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="drawbacks-and-restrictions">Drawbacks and restrictions</h2>

<p>The Kuwahara filter despite its capabilities in edge preservation has certain drawbacks.</p>
<ol>
<li>At a first glance it is noticeable that the Kuwahara filter does not take into account the case where two regions have equal standard deviations. This is not often the case in real images since it is rather hard to find two regions with exactly the same standard deviation due to the noise that is always present. In cases where two regions have similar standard deviations the value of the center pixel could be decided at random by the noise in these regions. Again this would not be a problem if the regions had the same mean. However, it is not unusual for regions of very different means to have the same standard deviation. This makes the Kuwahara filter susceptible to noise. Different ways have been proposed for dealing with this issue one of which is to set the value of the center pixel to 

<math display="inline" id="Kuwahara_filter:11">
 <semantics>
  <mfrac>
   <mrow>
    <msub>
     <mi>m</mi>
     <mn>1</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>m</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mn>2</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{m_{1}+m_{2}}{2}
  </annotation>
 </semantics>
</math>

 in cases where the standard deviation of two regions do not differ more than a certain value 

<math display="inline" id="Kuwahara_filter:12">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

.</li>
<li>The Kuwahara filter is also known to create block artifacts in the images especially in regions of the image that are highly textured. These blocks disrupt the smoothness of the image and are considered to have a negative effect in the aesthetics of the image. This phenomenon occurs due to the division of the window into square regions. A way to overcome this effect is to take windows that are not rectangular(i.e. circular windows) and separate them into more non-rectangular regions. There have also been approaches where the filter adapts its window depending on the input image.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></li>
</ol>
<h2 id="extensions-of-the-kuwahara-filter">Extensions of the Kuwahara filter</h2>

<p>The success of the Kuwahara filter has spurred an increase the development of edge-enhancing smoothing filteres. Several variations have been proposed for similar use most of which attempt to deal with the drawbacks of the original Kuwahara filter.</p>

<p>The "Generalized Kuwahara filter" proposed by P. Bakker<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> considers several windows that contain a fixed pixel. Each window is then assigned an estimate and a confidence value. The value of the fixed pixel then takes the value of the estimate of the window with the highest confidence. This filter is not characterized by the same ambiguity in the presence of noise and manages to eliminate the block artifacts.</p>

<p>The "Mean of Least Variance"(MLV) filter, proposed by M.A. Schulze <a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> also produces edge-enhancing smoothing results in images. Similarly to the Kuwahara filter it assumes a window of size 

<math display="inline" id="Kuwahara_filter:13">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>d</mi>
   </mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>×</mo>
     <mn>2</mn>
    </mrow>
    <mi>d</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>d</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>d</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2d-1\times 2d-1
  </annotation>
 </semantics>
</math>

 but instead of searching amongst four subregions of size 

<math display="inline" id="Kuwahara_filter:14">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>×</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\times d
  </annotation>
 </semantics>
</math>

 for the one with minimum variance it searches amongst all possible 

<math display="inline" id="Kuwahara_filter:15">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>×</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\times d
  </annotation>
 </semantics>
</math>

 subregions. This means the central pixel of the window will be assigned the mean of the one subregion out of a possible 

<math display="inline" id="Kuwahara_filter:16">
 <semantics>
  <msup>
   <mi>d</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>d</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{2}
  </annotation>
 </semantics>
</math>

 that has the smallest variance.</p>

<p>A more recent attempt in edge-enhancing smoothing was also proposed by J. E. Kyprianidis.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The filter's output is a weighed sum of the local averages with more weight given the averages of more homogenous regions.</p>
<h2 id="references">References</h2>
<h2 id="bibliography">Bibliography</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.inf.ed.ac.uk/teaching/courses/av/index.html">Advanced Vision homepage</a></li>
<li><a href="http://www.mathworks.com/matlabcentral/fileexchange/15027-faster-kuwahara-filter">Kuwahara matlab code in Mathworks</a></li>
<li><a href="http://www.cse.ust.hk/learning_objects/imageprocessing/kuwahara/kuwahara.html">HKUST's Department of Computer Science and Engineering Kuwahara java applet</a></li>
</ul>

<p>"</p>

<p><a href="Category:Image_processing" title="wikilink">Category:Image processing</a> <a href="Category:Artificial_intelligence" title="wikilink">Category:Artificial intelligence</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4">CVIPtools Developer Site: <a class="uri" href="http://cviptools.ece.siue.edu">http://cviptools.ece.siue.edu</a><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
</ol>
</section>
</body>
</html>

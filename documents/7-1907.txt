   Switched capacitor      Switched capacitor   A switched capacitor is an electronic circuit element used for discrete time  signal processing . It works by moving charges into and out of capacitors when switches are opened and closed. Usually, non-overlapping signals are used to control the switches, so that not all switches are closed simultaneously. Filters implemented with these elements are termed "switched-capacitor filters," and depend only on the ratios between capacitances. This makes them much more suitable for use within integrated circuits , where accurately specified resistors and capacitors are not economical to construct. 1  The switched capacitor resistor  The simplest switched capacitor (SC) circuit is the switched capacitor resistor, made of one capacitor C and two switches S     1     1    {}_{1}   and S     2     2    {}_{2}   which connect the capacitor with a given frequency alternately to the input and output of the SC. Each switching cycle transfers a charge   q   q   q   from the input to the output at the switching frequency   f   f   f   . Recall that the charge q on a capacitor C with a voltage V between the plates is given by:      q  =   C  V       q    C  V     q=CV   where V is the voltage across the capacitor. Therefore, when S     1     1    {}_{1}   is closed while S     2     2    {}_{2}   is open, the charge stored in the capacitor C     S     S    {}_{S}   is:        q  IN   =    C  S    V  IN     .       subscript  q  IN      subscript  C  S    subscript  V  IN      q_{\text{IN}}=C_{S}V_{\text{IN}}.   When S     2     2    {}_{2}   is closed, some of that charge is transferred out of the capacitor, after which the charge that remains in capacitor C     S     S    {}_{S}   is:        q  OUT   =    C  S    V  OUT     .       subscript  q  OUT      subscript  C  S    subscript  V  OUT      q_{\text{OUT}}=C_{S}V_{\text{OUT}}.   Thus, the charge moved out of the capacitor to the output is:      q  =    q  IN   -   q  OUT    =    C  S    (    V  IN   -   V  OUT    )          q     subscript  q  IN    subscript  q  OUT            subscript  C  S      subscript  V  IN    subscript  V  OUT        q=q_{\text{IN}}-q_{\text{OUT}}=C_{S}(V_{\text{IN}}-V_{\text{OUT}})   Because this charge q is transferred at a rate f , the rate of transfer of charge per unit time is:       I  =   q  f    .      I    q  f     I=qf.   Note that we use I , the symbol for electric current, for this quantity. This is to demonstrate that a continuous transfer of charge from one node to another is equivalent to a current. Substituting for q in the above, we have:      I  =    C  S    (    V  IN   -   V  OUT    )   f       I     subscript  C  S      subscript  V  IN    subscript  V  OUT    f     I=C_{S}(V_{\text{IN}}-V_{\text{OUT}})f   Let V be the voltage across the SC from input to output. So:       V  =    V  IN   -   V  OUT     .      V     subscript  V  IN    subscript  V  OUT      V=V_{\text{IN}}-V_{\text{OUT}}.   So the equivalent resistance R (i.e., the voltage–current relationship) is:       R  =   V  I   =   1    C  S   f     .        R    V  I          1     subscript  C  S   f       R={V\over I}={1\over{C_{S}f}}.   Thus, the SC behaves like a resistor whose value depends on capacitance C     S     S    {}_{S}    and switching frequency f .  The SC resistor is used as a replacement for simple resistors in integrated circuits because it is easier to fabricate reliably with a wide range of values. It also has the benefit that its value can be adjusted by changing the switching frequency (i.e., it is a programmable resistance). See also: operational amplifier applications .    q  =   C  V       q    C  V     q=CV   This same circuit can be used in discrete time systems (such as analog to digital converters) as a track and hold circuit. During the appropriate clock phase, the capacitor samples the analog voltage through switch one and in the second phase presents this held sampled value to an electronic circuit for processing.  The Parasitic Sensitive Integrator  Often switched capacitor circuits are used to provide accurate voltage gain and integration by switching a sampled capacitor onto an op-amp with a capacitor    C   f  b      subscript  C    f  b     C_{fb}   in feedback. One of the earliest of these circuits is the parasitic-Sensitive integrator developed by the Czech engineer Bedrich Hosticka. 2 Let us analyze what happens in this case. Denote by    T  =   1  /  f       T    1  f     T=1/f   the switching period. Recall that in capacitors      charge  =   capacitance  ×  voltage       charge    capacitance  voltage     \text{charge}=\text{capacitance}\times\text{voltage}     Then, at the instant when S1 opens and S2 closes, we have the following:  1) Because    C  s     subscript  C  s    C_{s}   has just charged:        Q  s    (  t  )    =     C  s   ⋅   V  s     (  t  )           subscript  Q  s   t      normal-⋅   subscript  C  s    subscript  V  s    t     Q_{s}(t)=C_{s}\cdot V_{s}(t)\,     2) Because the feedback cap,    C   f  b      subscript  C    f  b     C_{fb}   , is suddenly charged with that much charge (by the opamp, which seeks a virtual short circuit between its inputs):        Q   f  b     (  t  )    =     Q  s    (   t  -  T   )    +    Q   f  b     (   t  -  T   )            subscript  Q    f  b    t        subscript  Q  s     t  T       subscript  Q    f  b      t  T       Q_{fb}(t)=Q_{s}(t-T)+Q_{fb}(t-T)\,     Now dividing 2) by    C   f  b      subscript  C    f  b     C_{fb}   :        V   f  b     (  t  )    =      Q  s    (   t  -  T   )     C   f  b     +    V   f  b     (   t  -  T   )            subscript  V    f  b    t          subscript  Q  s     t  T     subscript  C    f  b        subscript  V    f  b      t  T       V_{fb}(t)=\frac{Q_{s}(t-T)}{C_{fb}}+V_{fb}(t-T)\,     And inserting 1):        V   f  b     (  t  )    =       C  s    C   f  b     ⋅   V  s     (   t  -  T   )    +    V   f  b     (   t  -  T   )            subscript  V    f  b    t        normal-⋅     subscript  C  s    subscript  C    f  b      subscript  V  s      t  T       subscript  V    f  b      t  T       V_{fb}(t)=\frac{C_{s}}{C_{fb}}\cdot V_{s}(t-T)+V_{fb}(t-T)\,     This last equation represents what is going on in    C   f  b      subscript  C    f  b     C_{fb}   - it increases (or decreases) its voltage each cycle according to the charge that is being "pumped" from    C  s     subscript  C  s    C_{s}   (due to the op-amp).  However, there is a more elegant way to formulate this fact if   T   T   T   is very short. Let us introduce     d  t   ←  T     normal-←    d  t   T    dt\leftarrow T   and     d   V   f  b     ←     V   f  b     (  t  )    -    V   f  b     (   t  -   d  t    )        normal-←    d   subscript  V    f  b          subscript  V    f  b    t      subscript  V    f  b      t    d  t        dV_{fb}\leftarrow V_{fb}(t)-V_{fb}(t-dt)   and rewrite the last equation divided by dt:        d   V   f  b     (  t  )     d  t    =     f    C  s    C   f  b      ⋅   V  s     (  t  )            d   subscript  V    f  b    t     d  t       normal-⋅    f     subscript  C  s    subscript  C    f  b       subscript  V  s    t     \frac{dV_{fb}(t)}{dt}=f\frac{C_{s}}{C_{fb}}\cdot V_{s}(t)\,     Therefore, the op-amp output voltage takes the form:        V   O  U  T     (  t  )    =   -    V   f  b     (  t  )     =   -    1    1   f   C  s      C   f  b       ∫    V  s    (  t  )   d   t                subscript  V    O  U  T    t        subscript  V    f  b    t               1      1    f   subscript  C  s      subscript  C    f  b           subscript  V  s   t  d  t         V_{OUT}(t)=-V_{fb}(t)=-\frac{1}{\frac{1}{fC_{s}}C_{fb}}\int V_{s}(t)dt\,     Note that this is an integrator with an "equivalent resistance"     R   e  q    =   1   f   C  s          subscript  R    e  q      1    f   subscript  C  s       R_{eq}=\frac{1}{fC_{s}}   . This allows its on-line or runtime adjustment (if we manage to make the switches oscillate according to some signal given by e.g. a microcontroller).  The Parasitic Insensitive Integrator  Use In Discrete-Time Systems  The delaying parasitic insensitive integrator has a wide use in discrete time electronic circuits such as biquad filters, anti-alias structures, and delta sigma data converters. This circuit implements the following z-domain function:       H   (  z  )    =   1   z  -  1          H  z     1    z  1      H(z)=\frac{1}{z-1}     The Multiplying Digital to Analog Converter  One useful characteristic of switched capacitor circuits is that they can be used to perform many circuit tasks at the same time, which is difficult with non-discrete time components. The multiplying digital to analog converter (MDAC) is an example as it can take an analog input, add a digital value to it, and multiply this by some factor based on the capacitor ratios. The output of the MDAC is given by the following:       V   O  u  t    =       V  i   ⋅   (    C  1   +   C  2    )    -    (   d  -  1   )   ⋅   V  r   ⋅   C  2     +    V   o  s    ⋅   (    C  1   +   C  2   +   C  p    )       C  1   +    (    C  1   +   C  2   +   C  p    )   A          subscript  V    O  u  t           normal-⋅   subscript  V  i      subscript  C  1    subscript  C  2      normal-⋅    d  1    subscript  V  r    subscript  C  2      normal-⋅   subscript  V    o  s       subscript  C  1    subscript  C  2    subscript  C  p         subscript  C  1        subscript  C  1    subscript  C  2    subscript  C  p    A       V_{Out}=\frac{V_{i}\cdot(C_{1}+C_{2})-(d-1)\cdot V_{r}\cdot C_{2}+V_{os}\cdot(%
 C_{1}+C_{2}+C_{p})}{C_{1}+\frac{(C_{1}+C_{2}+C_{p})}{A}}     The MDAC is a common component in modern pipeline analog to digital converters as well as other precision analog electronics and was first created in the form above by Stephen Lewis and others at Bell Laboratories. 3  See also   Nyquist–Shannon sampling theorem  Aliasing  Switched-mode power supply  Charge pump   References   Mingliang Liu, Demystifying Switched-Capacitor Circuits , ISBN 0-7506-7907-7   "  Category:Capacitors  Category:Electronic filter applications  Category:Electronic filter topology     Switched Capacitor Circuits , Swarthmore College course notes, accessed 2009-05-02 ↩  B. Hosticka, R. Brodersen, P. Gray, "MOS Sampled Data Recursive Filters. ng Switched Capacitor Integrators," IEEE Journal of Solid State Circuits, Vol SC-12, No.6, December 1977. ↩  Stephen H. Lewis et al., "A 10-bit, 20Msample/s Analog to Digital Converter, IEEE Journal of Solid State Circuits, March 1992 ↩     
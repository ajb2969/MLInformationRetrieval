   Clenshaw algorithm      Clenshaw algorithm   In numerical analysis , the Clenshaw algorithm , 1 also called Clenshaw summation , 2 is a recursive method to evaluate a linear combination of Chebyshev polynomials . It is a generalization of Horner's method for evaluating a linear combination of monomials .  It generalizes to more than just Chebyshev polynomials; it applies to any class of functions that can be defined by a three-term recurrence relation . 3  Clenshaw algorithm  In full generality, the Clenshaw algorithm computes the weighted sum of a finite series of functions     œï  k    (  x  )        subscript  œï  k   x    \phi_{k}(x)   :       S   (  x  )    =    ‚àë   k  =  0   n     a  k    œï  k    (  x  )           S  x     superscript   subscript     k  0    n      subscript  a  k    subscript  œï  k   x      S(x)=\sum_{k=0}^{n}a_{k}\phi_{k}(x)     where       œï  k   ,  k   =  0   ,   1  ,  ‚Ä¶      formulae-sequence      subscript  œï  k   k   0    1  normal-‚Ä¶     \phi_{k},\;k=0,1,\ldots   is a sequence of functions that satisfy the linear recurrence relation         œï   k  +  1     (  x  )    =     Œ±  k    (  x  )    œï  k    (  x  )    +    Œ≤  k    (  x  )    œï   k  -  1     (  x  )      ,         subscript  œï    k  1    x        subscript  Œ±  k   x   subscript  œï  k   x      subscript  Œ≤  k   x   subscript  œï    k  1    x      \phi_{k+1}(x)=\alpha_{k}(x)\,\phi_{k}(x)+\beta_{k}(x)\,\phi_{k-1}(x),     where the coefficients     Œ±  k    (  x  )        subscript  Œ±  k   x    \alpha_{k}(x)   and     Œ≤  k    (  x  )        subscript  Œ≤  k   x    \beta_{k}(x)   are known in advance.  The algorithm is most useful when     œï  k    (  x  )        subscript  œï  k   x    \phi_{k}(x)   are complex functions to compute directly, but     Œ±  k    (  x  )        subscript  Œ±  k   x    \alpha_{k}(x)   and     Œ≤  k    (  x  )        subscript  Œ≤  k   x    \beta_{k}(x)   are particularly simple. In the most common applications,    Œ±   (  x  )       Œ±  x    \alpha(x)   does not depend on   k   k   k   , and   Œ≤   Œ≤   \beta   is a constant that depends on neither   x   x   x   nor   k   k   k   .  To perform the summation for given series of coefficients     a  0   ,  ‚Ä¶  ,   a  n       subscript  a  0   normal-‚Ä¶   subscript  a  n     a_{0},\ldots,a_{n}   , compute the values     b  k    (  x  )        subscript  b  k   x    b_{k}(x)   by the "reverse" recurrence formula:       b   n  +  1     (  x  )        subscript  b    n  1    x    \displaystyle b_{n+1}(x)     Note that this computation makes no direct reference to the functions     œï  k    (  x  )        subscript  œï  k   x    \phi_{k}(x)   . After computing     b  2    (  x  )        subscript  b  2   x    b_{2}(x)   and     b  1    (  x  )        subscript  b  1   x    b_{1}(x)   , the desired sum can be expressed in terms of them and the simplest functions     œï  0    (  x  )        subscript  œï  0   x    \phi_{0}(x)   and     œï  1    (  x  )        subscript  œï  1   x    \phi_{1}(x)   :        S   (  x  )    =     œï  0    (  x  )    a  0    +    œï  1    (  x  )    b  1    (  x  )    +    Œ≤  1    (  x  )    œï  0    (  x  )    b  2    (  x  )      .        S  x        subscript  œï  0   x   subscript  a  0       subscript  œï  1   x   subscript  b  1   x      subscript  Œ≤  1   x   subscript  œï  0   x   subscript  b  2   x      S(x)=\phi_{0}(x)\,a_{0}+\phi_{1}(x)\,b_{1}(x)+\beta_{1}(x)\,\phi_{0}(x)\,b_{2}%
 (x).     See Fox and Parker 4 for more information and stability analyses.  Examples  Horner as a special case of Clenshaw  A particularly simple case occurs when evaluating a polynomial of the form       S   (  x  )    =    ‚àë   k  =  0   n     a  k    x  k           S  x     superscript   subscript     k  0    n      subscript  a  k    superscript  x  k       S(x)=\sum_{k=0}^{n}a_{k}x^{k}   . The functions are simply       œï  0    (  x  )        subscript  œï  0   x    \displaystyle\phi_{0}(x)   and are produced by the recurrence coefficients     Œ±   (  x  )    =  x        Œ±  x   x    \alpha(x)=x   and    Œ≤  =  0      Œ≤  0    \beta=0   .  In this case, the recurrence formula to compute the sum is        b  k    (  x  )    =    a  k   +   x   b   k  +  1     (  x  )            subscript  b  k   x      subscript  a  k     x   subscript  b    k  1    x      b_{k}(x)=a_{k}+xb_{k+1}(x)   and, in this case, the sum is simply       S   (  x  )    =    a  0   +   x   b  1    (  x  )     =    b  0    (  x  )            S  x      subscript  a  0     x   subscript  b  1   x            subscript  b  0   x      S(x)=a_{0}+xb_{1}(x)=b_{0}(x)   , which is exactly the usual Horner's method .  Special case for Chebyshev series  Consider a truncated Chebyshev series         p  n    (  x  )    =    a  0   +    a  1    T  1    (  x  )    +    a  2    T  2    (  x  )    +  ‚ãØ  +    a  n    T  n    (  x  )      .         subscript  p  n   x      subscript  a  0      subscript  a  1    subscript  T  1   x      subscript  a  2    subscript  T  2   x   normal-‚ãØ     subscript  a  n    subscript  T  n   x      p_{n}(x)=a_{0}+a_{1}T_{1}(x)+a_{2}T_{2}(x)+\cdots+a_{n}T_{n}(x).     The coefficients in the recursion relation for the Chebyshev polynomials are         Œ±   (  x  )    =   2  x    ,   Œ≤  =   -  1     ,     formulae-sequence      Œ±  x     2  x      Œ≤    1      \alpha(x)=2x,\quad\beta=-1,   with the initial conditions          T  0    (  x  )    =  1   ,     T  1    (  x  )    =  x    .     formulae-sequence       subscript  T  0   x   1        subscript  T  1   x   x     T_{0}(x)=1,\quad T_{1}(x)=x.     Thus, the recurrence is        b  k    (  x  )    =     a  k   +   2  x   b   k  +  1     (  x  )     -    b   k  +  2     (  x  )            subscript  b  k   x        subscript  a  k     2  x   subscript  b    k  1    x       subscript  b    k  2    x      b_{k}(x)=a_{k}+2xb_{k+1}(x)-b_{k+2}(x)   and the final sum is         p  n    (  x  )    =     a  0   +   x   b  1    (  x  )     -    b  2    (  x  )      .         subscript  p  n   x        subscript  a  0     x   subscript  b  1   x       subscript  b  2   x      p_{n}(x)=a_{0}+xb_{1}(x)-b_{2}(x).     One way to evaluate this is to continue the recurrence one more step, and compute         b  0    (  x  )    =     2   a  0    +   2  x   b  1    (  x  )     -    b  2    (  x  )      ,         subscript  b  0   x         2   subscript  a  0      2  x   subscript  b  1   x       subscript  b  2   x      b_{0}(x)=2a_{0}+2xb_{1}(x)-b_{2}(x),   (note the doubled a 0 coefficient) followed by         p  n    (  x  )    =    1  2    [     b  0    (  x  )    -    b  2    (  x  )     ]     .         subscript  p  n   x       1  2    delimited-[]       subscript  b  0   x      subscript  b  2   x        p_{n}(x)=\frac{1}{2}\left[b_{0}(x)-b_{2}(x)\right].     Meridian arc length on the ellipsoid  Clenshaw summation is extensively used in geodetic applications. 5 A simple application is summing the trigonometric series to compute the meridian arc distance on the surface of an ellipsoid. These have the form        m   (  Œ∏  )    =      C  0    Œ∏   +    C  1    sin  Œ∏    +    C  2    sin   2  Œ∏     +  ‚ãØ  +    C  n    sin   n  Œ∏       .        m  Œ∏        subscript  C  0   Œ∏      subscript  C  1     Œ∏       subscript  C  2       2  Œ∏     normal-‚ãØ     subscript  C  n       n  Œ∏        m(\theta)=C_{0}\,\theta+C_{1}\sin\theta+C_{2}\sin 2\theta+\cdots+C_{n}\sin n\theta.     Leaving off the initial      C  0    Œ∏       subscript  C  0   Œ∏    C_{0}\,\theta   term, the remainder is a summation of the appropriate form. There is no leading term because      œï  0    (  Œ∏  )    =   sin   0  Œ∏    =   sin  0   =  0           subscript  œï  0   Œ∏       0  Œ∏           0        0     \phi_{0}(\theta)=\sin 0\theta=\sin 0=0   .  The recurrence relation for    sin   k  Œ∏         k  Œ∏     \sin k\theta    is        sin   (   k  +  1   )    Œ∏   =    2   cos  Œ∏    sin   k  Œ∏     -    sin   (   k  -  1   )    Œ∏              k  1    Œ∏       2    Œ∏       k  Œ∏           k  1    Œ∏      \sin(k+1)\theta=2\cos\theta\sin k\theta-\sin(k-1)\theta   ,  making the coefficients in the recursion relation         Œ±  k    (  Œ∏  )    =   2   cos  Œ∏     ,    Œ≤  k   =   -  1.       formulae-sequence       subscript  Œ±  k   Œ∏     2    Œ∏        subscript  Œ≤  k     1.      \alpha_{k}(\theta)=2\cos\theta,\quad\beta_{k}=-1.     and the evaluation of the series is given by       b   n  +  1     (  Œ∏  )        subscript  b    n  1    Œ∏    \displaystyle b_{n+1}(\theta)   The final step is made particularly simple because      œï  0    (  Œ∏  )    =   sin  0   =  0           subscript  œï  0   Œ∏     0        0     \phi_{0}(\theta)=\sin 0=0   , so the end of the recurrence is simply     b  1    (  Œ∏  )    sin   (  Œ∏  )         subscript  b  1   Œ∏    Œ∏     b_{1}(\theta)\sin(\theta)   ; the      C  0    Œ∏       subscript  C  0   Œ∏    C_{0}\,\theta   term is added separately:        m   (  Œ∏  )    =      C  0    Œ∏   +    b  1    (  Œ∏  )    sin  Œ∏      .        m  Œ∏        subscript  C  0   Œ∏      subscript  b  1   Œ∏    Œ∏       m(\theta)=C_{0}\,\theta+b_{1}(\theta)\sin\theta.     Note that the algorithm requires only the evaluation of two trigonometric quantities    cos  Œ∏      Œ∏    \cos\theta   and    sin  Œ∏      Œ∏    \sin\theta   .  Difference in meridian arc lengths  Sometimes it necessary to compute the difference of two meridian arcs in a way that maintains high relative accuracy. This is accomplished by using trigonometric identities to write         m   (   Œ∏  1   )    -   m   (   Œ∏  2   )     =    ‚àë   k  =  1   n    2   C  k    sin   (     1  2    k   (    Œ∏  1   -   Œ∏  2    )    )     cos   (     1  2    k   (    Œ∏  1   +   Œ∏  2    )    )       .          m   subscript  Œ∏  1      m   subscript  Œ∏  2       superscript   subscript     k  1    n     2   subscript  C  k         1  2   k     subscript  Œ∏  1    subscript  Œ∏  2            1  2   k     subscript  Œ∏  1    subscript  Œ∏  2          m(\theta_{1})-m(\theta_{2})=\sum_{k=1}^{n}2C_{k}\sin\bigl({\textstyle\frac{1}{%
 2}}k(\theta_{1}-\theta_{2})\bigr)\cos\bigl({\textstyle\frac{1}{2}}k(\theta_{1}%
 +\theta_{2})\bigr).   Clenshaw summation can be applied in this case 6 provided we simultaneously compute     m   (   Œ∏  1   )    +   m   (   Œ∏  2   )          m   subscript  Œ∏  1      m   subscript  Œ∏  2      m(\theta_{1})+m(\theta_{2})   and perform a matrix summation,        ùñ¨   (   Œ∏  1   ,   Œ∏  2   )    =   [       (    m   (   Œ∏  1   )    +   m   (   Œ∏  2   )     )   /  2         (    m   (   Œ∏  1   )    -   m   (   Œ∏  2   )     )   /   (    Œ∏  1   -   Œ∏  2    )       ]   =     C  0    [     Œº      1     ]    +    ‚àë   k  =  1   n     C  k    ùñ•  k    (   Œ∏  1   ,   Œ∏  2   )       ,          ùñ¨    subscript  Œ∏  1    subscript  Œ∏  2             m   subscript  Œ∏  1      m   subscript  Œ∏  2     2           m   subscript  Œ∏  1      m   subscript  Œ∏  2        subscript  Œ∏  1    subscript  Œ∏  2                 subscript  C  0     Œº    1       superscript   subscript     k  1    n      subscript  C  k    subscript  ùñ•  k     subscript  Œ∏  1    subscript  Œ∏  2          \mathsf{M}(\theta_{1},\theta_{2})=\begin{bmatrix}(m(\theta_{1})+m(\theta_{2}))%
 /2\\
 (m(\theta_{1})-m(\theta_{2}))/(\theta_{1}-\theta_{2})\end{bmatrix}=C_{0}\begin%
 {bmatrix}\mu\\
 1\end{bmatrix}+\sum_{k=1}^{n}C_{k}\mathsf{F}_{k}(\theta_{1},\theta_{2}),   where     Œ¥   Œ¥   \displaystyle\delta   The first element of    ùñ¨   (   Œ∏  1   ,   Œ∏  2   )       ùñ¨    subscript  Œ∏  1    subscript  Œ∏  2      \mathsf{M}(\theta_{1},\theta_{2})   is the average value of   m   m   m   and the second element is the average slope.     ùñ•  k    (   Œ∏  1   ,   Œ∏  2   )        subscript  ùñ•  k     subscript  Œ∏  1    subscript  Œ∏  2      \mathsf{F}_{k}(\theta_{1},\theta_{2})   satisfies the recurrence relation         ùñ•   k  +  1     (   Œ∏  1   ,   Œ∏  2   )    =    ùñ†   (   Œ∏  1   ,   Œ∏  2   )    ùñ•  k    (   Œ∏  1   ,   Œ∏  2   )    -    ùñ•   k  -  1     (   Œ∏  1   ,   Œ∏  2   )      ,         subscript  ùñ•    k  1      subscript  Œ∏  1    subscript  Œ∏  2         ùñ†    subscript  Œ∏  1    subscript  Œ∏  2     subscript  ùñ•  k     subscript  Œ∏  1    subscript  Œ∏  2        subscript  ùñ•    k  1      subscript  Œ∏  1    subscript  Œ∏  2        \mathsf{F}_{k+1}(\theta_{1},\theta_{2})=\mathsf{A}(\theta_{1},\theta_{2})%
 \mathsf{F}_{k}(\theta_{1},\theta_{2})-\mathsf{F}_{k-1}(\theta_{1},\theta_{2}),   where       ùñ†   (   Œ∏  1   ,   Œ∏  2   )    =   2   [       cos  Œ¥    cos  Œº       -   Œ¥   sin  Œ¥    sin  Œº          -     sin  Œ¥   Œ¥    sin  Œº         cos  Œ¥    cos  Œº       ]          ùñ†    subscript  Œ∏  1    subscript  Œ∏  2       2        Œ¥     Œº        Œ¥    Œ¥     Œº               Œ¥   Œ¥     Œº         Œ¥     Œº         \mathsf{A}(\theta_{1},\theta_{2})=2\begin{bmatrix}\cos\delta\cos\mu&-\delta%
 \sin\delta\sin\mu\\
 -\displaystyle\frac{\sin\delta}{\delta}\sin\mu&\cos\delta\cos\mu\end{bmatrix}   takes the place of   Œ±   Œ±   \alpha   in the recurrence relation, and    Œ≤  =   -  1       Œ≤    1     \beta=-1   . The standard Clenshaw algorithm can now be applied to yield      ùñ°   n  +  1      subscript  ùñ°    n  1     \displaystyle\mathsf{B}_{n+1}   where    ùñ°  k     subscript  ùñ°  k    \mathsf{B}_{k}   are 2√ó2 matrices. Finally we have          m   (   Œ∏  1   )    -   m   (   Œ∏  2   )       Œ∏  1   -   Œ∏  2     =    ùñ¨  2    (   Œ∏  1   ,   Œ∏  2   )     .            m   subscript  Œ∏  1      m   subscript  Œ∏  2        subscript  Œ∏  1    subscript  Œ∏  2        subscript  ùñ¨  2     subscript  Œ∏  1    subscript  Œ∏  2       \frac{m(\theta_{1})-m(\theta_{2})}{\theta_{1}-\theta_{2}}=\mathsf{M}_{2}(%
 \theta_{1},\theta_{2}).   This technique can be used in the limit      Œ∏  2   =   Œ∏  1   =  Œº         subscript  Œ∏  2    subscript  Œ∏  1        Œº     \theta_{2}=\theta_{1}=\mu   and    Œ¥  =   0       Œ¥  0    \delta=0\,   to compute the derivative       d  m   (  Œº  )    /  d   Œº          d  m  Œº   d   Œº    dm(\mu)/d\mu   , provided that, in evaluating    ùñ•  1     subscript  ùñ•  1    \mathsf{F}_{1}   and   ùñ†   ùñ†   \mathsf{A}   , we take      lim   Œ¥  ‚Üí  0      (   sin  Œ¥   )   /  Œ¥    =  1        subscript    normal-‚Üí  Œ¥  0        Œ¥   Œ¥    1    \lim_{\delta\rightarrow 0}(\sin\delta)/\delta=1   .  See also   Horner scheme to evaluate polynomials in monomial form  De Casteljau's algorithm to evaluate polynomials in B√©zier form   References    "  Category:Numerical analysis     Note that this paper is written in terms of the Shifted Chebyshev polynomials of the first kind      T  n  *    (  x  )    =    T  n    (    2  x   -  1   )           subscript   superscript  T    n   x      subscript  T  n       2  x   1      T^{*}_{n}(x)=T_{n}(2x-1)   . ‚Ü©   ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©     
   Clenshaw algorithm      Clenshaw algorithm   In numerical analysis , the Clenshaw algorithm , 1 also called Clenshaw summation , 2 is a recursive method to evaluate a linear combination of Chebyshev polynomials . It is a generalization of Horner's method for evaluating a linear combination of monomials .  It generalizes to more than just Chebyshev polynomials; it applies to any class of functions that can be defined by a three-term recurrence relation . 3  Clenshaw algorithm  In full generality, the Clenshaw algorithm computes the weighted sum of a finite series of functions     ϕ  k    (  x  )        subscript  ϕ  k   x    \phi_{k}(x)   :       S   (  x  )    =    ∑   k  =  0   n     a  k    ϕ  k    (  x  )           S  x     superscript   subscript     k  0    n      subscript  a  k    subscript  ϕ  k   x      S(x)=\sum_{k=0}^{n}a_{k}\phi_{k}(x)     where       ϕ  k   ,  k   =  0   ,   1  ,  …      formulae-sequence      subscript  ϕ  k   k   0    1  normal-…     \phi_{k},\;k=0,1,\ldots   is a sequence of functions that satisfy the linear recurrence relation         ϕ   k  +  1     (  x  )    =     α  k    (  x  )    ϕ  k    (  x  )    +    β  k    (  x  )    ϕ   k  -  1     (  x  )      ,         subscript  ϕ    k  1    x        subscript  α  k   x   subscript  ϕ  k   x      subscript  β  k   x   subscript  ϕ    k  1    x      \phi_{k+1}(x)=\alpha_{k}(x)\,\phi_{k}(x)+\beta_{k}(x)\,\phi_{k-1}(x),     where the coefficients     α  k    (  x  )        subscript  α  k   x    \alpha_{k}(x)   and     β  k    (  x  )        subscript  β  k   x    \beta_{k}(x)   are known in advance.  The algorithm is most useful when     ϕ  k    (  x  )        subscript  ϕ  k   x    \phi_{k}(x)   are complex functions to compute directly, but     α  k    (  x  )        subscript  α  k   x    \alpha_{k}(x)   and     β  k    (  x  )        subscript  β  k   x    \beta_{k}(x)   are particularly simple. In the most common applications,    α   (  x  )       α  x    \alpha(x)   does not depend on   k   k   k   , and   β   β   \beta   is a constant that depends on neither   x   x   x   nor   k   k   k   .  To perform the summation for given series of coefficients     a  0   ,  …  ,   a  n       subscript  a  0   normal-…   subscript  a  n     a_{0},\ldots,a_{n}   , compute the values     b  k    (  x  )        subscript  b  k   x    b_{k}(x)   by the "reverse" recurrence formula:       b   n  +  1     (  x  )        subscript  b    n  1    x    \displaystyle b_{n+1}(x)     Note that this computation makes no direct reference to the functions     ϕ  k    (  x  )        subscript  ϕ  k   x    \phi_{k}(x)   . After computing     b  2    (  x  )        subscript  b  2   x    b_{2}(x)   and     b  1    (  x  )        subscript  b  1   x    b_{1}(x)   , the desired sum can be expressed in terms of them and the simplest functions     ϕ  0    (  x  )        subscript  ϕ  0   x    \phi_{0}(x)   and     ϕ  1    (  x  )        subscript  ϕ  1   x    \phi_{1}(x)   :        S   (  x  )    =     ϕ  0    (  x  )    a  0    +    ϕ  1    (  x  )    b  1    (  x  )    +    β  1    (  x  )    ϕ  0    (  x  )    b  2    (  x  )      .        S  x        subscript  ϕ  0   x   subscript  a  0       subscript  ϕ  1   x   subscript  b  1   x      subscript  β  1   x   subscript  ϕ  0   x   subscript  b  2   x      S(x)=\phi_{0}(x)\,a_{0}+\phi_{1}(x)\,b_{1}(x)+\beta_{1}(x)\,\phi_{0}(x)\,b_{2}%
 (x).     See Fox and Parker 4 for more information and stability analyses.  Examples  Horner as a special case of Clenshaw  A particularly simple case occurs when evaluating a polynomial of the form       S   (  x  )    =    ∑   k  =  0   n     a  k    x  k           S  x     superscript   subscript     k  0    n      subscript  a  k    superscript  x  k       S(x)=\sum_{k=0}^{n}a_{k}x^{k}   . The functions are simply       ϕ  0    (  x  )        subscript  ϕ  0   x    \displaystyle\phi_{0}(x)   and are produced by the recurrence coefficients     α   (  x  )    =  x        α  x   x    \alpha(x)=x   and    β  =  0      β  0    \beta=0   .  In this case, the recurrence formula to compute the sum is        b  k    (  x  )    =    a  k   +   x   b   k  +  1     (  x  )            subscript  b  k   x      subscript  a  k     x   subscript  b    k  1    x      b_{k}(x)=a_{k}+xb_{k+1}(x)   and, in this case, the sum is simply       S   (  x  )    =    a  0   +   x   b  1    (  x  )     =    b  0    (  x  )            S  x      subscript  a  0     x   subscript  b  1   x            subscript  b  0   x      S(x)=a_{0}+xb_{1}(x)=b_{0}(x)   , which is exactly the usual Horner's method .  Special case for Chebyshev series  Consider a truncated Chebyshev series         p  n    (  x  )    =    a  0   +    a  1    T  1    (  x  )    +    a  2    T  2    (  x  )    +  ⋯  +    a  n    T  n    (  x  )      .         subscript  p  n   x      subscript  a  0      subscript  a  1    subscript  T  1   x      subscript  a  2    subscript  T  2   x   normal-⋯     subscript  a  n    subscript  T  n   x      p_{n}(x)=a_{0}+a_{1}T_{1}(x)+a_{2}T_{2}(x)+\cdots+a_{n}T_{n}(x).     The coefficients in the recursion relation for the Chebyshev polynomials are         α   (  x  )    =   2  x    ,   β  =   -  1     ,     formulae-sequence      α  x     2  x      β    1      \alpha(x)=2x,\quad\beta=-1,   with the initial conditions          T  0    (  x  )    =  1   ,     T  1    (  x  )    =  x    .     formulae-sequence       subscript  T  0   x   1        subscript  T  1   x   x     T_{0}(x)=1,\quad T_{1}(x)=x.     Thus, the recurrence is        b  k    (  x  )    =     a  k   +   2  x   b   k  +  1     (  x  )     -    b   k  +  2     (  x  )            subscript  b  k   x        subscript  a  k     2  x   subscript  b    k  1    x       subscript  b    k  2    x      b_{k}(x)=a_{k}+2xb_{k+1}(x)-b_{k+2}(x)   and the final sum is         p  n    (  x  )    =     a  0   +   x   b  1    (  x  )     -    b  2    (  x  )      .         subscript  p  n   x        subscript  a  0     x   subscript  b  1   x       subscript  b  2   x      p_{n}(x)=a_{0}+xb_{1}(x)-b_{2}(x).     One way to evaluate this is to continue the recurrence one more step, and compute         b  0    (  x  )    =     2   a  0    +   2  x   b  1    (  x  )     -    b  2    (  x  )      ,         subscript  b  0   x         2   subscript  a  0      2  x   subscript  b  1   x       subscript  b  2   x      b_{0}(x)=2a_{0}+2xb_{1}(x)-b_{2}(x),   (note the doubled a 0 coefficient) followed by         p  n    (  x  )    =    1  2    [     b  0    (  x  )    -    b  2    (  x  )     ]     .         subscript  p  n   x       1  2    delimited-[]       subscript  b  0   x      subscript  b  2   x        p_{n}(x)=\frac{1}{2}\left[b_{0}(x)-b_{2}(x)\right].     Meridian arc length on the ellipsoid  Clenshaw summation is extensively used in geodetic applications. 5 A simple application is summing the trigonometric series to compute the meridian arc distance on the surface of an ellipsoid. These have the form        m   (  θ  )    =      C  0    θ   +    C  1    sin  θ    +    C  2    sin   2  θ     +  ⋯  +    C  n    sin   n  θ       .        m  θ        subscript  C  0   θ      subscript  C  1     θ       subscript  C  2       2  θ     normal-⋯     subscript  C  n       n  θ        m(\theta)=C_{0}\,\theta+C_{1}\sin\theta+C_{2}\sin 2\theta+\cdots+C_{n}\sin n\theta.     Leaving off the initial      C  0    θ       subscript  C  0   θ    C_{0}\,\theta   term, the remainder is a summation of the appropriate form. There is no leading term because      ϕ  0    (  θ  )    =   sin   0  θ    =   sin  0   =  0           subscript  ϕ  0   θ       0  θ           0        0     \phi_{0}(\theta)=\sin 0\theta=\sin 0=0   .  The recurrence relation for    sin   k  θ         k  θ     \sin k\theta    is        sin   (   k  +  1   )    θ   =    2   cos  θ    sin   k  θ     -    sin   (   k  -  1   )    θ              k  1    θ       2    θ       k  θ           k  1    θ      \sin(k+1)\theta=2\cos\theta\sin k\theta-\sin(k-1)\theta   ,  making the coefficients in the recursion relation         α  k    (  θ  )    =   2   cos  θ     ,    β  k   =   -  1.       formulae-sequence       subscript  α  k   θ     2    θ        subscript  β  k     1.      \alpha_{k}(\theta)=2\cos\theta,\quad\beta_{k}=-1.     and the evaluation of the series is given by       b   n  +  1     (  θ  )        subscript  b    n  1    θ    \displaystyle b_{n+1}(\theta)   The final step is made particularly simple because      ϕ  0    (  θ  )    =   sin  0   =  0           subscript  ϕ  0   θ     0        0     \phi_{0}(\theta)=\sin 0=0   , so the end of the recurrence is simply     b  1    (  θ  )    sin   (  θ  )         subscript  b  1   θ    θ     b_{1}(\theta)\sin(\theta)   ; the      C  0    θ       subscript  C  0   θ    C_{0}\,\theta   term is added separately:        m   (  θ  )    =      C  0    θ   +    b  1    (  θ  )    sin  θ      .        m  θ        subscript  C  0   θ      subscript  b  1   θ    θ       m(\theta)=C_{0}\,\theta+b_{1}(\theta)\sin\theta.     Note that the algorithm requires only the evaluation of two trigonometric quantities    cos  θ      θ    \cos\theta   and    sin  θ      θ    \sin\theta   .  Difference in meridian arc lengths  Sometimes it necessary to compute the difference of two meridian arcs in a way that maintains high relative accuracy. This is accomplished by using trigonometric identities to write         m   (   θ  1   )    -   m   (   θ  2   )     =    ∑   k  =  1   n    2   C  k    sin   (     1  2    k   (    θ  1   -   θ  2    )    )     cos   (     1  2    k   (    θ  1   +   θ  2    )    )       .          m   subscript  θ  1      m   subscript  θ  2       superscript   subscript     k  1    n     2   subscript  C  k         1  2   k     subscript  θ  1    subscript  θ  2            1  2   k     subscript  θ  1    subscript  θ  2          m(\theta_{1})-m(\theta_{2})=\sum_{k=1}^{n}2C_{k}\sin\bigl({\textstyle\frac{1}{%
 2}}k(\theta_{1}-\theta_{2})\bigr)\cos\bigl({\textstyle\frac{1}{2}}k(\theta_{1}%
 +\theta_{2})\bigr).   Clenshaw summation can be applied in this case 6 provided we simultaneously compute     m   (   θ  1   )    +   m   (   θ  2   )          m   subscript  θ  1      m   subscript  θ  2      m(\theta_{1})+m(\theta_{2})   and perform a matrix summation,        𝖬   (   θ  1   ,   θ  2   )    =   [       (    m   (   θ  1   )    +   m   (   θ  2   )     )   /  2         (    m   (   θ  1   )    -   m   (   θ  2   )     )   /   (    θ  1   -   θ  2    )       ]   =     C  0    [     μ      1     ]    +    ∑   k  =  1   n     C  k    𝖥  k    (   θ  1   ,   θ  2   )       ,          𝖬    subscript  θ  1    subscript  θ  2             m   subscript  θ  1      m   subscript  θ  2     2           m   subscript  θ  1      m   subscript  θ  2        subscript  θ  1    subscript  θ  2                 subscript  C  0     μ    1       superscript   subscript     k  1    n      subscript  C  k    subscript  𝖥  k     subscript  θ  1    subscript  θ  2          \mathsf{M}(\theta_{1},\theta_{2})=\begin{bmatrix}(m(\theta_{1})+m(\theta_{2}))%
 /2\\
 (m(\theta_{1})-m(\theta_{2}))/(\theta_{1}-\theta_{2})\end{bmatrix}=C_{0}\begin%
 {bmatrix}\mu\\
 1\end{bmatrix}+\sum_{k=1}^{n}C_{k}\mathsf{F}_{k}(\theta_{1},\theta_{2}),   where     δ   δ   \displaystyle\delta   The first element of    𝖬   (   θ  1   ,   θ  2   )       𝖬    subscript  θ  1    subscript  θ  2      \mathsf{M}(\theta_{1},\theta_{2})   is the average value of   m   m   m   and the second element is the average slope.     𝖥  k    (   θ  1   ,   θ  2   )        subscript  𝖥  k     subscript  θ  1    subscript  θ  2      \mathsf{F}_{k}(\theta_{1},\theta_{2})   satisfies the recurrence relation         𝖥   k  +  1     (   θ  1   ,   θ  2   )    =    𝖠   (   θ  1   ,   θ  2   )    𝖥  k    (   θ  1   ,   θ  2   )    -    𝖥   k  -  1     (   θ  1   ,   θ  2   )      ,         subscript  𝖥    k  1      subscript  θ  1    subscript  θ  2         𝖠    subscript  θ  1    subscript  θ  2     subscript  𝖥  k     subscript  θ  1    subscript  θ  2        subscript  𝖥    k  1      subscript  θ  1    subscript  θ  2        \mathsf{F}_{k+1}(\theta_{1},\theta_{2})=\mathsf{A}(\theta_{1},\theta_{2})%
 \mathsf{F}_{k}(\theta_{1},\theta_{2})-\mathsf{F}_{k-1}(\theta_{1},\theta_{2}),   where       𝖠   (   θ  1   ,   θ  2   )    =   2   [       cos  δ    cos  μ       -   δ   sin  δ    sin  μ          -     sin  δ   δ    sin  μ         cos  δ    cos  μ       ]          𝖠    subscript  θ  1    subscript  θ  2       2        δ     μ        δ    δ     μ               δ   δ     μ         δ     μ         \mathsf{A}(\theta_{1},\theta_{2})=2\begin{bmatrix}\cos\delta\cos\mu&-\delta%
 \sin\delta\sin\mu\\
 -\displaystyle\frac{\sin\delta}{\delta}\sin\mu&\cos\delta\cos\mu\end{bmatrix}   takes the place of   α   α   \alpha   in the recurrence relation, and    β  =   -  1       β    1     \beta=-1   . The standard Clenshaw algorithm can now be applied to yield      𝖡   n  +  1      subscript  𝖡    n  1     \displaystyle\mathsf{B}_{n+1}   where    𝖡  k     subscript  𝖡  k    \mathsf{B}_{k}   are 2×2 matrices. Finally we have          m   (   θ  1   )    -   m   (   θ  2   )       θ  1   -   θ  2     =    𝖬  2    (   θ  1   ,   θ  2   )     .            m   subscript  θ  1      m   subscript  θ  2        subscript  θ  1    subscript  θ  2        subscript  𝖬  2     subscript  θ  1    subscript  θ  2       \frac{m(\theta_{1})-m(\theta_{2})}{\theta_{1}-\theta_{2}}=\mathsf{M}_{2}(%
 \theta_{1},\theta_{2}).   This technique can be used in the limit      θ  2   =   θ  1   =  μ         subscript  θ  2    subscript  θ  1        μ     \theta_{2}=\theta_{1}=\mu   and    δ  =   0       δ  0    \delta=0\,   to compute the derivative       d  m   (  μ  )    /  d   μ          d  m  μ   d   μ    dm(\mu)/d\mu   , provided that, in evaluating    𝖥  1     subscript  𝖥  1    \mathsf{F}_{1}   and   𝖠   𝖠   \mathsf{A}   , we take      lim   δ  →  0      (   sin  δ   )   /  δ    =  1        subscript    normal-→  δ  0        δ   δ    1    \lim_{\delta\rightarrow 0}(\sin\delta)/\delta=1   .  See also   Horner scheme to evaluate polynomials in monomial form  De Casteljau's algorithm to evaluate polynomials in Bézier form   References    "  Category:Numerical analysis     Note that this paper is written in terms of the Shifted Chebyshev polynomials of the first kind      T  n  *    (  x  )    =    T  n    (    2  x   -  1   )           subscript   superscript  T    n   x      subscript  T  n       2  x   1      T^{*}_{n}(x)=T_{n}(2x-1)   . ↩   ↩  ↩  ↩  ↩     
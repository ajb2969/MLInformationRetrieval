<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1626">Frobenius normal form</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Frobenius normal form</h1>
<hr>In [[li
<p>near algebra]], the <strong>Frobenius normal form</strong> or <strong>rational canonical form</strong> of a <a href="square_matrix" title="wikilink">square matrix</a> <em>A</em> with entries in a <a href="field_(mathematics)" title="wikilink">field</a> <em>F</em> is a <a href="canonical_form" title="wikilink">canonical form</a> for <a href="Matrix_(mathematics)" title="wikilink">matrices</a> obtained by conjugation by invertible matrices over <em>F</em>. The form reflects a minimal decomposition of the vector space into subspaces that are cyclic for <em>A</em> (i.e., spanned by some vector and its repeated images under <em>A</em>). Since only one normal form can be reached from a given matrix (whence the "canonical"), a matrix <em>B</em> is <a href="similar_(linear_algebra)" title="wikilink">similar</a> to <em>A</em> if and only if it has the same rational canonical form as <em>A</em>. Since this form can be found without any operations that might change when <a href="field_extension" title="wikilink">extending</a> the field <em>F</em> (whence the "rational"), notably without factoring polynomials, this shows that whether two matrices are similar does not change upon field extensions. The form is named after German mathematician <a href="Ferdinand_Georg_Frobenius" title="wikilink">Ferdinand Georg Frobenius</a>.</p>

<p>Some authors use the term rational canonical form for a somewhat different form that is more properly called the <strong>primary rational canonical form</strong>. Instead of decomposing into a minimal number of cyclic subspaces, the primary form decomposes into a maximal number of cyclic subspaces. It is also defined over <em>F</em>, but has somewhat different properties: finding the form requires factorization of polynomials, and as a consequence the primary rational canonical form may change when the same matrix is considered over an extension field of <em>F</em>. This article mainly deals with the form that does not require factorization, and explicitly mentions "primary" when the form using factorization is meant.</p>
<h2 id="motivation">Motivation</h2>

<p>When trying to find out whether two square matrices <em>A</em> and <em>B</em> are similar, one approach is to try, for each of them, to decompose the vector space as far as possible a direct sum of stable subspaces, and compare the respective actions on these subspaces. For instance if both are diagonalizable, then one can take the decomposition into eigenspaces (for which the action is as simple as it can get, namely by a scalar), and then similarity can be decided by comparing eigenvalues and their multiplicities. While in practice this is often a quite insightful approach, there are various drawbacks this has as a general method. First, it requires finding all eigenvalues, say as roots of the characteristic polynomial, but it may not be possible to give an explicit expression for them. Second, a complete set of eigenvalues might exist only in an extension of the field one is working over, and then one does not get a proof of similarity over the original field. Finally <em>A</em> and <em>B</em> might not be diagonalizable even over this larger field, in which case one must instead use a decomposition into generalized eigenspaces, and possibly into Jordan blocks.</p>

<p>But obtaining such a fine decomposition is not necessary to just decide whether two matrices are similar. The rational canonical form is based on instead using a direct sum decomposition into stable subspaces that are as large as possible, while still allowing a very simple description of the action on each of them. These subspaces must be generated by a single nonzero vector <em>v</em> and all its images by repeated application of the linear operator associated to the matrix; such subspaces are called cyclic subspaces (by analogy with cyclic subgroups) and they are clearly stable under the linear operator. A basis of such a subspace is obtained by taking <em>v</em> and its successive images as long as they are linearly independent. The matrix of the linear operator with respect to such a basis is the <a href="companion_matrix" title="wikilink">companion matrix</a> of a monic polynomial; this polynomial (the minimal polynomial of the operator restricted to the subspace, which notion is analogous to that of the order of a cyclic subgroup) determines the action of the operator on the cyclic subspace up to isomorphism, and is independent of the choice of the vector <em>v</em> generating the subspace.</p>

<p>A direct sum decomposition into cyclic subspaces always exists, and finding one does not require factoring polynomials. However it is possible that cyclic subspaces do allow a decomposition as direct sum of smaller cyclic subspaces (essentially by the <a href="Chinese_remainder_theorem" title="wikilink">Chinese remainder theorem</a>). Therefore just having for both matrices some decomposition of the space into cyclic subspaces, and knowing the corresponding minimal polynomials, is not in itself sufficient to decide their similarity. An additional condition is imposed to ensure that for similar matrices one gets decompositions into cyclic subspaces that exactly match: in the list of associated minimal polynomials each one must divide the next (and the constant polynomial 1 is forbidden to exclude trivial cyclic subspaces of dimension 0). The resulting list of polynomials are called the <a href="invariant_factors" title="wikilink">invariant factors</a> of (the <em>K</em>[<em>X</em>]-module defined by) the matrix, and two matrices are similar if and only if they have identical lists of invariant factors. The rational canonical form of a matrix <em>A</em> is obtained by expressing it on a basis adapted to a decomposition into cyclic subspaces whose associated minimal polynomials are the invariant factors of <em>A</em>; two matrices are similar if and only if they have the same rational canonical form.</p>
<h2 id="example">Example</h2>

<p>Consider the following matrix A, over <strong>Q</strong>:</p>

<p>

<math display="block" id="Frobenius_normal_form:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>6</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>8</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>4</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>5</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>3</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <matrix>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">3</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">6</cn>
      </apply>
      <cn type="integer">4</cn>
      <cn type="integer">3</cn>
      <apply>
       <minus></minus>
       <cn type="integer">8</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">8</cn>
      <apply>
       <minus></minus>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">5</cn>
      <cn type="integer">2</cn>
      <cn type="integer">3</cn>
      <apply>
       <minus></minus>
       <cn type="integer">3</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">2</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">4</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\begin{pmatrix}-1&3&-1&0&-2&0&0&-2\\
-1&-1&1&1&-2&-1&0&-1\\
-2&-6&4&3&-8&-4&-2&1\\
-1&8&-3&-1&5&2&3&-3\\
0&0&0&0&0&0&0&1\\
0&0&0&0&-1&0&0&0\\
1&0&0&0&2&0&0&0\\
0&0&0&0&4&0&1&0\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p><em>A</em> has <a href="minimal_polynomial_(linear_algebra)" title="wikilink">minimal polynomial</a> 

<math display="inline" id="Frobenius_normal_form:1">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>X</mi>
      <mn>6</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>4</mn>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>4</mn>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>4</mn>
     <mi>X</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">6</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>X</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=X^{6}-4X^{4}-2X^{3}+4X^{2}+4X+1
  </annotation>
 </semantics>
</math>

, so that the dimension of a subspace generated by the repeated images of a single vector is at most 6. The <a href="characteristic_polynomial" title="wikilink">characteristic polynomial</a> is 

<math display="inline" id="Frobenius_normal_form:2">
 <semantics>
  <mrow>
   <mi>χ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>X</mi>
       <mn>8</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mi>X</mi>
       <mn>7</mn>
      </msup>
      <mo>-</mo>
      <mrow>
       <mn>5</mn>
       <msup>
        <mi>X</mi>
        <mn>6</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>5</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>10</mn>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>7</mn>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>5</mn>
     <mi>X</mi>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>χ</ci>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">8</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">7</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">5</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">5</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">10</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">5</cn>
      <ci>X</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi=X^{8}-X^{7}-5X^{6}+2X^{5}+10X^{4}+2X^{3}-7X^{2}-5X-1
  </annotation>
 </semantics>
</math>

, which is a multiple of the minimal polynomial by a factor 

<math display="inline" id="Frobenius_normal_form:3">
 <semantics>
  <mrow>
   <msup>
    <mi>X</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>X</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{2}-X-1
  </annotation>
 </semantics>
</math>


. There always exist vectors such that the cyclic subspace that they generate has the same minimal polynomial as the operator has on the whole space; indeed most vectors will have this property, and in this case the first standard basis vector 

<math display="inline" id="Frobenius_normal_form:4">
 <semantics>
  <msub>
   <mi>e</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{1}
  </annotation>
 </semantics>
</math>

 does so: the vectors 

<math display="inline" id="Frobenius_normal_form:5">
 <semantics>
  <mrow>
   <msup>
    <mi>A</mi>
    <mi>k</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>e</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}(e_{1})
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Frobenius_normal_form:6">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mn>5</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <list>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <cn type="integer">5</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=0,1,\ldots,5
  </annotation>
 </semantics>
</math>

 are linearly independent and span a cyclic subspace with minimal polynomial 

<math display="inline" id="Frobenius_normal_form:7">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

. There exist complementary stable subspaces (of dimension 2) to this cyclic subspace, and the space generated by vectors 

<math display="inline" id="Frobenius_normal_form:8">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>3</mn>
     <mo>,</mo>
     <mn>4</mn>
     <mo>,</mo>
     <mn>8</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⊤</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>v</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <cn type="integer">3</cn>
      <cn type="integer">4</cn>
      <cn type="integer">8</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </vector>
     <csymbol cd="latexml">top</csymbol>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v=(3,4,8,0,-1,0,2,-1)^{\top}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Frobenius_normal_form:9">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>5</mn>
     <mo>,</mo>
     <mn>4</mn>
     <mo>,</mo>
     <mn>5</mn>
     <mo>,</mo>
     <mn>9</mn>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>⊤</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <cn type="integer">5</cn>
      <cn type="integer">4</cn>
      <cn type="integer">5</cn>
      <cn type="integer">9</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
     </vector>
     <csymbol cd="latexml">top</csymbol>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w=(5,4,5,9,-1,1,1,-2)^{\top}
  </annotation>
 </semantics>
</math>

 is an example. In fact one has 

<math display="inline" id="Frobenius_normal_form:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>⋅</mo>
    <mi>v</mi>
   </mrow>
   <mo>=</mo>
   <mi>w</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <ci>A</ci>
     <ci>v</ci>
    </apply>
    <ci>w</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\cdot v=w
  </annotation>
 </semantics>
</math>

, so the complementary subspace is a cyclic subspace generated by 

<math display="inline" id="Frobenius_normal_form:11">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

; it has minimal polynomial 

<math display="inline" id="Frobenius_normal_form:12">
 <semantics>
  <mrow>
   <msup>
    <mi>X</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>X</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{2}-X-1
  </annotation>
 </semantics>
</math>

. Since 

<math display="inline" id="Frobenius_normal_form:13">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>


 is the minimal polynomial of the whole space, it is clear that 

<math display="inline" id="Frobenius_normal_form:14">
 <semantics>
  <mrow>
   <msup>
    <mi>X</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>X</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{2}-X-1
  </annotation>
 </semantics>
</math>

 must divide 

<math display="inline" id="Frobenius_normal_form:15">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 (and it is easily checked that it does), and we have found the invariant factors 

<math display="inline" id="Frobenius_normal_form:16">
 <semantics>
  <mrow>
   <msup>
    <mi>X</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>X</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{2}-X-1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Frobenius_normal_form:17">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>X</mi>
      <mn>6</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>4</mn>
      <msup>
       <mi>X</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>4</mn>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>4</mn>
     <mi>X</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">6</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>X</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=X^{6}-4X^{4}-2X^{3}+4X^{2}+4X+1
  </annotation>
 </semantics>
</math>

 of <em>A</em>. Then the rational canonical form of <em>A</em> is the block diagonal matrix with the corresponding companion matrices as diagonal blocks, namely</p>

<p>

<math display="block" id="Frobenius_normal_form:18">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>4</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>4</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">4</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">4</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">2</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">4</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\begin{pmatrix}0&1&0&0&0&0&0&0\\
1&1&0&0&0&0&0&0\\
0&0&0&0&0&0&0&-1\\
0&0&1&0&0&0&0&-4\\
0&0&0&1&0&0&0&-4\\
0&0&0&0&1&0&0&2\\
0&0&0&0&0&1&0&4\\
0&0&0&0&0&0&1&0\end{pmatrix}.
  </annotation>
 </semantics>
</math>

 A basis on which this form is attained is formed by the vectors 

<math display="inline" id="Frobenius_normal_form:19">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>,</mo>
   <mi>w</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>v</ci>
    <ci>w</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v,w
  </annotation>
 </semantics>
</math>

 above, followed by 

<math display="inline" id="Frobenius_normal_form:20">
 <semantics>
  <mrow>
   <msup>
    <mi>A</mi>
    <mi>k</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>e</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{k}(e_{1})
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Frobenius_normal_form:21">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mn>5</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <list>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <cn type="integer">5</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=0,1,\ldots,5
  </annotation>
 </semantics>
</math>

; explicitly this means that for</p>

<p>

<math display="block" id="Frobenius_normal_form:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>5</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>4</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>4</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>4</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>3</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>5</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>8</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>5</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>5</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>11</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>6</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>9</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>3</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>4</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>2</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>6</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>4</mn>
         </mtd>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
      <mtext>one has</mtext>
     </mrow>
    </mrow>
    <mrow>
     <mi>A</mi>
     <mo>=</mo>
     <mrow>
      <mi>P</mi>
      <mi>C</mi>
      <msup>
       <mi>P</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>P</ci>
     <list>
      <matrix>
       <matrixrow>
        <cn type="integer">3</cn>
        <cn type="integer">5</cn>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">4</cn>
        </apply>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">4</cn>
        <cn type="integer">4</cn>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">5</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">8</cn>
        <cn type="integer">5</cn>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">5</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">11</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">9</cn>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">3</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">4</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">0</cn>
        <cn type="integer">2</cn>
        <apply>
         <minus></minus>
         <cn type="integer">6</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">4</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
      </matrix>
      <mtext>one has</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\begin{pmatrix}3&5&1&-1&0&0&-4&0\\
4&4&0&-1&-1&-2&-3&-5\\
8&5&0&-2&-5&-2&-11&-6\\
0&9&0&-1&3&-2&0&0\\
-1&-1&0&0&0&1&-1&4\\
0&1&0&0&0&0&-1&1\\
2&1&0&1&-1&0&2&-6\\
-1&-2&0&0&1&-1&4&-2\end{pmatrix}\quad\text{one has}\quad A=PCP^{-1}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="general-case-and-theory">General case and theory</h2>

<p>Fix a base field <em>F</em> and a finite-<a href="Hamel_dimension" title="wikilink">dimensional</a> <a href="vector_space" title="wikilink">vector space</a> <em>V</em> over <em>F</em>. Given a polynomial <em>p</em>(<em>x</em>) ∈ <em>F</em>[<em>x</em>], there is associated to it a <a href="companion_matrix" title="wikilink">companion matrix</a> <em>C</em> whose <a href="characteristic_polynomial" title="wikilink">characteristic polynomial</a> is <em>p</em>(<em>x</em>).</p>

<p><strong>Theorem</strong>: Let <em>V</em> be a finite-dimensional vector space over a field <em>F</em>, and <em>A</em> a square matrix over <em>F</em>. Then <em>V</em> (viewed as an <em>F</em>[<em>x</em>]-<a href="module_(mathematics)" title="wikilink">module</a> with the action of <em>x</em> given by <em>A</em> and extending by linearity) satisfies the <em>F</em>[<em>x</em>]-module isomorphism</p>
<dl>
<dd><em>V</em> ≅ <em>F</em>[<em>x</em>]/(<em>a</em><sub>1</sub>(<em>x</em>)) ⊕ … ⊕ <em>F</em>[<em>x</em>]/(<em>a</em><sub><em>n</em></sub>(<em>x</em>))
</dd>
</dl>

<p>where the <em>a</em><sub><em>i</em></sub>(<em>x</em>) ∈ <em>F</em>[<em>x</em>] may be taken to be non-<a href="unit_(ring_theory)" title="wikilink">units</a>, unique as <a href="monic_polynomial" title="wikilink">monic polynomials</a>, and can be arranged to satisfy the relation</p>
<dl>
<dd><em>a</em><sub>1</sub>(<em>x</em>) | … | <em>a</em><sub><em>n</em></sub>(<em>x</em>)
</dd>
</dl>

<p>where "a | b" is notation for "<em>a</em> divides <em>b</em>".</p>

<p><em>Sketch of Proof</em>: Apply the <a href="structure_theorem_for_finitely_generated_modules_over_a_principal_ideal_domain" title="wikilink">structure theorem for finitely generated modules over a principal ideal domain</a> to <em>V</em>, viewing it as an <em>F</em>[<em>x</em>]-module. Note that any free <em>F</em>[<em>x</em>]-module is infinite-dimensional over <em>F</em>, so that the resulting direct sum decomposition has no <a href="free_module" title="wikilink">free</a> part since <em>V</em> is finite-dimensional. The uniqueness of the invariant factors requires a separate proof that they are determined up to units; then the monic condition ensures that they are uniquely determined. The proof of this latter part is omitted. See [DF] for details.</p>

<p>Given an arbitrary square matrix, the <a href="elementary_divisors" title="wikilink">elementary divisors</a> used in the construction of the <a href="Jordan_normal_form" title="wikilink">Jordan normal form</a> do not exist over <em>F</em>[<em>x</em>], so the <a href="invariant_factors" title="wikilink">invariant factors</a> <em>a</em><sub><em>i</em></sub>(<em>x</em>) as given above must be used instead. These correspond to factors of the minimal polynomial <em>m</em>(<em>x</em>) = <em>a</em><sub><em>n</em></sub>(<em>x</em>), which (by the <a href="Cayley–Hamilton_theorem" title="wikilink">Cayley–Hamilton theorem</a>) itself divides the characteristic polynomial <em>p</em>(<em>x</em>) and in fact has the same roots as <em>p</em>(<em>x</em>), not counting multiplicities. Note in particular that the Theorem asserts that the invariant factors have coefficients in <em>F</em>.</p>

<p>As each invariant factor <em>a</em><sub><em>i</em></sub>(<em>x</em>) is a polynomial in <em>F</em>[<em>x</em>], we may associate a corresponding <a href="block_matrix" title="wikilink">block matrix</a> <em>C</em><sub><em>i</em></sub> which is the <a href="companion_matrix" title="wikilink">companion matrix</a> to <em>a</em><sub><em>i</em></sub>(<em>x</em>). In particular, each such <em>C</em><sub><em>i</em></sub> has its entries in the field <em>F</em>.</p>

<p>Taking the matrix direct sum of these blocks over all the invariant factors yields the <strong>rational canonical form</strong> of <em>A</em>. Where the minimal polynomial is identical to the characteristic polynomial, the Frobenius normal form is the companion matrix of the characteristic polynomial. As the rational canonical form is uniquely determined by the unique invariant factors associated to <em>A</em>, and these invariant factors are independent of <a href="Hamel_basis" title="wikilink">basis</a>, it follows that two square matrices <em>A</em> and <em>B</em> are similar if and only if they have the same rational canonical form.</p>
<h2 id="a-rational-normal-form-generalizing-the-jordan-normal-form">A rational normal form generalizing the Jordan normal form</h2>

<p>The Frobenius normal form does not reflect any form of factorization of the characteristic polynomial, even if it does exist over the ground field <em>F</em>. This implies that it is invariant when <em>F</em> is replaced by a different field (as long as it contains the entries of the original matrix <em>A</em>). On the other hand this makes the Frobenius normal form rather different from other normal forms that do depend on factoring the characteristic polynomial, notably the <a href="diagonal_matrix" title="wikilink">diagonal form</a> (if <em>A</em> is diagonalizable) or more generally the <a href="Jordan_normal_form" title="wikilink">Jordan normal form</a> (if the characteristic polynomial splits into linear factors). For instance, the Frobenius normal form of a diagonal matrix with distinct diagonal entries is just the companion matrix of its characteristic polynomial.</p>

<p>There is another way to define a normal form, that like the Frobenius normal form is always defined over the same field <em>F</em> as <em>A</em>, but that does reflect a possible factorization of the characteristic polynomial (or equivalently the minimal polynomial) into irreducible factors over <em>F</em>, and which reduces to the Jordan normal form in case this factorization only contain linear factors (corresponding to <a href="eigenvalue" title="wikilink">eigenvalues</a>). This form<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is sometimes called the <strong>generalized Jordan normal form</strong>, or <strong>primary rational canonical form</strong>. It is based on the fact that the vector space can be canonically decomposed into a direct sum of stable subspaces corresponding to the <em>distinct</em> irreducible factors <em>P</em> of the characteristic polynomial (as stated by the ), where the characteristic polynomial of each summand is a power of the corresponding <em>P</em>. These summands can be further decomposed, non-canonically, as a direct sum of cyclic <em>F</em>[<em>x</em>]-modules (like is done for the Frobenius normal form above), where the characteristic polynomial of each summand is still a (generally smaller) power of <em>P</em>. The primary rational canonical form is a <a href="Block_matrix#Block_diagonal_matrices" title="wikilink">block diagonal matrix</a> corresponding to such a decomposition into cyclic modules, with a particular form called <em>generalized Jordan block</em> in the diagonal blocks, corresponding to a particular choice of a basis for the cyclic modules. This generalized Jordan block is itself a <a href="block_matrix" title="wikilink">block matrix</a> of the form</p>

<p>

<math display="block" id="Frobenius_normal_form:23">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="center">
      <mi>C</mi>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋯</mi>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mi>U</mi>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi>C</mi>
       <mo>;</mo>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋯</mi>
     </mtd>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋮</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋱</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋱</mi>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋮</mi>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mn>0</mn>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋯</mi>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi>U</mi>
       <mo>;</mo>
      </mrow>
     </mtd>
     <mtd columnalign="center">
      <mrow>
       <mi>C</mi>
       <mo>;</mo>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <ci>C</ci>
     <cn type="integer">0</cn>
     <ci>normal-⋯</ci>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <ci>U</ci>
     <ci>C</ci>
     <ci>normal-⋯</ci>
     <cn type="integer">0</cn>
    </matrixrow>
    <matrixrow>
     <ci>normal-⋮</ci>
     <ci>normal-⋱</ci>
     <ci>normal-⋱</ci>
     <ci>normal-⋮</ci>
    </matrixrow>
    <matrixrow>
     <cn type="integer">0</cn>
     <ci>normal-⋯</ci>
     <ci>U</ci>
     <ci>C</ci>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}C&0&\cdots&0\\
U&C;&\cdots&0\\
\vdots&\ddots&\ddots&\vdots\\
0&\cdots&U;&C;\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>C</em> is the companion matrix of the irreducible polynomial 

<math display="inline" id="Frobenius_normal_form:24">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Frobenius_normal_form:25">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 is a matrix whose sole nonzero entry is a 1 in the upper right hand corner. For the case of a linear irreducible factor 

<math display="inline" id="Frobenius_normal_form:26">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mi mathvariant="normal">−</mi>
    <mi>λ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>normal-−</ci>
     <ci>λ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=x−λ
  </annotation>
 </semantics>
</math>

, these blocks are reduced to single entries 

<math display="inline" id="Frobenius_normal_form:27">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mi>λ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <ci>λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=λ
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Frobenius_normal_form:28">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>U</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U=1
  </annotation>
 </semantics>
</math>

 and, one finds a (transposed) <a href="Jordan_block" title="wikilink">Jordan block</a>. In any generalized Jordan block, all entries immediately below the main diagonal are 1. A basis of the cyclic module giving rise to this form is obtained by choosing a generating vector 

<math display="inline" id="Frobenius_normal_form:29">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 (one that is not annihilated by <mtpl></mtpl> where the minimal polynomial of the cyclic module is <mtpl></mtpl>), and taking as basis</p>

<p>

<math display="block" id="Frobenius_normal_form:30">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>,</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mi>d</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mi>d</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <msup>
     <mi>P</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo rspace="5.8pt">,</mo>
   <mrow>
    <msup>
     <mi>P</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mrow>
      <mi>d</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>P</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>v</ci>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>v</ci>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>v</ci>
    </apply>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>A</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>A</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>A</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>A</ci>
     <ci>v</ci>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>A</ci>
     <ci>v</ci>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>A</ci>
      <ci>v</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v,A(v),A^{2}(v),\ldots,A^{d-1}(v),~{}P(A)(v),A(P(A)(v)),\ldots,A^{d-1}(P(A)(v)%
),~{}P^{2}(A)(v),\ldots,~{}P^{k-1}(A)(v),\ldots,A^{d-1}(P^{k-1}(A)(v))
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Frobenius_normal_form:31">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mi>d</mi>
    <mi>e</mi>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>e</ci>
     <ci>g</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=deg(P)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Smith_normal_form" title="wikilink">Smith normal form</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>[DF] David S. Dummit and Richard M. Foote. <em>Abstract Algebra</em>. 2nd Edition, John Wiley &amp; Sons. pp. 442, 446, 452-458. ISBN 0-471-36857-1.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://mathworld.wolfram.com/RationalCanonicalForm.html">Rational Canonical Form (Mathworld)</a></li>
</ul>
<h3 id="algorithms">Algorithms</h3>
<ul>
<li><a href="http://www-lmc.imag.fr/cathode2/Cirm/abstract/abs_storjohann/abs_storjohann.html">An O(<em>n</em><sup>3</sup>) Algorithm for Frobenius Normal Form</a></li>
<li>[<a class="uri" href="http://portal.acm.org/ft_gateway.cfm?id=281570&amp;type">http://portal.acm.org/ft_gateway.cfm?id=281570&amp;type;</a>;=pdf An Algorithm for the Frobenius Normal Form (pdf)]</li>
<li><a href="http://www.numbertheory.org/pdfs/canonical.pdf">A rational canonical form Algorithm (pdf)</a></li>
</ul>

<p>"</p>

<p><a href="Category:Linear_algebra" title="wikilink">Category:Linear algebra</a> <a href="Category:Matrix_normal_forms" title="wikilink">Category:Matrix normal forms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Phani Bhushan Bhattacharya, Surender Kumar Jain, S. R. Nagpaul, <em>Basic abstract algebra</em>, Theorem 5.4, [<a class="uri" href="http://books.google.fr/books?id=hiQ8e0b48swC&amp;lpg">http://books.google.fr/books?id=hiQ8e0b48swC&amp;lpg;</a>;=PA423&amp;dq;=%22generalized%20Jordan%20block%22&amp;hl;=en&amp;pg;=PA423#v=onepage&amp;q;&amp;f;=false p.423]<a href="#fnref1">↩</a></li>
</ol>
</section>
</hr></body>
</html>

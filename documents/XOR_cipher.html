<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1150">XOR cipher</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>XOR cipher</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, the <strong>simple XOR cipher</strong> is a type of <em>additive cipher</em>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> an <a href="encryption_algorithm" title="wikilink">encryption algorithm</a> that operates according to the principles:</p>
<dl>
<dd>A 

<math display="inline" id="XOR_cipher:0">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 0 = A,
</dd>
</dl>
<dl>
<dd>A 

<math display="inline" id="XOR_cipher:1">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 A = 0,
</dd>
</dl>
<dl>
<dd>(A 

<math display="inline" id="XOR_cipher:2">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 B) 

<math display="inline" id="XOR_cipher:3">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 C = A 

<math display="inline" id="XOR_cipher:4">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 (B 

<math display="inline" id="XOR_cipher:5">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 C),
</dd>
</dl>
<dl>
<dd>(B 

<math display="inline" id="XOR_cipher:6">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 A) 

<math display="inline" id="XOR_cipher:7">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 A = B 

<math display="inline" id="XOR_cipher:8">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 0 = B,
</dd>
</dl>

<p>where 

<math display="inline" id="XOR_cipher:9">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 denotes the <a href="exclusive_disjunction" title="wikilink">exclusive disjunction</a> (XOR) operation. This operation is sometimes called modulus 2 addition (or subtraction, which is identical).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> With this logic, a string of text can be encrypted by applying the bitwise XOR operator to every character using a given key. To decrypt the output, merely reapplying the XOR function with the key will remove the cipher.</p>
<h2 id="example">Example</h2>

<p>For example, the string "Wiki" (01010111 01101001 01101011 01101001 in 8-bit <a class="uri" href="ASCII" title="wikilink">ASCII</a>) can be encrypted with the repeating key 11110011 as follows:</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p><code>01010111 01101001 01101011 01101001</code></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="XOR_cipher:10">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p><code>11110011 11110011 11110011 11110011</code></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><code>10100100 10011010 10011000 10011010</code></p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>And conversely, for decryption:</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p><code>10100100 10011010 10011000 10011010</code></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="XOR_cipher:11">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p><code>11110011 11110011 11110011 11110011</code></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><code>01010111 01101001 01101011 01101001</code></p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>The XOR operator is extremely common as a component in more complex ciphers. By itself, using a constant repeating key, a simple XOR cipher can trivially be broken using <a href="frequency_analysis" title="wikilink">frequency analysis</a>. If the content of any message can be guessed or otherwise known then the key can be revealed. Its primary merit is that it is simple to implement, and that the XOR operation is computationally inexpensive. A simple repeating XOR (i.e using the same key for xor operation on the whole data) cipher is therefore sometimes used for hiding information in cases where no particular security is required.</p>

<p>If the key is random and is at least as long as the message, the XOR cipher is much more secure than when there is key repetition within a message.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> When the keystream is generated by a <a href="pseudo-random_number_generator" title="wikilink">pseudo-random number generator</a>, the result is a <a href="stream_cipher" title="wikilink">stream cipher</a>. With a key that is <a href="Hardware_random_number_generator" title="wikilink">truly random</a>, the result is a <a href="one-time_pad" title="wikilink">one-time pad</a>, which is unbreakable even in theory.</p>

<p>In any of these ciphers, the XOR operator is vulnerable to a <a href="known-plaintext_attack" title="wikilink">known-plaintext attack</a>, since <em>plaintext</em> 

<math display="inline" id="XOR_cipher:12">
 <semantics>
  <mo>⊕</mo>
  <annotation-xml encoding="MathML-Content">
   <csymbol cd="latexml">direct-sum</csymbol>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus
  </annotation>
 </semantics>
</math>

 <em>ciphertext</em> = <em>key</em>.</p>
<h2 id="example-implementation">Example implementation</h2>

<p>Example using the <a href="Python_(programming_language)" title="wikilink">Python</a> programming language.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python2</span>

<span class="im">from</span> os <span class="im">import</span> urandom

<span class="kw">def</span> genkey(length):
    <span class="co">"""Generate key"""</span>
    <span class="cf">return</span> urandom(length)

<span class="kw">def</span> xor_strings(s,t):
    <span class="co">"""xor two strings together"""</span>
    <span class="cf">return</span> <span class="st">""</span>.join(<span class="bu">chr</span>(<span class="bu">ord</span>(a)<span class="op">^</span><span class="bu">ord</span>(b)) <span class="cf">for</span> a,b <span class="op">in</span> <span class="bu">zip</span>(s,t))


message <span class="op">=</span> <span class="st">'This is a secret message'</span>
<span class="bu">print</span> <span class="st">'message:'</span>, message

key <span class="op">=</span> genkey(<span class="bu">len</span>(message))
<span class="bu">print</span> <span class="st">'key:'</span>, key

cipherText <span class="op">=</span> xor_strings(message, key)
<span class="bu">print</span> <span class="st">'cipherText:'</span>, cipherText
<span class="bu">print</span> <span class="st">'decrypted:'</span>, xor_strings(cipherText,key)

<span class="co"># verify</span>
<span class="cf">if</span> xor_strings(cipherText, key) <span class="op">==</span> message:
    <span class="bu">print</span> <span class="st">'Unit test passed'</span>
<span class="cf">else</span>:
    <span class="bu">print</span> <span class="st">'Unit test failed'</span></code></pre></div>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Vernam_cipher" title="wikilink">Vernam cipher</a></li>
<li><a href="Vigenère_cipher" title="wikilink">Vigenère cipher</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="bibliography">Bibliography</h2>
<ul>
<li></li>
<li>

<p>Transcript of a lecture given by Prof. Tutte at the <a href="University_of_Waterloo" title="wikilink">University of Waterloo</a></p></li>
</ul>
<h2 id="external-links">External Links</h2>
<ul>
<li><a href="http://sourceforge.net/projects/xorencrypt2/">XOR encryption for text files on windows with source code</a></li>
<li><a href="http://chris.dod.net/xor/xor.php">Solving the Basic XOR Cipher</a></li>
</ul>

<p>"</p>

<p><a href="Category:Stream_ciphers" title="wikilink">Category:Stream ciphers</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">This was inspired by <a href="#fnref4">↩</a></li>
</ol>
</section>
</body>


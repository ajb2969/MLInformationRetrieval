<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1960">Law of total expectation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Law of total expectation</h1>
<hr/>

<p>The proposition in <a href="probability_theory" title="wikilink">probability theory</a> known as the <strong>law of total expectation</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> the <strong>law of iterated expectations</strong>, the <strong>tower rule</strong>, the <strong>smoothing theorem</strong>, and <strong>Adam's Law</strong> among other names, states that if <em>X</em> is an integrable <a href="random_variable" title="wikilink">random variable</a> (i.e., a random variable satisfying E( | <em>X</em> | ) \operatorname{E} (X) = \operatorname{E}_Y ( \operatorname{E}_{X \mid Y} ( X \mid Y)),</p>

<p>i.e., the <a href="expected_value" title="wikilink">expected value</a> of the conditional expected value of <em>X</em> given <em>Y</em> is the same as the expected value of <em>X</em>.</p>

<p>(The <a href="conditional_expected_value" title="wikilink">conditional expected value</a> E( <em>X</em> | <em>Y</em> ) is a random variable in its own right, whose value depends on the value of <em>Y</em>. Notice that the conditional expected value of <em>X</em> given the <em>event</em> <em>Y</em> = <em>y</em> is a function of <em>y</em> (this is where adherence to the conventional, rigidly case-sensitive <a href="notation_in_probability" title="wikilink">notation of probability theory</a> becomes important!). If we write E( <em>X</em> | <em>Y</em> = <em>y</em>) = <em>g</em>(<em>y</em>) then the random variable E( <em>X</em> | <em>Y</em> ) is just <em>g</em>(<em>Y</em>).</p>

<p>One special case states that if 

<math display="inline" id="Law_of_total_expectation:0">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>A</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>A</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{1},A_{2},\ldots,A_{n}
  </annotation>
 </semantics>
</math>

 is a partition of the whole outcome space, i.e. these events are mutually exclusive and exhaustive, then</p>

<p>

<math display="block" id="Law_of_total_expectation:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>∣</mo>
        <msub>
         <mi>A</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>P</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>A</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-E</ci>
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-P</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(X)=\sum_{i=1}^{n}{\operatorname{E}(X\mid A_{i})\operatorname{%
P}(A_{i})}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="example">Example</h2>

<p>Suppose that two factories supply <a href="light_bulb" title="wikilink">light bulbs</a> to the market. Factory <em>X</em>'s bulbs work for an average of 5000 hours, whereas factory <em>Y</em>'s bulbs work for an average of 4000 hours. It is known that factory <em>X</em> supplies 60% of the total bulbs available. What is the expected length of time that a purchased bulb will work for?</p>

<p>Applying the law of total expectation, we have:</p>

<p>

<math display="inline" id="Law_of_total_expectation:2">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>L</mi>
       <mo>∣</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>P</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>L</mi>
       <mo>∣</mo>
       <mi>Y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>P</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>5000</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>.6</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>4000</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>.4</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>4600</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <ci>L</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-E</ci>
        <ci>L</ci>
        <ci>X</ci>
       </apply>
       <apply>
        <ci>normal-P</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-E</ci>
        <ci>L</ci>
        <ci>Y</ci>
       </apply>
       <apply>
        <ci>normal-P</ci>
        <ci>Y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">5000</cn>
       <cn type="float">.6</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4000</cn>
       <cn type="float">.4</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">4600</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(L)=\operatorname{E}(L\mid X)\operatorname{P}(X)+\operatorname%
{E}(L\mid Y)\operatorname{P}(Y)=5000(.6)+4000(.4)=4600
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Law_of_total_expectation:3">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>L</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(L)
  </annotation>
 </semantics>
</math>

 is the expected life of the bulb;</li>
<li>

<math display="inline" id="Law_of_total_expectation:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>6</mn>
    <mn>10</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">6</cn>
     <cn type="integer">10</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(X)={6\over 10}
  </annotation>
 </semantics>
</math>

 is the probability that the purchased bulb was manufactured by factory <em>X</em>;</li>
<li>

<math display="inline" id="Law_of_total_expectation:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>Pr</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>4</mn>
    <mn>10</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">4</cn>
     <cn type="integer">10</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr(Y)={4\over 10}
  </annotation>
 </semantics>
</math>

 is the probability that the purchased bulb was manufactured by factory <em>Y</em>;</li>
<li>

<math display="inline" id="Law_of_total_expectation:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo>∣</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>5000</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>L</ci>
     <ci>X</ci>
    </apply>
    <cn type="integer">5000</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(L\mid X)=5000
  </annotation>
 </semantics>
</math>

 is the expected lifetime of a bulb manufactured by <em>X</em>;</li>
<li>

<math display="inline" id="Law_of_total_expectation:7">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo>∣</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>4000</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>L</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">4000</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(L\mid Y)=4000
  </annotation>
 </semantics>
</math>

 is the expected lifetime of a bulb manufactured by <em>Y</em>.</li>
</ul>

<p>Thus each purchased light bulb has an expected lifetime of 4600 hours.</p>
<h2 id="proof-in-the-discrete-case">Proof in the discrete case</h2>

<p>

<math display="inline" id="Law_of_total_expectation:8">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mi>Y</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mo>E</mo>
      <mrow>
       <mi>X</mi>
       <mo>∣</mo>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>∣</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-E</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-∣</ci>
       <csymbol cd="unknown">Y</csymbol>
      </cerror>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{E}_{Y}\left(\operatorname{E}_{X\mid Y}(X\mid Y)\right)
  </annotation>
 </semantics>
</math>


</p>
<h2 id="proof-in-the-general-case">Proof in the general case</h2>

<p>The general statement of the result makes reference to a <a href="probability_space" title="wikilink">probability space</a> 

<math display="inline" id="Law_of_total_expectation:9">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi mathvariant="normal">Ω</mi>
   <mo>,</mo>
   <mi class="ltx_font_mathcaligraphic">ℱ</mi>
   <mo>,</mo>
   <mi>P</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>normal-Ω</ci>
    <ci>ℱ</ci>
    <ci>P</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\Omega,\mathcal{F},P)
  </annotation>
 </semantics>
</math>

 on which two sub <a href="Sigma-algebra" title="wikilink">

<math display="inline" id="Law_of_total_expectation:10">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

-algebras</a> 

<math display="inline" id="Law_of_total_expectation:11">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>1</mn>
   </msub>
   <mo>⊆</mo>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>2</mn>
   </msub>
   <mo>⊆</mo>
   <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <subset></subset>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <subset></subset>
     <share href="#.cmml">
     </share>
     <ci>ℱ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{G}_{1}\subseteq\mathcal{G}_{2}\subseteq\mathcal{F}
  </annotation>
 </semantics>
</math>

 are defined. For a random variable 

<math display="inline" id="Law_of_total_expectation:12">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 on such a space, the smoothing law states that</p>

<p>

<math display="block" id="Law_of_total_expectation:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>X</mi>
        <mo>∣</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">𝒢</mi>
         <mn>2</mn>
        </msub>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo>∣</mo>
      <msub>
       <mi class="ltx_font_mathcaligraphic">𝒢</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo>∣</mo>
      <msub>
       <mi class="ltx_font_mathcaligraphic">𝒢</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝒢</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[\operatorname{E}[X\mid\mathcal{G}_{2}]\mid\mathcal{G}_{1}]=%
\operatorname{E}[X\mid\mathcal{G}_{1}].
  </annotation>
 </semantics>
</math>

 Since a conditional expectation is a <a href="Radon–Nikodym_theorem" title="wikilink">Radon–Nikodym derivative</a>, verifying the following two properties establishes the smoothing law:</p>
<ul>
<li>

<math display="inline" id="Law_of_total_expectation:14">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>X</mi>
       <mo>∣</mo>
       <msub>
        <mi class="ltx_font_mathcaligraphic">𝒢</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>∣</mo>
     <msub>
      <mi class="ltx_font_mathcaligraphic">𝒢</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mtext>is</mtext>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝒢</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <mtext>is</mtext>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒢</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[\operatorname{E}[X\mid\mathcal{G}_{2}]\mid\mathcal{G}_{1}]%
\mbox{ is }\mathcal{G}_{1}
  </annotation>
 </semantics>
</math>

-<a class="uri" href="measurable" title="wikilink">measurable</a></li>
<li><math> \int_{G_1} \operatorname{E}[ \operatorname{E}[X \mid \mathcal{G}_2] \mid \mathcal{G}_1] dP = \int_{G_1} X dP</math></li>
</ul>

<p><code> \mbox{ holds for all } G_1 \in \mathcal{G}_2   </code></p>

<p>The first of these properties holds by the definition of the conditional expectation, and the second holds since 

<math display="inline" id="Law_of_total_expectation:15">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mn>1</mn>
   </msub>
   <mo>∈</mo>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>1</mn>
   </msub>
   <mo>⊆</mo>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <subset></subset>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝒢</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{1}\in\mathcal{G}_{1}\subseteq\mathcal{G}_{2}
  </annotation>
 </semantics>
</math>

 implies</p>

<p>

<math display="block" id="Law_of_total_expectation:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>G</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mrow>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mo>E</mo>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>X</mi>
          <mo>∣</mo>
          <msub>
           <mi class="ltx_font_mathcaligraphic">𝒢</mi>
           <mn>2</mn>
          </msub>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mo>∣</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">𝒢</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>P</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>G</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mrow>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>X</mi>
        <mo>∣</mo>
        <msub>
         <mi class="ltx_font_mathcaligraphic">𝒢</mi>
         <mn>2</mn>
        </msub>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>P</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>G</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mrow>
      <mi>X</mi>
      <mi>d</mi>
      <mi>P</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-E</ci>
        <apply>
         <ci>normal-E</ci>
         <ci>X</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝒢</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝒢</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>P</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-E</ci>
        <ci>X</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝒢</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>P</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>G</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>d</ci>
       <ci>P</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{G_{1}}\operatorname{E}[\operatorname{E}[X\mid\mathcal{G}_{2}]\mid%
\mathcal{G}_{1}]dP=\int_{G_{1}}\operatorname{E}[X\mid\mathcal{G}_{2}]dP=\int_{%
G_{1}}XdP.
  </annotation>
 </semantics>
</math>

</p>

<p>In the special case that 

<math display="inline" id="Law_of_total_expectation:17">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mo>,</mo>
    <mi mathvariant="normal">Ω</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒢</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Ω</csymbol>
     <ci>normal-}</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{G}_{1}=\{,\Omega\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Law_of_total_expectation:18">
 <semantics>
  <mrow>
   <msub>
    <mi class="ltx_font_mathcaligraphic">𝒢</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒢</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{G}_{2}=\sigma(Y)
  </annotation>
 </semantics>
</math>

, the smoothing law reduces to the statement</p>

<p>

<math display="block" id="Law_of_total_expectation:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>X</mi>
        <mo>∣</mo>
        <mi>Y</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[\operatorname{E}[X\mid Y]]=\operatorname{E}[X].
  </annotation>
 </semantics>
</math>

</p>
<h2 id="notation-without-indices">Notation without indices</h2>

<p>When using the expectation operator 

<math display="inline" id="Law_of_total_expectation:20">
 <semantics>
  <mo>E</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}
  </annotation>
 </semantics>
</math>

, adding indices to the operator may lead to cumbersome notations and these indices are often omitted. In the case of iterated expectations 

<math display="inline" id="Law_of_total_expectation:21">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>∣</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}\left(\operatorname{E}(X\mid Y)\right)
  </annotation>
 </semantics>
</math>

 stands for 

<math display="inline" id="Law_of_total_expectation:22">
 <semantics>
  <mrow>
   <msub>
    <mo>E</mo>
    <mi>Y</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mo>E</mo>
      <mrow>
       <mi>X</mi>
       <mo>∣</mo>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>∣</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-E</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-E</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-∣</ci>
       <csymbol cd="unknown">Y</csymbol>
      </cerror>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{Y}\left(\operatorname{E}_{X\mid Y}(X\mid Y)\right)
  </annotation>
 </semantics>
</math>

. The innermost expectation is the conditional expectation of 

<math display="inline" id="Law_of_total_expectation:23">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="Law_of_total_expectation:24">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

, and the outermost expectation is taken with respect to the conditioning variable 

<math display="inline" id="Law_of_total_expectation:25">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

. This convention is notably used in the rest of this article.</p>
<h2 id="iterated-expectations-with-nested-conditioning-sets">Iterated expectations with nested conditioning sets</h2>

<p>The following formulation of the <strong>law of iterated expectations</strong> plays an important role in many economic and finance models:</p>

<p>

<math display="block" id="Law_of_total_expectation:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>∣</mo>
      <msub>
       <mi>I</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>∣</mo>
        <msub>
         <mi>I</mi>
         <mn>2</mn>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>∣</mo>
      <msub>
       <mi>I</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(X\mid I_{1})=\operatorname{E}(\operatorname{E}(X\mid I_{2})%
\mid I_{1}),
  </annotation>
 </semantics>
</math>

</p>

<p>where the value of <em>I</em><sub>2</sub> is determined by that of <em>I</em><sub>1</sub>. To build intuition, imagine an investor who forecasts a random stock price <em>X</em> based on the limited information set <em>I</em><sub>1</sub>. The law of iterated expectations says that the investor can never gain a more precise forecast of <em>X</em> by conditioning on more specific information (<em>I</em><sub>2</sub>), <em>if</em> the more specific forecast must itself be forecast with the original information (<em>I</em><sub>1</sub>).</p>

<p>This formulation is often applied in a <a href="time_series" title="wikilink">time series</a> context, where E<sub><em>t</em></sub> denotes expectations conditional on only the information observed up to and including time period <em>t</em>. In typical models the information set <em>t</em> + 1 contains all information available through time <em>t</em>, plus additional information revealed at time <em>t</em> + 1. One can then write:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Law_of_total_expectation:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>E</mo>
      <mi>t</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo>E</mo>
      <mi>t</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mo>E</mo>
        <mrow>
         <mi>t</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-E</ci>
      <ci>t</ci>
     </apply>
     <ci>X</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-E</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-E</ci>
       <apply>
        <plus></plus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}_{t}(X)=\operatorname{E}_{t}(\operatorname{E}_{t+1}(X)).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li>The <a href="fundamental_theorem_of_poker" title="wikilink">fundamental theorem of poker</a> for one practical application.</li>
<li><a href="Law_of_total_probability" title="wikilink">Law of total probability</a></li>
<li><a href="Law_of_total_variance" title="wikilink">Law of total variance</a></li>
<li><a href="Law_of_total_covariance" title="wikilink">Law of total covariance</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>

<p>(Theorem 34.4)</p></li>
<li><a href="Christopher_Sims" title="wikilink">Christopher Sims</a>, <a href="http://sims.princeton.edu/yftp/Bubbles2007/ProbNotes.pdf">"Notes on Random Variables, Expectations, Probability Densities, and Martingales"</a>, especially equations (16) through (18)</li>
</ul>

<p>"</p>

<p><a href="Category:Algebra_of_random_variables" title="wikilink">Category:Algebra of random variables</a> <a href="Category:Theory_of_probability_distributions" title="wikilink">Category:Theory of probability distributions</a> <a href="Category:Statistical_laws" title="wikilink">Category:Statistical laws</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

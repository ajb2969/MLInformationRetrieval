   Lai-Massey scheme      Lai-Massey scheme   (Figure)  Lai Massey scheme diagram en.svg   The Lai-Massey scheme is a cryptographic structure used in the design of block ciphers . 1 2 It is used in IDEA and IDEA NXT .  Construction details  Let   F   normal-F   \mathrm{F}   be the round function and   H   normal-H   \mathrm{H}   a half-round function and let     K  0   ,   K  1   ,  …  ,   K  n       subscript  K  0    subscript  K  1   normal-…   subscript  K  n     K_{0},K_{1},\ldots,K_{n}   be the sub-keys for the rounds    0  ,  1  ,  …  ,  n     0  1  normal-…  n    0,1,\ldots,n   respectively.  Then the basic operation is as follows:  Split the plaintext block into two equal pieces, (    L  0     subscript  L  0    L_{0}   ,    R  0     subscript  R  0    R_{0}   )  For each round    i  =   0  ,  1  ,  …  ,  n       i   0  1  normal-…  n     i=0,1,\dots,n   , compute       (   L   i  +  1   ′   ,   R   i  +  1   ′   )   =   H   (    L  i  ′   +   T  i    ,    R  i  ′   +   T  i    )          superscript   subscript  L    i  1    normal-′    superscript   subscript  R    i  1    normal-′      normal-H      superscript   subscript  L  i   normal-′    subscript  T  i       superscript   subscript  R  i   normal-′    subscript  T  i        (L_{i+1}^{\prime},R_{i+1}^{\prime})=\mathrm{H}(L_{i}^{\prime}+T_{i},R_{i}^{%
 \prime}+T_{i})     where     T  i   =   F   (    L  i  ′   -   R  i  ′    ,   K  i   )         subscript  T  i     normal-F      superscript   subscript  L  i   normal-′    superscript   subscript  R  i   normal-′     subscript  K  i       T_{i}=\mathrm{F}(L_{i}^{\prime}-R_{i}^{\prime},K_{i})   and     (   L  0  ′   ,   R  0  ′   )   =   H   (   L  0   ,   R  0   )          superscript   subscript  L  0   normal-′    superscript   subscript  R  0   normal-′      normal-H    subscript  L  0    subscript  R  0       (L_{0}^{\prime},R_{0}^{\prime})=\mathrm{H}(L_{0},R_{0})     Then the ciphertext is     (   L   n  +  1    ,   R   n  +  1    )   =   (   L   n  +  1   ′   ,   R   n  +  1   ′   )         subscript  L    n  1     subscript  R    n  1       superscript   subscript  L    n  1    normal-′    superscript   subscript  R    n  1    normal-′      (L_{n+1},R_{n+1})=(L_{n+1}^{\prime},R_{n+1}^{\prime})   .  Decryption of a ciphertext    (   L   n  +  1    ,   R   n  +  1    )      subscript  L    n  1     subscript  R    n  1      (L_{n+1},R_{n+1})   is accomplished by computing for    i  =   n  ,   n  -  1   ,  …  ,  0       i   n    n  1   normal-…  0     i=n,n-1,\ldots,0          (   L  i  ′   ,   R  i  ′   )   =    H   -  1     (    L   i  +  1   ′   -   T  i    ,    R   i  +  1   ′   -   T  i    )          superscript   subscript  L  i   normal-′    superscript   subscript  R  i   normal-′       superscript  normal-H    1        superscript   subscript  L    i  1    normal-′    subscript  T  i       superscript   subscript  R    i  1    normal-′    subscript  T  i        (L_{i}^{\prime},R_{i}^{\prime})=\mathrm{H}^{-1}(L_{i+1}^{\prime}-T_{i},R_{i+1}%
 ^{\prime}-T_{i})     where     T  i   =   F   (    L   i  +  1   ′   -   R   i  +  1   ′    ,   K  i   )         subscript  T  i     normal-F      superscript   subscript  L    i  1    normal-′    superscript   subscript  R    i  1    normal-′     subscript  K  i       T_{i}=\mathrm{F}(L_{i+1}^{\prime}-R_{i+1}^{\prime},K_{i})   and     (   L   n  +  1   ′   ,   R   n  +  1   ′   )   =    H   -  1     (   L   n  +  1    ,   R   n  +  1    )          superscript   subscript  L    n  1    normal-′    superscript   subscript  R    n  1    normal-′       superscript  normal-H    1      subscript  L    n  1     subscript  R    n  1        (L_{n+1}^{\prime},R_{n+1}^{\prime})=\mathrm{H}^{-1}(L_{n+1},R_{n+1})     Then     (   L  0   ,   R  0   )   =   (   L  0  ′   ,   R  0  ′   )         subscript  L  0    subscript  R  0      superscript   subscript  L  0   normal-′    superscript   subscript  R  0   normal-′      (L_{0},R_{0})=(L_{0}^{\prime},R_{0}^{\prime})   is the plaintext again.  The Lai-Massey scheme offers security properties similar to those of the Feistel structure . It also shares its advantage over a substitution-permutation network that the round function   F   normal-F   \mathrm{F}   does not have to be invertible.  The half-round function is required to prevent a trivial distinguishing attack (      L  0   -   R  0    =    L   n  +  1    -   R   n  +  1            subscript  L  0    subscript  R  0       subscript  L    n  1     subscript  R    n  1       L_{0}-R_{0}=L_{n+1}-R_{n+1}   ). It commonly applies an orthomorphism   σ   σ   \sigma   on the left hand side, that is,       H   (  L  ,  R  )    =   (   σ   (  L  )    ,  R  )         normal-H   L  R       σ  L   R     \mathrm{H}(L,R)=(\sigma(L),R)   where both   σ   σ   \sigma   and    x  ↦    σ   (  x  )    -  x      maps-to  x      σ  x   x     x\mapsto\sigma(x)-x   are permutations (in the mathematical sense, that is, a bijection – not a permutation box ). Since there are no orthomorphisms for bit blocks (groups of size    2  n     superscript  2  n    2^{n}   ), "almost orthomorphisms" are used instead.     H   normal-H   \mathrm{H}   may depend on the key. If it doesn't, the last application can be omitted, since its inverse is known anyway. The last application is commonly called "round    n  .5      n  .5    n.5   " for a cipher that otherwise has   n   n   n   rounds.  Literature   X. Lai. On the design and security of block ciphers . ETH Series in Information Processing, vol. 1, Hartung-Gorre, Konstanz, 1992  X. Lai, J. L. Massey. A proposal for a new block encryption standard . Advances in Cryptology EUROCRYPT'90 , Aarhus, Denemark, LNCS 473, p. 389-404, Springer, 1991  Serge Vaudenay: A Classical Introduction to Cryptography , [ http://books.google.de/books?id=DVLEql738mwC&pg; ;=PA33 p. 33]   References    "  Category:Block ciphers     Aaram Yun, Je Hong Park, Jooyoung Lee: Lai-Massey Scheme and Quasi-Feistel Networks . IACR Cryptology ↩  Serge Vaudenay: On the Lai-Massey Scheme . ASIACRYPT'99 ↩     
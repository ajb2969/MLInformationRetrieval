   Weyr canonical form      Weyr canonical form   (Figure)  The image shows an example of a general Weyr matrix consisting of two blocks each of which is a basic Weyr matrix. The basic Weyr matrix in the top-left corner has the structure (4,2,1) and the other one has the structure (2,2,1,1).   In mathematics , in linear algebra , a Weyr canonical form (or, Weyr form or Weyr matrix ) is a square matrix satisfying certain conditions. A square matrix is said to be in the Weyr canonical form if the matrix satisfies the conditions defining the Weyr canonical form. The Weyr form was discovered by the Czech  mathematician  Eduard Weyr in 1885. 1 2 3 The Weyr form did not become popular among mathematicians and it was overshadowed by the closely related, but distinct, canonical form known by the name Jordan canonical form . 4 The Weyr form has been rediscovered several times since Weyr’s original discovery in 1885. 5 This form has been variously called as modified Jordan form,  reordered Jordan form,  second Jordan form, and H-form . 6 The current terminology is credited to Shapiro who introduced it in a paper published in the American Mathematical Monthly in 1999. 7 8  Recently several applications have been found for the Weyr matrix. Of particular interest is an application of the Weyr matrix in the study of phylogenetic invariants in biomathematics .  Definitions  Basic Weyr matrix  Definition  A basic Weyr matrix with eigenvalue    λ   λ   \lambda   is an    n  ×  n      n  n    n\times n   matrix   W   W   W   of the following form: There is a partition        n  1   +   n  2   +  ⋯  +   n  r    =  n         subscript  n  1    subscript  n  2   normal-⋯   subscript  n  r    n    n_{1}+n_{2}+\cdots+n_{r}=n   of   n   n   n   with     n  1   ≥   n  2   ≥  ⋯  ≥   n  r   ≥  1         subscript  n  1    subscript  n  2        normal-⋯        subscript  n  r        1     n_{1}\geq n_{2}\geq\cdots\geq n_{r}\geq 1   such that, when   W   W   W   is viewed as an    r  ×  r      r  r    r\times r    blocked matrix     (   W   i  j    )     subscript  W    i  j     (W_{ij})   , where the    (  i  ,  j  )     i  j    (i,j)   block    W   i  j      subscript  W    i  j     W_{ij}   is an     n  i   ×   n  j        subscript  n  i    subscript  n  j     n_{i}\times n_{j}   matrix, the following three features are present:   The main diagonal blocks    W   i  i      subscript  W    i  i     W_{ii}   are the     n  i   ×   n  i        subscript  n  i    subscript  n  i     n_{i}\times n_{i}    scalar matrices     λ  I      λ  I    \lambda I   for    i  =   1  ,  …  ,  r       i   1  normal-…  r     i=1,\ldots,r   .  The first superdiagonal blocks    W   i  ,   i  +  1       subscript  W   i    i  1      W_{i,i+1}   are full column rank      n  i   ×   n   i  +  1         subscript  n  i    subscript  n    i  1      n_{i}\times n_{i+1}   matrices in reduced row-echelon form (that is, an identity matrix followed by zero rows) for    i  =   1  ,  …  ,   r  -  1        i   1  normal-…    r  1      i=1,\ldots,r-1   .  All other blocks of W are zero (that is,     W   i  j    =  0       subscript  W    i  j    0    W_{ij}=0   when    j  ≠   i  ,   i  +  1        j   i    i  1      j\neq i,i+1   ).   In this case, we say that   W   W   W   has Weyr structure    (   n  1   ,   n  2   ,  …  ,   n  r   )      subscript  n  1    subscript  n  2   normal-…   subscript  n  r     (n_{1},n_{2},\ldots,n_{r})   .  Example  The following is an example of a basic Weyr matrix.       W  =       W  absent    W=        =   [      W  11      W  12                 W  22      W  23                 W  33      W  34                 W  44      ]       absent     subscript  W  11    subscript  W  12   absent  absent    absent   subscript  W  22    subscript  W  23   absent    absent  absent   subscript  W  33    subscript  W  34     absent  absent  absent   subscript  W  44       =\begin{bmatrix}W_{11}&W_{12}&&\\
 &W_{22}&W_{23}&\\
 &&W_{33}&W_{34}\\
 &&&W_{44}\\
 \end{bmatrix}      In this matrix,    n  =  10      n  10    n=10   and      n  1   =  4   ,     n  2   =  2   ,     n  3   =  2   ,    n  4   =  1        formulae-sequence     subscript  n  1   4    formulae-sequence     subscript  n  2   2    formulae-sequence     subscript  n  3   2      subscript  n  4   1       n_{1}=4,n_{2}=2,n_{3}=2,n_{4}=1   . So   W   W   W   has the Weyr structure    (  4  ,  2  ,  2  ,  1  )     4  2  2  1    (4,2,2,1)   . Also,         W  11   =   [     λ    0    0    0      0    λ    0    0      0    0    λ    0      0    0    0    λ     ]   =   λ   I  4     ,    W  22   =   [     λ    0      0    λ        ]   =   λ   I  2     ,    W  33   =   [     λ    0      0    λ        ]   =   λ   I  2     ,    W  44   =   [     λ     ]   =   λ   I  1        formulae-sequence       subscript  W  11     λ  0  0  0    0  λ  0  0    0  0  λ  0    0  0  0  λ           λ   subscript  I  4           subscript  W  22     λ  0    0  λ  absent           λ   subscript  I  2           subscript  W  33     λ  0    0  λ  absent           λ   subscript  I  2           subscript  W  44     λ           λ   subscript  I  1        W_{11}=\begin{bmatrix}\lambda&0&0&0\\
 0&\lambda&0&0\\
 0&0&\lambda&0\\
 0&0&0&\lambda\\
 \end{bmatrix}=\lambda I_{4},\quad W_{22}=\begin{bmatrix}\lambda&0\\
 0&\lambda&\\
 \end{bmatrix}=\lambda I_{2},\quad W_{33}=\begin{bmatrix}\lambda&0\\
 0&\lambda&\\
 \end{bmatrix}=\lambda I_{2},\quad W_{44}=\begin{bmatrix}\lambda\\
 \end{bmatrix}=\lambda I_{1}      and          W  12   =   [     1    0      0    1      0    0      0    0     ]    ,     W  23   =   [     1    0      0    1     ]    ,    W  34   =   [     1      0     ]      .     formulae-sequence     subscript  W  12     1  0    0  1    0  0    0  0      formulae-sequence     subscript  W  23     1  0    0  1        subscript  W  34     1    0        W_{12}=\begin{bmatrix}1&0\\
 0&1\\
 0&0\\
 0&0\\
 \end{bmatrix},\quad W_{23}=\begin{bmatrix}1&0\\
 0&1\\
 \end{bmatrix},\quad W_{34}=\begin{bmatrix}1\\
 0\\
 \end{bmatrix}.      General Weyr matrix  Definition  Let   W   W   W   be a square matrix and let     λ  1   ,  …  ,   λ  k       subscript  λ  1   normal-…   subscript  λ  k     \lambda_{1},\ldots,\lambda_{k}   be the distinct eigenvalues of   W   W   W   . We say that   W   W   W   is in Weyr form (or is a Weyr matrix) if   W   W   W   has the following form:       W  =   [      W  1                    W  2                   ⋱                   W  k      ]       W     subscript  W  1   absent  absent  absent    absent   subscript  W  2   absent  absent    absent  absent  normal-⋱  absent    absent  absent  absent   subscript  W  k       W=\begin{bmatrix}W_{1}&&&\\
 &W_{2}&&\\
 &&\ddots&\\
 &&&W_{k}\\
 \end{bmatrix}      where    W  i     subscript  W  i    W_{i}   is a basic Weyr matrix with eigenvalue    λ  i     subscript  λ  i    \lambda_{i}   for    i  =   1  ,  …  ,  k       i   1  normal-…  k     i=1,\ldots,k   .  Example  The following image shows an example of a general Weyr matrix consisting of three basic Weyr matrix blocks. The basic Weyr matrix in the top-left corner has the structure (4,2,1) with eigenvalue 4, the middle block has structure (2,2,1,1) with eigenvalue -3 and the one in the lower-right corner has the structure (3, 2) with eigenvalue 0.   (Figure)  WeyrMatrixExample02.jpg    The Weyr form is canonical  That the weyr form is a canonical form of a matrix is a consequence of the following result: 9  To within permutation of basic Weyr blocks, each square matrix   A   A   A   over an algebraically closed field is similar to a unique Weyr matrix   W   W   W   . The matrix   W   W   W   is called the Weyr (canonical ) form of   A   A   A   .  Computation of the Weyr canonical form  Reduction to the nilpotent case  Let   A   A   A   be a square matrix of order   n   n   n   over an algebraically closed field and let the distinct eigenvalues of   A   A   A   be     λ  1   ,   λ  2   ,  …  ,   λ  k       subscript  λ  1    subscript  λ  2   normal-…   subscript  λ  k     \lambda_{1},\lambda_{2},\ldots,\lambda_{k}   . As a consequence of the generalized eigenspace decomposition theorem, one can show that   A   A   A   is similar to a block diagonal matrix of the form      A  =   [        λ  1   I   +   N  1                       λ  2   I   +   N  2                    ⋱                     λ  k   I   +   N  k       ]   =    [       λ  1   I                     λ  2   I                   ⋱                    λ  k   I      ]   +   [      N  1                    N  2                   ⋱                   N  k      ]    =   D  +  N         A         subscript  λ  1   I    subscript  N  1    absent  absent  absent    absent       subscript  λ  2   I    subscript  N  2    absent  absent    absent  absent  normal-⋱  absent    absent  absent  absent       subscript  λ  k   I    subscript  N  k                  subscript  λ  1   I   absent  absent  absent    absent     subscript  λ  2   I   absent  absent    absent  absent  normal-⋱  absent    absent  absent  absent     subscript  λ  k   I        subscript  N  1   absent  absent  absent    absent   subscript  N  2   absent  absent    absent  absent  normal-⋱  absent    absent  absent  absent   subscript  N  k             D  N      A=\begin{bmatrix}\lambda_{1}I+N_{1}&&&\\
 &\lambda_{2}I+N_{2}&&\\
 &&\ddots&\\
 &&&\lambda_{k}I+N_{k}\\
 \end{bmatrix}=\begin{bmatrix}\lambda_{1}I&&&\\
 &\lambda_{2}I&&\\
 &&\ddots&\\
 &&&\lambda_{k}I\\
 \end{bmatrix}+\begin{bmatrix}N_{1}&&&\\
 &N_{2}&&\\
 &&\ddots&\\
 &&&N_{k}\\
 \end{bmatrix}=D+N     where   D   D   D   is a diagonal matrix and   N   N   N   is a nilpotent matrix . So the problem of reducing   A   A   A   to the Weyr form reduces to the problem of reducing the nilpotent matrices    N  i     subscript  N  i    N_{i}   to the Weyr form.  Reduction of a nilpotent matrix to the Weyr form  Given a nilpotent square matrix   A   A   A   of order   n   n   n   over an algebraically closed field   F   F   F   , the following algorithm produces an invertible matrix   C   C   C   and a Weyr matrix   W   W   W   such that    W  =    C   -  1    A  C       W     superscript  C    1    A  C     W=C^{-1}AC   .  Step 1  Let     A  1   =  A       subscript  A  1   A    A_{1}=A     Step 2   Compute a basis for the null space of    A  1     subscript  A  1    A_{1}   .  Extend the basis for the null space of    A  1     subscript  A  1    A_{1}   to a basis for the   n   n   n   -dimensional vector space    F  n     superscript  F  n    F^{n}   .  Form the matrix    P  1     subscript  P  1    P_{1}   consisting of these basis vectors.  Compute      P  1   -  1     A  1    P  1    =   [     0     B  2       0     A  2      ]          superscript   subscript  P  1     1     subscript  A  1    subscript  P  1      0   subscript  B  2     0   subscript  A  2       P_{1}^{-1}A_{1}P_{1}=\begin{bmatrix}0&B_{2}\\
 0&A_{2}\end{bmatrix}   .    A  2     subscript  A  2    A_{2}   is a square matrix of size   n   n   n   − nullity    (   A  1   )     subscript  A  1    (A_{1})   .   Step 3  If    A  2     subscript  A  2    A_{2}   is nonzero, repeat Step 2 on    A  2     subscript  A  2    A_{2}   .   Compute a basis for the null space of    A  2     subscript  A  2    A_{2}   .  Extend the basis for the null space of    A  2     subscript  A  2    A_{2}   to a basis for the vector space having dimension   n   n   n   − nullity    (   A  1   )     subscript  A  1    (A_{1})   .  Form the matrix    P  2     subscript  P  2    P_{2}   consisting of these basis vectors.  Compute      P  2   -  1     A  2    P  2    =   [     0     B  3       0     A  3      ]          superscript   subscript  P  2     1     subscript  A  2    subscript  P  2      0   subscript  B  3     0   subscript  A  3       P_{2}^{-1}A_{2}P_{2}=\begin{bmatrix}0&B_{3}\\
 0&A_{3}\end{bmatrix}   .    A  2     subscript  A  2    A_{2}   is a square matrix of size   n   n   n   − nullity    (   A  1   )     subscript  A  1    (A_{1})   − nullity    (   A  2   )     subscript  A  2    (A_{2})   .   Step 4  Continue the processes of Steps 1 and 2 to obtain increasingly smaller square matrices     A  1   ,   A  2   ,   A  3   ,  …      subscript  A  1    subscript  A  2    subscript  A  3   normal-…    A_{1},A_{2},A_{3},\ldots   and associated nvertible matrices      P  1   ,   P  2   ,   P  3   ,  …      subscript  P  1    subscript  P  2    subscript  P  3   normal-…    P_{1},P_{2},P_{3},\ldots   until the first zero matrix    A  r     subscript  A  r    A_{r}   is obtained.  Step 5  The Weyr structure of   A   A   A   is    (   n  1   ,   n  2   ,  …  ,   n  r   )      subscript  n  1    subscript  n  2   normal-…   subscript  n  r     (n_{1},n_{2},\ldots,n_{r})   where    n  i     subscript  n  i    n_{i}   = nullity    (   A  i   )     subscript  A  i    (A_{i})   .  Step 6   Compute the matrix    P  =    P  1    [     I    0      0     P  2      ]    [     I    0      0     P  3      ]   ⋯   [     I    0      0     P  r      ]        P     subscript  P  1     I  0    0   subscript  P  2       I  0    0   subscript  P  3     normal-⋯    I  0    0   subscript  P  r        P=P_{1}\begin{bmatrix}I&0\\
 0&P_{2}\end{bmatrix}\begin{bmatrix}I&0\\
 0&P_{3}\end{bmatrix}\cdots\begin{bmatrix}I&0\\
 0&P_{r}\end{bmatrix}   (here the   I   I   I   's are appropriately sized identity matrices).  Compute    X  =    P   -  1    A  P       X     superscript  P    1    A  P     X=P^{-1}AP   .   X   X   X   is a matrix of the following form:         X  =   [     0     X  12      X  13     ⋯     X   1  ,   r  -  1        X   ;   1  r            0     X  23     ⋯     X   2  ,   r  -  1        X   2  r                 ⋱                  ⋯    0     X    r  -  1   ,  r                       0     ]       X    0   subscript  X  12    subscript  X  13   normal-⋯   subscript  X   1    r  1      fragments  X   subscript  normal-;    1  r       absent  0   subscript  X  23   normal-⋯   subscript  X   2    r  1      subscript  X    2  r      absent  absent  absent  normal-⋱  absent    absent  absent  absent  normal-⋯  0   subscript  X     r  1   r      absent  absent  absent  absent  absent  0      X=\begin{bmatrix}0&X_{12}&X_{13}&\cdots&X_{1,r-1}&X_{1r}\\
 &0&X_{23}&\cdots&X_{2,r-1}&X_{2r}\\
 &&&\ddots&\\
 &&&\cdots&0&X_{r-1,r}\\
 &&&&&0\end{bmatrix}   .     Step 7  Use elementary row operations to find an invertible matrix    Y   r  -  1      subscript  Y    r  1     Y_{r-1}   of appropriate size such that the product     Y   r  -  1     X   r  ,   r  -  1          subscript  Y    r  1     subscript  X   r    r  1       Y_{r-1}X_{r,r-1}   is a matrix of the form     I   r  ,   r  -  1     =   [     I      O     ]        subscript  I   r    r  1       I    O      I_{r,r-1}=\begin{bmatrix}I\\
 O\end{bmatrix}   .  Step 8  Set     Q  1   =        subscript  Q  1   absent    Q_{1}=   diag    (  I  ,  I  ,  …  ,   Y   r  -  1    -  1    ,  I  )     I  I  normal-…   superscript   subscript  Y    r  1      1    I    (I,I,\ldots,Y_{r-1}^{-1},I)   and compute     Q  1   -  1    X   Q  1        superscript   subscript  Q  1     1    X   subscript  Q  1     Q_{1}^{-1}XQ_{1}   . In this matrix, the    (  r  ,   r  -  1   )     r    r  1     (r,r-1)   -block is    I   r  ,   r  -  1       subscript  I   r    r  1      I_{r,r-1}   .  Step 9  Find a matrix    R  1     subscript  R  1    R_{1}   formed as a product of elementary matrices such that     R  1   -  1     Q  1   -  1    X   Q  1    R  1        superscript   subscript  R  1     1     superscript   subscript  Q  1     1    X   subscript  Q  1    subscript  R  1     R_{1}^{-1}Q_{1}^{-1}XQ_{1}R_{1}   is a matrix in which all the blocks above the block    I   r  ,   r  -  1       subscript  I   r    r  1      I_{r,r-1}   contain only   0   0    's.  Step 10  Repeat Steps 8 and 9 on column    r  -  1      r  1    r-1   converting    (   r  -  1   ,   r  -  2   )       r  1     r  2     (r-1,r-2)   -block to    I    r  -  1   ,   r  -  2       subscript  I     r  1     r  2      I_{r-1,r-2}   via conjugation by some invertible matrix    Q  2     subscript  Q  2    Q_{2}   . Use this block to clear out the blocks above, via conjugation by a product    R  2     subscript  R  2    R_{2}   of elementary matrices.  Step 11  Repeat these processes on     r  -  2   ,   r  -  3   ,  …  ,  3  ,  2       r  2     r  3   normal-…  3  2    r-2,r-3,\ldots,3,2   columns, using conjugations by     Q  3   ,   R  3   ,  …  ,   Q   r  -  2    ,   R   r  -  2    ,   Q   r  -  1        subscript  Q  3    subscript  R  3   normal-…   subscript  Q    r  2     subscript  R    r  2     subscript  Q    r  1      Q_{3},R_{3},\ldots,Q_{r-2},R_{r-2},Q_{r-1}   . The resulting matrix   W   W   W   is now in Weyr form.  Step 12  Let    C  =    P  1   diag   (  I  ,   P  2   )   ⋯  diag   (  I  ,   P   r  -  1    )    Q  1    R  1    Q  2   ⋯   R   r  -  2     Q   r  -  1         C     subscript  P  1   diag   I   subscript  P  2    normal-⋯  diag   I   subscript  P    r  1      subscript  Q  1    subscript  R  1    subscript  Q  2   normal-⋯   subscript  R    r  2     subscript  Q    r  1       C=P_{1}\text{diag}(I,P_{2})\cdots\text{diag}(I,P_{r-1})Q_{1}R_{1}Q_{2}\cdots R%
 _{r-2}Q_{r-1}   . Then    W  =    C   -  1    A  C       W     superscript  C    1    A  C     W=C^{-1}AC   .  Applications of the Weyr form  Some well-known applications of the Weyr form are listed below: 10   The Weyr form can be used to simplify the proof of Gerstenhaber’s Theorem which asserts that the subalgebra generated by two commuting    n  ×  n      n  n    n\times n   matrices has dimension at most   n   n   n   .  A set of finite matrices is said to be approximately simultaneously diagonalizable if they can be perturbed to simultaneously diagonalizable matrices. The Weyr form is used to prove approximate simultaneous diagonalizability of various classes of matrices. The approximate simultaneous diagonalizability property has applications in the study of phylogenetic invariants in biomathematics .  The Weyr form can be used to simplify the proofs of the irreducibility of the variety of all k -tuples of commuting complex matrices.   References  "  Category:Linear algebra  Category:Matrix theory  Category:Matrix normal forms  Category:Matrix decompositions     ↩  ↩  ↩   ↩    ↩       
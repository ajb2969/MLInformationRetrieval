<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1515">Helmholtz free energy</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Helmholtz free energy</h1>
<hr/>

<p>In <a class="uri" href="thermodynamics" title="wikilink">thermodynamics</a>, the <strong>Helmholtz free energy</strong> is a <a href="thermodynamic_potential" title="wikilink">thermodynamic potential</a> that measures the “useful” work obtainable from a <a href="closed_system" title="wikilink">closed</a> <a href="thermodynamic_system" title="wikilink">thermodynamic system</a> at a constant temperature. The negative of the difference in the Helmholtz energy is equal to the maximum amount of work that the system can perform in a thermodynamic process in which temperature is held constant. If the volume is not held constant, part of this work will be performed as boundary work. The Helmholtz energy is commonly used for systems held at constant volume. Since in this case no work is performed on the environment, the drop in the Helmholtz energy is equal to the maximum amount of useful work that can be extracted from the system. For a system at constant temperature and volume, the Helmholtz energy is minimized at equilibrium.</p>

<p>The Helmholtz free energy was developed by <a href="Hermann_von_Helmholtz" title="wikilink">Hermann von Helmholtz</a>, a German physicist, and is usually denoted by the letter <em>A</em>  (from the German “Arbeit” or work), or the letter <em>F</em> . The <a class="uri" href="IUPAC" title="wikilink">IUPAC</a> recommends the letter <em>A</em>  as well as the use of name <em>Helmholtz energy</em>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In <a class="uri" href="physics" title="wikilink">physics</a>, the letter <em>F</em> can also be used to denote the Helmholtz energy, as Helmholtz energy is sometimes referred to as the <em>Helmholtz function,</em> <em>Helmholtz free energy,</em> or simply <em>free energy</em> (not to be confused with <a href="Gibbs_free_energy" title="wikilink">Gibbs free energy</a>).</p>

<p>While <a href="Gibbs_free_energy" title="wikilink">Gibbs free energy</a> is most commonly used as a measure of thermodynamic potential, especially in the field of <a class="uri" href="chemistry" title="wikilink">chemistry</a>, it is inconvenient for some applications that do not occur at constant pressure. For example, in <a class="uri" href="explosives" title="wikilink">explosives</a> research, Helmholtz free energy is often used since explosive reactions by their nature induce pressure changes. It is also frequently used to define fundamental <a href="equation_of_state" title="wikilink">equations of state</a> of pure substances.</p>
<h2 id="definition">Definition</h2>

<p>The Helmholtz energy is defined as:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Helmholtz_free_energy:0">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≡</mo>
   <mrow>
    <mi>U</mi>
    <mo>-</mo>
    <mrow>
     <mi>T</mi>
     <mpadded width="+1.7pt">
      <mi>S</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>U</ci>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\equiv U-TS\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li><em>A</em>  is the Helmholtz free energy (<a class="uri" href="SI" title="wikilink">SI</a>: <a href="joule" title="wikilink">joules</a>, CGS: <a href="erg" title="wikilink">ergs</a>),</li>
<li><em>U</em>  is the <a href="internal_energy" title="wikilink">internal energy</a> of the system (SI: joules, CGS: ergs),</li>
<li><em>T</em>  is the absolute temperature (<a href="kelvin" title="wikilink">kelvins</a>),</li>
<li><em>S</em>  is the <a class="uri" href="entropy" title="wikilink">entropy</a> (SI: joules per kelvin, CGS: ergs per kelvin).</li>
</ul>

<p>The Helmholtz energy is the <a href="Legendre_transform" title="wikilink">Legendre transform</a> of the internal energy, <em>U</em>, in which temperature replaces entropy as the independent variable.</p>
<h2 id="mathematical-development">Mathematical development</h2>

<p>From the <a href="first_law_of_thermodynamics" title="wikilink">first law of thermodynamics</a> (with a constant number of particles) we have</p>

<p>

<math display="block" id="Helmholtz_free_energy:1">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>U</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <mpadded width="+5pt">
      <mi>Q</mi>
     </mpadded>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>δ</mi>
     <mpadded width="+1.7pt">
      <mi>W</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>Q</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>W</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}U=\delta Q\ -\delta W\,
  </annotation>
 </semantics>
</math>

,</p>

<p>where 

<math display="inline" id="Helmholtz_free_energy:2">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 is the internal energy, 

<math display="inline" id="Helmholtz_free_energy:3">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mi>Q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>δ</ci>
    <ci>Q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta Q
  </annotation>
 </semantics>
</math>

 is the energy added by heating and 

<math display="inline" id="Helmholtz_free_energy:4">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mi>W</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>δ</ci>
    <ci>W</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta W
  </annotation>
 </semantics>
</math>

 is the work done <em>by the system</em>. From the <a href="second_law_of_thermodynamics" title="wikilink">second law of thermodynamics</a>, for a <a href="reversible_process_(thermodynamics)" title="wikilink">reversible process</a> we may say that 

<math display="inline" id="Helmholtz_free_energy:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>Q</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>T</mi>
    <mi mathvariant="normal">d</mi>
    <mi>S</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>Q</ci>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>normal-d</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta Q=T\mathrm{d}S
  </annotation>
 </semantics>
</math>

. Also, in case of a reversible change, the work done can be expressed as 

<math display="inline" id="Helmholtz_free_energy:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>W</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mi mathvariant="normal">d</mi>
    <mi>V</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>W</ci>
    </apply>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>normal-d</ci>
     <ci>V</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta W=p\mathrm{d}V
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Helmholtz_free_energy:7">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>U</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi mathvariant="normal">d</mi>
     <mi>S</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>p</mi>
     <mi mathvariant="normal">d</mi>
     <mpadded width="+1.7pt">
      <mi>V</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>normal-d</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>normal-d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}U=T\mathrm{d}S-p\mathrm{d}V\,
  </annotation>
 </semantics>
</math>

 Applying the product rule for differentiation to <em>d(TS)</em> = <em>TdS</em> + <em>SdT</em>, we have:</p>

<p>

<math display="block" id="Helmholtz_free_energy:8">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>U</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>T</mi>
       <mi>S</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>S</mi>
     <mi mathvariant="normal">d</mi>
     <mi>T</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>p</mi>
     <mi mathvariant="normal">d</mi>
     <mpadded width="+1.7pt">
      <mi>V</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>normal-d</ci>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>normal-d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}U=d(TS)-S\mathrm{d}T-p\mathrm{d}V\,
  </annotation>
 </semantics>
</math>

, and:</p>

<p>

<math display="block" id="Helmholtz_free_energy:9">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>U</mi>
      <mo>-</mo>
      <mrow>
       <mi>T</mi>
       <mi>S</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>S</mi>
      <mi mathvariant="normal">d</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>p</mi>
     <mi mathvariant="normal">d</mi>
     <mpadded width="+1.7pt">
      <mi>V</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <apply>
      <minus></minus>
      <ci>U</ci>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>S</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>normal-d</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>normal-d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}(U-TS)=-S\mathrm{d}T-p\mathrm{d}V\,
  </annotation>
 </semantics>
</math>

 The definition of A = U - TS enables to rewrite this as</p>

<p>

<math display="block" id="Helmholtz_free_energy:10">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>S</mi>
      <mi mathvariant="normal">d</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>p</mi>
     <mi mathvariant="normal">d</mi>
     <mpadded width="+1.7pt">
      <mi>V</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>normal-d</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>normal-d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}A=-S\mathrm{d}T-p\mathrm{d}V\,
  </annotation>
 </semantics>
</math>

</p>

<p>This relation is also valid for a process that is not reversible because <em>A</em> is a thermodynamic <a href="Functions_of_state" title="wikilink">function of state</a>.</p>
<h2 id="work-in-an-isothermal-process-and-equilibrium-conditions">Work in an Isothermal Process and Equilibrium Conditions</h2>

<p>The fundamental thermodynamic relation is</p>

<p>

<math display="block" id="Helmholtz_free_energy:11">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>U</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <mpadded width="+5pt">
      <mi>Q</mi>
     </mpadded>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>δ</mi>
     <mpadded width="+1.7pt">
      <mi>W</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>Q</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>W</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}U=\delta Q\ -\delta W\,
  </annotation>
 </semantics>
</math>

</p>

<p>We can make the substitution</p>

<p>

<math display="block" id="Helmholtz_free_energy:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi>Q</mi>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mi>T</mi>
    <mi mathvariant="normal">d</mi>
    <mpadded width="+1.7pt">
     <mi>S</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>Q</ci>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>normal-d</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta Q\leq T\mathrm{d}S\,
  </annotation>
 </semantics>
</math>

 Where equality holds for a reversible process</p>

<p>The expression for the internal energy becomes</p>

<p>

<math display="block" id="Helmholtz_free_energy:13">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>U</mi>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi mathvariant="normal">d</mi>
     <mi>S</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>δ</mi>
     <mpadded width="+1.7pt">
      <mi>W</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>normal-d</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>W</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}U\leq T\mathrm{d}S-\delta W\,
  </annotation>
 </semantics>
</math>

</p>

<p>If we isolate the work term</p>

<p>

<math display="block" id="Helmholtz_free_energy:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi>U</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>T</mi>
     <mi mathvariant="normal">d</mi>
     <mi>S</mi>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>δ</mi>
     <mpadded width="+1.7pt">
      <mi>W</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>U</ci>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>normal-d</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>W</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}U-T\mathrm{d}S\leq-\delta W\,
  </annotation>
 </semantics>
</math>

</p>

<p>And note that, for an isothermal process,</p>

<p>

<math display="block" id="Helmholtz_free_energy:15">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi mathvariant="normal">d</mi>
     <mi>U</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>T</mi>
     <mi mathvariant="normal">d</mi>
     <mpadded width="+1.7pt">
      <mi>S</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>U</ci>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>normal-d</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{d}A=\mathrm{d}U-T\mathrm{d}S\,
  </annotation>
 </semantics>
</math>

</p>

<p>Then</p>

<p>

<math display="block" id="Helmholtz_free_energy:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <mi>W</mi>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi mathvariant="normal">d</mi>
      <mi>A</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>W</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-d</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta W\leq-\mathrm{d}A,
  </annotation>
 </semantics>
</math>

 (isothermal process) Again, equality holds for a reversible process (in which 

<math display="inline" id="Helmholtz_free_energy:17">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mpadded width="+1.7pt">
    <mi>W</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>δ</ci>
    <ci>W</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta W\,
  </annotation>
 </semantics>
</math>

 becomes dW) . dW includes all reversible work, mechanical (pressure-volume) work and non-mechanical work (e. g. electrical work).</p>

<p>The maximum energy that can be freed for work is the negative of the change in A. The process is nominally isothermal, but it is only required that the system has the same initial and final temperature, and not that the temperature stays constant along the process.</p>

<p>Now, imagine that our system is also kept at constant volume to prevent work from being done. If temperature and volume are kept constant, then dA = 0; this is a necessary, but not sufficient condition for equilibrium. For any spontaneous process, the change in Helmholtz free energy must be negative, that is 

<math display="inline" id="Helmholtz_free_energy:18">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>f</mi>
    </msub>
    <mo>≤</mo>
    <msub>
     <mi>A</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{f}\leq A_{i},
  </annotation>
 </semantics>
</math>

. Therefore, to prevent a spontaneous change, we must also require that A be at a minimum.</p>
<h2 id="minimum-free-energy-and-maximum-work-principles">Minimum free energy and maximum work principles</h2>

<p>The laws of thermodynamics are only directly applicable to systems in thermal equilibrium. If we wish to describe phenomena like chemical reactions, then the best we can do is to consider suitably chosen initial and final states in which the system is in (metastable) thermal equilibrium. If the system is kept at fixed volume and is in contact with a heat bath at some constant temperature, then we can reason as follows.</p>

<p>Since the thermodynamical variables of the system are well defined in the initial state and the final state, the internal energy increase, 

<math display="inline" id="Helmholtz_free_energy:19">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>U</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta U
  </annotation>
 </semantics>
</math>

, the <a class="uri" href="entropy" title="wikilink">entropy</a> increase 

<math display="inline" id="Helmholtz_free_energy:20">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>S</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta S
  </annotation>
 </semantics>
</math>

, and the total amount of work that can be extracted, performed by the system, 

<math display="inline" id="Helmholtz_free_energy:21">
 <semantics>
  <mi>W</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>W</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W
  </annotation>
 </semantics>
</math>

, are well-defined quantities. Conservation of energy implies:</p>

<p>

<math display="block" id="Helmholtz_free_energy:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>U</mi>
      <mtext>bath</mtext>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>U</mi>
    </mrow>
    <mo>+</mo>
    <mi>W</mi>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>U</ci>
       <mtext>bath</mtext>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>U</ci>
     </apply>
     <ci>W</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta U_{\text{bath}}+\Delta U+W=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>The volume of the system is kept constant. This means that the volume of the heat bath does not change either and we can conclude that the heat bath does not perform any work. This implies that the amount of heat that flows into the heat bath is given by:</p>

<p>

<math display="block" id="Helmholtz_free_energy:23">
 <semantics>
  <mrow>
   <msub>
    <mi>Q</mi>
    <mtext>bath</mtext>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <msub>
     <mi>U</mi>
     <mtext>bath</mtext>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>U</mi>
      </mrow>
      <mo>+</mo>
      <mi>W</mi>
     </mrow>
     <mo rspace="4.2pt">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Q</ci>
      <mtext>bath</mtext>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>U</ci>
       <mtext>bath</mtext>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>U</ci>
       </apply>
       <ci>W</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{\text{bath}}=\Delta U_{\text{bath}}=-\left(\Delta U+W\right)\,
  </annotation>
 </semantics>
</math>

</p>

<p>The heat bath remains in thermal equilibrium at temperature T no matter what the system does. Therefore the entropy change of the heat bath is:</p>

<p>

<math display="block" id="Helmholtz_free_energy:24">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <msub>
     <mi>S</mi>
     <mtext>bath</mtext>
    </msub>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>Q</mi>
     <mtext>bath</mtext>
    </msub>
    <mi>T</mi>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>U</mi>
       </mrow>
       <mo>+</mo>
       <mi>W</mi>
      </mrow>
      <mi>T</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <mtext>bath</mtext>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <mtext>bath</mtext>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>U</ci>
        </apply>
        <ci>W</ci>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta S_{\text{bath}}=\frac{Q_{\text{bath}}}{T}=-\frac{\Delta U+W}{T}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The total entropy change is thus given by:</p>

<p>

<math display="block" id="Helmholtz_free_energy:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>S</mi>
      <mtext>bath</mtext>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>S</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>U</mi>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>T</mi>
         <mi mathvariant="normal">Δ</mi>
         <mi>S</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi>W</mi>
      </mrow>
      <mi>T</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <mtext>bath</mtext>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>U</ci>
        </apply>
        <apply>
         <times></times>
         <ci>T</ci>
         <ci>normal-Δ</ci>
         <ci>S</ci>
        </apply>
       </apply>
       <ci>W</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta S_{\text{bath}}+\Delta S=-\frac{\Delta U-T\Delta S+W}{T}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Since the system is in thermal equilibrium with the heat bath in the initial and the final states, T is also the temperature of the system in these states. The fact that the system's temperature does not change allows us to express the numerator as the free energy change of the system:</p>

<p>

<math display="block" id="Helmholtz_free_energy:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>S</mi>
      <mtext>bath</mtext>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>S</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>A</mi>
       </mrow>
       <mo>+</mo>
       <mi>W</mi>
      </mrow>
      <mi>T</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <mtext>bath</mtext>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>A</ci>
       </apply>
       <ci>W</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta S_{\text{bath}}+\Delta S=-\frac{\Delta A+W}{T}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Since the total change in entropy must always be larger or equal to zero, we obtain the inequality:</p>

<p>

<math display="block" id="Helmholtz_free_energy:27">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mo>≤</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <mi>A</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>W</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W\leq-\Delta A\,
  </annotation>
 </semantics>
</math>

</p>

<p>If no work is extracted from the system then</p>

<p>

<math display="block" id="Helmholtz_free_energy:28">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>A</mi>
   </mrow>
   <mo>≤</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>A</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta A\leq 0\,
  </annotation>
 </semantics>
</math>

</p>

<p>We see that for a system kept at constant temperature and volume, the total free energy during a spontaneous change can only decrease, that the total amount of work that can be extracted is limited by the free energy decrease, and that increasing the free energy requires work to be done on the system.</p>

<p>This result seems to contradict the equation 

<math display="inline" id="Helmholtz_free_energy:29">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>S</mi>
      <mi>d</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>P</mi>
     <mi>d</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>d</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dA=-SdT-PdV
  </annotation>
 </semantics>
</math>

, as keeping T and V constant seems to imply 

<math display="inline" id="Helmholtz_free_energy:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>A</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dA=0
  </annotation>
 </semantics>
</math>

 and hence 

<math display="inline" id="Helmholtz_free_energy:31">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mtext>constant</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <mtext>constant</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\text{ constant}
  </annotation>
 </semantics>
</math>

. In reality there is no contradiction. After the spontaneous change, the system, as described by thermodynamics, is a different system with a different free energy function than it was before the spontaneous change. Thus, we can say that 

<math display="inline" id="Helmholtz_free_energy:32">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>A</mi>
     <mn>2</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>A</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>≤</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta A=A_{2}-A_{1}\leq 0
  </annotation>
 </semantics>
</math>

 where the 

<math display="inline" id="Helmholtz_free_energy:33">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i}
  </annotation>
 </semantics>
</math>

 are different thermodynamic functions of state.</p>

<p>One can imagine that the spontaneous change is carried out in a sequence of infinitesimally small steps. To describe such a system thermodynamically, one needs to enlarge the thermodynamical state space of the system. In case of a chemical reaction, one must specify the number of particles of each type. The differential of the free energy then generalizes to:</p>

<p>

<math display="block" id="Helmholtz_free_energy:34">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>S</mi>
       <mi>d</mi>
       <mi>T</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>p</mi>
      <mi>d</mi>
      <mi>V</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <msub>
       <mi>μ</mi>
       <mi>j</mi>
      </msub>
      <mi>d</mi>
      <mpadded width="+1.7pt">
       <msub>
        <mi>N</mi>
        <mi>j</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>S</ci>
        <ci>d</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>d</ci>
       <ci>V</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>j</ci>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dA=-SdT-pdV+\sum_{j}\mu_{j}dN_{j}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where the 

<math display="inline" id="Helmholtz_free_energy:35">
 <semantics>
  <msub>
   <mi>N</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>N</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{j}
  </annotation>
 </semantics>
</math>

 are the numbers of particles of type j and the 

<math display="inline" id="Helmholtz_free_energy:36">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{j}
  </annotation>
 </semantics>
</math>

 are the corresponding <a href="chemical_potential" title="wikilink">chemical potentials</a>. This equation is then again valid for both reversible and non-reversible changes. In case of a spontaneous change at constant T and V, the last term will thus be negative.</p>

<p>In case there are other external parameters the above equation generalizes to:</p>

<p>

<math display="block" id="Helmholtz_free_energy:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>S</mi>
       <mi>d</mi>
       <mi>T</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <msub>
        <mi>X</mi>
        <mi>i</mi>
       </msub>
       <mi>d</mi>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>j</mi>
     </munder>
     <mrow>
      <msub>
       <mi>μ</mi>
       <mi>j</mi>
      </msub>
      <mi>d</mi>
      <mpadded width="+1.7pt">
       <msub>
        <mi>N</mi>
        <mi>j</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>S</ci>
        <ci>d</ci>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>i</ci>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>j</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>j</ci>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dA=-SdT-\sum_{i}X_{i}dx_{i}+\sum_{j}\mu_{j}dN_{j}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Here the 

<math display="inline" id="Helmholtz_free_energy:38">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 are the external variables and the 

<math display="inline" id="Helmholtz_free_energy:39">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}
  </annotation>
 </semantics>
</math>

 the corresponding <a href="generalized_forces" title="wikilink">generalized forces</a>.</p>
<h2 id="relation-to-the-canonical-partition-function">Relation to the canonical partition function</h2>

<p>A system kept at constant volume, temperature, and particle number is described by the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>. The probability to find the system in some energy eigenstate <em>r</em> is given by:</p>

<p>

<math display="block" id="Helmholtz_free_energy:40">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>β</mi>
        <msub>
         <mi>E</mi>
         <mi>r</mi>
        </msub>
       </mrow>
      </mrow>
     </msup>
     <mi>Z</mi>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{r}=\frac{e^{-\beta E_{r}}}{Z}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Helmholtz_free_energy:41">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mo>≡</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>k</mi>
      <mi>T</mi>
     </mrow>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>β</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta\equiv\frac{1}{kT}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Helmholtz_free_energy:42">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mtext>energy of eigenstate</mtext>
    <mpadded width="+1.7pt">
     <mi>r</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <mtext>energy of eigenstate</mtext>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{r}=\text{ energy of eigenstate }r\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Helmholtz_free_energy:43">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>β</mi>
       <msub>
        <mi>E</mi>
        <mi>r</mi>
       </msub>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Z</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>E</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z=\sum_{r}e^{-\beta E_{r}}
  </annotation>
 </semantics>
</math>

</p>

<p><em>Z</em> is called the <a href="partition_function_(statistical_mechanics)" title="wikilink">partition function</a> of the system. The fact that the system does not have a unique energy means that the various thermodynamical quantities must be defined as expectation values. In the thermodynamical limit of infinite system size, the relative fluctuations in these averages will go to zero.</p>

<p>The average internal energy of the system is the expectation value of the energy and can be expressed in terms of <em>Z</em> as follows:</p>

<p>

<math display="block" id="Helmholtz_free_energy:44">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>≡</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>E</mi>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>r</mi>
     </msub>
     <msub>
      <mi>E</mi>
      <mi>r</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <mi>log</mi>
       </mrow>
       <mi>Z</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>β</mi>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <ci>U</ci>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>E</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>r</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <partialdiff></partialdiff>
         <log></log>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U\equiv\left\langle E\right\rangle=\sum_{r}P_{r}E_{r}=-\frac{\partial\log Z}{%
\partial\beta}\,
  </annotation>
 </semantics>
</math>

</p>

<p>If the system is in state <em>r</em>, then the generalized force corresponding to an external variable <em>x</em> is given by</p>

<p>

<math display="block" id="Helmholtz_free_energy:45">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>E</mi>
        <mi>r</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{r}=-\frac{\partial E_{r}}{\partial x}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The thermal average of this can be written as:</p>

<p>

<math display="block" id="Helmholtz_free_energy:46">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mi>P</mi>
      <mi>r</mi>
     </msub>
     <msub>
      <mi>X</mi>
      <mi>r</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>β</mi>
    </mfrac>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <mi>log</mi>
       </mrow>
       <mi>Z</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>X</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>r</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>β</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <partialdiff></partialdiff>
         <log></log>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\sum_{r}P_{r}X_{r}=\frac{1}{\beta}\frac{\partial\log Z}{\partial x}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Suppose the system has one external variable 

<math display="inline" id="Helmholtz_free_energy:47">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. Then changing the system's temperature parameter by 

<math display="inline" id="Helmholtz_free_energy:48">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\beta
  </annotation>
 </semantics>
</math>

 and the external variable by 

<math display="inline" id="Helmholtz_free_energy:49">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dx
  </annotation>
 </semantics>
</math>

 will lead to a change in 

<math display="inline" id="Helmholtz_free_energy:50">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mi>Z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <log></log>
    <ci>Z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log Z
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Helmholtz_free_energy:51">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>log</mi>
      <mi>Z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <mi>log</mi>
       </mrow>
       <mi>Z</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>β</mi>
      </mrow>
     </mfrac>
     <mi>d</mi>
     <mi>β</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <mi>log</mi>
       </mrow>
       <mi>Z</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
     </mfrac>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>U</mi>
      </mpadded>
      <mi>d</mi>
      <mi>β</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>β</mi>
     <mpadded width="+1.7pt">
      <mi>X</mi>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>x</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <log></log>
       <ci>Z</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <partialdiff></partialdiff>
          <log></log>
         </apply>
         <ci>Z</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>β</ci>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <partialdiff></partialdiff>
          <log></log>
         </apply>
         <ci>Z</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>U</ci>
        <ci>d</ci>
        <ci>β</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>X</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\left(\log Z\right)=\frac{\partial\log Z}{\partial\beta}d\beta+\frac{\partial%
\log Z}{\partial x}dx=-U\,d\beta+\beta X\,dx\,
  </annotation>
 </semantics>
</math>

</p>

<p>If we write 

<math display="inline" id="Helmholtz_free_energy:52">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>U</mi>
   </mpadded>
   <mi>d</mi>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <ci>d</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U\,d\beta
  </annotation>
 </semantics>
</math>

 as:</p>

<p>

<math display="block" id="Helmholtz_free_energy:53">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>U</mi>
    </mpadded>
    <mi>d</mi>
    <mi>β</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>β</mi>
       <mi>U</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>β</mi>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>U</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>d</ci>
     <ci>β</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>U</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>d</ci>
      <ci>U</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U\,d\beta=d\left(\beta U\right)-\beta\,dU\,
  </annotation>
 </semantics>
</math>

</p>

<p>we get:</p>

<p>

<math display="block" id="Helmholtz_free_energy:54">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>log</mi>
      <mi>Z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>β</mi>
        <mi>U</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>β</mi>
     </mpadded>
     <mi>d</mi>
     <mi>U</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>β</mi>
     <mpadded width="+1.7pt">
      <mi>X</mi>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>x</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <apply>
      <log></log>
      <ci>Z</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>U</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>d</ci>
      <ci>U</ci>
     </apply>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>X</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\left(\log Z\right)=-d\left(\beta U\right)+\beta\,dU+\beta X\,dx\,
  </annotation>
 </semantics>
</math>

</p>

<p>This means that the change in the internal energy is given by:</p>

<p>

<math display="block" id="Helmholtz_free_energy:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>U</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>β</mi>
     </mfrac>
     <mi>d</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>log</mi>
        <mi>Z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>β</mi>
        <mi>U</mi>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>X</mi>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>x</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>β</ci>
      </apply>
      <ci>d</ci>
      <apply>
       <plus></plus>
       <apply>
        <log></log>
        <ci>Z</ci>
       </apply>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>U</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dU=\frac{1}{\beta}d\left(\log Z+\beta U\right)-X\,dx\,
  </annotation>
 </semantics>
</math>

</p>

<p>In the thermodynamic limit, the <a href="fundamental_thermodynamic_relation" title="wikilink">fundamental thermodynamic relation</a> should hold:</p>

<p>

<math display="block" id="Helmholtz_free_energy:56">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi>U</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>T</mi>
     </mpadded>
     <mi>d</mi>
     <mi>S</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>X</mi>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <mi>x</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>d</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   dU=T\,dS-X\,dx\,
  </annotation>
 </semantics>
</math>

</p>

<p>This then implies that the entropy of the system is given by:</p>

<p>

<math display="block" id="Helmholtz_free_energy:57">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>k</mi>
     <mrow>
      <mi>log</mi>
      <mi>Z</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mfrac>
     <mi>U</mi>
     <mi>T</mi>
    </mfrac>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>c</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>k</ci>
      <apply>
       <log></log>
       <ci>Z</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <ci>U</ci>
      <ci>T</ci>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=k\log Z+\frac{U}{T}+c\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>c</em> is some constant. The value of <em>c</em> can be determined by considering the limit <em>T</em> → 0. In this limit the entropy becomes 

<math display="inline" id="Helmholtz_free_energy:58">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mi>k</mi>
    <mrow>
     <mi>log</mi>
     <msub>
      <mi mathvariant="normal">Ω</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <ci>k</ci>
     <apply>
      <log></log>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ω</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=k\log\Omega_{0}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Helmholtz_free_energy:59">
 <semantics>
  <msub>
   <mi mathvariant="normal">Ω</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Ω</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega_{0}
  </annotation>
 </semantics>
</math>

 is the ground state degeneracy. The partition function in this limit is 

<math display="inline" id="Helmholtz_free_energy:60">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Ω</mi>
    <mn>0</mn>
   </msub>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <msub>
       <mi>U</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Ω</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega_{0}e^{-\beta U_{0}}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Helmholtz_free_energy:61">
 <semantics>
  <msub>
   <mi>U</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>U</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{0}
  </annotation>
 </semantics>
</math>

 is the ground state energy. Thus, we see that 

<math display="inline" id="Helmholtz_free_energy:62">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=0
  </annotation>
 </semantics>
</math>

 and that:</p>

<p>

<math display="block" id="Helmholtz_free_energy:63">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>k</mi>
     <mi>T</mi>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <mi>Z</mi>
       <mo rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>T</ci>
      <apply>
       <log></log>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=-kT\log\left(Z\right)\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="bogoliubov-inequality">Bogoliubov inequality</h2>

<p>Computing the free energy is an intractable problem for all but the simplest models in statistical physics. A powerful approximation method is <a href="mean_field_theory" title="wikilink">mean field theory</a>, which is a variational method based on the <a href="Bogoliubov_inequality" title="wikilink">Bogoliubov inequality</a>. This inequality can be formulated as follows.</p>

<p>Suppose we replace the real Hamiltonian 

<math display="inline" id="Helmholtz_free_energy:64">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 of the model by a trial Hamiltonian 

<math display="inline" id="Helmholtz_free_energy:65">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

, which has different interactions and may depend on extra parameters that are not present in the original model. If we choose this trial Hamiltonian such that</p>

<p>

<math display="block" id="Helmholtz_free_energy:66">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <mover accent="true">
     <mi>H</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>H</mi>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>H</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>H</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\tilde{H}\right\rangle=\left\langle H\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>where both averages are taken with respect to the canonical distribution defined by the trial Hamiltonian 

<math display="inline" id="Helmholtz_free_energy:67">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

, then</p>

<p>

<math display="block" id="Helmholtz_free_energy:68">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≤</mo>
   <mpadded width="+1.7pt">
    <mover accent="true">
     <mi>A</mi>
     <mo stretchy="false">~</mo>
    </mover>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>A</ci>
    <apply>
     <ci>normal-~</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\leq\tilde{A}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Helmholtz_free_energy:69">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 is the free energy of the original Hamiltonian and 

<math display="inline" id="Helmholtz_free_energy:70">
 <semantics>
  <mover accent="true">
   <mi>A</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{A}
  </annotation>
 </semantics>
</math>

 is the free energy of the trial Hamiltonian. By including a large number of parameters in the trial Hamiltonian and minimizing the free energy we can expect to get a close approximation to the exact free energy.</p>

<p>The Bogoliubov inequality is often formulated in a slightly different but equivalent way. If we write the Hamiltonian as:</p>

<p>

<math display="block" id="Helmholtz_free_energy:71">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <mi>H</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=H_{0}+\Delta H\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Helmholtz_free_energy:72">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}
  </annotation>
 </semantics>
</math>

 is exactly solvable, then we can apply the above inequality by defining</p>

<p>

<math display="block" id="Helmholtz_free_energy:73">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>H</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mrow>
       <mo>⟨</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>H</mi>
       </mrow>
       <mo>⟩</mo>
      </mrow>
      <mn>0</mn>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-~</ci>
     <ci>H</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>H</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}=H_{0}+\left\langle\Delta H\right\rangle_{0}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Here we have defined 

<math display="inline" id="Helmholtz_free_energy:74">
 <semantics>
  <msub>
   <mrow>
    <mo>⟨</mo>
    <mi>X</mi>
    <mo>⟩</mo>
   </mrow>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>X</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle X\right\rangle_{0}
  </annotation>
 </semantics>
</math>

 to be the average of X over the canonical ensemble defined by 

<math display="inline" id="Helmholtz_free_energy:75">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}
  </annotation>
 </semantics>
</math>

. Since 

<math display="inline" id="Helmholtz_free_energy:76">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 defined this way differs from 

<math display="inline" id="Helmholtz_free_energy:77">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}
  </annotation>
 </semantics>
</math>

 by a constant, we have in general</p>

<p>

<math display="block" id="Helmholtz_free_energy:78">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <mi>X</mi>
     <mo>⟩</mo>
    </mrow>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>X</mi>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>X</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle X\right\rangle_{0}=\left\langle X\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore</p>

<p>

<math display="block" id="Helmholtz_free_energy:79">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <mover accent="true">
     <mi>H</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>H</mi>
      </mrow>
      <mo>⟩</mo>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>H</mi>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>H</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>H</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>H</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\tilde{H}\right\rangle=\left\langle H_{0}+\left\langle\Delta H%
\right\rangle\right\rangle=\left\langle H\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>And thus the inequality</p>

<p>

<math display="block" id="Helmholtz_free_energy:80">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≤</mo>
   <mpadded width="+1.7pt">
    <mover accent="true">
     <mi>A</mi>
     <mo stretchy="false">~</mo>
    </mover>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>A</ci>
    <apply>
     <ci>normal-~</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\leq\tilde{A}\,
  </annotation>
 </semantics>
</math>

</p>

<p>holds. The free energy 

<math display="inline" id="Helmholtz_free_energy:81">
 <semantics>
  <mover accent="true">
   <mi>A</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{A}
  </annotation>
 </semantics>
</math>

 is the free energy of the model defined by 

<math display="inline" id="Helmholtz_free_energy:82">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}
  </annotation>
 </semantics>
</math>

 plus 

<math display="inline" id="Helmholtz_free_energy:83">
 <semantics>
  <mrow>
   <mo>⟨</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>H</mi>
   </mrow>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>H</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\Delta H\right\rangle
  </annotation>
 </semantics>
</math>

. This means that</p>

<p>

<math display="block" id="Helmholtz_free_energy:84">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>A</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mrow>
       <mo>⟨</mo>
       <msub>
        <mi>H</mi>
        <mn>0</mn>
       </msub>
       <mo>⟩</mo>
      </mrow>
      <mn>0</mn>
     </msub>
     <mo>-</mo>
     <mrow>
      <mi>T</mi>
      <msub>
       <mi>S</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>H</mi>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mi>H</mi>
      <mo>⟩</mo>
     </mrow>
     <mn>0</mn>
    </msub>
    <mo>-</mo>
    <mrow>
     <mi>T</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>S</mi>
       <mn>0</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-~</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-⟨⟩</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <ci>T</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>H</ci>
        </apply>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <ci>H</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{A}=\left\langle H_{0}\right\rangle_{0}-TS_{0}+\left\langle\Delta H%
\right\rangle_{0}=\left\langle H\right\rangle_{0}-TS_{0}\,
  </annotation>
 </semantics>
</math>

</p>

<p>and thus:</p>

<p>

<math display="block" id="Helmholtz_free_energy:85">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≤</mo>
   <mrow>
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mi>H</mi>
      <mo>⟩</mo>
     </mrow>
     <mn>0</mn>
    </msub>
    <mo>-</mo>
    <mrow>
     <mi>T</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>S</mi>
       <mn>0</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>H</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\leq\left\langle H\right\rangle_{0}-TS_{0}\,
  </annotation>
 </semantics>
</math>

</p>
<h3 id="proof">Proof</h3>

<p>For a classical model we can prove the Bogoliubov inequality as follows. We denote the canonical probability distributions for the Hamiltonian and the trial Hamiltonian by 

<math display="inline" id="Helmholtz_free_energy:86">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{r}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Helmholtz_free_energy:87">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>P</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>P</ci>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{P}_{r}
  </annotation>
 </semantics>
</math>

, respectively. The inequality:</p>

<p>

<math display="block" id="Helmholtz_free_energy:88">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mover accent="true">
         <mi>P</mi>
         <mo stretchy="false">~</mo>
        </mover>
        <mi>r</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>P</mi>
        <mi>r</mi>
       </msub>
       <mo rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>P</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <log></log>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-~</ci>
         <ci>P</ci>
        </apply>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>P</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <log></log>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{r}\tilde{P}_{r}\log\left(\tilde{P}_{r}\right)\geq\sum_{r}\tilde{P}_{r}%
\log\left(P_{r}\right)\,
  </annotation>
 </semantics>
</math>

</p>

<p>then holds. To see this, consider the difference between the left hand side and the right hand side. We can write this as:</p>

<p>

<math display="block" id="Helmholtz_free_energy:89">
 <semantics>
  <mrow>
   <munder>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mi>r</mi>
   </munder>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>P</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mi>r</mi>
    </msub>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <msub>
        <mover accent="true">
         <mi>P</mi>
         <mo stretchy="false">~</mo>
        </mover>
        <mi>r</mi>
       </msub>
       <msub>
        <mi>P</mi>
        <mi>r</mi>
       </msub>
      </mfrac>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>P</ci>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <log></log>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-~</ci>
         <ci>P</ci>
        </apply>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{r}\tilde{P}_{r}\log\left(\frac{\tilde{P}_{r}}{P_{r}}\right)\,
  </annotation>
 </semantics>
</math>

</p>

<p>Since</p>

<p>

<math display="block" id="Helmholtz_free_energy:90">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mn>1</mn>
      <mi>x</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <log></log>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log\left(x\right)\geq 1-\frac{1}{x}\,
  </annotation>
 </semantics>
</math>

</p>

<p>it follows that:</p>

<p>

<math display="block" id="Helmholtz_free_energy:91">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <msub>
         <mover accent="true">
          <mi>P</mi>
          <mo stretchy="false">~</mo>
         </mover>
         <mi>r</mi>
        </msub>
        <msub>
         <mi>P</mi>
         <mi>r</mi>
        </msub>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>P</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mi>r</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>P</mi>
       <mi>r</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>r</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-~</ci>
         <ci>P</ci>
        </apply>
        <ci>r</ci>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-~</ci>
           <ci>P</ci>
          </apply>
          <ci>r</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>r</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-~</ci>
         <ci>P</ci>
        </apply>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{r}\tilde{P}_{r}\log\left(\frac{\tilde{P}_{r}}{P_{r}}\right)\geq\sum_{r}%
\left(\tilde{P}_{r}-P_{r}\right)=0\,
  </annotation>
 </semantics>
</math>

</p>

<p>where in the last step we have used that both probability distributions are normalized to 1.</p>

<p>We can write the inequality as:</p>

<p>

<math display="block" id="Helmholtz_free_energy:92">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mover accent="true">
        <mi>P</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mi>r</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <mo>⟨</mo>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>P</mi>
       <mi>r</mi>
      </msub>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <log></log>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>P</ci>
       </apply>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <log></log>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\log\left(\tilde{P}_{r}\right)\right\rangle\geq\left\langle\log%
\left(P_{r}\right)\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>where the averages are taken with respect to 

<math display="inline" id="Helmholtz_free_energy:93">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>P</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>P</ci>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{P}_{r}
  </annotation>
 </semantics>
</math>

. If we now substitute in here the expressions for the probability distributions:</p>

<p>

<math display="block" id="Helmholtz_free_energy:94">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>H</mi>
         <mrow>
          <mo>(</mo>
          <mi>r</mi>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mi>Z</mi>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>H</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{r}=\frac{\exp\left[-\beta H\left(r\right)\right]}{Z}\,
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Helmholtz_free_energy:95">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>P</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mover accent="true">
          <mi>H</mi>
          <mo stretchy="false">~</mo>
         </mover>
         <mrow>
          <mo>(</mo>
          <mi>r</mi>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mover accent="true">
      <mi>Z</mi>
      <mo stretchy="false">~</mo>
     </mover>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>P</ci>
     </apply>
     <ci>r</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <ci>normal-~</ci>
         <ci>H</ci>
        </apply>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-~</ci>
      <ci>Z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{P}_{r}=\frac{\exp\left[-\beta\tilde{H}\left(r\right)\right]}{\tilde{Z}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>we get:</p>

<p>

<math display="block" id="Helmholtz_free_energy:96">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>β</mi>
       <mover accent="true">
        <mi>H</mi>
        <mo stretchy="false">~</mo>
       </mover>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <mover accent="true">
        <mi>Z</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <mo>⟨</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>β</mi>
       <mi>H</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <mi>Z</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <apply>
         <ci>normal-~</ci>
         <ci>H</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <log></log>
       <apply>
        <ci>normal-~</ci>
        <ci>Z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>H</ci>
       </apply>
      </apply>
      <apply>
       <log></log>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle-\beta\tilde{H}-\log\left(\tilde{Z}\right)\right\rangle\geq\left%
\langle-\beta H-\log\left(Z\right)\right\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>Since the averages of 

<math display="inline" id="Helmholtz_free_energy:97">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Helmholtz_free_energy:98">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 are, by assumption, identical we have:</p>

<p>

<math display="block" id="Helmholtz_free_energy:99">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≤</mo>
   <mover accent="true">
    <mi>A</mi>
    <mo stretchy="false">~</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>A</ci>
    <apply>
     <ci>normal-~</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\leq\tilde{A}
  </annotation>
 </semantics>
</math>

</p>

<p>Here we have used that the partition functions are constants with respect to taking averages and that the free energy is proportional to minus the logarithm of the partition function.</p>

<p>We can easily generalize this proof to the case of quantum mechanical models. We denote the eigenstates of 

<math display="inline" id="Helmholtz_free_energy:100">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Helmholtz_free_energy:101">
 <semantics>
  <mrow>
   <mo fence="true">|</mo>
   <mi>r</mi>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|r\right\rangle
  </annotation>
 </semantics>
</math>

. We denote the diagonal components of the density matrices for the canonical distributions for 

<math display="inline" id="Helmholtz_free_energy:102">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Helmholtz_free_energy:103">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 in this basis as:</p>

<p>

<math display="block" id="Helmholtz_free_energy:104">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>r</mi>
    <mo fence="true">|</mo>
    <mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>H</mi>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mi>Z</mi>
    </mfrac>
    <mo fence="true">|</mo>
    <mi>r</mi>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <ci>r</ci>
     <apply>
      <divide></divide>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>β</ci>
         <ci>H</ci>
        </apply>
       </apply>
      </apply>
      <ci>Z</ci>
     </apply>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{r}=\left\langle r\left|\frac{\exp\left[-\beta H\right]}{Z}\right|r\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Helmholtz_free_energy:105">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>P</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>r</mi>
    <mo fence="true">|</mo>
    <mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mover accent="true">
          <mi>H</mi>
          <mo stretchy="false">~</mo>
         </mover>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mover accent="true">
      <mi>Z</mi>
      <mo stretchy="false">~</mo>
     </mover>
    </mfrac>
    <mo fence="true">|</mo>
    <mi>r</mi>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <msub>
          <mover accent="true">
           <mi>E</mi>
           <mo stretchy="false">~</mo>
          </mover>
          <mi>r</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mover accent="true">
      <mi>Z</mi>
      <mo stretchy="false">~</mo>
     </mover>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>P</ci>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <ci>r</ci>
      <apply>
       <divide></divide>
       <apply>
        <exp></exp>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <apply>
           <ci>normal-~</ci>
           <ci>H</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <ci>Z</ci>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>β</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-~</ci>
           <ci>E</ci>
          </apply>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-~</ci>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{P}_{r}=\left\langle r\left|\frac{\exp\left[-\beta\tilde{H}\right]}{%
\tilde{Z}}\right|r\right\rangle=\frac{\exp\left(-\beta\tilde{E}_{r}\right)}{%
\tilde{Z}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where the 

<math display="inline" id="Helmholtz_free_energy:106">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>E</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>E</ci>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{E}_{r}
  </annotation>
 </semantics>
</math>

 are the eigenvalues of 

<math display="inline" id="Helmholtz_free_energy:107">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

</p>

<p>We assume again that the averages of H and 

<math display="inline" id="Helmholtz_free_energy:108">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 in the canonical ensemble defined by 

<math display="inline" id="Helmholtz_free_energy:109">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 are the same:</p>

<p>

<math display="block" id="Helmholtz_free_energy:110">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <mover accent="true">
     <mi>H</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>H</mi>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>H</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>H</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\tilde{H}\right\rangle=\left\langle H\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Helmholtz_free_energy:111">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <mi>H</mi>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mrow>
      <mo>⟨</mo>
      <mi>r</mi>
      <mo fence="true">|</mo>
      <mi>H</mi>
      <mo fence="true">|</mo>
      <mi>r</mi>
      <mo rspace="4.2pt">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>H</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>P</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <ci>r</ci>
       <ci>H</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle H\right\rangle=\sum_{r}\tilde{P}_{r}\left\langle r\left|H\right|r%
\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>The inequality</p>

<p>

<math display="block" id="Helmholtz_free_energy:112">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mover accent="true">
         <mi>P</mi>
         <mo stretchy="false">~</mo>
        </mover>
        <mi>r</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>r</mi>
    </munder>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>P</mi>
        <mi>r</mi>
       </msub>
       <mo rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>P</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <log></log>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-~</ci>
         <ci>P</ci>
        </apply>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>P</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <log></log>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{r}\tilde{P}_{r}\log\left(\tilde{P}_{r}\right)\geq\sum_{r}\tilde{P}_{r}%
\log\left(P_{r}\right)\,
  </annotation>
 </semantics>
</math>

</p>

<p>still holds as both the 

<math display="inline" id="Helmholtz_free_energy:113">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{r}
  </annotation>
 </semantics>
</math>

 and the 

<math display="inline" id="Helmholtz_free_energy:114">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>P</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>r</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-~</ci>
     <ci>P</ci>
    </apply>
    <ci>r</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{P}_{r}
  </annotation>
 </semantics>
</math>

 sum to 1. On the l.h.s. we can replace:</p>

<p>

<math display="block" id="Helmholtz_free_energy:115">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mi>r</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>β</mi>
      <msub>
       <mover accent="true">
        <mi>E</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mi>r</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo>(</mo>
      <mover accent="true">
       <mi>Z</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <log></log>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>P</ci>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>β</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-~</ci>
         <ci>E</ci>
        </apply>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <log></log>
      <apply>
       <ci>normal-~</ci>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log\left(\tilde{P}_{r}\right)=-\beta\tilde{E}_{r}-\log\left(\tilde{Z}\right)\,
  </annotation>
 </semantics>
</math>

</p>

<p>On the right hand side we can use the inequality</p>

<p>

<math display="block" id="Helmholtz_free_energy:116">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mi>X</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>⟩</mo>
    </mrow>
    <mi>r</mi>
   </msub>
   <mo>≥</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mrow>
       <mo>⟨</mo>
       <mi>X</mi>
       <mo>⟩</mo>
      </mrow>
      <mi>r</mi>
     </msub>
     <mo rspace="4.2pt">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <exp></exp>
       <ci>X</ci>
      </apply>
     </apply>
     <ci>r</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>X</ci>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\exp\left(X\right)\right\rangle_{r}\geq\exp\left(\left\langle X%
\right\rangle_{r}\right)\,
  </annotation>
 </semantics>
</math>

 where we have introduced the notation</p>

<p>

<math display="block" id="Helmholtz_free_energy:117">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>⟨</mo>
     <mi>Y</mi>
     <mo>⟩</mo>
    </mrow>
    <mi>r</mi>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mo>⟨</mo>
    <mi>r</mi>
    <mo fence="true">|</mo>
    <mi>Y</mi>
    <mo fence="true">|</mo>
    <mi>r</mi>
    <mo rspace="4.2pt">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>Y</ci>
     </apply>
     <ci>r</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <ci>r</ci>
     <ci>Y</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle Y\right\rangle_{r}\equiv\left\langle r\left|Y\right|r\right\rangle\,
  </annotation>
 </semantics>
</math>

</p>

<p>for the expectation value of the operator Y in the state r. <a href="Jensen's_inequality#Statistical_physics" title="wikilink">See here</a> for a proof. Taking the logarithm of this inequality gives:</p>

<p>

<math display="block" id="Helmholtz_free_energy:118">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo>[</mo>
     <msub>
      <mrow>
       <mo>⟨</mo>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo>(</mo>
         <mi>X</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>⟩</mo>
      </mrow>
      <mi>r</mi>
     </msub>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mi>X</mi>
      <mo>⟩</mo>
     </mrow>
     <mi>r</mi>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <log></log>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <exp></exp>
        <ci>X</ci>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>X</ci>
     </apply>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log\left[\left\langle\exp\left(X\right)\right\rangle_{r}\right]\geq\left%
\langle X\right\rangle_{r}\,
  </annotation>
 </semantics>
</math>

</p>

<p>This allows us to write:</p>

<p>

<math display="block" id="Helmholtz_free_energy:119">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>P</mi>
      <mi>r</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo>[</mo>
     <msub>
      <mrow>
       <mo>⟨</mo>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>β</mi>
            <mi>H</mi>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mi>log</mi>
           <mrow>
            <mo>(</mo>
            <mi>Z</mi>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>⟩</mo>
      </mrow>
      <mi>r</mi>
     </msub>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mrow>
      <mo>⟨</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>H</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>log</mi>
        <mrow>
         <mo>(</mo>
         <mi>Z</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>⟩</mo>
     </mrow>
     <mi>r</mi>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <log></log>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <log></log>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <exp></exp>
         <apply>
          <minus></minus>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <ci>β</ci>
            <ci>H</ci>
           </apply>
          </apply>
          <apply>
           <log></log>
           <ci>Z</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>H</ci>
         </apply>
        </apply>
        <apply>
         <log></log>
         <ci>Z</ci>
        </apply>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log\left(P_{r}\right)=\log\left[\left\langle\exp\left(-\beta H-\log\left(Z%
\right)\right)\right\rangle_{r}\right]\geq\left\langle-\beta H-\log\left(Z%
\right)\right\rangle_{r}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The fact that the averages of H and 

<math display="inline" id="Helmholtz_free_energy:120">
 <semantics>
  <mover accent="true">
   <mi>H</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{H}
  </annotation>
 </semantics>
</math>

 are the same then leads to the same conclusion as in the classical case:</p>

<p>

<math display="block" id="Helmholtz_free_energy:121">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≤</mo>
   <mover accent="true">
    <mi>A</mi>
    <mo stretchy="false">~</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>A</ci>
    <apply>
     <ci>normal-~</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\leq\tilde{A}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="generalized-helmholtz-energy">Generalized Helmholtz energy</h2>

<p>In the more general case, the mechanical term (

<math display="inline" id="Helmholtz_free_energy:122">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mi mathvariant="normal">d</mi>
   <mi>V</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>normal-d</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p{\rm d}V
  </annotation>
 </semantics>
</math>

) must be replaced by the product of volume, <a href="Stress_(physics)" title="wikilink">stress</a>, and an infinitesimal strain:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Helmholtz_free_energy:123">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">d</mi>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>V</mi>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mi>j</mi>
        </mrow>
       </munder>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>σ</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
        </mpadded>
        <mi mathvariant="normal">d</mi>
        <msub>
         <mi>ε</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>S</mi>
      <mi mathvariant="normal">d</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>μ</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
      <mi mathvariant="normal">d</mi>
      <mpadded width="+1.7pt">
       <msub>
        <mi>N</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-d</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>V</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <ci>normal-d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ε</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>normal-d</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm d}A=V\sum_{ij}\sigma_{ij}\,{\rm d}\varepsilon_{ij}-S{\rm d}T+\sum_{i}\mu_%
{i}\,{\rm d}N_{i}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Helmholtz_free_energy:124">
 <semantics>
  <msub>
   <mi>σ</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>σ</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{ij}
  </annotation>
 </semantics>
</math>

 is the stress tensor, and 

<math display="inline" id="Helmholtz_free_energy:125">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{ij}
  </annotation>
 </semantics>
</math>

 is the strain tensor. In the case of linear <a href="Elasticity_(physics)" title="wikilink">elastic</a> materials that obey <a href="Hooke's_Law" title="wikilink">Hooke's Law</a>, the stress is related to the strain by:</p>

<p>

<math display="block" id="Helmholtz_free_energy:126">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
      <mi>k</mi>
      <mi>l</mi>
     </mrow>
    </msub>
    <msub>
     <mi>ϵ</mi>
     <mrow>
      <mi>k</mi>
      <mi>l</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
       <ci>k</ci>
       <ci>l</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{ij}=C_{ijkl}\epsilon_{kl}
  </annotation>
 </semantics>
</math>

</p>

<p>where we are now using <a href="Einstein_notation" title="wikilink">Einstein notation</a> for the tensors, in which repeated indices in a product are summed. We may integrate the expression for 

<math display="inline" id="Helmholtz_free_energy:127">
 <semantics>
  <mrow>
   <mi mathvariant="normal">d</mi>
   <mi>A</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-d</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm d}A
  </annotation>
 </semantics>
</math>

 to obtain the Helmholtz energy:</p>

<p>

<math display="block" id="Helmholtz_free_energy:128">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>V</mi>
      <msub>
       <mi>C</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
        <mi>k</mi>
        <mi>l</mi>
       </mrow>
      </msub>
      <msub>
       <mi>ϵ</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>ϵ</mi>
       <mrow>
        <mi>k</mi>
        <mi>l</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>S</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <msub>
       <mi>μ</mi>
       <mi>i</mi>
      </msub>
      <mpadded width="+1.7pt">
       <msub>
        <mi>N</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>V</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
         <ci>k</ci>
         <ci>l</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>l</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\frac{1}{2}VC_{ijkl}\epsilon_{ij}\epsilon_{kl}-ST+\sum_{i}\mu_{i}N_{i}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Helmholtz_free_energy:129">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>V</mi>
      <msub>
       <mi>σ</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>ϵ</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>S</mi>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <msub>
       <mi>μ</mi>
       <mi>i</mi>
      </msub>
      <mpadded width="+1.7pt">
       <msub>
        <mi>N</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>V</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>T</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\frac{1}{2}V\sigma_{ij}\epsilon_{ij}-ST+\sum_{i}\mu_{i}N_{i}\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="application-to-fundamental-equations-of-state">Application to fundamental equations of state</h2>

<p>The Helmholtz free energy function for a pure substance (together with its partial derivatives) can be used to determine all other thermodynamic properties for the substance. See, for example, the equations of state for <a class="uri" href="water" title="wikilink">water</a>, as given by the <a class="uri" href="IAPWS" title="wikilink">IAPWS</a> in their <a href="http://www.iapws.org/relguide/IAPWS95-Rev.pdf">IAPWS-95</a> release.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Gibbs_free_energy" title="wikilink">Gibbs free energy</a> and <a href="thermodynamic_free_energy" title="wikilink">thermodynamic free energy</a> for thermodynamics history overview and discussion of <em>free energy</em></li>
<li><a href="Grand_potential" title="wikilink">Grand potential</a></li>
<li><a href="Work_content" title="wikilink">Work content</a> - for applications to <a class="uri" href="chemistry" title="wikilink">chemistry</a></li>
<li><a href="Statistical_mechanics" title="wikilink">Statistical mechanics</a></li>
<li>This page details the Helmholtz energy from the point of view of <a href="thermodynamics" title="wikilink">thermal</a> and <a href="statistical_physics" title="wikilink">statistical</a> <a class="uri" href="physics" title="wikilink">physics</a>.</li>
<li><a href="Bennett_acceptance_ratio" title="wikilink">Bennett acceptance ratio</a> for an efficient way to calculate free energy differences, and comparison with other methods.</li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>Atkins' <em>Physical Chemistry</em>, 7th edition, by <a href="Peter_Atkins" title="wikilink">Peter Atkins</a> and Julio de Paula, Oxford University Press</li>
</ul>
<ul>
<li>HyperPhysics Helmholtz Free Energy <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/thermo/helmholtz.html">1</a></li>
</ul>

<p>"</p>

<p><a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a> <a href="Category:State_functions" title="wikilink">Category:State functions</a> <a href="Category:Thermodynamic_free_energy" title="wikilink">Category:Thermodynamic free energy</a> <a href="Category:Hermann_von_Helmholtz" title="wikilink">Category:Hermann von Helmholtz</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Levine, Ira. N. (1978). "<em>Physical Chemistry</em>" McGraw Hill: University of Brooklyn<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="851">Ridge detection</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Ridge detection</h1>
<hr/>

<p>The attempt (via software) to locate ridges (or edges) in an image.</p>

<p>In <a href="mathematic" title="wikilink">mathematics</a> and <a href="computer_vision" title="wikilink">computer vision</a>, the <strong>ridges</strong> (or the <strong>ridge set</strong>) of a <a href="smooth_function" title="wikilink">smooth function</a> of two variables are a set of curves whose points are, in one or more ways to be made precise below, <a href="local_maxima" title="wikilink">local maxima</a> of the function in at least one dimension. This notion captures the intuition of geographical <a href="ridge" title="wikilink">ridges</a>. For a function of 

<math display="inline" id="Ridge_detection:0">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 variables, its ridges are a set of curves whose points are local maxima in 

<math display="inline" id="Ridge_detection:1">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N-1
  </annotation>
 </semantics>
</math>

 dimensions. In this respect, the notion of ridge points extends the concept of a <a href="maxima_and_minima" title="wikilink">local maximum</a>. Correspondingly, the notion of <strong>valleys</strong> for a function can be defined by replacing the condition of a local maximum with the condition of a <a href="local_minimum" title="wikilink">local minimum</a>. The union of ridge sets and valley sets, together with a related set of points called the <strong>connector set</strong> form a connected set of curves that partition, intersect, or meet at the critical points of the function. This union of sets together is called the function's <strong>relative critical set</strong>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>Ridge sets, valley sets, and relative critical sets represent important geometric information intrinsic to a function. In a way, they provide a compact representation of important features of the function, but the extent to which they can be used to determine global features of the function is an open question. The primary motivation for the creation of <strong>ridge detection</strong> and <strong>valley detection</strong> procedures has come from <a href="image_analysis" title="wikilink">image analysis</a> and <a href="computer_vision" title="wikilink">computer vision</a> and is to capture the interior of elongated objects in the image domain. Ridge-related representations in terms of <a href="Watershed_(algorithm)" title="wikilink">watersheds</a> have been used for <a href="image_segmentation" title="wikilink">image segmentation</a>. There have also been attempts to capture the shapes of objects by graph-based representations that reflect ridges, valleys and critical points in the image domain. Such representations may, however, be highly noise sensitive if computed at a single scale only. Because scale-space theoretic computations involve convolution with the Gaussian (smoothing) kernel, it has been hoped that use of multi-scale ridges, valleys and critical points in the context of <a href="scale_space" title="wikilink">scale space</a> theory should allow for more a robust representation of objects (or shapes) in the image.</p>

<p>In this respect, ridges and valleys can be seen as a complement to natural <a href="interest_point_detection" title="wikilink">interest points</a> or local extremal points. With appropriately defined concepts, ridges and valleys in the <a href="intensity_landscape" title="wikilink">intensity landscape</a> (or in some other representation derived from the intensity landscape) may form a <a href="scale_invariant" title="wikilink">scale invariant</a> <a href="topological_skeleton" title="wikilink">skeleton</a> for organizing spatial constraints on local appearance, with a number of qualitative similarities to the way the Blum's <a href="medial_axis" title="wikilink">medial axis transform</a> provides a <a href="shape_skeleton" title="wikilink">shape skeleton</a> for <a href="binary_image" title="wikilink">binary images</a>. In typical applications, ridge and valley descriptors are often used for detecting roads in <a href="aerial_image" title="wikilink">aerial images</a> and for detecting <a href="blood_vessel" title="wikilink">blood vessels</a> in <a href="retinal_image" title="wikilink">retinal images</a> or three-dimensional <a href="magnetic_resonance_imaging" title="wikilink">magnetic resonance images</a>.</p>
<h2 id="differential-geometric-definition-of-ridges-and-valleys-at-a-fixed-scale-in-a-two-dimensional-image">Differential geometric definition of ridges and valleys at a fixed scale in a two-dimensional image</h2>

<p>Let 

<math display="inline" id="Ridge_detection:2">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

 denote a two-dimensional function, and let 

<math display="inline" id="Ridge_detection:3">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 be the <a href="scale_space" title="wikilink">scale-space representation</a> of 

<math display="inline" id="Ridge_detection:4">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

 obtained by convolving 

<math display="inline" id="Ridge_detection:5">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

 with a Gaussian function</p>

<p>

<math display="block" id="Ridge_detection:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msup>
           <mi>x</mi>
           <mn>2</mn>
          </msup>
          <mo>+</mo>
          <msup>
           <mi>y</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
       <mi>t</mi>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>y</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x,y,t)=\frac{1}{2\pi t}e^{-(x^{2}+y^{2})/2t}
  </annotation>
 </semantics>
</math>

. Furthermore, let 

<math display="inline" id="Ridge_detection:7">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mi>p</mi>
    <mi>p</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{pp}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Ridge_detection:8">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mi>q</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>q</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{qq}
  </annotation>
 </semantics>
</math>

 denote the <a href="eigenvalue" title="wikilink">eigenvalues</a> of the <a href="Hessian_matrix" title="wikilink">Hessian matrix</a></p>

<p>

<math display="block" id="Ridge_detection:9">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>x</mi>
         <mi>x</mi>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>x</mi>
         <mi>y</mi>
        </mrow>
       </msub>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>x</mi>
         <mi>y</mi>
        </mrow>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>y</mi>
         <mi>y</mi>
        </mrow>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\begin{bmatrix}L_{xx}&L_{xy}\\
L_{xy}&L_{yy}\end{bmatrix}
  </annotation>
 </semantics>
</math>

 of the <a href="scale_space" title="wikilink">scale-space representation</a> 

<math display="inline" id="Ridge_detection:10">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 with a coordinate transformation (a rotation) applied to local directional derivative operators,</p>

<p>

<math display="block" id="Ridge_detection:11">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>p</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mi>β</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>x</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mi>β</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>y</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>q</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mi>β</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>x</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mi>β</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>y</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>p</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <ci>β</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <ci>β</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>q</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <ci>β</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <ci>β</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{p}=\sin\beta\partial_{x}-\cos\beta\partial_{y},\partial_{q}=\cos%
\beta\partial_{x}+\sin\beta\partial_{y}
  </annotation>
 </semantics>
</math>

 where p and q are coordinates of the rotated coordinate system.</p>

<p>It can be shown that the mixed derivative 

<math display="inline" id="Ridge_detection:12">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{pq}
  </annotation>
 </semantics>
</math>

 in the transformed coordinate system is zero if we choose</p>

<p>

<math display="block" id="Ridge_detection:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>cos</mi>
    <mi>β</mi>
   </mrow>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <msub>
          <mi>L</mi>
          <mrow>
           <mi>x</mi>
           <mi>x</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>L</mi>
          <mrow>
           <mi>y</mi>
           <mi>y</mi>
          </mrow>
         </msub>
        </mrow>
        <msqrt>
         <mrow>
          <msup>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <msub>
              <mi>L</mi>
              <mrow>
               <mi>x</mi>
               <mi>x</mi>
              </mrow>
             </msub>
             <mo>-</mo>
             <msub>
              <mi>L</mi>
              <mrow>
               <mi>y</mi>
               <mi>y</mi>
              </mrow>
             </msub>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mo>+</mo>
          <mrow>
           <mn>4</mn>
           <msubsup>
            <mi>L</mi>
            <mrow>
             <mi>x</mi>
             <mi>y</mi>
            </mrow>
            <mn>2</mn>
           </msubsup>
          </mrow>
         </mrow>
        </msqrt>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <cos></cos>
     <ci>β</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>y</ci>
           <ci>y</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <root></root>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <minus></minus>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>L</ci>
             <apply>
              <times></times>
              <ci>x</ci>
              <ci>x</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>L</ci>
             <apply>
              <times></times>
              <ci>y</ci>
              <ci>y</ci>
             </apply>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">4</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>L</ci>
             <apply>
              <times></times>
              <ci>x</ci>
              <ci>y</ci>
             </apply>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos\beta=\sqrt{\frac{1}{2}\left(1+\frac{L_{xx}-L_{yy}}{\sqrt{(L_{xx}-L_{yy})^%
{2}+4L_{xy}^{2}}}\right)}
  </annotation>
 </semantics>
</math>

,

<math display="inline" id="Ridge_detection:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>sin</mi>
    <mi>β</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>sgn</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <msqrt>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>L</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>L</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
         <msqrt>
          <mrow>
           <msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <msub>
               <mi>L</mi>
               <mrow>
                <mi>x</mi>
                <mi>x</mi>
               </mrow>
              </msub>
              <mo>-</mo>
              <msub>
               <mi>L</mi>
               <mrow>
                <mi>y</mi>
                <mi>y</mi>
               </mrow>
              </msub>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
            <mn>2</mn>
           </msup>
           <mo>+</mo>
           <mrow>
            <mn>4</mn>
            <msubsup>
             <mi>L</mi>
             <mrow>
              <mi>x</mi>
              <mi>y</mi>
             </mrow>
             <mn>2</mn>
            </msubsup>
           </mrow>
          </mrow>
         </msqrt>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <sin></sin>
     <ci>β</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>sgn</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>L</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>x</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>L</ci>
           <apply>
            <times></times>
            <ci>y</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <root></root>
          <apply>
           <plus></plus>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <minus></minus>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>L</ci>
              <apply>
               <times></times>
               <ci>x</ci>
               <ci>x</ci>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>L</ci>
              <apply>
               <times></times>
               <ci>y</ci>
               <ci>y</ci>
              </apply>
             </apply>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <times></times>
            <cn type="integer">4</cn>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>L</ci>
              <apply>
               <times></times>
               <ci>x</ci>
               <ci>y</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sin\beta=\operatorname{sgn}(L_{xy})\sqrt{\frac{1}{2}\left(1-\frac{L_{xx}-L_{%
yy}}{\sqrt{(L_{xx}-L_{yy})^{2}+4L_{xy}^{2}}}\right)}
  </annotation>
 </semantics>
</math>

. Then, a formal differential geometric definition of the ridges of 

<math display="inline" id="Ridge_detection:15">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

 at a fixed scale 

<math display="inline" id="Ridge_detection:16">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 can be expressed as the set of points that satisfy <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Ridge_detection:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>L</mi>
      <mi>p</mi>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>p</mi>
        <mi>p</mi>
       </mrow>
      </msub>
      <mo>≤</mo>
      <mn>0</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>p</mi>
         <mi>p</mi>
        </mrow>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>≥</mo>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>q</mi>
         <mi>q</mi>
        </mrow>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>p</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <leq></leq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <geq></geq>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>p</ci>
         <ci>p</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>q</ci>
         <ci>q</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{p}=0,L_{pp}\leq 0,|L_{pp}|\geq|L_{qq}|.
  </annotation>
 </semantics>
</math>

 Correspondingly, the valleys of 

<math display="inline" id="Ridge_detection:18">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

 at scale 

<math display="inline" id="Ridge_detection:19">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 are the set of points</p>

<p>

<math display="block" id="Ridge_detection:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>L</mi>
      <mi>q</mi>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>q</mi>
        <mi>q</mi>
       </mrow>
      </msub>
      <mo>≥</mo>
      <mn>0</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>q</mi>
         <mi>q</mi>
        </mrow>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>≥</mo>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>p</mi>
         <mi>p</mi>
        </mrow>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>q</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <geq></geq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>q</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <geq></geq>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>q</ci>
         <ci>q</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>p</ci>
         <ci>p</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{q}=0,L_{qq}\geq 0,|L_{qq}|\geq|L_{pp}|.
  </annotation>
 </semantics>
</math>

 In terms of a 

<math display="inline" id="Ridge_detection:21">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>u</mi>
   <mo>,</mo>
   <mi>v</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>u</ci>
    <ci>v</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (u,v)
  </annotation>
 </semantics>
</math>

 coordinate system with the 

<math display="inline" id="Ridge_detection:22">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 direction parallel to the image gradient</p>

<p>

<math display="block" id="Ridge_detection:23">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>u</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mi>α</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>x</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mi>α</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>y</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>v</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>cos</mi>
       <mi>α</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>x</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mi>α</mi>
      </mrow>
      <msub>
       <mo>∂</mo>
       <mi>y</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>u</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <ci>α</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <ci>α</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <cos></cos>
        <ci>α</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <ci>α</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{u}=\sin\alpha\partial_{x}-\cos\alpha\partial_{y},\partial_{v}=\cos%
\alpha\partial_{x}+\sin\alpha\partial_{y}
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Ridge_detection:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>cos</mi>
     <mi>α</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msub>
      <mi>L</mi>
      <mi>x</mi>
     </msub>
     <msqrt>
      <mrow>
       <msubsup>
        <mi>L</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>L</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>sin</mi>
     <mi>α</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msub>
      <mi>L</mi>
      <mi>y</mi>
     </msub>
     <msqrt>
      <mrow>
       <msubsup>
        <mi>L</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>L</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <cos></cos>
      <ci>α</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <ci>y</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <sin></sin>
      <ci>α</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <ci>y</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos\alpha=\frac{L_{x}}{\sqrt{L_{x}^{2}+L_{y}^{2}}},\sin\alpha=\frac{L_{y}}{%
\sqrt{L_{x}^{2}+L_{y}^{2}}}
  </annotation>
 </semantics>
</math>

 it can be shown that this ridge and valley definition can instead be equivalently<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> be written as</p>

<p>

<math display="block" id="Ridge_detection:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>L</mi>
     <mrow>
      <mi>u</mi>
      <mi>v</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>L</mi>
      <mrow>
       <mi>u</mi>
       <mi>u</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>L</mi>
      <mrow>
       <mi>v</mi>
       <mi>v</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>≥</mo>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <times></times>
       <ci>u</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <geq></geq>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>u</ci>
         <ci>u</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>v</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{uv}=0,L_{uu}^{2}-L_{vv}^{2}\geq 0
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="Ridge_detection:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>L</mi>
      <mi>v</mi>
      <mn>2</mn>
     </msubsup>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>u</mi>
       <mi>u</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msubsup>
        <mi>L</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>y</mi>
         <mi>y</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>L</mi>
        <mi>x</mi>
       </msub>
       <msub>
        <mi>L</mi>
        <mi>y</mi>
       </msub>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>x</mi>
         <mi>y</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msubsup>
       <mi>L</mi>
       <mi>y</mi>
       <mn>2</mn>
      </msubsup>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>x</mi>
        <mi>x</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <times></times>
       <ci>u</ci>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}^{2}L_{uu}=L_{x}^{2}L_{yy}-2L_{x}L_{y}L_{xy}+L_{y}^{2}L_{xx},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Ridge_detection:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>L</mi>
      <mi>v</mi>
      <mn>2</mn>
     </msubsup>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>u</mi>
       <mi>v</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>x</mi>
      </msub>
      <msub>
       <mi>L</mi>
       <mi>y</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>x</mi>
          <mi>x</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>y</mi>
          <mi>y</mi>
         </mrow>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>L</mi>
         <mi>x</mi>
         <mn>2</mn>
        </msubsup>
        <mo>-</mo>
        <msubsup>
         <mi>L</mi>
         <mi>y</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <times></times>
       <ci>u</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}^{2}L_{uv}=L_{x}L_{y}(L_{xx}-L_{yy})-(L_{x}^{2}-L_{y}^{2})L_{xy},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Ridge_detection:28">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>L</mi>
     <mi>v</mi>
     <mn>2</mn>
    </msubsup>
    <msub>
     <mi>L</mi>
     <mrow>
      <mi>v</mi>
      <mi>v</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>L</mi>
      <mi>x</mi>
      <mn>2</mn>
     </msubsup>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>L</mi>
      <mi>x</mi>
     </msub>
     <msub>
      <mi>L</mi>
      <mi>y</mi>
     </msub>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>x</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi>L</mi>
      <mi>y</mi>
      <mn>2</mn>
     </msubsup>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}^{2}L_{vv}=L_{x}^{2}L_{xx}+2L_{x}L_{y}L_{xy}+L_{y}^{2}L_{yy}
  </annotation>
 </semantics>
</math>

 and the sign of 

<math display="inline" id="Ridge_detection:29">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mi>u</mi>
    <mi>u</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>u</ci>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{uu}
  </annotation>
 </semantics>
</math>

 determines the polarity; 

<math display="inline" id="Ridge_detection:30">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mrow>
     <mi>u</mi>
     <mi>u</mi>
    </mrow>
   </msub>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>u</ci>
      <ci>u</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{uu}<0
  </annotation>
 </semantics>
</math>

 for ridges and 

<math display="inline" id="Ridge_detection:31">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mrow>
     <mi>u</mi>
     <mi>u</mi>
    </mrow>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <apply>
      <times></times>
      <ci>u</ci>
      <ci>u</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{uu}>0
  </annotation>
 </semantics>
</math>

 for valleys.</p>
<h2 id="computation-of-variable-scale-ridges-from-two-dimensional-images">Computation of variable scale ridges from two-dimensional images</h2>

<p>A main problem with the fixed scale ridge definition presented above is that it can be very sensitive to the choice of the scale level. Experiments show that the scale parameter of the Gaussian pre-smoothing kernel must be carefully tuned to the width of the ridge structure in the image domain, in order for the ridge detector to produce a connected curve reflecting the underlying image structures. To handle this problem in the absence of prior information, the notion of <em>scale-space ridges</em> has been introduced, which treats the scale parameter as an inherent property of the ridge definition and allows the scale levels to vary along a scale-space ridge. Moreover, the concept of a scale-space ridge also allows the scale parameter to be automatically tuned to the width of the ridge structures in the image domain, in fact as a consequence of a well-stated definition. In the literature, a number of different approaches have been proposed based on this idea.</p>

<p>Let 

<math display="inline" id="Ridge_detection:32">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R(x,y,t)
  </annotation>
 </semantics>
</math>

 denote a measure of ridge strength (to be specified below). Then, for a two-dimensional image, a scale-space ridge is the set of points that satisfy</p>

<p>

<math display="block" id="Ridge_detection:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>L</mi>
      <mi>p</mi>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>p</mi>
        <mi>p</mi>
       </mrow>
      </msub>
      <mo>≤</mo>
      <mn>0</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mi>t</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>R</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mrow>
        <msub>
         <mo>∂</mo>
         <mrow>
          <mi>t</mi>
          <mi>t</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>R</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>≤</mo>
       <mn>0</mn>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>p</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <leq></leq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
        <ci>R</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <leq></leq>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <apply>
          <times></times>
          <ci>t</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <ci>R</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{p}=0,L_{pp}\leq 0,\partial_{t}(R)=0,\partial_{tt}(R)\leq 0,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Ridge_detection:34">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 is the scale parameter in the <a href="scale_space" title="wikilink">scale-space representation</a>. Similarly, a <em>scale-space valley</em> is the set of points that satisfy</p>

<p>

<math display="block" id="Ridge_detection:35">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>q</mi>
    </msub>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>q</mi>
       <mi>q</mi>
      </mrow>
     </msub>
     <mo>≥</mo>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mi>t</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>R</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mrow>
       <msub>
        <mo>∂</mo>
        <mrow>
         <mi>t</mi>
         <mi>t</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>R</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>≤</mo>
      <mn>0.</mn>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>q</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <geq></geq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>q</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
        <ci>R</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <leq></leq>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <partialdiff></partialdiff>
         <apply>
          <times></times>
          <ci>t</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <ci>R</ci>
       </apply>
       <cn type="float">0.</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{q}=0,L_{qq}\geq 0,\partial_{t}(R)=0,\partial_{tt}(R)\leq 0.
  </annotation>
 </semantics>
</math>

 An immediate consequence of this definition is that for a two-dimensional image the concept of scale-space ridges sweeps out a set of one-dimensional curves in the three-dimensional scale-space, where the scale parameter is allowed to vary along the scale-space ridge (or the scale-space valley). The ridge descriptor in the image domain will then be a projection of this three-dimensional curve into the two-dimensional image plane, where the attribute scale information at every ridge point can be used as a natural estimate of the width of the ridge structure in the image domain in a neighbourhood of that point.</p>

<p>In the literature, various measures of ridge strength have been proposed. When Lindeberg (1996, 1998)<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> coined the term scale-space ridge, he considered three measures of ridge strength:</p>
<ul>
<li>The main principal curvature</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Ridge_detection:36">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mrow>
     <mrow>
      <mi>p</mi>
      <mi>p</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>γ</mi>
      <mo>-</mo>
      <mrow>
       <mi>n</mi>
       <mi>o</mi>
       <mi>r</mi>
       <mi>m</mi>
      </mrow>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>t</mi>
      <mi>γ</mi>
     </msup>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>x</mi>
         <mi>x</mi>
        </mrow>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>y</mi>
         <mi>y</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>-</mo>
      <msqrt>
       <mrow>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>L</mi>
            <mrow>
             <mi>x</mi>
             <mi>x</mi>
            </mrow>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>L</mi>
            <mrow>
             <mi>y</mi>
             <mi>y</mi>
            </mrow>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mrow>
         <mn>4</mn>
         <msubsup>
          <mi>L</mi>
          <mrow>
           <mi>x</mi>
           <mi>y</mi>
          </mrow>
          <mn>2</mn>
         </msubsup>
        </mrow>
       </mrow>
      </msqrt>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <list>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>γ</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>o</ci>
        <ci>r</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <ci>γ</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>L</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>x</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>L</ci>
           <apply>
            <times></times>
            <ci>y</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>L</ci>
           <apply>
            <times></times>
            <ci>x</ci>
            <ci>y</ci>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{pp,\gamma-norm}=\frac{t^{\gamma}}{2}\left(L_{xx}+L_{yy}-\sqrt{(L_{xx}-L_{yy%
})^{2}+4L_{xy}^{2}}\right)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd>expressed in terms of <em>

<math display="inline" id="Ridge_detection:37">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

-normalized derivatives</em> with

<p>

<math display="block" id="Ridge_detection:38">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>ξ</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>t</mi>
      <mrow>
       <mi>γ</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msub>
      <mo>∂</mo>
      <mi>x</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>η</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>t</mi>
      <mrow>
       <mi>γ</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msub>
      <mo>∂</mo>
      <mi>y</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>ξ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <divide></divide>
        <ci>γ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>η</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <divide></divide>
        <ci>γ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <partialdiff></partialdiff>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{\xi}=t^{\gamma/2}\partial_{x},\partial_{\eta}=t^{\gamma/2}\partial_{y}
  </annotation>
 </semantics>
</math>

.</p>
</dd>
</dl>
<ul>
<li>The square of the 

<math display="inline" id="Ridge_detection:39">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

-normalized square eigenvalue difference</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Ridge_detection:40">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>N</mi>
     <mrow>
      <mi>γ</mi>
      <mo>-</mo>
      <mrow>
       <mi>n</mi>
       <mi>o</mi>
       <mi>r</mi>
       <mi>m</mi>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>L</mi>
        <mrow>
         <mrow>
          <mi>p</mi>
          <mi>p</mi>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>γ</mi>
          <mo>-</mo>
          <mrow>
           <mi>n</mi>
           <mi>o</mi>
           <mi>r</mi>
           <mi>m</mi>
          </mrow>
         </mrow>
        </mrow>
        <mn>2</mn>
       </msubsup>
       <mo>-</mo>
       <msubsup>
        <mi>L</mi>
        <mrow>
         <mrow>
          <mi>q</mi>
          <mi>q</mi>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>γ</mi>
          <mo>-</mo>
          <mrow>
           <mi>n</mi>
           <mi>o</mi>
           <mi>r</mi>
           <mi>m</mi>
          </mrow>
         </mrow>
        </mrow>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>t</mi>
      <mrow>
       <mn>4</mn>
       <mi>γ</mi>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>x</mi>
          <mi>x</mi>
         </mrow>
        </msub>
        <mo>+</mo>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>y</mi>
          <mi>y</mi>
         </mrow>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>L</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>L</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mn>4</mn>
        <msubsup>
         <mi>L</mi>
         <mrow>
          <mi>x</mi>
          <mi>y</mi>
         </mrow>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <apply>
       <minus></minus>
       <ci>γ</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>o</ci>
        <ci>r</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <list>
          <apply>
           <times></times>
           <ci>p</ci>
           <ci>p</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>γ</ci>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>o</ci>
            <ci>r</ci>
            <ci>m</ci>
           </apply>
          </apply>
         </list>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <list>
          <apply>
           <times></times>
           <ci>q</ci>
           <ci>q</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>γ</ci>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>o</ci>
            <ci>r</ci>
            <ci>m</ci>
           </apply>
          </apply>
         </list>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <ci>γ</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <apply>
          <times></times>
          <ci>x</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <apply>
          <times></times>
          <ci>y</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>y</ci>
           <ci>y</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>y</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{\gamma-norm}=\left(L_{pp,\gamma-norm}^{2}-L_{qq,\gamma-norm}^{2}\right)^{2}%
=t^{4\gamma}(L_{xx}+L_{yy})^{2}\left((L_{xx}-L_{yy})^{2}+4L_{xy}^{2}\right).
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<ul>
<li>The square of the 

<math display="inline" id="Ridge_detection:41">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

-normalized eigenvalue difference</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Ridge_detection:42">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>γ</mi>
      <mo>-</mo>
      <mrow>
       <mi>n</mi>
       <mi>o</mi>
       <mi>r</mi>
       <mi>m</mi>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>L</mi>
        <mrow>
         <mrow>
          <mi>p</mi>
          <mi>p</mi>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>γ</mi>
          <mo>-</mo>
          <mrow>
           <mi>n</mi>
           <mi>o</mi>
           <mi>r</mi>
           <mi>m</mi>
          </mrow>
         </mrow>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mrow>
          <mi>q</mi>
          <mi>q</mi>
         </mrow>
         <mo>,</mo>
         <mrow>
          <mi>γ</mi>
          <mo>-</mo>
          <mrow>
           <mi>n</mi>
           <mi>o</mi>
           <mi>r</mi>
           <mi>m</mi>
          </mrow>
         </mrow>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>t</mi>
      <mrow>
       <mn>2</mn>
       <mi>γ</mi>
      </mrow>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>L</mi>
           <mrow>
            <mi>x</mi>
            <mi>x</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>L</mi>
           <mrow>
            <mi>y</mi>
            <mi>y</mi>
           </mrow>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mn>4</mn>
        <msubsup>
         <mi>L</mi>
         <mrow>
          <mi>x</mi>
          <mi>y</mi>
         </mrow>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <minus></minus>
       <ci>γ</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>o</ci>
        <ci>r</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <list>
         <apply>
          <times></times>
          <ci>p</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>γ</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>o</ci>
           <ci>r</ci>
           <ci>m</ci>
          </apply>
         </apply>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <list>
         <apply>
          <times></times>
          <ci>q</ci>
          <ci>q</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>γ</ci>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>o</ci>
           <ci>r</ci>
           <ci>m</ci>
          </apply>
         </apply>
        </list>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>γ</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>y</ci>
           <ci>y</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <apply>
           <times></times>
           <ci>x</ci>
           <ci>y</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{\gamma-norm}=\left(L_{pp,\gamma-norm}-L_{qq,\gamma-norm}\right)^{2}=t^{2%
\gamma}\left((L_{xx}-L_{yy})^{2}+4L_{xy}^{2}\right).
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>The notion of 

<math display="inline" id="Ridge_detection:43">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

-normalized derivatives is essential here, since it allows the ridge and valley detector algorithms to be calibrated properly. By requiring that for a one-dimensional Gaussian ridge embedded in two (or three dimensions) the detection scale should be equal to the width of the ridge structure when measured in units of length (a requirement of a match between the size of the detection filter and the image structure it responds to), it follows that one should choose 

<math display="inline" id="Ridge_detection:44">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mo>/</mo>
    <mn>4</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <apply>
     <divide></divide>
     <cn type="integer">3</cn>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=3/4
  </annotation>
 </semantics>
</math>

. Out of these three measures of ridge strength, the first entity 

<math display="inline" id="Ridge_detection:45">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mrow>
     <mi>p</mi>
     <mi>p</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>γ</mi>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mi>o</mi>
      <mi>r</mi>
      <mi>m</mi>
     </mrow>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <list>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <minus></minus>
      <ci>γ</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>o</ci>
       <ci>r</ci>
       <ci>m</ci>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{pp,\gamma-norm}
  </annotation>
 </semantics>
</math>

 is a general purpose ridge strength measure with many applications such as blood vessel detection and road extraction. Nevertheless, the entity 

<math display="inline" id="Ridge_detection:46">
 <semantics>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>γ</mi>
    <mo>-</mo>
    <mrow>
     <mi>n</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>m</mi>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <apply>
     <minus></minus>
     <ci>γ</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>o</ci>
      <ci>r</ci>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{\gamma-norm}
  </annotation>
 </semantics>
</math>

 has been used in applications such as fingerprint enhancement,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> real-time hand tracking and gesture recognition<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> as well as for modelling local image statistics for detecting and tracking humans in images and video.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>There are also other closely related ridge definitions that make use of normalized derivatives with the implicit assumption of 

<math display="inline" id="Ridge_detection:47">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=1
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> <em>Develop these approaches in further detail.</em> When detecting ridges with 

<math display="inline" id="Ridge_detection:48">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=1
  </annotation>
 </semantics>
</math>

, however, the detection scale will be twice as large as for 

<math display="inline" id="Ridge_detection:49">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mo>/</mo>
    <mn>4</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <apply>
     <divide></divide>
     <cn type="integer">3</cn>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=3/4
  </annotation>
 </semantics>
</math>

, resulting in more shape distortions and a lower ability to capture ridges and valleys with nearby interfering image structures in the image domain.</p>
<h2 id="history">History</h2>

<p>The notion of ridges and valleys in digital images was introduced by <a class="uri" href="Haralick" title="wikilink">Haralick</a> in 1983<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> and by Crowley concerning <a href="difference_of_Gaussians" title="wikilink">difference of Gaussians</a> <a href="pyramid_(image_processing)" title="wikilink">pyramids</a> in 1984.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> The application of ridge descriptors to medical image analysis has been extensively studied by Pizer and his co-workers<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a><a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> resulting in their notion of M-reps.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> Ridge detection has also been furthered by Lindeberg with the introduction of 

<math display="inline" id="Ridge_detection:50">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

-normalized derivatives and scale-space ridges defined from local maximization of the appropriately normalized main principal curvature of the Hessian matrix (or other measures of ridge strength) over space and over scale. These notions have later been developed with application to road extraction by Steger et al.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a><a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> and to blood vessel segmentation by Frangi et al.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> as well as to the detection of curvilinear and tubular structures by Sato et al.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> and Krissian et al.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> A review of several of the classical ridge definitions at a fixed scale including relations between them has been given by Koenderink and van Doorn.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> A review of vessel extraction techniques has been presented by Kirbas and Quek.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>
<h2 id="definition-of-ridges-and-valleys-in-n-dimensions">Definition of ridges and valleys in N dimensions</h2>

<p>In its broadest sense, the notion of ridge generalizes the idea of a local maximum of a real-valued function. A point 

<math display="inline" id="Ridge_detection:51">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

 in the domain of a function 

<math display="inline" id="Ridge_detection:52">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>:</mo>
   <mrow>
    <msup>
     <mi>ℝ</mi>
     <mi>n</mi>
    </msup>
    <mo>→</mo>
    <mi>ℝ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>f</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℝ</ci>
      <ci>n</ci>
     </apply>
     <ci>ℝ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f:\mathbb{R}^{n}\rightarrow\mathbb{R}
  </annotation>
 </semantics>
</math>

is a local maximum of the function if there is a distance 

<math display="inline" id="Ridge_detection:53">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>δ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta>0
  </annotation>
 </semantics>
</math>

 with the property that if 

<math display="inline" id="Ridge_detection:54">
 <semantics>
  <mi>𝐱</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐱</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
 </semantics>
</math>

 is within 

<math display="inline" id="Ridge_detection:55">
 <semantics>
  <mi>δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta
  </annotation>
 </semantics>
</math>

 units of 

<math display="inline" id="Ridge_detection:56">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Ridge_detection:57">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐱</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>𝐱</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\mathbf{x})<f(\mathbf{x}_{0})
  </annotation>
 </semantics>
</math>

. It is well known that critical points, of which local maxima are just one type, are isolated points in a function's domain in all but the most unusual situations (<em>i.e.</em>, the nongeneric cases).</p>

<p>Consider relaxing the condition that 

<math display="inline" id="Ridge_detection:58">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐱</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>𝐱</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\mathbf{x})<f(\mathbf{x}_{0})
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Ridge_detection:59">
 <semantics>
  <mi>𝐱</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐱</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
 </semantics>
</math>

 in an entire neighborhood of 

<math display="inline" id="Ridge_detection:60">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

 slightly to require only that this hold on an 

<math display="inline" id="Ridge_detection:61">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n-1
  </annotation>
 </semantics>
</math>

 dimensional subset. Presumably this relaxation allows the set of points which satisfy the criteria, which we will call the ridge, to have a single degree of freedom, at least in the generic case. This means that the set of ridge points will form a 1-dimensional locus, or a ridge curve. Notice that the above can be modified to generalize the idea to local minima and result in what might call 1-dimensional valley curves.</p>

<p>This following ridge definition follows the book by Eberly<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> and can be seen as a generalization of some of the abovementioned ridge definitions. Let 

<math display="inline" id="Ridge_detection:62">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>⊂</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <subset></subset>
    <ci>U</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U\subset\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

 be an open set, and 

<math display="inline" id="Ridge_detection:63">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>:</mo>
   <mrow>
    <mi>U</mi>
    <mo>→</mo>
    <mi>ℝ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>f</ci>
    <apply>
     <ci>normal-→</ci>
     <ci>U</ci>
     <ci>ℝ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f:U\rightarrow\mathbb{R}
  </annotation>
 </semantics>
</math>

 be smooth. Let 

<math display="inline" id="Ridge_detection:64">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐱</mi>
    <mn>0</mn>
   </msub>
   <mo>∈</mo>
   <mi>U</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐱</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>U</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}\in U
  </annotation>
 </semantics>
</math>

. Let 

<math display="inline" id="Ridge_detection:65">
 <semantics>
  <mrow>
   <msub>
    <mo>∇</mo>
    <msub>
     <mi>𝐱</mi>
     <mn>0</mn>
    </msub>
   </msub>
   <mi>f</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-∇</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{\mathbf{x}_{0}}f
  </annotation>
 </semantics>
</math>

 be the gradient of 

<math display="inline" id="Ridge_detection:66">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 at 

<math display="inline" id="Ridge_detection:67">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

, and let 

<math display="inline" id="Ridge_detection:68">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <msub>
     <mi>𝐱</mi>
     <mn>0</mn>
    </msub>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathbf{x}_{0}}(f)
  </annotation>
 </semantics>
</math>

 be the 

<math display="inline" id="Ridge_detection:69">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times n
  </annotation>
 </semantics>
</math>

 Hessian matrix of 

<math display="inline" id="Ridge_detection:70">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

at 

<math display="inline" id="Ridge_detection:71">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

. Let 

<math display="inline" id="Ridge_detection:72">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
   <mo>≤</mo>
   <msub>
    <mi>λ</mi>
    <mn>2</mn>
   </msub>
   <mo>≤</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>≤</mo>
   <msub>
    <mi>λ</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>normal-⋯</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{1}\leq\lambda_{2}\leq\cdots\leq\lambda_{n}
  </annotation>
 </semantics>
</math>

 be the 

<math display="inline" id="Ridge_detection:73">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 ordered eigenvalues of 

<math display="inline" id="Ridge_detection:74">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <msub>
     <mi>𝐱</mi>
     <mn>0</mn>
    </msub>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>f</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathbf{x}_{0}}(f)
  </annotation>
 </semantics>
</math>

 and let 

<math display="inline" id="Ridge_detection:75">
 <semantics>
  <msub>
   <mi>𝐞</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐞</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{e}_{i}
  </annotation>
 </semantics>
</math>

 be a unit eigenvector in the eigenspace for 

<math display="inline" id="Ridge_detection:76">
 <semantics>
  <msub>
   <mi>λ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{i}
  </annotation>
 </semantics>
</math>

. (For this, one should assume that all the eigenvalues are distinct.)</p>

<p>The point 

<math display="inline" id="Ridge_detection:77">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

 is a point on the 1-dimensional ridge of 

<math display="inline" id="Ridge_detection:78">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 if the following conditions hold:</p>
<ol>
<li>

<math display="inline" id="Ridge_detection:79">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{n-1}<0
  </annotation>
 </semantics>
</math>

, and</li>
<li>

<math display="inline" id="Ridge_detection:80">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∇</mo>
     <msub>
      <mi>𝐱</mi>
      <mn>0</mn>
     </msub>
    </msub>
    <mrow>
     <mi>f</mi>
     <mo>⋅</mo>
     <msub>
      <mi>𝐞</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐞</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{\mathbf{x}_{0}}f\cdot\mathbf{e}_{i}=0
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Ridge_detection:81">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,2,\ldots,n-1
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p>This makes precise the concept that 

<math display="inline" id="Ridge_detection:82">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 restricted to <em>this particular</em> 

<math display="inline" id="Ridge_detection:83">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n-1
  </annotation>
 </semantics>
</math>

-dimensional subspace has a local maxima at 

<math display="inline" id="Ridge_detection:84">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

.</p>

<p>This definition naturally generalizes to the <em>k</em>-dimensional ridge as follows: the point 

<math display="inline" id="Ridge_detection:85">
 <semantics>
  <msub>
   <mi>𝐱</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐱</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{0}
  </annotation>
 </semantics>
</math>

 is a point on the <em>k</em>-dimensional ridge of 

<math display="inline" id="Ridge_detection:86">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 if the following conditions hold:</p>
<ol>
<li>

<math display="inline" id="Ridge_detection:87">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{n-k}<0
  </annotation>
 </semantics>
</math>

, and</li>
<li>

<math display="inline" id="Ridge_detection:88">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∇</mo>
     <msub>
      <mi>𝐱</mi>
      <mn>0</mn>
     </msub>
    </msub>
    <mrow>
     <mi>f</mi>
     <mo>⋅</mo>
     <msub>
      <mi>𝐞</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-∇</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐞</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla_{\mathbf{x}_{0}}f\cdot\mathbf{e}_{i}=0
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Ridge_detection:89">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mi>k</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,2,\ldots,n-k
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p>In many ways, these definitions naturally generalize that of a local maximum of a function. Properties of maximal convexity ridges are put on a solid mathematical footing by Damon<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> and Miller.<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> Their properties in one-parameter families was established by Keller.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a></p>
<h2 id="maximal-scale-ridge">Maximal Scale Ridge</h2>

<p>The following definition can be traced to Fritsch<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> who was interested in extracting geometric information about figures in two dimensional greyscale images. Fritsch filtered his image with a "medialness" filter that gave him information analogous to "distant to the boundary" data in scale-space. Ridges of this image, once projected to the original image, were to be analogous to a shape skeleton (<em>e.g.</em>, the Blum Medial Axis) of the original image.</p>

<p>What follows is a definition for the maximal scale ridge of a function of three variables, one of which is a "scale" parameter. One thing that we want to be true in this definition is, if 

<math display="inline" id="Ridge_detection:90">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐱</mi>
   <mo>,</mo>
   <mi>σ</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐱</ci>
    <ci>σ</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{x},\sigma)
  </annotation>
 </semantics>
</math>

 is a point on this ridge, then the value of the function at the point is maximal in the scale dimension. Let 

<math display="inline" id="Ridge_detection:91">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>𝐱</mi>
    <mo>,</mo>
    <mi>σ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>𝐱</ci>
     <ci>σ</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\mathbf{x},\sigma)
  </annotation>
 </semantics>
</math>

 be a smooth differentiable function on 

<math display="inline" id="Ridge_detection:92">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>⊂</mo>
   <mrow>
    <msup>
     <mi>ℝ</mi>
     <mn>2</mn>
    </msup>
    <mo>×</mo>
    <msub>
     <mi>ℝ</mi>
     <mo>+</mo>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <subset></subset>
    <ci>U</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℝ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℝ</ci>
      <plus></plus>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U\subset\mathbb{R}^{2}\times\mathbb{R}_{+}
  </annotation>
 </semantics>
</math>

. The 

<math display="inline" id="Ridge_detection:93">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>𝐱</mi>
   <mo>,</mo>
   <mi>σ</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>𝐱</ci>
    <ci>σ</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{x},\sigma)
  </annotation>
 </semantics>
</math>

 is a point on the maximal scale ridge if and only if</p>
<ol>
<li>

<math display="inline" id="Ridge_detection:94">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>f</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>σ</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>f</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>σ</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial f}{\partial\sigma}=0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Ridge_detection:95">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mo>∂</mo>
      <mn>2</mn>
     </msup>
     <mi>f</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <partialdiff></partialdiff>
       <cn type="integer">2</cn>
      </apply>
      <ci>f</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial^{2}f}{\partial\sigma^{2}}<0
  </annotation>
 </semantics>
</math>

, and</li>
<li>

<math display="inline" id="Ridge_detection:96">
 <semantics>
  <mrow>
   <mrow>
    <mo>∇</mo>
    <mrow>
     <mi>f</mi>
     <mo>⋅</mo>
     <msub>
      <mi>𝐞</mi>
      <mn>1</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-∇</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐞</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla f\cdot\mathbf{e}_{1}=0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Ridge_detection:97">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>𝐞</mi>
     <mn>1</mn>
     <mi>t</mi>
    </msubsup>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>f</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>𝐞</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐞</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <ci>H</ci>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐞</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{e}_{1}^{t}H(f)\mathbf{e}_{1}<0
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<h2 id="relations-between-edge-detection-and-ridge-detection">Relations between edge detection and ridge detection</h2>

<p>The purpose of ridge detection is usually to capture the major axis of symmetry of an elongated object, whereas the purpose of <a href="edge_detection" title="wikilink">edge detection</a> is usually to capture the boundary of the object. However, some literature on edge detection erroneously includes the notion of ridges into the concept of edges, which confuses the situation.</p>

<p>In terms of definitions, there is a close connection between edge detectors and ridge detectors. With the formulation of non-maximum as given by Canny,<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> it holds that edges are defined as the points where the gradient magnitude assumes a local maximum in the gradient direction. Following a differential geometric way of expressing this definition,<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a> we can in the above-mentioned 

<math display="inline" id="Ridge_detection:98">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>u</mi>
   <mo>,</mo>
   <mi>v</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>u</ci>
    <ci>v</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (u,v)
  </annotation>
 </semantics>
</math>

-coordinate system state that the gradient magnitude of the scale-space representation, which is equal to the first-order directional derivative in the 

<math display="inline" id="Ridge_detection:99">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

-direction 

<math display="inline" id="Ridge_detection:100">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>v</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}
  </annotation>
 </semantics>
</math>

, should have its first order directional derivative in the 

<math display="inline" id="Ridge_detection:101">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

-direction equal to zero</p>

<p>

<math display="block" id="Ridge_detection:102">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mi>v</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>L</mi>
      <mi>v</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <ci>v</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{v}(L_{v})=0
  </annotation>
 </semantics>
</math>

 while the second-order directional derivative in the 

<math display="inline" id="Ridge_detection:103">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

-direction of 

<math display="inline" id="Ridge_detection:104">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>v</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}
  </annotation>
 </semantics>
</math>

 should be negative, i.e.,</p>

<p>

<math display="block" id="Ridge_detection:105">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>∂</mo>
     <mrow>
      <mi>v</mi>
      <mi>v</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>L</mi>
      <mi>v</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <partialdiff></partialdiff>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial_{vv}(L_{v})\leq 0
  </annotation>
 </semantics>
</math>

. Written out as an explicit expression in terms of local partial derivatives 

<math display="inline" id="Ridge_detection:106">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{x}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Ridge_detection:107">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{y}
  </annotation>
 </semantics>
</math>

 ... 

<math display="inline" id="Ridge_detection:108">
 <semantics>
  <msub>
   <mi>L</mi>
   <mrow>
    <mi>y</mi>
    <mi>y</mi>
    <mi>y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <apply>
     <times></times>
     <ci>y</ci>
     <ci>y</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{yyy}
  </annotation>
 </semantics>
</math>

, this edge definition can be expressed as the zero-crossing curves of the differential invariant</p>

<p>

<math display="block" id="Ridge_detection:109">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>L</mi>
      <mi>v</mi>
      <mn>2</mn>
     </msubsup>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>v</mi>
       <mi>v</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <msubsup>
        <mi>L</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
      </mpadded>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>x</mi>
        <mi>x</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mn>2</mn>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>L</mi>
        <mi>x</mi>
       </msub>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>L</mi>
        <mi>y</mi>
       </msub>
      </mpadded>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>x</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msubsup>
        <mi>L</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
      </mpadded>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>y</mi>
        <mi>y</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>v</ci>
        <ci>v</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}^{2}L_{vv}=L_{x}^{2}\,L_{xx}+2\,L_{x}\,L_{y}\,L_{xy}+L_{y}^{2}\,L_{yy}=0,
  </annotation>
 </semantics>
</math>

 that satisfy a sign-condition on the following differential invariant</p>

<p>

<math display="block" id="Ridge_detection:110">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>L</mi>
     <mi>v</mi>
     <mn>3</mn>
    </msubsup>
    <msub>
     <mi>L</mi>
     <mrow>
      <mi>v</mi>
      <mi>v</mi>
      <mi>v</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>L</mi>
       <mi>x</mi>
       <mn>3</mn>
      </msubsup>
     </mpadded>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
       <mi>x</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mn>3</mn>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>L</mi>
       <mi>x</mi>
       <mn>2</mn>
      </msubsup>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>L</mi>
       <mi>y</mi>
      </msub>
     </mpadded>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>x</mi>
       <mi>x</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mn>3</mn>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>L</mi>
       <mi>x</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>L</mi>
       <mi>y</mi>
       <mn>2</mn>
      </msubsup>
     </mpadded>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>x</mi>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>L</mi>
       <mi>y</mi>
       <mn>3</mn>
      </msubsup>
     </mpadded>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>y</mi>
       <mi>y</mi>
       <mi>y</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <times></times>
        <ci>v</ci>
        <ci>v</ci>
        <ci>v</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>x</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>x</ci>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <apply>
         <times></times>
         <ci>y</ci>
         <ci>y</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{v}^{3}L_{vvv}=L_{x}^{3}\,L_{xxx}+3\,L_{x}^{2}\,L_{y}\,L_{xxy}+3\,L_{x}\,L_{%
y}^{2}\,L_{xyy}+L_{y}^{3}\,L_{yyy}\leq 0
  </annotation>
 </semantics>
</math>

 (see the article on <a href="edge_detection" title="wikilink">edge detection</a> for more information). Notably, the edges obtained in this way are the ridges of the gradient magnitude.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Scale_space" title="wikilink">Scale space</a></li>
<li><a href="Feature_detection_(computer_vision)" title="wikilink">Feature detection (computer vision)</a></li>
<li><a href="Edge_detection" title="wikilink">Edge detection</a></li>
<li><a href="Interest_point_detection" title="wikilink">Interest point detection</a></li>
<li><a href="Blob_detection" title="wikilink">Blob detection</a></li>
<li><a href="Computer_vision" title="wikilink">Computer vision</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.letteraturaoperaomnia.org/thesis/thesis_italy_XX_ciclo_andrea_anzalone.html">Multiscale analysis for optimized vessel segmentation of fundus retina images</a> Ph.D Thesis</li>
</ul>

<p>"</p>

<p><a href="Category:Feature_detection_(computer_vision)" title="wikilink">Category:Feature detection (computer vision)</a> <a href="Category:Multivariable_calculus" title="wikilink">Category:Multivariable calculus</a> <a href="Category:Smooth_functions" title="wikilink">Category:Smooth functions</a> <a href="Category:Singularity_theory" title="wikilink">Category:Singularity theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Miller, J. <em>Relative Critical Sets in 

<math display="inline" id="Ridge_detection:111">
 <semantics>
  <msup>
   <mi>ℝ</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ℝ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

 and Applications to Image Analysis.</em> Ph.D. Dissertation. University of North Carolina. 1998.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"> Earlier version presented at IEEE Conference on Pattern Recognition and Computer Vision, CVPR'96, San Francisco, California, pages 465–470, june 1996<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="http://www.nada.kth.se/cvap/abstracts/BreLapLin-FG02.html">L. Bretzner, I. Laptev and T. Lindeberg: Hand Gesture Recognition using Multi-Scale Colour Features, Hierarchical Models and Particle Filtering, Proc. IEEE Conference on Face and Gesture 2002, Washington DC, 423–428.</a><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9">J. Furst and J. Miller, "The Maximal Scale Ridge: Incorporating Scale in the Ridge Definition", <em>Scale Space Theory in Computer Vision: Proceedings of the First International Conference on, Scale Space '97,</em> pp. 93–104. Springer Lecture Notes in Computer Science, vol. 1682.<a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="http://citeseer.ist.psu.edu/pizer01segmentation.html">S. Pizer, S. Joshi, T. Fletcher, M. Styner, G. Tracton, J. Chen (2001) "Segmentation of Single-Figure Objects by Deformable M-reps", Proceedings of the 4th International Conference on Medical Image Computing and Computer-Assisted Intervention, Springer Lecture Notes In Computer Science; Vol. 2208, pp. 862–871</a><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"></li>
<li id="fn26"></li>
<li id="fn27">Kerrel, R. <em>Generic Transitions of Relative Critical Sets in Parameterized Families with Applications to Image Analysis.</em> University of North Carolina. 1999.<a href="#fnref27">↩</a></li>
<li id="fn28">Fritsch, DS, Eberly,D., Pizer, SM, and McAuliffe, MJ. "Stimulated cores and their applications in medical imaging." Information Processing in Medical Imaging, Y. Bizais, C Barillot, R DiPaola, eds., Kluwer Series in Computational Imaging and Vision, pp. 365–368.<a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"><a href="#fnref30">↩</a></li>
</ol>
</section>
</body>
</html>

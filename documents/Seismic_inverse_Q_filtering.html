<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1194">Seismic inverse Q filtering</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Seismic inverse Q filtering</h1>
<hr/>

<p><strong>Seismic inverse Q filtering</strong> is a data processing technology for enhancing the resolution of <a href="reflection_seismology" title="wikilink">reflection seismology</a> images. Q is the <a href="anelastic_attenuation_factor" title="wikilink">anelastic attenuation factor</a> or the seismic quality factor, a measure of the energy loss as the seismic wave moves.</p>
<h2 id="basics">Basics</h2>

<p>Seismic inverse Q-filtering employs a wave propagation reversal procedure that compensates for energy absorption and corrects wavelet distortion due to velocity dispersion.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> By compensating for amplitude attenuation with a model of the visco-elastic attenuation model type, seismic data can provide true relative-amplitude information for amplitude inversion and subsequent reservoir characterization. By correcting the phase distortion due to velocity dispersion, seismic data with enhanced vertical resolution can yield correct timings for lithological identification.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>However, Wang's outline of the subject is excellent and to follow his path, inverse Q filtering can be introduced based on the 1-D one-way propagation wave equation. He introduce this equation:.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:0">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>U</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>r</mi>
       <mo>,</mo>
       <mi>w</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>r</mi>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mi>i</mi>
     <mi>k</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>U</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>r</mi>
      <mo>,</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1.1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>U</ci>
       <interval closure="open">
        <ci>r</ci>
        <ci>w</ci>
       </interval>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>k</ci>
      <ci>w</ci>
      <ci>U</ci>
      <interval closure="open">
       <ci>r</ci>
       <ci>w</ci>
      </interval>
     </apply>
    </apply>
    <list>
     <cn type="integer">0</cn>
     <cn type="float">1.1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dU(r,w)}{dr}-ik(w)U(r,w)=0\quad(1.1)
  </annotation>
 </semantics>
</math>

</p>

<p>where U(r,w) is the plane wave of radial frequency w at travel distance r, k(w) is the wavenumber and i is the imaginary unit. Reflection seismograms record the reflection wave along the propagation path r from the source to reflector and back to the surface. With this approach Wang assumes that the plane wave U(r,w) has already been attenuated by a Q filter through travel distance r. We must have this in mind when we go to the step of finding a solution of (1.1). It is necessary that the initial U(r,w) either is already created by a forward synthetic Q-filtering process or taken directly from seismic surface data. Wang has introduced this concept in chapter 5 in his book.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> I think it is necessary to have this in mind also when the inverse theory is developed. Equation (1.1) has an analytical solution given by</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:1">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo>+</mo>
    <mo>△</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mi>k</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>w</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>△</mo>
    <mi>r</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1.2</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">r</csymbol>
     <plus></plus>
     <ci>normal-△</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">k</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">w</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-△</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="float">1.2</cn>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(r+\bigtriangleup r,w)=U(r,w)\exp(ik(w)\bigtriangleup r)\quad(1.2)
  </annotation>
 </semantics>
</math>

</p>
<h2 id="kolskys-attenuation-dispersion-model">Kolsky's attenuation-dispersion model</h2>

<p>The wavenumber k(w) is an important variable in the solution (1.2). To obtain a solution that can be applied to seismic k(w) must be connected to a function that represent the way U(r,w) propagates in the seismic media. This functions can be regarded as a Q-model.</p>

<p>The Kolsky Model is used extensively in seismic inverse Q-filtering. The model assumes the attenuation α(w) to be strictly linear with frequency over the range of measurement:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:2">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>w</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>c</mi>
        <mi>r</mi>
       </msub>
       <msub>
        <mi>Q</mi>
        <mi>r</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1.3</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <list>
     <apply>
      <divide></divide>
      <apply>
       <abs></abs>
       <ci>w</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Q</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <cn type="float">1.3</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=\frac{|w|}{(2c_{r}Q_{r})}\quad(1.3)
  </annotation>
 </semantics>
</math>

</p>

<p>And defines the phase velocity as:</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:3">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mi>c</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>c</mi>
       <mi>r</mi>
      </msub>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mi>π</mi>
          <msub>
           <mi>Q</mi>
           <mi>r</mi>
          </msub>
         </mrow>
        </mfrac>
        <mi>l</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">|</mo>
         <mfrac>
          <mi>w</mi>
          <msub>
           <mi>w</mi>
           <mi>r</mi>
          </msub>
         </mfrac>
         <mo stretchy="false">|</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1.4</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>w</ci>
     </apply>
    </apply>
    <list>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <ci>π</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>Q</ci>
           <ci>r</ci>
          </apply>
         </apply>
        </apply>
        <ci>l</ci>
        <ci>n</ci>
        <apply>
         <abs></abs>
         <apply>
          <divide></divide>
          <ci>w</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <ci>r</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="float">1.4</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{c(w)}=\frac{1}{c_{r}}(1-\frac{1}{\pi Q_{r}}ln|\frac{w}{w_{r}}|)\quad(%
1.4)
  </annotation>
 </semantics>
</math>

</p>

<p>Where c<sub>r</sub> and Q<sub>r</sub> are the phase velocity and the Q value at a reference frequency w<sub>r</sub>.</p>

<p>For a large value of Qr &gt;&gt;1 the solution (1.4) can be approximated to</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:4">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mi>c</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msub>
       <mi>c</mi>
       <mi>r</mi>
      </msub>
     </mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mfrac>
        <mi>w</mi>
        <msub>
         <mi>w</mi>
         <mi>r</mi>
        </msub>
       </mfrac>
       <mo stretchy="false">|</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mi>γ</mi>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1.5</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>w</ci>
     </apply>
    </apply>
    <list>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <divide></divide>
         <ci>w</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>γ</ci>
       </apply>
      </apply>
     </apply>
     <cn type="float">1.5</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{c(w)}=\frac{1}{c_{r}}|\frac{w}{w_{r}}|^{-\gamma}\quad(1.5)
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:5">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>π</mi>
      <msub>
       <mi>Q</mi>
       <mi>r</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <ci>π</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=(\pi Q_{r})^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>Kolsky’s model was derived from and fitted well with experimental observations. A requirement in the theory for materials satisfying the linear attenuation assumption is that the reference frequency w<sub>r</sub> is a finite (arbitrarily small but nonzero) cut-off on the absorption. According to Kolsky, we are free to choose w<sub>r</sub> following the phenomenological criterion that it be small compared with the lowest measured frequency w in the frequency band.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Those who want a deeper insight into this concept can go to Futterman (1962)<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>Now we consider (1.3) as the real part of the wavenumber k(w) and (1.5) as the imaginary part. Considering only the positive frequencies, the complex wavenumber k(w) then becomes</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:6">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac>
     <mi>i</mi>
     <mrow>
      <mn>2</mn>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>w</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo stretchy="false">)</mo>
   </mrow>
   <mfrac>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>w</mi>
     <mo stretchy="false">|</mo>
    </mrow>
    <msub>
     <mi>c</mi>
     <mi>r</mi>
    </msub>
   </mfrac>
   <mo stretchy="false">|</mo>
   <mfrac>
    <mi>w</mi>
    <msub>
     <mi>w</mi>
     <mi>r</mi>
    </msub>
   </mfrac>
   <msup>
    <mo stretchy="false">|</mo>
    <mrow>
     <mo>-</mo>
     <mi>γ</mi>
    </mrow>
   </msup>
   <mo stretchy="false">)</mo>
   <mo stretchy="false">(</mo>
   <mn>1.6</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">k</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">1</cn>
     <minus></minus>
     <apply>
      <divide></divide>
      <ci>i</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>Q</ci>
       <ci>w</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <apply>
     <divide></divide>
     <apply>
      <abs></abs>
      <ci>w</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <ci>normal-|</ci>
    <apply>
     <divide></divide>
     <ci>w</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-|</ci>
     <apply>
      <minus></minus>
      <ci>γ</ci>
     </apply>
    </apply>
    <ci>normal-)</ci>
    <ci></ci>
    <ci>normal-(</ci>
    <cn type="float">1.6</cn>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k(w)=(1-\frac{i}{2Q(w)})\frac{|w|}{c_{r}}|\frac{w}{w_{r}}|^{-\gamma})\quad(1.6)
  </annotation>
 </semantics>
</math>

</p>

<p>where c<sub>r</sub> and Q<sub>r</sub> are the phase velocity c(w) and the Q(w) value, respectively, at an arbitrary reference frequency. Substituting this complex-valued wavenumber k(w) into solution (1.2) produces the following expression:</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:7">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo>+</mo>
    <mo>△</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mfrac>
     <mrow>
      <mo>△</mo>
      <mi>r</mi>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>w</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mi>i</mi>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>w</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>△</mo>
      <mi>r</mi>
     </mrow>
     <msub>
      <mi>c</mi>
      <mi>r</mi>
     </msub>
    </mfrac>
    <mo stretchy="false">|</mo>
    <mfrac>
     <mi>w</mi>
     <msub>
      <mi>w</mi>
      <mi>r</mi>
     </msub>
    </mfrac>
    <msup>
     <mo stretchy="false">|</mo>
     <mrow>
      <mo>-</mo>
      <mi>γ</mi>
     </mrow>
    </msup>
    <mo stretchy="false">]</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1.7</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">r</csymbol>
     <plus></plus>
     <ci>normal-△</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-△</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>Q</ci>
       <ci>w</ci>
      </apply>
     </apply>
     <plus></plus>
     <csymbol cd="unknown">i</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-△</ci>
       <apply>
        <abs></abs>
        <ci>w</ci>
       </apply>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <divide></divide>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-|</ci>
      <apply>
       <minus></minus>
       <ci>γ</ci>
      </apply>
     </apply>
     <ci>normal-]</ci>
    </cerror>
    <ci></ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="float">1.7</cn>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(r+\bigtriangleup r,w)=U(r,w)\exp[\frac{\bigtriangleup r}{2Q(w)}+i\frac{|w|%
\bigtriangleup r}{c_{r}}|\frac{w}{w_{r}}|^{-\gamma}]\quad(1.7)
  </annotation>
 </semantics>
</math>

</p>

<p>Replacing the distance increment ∆r by traveltime increment ∆t = ∆r/c<sub>r</sub>, equation (1.7) is expressed as</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:8">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo>+</mo>
    <mo>△</mo>
    <mi>t</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo maxsize="210%" minsize="210%">(</mo>
    <mo stretchy="false">|</mo>
    <mfrac>
     <mi>w</mi>
     <msub>
      <mi>w</mi>
      <mi>h</mi>
     </msub>
    </mfrac>
    <msup>
     <mo stretchy="false">|</mo>
     <mrow>
      <mo>-</mo>
      <mi>γ</mi>
     </mrow>
    </msup>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>w</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>△</mo>
      <mi>t</mi>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>w</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo maxsize="210%" minsize="210%">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo maxsize="210%" minsize="210%">(</mo>
    <mi>i</mi>
    <mo stretchy="false">|</mo>
    <mfrac>
     <mi>w</mi>
     <msub>
      <mi>w</mi>
      <mi>h</mi>
     </msub>
    </mfrac>
    <msup>
     <mo stretchy="false">|</mo>
     <mrow>
      <mo>-</mo>
      <mi>γ</mi>
     </mrow>
    </msup>
    <mi>w</mi>
    <mo>△</mo>
    <mi>t</mi>
    <mo maxsize="210%" minsize="210%">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1.8.</mn>
    <mi>a</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <plus></plus>
     <ci>normal-△</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <ci>normal-|</ci>
     <apply>
      <divide></divide>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-|</ci>
      <apply>
       <minus></minus>
       <ci>γ</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-△</ci>
       <apply>
        <abs></abs>
        <ci>w</ci>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>Q</ci>
       <ci>w</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-|</ci>
     <apply>
      <divide></divide>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-|</ci>
      <apply>
       <minus></minus>
       <ci>γ</ci>
      </apply>
     </apply>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-△</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="float">1.8.</cn>
     <csymbol cd="unknown">a</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(t+\bigtriangleup t,w)=U(t,w)\exp\bigg(|\frac{w}{w_{h}}|^{-\gamma}\frac{|w|%
\bigtriangleup t}{2Q(w)}\bigg)\exp\bigg(i|\frac{w}{w_{h}}|^{-\gamma}w%
\bigtriangleup t\bigg)\quad(1.8.a)
  </annotation>
 </semantics>
</math>

</p>

<p>This is a basic inverse Q filter with the Kolsky model. The two exponential operators compensate and correct for, respectively, the amplitude effect (i.e. the energy absorption) and the phase effect (i.e. the velocity dispersion) of the earth Q filter. In order for the inverse filter to compensate for a <a href="Causal_filter" title="wikilink">causal solution</a> Wang modified the original Kolsky model by using w<sub>r</sub> as the highest frequency in the frequency band and call it w<sub>h</sub>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>As mentioned above, at the same time we start discussing the design and application of an inverse Q-filter, we need to specify a mathematical Q-model that can compute benchmark data similar to Wang’s benchmark data that can be used for inversion later. Then we must regard the forward Q-filtering process as our solution of (1.2) which means we must compute the inversion of (1.2) as a Q-forward filtering process. Wang showed how easily this could be done by simply changing the sign before γ and Q.</p>

<p>Wang writes: We call the removal of the phase correction effect given by a previous phase-only inverse Q-filtering as phase-only forward Q-filtering. It would be rather straightforward if we consider it as an inverse problem of the inverse equation and take an inverse solution. But solving an inverse problem is often time-consuming because it involves the computation of an inverse matrix.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> Then Wang develops the theory both of amplitude forward Q-filtering and phase Q-filtering simply by changing sign before γ and Q, and introduce the equation:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:9">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo>+</mo>
    <mo>△</mo>
    <mi>t</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo maxsize="210%" minsize="210%">(</mo>
    <mo>-</mo>
    <mo stretchy="false">|</mo>
    <mfrac>
     <mi>w</mi>
     <msub>
      <mi>w</mi>
      <mi>r</mi>
     </msub>
    </mfrac>
    <msup>
     <mo stretchy="false">|</mo>
     <mi>γ</mi>
    </msup>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>w</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>△</mo>
      <mi>t</mi>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>w</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo maxsize="210%" minsize="210%">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo maxsize="210%" minsize="210%">(</mo>
    <mi>i</mi>
    <mo stretchy="false">|</mo>
    <mfrac>
     <mi>w</mi>
     <msub>
      <mi>w</mi>
      <mi>r</mi>
     </msub>
    </mfrac>
    <msup>
     <mo stretchy="false">|</mo>
     <mi>γ</mi>
    </msup>
    <mi>w</mi>
    <mo>△</mo>
    <mi>t</mi>
    <mo maxsize="210%" minsize="210%">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1.8.</mn>
    <mi>b</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <plus></plus>
     <ci>normal-△</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <minus></minus>
     <ci>normal-|</ci>
     <apply>
      <divide></divide>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-|</ci>
      <ci>γ</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-△</ci>
       <apply>
        <abs></abs>
        <ci>w</ci>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>Q</ci>
       <ci>w</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-|</ci>
     <apply>
      <divide></divide>
      <ci>w</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-|</ci>
      <ci>γ</ci>
     </apply>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-△</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci></ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="float">1.8.</cn>
     <csymbol cd="unknown">b</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(t+\bigtriangleup t,w)=U(t,w)\exp\bigg(-|\frac{w}{w_{r}}|^{\gamma}\frac{|w|%
\bigtriangleup t}{2Q(w)}\bigg)\exp\bigg(i|\frac{w}{w_{r}}|^{\gamma}w%
\bigtriangleup t\bigg)\quad(1.8.b)
  </annotation>
 </semantics>
</math>

</p>

<p>In (1.8.b) I use the reference frequency in the original form given by Kolsky and use the notation w<sub>r</sub>.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Equation (1.8.a and. b) is the basis for Q filtering in which downward continuation is performed in the frequency domain on all plane waves. The sum of these plane waves gives the time-domain seismic signal,</p>

<p>

<math display="block" id="Seismic_inverse_Q_filtering:10">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo>+</mo>
    <mo>△</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mn>0</mn>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo>+</mo>
    <mo>△</mo>
    <mi>t</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>w</mi>
   <mo>.</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1.9</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <plus></plus>
     <ci>normal-△</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <cn type="integer">0</cn>
     </apply>
     <infinity></infinity>
    </apply>
    <csymbol cd="unknown">U</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <plus></plus>
     <ci>normal-△</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">w</csymbol>
    <ci>normal-.</ci>
    <ci></ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="float">1.9</cn>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(t+\bigtriangleup t)=\int_{0}^{\infty}U(t+\bigtriangleup t,w)dw.\quad(1.9)
  </annotation>
 </semantics>
</math>

</p>

<p>This summation is referred to as the imaging condition, as in seismic migration. Equations (1.8.a) and (1.8.b) must be applied successively to each time sample with sampling interval ∆t, producing u(t) at each level. This last approach completes the downward continuation theory of q-filtering.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h2 id="computations">Computations</h2>

<p>Fig.1 a and b shows a forward Q-filtering solution of (1.8.a-b integrated with (1.9)) for a single pulse presented for this article. This simple graph illustrates very well some aspects of the theory of Q-filtering. Black dotted graph is zero-phase solution of the equation (1.8.b) where we have amplitude only Q-filtering and no effect from the phase (Q=10). On fig.1.a. blue dotted line is (1.8.b) with f<sub>r</sub>=0.001 Hz. (We compute from the relation w=2

<math display="block" id="Seismic_inverse_Q_filtering:11">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 f.) Red line is the solution of (1.8.a) with f<sub>h</sub>=10 Hz. We have no amplitude compensation for (1.8.a), looking only at the effect from the phase. Comparing with fig.1.b. we can see that the smaller the reference frequency f<sub>r</sub> in the forward solution,the more phase effect we get. In the inverse solution (1.8.a) we have the opposite effect,the higher value of f<sub>h</sub> the more the forward phase effect is compensated, toward a causal solution. The graphs give a good illustration of Q-filtering according to the theory of Wang. However, more calculations should be done and more seismic models should be introduced. The effect of amplitude inverse Q-filtering should also be studied.</p>

<p><a class="uri" href="File:Qfilterimage1.jpg.png|Fig.1.a.Solution">File:Qfilterimage1.jpg.png|Fig.1.a.Solution</a> (1.8.a) with phase inversion only f<sub>h</sub>=10 Hz (red) and solution (1.8.b) with f<sub>r</sub>=0.001 Hz (dotted blue). Solution (1.8.b) with amplitude only forward Q-filtering (black dotted). <a class="uri" href="File:Qfilterimage2.png|Fig.1.b.Solution">File:Qfilterimage2.png|Fig.1.b.Solution</a> (1.8.a) with phase inversion only f<sub>h</sub>=1000000 Hz (red) and solution (1.8.b) f<sub>r</sub>=0.0000001 Hz (dotted blue). Solution (1.8.b) with amplitude only forward Q-filtering (black dotted).</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://bki.net/ricc/inverseQfilter">Some aspects of seismic inverse Q-filtering theory</a> by Knut Sørsdal</li>
</ul>

<p>"</p>

<p><a href="Category:Seismology_measurement" title="wikilink">Category:Seismology measurement</a> <a class="uri" href="Category:Geophysics" title="wikilink">Category:Geophysics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Wang 2008, From Preface.<a href="#fnref1">↩</a></li>
<li id="fn2">Wang 2008, From the back cover<a href="#fnref2">↩</a></li>
<li id="fn3">Wang 2008, p.60-62. chapter 4<a href="#fnref3">↩</a></li>
<li id="fn4">Wang 2008, chapter 5.3 Forward Q-filtering<a href="#fnref4">↩</a></li>
<li id="fn5">Wang 2008, p. 18, sec. 2.1: Kolsky's attenuation-dispersion model<a href="#fnref5">↩</a></li>
<li id="fn6">Wang 2008, p.19<a href="#fnref6">↩</a></li>
<li id="fn7">Futterman W.I. 1962. Dispersive body waves. Journal of Geophysical Research 67. p.5279-91<a href="#fnref7">↩</a></li>
<li id="fn8">Wang 2008, p. 20, sec.2.2. Modification to the Kolsky model<a href="#fnref8">↩</a></li>
<li id="fn9">Wang 2008, p.91, sec. 5.3.1 Phase-only forward Q filtering<a href="#fnref9">↩</a></li>
<li id="fn10">Wang 2008, p. 94, sec. 5.4.<a href="#fnref10">↩</a></li>
<li id="fn11">Wang 2008, p. 19<a href="#fnref11">↩</a></li>
<li id="fn12">Wang 2008, p. 6,p.62.<a href="#fnref12">↩</a></li>
</ol>
</section>
</body>
</html>

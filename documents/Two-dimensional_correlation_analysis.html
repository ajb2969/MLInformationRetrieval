<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1629">Two-dimensional correlation analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Two-dimensional correlation analysis</h1>
<hr/>

<p><strong>Two dimensional correlation analysis</strong> is a mathematical technique that is used to study changes in measured signals. As mostly spectroscopic signals are discussed, sometime also <strong>two dimensional correlation spectroscopy</strong> is used and refers to the same technique.</p>

<p>In 2D correlation analysis, a sample is subjected to an external perturbation while all other parameters of the system are kept at the same value. This perturbation can be a systematic and controlled change in temperature, pressure, pH, chemical composition of the system, or even time after a <a class="uri" href="catalyst" title="wikilink">catalyst</a> was added to a chemical mixture. As a result of the controlled change (the <em>perturbation</em>), the system will undergo variations which are measured by a chemical or physical detection method. The measured signals or spectra will shown systematic variations that are processed with 2D correlation analysis for interpretation.</p>

<p>When one considers spectra that consist of few bands, it is quite obvious to determine which bands are subject to a changing intensity. Such a changing intensity can be caused for example by chemical reactions. However, the interpretation of the measured signal becomes more tricky when spectra are complex and bands are heavily overlapping. Two dimensional correlation analysis allows one to determine at which positions in such a measured signal there is a systematic change in a peak, either continuous rising or drop in intensity. 2D correlation analysis results in two complementary signals, which referred to as the 2D synchronous and 2D asynchronous spectrum. These signals allow amongst others<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<ol>
<li>to determine the events that are occurring at the same time (in phase) and those events that are occurring at different times (out of phase)</li>
<li>to determine the sequence of spectral changes</li>
<li>to identify various inter- and intramolecular interactions</li>
<li>band assignments of reacting groups</li>
<li>to detect correlations between spectra of different techniques, for example <a href="near_infrared_spectroscopy" title="wikilink">near infrared spectroscopy</a> (NIR) and <a href="Raman_spectroscopy" title="wikilink">Raman spectroscopy</a></li>
</ol>
<h2 id="history">History</h2>

<p>2D correlation analysis originated from <a href="Correlation_spectroscopy" title="wikilink">2D NMR spectroscopy</a>. <a href="Isao_Noda" title="wikilink">Isao Noda</a> developed perturbation based 2D spectroscopy in the 1980s.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> This technique required sinusoidal perturbations to the chemical system under investigation. This specific type of the applied perturbation severely limited its possible applications. Following research done by several groups of scientists, perturbation based 2D spectroscopy could be developed to a more extended and generalized broader base. Since the development of generalized 2D correlation analysis in 1993 based on <a href="Fourier_transformation" title="wikilink">Fourier transformation</a> of the data, 2D correlation analysis gained widespread use. Alternative techniques that were simpler to calculate, for example the <a href="disrelation_spectrum" title="wikilink">disrelation spectrum</a>, were also developed simultaneously. Because of its computational efficiency and simplicity, the <a href="Hilbert_transform" title="wikilink">Hilbert transform</a> is nowadays used for the calculation of the 2D spectra. To date, 2D correlation analysis is not only used for the interpretation of many types of spectroscopic data (including <a href="X-ray_fluorescence" title="wikilink">XRF</a>, <a href="UV/VIS_spectroscopy" title="wikilink">UV/VIS spectroscopy</a>, <a href="fluorescence_spectroscopy" title="wikilink">fluorescence</a>, <a href="infrared_spectroscopy" title="wikilink">infrared</a>, and <a href="Raman_spectroscopy" title="wikilink">Raman</a> spectra), although its application is not limited to spectroscopy.</p>
<h2 id="properties-of-2d-correlation-analysis">Properties of 2D correlation analysis</h2>

<p> 2D correlation analysis is frequently used for its main advantage: increasing the spectral resolution by spreading overlapping peaks over two dimensions and as a result simplification of the interpretation of one-dimensional spectra that are otherwise visually indistinguishable from each other.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Further advantages are its ease of application and the possibility to make the distinction between band shifts and band overlap.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Each type of spectral event, band shifting, overlapping bands of which the intensity changes in the opposite direction, band broadening, baseline change, etc. has a particular 2D pattern. See also the figure with the original dataset on the right and the corresponding 2D spectrum in the figure below.</p>
<h2 id="presence-of-2d-spectra">Presence of 2D spectra</h2>

<p>2D synchronous and asynchronous spectra are basically 3D-datasets and are generally represented by contour plots. X- and y-axes are identical to the x-axis of the original dataset, whereas the different contours represent the magnitude of correlation between the spectral intensities. The 2D synchronous spectrum is symmetric relative to the main diagonal. The main diagonal thus contains positive peaks. As the peaks at (<em>x</em>,<em>y</em>) in de 2D synchronous spectrum are a measure for the correlation between the intensity changes at <em>x</em> and <em>y</em> in the original data, these main diagonal peaks are also called <em>autopeaks</em> and the main diagonal signal is referred to as <em><a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a> signal</em>. The off-diagonal <em>cross-peaks</em> can be either positive or negative. On the other hand the asynchronous spectrum is asymmetric and never has peaks on the main diagonal.</p>

<p>Generally contour plots of 2D spectra are oriented with rising axes from left to right and top to down. Other orientations are possible, but interpretation has to be adapted accordingly.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="calculation-of-2d-spectra">Calculation of 2D spectra</h2>

<p>Suppose the original dataset <strong>D</strong> contains the <em>n</em> spectra in rows. The signals of the original dataset are generally preprocessed. The original spectra are compared to a reference spectrum. By subtracting a reference spectrum, often the average spectrum of the dataset, so called dynamic spectra are calculated which form the corresponding dynamic dataset <em>E</em>. The presence and interpretation may be dependent on the choice of reference spectrum. The equations below are valid for equally spaced measurements of the perturbation.</p>
<h3 id="calculation-of-the-synchronous-spectrum">Calculation of the synchronous spectrum</h3>

<p>A 2D synchronous spectrum expresses the similarity between spectral of the data in the original dataset. In generalized 2D correlation spectroscopy this is mathematically expressed as <a class="uri" href="covariance" title="wikilink">covariance</a> (or <a class="uri" href="correlation" title="wikilink">correlation</a>).</p>

<p>

<math display="block" id="Two-dimensional_correlation_analysis:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ν</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>ν</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <msup>
      <mi>y</mi>
      <mi>T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ν</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
   <mrow>
    <mi>y</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ν</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ν</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ν</ci>
        <cn type="integer">2</cn>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ν</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>y</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ν</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(\nu_{1},\nu_{2})=\frac{1}{n-1}y^{T}(\nu_{1}).y(\nu_{2})
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li><em>Φ</em> is the 2D synchronous spectrum</li>
<li><em>ν<sub>1</sub></em> and <em>ν<sub>2</sub></em> are two spectral channels</li>
<li><em>y<sub>ν</sub></em> is the vector composed of the signal intensities in <strong>E</strong> in column <em>ν</em></li>
<li><em>n</em> the number of signals in the original dataset</li>
</ul>
<h3 id="calculation-of-the-asynchronous-spectrum">Calculation of the asynchronous spectrum</h3>

<p>Orthogonal spectra to the dynamic dataset <strong>E</strong> are obtained with the Hilbert-transform:</p>

<p>

<math display="block" id="Two-dimensional_correlation_analysis:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ψ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ν</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>ν</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
     <msup>
      <mi>y</mi>
      <mi>T</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ν</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
   <mi>N</mi>
   <mo>.</mo>
   <mrow>
    <mi>y</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ν</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ψ</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ν</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ν</ci>
        <cn type="integer">2</cn>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ν</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>y</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ν</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(\nu_{1},\nu_{2})=\frac{1}{n-1}y^{T}(\nu_{1}).N.y(\nu_{2})
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li><em>Ψ</em> is the 2D asynchronous spectrum</li>
<li><em>ν<sub>1</sub></em> en <em>ν<sub>1</sub></em> are two spectral channels</li>
<li><em>y<sub>ν</sub></em> is the vector composed of the signal intensities in <strong>E</strong> in column <em>ν</em></li>
<li><em>n</em> the number of signals in the original dataset</li>
<li><strong>N</strong> the Noda-Hilbert transform matrix</li>
</ul>

<p>The values of <strong>N</strong>, <em>N<sub>j, k</sub></em> are determined as follows:</p>
<ul>
<li>0 if j = k</li>
<li>

<math display="inline" id="Two-dimensional_correlation_analysis:2">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mi>π</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mi>j</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>π</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{\pi(k-j)}
  </annotation>
 </semantics>
</math>

 if j ≠ k</li>
</ul>

<p>where:</p>
<ul>
<li><em>j</em> the row number</li>
<li><em>k</em> the column number</li>
</ul>
<h2 id="interpretation">Interpretation</h2>

<p>Interpretation of two-dimensional correlation spectra can be considered to consist of several stages.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h3 id="detection-of-peaks-of-which-the-intensity-changes-in-the-original-dataset">Detection of peaks of which the intensity changes in the original dataset</h3>

<p>As real measurement signals contain a certain level of noise, the derived 2D spectra are influenced and degraded with substantial higher amounts of noise. Hence, interpretation begins with studying the autocorrelation spectrum on the main diagonal of the 2D synchronous spectrum. In the 2D synchronous main diagonal signal on the right 4 peaks are visible at 10, 20, 30, and 40 (see also the 4 corresponding positive autopeaks in the 2D synchronous spectrum on the right). This indicates that in the original dataset 4 peaks of changing intensity are present. The intensity of peaks on the autocorrelation spectrum are directly proportional to the relative importance of the intensity change in the original spectra. Hence, if an intense band is present at position <em>x</em>, it is very likely that a true intensity change is occurring and the peak is not due to noise.</p>

<p>Additional techniques help to filter the peaks that can be seen in the 2D synchronous and asynchronous spectra.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h3 id="determining-the-direction-of-intensity-change">Determining the direction of intensity change</h3>

<p>It is not always possible to unequivocally determine the direction of intensity change, such as is for example the case for highly overlapping signals next to each other and of which the intensity changes in the opposite direction. This is where the off diagonal peaks in the synchronous 2D spectrum are used for:</p>
<ol>
<li>if there is a positive cross-peak at (<em>x</em>, <em>y</em>) in the synchronous 2D spectrum, the intensity of the signals at <em>x</em> and <em>y</em> changes in the same direction</li>
<li>if there is a negative cross-peak at (<em>x</em>, <em>y</em>) in the synchronous 2D spectrum, the intensity of the signals at <em>x</em> and <em>y</em> changes in the opposite direction</li>
</ol>

<p>As can be seen in the 2D synchronous spectrum on the right, the intensity changes of the peaks at 10 and 30 are related and the intensity of the peak at 10 and 30 changes in the opposite direction (negative cross-peak at (10,30)). The same is true for the peaks at 20 and 40.</p>
<h3 id="determining-the-sequence-of-events">Determining the sequence of events</h3>

<p>Most importantly, with the <em>sequential order rules</em>, also referred to as <em>Noda's rules</em>, the sequence of the intensity changes can be determined.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> By carefully interpreting the signs of the 2D synchronous and asynchronous cross peaks with the following rules, the sequence of spectral events during the experiment can be determined:</p>
<ol>
<li>if the intensities of the bands at <em>x</em> and <em>y</em> in the dataset are changing in the same direction, the synchronous 2D cross peak at (<em>x</em>,<em>y</em>) is positive</li>
<li>if the intensities of the bands at <em>x</em> and <em>y</em> in the dataset are changing in the opposite direction, the synchronous 2D cross peak at (<em>x</em>,<em>y</em>) is negative</li>
<li>if the change at x mainly precedes the change in the band at <em>y</em>, the asynchronous 2D cross peak at (<em>x</em>,<em>y</em>) is positive</li>
<li>if the change at x mainly follows the change in the band at <em>y</em>, the asynchronous 2D cross peak at (<em>x</em>,<em>y</em>) is negative</li>
<li>if the synchronous 2D cross peak at (<em>x</em>,<em>y</em>) is negative, the interpretation of rule 3 and 4 for the asynchronous 2D peak at (<em>x</em>,<em>y</em>) has to be reversed</li>
</ol>
<dl>
<dd>where <em>x</em> and <em>y</em> are the positions on the x-xaxis of two bands in the original data that are subject to intensity changes.
</dd>
</dl>

<p>Following the rules above. It can be derived that the changes at 10 and 30 occur simultaneously and the changes in intensity at 20 and 40 occur simultaneously as well. Because of the positive asynchronous cross-peak at (10, 20), the changes at 10 and 30 (predominantly) occur before the intensity changes at 20 and 40.</p>

<p>It should be noted that in some cases the Noda rules cannot be so readily implied, predominately when spectral features are not caused by simple intensity variations. This may occur when band shifts occur, or when a very erratic intensity variation is present in a given frequency range.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Correlation_spectroscopy" title="wikilink">Correlation spectroscopy</a></li>
<li><a href="Fluorescence_correlation_spectroscopy" title="wikilink">Fluorescence correlation spectroscopy</a></li>
<li><a href="Two-dimensional_infrared_spectroscopy" title="wikilink">Two-dimensional infrared spectroscopy</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Spectroscopy" title="wikilink">Category:Spectroscopy</a> <a href="Category:Scientific_techniques" title="wikilink">Category:Scientific techniques</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"></li>
</ol>
</section>
</body>
</html>

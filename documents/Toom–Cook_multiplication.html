<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="101">Toom–Cook multiplication</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Toom–Cook multiplication</h1>
<hr/>

<p><strong>Toom–Cook</strong>, sometimes known as <strong>Toom-3</strong>, named after <a href="Andrei_Toom" title="wikilink">Andrei Toom</a>, who introduced the new algorithm with its low complexity, and <a href="Stephen_Cook" title="wikilink">Stephen Cook</a>, who cleaned the description of it, is a <a href="multiplication_algorithm" title="wikilink">multiplication algorithm</a>, a method of multiplying two large integers.</p>

<p>Given two large integers, <em>a</em> and <em>b</em>, Toom–Cook splits up <em>a</em> and <em>b</em> into <em>k</em> smaller parts each of length <em>l</em>, and performs operations on the parts. As <em>k</em> grows, one may combine many of the multiplication sub-operations, thus reducing the overall complexity of the algorithm. The multiplication sub-operations can then be computed recursively using Toom–Cook multiplication again, and so on. Although the terms "Toom-3" and "Toom–Cook" are sometimes incorrectly used interchangeably, Toom-3 is only a single instance of the Toom–Cook algorithm, where <em>k</em> = 3.</p>

<p>Toom-3 reduces 9 multiplications to 5, and runs in Θ(<em>n</em><sup>log(5)/log(3)</sup>), about Θ(<em>n</em><sup>1.465</sup>). In general, Toom-<em>k</em> runs in Θ(<em>c</em>(<em>k</em>) <em>n<sup>e</sup></em>), where <em>e</em> = log(2<em>k</em> − 1) / log(<em>k</em>), <em>n<sup>e</sup></em> is the time spent on sub-multiplications, and <em>c</em> is the time spent on additions and multiplication by small constants.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The <a href="Karatsuba_algorithm" title="wikilink">Karatsuba algorithm</a> is a special case of Toom–Cook, where the number is split into two smaller ones. It reduces 4 multiplications to 3 and so operates at Θ(<em>n</em><sup>log(3)/log(2)</sup>), which is about Θ(<em>n</em><sup>1.585</sup>). Ordinary long multiplication is equivalent to Toom-1, with complexity Θ(<em>n</em><sup>2</sup>).</p>

<p>Although the exponent <em>e</em> can be set arbitrarily close to 1 by increasing <em>k</em>, the function <em>c</em> unfortunately grows very rapidly.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The growth rate for mixed-level Toom-Cook schemes was still an open research problem in 2005.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> An implementation described by <a href="Donald_Knuth" title="wikilink">Donald Knuth</a> achieves the time complexity Θ(<em>n</em> 2<sup>√(2 log <em>n</em>)</sup> log <em>n</em>).<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>Due to its overhead, Toom–Cook is slower than long multiplication with small numbers, and it is therefore typically used for intermediate-size multiplications, before the asymptotically faster <a href="Schönhage–Strassen_algorithm" title="wikilink">Schönhage–Strassen algorithm</a> (with complexity Θ(<em>n</em> log <em>n</em> log log <em>n</em>)) becomes practical.</p>

<p>Toom first described this algorithm in 1963, and Cook published an improved (asymptotically equivalent) algorithm in his PhD thesis in 1966.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="details">Details</h2>

<p>This section discusses exactly how to perform Toom-<em>k</em> for any given value of <em>k</em>, and is a simplification of a description of Toom–Cook polynomial multiplication described by Marco Bodrato.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> The algorithm has five main steps:</p>
<ol>
<li><a href="Toom–Cook_multiplication#Splitting" title="wikilink">Splitting</a></li>
<li><a href="Toom–Cook_multiplication#Evaluation" title="wikilink">Evaluation</a></li>
<li><a href="Toom–Cook_multiplication#Pointwise_multiplication" title="wikilink">Pointwise multiplication</a></li>
<li><a href="Toom–Cook_multiplication#Interpolation" title="wikilink">Interpolation</a></li>
<li><a href="Toom–Cook_multiplication#Recomposition" title="wikilink">Recomposition</a></li>
</ol>

<p>In a typical large integer implementation, each integer is represented as a sequence of digits in <a href="positional_notation" title="wikilink">positional notation</a>, with the base or radix set to some (typically large) value <em>b</em>; for this example we use <em>b</em> = 10000, so that each digit corresponds to a group of four decimal digits (in a computer implementation, <em>b</em> would typically be a power of 2 instead). Say the two integers being multiplied are:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>m</em></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>3456</p></td>
<td style="text-align: left;">
<p>7890</p></td>
<td style="text-align: left;">
<p>1234</p></td>
<td style="text-align: left;">
<p>5678</p></td>
<td style="text-align: left;">
<p>9012</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>n</em></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>8765</p></td>
<td style="text-align: left;">
<p>4321</p></td>
<td style="text-align: left;">
<p>9876</p></td>
<td style="text-align: left;">
<p>5432</p></td>
<td style="text-align: left;">
<p>1098.</p></td>
</tr>
</tbody>
</table>

<p>These are much smaller than would normally be processed with Toom–Cook (grade-school multiplication would be faster) but they will serve to illustrate the algorithm.</p>
<h3 id="splitting">Splitting</h3>

<p>The first step is to select the base <em>B</em> = <em>b</em><sup><em>i</em></sup>, such that the number of digits of both <em>m</em> and <em>n</em> in base <em>B</em> is at most <em>k</em> (e.g., 3 in Toom-3). A typical choice for <em>i</em> is given by:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:0">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>max</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">⌊</mo>
         <mrow>
          <msub>
           <mi>log</mi>
           <mi>b</mi>
          </msub>
          <mi>m</mi>
         </mrow>
         <mo stretchy="false">⌋</mo>
        </mrow>
        <mo>/</mo>
        <mi>k</mi>
       </mrow>
       <mo stretchy="false">⌋</mo>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">⌊</mo>
         <mrow>
          <msub>
           <mi>log</mi>
           <mi>b</mi>
          </msub>
          <mi>n</mi>
         </mrow>
         <mo stretchy="false">⌋</mo>
        </mrow>
        <mo>/</mo>
        <mi>k</mi>
       </mrow>
       <mo stretchy="false">⌋</mo>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <apply>
     <plus></plus>
     <apply>
      <max></max>
      <apply>
       <floor></floor>
       <apply>
        <divide></divide>
        <apply>
         <floor></floor>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <log></log>
           <ci>b</ci>
          </apply>
          <ci>m</ci>
         </apply>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <floor></floor>
       <apply>
        <divide></divide>
        <apply>
         <floor></floor>
         <apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <log></log>
           <ci>b</ci>
          </apply>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <cn type="float">1.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=\max\{{\lfloor}{\lfloor}\log_{b}m{\rfloor}/k{\rfloor},{\lfloor}{\lfloor}\log%
_{b}n{\rfloor}/k{\rfloor}\}+1.
  </annotation>
 </semantics>
</math>

</p>

<p>In our example we'll be doing Toom-3, so we choose <em>B</em> = <em>b</em><sup>2</sup> = 10<sup>8</sup>. We then separate <em>m</em> and <em>n</em> into their base <em>B</em> digits <em>m</em><sub><em>i</em></sub>, <em>n</em><sub><em>i</em></sub>:</p>

<p>

<math display="inline" id="Toom–Cook_multiplication:1">
 <semantics>
  <msub>
   <mi>m</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle m_{2}
  </annotation>
 </semantics>
</math>


</p>

<p>We then use these digits as coefficients in degree <em>k</em>−1 polynomials <em>p</em> and <em>q</em>, with the property that <em>p</em>(<em>B</em>) = <em>m</em> and <em>q</em>(<em>B</em>) = <em>n</em>:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>m</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>m</mi>
      <mn>1</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>m</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>123456</mn>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>78901234</mn>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mn>56789012</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">123456</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">78901234</cn>
       <ci>x</ci>
      </apply>
      <cn type="integer">56789012</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(x)=m_{2}x^{2}+m_{1}x+m_{0}=123456x^{2}+78901234x+56789012\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Toom–Cook_multiplication:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>n</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>n</mi>
      <mn>1</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>n</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>98765</mn>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>43219876</mn>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mn>54321098</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">98765</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">43219876</cn>
       <ci>x</ci>
      </apply>
      <cn type="integer">54321098</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(x)=n_{2}x^{2}+n_{1}x+n_{0}=98765x^{2}+43219876x+54321098\,
  </annotation>
 </semantics>
</math>

</p>

<p>The purpose of defining these polynomials is that if we can compute their product <em>r</em>(<em>x</em>) = <em>p</em>(<em>x</em>)<em>q</em>(<em>x</em>), our answer will be <em>r</em>(<em>B</em>) = <em>m</em>×<em>n</em>.</p>

<p>In the case where the numbers being multiplied are of different sizes, it's useful to use different values of <em>k</em> for <em>m</em> and <em>n</em>, which we'll call <em>k</em><sub><em>m</em></sub> and <em>k</em><sub><em>n</em></sub>. For example, the algorithm "Toom-2.5" refers to Toom–Cook with <em>k</em><sub><em>m</em></sub> = 3 and <em>k</em><sub><em>n</em></sub> = 2. In this case the <em>i</em> in <em>B</em> = <em>b</em><sup><em>i</em></sup> is typically chosen by:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mi>max</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">⌈</mo>
         <mrow>
          <msub>
           <mi>log</mi>
           <mi>b</mi>
          </msub>
          <mi>m</mi>
         </mrow>
         <mo stretchy="false">⌉</mo>
        </mrow>
        <mo>/</mo>
        <msub>
         <mi>k</mi>
         <mi>m</mi>
        </msub>
       </mrow>
       <mo stretchy="false">⌋</mo>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">⌈</mo>
         <mrow>
          <msub>
           <mi>log</mi>
           <mi>b</mi>
          </msub>
          <mi>n</mi>
         </mrow>
         <mo stretchy="false">⌉</mo>
        </mrow>
        <mo>/</mo>
        <msub>
         <mi>k</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo stretchy="false">⌋</mo>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <apply>
     <max></max>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <ceiling></ceiling>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <log></log>
          <ci>b</ci>
         </apply>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <apply>
        <ceiling></ceiling>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <log></log>
          <ci>b</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=\max\{{\lfloor}{\lceil}\log_{b}m{\rceil}/k_{m}{\rfloor},{\lfloor}{\lceil}%
\log_{b}n{\rceil}/k_{n}{\rfloor}\}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="evaluation">Evaluation</h3>

<p>The Toom–Cook approach to computing the polynomial product <em>p</em>(<em>x</em>)<em>q</em>(<em>x</em>) is a commonly used one. Note that a polynomial of degree <em>d</em> is uniquely determined by <em>d</em> + 1 points (for example, a line - polynomial of degree one is specified by two points). The idea is to evaluate <em>p(·)</em> and <em>q(·)</em> at various points. Then multiply their values at these points to get points on the product polynomial. Finally interpolate to find its coefficients.</p>

<p>Since deg(<em>pq</em>) = deg(<em>p</em>) + deg(<em>q</em>), we will need deg(<em>p</em>) + deg(<em>q</em>) + 1 = <em>k</em><sub><em>m</em></sub> + <em>k</em><sub><em>n</em></sub> − 1 points to determine the final result. Call this <em>d</em>. In the case of Toom-3, <em>d</em> = 5. The algorithm will work no matter what points are chosen (with a few small exceptions, see matrix invertibility requirement in <a href="Toom–Cook_multiplication#Interpolation" title="wikilink">Interpolation</a>), but in the interest of simplifying the algorithm it's better to choose small integer values like 0, 1, −1, and −2.</p>

<p>One unusual point value that is frequently used is infinity, written ∞ or 1/0. To "evaluate" a polynomial <em>p</em> at infinity actually means to take the limit of <em>p</em>(<em>x</em>)/<em>x</em><sup>deg <em>p</em></sup> as <em>x</em> goes to infinity. Consequently, <em>p</em>(∞) is always the value of its highest-degree coefficient (in the example above coefficient m<sub>2</sub>).</p>

<p>In our Toom-3 example, we will use the points 0, 1, −1, −2, and ∞. These choices simplify evaluation, producing the formulas:</p>

<p>

<math display="inline" id="Toom–Cook_multiplication:5">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p(0)
  </annotation>
 </semantics>
</math>


</p>

<p>and analogously for <em>q</em>. In our example, the values we get are:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>p</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>p</em>(1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>0</sub> + <em>m</em><sub>1</sub> + <em>m</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012 + 78901234 + 123456</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>135813702</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>p</em>(−1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>0</sub> − <em>m</em><sub>1</sub> + <em>m</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012 − 78901234 + 123456</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−21988766</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>p</em>(−2)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>0</sub> − 2<em>m</em><sub>1</sub> + 4<em>m</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012 − 2×78901234 + 4×123456</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−100519632</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>p</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>123456</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>123456</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>q</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>n</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>54321098</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>54321098</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>q</em>(1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>n</em><sub>0</sub> + <em>n</em><sub>1</sub> + <em>n</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>54321098 + 43219876 + 98765</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>97639739</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>q</em>(−1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>n</em><sub>0</sub> − <em>n</em><sub>1</sub> + <em>n</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>54321098 − 43219876 + 98765</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>11199987</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>q</em>(−2)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>n</em><sub>0</sub> − 2<em>n</em><sub>1</sub> + 4<em>n</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>54321098 − 2×43219876 + 4×98765</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−31723594</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>q</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>n</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>98765</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>98765.</p></td>
</tr>
</tbody>
</table>

<p>As shown, these values may be negative.</p>

<p>For the purpose of later explanation, it will be useful to view this evaluation process as a matrix-vector multiplication, where each row of the matrix contains powers of one of the evaluation points, and the vector contains the coefficients of the polynomial:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>1</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>p</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi mathvariant="normal">∞</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msup>
          <mn>0</mn>
          <mn>0</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mn>0</mn>
          <mn>1</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mn>0</mn>
          <mn>2</mn>
         </msup>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msup>
          <mn>1</mn>
          <mn>0</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mn>1</mn>
          <mn>1</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mn>1</mn>
          <mn>2</mn>
         </msup>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>0</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>1</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>2</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>0</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>2</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>1</mn>
         </msup>
        </mtd>
        <mtd columnalign="center">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mo>-</mo>
            <mn>2</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>m</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>m</mi>
          <mn>1</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>m</mi>
          <mn>2</mn>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>m</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>m</mi>
          <mn>1</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>m</mi>
          <mn>2</mn>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <ci>p</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>p</ci>
        <infinity></infinity>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">0</cn>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">0</cn>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">1</cn>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">0</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">4</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">0</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{matrix}p(0)\\
p(1)\\
p(-1)\\
p(-2)\\
p(\infty)\end{matrix}\right)=\left(\begin{matrix}0^{0}&0^{1}&0^{2}\\
1^{0}&1^{1}&1^{2}\\
(-1)^{0}&(-1)^{1}&(-1)^{2}\\
(-2)^{0}&(-2)^{1}&(-2)^{2}\\
0&0&1\end{matrix}\right)\left(\begin{matrix}m_{0}\\
m_{1}\\
m_{2}\end{matrix}\right)=\left(\begin{matrix}1&0&0\\
1&1&1\\
1&-1&1\\
1&-2&4\\
0&0&1\end{matrix}\right)\left(\begin{matrix}m_{0}\\
m_{1}\\
m_{2}\end{matrix}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The dimensions of the matrix are <em>d</em> by <em>k</em><sub><em>m</em></sub> for <em>p</em> and <em>d</em> by <em>k</em><sub><em>n</em></sub> for <em>q</em>. The row for infinity is always all zero except for a 1 in the last column.</p>
<h4 id="faster-evaluation">Faster evaluation</h4>

<p>Multipoint evaluation can be obtained faster than with the above formulas. The number of elementary operations (addition/subtraction) can be reduced. The sequence given by Bodrato<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> for Toom-3, executed here over the first operand (polynomial <em>p</em>) of the running example is the following:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>p</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>0</sub> + <em>m</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012 + 123456</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56912468</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>p</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>p</em>(1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em><sub>0</sub> + <em>m</em><sub>1</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56912468 + 78901234</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>135813702</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>p</em>(−1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em><sub>0</sub> − <em>m</em><sub>1</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56912468 − 78901234</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−21988766</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>p</em>(−2)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>(<em>p</em>(−1) + <em>m</em><sub>2</sub>)×2 − <em>m</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>(− 21988766 + 123456 )×2 − 56789012</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>− 100519632</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>p</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>m</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>123456</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>123456.</p></td>
</tr>
</tbody>
</table>

<p>This sequence requires five addition/subtraction operations, one less than the straightforward evaluation. Moreover the multiplication by 4 in the calculation of <em>p</em>(−2) was saved.</p>
<h3 id="pointwise-multiplication">Pointwise multiplication</h3>

<p>Unlike multiplying the polynomials <em>p</em>(·) and <em>q</em>(·), multiplying the evaluated values <em>p</em>(<em>a</em>) and <em>q</em>(<em>a</em>) just involves multiplying integers — a smaller instance of the original problem. We recursively invoke our multiplication procedure to multiply each pair of evaluated points. In practical implementations, as the operands become smaller, the algorithm will switch to the <a href="Multiplication_algorithm#Long_multiplication" title="wikilink">Schoolbook long multiplication</a>. Letting <em>r</em> be the product polynomial, in our example we have:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em>(0)<em>q</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>56789012 × 54321098</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>3084841486175176</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>r</em>(1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em>(1)<em>q</em>(1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>135813702 × 97639739</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>13260814415903778</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em>(−1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em>(−1)<em>q</em>(−1)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−21988766 × 11199987</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−246273893346042</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>r</em>(−2)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em>(−2)<em>q</em>(−2)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−100519632 × −31723594</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>3188843994597408</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p><em>p</em>(∞)<em>q</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>123456 × 98765</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>12193131840.</p></td>
</tr>
</tbody>
</table>

<p>As shown, these can also be negative. For large enough numbers, this is the most expensive step, the only step that is not linear in the sizes of <em>m</em> and <em>n</em>.</p>
<h3 id="interpolation">Interpolation</h3>

<p>This is the most complex step, the reverse of the evaluation step: given our <em>d</em> points on the product polynomial <em>r</em>(·), we need to determine its coefficients. In other words, we want to solve this matrix equation for the vector on the right-hand side:</p>

<p>

<math display="inline" id="Toom–Cook_multiplication:7">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>r</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>r</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>r</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>r</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <mrow>
       <mi>r</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">∞</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>r</ci>
      <infinity></infinity>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left(\begin{matrix}r(0)\\
r(1)\\
r(-1)\\
r(-2)\\
r(\infty)\end{matrix}\right)
  </annotation>
 </semantics>
</math>


</p>

<p>This matrix is constructed the same way as the one in the evaluation step, except that it's <em>d</em>×<em>d</em>. We could solve this equation with a technique like <a href="Gaussian_elimination" title="wikilink">Gaussian elimination</a>, but this is too expensive. Instead, we use the fact that, provided the evaluation points were chosen suitably, this matrix is invertible, and so:</p>

<p>

<math display="inline" id="Toom–Cook_multiplication:8">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mtable>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>r</mi>
       <mn>0</mn>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>r</mi>
       <mn>1</mn>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>r</mi>
       <mn>2</mn>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>r</mi>
       <mn>3</mn>
      </msub>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>r</mi>
       <mn>4</mn>
      </msub>
     </mtd>
    </mtr>
   </mtable>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">3</cn>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">4</cn>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left(\begin{matrix}r_{0}\\
r_{1}\\
r_{2}\\
r_{3}\\
r_{4}\end{matrix}\right)
  </annotation>
 </semantics>
</math>


</p>

<p>All that remains is to compute this matrix-vector product. Although the matrix contains fractions, the resulting coefficients will be integers — so this can all be done with integer arithmetic, just additions, subtractions, and multiplication/division by small constants. A difficult design challenge in Toom–Cook is to find an efficient sequence of operations to compute this product; one sequence given by Bodrato<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> for Toom-3 is the following, executed here over the running example:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p><em>r</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>3084841486175176</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>r</em><sub>4</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p><em>r</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>12193131840</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>3</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p>(<em>r</em>(−2) − <em>r</em>(1))/3</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>(3188843994597408 − 13260814415903778)/3</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−3357323473768790</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>1</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p>(<em>r</em>(1) − <em>r</em>(−1))/2</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>(13260814415903778 − (−246273893346042))/2</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>6753544154624910</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p><em>r</em>(−1) − <em>r</em>(0)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−246273893346042 − 3084841486175176</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−3331115379521218</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>3</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p>(<em>r</em><sub>2</sub> − <em>r</em><sub>3</sub>)/2 + 2<em>r</em>(∞)</p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>(−3331115379521218 − (−3357323473768790))/2 + 2×12193131840</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>13128433387466</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>2</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p><em>r</em><sub>2</sub> + <em>r</em><sub>1</sub> − <em>r</em><sub>4</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>−3331115379521218 + 6753544154624910 − 12193131840</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>3422416581971852</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>r</em><sub>1</sub></p></td>
<td style="text-align: left;">
<p>←</p></td>
<td style="text-align: left;">
<p><em>r</em><sub>1</sub> − <em>r</em><sub>3</sub></p></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>6753544154624910 − 13128433387466</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>=</p></td>
<td style="text-align: left;">
<p>6740415721237444.</p></td>
</tr>
</tbody>
</table>

<p>We now know our product polynomial <em>r</em>:</p>

<p>

<math display="inline" id="Toom–Cook_multiplication:9">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle r(x)
  </annotation>
 </semantics>
</math>


</p>

<p>If we were using different <em>k</em><sub><em>m</em></sub>, <em>k</em><sub><em>n</em></sub>, or evaluation points, the matrix and so our interpolation strategy would change; but it does not depend on the inputs and so can be hard-coded for any given set of parameters.</p>
<h3 id="recomposition">Recomposition</h3>

<p>Finally, we evaluate r(B) to obtain our final answer. This is straightforward since B is a power of <em>b</em> and so the multiplications by powers of B are all shifts by a whole number of digits in base <em>b</em>. In the running example b = 10<sup>4</sup> and B = b<sup>2</sup> = 10<sup>8</sup>.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>3084</p></td>
<td style="text-align: left;">
<p>8414</p></td>
<td style="text-align: left;">
<p>8617</p></td>
<td style="text-align: left;">
<p>5176</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>6740</p></td>
<td style="text-align: left;">
<p>4157</p></td>
<td style="text-align: left;">
<p>2123</p></td>
<td style="text-align: left;">
<p>7444</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>3422</p></td>
<td style="text-align: left;">
<p>4165</p></td>
<td style="text-align: left;">
<p>8197</p></td>
<td style="text-align: left;">
<p>1852</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>13</p></td>
<td style="text-align: left;">
<p>1284</p></td>
<td style="text-align: left;">
<p>3338</p></td>
<td style="text-align: left;">
<p>7466</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>+</p></td>
<td style="text-align: left;">
<p>121</p></td>
<td style="text-align: left;">
<p>9313</p></td>
<td style="text-align: left;">
<p>1840</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><hr/></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>121</p></td>
<td style="text-align: left;">
<p>9326</p></td>
<td style="text-align: left;">
<p>3124</p></td>
<td style="text-align: left;">
<p>6761</p></td>
<td style="text-align: left;">
<p>1632</p></td>
<td style="text-align: left;">
<p>4937</p></td>
<td style="text-align: left;">
<p>6009</p></td>
<td style="text-align: left;">
<p>5208</p></td>
<td style="text-align: left;">
<p>5858</p></td>
<td style="text-align: left;">
<p>8617</p></td>
<td style="text-align: left;">
<p>5176</p></td>
</tr>
</tbody>
</table>

<p>And this is in fact the product of 1234567890123456789012 and 987654321987654321098.</p>
<h2 id="interpolation-matrices-for-various-k">Interpolation matrices for various <em>k</em></h2>

<p>Here we give common interpolation matrices for a few different common small values of <em>k</em><sub><em>m</em></sub> and <em>k</em><sub><em>n</em></sub>.</p>
<h3 id="toom-1">Toom-1</h3>

<p>Toom-1 (<em>k</em><sub><em>m</em></sub> = <em>k</em><sub><em>n</em></sub> = 1) requires 1 evaluation point, here chosen to be 0. It degenerates to long multiplication, with an interpolation matrix of the identity matrix:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{matrix}1\end{matrix}\right)^{-1}=\left(\begin{matrix}1\end{matrix%
}\right).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="toom-1.5">Toom-1.5</h3>

<p>Toom-1.5 (<em>k</em><sub><em>m</em></sub> = 2, <em>k</em><sub><em>n</em></sub> = 1) requires 2 evaluation points, here chosen to be 0 and ∞. Its interpolation matrix is then the identity matrix:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:11">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{matrix}1&0\\
0&1\end{matrix}\right)^{-1}=\left(\begin{matrix}1&0\\
0&1\end{matrix}\right).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="toom-2">Toom-2</h3>

<p>Toom-2 (<em>k</em><sub><em>m</em></sub> = 2, <em>k</em><sub><em>n</em></sub> = 2) requires 3 evaluation points, here chosen to be 0, 1, and ∞. It is the same as <a href="Karatsuba_multiplication" title="wikilink">Karatsuba multiplication</a>, with an interpolation matrix of:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:12">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{matrix}1&0&0\\
1&1&1\\
0&0&1\end{matrix}\right)^{-1}=\left(\begin{matrix}1&0&0\\
-1&1&-1\\
0&0&1\end{matrix}\right).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="toom-2.5">Toom-2.5</h3>

<p>Toom-2.5 (<em>k</em><sub><em>m</em></sub> = 3, <em>k</em><sub><em>n</em></sub> = 2) requires 4 evaluation points, here chosen to be 0, 1, -1, and ∞. It then has an interpolation matrix of:</p>

<p>

<math display="block" id="Toom–Cook_multiplication:13">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
       <cn type="integer">1</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\begin{matrix}1&0&0&0\\
1&1&1&1\\
1&-1&1&-1\\
0&0&0&1\end{matrix}\right)^{-1}=\left(\begin{matrix}1&0&0&0\\
0&1/2&-1/2&-1\\
-1&1/2&1/2&0\\
0&0&0&1\end{matrix}\right).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li>D. Knuth. <em><a href="The_Art_of_Computer_Programming" title="wikilink">The Art of Computer Programming</a></em>, Volume 2. Third Edition, Addison-Wesley, 1997. Section 4.3.3.A: Digital methods, pg.294.</li>
<li>R. Crandall &amp; C. Pomerance. <em>Prime Numbers – A Computational Perspective</em>. Second Edition, Springer, 2005. Section 9.5.1: Karatsuba and Toom–Cook methods, pg.473.</li>
<li>M. Bodrato. <em><a href="http://bodrato.it/toom-cook/">Toward Optimal Toom–Cook Multiplication...</a></em>. In WAIFI'07, Springer, 2007.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://gmplib.org/manual/Toom-3_002dWay-Multiplication.html">Toom-Cook 3-Way Multiplication from GMP Documentations</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computer_arithmetic_algorithms" title="wikilink">Category:Computer arithmetic algorithms</a> <a class="uri" href="Category:Multiplication" title="wikilink">Category:Multiplication</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Knuth, p. 296<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">Crandall &amp; Pomerance, p. 474<a href="#fnref3">↩</a></li>
<li id="fn4">Crandall &amp; Pomerance, p. 536<a href="#fnref4">↩</a></li>
<li id="fn5">Knuth, p. 302<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="http://cr.yp.to/bib/1966/cook.html">Positive Results</a>, chapter III of Stephen A. Cook: <em>On the Minimum Computation Time of Functions</em>.<a href="#fnref6">↩</a></li>
<li id="fn7">Marco Bodrato. Towards Optimal Toom–Cook Multiplication for Univariate and Multivariate Polynomials in Characteristic 2 and 0. In <em>WAIFI'07 proceedings</em>, volume 4547 of LNCS, pages 116–133. June 21–22, 2007. <a href="http://bodrato.it/papers/#WAIFI2007">author website</a><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
</ol>
</section>
</body>
</html>

   Pfaffian      Pfaffian   In mathematics , the determinant of a skew-symmetric matrix can always be written as the square of a polynomial in the matrix entries. This polynomial is called the Pfaffian of the matrix. The term Pfaffian was introduced by  who named them after Johann Friedrich Pfaff . The Pfaffian is nonvanishing only for 2 n × 2 n skew-symmetric matrices, in which case it is a polynomial of degree n .  Explicitly, for a skew-symmetric matrix A ,      pf    (  A  )   2   =  det   (  A  )   ,     fragments  pf   superscript   fragments  normal-(  A  normal-)   2      fragments  normal-(  A  normal-)   normal-,    \operatorname{pf}(A)^{2}=\det(A),   which was first proved by Thomas Muir in 1882 .  The fact that the determinant of any skew symmetric matrix is the square of a polynomial can be shown by writing the matrix as a block matrix, then using induction and examining the Schur complement , which is skew symmetric as well. 1  Examples      A  =   [     0    a       -  a     0     ]   .  pf   (  A  )   =  a  .     fragments  A     0  a      a   0    normal-.  italic-  pf   fragments  normal-(  A  normal-)    a  normal-.    A=\begin{bmatrix}0&a\\
 -a&0\end{bmatrix}.\qquad\operatorname{pf}(A)=a.         B  =   [     0    a    b       -  a     0    c       -  b      -  c     0     ]   .  pf   (  B  )   =  0.     fragments  B     0  a  b      a   0  c      b     c   0    normal-.  italic-  pf   fragments  normal-(  B  normal-)    0.    B=\begin{bmatrix}0&a&b\\
 -a&0&c\\
 -b&-c&0\end{bmatrix}.\qquad\operatorname{pf}(B)=0.     (3 is odd, so Pfaffian of B is 0)        pf   [     0    a    b    c       -  a     0    d    e       -  b      -  d     0    f       -  c      -  e      -  f     0     ]    =     a  f   -   b  e    +   d  c     .       pf    0  a  b  c      a   0  d  e      b     d   0  f      c     e     f   0           a  f     b  e      d  c      \operatorname{pf}\begin{bmatrix}0&a&b&c\\
 -a&0&d&e\\
 -b&-d&0&f\\
 -c&-e&-f&0\end{bmatrix}=af-be+dc.     The Pfaffian of a 2 n × 2 n skew-symmetric tridiagonal matrix is given as        pf   [     0     a  1     0    0       -   a  1      0     b  1     0      0     -   b  1      0     a  2       0    0     -   a  2      ⋱    ⋱               ⋱        b   ;   n  -  1                      -   b   n  -  1       0     a   ;  n                        -   a  n      0     ]    =    a  1    a  2   ⋯   a  n     .       pf    0   subscript  a  1   0  0       subscript  a  1    0   subscript  b  1   0    0     subscript  b  1    0   subscript  a  2     0  0     subscript  a  2    normal-⋱  normal-⋱    absent  absent  absent  normal-⋱  absent   fragments  b   subscript  normal-;    n  1       absent  absent  absent  absent     subscript  b    n  1     0   fragments  a   subscript  normal-;  n      absent  absent  absent  absent  absent     subscript  a  n    0        subscript  a  1    subscript  a  2   normal-⋯   subscript  a  n      \operatorname{pf}\begin{bmatrix}0&a_{1}&0&0\\
 -a_{1}&0&b_{1}&0\\
 0&-b_{1}&0&a_{2}\\
 0&0&-a_{2}&\ddots&\ddots\\
 &&&\ddots&&b_{n-1}\\
 &&&&-b_{n-1}&0&a_{n}\\
 &&&&&-a_{n}&0\end{bmatrix}=a_{1}a_{2}\cdots a_{n}.   (Note that any skew-symmetric matrix can be reduced to this form with all    b  i     subscript  b  i    b_{i}   equal to zero, see Spectral theory of a skew-symmetric matrix )  Formal definition  Let A = { a i,j } be a 2 n × 2 n skew-symmetric matrix. The Pfaffian of A is defined by the equation       pf   (  A  )    =    1    2  n    n  !       ∑   σ  ∈   S   2  n        sgn   (  σ  )      ∏   i  =  1   n    a    σ   (    2  i   -  1   )    ,   σ   (   2  i   )               pf  A       1     superscript  2  n     n       subscript     σ   subscript  S    2  n         sgn  σ     superscript   subscript  product    i  1    n    subscript  a     σ      2  i   1      σ    2  i            \operatorname{pf}(A)=\frac{1}{2^{n}n!}\sum_{\sigma\in S_{2n}}\operatorname{sgn%
 }(\sigma)\prod_{i=1}^{n}a_{\sigma(2i-1),\sigma(2i)}     where S 2 n is the symmetric group and sgn(σ) is the signature of σ.  One can make use of the skew-symmetry of A to avoid summing over all possible permutations . Let Π be the set of all partitions of {1, 2, …, 2 n } into pairs without regard to order. There are (2 n − 1) !! such partitions. An element α ∈ Π can be written as      α  =   {   (   i  1   ,   j  1   )   ,   (   i  2   ,   j  2   )   ,  ⋯  ,   (   i  n   ,   j  n   )   }       α     subscript  i  1    subscript  j  1      subscript  i  2    subscript  j  2    normal-⋯    subscript  i  n    subscript  j  n       \alpha=\{(i_{1},j_{1}),(i_{2},j_{2}),\cdots,(i_{n},j_{n})\}     with i k  k and     i  1   <   i  2   <  ⋯  <   i  n          subscript  i  1    subscript  i  2        normal-⋯        subscript  i  n      i_{1}   . Let      π  =   [     1    2    3    4    ⋯     2  n        i  1      j  1      i  2      j  2     ⋯     j  n      ]       π    1  2  3  4  normal-⋯    2  n      subscript  i  1    subscript  j  1    subscript  i  2    subscript  j  2   normal-⋯   subscript  j  n       \pi=\begin{bmatrix}1&2&3&4&\cdots&2n\\
 i_{1}&j_{1}&i_{2}&j_{2}&\cdots&j_{n}\end{bmatrix}     be the corresponding permutation. Given a partition α as above, define        A  α   =    sgn   (  π  )      a    i  1   ,   j  1      a    i  2   ,   j  2     ⋯   a    i  n   ,   j  n        .       subscript  A  α     sgn  π      subscript  a    subscript  i  1    subscript  j  1      subscript  a    subscript  i  2    subscript  j  2     normal-⋯   subscript  a    subscript  i  n    subscript  j  n         A_{\alpha}=\operatorname{sgn}(\pi)a_{i_{1},j_{1}}a_{i_{2},j_{2}}\cdots a_{i_{n%
 },j_{n}}.     The Pfaffian of A is then given by        pf   (  A  )    =    ∑   α  ∈  Π     A  α     .       pf  A     subscript     α  normal-Π     subscript  A  α      \operatorname{pf}(A)=\sum_{\alpha\in\Pi}A_{\alpha}.     The Pfaffian of a n × n skew-symmetric matrix for n odd is defined to be zero, as the determinant of an odd skew-symmetric matrix is zero, since for a skew-symmetric matrix,     det  A   =   det   A  T    =   det   (   -  A   )    =     (   -  1   )   n    det  A            A      superscript  A  T             A            superscript    1   n     A       \det\,A=\det\,A^{\text{T}}=\det\left(-A\right)=(-1)^{n}\det\,A   , and for n odd, this implies     det  A   =  0        A   0    \det\,A=0   .  Recursive definition  By convention, the Pfaffian of the 0×0 matrix is equal to one. The Pfaffian of a skew-symmetric 2 n ×2 n matrix A with n >0 can be computed recursively as        pf   (  A  )    =    ∑       j  =  1        j  ≠  i        2  n       (   -  1   )    i  +  j  +  1  +   θ   (   i  -  j   )       a   i  j     pf   (   A    i  ^    j  ^     )       ,       pf  A     superscript   subscript    STACKED    j  1     j  i       2  n       superscript    1     i  j  1    θ    i  j       subscript  a    i  j     pf   subscript  A     normal-^  i    normal-^  j          \operatorname{pf}(A)=\sum_{{j=1}\atop{j\neq i}}^{2n}(-1)^{i+j+1+\theta(i-j)}a_%
 {ij}\operatorname{pf}(A_{\hat{i}\hat{j}}),     where index i can be selected arbitrarily,    θ   (   i  -  j   )       θ    i  j     \theta(i-j)   is the Heaviside step function , and    A    i  ^    j  ^       subscript  A     normal-^  i    normal-^  j      A_{\hat{i}\hat{j}}   denotes the matrix A with both the i -th and j -th rows and columns removed. 2 Note how for the special choice    i  =  1      i  1    i=1   this reduces to the simpler expression:        pf   (  A  )    =    ∑   j  =  2    2  n       (   -  1   )   j    a   1  j     pf   (   A    1  ^    j  ^     )       .       pf  A     superscript   subscript     j  2      2  n       superscript    1   j    subscript  a    1  j     pf   subscript  A     normal-^  1    normal-^  j          \operatorname{pf}(A)=\sum_{j=2}^{2n}(-1)^{j}a_{1j}\operatorname{pf}(A_{\hat{1}%
 \hat{j}}).     Alternative definitions   One can associate to any skew-symmetric 2 n ×2 n matrix A ={ a ij } a bivector         pf   (   A  T   )    =     (   -  1   )   n    pf   (  A  )      .       pf   superscript  A  T       superscript    1   n    pf  A      \operatorname{pf}(A^{\text{T}})=(-1)^{n}\operatorname{pf}(A).   here ω n denotes the wedge product of n copies of ω.  Identities  For a 2 n × 2 n skew-symmetric matrix A        pf   (   λ  A   )    =    λ  n    pf   (  A  )      .       pf    λ  A       superscript  λ  n    pf  A      \operatorname{pf}(\lambda A)=\lambda^{n}\operatorname{pf}(A).         pf    (  A  )   2   =  det   (  A  )   .     fragments  pf   superscript   fragments  normal-(  A  normal-)   2      fragments  normal-(  A  normal-)   normal-.    \operatorname{pf}(A)^{2}=\det(A).           pf   (   B  A   B  T    )    =   det    (  B  )    pf   (  A  )       .       pf    B  A   superscript  B  T         B   pf  A       \operatorname{pf}(BAB^{\text{T}})=\det(B)\operatorname{pf}(A).   For an arbitrary 2 n × 2 n matrix B ,      pf   (   A    2  m   +  1    )   =    (  -  1  )    n  m    pf    (  A  )     2  m   +  1    .     fragments  pf   fragments  normal-(   superscript  A      2  m   1    normal-)     superscript   fragments  normal-(   1  normal-)     n  m    pf   superscript   fragments  normal-(  A  normal-)       2  m   1    normal-.    \operatorname{pf}(A^{2m+1})=(-1)^{nm}\operatorname{pf}(A)^{2m+1}.   Substituting in this equation B = A m , one gets for all integer m         A  1   ⊕   A  2    =   [      A  1     0      0     A  2      ]    ,       direct-sum   subscript  A  1    subscript  A  2       subscript  A  1   0    0   subscript  A  2       A_{1}\oplus A_{2}=\begin{bmatrix}A_{1}&0\\
 0&A_{2}\end{bmatrix},   For a block-diagonal matrix          pf   (    A  1   ⊕   A  2    )    =    pf   (   A  1   )     pf   (   A  2   )      .       pf   direct-sum   subscript  A  1    subscript  A  2        pf   subscript  A  1     pf   subscript  A  2       \operatorname{pf}(A_{1}\oplus A_{2})=\operatorname{pf}(A_{1})\operatorname{pf}%
 (A_{2}).             pf   [     0    M       -   M  T      0     ]    =     (   -  1   )     n   (   n  -  1   )    /  2     det  M     .       pf    0  M       superscript  M  T    0        superscript    1       n    n  1    2      M      \operatorname{pf}\begin{bmatrix}0&M\\
 -M^{\text{T}}&0\end{bmatrix}=(-1)^{n(n-1)/2}\det M.      For an arbitrary n × n matrix M :         1   pf   (  A  )       ∂   pf   (  A  )      ∂   x  i      =    1  2    tr   (    A   -  1      ∂  A    ∂   x  i      )      ,          1   pf  A         pf  A       subscript  x  i          1  2    tr     superscript  A    1        A      subscript  x  i          \frac{1}{\operatorname{pf}(A)}\frac{\partial\operatorname{pf}(A)}{\partial x_{%
 i}}=\frac{1}{2}\operatorname{tr}\left(A^{-1}\frac{\partial A}{\partial x_{i}}%
 \right),   If A depends on some variable x i , then the gradient of a Pfaffian is given by         1   pf   (  A  )        ∂  2    pf   (  A  )       ∂   x  i     ∂   x  j       =      1  2    tr   (    A   -  1       ∂  2   A     ∂   x  i     ∂   x  j       )     -    1  2    tr   (    A   -  1      ∂  A    ∂   x  i      A   -  1      ∂  A    ∂   x  j      )      +    1  4    tr   (    A   -  1      ∂  A    ∂   x  i      )     tr   (    A   -  1      ∂  A    ∂   x  j      )       .          1   pf  A        superscript   2    pf  A         subscript  x  i       subscript  x  j               1  2    tr     superscript  A    1        superscript   2   A        subscript  x  i       subscript  x  j             1  2    tr     superscript  A    1        A      subscript  x  i      superscript  A    1        A      subscript  x  j             1  4    tr     superscript  A    1        A      subscript  x  i        tr     superscript  A    1        A      subscript  x  j           \frac{1}{\operatorname{pf}(A)}\frac{\partial^{2}\operatorname{pf}(A)}{\partial
 x%
 _{i}\partial x_{j}}=\frac{1}{2}\operatorname{tr}\left(A^{-1}\frac{\partial^{2}%
 A}{\partial x_{i}\partial x_{j}}\right)-\frac{1}{2}\operatorname{tr}\left(A^{-%
 1}\frac{\partial A}{\partial x_{i}}A^{-1}\frac{\partial A}{\partial x_{j}}%
 \right)+\frac{1}{4}\operatorname{tr}\left(A^{-1}\frac{\partial A}{\partial x_{%
 i}}\right)\operatorname{tr}\left(A^{-1}\frac{\partial A}{\partial x_{j}}\right).   and the Hessian of a Pfaffian is given by       pf   (   B  A   B  T    )    =   det    (  B  )    pf   (  A  )           pf    B  A   superscript  B  T         B   pf  A       \operatorname{pf}(BAB^{\text{T}})=\det(B)\operatorname{pf}(A)     Properties  Pfaffians have the following properties, which are similar to those of determinants.   Multiplication of a row and a column by a constant is equivalent to multiplication of Pfaffian by the same constant.  Simultaneous interchange of two different rows and corresponding columns changes the sign of Pfaffian.  A multiple of a row and corresponding column added to another row and corresponding column does not change the value of Pfaffian.   These properties can be derived from the identity $\operatorname{pf}(BAB^\text{T})=\det(B)\operatorname{pf}(A)$ .  Applications   There exist programs for the numerical computation of the Pfaffian on various platforms (Python, Matlab, Mathematica) .    The Pfaffian is an invariant polynomial of a skew-symmetric matrix under a proper orthogonal change of basis. As such, it is important in the theory of characteristic classes . In particular, it can be used to define the Euler class of a Riemannian manifold which is used in the generalized Gauss–Bonnet theorem .    The number of perfect matchings in a planar graph is given by a Pfaffian, hence is polynomial time computable via the FKT algorithm . This is surprising given that for general graphs, the problem is very difficult (so called #P-complete ). This result is used to calculate the number of domino tilings of a rectangle, the partition function of Ising models in physics, or of Markov random fields in machine learning (; ), where the underlying graph is planar. It is also used to derive efficient algorithms for some otherwise seemingly intractable problems, including the efficient simulation of certain types of restricted quantum computation . Read Holographic algorithm for more information.   See also   Determinant  Dimer model  Polyomino  Statistical mechanics   Notes  References    Reprinted in Collected mathematical papers, volume 2.     .   .      [ http://books.google.com/books?id=pk4DAAAAQAAJ&dq; ;=thomas+muir+treatise+on+the+theory+of+determinant&psp;=1 Online ]     External links    Pfaffian at PlanetMath.org  T. Jones, The Pfaffian and the Wedge Product (a demonstration of the proof of the Pfaffian/determinant relationship)  R. Kenyon and A. Okounkov , What is ... a dimer?   W. Ledermann "A note on skew-symmetric determinants" http://www.researchgate.net/publication/231827602_A_note_on_skew-symmetric_determinants   "  Category:Determinants  Category:Multilinear algebra     Ledermann, W. "A note on skew-symmetric determinants" ↩  http://jesusmtz.public.iastate.edu/soliton/REPORT%202.pdf ↩     
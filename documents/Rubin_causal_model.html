<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="512">Rubin causal model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Rubin causal model</h1>
<hr>The '''Rubin causal model (RCM)''', also known as the '''Neyman–Rubin causal model''',<ref name="sekhon">{{cite book |last=Sekhon |first=Jasjeet |chapter=The Neyman-Rubin Model of Causal Inference and Estimation via Matching Methods |title=The Oxford Handbook of Political Methodology |year=2007 |chapterurl=http://sekhon.berkeley.edu/papers/SekhonOxfordHandbook.pdf }}</ref> is an approach to the [[statistical analysis]] of [[Causality|cause and effect]] based on the [[Conceptual framework|framework]] of [[counterfactual conditional|potential outcomes]], named after [[Donald Rubin]]. The name "Rubin causal model" was first coined by Rubin's graduate school colleague, [[Paul W. Holland]].<ref name="holland:causal86">{{cite journal |last=Holland |first=Paul W. |title=Statistics and Causal Inference |journal=[[Journal of the American Statistical Association|J. Amer. Statist. Assoc.]] |volume=81 |issue=396 |year=1986 |pages=945–960 |jst
<p>or=2289064 |doi=10.1080/01621459.1986.10478354}} The potential outcomes framework was first proposed by <a href="Jerzy_Neyman" title="wikilink">Jerzy Neyman</a> in his 1923 Master's thesis,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> though he discussed it only in the context of completely randomized experiments.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Rubin, together with other contemporary statisticians, extended it into a powerful general framework for thinking about causation in both observational and experimental studies.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="introduction">Introduction</h2>

<p>The Neyman potential outcomes framework is based in the idea of potential outcomes and the assignment mechanism: every unit has different potential outcomes depending on their "assignment" to a condition.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Potential outcomes are expressed in the form of <a href="counterfactual_conditional" title="wikilink">counterfactual conditional</a> statements, which state what would be the case conditional on a prior event occurring. For instance, a person would have a particular income at age 40 if they had attended a private college, whereas they would have a different income at age 40 had they attended a public college. To measure the causal effect of going to a public versus a private college, the investigator should look at the outcome for the same individual in both alternative futures. Since it is impossible to see both potential outcomes at once, one of the potential outcomes is always missing. This observation is described as the "fundamental problem of causal inference". A randomized experiment works by assigning people randomly to treatments (in this case, public or private college). Because the assignment was random, the groups are (on average) equivalent, and the difference in income at age 40 can be attributed to the college assignment since that was the only difference between the groups. The assignment mechanism is the explanation for why some units received the treatment and others the control.</p>

<p>Rubin, together with a number of other contributors such as Cochran, developed this approach into a powerful formal framework for assessing causation in observational data.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In such data, there is a non-random assignment mechanism: in the case of college attendance, people may choose to attend a private versus a public college based on their financial situation, parents' education, relative ranks of the schools they were admitted to, etc. If all of these factors can be balanced between the two groups of public and private college students, then the effect of the college attendance can be attributed to the college choice.</p>

<p>Many statistical methods have been developed for causal inference, such as <a href="propensity_score_matching" title="wikilink">propensity score matching</a> and <a href="nearest-neighbor_matching" title="wikilink">nearest-neighbor matching</a> (which often uses the <a href="Mahalanobis_metric" title="wikilink">Mahalanobis metric</a>, also called Mahalanobis matching). These methods attempt to correct for the assignment mechanism by finding control units similar to treatment units. In the example, matching finds graduates of a public college most similar to graduates of a private college, so that like is compared only with like.</p>

<p>Causal inference methods make few assumptions other than that one unit's outcomes are unaffected by another unit's treatment assignment, the <a href="stable_unit_treatment_value_assumption" title="wikilink">stable unit treatment value assumption</a> (SUTVA).</p>
<h2 id="an-extended-example">An extended example</h2>

<p>Rubin defines a causal effect:</p>
<blockquote>

<p>Intuitively, the causal effect of one treatment, E, over another, C, for a particular unit and an interval of time from 

<math display="inline" id="Rubin_causal_model:0">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{1}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Rubin_causal_model:1">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{2}
  </annotation>
 </semantics>
</math>

 is the difference between what would have happened at time 

<math display="inline" id="Rubin_causal_model:2">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{2}
  </annotation>
 </semantics>
</math>

 if the unit had been exposed to E initiated at 

<math display="inline" id="Rubin_causal_model:3">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{1}
  </annotation>
 </semantics>
</math>


 and what would have happened at 

<math display="inline" id="Rubin_causal_model:4">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{2}
  </annotation>
 </semantics>
</math>

 if the unit had been exposed to C initiated at 

<math display="inline" id="Rubin_causal_model:5">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{1}
  </annotation>
 </semantics>
</math>

: 'If an hour ago I had taken two aspirins instead of just a glass of water, my headache would now be gone,' or because an hour ago I took two aspirins instead of just a glass of water, my headache is now gone.' Our definition of the causal effect of the E versus C treatment will reflect this intuitive meaning.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
</blockquote>

<p>According to the RCM, the causal effect of your taking or not taking aspirin one hour ago is the difference between how your head would have felt in case 1 (taking the aspirin) and case 2 (not taking the aspirin). If your headache would remain without aspirin but disappear if you took aspirin, then the causal effect of taking aspirin is headache relief.</p>

<p>Suppose that Joe is participating in an FDA test for a new hypertension drug. If we were omniscient, we would know the outcomes for Joe under both the treatments and therefore know the treatment effect.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:6">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:7">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>


</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-10</p></td>
</tr>
</tbody>
</table>

<p>

<math display="inline" id="Rubin_causal_model:9">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

 is the change in Joe's <a href="blood_pressure" title="wikilink">blood pressure</a> if he takes the pill. In general, this notation expresses the effect of a treatment, <em>t</em>, on a unit, <em>u</em>. Similarly, 

<math display="inline" id="Rubin_causal_model:10">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

 is the effect of a different treatment, <em>c</em> or control, on a unit, <em>u</em>. In this case, 

<math display="inline" id="Rubin_causal_model:11">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

 is the change in Joe's blood pressure if he doesn't take the pill. 

<math display="inline" id="Rubin_causal_model:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

 is the causal effect of taking the drug.</p>

<p>From this table we only know the causal effect on Joe. Everyone else in the study might have an increase in blood pressure. However, regardless of what the causal effect is for the other subjects, the causal effect for Joe is a decrease in blood pressure.</p>

<p>Consider a larger sample of patients:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:13">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:14">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-10</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-10</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>-15</p></td>
</tr>
</tbody>
</table>

<p>The causal effect is different for every subject, but the drug <em>works</em> for everyone because everyone's blood pressure decreases.</p>
<h3 id="stable-unit-treatment-value-assumption-sutva">Stable unit treatment value assumption (SUTVA)</h3>

<p>We require that "the [potential outcome] observation on one unit should be unaffected by the particular assignment of treatments to the other units" (Cox 1958, §2.4). This is called the Stable Unit Treatment Value Assumption (SUTVA), which goes beyond the concept of independence.</p>

<p>In the context of our example, Joe's change in blood pressure may not depend on whether or not Mary receives the drug. Suppose that Joe and Mary live in the same house. Mary always cooks. If Mary does not take the drug she will not cook salty foods, but if she does take the drug she will cook salty foods. A high salt diet increases Joe's blood pressure. Therefore, his response will depend on which treatment Mary receives. [Note that if it's a blinded trial, Mary doesn't know if she gets the active or placebo drug, so another example is probably better.]</p>

<p>SUTVA violation makes causal inference more difficult. We can account for dependent observations by considering more treatments. We create 4 treatments by taking into account whether or not Mary receives treatment.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>Joe = c, Mary = t</p></th>
<th style="text-align: left;">
<p>Joe = t, Mary = t</p></th>
<th style="text-align: left;">
<p>Joe = c, Mary = c</p></th>
<th style="text-align: left;">
<p>Joe = t, Mary = c</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>

<p>Now there are multiple causal effects. One is the causal effect of the drug on Joe when Mary receives treatment and is calculated, 

<math display="inline" id="Rubin_causal_model:16">
 <semantics>
  <mrow>
   <mn>10</mn>
   <mo>-</mo>
   <mn>20</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">10</cn>
    <cn type="integer">20</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   10-20
  </annotation>
 </semantics>
</math>

. Another is the causal effect on Joe when Mary does not receive treatment and is calculated 

<math display="inline" id="Rubin_causal_model:17">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>-</mo>
   <mn>5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">0</cn>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0-5
  </annotation>
 </semantics>
</math>

. The third is the causal effect of Mary on Joe, and is calculated 

<math display="inline" id="Rubin_causal_model:18">
 <semantics>
  <mrow>
   <mn>20</mn>
   <mo>-</mo>
   <mn>5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">20</cn>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   20-5
  </annotation>
 </semantics>
</math>


. The treatment Mary receives has a greater causal effect for Joe than the assignment of treatment to Joe.</p>

<p>With additional treatments, SUTVA holds. However, if any units other than Joe are dependent on Mary, then we must consider further treatments. The greater the number of dependent units, the more treatments we must consider and the more complex the calculations become (consider an experiment with 20 different causal effects). In order to determine the causal effect using only two treatments, the observations must be independent.</p>

<p>Consider an example where not all subjects benefit from the drug.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:19">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:20">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:21">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>15</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>- 5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-25</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-20</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>-8</p></td>
</tr>
</tbody>
</table>

<p>One may calculate the average causal effect by taking the mean of all the causal effects or by subtracting the mean change under control from the mean change under treatment. Although the average causal effect is a decrease in blood pressure, the causal effect for Joe is an increase in blood pressure. Joe would never want to take the drug.</p>

<p>How we measure the response affects what inferences we draw. Suppose that we measure changes in blood pressure as a percentage change:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:22">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:23">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:24">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>12</p></td>
<td style="text-align: left;">
<p>-6</p></td>
<td style="text-align: left;">
<p>18</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>-1</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-8</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>-10</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>-1</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>-2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-1</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-1</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>0.4%</p></td>
<td style="text-align: left;">
<p>-0.4%</p></td>
<td style="text-align: left;">
<p>0.8%</p></td>
</tr>
</tbody>
</table>

<p>This measurement suggests the opposite conclusion, that the average causal effect is an increase in blood pressure. One obtains this result because the positive change in blood pressure for Joe is a larger percentage of his blood pressure. This would occur if Joe's blood pressure is lower than the blood pressure of the other subjects. For example, Joe's blood pressure is 140 and increase by 14 mm Hg, an increase of 10%. If Mary's blood pressure is 200 mm Hg and her blood pressure increases by 14 mm Hg, then her blood pressure only increases by 7%. Consequently, a small absolute change in blood pressure would yield a larger percentage change for Joe.</p>
<h3 id="the-fundamental-problem-of-causal-inference">The fundamental problem of causal inference</h3>

<p>The results we have seen up to this point would never be observed in practice. It is impossible to observe the effect of more than one treatment on a subject at one time. Joe cannot both take the pill and not take the pill at the same time. Therefore, the data would look something like this:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:25">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:26">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:27">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
</tbody>
</table>

<p>Question marks are responses that could not be observed. Some scholars call the impossibility of observing responses to multiple treatments on the same subject over a given period of time the <em>Fundamental Problem of Causal Inference</em> (FPCI).<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> The FPCI makes <em>observing causal effects</em> impossible. However, this does not make <em>causal inference</em> impossible. Certain techniques and assumptions allow the FPCI to be overcome.</p>

<p>Suppose that we want to determine the causal effect of the drug on Joe. The FPCI makes it impossible to <em>observe</em> the causal effect so we must determine the <em>average</em> causal effect instead. To do this, we could instruct Joe to repeat the experiment each month for 6 consecutive months. At the beginning of each month, we would flip a coin to determine which treatment he receives. The results of this experiment follow:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>date</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:28">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:29">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:30">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>January</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>February</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>March</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>April</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>May</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>June</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-15</p></td>
</tr>
</tbody>
</table>

<p>Suppose that Joe could only choose to take the drug for all 6 months or not take the drug at all. During one of the months Joe's blood pressure increases when he takes the drug. However, it could have been even higher if he had not taken the drug. Joe would, on average, benefit from the drug because the average causal effect is a decrease in blood pressure. Even if he knew that he would be better off not taking the drug in February, it would most likely be in his overall interest to choose the drug for the entire duration of the study.</p>

<p>In order for us to conclude that the average causal effect of the pill is a decrease in Joe's blood pressure, we must make certain assumptions. Joe's responses must be independent of each other. Joe's response during any month must not be affected by the treatments he receives during any other month. His taking the drug in January should not affect his response to the control in February. If this assumption does not hold, perhaps because the drug remains in the blood stream, we would have to consider multiple treatments. By making each treatment a combination of the treatment Joe received the previous month and the treatment he would receive the following month, we would create 4 treatments:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>Joe = 0, last month = 1</p></th>
<th style="text-align: left;">
<p>Joe = 1, last month = 1</p></th>
<th style="text-align: left;">
<p>Joe = 0, last month = 0</p></th>
<th style="text-align: left;">
<p>Joe = 1, last month = 0</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>0</p></td>
</tr>
</tbody>
</table>

<p>Using these different treatments would restore independence. However, as responses become dependent on more than one treatment assignment, the number of treatments becomes exponentially greater, and determining average causal effect becomes more complex. In this example, we would have to determine three different causal effects. The first is the causal effect of the drug on Joe when Joe takes the drug the month before. The second is the causal effect of the drug on Joe when Joe does not take the drug the month before. The third is the causal effect of taking the drug on Joe when he does not take the drug this month, but took it the month before.</p>

<p>We can infer what Joe's response to the unobserved treatment would be if we make an assumption of constant effect. This means that the causal effect is the same at different times, no different in March than it is in April. If the causal effect is always the same, then the average causal effect equals the causal effect. Therefore, knowing the average causal effect and observing one response, we can calculate the other response.</p>

<p>

<math display="block" id="Rubin_causal_model:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>T</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>Y</mi>
      <mi>c</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>T</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>c</ci>
      </apply>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)=T+Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Rubin_causal_model:32">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>Y</mi>
       <mi>t</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>Y</mi>
      <mi>c</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>t</ci>
      </apply>
      <ci>u</ci>
     </apply>
     <ci>T</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-T=Y_{c}(u).
  </annotation>
 </semantics>
</math>

</p>

<p>Since the average causal effect for Joe is a reduction in blood pressure, an assumption of constant effect suggests that the drug would always reduce his blood pressure.</p>
<h3 id="multiple-subjects">Multiple subjects</h3>

<p>Another way to determine average causal effect is to use multiple subjects:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:33">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:34">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:35">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Susie</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-10</p></td>
</tr>
</tbody>
</table>

<p>Mary's and Susie's blood pressures increase when they take the drug. We do not know the causal effect of the drug on Susie or Mary because we do not know their responses under control.</p>

<p>If we wanted to infer the unobserved values we could make an assumption of either constant effect or homogeneity, an even stronger assumption than constant effect. If the subjects are all the same or homogeneous, then they would all have the same response to the treatment and the same response to the control. Mathematically, 

<math display="inline" id="Rubin_causal_model:36">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mrow>
      <mi>t</mi>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mrow>
      <mi>t</mi>
      <mn>2</mn>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t1}(u)=Y_{t2}(u)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Rubin_causal_model:37">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mrow>
      <mi>c</mi>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mrow>
      <mi>c</mi>
      <mn>2</mn>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c1}(u)=Y_{c2}(u)
  </annotation>
 </semantics>
</math>

, where 1 and 2 are units being tested for homogeneity. As causal effect equals 

<math display="inline" id="Rubin_causal_model:38">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>


, the causal effect would be the same for all of them. The following tables illustrate data that supports assumptions of constant effect, homogeneity, or both:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:39">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:40">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:41">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>20</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
</tbody>
</table>

<p>All of the subjects have the same causal effect even though they have different responses to the treatments. This data supports the assumption of constant effect, but does not support the assumption of homogeneity.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:42">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:43">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:44">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
</tbody>
</table>

<p>These subjects have the same responses to the treatment and consequently, the same causal effect. This makes them homogeneous. This data supports the assumptions of both constant effect and homogeneity.</p>

<p>If the assumption of homogeneity holds, then the average causal effect equals the causal effect for every unit. Knowing the average causal effect and having observed the response to one treatment for each unit, one can determine the response to the other treatment. One cannot apply this assumption to the data in this example because the responses are different for every subject.</p>
<h3 id="the-assignment-mechanism">The assignment mechanism</h3>

<p>The assignment mechanism, the method by which units are assigned treatment, affects the calculation of the average causal effect. One such assignment mechanism is randomization. For each subject we could flip a coin to determine if she receives treatment. If we wanted five subjects to receive treatment, we could assign treatment to the first five names we pick out of a hat. When we randomly assign treatments we may get different answers.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:45">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:46">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:47">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>15</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-25</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-20</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>-8</p></td>
</tr>
</tbody>
</table>

<p>This is the true average causal effect. Assigning treatments randomly, we calculate another causal effect.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:48">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:49">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:50">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>1.66</p></td>
<td style="text-align: left;">
<p>7.5</p></td>
<td style="text-align: left;">
<p>-5.83</p></td>
</tr>
</tbody>
</table>

<p>Under the same mechanism another random assignment of treatments yields yet another average causal effect.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:51">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:52">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:53">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>


</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-3.33</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-8.33</p></td>
</tr>
</tbody>
</table>

<p>The average causal effect varies because our sample is small and the responses have a large <a class="uri" href="variance" title="wikilink">variance</a>. If the sample were larger and the variance were less, the average causal effect would be closer to the true average causal effect.</p>

<p>Alternatively, suppose the mechanism assigns the treatment to all men and only to them.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:54">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:55">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:56">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-15</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Susie</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-15</p></td>
</tr>
</tbody>
</table>

<p>Under this assignment mechanism, it is impossible for women to receive treatment and therefore impossible to determine the average causal effect on female subjects. In order to make any inferences of causal effect on a subject, the probability that the subject receive treatment must be greater than 0 and less than 1.</p>
<h3 id="the-perfect-doctor">The perfect doctor</h3>

<p>Consider the use of the <em>perfect doctor</em> as an assignment mechanism. The perfect doctor knows how each subject will respond to the drug or the control and assigns each subject to the treatment that will most benefit her. The perfect doctor knows this information about a sample of patients:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:57">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:58">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:59">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>15</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-50</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>-55</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-20</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>15</p></td>
<td style="text-align: left;">
<p>-35</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Susie</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>30</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>1.7</p></td>
<td style="text-align: left;">
<p>-11.7</p></td>
</tr>
</tbody>
</table>

<p>Based on this knowledge she would make the following treatment assignments:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:60">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:61">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:62">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>-50</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Susie</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;">
<p>-18</p></td>
<td style="text-align: left;">
<p>-12.5</p></td>
<td style="text-align: left;">
<p>-5.5</p></td>
</tr>
</tbody>
</table>

<p>The perfect doctor distorts both averages by filtering out poor responses to both the treatment and control. The difference between means, which is the supposed average causal effect, is distorted in a direction that depends on details. For instance, a subject like Susie who is harmed by taking the drug would be assigned to the control group by the perfect doctor and thus the negative effect of the drug would be masked.</p>
<h2 id="matching">Matching</h2>

<p>Another approach to estimation of causal effect is matching or pairing similar units, as an approximation to observing the same unit twice. If an experiment is possible, match units with identical or most similar attributes; randomly assign treatment to one and control to the other unit in each pair.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>subject</p></th>
<th style="text-align: left;">
<p>sex</p></th>
<th style="text-align: left;">
<p>blood pressure</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:63">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)
  </annotation>
 </semantics>
</math>


</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:64">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mi>c</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>c</ci>
    </apply>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>

<math display="inline" id="Rubin_causal_model:65">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mrow>
    <msub>
     <mi>Y</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>t</ci>
     </apply>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Y</ci>
      <ci>c</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{t}(u)-Y_{c}(u)
  </annotation>
 </semantics>
</math>

</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Joe</p></td>
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>180</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>-15</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Bob</p></td>
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>180</p></td>
<td style="text-align: left;">
<p>-20</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>James</p></td>
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>160</p></td>
<td style="text-align: left;">
<p>-10</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Paul</p></td>
<td style="text-align: left;">
<p>male</p></td>
<td style="text-align: left;">
<p>160</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Mary</p></td>
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>180</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Sally</p></td>
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>180</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Susie</p></td>
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>160</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Jen</p></td>
<td style="text-align: left;">
<p>female</p></td>
<td style="text-align: left;">
<p>160</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>?</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>MEAN</p></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>170</p></td>
<td style="text-align: left;">
<p>-5</p></td>
<td style="text-align: left;">
<p>0</p></td>
<td style="text-align: left;">
<p>-5</p></td>
</tr>
</tbody>
</table>

<p>If matched units are homogeneous, then they have the same causal effect. This means that they have the same average causal effect. Therefore, if all units are perfectly matched, the average causal effect equals the causal effect.</p>

<p><a href="Propensity_score_matching" title="wikilink">Propensity score matching</a> is often used when there are multiple attributes.</p>
<h2 id="conclusion">Conclusion</h2>

<p>The causal effect of a treatment on a single unit at a point in time is the difference between the outcome variable with the treatment and without the treatment. The Fundamental Problem of Causal Inference is that it is impossible to observe the causal effect on a single unit. You either take the aspirin now or you don't. As a consequence, assumptions must be made in order to estimate the missing counterfactuals.</p>
<h2 id="relations-to-other-approaches">Relations to other approaches</h2>

<p>In the view of <a href="Judea_Pearl" title="wikilink">Pearl</a> (2000),<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> the Rubin Causal Model (RCM) is subsumed by the <a href="Structural_Equation_Modeling" title="wikilink">Structural Equation Model (SEM)</a> used in econometrics and the social sciences, in its extended nonparametric form. That view, which has long been argued by <a href="James_Heckman" title="wikilink">Heckman</a> (2005)<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> is presented formally in Pearl (2000).<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> The key connection between the RCM and SEM rests on interpreting the "potential outcome" variable <em>Y<sub>x</sub>(u)</em> to be the solution for variable <em>Y</em> in a modified structural model, in which the external intervention <em>X=x</em> is emulated by replacing the equation that determines <em>X</em> by the constant equation <em>X=x</em>.</p>

<p>The variable <em>u</em>, which in the RCM stands for the identity of each experimental unit (e.g., a patient or an agricultural lot,) is represented in the SEM formulation by a vector of exogeneous variables (usually unobserved) that characterize that unit. With this interpretation, every theorem in RCM can be shown to be a theorem in SEM and vice versa.</p>

<p>This interpretation has led to a complete axiomatization of RCM and, based on the derivations of Shpitser-Pearl (2006),<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> a complete solution to the identification of causal effects, using graphs. Complete solution means that, for any subset <em>X</em> of variables and a set <em>A</em> of causal assumptions encoded in a graph <em>G</em>, it is possible to determine algorithmically whether the causal effect <em>P(Y<sub>x</sub> = y)</em> can be estimated consistently from non-experimental data and, if so, what form the estimand of <em>P(Y<sub>x</sub> = y)</em> should have.</p>

<p>Using that estimand, it is possible then to estimate, from observational study, the average causal effect over the population:</p>

<p>

<math display="block" id="Rubin_causal_model:66">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mi>u</mi>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>Y</mi>
       <mi>t</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>Y</mi>
       <mi>c</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>u</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <ci>t</ci>
       </apply>
       <ci>u</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <ci>c</ci>
       </apply>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{u}[Y_{t}(u)-Y_{c}(u)]
  </annotation>
 </semantics>
</math>

.</p>

<p>From the perspective of Pearl and his colleagues, a major shortcoming of RCM is that all assumptions and background knowledge pertaining to a given problem must first be translated into the language of counterfactuals (e.g., ignorability) before analysis can commence. In SEM, by comparison, Pearl (2000)<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> and Heckman (2008)<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> hold that background knowledge is expressed directly in the vocabulary of ordinary scientific discourse, invoking cause-effect relationships among realizable, not hypothetical variables.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>The Rubin causal model has also been connected to <a href="instrumental_variable" title="wikilink">instrumental variables</a> (Angrist, Imbens, and Rubin, 1996)<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> and other techniques for causal inference. For more on the connections between the Rubin causal model, structural equation modeling, and other statistical methods for causal inference, see Morgan and Winship (2007)<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> and Pearl (2009).<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Principal_stratification" title="wikilink">Principal stratification</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="Donald_Rubin" title="wikilink">Donald Rubin</a> (1977) "Assignment to Treatment Group on the Basis of a Covariate", <em><a href="Journal_of_Educational_Statistics" title="wikilink">Journal of Educational Statistics</a></em>, 2, pp. 1–26.</li>
<li>Rubin, Donald (1978) "Bayesian Inference for Causal Effects: The Role of Randomization", <em><a href="The_Annals_of_Statistics" title="wikilink">The Annals of Statistics</a></em>, 6, pp. 34–58.</li>
<li>Rubin, Donald (1974) "Estimating Causal Effects of Treatments in Randomized and Nonrandomized Studies", <em><a href="Journal_of_Educational_Psychology" title="wikilink">Journal of Educational Psychology</a></em>, 66 (5), pp. 688–701.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.dictionaryofeconomics.com/article?id=pde2008_R000247">"Rubin Causal Model"</a>: an article for the New Palgrave Dictionary of Economics by <a href="Guido_Imbens" title="wikilink">Guido Imbens</a> and <a href="Donald_Rubin" title="wikilink">Donald Rubin</a>.</li>
<li><a href="http://www.wjh.harvard.edu/~cwinship/cfa.html">"Counterfactual Causal Analysis"</a>: a webpage maintained by <a href="Stephen_Morgan" title="wikilink">Stephen Morgan</a>, Christopher Winship, and others with links to many research articles on causal inference.</li>
</ul>

<p>"</p>

<p><a href="Category:Causal_inference" title="wikilink">Category:Causal inference</a> <a href="Category:Statistical_models" title="wikilink">Category:Statistical models</a> <a class="uri" href="Category:Econometrics" title="wikilink">Category:Econometrics</a> <a href="Category:Observational_study" title="wikilink">Category:Observational study</a> <a class="uri" href="Category:Experiments" title="wikilink">Category:Experiments</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Neyman, Jerzy. <em>Sur les applications de la theorie des probabilites aux experiences agricoles: Essai des principes.</em> Master's Thesis (1923). Excerpts reprinted in English, Statistical Science, Vol. 5, pp. 463-472. (D. M. Dabrowska, and T. P. Speed, Translators.)<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8">Pearl, J. <em>Causality: Models, Reasoning, and Inference</em>, <a href="Cambridge_University_Press" title="wikilink">Cambridge University Press</a> (2000).<a href="#fnref8">↩</a></li>
<li id="fn9">Heckman, J.J., The scientific model of causality, <em><a href="Sociological_methodology" title="wikilink">Sociological methodology</a></em>, Vol. 35, 1-97, 2005. <a class="uri" href="http://www.jstor.org/stable/4148843">http://www.jstor.org/stable/4148843</a><a href="#fnref9">↩</a></li>
<li id="fn10"></li>
<li id="fn11">Shpitser, I. and Pearl, J., Identification of Conditional Interventional Distributions. In R. Dechter and T.S. Richardson (Eds.), <em>Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence</em>, Corvallis, OR: AUAI Press, 437-444, 2006.<a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13">Heckman, J.J. Econometric Causality. <em><a href="International_Statistical_Review" title="wikilink">International Statistical Review</a>,</em> Vol. 76, 1--27, 2008.<a href="#fnref13">↩</a></li>
<li id="fn14">Pearl, J. <a href="http://ftp.cs.ucla.edu/pub/stat_ser/r350.pdf">Causal inference in statistics: An overview</a>. UCLA Computer Science Department, Technical Report R-350. To appear in <em>Statistics Surveys,</em> 2009.<a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"></li>
</ol>
</section>
</ref></hr></body>
</html>

   Sprague–Grundy theorem      Sprague–Grundy theorem   In combinatorial game theory , the Sprague–Grundy theorem states that every impartial game under the normal play convention is equivalent to a nimber . The Grundy value or nim-value of an impartial game is then defined as the unique nimber that the game is equivalent to. In the case of a game whose positions (or summands of positions) are indexed by the natural numbers (for example the possible heap sizes in nim-like games), the sequence of nimbers for successive heap sizes is called the nim-sequence of the game.  The theorem and its proof encapsulate the main results of a theory discovered independently by R. P. Sprague (1935) and P. M. Grundy (1939). [1 ]  Definitions  For the purposes of the Sprague–Grundy theorem, a game is a two-player game of perfect information satisfying the ending condition (all games come to an end: there are no infinite lines of play) and the normal play condition (a player who cannot move loses).  An impartial game is one such as nim , in which each player has exactly the same available moves as the other player in any position. Note that games such as tic-tac-toe , checkers , and chess are not impartial games. In the case of checkers and chess, for example, players can only move their own pieces, not their opponent's pieces. And in tic-tac-toe, one player puts down X's, while the other puts down O's. Positions in impartial games fall into two outcome classes : either the next player (the one whose turn it is) wins (an N-position ) or the previous player wins (a P-position ).  In this proof, a position is identified with the set of positions that can be reached in one move (these positions are called options ). For example, the position    {  }      \{\}   is a P-position under normal play, because the current player has no moves and therefore loses. The position    {   {  }   }        \{\{\}\}   , in contrast, is an N-position; the current player has only one option, and that option is a losing position for their opponent.  A nimber is a special position denoted     *  n      absent  n    *n   for some ordinal    n   n   n   .     *  0      absent  0    *0   is    {  }      \{\}   , the P-position given as an example earlier. The other nimbers are defined inductively by    *   (  n  +  1  )   =  *  n  ∪   {  *  n  }      fragments    fragments  normal-(  n   1  normal-)     n    fragments  normal-{   n  normal-}     *(n+1)=*n\cup\{*n\}   ; in particular,    *  1  =   {  *  0  }      fragments   1    fragments  normal-{   0  normal-}     *1=\{*0\}   (the example N-position from above),    *  2  =   {  *  0  ,  *  1  }      fragments   2    fragments  normal-{   0  normal-,   1  normal-}     *2=\{*0,*1\}   (a choice between the two example positions), etc.     *  n      absent  n    *n   therefore corresponds to a heap of   n   n   n   counters in the game of nim , hence the name.  Two positions   G   G   G   and   H   H   H   can be added to make a new position    G  +  H      G  H    G+H   in a combined game where the current player can choose either to move in   G   G   G   or in   H   H   H   . Explicit computation of the set    G  +  H      G  H    G+H   is by repeated application of the rule     G  +  H   =    {   G  +  h   ∣   h  ∈  H   }   ∪   {   g  +  H   ∣   g  ∈  G   }          G  H      conditional-set    G  h     h  H     conditional-set    g  H     g  G       G+H=\{G+h\mid h\in H\}\cup\{g+H\mid g\in G\}   , which incidentally indicates that position addition is both commutative and associative as expected.  Two positions   G   G   G   and    G  ′     superscript  G  normal-′    G^{\prime}   are defined to be equivalent if for every position   H   H   H   , the position    G  +  H      G  H    G+H   is in the same outcome class as     G  ′   +  H       superscript  G  normal-′   H    G^{\prime}+H   . Such an equivalence is written    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   .  First Lemma  As an intermediate step to proving the main theorem, we show that, for every position   G   G   G   and every P-position   A   A   A   , the equivalence    G  ≈   A  +  G       G    A  G     G\approx A+G   holds. By the above definition of equivalence, this amounts to showing that    G  +  H      G  H    G+H   and    A  +  G  +  H      A  G  H    A+G+H   share an outcome class for all   H   H   H   .  Suppose that    G  +  H      G  H    G+H   is a P-position. Then the previous player has a winning strategy for    A  +  G  +  H      A  G  H    A+G+H   : respond to moves in   A   A   A   according to their winning strategy for   A   A   A   (which exists by virtue of   A   A   A   being a P-position), and respond to moves in    G  +  H      G  H    G+H   according to their winning strategy for    G  +  H      G  H    G+H   (which exists for analogous reason). So    A  +  G  +  H      A  G  H    A+G+H   must also be a P-position.  On the other hand, if    G  +  H      G  H    G+H   is an N-position, then the next player has a winning strategy: choose a P-position from among the    G  +  H      G  H    G+H   options, putting their opponent in the case above. Thus, in this case,    A  +  G  +  H      A  G  H    A+G+H   must be a N-position, just like    G  +  H      G  H    G+H   .  As these are the only two cases, the lemma holds.  Second Lemma  As a further step, we show that    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   if and only if    G  +   G  ′       G   superscript  G  normal-′     G+G^{\prime}   is a P-position.  In the forward direction, suppose that    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   . Applying the definition of equivalence with    H  =  G      H  G    H=G   , we find that     G  ′   +  G       superscript  G  normal-′   G    G^{\prime}+G   (which is equal to    G  +   G  ′       G   superscript  G  normal-′     G+G^{\prime}   by commutativity of addition) is in the same outcome class as    G  +  G      G  G    G+G   . But    G  +  G      G  G    G+G   must be a P-position: for every move made in one copy of   G   G   G   , the previous player can respond with the same move in the other copy, and so always make the last move.  In the reverse direction, we apply the first lemma with    A  =   G  +   G  ′        A    G   superscript  G  normal-′      A=G+G^{\prime}   to   G   G   G   to get    G  ≈   G  +   (   G  +   G  ′    )        G    G    G   superscript  G  normal-′       G\approx G+(G+G^{\prime})   and with    A  =   G  +  G       A    G  G     A=G+G   to    G  ′     superscript  G  normal-′    G^{\prime}   to deduce     G  ′   ≈    G  ′   +   (   G  +  G   )         superscript  G  normal-′      superscript  G  normal-′     G  G      G^{\prime}\approx G^{\prime}+(G+G)   . By associativity and commutativity, the right-hand sides of these results are equal. Furthermore,   ≈     \approx   is an equivalence relation because equality is an equivalence relation on outcome classes. Via the transitivity of   ≈     \approx   , we can conclude that    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   .  Proof  We prove that all positions are equivalent to a nimber by structural induction . The more specific result, that the given game's initial position must be equivalent to a nimber, shows that the game is itself equivalent to a nimber.  Consider a position    G  =   {   G  1   ,   G  2   ,  …  ,   G  k   }       G    subscript  G  1    subscript  G  2   normal-…   subscript  G  k      G=\{G_{1},G_{2},\ldots,G_{k}\}   . By the induction hypothesis, all of the options are equivalent to nimbers, say     G  i   ≈  *   n  i      fragments   subscript  G  i      subscript  n  i     G_{i}\approx*n_{i}   . So let     G  ′   =   {  *   n  1   ,  *   n  2   ,  …  ,  *   n  k   }      fragments   superscript  G  normal-′     fragments  normal-{    subscript  n  1   normal-,    subscript  n  2   normal-,  normal-…  normal-,    subscript  n  k   normal-}     G^{\prime}=\{*n_{1},*n_{2},\ldots,*n_{k}\}   . We will show that    G  ≈  *  m     fragments  G    m    G\approx*m   , where   m   m   m   is the mex (minimum exclusion) of the numbers     n  1   ,   n  2   ,  …  ,   n  k       subscript  n  1    subscript  n  2   normal-…   subscript  n  k     n_{1},n_{2},\ldots,n_{k}   , that is, the smallest non-negative integer not equal to some    n  i     subscript  n  i    n_{i}   .  The first thing we need to note is that    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   , by way of the second lemma. If   k   k   k   is zero, the claim is trivially true. Otherwise, consider    G  +   G  ′       G   superscript  G  normal-′     G+G^{\prime}   . If the next player makes a move to    G  i     subscript  G  i    G_{i}   in   G   G   G   , then the previous player can move to     *   n  i       absent   subscript  n  i     *n_{i}   in    G  ′     superscript  G  normal-′    G^{\prime}   , and conversely if the next player makes a move in    G  ′     superscript  G  normal-′    G^{\prime}   . After this, the position is a P-position by the lemma's forward implication. Therefore,    G  +   G  ′       G   superscript  G  normal-′     G+G^{\prime}   is a P-position, and, citing the lemma's reverse implication,    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   .  Now let us show that     G  ′   +  *  m     fragments   superscript  G  normal-′     m    G^{\prime}+*m   is a P-position, which, using the second lemma once again, means that     G  ′   ≈  *  m     fragments   superscript  G  normal-′     m    G^{\prime}\approx*m   . We do so by giving an explicit strategy for the previous player.  Suppose that    G  ′     superscript  G  normal-′    G^{\prime}   and     *  m      absent  m    *m   are empty. Then     G  ′   +  *  m     fragments   superscript  G  normal-′     m    G^{\prime}+*m   is the null set, clearly a P-position.  Or consider the case that the next player moves in the component     *  m      absent  m    *m   to the option     *   m  ′       absent   superscript  m  normal-′     *m^{\prime}   where    G  ′     superscript  G  normal-′    G^{\prime}   was the minimum excluded number, the previous player can move in     *   m  ′       absent   superscript  m  normal-′     *m^{\prime}   to    G  ′     superscript  G  normal-′    G^{\prime}   . And, as shown before, any position plus itself is a P-position.  Finally, suppose instead that the next player moves in the component     *   n  i       absent   subscript  n  i     *n_{i}   to the option     n  i   <  m       subscript  n  i   m    n_{i}   . If     *  m      absent  m    *m   then the previous player moves in     *   n  i       absent   subscript  n  i     *n_{i}   to     n  i   >  m       subscript  n  i   m    n_{i}>m   ; otherwise, if     *   n  i       absent   subscript  n  i     *n_{i}   , the previous player moves in     *  m      absent  m    *m   to     n  i   =  m       subscript  n  i   m    n_{i}=m   ; in either case the result is a position plus itself. (It is not possible that   m   m   m   because    n  i     subscript  n  i    n_{i}   was defined to be different from all the    G  ≈   G  ′       G   superscript  G  normal-′     G\approx G^{\prime}   .)  In summary, we have     G  ′   ≈  *  m     fragments   superscript  G  normal-′     m    G^{\prime}\approx*m   and    G  ≈  *  m     fragments  G    m    G\approx*m   . By transitivity, we conclude that   G   G   G   , as desired.  Development  If   m   m   m   is a position of an impartial game, the unique integer    G  ≈  *  m     fragments  G    m    G\approx*m   such that   m   m   m   is called its Grundy value, or Grundy number, and the function which assigns this value to each such position is called the Sprague–Grundy function. R.L.Sprague and P.M.Grundy independently gave an explicit definition of this function, not based on any concept of equivalence to nim positions, and showed that it had the following properties:   The Grundy value of a single nim pile of size     *  m      absent  m    *m   (i.e. of the position   m   m   m   ) is   G   G   G   ;  A position is a loss for the next player to move (i.e. a P-position) if and only if its Grundy value is zero; and  The Grundy value of the sum of a finite set of positions is just the nim-sum of the Grundy values of its summands.   It follows straightforwardly from these results that if a position   m   m   m   has a Grundy value of    G  +  H      G  H    G+H   , then     *   m  +  H       absent    m  H     *m+H   has the same Grundy value as   H   H   H   , and therefore belongs to the same outcome class, for any position $H$ . Thus, although Sprague and Grundy never explicitly stated the theorem described in this article, it is nevertheless an almost trivial consequence of their results. These results have subsequently been developed into the field of combinatorial game theory , notably by Richard Guy , Elwyn Berlekamp , John Horton Conway and others, where they are now encapsulated in the Sprague–Grundy theorem and its proof in the form described here. The field is presented in the books Winning Ways for your Mathematical Plays and On Numbers and Games .  See also   Genus theory  Indistinguishability quotient   References    Reprinted, 1964, 27 : 9–11.       External links   Grundy's game at cut-the-knot  Easily readable, introductory account from the UCLA Math Department  The Game of Nim at sputsoft.com   "  Category:Combinatorial game theory  Category:Theorems in discrete mathematics   
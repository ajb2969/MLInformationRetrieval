   Hierarchical clustering      Hierarchical clustering   In data mining and statistics , hierarchical clustering (also called hierarchical cluster analysis or HCA ) is a method of cluster analysis which seeks to build a hierarchy of clusters. Strategies for hierarchical clustering generally fall into two types: 1   Agglomerative : This is a "bottom up" approach: each observation starts in its own cluster, and pairs of clusters are merged as one moves up the hierarchy.  Divisive : This is a "top down" approach: all observations start in one cluster, and splits are performed recursively as one moves down the hierarchy.   In general, the merges and splits are determined in a greedy manner. The results of hierarchical clustering are usually presented in a dendrogram .  In the general case, the complexity of agglomerative clustering is    O   (   n  3   )       O   superscript  n  3     O(n^{3})   , which makes them too slow for large data sets. Divisive clustering with an exhaustive search is    O   (   2  n   )       O   superscript  2  n     O(2^{n})   , which is even worse. However, for some special cases, optimal efficient agglomerative methods (of complexity    O   (   n  2   )       O   superscript  n  2     O(n^{2})   ) are known: SLINK 2 for single-linkage and CLINK 3 for complete-linkage clustering.  Cluster dissimilarity  In order to decide which clusters should be combined (for agglomerative), or where a cluster should be split (for divisive), a measure of dissimilarity between sets of observations is required. In most methods of hierarchical clustering, this is achieved by use of an appropriate metric (a measure of distance between pairs of observations), and a linkage criterion which specifies the dissimilarity of sets as a function of the pairwise distances of observations in the sets.  Metric  The choice of an appropriate metric will influence the shape of the clusters, as some elements may be close to one another according to one distance and farther away according to another. For example, in a 2-dimensional space, the distance between the point (1,0) and the origin (0,0) is always 1 according to the usual norms, but the distance between the point (1,1) and the origin (0,0) can be 2 under Manhattan distance,    2      2    \scriptstyle\sqrt{2}   under Euclidean distance, or 1 under maximum distance.  Some commonly used metrics for hierarchical clustering are: 4      Names   Formula       Euclidean distance         ‚à•   a  -  b   ‚à•   2   =     ‚àë  i     (    a  i   -   b  i    )   2          subscript   norm    a  b    2       subscript   i    superscript     subscript  a  i    subscript  b  i    2       \|a-b\|_{2}=\sqrt{\sum_{i}(a_{i}-b_{i})^{2}}        Squared Euclidean distance         ‚à•   a  -  b   ‚à•   2  2   =    ‚àë  i     (    a  i   -   b  i    )   2         superscript   subscript   norm    a  b    2   2     subscript   i    superscript     subscript  a  i    subscript  b  i    2      \|a-b\|_{2}^{2}=\sum_{i}(a_{i}-b_{i})^{2}        Manhattan distance         ‚à•   a  -  b   ‚à•   1   =    ‚àë  i    |    a  i   -   b  i    |         subscript   norm    a  b    1     subscript   i        subscript  a  i    subscript  b  i        \|a-b\|_{1}=\sum_{i}|a_{i}-b_{i}|        maximum distance         ‚à•   a  -  b   ‚à•   ‚àû   =    max  i    |    a  i   -   b  i    |         subscript   norm    a  b        subscript   i        subscript  a  i    subscript  b  i        \|a-b\|_{\infty}=\max_{i}|a_{i}-b_{i}|        Mahalanobis distance          (   a  -  b   )   ‚ä§    S   -  1     (   a  -  b   )           superscript    a  b   top    superscript  S    1      a  b      \sqrt{(a-b)^{\top}S^{-1}(a-b)}   where S is the Covariance matrix       For text or other non-numeric data, metrics such as the Hamming distance or Levenshtein distance are often used.  A review of cluster analysis in health psychology research found that the most common distance measure in published studies in that research area is the Euclidean distance or the squared Euclidean distance.  Linkage criteria  The linkage criterion determines the distance between sets of observations as a function of the pairwise distances between observations.  Some commonly used linkage criteria between two sets of observations A and B are: 5 6      Names   Formula       Maximum or complete-linkage clustering         max    {    d   (  a  ,  b  )    :    a  ‚àà  A   ,   b  ‚àà   B      }    .       normal-:    d   a  b     formulae-sequence    a  A     b  B       \max\,\{\,d(a,b):a\in A,\,b\in B\,\}.        Minimum or single-linkage clustering         min    {    d   (  a  ,  b  )    :    a  ‚àà  A   ,   b  ‚àà   B      }    .       normal-:    d   a  b     formulae-sequence    a  A     b  B       \min\,\{\,d(a,b):a\in A,\,b\in B\,\}.        Mean or average linkage clustering, or UPGMA         1    |  A  |    |  B  |       ‚àë   a  ‚àà  A      ‚àë   b  ‚àà  B     d   (  a  ,  b  )       .        1      A     B       subscript     a  A      subscript     b  B      d   a  b        \frac{1}{|A||B|}\sum_{a\in A}\sum_{b\in B}d(a,b).        Centroid linkage clustering, or UPGMC       ||    c  s   -   c  t    ||     norm     subscript  c  s    subscript  c  t      ||c_{s}-c_{t}||   where    c  s     subscript  c  s    c_{s}   and    c  t     subscript  c  t    c_{t}   are the centroids of clusters s and t , respectively.     Minimum energy clustering         2   n  m      ‚àë    i  ,  j   =  1    n  ,  m      ‚à•    a  i   -   b  j    ‚à•   2     -    1   n  2      ‚àë    i  ,  j   =  1   n     ‚à•    a  i   -   a  j    ‚à•   2     -    1   m  2      ‚àë    i  ,  j   =  1   m     ‚à•    b  i   -   b  j    ‚à•   2             2    n  m      superscript   subscript      i  j   1     n  m     subscript   norm     subscript  a  i    subscript  b  j     2         1   superscript  n  2      superscript   subscript      i  j   1    n    subscript   norm     subscript  a  i    subscript  a  j     2         1   superscript  m  2      superscript   subscript      i  j   1    m    subscript   norm     subscript  b  i    subscript  b  j     2       \frac{2}{nm}\sum_{i,j=1}^{n,m}\|a_{i}-b_{j}\|_{2}-\frac{1}{n^{2}}\sum_{i,j=1}^%
 {n}\|a_{i}-a_{j}\|_{2}-\frac{1}{m^{2}}\sum_{i,j=1}^{m}\|b_{i}-b_{j}\|_{2}        where d is the chosen metric. Other linkage criteria include:   The sum of all intra-cluster variance.  The decrease in variance for the cluster being merged ( Ward's criterion ). 7  The probability that candidate clusters spawn from the same distribution function (V-linkage).  The product of in-degree and out-degree on a k-nearest-neighbor graph (graph degree linkage). 8  The increment of some cluster descriptor (i.e., a quantity defined for measuring the quality of a cluster) after merging two clusters. 9 10 11   Discussion  Hierarchical clustering has the distinct advantage that any valid measure of distance can be used. In fact, the observations themselves are not required: all that is used is a matrix of distances.  Example for Agglomerative Clustering  For example, suppose this data is to be clustered, and the Euclidean distance is the distance metric .  Cutting the tree at a given height will give a partitioning clustering at a selected precision. In this example, cutting after the second row of the dendrogram will yield clusters {a} {b c} {d e} {f}. Cutting after the third row will yield clusters {a} {b c} {d e f}, which is a coarser clustering, with a smaller number but larger clusters.  (Figure)  Raw data   The hierarchical clustering dendrogram would be as such:  (Figure)  Traditional representation   This method builds the hierarchy from the individual elements by progressively merging clusters. In our example, we have six elements {a} {b} {c} {d} {e} and {f}. The first step is to determine which elements to merge in a cluster. Usually, we want to take the two closest elements, according to the chosen distance.  Optionally, one can also construct a distance matrix at this stage, where the number in the i -th row j -th column is the distance between the i -th and j -th elements. Then, as clustering progresses, rows and columns are merged as the clusters are merged and the distances updated. This is a common way to implement this type of clustering, and has the benefit of caching distances between clusters. A simple agglomerative clustering algorithm is described in the single-linkage clustering page; it can easily be adapted to different types of linkage (see below).  Suppose we have merged the two closest elements b and c , we now have the following clusters { a }, { b , c }, { d }, { e } and { f }, and want to merge them further. To do that, we need to take the distance between {a} and {b c}, and therefore define the distance between two clusters. Usually the distance between two clusters   ùíú   ùíú   \mathcal{A}   and   ‚Ñ¨   ‚Ñ¨   \mathcal{B}   is one of the following:   The maximum distance between elements of each cluster (also called complete-linkage clustering ):          max   {    d   (  x  ,  y  )    :    x  ‚àà  ùíú   ,   y  ‚àà   ‚Ñ¨      }    .       normal-:    d   x  y     formulae-sequence    x  ùíú     y  ‚Ñ¨       \max\{\,d(x,y):x\in\mathcal{A},\,y\in\mathcal{B}\,\}.         The minimum distance between elements of each cluster (also called single-linkage clustering ):          min   {    d   (  x  ,  y  )    :    x  ‚àà  ùíú   ,   y  ‚àà   ‚Ñ¨      }    .       normal-:    d   x  y     formulae-sequence    x  ùíú     y  ‚Ñ¨       \min\{\,d(x,y):x\in\mathcal{A},\,y\in\mathcal{B}\,\}.         The mean distance between elements of each cluster (also called average linkage clustering, used e.g. in UPGMA ):           1    |  ùíú  |   ‚ãÖ   |  ‚Ñ¨  |       ‚àë   x  ‚àà  ùíú      ‚àë   y  ‚àà  ‚Ñ¨     d   (  x  ,  y  )       .        1   normal-‚ãÖ    ùíú     ‚Ñ¨       subscript     x  ùíú      subscript     y  ‚Ñ¨      d   x  y        {1\over{|\mathcal{A}|\cdot|\mathcal{B}|}}\sum_{x\in\mathcal{A}}\sum_{y\in%
 \mathcal{B}}d(x,y).         The sum of all intra-cluster variance.  The increase in variance for the cluster being merged ( Ward's method )  The probability that candidate clusters spawn from the same distribution function (V-linkage).   Each agglomeration occurs at a greater distance between clusters than the previous agglomeration, and one can decide to stop clustering either when the clusters are too far apart to be merged (distance criterion) or when there is a sufficiently small number of clusters (number criterion).  Software  Open Source Frameworks   R has several functions for hierarchical clustering: see CRAN Task View: Cluster Analysis & Finite Mixture Models for more information.  Cluster 3.0 provides a nice Graphical User Interface to access to different clustering routines and is available for Windows, Mac OS X, Linux, Unix.  ELKI includes multiple hierarchical clustering algorithms, various linkage strategies and also includes the efficient SLINK 12 algorithm, flexible cluster extraction from dendrograms and various other cluster analysis algorithms.  Octave , the GNU analog to MATLAB implements hierarchical clustering in linkage function  Orange , a free data mining software suite, module orngClustering for scripting in Python , or cluster analysis through visual programming.  scikit-learn implements a hierarchical clustering.  Weka includes hierarchical cluster analysis.  fastCluster efficiently implements the seven most widely used clustering schemes.  SCaViS computing environment in Java that implements this algorithm.   Standalone implementations   CrimeStat implements two hierarchical clustering routines, a nearest neighbor (Nnh) and a risk-adjusted(Rnnh).  figue is a JavaScript package that implements some agglomerative clustering functions (single-linkage, complete-linkage, average-linkage) and functions to visualize clustering output (e.g. dendrograms).  hcluster is a Python implementation, based on NumPy , which supports hierarchical clustering and plotting.  Hierarchical Agglomerative Clustering implemented as C# visual studio project that includes real text files processing, building of document-term matrix with stop words filtering and stemming.  MultiDendrograms An open source  Java application for variable-group agglomerative hierarchical clustering, with graphical user interface .  Graph Agglomerative Clustering (GAC) toolbox implemented several graph-based agglomerative clustering algorithms.  Hierarchical Clustering Explorer provides tools for interactive exploration of multidimensional data.   Commercial   MATLAB includes hierarchical cluster analysis.  SAS includes hierarchical cluster analysis.  Mathematica includes a Hierarchical Clustering Package.  NCSS (statistical software) includes hierarchical cluster analysis.  SPSS includes hierarchical cluster analysis.  Qlucore Omics Explorer includes hierarchical cluster analysis.  Stata includes hierarchical cluster analysis.   See also   Statistical distance  Brown clustering  Cluster analysis  CURE data clustering algorithm  Dendrogram  Determining the number of clusters in a data set  Hierarchical clustering of networks  Nearest-neighbor chain algorithm  Numerical taxonomy  OPTICS algorithm  Nearest neighbor search  Locality-sensitive hashing   Notes  References and further reading      Hierarchical Cluster Analysis  Free statistical software. An overview of statistical software and methods used in published microbiological studies   "  Category:Network analysis  Category:Data clustering algorithms     Rokach, Lior, and Oded Maimon. "Clustering methods." Data mining and knowledge discovery handbook. Springer US, 2005. 321-352. ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  Sz√©kely, G. J. and Rizzo, M. L. (2005) Hierarchical clustering via Joint Between-Within Distances: Extending Ward's Minimum Variance Method, Journal of Classification 22, 151-183. ‚Ü©  ‚Ü©  Zhang, et al. "Graph degree linkage: Agglomerative clustering on a directed graph." 12th European Conference on Computer Vision, Florence, Italy, October 7‚Äì13, 2012. http://arxiv.org/abs/1208.5092 ‚Ü©  Zhang, et al. "Agglomerative clustering via maximum incremental path integral." Pattern Recognition (2013). ‚Ü©  Zhao, and Tang. "Cyclizing clusters via zeta function of a graph."Advances in Neural Information Processing Systems. 2008. ‚Ü©  Ma, et al. "Segmentation of multivariate mixed data via lossy data coding and compression." IEEE Transactions on Pattern Analysis and Machine Intelligence, 29(9) (2007): 1546-1562. ‚Ü©      
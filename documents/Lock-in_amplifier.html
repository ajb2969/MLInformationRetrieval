<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1619">Lock-in amplifier</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lock-in amplifier</h1>
<hr/>

<p> </p>

<p>A <strong>lock-in amplifier</strong> is a type of <a class="uri" href="amplifier" title="wikilink">amplifier</a> that can extract a <a href="Signaling_(telecommunication)" title="wikilink">signal</a> with a known <a href="carrier_wave" title="wikilink">carrier wave</a> from an extremely noisy environment. Depending on the dynamic reserve of the instrument, signals up to 1 million times smaller than noise components, potentially fairly close by in frequency, can still be reliably detected. It is essentially a <a href="homodyne_detection" title="wikilink">homodyne detector</a> followed by <a href="low_pass_filter" title="wikilink">low pass filter</a> that is often adjustable in cut off frequency and filter order. Whereas traditional lock-in amplifiers use analog <a href="frequency_mixer" title="wikilink">frequency mixers</a> and <a href="RC_filter" title="wikilink">RC filters</a> for the demodulation, state of the art instruments have both steps implemented by fast <a href="digital_signal_processing" title="wikilink">digital signal processing</a> for example on an <a class="uri" href="FPGA" title="wikilink">FPGA</a>. Usually sine and cosine demodulation is performed simultaneously, which is sometimes also referred to as dual phase demodulation. This allows the extraction of the in-phase and the quadrature component that can then be transferred into polar coordinates, i.e. amplitude and phase, or further processed as real and imaginary part of a complex number (e.g. for complex <a class="uri" href="FFT" title="wikilink">FFT</a> analysis).</p>

<p>The device is often used to measure <a href="phase_shift" title="wikilink">phase shift</a>, even when the signals are large and of high <a href="signal-to-noise_ratio" title="wikilink">signal-to-noise ratio</a>, and do not need further improvement.</p>

<p>Recovering signals at low signal-to-noise ratios requires a strong, clean reference signal the same frequency as the received signal. This is not the case in many experiments, so the instrument can recover signals buried in the noise only in a limited set of circumstances.</p>

<p>The lock-in amplifier is commonly believed to be invented by <a href="Princeton_University" title="wikilink">Princeton University</a> physicist <a href="Robert_H._Dicke" title="wikilink">Robert H. Dicke</a> who founded the company Princeton Applied Research (PAR) to market the product. However, in an interview with <a href="Martin_Harwit" title="wikilink">Martin Harwit</a>, Dicke claims that even though he is often credited with the invention of the device, he believes he read about it in a review of scientific equipment written by <a href="Walter_C_Michels" title="wikilink">Walter C Michels</a>, a professor at <a href="Bryn_Mawr_College" title="wikilink">Bryn Mawr College</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> This could have been a 1941 paper by Michels and Curtis,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> which in turn cites a 1934 paper by C. R. Cosens.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Another timeless paper was written by C.A. Stutt in 1949.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="basic-principles">Basic principles</h2>

<p>Operation of a lock-in amplifier relies on the <a class="uri" href="orthogonality" title="wikilink">orthogonality</a> of <a href="sinusoidal_function" title="wikilink">sinusoidal functions</a>. Specifically, when a sinusoidal function of frequency <em>f<sub>1</sub></em> is multiplied by another sinusoidal function of frequency <em>f<sub>2</sub></em> not equal to <em>f<sub>1</sub></em> and <a href="integral" title="wikilink">integrated</a> over a time much longer than the period of the two functions, the result is zero. Instead, when <em>f<sub>1</sub></em> is equal to <em>f<sub>2</sub></em> and the two functions are in phase, the average value is equal to half of the product of the amplitudes.</p>

<p>In essence, a lock-in amplifier takes the input signal, <a href="product_detector" title="wikilink">multiplies</a> it by the reference signal (either provided from the internal <a href="electronic_oscillator" title="wikilink">oscillator</a> or an external source), and integrates it over a specified time, usually on the order of milliseconds to a few seconds. The resulting signal is a DC signal, where the contribution from any signal that is not at the same frequency as the reference signal is <a href="attenuation" title="wikilink">attenuated</a> close to zero. The <a href="Quadrature_phase" title="wikilink">out-of-phase component</a> of the signal that has the same frequency as the reference signal is also attenuated (because sine functions are orthogonal to the cosine functions of the same frequency), making a lock-in a phase-sensitive detector.</p>

<p>For a sine reference signal and an input waveform 

<math display="inline" id="Lock-in_amplifier:0">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mi>in</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <ci>in</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{\mathrm{in}}(t)
  </annotation>
 </semantics>
</math>

, the DC output signal 

<math display="inline" id="Lock-in_amplifier:1">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mi>out</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <ci>out</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{\mathrm{out}}(t)
  </annotation>
 </semantics>
</math>

 can be calculated for an analog lock-in amplifier by:</p>

<p>

<math display="block" id="Lock-in_amplifier:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>U</mi>
     <mi>out</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mi>T</mi>
      </mrow>
      <mi>t</mi>
     </msubsup>
     <mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo>[</mo>
        <mrow>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mi>π</mi>
           <msub>
            <mi>f</mi>
            <mi>ref</mi>
           </msub>
          </mrow>
          <mo>⋅</mo>
          <mi>s</mi>
         </mrow>
         <mo>+</mo>
         <mi>φ</mi>
        </mrow>
        <mo>]</mo>
       </mrow>
      </mrow>
      <msub>
       <mi>U</mi>
       <mi>in</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>s</mi>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">d</mi>
      <mi>s</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>U</ci>
      <ci>out</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>T</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>T</ci>
        </apply>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <sin></sin>
        <apply>
         <plus></plus>
         <apply>
          <ci>normal-⋅</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>π</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>f</ci>
            <ci>ref</ci>
           </apply>
          </apply>
          <ci>s</ci>
         </apply>
         <ci>φ</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <ci>in</ci>
       </apply>
       <ci>s</ci>
       <ci>normal-d</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{\mathrm{out}}(t)=\frac{1}{T}\int_{t-T}^{t}{\sin\left[2\pi f_{\mathrm{ref}}%
\cdot s+\varphi\right]U_{\mathrm{in}}(s)}\;\mathrm{d}s
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>φ</em> is a phase that can be set on the lock-in (set to zero by default).</p>

<p>If the averaging time T is large enough (e.g. much larger than the signal period) to suppress all unwanted parts like noise and the variations at twice the reference frequency, the output is</p>

<p>

<math display="block" id="Lock-in_amplifier:3">
 <semantics>
  <mrow>
   <msub>
    <mi>U</mi>
    <mi>out</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>s</mi>
      <mi>i</mi>
      <mi>g</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>U</ci>
     <ci>out</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>i</ci>
       <ci>g</ci>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U_{\mathrm{out}}=V_{sig}\cos\theta
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Lock-in_amplifier:4">
 <semantics>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>s</mi>
    <mi>i</mi>
    <mi>g</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>i</ci>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{sig}
  </annotation>
 </semantics>
</math>

 is the signal amplitude at the reference frequency and 

<math display="inline" id="Lock-in_amplifier:5">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is the phase difference between the signal and reference.</p>

<p>Many applications of the lock-in only require recovering the signal amplitude rather than relative phase to the reference signal. For a simple so called single phase lock-in-amplifier the phase difference is adjusted (usually manually) to zero to get the full signal.</p>

<p>More advanced, so called two phase lock-in-amplifiers have a second detector, doing the same calculation as before, but with an additional 90 degree phase shift. Thus one has two outputs: 

<math display="inline" id="Lock-in_amplifier:6">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>s</mi>
      <mi>i</mi>
      <mi>g</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>i</ci>
       <ci>g</ci>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=V_{sig}\cos\theta
  </annotation>
 </semantics>
</math>

 is called the 'in-phase' component and 

<math display="inline" id="Lock-in_amplifier:7">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>s</mi>
      <mi>i</mi>
      <mi>g</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>sin</mi>
     <mi>θ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>i</ci>
       <ci>g</ci>
      </apply>
     </apply>
     <apply>
      <sin></sin>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=V_{sig}\sin\theta
  </annotation>
 </semantics>
</math>

 the 'quadrature' component. These two quantities represent the signal as a vector relative to the lock-in reference oscillator. By computing the magnitude (R) of the signal vector, the phase dependency is removed:</p>

<p>

<math display="block" id="Lock-in_amplifier:8">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <msup>
      <mi>X</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>Y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </msqrt>
   <mo>=</mo>
   <msub>
    <mi>V</mi>
    <mrow>
     <mi>s</mi>
     <mi>i</mi>
     <mi>g</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>R</ci>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>i</ci>
       <ci>g</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R=\sqrt{X^{2}+Y^{2}}=V_{sig}
  </annotation>
 </semantics>
</math>

. The phase can be calculated from</p>

<p>

<math display="block" id="Lock-in_amplifier:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>tan</mi>
    <mi>θ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>Y</mi>
    <mo>/</mo>
    <mi>X</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <tan></tan>
     <ci>θ</ci>
    </apply>
    <apply>
     <divide></divide>
     <ci>Y</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tan\theta=Y/X
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="signal-measurement-in-noisy-environments">Signal measurement in noisy environments</h2>

<p> The essential idea in signal recovery is that <a href="Electronic_noise" title="wikilink">noise</a> tends to be spread over a wider spectrum, often much wider than the signal. In the simplest case of white noise, even if the <a href="root_mean_square" title="wikilink">root mean square</a> of noise is 10<sup>3</sup> times as large as the signal to be recovered, if the bandwidth of the measurement instrument can be reduced by a factor much greater than 10<sup>6</sup> around the signal frequency, then the equipment can be relatively insensitive to the noise. In a typical 100 MHz bandwidth (e.g. an oscilloscope), a bandpass filter with width much narrower than 100 Hz would accomplish this. The averaging time of the lock-in-amplifier determines the bandwidth, and allows very narrow filters, less than 1 Hz if needed. However this comes at the price of a slow response to changes in the signal.</p>

<p>In summary, even when noise and signal are indistinguishable in the time domain, if the signal has a definite frequency band and there is no large noise peak within that band, noise and signal can be separated sufficiently in the frequency domain.</p>

<p>If the signal is either slowly varying or otherwise constant (essentially a DC signal), then <a href="Flicker_noise" title="wikilink">1/f noise</a> typically overwhelms the signal. It may then be necessary to use external means to modulate the signal. For example, when detecting a small light signal against a bright background, the signal can be modulated either by a <a href="Optical_chopper" title="wikilink">chopper wheel</a>, <a href="Acousto-optic_modulator" title="wikilink">acousto-optical modulator</a>, <a href="photoelastic_modulator" title="wikilink">photoelastic modulator</a> at a large enough frequency so that 1/f noise drops off significantly, and the lock-in amplifier is referenced to the operating frequency of the modulator. In the case of an <a href="atomic_force_microscope" title="wikilink">atomic force microscope</a>, to achieve <a class="uri" href="nanometer" title="wikilink">nanometer</a> and <a class="uri" href="piconewton" title="wikilink">piconewton</a> resolution, the <a class="uri" href="cantilever" title="wikilink">cantilever</a> position is modulated at a high frequency, to which the lock-in amplifier is again referenced.</p>

<p>When the lock-in technique is applied, care must be taken to calibrate the signal, because lock-in amplifiers generally detect only the root-mean-square signal of the operating frequency. For a sinusoidal modulation, this would introduce a factor of 

<math display="inline" id="Lock-in_amplifier:10">
 <semantics>
  <msqrt>
   <mn>2</mn>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{2}
  </annotation>
 </semantics>
</math>

 between the lock-in amplifier output and the peak amplitude of the signal, and a different factor for non-sinusoidal modulation.</p>

<p>In the case of nonlinear systems, higher harmonics of the modulation-frequency appear. A simple example is the light of a conventional light bulb being modulated at twice the line frequency. Some lock-in-Amplifiers also allow separate measurements of these higher harmonics.</p>

<p>Furthermore, the response width (effective bandwidth) of detected signal depends on the amplitude of the modulation. Generally, linewidth/modulation function has a monotonically increasing, non-linear behavior.</p>
<h2 id="references">References</h2>
<h2 id="publications">Publications</h2>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.thinksrs.com/downloads/PDFs/ApplicationNotes/AboutLIAs.pdf">About LIAs</a> from Stanford Research Systems. Application note detailing how lock-in amplifiers work.</li>
<li><a href="http://igorbarsukov.com/lorentz.html">Calculation</a> of a modulated time dependent Lorentz signal and its line broadening due to the finite modulation by Lock-In Technique.</li>
<li><a href="http://www.bentham.co.uk/pdf/F225.pdf">Lock-in amplifier tutorial</a> from Bentham Instruments. Comprehensive tutorial about the why and how of lock-in amplifiers.</li>
<li><a href="http://www.signalrecovery.com/literature/index.aspx">Lock-in Technical Notes</a> Range of Technical and Applications notes describing the design of digital and analog lock-ins, and guide to their specifications from <em>SIGNAL RECOVERY</em>.</li>
<li><a href="http://leso.epfl.ch/cms/site/leso/lang/fr/pcsc-lockin">PCSC-Lock-in</a> Tool for data acquisition on acoustic chopping frequency using a computer sound card.</li>
</ul>

<p>"</p>

<p><a href="Category:Electronic_test_equipment" title="wikilink">Category:Electronic test equipment</a> <a href="Category:Electronic_amplifiers" title="wikilink">Category:Electronic amplifiers</a> <a href="Category:Laboratory_equipment" title="wikilink">Category:Laboratory equipment</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Oral History Transcript — Dr. Robert Dicke <a class="uri" href="http://www.aip.org/history/ohilist/4572.html">http://www.aip.org/history/ohilist/4572.html</a><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">Stutt, C.A. (1949). "Low-frequency spectrum of lock-in amplifiers". MIT Technical Report (MIT) (105): 1–18. <a class="uri" href="http://dspace.mit.edu/handle/1721.1/4940">http://dspace.mit.edu/handle/1721.1/4940</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

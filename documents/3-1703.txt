   Trapezoidal rule      Trapezoidal rule   {{ About|the quadrature rule for approximating integrals|the implicit trapezoidal rule for solving initial value problems|Trapezoidal rule (differential equations)|the explicit trapezoidal rule for solving initial value problems|Heun's method}}   In numerical analysis , the trapezoidal rule (also known as the trapezoid rule or trapezium rule ) is a technique for approximating the definite integral        ∫  a  b    f   (  x  )   d  x    .      superscript   subscript   a   b     f  x  d  x     \int_{a}^{b}f(x)\,dx.     The trapezoidal rule works by approximating the region under the graph of the function    f   (  x  )       f  x    f(x)   as a trapezoid and calculating its area. It follows that         ∫  a  b    f   (  x  )   d  x    ≈    (   b  -  a   )    [     f   (  a  )    +   f   (  b  )     2   ]     .        superscript   subscript   a   b     f  x  d  x        b  a    delimited-[]        f  a     f  b    2       \int_{a}^{b}f(x)\,dx\approx(b-a)\left[\frac{f(a)+f(b)}{2}\right].     Applicability and alternatives  The trapezoidal rule is one of a family of formulas for numerical integration called Newton–Cotes formulas , of which the midpoint rule is similar to the trapezoid rule. Simpson's rule is another member of the same family, and in general has faster convergence than the trapezoidal rule for functions which are twice continuously differentiable, though not in all specific cases. However for various classes of rougher functions (ones with weaker smoothness conditions), the trapezoidal rule has faster convergence in general than Simpson's rule. 1  Moreover, the trapezoidal rule tends to become extremely accurate when periodic functions are integrated over their periods, which can be analyzed in various ways . 2 3  For non-periodic functions, however, methods with unequally spaced points such as Gaussian quadrature and Clenshaw–Curtis quadrature are generally far more accurate; Clenshaw–Curtis quadrature can be viewed as a change of variables to express arbitrary integrals in terms of periodic integrals, at which point the trapezoidal rule can be applied accurately.  Numerical implementation  (Figure)  Illustration of trapezoidal rule used on a sequence of samples (in this case, a non-uniform grid).   Uniform grid  For a domain discretized into N equally spaced panels, or N +1 grid points a = x 1 2 N+1 = b , where the grid spacing is h =( b - a )/ N , the approximation to the integral becomes        ∫  a  b    f   (  x  )   d  x    ≈    h  2     ∑   k  =  1   N    (    f   (   x   k  +  1    )    +   f   (   x  k   )     )           superscript   subscript   a   b     f  x  d  x        h  2     superscript   subscript     k  1    N       f   subscript  x    k  1       f   subscript  x  k         \int_{a}^{b}f(x)\,dx\approx\frac{h}{2}\sum_{k=1}^{N}\left(f(x_{k+1})+f(x_{k})\right)         =     b  -  a    2  N     (    f   (   x  1   )    +   2  f   (   x  2   )    +   2  f   (   x  3   )    +   2  f   (   x  4   )    +  ⋯  +   2  f   (   x  N   )    +   f   (   x   N  +  1    )     )     .      absent        b  a     2  N        f   subscript  x  1      2  f   subscript  x  2      2  f   subscript  x  3      2  f   subscript  x  4    normal-⋯    2  f   subscript  x  N      f   subscript  x    N  1         {}=\frac{b-a}{2N}(f(x_{1})+2f(x_{2})+2f(x_{3})+2f(x_{4})+\cdots+2f(x_{N})+f(x_%
 {N+1})).     Non-uniform grid  When the grid spacing is non-uniform, one can use the formula         ∫  a  b    f   (  x  )   d  x    ≈    1  2     ∑   k  =  1   N     (    x   k  +  1    -   x  k    )    (    f   (   x   k  +  1    )    +   f   (   x  k   )     )       .        superscript   subscript   a   b     f  x  d  x        1  2     superscript   subscript     k  1    N        subscript  x    k  1     subscript  x  k        f   subscript  x    k  1       f   subscript  x  k          \int_{a}^{b}f(x)\,dx\approx\frac{1}{2}\sum_{k=1}^{N}\left(x_{k+1}-x_{k}\right)%
 \left(f(x_{k+1})+f(x_{k})\right).     Error analysis  The error of the composite trapezoidal rule is the difference between the value of the integral and the numerical result:      error  =     ∫  a  b    f   (  x  )   d  x    -     b  -  a   N    [      f   (  a  )    +   f   (  b  )     2   +    ∑   k  =  1    N  -  1     f   (   a  +   k    b  -  a   N     )      ]         error      superscript   subscript   a   b     f  x  d  x          b  a   N    delimited-[]          f  a     f  b    2     superscript   subscript     k  1      N  1      f    a    k      b  a   N             \text{error}=\int_{a}^{b}f(x)\,dx-\frac{b-a}{N}\left[{f(a)+f(b)\over 2}+\sum_{%
 k=1}^{N-1}f\left(a+k\frac{b-a}{N}\right)\right]     There exists a number ξ between a and b , such that 4      error  =   -      (   b  -  a   )   3    12   N  2      f  ′′    (  ξ  )         error         superscript    b  a   3     12   superscript  N  2      superscript  f  ′′   ξ      \text{error}=-\frac{(b-a)^{3}}{12N^{2}}f^{\prime\prime}(\xi)     It follows that if the integrand is concave up (and thus has a positive second derivative), then the error is negative and the trapezoidal rule overestimates the true value. This can also be seen from the geometric picture: the trapezoids include all of the area under the curve and extend over it. Similarly, a concave-down function yields an underestimate because area is unaccounted for under the curve, but none is counted above. If the interval of the integral being approximated includes an inflection point, the error is harder to identify.  In general, three techniques are used in the analysis of error: 5   Fourier series  Residue calculus  Euler–Maclaurin summation formula : 6 7   An asymptotic error estimate for N → ∞ is given by       error  =    -      (   b  -  a   )   2    12   N  2      [     f  ′    (  b  )    -    f  ′    (  a  )     ]     +   O   (   N   -  3    )      .      error           superscript    b  a   2     12   superscript  N  2      delimited-[]       superscript  f  normal-′   b      superscript  f  normal-′   a         O   superscript  N    3        \text{error}=-\frac{(b-a)^{2}}{12N^{2}}\big[f^{\prime}(b)-f^{\prime}(a)\big]+O%
 (N^{-3}).   Further terms in this error estimate are given by the Euler–Maclaurin summation formula.  It is argued that the speed of convergence of the trapezoidal rule reflects and can be used as a definition of classes of smoothness of the functions. 8  Periodic functions  The trapezoidal rule often converges very quickly for periodic functions. 9 This can be explained intuitively as:   When the function is periodic and one integrates over one full period, there are about as many sections of the graph that are concave up as concave down, so the errors cancel. 10    In the error formula above, f'(a) = f'(b), and only the O(N −3 ) term remains.  More detailed analysis can be found in. 11 12  "Rough" functions  For various classes of functions that are not twice-differentiable, the trapezoidal rule has sharper bounds than Simpson's rule . 13  See also   Gaussian quadrature  Newton–Cotes formulas  Rectangle method  Romberg's method  Simpson's rule   Notes    References    .    .     External links   Trapezoidal Rule for Numerical Integration  Notes on the convergence of trapezoidal-rule quadrature   "  Category:Numerical integration (quadrature)     ↩  ↩  ↩  ↩  ↩  ↩  ↩           
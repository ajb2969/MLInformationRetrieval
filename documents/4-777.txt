   Pontryagin's minimum principle      Pontryagin's minimum principle   Pontryagin's maximum (or minimum) principle is used in optimal control theory to find the best possible control for taking a dynamical system from one state to another, especially in the presence of constraints for the state or input controls. It was formulated in 1956 by the Russian mathematician Lev Pontryagin and his students. 1 It has as a special case the Euler‚ÄìLagrange equation of the calculus of variations .  The principle states informally that the control Hamiltonian must take an extreme value over controls in , the set of all permissible controls. Whether the extreme value is maximum or minimum depends both on the problem and on the sign convention used for defining the Hamiltonian. The normal convention, which is the one used in Hamiltonian , leads to a maximum hence maximum principle but the sign convention used in this article, which apparently comes from, 2 makes the extreme value a minimum, hence the unusual name minimum principle .  If   ùí∞   ùí∞   \mathcal{U}   is the set of values of permissible controls then the principle states that the optimal control u* must satisfy:        H   (    x  *    (  t  )    ,    u  *    (  t  )    ,    Œª  *    (  t  )    ,  t  )    ‚â§   H   (    x  *    (  t  )    ,  u  ,    Œª  *    (  t  )    ,  t  )     ,     ‚àÄ  u   ‚àà  ùí∞   ,   t  ‚àà   [   t  0   ,   t  f   ]        formulae-sequence      H      superscript  x    t      superscript  u    t      superscript  Œª    t   t      H      superscript  x    t   u     superscript  Œª    t   t      formulae-sequence     for-all  u   ùí∞     t    subscript  t  0    subscript  t  f        H(x^{*}(t),u^{*}(t),\lambda^{*}(t),t)\leq H(x^{*}(t),u,\lambda^{*}(t),t),\quad%
 \forall u\in\mathcal{U},\quad t\in[t_{0},t_{f}]   where     x  *   ‚àà    C  1    [   t  0   ,   t  f   ]         superscript  x       superscript  C  1     subscript  t  0    subscript  t  f       x^{*}\in C^{1}[t_{0},t_{f}]   is the optimal state trajectory and     Œª  *   ‚àà   B  V   [   t  0   ,   t  f   ]         superscript  Œª      B  V    subscript  t  0    subscript  t  f       \lambda^{*}\in BV[t_{0},t_{f}]   is the optimal costate trajectory. 3  The result was first successfully applied to minimum time problems where the input control is constrained, but it can also be useful in studying state-constrained problems.  Special conditions for the Hamiltonian can also be derived. When the final time    t  f     subscript  t  f    t_{f}   is fixed and the Hamiltonian does not depend explicitly on time    (     ‚àÇ  H    ‚àÇ  t    ‚â°  0   )          H     t    0    \left(\tfrac{\partial H}{\partial t}\equiv 0\right)   , then:       H   (    x  *    (  t  )    ,    u  *    (  t  )    ,    Œª  *    (  t  )    )    ‚â°   constant         H      superscript  x    t      superscript  u    t      superscript  Œª    t     constant    H(x^{*}(t),u^{*}(t),\lambda^{*}(t))\equiv\mathrm{constant}\,   and if the final time is free, then:       H   (    x  *    (  t  )    ,    u  *    (  t  )    ,    Œª  *    (  t  )    )    ‚â°   0.         H      superscript  x    t      superscript  u    t      superscript  Œª    t     0.    H(x^{*}(t),u^{*}(t),\lambda^{*}(t))\equiv 0.\,   More general conditions on the optimal control are given below.  When satisfied along a trajectory, Pontryagin's minimum principle is a necessary condition for an optimum. The Hamilton‚ÄìJacobi‚ÄìBellman equation provides a necessary and sufficient condition for an optimum, but this condition must be satisfied over the whole of the state space.  Maximization and minimization  The principle was first known as Pontryagin's maximum principle and its proof is historically based on maximizing the Hamiltonian. The initial application of this principle was to the maximization of the terminal speed of a rocket. However as it was subsequently mostly used for minimization of a performance index it has here been referred to as the minimum principle . Pontryagin's book solved the problem of minimizing a performance index. 4  Notation  In what follows we will be making use of the following notation.        Œ®  T    (   x   (  T  )    )    =       ‚àÇ  Œ®    (  x  )     ‚àÇ  T    |    x  =   x   (  T  )             subscript  normal-Œ®  T     x  T     evaluated-at        normal-Œ®   x     T      x    x  T       \Psi_{T}(x(T))=\frac{\partial\Psi(x)}{\partial T}|_{x=x(T)}\,           Œ®  x    (   x   (  T  )    )    =   [           ‚àÇ  Œ®    (  x  )     ‚àÇ   x  1      |    x  =   x   (  T  )        ‚ãØ          ‚àÇ  Œ®    (  x  )     ‚àÇ   x  n      |    x  =   x   (  T  )         ]          subscript  normal-Œ®  x     x  T       evaluated-at        normal-Œ®   x      subscript  x  1       x    x  T     normal-‚ãØ   evaluated-at        normal-Œ®   x      subscript  x  n       x    x  T         \Psi_{x}(x(T))=\begin{bmatrix}\frac{\partial\Psi(x)}{\partial x_{1}}|_{x=x(T)}%
 &\cdots&\frac{\partial\Psi(x)}{\partial x_{n}}|_{x=x(T)}\end{bmatrix}           H  x    (   x  *   ,   u  *   ,   Œª  *   ,  t  )    =   [          ‚àÇ  H    ‚àÇ   x  1      |     x  =   x  *    ,    u  =   u  *    ,   Œª  =   Œª  *         ‚ãØ         ‚àÇ  H    ‚àÇ   x  n      |     x  =   x  *    ,    u  =   u  *    ,   Œª  =   Œª  *          ]          subscript  H  x     superscript  x     superscript  u     superscript  Œª    t       evaluated-at      H      subscript  x  1      formulae-sequence    x   superscript  x      formulae-sequence    u   superscript  u       Œª   superscript  Œª        normal-‚ãØ   evaluated-at      H      subscript  x  n      formulae-sequence    x   superscript  x      formulae-sequence    u   superscript  u       Œª   superscript  Œª            H_{x}(x^{*},u^{*},\lambda^{*},t)=\begin{bmatrix}\frac{\partial H}{\partial x_{%
 1}}|_{x=x^{*},u=u^{*},\lambda=\lambda^{*}}&\cdots&\frac{\partial H}{\partial x%
 _{n}}|_{x=x^{*},u=u^{*},\lambda=\lambda^{*}}\end{bmatrix}           L  x    (   x  *   ,   u  *   )    =   [          ‚àÇ  L    ‚àÇ   x  1      |     x  =   x  *    ,   u  =   u  *        ‚ãØ         ‚àÇ  L    ‚àÇ   x  n      |     x  =   x  *    ,   u  =   u  *         ]          subscript  L  x     superscript  x     superscript  u         evaluated-at      L      subscript  x  1      formulae-sequence    x   superscript  x       u   superscript  u       normal-‚ãØ   evaluated-at      L      subscript  x  n      formulae-sequence    x   superscript  x       u   superscript  u           L_{x}(x^{*},u^{*})=\begin{bmatrix}\frac{\partial L}{\partial x_{1}}|_{x=x^{*},%
 u=u^{*}}&\cdots&\frac{\partial L}{\partial x_{n}}|_{x=x^{*},u=u^{*}}\end{bmatrix}           f  x    (   x  *   ,   u  *   )    =   [          ‚àÇ   f  1     ‚àÇ   x  1      |     x  =   x  *    ,   u  =   u  *        ‚ãØ         ‚àÇ   f  1     ‚àÇ   x  n      |     x  =   x  *    ,   u  =   u  *          ‚ãÆ    ‚ã±    ‚ãÆ           ‚àÇ   f  n     ‚àÇ   x  1      |     x  =   x  *    ,   u  =   u  *        ‚Ä¶         ‚àÇ   f  n     ‚àÇ   x  n      |     x  =   x  *    ,   u  =   u  *         ]          subscript  f  x     superscript  x     superscript  u         evaluated-at       subscript  f  1       subscript  x  1      formulae-sequence    x   superscript  x       u   superscript  u       normal-‚ãØ   evaluated-at       subscript  f  1       subscript  x  n      formulae-sequence    x   superscript  x       u   superscript  u         normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ     evaluated-at       subscript  f  n       subscript  x  1      formulae-sequence    x   superscript  x       u   superscript  u       normal-‚Ä¶   evaluated-at       subscript  f  n       subscript  x  n      formulae-sequence    x   superscript  x       u   superscript  u           f_{x}(x^{*},u^{*})=\begin{bmatrix}\frac{\partial f_{1}}{\partial x_{1}}|_{x=x^%
 {*},u=u^{*}}&\cdots&\frac{\partial f_{1}}{\partial x_{n}}|_{x=x^{*},u=u^{*}}\\
 \vdots&\ddots&\vdots\\
 \frac{\partial f_{n}}{\partial x_{1}}|_{x=x^{*},u=u^{*}}&\ldots&\frac{\partial
 f%
 _{n}}{\partial x_{n}}|_{x=x^{*},u=u^{*}}\end{bmatrix}     Formal statement of necessary conditions for minimization problem  Here the necessary conditions are shown for minimization of a functional. Take   x   x   x   to be the state of the dynamical system with input   u   u   u   , such that        x  Àô   =   f   (  x  ,  u  )     ,     x   (  0  )    =   x  0    ,     u   (  t  )    ‚àà  ùí∞   ,   t  ‚àà   [  0  ,  T  ]         formulae-sequence     normal-Àô  x     f   x  u      formulae-sequence      x  0    subscript  x  0     formulae-sequence      u  t   ùí∞     t   0  T        \dot{x}=f(x,u),\quad x(0)=x_{0},\quad u(t)\in\mathcal{U},\quad t\in[0,T]   where   ùí∞   ùí∞   \mathcal{U}   is the set of admissible controls and   T   T   T   is the terminal (i.e., final) time of the system. The control    u  ‚àà  ùí∞      u  ùí∞    u\in\mathcal{U}   must be chosen for all    t  ‚àà   [  0  ,  T  ]       t   0  T     t\in[0,T]   to minimize the objective functional   J   J   J   which is defined by the application and can be abstracted as      J  =    Œ®   (   x   (  T  )    )    +    ‚à´  0  T    L   (   x   (  t  )    ,   u   (  t  )    )   d  t         J      normal-Œ®    x  T      subscript   superscript   T   0     L     x  t     u  t    d  t       J=\Psi(x(T))+\int^{T}_{0}L(x(t),u(t))\,dt     The constraints on the system dynamics can be adjoined to the Lagrangian    L   L   L   by introducing time-varying Lagrange multiplier vector   Œª   Œª   \lambda   , whose elements are called the costates of the system. This motivates the construction of the Hamiltonian    H   H   H   defined for all    t  ‚àà   [  0  ,  T  ]       t   0  T     t\in[0,T]   by:       H   (   Œª   (  t  )    ,   x   (  t  )    ,   u   (  t  )    ,  t  )    =     Œª  ‚Ä≤    (  t  )   f   (   x   (  t  )    ,   u   (  t  )    )    +   L   (   x   (  t  )    ,   u   (  t  )    )           H     Œª  t     x  t     u  t   t         superscript  Œª  normal-‚Ä≤   t  f     x  t     u  t       L     x  t     u  t        H(\lambda(t),x(t),u(t),t)=\lambda^{\prime}(t)f(x(t),u(t))+L(x(t),u(t))\,   where    Œª  ‚Ä≤     superscript  Œª  normal-‚Ä≤    \lambda^{\prime}   is the transpose of   Œª   Œª   \lambda   .  Pontryagin's minimum principle states that the optimal state trajectory    x  *     superscript  x     x^{*}   , optimal control    u  *     superscript  u     u^{*}   , and corresponding Lagrange multiplier vector    Œª  *     superscript  Œª     \lambda^{*}   must minimize the Hamiltonian   H   H   H   so that        (  1  )    H   (    x  *    (  t  )    ,    u  *    (  t  )    ,    Œª  *    (  t  )    ,  t  )     ‚â§   H   (    x  *    (  t  )    ,  u  ,    Œª  *    (  t  )    ,  t  )         1    H      superscript  x    t      superscript  u    t      superscript  Œª    t   t       H      superscript  x    t   u     superscript  Œª    t   t      (1)\qquad H(x^{*}(t),u^{*}(t),\lambda^{*}(t),t)\leq H(x^{*}(t),u,\lambda^{*}(t%
 ),t)\,     for all time    t  ‚àà   [  0  ,  T  ]       t   0  T     t\in[0,T]   and for all permissible control inputs    u  ‚àà  ùí∞      u  ùí∞    u\in\mathcal{U}   . It must also be the case that        (  2  )      Œ®  T    (   x   (  T  )    )    +   H   (  T  )      =   0        2       subscript  normal-Œ®  T     x  T      H  T     0    (2)\qquad\Psi_{T}(x(T))+H(T)=0\,     Additionally, the costate equations        (  3  )    -     Œª  Àô   ‚Ä≤    (  t  )      =    H  x    (    x  *    (  t  )    ,    u  *    (  t  )    ,   Œª   (  t  )    ,  t  )    =     Œª  ‚Ä≤    (  t  )    f  x    (    x  *    (  t  )    ,    u  *    (  t  )    )    +    L  x    (    x  *    (  t  )    ,    u  *    (  t  )    )            3       superscript   normal-Àô  Œª   normal-‚Ä≤   t        subscript  H  x       superscript  x    t      superscript  u    t     Œª  t   t              superscript  Œª  normal-‚Ä≤   t   subscript  f  x       superscript  x    t      superscript  u    t        subscript  L  x       superscript  x    t      superscript  u    t         (3)\qquad-\dot{\lambda}^{\prime}(t)=H_{x}(x^{*}(t),u^{*}(t),\lambda(t),t)=%
 \lambda^{\prime}(t)f_{x}(x^{*}(t),u^{*}(t))+L_{x}(x^{*}(t),u^{*}(t))     must be satisfied. If the final state    x   (  T  )       x  T    x(T)   is not fixed (i.e., its differential variation is not zero), it must also be that the terminal costates are such that        (  4  )     Œª  ‚Ä≤    (  T  )     =    Œ®  x    (   x   (  T  )    )         4     superscript  Œª  normal-‚Ä≤   T       subscript  normal-Œ®  x     x  T      (4)\qquad\lambda^{\prime}(T)=\Psi_{x}(x(T))\,     These four conditions in (1)-(4) are the necessary conditions for an optimal control. Note that (4) only applies when    x   (  T  )       x  T    x(T)   is free. If it is fixed, then this condition is not necessary for an optimum.  See also   Lagrange multipliers on Banach spaces , Lagrangian method in calculus of variations   Notes  References        Slides are available at 1      External links    Pontryagin's Principle Illustrated with Examples   fr:Commande optimale#Principe du maximum  ru:–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ#–ü—Ä–∏–Ω—Ü–∏–ø –º–∞–∫—Å–∏–º—É–º–∞ –ü–æ–Ω—Ç—Ä—è–≥–∏–Ω–∞ "  Category:Mathematical optimization  Category:Optimal control  Category:Principles  Category:Calculus of variations     See ref. below for first published work. ‚Ü©  ‚Ü©  More info on C 1 and BV spaces ‚Ü©  See p.13 of the 1962 book of Pontryagin et al. referenced below. ‚Ü©     
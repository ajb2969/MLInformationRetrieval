   Local inverse      Local inverse   The local inverse is a kind of inverse function or matrix inverse used in image and signal processing, as well as other general areas of mathematics.  The concept of local inverse came from interior reconstruction of the CT image. One of the interior reconstruction methods was done through that first approximately reconstructs the image outside the ROI (region of interest) and then subtracts the re-projection data of the image at outside the ROI from the original projection data; then the above created data are used to make a new reconstruction. This idea can be widened to inverse. Instead of directly making an inverse, the unknowns at the outside of the local region can be first inverted. Recalculate the data from these unknowns (at outside the local region). Subtract this recalculated data from the original data, then the inverse for the unknowns inside the local region is done through the above newly produced data.  This concept is a direct extension of local tomography , generalized inverse and iterative refinement method. It is used to solve the inverse problem with incomplete input data, similar to local tomography. However this concept of local inverse also can be applied to complete input data.  Local inverse for full field of view system or over-determined system       [     f      g     ]   =    [     A    B      C    D     ]    [     x      y     ]          f    g        A  B    C  D      x    y       \begin{bmatrix}f\\
 g\end{bmatrix}=\begin{bmatrix}A&B\\
 C&D\end{bmatrix}\begin{bmatrix}x\\
 y\end{bmatrix}     Assume there is   E   E   E   ,   F   F   F   ,   G   G   G   and   H   H   H   that satisfies,        [     E    F      G    H     ]    [     A    B      C    D     ]    =  J          E  F    G  H      A  B    C  D     J    \begin{bmatrix}E&F\\
 G&H\end{bmatrix}\begin{bmatrix}A&B\\
 C&D\end{bmatrix}=J     Here   J   J   J   is not equal to   I   I   I   .   J   J   J   is close to   I   I   I   .   I   I   I   is identical matrix. Examples of this kind of matrix    [     E    F      G    H     ]      E  F    G  H     \begin{bmatrix}E&F\\
 G&H\end{bmatrix}   are for example, filtered back-projection method for image reconstruction, the inverse with regularization. In this case an approximate solution can be found as following,  and       [      x  0        y  0      ]   =    [     E    F      G    H     ]    [     f      g     ]           subscript  x  0      subscript  y  0         E  F    G  H      f    g       \begin{bmatrix}x_{0}\\
 y_{0}\end{bmatrix}=\begin{bmatrix}E&F\\
 G&H\end{bmatrix}\begin{bmatrix}f\\
 g\end{bmatrix}     A better solution for    x  1     subscript  x  1    x_{1}   can be found as following,       [      x  1        y  1      ]   =    [     E    F      G    H     ]    [      f  -   B   y  0          g  -   D   y  0        ]           subscript  x  1      subscript  y  1         E  F    G  H        f    B   subscript  y  0         g    D   subscript  y  0          \begin{bmatrix}x_{1}\\
 y_{1}\end{bmatrix}=\begin{bmatrix}E&F\\
 G&H\end{bmatrix}\begin{bmatrix}f-By_{0}\\
 g-Dy_{0}\end{bmatrix}     In the above formula    y  1     subscript  y  1    y_{1}   is useless, hence       x  1   =    E   (   f  -   B   y  0     )    +   F   (   g  -   D   y  0     )          subscript  x  1       E    f    B   subscript  y  0        F    g    D   subscript  y  0         x_{1}=E(f-By_{0})+F(g-Dy_{0})     In the same way, there is       y  1   =    G   (   f  -   A   x  0     )    +   H   (   g  -   C   x  0     )          subscript  y  1       G    f    A   subscript  x  0        H    g    C   subscript  x  0         y_{1}=G(f-Ax_{0})+H(g-Cx_{0})     In the above the solution is only divided to as two parts.   x   x   x   is inside the ROI(region of Interest)   y   y   y   is at outside of ROI. f is inside of FOV(field of view) y is outside of FOV.  The two parts can be extended to many parts, in this case, the extended method is referred as the sub-region iterative refinement method method 1  Local inverse for Limited field of view system or under-determined system       [     f      g     ]   =    [     A    B      C    D     ]    [     x      y     ]          f    g        A  B    C  D      x    y       \begin{bmatrix}f\\
 g\end{bmatrix}=\begin{bmatrix}A&B\\
 C&D\end{bmatrix}\begin{bmatrix}x\\
 y\end{bmatrix}     Assume   A   A   A   ,   B   B   B   ,   C   C   C   ,   D   D   D   are known matrices;   x   x   x   and   y   y   y   are unknown vectors;   f   f   f   is known vector;   g   g   g   is unknown vector. It is interested to know the vector x. What is the better solution?  Assume the above matrix inverse exists    [     E    F      G    H     ]      E  F    G  H     \begin{bmatrix}E&F\\
 G&H\end{bmatrix}           [     A    B      C    D     ]    [     E    F      G    H     ]    =  J          A  B    C  D      E  F    G  H     J    \begin{bmatrix}A&B\\
 C&D\end{bmatrix}\begin{bmatrix}E&F\\
 G&H\end{bmatrix}=J     Here    J  =  I      J  I    J=I   or   J   J   J   is close to   I   I   I   . The local inverse algorithm is as follows:  (1)    g   e  x      subscript  g    e  x     g_{ex}   . An extrapolated   g   g   g   function is obtained by         g   e  x    |    ∂  G    =    f  |    ∂  F         evaluated-at   subscript  g    e  x      G     evaluated-at  f    F      g_{ex}|_{\partial G}=f|_{\partial F}     (2)    y  0     subscript  y  0    y_{0}   . An approximate   y   y   y   function is calculated by       y  0   =   H   g   e  x          subscript  y  0     H   subscript  g    e  x       y_{0}=Hg_{ex}     (3)    y  ′     superscript  y  normal-′    y^{\prime}   . A correction for   y   y   y   is done by       y  ′   =    y  0   +   y   c  o          superscript  y  normal-′      subscript  y  0    subscript  y    c  o       y^{\prime}=y_{0}+y_{co}     (4)    f  ′     superscript  f  normal-′    f^{\prime}   . A corrected function for   f   f   f   is calculated by       f  ′   =   f  -   B   y  ′          superscript  f  normal-′     f    B   superscript  y  normal-′       f^{\prime}=f-By^{\prime}     (5)    g   1  e  x      subscript  g    1  e  x     g_{1ex}   . An extrapolated   g   g   g   function is obtained by         g   1  e  x    |    ∂  G    =     f  ′   |    ∂  F         evaluated-at   subscript  g    1  e  x      G     evaluated-at   superscript  f  normal-′     F      g_{1ex}|_{\partial G}=f^{\prime}|_{\partial F}     (6)    x  1     subscript  x  1    x_{1}   . A local inverse solution is obtained       x  1   =    E   f  ′    +   F   g   1  e  x           subscript  x  1       E   superscript  f  normal-′      F   subscript  g    1  e  x        x_{1}=Ef^{\prime}+Fg_{1ex}     In the above algorithm, there are two time extrapolations for   g   g   g   functions which are used to overcome the data truncation problem. There is a correction for   y   y   y   . This correction can be a constant correction to correct the DC values of   y   y   y   function or a linear correction according to the prior knowledges about the   y   y   y   function. This algorithm can be found in reference. 2  In the example of reference, 3 it is found that     y  ′   =    y  0   +   y   c  o     =   k   y  0           superscript  y  normal-′      subscript  y  0    subscript  y    c  o            k   subscript  y  0       y^{\prime}=y_{0}+y_{co}=ky_{0}   , here    k  =  1.04      k  1.04    k=1.04   . In that example the constant correction is made. More complicated correction can be made, for example linear correction, which perhaps achieves better results.       A  +   B       superscript  A    B    A^{+}B   is close to   0   0      Shuang-ren Zhao defined a Local inverse 4 to solve the above problem. First consider the simplest solution.      f  =    A  x   +   B  y        f      A  x     B  y      f=Ax+By   or       A  x   =   f  -   B  y    =   f  ′           A  x     f    B  y          superscript  f  normal-′      Ax=f-By=f^{\prime}     Here     f  ′   =   f  -   B  y         superscript  f  normal-′     f    B  y      f^{\prime}=f-By   is the correct data in which there is no the influence of the object function in outside. From this data it is easy to get correct solution,  or       x  ′   =    A   -  1     f  ′         superscript  x  normal-′      superscript  A    1     superscript  f  normal-′      x^{\prime}=A^{-1}f^{\prime}     Here    x  ′     superscript  x  normal-′    x^{\prime}   is a correct(or exact) solution of the unknown   x   x   x   , that means     x  ′   =  x       superscript  x  normal-′   x    x^{\prime}=x   . In case that   A   A   A   is not a square matrix or it has no inverse, generalized inverse can applied,       x  ′   =    A  +    (   f  -   B  y    )    =    A  +    f  ′           superscript  x  normal-′      superscript  A      f    B  y             superscript  A     superscript  f  normal-′       x^{\prime}=A^{+}(f-By)=A^{+}f^{\prime}     Since   y   y   y   is unknown, if it is set to   0   0    , a approximate solution is obtained.       x  0   =    A  +   f        subscript  x  0      superscript  A    f     x_{0}=A^{+}f     On the above solution the result    x  0     subscript  x  0    x_{0}   is related to the unknown vector   y   y   y   . Since   y   y   y   can be any values, this way the result    x  0     subscript  x  0    x_{0}   has very strong artifacts which is       error  0   =   |    x  0   -   x  ′    |   =   |    A  +   B  y   |          subscript  error  0        subscript  x  0    superscript  x  normal-′               superscript  A    B  y       \mathrm{error}_{0}=|x_{0}-x^{\prime}|=|A^{+}By|     This kind of artifact is referred as truncation artifacts in the field of CT image reconstruction. In order to minimize the above artifacts of the solution, a special matrix   Q   Q   Q   is considered, which satisfies       Q  B   =  0        Q  B   0    QB=0     Hence,       Q  A  x   =    Q  f   -   Q  B  y    =   Q  f           Q  A  x       Q  f     Q  B  y           Q  f      QAx=Qf-QBy=Qf     solve the above equation with Generalized inverse       x  1   =     [   Q  A   ]   +   Q  f   =     [  A  ]   +    Q  +   Q  f          subscript  x  1      superscript   delimited-[]    Q  A      Q  f           superscript   delimited-[]  A      superscript  Q    Q  f      x_{1}=[QA]^{+}Qf=[A]^{+}Q^{+}Qf     Here    Q  +     superscript  Q     Q^{+}   is generalized inverse of the matrix   Q   Q   Q   .    x  1     subscript  x  1    x_{1}   is a solution for   x   x   x   . It is easy to find a matrix Q which satisfy     Q  B   =  0        Q  B   0    QB=0   ,   Q   Q   Q   can be written as following:      Q  =   I  -   B   B  +         Q    I    B   superscript  B        Q=I-BB^{+}     This kind of matrix   Q   Q   Q   is referred as transverse projection of matrix   B   B   B     Here    B  +     superscript  B     B^{+}   is the generalized inverse of the matrix   B   B   B   .    B  +     superscript  B     B^{+}   satisfies       B   B  +   B   =  B        B   superscript  B    B   B    BB^{+}B=B     It can be proven that       Q  B   =    [   I  -   B   B  +     ]   B   =   B  -   B   B  +   B    =   B  -  B   =  0          Q  B      delimited-[]    I    B   superscript  B       B          B    B   superscript  B    B           B  B        0     QB=[I-BB^{+}]B=B-BB^{+}B=B-B=0     It is easy to prove that     Q  Q   =  Q        Q  Q   Q    QQ=Q         Q  Q      Q  Q    \displaystyle QQ     and hence       Q  Q  Q   =    (   Q  Q   )   Q   =   Q  Q   =  Q          Q  Q  Q       Q  Q   Q          Q  Q        Q     QQQ=(QQ)Q=QQ=Q     Hence Q is also the generalized inverse of Q  That means        Q  +   Q   =   Q  Q   =  Q           superscript  Q    Q     Q  Q        Q     Q^{+}Q=QQ=Q     Hence,       x  1   =    A  +     [  Q  ]   +   Q  f   =    A  +   Q  f          subscript  x  1      superscript  A     superscript   delimited-[]  Q     Q  f           superscript  A    Q  f      x_{1}=A^{+}[Q]^{+}Qf=A^{+}Qf     or       x  1   =     [  A  ]   +    [   I  -   B   B  +     ]   f        subscript  x  1      superscript   delimited-[]  A      delimited-[]    I    B   superscript  B       f     x_{1}=[A]^{+}[I-BB^{+}]f     The matrix       A  L   =     [  A  ]   +    [   I  -   B   B  +     ]         superscript  A  L      superscript   delimited-[]  A      delimited-[]    I    B   superscript  B          A^{L}=[A]^{+}[I-BB^{+}]       A  L     superscript  A  L    A^{L}   is referred as the local inverse of Matrix    [     A    B      C    D     ]      A  B    C  D     \begin{bmatrix}A&B\\
 C&D\end{bmatrix}   . Using local inverse instead of generalized inverse or inverse can avoid the artifacts from unknown input data. Considering,         [  A  ]   +    [   I  -   B   B  +     ]    f  ′    =     [  A  ]   +    [   I  -   B   B  +     ]    (   f  -   B  y    )    =     [  A  ]   +    [   I  -   B   B  +     ]   f            superscript   delimited-[]  A      delimited-[]    I    B   superscript  B        superscript  f  normal-′       superscript   delimited-[]  A      delimited-[]    I    B   superscript  B         f    B  y             superscript   delimited-[]  A      delimited-[]    I    B   superscript  B       f      [A]^{+}[I-BB^{+}]f^{\prime}=[A]^{+}[I-BB^{+}](f-By)=[A]^{+}[I-BB^{+}]f     Hence there is,       x  1   =     [  A  ]   +    [   I  -   B   B  +     ]    f  ′         subscript  x  1      superscript   delimited-[]  A      delimited-[]    I    B   superscript  B        superscript  f  normal-′      x_{1}=[A]^{+}[I-BB^{+}]f^{\prime}     Hence    x  1     subscript  x  1    x_{1}   is only related the correct data    f  ′     superscript  f  normal-′    f^{\prime}   . This kind error can be calculated as       error  1   =   |    x  1   -   x  ′    |   =   |     [  A  ]   +   B   B  +    f  ′    |          subscript  error  1        subscript  x  1    superscript  x  normal-′               superscript   delimited-[]  A     B   superscript  B     superscript  f  normal-′        \mathrm{error}_{1}=|x_{1}-x^{\prime}|=|[A]^{+}BB^{+}f^{\prime}|     This kind error are called bowl effect. Bowl effect does not related the unknown object   y   y   y   , it is only related the correct data    f  ′     superscript  f  normal-′    f^{\prime}     In case the contribution of      [  A  ]   +   B   B  +    f  ′        superscript   delimited-[]  A     B   superscript  B     superscript  f  normal-′     [A]^{+}BB^{+}f^{\prime}   to   x   x   x   are smaller than that of      [  A  ]   +   B  y       superscript   delimited-[]  A     B  y    [A]^{+}By   , or       error  1   ≪   error  0      much-less-than   subscript  error  1    subscript  error  0     \mathrm{error}_{1}\ll\mathrm{error}_{0}     the local inverse solution    x  1     subscript  x  1    x_{1}   is better than    x  0     subscript  x  0    x_{0}   for this kind of inverse problem. Using    x  1     subscript  x  1    x_{1}   instead of    x  0     subscript  x  0    x_{0}   , the truncation artifacts are replaced as bowl effect. This result is same as local tomography , hence local inverse is a direct extension of the concept of the local tomography.  It is well known that the solution of the generalized inverse is a minimal L2 norm method. From the above derivation it is clear that the solution of local inverse is a minimal L2 norm method subject to the condition that the influence of unknown object   y   y   y   is   0   0    . Hence the local inverse is also an direct extension of the concept of the generalized inverse.  See also   Formulation of the Jacobian conjecture  Interior image reconstruction of CT scans  interior reconstruction  extrapolation  matrix inverse  generalized inverse  iterative refinement  Local tomography   References    "  Category:Inverse functions     Shuangren Zhao, Xintie Yang, ''Iterative reconstruction in all sub-regions '', SCIENCEPAPER ONLINE . 2006; 1(4): page 301–308, http://www.paper.edu.cn/uploads/journal/2007/42/1673-7180(2006)04-0301-08.pdf ↩  Shuangren Zhao, Kang Yang, Dazong Jiang, Xintie Yang, Interior reconstruction using local inverse , J Xray Sci Technol . 2011; 19(1): 69–90 ↩  S. Zhao, D Jaffray, Iterative reconstruction and reprojection for truncated projections , AAPM 2004 , Abstract in Medical Physics 2004 , Volume 31, P1719, http://imrecons.com/wp-content/uploads/2013/02/iterative_extro.pdf ↩      
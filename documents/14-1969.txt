   Trapezoidal rule (differential equations)      Trapezoidal rule (differential equations)   In numerical analysis and scientific computing , the trapezoidal rule is a numerical method to solve ordinary differential equations derived from the trapezoidal rule for computing integrals. The trapezoidal rule is an implicit second-order method, which can be considered as both a Runge–Kutta method and a linear multistep method .  Method  Suppose that we want to solve the differential equation        y  ′   =   f   (  t  ,  y  )     .       superscript  y  normal-′     f   t  y      y^{\prime}=f(t,y).   The trapezoidal rule is given by the formula        y   n  +  1    =    y  n   +     1  2    h   (    f   (   t  n   ,   y  n   )    +   f   (   t   n  +  1    ,   y   n  +  1    )     )      ,       subscript  y    n  1       subscript  y  n       1  2   h      f    subscript  t  n    subscript  y  n       f    subscript  t    n  1     subscript  y    n  1           y_{n+1}=y_{n}+\tfrac{1}{2}h\Big(f(t_{n},y_{n})+f(t_{n+1},y_{n+1})\Big),   where    h  =    t   n  +  1    -   t  n        h     subscript  t    n  1     subscript  t  n      h=t_{n+1}-t_{n}   is the step size. 1  This is an implicit method: the value    y   n  +  1      subscript  y    n  1     y_{n+1}   appears on both sides of the equation, and to actually calculate it, we have to solve an equation which will usually be nonlinear. One possible method for solving this equation is Newton's method . We can use the Euler method to get a fairly good estimate for the solution, which can be used as the initial guess of Newton's method. 2  Motivation  Integrating the differential equation from    t  n     subscript  t  n    t_{n}   to    t   n  +  1      subscript  t    n  1     t_{n+1}   , we find that         y   (   t   n  +  1    )    -   y   (   t  n   )     =    ∫   t  n    t   n  +  1      f   (  t  ,   y   (  t  )    )   d  t     .          y   subscript  t    n  1       y   subscript  t  n       superscript   subscript    subscript  t  n     subscript  t    n  1       f   t    y  t    normal-d  t      y(t_{n+1})-y(t_{n})=\int_{t_{n}}^{t_{n+1}}f(t,y(t))\,\mathrm{d}t.   The trapezoidal rule states that the integral on the right-hand side can be approximated as         ∫   t  n    t   n  +  1      f   (  t  ,   y   (  t  )    )   d  t    ≈     1  2    h   (    f   (   t  n   ,   y   (   t  n   )    )    +   f   (   t   n  +  1    ,   y   (   t   n  +  1    )    )     )     .        superscript   subscript    subscript  t  n     subscript  t    n  1       f   t    y  t    normal-d  t        1  2   h      f    subscript  t  n     y   subscript  t  n        f    subscript  t    n  1      y   subscript  t    n  1           \int_{t_{n}}^{t_{n+1}}f(t,y(t))\,\mathrm{d}t\approx\tfrac{1}{2}h\Big(f(t_{n},y%
 (t_{n}))+f(t_{n+1},y(t_{n+1}))\Big).   Now combine both formulas and use that     y  n   ≈   y   (   t  n   )         subscript  y  n     y   subscript  t  n      y_{n}\approx y(t_{n})   and     y   n  +  1    ≈   y   (   t   n  +  1    )         subscript  y    n  1      y   subscript  t    n  1       y_{n+1}\approx y(t_{n+1})   to get the trapezoidal rule for solving ordinary differential equations. 3  Error analysis  It follows from the error analysis of the trapezoidal rule for quadrature that the local truncation error     τ  n     subscript  τ  n    \tau_{n}   of the trapezoidal rule for solving differential equations can be bounded as:        |   τ  n   |   ≤     1  12     h  3     max  t    |    y  ′′′    (  t  )    |      .         subscript  τ  n        1  12    superscript  h  3     subscript   t        superscript  y  ′′′   t        |\tau_{n}|\leq\tfrac{1}{12}h^{3}\max_{t}|y^{\prime\prime\prime}(t)|.   Thus, the trapezoidal rule is a second-order method. This result can be used to show that the global error is    O   (   h  2   )       O   superscript  h  2     O(h^{2})   as the step size   h   h   h   tends to zero (see big O notation for the meaning of this). 4  Stability  The region of absolute stability for the trapezoidal rule is       {   z  ∈  ℂ   ∣    Re   (  z  )    <  0   }   .     conditional-set    z  ℂ      Re  z   0     \{z\in\mathbb{C}\mid\operatorname{Re}(z)<0\}.   This includes the left-half plane, so the trapezoidal rule is A-stable. The second Dahlquist barrier states that the trapezoidal rule is the most accurate amongst the A-stable linear multistep methods. More precisely, a linear multistep method that is A-stable has at most order two, and the error constant of a second-order A-stable linear multistep method cannot be better than the error constant of the trapezoidal rule. 5  In fact, the region of absolute stability for the trapezoidal rule is precisely the left-half plane. This means that if the trapezoidal rule is applied to the linear test equation y ' = λ y , the numerical solution decays to zero if and only if the exact solution does.  Notes  References    .   .   See also   Crank–Nicolson method   "  Category:Runge–Kutta methods     ; ↩  ↩  ; ↩  ; ↩  ↩     
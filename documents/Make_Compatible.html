<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="8">Make Compatible</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Make Compatible</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p><strong>Make Compatible</strong> is a program developed by <a class="uri" href="Microsoft" title="wikilink">Microsoft</a> that is included with <a href="Windows_9x" title="wikilink">Windows 9x</a> <a href="operating_system" title="wikilink">operating systems</a>. It changes per-program system settings in Windows to allow <a href="Windows_3.1" title="wikilink">Windows 3.1</a> programs that are tailored specifically to that platform to execute under newer versions. The name of the program image file for Make Compatible is , and it is stored in the  directory.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="options">Options</h2>

<p>When it is invoked, one can choose the name of the Windows 3.1 application program image file using the "Choose Program" option on the "File" menu. After the program image file is chosen, Make Compatible by default displays a list of five options that can be set to alter the behaviour of Windows for that program when it is executed:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<ul>
<li>Don't spool to enhanced <a href="Windows_Metafile" title="wikilink">meta files</a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></li>
<li>Give application more stack space<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></li>
<li>Lie about printer device mode size<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
<li>Lie about Windows version number<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
<li>Windows 3.1-style controls<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></li>
</ul>

<p>An advanced options mode, selectable via the "Advanced Options" selection on the "File" menu presents a longer list of options, allowing finer control of Windows 3.1 emulation if the particular application requires it.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h2 id="compatibility-bits">Compatibility bits</h2>

<p>Each of the options is recorded in a system database of so-called "compatibility bits". This is a database of 1-bit flags, one for each of the options displayed by Make Compatible.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>This database already existed in earlier versions of Windows. In Windows 3.1, the database is stored in the <mtpl></mtpl> section of , with entries such as:<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>:</p>
<div class="sourceCode"><pre class="sourceCode INI"><code class="sourceCode ini"><span class="kw">[Compatibility]</span>
<span class="dt">ACAD</span><span class="ot">=</span><span class="dv">0x8000</span>
<span class="dt">AMIPRO</span><span class="ot">=</span><span class="dv">0x04000010</span></code></pre></div>

<p>Each line names an application program, and gives a hexadecimal numeric constant to associate with that program. The hexadecimal numeric constant encodes the compatibility bitflags for that particular application, that Windows applies when the application is executed. Make Compatible merely provides a <a href="graphical_user_interface" title="wikilink">graphical user interface</a> for editing these flags in an easy way, rather than editing  manually, with a text editor. It allows one to set and unset individual flags without having to know their numeric values.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>

<p>The compatibility bitflags settable in  are not documented in the  file that ships with Windows 3.1, or in the <em>Microsoft Windows 3.1 Resource Kit</em> published by Microsoft. They are listed as a simple set of defined constants (with names beginning "GACF_" for "GetAppCompatFlags"), without explanation, in the  <a href="header_file" title="wikilink">header file</a> that is shipped with the Microsoft Windows 3.1 Device driver Development Kit. In Windows 3.1, the compatibility flags that are in effect for any given task in the kernel's Task Database are readable via the undocumented <code>GetAppCompatFlags()</code> function that is exported from the  module.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>
<h2 id="advanced-mode-flags">Advanced mode flags</h2>

<p>The flags are documented in Microsoft KnowledgeBase article #82860. They correspond to the "advanced mode" flags that are settable by Make Compatible's "Advanced Options" menu:<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<dl>
<dt>30 average width metrics:This is bit #19 of the compatibility bits word, with hexadecimal value <code>0x80000</code>, known by the symbolic name <code>GACF_30AVGWIDTH</code> in . This flag causes Windows to re-scale all fonts by a factor of 

<math display="inline" id="Make_Compatible:0">
 <semantics>
  <mrow>
   <mn>7</mn>
   <mo>/</mo>
   <mn>8</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">7</cn>
    <cn type="integer">8</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   7/8
  </annotation>
 </semantics>
</math>

 when calculating their average character widths. The reason for this is that one particular Windows 3.0 application, <a class="uri" href="TurboTax" title="wikilink">TurboTax</a>, hard-coded the values that it was using for such size calculations, which failed to work correctly with the new <a class="uri" href="TrueType" title="wikilink">TrueType</a>-compatible font average width calculation method employed by Windows 3.1. This prevented people from using TurboTax to print their <a href="income_tax" title="wikilink">income tax</a> return forms on <a class="uri" href="PostScript" title="wikilink">PostScript</a> printers.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a><br/>
Always send NC_Paint:This is bit #6 of the compatibility bits word, with hexadecimal value <code>0x40</code>, known by the symbolic name <code>GACF_ALWAYSSENDNCPAINT</code> in . This flag forces any call to <code>SetWindowPos()</code> to cause the sending of <code>WM_NCPAINT</code> message to all child windows. This is the Windows 3.0 behaviour. In Windows 3.1, the behaviour was changed so that the window message is only sent to those windows that need their non-client areas to be repainted. Some Windows 3.0 applications, however, relied upon always receiving this message, to determine whether child windows needed repositioning.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><br/>
Don't enum device fonts:This is bit #14 of the compatibility bits word, with hexadecimal value <code>0x4000</code>, known by the symbolic name <code>GACF_ENUMTTNOTEDEVICE</code> in . This flag causes Windows 3.1 to turn the <code>DEVICE_FONTTYPE</code> flag off in particular circumstances when an application that is wanting to print enumerates fonts. The particular circumstances are when the target printer is not either a <a href="dot_matrix_printer" title="wikilink">dot matrix printer</a> or a PostScript printer, and the fonts are TrueType fonts that are not resident in the printer itself. In such circumstances, some applications (including <a class="uri" href="PageMaker" title="wikilink">PageMaker</a> and <a class="uri" href="MGXDraw" title="wikilink">MGXDraw</a>) misinterpret the flag and believe the font to be device-resident. (TrueType fonts can be uploaded by Windows to printers, and need not be resident on the device itself to be usable.) They then query the printer to see what sizes of the font it supports, and when that fails (because the printer doesn't know about the font until it is uploaded), they incorrectly assume that the font cannot be resized. Setting the <code>DEVICE_FONTTYPE</code> flag to false in such situations prevents the applications from going wrong, and that is what this compatibility bitflag does.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><br/>
Don't send calcsize <code>WM_MOVE</code>:This is bit #17 of the compatibility bits word, with hexadecimal value <code>0x20000</code>, known by the symbolic name <code>GACF_NCCALCSIZEONMOVE</code> in . This flag forces the <code>WM_NCCALCSIZE</code> message to be sent to a window that is being moved or resized. This is the Windows 3.0 behaviour. In Windows 3.1, the behaviour was changed so that the window message is only sent to those windows that were being resized. It was not sent if the window was merely moved. Some Windows 3.0 applications, however, such as <a href="Lotus_Notes" title="wikilink">Lotus Notes</a> for example, relied upon always receiving this message.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a><br/>
Enum Helv and Times Roman fonts:This is bit #12 of the compatibility bits word, with hexadecimal value <code>0x1000</code>, known by the symbolic name <code>GACF_ENUMHELVTMSRMN</code> in . This flag works around a problem with applications that refused to work properly unless fonts with the exact names "Helv" and "Tms Rmn" were listed as present on the system by the Windows font enumeration API. The names are trademarks of <a href="Mergenthaler_Linotype_Company" title="wikilink">Linotype company</a> for particular fonts, <a class="uri" href="Helvetica" title="wikilink">Helvetica</a> and <a href="Times_Roman" title="wikilink">Times Roman</a>, and since Microsoft didn't ship those Linotype fonts with Windows 3.1, it could not enumerate them as present. This flag causes Windows to enumerate the "MS Sans Serif" and "MS Serif" fonts under the names "Helv" and "Tms Rmn", for compatibility with the applications that don't work without those exact names being used.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a><br/>
Force extra windows words:This is bit #8 of the compatibility bits word, with hexadecimal value <code>0x100</code>, known by the symbolic name <code>GACF_MOREEXTRAWNDWORDS</code> in . This flag works around a problem with applications that assumed the existence of window words (extra items of data associated by Windows with GUI windows) when they had not in fact informed Windows that extra window words were required. Windows 3.1, unlike Windows 3.0, <a href="bounds_checking" title="wikilink">bounds checks</a> all uses of extra window words, and applications that assumed that they could use more space than they had asked for would thus fail. For applications run with this flag set, Windows 3.1 silently increased the total number of words requested by the application by an extra 4 bytes.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a><br/>
Force printer text to new band:This is bit #1 of the compatibility bits word, with hexadecimal value <code>0x2</code>, known by the symbolic name <code>GACF_FORCETEXTBAND</code> in . This flag causes Windows 3.1 to always use two bands when printing, the first for graphics and the second for text. Normally Windows 3.1 tries to print both in a single band. But applications such as WordPerfect assumed that a second band would always exist, and would always be where the text was, as had been the case in Windows 3.0. Freelance Graphics had a similar problem.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a><br/>
Force TT fonts to graphics band:This is bit #15 of the compatibility bits word, with hexadecimal value <code>0x8000</code>, known by the symbolic name <code>GACF_FORCETTGRAPHICS</code> in . This flag was to work around a problem with <a href="Freelance_Graphics" title="wikilink">Freelance Graphics</a>, where it wouldn't print using TrueType fonts unless they were printed as graphics.<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a><br/>
Global hooks only called for Win16 apps:<br/>
Ignore discardable segment attributes:This is bit #0 of the compatibility bits word, with hexadecimal value <code>0x1</code>, known by the symbolic name <code>GACF_IGNORENODISCARD</code> in . This flag forces the <code>GEM_NODISCARD</code> flag passed to <code>GlobalAlloc()</code> by a program to be ignored. It worked around a bug in the run-time library supplied with Microsoft's own <a href="C_(programming_language)" title="wikilink">C</a> compiler, <a href="Microsoft_C" title="wikilink">Microsoft C</a> version 6. The run-time library would erroneously set that flag in calls to <code>GlobalAlloc()</code>, and any application compiled with that compiler would thus exhibit the behaviour.<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a><br/>
Ignore raster fonts:This is bit #9 of the compatibility bits word, with hexadecimal value <code>0x200</code>, known by the symbolic name <code>GACF_TTIGNORERASTERDUPE</code> in . This flag prevents fonts of the same sizes from being enumerated as both bitmap and TrueType fonts. This was because several applications, including <a class="uri" href="WordPerfect" title="wikilink">WordPerfect</a> and <a href="Visual_Basic" title="wikilink">Visual Basic</a>, were not capable of handling that particular situation correctly.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a><br/>
Ignore topmost windows:This is bit #3 of the compatibility bits word, with hexadecimal value <code>0x8</code>, known by the symbolic name <code>GACF_IGNORETOPMOST</code> in . This flag fixes a particular problem with <a class="uri" href="cc:Mail" title="wikilink">cc:Mail</a> that caused it to fail on Windows 3.1. It assumed that accessing the first window with <code>GetWindow(HWND,GW_HWND_FIRST)</code> would return it the window of the application that it had just started with <code>WinExec()</code>. But on Windows 3.1, which introduced the idea of "topmost" windows, this was no longer true. The flag caused Windows 3.1 to skip topmost windows when that particular API request was made.<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a><br/>
Module specific hack:<br/>
No HRGN 1:This is bit #16 of the compatibility bits word, with hexadecimal value <code>0x10000</code>, known by the symbolic name <code>GACF_NOHRGN1</code> in . This flag reinstates a bug that existed in Windows 3.0 that was fixed in Windows 3.1. It did so because several applications, such as <a href="Microsoft_Draw" title="wikilink">Microsoft Draw</a>, worked around the bug themselves, and would fail to work correctly when the bug was eliminated. The bug was an error in the return value of the <code>GetUpdateRect()</code> function, whereby in certain situations (where the entire window was invalid) it would return the coördinates of the update rectangle in window coördinates, rather than in logical coördinates as it was supposed to. In Windows 3.1, it always returned the update rectangle in logical coördinates. The applications that worked around the bug would perform the coördinate transform themselves to work around the bug, and end up updating the wrong parts of their windows on Windows 3.1.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a><br/>
One graphic band and use print escapes:This is bit #2 of the compatibility bits word, with hexadecimal value <code>0x4</code>, known by the symbolic name <code>GACF_ONELANDGRXBAND</code> in . This flag causes Windows 3.1 to use a single graphics band when printing in <a href="Landscape_mode" title="wikilink">Landscape mode</a>, consuming as much memory as needed for that band, and discarding whatever content would not fit into the band.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a><br/>
Subtract clip siblings:This is bit #14 of the compatibility bits word, with hexadecimal value <code>0x4000</code>, known by the symbolic name <code>GACF_SUBTRACTCLIPSIBS</code> in . This flag causes Windows 3.1 to handle window invalidation differently for top-level windows that do not have the <code>WS_CLIPSIBLINGS</code> window style set, and their chlid windows. (In other words: It affects dialogue boxes and the controls on them.) With the flag set, Windows would not invalidate sibling child windows underneath (in the <a class="uri" href="z-order" title="wikilink">z-order</a>) other <code>WS_CLIPSIBLINGS</code> child windows. The main reason for the flag was applications such as Lotus Notes 2.1, which implemented its own <a href="combo_box" title="wikilink">combo boxes</a> as child windows, rather than as top-level windows (the system default combo box implementation). With this flag set, odd display problems with such windows would disappear.<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a><br/>
Support multiple printing bands:This is bit #5 of the compatibility bits word, with hexadecimal value <code>0x20</code>, known by the symbolic name <code>GACF_MULTIPLEBANDS</code> in . This flag causes Windows 3.1 to always use multiple bands for printing, even when one band would be sufficient. This was to work around a problem in Freelance Graphics, which would assume that if only one band existed, and it was the entire page, it was the text band, and would not even attempt to print graphics. On Windows 3.1, the universal printer driver would sometimes be able to handle both text and graphics with a single band. By forcing the use of multiple bands, the problems that this would cause for Freelance Graphics were avoided.<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a><br/>
TT fonts are device fonts:This is bit #4 of the compatibility bits word, with hexadecimal value <code>0x10</code>, known by the symbolic name <code>GACF_CALLTTDEVICE</code> in . This flag causes Windows 3.1 to always set the <code>DEVICE_FONTTYPE</code> flag on any TrueType fonts that are enumerated using the Windows <code>EnumFont()</code> API. This was to fix a problem with applications including <a class="uri" href="AmiPro" title="wikilink">AmiPro</a> and WordPerfect, both of which assumed that all TrueType fonts available on a printer would be device-resident.<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a><br/>
Windows 3.1 palette behavior:</dt>
</dl>
<h2 id="additional-flags">Additional flags</h2>

<p>Windows 3.1 defined 20 application compatibility flags.<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a> Windows 95 and 98 defined a further 11 flags, not documented in the KnowledgeBase article and not assigned symbolic constant names in , which are the remainder of the options accessible via the "Advanced Options" menu in Make Compatible:<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a></p>
<dl>
<dt>Disable 16 color brush cache and 55ms timer:This is bit #29 of the compatibility bits word, with hexadecimal value <code>0x20000000</code>.<br/>
Disable EMF spooling:This is bit #26 of the compatibility bits word, with hexadecimal value <code>0x4000000</code>.<br/>
Disable font associations:This is bit #24 of the compatibility bits word, with hexadecimal value <code>0x1000000</code>.<br/>
Don't attach input thread when journaling, <code>SetActiveWindow</code> == <code>SetForeGroundWindow</code>:This is bit #28 of the compatibility bits word, with hexadecimal value <code>0x10000000</code>.<br/>
Don't Shutdown/Ignore certain faults/dequote commandline:This is bit #25 of the compatibility bits word, with hexadecimal value <code>0x2000000</code>.<br/>
Enable 3.x UI features:This is bit #27 of the compatibility bits word, with hexadecimal value <code>0x8000000</code>.<br/>
Force Win31 printer dev mode size:This is bit #23 of the compatibility bits word, with hexadecimal value <code>0x800000</code>.<br/>
Increase stack size:This is bit #22 of the compatibility bits word, with hexadecimal value <code>0x400000</code>.<br/>
Lie about device caps/no <code>SetDIBits</code> validation:This is bit #20 of the compatibility bits word, with hexadecimal value <code>0x100000</code>.<br/>
Lie about windows version:This is bit #21 of the compatibility bits word, with hexadecimal value <code>0x200000</code>.<br/>
Mirror fonts in :This is bit #30 of the compatibility bits word, with hexadecimal value <code>0x40000000</code>.</dt>
</dl>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li><mtpl></mtpl></li>
</ul>

<p>"</p>

<p><a href="Category:Windows_95" title="wikilink">Category:Windows 95</a> <a href="Category:Windows_components" title="wikilink">Category:Windows components</a> <a href="Category:Computer_configuration" title="wikilink">Category:Computer configuration</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"></li>
<li id="fn18"></li>
<li id="fn19"></li>
<li id="fn20"></li>
<li id="fn21"></li>
<li id="fn22"></li>
<li id="fn23"></li>
<li id="fn24"></li>
<li id="fn25"></li>
<li id="fn26"></li>
<li id="fn27"></li>
<li id="fn28"></li>
<li id="fn29"></li>
<li id="fn30"></li>
<li id="fn31"></li>
<li id="fn32"></li>
<li id="fn33"></li>
<li id="fn34"></li>
<li id="fn35"><a href="#fnref35">↩</a></li>
</ol>
</section>
</body>


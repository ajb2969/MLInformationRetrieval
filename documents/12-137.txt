   Trace Zero Cryptography      Trace Zero Cryptography   In 1998 Gerhard Frey firstly proposed using trace zero varieties for cryptographic purpose. These varieties are subgroups of the divisor class group on a low genus hyperelliptic curve defined over a finite field . These groups can be used to establish asymmetric cryptography using the discrete logarithm problem as cryptographic primitive.  Trace zero varieties feature a better scalar multiplication performance than elliptic curves. This allows a fast arithmetic in this groups, which can speed up the calculations with a factor 3 compared with elliptic curves and hence speed up the cryptosystem.  Another advantage is that for a groups of cryptographically relevant size, the order of the group can simply be calculated using the characteristic polynomial of the Frobenius endomorphism. This is not the case, for example, in elliptic curve cryptography when the group of points of an elliptic curve over a prime field is used for cryptographic purpose.  However to represent an element of the trace zero variety more bits are needed compared with elements of elliptic or hyperelliptic curves. Another disadvantage, is the fact, that it is possible to reduce the security of the TZV of 1 / 6 th of the bit length using cover attack.  Mathematical background  A hyperelliptic curve  C of genus g over a prime field    𝔽  q     subscript  𝔽  q    \mathbb{F}_{q}   where q = p n ( p prime) of odd characteristic is defined as       C  :     y  2   +   h   (  x  )   y    =   f   (  x  )      ,     normal-:  C       superscript  y  2     h  x  y      f  x      C:~{}y^{2}+h(x)y=f(x),     where f monic, deg( f ) = 2 g + 1 and deg( h ) ≤ g. The curve has at least one    𝔽  q     subscript  𝔽  q    \mathbb{F}_{q}   -rational Weierstraßpoint.  The Jacobian variety      J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   of C is for all finite extension    𝔽   q  n      subscript  𝔽   superscript  q  n     \mathbb{F}_{q^{n}}   isomorphic to the ideal class group    Cl   (   C  /   𝔽   q  n     )      Cl    C   subscript  𝔽   superscript  q  n       \operatorname{Cl}(C/\mathbb{F}_{q^{n}})   . With the Mumford's representation it is possible to represent the elements of     J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   with a pair of polynomials [u, v] , where u , v ∈     𝔽   q  n     [  x  ]        subscript  𝔽   superscript  q  n     delimited-[]  x     \mathbb{F}_{q^{n}}[x]   .  The Frobenius endomorphism σ is used on an element [u, v] of     J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   to raise the power of each coefficient of that element to q : σ( [u, v] ) = [ u q (x), v q (x)]. The characteristic polynomial of this endomorphism has the following form:        χ   (  T  )    =    T   2  g    +    a  1    T    2  g   -  1     +  ⋯  +    a  g    T  g    +  ⋯  +    a  1    q   g  -  1    T   +   q  g     ,        χ  T      superscript  T    2  g       subscript  a  1    superscript  T      2  g   1     normal-⋯     subscript  a  g    superscript  T  g    normal-⋯     subscript  a  1    superscript  q    g  1    T    superscript  q  g      \chi(T)=T^{2g}+a_{1}T^{2g-1}+\cdots+a_{g}T^{g}+\cdots+a_{1}q^{g-1}T+q^{g},   where a i in  With the Hasse–Weil theorem it is possible to receive the group order of any extension field    𝔽   q  n      subscript  𝔽   superscript  q  n     \mathbb{F}_{q^{n}}   by using the complex roots τ i of χ( T ):       |    J  C    (   𝔽   q  n    )    |   =    ∏   i  =  1    2  g     (   1  -   τ  i  n    )             subscript  J  C    subscript  𝔽   superscript  q  n        superscript   subscript  product    i  1      2  g      1   superscript   subscript  τ  i   n       |J_{C}(\mathbb{F}_{q^{n}})|=\prod_{i=1}^{2g}(1-\tau_{i}^{n})     Let D be an element of the     J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   of C , then it is possible to define an endomorphism of     J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   , the so-called trace of D :       Tr   (  D  )    =    ∑   i  =  0    n  -  1      σ  i    (  D  )     =   D  +   σ   (  D  )    +  ⋯  +    σ   n  -  1     (  D  )            Tr  D     superscript   subscript     i  0      n  1       superscript  σ  i   D           D    σ  D   normal-⋯     superscript  σ    n  1    D       \operatorname{Tr}(D)=\sum_{i=0}^{n-1}\sigma^{i}(D)=D+\sigma(D)+\cdots+\sigma^{%
 n-1}(D)     Based on this endomorphism one can reduce the Jacobian variety to a subgroup G with the property, that every element is of trace zero:      G  =   {  D  ∈   J  C    (   𝔽   q  n    )   |  Tr   (  D  )   =  0  }   ,   (   0  neutral element in    J  C    (   𝔽   q  n    )       fragments  G    fragments  normal-{  D    subscript  J  C    fragments  normal-(   subscript  𝔽   superscript  q  n    normal-)   normal-|  Tr   fragments  normal-(  D  normal-)    0  normal-}   normal-,   fragments  normal-(  0 neutral element in   subscript  J  C    fragments  normal-(   subscript  𝔽   superscript  q  n    normal-)      G=\{D\in J_{C}(\mathbb{F}_{q^{n}})~{}|~{}\text{Tr}(D)=\textbf{{0}}\},~{}~{}~{}%
 (\textbf{{0}}\text{ neutral element in }J_{C}(\mathbb{F}_{q^{n}})     G is the kernel of the trace endomorphism and thus G is a group, the so-called trace zero (sub)variety (TZV) of     J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   .  The intersection of G and     J  C    (   𝔽  q   )        subscript  J  C    subscript  𝔽  q     J_{C}(\mathbb{F}_{q})   is produced by the n -torsion elements of     J  C    (   𝔽  q   )        subscript  J  C    subscript  𝔽  q     J_{C}(\mathbb{F}_{q})   . If the greatest common divisor     gcd   (  n  ,   |    J  C    (   𝔽  q   )    |   )    =  1        n       subscript  J  C    subscript  𝔽  q      1    \gcd(n,|J_{C}(\mathbb{F}_{q})|)=1   the intersection is empty and one can compute the group order of G :       |  G  |   =    |    J  C    (   𝔽   q  n    )    |    |    J  C    (   𝔽  q   )    |    =     ∏   i  =  1    2  g     (   1  -   τ  i  n    )      ∏   i  =  1    2  g     (   1  -   τ  i    )             G          subscript  J  C    subscript  𝔽   superscript  q  n           subscript  J  C    subscript  𝔽  q               superscript   subscript  product    i  1      2  g      1   superscript   subscript  τ  i   n       superscript   subscript  product    i  1      2  g      1   subscript  τ  i         |G|=\dfrac{|J_{C}(\mathbb{F}_{q^{n}})|}{|J_{C}(\mathbb{F}_{q})|}=\dfrac{\prod_%
 {i=1}^{2g}(1-\tau_{i}^{n})}{\prod_{i=1}^{2g}(1-\tau_{i})}     The actual group used in cryptographic applications is a subgroup G 0 of G of a large prime order l . This group may be G itself. 1 2  There exist three different cases of cryptograpghical relevance for TZV: 3   g = 1, n = 3  g = 1, n = 5  g = 2, n = 3   Arithmetic  The arithmetic used in the TZV group G 0 based on the arithmetic for the whole group     J  C    (   𝔽   q  n    )        subscript  J  C    subscript  𝔽   superscript  q  n      J_{C}(\mathbb{F}_{q^{n}})   , But it is possible to use the Frobenius endomorphism σ to speed up the scalar multiplication. This can be archived if G 0 is generated by D of order l then σ(D) = sD , for some integers s . For the given cases of TZV s can be computed as follows, where a i come from the characteristic polynomial of the Frobenius endomorphism :   For g = 1, n = 3    s  =     q  -  1    1  -   a  1     mod  ℓ       s   modulo      q  1     1   subscript  a  1     normal-ℓ     s=\dfrac{q-1}{1-a_{1}}\bmod{\ell}       For g = 1, n = 5    s  =       q  2   -  q  -    a  1  2   q    +    a  1   q   +  1        q  -   2   a  1   q    +   a  1  3    -   a  1  2    +   a  1    -  1    mod  ℓ       s   modulo         superscript  q  2   q     superscript   subscript  a  1   2   q       subscript  a  1   q   1             q    2   subscript  a  1   q     superscript   subscript  a  1   3     superscript   subscript  a  1   2     subscript  a  1    1    normal-ℓ     s=\dfrac{q^{2}-q-a_{1}^{2}q+a_{1}q+1}{q-2a_{1}q+a_{1}^{3}-a_{1}^{2}+a_{1}-1}%
 \bmod{\ell}       For g = 2, n = 3    s  =    -      q  2   -   a  2    +   a  1        a  1   q   -   a  2    +  1     mod  ℓ       s   modulo           superscript  q  2    subscript  a  2     subscript  a  1           subscript  a  1   q    subscript  a  2    1     normal-ℓ     s=-\dfrac{q^{2}-a_{2}+a_{1}}{a_{1}q-a_{2}+1}\bmod{\ell}      Knowing this, it is possible to replace any scalar multiplication mD (|m| ≤ l/2) with:          m  0   D   +    m  1   σ   (  D  )    +  ⋯  +    m   n  -  1     σ   n  -  1     (  D  )     ,   where   m  i     =   O   (   ℓ   1  /   (   n  -  1   )     )    =   O   (   q  g   )                subscript  m  0   D      subscript  m  1   σ  D   normal-⋯     subscript  m    n  1     superscript  σ    n  1    D      where   subscript  m  i       O   superscript  normal-ℓ    1    n  1             O   superscript  q  g       m_{0}D+m_{1}\sigma(D)+\cdots+m_{n-1}\sigma^{n-1}(D),~{}~{}~{}~{}\text{where }m%
 _{i}=O(\ell^{1/(n-1)})=O(q^{g})     With this trick the multiple scalar product can be reduced to about 1/( n − 1) th of doublings necessary for calculating mD , if the implied constants are small enough. 4 5  Security  The security of cryptographic systems based on trace zero subvarieties according of the results of the papers 6 7 comparable to the security of hyper-elliptic curves of low genus ''g' '' over    𝔽   p  ′      subscript  𝔽   superscript  p  normal-′     \mathbb{F}_{p^{\prime}}   , where ''p' '' ~ ( n − 1)(''g/g' '') for |G| ~128 bits.  For the cases where n = 3, g = 2 and n = 5, g = 1 it is possible to reduce the security for at most 6 bits, where |G| ~ 2 256 , because one can not be sure that G is contained in a Jacobian of a curve of genus 6. The security of curves of genus 4 for similar fields are far less secure.  Cover attack on a trace zero crypto-system  The attack published in 8 shows, that the DLP in trace zero groups of genus 2 over finite fields of characteristic diverse than 2 or 3 and a field extension of degree 3 can be transformed into a DLP in a class group of degree 0 with genus of at most 6 over the base field. In this new class group the DLP can be attacked with the index calculus methods. This leads to a reduction of the bit length 1 / 6 th .  Notes  References   G. Frey and T. Lange: "Mathematical background of public key cryptography", Technical report, 2005  R. M. Avanzi and E. Cesena: "Trace zero varieties over ﬁelds of characteristic 2 for cryptographic applications", Technical report, 2007  T. Lange: "Trace zero subvariety for cryptosystems", Technical report, 2003, http://eprint.iacr.org/2003/094 , 2003  C. Diem and J. Scholten: "An attack on a trace-zero cryptosystem"  M. Wienecke: "Cryptography on Trace-Zero Varieties", ITS-Seminar paper, http://www.crypto.rub.de/its_seminar_ws0708.html , 2008  A. V. Sutherland: "101 useful trace zero varieties", http://www-math.mit.edu/~drew/TraceZeroVarieties.html , 2007   "  Category:Cryptography     G. Frey and T. Lange: "Mathematical background of public key cryptography" ↩  T. Lange: "Trace zero subvariety for cryptosystems" ↩  R. M. Avanzi and E. Cesena: "Trace zero varieties over ﬁelds of characteristic 2 for cryptographic applications" ↩  R. M. Avanzi and E. Cesena: "Trace zero varieties over ﬁelds of characteristic 2 for cryptographic applications" ↩  T. Lange: "Trace zero subvariety for cryptosystems" ↩  T. Lange: "Trace zero subvariety for cryptosystems" ↩  R. M. Avanzi and E. Cesena: "Trace zero varieties over ﬁelds of characteristic 2 for cryptographic applications" ↩  C. Diem and J. Scholten: "An attack on a trace-zero cryptosystem" ↩     
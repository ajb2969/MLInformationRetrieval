<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1842">Differential optical absorption spectroscopy</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Differential optical absorption spectroscopy</h1>
<hr/>

<p>In <a href="atmospheric_chemistry" title="wikilink">atmospheric chemistry</a>, <strong>differential optical absorption spectroscopy (DOAS)</strong> is used to measure concentrations of <a href="trace_gases" title="wikilink">trace gases</a>. When combined with basic optical spectrometers such as prisms or diffraction gratings and automated, ground-based observation platforms, what we have is a cheap and powerful means for the measurement of such trace gas species as <a class="uri" href="ozone" title="wikilink">ozone</a> and <a href="nitrogen_dioxide" title="wikilink">nitrogen dioxide</a>.</p>
<figure><b>(Figure)</b>
<figcaption>Long-path DOAS System at the Cape Verde Atmospheric Observatory (CVAO) at <a href="São_Vicente_(Cape_Verde)" title="wikilink">São Vicente</a>, <a href="Cape_Verde" title="wikilink">Cape Verde</a></figcaption>
</figure>
<h2 id="theory">Theory</h2>

<p>DOAS instruments are often divided into two main groups: passive and active ones. The active DOAS system such as longpath(LP)-systems and cavity-enhanced(CE) DOAS systems have their own light-source, whereas passive ones use the sun as their light source, e.g. MAX(Multi-axial)-DOAS. Also the moon can be used for night-time DOAS measurements, but here usually direct light measurements need to be done instead of scattered light measurements as it is the case for passive DOAS systems such as the MAX-DOAS.</p>

<p>The change in intensity of a beam of radiation as it travels through a medium that is not emitting is given by <a href="Beers_law" title="wikilink">Beers law</a>:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:0">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <msub>
          <mi>ρ</mi>
          <mi>i</mi>
         </msub>
         <mpadded width="+1.7pt">
          <msub>
           <mi>β</mi>
           <mi>i</mi>
          </msub>
         </mpadded>
         <mi>d</mi>
         <mi>s</mi>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>I</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ρ</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>i</ci>
         </apply>
         <ci>d</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I=I_{0}\exp\left(\sum_{i}\int\rho_{i}\beta_{i}\,ds\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>I</em> is the <a href="intensity_(physics)" title="wikilink">intensity</a> of the <a class="uri" href="radiation" title="wikilink">radiation</a>, 

<math display="inline" id="Differential_optical_absorption_spectroscopy:1">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="density" title="wikilink">density</a> of <a href="chemical_substance" title="wikilink">substance</a>, 

<math display="inline" id="Differential_optical_absorption_spectroscopy:2">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 is the <a href="absorption_(electromagnetic_radiation)" title="wikilink">absorption</a> and <a class="uri" href="scattering" title="wikilink">scattering</a> <a href="cross_section_(physics)" title="wikilink">cross section</a> and <em>s</em> is the path. The subscript <em>i</em> denotes different species, assuming that the medium is composed of multiple substances. Several simplifications can be made. The first is to pull the absorption cross section out of the <a class="uri" href="integral" title="wikilink">integral</a> by assuming that it does not change significantly with the path—i.e. that it is a <a href="constant_(mathematics)" title="wikilink">constant</a>. Since the DOAS method is used to measure total <a href="column_density" title="wikilink">column density</a>, and not density per se, the second is to take the integral as a single parameter which we call <a href="column_density" title="wikilink">column density</a>:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:3">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>ρ</mi>
     </mpadded>
     <mi>d</mi>
     <mi>s</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>σ</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <ci>d</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma=\int\rho\,ds
  </annotation>
 </semantics>
</math>

</p>

<p>The new, considerably simplified <a class="uri" href="equation" title="wikilink">equation</a> now looks like this:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:4">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <msub>
         <mi>β</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>σ</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mi>i</mi>
     </munder>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>β</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>σ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>I</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>i</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I=I_{0}\exp\left(\sum_{i}\beta_{i}\sigma_{i}\right)=I_{0}\prod_{i}e^{\beta_{i}%
\sigma_{i}}
  </annotation>
 </semantics>
</math>

</p>

<p>If that was all there was to it, given any spectrum with sufficient <a href="spectral_resolution" title="wikilink">resolution</a> and spectral features, all the species could be solved for by simple <a href="invertible_matrix" title="wikilink">algebraic inversion</a>. Active DOAS variants can use the spectrum of the lightsource itself as reference. Unfortunately for passive measurements, where we are measuring from the bottom of the <a class="uri" href="atmosphere" title="wikilink">atmosphere</a> and not the top, there is no way to determine the initial intensity, <em>I</em><sub>0</sub>. Rather, what is done is to take the ratio of two measurements with different paths through the atmosphere and so determine the difference in <a href="optical_depth" title="wikilink">optical depth</a> between the two columns (Alternative a solar atlas can be employed, but this introduces another important error source to the fitting process, the instrument function itself. If the reference spectrum itself is also recorded with the same setup, these effects will eventually cancel out):</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:5">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mo>=</mo>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <msub>
       <mi>I</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>I</mi>
       <mn>2</mn>
      </msub>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>σ</mi>
        <mrow>
         <mi>i</mi>
         <mn>2</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>σ</mi>
        <mrow>
         <mi>i</mi>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>σ</mi>
     <mi>i</mi>
    </msub>
    <mpadded width="+1.7pt">
     <msub>
      <mi>β</mi>
      <mi>i</mi>
     </msub>
    </mpadded>
    <mi mathvariant="normal">Δ</mi>
    <msub>
     <mi>σ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>δ</ci>
     <apply>
      <ln></ln>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>β</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta=\ln\left(\frac{I_{1}}{I_{2}}\right)=\sum_{i}\beta_{i}\left(\sigma_{i2}-%
\sigma_{i1}\right)=\sigma_{i}\beta_{i}\,\Delta\sigma_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>A significant component of a measured spectrum is often given by scattering and continuum components that have a smooth variation with respect to <a class="uri" href="wavelength" title="wikilink">wavelength</a>. Since these don't supply much information, the spectrum can be divided into two parts:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:6">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>I</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>i</mi>
       </munder>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msubsup>
           <mi>β</mi>
           <mi>i</mi>
           <mo>*</mo>
          </msubsup>
          <mo>+</mo>
          <msub>
           <mi>α</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msub>
         <mi>σ</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>I</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>β</ci>
           <ci>i</ci>
          </apply>
          <times></times>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>α</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I=I_{0}\exp\left[\sum_{i}\left(\beta_{i}^{*}+\alpha_{i}\right)\sigma_{i}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Differential_optical_absorption_spectroscopy:7">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 is the continuum component of the spectrum and 

<math display="inline" id="Differential_optical_absorption_spectroscopy:8">
 <semantics>
  <msup>
   <mi>β</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>β</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta^{*}
  </annotation>
 </semantics>
</math>

 is that which remains and we shall call the differential cross-section. Therefore:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:9">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mi>d</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>δ</mi>
     <mi>c</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <msub>
        <mi>I</mi>
        <mrow>
         <mn>1</mn>
         <mi>d</mi>
        </mrow>
       </msub>
       <msub>
        <mi>I</mi>
        <mrow>
         <mn>2</mn>
         <mi>d</mi>
        </mrow>
       </msub>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <msub>
        <mi>I</mi>
        <mrow>
         <mn>1</mn>
         <mi>c</mi>
        </mrow>
       </msub>
       <msub>
        <mi>I</mi>
        <mrow>
         <mn>2</mn>
         <mi>c</mi>
        </mrow>
       </msub>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>β</mi>
        <mi>i</mi>
        <mo>*</mo>
       </msubsup>
       <mo>+</mo>
       <msub>
        <mi>α</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>σ</mi>
        <mrow>
         <mi>i</mi>
         <mn>2</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>σ</mi>
        <mrow>
         <mi>i</mi>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <msubsup>
       <mi>β</mi>
       <mi>i</mi>
       <mo>*</mo>
      </msubsup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>σ</mi>
         <mrow>
          <mi>i</mi>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>σ</mi>
         <mrow>
          <mi>i</mi>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi>i</mi>
     </munder>
     <mrow>
      <msub>
       <mi>α</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>σ</mi>
         <mrow>
          <mi>i</mi>
          <mn>2</mn>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>σ</mi>
         <mrow>
          <mi>i</mi>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <times></times>
          <cn type="integer">1</cn>
          <ci>d</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <times></times>
          <cn type="integer">1</cn>
          <ci>c</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>c</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>i</ci>
         </apply>
         <times></times>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>β</ci>
          <ci>i</ci>
         </apply>
         <times></times>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>α</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <apply>
           <times></times>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{d}+\delta_{c}=\ln\left(\frac{I_{1d}}{I_{2d}}\right)+\ln\left(\frac{I_{%
1c}}{I_{2c}}\right)=\sum\left(\beta_{i}^{*}+\alpha_{i}\right)\left(\sigma_{i2}%
-\sigma_{i1}\right)=\sum_{i}\beta_{i}^{*}\left(\sigma_{i2}-\sigma_{i1}\right)+%
\sum_{i}\alpha_{i}\left(\sigma_{i2}-\sigma_{i1}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where we call 

<math display="inline" id="Differential_optical_absorption_spectroscopy:10">
 <semantics>
  <msub>
   <mi>δ</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>δ</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{d}
  </annotation>
 </semantics>
</math>

 the differential optical depth (DOD). Removing the continuum components and adding in the wavelength dependence produces a matrix equation with which to do the inversion:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:11">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>δ</mi>
     <mi>d</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>λ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>σ</mi>
     <mi>i</mi>
    </msub>
    <msubsup>
     <mi>β</mi>
     <mi>i</mi>
     <mo>*</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>λ</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">Δ</mi>
    <msub>
     <mi>σ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>δ</ci>
      <ci>d</ci>
     </apply>
     <ci>λ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>i</ci>
      </apply>
      <times></times>
     </apply>
     <ci>λ</ci>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta_{d}(\lambda)=\sigma_{i}\beta_{i}^{*}(\lambda)\,\Delta\sigma_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>What this means is that before performing the inversion, the continuum components from both the optical depth and from the species cross sections must be removed. This is the important “trick” of the DOAS method. In practice, this is done by simply fitting a polynomial to the spectrum and then subtracting it. Obviously, this will not produce an exact equality between the measured optical depths and those calculated with the differential cross-sections but the difference is usually small. Alternatively a common method which is applied to remove broad-band structures from the optical density are binomial high-pass filters.</p>

<p>Also, unless the path difference between the two measurements can be strictly determined and has some physical meaning (such as the distance of telescope and retro-reflector for a longpath-DOAS system), the retrieved quantities, 

<math display="inline" id="Differential_optical_absorption_spectroscopy:12">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <msub>
     <mi>σ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{\Delta\sigma_{i}\}
  </annotation>
 </semantics>
</math>

 will be meaningless. The typical measurement geometry will be as follows: the instrument is always pointing straight up. Measurements are taken at two different times of day: once with the sun high in the sky, and once with it near the horizon. In both cases the light is scattered into the instrument before passing through the troposphere but takes different paths through the stratosphere as shown in the figure.</p>

<p>To deal with this, we introduce a quantity called the airmass factor which gives the ratio between the vertical column density (the observation is performed looking straight up, with the sun at full zenith) and the slant column density (same observation angle, sun at some other angle):</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:13">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mrow>
     <mi>i</mi>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>amf</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>σ</mi>
     <mrow>
      <mi>i</mi>
      <mi>θ</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>amf</ci>
      <ci>i</ci>
     </apply>
     <ci>θ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i0}=\mathrm{amf}_{i}(\theta)\sigma_{i\theta}
  </annotation>
 </semantics>
</math>

</p>

<p>where amf<sub><em>i</em></sub> is the airmass factor of species <em>i</em>, 

<math display="inline" id="Differential_optical_absorption_spectroscopy:14">
 <semantics>
  <msub>
   <mi>σ</mi>
   <mrow>
    <mi>i</mi>
    <mn>0</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>σ</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i0}
  </annotation>
 </semantics>
</math>

 is the vertical column and 

<math display="inline" id="Differential_optical_absorption_spectroscopy:15">
 <semantics>
  <msub>
   <mi>σ</mi>
   <mrow>
    <mi>i</mi>
    <mi>θ</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>σ</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i\theta}
  </annotation>
 </semantics>
</math>

 is the slant column with the sun at zenith angle 

<math display="inline" id="Differential_optical_absorption_spectroscopy:16">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

. Airmass factors can be determined by radiative transfer calculations.</p>

<p>Some algebra shows the vertical column density to be given by:</p>

<p>

<math display="block" id="Differential_optical_absorption_spectroscopy:17">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mrow>
     <mi>i</mi>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>σ</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>amf</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>θ</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>amf</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>θ</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>amf</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>amf</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i0}=\frac{\Delta\sigma_{i}}{\mathrm{amf}_{i}(\theta_{2})-\mathrm{amf}_%
{i}(\theta_{1})}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Differential_optical_absorption_spectroscopy:18">
 <semantics>
  <msub>
   <mi>θ</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{1}
  </annotation>
 </semantics>
</math>

 is the angle at the first measurement geometry and 

<math display="inline" id="Differential_optical_absorption_spectroscopy:19">
 <semantics>
  <msub>
   <mi>θ</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{2}
  </annotation>
 </semantics>
</math>

 is the angle at the second. Note that with this method, the column along the common path will be subtracted from our measurements and cannot be recovered. What this means is that, only the column density in the stratosphere can be retrieved and the lowest point of scatter between the two measurements must be determined to figure out where the column begins.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.doas-bremen.de">DOAS group at IUP, Bremen</a></li>
<li><a href="http://www.iup.uni-heidelberg.de/institut/forschung/groups/atmosphere">DOAS and atmospheric chemistry group at IUP, Heidelberg</a></li>
</ul>

<p>"</p>

<p><a href="Category:Inverse_problems" title="wikilink">Category:Inverse problems</a> <a href="Category:Remote_sensing" title="wikilink">Category:Remote sensing</a></p>
</body>
</html>

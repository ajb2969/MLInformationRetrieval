<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1452">SMS4</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>SMS4</h1>
<hr/>

<p><strong>SMS4</strong> is a <a href="block_cipher" title="wikilink">block cipher</a> used in the <a href="China" title="wikilink">Chinese</a> National Standard for Wireless LAN <a href="WLAN_Authentication_and_Privacy_Infrastructure" title="wikilink">WAPI</a> (Wired Authentication and Privacy Infrastructure).</p>

<p>SMS4 was a proposed cipher to be used in <a href="IEEE_802.11i" title="wikilink">IEEE 802.11i</a> standard, but has so far been rejected by <a href="International_Organization_for_Standardization" title="wikilink">ISO</a>. One of the reasons for the rejection has been opposition to the WAPI fast-track proposal by the <a class="uri" href="IEEE" title="wikilink">IEEE</a>.</p>

<p>The SMS4 algorithm was invented by Prof. LU Shu-wang(吕述望). The algorithm was declassified in January, 2006. A few details of the SMS4 cipher are:</p>
<ul>
<li>It has a block size of 128 bits.</li>
<li>Uses an 8-bit <a class="uri" href="S-box" title="wikilink">S-box</a></li>
<li>The key size is 128 bits.</li>
<li>The only operations used are XOR, circular shifts and S-Box applications</li>
<li>Performs 32 rounds to process one block.</li>
<li>Each round updates a quarter (32 bits) of the internal state.</li>
<li>A non-linear <a href="key_schedule" title="wikilink">key schedule</a> is used to produce the round keys.</li>
<li>Decryption is using the same keys as encryption, but in reversed order.</li>
</ul>
<h2 id="terms-and-definitions">Terms and Definitions</h2>
<h3 id="word-and-byte">Word and Byte</h3>

<p>Define 

<math display="inline" id="SMS4:0">
<semantics>
<msubsup>
<mi>Z</mi>
<mn>2</mn>
<mi>e</mi>
</msubsup>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>Z</ci>
<ci>e</ci>
</apply>
<cn type="integer">2</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   Z^{e}_{2}
  </annotation>
</semantics>
</math>

 as a vector set of <em>e</em> bits.</p>

<p>
<math display="inline" id="SMS4:1">
<semantics>
<msubsup>
<mi>Z</mi>
<mn>2</mn>
<mn>32</mn>
</msubsup>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>Z</ci>
<cn type="integer">32</cn>
</apply>
<cn type="integer">2</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   Z^{32}_{2}
  </annotation>
</semantics>
</math>

 is a <strong>word</strong>.</p>

<p>
<math display="inline" id="SMS4:2">
<semantics>
<msubsup>
<mi>Z</mi>
<mn>2</mn>
<mn>8</mn>
</msubsup>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>Z</ci>
<cn type="integer">8</cn>
</apply>
<cn type="integer">2</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   Z^{8}_{2}
  </annotation>
</semantics>
</math>

 is a <strong>byte</strong>.</p>
<h3 id="s-box">S-box</h3>

<p>S-box is fixed for 8-bit input and 8-bit output, noted as Sbox().</p>
<h3 id="keys-and-key-parameters">Keys and Key Parameters</h3>

<p>The length of encryption keys are 128-bit, represented as 

<math display="inline" id="SMS4:3">
<semantics>
<mrow>
<mrow>
<mi>M</mi>
<mi>K</mi>
</mrow>
<mo>=</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>M</mi>
<msub>
<mi>K</mi>
<mn>0</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>M</mi>
<msub>
<mi>K</mi>
<mn>1</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>M</mi>
<msub>
<mi>K</mi>
<mn>2</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>M</mi>
<msub>
<mi>K</mi>
<mn>3</mn>
</msub>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>M</ci>
<ci>K</ci>
</apply>
<vector>
<apply>
<times></times>
<ci>M</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>M</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>M</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>M</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">3</cn>
</apply>
</apply>
</vector>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   MK=(MK_{0},\ MK_{1},\ MK_{2},\ MK_{3})
  </annotation>
</semantics>
</math>

, in which 

<math display="inline" id="SMS4:4">
<semantics>
<mrow>
<mi>M</mi>
<mpadded width="+5pt">
<msub>
<mi>K</mi>
<mi>i</mi>
</msub>
</mpadded>
<mrow>
<mo stretchy="false">(</mo>
<mi>i</mi>
<mo>=</mo>
<mn>0</mn>
<mo>,</mo>
<mn>1</mn>
<mo>,</mo>
<mn>2</mn>
<mo>,</mo>
<mn>3</mn>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<csymbol cd="unknown">M</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<ci>i</ci>
</apply>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">i</csymbol>
<eq></eq>
<cn type="integer">0</cn>
<ci>normal-,</ci>
<cn type="float">1</cn>
<ci>normal-,</ci>
<cn type="float">2</cn>
<ci>normal-,</ci>
<cn type="float">3</cn>
<ci>normal-)</ci>
</cerror>
</cerror>
</annotation-xml>
<annotation encoding="application/x-tex">
   MK_{i}\ (i=0,\ 1,\ 2,\ 3)
  </annotation>
</semantics>
</math>

 is a word.</p>

<p>A round key is represented as 

<math display="inline" id="SMS4:5">
<semantics>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>r</mi>
<msub>
<mi>k</mi>
<mn>0</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>r</mi>
<msub>
<mi>k</mi>
<mn>1</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mi mathvariant="normal">…</mi>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>r</mi>
<msub>
<mi>k</mi>
<mn>31</mn>
</msub>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<vector>
<apply>
<times></times>
<ci>r</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>k</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>r</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>k</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>normal-…</ci>
<apply>
<times></times>
<ci>r</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>k</ci>
<cn type="integer">31</cn>
</apply>
</apply>
</vector>
</annotation-xml>
<annotation encoding="application/x-tex">
   (rk_{0},\ rk_{1},\ \ldots,\ rk_{31})
  </annotation>
</semantics>
</math>

. It is generated by the encryption key.</p>

<p>
<math display="inline" id="SMS4:6">
<semantics>
<mrow>
<mrow>
<mi>F</mi>
<mi>K</mi>
</mrow>
<mo>=</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>F</mi>
<msub>
<mi>K</mi>
<mn>0</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>F</mi>
<msub>
<mi>K</mi>
<mn>1</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>F</mi>
<msub>
<mi>K</mi>
<mn>2</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>F</mi>
<msub>
<mi>K</mi>
<mn>3</mn>
</msub>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>F</ci>
<ci>K</ci>
</apply>
<vector>
<apply>
<times></times>
<ci>F</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>F</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>F</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>F</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">3</cn>
</apply>
</apply>
</vector>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   FK=(FK_{0},\ FK_{1},\ FK_{2},\ FK_{3})
  </annotation>
</semantics>
</math>

 is a system parameter.</p>

<p>
<math display="inline" id="SMS4:7">
<semantics>
<mrow>
<mrow>
<mi>C</mi>
<mi>K</mi>
</mrow>
<mo>=</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>C</mi>
<msub>
<mi>K</mi>
<mn>0</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>C</mi>
<msub>
<mi>K</mi>
<mn>1</mn>
</msub>
</mrow>
<mo rspace="7.5pt">,</mo>
<mi mathvariant="normal">…</mi>
<mo rspace="7.5pt">,</mo>
<mrow>
<mi>C</mi>
<msub>
<mi>K</mi>
<mn>31</mn>
</msub>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>C</ci>
<ci>K</ci>
</apply>
<vector>
<apply>
<times></times>
<ci>C</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>C</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>normal-…</ci>
<apply>
<times></times>
<ci>C</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<cn type="integer">31</cn>
</apply>
</apply>
</vector>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   CK=(CK_{0},\ CK_{1},\ \ldots,\ CK_{31})
  </annotation>
</semantics>
</math>

 is a fixed parameter.</p>

<p>
<math display="inline" id="SMS4:8">
<semantics>
<mrow>
<mi>F</mi>
<msub>
<mi>K</mi>
<mi>i</mi>
</msub>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>F</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<ci>i</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   FK_{i}
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="SMS4:9">
<semantics>
<mrow>
<mi>C</mi>
<msub>
<mi>K</mi>
<mi>i</mi>
</msub>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>C</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>K</ci>
<ci>i</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   CK_{i}
  </annotation>
</semantics>
</math>

 are words, used for extension of the algorithm.</p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.oscca.gov.cn/UpFile/200621016423197990.pdf">Chinese document describing the SMS4 cipher</a></li>
<li><a href="http://eprint.iacr.org/2008/329.pdf">English translation of the Chinese document</a></li>
<li><a href="http://eprint.iacr.org/2008/281">Linear and Differential Cryptanalysis of Reduced SMS4 Block Cipher</a></li>
<li><a href="http://www.cryptoclarity.com/CryptoClarityLLC/Welcome/Entries/2009/2/24_SMS4_Cipher_as_a_Spreadsheet.html">Example of SMS4 implemented as a Spreadsheet</a></li>
<li><a href="http://www.lois.labs.gov.cn/personnel/lvshuwang.htm">Page of Prof. LU Shu-wang(吕述望) in Chinese</a></li>
<li><a href="http://hi.baidu.com/numax/blog/item/80addfefddfb93e4cf1b3e61.html">Example of SMS4 implemented in ANSI C</a></li>
</ul>

<p>"</p>

<p><a href="Category:Block_ciphers" title="wikilink">Category:Block ciphers</a></p>
</body>
</html>

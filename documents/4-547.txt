   Empirical Bayes method      Empirical Bayes method   Empirical Bayes methods are procedures for statistical inference in which the prior distribution is estimated from the data. This approach stands in contrast to standard Bayesian methods , for which the prior distribution is fixed before any data are observed. Despite this difference in perspective, empirical Bayes may be viewed as an approximation to a fully Bayesian treatment of a hierarchical model wherein the parameters at the highest level of the hierarchy are set to their most likely values, instead of being integrated out. Empirical Bayes, also known as maximum marginal likelihood , 1 represents one approach for setting hyperparameters .  Introduction  Empirical Bayes methods can be seen as an approximation to a fully Bayesian treatment of a hierarchical Bayes model .  In, for example, a two-stage hierarchical Bayes model, observed data    y  =   {   y  1   ,   y  2   ,  …  ,   y  N   }       y    subscript  y  1    subscript  y  2   normal-…   subscript  y  N      y=\{y_{1},y_{2},\dots,y_{N}\}   are assumed to be generated from an unobserved set of parameters    θ  =   {   θ  1   ,   θ  2   ,  …  ,   θ  n   }       θ    subscript  θ  1    subscript  θ  2   normal-…   subscript  θ  n      \theta=\{\theta_{1},\theta_{2},\dots,\theta_{n}\}   according to a probability distribution    p   (  y  |  θ  )      fragments  p   fragments  normal-(  y  normal-|  θ  normal-)     p(y|\theta)\,   . In turn, the parameters   θ   θ   \theta   can be considered samples drawn from a population characterised by hyperparameters     η    η   \eta\,   according to a probability distribution    p   (  θ  |  η  )      fragments  p   fragments  normal-(  θ  normal-|  η  normal-)     p(\theta|\eta)\,   . In the hierarchical Bayes model, though not in the empirical Bayes approximation, the hyperparameters    η    η   \eta\,   are considered to be drawn from an unparameterized distribution    p   (  η  )       p  η    p(\eta)\,   .  Information about a particular quantity of interest     θ  i      subscript  θ  i    \theta_{i}\;   therefore comes not only from the properties of those data which directly depend on it, but also from the properties of the population of parameters    θ    θ   \theta\;   as a whole, inferred from the data as a whole, summarised by the hyperparameters    η    η   \eta\;   .  Using Bayes' theorem ,      p   (  θ  |  y  )   =    p   (  y  |  θ  )   p   (  θ  )     p   (  y  )     =    p   (  y  |  θ  )     p   (  y  )     ∫  p   (  θ  |  η  )   p   (  η  )   d   η   .     fragments  p   fragments  normal-(  θ  normal-|  y  normal-)       fragments  p   fragments  normal-(  y  normal-|  θ  normal-)   p   fragments  normal-(  θ  normal-)      p  y        fragments  p   fragments  normal-(  y  normal-|  θ  normal-)      p  y     p   fragments  normal-(  θ  normal-|  η  normal-)   p   fragments  normal-(  η  normal-)   d  η  normal-.    p(\theta|y)=\frac{p(y|\theta)p(\theta)}{p(y)}=\frac{p(y|\theta)}{p(y)}\int p(%
 \theta|\eta)p(\eta)\,d\eta\,.     In general, this integral will not be tractable analytically or symbolically and must be evaluated by numerical methods. Stochastic (random) or deterministic approximations may be used. Example stochastic methods are Markov Chain Monte Carlo and Monte Carlo sampling. Deterministic approximations are discussed in quadrature .  Alternatively, the expression can be written as      p   (  θ  |  y  )   =  ∫  p   (  θ  |  η  ,  y  )   p   (  η  |  y  )   d  η  =  ∫    p   (  y  |  θ  )   p   (  θ  |  η  )     p   (  y  |  η  )     p   (  η  |  y  )   d   η   ,     fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p   fragments  normal-(  θ  normal-|  η  normal-,  y  normal-)   p   fragments  normal-(  η  normal-|  y  normal-)   d  η       fragments  p   fragments  normal-(  y  normal-|  θ  normal-)   p   fragments  normal-(  θ  normal-|  η  normal-)     fragments  p   fragments  normal-(  y  normal-|  η  normal-)     p   fragments  normal-(  η  normal-|  y  normal-)   d  η  normal-,    p(\theta|y)=\int p(\theta|\eta,y)p(\eta|y)\;d\eta=\int\frac{p(y|\theta)p(%
 \theta|\eta)}{p(y|\eta)}p(\eta|y)\;d\eta\,,   and the term in the integral can in turn be expressed as      p   (  η  |  y  )   =  ∫  p   (  η  |  θ  )   p   (  θ  |  y  )   d  θ  .     fragments  p   fragments  normal-(  η  normal-|  y  normal-)     p   fragments  normal-(  η  normal-|  θ  normal-)   p   fragments  normal-(  θ  normal-|  y  normal-)   d  θ  normal-.    p(\eta|y)=\int p(\eta|\theta)p(\theta|y)\;d\theta.     These suggest an iterative scheme, qualitatively similar in structure to a Gibbs sampler , to evolve successively improved approximations to    p   (  θ  |  y  )      fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p(\theta|y)\;   and    p   (  η  |  y  )      fragments  p   fragments  normal-(  η  normal-|  y  normal-)     p(\eta|y)\;   . First, calculate an initial approximation to    p   (  θ  |  y  )      fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p(\theta|y)\;   ignoring the   η   η   \eta   dependence completely; then calculate an approximation to    p   (  η  |  y  )      fragments  p   fragments  normal-(  η  normal-|  y  normal-)     p(\eta|y)\;   based upon the initial approximate distribution of    p   (  θ  |  y  )      fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p(\theta|y)\;   ; then use this    p   (  η  |  y  )      fragments  p   fragments  normal-(  η  normal-|  y  normal-)     p(\eta|y)\;   to update the approximation for    p   (  θ  |  y  )      fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p(\theta|y)\;   ; then update    p   (  η  |  y  )      fragments  p   fragments  normal-(  η  normal-|  y  normal-)     p(\eta|y)\;   ; and so on.  When the true distribution    p   (  η  |  y  )      fragments  p   fragments  normal-(  η  normal-|  y  normal-)     p(\eta|y)\;   is sharply peaked, the integral determining    p   (  θ  |  y  )      fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p(\theta|y)\;   may be not much changed by replacing the probability distribution over    η    η   \eta\;   with a point estimate     η  *      superscript  η     \eta^{*}\;   representing the distribution's peak (or, alternatively, its mean),      p   (  θ  |  y  )   ≃     p   (  y  |  θ  )   p   (  θ  |   η  *   )     p   (  y  |   η  *   )      .     fragments  p   fragments  normal-(  θ  normal-|  y  normal-)   similar-to-or-equals     fragments  p   fragments  normal-(  y  normal-|  θ  normal-)   p   fragments  normal-(  θ  normal-|   superscript  η    normal-)     fragments  p   fragments  normal-(  y  normal-|   superscript  η    normal-)     normal-.    p(\theta|y)\simeq\frac{p(y|\theta)\;p(\theta|\eta^{*})}{p(y|\eta^{*})}\,.   With this approximation, the above iterative scheme becomes the EM algorithm .  The term "Empirical Bayes" can cover a wide variety of methods, but most can be regarded as an early truncation of either the above scheme or something quite like it. Point estimates, rather than the whole distribution, are typically used for the parameter(s)    η    η   \eta\;   . The estimates for     η  *      superscript  η     \eta^{*}\;   are typically made from the first approximation to    p   (  θ  |  y  )      fragments  p   fragments  normal-(  θ  normal-|  y  normal-)     p(\theta|y)\;   without subsequent refinement. These estimates for     η  *      superscript  η     \eta^{*}\;   are usually made without considering an appropriate prior distribution for   η   η   \eta   .  Point estimation  Robbins method : non-parametric empirical Bayes (NPEB)  Robbins 2 considered a case of sampling from a mixed distribution , where probability for each    y  i     subscript  y  i    y_{i}   (conditional on    θ  i     subscript  θ  i    \theta_{i}   ) is specified by a Poisson distribution ,      p   (   y  i   |   θ  i   )   =     θ  i     y  i     e   -   θ  i        y  i   !       fragments  p   fragments  normal-(   subscript  y  i   normal-|   subscript  θ  i   normal-)         superscript   subscript  θ  i    subscript  y  i     superscript  e     subscript  θ  i         subscript  y  i       p(y_{i}|\theta_{i})={{\theta_{i}}^{y_{i}}e^{-\theta_{i}}\over{y_{i}}!}     while the prior on θ is unspecified except that it is also i.i.d. from an unknown distribution, with cumulative distribution function     G   (  θ  )       G  θ    G(\theta)   . Compound sampling arises in a variety of statistical estimation problems, such as accident rates and clinical trials. We simply seek a point prediction of    θ  i     subscript  θ  i    \theta_{i}   given all the observed data. Because the prior is unspecified, we seek to do this without knowledge of G . 3  Under squared error loss (SEL), the conditional expectation  E (θ i | Y i = y i ) is a reasonable quantity to use for prediction. For the Poisson compound sampling model, this quantity is        E   (   θ  i   |   y  i   )    =    ∫    (     θ   y  +  1     e   -  θ     /    y  i   !    )   d  G   (  θ  )      ∫    (     θ  y    e   -  θ     /    y  i   !    )   d  G   (  θ  )       .       normal-E   subscript  θ  i    subscript  y  i               superscript  θ    y  1     superscript  e    θ        subscript  y  i     d  G  θ             superscript  θ  y    superscript  e    θ        subscript  y  i     d  G  θ       \operatorname{E}(\theta_{i}|y_{i})={\int(\theta^{y+1}e^{-\theta}/{y_{i}}!)\,dG%
 (\theta)\over{\int(\theta^{y}e^{-\theta}/{y_{i}}!)\,dG(\theta})}.     This can be simplified by multiplying the expression by     (    y  i   +  1   )   /   (    y  i   +  1   )          subscript  y  i   1      subscript  y  i   1     ({y_{i}}+1)/({y_{i}}+1)   , yielding        E   (   θ  i   |   y  i   )    =     (    y  i   +  1   )    p  G    (    y  i   +  1   )      p  G    (   y  i   )      ,       normal-E   subscript  θ  i    subscript  y  i           subscript  y  i   1    subscript  p  G      subscript  y  i   1       subscript  p  G    subscript  y  i       \operatorname{E}(\theta_{i}|y_{i})={{(y_{i}+1)p_{G}(y_{i}+1)}\over{p_{G}(y_{i}%
 )}},     where p G is the marginal distribution obtained by integrating out θ over G .  To take advantage of this, Robbins 4 suggested estimating the marginals with their empirical frequencies, yielding the fully non-parametric estimate as:        E   (   θ  i   |   y  i   )    ≈    (    y  i   +  1   )     #   {   Y  j   =   y  i   +  1  }     #   {   Y  j   =   y  i   }       ,       normal-E   subscript  θ  i    subscript  y  i         subscript  y  i   1      fragments  #   fragments  normal-{   subscript  Y  j     subscript  y  i    1  normal-}     fragments  #   fragments  normal-{   subscript  Y  j     subscript  y  i   normal-}        \operatorname{E}(\theta_{i}|y_{i})\approx(y_{i}+1){{\#\{Y_{j}=y_{i}+1\}}\over{%
 \#\{Y_{j}=y_{i}\}}},     where   #   normal-#   \#   denotes "number of". (See also Good–Turing frequency estimation .)   Example - Accident rates   Suppose each customer of an insurance company has an "accident rate" Θ and is insured against accidents; the probability distribution of Θ is the underlying distribution, and is unknown. The number of accidents suffered by each customer in a specified time period has a Poisson distribution with expected value equal to the particular customer's accident rate. The actual number of accidents experienced by a customer is the observable quantity. A crude way to estimate the underlying probability distribution of the accident rate Θ is to estimate the proportion of members of the whole population suffering 0, 1, 2, 3, ... accidents during the specified time period as the corresponding proportion in the observed random sample. Having done so, it is then desired to predict the accident rate of each customer in the sample. As above, one may use the conditional  expected value of the accident rate Θ given the observed number of accidents during the baseline period. Thus, if a customer suffers six accidents during the baseline period, that customer's estimated accident rate is 7 × [the proportion of the sample who suffered 7 accidents] / [the proportion of the sample who suffered 6 accidents]. Note that if the proportion of people suffering k accidents is a decreasing function of k , the customer's predicted accident rate will often be lower than their observed number of accidents. This shrinkage effect is typical of empirical Bayes analyses.  Parametric empirical Bayes  If the likelihood and its prior take on simple parametric forms (such as 1- or 2-dimensional likelihood functions with simple conjugate priors ), then the empirical Bayes problem is only to estimate the marginal    m   (  y  |  η  )      fragments  m   fragments  normal-(  y  normal-|  η  normal-)     m(y|\eta)   and the hyperparameters   η   η   \eta   using the complete set of empirical measurements. For example, one common approach, called parametric empirical Bayes point estimation, is to approximate the marginal using the maximum likelihood estimate (MLE), or a Moments expansion, which allows one to express the hyperparameters   η   η   \eta   in terms of the empirical mean and variance. This simplified marginal allows one to plug in the empirical averages into a point estimate for the prior   θ   θ   \theta   . The resulting equation for the prior   θ   θ   \theta   is greatly simplified, as shown below.  There are several common parametric empirical Bayes models, including the Poisson–gamma model (below), the Beta-binomial model , the Gaussian–Gaussian model , the Dirichlet-multinomial model , as well specific models for Bayesian linear regression (see below) and Bayesian multivariate linear regression . More advanced approaches include hierarchical Bayes models and Bayesian mixture models .  Poisson–gamma model  For example, in the example above, let the likelihood be a Poisson distribution , and let the prior now be specified by the conjugate prior , which is a gamma distribution (    G   (  α  ,  β  )       G   α  β     G(\alpha,\beta)   ) (where    η  =   (  α  ,  β  )       η   α  β     \eta=(\alpha,\beta)   ):      ρ   (  θ  |  α  ,  β  )   =       θ   α  -  1      e   -   θ  /  β        β  α   Γ   (  α  )       for   θ  >  0  ,  α  >  0  ,  β  >  0  .     fragments  ρ   fragments  normal-(  θ  normal-|  α  normal-,  β  normal-)         superscript  θ    α  1     superscript  e      θ  β         superscript  β  α   normal-Γ  α    for  θ   0  normal-,  α   0  normal-,  β   0  normal-.    \rho(\theta|\alpha,\beta)=\frac{\theta^{\alpha-1}\,e^{-\theta/\beta}}{\beta^{%
 \alpha}\Gamma(\alpha)}\ \mathrm{for}\ \theta>0,\alpha>0,\beta>0\,\!.     It is straightforward to show the posterior is also a gamma distribution. Write      ρ   (  θ  |  y  )   ∝  ρ   (  y  |  θ  )   ρ   (  θ  |  α  ,  β  )   ,     fragments  ρ   fragments  normal-(  θ  normal-|  y  normal-)   proportional-to  ρ   fragments  normal-(  y  normal-|  θ  normal-)   ρ   fragments  normal-(  θ  normal-|  α  normal-,  β  normal-)   normal-,    \rho(\theta|y)\propto\rho(y|\theta)\rho(\theta|\alpha,\beta),     where the marginal distribution has been omitted since it does not depend explicitly on   θ   θ   \theta   . Expanding terms which do depend on   θ   θ   \theta   gives the posterior as:      ρ   (  θ  |  y  )   ∝   (    θ  y     e   -  θ    )    (    θ   α  -  1      e   -   θ  /  β     )   =    θ    y  +  α   -  1      e   -   θ   (   1  +   1  /  β    )      .     fragments  ρ   fragments  normal-(  θ  normal-|  y  normal-)   proportional-to   fragments  normal-(   superscript  θ  y    superscript  e    θ    normal-)    fragments  normal-(   superscript  θ    α  1     superscript  e      θ  β     normal-)     superscript  θ      y  α   1     superscript  e      θ    1    1  β       normal-.    \rho(\theta|y)\propto(\theta^{y}\,e^{-\theta})(\theta^{\alpha-1}\,e^{-\theta/%
 \beta})=\theta^{y+\alpha-1}\,e^{-\theta(1+1/\beta)}.     So the posterior density is also a gamma distribution     G   (   α  ′   ,   β  ′   )       G    superscript  α  normal-′    superscript  β  normal-′      G(\alpha^{\prime},\beta^{\prime})   , where     α  ′   =   y  +  α        superscript  α  normal-′     y  α     \alpha^{\prime}=y+\alpha   , and     β  ′   =    (   1  +   1  /  β    )    -  1         superscript  β  normal-′    superscript    1    1  β      1      \beta^{\prime}=(1+1/\beta)^{-1}   . Also notice that the marginal is simply the integral of the posterior over all   Θ   normal-Θ   \Theta   , which turns out to be a negative binomial distribution .  To apply empirical Bayes, we will approximate the marginal using the maximum likelihood estimate (MLE). But since the posterior is a gamma distribution, the MLE of the marginal turns out to be just the mean of the posterior, which is the point estimate    E   (  θ  |  y  )      normal-E  θ  y    \operatorname{E}(\theta|y)   we need. Recalling that the mean   μ   μ   \mu   of a gamma distribution    G   (   α  ′   ,   β  ′   )       G    superscript  α  normal-′    superscript  β  normal-′      G(\alpha^{\prime},\beta^{\prime})   is simply     α  ′    β  ′        superscript  α  normal-′    superscript  β  normal-′     \alpha^{\prime}\beta^{\prime}   , we have        E   (  θ  |  y  )    =    α  ′    β  ′    =     y  ¯   +  α    1  +   1  /  β     =     β   1  +  β     y  ¯    +    1   1  +  β     (   α  β   )      .         normal-E  θ  y      superscript  α  normal-′    superscript  β  normal-′              normal-¯  y   α     1    1  β                β    1  β     normal-¯  y        1    1  β      α  β        \operatorname{E}(\theta|y)=\alpha^{\prime}\beta^{\prime}=\frac{\bar{y}+\alpha}%
 {1+1/\beta}=\frac{\beta}{1+\beta}\bar{y}+\frac{1}{1+\beta}(\alpha\beta).     To obtain the values of   α   α   \alpha   and   β   β   \beta   , empirical Bayes prescribes estimating mean    α  β      α  β    \alpha\beta   and variance    α   β  2       α   superscript  β  2     \alpha\beta^{2}   using the complete set of empirical data.  The resulting point estimate    E   (  θ  |  y  )      normal-E  θ  y    \operatorname{E}(\theta|y)   is therefore like a weighted average of the sample mean    y  ¯     normal-¯  y    \bar{y}   and the prior mean    μ  =   α  β       μ    α  β     \mu=\alpha\beta   . This turns out to be a general feature of empirical Bayes; the point estimates for the prior (i.e. mean) will look like a weighted averages of the sample estimate and the prior estimate (likewise for estimates of the variance).  See also   Bayes estimator  Bayes' theorem  Bayesian approaches to brain function  Bayesian probability  Best linear unbiased prediction  Conditional probability  Monty Hall problem  Posterior probability  Robbins lemma   References  Further reading   Peter E. Rossi, Greg M. Allenby, and Robert McCulloch, Bayesian Statistics and Marketing , John Wiley & Sons, Ltd, 2006     External links   [ http://www.webcitation.org/query?url=http://ca.geocities.com/hauer%40rogers.com/Pubs/TRBpaper.pdf&date; ;=2009-10-25+03:03:10 Use of empirical Bayes Method in estimating road safety (North America)]  Empirical Bayes methods for missing data analysis  Using the Beta-Binomial distribution to assess performance of a biometric identification device  A Hierarchical Naive Bayes Classifiers (for continuous and discrete variables).   "  Category:Non-parametric Bayesian methods            
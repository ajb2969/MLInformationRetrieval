   Holm–Bonferroni method      Holm–Bonferroni method   In statistics , the Holm–Bonferroni method  1 is a method used to counteract the problem of multiple comparisons . It is intended to control the Familywise error rate and offers a simple test uniformly more powerful than the Bonferroni correction . It is one of the earliest usages of stepwise algorithms in simultaneous inference .  It is named after Sture Holm , who invented the method in 1978, and Carlo Emilio Bonferroni .  Introduction  When considering several hypotheses in the same test the problem of multiplicity arises. Intuitively, the more hypotheses we check, the higher the probability to witness a rare result. With 10 different hypotheses and significance level of 0.05, the probability of committing one or more type I errors is greater than 1-.95^10=0.4 if the nulls are in fact true. The Holm–Bonferroni method is one of many approaches that control the overall probability of witnessing one or more type I errors (aka family-wise error rate ) by adjusting the rejection criteria of each of the individual hypotheses or comparisons.  Formulation  The method is as follows:   Let     H  1   ,  …  ,   H  m       subscript  H  1   normal-…   subscript  H  m     H_{1},...,H_{m}   be a family of hypotheses and     P  1   ,  …  ,   P  m       subscript  P  1   normal-…   subscript  P  m     P_{1},...,P_{m}   the corresponding P-values.  Start by ordering the p-values (from lowest to highest)     P   (  1  )    …   P   (  m  )         subscript  P  1   normal-…   subscript  P  m     P_{(1)}\ldots P_{(m)}   and let the associated hypotheses be     H   (  1  )    …   H   (  m  )         subscript  H  1   normal-…   subscript  H  m     H_{(1)}\ldots H_{(m)}     For a given significance level    α   α   \alpha   , let   k   k   k   be the minimal index such that     P   (  k  )    >   α    m  +  1   -  k         subscript  P  k     α      m  1   k      P_{(k)}>\frac{\alpha}{m+1-k}     Reject the null hypotheses     H   (  1  )    …   H   (   k  -  1   )         subscript  H  1   normal-…   subscript  H    k  1      H_{(1)}\ldots H_{(k-1)}   and do not reject     H   (  k  )    …   H   (  m  )         subscript  H  k   normal-…   subscript  H  m     H_{(k)}\ldots H_{(m)}     If    k  =  1      k  1    k=1   then do not reject any of the null hypotheses and if no such   k   k   k   exist then reject all of the null hypotheses.   The Holm–Bonferroni method ensures that this method will control the     F  W  E  R   ≤  α        F  W  E  R   α    FWER\leq\alpha   , where    F  W  E  R      F  W  E  R    FWER   is the Familywise error rate  Proof that Holm-Bonferroni controls the FWER  Let     H   (  1  )    …   H   (  m  )         subscript  H  1   normal-…   subscript  H  m     H_{(1)}\ldots H_{(m)}   be a family of hypotheses, and     P   (  1  )    ≤   P   (  2  )    ≤  …  ≤   P   (  m  )           subscript  P  1    subscript  P  2        normal-…        subscript  P  m      P_{(1)}\leq P_{(2)}\leq\ldots\leq P_{(m)}   be the sorted p-values. Let    I  0     subscript  I  0    I_{0}   be the set of indices corresponding to the (unknown) true null hypotheses, having    m  0     subscript  m  0    m_{0}   members.  Let us assume that we wrongly reject a true hypothesis. We have to prove that the probability of this event is at most   α   α   \alpha   . Let   h   h   h   be the first rejected true hypothesis (first in the ordering given by the Bonferroni–Holm test). So    h  -  1      h  1    h-1   is the last false hypothesis rejected and      h  -  1   +   m  0    ≤  m          h  1    subscript  m  0    m    h-1+m_{0}\leq m   . From there, we get     1    m  -  h   +  1    ≤   1   m  0          1      m  h   1      1   subscript  m  0      \frac{1}{m-h+1}\leq\frac{1}{m_{0}}   (1). Since   h   h   h   is rejected we have     P   (  h  )    ≤   α    m  +  1   -  h         subscript  P  h     α      m  1   h      P_{(h)}\leq\frac{\alpha}{m+1-h}   by definition of the test. Using (1), the right hand side is at most    α   m  0       α   subscript  m  0     \frac{\alpha}{m_{0}}   . Thus, if we wrongly reject a true hypothesis, there has to be a true hypothesis with P-value at most    α   m  0       α   subscript  m  0     \frac{\alpha}{m_{0}}   .  So let us define    A  =   {   P  i   ≤   α   m  0    for some  i  ∈   I  0   }      fragments  A    fragments  normal-{   subscript  P  i      α   subscript  m  0    for some  i    subscript  I  0   normal-}     A=\left\{P_{i}\leq\frac{\alpha}{m_{0}}\text{ for some }i\in I_{0}\right\}   . Whatever the (unknown) set of true hypotheses    I  0     subscript  I  0    I_{0}   is, we have     Pr   (  A  )    ≤  α       Pr  A   α    \Pr(A)\leq\alpha   (by the Bonferroni inequalities ). Therefore, the probability to reject a true hypothesis is at most   α   α   \alpha   .  Proof that Holm-Bonferroni controls the FWER using the closure principle  The Holm–Bonferroni method can be viewed as closed testing procedure , 2 with Bonferroni method applied locally on each of the intersections of null hypotheses.  It is a shortcut procedure since practically the number of comparisons to be made equal to   m   m   m   or less, while the number of all intersections of null hypotheses to be tested is of order    2  m     superscript  2  m    2^{m}   .  The closure principle states that a hypothesis    H  i     subscript  H  i    H_{i}   in a family of hypotheses     H  1   ,  …  ,   H  m       subscript  H  1   normal-…   subscript  H  m     H_{1},...,H_{m}   is rejected - while controlling the family-wise error rate of   α   α   \alpha   - if and only if all the sub-families of the intersections with    H  i     subscript  H  i    H_{i}   are controlled at level of family-wise error rate of   α   α   \alpha   .  In Holm-Bonferroni procedure, we first test    H   (  1  )      subscript  H  1    H_{(1)}   . If it is not rejected then the intersection of all null hypotheses     ⋂   i  =  1   m    H  i       superscript   subscript     i  1    m    subscript  H  i     \bigcap\nolimits_{i=1}^{m}{{H_{i}}}   is not rejected too, such that there exist at least one intersection hypothesis for each of elementary hypotheses     H  1   ,  …  ,   H  m       subscript  H  1   normal-…   subscript  H  m     H_{1},...,H_{m}   that is not rejected, thus we reject none of the elementary hypotheses.  If    H   (  1  )      subscript  H  1    H_{(1)}   is rejected at level    α  /  m      α  m    \alpha/m   then all the intersection sub-families that contain it are rejected too, thus    H   (  1  )      subscript  H  1    H_{(1)}   is rejected. This is because    P   (  1  )      subscript  P  1    P_{(1)}   is the smallest in each one of the intersection sub-families and the size of the sub-families is the most   m   m   m   , such that the Bonferroni threshold larger than    α  /  m      α  m    \alpha/m   .  The same rationale applies for    H   (  2  )      subscript  H  2    H_{(2)}   . However, since    H   (  1  )      subscript  H  1    H_{(1)}   already rejected, it sufficient to reject all the intersection sub-families of    H   (  2  )      subscript  H  2    H_{(2)}   without    H   (  1  )      subscript  H  1    H_{(1)}   . Once     P   (  2  )    ≤   α  /   (   m  -  1   )         subscript  P  2     α    m  1      P_{(2)}\leq\alpha/(m-1)   holds all the intersections that contains    H   (  2  )      subscript  H  2    H_{(2)}   are rejected.  The same applies for each    1  ≤  i  ≤  m        1  i       m     1\leq i\leq m   .  Example  Consider four null hypotheses     H  1   ,  …  ,   H  4       subscript  H  1   normal-…   subscript  H  4     H_{1},...,H_{4}   with unadjusted p-values     p  1   =  0.01       subscript  p  1   0.01    p_{1}=0.01   ,     p  2   =  0.04       subscript  p  2   0.04    p_{2}=0.04   ,     p  3   =  0.03       subscript  p  3   0.03    p_{3}=0.03   and     p  4   =  0.005       subscript  p  4   0.005    p_{4}=0.005   , to be tested at significance level    α  =  0.05      α  0.05    \alpha=0.05   . Since the procedure is step-down, we first test     H  4   =   H   (  1  )         subscript  H  4    subscript  H  1     H_{4}=H_{(1)}   , which has the smallest p-value     p  4   =   p   (  1  )    =  0.005         subscript  p  4    subscript  p  1        0.005     p_{4}=p_{(1)}=0.005   . The p-value is compared to     α  /  4   =  0.0125        α  4   0.0125    \alpha/4=0.0125   , the null hypothesis is rejected and we continue to the next one. Since     p  1   =   p   (  2  )    =  0.01  <  0.0167  =   α  /  3          subscript  p  1    subscript  p  2        0.01       0.0167         α  3      p_{1}=p_{(2)}=0.01<0.0167=\alpha/3   we reject     H  1   =   H   (  2  )         subscript  H  1    subscript  H  2     H_{1}=H_{(2)}   as well and continue. The next hypothesis    H  3     subscript  H  3    H_{3}   is not rejected since     p  3   =   p   (  3  )    =  0.03  >  0.025  =   α  /  2          subscript  p  3    subscript  p  3        0.03       0.025         α  2      p_{3}=p_{(3)}=0.03>0.025=\alpha/2   . We stop testing and conclude that    H  1     subscript  H  1    H_{1}   and    H  4     subscript  H  4    H_{4}   are rejected and    H  2     subscript  H  2    H_{2}   and    H  3     subscript  H  3    H_{3}   are not rejected while controlling the Family Wise Error Rate at level    α  =  0.05      α  0.05    \alpha=0.05   . Note that even though     p  2   =   p   (  4  )    =  0.04  <  0.05  =  α         subscript  p  2    subscript  p  4        0.04       0.05       α     p_{2}=p_{(4)}=0.04<0.05=\alpha   applies,    H  2     subscript  H  2    H_{2}   is not rejected. This is because the testing procedure stops once there is no rejection.  Extensions  The Holm–Bonferroni method is an example of a closed test procedure . 3 As such, it controls the familywise error rate for all the k hypotheses at level α in the strong sense. Each intersection is tested using the simple Bonferroni test.  Adjusted P-value  The adjusted P-values for Holm–Bonferroni method are:        p  ~    (  i  )    =   max   j  ≤  i      {   (  m  -  j  +  1  )    p   (  j  )    }   1      fragments   subscript   normal-~  p   i     subscript     j  i     subscript   fragments  normal-{   fragments  normal-(  m   j   1  normal-)    subscript  p  j   normal-}   1     \widetilde{p}_{(i)}=\max_{j\leq i}\left\{(m-j+1)p_{(j)}\right\}_{1}   , where      {  x  }   1   ≡   min   (  x  ,  1  )         subscript   x   1     x  1     \{x\}_{1}\equiv\min(x,1)   .  In the earlier example , the adjusted p-values are      p  ~   1   =  0.03       subscript   normal-~  p   1   0.03    \widetilde{p}_{1}=0.03   ,      p  ~   2   =  0.06       subscript   normal-~  p   2   0.06    \widetilde{p}_{2}=0.06   ,      p  ~   3   =  0.06       subscript   normal-~  p   3   0.06    \widetilde{p}_{3}=0.06   and      p  ~   4   =  0.02       subscript   normal-~  p   4   0.02    \widetilde{p}_{4}=0.02   . Only hypotheses    H  1     subscript  H  1    H_{1}   and    H  4     subscript  H  4    H_{4}   are rejected at level    α  =  0.05      α  0.05    \alpha=0.05   .  Šidák version  When hypotheses have non-negative dependence, it is possible to replace     α  m   ,   α   m  -  1    ,  …  ,   α  1        α  m     α    m  1    normal-…    α  1     \frac{\alpha}{m},\frac{\alpha}{m-1},...,\frac{\alpha}{1}   with:       1  -    (   1  -  α   )    1  /  m     ,   1  -    (   1  -  α   )    1  /   (   m  -  1   )      ,  …  ,   1  -    (   1  -  α   )   1         1   superscript    1  α     1  m       1   superscript    1  α     1    m  1      normal-…    1   superscript    1  α   1      1-(1-\alpha)^{1/m},1-(1-\alpha)^{1/(m-1)},...,1-(1-\alpha)^{1}   resulting in a slightly more powerful test.  Weighted version  Let     P   (  1  )    ,  …  ,   P   (  m  )        subscript  P  1   normal-…   subscript  P  m     P_{(1)},...,P_{(m)}   be the ordered unadjusted p-values. Let    H   (  i  )      subscript  H  i    H_{(i)}   ,    0  ≤   w   (  i  )        0   subscript  w  i     0\leq w_{(i)}   correspond to    P   (  i  )      subscript  P  i    P_{(i)}   . Reject    H   (  i  )      subscript  H  i    H_{(i)}   as long as        P   (  j  )    ≤     w   (  j  )      ∑   k  =  j   m    w   (  k  )      α    ,   j  =   1  ,  …  ,  i       formulae-sequence     subscript  P  j        subscript  w  j     subscript   superscript   m     k  j     subscript  w  k     α      j   1  normal-…  i      P_{(j)}\leq\frac{w_{(j)}}{\sum^{m}_{k=j}{w_{(k)}}}\alpha,\quad j=1,...,i     adjusted p-values: The adjusted weighted p-value are :      p  ~    (  i  )    =   max   j  ≤  i      {      ∑   k  =  j   m     w   (  k  )      w   (  j  )      p   (  j  )    }   1      fragments   subscript   normal-~  p   i     subscript     j  i     subscript   fragments  normal-{      subscript   superscript   m     k  j     subscript  w  k     subscript  w  j     subscript  p  j   normal-}   1     \widetilde{p}_{(i)}=\max_{j\leq i}\left\{\frac{\sum^{m}_{k=j}{w_{(k)}}}{w_{(j)%
 }}p_{(j)}\right\}_{1}   , where      {  x  }   1   ≡   min   (  x  ,  1  )         subscript   x   1     x  1     \{x\}_{1}\equiv\min(x,1)   .  A hypothesis is rejected at level α if and only if its adjusted p-value is less than α. In the earlier example using equal weights, the adjusted p-values are 0.03, 0.06, 0.06, and 0.02. This is another way to see that using α = 0.05, only hypotheses one and four are rejected by this procedure.  Alternatives and usage  Holm–Bonferroni method is uniformly more powerful than the classic Bonferroni correction. Since no assumptions required, it can always substitute the Bonferroni correction. However, it is not the best simultaneous inference controlling procedure available. There are many other methods that intend to control the family-wise error rate, many of them are more powerful than Holm-Bonferroni. Among those there is the Hochberg procedure (1988) and Hommel procedure  4 .  In Hochberg procedure rejection of     H   (  1  )    …   H   (  k  )         subscript  H  1   normal-…   subscript  H  k     H_{(1)}\ldots H_{(k)}   is made after finding the maximal index   k   k   k   such that     P   (  k  )    ≤   α    m  +  1   -  k         subscript  P  k     α      m  1   k      P_{(k)}\leq\frac{\alpha}{m+1-k}   . Thus, The Hochberg procedure is more powerful by construction. However, the Hochberg procedure require the hypotheses to be independent (or under some forms of positive dependence), while Holm-Bonferroni can be applied with no further assumptions on the data.  Bonferroni contribution  Carlo Emilio Bonferroni did not take part in inventing the method described here. Holm originally called the method the "sequentially rejective Bonferroni test", and it became known as Holm-Bonferroni only after some time. Holm's motives for naming his method after Bonferroni are explained in the original paper: "The use of the Boole inequality within multiple inference theory is usually called the Bonferroni technique, and for this reason we will call our test the sequentially rejective Bonferroni test."  See also   Multiple comparisons  Bonferroni correction  Familywise error rate  Closed testing procedure   References    de:Alphafehler-Kumulierung  sv:Bonferroni-Holms metod "  Category:Hypothesis testing  Category:Statistical tests  Category:Multiple comparisons     ↩  ↩  ↩  ↩     
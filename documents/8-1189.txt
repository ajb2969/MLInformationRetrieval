   Affine shape adaptation      Affine shape adaptation   Affine shape adaptation is a methodology for iteratively adapting the shape of the smoothing kernels in an affine group of smoothing kernels to the local image structure in neighbourhood region of a specific image point. Equivalently, affine shape adaptation can be accomplished by iteratively warping a local image patch with affine transformations while applying a rotationally symmetric filter to the warped image patches. Provided that this iterative process converges, the resulting fixed point will be affine invariant . In the area of computer vision , this idea has been used for defining affine invariant interest point operators as well as affine invariant texture analysis methods.  Affine-adapted interest point operators  The interest points obtained from the scale-adapted Laplacian blob detector or the multi-scale Harris corner detector with automatic scale selection are invariant to translations, rotations and uniform rescalings in the spatial domain. The images that constitute the input to a computer vision system are, however, also subject to perspective distortions. To obtain interest points that are more robust to perspective transformations, a natural approach is to devise a feature detector that is invariant to affine transformations .  Interestingly, affine invariance can be accomplished from measurements of the same multi-scale windowed second moment matrix   μ   μ   \mu   as is used in the multi-scale Harris operator provided that we extend the regular scale space concept obtained by convolution with rotationally symmetric Gaussian kernels to an affine Gaussian scale-space obtained by shape-adapted Gaussian kernels (Lindeberg 1994 section 15.3; Lindeberg and Garding 1997). For a two-dimensional image   I   I   I   , let     x  ¯   =    (  x  ,  y  )   T        normal-¯  x    superscript   x  y   T     \bar{x}=(x,y)^{T}   and let    Σ  t     subscript  normal-Σ  t    \Sigma_{t}   be a positive definite 2×2 matrix. Then, a non-uniform Gaussian kernel can be defined as       g   (   x  ¯   ;  Σ  )    =    1   2  π    det   Σ  t        e   -     x  ¯    Σ  t   -  1     x  ¯    /  2            g    normal-¯  x   normal-Σ        1    2  π     det   subscript  normal-Σ  t        superscript  e         normal-¯  x    superscript   subscript  normal-Σ  t     1     normal-¯  x    2        g(\bar{x};\Sigma)=\frac{1}{2\pi\sqrt{\operatorname{det}\Sigma_{t}}}e^{-\bar{x}%
 \Sigma_{t}^{-1}\bar{x}/2}   and given any input image    I  L     subscript  I  L    I_{L}   the affine Gaussian scale-space is the three-parameter scale-space defined as        L   (   x  ¯   ;   Σ  t   )    =    ∫    x  i   ¯      I  L    (   x  -  ξ   )   g   (   ξ  ¯   ;   Σ  t   )   d   ξ  ¯      .        L    normal-¯  x    subscript  normal-Σ  t       subscript    normal-¯    x  i        subscript  I  L     x  ξ   g    normal-¯  ξ    subscript  normal-Σ  t    d   normal-¯  ξ       L(\bar{x};\Sigma_{t})=\int_{\bar{xi}}I_{L}(x-\xi)\,g(\bar{\xi};\Sigma_{t})\,d%
 \bar{\xi}.   Next, introduce an affine transformation    η  =   B  ξ       η    B  ξ     \eta=B\xi   where   B   B   B   is a 2×2-matrix, and define a transformed image    I  R     subscript  I  R    I_{R}   as        I  L    (   ξ  ¯   )    =    I  R    (   η  ¯   )           subscript  I  L    normal-¯  ξ       subscript  I  R    normal-¯  η      I_{L}(\bar{\xi})=I_{R}(\bar{\eta})   . Then, the affine scale-space representations   L   L   L   and   R   R   R   of    I  L     subscript  I  L    I_{L}   and    I  R     subscript  I  R    I_{R}   , respectively, are related according to       L   (   ξ  ¯   ,   Σ  L   )    =   R   (   η  ¯   ,   Σ  R   )          L    normal-¯  ξ    subscript  normal-Σ  L       R    normal-¯  η    subscript  normal-Σ  R       L(\bar{\xi},\Sigma_{L})=R(\bar{\eta},\Sigma_{R})   provided that the affine shape matrices    Σ  L     subscript  normal-Σ  L    \Sigma_{L}   and    Σ  R     subscript  normal-Σ  R    \Sigma_{R}   are related according to       Σ  R   =   B   Σ  L    B  T         subscript  normal-Σ  R     B   subscript  normal-Σ  L    superscript  B  T      \Sigma_{R}=B\Sigma_{L}B^{T}   . Disregarding mathematical details, which unfortunately become somewhat technical if one aims at a precise description of what is going on, the important message is that the affine Gaussian scale-space is closed under affine transformations .  If we, given the notation     ∇  L   =    (   L  x   ,   L  y   )   T        normal-∇  L    superscript    subscript  L  x    subscript  L  y    T     \nabla L=(L_{x},L_{y})^{T}   as well as local shape matrix    Σ  t     subscript  normal-Σ  t    \Sigma_{t}   and an integration shape matrix    Σ  s     subscript  normal-Σ  s    \Sigma_{s}   , introduce an affine-adapted multi-scale second-moment matrix according to        μ  L    (   x  ¯   ;   Σ  t   ,   Σ  s   )    =   g   (    x  ¯   -   ξ  ¯    ;   Σ  s   )    (     ∇  L    (   ξ  ¯   ;   Σ  t   )      ∇  L  T    (   ξ  ¯   ;   Σ  t   )     )           subscript  μ  L     normal-¯  x    subscript  normal-Σ  t    subscript  normal-Σ  s       g      normal-¯  x    normal-¯  ξ     subscript  normal-Σ  s        subscript  normal-∇  L    normal-¯  ξ    subscript  normal-Σ  t      superscript   subscript  normal-∇  L   T    normal-¯  ξ    subscript  normal-Σ  t        \mu_{L}(\bar{x};\Sigma_{t},\Sigma_{s})=g(\bar{x}-\bar{\xi};\Sigma_{s})\,\left(%
 \nabla_{L}(\bar{\xi};\Sigma_{t})\nabla_{L}^{T}(\bar{\xi};\Sigma_{t})\right)   it can be shown that under any affine transformation     q  ¯   =   B   p  ¯         normal-¯  q     B   normal-¯  p      \bar{q}=B\bar{p}   the affine-adapted multi-scale second-moment matrix transforms according to        μ  L    (   p  ¯   ;   Σ  t   ,   Σ  s   )    =    B  T    μ  R    (  q  ;   B   Σ  t    B  T    ,   B   Σ  s    B  T    )   B          subscript  μ  L     normal-¯  p    subscript  normal-Σ  t    subscript  normal-Σ  s        superscript  B  T    subscript  μ  R    q    B   subscript  normal-Σ  t    superscript  B  T      B   subscript  normal-Σ  s    superscript  B  T     B     \mu_{L}(\bar{p};\Sigma_{t},\Sigma_{s})=B^{T}\mu_{R}(q;B\Sigma_{t}B^{T},B\Sigma%
 _{s}B^{T})B   . Again, disregarding somewhat messy technical details, the important message here is that ''given a correspondence between the image points    p  ¯     normal-¯  p    \bar{p}   and    q  ¯     normal-¯  q    \bar{q}   , the affine transformation   B   B   B   can be estimated from measurements of the multi-scale second-moment matrices    μ  L     subscript  μ  L    \mu_{L}   and    μ  R     subscript  μ  R    \mu_{R}   in the two domains.  An important consequence of this study is that if we can find an affine transformation   B   B   B   such that    μ  R     subscript  μ  R    \mu_{R}   is a constant times the unit matrix, then we obtain a fixed-point that is invariant to affine transformations (Lindeberg 1994 section 15.4; Lindeberg and Garding 1997). For the purpose of practical implementation, this property can often be reached by in either of two main ways. The first approach is based on transformations of the smoothing filters and consists of:   estimating the second-moment matrix   μ   μ   \mu   in the image domain,  determining a new adapted smoothing kernel with covariance matrix proportional to    μ   -  1      superscript  μ    1     \mu^{-1}   ,  smoothing the original image by the shape-adapted smoothing kernel, and  repeating this operation until the difference between two successive second-moment matrices is sufficiently small.   The second approach is based on warpings in the image domain and implies:   estimating   μ   μ   \mu   in the image domain,  estimating a local affine transformation proportional to     B  ^   =   μ   1  /  2         normal-^  B    superscript  μ    1  2      \hat{B}=\mu^{1/2}   where    μ   1  /  2      superscript  μ    1  2     \mu^{1/2}   denotes the square root matrix of   μ   μ   \mu   ,  warping the input image by the affine transformation     B  ^    -  1      superscript   normal-^  B     1     \hat{B}^{-1}   and  repeating this operation until   μ   μ   \mu   is sufficiently close to a constant times the unit matrix.   This overall process is referred to as affine shape adaptation (Lindeberg and Garding 1997; Baumberg 2000; Mikolajczyk and Schmid 2004; Tuytelaars and van Gool 2004; Lindeberg 2008). In the ideal continuous case, the two approaches are mathematically equivalent. In practical implementations, however, the first filter-based approach is usually more accurate in the presence of noise while the second warping-based approach is usually faster.  In practice, the affine shape adaptation process described here is often combined with interest point detection automatic scale selection as described in the articles on blob detection and corner detection , to obtain interest points that are invariant to the full affine group, including scale changes. Besides the commonly used multi-scale Harris operator, this affine shape adaptation can also be applied to other types of interest point operators such as the Laplacian/Difference of Gaussian blob operator and the determinant of the Hessian (Lindeberg 2008). Affine shape adaptation can also be used for affine invariant texture recognition and affine invariant texture segmentation.  See also   Corner detection  Blob detection  Harris affine region detector  Hessian affine region detector  Scale space  Gaussian function   References            "  Category:Feature detection (computer vision)   
   Vincenty's formulae      Vincenty's formulae   Vincenty's formulae are two related iterative methods used in geodesy to calculate the distance between two points on the surface of a spheroid, developed by Thaddeus Vincenty (1975a) They are based on the assumption that the figure of the Earth is an oblate spheroid , and hence are more accurate than methods such as great-circle distance which assume a spherical Earth.  The first (direct) method computes the location of a point which is a given distance and azimuth (direction) from another point. The second (inverse) method computes the geographical distance and azimuth between two given points. They have been widely used in geodesy because they are accurate to within 0.5 mm (0.020″) on the Earth ellipsoid .  Background  Vincenty's goal was to express existing algorithms for geodesics on an ellipsoid in a form that minimized the program length (see the first sentence of his paper). His unpublished report (1975b) mentions the use of a Wang 720 desk calculator which had only a few kilobytes of memory. To obtain good accuracy for long lines, the solution uses the classical solution of Legendre (1806), Bessel (1825), and Helmert (1880) based on the auxiliary sphere. (Vincenty relied on formulation of this method given by Rainsford, 1955.) Legendre showed that an ellipsoidal geodesic can be exactly mapped to a great circle on the auxiliary sphere by mapping the geographic latitude to reduced latitude and setting the azimuth of the great circle equal to that of the geodesic. The longitude on the ellipsoid and the distance along the geodesic are then given in terms of the longitude on the sphere and the arc length along the great circle by simple integrals. Bessel and Helmert gave rapidly converging series for these integrals which allow the geodesic to be computed with arbitrary accuracy.  In order to minimize the program size, Vincenty took these series, re-expanded them using the first term of each series as the small parameter, and truncated them to order ƒ 3 . This resulted in compact expressions for the longitude and distance integrals. The expressions were put in Horner (or nested ) form, since this allows polynomials to be evaluated using only a single temporary register. Finally, simple iterative techniques were used to solve the implicit equations in the direct and inverse methods; even though these are slow (and in the case of the inverse method it sometimes does not converge), they result in the least increase in code size.  Notation  Define the following notation:      a   length of semi- major axis of the ellipsoid (radius at equator);   (6378137.0 metres in WGS-84 )     ƒ   flattening of the ellipsoid;   (1/298.257223563 in WGS-84 )     b = (1 - ƒ ) a   length of semi- minor axis of the ellipsoid (radius at the poles);   (6356752.314245 meters in WGS-84 )     Φ 1 , Φ 2   latitude of the points;     U 1 = arctan[(1 − ƒ ) tan Φ 1 ],  U 2 = arctan[(1 − ƒ ) tan Φ 2 ]   reduced latitude (latitude on the auxiliary sphere)     L = L 2 - L 1   difference in longitude of two points;     λ 1 , λ 2   longitude of the points on the auxiliary sphere;     α 1 , α 2   forward azimuths at the points;     α   azimuth at the equator;     s   ellipsoidal distance between the two points;     σ   arc length between points on the auxiliary sphere     Inverse problem  Given the coordinates of the two points ( Φ 1 , L 1 ) and ( Φ 2 , L 2 ), the inverse problem finds the azimuths α 1 , α 2 and the ellipsoidal distance s .  Calculate U 1 , U 2 and L , and set initial value of λ = L . Then iteratively evaluate the following equations until λ converges:         sin  σ   =      (    cos   U  2     sin  λ    )   2   +    (     cos   U  1     sin   U  2     -    sin   U  1     cos   U  2     cos  λ     )   2           σ        superscript       subscript  U  2      λ    2    superscript         subscript  U  1       subscript  U  2          subscript  U  1       subscript  U  2      λ     2       \sin\sigma=\sqrt{(\cos U_{2}\sin\lambda)^{2}+(\cos U_{1}\sin U_{2}-\sin U_{1}%
 \cos U_{2}\cos\lambda)^{2}}               cos  σ   =     sin   U  1     sin   U  2     +    cos   U  1     cos   U  2     cos   λ            σ          subscript  U  1       subscript  U  2          subscript  U  1       subscript  U  2      λ       \cos\sigma=\sin U_{1}\sin U_{2}+\cos U_{1}\cos U_{2}\cos\lambda\,              σ  =   arctan     sin  σ    cos  σ          σ        σ     σ       \sigma=\arctan\frac{\sin\sigma}{\cos\sigma}\,    1 2             sin  α   =      cos   U  1     cos   U  2     sin  λ     sin  σ           α          subscript  U  1       subscript  U  2      λ      σ      \sin\alpha=\frac{\cos U_{1}\cos U_{2}\sin\lambda}{\sin\sigma}\,    If sin ''σ     = 0'' the value of sin α is indeterminate. It represents an end point equal to, or  diametrically opposite the start point.          cos  2   α   =   1  -    sin  2    α           superscript   2   α     1    superscript   2   α      \cos^{2}\alpha=1-\sin^{2}\alpha\,               cos   (   2   σ  m    )    =    cos  σ   -     2   sin   U  1     sin   U  2       cos  2   α              2   subscript  σ  m         σ       2     subscript  U  1       subscript  U  2       superscript   2   α       \cos(2\sigma_{m})=\cos\sigma-\frac{2\sin U_{1}\sin U_{2}}{\cos^{2}\alpha}\,    Start     and end point are on the equator. In this case C = 0 so the value of    cos   (   2   σ  m    )         2   subscript  σ  m      \cos(2\sigma_{m})   is not used. The limiting value is     cos   (   2   σ  m    )    =   -  1           2   subscript  σ  m       1     \cos(2\sigma_{m})=-1   .        C  =    f  16     cos  2   α    [   4  +   f   (   4  -   3    cos  2   α     )     ]        C      f  16     superscript   2   α    delimited-[]    4    f    4    3    superscript   2   α           C=\frac{f}{16}\cos^{2}\alpha\big[4+f(4-3\cos^{2}\alpha)\big]\,              λ  =   L  +    (   1  -  C   )   f   sin  α    {   σ  +   C   sin  σ    [    cos   (   2   σ  m    )    +   C   cos  σ    (    -  1   +   2    cos  2    (   2   σ  m    )      )     ]     }         λ    L      1  C   f    α      σ    C    σ    delimited-[]        2   subscript  σ  m       C    σ       1     2    superscript   2     2   subscript  σ  m                 \lambda=L+(1-C)f\sin\alpha\left\{\sigma+C\sin\sigma\left[\cos(2\sigma_{m})+C%
 \cos\sigma(-1+2\cos^{2}(2\sigma_{m}))\right]\right\}\,        When λ has converged to the desired degree of accuracy (10 −12 corresponds to approximately 0.06mm), evaluate the following:       u  2   =    cos  2    α      a  2   -   b  2     b  2            superscript  u  2     superscript   2     α       superscript  a  2    superscript  b  2     superscript  b  2        u^{2}=\cos^{2}\alpha\frac{a^{2}-b^{2}}{b^{2}}\,         A  =   1  +     u  2   16384    {   4096  +    u  2    [    -  768   +    u  2    (   320  -   175   u  2     )     ]     }         A    1       superscript  u  2   16384      4096     superscript  u  2    delimited-[]      768      superscript  u  2     320    175   superscript  u  2               A=1+\frac{u^{2}}{16384}\left\{4096+u^{2}\left[-768+u^{2}(320-175u^{2})\right]\right\}         B  =     u  2   1024    {   256  +    u  2    [    -  128   +    u  2    (   74  -   47   u  2     )     ]     }        B       superscript  u  2   1024      256     superscript  u  2    delimited-[]      128      superscript  u  2     74    47   superscript  u  2              B=\frac{u^{2}}{1024}\left\{256+u^{2}\left[-128+u^{2}(74-47u^{2})\right]\right\}          Δ  σ   =   B   sin  σ    {    cos   (   2   σ  m    )    +     1  4    B   [     cos  σ    (    -  1   +   2    cos  2    (   2   σ  m    )      )    -     1  6    B   cos   (   2   σ  m    )     (    -  3   +   4    sin  2   σ     )    (    -  3   +   4    cos  2    (   2   σ  m    )      )     ]     }          normal-Δ  σ     B    σ          2   subscript  σ  m         1  4   B   delimited-[]        σ       1     2    superscript   2     2   subscript  σ  m            1  6   B      2   subscript  σ  m         3     4    superscript   2   σ         3     4    superscript   2     2   subscript  σ  m                \Delta\sigma=B\sin\sigma\Big\{\cos(2\sigma_{m})+\tfrac{1}{4}B\big[\cos\sigma%
 \big(-1+2\cos^{2}(2\sigma_{m})\big)-\tfrac{1}{6}B\cos(2\sigma_{m})(-3+4\sin^{2%
 }\sigma)\big(-3+4\cos^{2}(2\sigma_{m})\big)\big]\Big\}         s  =   b  A   (   σ  -   Δ  σ    )        s    b  A    σ    normal-Δ  σ       s=bA(\sigma-\Delta\sigma)\,          α  1   =   arctan   (     cos   U  2     sin  λ       cos   U  1     sin   U  2     -    sin   U  1     cos   U  2     cos  λ      )         subscript  α  1            subscript  U  2      λ           subscript  U  1       subscript  U  2          subscript  U  1       subscript  U  2      λ         \alpha_{1}=\arctan\left(\frac{\cos U_{2}\sin\lambda}{\cos U_{1}\sin U_{2}-\sin
 U%
 _{1}\cos U_{2}\cos\lambda}\right)    3       α  2   =   arctan   (     cos   U  1     sin  λ      -    sin   U  1     cos   U  2      +    cos   U  1     sin   U  2     cos  λ      )         subscript  α  2            subscript  U  1      λ             subscript  U  1       subscript  U  2           subscript  U  1       subscript  U  2      λ         \alpha_{2}=\arctan\left(\frac{\cos U_{1}\sin\lambda}{-\sin U_{1}\cos U_{2}+%
 \cos U_{1}\sin U_{2}\cos\lambda}\right)    4  Between two nearly antipodal points, the iterative formula may fail to converge; this will occur when the first guess at λ as computed by the equation above is greater than π in absolute value.  Direct Problem  Given an initial point ( Φ 1 , L 1 ) and initial azimuth, α 1 , and a distance, s , along the geodesic the problem is to find the end point ( Φ 2 , L 2 ) and azimuth, α 2 .  Start by calculating the following:       U  1   =   arctan   (    (   1  -  f   )    tan   ϕ  1     )         subscript  U  1         1  f      subscript  ϕ  1        U_{1}=\arctan\left((1-f)\tan\phi_{1}\right)\,          σ  1   =   arctan   (    tan   U  1     cos   α  1     )         subscript  σ  1          subscript  U  1       subscript  α  1        \sigma_{1}=\arctan\left(\frac{\tan U_{1}}{\cos\alpha_{1}}\right)\,    5       sin  α   =    cos   U  1     sin    α  1            α        subscript  U  1       subscript  α  1       \sin\alpha=\cos U_{1}\sin\alpha_{1}\,           cos  2   α   =   1  -    sin  2    α           superscript   2   α     1    superscript   2   α      \cos^{2}\alpha=1-\sin^{2}\alpha\,          u  2   =    cos  2    α      a  2   -   b  2     b  2            superscript  u  2     superscript   2     α       superscript  a  2    superscript  b  2     superscript  b  2        u^{2}=\cos^{2}\alpha\frac{a^{2}-b^{2}}{b^{2}}\,         A  =   1  +     u  2   16384    {   4096  +    u  2    [    -  768   +    u  2    (   320  -   175   u  2     )     ]     }         A    1       superscript  u  2   16384      4096     superscript  u  2    delimited-[]      768      superscript  u  2     320    175   superscript  u  2               A=1+\frac{u^{2}}{16384}\left\{4096+u^{2}\left[-768+u^{2}(320-175u^{2})\right]\right\}         B  =     u  2   1024    {   256  +    u  2    [    -  128   +    u  2    (   74  -   47   u  2     )     ]     }        B       superscript  u  2   1024      256     superscript  u  2    delimited-[]      128      superscript  u  2     74    47   superscript  u  2              B=\frac{u^{2}}{1024}\left\{256+u^{2}\left[-128+u^{2}(74-47u^{2})\right]\right\}     Then, using an initial value    σ  =   s   b  A        σ    s    b  A      \sigma=\tfrac{s}{bA}   , iterate the following equations until there is no significant change in σ :         2   σ  m    =    2   σ  1    +   σ          2   subscript  σ  m        2   subscript  σ  1    σ     2\sigma_{m}=2\sigma_{1}+\sigma\,               Δ  σ   =   B   sin  σ    {    cos   (   2   σ  m    )    +    1  4   B   [     cos  σ    (    -  1   +   2    cos  2    (   2   σ  m    )      )    -    1  6   B   cos   (   2   σ  m    )     (    -  3   +   4    sin  2   σ     )    (    -  3   +   4    cos  2    (   2   σ  m    )      )     ]     }          normal-Δ  σ     B    σ          2   subscript  σ  m         1  4   B   delimited-[]        σ       1     2    superscript   2     2   subscript  σ  m            1  6   B      2   subscript  σ  m         3     4    superscript   2   σ         3     4    superscript   2     2   subscript  σ  m                \Delta\sigma=B\sin\sigma\Big\{\cos(2\sigma_{m})+\tfrac{1}{4}B\big[\cos\sigma%
 \big(-1+2\cos^{2}(2\sigma_{m})\big)-\tfrac{1}{6}B\cos(2\sigma_{m})(-3+4\sin^{2%
 }\sigma)\big(-3+4\cos^{2}(2\sigma_{m})\big)\big]\Big\}              σ  =    s   b  A    +   Δ   σ         σ      s    b  A      normal-Δ  σ      \sigma=\frac{s}{bA}+\Delta\sigma\,        Once σ is obtained to sufficient accuracy evaluate:       ϕ  2   =   arctan   (      sin   U  1     cos  σ    +    cos   U  1     sin  σ    cos   α  1        (   1  -  f   )       sin  2   α   +    (     sin   U  1     sin  σ    -    cos   U  1     cos  σ    cos   α  1      )   2       )         subscript  ϕ  2              subscript  U  1      σ         subscript  U  1      σ      subscript  α  1          1  f         superscript   2   α    superscript         subscript  U  1      σ         subscript  U  1      σ      subscript  α  1      2          \phi_{2}=\arctan\left(\frac{\sin U_{1}\cos\sigma+\cos U_{1}\sin\sigma\cos%
 \alpha_{1}}{(1-f)\sqrt{\sin^{2}\alpha+(\sin U_{1}\sin\sigma-\cos U_{1}\cos%
 \sigma\cos\alpha_{1})^{2}}}\right)\,    6      λ  =   arctan   (     sin  σ    sin   α  1        cos   U  1     cos  σ    -    sin   U  1     sin  σ    cos   α  1       )        λ          σ      subscript  α  1            subscript  U  1      σ         subscript  U  1      σ      subscript  α  1          \lambda=\arctan\left(\frac{\sin\sigma\sin\alpha_{1}}{\cos U_{1}\cos\sigma-\sin
 U%
 _{1}\sin\sigma\cos\alpha_{1}}\right)\,    7      C  =    f  16     cos  2   α    [   4  +   f   (   4  -   3    cos  2   α     )     ]        C      f  16     superscript   2   α    delimited-[]    4    f    4    3    superscript   2   α           C=\frac{f}{16}\cos^{2}\alpha\big[4+f(4-3\cos^{2}\alpha)\big]\,         L  =   λ  -    (   1  -  C   )   f   sin  α    {   σ  +   C   sin  σ    [    cos   (   2   σ  m    )    +   C   cos  σ    (    -  1   +   2    cos  2    (   2   σ  m    )      )     ]     }         L    λ      1  C   f    α      σ    C    σ    delimited-[]        2   subscript  σ  m       C    σ       1     2    superscript   2     2   subscript  σ  m                 L=\lambda-(1-C)f\sin\alpha\left\{\sigma+C\sin\sigma\left[\cos(2\sigma_{m})+C%
 \cos\sigma(-1+2\cos^{2}(2\sigma_{m}))\right]\right\}\,          L  2   =   L  +    L  1          subscript  L  2     L   subscript  L  1      L_{2}=L+L_{1}\,          α  2   =   arctan   (    sin  α     -    sin   U  1     sin  σ     +    cos   U  1     cos  σ    cos   α  1       )         subscript  α  2         α            subscript  U  1      σ          subscript  U  1      σ      subscript  α  1          \alpha_{2}=\arctan\left(\frac{\sin\alpha}{-\sin U_{1}\sin\sigma+\cos U_{1}\cos%
 \sigma\cos\alpha_{1}}\right)\,    8  If the initial point is at the North or South pole then the first equation is indeterminate. If the initial azimuth is due East or West then the second equation is indeterminate. If a double valued atan2 type function is used then these values are usually handled correctly.  Vincenty's modification  In his letter to Survey Review in 1976, Vincenty suggested replacing his series expressions for A and B with simpler formulas using Helmert's expansion parameter k 1 :      A  =    1  +    1  4     (   k  1   )   2      1  -   k  1         A      1      1  4    superscript   subscript  k  1   2       1   subscript  k  1       A=\frac{1+\frac{1}{4}(k_{1})^{2}}{1-k_{1}}       B  =    k  1    (   1  -    3  8     (   k  1   )   2     )        B     subscript  k  1     1      3  8    superscript   subscript  k  1   2        B=k_{1}(1-\tfrac{3}{8}(k_{1})^{2})     where     k  1   =      (   1  +   u  2    )    -  1      (   1  +   u  2    )    +  1         subscript  k  1           1   superscript  u  2     1         1   superscript  u  2     1      k_{1}=\frac{\sqrt{(1+u^{2})}-1}{\sqrt{(1+u^{2})}+1}     Nearly antipodal points  As noted above, the iterative solution to the inverse problem fails to converge or converges slowly for nearly antipodal points. An example of slow convergence is ( Φ 1 , L 1 ) = (0°, 0°) and ( Φ 2 , L 2 ) = (0.5°, 179.5°) for the WGS84 ellipsoid. This requires about 130 iterations to give a result accurate to 1 mm. Depending on how the inverse method is implemented, the algorithm might return the correct result (19936288.579 m), an incorrect result, or an error indicator. An example of an incorrect result is provided by the NGS online utility which returns a distance which is about 5 km too long. Vincenty suggested a method of accelerating the convergence in such cases (Rapp, 1973).  An example of a failure of the inverse method to converge is ( Φ 1 , L 1 ) = (0°, 0°) and ( Φ 2 , L 2 ) = (0.5°, 179.7°) for the WGS84 ellipsoid. In an unpublished report, Vincenty (1975b) gave an alternative iterative scheme to handle such cases. This converges to the correct result 19944127.421 m after about 60 iterations; however, in other cases many thousands of iterations are required.  Newton's method has been successfully used to give rapid convergence for all pairs of input points (Karney, 2013).  See also   Geographical distance  Great-circle distance  Meridian arc  Geodesics on an ellipsoid  Thaddeus Vincenty  Geodesy   Notes  References              External links   Online calculators from Geoscience Australia :  Vincenty Direct (destination point)  Vincenty Inverse (distance between points)   Calculators from the U.S. National Geodetic Survey :  Online and downloadable PC-executable calculation utilities , including forward (direct) and inverse problems, in both two and three dimensions (accessed 2011-08-01).   Online calculators with JavaScript source code by Chris Veness (Creative Commons Attribution license):  Vincenty Direct (destination point)  Vincenty Inverse (distance between points)   GeographicLib provides a utility GeodSolve (with MIT/X11 licensed source code) for solving direct and inverse geodesic problems. Compared to Vincenty, this is about 1000 times more accurate (error = 15 nm) and the inverse solution is complete. Here is an online version of GeodSolve .   "  Category:Geodesy  Category:Articles with example pseudocode     σ isn't evaluated directly from sin σ or cos σ to preserve numerical accuracy near the poles and equator ↩  The arctan quantity should be evaluated using a two argument atan2 type function. ↩           
   Stochastic portfolio theory      Stochastic portfolio theory   Stochastic portfolio theory (SPT) is a mathematical theory for analyzing stock market structure and portfolio behavior introduced by E. Robert Fernholz in 2002. It is descriptive as opposed to normative, and is consistent with the observed behavior of actual markets. Normative assumptions, which serve as a basis for earlier theories like modern portfolio theory (MPT) and the capital asset pricing model (CAPM), are absent from SPT.  SPT uses continuous-time random processes (in particular, continuous semi-martingales) to represent the prices of individual securities. Processes with discontinuities, such as jumps, have also been incorporated into the theory.  Stocks, portfolios and markets  SPT considers stocks and stock markets , but its methods can be applied to other classes of assets as well. A stock is represented by its price process, usually in the logarithmic representation . In the case the market is a collection of stock-price processes     X  i   ,     subscript  X  i    X_{i},   for     i  =   1  ,  …  ,  n    ,      i   1  normal-…  n     i=1,\dots,n,   each defined by a continuous semimartingale       d   log   X  i     (  t  )    =     γ  i    (  t  )   d  t   +    ∑   ν  =  1   d     ξ   i  ν     (  t  )   d   W  ν    (  t  )            d     subscript  X  i    t        subscript  γ  i   t  d  t     superscript   subscript     ν  1    d      subscript  ξ    i  ν    t  d   subscript  W  ν   t       d\log X_{i}(t)=\gamma_{i}(t)\,dt+\sum_{\nu=1}^{d}\xi_{i\nu}(t)\,dW_{\nu}(t)   where    W  :=   (   W  1   ,  …  ,   W  d   )      assign  W    subscript  W  1   normal-…   subscript  W  d      W:=(W_{1},\dots,W_{d})   is an   n   n   n   -dimensional Brownian motion  (Wiener) process with    d  ≥  n      d  n    d\geq n   , and the processes    γ  i     subscript  γ  i    \gamma_{i}   and    ξ   i  ν      subscript  ξ    i  ν     \xi_{i\nu}   are progressively measurable with respect to the Brownian filtration     {   ℱ  t   }   =   {   ℱ  t  W   }         subscript  ℱ  t      subscript   superscript  ℱ  W   t      \{\mathcal{F}_{t}\}=\{\mathcal{F}^{W}_{t}\}   . In this representation     γ  i    (  t  )        subscript  γ  i   t    \gamma_{i}(t)   is called the (compound) growth rate of     X  i   ,     subscript  X  i    X_{i},   and the covariance between    log   X  i        subscript  X  i     \log X_{i}   and    log   X  j        subscript  X  j     \log X_{j}   is       σ   i  j     (  t  )    =    ∑   ν  =  1   d     ξ   i  ν     (  t  )    ξ   j  ν     (  t  )      .         subscript  σ    i  j    t     superscript   subscript     ν  1    d      subscript  ξ    i  ν    t   subscript  ξ    j  ν    t      \sigma_{ij}(t)=\sum_{\nu=1}^{d}\xi_{i\nu}(t)\xi_{j\nu}(t).   It is frequently assumed that, for all    i  ,    i   i,   the process      ξ   i  ,  1   2    (  t  )    +  ⋯  +    ξ   i  d   2    (  t  )           superscript   subscript  ξ   i  1    2   t   normal-⋯     superscript   subscript  ξ    i  d    2   t     \xi_{i,1}^{2}(t)+\cdots+\xi_{id}^{2}(t)   is positive, locally square-integrable , and does not grow too rapidly as     t  →  ∞   .     normal-→  t     t\rightarrow\infty.     The logarithmic representation is equivalent to the classical arithmetic representation which uses the rate of return       α  i    (  t  )    ,       subscript  α  i   t    \alpha_{i}(t),   however the growth rate can be a meaningful indicator of long-term performance of a financial asset, whereas the rate of return has an upward bias. The relation between the rate of return and the growth rate is        α  i    (  t  )    =     γ  i    (  t  )    +     σ   i  i     (  t  )    2           subscript  α  i   t        subscript  γ  i   t        subscript  σ    i  i    t   2      \alpha_{i}(t)=\gamma_{i}(t)+\frac{\sigma_{ii}(t)}{2}   The usual convention in SPT is to assume that each stock has a single share outstanding, so     X  i    (  t  )        subscript  X  i   t    X_{i}(t)   represents the total capitalization of the   i   i   i   -th stock at time    t  ,    t   t,   and     X   (  t  )    =     X  1    (  t  )    +  ⋯  +    X  n    (  t  )           X  t        subscript  X  1   t   normal-⋯     subscript  X  n   t      X(t)=X_{1}(t)+\cdots+X_{n}(t)   is the total capitalization of the market. Dividends can be included in this representation, but are omitted here for simplicity.  An investment strategy     π  =   (   π  1   ,  ⋯  ,   π  n   )       π    subscript  π  1   normal-⋯   subscript  π  n      \pi=(\pi_{1},\cdots,\pi_{n})   is a vector of bounded, progressively measurable processes; the quantity     π  i    (  t  )        subscript  π  i   t    \pi_{i}(t)   represents the proportion of total wealth invested in the   i   i   i   -th stock at time   t   t   t   , and      π  0    (  t  )    :=   1  -    ∑   i  =  1   n     π  i    (  t  )         assign     subscript  π  0   t     1    superscript   subscript     i  1    n      subscript  π  i   t       \pi_{0}(t):=1-\sum_{i=1}^{n}\pi_{i}(t)   is the proportion hoarded (invested in a money market with zero interest rate). Negative weights correspond to short positions. The cash strategy    κ  ≡  0   (   κ  0   ≡  1  )      fragments  κ   0   fragments  normal-(   subscript  κ  0    1  normal-)     \kappa\equiv 0(\kappa_{0}\equiv 1)   keeps all wealth in the money market. A strategy   π   π   \pi   is called portfolio , if it is fully invested in the stock market , that is       π  1    (  t  )    +  ⋯  +    π  n    (  t  )     =  1           subscript  π  1   t   normal-⋯     subscript  π  n   t    1    \pi_{1}(t)+\cdots+\pi_{n}(t)=1   holds, at all times.  The value process     Z  π     subscript  Z  π    Z_{\pi}   of a strategy   π   π   \pi   is always positive and satisfies       d   log   Z  π     (  t  )    =     ∑   i  =  1   n     π  i    (  t  )   d   log   X  i     (  t  )     +    γ  π  *    (  t  )   d  t          d     subscript  Z  π    t       superscript   subscript     i  1    n      subscript  π  i   t  d     subscript  X  i    t       superscript   subscript  γ  π     t  d  t      d\log Z_{\pi}(t)=\sum_{i=1}^{n}\pi_{i}(t)\,d\log X_{i}(t)+\gamma_{\pi}^{*}(t)%
 \,dt     where the process    γ  π  *     superscript   subscript  γ  π      \gamma_{\pi}^{*}   is called the excess growth rate process and is given by        γ  π  *    (  t  )    :=     1  2     ∑   i  =  1   n     π  i    (  t  )    σ   i  i     (  t  )      -    1  2     ∑    i  ,  j   =  1   n     π  i    (  t  )    π  j    (  t  )    σ   i  j     (  t  )          assign     superscript   subscript  γ  π     t         1  2     superscript   subscript     i  1    n      subscript  π  i   t   subscript  σ    i  i    t         1  2     superscript   subscript      i  j   1    n      subscript  π  i   t   subscript  π  j   t   subscript  σ    i  j    t        \gamma_{\pi}^{*}(t):=\frac{1}{2}\sum_{i=1}^{n}\pi_{i}(t)\sigma_{ii}(t)-\frac{1%
 }{2}\sum_{i,j=1}^{n}\pi_{i}(t)\pi_{j}(t)\sigma_{ij}(t)     This expression is non-negative for a portfolio with non-negative weights     π  i    (  t  )        subscript  π  i   t    \pi_{i}(t)   and has been used in quadratic optimization of stock portfolios, a special case of which is optimization with respect to the logarithmic utility function.  The market weight processes ,        μ  i    (  t  )    :=     X  i    (  t  )       X  1    (  t  )    +  ⋯  +    X  n    (  t  )         assign     subscript  μ  i   t        subscript  X  i   t        subscript  X  1   t   normal-⋯     subscript  X  n   t       \mu_{i}(t):=\frac{X_{i}(t)}{X_{1}(t)+\cdots+X_{n}(t)}   where    i  =   1  ,  …  ,  n       i   1  normal-…  n     i=1,\dots,n   define the market portfolio    μ   μ   \mu   . With the initial condition       Z  μ    (  0  )    =   X   (  0  )     ,         subscript  Z  μ   0     X  0     Z_{\mu}(0)=X(0),   the associated value process will satisfy      Z  μ    (  t  )    =   X   (  t  )           subscript  Z  μ   t     X  t     Z_{\mu}(t)=X(t)   for all    t  .    t   t.     (Figure)  Figure 1 shows the entropy of the U.S. stock market over the period from 1980 to 2012, with the axis at the average value over the period. Although the entropy fluctuates over time, its behavior indicates that there is a certain stability to the stock market. Characterization of this stability is one of the goals of SPT.|page=1   A number of conditions can be imposed on a market, sometimes to model actual markets and sometimes to emphasize certain types of hypothetical market behavior. Some commonly invoked conditions are:   A market is nondegenerate if the eigenvalues of the covariance matrix      (    σ   i  j     (  t  )    )     1  ≤  i   ,   j  ≤  n       subscript     subscript  σ    i  j    t    formulae-sequence    1  i     j  n      (\sigma_{ij}(t))_{1\leq i,j\leq n}   are bounded away from zero. It has bounded variance if the eigenvalues are bounded.  A market is coherent if      lim   t  →  ∞      t   -  1     log   (    μ  i    (  t  )    )      =  0        subscript  lim   normal-→  t        superscript  t    1         subscript  μ  i   t      0    \operatorname{lim}_{t\rightarrow\infty}t^{-1}\log(\mu_{i}(t))=0   for all     i  =   1  ,  …  ,  n    .      i   1  normal-…  n     i=1,\dots,n.     A market is diverse on    [  0  ,  T  ]     0  T    [0,T]   if there exists    ε  >  0      ε  0    \varepsilon>0   such that      μ  max    (  t  )    ≤   1  -  ε          subscript  μ    t     1  ε     \mu_{\max}(t)\leq 1-\varepsilon   for     t  ∈   [  0  ,  T  ]    .      t   0  T     t\in[0,T].     A market is weakly diverse on    [  0  ,  T  ]     0  T    [0,T]   if there exists    ε  >  0      ε  0    \varepsilon>0   such that         1  T     ∫  0  T     μ  max    (  t  )   d  t     ≤   1  -  ε           1  T     superscript   subscript   0   T      subscript  μ    t  d  t       1  ε     \frac{1}{T}\int_{0}^{T}\mu_{\max}(t)\,dt\leq 1-\varepsilon     Diversity and weak diversity are rather weak conditions, and markets are generally far more diverse than would be tested by these extremes. A measure of market diversity is market entropy , defined by        S   (   μ   (  t  )    )    =   -    ∑   i  =  1   n     μ  i    (  t  )    log   (    μ  i    (  t  )    )        .        S    μ  t        superscript   subscript     i  1    n      subscript  μ  i   t       subscript  μ  i   t         S(\mu(t))=-\sum_{i=1}^{n}\mu_{i}(t)\log(\mu_{i}(t)).     Stochastic stability   We consider the vector process     (    μ   (  1  )     (  t  )    ,  …  ,    μ   (  n  )     (  t  )    )   ,        subscript  μ  1   t   normal-…     subscript  μ  n   t     (\mu_{(1)}(t),\dots,\mu_{(n)}(t)),   with    0  ≤  t  <  ∞        0  t           0\leq t<\infty   of ranked market weights       max   1  ≤  i  ≤  n     μ  i    (  t  )   =  :   μ   (  1  )     (  t  )   ≥   μ   (  2  )     (  t  )   ≥  ⋯   μ   (  n  )     (  t  )   :=   min   1  ≤  i  ≤  n     μ  i    (  t  )      fragments   subscript       1  i       n      subscript  μ  i    fragments  normal-(  t  normal-)    normal-:   subscript  μ  1    fragments  normal-(  t  normal-)     subscript  μ  2    fragments  normal-(  t  normal-)    normal-⋯   subscript  μ  n    fragments  normal-(  t  normal-)   assign   subscript       1  i       n      subscript  μ  i    fragments  normal-(  t  normal-)     \max_{1\leq i\leq n}\mu_{i}(t)=:\mu_{(1)}(t)\geq\mu_{(2)}(t)\geq\cdots\mu_{(n)%
 }(t):=\min_{1\leq i\leq n}\mu_{i}(t)   where ties are resolved “lexicographically”, always in favor of the lowest index. The log-gaps         G   (  k  ,   k  +  1   )     (  t  )    :=   log   (      μ   (  k  )     (  t  )    /   μ   (   k  +  1   )      (  t  )    )     ,     assign     superscript  G   k    k  1     t            subscript  μ  k   t    subscript  μ    k  1     t      G^{(k,k+1)}(t):=\log(\mu_{(k)}(t)/\mu_{(k+1)}(t)),   where    0  ≤  t  <  ∞        0  t           0\leq t<\infty   and    k  =   1  ,  …  ,   n  -  1        k   1  normal-…    n  1      k=1,\dots,n-1   are continuous, non-negative semimartingales; we denote by      Λ   (  k  ,   k  +  1   )     (  t  )    =    L   G   (  k  ,   k  +  1   )      (  t  ;  0  )           superscript  normal-Λ   k    k  1     t      superscript  L   superscript  G   k    k  1       t  0      \Lambda^{(k,k+1)}(t)=L^{G^{(k,k+1)}}(t;0)   their local times at the origin. These quantities measure the amount of turnover between ranks   k   k   k   and    k  +  1      k  1    k+1   during the time-interval    [  0  ,  t  ]     0  t    [0,t]   .  A market is called stochastically stable , if    (    μ   (  1  )     (  t  )    ,  ⋯  ,    μ   (  n  )     (  t  )    )        subscript  μ  1   t   normal-⋯     subscript  μ  n   t     (\mu_{(1)}(t),\cdots,\mu_{(n)}(t))    converges in distribution as    t  →  ∞     normal-→  t     t\rightarrow\infty   to a random vector    (   M   (  1  )    ,  ⋯  ,   M   (  n  )    )      subscript  M  1   normal-⋯   subscript  M  n     (M_{(1)},\cdots,M_{(n)})   with values in the Weyl chamber     {     (   x  1   ,  …  ,   x  n   )    ∣   x  1   >    x  2    >  …  >    x  n   and    ∑   i  =  1   n    x  i     =  1   }             subscript  x  1   normal-…   subscript  x  n     ket   subscript  x  1     subscript  x  2    normal-…          subscript  x  n   and    superscript   subscript     i  1    n    subscript  x  i          1      \{(x_{1},\dots,x_{n})\mid x_{1}>x_{2}>\dots>x_{n}\text{ and }\sum_{i=1}^{n}x_{%
 i}=1\}   of the unit simplex, and if the strong law of large numbers        lim   t  →  ∞       Λ   (  k  ,   k  +  1   )     (  t  )    t    =   λ   (  k  ,   k  +  1   )    >  0          subscript    normal-→  t          superscript  normal-Λ   k    k  1     t   t     superscript  λ   k    k  1          0     \lim_{t\rightarrow\infty}\frac{\Lambda^{(k,k+1)}(t)}{t}=\lambda^{(k,k+1)}>0   holds for suitable real constants      λ   (  1  ,  2  )    ,  …  ,   λ   (   n  -  1   ,  n  )     .      superscript  λ   1  2    normal-…   superscript  λ     n  1   n      \lambda^{(1,2)},\dots,\lambda^{(n-1,n)}.     Arbitrage and the numeraire property  Given any two investment strategies    π  ,  ρ     π  ρ    \pi,\rho   and a real number    T  >  0      T  0    T>0   , we say that   π   π   \pi   is arbitrage relative to   ρ   ρ   \rho   over the time-horizon    [  0  ,  T  ]     0  T    [0,T]   , if    ℙ   (   Z  π    (  T  )   ≥   Z  ρ    (  T  )   )   ≥  1     fragments  P   fragments  normal-(   subscript  Z  π    fragments  normal-(  T  normal-)     subscript  Z  ρ    fragments  normal-(  T  normal-)   normal-)    1    \mathbb{P}(Z_{\pi}(T)\geq Z_{\rho}(T))\geq 1   and    ℙ   (   Z  π    (  T  )   >   Z  ρ    (  T  )   )   >  0     fragments  P   fragments  normal-(   subscript  Z  π    fragments  normal-(  T  normal-)     subscript  Z  ρ    fragments  normal-(  T  normal-)   normal-)    0    \mathbb{P}(Z_{\pi}(T)>Z_{\rho}(T))>0   both hold; this relative arbitrage is called “strong” if    ℙ   (   Z  π    (  T  )   >   Z  ρ    (  T  )   )   =  1.     fragments  P   fragments  normal-(   subscript  Z  π    fragments  normal-(  T  normal-)     subscript  Z  ρ    fragments  normal-(  T  normal-)   normal-)    1.    \mathbb{P}(Z_{\pi}(T)>Z_{\rho}(T))=1.   When   ρ   ρ   \rho   is     κ  ≡  0   ,      κ  0    \kappa\equiv 0,   we recover the usual definition of arbitrage relative to cash. We say that a given strategy   ν   ν   \nu   has the numeraire property , if for any strategy   π   π   \pi   the ratio     Z  π   /   Z  ν        subscript  Z  π    subscript  Z  ν     Z_{\pi}/Z_{\nu}   is a   ℙ   ℙ   \mathbb{P}   −supermartingale. In such a case, the process    1  /   Z  ν       1   subscript  Z  ν     1/Z_{\nu}   is called a “deflator” for the market.  No arbitrage is possible, over any given time horizon, relative to a strategy   ν   ν   \nu   that has the numeraire property (either with respect to the underlying probability measure   ℙ   ℙ   \mathbb{P}   , or with respect to any other probability measure which is equivalent to   ℙ   ℙ   \mathbb{P}   ). A strategy   ν   ν   \nu   with the numeraire property maximizes the asymptotic growth rate from investment, in the sense that        lim sup   T  →  ∞      1  T    log   (     Z  π    (  T  )      Z  ν    (  T  )     )      ≤  0        subscript  limit-supremum   normal-→  T         1  T          subscript  Z  π   T      subscript  Z  ν   T       0    \limsup_{T\rightarrow\infty}\frac{1}{T}\log\left(\frac{Z_{\pi}(T)}{Z_{\nu}(T)}%
 \right)\leq 0   holds for any strategy   π   π   \pi   ; it also maximizes the expected log-utility from investment, in the sense that for any strategy   π   π   \pi   and real number    T  >  0      T  0    T>0   we have      𝔼   [  log   (   Z  π    (  T  )   ]   ≤  𝔼   [  log   (   Z  ν    (  T  )   )   ]   .      fragments  E   fragments  normal-[    fragments  normal-(   subscript  Z  π    fragments  normal-(  T  normal-)   normal-]    E   fragments  normal-[    fragments  normal-(   subscript  Z  ν    fragments  normal-(  T  normal-)   normal-)   normal-]   normal-.     \mathbb{E}[\log(Z_{\pi}(T)]\leq\mathbb{E}[\log(Z_{\nu}(T))].   If the vector     α   (  t  )    =    (    α  1    (  t  )    ,  ⋯  ,    α  n    (  t  )    )   ′         α  t    superscript      subscript  α  1   t   normal-⋯     subscript  α  n   t    normal-′     \alpha(t)=(\alpha_{1}(t),\cdots,\alpha_{n}(t))^{\prime}   of instantaneous rates of return, and the matrix     σ   (  t  )    =    (   σ   (  t  )    )     1  ≤  i   ,   j  ≤  n           σ  t    subscript    σ  t    formulae-sequence    1  i     j  n       \sigma(t)=(\sigma(t))_{1\leq i,j\leq n}   of instantaneous covariances, are known, then the strategy        ν   (  t  )    =   arg    max   p  ∈   ℝ  n      (     p  ′   α   (  t  )    -     1  2     p  ′   α   (  t  )   p    )        for all  0   ≤  t  <  ∞      formulae-sequence      ν  t       subscript     p   superscript  ℝ  n          superscript  p  normal-′   α  t       1  2    superscript  p  normal-′   α  t  p             for all  0   t            \nu(t)=\arg\max_{p\in\mathbb{R}^{n}}(p^{\prime}\alpha(t)-\tfrac{1}{2}p^{\prime%
 }\alpha(t)p)\qquad\text{ for all }0\leq t<\infty   has the numeraire property whenever the indicated maximum is attained.  The study of the numeraire portfolio links SPT to the so-called Benchmark approach to Mathematical Finance, which takes such a numeraire portfolio as given and provides a way to price contingent claims, without any further assumptions.  A probability measure   ℚ   ℚ   \mathbb{Q}   is called equivalent martingale measure (EMM) on a given time-horizon    [  0  ,  T  ]     0  T    [0,T]   , if it has the same null sets as   ℙ   ℙ   \mathbb{P}   on    ℱ  T     subscript  ℱ  T    \mathcal{F}_{T}   , and if the processes      X  1    (  t  )    ,  …  ,    X  n    (  t  )          subscript  X  1   t   normal-…     subscript  X  n   t     X_{1}(t),\dots,X_{n}(t)   with    0  ≤  t  ≤  T        0  t       T     0\leq t\leq T   are all   ℚ   ℚ   \mathbb{Q}   −martingales. Assuming that such an EMM exists, arbitrage is not possible on    [  0  ,  T  ]     0  T    [0,T]   relative to either cash   κ   κ   \kappa   or to the market portfolio   μ   μ   \mu   (or more generally, relative to any strategy   ρ   ρ   \rho   whose wealth process    Z  ρ     subscript  Z  ρ    Z_{\rho}   is a martingale under some EMM). Conversely, if    π  ,  ρ     π  ρ    \pi,\rho   are portfolios and one of them is arbitrage relative to the other on    [  0  ,  T  ]     0  T    [0,T]   then no EMM can exist on this horizon.  Functionally-generated portfolios  Suppose we are given a smooth function    G  :   U  →   (  0  ,  ∞  )       normal-:  G   normal-→  U   0       G:U\rightarrow(0,\infty)   on some neighborhood   U   U   U   of the unit simplex in    ℝ  n     superscript  ℝ  n    \mathbb{R}^{n}   . We call         π  i  𝔾    (  t  )    :=    μ  i    (  t  )    (      D  i    log   (   𝔾   (   μ   (  t  )    )    )     +  1   -    ∑   j  =  1   n     μ  j    (  t  )    D  j    log   (   𝔾   (   μ   (  t  )    )    )       )       for  1   ≤  i  ≤  n      formulae-sequence   assign     superscript   subscript  π  i   𝔾   t      subscript  μ  i   t         subscript  D  i       𝔾    μ  t      1     superscript   subscript     j  1    n      subscript  μ  j   t   subscript  D  j       𝔾    μ  t                for  1   i       n      \pi_{i}^{\mathbb{G}}(t):=\mu_{i}(t)\left(D_{i}\log(\mathbb{G}(\mu(t)))+1-\sum_%
 {j=1}^{n}\mu_{j}(t)D_{j}\log(\mathbb{G}(\mu(t)))\right)\qquad\text{ for }1\leq
 i\leq
 n   the portfolio generated by the function   𝔾   𝔾   \mathbb{G}    . It can be shown that all the weights of this portfolio are non-negative, if its generating function   𝔾   𝔾   \mathbb{G}   is concave. Under mild conditions, the relative performance of this functionally-generated portfolio    π  𝔾     subscript  π  𝔾    \pi_{\mathbb{G}}   with respect to the market portfolio   μ   μ   \mu   , is given by the F-G decomposition       log   (     Z   π  𝔾     (  T  )      Z  μ    (  T  )     )    =    log   (    𝔾   (   μ   (  T  )    )     𝔾   (   μ   (  0  )    )     )    +    ∫  0  T    g   (  t  )   d  t                subscript  Z   superscript  π  𝔾    T      subscript  Z  μ   T             𝔾    μ  T      𝔾    μ  0        superscript   subscript   0   T     g  t  d  t       \log\left(\frac{Z_{\pi^{\mathbb{G}}}(T)}{Z_{\mu}(T)}\right)=\log\left(\frac{%
 \mathbb{G}(\mu(T))}{\mathbb{G}(\mu(0))}\right)+\int_{0}^{T}g(t)\,dt   which involves no stochastic integrals. Here the expression       g   (  t  )    :=     -  1    2  𝔾   (   μ   (  t  )    )       ∑   i  =  1   n     ∑   j  =  1   n     D   i  j   2   𝔾   (   μ   (  t  )    )    μ  i    (  t  )    μ  j    (  t  )    τ   i  j   μ    (  t  )          assign    g  t         1     2  𝔾    μ  t       superscript   subscript     i  1    n     superscript   subscript     j  1    n      superscript   subscript  D    i  j    2   𝔾    μ  t    subscript  μ  i   t   subscript  μ  j   t   superscript   subscript  τ    i  j    μ   t        g(t):=\frac{-1}{2\mathbb{G}(\mu(t))}\sum_{i=1}^{n}\sum_{j=1}^{n}D_{ij}^{2}%
 \mathbb{G}(\mu(t))\mu_{i}(t)\mu_{j}(t)\tau_{ij}^{\mu}(t)   is called the drift process of the portfolio (and it is a non-negative quantity if the generating function   𝔾   𝔾   \mathbb{G}   is concave); and the quantities         τ   i  j   μ    (  t  )    :=    ∑   ν  =  1   n     (     ξ   i  ν     (  t  )    -    ξ  ν  μ    (  t  )     )    (     ξ   j  ν     (  t  )    -    ξ  ν  μ    (  t  )     )      ,     ξ   i  ν     (  t  )    :=    ∑   i  =  1   n     μ  i    (  t  )    ξ   i  ν     (  t  )         formulae-sequence   assign     superscript   subscript  τ    i  j    μ   t     superscript   subscript     ν  1    n          subscript  ξ    i  ν    t      superscript   subscript  ξ  ν   μ   t         subscript  ξ    j  ν    t      superscript   subscript  ξ  ν   μ   t        assign     subscript  ξ    i  ν    t     superscript   subscript     i  1    n      subscript  μ  i   t   subscript  ξ    i  ν    t       \tau_{ij}^{\mu}(t):=\sum_{\nu=1}^{n}(\xi_{i\nu}(t)-\xi_{\nu}^{\mu}(t))(\xi_{j%
 \nu}(t)-\xi_{\nu}^{\mu}(t)),\qquad\xi_{i\nu}(t):=\sum_{i=1}^{n}\mu_{i}(t)\xi_{%
 i\nu}(t)     with     1  ≤  i   ,   j  ≤  n      formulae-sequence    1  i     j  n     1\leq i,j\leq n   are called the relative covariances between    log   (   X  i   )        subscript  X  i     \log(X_{i})   and    log   (   X  j   )        subscript  X  j     \log(X_{j})   with respect to the market.  Examples   The constant function    𝔾  :=  w  >  0       assign  𝔾  w       0     \mathbb{G}:=w>0   generates the market portfolio    μ   μ   \mu   ,  The geometric mean function     ℍ   (  x  )    :=    (    x  1   ⋯   x  n    )    1  n       assign    ℍ  x    superscript     subscript  x  1   normal-⋯   subscript  x  n      1  n      \mathbb{H}(x):=(x_{1}\cdots x_{n})^{\frac{1}{n}}   generates the equal-weighted portfolio       φ  i    (  n  )    =   1  n          subscript  φ  i   n     1  n     \varphi_{i}(n)=\frac{1}{n}   for all    1  ≤  i  ≤  n        1  i       n     1\leq i\leq n   ,  The modified entropy function      𝕊  c    (  x  )    =   c  -    ∑   i  =  1   n     x  i   ⋅   log   (   x  i   )              superscript  𝕊  c   x     c    superscript   subscript     i  1    n    normal-⋅   subscript  x  i      subscript  x  i         \mathbb{S}^{c}(x)=c-\sum_{i=1}^{n}x_{i}\cdot\log(x_{i})   for any    c  >  0      c  0    c>0   generates the modified entropy-weighted portfolio ,  The function      𝔻   (  p  )     (  x  )    :=    (    ∑   i  =  1   n    x  i  p    )    1  p       assign     superscript  𝔻  p   x    superscript    superscript   subscript     i  1    n    superscript   subscript  x  i   p      1  p      \mathbb{D}^{(p)}(x):=(\sum_{i=1}^{n}x_{i}^{p})^{\frac{1}{p}}   with    0  <  p  <  1        0  p       1     0   generates the diversity-weighted portfolio       δ  i   (  p  )     (  t  )    =     (    μ  i    (  t  )    )   p      ∑   i  =  1   n      (    μ  i    (  t  )    )   p            superscript   subscript  δ  i   p   t      superscript     subscript  μ  i   t   p     superscript   subscript     i  1    n    superscript     subscript  μ  i   t   p       \delta_{i}^{(p)}(t)=\frac{(\mu_{i}(t))^{p}}{\sum_{i=1}^{n}(\mu_{i}(t))^{p}}   with drift process      (   1  -  p   )    γ   δ   (  p  )    *    (  t  )         1  p    superscript   subscript  γ   superscript  δ  p      t    (1-p)\gamma_{\delta^{(p)}}^{*}(t)   .   Arbitrage relative to the market  The excess growth rate of the market portfolio admits the representation     2   γ  μ  *    (  t  )    =    ∑   i  =  1   n     μ  i    (  t  )    τ   i  i   μ    (  t  )           2   superscript   subscript  γ  μ     t     superscript   subscript     i  1    n      subscript  μ  i   t   superscript   subscript  τ    i  i    μ   t      2\gamma_{\mu}^{*}(t)=\sum_{i=1}^{n}\mu_{i}(t)\tau_{ii}^{\mu}(t)   as a capitalization-weighted average relative stock variance. This quantity is nonnegative; if it happens to be bounded away from zero, namely         γ  μ  *    (  t  )    =    1  2     ∑   i  =  1   n     μ  i    (  t  )    τ   i  i   μ    (  t  )      ≥  h  >  0   ,           superscript   subscript  γ  μ     t       1  2     superscript   subscript     i  1    n      subscript  μ  i   t   superscript   subscript  τ    i  i    μ   t          h       0     \gamma_{\mu}^{*}(t)=\frac{1}{2}\sum_{i=1}^{n}\mu_{i}(t)\tau_{ii}^{\mu}(t)\geq h%
 >0,   for all    0  ≤  t  <  ∞        0  t           0\leq t<\infty   for some real constant   h   h   h   , then it can be shown using the F-G decomposition that, for every     T  >    𝕊   (   μ   (  0  )    )    /  h    ,      T      𝕊    μ  0    h     T>\mathbb{S}(\mu(0))/h,   there exists a constant    c  >  0      c  0    c>0   for which the modified entropic portfolio    Θ   (  c  )      superscript  normal-Θ  c    \Theta^{(c)}   is strict arbitrage relative to the market   μ   μ   \mu   over    [  0  ,  T  ]     0  T    [0,T]   ; see Fernholz and Karatzas (2005) for details. It is an open question, whether such arbitrage exists over arbitrary time horizons (for two special cases, in which the answer to this question turns out to be affirmative, please see the paragraph below and the next section).  If the eigenvalues of the covariance matrix     (    σ   i  j     (  t  )    )     1  ≤  i   ,   j  ≤  n       subscript     subscript  σ    i  j    t    formulae-sequence    1  i     j  n      (\sigma_{ij}(t))_{1\leq i,j\leq n}   are bounded away from both zero and infinity, the condition     γ  μ  *   ≥  h  >  0         superscript   subscript  γ  μ     h       0     \gamma_{\mu}^{*}\geq h>0   can be shown to be equivalent to diversity, namely     μ  max   ≤   1  -  ε        subscript  μ      1  ε     \mu_{\max}\leq 1-\varepsilon   for a suitable     ε  ∈   (  0  ,  1  )    .      ε   0  1     \varepsilon\in(0,1).   Then the diversity-weighted portfolio    δ   (  p  )      superscript  δ  p    \delta^{(p)}   leads to strict arbitrage relative to the market portfolio over sufficiently long time horizons; whereas, suitable modifications of this diversity-weighted portfolio realize such strict arbitrage over arbitrary time horizons.  An example: volatility-stabilized markets  We consider the example of a system of stochastic differential equations       d   log   (    X  i    (  t  )    )     =      α   2   μ  i    (  t  )      d  t   +     σ    μ  i    (  t  )      d   W  i    (  t  )           d       subscript  X  i   t           α    2   subscript  μ  i   t    d  t       σ     subscript  μ  i   t    d   subscript  W  i   t      d\log(X_{i}(t))=\frac{\alpha}{2\mu_{i}(t)}\,dt+\frac{\sigma}{\mu_{i}(t)}\,dW_{%
 i}(t)   with    1  ≤  i  ≤  n        1  i       n     1\leq i\leq n   given real constants    α  ≥  0      α  0    \alpha\geq 0   and an   n   n   n   -dimensional Brownian motion     (   W  1   ,  …  ,   W  n   )   .      subscript  W  1   normal-…   subscript  W  n     (W_{1},\dots,W_{n}).   It follows from the work of Bass and Perkins (2002) that this system has a weak solution, which is unique in distribution. Fernholz and Karatzas (2005) show how to construct this solution in terms of scaled and time-changed squared Bessel processes , and prove that the resulting system is coherent.  The total market capitalization   X   X   X   behaves here as geometric Brownian motion with drift, and has the same constant growth rate as the largest stock; whereas the excess growth rate of the market portfolio is a positive constant. On the other hand, the relative market weights    μ  i     subscript  μ  i    \mu_{i}   with    1  ≤  i  ≤  n        1  i       n     1\leq i\leq n   have the dynamics of multi-allele Wright-Fisher processes . This model is an example of a non-diverse market with unbounded variances, in which strong arbitrage opportunities with respect to the market portfolio   μ   μ   \mu   exist over arbitrary time horizons , as was shown by Banner and Fernholz (2008). Moreover, Pal (2012) derived the joint density of market weights at fixed times and at certain stopping times.  Rank-based portfolios  We fix an integer    m  ∈   {  2  ,  …  ,   n  -  1   }       m   2  normal-…    n  1      m\in\{2,\dots,n-1\}   and construct two capitalization-weighted portfolios: one consisting of the top   m   m   m   stocks, denoted   ζ   ζ   \zeta   , and one consisting of the bottom    n  -  m      n  m    n-m   stocks, denoted   η   η   \eta   . More specifically,         ζ  i    (  t  )    =     ∑   k  =  1   m     μ   (  k  )     (  t  )    𝟏   {   μ  i    (  t  )   =   μ   (  k  )     (  t  )   }        ∑   l  =  1   m     μ   (  l  )     (  t  )         and   η  i    (  t  )    =     ∑   k  =   m  +  1    n     μ   (  k  )     (  t  )    𝟏   {   μ  i    (  t  )   =   μ   (  k  )     (  t  )   }        ∑   l  =   m  +  1    n     μ   (  l  )     (  t  )          formulae-sequence       subscript  ζ  i   t       superscript   subscript     k  1    m      subscript  μ  k   t   subscript  1   fragments  normal-{   subscript  μ  i    fragments  normal-(  t  normal-)     subscript  μ  k    fragments  normal-(  t  normal-)   normal-}        superscript   subscript     l  1    m      subscript  μ  l   t          and   subscript  η  i   t       superscript   subscript     k    m  1     n      subscript  μ  k   t   subscript  1   fragments  normal-{   subscript  μ  i    fragments  normal-(  t  normal-)     subscript  μ  k    fragments  normal-(  t  normal-)   normal-}        superscript   subscript     l    m  1     n      subscript  μ  l   t        \zeta_{i}(t)=\frac{\sum_{k=1}^{m}\mu_{(k)}(t)\mathbf{1}_{\{\mu_{i}(t)=\mu_{(k)%
 }(t)\}}}{\sum_{l=1}^{m}\mu_{(l)}(t)}\qquad\text{ and }\eta_{i}(t)=\frac{\sum_{%
 k=m+1}^{n}\mu_{(k)}(t)\mathbf{1}_{\{\mu_{i}(t)=\mu_{(k)}(t)\}}}{\sum_{l=m+1}^{%
 n}\mu_{(l)}(t)}   for     1  ≤  i  ≤  n   .        1  i       n     1\leq i\leq n.   Fernholz (1999), (2002) showed that the relative performance of the large-stock portfolio with respect to the market is given as        log   (     Z  ζ    (  t  )      Z  μ    (  t  )     )    =    log   (      μ   (  1  )     (  T  )    +  ⋯  +    μ   (  m  )     (  T  )        μ   (  1  )     (  0  )    +  ⋯  +    μ   (  m  )     (  0  )      )    -    1  2     ∫  0  T        μ   (  m  )     (  t  )       μ   (  1  )     (  t  )    +  ⋯  +    μ   (  m  )     (  t  )       d   Λ   (  m  ,   m  +  1   )     (  t  )        .             subscript  Z  ζ   t      subscript  Z  μ   t                subscript  μ  1   T   normal-⋯     subscript  μ  m   T         subscript  μ  1   0   normal-⋯     subscript  μ  m   0          1  2     superscript   subscript   0   T          subscript  μ  m   t        subscript  μ  1   t   normal-⋯     subscript  μ  m   t     d   superscript  normal-Λ   m    m  1     t        \log\left(\frac{Z_{\zeta}(t)}{Z_{\mu}(t)}\right)=\log\left(\frac{\mu_{(1)}(T)+%
 \cdots+\mu_{(m)}(T)}{\mu_{(1)}(0)+\cdots+\mu_{(m)}(0)}\right)-\frac{1}{2}\int_%
 {0}^{T}\frac{\mu_{(m)}(t)}{\mu_{(1)}(t)+\cdots+\mu_{(m)}(t)}\,d\Lambda^{(m,m+1%
 )}(t).   Indeed, if there is no turnover at the mth rank during the interval    [  0  ,  T  ]     0  T    [0,T]   , the fortunes of   ζ   ζ   \zeta   relative to the market are determined solely on the basis of how the total capitalization of this sub-universe of the   m   m   m   largest stocks fares, at time   T   T   T   versus time 0; whenever there is turnover at the   m   m   m   -th rank, though,   ζ   ζ   \zeta   has to sell at a loss a stock that gets “relegated” to the lower league, and buy a stock that has risen in value and been promoted. This accounts for the “leakage” that is evident in the last term, an integral with respect to the cumulative turnover process    Λ   (  m  ,   m  +  1   )      superscript  normal-Λ   m    m  1      \Lambda^{(m,m+1)}   of the relative weight in the large-cap portfolio   ζ   ζ   \zeta   of the stock that occupies the mth rank.  The reverse situation prevails with the portfolio   η   η   \eta   of small stocks, which gets to sell at a profit stocks that are being promoted to the “upper capitalization” league, and buy relatively cheaply stocks that are being relegated:        log   (     Z  η    (  t  )      Z  μ    (  t  )     )    =    log   (      μ   (   m  +  1   )     (  T  )    +  ⋯  +    μ   (  n  )     (  T  )        μ   (   m  +  1   )     (  0  )    +  ⋯  +    μ   (  n  )     (  0  )      )    +    1  2     ∫  0  T      μ   (   m  +  1   )     (  t  )       μ   (   m  +  1   )     (  t  )    +  ⋯  +    μ   (  n  )     (  t  )          .             subscript  Z  η   t      subscript  Z  μ   t                subscript  μ    m  1    T   normal-⋯     subscript  μ  n   T         subscript  μ    m  1    0   normal-⋯     subscript  μ  n   0          1  2     superscript   subscript   0   T        subscript  μ    m  1    t        subscript  μ    m  1    t   normal-⋯     subscript  μ  n   t          \log\left(\frac{Z_{\eta}(t)}{Z_{\mu}(t)}\right)=\log\left(\frac{\mu_{(m+1)}(T)%
 +\cdots+\mu_{(n)}(T)}{\mu_{(m+1)}(0)+\cdots+\mu_{(n)}(0)}\right)+\frac{1}{2}%
 \int_{0}^{T}\frac{\mu_{(m+1)}(t)}{\mu_{(m+1)}(t)+\cdots+\mu_{(n)}(t)}.   It is clear from these two expressions that, in a coherent and stochastically stable market, the small- stock cap-weighted portfolio   ζ   ζ   \zeta   will tend to outperform its large-stock counterpart   η   η   \eta   , at least over large time horizons and; in particular, we have under those conditions        lim   T  →  ∞      1  T    log   (     Z  η    (  t  )      Z  μ    (  t  )     )      =    λ   (  m  ,   m  +  1   )    𝔼   (     M   (  1  )      M   (  1  )    +  ⋯  +   M   (  m  )      +    M   (   m  +  1   )      M   (   m  +  1   )    +  ⋯  +   M   (  n  )       )    >  0.          subscript    normal-→  T         1  T          subscript  Z  η   t      subscript  Z  μ   t          superscript  λ   m    m  1     𝔼       subscript  M  1      subscript  M  1   normal-⋯   subscript  M  m        subscript  M    m  1       subscript  M    m  1    normal-⋯   subscript  M  n            0.     \lim_{T\rightarrow\infty}\frac{1}{T}\log\left(\frac{Z_{\eta}(t)}{Z_{\mu}(t)}%
 \right)=\lambda^{(m,m+1)}\mathbb{E}\left(\frac{M_{(1)}}{M_{(1)}+\cdots+M_{(m)}%
 }+\frac{M_{(m+1)}}{M_{(m+1)}+\cdots+M_{(n)}}\right)>0.   This quantifies the so-called size effect . In Fernholz (1999, 2002), constructions such as these are generalized to include functionally generated portfolios based on ranked market weights.  First- and second-order models  First- and second-order models are hybrid Atlas models that reproduce some of the structure of real stock markets. First-order models have only rank-based parameters, and second-order models have both rank-based and name-based parameters.  Suppose that     X  1   ,  …  ,   X  n       subscript  X  1   normal-…   subscript  X  n     X_{1},\ldots,X_{n}   is a coherent market, and that the limits       σ  k  2   =    lim   t  →  ∞      t   -  1     ⟨   log   μ   (  k  )     ⟩    (  t  )          superscript   subscript  σ  k   2     subscript    normal-→  t        superscript  t    1     delimited-⟨⟩     subscript  μ  k     t      \mathbf{\sigma}_{k}^{2}=\lim_{t\to\infty}t^{-1}\langle\log\mu_{(k)}\rangle(t)     and       𝐠  k   =    lim   T  →  ∞      1  T     ∫  0  T     ∑   i  =  1   n      𝟏   {   r  t    (  i  )   =  k  }     d   log   μ  i     (  t  )             subscript  𝐠  k     subscript    normal-→  T         1  T     superscript   subscript   0   T     superscript   subscript     i  1    n      subscript  1   fragments  normal-{   subscript  r  t    fragments  normal-(  i  normal-)    k  normal-}    d     subscript  μ  i    t         \mathbf{g}_{k}=\lim_{T\to\infty}\frac{1}{T}\int_{0}^{T}\sum_{i=1}^{n}\mathbf{1%
 }_{\{r_{t}(i)=k\}}\,d\log\mu_{i}(t)     exist for    k  =   1  ,  …  ,   n        k   1  normal-…  n     k=1,\ldots,n\,   , where     r  t    (  i  )        subscript  r  t   i    r_{t}(i)   is the rank of     X  i    (  t  )        subscript  X  i   t    X_{i}(t)   . Then the Atlas model      X  ^   1   ,  …  ,    X  ^   n       subscript   normal-^  X   1   normal-…   subscript   normal-^  X   n     {\widehat{X}}_{1},\ldots,{\widehat{X}}_{n}   defined by        d   log    X  ^   i     (  t  )    =     ∑   k  =  1   n     𝐠  k     1   {    r  ^   t    (  i  )   =  k  }     d  t    +    ∑   k  =  1   n     σ  k     𝟏   {    r  ^   t    (  i  )   =  k  }     d   W  i    (  t  )       ,        d     subscript   normal-^  X   i    t       superscript   subscript     k  1    n      subscript  𝐠  k    subscript  1   fragments  normal-{   subscript   normal-^  r   t    fragments  normal-(  i  normal-)    k  normal-}    d  t      superscript   subscript     k  1    n      subscript  σ  k    subscript  1   fragments  normal-{   subscript   normal-^  r   t    fragments  normal-(  i  normal-)    k  normal-}    d   subscript  W  i   t       d\log{\widehat{X}}_{i}(t)=\sum_{k=1}^{n}\mathbf{g}_{k}\,\mathbf{1}_{\{{\hat{r}%
 }_{t}(i)=k\}}\,dt+\sum_{k=1}^{n}\mathbf{\sigma}_{k}\mathbf{1}_{\{{\hat{r}}_{t}%
 (i)=k\}}\,dW_{i}(t),     where      r  ^   t    (  i  )        subscript   normal-^  r   t   i    {\hat{r}}_{t}(i)   is the rank of      X  ^   i    (  t  )        subscript   normal-^  X   i   t    \widehat{X}_{i}(t)   and    (   W  1   ,  …  ,   W  n   )      subscript  W  1   normal-…   subscript  W  n     (W_{1},\ldots,W_{n})   is an   n   n   n   -dimensional Brownian motion process, is the first-order model for the original market,     X  1   ,  …  ,   X  n       subscript  X  1   normal-…   subscript  X  n     X_{1},\ldots,X_{n}   .  Under reasonable conditions, the capital distribution curve for a first-order model will be close to that of the original market. However, a first-order model is ergodic in the sense that each stock asymptotically spends    (   1  /  n   )      1  n    (1/n)   -th of its time at each rank, a property that is not present in actual markets. In order to vary the proportion of time that a stock spends at each rank, it is necessary to use some form of hybrid Atlas model with parameters that depend on both rank and name. An effort in this direction was made by Fernholz, Ichiba, and Karatzas (2013), who introduced a second-order model for the market with rank- and name-based growth parameters, and variance parameters that depended on rank alone.  References   Fernholz, E.R. (2002). Stochastic Portfolio Theory . New York: Springer-Verlag.   "  Category:Mathematical theorems  Category:Finance theories   
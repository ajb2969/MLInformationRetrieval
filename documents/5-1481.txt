   Variogram      Variogram   In spatial statistics the theoretical variogram     2  γ   (  x  ,  y  )       2  γ   x  y     2\gamma(x,y)   is a function describing the degree of spatial dependence of a spatial random field or stochastic process     Z   (  x  )       Z  x    Z(x)   .  For instance in mining a variogram will give a measure of how much two samples taken from the mining area will vary in gold percentage depending on the distance between those samples. Samples taken far apart will vary more than samples taken close to each other.  Definition  The variogram is defined as the variance of the difference between field values at two locations (   x   x   x   and   y   y   y   ) across realizations of the field (Cressie 1993):        2  γ   (  x  ,  y  )    =   var   (    Z   (  x  )    -   Z   (  y  )     )    =   E   [    (    (    Z   (  x  )    -   μ   (  x  )     )   -   (    Z   (  y  )    -   μ   (  y  )     )    )   2   ]     .          2  γ   x  y      var      Z  x     Z  y            E   delimited-[]   superscript        Z  x     μ  x        Z  y     μ  y     2        2\gamma(x,y)=\text{var}\left(Z(x)-Z(y)\right)=E\left[((Z(x)-\mu(x))-(Z(y)-\mu(%
 y)))^{2}\right].     If the spatial random field has constant mean   μ   μ   \mu   , this is equivalent to the expectation for the squared increment of the values between locations   x   x   x   and   y   y   y   (Wackernagel 2003) (where   x   x   x   and   y   y   y   are not coordinates but points in space):        2  γ   (  x  ,  y  )    =   E   [    (    Z   (  x  )    -   Z   (  y  )     )   2   ]     ,        2  γ   x  y      E   delimited-[]   superscript      Z  x     Z  y    2       2\gamma(x,y)=E\left[\left(Z(x)-Z(y)\right)^{2}\right],     where    γ   (  x  ,  y  )       γ   x  y     \gamma(x,y)   itself is called the semivariogram . In the case of a stationary process , the variogram and semivariogram can be represented as a function      γ  s    (  h  )    =   γ   (  0  ,   0  +  h   )           subscript  γ  s   h     γ   0    0  h       \gamma_{s}(h)=\gamma(0,0+h)   of the difference    h  =   y  -  x       h    y  x     h=y-x   between locations only, by the following relation (Cressie 1993):        γ   (  x  ,  y  )    =    γ  s    (   y  -  x   )     .        γ   x  y       subscript  γ  s     y  x      \gamma(x,y)=\gamma_{s}(y-x).     If the process is furthermore isotropic , then the variogram and semivariogram can be represented by a function      γ  i    (  h  )    :=    γ  s    (   h   e  1    )       assign     subscript  γ  i   h      subscript  γ  s     h   subscript  e  1       \gamma_{i}(h):=\gamma_{s}(he_{1})   of the distance    h  =   ∥   y  -  x   ∥       h   norm    y  x      h=\|y-x\|   only (Cressie 1993):        γ   (  x  ,  y  )    =    γ  i    (  h  )     .        γ   x  y       subscript  γ  i   h     \gamma(x,y)=\gamma_{i}(h).     The indexes   i   i   i   or   s   s   s   are typically not written. The terms are used for all three forms of the function. Moreover, the term "variogram" is sometimes used to denote the semivariogram, and the symbol   γ   γ   \gamma   is sometimes used for the variogram, which brings some confusion.  Properties  According to (Cressie 1993, Chiles and Delfiner 1999, Wackernagel 2003) the theoretical variogram has the following properties:   The semivariogram is nonnegative     γ   (  x  ,  y  )    ≥  0        γ   x  y    0    \gamma(x,y)\geq 0   , since it is the expectation of a square.  The semivariogram     γ   (  x  ,  x  )    =    γ  i    (  0  )    =   E   (    (    Z   (  x  )    -   Z   (  x  )     )   2   )    =  0          γ   x  x       subscript  γ  i   0          E   superscript      Z  x     Z  x    2         0     \gamma(x,x)=\gamma_{i}(0)=E\left((Z(x)-Z(x))^{2}\right)=0   at distance 0 is always 0, since      Z   (  x  )    -   Z   (  x  )     =  0          Z  x     Z  x    0    Z(x)-Z(x)=0   .  A function is a semivariogram if and only if it is a conditionally negative definite function, i.e. for all weights     w  1   ,  …  ,   w  N       subscript  w  1   normal-…   subscript  w  N     w_{1},\ldots,w_{N}   subject to      ∑   i  =  1   N    w  i    =  0        superscript   subscript     i  1    N    subscript  w  i    0    \sum_{i=1}^{N}w_{i}=0   and locations     x  1   ,  …  ,   x  N       subscript  x  1   normal-…   subscript  x  N     x_{1},\ldots,x_{N}   it holds:        ∑   i  =  1   N     ∑   j  =  1   N     w  i   γ   (   x  i   ,   x  j   )    w  j      ≤  0        superscript   subscript     i  1    N     superscript   subscript     j  1    N      subscript  w  i   γ    subscript  x  i    subscript  x  j     subscript  w  j      0    \sum_{i=1}^{N}\sum_{j=1}^{N}w_{i}\gamma(x_{i},x_{j})w_{j}\leq 0      which corresponds to the fact that the variance    v  a  r   (  X  )       v  a  r  X    var(X)   of    X  =    ∑   i  =  1   N     w  i   Z   (   x  i   )         X    superscript   subscript     i  1    N      subscript  w  i   Z   subscript  x  i       X=\sum_{i=1}^{N}w_{i}Z(x_{i})   is given by the negative of this double sum and must be nonnegative.  As a consequence the semivariogram might be non continuous only at the origin. The height of the jump at the origin is sometimes referred to as nugget or nugget effect.  If the covariance function of a stationary process exists it is related to variogram by       2  γ   (  x  ,  y  )    =     C   (  x  ,  x  )    +   C   (  y  ,  y  )     -   2  C   (  x  ,  y  )           2  γ   x  y          C   x  x      C   y  y       2  C   x  y       2\gamma(x,y)=C(x,x)+C(y,y)-2C(x,y)      For a non-stationary process the square of the difference between expected values at both points must be added:        2  γ   (  x  ,  y  )    =      C   (  x  ,  x  )    +   C   (  y  ,  y  )     -   2  C   (  x  ,  y  )     +    (    E   [   Z   (  x  )    ]    -   E   [   Z   (  y  )    ]     )   2          2  γ   x  y            C   x  x      C   y  y       2  C   x  y      superscript      E   delimited-[]    Z  x       E   delimited-[]    Z  y      2      2\gamma(x,y)=C(x,x)+C(y,y)-2C(x,y)+(E\left[Z(x)\right]-E\left[Z(y)\right])^{2}      If a stationary random field has no spatial dependence (i.e.     C   (  h  )    =  0        C  h   0    C(h)=0   if    h  ≠  0      h  0    h\not=0   ), the semivariogram is the constant    v  a  r   (   Z   (  x  )    )       v  a  r    Z  x     var(Z(x))   everywhere except at the origin, where it is zero.       γ   (  x  ,  y  )    =   E   [    |    Z   (  x  )    -   Z   (  y  )     |   2   ]    =   γ   (  y  ,  x  )            γ   x  y      E   delimited-[]   superscript        Z  x     Z  y     2            γ   y  x       \gamma(x,y)=E\left[|Z(x)-Z(y)|^{2}\right]=\gamma(y,x)   is a symmetric function.  Consequently,      γ  s    (  h  )    =    γ  s    (   -  h   )           subscript  γ  s   h      subscript  γ  s     h      \gamma_{s}(h)=\gamma_{s}(-h)   is an even function .  If the random field is stationary and ergodic , the      lim   h  →  ∞      γ  s    (  h  )     =   v  a  r   (   Z   (  x  )    )          subscript    normal-→  h        subscript  γ  s   h      v  a  r    Z  x      \lim_{h\to\infty}\gamma_{s}(h)=var(Z(x))   corresponds to the variance of the field. The limit of the semivariogram is also called its sill .   Empirical variogram  For observations       z  i   ,  i   =  1   ,   …  ,  k      formulae-sequence      subscript  z  i   i   1    normal-…  k     z_{i},\;i=1,\ldots,k   at locations     x  1   ,  …  ,   x  k       subscript  x  1   normal-…   subscript  x  k     x_{1},\ldots,x_{k}   the empirical variogram     γ  ^    (  h  )        normal-^  γ   h    \hat{\gamma}(h)   is defined as (Cressie 1993):        γ  ^    (  h  )    :=    1   2   |   N   (  h  )    |       ∑    (  i  ,  j  )   ∈   N   (  h  )        |    z  i   -   z  j    |   2        assign     normal-^  γ   h       1    2      N  h        subscript      i  j     N  h      superscript       subscript  z  i    subscript  z  j     2       \hat{\gamma}(h):=\frac{1}{2|N(h)|}\sum_{(i,j)\in N(h)}|z_{i}-z_{j}|^{2}     where    N   (  h  )       N  h    N(h)   denotes the set of pairs of observations    i  ,  j     i  j    i,\;j   such that     |    x  i   -   x  j    |   =  h           subscript  x  i    subscript  x  j     h    |x_{i}-x_{j}|=h   , and    |   N   (  h  )    |        N  h     |N(h)|   is the number of pairs in the set. (Generally an "approximate distance"   h   h   h   is used, implemented using a certain tolerance.)  The empirical variogram is used in geostatistics as a first estimate of the (theoretical) variogram needed for spatial interpolation by kriging .  According to (Cressie 1993), for observations     z  i   =   Z   (   x  i   )         subscript  z  i     Z   subscript  x  i      z_{i}=Z(x_{i})   from a stationary  random field     Z   (  x  )       Z  x    Z(x)   , the empirical variogram with lag tolerance 0 is an unbiased estimator of the theoretical variogram, due to:       E   [    γ  ^    (  h  )    ]    =    1   2   |   N   (  h  )    |       ∑    (  i  ,  j  )   ∈   N   (  h  )       E   [    |    Z   (   x  i   )    -   Z   (   x  j   )     |   2   ]      =    1   2   |   N   (  h  )    |       ∑    (  i  ,  j  )   ∈   N   (  h  )       2  γ   (    x  j   -   x  i    )      =     2   |   N   (  h  )    |     2   |   N   (  h  )    |     γ   (  h  )            E   delimited-[]     normal-^  γ   h         1    2      N  h        subscript      i  j     N  h       E   delimited-[]   superscript        Z   subscript  x  i      Z   subscript  x  j      2                1    2      N  h        subscript      i  j     N  h       2  γ     subscript  x  j    subscript  x  i                  2      N  h       2      N  h      γ  h      E\left[\hat{\gamma}(h)\right]=\frac{1}{2|N(h)|}\sum_{(i,j)\in N(h)}E\left[|Z(x%
 _{i})-Z(x_{j})|^{2}\right]=\frac{1}{2|N(h)|}\sum_{(i,j)\in N(h)}2\gamma(x_{j}-%
 x_{i})=\frac{2|N(h)|}{2|N(h)|}\gamma(h)     Variogram parameters  The following parameters are often used to describe variograms:   nugget    n   n   n   : The height of the jump of the semivariogram at the discontinuity at the origin.  sill    s   s   s   : Limit of the variogram tending to infinity lag distances.  range    r   r   r   : The distance in which the difference of the variogram from the sill becomes negligible. In models with a fixed sill, it is the distance at which this is first reached; for models with an asymptotic sill, it is conventionally taken to be the distance when the semivariance first reaches 95% of the sill.   Variogram models  The empirical variogram cannot be computed at every lag distance   h   h   h   and due to variation in the estimation it is not ensured that it is a valid variogram, as defined above. However some Geostatistical methods such as kriging need valid semivariograms. In applied geostatistics the empirical variograms are thus often approximated by model function ensuring validity (Chiles&Delfiner; 1999). Some important models are (Chiles&Delfiner; 1999, Cressie 1993):   The exponential variogram model          γ   (  h  )    =     (   s  -  n   )    (   1  -   exp   (   -   h  /   (   r  a   )     )     )    +   n   1   (  0  ,  ∞  )     (  h  )           γ  h         s  n     1        h    r  a          n   subscript  1   0     h      \gamma(h)=(s-n)(1-\exp(-h/(ra)))+n1_{(0,\infty)}(h)         The spherical variogram model          γ   (  h  )    =     (   s  -  n   )    (     (     3  h    2  r    -    h  3    2   r  3      )    1   (  0  ,  r  )     (  h  )    +    1   [  r  ,  ∞  )     (  h  )     )    +   n   1   (  0  ,  ∞  )     (  h  )           γ  h         s  n             3  h     2  r       superscript  h  3     2   superscript  r  3       subscript  1   0  r    h      subscript  1   r     h       n   subscript  1   0     h      \gamma(h)=(s-n)\left(\left(\frac{3h}{2r}-\frac{h^{3}}{2r^{3}}\right)1_{(0,r)}(%
 h)+1_{[r,\infty)}(h)\right)+n1_{(0,\infty)}(h)         The Gaussian variogram model          γ   (  h  )    =     (   s  -  n   )    (   1  -   exp   (   -    h  2     r  2   a     )     )    +   n   1   (  0  ,  ∞  )     (  h  )           γ  h         s  n     1         superscript  h  2      superscript  r  2   a          n   subscript  1   0     h      \gamma(h)=(s-n)\left(1-\exp\left(-\frac{h^{2}}{r^{2}a}\right)\right)+n1_{(0,%
 \infty)}(h)        The parameter   a   a   a   has different values in different references, due to the ambiguity in the definition of the range. E.g.    a  =   1  /  3       a    1  3     a=1/3   is the value used in (Chiles&Delfiner; 1999). The     1  A    (  h  )        subscript  1  A   h    1_{A}(h)   function is 1 if    h  ∈  A      h  A    h\in A   and 0 otherwise.  Discussion  Three functions are used in geostatistics for describing the spatial or the temporal correlation of observations: these are the correlogram , the covariance and the semivariogram . The last is also more simply called variogram . The sampling variogram , unlike the semivariogram and the variogram, shows where a significant degree of spatial dependence in the sample space or sampling unit dissipates into randomness when the variance terms of a temporally or in-situ ordered set are plotted against the variance of the set and the lower limits of its 99% and 95% confidence ranges.  The variogram is the key function in geostatistics as it will be used to fit a model of the temporal/ spatial correlation of the observed phenomenon. One is thus making a distinction between the experimental variogram that is a visualisation of a possible spatial/temporal correlation and the variogram model that is further used to define the weights of the kriging function. Note that the experimental variogram is an empirical estimate of the covariance of a Gaussian process . As such, it may not be positive definite and hence not directly usable in kriging , without constraints or further processing. This explains why only a limited number of variogram models are used: most commonly, the linear, the spherical, the Gaussian and the exponential models.  Related concepts  The squared term in the variogram, for instance     (    Z   (  x  )    -   Z   (  y  )     )   2     superscript      Z  x     Z  y    2    (Z(x)-Z(y))^{2}   , can be replaced with different powers: A madogram is defined with the absolute difference ,    |    Z   (  x  )    -   Z   (  y  )     |          Z  x     Z  y      |Z(x)-Z(y)|   , and a rodogram is defined with the square root of the absolute difference,     |    Z   (  x  )    -   Z   (  y  )     |   0.5     superscript        Z  x     Z  y     0.5    |Z(x)-Z(y)|^{0.5}   . Estimators based on these lower powers are said to be more resistant to outliers . They can be generalized as a "variogram of order α ",       2  γ   (  x  ,  y  )    =   E   [    |    Z   (  x  )    -   Z   (  y  )     |   α   ]          2  γ   x  y      E   delimited-[]   superscript        Z  x     Z  y     α       2\gamma(x,y)=E\left[\left|Z(x)-Z(y)\right|^{\alpha}\right]   ,  in which a variogram is of order 2, a madogram is a variogram of order 1, and a rodogram is a variogram of order 0.5. 1  When a variogram is used to describe the correlation of different variables it is called cross-variogram . Cross-variograms are used in co-kriging . Should the variable be binary or represent classes of values, one is then talking about indicator variograms . Indicator variogram is used in indicator kriging .  See also   Covariance function  Semivariance   References   Cressie, N., 1993, Statistics for spatial data, Wiley Interscience  Chiles, J. P., P. Delfiner, 1999, Geostatistics, Modelling Spatial Uncertainty, Wiley-Interscience  Wackernagel, H., 2003, Multivariate Geostatistics, Springer  Burrough, P A and McDonnell, R A, 1998, Principles of Geographical Information Systems  Isobel Clark, 1979, Practical Geostatistics, Applied Science Publishers   External links   AI-GEOSTATS: an educational resource about geostatistics and spatial statistics  Practical Geostatistics 1979 by Isobel Clark : an introduction to geostatistics  Geostatistics: Lecture by Rudolf Dutter at the Technical University of Vienna   "  Category:Geostatistics  Category:Statistical deviation and dispersion  Category:Spatial processes     ↩     
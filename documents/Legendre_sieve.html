<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1355">Legendre sieve</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Legendre sieve</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, the <strong>Legendre sieve</strong>, named after <a href="Adrien-Marie_Legendre" title="wikilink">Adrien-Marie Legendre</a>, is the simplest method in modern <a href="sieve_theory" title="wikilink">sieve theory</a>. It applies the concept of the <a href="Sieve_of_Eratosthenes" title="wikilink">Sieve of Eratosthenes</a> to find upper or lower <a href="upper_bound" title="wikilink">bounds</a> on the number of <a href="prime_number" title="wikilink">primes</a> within a given set of integers. Because it is a simple extension of <a class="uri" href="Eratosthenes" title="wikilink">Eratosthenes</a>' idea, it is sometimes called the <strong>Legendre–Eratosthenes sieve</strong>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="legendres-identity">Legendre's identity</h2>

<p>The central idea of the method is expressed by the following identity, sometimes called the <strong>Legendre identity</strong>:</p>

<p>

<math display="block" id="Legendre_sieve:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>P</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>a</mi>
       <mo>∈</mo>
       <mi>A</mi>
      </mrow>
     </munder>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>d</mi>
        <mo>∣</mo>
        <mi>a</mi>
        <mo rspace="4.2pt">;</mo>
        <mi>d</mi>
        <mo>∣</mo>
        <mi>P</mi>
       </mrow>
      </munder>
      <mrow>
       <mi>μ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>d</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo>∣</mo>
       <mi>P</mi>
      </mrow>
     </munder>
     <mrow>
      <mi>μ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>d</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>A</mi>
        <mi>d</mi>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <interval closure="open">
       <ci>A</ci>
       <ci>P</ci>
      </interval>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <in></in>
        <ci>a</ci>
        <ci>A</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">d</csymbol>
         <ci>normal-∣</ci>
         <csymbol cd="unknown">a</csymbol>
         <ci>normal-;</ci>
         <csymbol cd="unknown">d</csymbol>
         <ci>normal-∣</ci>
         <csymbol cd="unknown">P</csymbol>
        </cerror>
       </apply>
       <apply>
        <times></times>
        <ci>μ</ci>
        <ci>d</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">P</csymbol>
       </cerror>
      </apply>
      <apply>
       <times></times>
       <ci>μ</ci>
       <ci>d</ci>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <ci>d</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(A,P)=\sum_{a\in A}\sum_{d\mid a;\,d\mid P}\mu(d)=\sum_{d\mid P}\mu(d)|A_{d}|,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em> is a set of integers, <em>P</em> is a product of distinct primes, 

<math display="inline" id="Legendre_sieve:1">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 is the <a href="Möbius_function" title="wikilink">Möbius function</a>, and 

<math display="inline" id="Legendre_sieve:2">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>d</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{d}
  </annotation>
 </semantics>
</math>

 is the set of integers in <em>A</em> divisible by <em>d</em>, and <em>S(A, P)</em> is defined to be:</p>

<p>

<math display="block" id="Legendre_sieve:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo>,</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mi>n</mi>
     <mo>:</mo>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mo>∈</mo>
       <mi>A</mi>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo>,</mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <interval closure="open">
      <ci>A</ci>
      <ci>P</ci>
     </interval>
    </apply>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="latexml">conditional-set</csymbol>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <in></in>
        <ci>n</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <eq></eq>
        <interval closure="open">
         <ci>n</ci>
         <ci>P</ci>
        </interval>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(A,P)=|\{n:n\in A,(n,P)=1\}|
  </annotation>
 </semantics>
</math>

</p>

<p>i.e. <em>S</em>(<em>A</em>, <em>P</em>) is the count of numbers in <em>A</em> with no factors common with <em>P</em>.</p>

<p>Note that in the most typical case, <em>A</em> is all integers less than or equal to some real number <em>X</em>, <em>P</em> is the product of all primes less than or equal to some integer <em>z</em>  \begin{align} S(A,P) &amp; = \sum_{d\mid P}\mu(d)\left\lfloor\frac{X}{d}\right\rfloor \\ &amp; = [X] - \sum_{p_1 </p>

<p>(where 

<math display="inline" id="Legendre_sieve:4">
 <semantics>
  <mrow>
   <mo stretchy="false">⌊</mo>
   <mi>X</mi>
   <mo stretchy="false">⌋</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <floor></floor>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lfloor X\rfloor
  </annotation>
 </semantics>
</math>

 denotes the <a href="floor_function" title="wikilink">floor function</a>). In this example the fact that the Legendre identity is derived from the Sieve of Eratosthenes is clear: the first term is the number of integers below <em>X</em>, the second term removes the multiples of all primes, the third term adds back the multiples of two primes (which were miscounted by being "crossed out twice"), and so on until all 

<math display="inline" id="Legendre_sieve:5">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mi>π</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <times></times>
     <ci>π</ci>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{\pi(z)}
  </annotation>
 </semantics>
</math>

 (where 

<math display="inline" id="Legendre_sieve:6">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>π</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(z)
  </annotation>
 </semantics>
</math>

 denotes the number of primes below <em>z</em>) combinations of primes have been covered.</p>

<p>Once <em>S</em>(<em>A</em>, <em>P</em>) has been calculated for this special case, it can be used to bound 

<math display="inline" id="Legendre_sieve:7">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>π</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi(X)
  </annotation>
 </semantics>
</math>

 using the expression</p>

<p>

<math display="block" id="Legendre_sieve:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>P</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≥</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>π</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>π</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <times></times>
     <ci>S</ci>
     <interval closure="open">
      <ci>A</ci>
      <ci>P</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>π</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <times></times>
       <ci>π</ci>
       <ci>z</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(A,P)\geq\pi(X)-\pi(z)+1,\,
  </annotation>
 </semantics>
</math>

</p>

<p>which follows immediately from the definition of <em>S</em>(<em>A</em>, <em>P</em>).</p>
<h2 id="limitations">Limitations</h2>

<p>Unfortunately, the Legendre sieve has a problem with fractional parts of terms accumulating into a large error, which means the sieve only gives very weak bounds in most cases. For this reason it is almost never used in practice, having been superseded by other techniques such as the <a href="Brun_sieve" title="wikilink">Brun sieve</a> and <a href="Selberg_sieve" title="wikilink">Selberg sieve</a>. However, since these more powerful sieves are extensions of the basic ideas of the Legendre sieve, it is useful to first understand how this sieve works.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Sieve_theory" title="wikilink">Category:Sieve theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Iwaniec, Henryk. <a href="http://www.numdam.org/item?id=ASNSP_1977_4_4_2_257_0">The sieve of Eratosthenes-Legendre</a>. Annali della Scuola Normale Superiore di Pisa - Classe di Scienze, Sér. 4, 4 no. 2 (1977), p. 257-268 MR <a href="http://www.ams.org/mathscinet-getitem?mr=453676">453676</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

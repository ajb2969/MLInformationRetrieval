   ProbCons      ProbCons   ProbCons is an open source probabilistic consistency-based multiple alignment of amino acid sequences. It is an efficient protein multiple sequence alignment program, which has demonstrated a statistically significant improvement in accuracy compared to several leading alignment tools. 1  Algorithm  The following describes the basic outline of the ProbCons algorithm. 2  Step 1: Reliability of an alignment edge  For every pair of sequences compute the probability that letters    x  i     subscript  x  i    x_{i}   and    y  i     subscript  y  i    y_{i}   are paired in    a  *     superscript  a     a^{*}   an alignment that is generated by the model.         P   (   x  i   ‚àº   y  i   |  x  ,  y  )        =   d  e  f    P  r   [   x  i   ‚àº   y  i   in some a  |  x  ,  y  ]          =    ‚àë    alignment a with   x  i    -   y  i      P  r   [  a  |  x  ,  y  ]          =    ‚àë  alignment a    ùüè   {   x  i   -   y  i   ‚àà  a  }   P  r   [  a  |  x  ,  y  ]           fragments  P   fragments  normal-(   subscript  x  i   similar-to   subscript  y  i   normal-|  x  normal-,  y  normal-)     fragments   superscript     d  e  f    P  r   fragments  normal-[   subscript  x  i   similar-to   subscript  y  i   in some a  normal-|  x  normal-,  y  normal-]       missing-subexpression    fragments    subscript       alignment a with   subscript  x  i     subscript  y  i     P  r   fragments  normal-[  a  normal-|  x  normal-,  y  normal-]       missing-subexpression    fragments    subscript   alignment a   1   fragments  normal-{   subscript  x  i     subscript  y  i    a  normal-}   P  r   fragments  normal-[  a  normal-|  x  normal-,  y  normal-]       \begin{aligned}\displaystyle P(x_{i}\sim y_{i}|x,y)&\displaystyle\stackrel{def%
 }{=}Pr[x_{i}\sim y_{i}\text{ in some a }|x,y]\\
 &\displaystyle=\sum_{\text{alignment a with }x_{i}-y_{i}}Pr[a|x,y]\\
 &\displaystyle=\sum_{\text{alignment a}}\mathbf{1}\{x_{i}-y_{i}\in a\}Pr[a|x,y%
 ]\end{aligned}     (Where    ùüè   {   x  i   ‚àº   y  i   ‚àà  a  }      fragments  1   fragments  normal-{   subscript  x  i   similar-to   subscript  y  i    a  normal-}     \mathbf{1}\{x_{i}\sim y_{i}\in a\}   is equal to 1 if    x  i     subscript  x  i    x_{i}   and    y  i     subscript  y  i    y_{i}   are in the alignment and 0 otherwise.)  Step 2: Maximum expected accuracy  The accuracy of an alignment    a  *     superscript  a     a^{*}   with respect to another alignment   a   a   a   is defined as the number of common aligned pairs divided by the length of the shorter sequence.  Calculate expected accuracy of each sequence:          E   P  r   [  a  |  x  ,  y  ]      (   a  c  c   (   a  *   ,  a  )    )       =    ‚àë  a    P  r   [  a  |  x  ,  y  ]   a  c  c   (   a  *   ,  a  )          =    1   m  i  n   (   |  x  |   ,   |  y  |   )      ‚ãÖ    ‚àë  a    ùüè   {   x  i   ‚àº   y  i   ‚àà  a  }   P  r   [  a  |  x  ,  y  ]          =    1   m  i  n   (   |  x  |   ,   |  y  |   )      ‚ãÖ    ‚àë    x  i   -   y  i      P   (   x  i   ‚àº   y  j   |  x  ,  y  )             subscript  E   fragments  P  r   fragments  normal-[  a  normal-|  x  normal-,  y  normal-]       a  c  c    superscript  a    a      fragments    subscript   a   P  r   fragments  normal-[  a  normal-|  x  normal-,  y  normal-]   a  c  c   fragments  normal-(   superscript  a    normal-,  a  normal-)       missing-subexpression    fragments     1    m  i  n     x     y      normal-‚ãÖ   subscript   a   1   fragments  normal-{   subscript  x  i   similar-to   subscript  y  i    a  normal-}   P  r   fragments  normal-[  a  normal-|  x  normal-,  y  normal-]       missing-subexpression    fragments     1    m  i  n     x     y      normal-‚ãÖ   subscript      subscript  x  i    subscript  y  i     P   fragments  normal-(   subscript  x  i   similar-to   subscript  y  j   normal-|  x  normal-,  y  normal-)       \begin{aligned}\displaystyle E_{Pr[a|x,y]}(acc(a^{*},a))&\displaystyle=\sum_{a%
 }Pr[a|x,y]acc(a^{*},a)\\
 &\displaystyle=\frac{1}{min(|x|,|y|)}\cdot\sum_{a}\mathbf{1}\{x_{i}\sim y_{i}%
 \in a\}Pr[a|x,y]\\
 &\displaystyle=\frac{1}{min(|x|,|y|)}\cdot\sum_{x_{i}-y_{i}}P(x_{i}\sim y_{j}|%
 x,y)\end{aligned}     This yields a maximum expected accuracy (MEA) alignment:       E   (  x  ,  y  )    =    arg     max   a  *      E   P  r   [  a  |  x  ,  y  ]        (   a  c  c   (   a  *   ,  a  )    )          E   x  y          subscript    superscript  a      subscript  E   fragments  P  r   fragments  normal-[  a  normal-|  x  normal-,  y  normal-]         a  c  c    superscript  a    a       E(x,y)=\arg\max_{a^{*}}\;E_{Pr[a|x,y]}(acc(a^{*},a))     Step 3: Probabilistic Consistency Transformation  All pairs of sequences x,y from the set of all sequences   ùíÆ   ùíÆ   \mathcal{S}   are now re-estimated using all intermediate sequences z:       P  ‚Ä≤    (   x  i   -   y  i   |  x  ,  y  )   =   1   |  ùíÆ  |     ‚àë  z    ‚àë   1  ‚â§  k  ‚â§   |  z  |     P   (   x  i   ‚àº   z  i   |  x  ,  z  )   ‚ãÖ  P   (   z  i   ‚àº   y  i   |  z  ,  y  )      fragments   superscript  P  normal-‚Ä≤    fragments  normal-(   subscript  x  i     subscript  y  i   normal-|  x  normal-,  y  normal-)      1    ùíÆ     subscript   z    subscript       1  k         z      P   fragments  normal-(   subscript  x  i   similar-to   subscript  z  i   normal-|  x  normal-,  z  normal-)   normal-‚ãÖ  P   fragments  normal-(   subscript  z  i   similar-to   subscript  y  i   normal-|  z  normal-,  y  normal-)     P^{\prime}(x_{i}-y_{i}|x,y)=\frac{1}{|\mathcal{S}|}\sum_{z}\sum_{1\leq k\leq|z%
 |}P(x_{i}\sim z_{i}|x,z)\cdot P(z_{i}\sim y_{i}|z,y)     This step can be iterated.  Step 4: Computation of guide tree  Construct a guide tree by hierarchical clustering using MEA score as sequence similarity score. Cluster similarity is defined using weighted average over pairwise sequence similarity.  Step 5: Compute MSA  Finally compute the MSA using progressive alignment or iterative alignment.  See also   Sequence alignment software  Clustal  MUSCLE  AMAP  T-Coffee  Probalign  ProbConsRNA ‚Äî for nucleotide sequences   References  External links     "  Category:Bioinformatics  Category:Computational phylogenetics     ‚Ü©  Lecture "Bioinformatics II" at University of Freiburg 1 ‚Ü©     
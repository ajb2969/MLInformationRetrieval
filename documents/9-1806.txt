   ItÅ diffusion      ItÅ diffusion   In mathematics â€” specifically, in stochastic analysis â€” an ItÅ diffusion is a solution to a specific type of stochastic differential equation . That equation is similar to the Langevin equation used in physics to describe the Brownian motion of a particle subjected to a potential in a viscous fluid. ItÅ diffusions are named after the Japanese  mathematician  Kiyoshi ItÅ .  Overview  (Figure)  This Wiener process (Brownian motion) in three-dimensional space (one sample path shown) is an example of an ItÅ diffusion.   A ( time-homogeneous ) ItÅ diffusion in n -dimensional Euclidean space  R n is a process  X :Â [0,Â +âˆ)Â Ã—Â Î©Â â†’ R n defined on a probability space (Î©,Â Î£, P ) and satisfying a stochastic differential equation of the form        d   X  t    =    b   (   X  t   )   d  t   +   Ïƒ   (   X  t   )   d   B  t      ,        normal-d   subscript  X  t        b   subscript  X  t   normal-d  t     Ïƒ   subscript  X  t   normal-d   subscript  B  t       \mathrm{d}X_{t}=b(X_{t})\,\mathrm{d}t+\sigma(X_{t})\,\mathrm{d}B_{t},     where B is an m -dimensional Brownian motion and b : R n â†’ R n and ÏƒÂ : R n â†’ R n Ã— m satisfy the usual Lipschitz continuity condition        |    b   (  x  )    -   b   (  y  )     |   +   |    Ïƒ   (  x  )    -   Ïƒ   (  y  )     |    â‰¤   C   |   x  -  y   |                b  x     b  y           Ïƒ  x     Ïƒ  y        C      x  y       |b(x)-b(y)|+|\sigma(x)-\sigma(y)|\leq C|x-y|     for some constant C and all x , y âˆˆ R n ; this condition ensures the existence of a unique strong solution  X to the stochastic differential equation given above. The vector field  b is known as the drift coefficient of X ; the matrix field Ïƒ is known as the diffusion coefficient of X . It is important to note that b and Ïƒ do not depend upon time; if they were to depend upon time, X would be referred to only as an ItÅ process , not a diffusion. ItÅ diffusions have a number of nice properties, which include   sample and Feller continuity ;  the Markov property ;  the strong Markov property ;  the existence of an infinitesimal generator ;  the existence of a characteristic operator ;  Dynkin's formula .   In particular, an ItÅ diffusion is a continuous, strongly Markovian process such that the domain of its characteristic operator includes all twice-continuously differentiable functions, so it is a diffusion in the sense defined by Dynkin (1965).  Continuity  Sample continuity  An ItÅ diffusion X is a sample continuous process , i.e., for almost all realisations B t (Ï‰) of the noise, X t (Ï‰) is a continuous function of the time parameter, t . More accurately, there is a "continuous version" of X , a continuous process Y so that      ğ   [   X  t   =   Y  t   ]   =  1  for all  t  .     fragments  P   fragments  normal-[   subscript  X  t     subscript  Y  t   normal-]    1  for all  t  normal-.    \mathbf{P}[X_{t}=Y_{t}]=1\mbox{ for all }t.     This follows from the standard existence and uniqueness theory for strong solutions of stochastic differential equations.  Feller continuity  In addition to being (sample) continuous, an ItÅ diffusion X satisfies the stronger requirement to be a Feller-continuous process .  For a point x âˆˆ R n , let P x denote the law of X given initial datum X 0 = x , and let E x denote expectation with respect to P x .  Let f : R n â†’ R be a Borel - measurable function that is bounded below and define, for fixed t â‰¥Â 0, u : R n â†’ R by        u   (  x  )    =    ğ„  x    [   f   (   X  t   )    ]     .        u  x      superscript  ğ„  x    delimited-[]    f   subscript  X  t        u(x)=\mathbf{E}^{x}[f(X_{t})].      Lower semi-continuity : if f is lower semi-continuous, then u is lower semi-continuous.  Feller continuity: if f is bounded and continuous, then u is continuous.   The behaviour of the function u above when the time t is varied is addressed by the Kolmogorov backward equation, the Fokkerâ€“Planck equation, etc. (See below.)  The Markov property  The Markov property  An ItÅ diffusion X has the important property of being Markovian : the future behaviour of X , given what has happened up to some time t , is the same as if the process had been started at the position X t at time 0. The precise mathematical formulation of this statement requires some additional notation:  Let Î£ âˆ— denote the natural  filtration of (Î©,Â Î£) generated by the Brownian motion B : for t â‰¥Â 0,        Î£  t   =   Î£  t  B   =   Ïƒ   {     B  s   -  1     (  A  )    âŠ†   Î©    :    0  â‰¤  s  â‰¤  t   ,   A  âŠ†    ğ‘  n   Borel     }     .         subscript  normal-Î£  t    superscript   subscript  normal-Î£  t   B          Ïƒ   conditional-set       superscript   subscript  B  s     1    A   normal-Î©    formulae-sequence      0  s       t      A     superscript  ğ‘  n   Borel          \Sigma_{t}=\Sigma_{t}^{B}=\sigma\left\{B_{s}^{-1}(A)\subseteq\Omega\ :\ 0\leq s%
 \leq t,A\subseteq\mathbf{R}^{n}\mbox{ Borel}\right\}.     It is easy to show that X is adapted to Î£ âˆ— (i.e. each X t is Î£ t -measurable), so the natural filtration F âˆ— = F âˆ— X of (Î©,Â Î£) generated by X has F t âŠ†Â Î£ t for each t â‰¥Â 0.  Let f : R n â†’ R be a bounded, Borel-measurable function. Then, for all t and h â‰¥Â 0, the conditional expectation conditioned on the Ïƒ-algebra Î£ t and the expectation of the process "restarted" from X t satisfy the Markov property :       ğ„  x    [  f   (   X   t  +  h    )   |   Î£  t   ]    (  Ï‰  )   =   ğ„    X  t    (  Ï‰  )      [  f   (   X  h   )   ]   .     fragments   superscript  ğ„  x    fragments  normal-[  f   fragments  normal-(   subscript  X    t  h    normal-)   normal-|   subscript  normal-Î£  t   normal-]    fragments  normal-(  Ï‰  normal-)     superscript  ğ„     subscript  X  t   Ï‰     fragments  normal-[  f   fragments  normal-(   subscript  X  h   normal-)   normal-]   normal-.    \mathbf{E}^{x}\big[f(X_{t+h})\big|\Sigma_{t}\big](\omega)=\mathbf{E}^{X_{t}(%
 \omega)}[f(X_{h})].     In fact, X is also a Markov process with respect to the filtration F âˆ— , as the following shows:       ğ„  x    [  f   (   X   t  +  h    )   |   F  t   ]      fragments   superscript  ğ„  x    fragments  normal-[  f   fragments  normal-(   subscript  X    t  h    normal-)   normal-|   subscript  F  t   normal-]     \displaystyle\mathbf{E}^{x}\left[f(X_{t+h})\big|F_{t}\right]     The strong Markov property  The strong Markov property is a generalization of the Markov property above in which t is replaced by a suitable random time Ï„Â :Â Î©Â â†’Â [0,Â +âˆ] known as a stopping time . So, for example, rather than "restarting" the process X at time t =Â 1, one could "restart" whenever X first reaches some specified point p of R n .  As before, let f : R n â†’ R be a bounded, Borel-measurable function. Let Ï„ be a stopping time with respect to the filtration Î£ âˆ— with Ï„Â \mathbf{E}^{x} \big[ f(X_{\tau+h}) \big| \Sigma_{\tau} \big] = \mathbf{E}^{X_{\tau}} \big[ f(X_{h}) \big].  The generator  Definition  Associated to each ItÅ diffusion, there is a second-order partial differential operator known as the generator of the diffusion. The generator is very useful in many applications and encodes a great deal of information about the process X . Formally, the infinitesimal generator of an ItÅ diffusion X is the operator A , which is defined to act on suitable functions f : R n â†’ R by        A  f   (  x  )    =    lim   t  â†“  0        ğ„  x    [   f   (   X  t   )    ]    -   f   (  x  )     t     .        A  f  x     subscript    normal-â†“  t  0           superscript  ğ„  x    delimited-[]    f   subscript  X  t        f  x    t      Af(x)=\lim_{t\downarrow 0}\frac{\mathbf{E}^{x}[f(X_{t})]-f(x)}{t}.     The set of all functions f for which this limit exists at a point x is denoted D A ( x ), while D A denotes the set of all f for which the limit exists for all x âˆˆ R n . One can show that any compactly-supported  C 2 (twice differentiable with continuous second derivative) function f lies in D A and that        A  f   (  x  )    =     âˆ‘  i     b  i    (  x  )     âˆ‚  f    âˆ‚   x  i      (  x  )     +     1  2      âˆ‘   i  ,  j       (   Ïƒ   (  x  )   Ïƒ    (  x  )   âŠ¤    )    i  ,  j       âˆ‚  2   f     âˆ‚    x  i      âˆ‚   x  j       (  x  )        ,        A  f  x       subscript   i      subscript  b  i   x      f      subscript  x  i     x        1  2     subscript    i  j       subscript    Ïƒ  x  Ïƒ   superscript  x  top     i  j        superscript   2   f        subscript  x  i       subscript  x  j      x        Af(x)=\sum_{i}b_{i}(x)\frac{\partial f}{\partial x_{i}}(x)+\tfrac{1}{2}\sum_{i%
 ,j}\left(\sigma(x)\sigma(x)^{\top}\right)_{i,j}\frac{\partial^{2}f}{\partial x%
 _{i}\,\partial x_{j}}(x),     or, in terms of the gradient and scalar and Frobenius  inner products ,         A  f   (  x  )    =      b   (  x  )    â‹…    âˆ‡  x   f     (  x  )    +     1  2     (   Ïƒ   (  x  )   Ïƒ    (  x  )   âŠ¤    )      :      âˆ‡  x    âˆ‡  x    f    (  x  )     .     normal-:      A  f  x        normal-â‹…    b  x     subscript  normal-âˆ‡  x   f    x       1  2     Ïƒ  x  Ïƒ   superscript  x  top            subscript  normal-âˆ‡  x    subscript  normal-âˆ‡  x    f   x     Af(x)=b(x)\cdot\nabla_{x}f(x)+\tfrac{1}{2}\left(\sigma(x)\sigma(x)^{\top}%
 \right):\nabla_{x}\nabla_{x}f(x).     An example  The generator A for standard n -dimensional Brownian motion B , which satisfies the stochastic differential equation d X t =Â d B t , is given by       A  f   (  x  )    =     1  2      âˆ‘   i  ,  j      Î´   i  j       âˆ‚  2   f     âˆ‚    x  i      âˆ‚   x  j       (  x  )      =     1  2      âˆ‘  i       âˆ‚  2   f    âˆ‚   x  i  2      (  x  )              A  f  x       1  2     subscript    i  j       subscript  Î´    i  j        superscript   2   f        subscript  x  i       subscript  x  j      x              1  2     subscript   i         superscript   2   f      superscript   subscript  x  i   2     x        Af(x)=\tfrac{1}{2}\sum_{i,j}\delta_{ij}\frac{\partial^{2}f}{\partial x_{i}\,%
 \partial x_{j}}(x)=\tfrac{1}{2}\sum_{i}\frac{\partial^{2}f}{\partial x_{i}^{2}%
 }(x)   ,  i.e., A =Â Î”/2, where Î” denotes the Laplace operator .  The Kolmogorov and Fokkerâ€“Planck equations  The generator is used in the formulation of Kolmogorov's backward equation. Intuitively, this equation tells us how the expected value of any suitably smooth statistic of X evolves in time: it must solve a certain partial differential equation in which time t and the initial position x are the independent variables. More precisely, if f âˆˆ C 2 ( R n ; R ) has compact support and u :Â [0,Â +âˆ)Â Ã— R n â†’ R is defined by        u   (  t  ,  x  )    =    ğ„  x    [   f   (   X  t   )    ]     ,        u   t  x       superscript  ğ„  x    delimited-[]    f   subscript  X  t        u(t,x)=\mathbf{E}^{x}[f(X_{t})],     then u ( t , x ) is differentiable with respect to t , u ( t ,Â Â·)Â âˆˆ D A for all t , and u satisfies the following partial differential equation , known as Kolmogorov's backward equation :      {          âˆ‚  u    âˆ‚  t     (  t  ,  x  )    =   A  u   (  t  ,  x  )     ,        t  >  0   ,   x  âˆˆ   ğ‘  n     ;          u   (  0  ,  x  )    =   f   (  x  )     ,       x  âˆˆ   ğ‘  n    .         cases          u     t     t  x      A  u   t  x      formulae-sequence    t  0     x   superscript  ğ‘  n         u   0  x      f  x      x   superscript  ğ‘  n      \begin{cases}\dfrac{\partial u}{\partial t}(t,x)=Au(t,x),&t>0,x\in\mathbf{R}^{%
 n};\\
 u(0,x)=f(x),&x\in\mathbf{R}^{n}.\end{cases}     The Fokkerâ€“Planck equation (also known as Kolmogorov's forward equation ) is in some sense the " adjoint " to the backward equation, and tells us how the probability density functions of X t evolve with time t . Let Ï( t ,Â Â·) be the density of X t with respect to Lebesgue measure on R n , i.e., for any Borel-measurable set S âŠ† R n ,      ğ   [   X  t   âˆˆ  S  ]   =   âˆ«  S   Ï   (  t  ,  x  )   d  x  .     fragments  P   fragments  normal-[   subscript  X  t    S  normal-]     subscript   S   Ï   fragments  normal-(  t  normal-,  x  normal-)   d  x  normal-.    \mathbf{P}\left[X_{t}\in S\right]=\int_{S}\rho(t,x)\,\mathrm{d}x.     Let A âˆ— denote the Hermitian adjoint of A (with respect to the L 2  inner product ). Then, given that the initial position X 0 has a prescribed density Ï 0 , Ï( t , x ) is differentiable with respect to t , Ï( t ,Â Â·)Â âˆˆ D A * for all t , and Ï satisfies the following partial differential equation, known as the Fokkerâ€“Planck equation :      {          âˆ‚  Ï    âˆ‚  t     (  t  ,  x  )    =    A  *   Ï   (  t  ,  x  )     ,        t  >  0   ,   x  âˆˆ   ğ‘  n     ;          Ï   (  0  ,  x  )    =    Ï  0    (  x  )     ,       x  âˆˆ   ğ‘  n    .         cases          Ï     t     t  x       superscript  A    Ï   t  x      formulae-sequence    t  0     x   superscript  ğ‘  n         Ï   0  x       subscript  Ï  0   x      x   superscript  ğ‘  n      \begin{cases}\dfrac{\partial\rho}{\partial t}(t,x)=A^{*}\rho(t,x),&t>0,x\in%
 \mathbf{R}^{n};\\
 \rho(0,x)=\rho_{0}(x),&x\in\mathbf{R}^{n}.\end{cases}     The Feynmanâ€“Kac formula  The Feynmanâ€“Kac formula is a useful generalization of Kolmogorov's backward equation. Again, f is in C 2 ( R n ; R ) and has compact support, and q : R n â†’ R is taken to be a continuous function that is bounded below. Define a function v :Â [0,Â +âˆ)Â Ã— R n â†’ R by        v   (  t  ,  x  )    =    ğ„  x    [    exp   (   -    âˆ«  0  t    q   (   X  s   )   d  s     )    f   (   X  t   )    ]     .        v   t  x       superscript  ğ„  x    delimited-[]          superscript   subscript   0   t     q   subscript  X  s   normal-d  s      f   subscript  X  t        v(t,x)=\mathbf{E}^{x}\left[\exp\left(-\int_{0}^{t}q(X_{s})\,\mathrm{d}s\right)%
 f(X_{t})\right].     The Feynmanâ€“Kac formula states that v satisfies the partial differential equation      {          âˆ‚  v    âˆ‚  t     (  t  ,  x  )    =    A  v   (  t  ,  x  )    -   q   (  x  )   v   (  t  ,  x  )      ,        t  >  0   ,   x  âˆˆ   ğ‘  n     ;          v   (  0  ,  x  )    =   f   (  x  )     ,       x  âˆˆ   ğ‘  n    .         cases          v     t     t  x        A  v   t  x      q  x  v   t  x       formulae-sequence    t  0     x   superscript  ğ‘  n         v   0  x      f  x      x   superscript  ğ‘  n      \begin{cases}\dfrac{\partial v}{\partial t}(t,x)=Av(t,x)-q(x)v(t,x),&t>0,x\in%
 \mathbf{R}^{n};\\
 v(0,x)=f(x),&x\in\mathbf{R}^{n}.\end{cases}     Moreover, if w :Â [0,Â +âˆ)Â Ã— R n â†’ R is C 1 in time, C 2 in space, bounded on K Ã— R n for all compact K , and satisfies the above partial differential equation, then w must be v as defined above.  Kolmogorov's backward equation is the special case of the Feynmanâ€“Kac formula in which q ( x )Â =Â 0 for all x âˆˆ R n .  The characteristic operator  Definition  The characteristic operator of an ItÅ diffusion X is a partial differential operator closely related to the generator, but somewhat more general. It is more suited to certain problems, for example in the solution of the Dirichlet problem .  The characteristic operator    ğ’œ   ğ’œ   \mathcal{A}   of an ItÅ diffusion X is defined by        ğ’œ  f   (  x  )    =    lim   U  â†“  x        ğ„  x    [   f   (   X   Ï„  U    )    ]    -   f   (  x  )       ğ„  x    [   Ï„  U   ]       ,        ğ’œ  f  x     subscript    normal-â†“  U  x           superscript  ğ„  x    delimited-[]    f   subscript  X   subscript  Ï„  U         f  x       superscript  ğ„  x    delimited-[]   subscript  Ï„  U         \mathcal{A}f(x)=\lim_{U\downarrow x}\frac{\mathbf{E}^{x}\left[f(X_{\tau_{U}})%
 \right]-f(x)}{\mathbf{E}^{x}[\tau_{U}]},     where the sets U form a sequence of open sets  U k that decrease to the point x in the sense that        U   k  +  1    âŠ†    U  k   and    â‹‚   k  =  1   âˆ    U  k     =   {  x  }    ,         subscript  U    k  1       subscript  U  k   and    superscript   subscript     k  1       subscript  U  k           x      U_{k+1}\subseteq U_{k}\mbox{ and }\bigcap_{k=1}^{\infty}U_{k}=\{x\},     and       Ï„  U   =   inf   {   t  â‰¥   0    :    X  t   âˆ‰  U   }         subscript  Ï„  U    infimum   conditional-set    t  0      subscript  X  t   U       \tau_{U}=\inf\{t\geq 0\ :\ X_{t}\not\in U\}     is the first exit time from U for X .    D  ğ’œ     subscript  D  ğ’œ    D_{\mathcal{A}}   denotes the set of all f for which this limit exists for all x âˆˆ R n and all sequences { U k }. If E x [Ï„ U ]Â =Â +âˆ for all open sets U containing x , define       ğ’œ  f   (  x  )    =  0.        ğ’œ  f  x   0.    \mathcal{A}f(x)=0.     Relationship with the generator  The characteristic operator and infinitesimal generator are very closely related, and even agree for a large class of functions. One can show that       D  A   âŠ†   D  ğ’œ        subscript  D  A    subscript  D  ğ’œ     D_{A}\subseteq D_{\mathcal{A}}     and that        A  f   =   ğ’œ  f  for all  f   âˆˆ   D  A    .          A  f     ğ’œ  f  for all  f         subscript  D  A      Af=\mathcal{A}f\mbox{ for all }f\in D_{A}.     In particular, the generator and characteristic operator agree for all C 2 functions f , in which case        ğ’œ  f   (  x  )    =     âˆ‘  i     b  i    (  x  )     âˆ‚  f    âˆ‚   x  i      (  x  )     +     1  2      âˆ‘   i  ,  j       (   Ïƒ   (  x  )   Ïƒ    (  x  )   âŠ¤    )    i  ,  j       âˆ‚  2   f     âˆ‚    x  i      âˆ‚   x  j       (  x  )        .        ğ’œ  f  x       subscript   i      subscript  b  i   x      f      subscript  x  i     x        1  2     subscript    i  j       subscript    Ïƒ  x  Ïƒ   superscript  x  top     i  j        superscript   2   f        subscript  x  i       subscript  x  j      x        \mathcal{A}f(x)=\sum_{i}b_{i}(x)\frac{\partial f}{\partial x_{i}}(x)+\tfrac{1}%
 {2}\sum_{i,j}\left(\sigma(x)\sigma(x)^{\top}\right)_{i,j}\frac{\partial^{2}f}{%
 \partial x_{i}\,\partial x_{j}}(x).     Application: Brownian motion on a Riemannian manifold  (Figure)  The characteristic operator of a Brownian motion is Â½ times the Laplace-Beltrami operator. Here it is the Laplace-Beltrami operator on a 2-sphere.   Above, the generator (and hence characteristic operator) of Brownian motion on R n was calculated to be Â½Î”, where Î” denotes the Laplace operator. The characteristic operator is useful in defining Brownian motion on an m -dimensional Riemannian manifold ( M , g ): a Brownian motion on  M is defined to be a diffusion on M whose characteristic operator   ğ’œ   ğ’œ   \mathcal{A}   in local coordinates x i , 1Â â‰¤ i â‰¤ m , is given by Â½Î” LB , where Î” LB is the Laplace-Beltrami operator given in local coordinates by        Î”  LB   =    1    det   (  g  )        âˆ‘   i  =  1   m     âˆ‚   âˆ‚   x  i      (     det   (  g  )       âˆ‘   j  =  1   m     g   i  j     âˆ‚   âˆ‚   x  j        )       ,       subscript  normal-Î”  LB       1      g       superscript   subscript     i  1    m           subscript  x  i           g      superscript   subscript     j  1    m      superscript  g    i  j          subscript  x  j             \Delta_{\mathrm{LB}}=\frac{1}{\sqrt{\det(g)}}\sum_{i=1}^{m}\frac{\partial}{%
 \partial x_{i}}\left(\sqrt{\det(g)}\sum_{j=1}^{m}g^{ij}\frac{\partial}{%
 \partial x_{j}}\right),     where [ g ij ]Â =Â [ g ij ] âˆ’1 in the sense of the inverse of a square matrix .  The resolvent operator  In general, the generator A of an ItÅ diffusion X is not a bounded operator . However, if a positive multiple of the identity operator I is subtracted from A then the resulting operator is invertible. The inverse of this operator can be expressed in terms of X itself using the resolvent operator.  For Î±Â >Â 0, the resolvent operator  R Î± , acting on bounded, continuous functions g : R n â†’ R , is defined by         R  Î±   g   (  x  )    =    ğ„  x    [    âˆ«  0  âˆ     e   -   Î±  t     g   (   X  t   )   d  t    ]     .         subscript  R  Î±   g  x      superscript  ğ„  x    delimited-[]    superscript   subscript   0        superscript  e      Î±  t     g   subscript  X  t   normal-d  t        R_{\alpha}g(x)=\mathbf{E}^{x}\left[\int_{0}^{\infty}e^{-\alpha t}g(X_{t})\,%
 \mathrm{d}t\right].     It can be shown, using the Feller continuity of the diffusion X , that R Î± g is itself a bounded, continuous function. Also, R Î± and Î± I âˆ’ A are mutually inverse operators:   if f : R n â†’ R is C 2 with compact support, then, for all Î±Â >Â 0,            R  Î±    (    Î±  ğˆ   -  A   )   f   =  f   ;         subscript  R  Î±       Î±  ğˆ   A   f   f    R_{\alpha}(\alpha\mathbf{I}-A)f=f;         if g : R n â†’ R is bounded and continuous, then R Î± g lies in D A and, for all Î±Â >Â 0,            (    Î±  ğˆ   -  A   )    R  Î±   g   =  g   .            Î±  ğˆ   A    subscript  R  Î±   g   g    (\alpha\mathbf{I}-A)R_{\alpha}g=g.        Invariant measures  Sometimes it is necessary to find an invariant measure for an ItÅ diffusion X , i.e. a measure on R n that does not change under the "flow" of X : i.e., if X 0 is distributed according to such an invariant measure Î¼ âˆ , then X t is also distributed according to Î¼ âˆ for any t â‰¥Â 0. The Fokkerâ€“Planck equation offers a way to find such a measure, at least if it has a probability density function Ï âˆ : if X 0 is indeed distributed according to an invariant measure Î¼ âˆ with density Ï âˆ , then the density Ï( t ,Â Â·) of X t does not change with t , so Ï( t ,Â Â·)Â =Â Ï âˆ , and so Ï âˆ must solve the (time-independent) partial differential equation          A  *    Ï  âˆ    (  x  )    =  0   ,   x  âˆˆ   ğ‘  n     .     formulae-sequence       superscript  A     subscript  Ï    x   0     x   superscript  ğ‘  n      A^{*}\rho_{\infty}(x)=0,\quad x\in\mathbf{R}^{n}.     This illustrates one of the connections between stochastic analysis and the study of partial differential equations. Conversely, a given second-order linear partial differential equation of the form Î› f =Â 0 may be hard to solve directly, but if Î›Â = A âˆ— for some ItÅ diffusion X , and an invariant measure for X is easy to compute, then that measure's density provides a solution to the partial differential equation.  Invariant measures for gradient flows  An invariant measure is comparatively easy to compute when the process X is a stochastic gradient flow of the form        d   X  t    =    -    âˆ‡  Î¨    (   X  t   )   d  t    +      2   Î²   -  1       d   B  t      ,        normal-d   subscript  X  t           normal-âˆ‡  normal-Î¨    subscript  X  t   normal-d  t          2   superscript  Î²    1      normal-d   subscript  B  t       \mathrm{d}X_{t}=-\nabla\Psi(X_{t})\,\mathrm{d}t+\sqrt{2\beta^{-1}}\,\mathrm{d}%
 B_{t},     where Î²Â >Â 0 plays the role of an inverse temperature and Î¨Â : R n â†’ R is a scalar potential satisfying suitable smoothness and growth conditions. In this case, the Fokkerâ€“Planck equation has a unique stationary solution Ï âˆ (i.e. X has a unique invariant measure Î¼ âˆ with density Ï âˆ ) and it is given by the Gibbs distribution :         Ï  âˆ    (  x  )    =    Z   -  1     exp   (   -   Î²  Î¨   (  x  )     )      ,         subscript  Ï    x      superscript  Z    1          Î²  normal-Î¨  x        \rho_{\infty}(x)=Z^{-1}\exp(-\beta\Psi(x)),     where the partition function  Z is given by       Z  =    âˆ«   ğ‘  n      exp   (   -   Î²  Î¨   (  x  )     )    d  x     .      Z    subscript    superscript  ğ‘  n            Î²  normal-Î¨  x     normal-d  x      Z=\int_{\mathbf{R}^{n}}\exp(-\beta\Psi(x))\,\mathrm{d}x.     Moreover, the density Ï âˆ satisfies a variational principle : it minimizes over all probability densities Ï on R n the free energy functional F given by        F   [  Ï  ]    =    E   [  Ï  ]    +    1  Î²   S   [  Ï  ]      ,        F   delimited-[]  Ï        E   delimited-[]  Ï        1  Î²   S   delimited-[]  Ï       F[\rho]=E[\rho]+\frac{1}{\beta}S[\rho],     where       E   [  Ï  ]    =    âˆ«   ğ‘  n     Î¨   (  x  )   Ï   (  x  )   d  x          E   delimited-[]  Ï      subscript    superscript  ğ‘  n      normal-Î¨  x  Ï  x  normal-d  x      E[\rho]=\int_{\mathbf{R}^{n}}\Psi(x)\rho(x)\,\mathrm{d}x     plays the role of an energy functional, and       S   [  Ï  ]    =    âˆ«   ğ‘  n     Ï   (  x  )    log  Ï    (  x  )   d  x          S   delimited-[]  Ï      subscript    superscript  ğ‘  n      Ï  x    Ï   x  normal-d  x      S[\rho]=\int_{\mathbf{R}^{n}}\rho(x)\log\rho(x)\,\mathrm{d}x     is the negative of the Gibbs-Boltzmann entropy functional. Even when the potential Î¨ is not well-behaved enough for the partition function Z and the Gibbs measure Î¼ âˆ to be defined, the free energy F [Ï( t ,Â Â·)] still makes sense for each time t â‰¥Â 0, provided that the initial condition has F [Ï(0,Â Â·)] n satisfying the stochastic differential equation        d   X  t    =    -   Îº   (    X  t   -  m   )   d  t    +      2   Î²   -  1       d   B  t      ,        normal-d   subscript  X  t          Îº     subscript  X  t   m   normal-d  t          2   superscript  Î²    1      normal-d   subscript  B  t       \mathrm{d}X_{t}=-\kappa(X_{t}-m)\,\mathrm{d}t+\sqrt{2\beta^{-1}}\,\mathrm{d}B_%
 {t},     where m âˆˆ R n and Î², ÎºÂ >Â 0 are given constants. In this case, the potential Î¨ is given by        Î¨   (  x  )    =     1  2    Îº    |   x  -  m   |   2     ,        normal-Î¨  x       1  2   Îº   superscript      x  m    2      \Psi(x)=\tfrac{1}{2}\kappa|x-m|^{2},     and so the invariant measure for X is a Gaussian measure with density Ï âˆ given by        Ï  âˆ    (  x  )    =     (    Î²  Îº    2  Ï€    )    n  2     exp   (   -    Î²  Îº    |   x  -  m   |   2    2    )            subscript  Ï    x      superscript      Î²  Îº     2  Ï€      n  2            Î²  Îº   superscript      x  m    2    2        \rho_{\infty}(x)=\left(\frac{\beta\kappa}{2\pi}\right)^{\frac{n}{2}}\exp\left(%
 -\frac{\beta\kappa|x-m|^{2}}{2}\right)   .  Heuristically, for large t , X t is approximately normally distributed with mean m and variance (Î²Îº) âˆ’1 . The expression for the variance may be interpreted as follows: large values of Îº mean that the potential well Î¨ has "very steep sides", so X t is unlikely to move far from the minimum of Î¨ at m ; similarly, large values of Î² mean that the system is quite "cold" with little noise, so, again, X t is unlikely to move far away from m .  The martingale property  In general, an ItÅ diffusion X is not a martingale . However, for any f âˆˆ C 2 ( R n ; R ) with compact support, the process M :Â [0,Â +âˆ)Â Ã—Â Î©Â â†’ R defined by        M  t   =    f   (   X  t   )    -    âˆ«  0  t    A  f   (   X  s   )   d  s      ,       subscript  M  t       f   subscript  X  t      superscript   subscript   0   t     A  f   subscript  X  s   normal-d  s       M_{t}=f(X_{t})-\int_{0}^{t}Af(X_{s})\,\mathrm{d}s,     where A is the generator of X , is a martingale with respect to the natural filtration F âˆ— of (Î©,Â Î£) by X . The proof is quite simple: it follows from the usual expression of the action of the generator on smooth enough functions f and ItÅ's lemma (the stochastic chain rule ) that        f   (   X  t   )    =    f   (  x  )    +    âˆ«  0  t    A  f   (   X  s   )   d  s    +    âˆ«  0  t     âˆ‡  f     (   X  s   )   âŠ¤   Ïƒ   (   X  s   )   d   B  s       .        f   subscript  X  t        f  x     superscript   subscript   0   t     A  f   subscript  X  s   normal-d  s      superscript   subscript   0   t      normal-âˆ‡  f    superscript   subscript  X  s   top   Ïƒ   subscript  X  s   normal-d   subscript  B  s        f(X_{t})=f(x)+\int_{0}^{t}Af(X_{s})\,\mathrm{d}s+\int_{0}^{t}\nabla f(X_{s})^{%
 \top}\sigma(X_{s})\,\mathrm{d}B_{s}.     Since ItÅ integrals are martingales with respect to the natural filtration Î£ âˆ— of (Î©,Â Î£) by B , for t > s ,       ğ„  x    [   M  t   |   Î£  s   ]   =   M  s   .     fragments   superscript  ğ„  x    fragments  normal-[   subscript  M  t   normal-|   subscript  normal-Î£  s   normal-]     subscript  M  s   normal-.    \mathbf{E}^{x}\big[M_{t}\big|\Sigma_{s}\big]=M_{s}.     Hence, as required,       ğ„  x    [   M  t   |   F  s   ]   =   ğ„  x    [   ğ„  x    [   M  t   |   Î£  s   ]   |   F  s   ]   =   ğ„  x    [   M  s   |   F  s   ]   =   M  s   ,     fragments   superscript  ğ„  x    fragments  normal-[   subscript  M  t   normal-|   subscript  F  s   normal-]     superscript  ğ„  x    fragments  normal-[   superscript  ğ„  x    fragments  normal-[   subscript  M  t   normal-|   subscript  normal-Î£  s   normal-]   normal-|   subscript  F  s   normal-]     superscript  ğ„  x    fragments  normal-[   subscript  M  s   normal-|   subscript  F  s   normal-]     subscript  M  s   normal-,    \mathbf{E}^{x}[M_{t}|F_{s}]=\mathbf{E}^{x}\left[\mathbf{E}^{x}\big[M_{t}\big|%
 \Sigma_{s}\big]\big|F_{s}\right]=\mathbf{E}^{x}\big[M_{s}\big|F_{s}\big]=M_{s},     since M s is F s -measurable.  Dynkin's formula  Dynkin's formula, named after Eugene Dynkin , gives the expected value of any suitably smooth statistic of an ItÅ diffusion X (with generator A ) at a stopping time. Precisely, if Ï„ is a stopping time with E x [Ï„] n â†’ R is C 2 with compact support, then         ğ„  x    [   f   (   X  Ï„   )    ]    =    f   (  x  )    +    ğ„  x    [    âˆ«  0  Ï„    A  f   (   X  s   )   d  s    ]      .         superscript  ğ„  x    delimited-[]    f   subscript  X  Ï„          f  x      superscript  ğ„  x    delimited-[]    superscript   subscript   0   Ï„     A  f   subscript  X  s   normal-d  s         \mathbf{E}^{x}[f(X_{\tau})]=f(x)+\mathbf{E}^{x}\left[\int_{0}^{\tau}Af(X_{s})%
 \,\mathrm{d}s\right].     Dynkin's formula can be used to calculate many useful statistics of stopping times. For example, canonical Brownian motion on the real line starting at 0 exits the interval (âˆ’ R ,Â + R ) at a random time Ï„ R with expected value         ğ„  0    [   Ï„  R   ]    =   R  2    .         superscript  ğ„  0    delimited-[]   subscript  Ï„  R      superscript  R  2     \mathbf{E}^{0}[\tau_{R}]=R^{2}.     Dynkin's formula provides information about the behaviour of X at a fairly general stopping time. For more information on the distribution of X at a hitting time , one can study the harmonic measure of the process.  Associated measures  The harmonic measure  In many situations, it is sufficient to know when an ItÅ diffusion X will first leave a measurable set  H âŠ† R n . That is, one wishes to study the first exit time         Ï„  H    (  Ï‰  )    =   inf   {   t  â‰¥  0   |    X  t   âˆ‰  H   }     .         subscript  Ï„  H   Ï‰    infimum   conditional-set    t  0      subscript  X  t   H       \tau_{H}(\omega)=\inf\{t\geq 0|X_{t}\not\in H\}.     Sometimes, however, one also wishes to know the distribution of the points at which X exits the set. For example, canonical Brownian motion B on the real line starting at 0 exits the interval (âˆ’1,Â 1) at âˆ’1 with probability Â½ and at 1 with probability Â½, so B Ï„ (âˆ’1,Â 1) is uniformly distributed on the set {âˆ’1,Â 1}.  In general, if G is compactly embedded within R n , then the harmonic measure (or hitting distribution ) of X on the boundary âˆ‚ G of G is the measure Î¼ G x defined by       Î¼  G  x    (  F  )   =   ğ  x    [   X   Ï„  G    âˆˆ  F  ]      fragments   superscript   subscript  Î¼  G   x    fragments  normal-(  F  normal-)     superscript  ğ  x    fragments  normal-[   subscript  X   subscript  Ï„  G     F  normal-]     \mu_{G}^{x}(F)=\mathbf{P}^{x}\left[X_{\tau_{G}}\in F\right]     for x âˆˆ G and F âŠ†Â âˆ‚ G .  Returning to the earlier example of Brownian motion, one can show that if B is a Brownian motion in R n starting at x âˆˆ R n and D âŠ‚ R n is an open ball centred on x , then the harmonic measure of B on âˆ‚ D is invariant under all rotations of D about x and coincides with the normalized surface measure on âˆ‚ D .  The harmonic measure satisfies an interesting mean value property : if f : R n â†’ R is any bounded, Borel-measurable function and Ï† is given by        Ï†   (  x  )    =    ğ„  x    [   f   (   X   Ï„  H    )    ]     ,        Ï†  x      superscript  ğ„  x    delimited-[]    f   subscript  X   subscript  Ï„  H         \varphi(x)=\mathbf{E}^{x}\left[f(X_{\tau_{H}})\right],     then, for all Borel sets G âŠ‚âŠ‚ H and all x âˆˆ G ,        Ï†   (  x  )    =    âˆ«   âˆ‚  G     Ï†   (  y  )   d   Î¼  G  x    (  y  )      .        Ï†  x     subscript     G      Ï†  y  normal-d   superscript   subscript  Î¼  G   x   y      \varphi(x)=\int_{\partial G}\varphi(y)\,\mathrm{d}\mu_{G}^{x}(y).     The mean value property is very useful in the solution of partial differential equations using stochastic processes .  The Green measure and Green formula  Let A be a partial differential operator on a domain D âŠ† R n and let X be an ItÅ diffusion with A as its generator. Intuitively, the Green measure of a Borel set H is the expected length of time that X stays in H before it leaves the domain D . That is, the Green measure of X with respect to D at x , denoted G ( x ,Â Â·), is defined for Borel sets H âŠ† R n by        G   (  x  ,  H  )    =    ğ„  x    [    âˆ«  0   Ï„  D      Ï‡  H    (   X  s   )   d  s    ]     ,        G   x  H       superscript  ğ„  x    delimited-[]    superscript   subscript   0    subscript  Ï„  D       subscript  Ï‡  H    subscript  X  s   normal-d  s        G(x,H)=\mathbf{E}^{x}\left[\int_{0}^{\tau_{D}}\chi_{H}(X_{s})\,\mathrm{d}s%
 \right],     or for bounded, continuous functions f : D â†’ R by         âˆ«  D    f   (  y  )   G   (  x  ,   d  y   )     =    ğ„  x    [    âˆ«  0   Ï„  D     f   (   X  s   )   d  s    ]     .        subscript   D     f  y  G   x    normal-d  y         superscript  ğ„  x    delimited-[]    superscript   subscript   0    subscript  Ï„  D      f   subscript  X  s   normal-d  s        \int_{D}f(y)\,G(x,\mathrm{d}y)=\mathbf{E}^{x}\left[\int_{0}^{\tau_{D}}f(X_{s})%
 \,\mathrm{d}s\right].     The name "Green measure" comes from the fact that if X is Brownian motion, then        G   (  x  ,  H  )    =    âˆ«  H    G   (  x  ,  y  )   d  y     ,        G   x  H      subscript   H     G   x  y   normal-d  y      G(x,H)=\int_{H}G(x,y)\,\mathrm{d}y,     where G ( x , y ) is Green's function for the operator Â½Î” on the domain D .  Suppose that E x [Ï„ D ]Â 2( R n ; R ) with compact support:        f   (  x  )    =     ğ„  x    [   f   (   X   Ï„  D    )    ]    -    âˆ«  D    A  f   (  y  )   G   (  x  ,   d  y   )       .        f  x        superscript  ğ„  x    delimited-[]    f   subscript  X   subscript  Ï„  D         subscript   D     A  f  y  G   x    normal-d  y         f(x)=\mathbf{E}^{x}\left[f\left(X_{\tau_{D}}\right)\right]-\int_{D}Af(y)\,G(x,%
 \mathrm{d}y).     In particular, if the support of f is compactly embedded in D ,        f   (  x  )    =   -    âˆ«  D    A  f   (  y  )   G   (  x  ,   d  y   )       .        f  x       subscript   D     A  f  y  G   x    normal-d  y         f(x)=-\int_{D}Af(y)\,G(x,\mathrm{d}y).     See also   Diffusion process   References        (See Sections 7, 8 and 9)   "  Category:Stochastic differential equations   
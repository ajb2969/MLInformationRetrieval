   Feedback linearization      Feedback linearization   (Figure)  Block diagram illustrating the feedback linearization of a nonlinear system   Feedback linearization is a common approach used in controlling nonlinear systems . The approach involves coming up with a transformation of the nonlinear system into an equivalent linear system through a change of variables and a suitable control input. Feedback linearization may be applied to nonlinear systems of the form      x  Àô     normal-Àô  x    \displaystyle\dot{x}     where    x  ‚àà   ‚Ñù  n       x   superscript  ‚Ñù  n     x\in\mathbb{R}^{n}   is the state vector,    u  ‚àà   ‚Ñù  p       u   superscript  ‚Ñù  p     u\in\mathbb{R}^{p}   is the vector of inputs, and    y  ‚àà   ‚Ñù  m       y   superscript  ‚Ñù  m     y\in\mathbb{R}^{m}   is the vector of outputs. The goal is to develop a control input      u  =    a   (  x  )    +   b   (  x  )    v         u      a  x     b  x  v      u=a(x)+b(x)v\,   that renders a linear input‚Äìoutput map between the new input   v   v   v   and the output. An outer-loop control strategy for the resulting linear control system can then be applied.  Feedback Linearization of SISO Systems  Here, we consider the case of feedback linearization of a single-input single-output (SISO) system. Similar results can be extended to multiple-input multiple-output (MIMO) systems. In this case,    u  ‚àà  ‚Ñù      u  ‚Ñù    u\in\mathbb{R}   and    y  ‚àà  ‚Ñù      y  ‚Ñù    y\in\mathbb{R}   . We wish to find a coordinate transformation    z  =   T   (  x  )        z    T  x     z=T(x)   that transforms our system (1) into the so-called normal form which will reveal a feedback law of the form      u  =    a   (  x  )    +   b   (  x  )    v         u      a  x     b  x  v      u=a(x)+b(x)v\,   that will render a linear input‚Äìoutput map from the new input    v  ‚àà  ‚Ñù      v  ‚Ñù    v\in\mathbb{R}   to the output   y   y   y   . To ensure that the transformed system is an equivalent representation of the original system, the transformation must be a diffeomorphism . That is, the transformation must not only be invertible (i.e., bijective), but both the transformation and its inverse must be smooth so that differentiability in the original coordinate system is preserved in the new coordinate system. In practice, the transformation can be only locally diffeomorphic, but the linearization results only hold in this smaller region.  We require several tools before we can solve this problem.  Lie derivative  The goal of feedback linearization is to produce a transformed system whose states are the output   y   y   y   and its first    (   n  -  1   )      n  1    (n-1)   derivatives. To understand the structure of this target system, we use the Lie derivative . Consider the time derivative of (2), which we can compute using the chain rule ,       y  Àô   =      d  h    (  x  )     d  t          normal-Àô  y        normal-d  h   x    normal-d  t      \displaystyle\dot{y}=\frac{\operatorname{d}h(x)}{\operatorname{d}t}     Now we can define the Lie derivative of    h   (  x  )       h  x    h(x)   along    f   (  x  )       f  x    f(x)   as,         L  f   h   (  x  )    =      d  h    (  x  )     d  x    f   (  x  )     ,         subscript  L  f   h  x          normal-d  h   x    normal-d  x    f  x     L_{f}h(x)=\frac{\operatorname{d}h(x)}{\operatorname{d}x}f(x),     and similarly, the Lie derivative of    h   (  x  )       h  x    h(x)   along    g   (  x  )       g  x    g(x)   as,         L  g   h   (  x  )    =      d  h    (  x  )     d  x    g   (  x  )     .         subscript  L  g   h  x          normal-d  h   x    normal-d  x    g  x     L_{g}h(x)=\frac{\operatorname{d}h(x)}{\operatorname{d}x}g(x).     With this new notation, we may express    y  Àô     normal-Àô  y    \dot{y}   as,       y  Àô   =     L  f   h   (  x  )    +    L  g   h   (  x  )   u         normal-Àô  y        subscript  L  f   h  x      subscript  L  g   h  x  u      \dot{y}=L_{f}h(x)+L_{g}h(x)u     Note that the notation of Lie derivatives is convenient when we take multiple derivatives with respect to either the same vector field, or a different one. For example,         L  f  2   h   (  x  )    =    L  f    L  f   h   (  x  )    =     d   (    L  f   h   (  x  )    )     d  x    f   (  x  )     ,           superscript   subscript  L  f   2   h  x      subscript  L  f    subscript  L  f   h  x             normal-d     subscript  L  f   h  x     normal-d  x    f  x      L_{f}^{2}h(x)=L_{f}L_{f}h(x)=\frac{\operatorname{d}(L_{f}h(x))}{\operatorname{%
 d}x}f(x),     and         L  g    L  f   h   (  x  )    =     d   (    L  f   h   (  x  )    )     d  x    g   (  x  )     .         subscript  L  g    subscript  L  f   h  x        normal-d     subscript  L  f   h  x     normal-d  x    g  x     L_{g}L_{f}h(x)=\frac{\operatorname{d}(L_{f}h(x))}{\operatorname{d}x}g(x).     Relative degree  In our feedback linearized system made up of a state vector of the output   y   y   y   and its first    (   n  -  1   )      n  1    (n-1)   derivatives, we must understand how the input   u   u   u   enters the system. To do this, we introduce the notion of relative degree. Our system given by (1) and (2) is said to have relative degree    r  ‚àà  ùïé      r  ùïé    r\in\mathbb{W}   at a point    x  0     subscript  x  0    x_{0}   if,        L  g    L  f  k   h   (  x  )    =   0   ‚àÄ  x           subscript  L  g    superscript   subscript  L  f   k   h  x    0   for-all  x      L_{g}L_{f}^{k}h(x)=0\qquad\forall x   in a neighbourhood of    x  0     subscript  x  0    x_{0}   and all    k  ‚â§   r  -  2       k    r  2     k\leq r-2           L  g    L  f   r  -  1    h   (   x  0   )    ‚â†  0         subscript  L  g    superscript   subscript  L  f     r  1    h   subscript  x  0    0    L_{g}L_{f}^{r-1}h(x_{0})\neq 0     Considering this definition of relative degree in light of the expression of the time derivative of the output   y   y   y   , we can consider the relative degree of our system (1) and (2) to be the number of times we have to differentiate the output   y   y   y   before the input   u   u   u   appears explicitly. In an LTI system , the relative degree is the difference between the degree of the transfer function's denominator polynomial (i.e., number of poles ) and the degree of its numerator polynomial (i.e., number of zeros ).  Linearization by feedback  For the discussion that follows, we will assume that the relative degree of the system is   n   n   n   . In this case, after differentiating the output   n   n   n   times we have,     y   y   \displaystyle y     where the notation    y   (  n  )      superscript  y  n    y^{(n)}   indicates the   n   n   n   th derivative of   y   y   y   . Because we assumed the relative degree of the system is   n   n   n   , the Lie derivatives of the form     L  g    L  f  i   h   (  x  )        subscript  L  g    superscript   subscript  L  f   i   h  x    L_{g}L_{f}^{i}h(x)   for    i  =   1  ,  ‚Ä¶  ,   n  -  2        i   1  normal-‚Ä¶    n  2      i=1,\dots,n-2   are all zero. That is, the input   u   u   u   has no direct contribution to any of the first    (   n  -  1   )      n  1    (n-1)   th derivatives.  The coordinate transformation    T   (  x  )       T  x    T(x)   that puts the system into normal form comes from the first    (   n  -  1   )      n  1    (n-1)   derivatives. In particular,      z  =   T   (  x  )    =   [       z  1    (  x  )          z  2    (  x  )        ‚ãÆ        z  n    (  x  )       ]   =   [     y       y  Àô       ‚ãÆ       y   (   n  -  1   )       ]   =   [      h   (  x  )          L  f   h   (  x  )        ‚ãÆ        L  f   n  -  1    h   (  x  )       ]         z    T  x             subscript  z  1   x        subscript  z  2   x     normal-‚ãÆ       subscript  z  n   x            y     normal-Àô  y     normal-‚ãÆ     superscript  y    n  1               h  x        subscript  L  f   h  x     normal-‚ãÆ       superscript   subscript  L  f     n  1    h  x        z=T(x)=\begin{bmatrix}z_{1}(x)\\
 z_{2}(x)\\
 \vdots\\
 z_{n}(x)\end{bmatrix}=\begin{bmatrix}y\\
 \dot{y}\\
 \vdots\\
 y^{(n-1)}\end{bmatrix}=\begin{bmatrix}h(x)\\
 L_{f}h(x)\\
 \vdots\\
 L_{f}^{n-1}h(x)\end{bmatrix}     transforms trajectories from the original   x   x   x   coordinate system into the new   z   z   z   coordinate system. So long as this transformation is a diffeomorphism , smooth trajectories in the original coordinate system will have unique counterparts in the   z   z   z   coordinate system that are also smooth. Those   z   z   z   trajectories will be described by the new system,       {       z  Àô   1       =    L  f   h   (  x  )    =    z  2    (  x  )           z  Àô   2       =    L  f  2   h   (  x  )    =    z  3    (  x  )            ‚ãÆ        z  Àô   n       =     L  f  n   h   (  x  )    +    L  g    L  f   n  -  1    h   (  x  )   u         .     cases   subscript   normal-Àô  z   1       absent     subscript  L  f   h  x           subscript  z  2   x      subscript   normal-Àô  z   2       absent     superscript   subscript  L  f   2   h  x           subscript  z  3   x     absent  normal-‚ãÆ   subscript   normal-Àô  z   n     absent       superscript   subscript  L  f   n   h  x      subscript  L  g    superscript   subscript  L  f     n  1    h  x  u       \begin{cases}\dot{z}_{1}&=L_{f}h(x)=z_{2}(x)\\
 \dot{z}_{2}&=L_{f}^{2}h(x)=z_{3}(x)\\
 &\vdots\\
 \dot{z}_{n}&=L_{f}^{n}h(x)+L_{g}L_{f}^{n-1}h(x)u\end{cases}.     Hence, the feedback control law      u  =    1    L  g    L  f   n  -  1    h   (  x  )      (    -    L  f  n   h   (  x  )     +  v   )        u      1     subscript  L  g    superscript   subscript  L  f     n  1    h  x           superscript   subscript  L  f   n   h  x    v      u=\frac{1}{L_{g}L_{f}^{n-1}h(x)}(-L_{f}^{n}h(x)+v)     renders a linear input‚Äìoutput map from   v   v   v   to     z  1   =  y       subscript  z  1   y    z_{1}=y   . The resulting linearized system      {       z  Àô   1       =   z  2          z  Àô   2       =   z  3           ‚ãÆ        z  Àô   n       =  v         cases   subscript   normal-Àô  z   1     absent   subscript  z  2     subscript   normal-Àô  z   2     absent   subscript  z  3    absent  normal-‚ãÆ   subscript   normal-Àô  z   n     absent  v     \begin{cases}\dot{z}_{1}&=z_{2}\\
 \dot{z}_{2}&=z_{3}\\
 &\vdots\\
 \dot{z}_{n}&=v\end{cases}     is a cascade of   n   n   n   integrators, and an outer-loop control   v   v   v   may be chosen using standard linear system methodology. In particular, a state-feedback control law of      v  =  -  K  z  ,     fragments  v    K  z  italic-  normal-,    v=-Kz\qquad,     where the state vector   z   z   z   is the output   y   y   y   and its first    (   n  -  1   )      n  1    (n-1)   derivatives, results in the LTI system       z  Àô   =   A  z        normal-Àô  z     A  z     \dot{z}=Az     with,       A  =   [     0    1    0    ‚Ä¶    0      0    0    1    ‚Ä¶    0      ‚ãÆ    ‚ãÆ    ‚ãÆ    ‚ã±    ‚ãÆ      0    0    0    ‚Ä¶    1       -   k  1       -   k  2       -   k  3      ‚Ä¶     -   k  n       ]    .      A    0  1  0  normal-‚Ä¶  0    0  0  1  normal-‚Ä¶  0    normal-‚ãÆ  normal-‚ãÆ  normal-‚ãÆ  normal-‚ã±  normal-‚ãÆ    0  0  0  normal-‚Ä¶  1       subscript  k  1       subscript  k  2       subscript  k  3    normal-‚Ä¶     subscript  k  n        A=\begin{bmatrix}0&1&0&\ldots&0\\
 0&0&1&\ldots&0\\
 \vdots&\vdots&\vdots&\ddots&\vdots\\
 0&0&0&\ldots&1\\
 -k_{1}&-k_{2}&-k_{3}&\ldots&-k_{n}\end{bmatrix}.     So, with the appropriate choice of   k   k   k   , we can arbitrarily place the closed-loop poles of the linearized system.  Unstable zero dynamics  Feedback linearization can be accomplished with systems that have relative degree less than   n   n   n   . However, the normal form of the system will include zero dynamics (i.e., states that are not observable from the output of the system) that may be unstable. In practice, unstable dynamics may have deleterious effects on the system (e.g., it may be dangerous for internal states of the system to grow unbounded). These unobservable states may be controllable or at least stable, and so measures can be taken to ensure these states do not cause problems in practice.  See also   Nonlinear control   Further reading   A. Isidori, Nonlinear Control Systems, third edition, Springer Verlag, London, 1995.  H. K. Khalil, Nonlinear Systems, third edition, Prentice Hall, Upper Saddle River, New Jersey, 2002.  M. Vidyasagar, Nonlinear Systems Analysis second edition, Prentice Hall, Englewood Cliffs, New Jersey, 1993.  B. Friedland, Advanced Control System Design Facsimile edition, Prentice Hall, Upper Saddle river, New Jersey, 1996.   External links   ECE¬†758: Modeling and Nonlinear Control of a Single-link Flexible Joint Manipulator ‚Äì Gives explanation and an application of feedback linearization.  ECE¬†758: Ball-in-Tube Linearization Example ‚Äì Trivial application of linearization for a system already in normal form (i.e., no coordinate transformation necessary).  Wolfram language functions to do feedback linearization , compute relative orders , and determine zero dynamics .   "  Category:Control theory  Category:Nonlinear control   
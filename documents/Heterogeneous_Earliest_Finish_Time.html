<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1896">Heterogeneous Earliest Finish Time</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Heterogeneous Earliest Finish Time</h1>
<hr/>

<p><strong>Heterogeneous Earliest Finish Time</strong> (or HEFT) is a heuristic to schedule a set of dependent tasks onto a network of heterogeneous workers taking communication time into account.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> For inputs HEFT takes a set of tasks, represented as a <a href="directed_acyclic_graph" title="wikilink">directed acyclic graph</a>, a set of workers, the times to execute each task on each worker, and the times to communicate the results from each job to each of its children between each pair of workers. It descends from <a href="list_scheduling" title="wikilink">list scheduling</a> algorithms.</p>
<h2 id="algorithm">Algorithm</h2>

<p>HEFT executes in two phases.</p>
<h3 id="prioritizing-tasks">Prioritizing tasks</h3>

<p>In the first phase each task is given a priority. The priority of each task 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:0">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{i}
  </annotation>
 </semantics>
</math>

 is usually designated to be its "upward rank" which is defined recursively as follows</p>

<p>

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mi>a</mi>
    <mi>n</mi>
    <msub>
     <mi>k</mi>
     <mi>u</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <msub>
      <mi>w</mi>
      <mi>i</mi>
     </msub>
     <mo>¯</mo>
    </mover>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>max</mi>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>j</mi>
       </msub>
       <mo>∈</mo>
       <mrow>
        <mi>s</mi>
        <mi>u</mi>
        <mi>c</mi>
        <mi>c</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>n</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <msub>
         <mi>c</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>¯</mo>
       </mover>
       <mo>+</mo>
       <mrow>
        <mi>r</mi>
        <mi>a</mi>
        <mi>n</mi>
        <msub>
         <mi>k</mi>
         <mi>u</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>n</mi>
          <mi>j</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>a</ci>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>u</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <max></max>
       <apply>
        <in></in>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <ci>u</ci>
         <ci>c</ci>
         <ci>c</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-¯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <list>
          <ci>i</ci>
          <ci>j</ci>
         </list>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>r</ci>
        <ci>a</ci>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   rank_{u}(n_{i})=\overline{w_{i}}+\max_{n_{j}\in succ(n_{i})}(\overline{c_{i,j}%
}+rank_{u}(n_{j}))
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:2">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{i}
  </annotation>
 </semantics>
</math>

 represents the 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:3">
 <semantics>
  <msup>
   <mi>i</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>i</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i^{th}
  </annotation>
 </semantics>
</math>

 task, 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:4">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{w_{i}}
  </annotation>
 </semantics>
</math>

 is an average computation cost of job i among all the workers, 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:5">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mi>u</mi>
   <mi>c</mi>
   <mi>c</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>n</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>s</ci>
    <ci>u</ci>
    <ci>c</ci>
    <ci>c</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   succ(n_{i})
  </annotation>
 </semantics>
</math>

 is the set of all jobs that immediately depend on task 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:6">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{i}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:7">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{c_{i,j}}
  </annotation>
 </semantics>
</math>

 is the average communication cost of the variables transferred between jobs 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:8">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:9">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{j}
  </annotation>
 </semantics>
</math>

 between all pairs of workers. Note that the computation of 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:10">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mi>a</mi>
   <mi>n</mi>
   <msub>
    <mi>k</mi>
    <mi>u</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>n</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>r</ci>
    <ci>a</ci>
    <ci>n</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>u</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   rank_{u}(n_{i})
  </annotation>
 </semantics>
</math>

 depends on the computation of the rank of all its children. The upward rank is meant to represent the expected distance of any task from the end of the computation. For averaged quantities like 

<math display="inline" id="Heterogeneous_Earliest_Finish_Time:11">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{w_{i}}
  </annotation>
 </semantics>
</math>

 different averages may provide different results.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="assigning-tasks-to-workers">Assigning tasks to workers</h3>

<p>In the second phase tasks are assigned to workers. Now that all tasks are prioritized we consider and schedule each one, starting with the highest priority. The task with the highest priority for which all dependent tasks have finished is scheduled on the worker which will result in the earliest finish time of that task. This finish time depends on the communication time to send all necessary inputs to the worker, the computation time of the task on the worker, and the time when that processor becomes available (it may be busy with another task).</p>
<h2 id="performance">Performance</h2>

<p>HEFT is well respected among heuristic algorithms for this problem. However in complex situations it can easily fail to find the optimal scheduling. HEFT is essentially a greedy algorithm and incapable of making short-term sacrifices for long term benefits.</p>
<h2 id="code">Code</h2>

<p>A Python implementation of HEFT is available <a href="https://github.com/mrocklin/heft">on github</a></p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Scheduling_algorithms" title="wikilink">Category:Scheduling algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

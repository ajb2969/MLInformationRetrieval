   Mixed logit      Mixed logit   Mixed logit is a fully general statistical model for examining discrete choices . The motivation for the mixed logit model arises from the limitations of the standard logit model. The standard logit model has three primary limitations, which mixed logit solves: "It [Mixed Logit] obviates the three limitations of standard logit by allowing for random taste variation, unrestricted substitution patterns, and correlation in unobserved factors over time." 1 Mixed logit can also utilize any distribution for the random coefficients, unlike probit which is limited to the normal distribution. It has been shown that a mixed logit model can approximate to any degree of accuracy any true random utility model of discrete choice, given an appropriate specification of variables and distribution of coefficients." 2 The following discussion draws from Ch. 6 of Discrete Choice Methods with Simulation , by Kenneth Train ( Cambridge University Press ), to which the reader is referred for more details and citations. See also the article on discrete choice for information on how the mixed logit relates to discrete choice analysis in general and to other specific types of choice models.  Random taste variation  The standard logit model's "taste" cofficients, or   β   β   \beta   's, are fixed, which means the   β   β   \beta   's are the same for everyone. Mixed logit has different   β   β   \beta   's for each person (i.e., each decision maker.)  In the standard logit model, the utility of person n for alternative i is:       U   n  i    =    β   x   n  i     +   ε   n  i          subscript  U    n  i        β   subscript  x    n  i      subscript  ε    n  i       U_{ni}=\beta x_{ni}+\varepsilon_{ni}     with      ε   n  i      subscript  ε    n  i     \varepsilon_{ni}   ~ iid extreme value  For the mixed logit model, this specification is generalized by allowing    β  n     subscript  β  n    \beta_{n}   to be random. The utility of person n for alternative i in the mixed logit model is:       U   n  i    =     β  n    x   n  i     +   ε   n  i          subscript  U    n  i         subscript  β  n    subscript  x    n  i      subscript  ε    n  i       U_{ni}=\beta_{n}x_{ni}+\varepsilon_{ni}     with      ε   n  i      subscript  ε    n  i     \varepsilon_{ni}   ~ iid extreme value        β   n   ∼  f   (  β  |  θ  )      fragments   subscript  β  n   similar-to  f   fragments  normal-(  β  normal-|  θ  normal-)     \quad\beta_{n}\sim f(\beta|\theta)     where θ are the parameters of the distribution of    β  n     subscript  β  n    \beta_{n}   's over the population, such as the mean and variance of    β  n     subscript  β  n    \beta_{n}   .  Conditional on    β  n     subscript  β  n    \beta_{n}   , the probability that person n chooses alternative i is the standard logit formula:        L   n  i     (   β  n   )    =    e    β  n    X   n  i        ∑  j    e    β  n    X   n  j               subscript  L    n  i     subscript  β  n       superscript  e     subscript  β  n    subscript  X    n  i        subscript   j    superscript  e     subscript  β  n    subscript  X    n  j          L_{ni}(\beta_{n})=\frac{e^{\beta_{n}X_{ni}}}{\sum_{j}e^{\beta_{n}X_{nj}}}   However, since    β  n     subscript  β  n    \beta_{n}   is random and not known, the (unconditional) choice probability is the integral of this logit formula over the density of    β  n     subscript  β  n    \beta_{n}   .       P   n  i    =  ∫   L   n  i     (  β  )   f   (  β  |  θ  )   d  β     fragments   subscript  P    n  i       subscript  L    n  i     fragments  normal-(  β  normal-)   f   fragments  normal-(  β  normal-|  θ  normal-)   d  β    P_{ni}=\int L_{ni}(\beta)f(\beta|\theta)d\beta     This model is also called the random coefficient logit model since    β  n     subscript  β  n    \beta_{n}   is a random variable. It allows the slopes of utility (i.e., the marginal utility) to be random, which is an extension of the random effects model where only the intercept was stochastic.  Any probability density function can be specified for the distribution of the coefficients in the population, i.e., for    f   (  β  |  θ  )      fragments  f   fragments  normal-(  β  normal-|  θ  normal-)     f(\beta|\theta)   . The most widely used distribution is normal, mainly for its simplicity. For coefficients that take the same sign for all people, such as a price coefficient that is necessarily negative or the coefficient of a desirable attribute, distributions with support on only one side of zero, like the lognormal, are used. 3 4 When coefficients cannot logically be unboundedly large or small, then bounded distributions are often used, such as the    S  b     subscript  S  b    S_{b}   or triangular distributions.  Unrestricted substitution patterns  The mixed logit model can represent general substitution pattern because it does not exhibit logit's restrictive independence of irrelevant alternatives (IIA) property. The percentage change in the probability for one alternative given a percentage change in the m th attribute of another alternative is       E   n  i   x   n  j   m     =   -     x   n  j   m    P   n  i      ∫    β  m    L   n  i     (  β  )    L   n  j     (  β  )   f   (  β  )   d  β      =   -    x   n  j   m    ∫    β  m    L   n  j     (  β  )      L   n  i     (  β  )     P   n  i     f   (  β  )   d  β             subscript  E    n  i   superscript   subscript  x    n  j    m            superscript   subscript  x    n  j    m    subscript  P    n  i          superscript  β  m    subscript  L    n  i    β   subscript  L    n  j    β  f  β  d  β                superscript   subscript  x    n  j    m        superscript  β  m    subscript  L    n  j    β       subscript  L    n  i    β    subscript  P    n  i     f  β  d  β         E_{nix_{nj}^{m}}=-\frac{x_{nj}^{m}}{P_{ni}}\int\beta^{m}L_{ni}(\beta)L_{nj}(%
 \beta)f(\beta)d\beta=-x_{nj}^{m}\int\beta^{m}L_{nj}(\beta)\frac{L_{ni}(\beta)}%
 {P_{ni}}f(\beta)d\beta     where β  m is the m th element of   β   β   \beta   . 5 It can be seen from this formula that "A ten-percent reduction for one alternative need not imply (as with logit) a ten-percent reduction in each other alternative." 6 The relative percentages depend on correlation between the likelihood that respondent n will choose alternative i, L ni , and the likelihood that respondent n will choose alternative j, L nj , over various draws of β .  Correlation in unobserved factors over time  Standard logit does not take into account any unobserved factors that persist over time for a given decision maker. This can be a problem if you are using panel data, which represent repeated choices over time. By applying a standard logit model to panel data you are making the assumption that the unobserved factors that affect a person's choice are new every time the person makes the choice. That is a very unlikely assumption. To take into account both random taste variation and correlation in unobserved factors over time, the utility for respondent n for alternative i at time t is specified as follows:       U   n  i  t    =     β  n    X   n  i  t     +   ε   n  i  t          subscript  U    n  i  t         subscript  β  n    subscript  X    n  i  t      subscript  ε    n  i  t       U_{nit}=\beta_{n}X_{nit}+\varepsilon_{nit}     where the subscript t is the time dimension. We still make the logit assumption which is that   ε   ε   \varepsilon   is i.i.d extreme value. That means that   ε   ε   \varepsilon   is independent over time, people, and alternatives.   ε   ε   \varepsilon   is essentially just white noise. However, correlation over time and over alternatives arises from the common effect of the   β   β   \beta   's, which enter utility in each time period and each alternative.  To examine the correlation explicitly, assume that the β 's are normally distributed with mean    β  ¯     normal-¯  β    \bar{\beta}   and variance    σ  2     superscript  σ  2    \sigma^{2}   . Then the utility equation becomes:       U   n  i  t    =     (    β  ¯   +   σ   η  n     )    X   n  i  t     +   ε   n  i  t          subscript  U    n  i  t           normal-¯  β     σ   subscript  η  n      subscript  X    n  i  t      subscript  ε    n  i  t       U_{nit}=(\bar{\beta}+\sigma\eta_{n})X_{nit}+\varepsilon_{nit}     and η is a draw from the standard normal density. Rearranging, the equation becomes:       U   n  i  t    =     β  ¯    X   n  i  t     +   (    σ   η  n    X   n  i  t     +   ε   n  i  t     )         subscript  U    n  i  t         normal-¯  β    subscript  X    n  i  t         σ   subscript  η  n    subscript  X    n  i  t      subscript  ε    n  i  t        U_{nit}=\bar{\beta}X_{nit}+(\sigma\eta_{n}X_{nit}+\varepsilon_{nit})          U   n  i  t    =     β  ¯    X   n  i  t     +   e   n  i  t          subscript  U    n  i  t         normal-¯  β    subscript  X    n  i  t      subscript  e    n  i  t       U_{nit}=\bar{\beta}X_{nit}+e_{nit}     where the unobserved factors are collected in     e   n  i  t    =    σ   η  n    X   n  i  t     +   ε   n  i  t          subscript  e    n  i  t        σ   subscript  η  n    subscript  X    n  i  t      subscript  ε    n  i  t       e_{nit}=\sigma\eta_{n}X_{nit}+\varepsilon_{nit}   . Of the unobserved factors,    ε   n  i  t      subscript  ε    n  i  t     \varepsilon_{nit}   is independent over time, and    σ   η  n    X   n  i  t        σ   subscript  η  n    subscript  X    n  i  t      \sigma\eta_{n}X_{nit}   is not independent over time or alternatives.  Then the covariance between alternatives   i   i   i   and   j   j   j   is,       C  o  v   (   e   n  i  t    ,   e   n  j  t    )    =    σ  2    (    X   n  i  t     X   n  j  t     )          C  o  v    subscript  e    n  i  t     subscript  e    n  j  t         superscript  σ  2      subscript  X    n  i  t     subscript  X    n  j  t        Cov(e_{nit},e_{njt})=\sigma^{2}(X_{nit}X_{njt})     and the covariance between time   t   t   t   and   q   q   q   is       C  o  v   (   e   n  i  t    ,   e   n  i  q    )    =    σ  2    (    X   n  i  t     X   n  i  q     )          C  o  v    subscript  e    n  i  t     subscript  e    n  i  q         superscript  σ  2      subscript  X    n  i  t     subscript  X    n  i  q        Cov(e_{nit},e_{niq})=\sigma^{2}(X_{nit}X_{niq})     By specifying the X's appropriately, one can obtain any pattern of covariance over time and alternatives.  Conditional on    β  n     subscript  β  n    \beta_{n}   , the probability of the sequence of choices by a person is simply the product of the logit probability of each individual choice by that person:        L  n    (   β  n   )    =    ∏  t     e    β  n    X   n  i  t        ∑  j    e    β  n    X   n  j  t                subscript  L  n    subscript  β  n      subscript  product  t      superscript  e     subscript  β  n    subscript  X    n  i  t        subscript   j    superscript  e     subscript  β  n    subscript  X    n  j  t           L_{n}(\beta_{n})=\prod_{t}\frac{e^{\beta_{n}X_{nit}}}{\sum_{j}e^{\beta_{n}X_{%
 njt}}}     since    ε   n  i  t      subscript  ε    n  i  t     \varepsilon_{nit}   is independent over time. Then the (unconditional) probability of the sequence of choices is simply the integral of this product of logits over the density of   β   β   \beta   .       P   n  i    =  ∫   L  n    (  β  )   f   (  β  |  θ  )   d  β     fragments   subscript  P    n  i       subscript  L  n    fragments  normal-(  β  normal-)   f   fragments  normal-(  β  normal-|  θ  normal-)   d  β    P_{ni}=\int L_{n}(\beta)f(\beta|\theta)d\beta     Simulation  Unfortunately there is no closed form for the integral that enters the choice probability, and so the researcher must simulate P n . Fortunately for the researcher, simulating P n can be very simple. There are four basic steps to follow  1. Take a draw from the probability density function that you specified for the 'taste' coefficients. That is, take a draw from    f   (  β  |  θ  )      fragments  f   fragments  normal-(  β  normal-|  θ  normal-)     f(\beta|\theta)   and label the draw    β  r     superscript  β  r    \beta^{r}   , for    r  =  1      r  1    r=1   representing the first draw.  2. Calculate     L  n    (   β  r   )        subscript  L  n    superscript  β  r     L_{n}(\beta^{r})   . (The conditional probability.)  3. Repeat many times, for    r  =   2  ,  …  ,  R       r   2  normal-…  R     r=2,...,R   .  4. Average the results  Then the formula for the simulation look like the following,        P  ~    n  i    =      ∑  r      L  n    (   β  r   )     R        subscript   normal-~  P     n  i        subscript   r      subscript  L  n    superscript  β  r     R     \tilde{P}_{ni}=\frac{\sum_{r}L_{n}(\beta^{r})}{R}     where R is the total number of draws taken from the distribution, and r is one draw.  Once this is done you will have a value for the probability of each alternative i for each respondent n.  References  "  Category:Statistical models     Train, K. (2003) Discrete Choice Methods with Simulation ↩  McFadden, D. and Train, K. (2000). “ Mixed MNL Models for Discrete Response ,” Journal of Applied Econometrics, Vol. 15, No. 5, pp. 447-470, ↩  David Revelt and Train, K (1998). " Mixed Logit with Repeated Choices: Households' Choices of Appliance Efficiency Level ," Review of Economics and Statistics, Vol. 80, No. 4, pp. 647-657 ↩  Train, K (1998)." Recreation Demand Models with Taste Variation ," Land Economics, Vol. 74, No. 2, pp. 230-239. ↩  Train, Kenneth ↩      
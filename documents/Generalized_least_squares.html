<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1506">Generalized least squares</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Generalized least squares</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>generalized least squares (GLS)</strong> is a technique for estimating the unknown <a href="parameter" title="wikilink">parameters</a> in a <a href="linear_regression" title="wikilink">linear regression</a> model. GLS application is warranted when there is a certain degree of <a class="uri" href="correlation" title="wikilink">correlation</a> between the observations. In these cases, <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a> and <a href="weighted_least_squares" title="wikilink">weighted least squares</a> can be statistically <a href="efficiency_(statistics)" title="wikilink">inefficient</a>, or even give misleading <a href="statistical_inference" title="wikilink">inferences</a>. GLS was first described by <a href="Alexander_Aitken" title="wikilink">Alexander Aitken</a> in 1934.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="method-outline">Method outline</h2>

<p>In a typical <a href="linear_regression" title="wikilink">linear regression</a> model we observe data 

<math display="inline" id="Generalized_least_squares:0">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mrow>
      <mn>1..</mn>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mrow>
      <mn>1..</mn>
      <mi>p</mi>
     </mrow>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </set>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <apply>
       <times></times>
       <cn type="float">1..</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>j</ci>
      <apply>
       <times></times>
       <cn type="float">1..</cn>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{y_{i},x_{ij}\}_{i=1..n,j=1..p}
  </annotation>
 </semantics>
</math>

 on <em>n</em> <a href="statistical_unit" title="wikilink">statistical units</a>. The response values are placed in a vector <em>Y</em>¬†=¬†(<em>y</em><sub>1</sub>, ..., <em>y</em><sub><em>n</em></sub>)‚Ä≤, and the predictor values are placed in the design matrix <em>X</em>¬†=¬†<a class="uri" href="''x''&lt;sub&gt;''ij''&lt;/sub&gt;" title="wikilink">''x''<sub>''ij''</sub></a>, where <em>x</em><sub><em>ij</em></sub> is the value of the <em>j</em>th predictor variable for the <em>i</em>th unit. The model assumes that the <a href="conditional_mean" title="wikilink">conditional mean</a> of <em>Y</em> given <em>X</em> is a linear function of <em>X</em>, whereas the conditional <a href="covariance_matrix" title="wikilink">variance</a> of the error term given <em>X</em> is a <em>known</em> matrix Œ©. This is usually written as</p>

<p>

<math display="block" id="Generalized_least_squares:1">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mi>X</mi>
   <mi>Œ≤</mi>
   <mo>+</mo>
   <mi>Œµ</mi>
   <mo rspace="22.5pt">,</mo>
   <mi mathvariant="normal">E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>Œµ</mi>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
   <mo rspace="7.5pt">,</mo>
   <mo>Var</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>Œµ</mi>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mi mathvariant="normal">Œ©</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Y</csymbol>
    <eq></eq>
    <csymbol cd="unknown">X</csymbol>
    <csymbol cd="unknown">Œ≤</csymbol>
    <plus></plus>
    <csymbol cd="unknown">Œµ</csymbol>
    <ci>normal-,</ci>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">Œµ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">0</cn>
    <ci>normal-,</ci>
    <ci>Var</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">Œµ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">Œ©</csymbol>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=X\beta+\varepsilon,\qquad\mathrm{E}[\varepsilon|X]=0,\ \operatorname{Var}[%
\varepsilon|X]=\Omega.
  </annotation>
 </semantics>
</math>

 Here <em>Œ≤</em> is a vector of unknown ‚Äúregression coefficients‚Äù that must be estimated from the data.</p>

<p>Suppose <em>b</em> is a candidate estimate for <em>Œ≤</em>. Then the <a href="errors_and_residuals_in_statistics" title="wikilink">residual</a> vector for <em>b</em> will be <em>Y</em>¬†‚àí¬†<em>Xb</em>. Generalized least squares method estimates <em>Œ≤</em> by minimizing the squared <a href="Mahalanobis_distance" title="wikilink">Mahalanobis length</a> of this residual vector:</p>

<p>

<math display="block" id="Generalized_least_squares:2">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>Œ≤</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <munder accentunder="true">
       <mrow>
        <mpadded width="+1.7pt">
         <mi>arg</mi>
        </mpadded>
        <mi>min</mi>
       </mrow>
       <mo>ùëè</mo>
      </munder>
     </mpadded>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi mathvariant="normal">Y</mi>
         <mo>-</mo>
         <mi>Xb</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>‚Ä≤</mo>
      </msup>
     </mpadded>
     <msup>
      <mi mathvariant="normal">Œ©</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi mathvariant="normal">Y</mi>
       <mo>-</mo>
       <mi>Xb</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>Œ≤</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>b</ci>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>min</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>normal-Y</ci>
       <ci>Xb</ci>
      </apply>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Œ©</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>normal-Y</ci>
      <ci>Xb</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}=\underset{b}{\rm arg\,min}\,(Y-Xb)^{\prime}\,\Omega^{-1}(Y-Xb),
  </annotation>
 </semantics>
</math>

</p>

<p>Since the objective is a quadratic form in <em>b</em>, the estimator has an explicit formula:</p>

<p>

<math display="block" id="Generalized_least_squares:3">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>Œ≤</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mo>‚Ä≤</mo>
        </msup>
        <msup>
         <mi mathvariant="normal">Œ©</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mi>X</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>X</mi>
      <mo>‚Ä≤</mo>
     </msup>
     <msup>
      <mi mathvariant="normal">Œ©</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mi>Y</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>Œ≤</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-‚Ä≤</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Œ©</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Œ©</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\beta}=(X^{\prime}\Omega^{-1}X)^{-1}X^{\prime}\Omega^{-1}Y.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="properties">Properties</h3>

<p>The GLS estimator is <a href="Bias_of_an_estimator" title="wikilink">unbiased</a>, <a href="consistent_estimator" title="wikilink">consistent</a>, <a href="efficiency_(statistics)" title="wikilink">efficient</a>, and <a href="asymptotic_distribution" title="wikilink">asymptotically normal</a>:</p>

<p>

<math display="block" id="Generalized_least_squares:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msqrt>
      <mi>n</mi>
     </msqrt>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>Œ≤</mi>
        <mo stretchy="false">^</mo>
       </mover>
       <mo>-</mo>
       <mi>Œ≤</mi>
      </mrow>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mpadded width="+5pt">
     <mover accent="true">
      <mo>‚Üí</mo>
      <mo>ùëë</mo>
     </mover>
    </mpadded>
    <mrow>
     <mpadded width="-1.7pt">
      <mi class="ltx_font_mathcaligraphic">ùí©</mi>
     </mpadded>
     <mrow>
      <mo>(</mo>
      <mn>0</mn>
      <mo rspace="4.2pt">,</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <msup>
           <mi>X</mi>
           <mo>‚Ä≤</mo>
          </msup>
         </mpadded>
         <msup>
          <mi mathvariant="normal">Œ©</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>d</ci>
     <ci>normal-‚Üí</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-^</ci>
       <ci>Œ≤</ci>
      </apply>
      <ci>Œ≤</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ùí©</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-‚Ä≤</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>normal-Œ©</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>X</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{n}(\hat{\beta}-\beta)\ \xrightarrow{d}\ \mathcal{N}\!\left(0,\,(X^{%
\prime}\,\Omega^{-1}X)^{-1}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>GLS is equivalent to applying ordinary least squares to a linearly transformed version of the data. To see this, factor , for instance using the <a href="Cholesky_decomposition" title="wikilink">Cholesky decomposition</a>. Then if we multiply both sides of the equation  by <em>B</em><sup>‚àí1</sup>, we get an equivalent linear model , where <mtpl></mtpl>, <mtpl></mtpl>, and <mtpl></mtpl>. In this model <mtpl></mtpl>. Thus we can efficiently estimate <em>Œ≤</em> by applying OLS to the transformed data, which requires minimizing</p>

<p>

<math display="block" id="Generalized_least_squares:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>Y</mi>
         <mo>*</mo>
        </msup>
        <mo>-</mo>
        <mrow>
         <msup>
          <mi>X</mi>
          <mo>*</mo>
         </msup>
         <mi>b</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>‚Ä≤</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>Y</mi>
        <mo>*</mo>
       </msup>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>X</mi>
         <mo>*</mo>
        </msup>
        <mi>b</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>Y</mi>
         <mo>-</mo>
         <mrow>
          <mi>X</mi>
          <mi>b</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>‚Ä≤</mo>
      </msup>
     </mpadded>
     <msup>
      <mi mathvariant="normal">Œ©</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>Y</mi>
       <mo>-</mo>
       <mrow>
        <mi>X</mi>
        <mi>b</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <times></times>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <times></times>
        </apply>
        <ci>b</ci>
       </apply>
      </apply>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Y</ci>
       <times></times>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <times></times>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>Y</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>b</ci>
       </apply>
      </apply>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Œ©</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Y^{*}-X^{*}b)^{\prime}(Y^{*}-X^{*}b)=(Y-Xb)^{\prime}\,\Omega^{-1}(Y-Xb).
  </annotation>
 </semantics>
</math>

</p>

<p>This has the effect of standardizing the scale of the errors and ‚Äúde-correlating‚Äù them. Since OLS is applied to data with homoscedastic errors, the <a href="Gauss‚ÄìMarkov_theorem" title="wikilink">Gauss‚ÄìMarkov theorem</a> applies, and therefore the GLS estimate is the <a href="Blue_(statistics)" title="wikilink">best linear unbiased estimator</a> for <em>Œ≤</em>.</p>
<h2 id="weighted-least-squares">Weighted least squares</h2>

<p>A special case of GLS called weighted least squares (WLS) occurs when all the off-diagonal entries of <em>Œ©</em> are 0. This situation arises when the variances of the observed values are unequal (i.e.¬†<a class="uri" href="heteroscedasticity" title="wikilink">heteroscedasticity</a> is present), but where no correlations exist among the observed variances. The weight for unit <em>i</em> is proportional to the reciprocal of the variance of the response for unit <em>i</em>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="feasible-generalized-least-squares">Feasible generalized least squares</h2>

<p>If the covariance of the errors 

<math display="inline" id="Generalized_least_squares:6">
 <semantics>
  <mi mathvariant="normal">Œ©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega
  </annotation>
 </semantics>
</math>

 is unknown, one can get a consistent estimate of 

<math display="inline" id="Generalized_least_squares:7">
 <semantics>
  <mi mathvariant="normal">Œ©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega
  </annotation>
 </semantics>
</math>

, say 

<math display="inline" id="Generalized_least_squares:8">
 <semantics>
  <mover accent="true">
   <mi mathvariant="normal">Œ©</mi>
   <mo>^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>normal-Œ©</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Omega}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> One strategy for building an implementable version of GLS is the Feasible Generalized Least Squares (FGLS) estimator. In FGLS, we proceed in two stages: (1) the model is estimated by OLS or another consistent (but inefficient) estimator, and the residuals are used to build a consistent estimator of the errors covariance matrix (to do so, we often need to examine the model adding additional constraints, for example if the errors follow a time series process, we generally need some theoretical assumptions on this process to ensure that a consistent estimator is available); and (2) using the consistent estimator of the covariance matrix of the errors, we implement GLS ideas.</p>

<p>Whereas GLS is more efficient than OLS under heteroscedasticity or autocorrelation, this is not true for FGLS. The feasible estimator is, provided the errors co variance matrix is consistently estimated, <em>asymptotically</em> more efficient, but for a small or medium size sample, it can be actually less efficient than OLS. This is why, some authors prefer to use OLS, and re formulate their inferences by simply considering an alternative estimator for the variance of the estimator robust to heteroscedasticity or serial autocorrelation. But for large samples FGLS is preferred over OLS under heteroskedasticity or serial correlation.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> A cautionary note is that the FGLS estimator is not always consistent. One case in which FGLS might be inconsistent is if there are individual specific fixed effects.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> In general this estimator has different properties than GLS. For large samples (i.e., asymptotically) all properties are (under appropriate conditions) common with respect to GLS, but for finite samples the properties of FGLS estimators are unknown: they vary dramatically with each particular model, and as a general rule their exact distributions cannot be derived analytically. For finite samples, FGLS may be even less efficient than OLS in some cases. Thus, while GLS can be made feasible, it is not always wise to apply this method when the sample is small. A method sometimes used to improve the accuracy of the estimators in finite samples is to iterate, i.e. taking the residuals from FGLS to update the errors covariance estimator, and then updating the FGLS estimation, applying the same idea iteratively until the estimators vary less than some tolerance. But this method does not necessarily improve the efficiency of the estimator very much if the original sample was small. A reasonable option when samples are not too large is to apply OLS, but throwing away the classical variance estimator</p>

<p>

<math display="block" id="Generalized_least_squares:9">
 <semantics>
  <mrow>
   <msup>
    <mi>œÉ</mi>
    <mn>2</mn>
   </msup>
   <mo>*</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mo>‚Ä≤</mo>
      </msup>
      <mi>X</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>œÉ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-‚Ä≤</ci>
      </apply>
      <ci>X</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}*(X^{\prime}X)^{-1}
  </annotation>
 </semantics>
</math>

 (which is inconsistent in this framework) and using a HAC (Heteroskedasticity and Autocorrelation Consistent) estimator. For example, in autocorrelation context we can use the Bartlett estimator (often known as Newey-West estimator since these authors popularized the use of this estimator among econometricians in their 1987 Econometrica article), and in heteroskedastic context we can use the Eicker‚ÄìWhite estimator (<a href="Heteroscedasticity-consistent_standard_errors" title="wikilink">Eicker‚ÄìWhite</a>). This approach is much safer, and it is the appropriate path to take unless the sample is large, and "large" is sometimes a slippery issue (e.g. if the errors distribution is asymmetric the required sample would be much larger).</p>

<p>The <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a> (OLS) estimator is calculated as usual by</p>

<p>

<math display="block" id="Generalized_least_squares:10">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Œ≤</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>O</mi>
     <mi>L</mi>
     <mi>S</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mo>‚Ä≤</mo>
       </msup>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mo>‚Ä≤</mo>
    </msup>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œ≤</ci>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <ci>L</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-‚Ä≤</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{OLS}=(X^{\prime}X)^{-1}X^{\prime}y
  </annotation>
 </semantics>
</math>

</p>

<p>and estimates of the residuals 

<math display="inline" id="Generalized_least_squares:11">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>u</mi>
     <mo>^</mo>
    </mover>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>Y</mi>
      <mo>-</mo>
      <mrow>
       <mi>X</mi>
       <mi>b</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>u</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <minus></minus>
      <ci>Y</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>b</ci>
      </apply>
     </apply>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{u}_{j}=(Y-Xb)_{j}
  </annotation>
 </semantics>
</math>

 are constructed.</p>

<p>For simplicity consider the model for heteroskedastic errors. Assume that the variance-covariance matrix 

<math display="inline" id="Generalized_least_squares:12">
 <semantics>
  <mi mathvariant="normal">Œ©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Œ©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega
  </annotation>
 </semantics>
</math>

 of the error vector is diagonal, or equivalently that errors from distinct observations are uncorrelated. Then each diagonal entry may be estimated by the fitted residuals 

<math display="inline" id="Generalized_least_squares:13">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>u</mi>
    <mo>^</mo>
   </mover>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>u</ci>
    </apply>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{u}_{j}
  </annotation>
 </semantics>
</math>

 so 

<math display="inline" id="Generalized_least_squares:14">
 <semantics>
  <msub>
   <mover accent="true">
    <mi mathvariant="normal">Œ©</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mi>O</mi>
    <mi>L</mi>
    <mi>S</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>normal-Œ©</ci>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <ci>L</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Omega}_{OLS}
  </annotation>
 </semantics>
</math>

 may be constructed by</p>

<p>

<math display="block" id="Generalized_least_squares:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi mathvariant="normal">Œ©</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mi>O</mi>
      <mi>L</mi>
      <mi>S</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>diag</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mover accent="true">
        <mi>œÉ</mi>
        <mo>^</mo>
       </mover>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>,</mo>
      <msubsup>
       <mover accent="true">
        <mi>œÉ</mi>
        <mo>^</mo>
       </mover>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>,</mo>
      <mi mathvariant="normal">‚Ä¶</mi>
      <mo>,</mo>
      <msubsup>
       <mover accent="true">
        <mi>œÉ</mi>
        <mo>^</mo>
       </mover>
       <mi>n</mi>
       <mn>2</mn>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>normal-Œ©</ci>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <ci>L</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <ci>diag</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>œÉ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>œÉ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>œÉ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Omega}_{OLS}=\operatorname{diag}(\widehat{\sigma}^{2}_{1},\widehat{%
\sigma}^{2}_{2},\dots,\widehat{\sigma}^{2}_{n}).
  </annotation>
 </semantics>
</math>

</p>

<p>It is important to notice that the squared residuals cannot be used in the previous expression; we need an estimator of the errors variances. To do so, we can use a parametric heteroskedasticity model, or a nonparametric estimator. Once this step is fulfilled, we can proceed:</p>

<p>Estimate 

<math display="inline" id="Generalized_least_squares:16">
 <semantics>
  <msub>
   <mi>Œ≤</mi>
   <mrow>
    <mi>F</mi>
    <mi>G</mi>
    <mi>L</mi>
    <mi>S</mi>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œ≤</ci>
    <apply>
     <times></times>
     <ci>F</ci>
     <ci>G</ci>
     <ci>L</ci>
     <ci>S</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta_{FGLS1}
  </annotation>
 </semantics>
</math>

 using 

<math display="inline" id="Generalized_least_squares:17">
 <semantics>
  <msub>
   <mover accent="true">
    <mi mathvariant="normal">Œ©</mi>
    <mo>^</mo>
   </mover>
   <mrow>
    <mi>O</mi>
    <mi>L</mi>
    <mi>S</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>normal-Œ©</ci>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <ci>L</ci>
     <ci>S</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Omega}_{OLS}
  </annotation>
 </semantics>
</math>

 using<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> <a href="weighted_least_squares" title="wikilink">weighted least squares</a></p>

<p>

<math display="block" id="Generalized_least_squares:18">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Œ≤</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>F</mi>
     <mi>G</mi>
     <mi>L</mi>
     <mi>S</mi>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mo>‚Ä≤</mo>
       </msup>
       <msubsup>
        <mover accent="true">
         <mi mathvariant="normal">Œ©</mi>
         <mo>^</mo>
        </mover>
        <mrow>
         <mi>O</mi>
         <mi>L</mi>
         <mi>S</mi>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mo>‚Ä≤</mo>
    </msup>
    <msubsup>
     <mover accent="true">
      <mi mathvariant="normal">Œ©</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mi>O</mi>
      <mi>L</mi>
      <mi>S</mi>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œ≤</ci>
     </apply>
     <apply>
      <times></times>
      <ci>F</ci>
      <ci>G</ci>
      <ci>L</ci>
      <ci>S</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-‚Ä≤</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>normal-Œ©</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>O</ci>
         <ci>L</ci>
         <ci>S</ci>
        </apply>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>normal-Œ©</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>O</ci>
       <ci>L</ci>
       <ci>S</ci>
      </apply>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{FGLS1}=(X^{\prime}\widehat{\Omega}^{-1}_{OLS}X)^{-1}X^{\prime%
}\widehat{\Omega}^{-1}_{OLS}y
  </annotation>
 </semantics>
</math>

</p>

<p>The procedure can be iterated. The first iteration is given by</p>

<p>

<math display="block" id="Generalized_least_squares:19">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>u</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>F</mi>
     <mi>G</mi>
     <mi>L</mi>
     <mi>S</mi>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>Y</mi>
    <mo>-</mo>
    <mrow>
     <mi>X</mi>
     <msub>
      <mover accent="true">
       <mi>Œ≤</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>F</mi>
       <mi>G</mi>
       <mi>L</mi>
       <mi>S</mi>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>u</ci>
     </apply>
     <apply>
      <times></times>
      <ci>F</ci>
      <ci>G</ci>
      <ci>L</ci>
      <ci>S</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <ci>Y</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>Œ≤</ci>
       </apply>
       <apply>
        <times></times>
        <ci>F</ci>
        <ci>G</ci>
        <ci>L</ci>
        <ci>S</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{u}_{FGLS1}=Y-X\widehat{\beta}_{FGLS1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Generalized_least_squares:20">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi mathvariant="normal">Œ©</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>F</mi>
     <mi>G</mi>
     <mi>L</mi>
     <mi>S</mi>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>diag</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mover accent="true">
       <mi>œÉ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mrow>
        <mi>F</mi>
        <mi>G</mi>
        <mi>L</mi>
        <mi>S</mi>
        <mn>1</mn>
       </mrow>
       <mo>,</mo>
       <mn>1</mn>
      </mrow>
      <mn>2</mn>
     </msubsup>
     <mo>,</mo>
     <msubsup>
      <mover accent="true">
       <mi>œÉ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mrow>
        <mi>F</mi>
        <mi>G</mi>
        <mi>L</mi>
        <mi>S</mi>
        <mn>1</mn>
       </mrow>
       <mo>,</mo>
       <mn>2</mn>
      </mrow>
      <mn>2</mn>
     </msubsup>
     <mo>,</mo>
     <mi mathvariant="normal">‚Ä¶</mi>
     <mo>,</mo>
     <msubsup>
      <mover accent="true">
       <mi>œÉ</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mrow>
        <mi>F</mi>
        <mi>G</mi>
        <mi>L</mi>
        <mi>S</mi>
        <mn>1</mn>
       </mrow>
       <mo>,</mo>
       <mi>n</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>normal-Œ©</ci>
     </apply>
     <apply>
      <times></times>
      <ci>F</ci>
      <ci>G</ci>
      <ci>L</ci>
      <ci>S</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <ci>diag</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>œÉ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <list>
       <apply>
        <times></times>
        <ci>F</ci>
        <ci>G</ci>
        <ci>L</ci>
        <ci>S</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>œÉ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <list>
       <apply>
        <times></times>
        <ci>F</ci>
        <ci>G</ci>
        <ci>L</ci>
        <ci>S</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </list>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>œÉ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <list>
       <apply>
        <times></times>
        <ci>F</ci>
        <ci>G</ci>
        <ci>L</ci>
        <ci>S</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Omega}_{FGLS1}=\operatorname{diag}(\widehat{\sigma}^{2}_{FGLS1,1},%
\widehat{\sigma}^{2}_{FGLS1,2},\dots,\widehat{\sigma}^{2}_{FGLS1,n})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Generalized_least_squares:21">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>Œ≤</mi>
     <mo>^</mo>
    </mover>
    <mrow>
     <mi>F</mi>
     <mi>G</mi>
     <mi>L</mi>
     <mi>S</mi>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mo>‚Ä≤</mo>
       </msup>
       <msubsup>
        <mover accent="true">
         <mi mathvariant="normal">Œ©</mi>
         <mo>^</mo>
        </mover>
        <mrow>
         <mi>F</mi>
         <mi>G</mi>
         <mi>L</mi>
         <mi>S</mi>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <mi>X</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mo>‚Ä≤</mo>
    </msup>
    <msubsup>
     <mover accent="true">
      <mi mathvariant="normal">Œ©</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mi>F</mi>
      <mi>G</mi>
      <mi>L</mi>
      <mi>S</mi>
      <mn>1</mn>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>Œ≤</ci>
     </apply>
     <apply>
      <times></times>
      <ci>F</ci>
      <ci>G</ci>
      <ci>L</ci>
      <ci>S</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-‚Ä≤</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>normal-Œ©</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>F</ci>
         <ci>G</ci>
         <ci>L</ci>
         <ci>S</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>normal-Œ©</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>F</ci>
       <ci>G</ci>
       <ci>L</ci>
       <ci>S</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\beta}_{FGLS2}=(X^{\prime}\widehat{\Omega}^{-1}_{FGLS1}X)^{-1}X^{%
\prime}\widehat{\Omega}^{-1}_{FGLS1}y
  </annotation>
 </semantics>
</math>

</p>

<p>This estimation of 

<math display="inline" id="Generalized_least_squares:22">
 <semantics>
  <mover accent="true">
   <mi mathvariant="normal">Œ©</mi>
   <mo>^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>normal-Œ©</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Omega}
  </annotation>
 </semantics>
</math>

 can be iterated to convergence.</p>

<p>Under regularity conditions any of the FGLS estimator (or that of any of its iterations, if we iterate a finite number of times) is asymptotically distributed as</p>

<p>

<math display="block" id="Generalized_least_squares:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msqrt>
      <mi>n</mi>
     </msqrt>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>Œ≤</mi>
         <mo stretchy="false">^</mo>
        </mover>
        <mrow>
         <mi>F</mi>
         <mi>G</mi>
         <mi>L</mi>
         <mi>S</mi>
        </mrow>
       </msub>
       <mo>-</mo>
       <mi>Œ≤</mi>
      </mrow>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mpadded width="+5pt">
     <mover accent="true">
      <mo>‚Üí</mo>
      <mo>ùëë</mo>
     </mover>
    </mpadded>
    <mrow>
     <mpadded width="-1.7pt">
      <mi class="ltx_font_mathcaligraphic">ùí©</mi>
     </mpadded>
     <mrow>
      <mo>(</mo>
      <mn>0</mn>
      <mo rspace="4.2pt">,</mo>
      <mi>V</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <ci>d</ci>
     <ci>normal-‚Üí</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>Œ≤</ci>
       </apply>
       <apply>
        <times></times>
        <ci>F</ci>
        <ci>G</ci>
        <ci>L</ci>
        <ci>S</ci>
       </apply>
      </apply>
      <ci>Œ≤</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>ùí©</ci>
     <interval closure="open">
      <cn type="integer">0</cn>
      <ci>V</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{n}(\hat{\beta}_{FGLS}-\beta)\ \xrightarrow{d}\ \mathcal{N}\!\left(0,\,V%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>where n is the sample size and</p>

<p>

<math display="block" id="Generalized_least_squares:24">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>=</mo>
   <mrow>
    <mtext>p-lim</mtext>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>X</mi>
        <mo>‚Ä≤</mo>
       </msup>
       <msup>
        <mi mathvariant="normal">Œ©</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mi>X</mi>
      </mrow>
      <mo>/</mo>
      <mi>T</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>V</ci>
    <apply>
     <times></times>
     <mtext>p-lim</mtext>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-‚Ä≤</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Œ©</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>X</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V=\text{p-lim}(X^{\prime}\Omega^{-1}X/T)
  </annotation>
 </semantics>
</math>

 here p-lim means limit in probability</p>
<h2 id="applications">Applications</h2>

<p>GLS methods have also been adapted for use in <a href="Phylogenetic_comparative_methods" title="wikilink">Phylogenetic comparative methods</a>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Iteratively_reweighted_least_squares" title="wikilink">Iteratively reweighted least squares</a></li>
<li><a href="Confidence_region" title="wikilink">Confidence region</a></li>
<li><a href="Degrees_of_freedom_(statistics)#Effective_degrees_of_freedom" title="wikilink">Effective degrees of freedom</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Least_squares" title="wikilink">Category:Least squares</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2">, chapter 3<a href="#fnref2">‚Ü©</a></li>
<li id="fn3">Baltagi, B. H. (2008). Econometrics (4th ed.). New York: Springer.<a href="#fnref3">‚Ü©</a></li>
<li id="fn4"></li>
<li id="fn5">Greene, W. H. (2003). Econometric Analysis (5th ed.). Upper Saddle River, NJ: Prentice Hall.<a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
<li id="fn7"></li>
<li id="fn8">Rezende, E. L., and J. A. F. Diniz-Filho. 2012. Phylogenetic analyses: comparing species to infer adaptations and physiological mechanisms. Comprehensive Physiology 2:639‚Äì674.<a href="#fnref8">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

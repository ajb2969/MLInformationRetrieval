   Jacobian matrix and determinant      Jacobian matrix and determinant   In vector calculus , the Jacobian matrix (, ) is the matrix of all first-order partial derivatives of a vector-valued function . Specifically, suppose is a function which takes as input the vector and produces as output the vector . Then the Jacobian matrix   ğ‰   ğ‰   \mathbf{J}   of   ğŸ   ğŸ   \mathbf{f}   is an    m  Ã—  n      m  normal-Ã—  n    mÃ—n   matrix, usually defined and arranged as follows:      ğ‰  =    d  ğŸ    d  ğ±    =   [       âˆ‚  ğŸ    âˆ‚   x  1       â‹¯      âˆ‚  ğŸ    âˆ‚   x  n        ]   =   [       âˆ‚   f  1     âˆ‚   x  1       â‹¯      âˆ‚   f  1     âˆ‚   x  n         â‹®    â‹±    â‹®        âˆ‚   f  m     âˆ‚   x  1       â‹¯      âˆ‚   f  m     âˆ‚   x  n        ]         ğ‰      d  ğŸ     d  ğ±               ğŸ      subscript  x  1     normal-â‹¯      ğŸ      subscript  x  n                   subscript  f  1       subscript  x  1     normal-â‹¯       subscript  f  1       subscript  x  n       normal-â‹®  normal-â‹±  normal-â‹®         subscript  f  m       subscript  x  1     normal-â‹¯       subscript  f  m       subscript  x  n          \mathbf{J}=\frac{d\mathbf{f}}{d\mathbf{x}}=\begin{bmatrix}\dfrac{\partial%
 \mathbf{f}}{\partial x_{1}}&\cdots&\dfrac{\partial\mathbf{f}}{\partial x_{n}}%
 \end{bmatrix}=\begin{bmatrix}\dfrac{\partial f_{1}}{\partial x_{1}}&\cdots&%
 \dfrac{\partial f_{1}}{\partial x_{n}}\\
 \vdots&\ddots&\vdots\\
 \dfrac{\partial f_{m}}{\partial x_{1}}&\cdots&\dfrac{\partial f_{m}}{\partial x%
 _{n}}\end{bmatrix}     or, component-wise:        ğ‰   i  ,  j    =    âˆ‚   f  i     âˆ‚   x  j      .       subscript  ğ‰   i  j         subscript  f  i       subscript  x  j       \mathbf{J}_{i,j}=\frac{\partial f_{i}}{\partial x_{j}}.     This matrix, whose entries are functions of   ğ±   ğ±   \mathbf{x}   , is also denoted by    D  ğŸ      D  ğŸ    D\mathbf{f}   , , and . (Note that some literature defines the Jacobian as the transpose of the matrix given above.)  The Jacobian matrix is important because if the function   ğŸ   ğŸ   \mathbf{f}   is differentiable at a point   ğ±   ğ±   \mathbf{x}   (this is a slightly stronger condition than merely requiring that all partial derivatives exist there), then the Jacobian matrix defines a linear map  , which is the best linear approximation of the function   ğŸ   ğŸ   \mathbf{f}   near the point   ğ±   ğ±   \mathbf{x}   . This linear map is thus the generalization of the usual notion of derivative, and is called the derivative or the differential of   ğŸ   ğŸ   \mathbf{f}   at   ğ±   ğ±   \mathbf{x}   .  If   m   m   m   =   n   n   n   , the Jacobian matrix is a square matrix, and its determinant , a function of , is the Jacobian determinant of   ğŸ   ğŸ   \mathbf{f}   . It carries important information about the local behavior of   ğŸ   ğŸ   \mathbf{f}   . In particular, the function   ğŸ   ğŸ   \mathbf{f}   has locally in the neighborhood of a point   ğ±   ğ±   \mathbf{x}   an inverse function that is differentiable if and only if the Jacobian determinant is nonzero at   ğ±   ğ±   \mathbf{x}   (see Jacobian conjecture ). The Jacobian determinant occurs also when changing the variables in multi-variable integrals (see substitution rule for multiple variables ).  If   m   m   m   = 1,   ğŸ   ğŸ   \mathbf{f}   is a scalar field and the Jacobian matrix is reduced to a row vector of partial derivatives of   ğŸ   ğŸ   \mathbf{f}   â€”i.e. the gradient of   ğŸ   ğŸ   \mathbf{f}   .  These concepts are named after the mathematician  Carl Gustav Jacob Jacobi (1804â€“1851).  Jacobian matrix  The Jacobian generalizes the gradient of a scalar -valued function of multiple variables, which itself generalizes the derivative of a scalar-valued function of a single variable. In other words, the Jacobian for a scalar-valued multivariable function is the gradient and that of a scalar-valued function of single variable is simply its derivative. The Jacobian can also be thought of as describing the amount of "stretching", "rotating" or "transforming" that a transformation imposes locally. For example, if     (   x  â€²   ,   y  â€²   )   =   ğŸ   (  x  ,  y  )           x  normal-â€²     y  normal-â€²      ğŸ   x  y      (xâ€²,yâ€²)=\mathbf{f}(x,y)   is used to transform an image, the Jacobian , describes how the image in the neighborhood of    (  x  ,  y  )     x  y    (x,y)   is transformed.  If a function is differentiable at a point, its derivative is given in coordinates by the Jacobian, but a function doesn't need to be differentiable for the Jacobian to be defined, since only the partial derivatives are required to exist.  If   ğ©   ğ©   \mathbf{p}   is a point in and   ğŸ   ğŸ   \mathbf{f}   is differentiable at   ğ©   ğ©   \mathbf{p}   , then its derivative is given by . In this case, the linear map described by is the best linear approximation of   ğŸ   ğŸ   \mathbf{f}   near the point   ğ©   ğ©   \mathbf{p}   , in the sense that       ğŸ   (  ğ±  )    =    ğŸ   (  ğ©  )    +    ğ‰  ğŸ    (  ğ©  )    (   ğ±  -  ğ©   )    +   o   (   âˆ¥   ğ±  -  ğ©   âˆ¥   )           ğŸ  ğ±       ğŸ  ğ©      subscript  ğ‰  ğŸ   ğ©    ğ±  ğ©      o   norm    ğ±  ğ©        \mathbf{f}(\mathbf{x})=\mathbf{f}(\mathbf{p})+\mathbf{J}_{\mathbf{f}}(\mathbf{%
 p})(\mathbf{x}-\mathbf{p})+o(\|\mathbf{x}-\mathbf{p}\|)     for   ğ±   ğ±   \mathbf{x}   close to   ğ©   ğ©   \mathbf{p}   and where   o   o   o   is the little o-notation (for    ğ±  â†’  ğ©      ğ±  normal-â†’  ğ©    \mathbf{x}â†’\mathbf{p}   ) and    â€–  ğ±  âˆ’  ğ©  â€–      normal-â€–  ğ±  normal-âˆ’  ğ©  normal-â€–    â€–\mathbf{x}âˆ’\mathbf{p}â€–   is the distance between   ğ±   ğ±   \mathbf{x}   and   ğ©   ğ©   \mathbf{p}   .  Compare this to a Taylor series for a scalar function of a scalar argument, truncated to first order:        f   (  x  )    =    f   (  p  )    +    f  â€²    (  p  )    (   x  -  p   )    +   o   (   x  -  p   )      .        f  x       f  p      superscript  f  normal-â€²   p    x  p      o    x  p       f(x)=f(p)+f^{\prime}(p)(x-p)+o(x-p).     In a sense, both the gradient and Jacobian are " first derivatives "â€”the former the first derivative of a scalar function of several variables, the latter the first derivative of a vector function of several variables.  The Jacobian of the gradient of a scalar function of several variables has a special name: the Hessian matrix , which in a sense is the " second derivative " of the function in question.  Jacobian determinant  (Figure)  A nonlinear map f : R 2 â†’ R 2 sends a small square to a distorted parallelepiped close to the image of the square under the best linear approximation of f near the point.   If   m   m   m   =   n   n   n   , then   ğŸ   ğŸ   \mathbf{f}   is a function from to itself and the Jacobian matrix is a square matrix . We can then form its determinant , known as the Jacobian determinant . The Jacobian determinant is occasionally referred to as "the Jacobian".  The Jacobian determinant at a given point gives important information about the behavior of   ğŸ   ğŸ   \mathbf{f}   near that point. For instance, the continuously differentiable function    ğŸ   ğŸ   \mathbf{f}   is invertible near a point if the Jacobian determinant at   ğ©   ğ©   \mathbf{p}   is non-zero. This is the inverse function theorem . Furthermore, if the Jacobian determinant at   ğ©   ğ©   \mathbf{p}   is positive , then   ğŸ   ğŸ   \mathbf{f}   preserves orientation near   ğ©   ğ©   \mathbf{p}   ; if it is negative ,   ğŸ   ğŸ   \mathbf{f}   reverses orientation. The absolute value of the Jacobian determinant at   ğ©   ğ©   \mathbf{p}   gives us the factor by which the function   ğŸ   ğŸ   \mathbf{f}   expands or shrinks volumes near   ğ©   ğ©   \mathbf{p}   ; this is why it occurs in the general substitution rule .  The Jacobian determinant is used when making a change of variables when evaluating a multiple integral of a function over a region within its domain. To accommodate for the change of coordinates the magnitude of the Jacobian determinant arises as a multiplicative factor within the integral. This is because the   n   n   n   -dimensional    d  V      d  V    dV   element is in general a parallelepiped in the new coordinate system, and the   n   n   n   -volume of a parallelepiped is the determinant of its edge vectors.  The Jacobian can also be used to solve systems of differential equations at an equilibrium point or approximate solutions near an equilibrium point.  Inverse  According to the inverse function theorem , the matrix inverse of the Jacobian matrix of an invertible function is the Jacobian matrix of the inverse function. That is, if the Jacobian of the function is continuous and nonsingular at the point   ğ©   ğ©   \mathbf{p}   in , then   ğŸ   ğŸ   \mathbf{f}   is invertible when restricted to some neighborhood of   ğ©   ğ©   \mathbf{p}   and         ğ‰   ğŸ   -  1     âˆ˜  ğŸ   =   ğ‰  ğŸ     -  1     .         subscript  ğ‰   superscript  ğŸ    1     ğŸ    superscript   subscript  ğ‰  ğŸ     1      \mathbf{J}_{\mathbf{f}^{-1}}\circ\mathbf{f}={\mathbf{J}_{\mathbf{f}}}^{-1}.     Conversely, if the Jacobian determinant is not zero at a point, then the function is locally invertible near this point, that is there is neighbourhood of this point, in which the function is invertible.  The (unproved) Jacobian conjecture is related to global invertibility in the case of a polynomial functions, that is a function defined by n  polynomials in n variables. It asserts that, if the Jacobian determinant is a non-zero constant (or, equivalently, that it does not have any complex zero), then the function is invertible and its inverse is a polynomial function.  Critical points  If is a differentiable function , a critical point of   ğŸ   ğŸ   \mathbf{f}   is a point where the rank of the Jacobian matrix is not maximal. This means that the rank at the critical point is lower than the rank at some neighbour point. In other words, let   k   k   k   be the maximal dimension of the open balls contained in the image of   ğŸ   ğŸ   \mathbf{f}   ; then a point is critical if all minors of rank   k   k   k   of   ğŸ   ğŸ   \mathbf{f}   are zero.  In the case where 1 =   m   m   m   =   n   n   n   =   k   k   k   , a point is critical if the Jacobian determinant is zero.  Examples  Example 1  Consider the function given by        ğŸ   (  x  ,  y  )    =   [       x  2   y         5  x   +   sin  y       ]    .        ğŸ   x  y         superscript  x  2   y         5  x     y        \mathbf{f}(x,y)=\begin{bmatrix}x^{2}y\\
 5x+\sin y\end{bmatrix}.   Then we have        f  1    (  x  ,  y  )    =    x  2   y          subscript  f  1    x  y       superscript  x  2   y     f_{1}(x,y)=x^{2}y   and        f  2    (  x  ,  y  )    =    5  x   +   sin  y           subscript  f  2    x  y        5  x     y      f_{2}(x,y)=5x+\sin y   and the Jacobian matrix of   ğ…   ğ…   \mathbf{F}   is        ğ‰  ğŸ    (  x  ,  y  )    =   [       âˆ‚   f  1     âˆ‚  x        âˆ‚   f  1     âˆ‚  y          âˆ‚   f  2     âˆ‚  x        âˆ‚   f  2     âˆ‚  y       ]   =   [      2  x  y      x  2       5     cos  y      ]            subscript  ğ‰  ğŸ    x  y           subscript  f  1      x         subscript  f  1      y           subscript  f  2      x         subscript  f  2      y               2  x  y    superscript  x  2     5    y        \mathbf{J}_{\mathbf{f}}(x,y)=\begin{bmatrix}\dfrac{\partial f_{1}}{\partial x}%
 &\dfrac{\partial f_{1}}{\partial y}\\
 \dfrac{\partial f_{2}}{\partial x}&\dfrac{\partial f_{2}}{\partial y}\end{%
 bmatrix}=\begin{bmatrix}2xy&x^{2}\\
 5&\cos y\end{bmatrix}   and the Jacobian determinant is        det   (    ğ‰  ğŸ    (  x  ,  y  )    )    =    2  x  y   cos  y    -   5   x  2      .           subscript  ğ‰  ğŸ    x  y         2  x  y    y      5   superscript  x  2       \det(\mathbf{J}_{\mathbf{f}}(x,y))=2xy\cos y-5x^{2}.     Example 2: polar-Cartesian transformation  The transformation from polar coordinates     (  r  ,  Ï†  )     r  Ï†    (r,Ï†)   to Cartesian coordinates ( x , y ), is given by the function with components:     x   x   \displaystyle x          ğ‰   (  r  ,  Ï†  )    =   [       âˆ‚  x    âˆ‚  r        âˆ‚  x    âˆ‚  Ï†          âˆ‚  y    âˆ‚  r        âˆ‚  y    âˆ‚  Ï†       ]   =   [      cos  Ï†      -   r   sin  Ï†          sin  Ï†      r   cos  Ï†       ]           ğ‰   r  Ï†          x     r        x     Ï†          y     r        y     Ï†               Ï†       r    Ï†         Ï†     r    Ï†         \mathbf{J}(r,\varphi)=\begin{bmatrix}\dfrac{\partial x}{\partial r}&\dfrac{%
 \partial x}{\partial\varphi}\\
 \dfrac{\partial y}{\partial r}&\dfrac{\partial y}{\partial\varphi}\end{bmatrix%
 }=\begin{bmatrix}\cos\varphi&-r\sin\varphi\\
 \sin\varphi&r\cos\varphi\end{bmatrix}     The Jacobian determinant is equal to   r   r   r   . This can be used to transform integrals between the two coordinate systems:         âˆ¬  A    f   (  x  ,  y  )   d   x   d  y    =    âˆ¬  A    f   (   r   cos  Ï•    ,   r   sin  Ï•    )    r   d   r   d  Ï•     .        subscript  double-integral  A     f   x  y   d  x  d  y      subscript  double-integral  A     f     r    Ï•      r    Ï•     r  d  r  d  Ï•      \iint_{A}f(x,y)\,dx\,dy=\iint_{A}f(r\cos\phi,r\sin\phi)\,r\,dr\,d\phi.     Example 3: spherical-Cartesian transformation  The transformation from spherical coordinates     (  r  ,  Î¸  ,  Ï†  )     r  Î¸  Ï†    (r,Î¸,Ï†)   to Cartesian coordinates ( x , y , z ), is given by the function with components:     x   x   \displaystyle x     The Jacobian matrix for this coordinate change is         ğ‰  ğ…    (  r  ,  Î¸  ,  Ï†  )    =   [       âˆ‚  x    âˆ‚  r        âˆ‚  x    âˆ‚  Î¸        âˆ‚  x    âˆ‚  Ï†          âˆ‚  y    âˆ‚  r        âˆ‚  y    âˆ‚  Î¸        âˆ‚  y    âˆ‚  Ï†          âˆ‚  z    âˆ‚  r        âˆ‚  z    âˆ‚  Î¸        âˆ‚  z    âˆ‚  Ï†       ]   =   [       sin  Î¸    cos  Ï†       r   cos  Î¸    cos  Ï†       -   r   sin  Î¸    sin  Ï†           sin  Î¸    sin  Ï†       r   cos  Î¸    sin  Ï†       r   sin  Î¸    cos  Ï†         cos  Î¸      -   r   sin  Î¸       0     ]    .           subscript  ğ‰  ğ…    r  Î¸  Ï†          x     r        x     Î¸        x     Ï†          y     r        y     Î¸        y     Ï†          z     r        z     Î¸        z     Ï†                 Î¸     Ï†      r    Î¸     Ï†        r    Î¸     Ï†           Î¸     Ï†      r    Î¸     Ï†      r    Î¸     Ï†        Î¸       r    Î¸     0       \mathbf{J}_{\mathbf{F}}(r,\theta,\varphi)=\begin{bmatrix}\dfrac{\partial x}{%
 \partial r}&\dfrac{\partial x}{\partial\theta}&\dfrac{\partial x}{\partial%
 \varphi}\\
 \dfrac{\partial y}{\partial r}&\dfrac{\partial y}{\partial\theta}&\dfrac{%
 \partial y}{\partial\varphi}\\
 \dfrac{\partial z}{\partial r}&\dfrac{\partial z}{\partial\theta}&\dfrac{%
 \partial z}{\partial\varphi}\end{bmatrix}=\begin{bmatrix}\sin\theta\cos\varphi%
 &r\cos\theta\cos\varphi&-r\sin\theta\sin\varphi\\
 \sin\theta\sin\varphi&r\cos\theta\sin\varphi&r\sin\theta\cos\varphi\\
 \cos\theta&-r\sin\theta&0\end{bmatrix}.     The determinant is . As an example, since  dx 1  dx 2  dx 3 }} this determinant implies that the differential volume element   r 2 sin Î¸  dr  dÎ¸  dÏ† }} . Nevertheless this determinant varies with coordinates.  Example 4  The Jacobian matrix of the function with components      y  1     subscript  y  1    \displaystyle y_{1}     is         ğ‰  ğ…    (   x  1   ,   x  2   ,   x  3   )    =   [       âˆ‚   y  1     âˆ‚   x  1         âˆ‚   y  1     âˆ‚   x  2         âˆ‚   y  1     âˆ‚   x  3           âˆ‚   y  2     âˆ‚   x  1         âˆ‚   y  2     âˆ‚   x  2         âˆ‚   y  2     âˆ‚   x  3           âˆ‚   y  3     âˆ‚   x  1         âˆ‚   y  3     âˆ‚   x  2         âˆ‚   y  3     âˆ‚   x  3           âˆ‚   y  4     âˆ‚   x  1         âˆ‚   y  4     âˆ‚   x  2         âˆ‚   y  4     âˆ‚   x  3        ]   =   [     1    0    0      0    0    5      0     8   x  2       -  2         x  3    cos   x  1       0     sin   x  1       ]    .           subscript  ğ‰  ğ…     subscript  x  1    subscript  x  2    subscript  x  3            subscript  y  1       subscript  x  1          subscript  y  1       subscript  x  2          subscript  y  1       subscript  x  3            subscript  y  2       subscript  x  1          subscript  y  2       subscript  x  2          subscript  y  2       subscript  x  3            subscript  y  3       subscript  x  1          subscript  y  3       subscript  x  2          subscript  y  3       subscript  x  3            subscript  y  4       subscript  x  1          subscript  y  4       subscript  x  2          subscript  y  4       subscript  x  3              1  0  0    0  0  5    0    8   subscript  x  2      2        subscript  x  3      subscript  x  1     0     subscript  x  1         \mathbf{J}_{\mathbf{F}}(x_{1},x_{2},x_{3})=\begin{bmatrix}\dfrac{\partial y_{1%
 }}{\partial x_{1}}&\dfrac{\partial y_{1}}{\partial x_{2}}&\dfrac{\partial y_{1%
 }}{\partial x_{3}}\\
 \dfrac{\partial y_{2}}{\partial x_{1}}&\dfrac{\partial y_{2}}{\partial x_{2}}&%
 \dfrac{\partial y_{2}}{\partial x_{3}}\\
 \dfrac{\partial y_{3}}{\partial x_{1}}&\dfrac{\partial y_{3}}{\partial x_{2}}&%
 \dfrac{\partial y_{3}}{\partial x_{3}}\\
 \dfrac{\partial y_{4}}{\partial x_{1}}&\dfrac{\partial y_{4}}{\partial x_{2}}&%
 \dfrac{\partial y_{4}}{\partial x_{3}}\end{bmatrix}=\begin{bmatrix}1&0&0\\
 0&0&5\\
 0&8x_{2}&-2\\
 x_{3}\cos x_{1}&0&\sin x_{1}\end{bmatrix}.     This example shows that the Jacobian need not be a square matrix.  Example 5  The Jacobian determinant of the function with components      y  1     subscript  y  1    \displaystyle y_{1}     is        |     0    5    0       8   x  1       -   2   x  3    cos   (    x  2    x  3    )         -   2   x  2    cos   (    x  2    x  3    )          0     x  3      x  2      |   =   -   8   x  1    |     5    0       x  3      x  2      |     =   -   40   x  1    x  2      .            0  5  0      8   subscript  x  1        2   subscript  x  3        subscript  x  2    subscript  x  3           2   subscript  x  2        subscript  x  2    subscript  x  3         0   subscript  x  3    subscript  x  2          8   subscript  x  1       5  0     subscript  x  3    subscript  x  2                 40   subscript  x  1    subscript  x  2        \begin{vmatrix}0&5&0\\
 8x_{1}&-2x_{3}\cos(x_{2}x_{3})&-2x_{2}\cos(x_{2}x_{3})\\
 0&x_{3}&x_{2}\end{vmatrix}=-8x_{1}\begin{vmatrix}5&0\\
 x_{3}&x_{2}\end{vmatrix}=-40x_{1}x_{2}.     From this we see that   ğ…   ğ…   \mathbf{F}   reverses orientation near those points where and have the same sign; the function is locally invertible everywhere except near points where 0}} or 0}} . Intuitively, if one starts with a tiny object around the point    (  1  ,  2  ,  3  )     1  2  3    (1,2,3)   and apply   ğ…   ğ…   \mathbf{F}   to that object, one will get a resulting object with approximately     40  Ã—  1  Ã—  2   =  80        40  normal-Ã—  1  normal-Ã—  2   80    40Ã—1Ã—2=80   times the volume of the original one.  Other uses  The Jacobian serves as a linearized design matrix in statistical regression and curve fitting ; see non-linear least squares .  Dynamical systems  Consider a dynamical system of the form     ğ±  â€²   =   ğ…   (  ğ±  )          ğ±  normal-â€²     ğ…  ğ±     \mathbf{x}â€²=\mathbf{F}(\mathbf{x})   , where    ğ±  â€²      ğ±  normal-â€²    \mathbf{x}â€²   is the (component-wise) time derivative of   ğ±   ğ±   \mathbf{x}   , and is differentiable. If 0}} , then is a stationary point (also called a critical point; this is not to be confused with fixed points). The behavior of the system near a stationary point is related to the eigenvalues of , the Jacobian of   ğ…   ğ…   \mathbf{F}   at the stationary point. 1 Specifically, if the eigenvalues all have real parts that are negative, then the system is stable near the stationary point, if any eigenvalue has a real part that is positive, then the point is unstable. If the largest real part of the eigenvalues is zero, the Jacobian matrix does not allow for an evaluation of the stability.  Newton's method  A system of coupled nonlinear equations can be solved iteratively by Newton's method . This method uses the Jacobian matrix of the system of equations.  See also   Hessian matrix  Pushforward (differential)   References  Further reading     External links    Mathworld A more technical explanation of Jacobians   "  Category:Multivariable calculus  Category:Differential calculus  Category:Generalizations of the derivative  Category:Determinants  Category:Matrices     â†©     
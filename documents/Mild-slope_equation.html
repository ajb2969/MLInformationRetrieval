<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1534">Mild-slope equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Mild-slope equation</h1>
<hr/>

<p> In <a href="fluid_dynamics" title="wikilink">fluid dynamics</a>, the <strong>mild-slope equation</strong> describes the combined effects of <a class="uri" href="diffraction" title="wikilink">diffraction</a> and <a class="uri" href="refraction" title="wikilink">refraction</a> for <a href="water_wave" title="wikilink">water waves</a> propagating over <a class="uri" href="bathymetry" title="wikilink">bathymetry</a> and due to lateral boundaries—like <a href="Breakwater_(structure)" title="wikilink">breakwaters</a> and <a href="coastline" title="wikilink">coastlines</a>. It is an approximate model, deriving its name from being originally developed for wave propagation over mild slopes of the sea floor. The mild-slope equation is often used in <a href="coastal_engineering" title="wikilink">coastal engineering</a> to compute the wave-field changes near <a href="harbour" title="wikilink">harbours</a> and <a href="coast" title="wikilink">coasts</a>.</p>

<p>The mild-slope equation models the propagation and transformation of water waves, as they travel through waters of varying depth and interact with lateral boundaries such as <a href="cliff" title="wikilink">cliffs</a>, <a href="beach" title="wikilink">beaches</a>, <a href="seawall" title="wikilink">seawalls</a> and breakwaters. As a result, it describes the variations in wave <a class="uri" href="amplitude" title="wikilink">amplitude</a>, or equivalently <a href="wave_height" title="wikilink">wave height</a>. From the wave amplitude, the amplitude of the <a href="flow_velocity" title="wikilink">flow velocity</a> oscillations underneath the water surface can also be computed. These quantities—wave amplitude and flow-velocity amplitude—may subsequently be used to determine the wave effects on coastal and offshore structures, ships and other floating objects, <a href="sediment_transport" title="wikilink">sediment transport</a> and resulting <a class="uri" href="geomorphology" title="wikilink">geomorphology</a> changes of the sea bed and coastline, mean flow fields and <a href="mass_transfer" title="wikilink">mass transfer</a> of dissolved and floating materials. Most often, the mild-slope equation is solved by computer using methods from <a href="numerical_analysis" title="wikilink">numerical analysis</a>.</p>

<p>A first form of the mild-slope equation was developed by <a href="Carl_Eckart" title="wikilink">Eckart</a> in 1952, and an improved version—the mild-slope equation in its classical formulation—has been derived independently by Juri Berkhoff in 1972.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Thereafter, many modified and extended forms have been proposed, to include the effects of, for instance: <a href="wave–current_interaction" title="wikilink">wave–current interaction</a>, wave <a class="uri" href="nonlinearity" title="wikilink">nonlinearity</a>, steeper sea-bed slopes, <a href="drag_(physics)" title="wikilink">bed friction</a> and <a href="wave_breaking" title="wikilink">wave breaking</a>. Also <a href="Parabolic_partial_differential_equation" title="wikilink">parabolic</a> approximations to the mild-slope equation are often used, in order to reduce the computational cost.</p>

<p>In case of a constant depth, the mild-slope equation reduces to the <a href="Helmholtz_equation" title="wikilink">Helmholtz equation</a> for wave diffraction.</p>
<h2 id="formulation-for-monochromatic-wave-motion">Formulation for monochromatic wave motion</h2>

<p>For <a class="uri" href="monochromatic" title="wikilink">monochromatic</a> waves according to <a href="linear_theory" title="wikilink">linear theory</a>—with the <a href="free_surface" title="wikilink">free surface</a> elevation given as 

<math display="inline" id="Mild-slope_equation:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">ℜ</mi>
    <mrow>
     <mo>{</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <msup>
       <mtext>e</mtext>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>i</mi>
         <mi>ω</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo>}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ζ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <real></real>
     <apply>
      <times></times>
      <ci>η</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <mtext>e</mtext>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>ω</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(x,y,t)=\Re\left\{\eta(x,y)\,\text{e}^{-i\omega t}\right\}
  </annotation>
 </semantics>
</math>

 and the waves propagating on a fluid layer of <a href="average" title="wikilink">mean</a> water depth 

<math display="inline" id="Mild-slope_equation:1">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(x,y)
  </annotation>
 </semantics>
</math>

—the mild-slope equation is:<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>c</mi>
          <mi>p</mi>
         </msub>
        </mpadded>
        <mpadded width="+1.7pt">
         <msub>
          <mi>c</mi>
          <mi>g</mi>
         </msub>
        </mpadded>
        <mrow>
         <mo>∇</mo>
         <mi>η</mi>
        </mrow>
       </mrow>
       <mo rspace="4.2pt">)</mo>
      </mrow>
     </mrow>
     <mo rspace="4.2pt">+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>c</mi>
        <mi>p</mi>
       </msub>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>c</mi>
        <mi>g</mi>
       </msub>
      </mpadded>
      <mpadded width="+1.7pt">
       <mi>η</mi>
      </mpadded>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>g</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>η</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <ci>η</ci>
     </apply>
    </apply>
    <cn type="float">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot\left(c_{p}\,c_{g}\,\nabla\eta\right)\,+\,k^{2}\,c_{p}\,c_{g}\,\eta%
\,=\,0,
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li>

<math display="inline" id="Mild-slope_equation:3">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>η</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta(x,y)
  </annotation>
 </semantics>
</math>


 is the <a href="complex-valued_amplitude" title="wikilink">complex-valued amplitude</a> of the free-surface elevation 

<math display="inline" id="Mild-slope_equation:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ζ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(x,y,t);
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Mild-slope_equation:5">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 is the horizontal position;</li>
<li>

<math display="inline" id="Mild-slope_equation:6">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 is the <a href="angular_frequency" title="wikilink">angular frequency</a> of the monochromatic wave motion;</li>
<li>

<math display="inline" id="Mild-slope_equation:7">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is the <a href="imaginary_unit" title="wikilink">imaginary unit</a>;</li>
<li>

<math display="inline" id="Mild-slope_equation:8">
 <semantics>
  <mrow>
   <mi mathvariant="normal">ℜ</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mo>⋅</mo>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <real></real>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Re\{\cdot\}
  </annotation>
 </semantics>
</math>


 means taking the <a href="real_part" title="wikilink">real part</a> of the quantity between braces;</li>
<li>

<math display="inline" id="Mild-slope_equation:9">
 <semantics>
  <mo>∇</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-∇</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla
  </annotation>
 </semantics>
</math>

 is the horizontal <a class="uri" href="gradient" title="wikilink">gradient</a> operator;</li>
<li>

<math display="inline" id="Mild-slope_equation:10">
 <semantics>
  <mrow>
   <mo>∇</mo>
   <mo>⋅</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-∇</ci>
    <ci>normal-⋅</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="divergence" title="wikilink">divergence</a> operator;</li>
<li>

<math display="inline" id="Mild-slope_equation:11">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="wavenumber" title="wikilink">wavenumber</a>;</li>
<li>

<math display="inline" id="Mild-slope_equation:12">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{p}
  </annotation>
 </semantics>
</math>

 is the <a href="phase_speed" title="wikilink">phase speed</a> of the waves and</li>
<li>

<math display="inline" id="Mild-slope_equation:13">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>g</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{g}
  </annotation>
 </semantics>
</math>


 is the <a href="group_speed" title="wikilink">group speed</a> of the waves.</li>
</ul>

<p>The phase and group speed depend on the <a href="dispersion_(water_waves)" title="wikilink">dispersion relation</a>, and are derived from <a href="Airy_wave_theory" title="wikilink">Airy wave theory</a> as:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="inline" id="Mild-slope_equation:14">
 <semantics>
  <msup>
   <mi>ω</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ω</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\omega^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Mild-slope_equation:15">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is <a href="Earth's_gravity" title="wikilink">Earth's gravity</a> and</li>
<li>

<math display="inline" id="Mild-slope_equation:16">
 <semantics>
  <mi>tanh</mi>
  <annotation-xml encoding="MathML-Content">
   <tanh></tanh>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tanh
  </annotation>
 </semantics>
</math>

 is the <a href="hyperbolic_tangent" title="wikilink">hyperbolic tangent</a>.</li>
</ul>

<p>For a given angular frequency 

<math display="inline" id="Mild-slope_equation:17">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

, the wavenumber 

<math display="inline" id="Mild-slope_equation:18">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 has to be solved from the dispersion equation, which relates these two quantities to the water depth 

<math display="inline" id="Mild-slope_equation:19">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="transformation-to-an-inhomogeneous-helmholtz-equation">Transformation to an inhomogeneous Helmholtz equation</h2>

<p>Through the transformation</p>

<p>

<math display="block" id="Mild-slope_equation:20">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>ψ</mi>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>η</mi>
     </mpadded>
     <msqrt>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>p</mi>
        </msub>
       </mpadded>
       <msub>
        <mi>c</mi>
        <mi>g</mi>
       </msub>
      </mrow>
     </msqrt>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ψ</ci>
    <apply>
     <times></times>
     <ci>η</ci>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>g</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi\,=\,\eta\,\sqrt{c_{p}\,c_{g}},
  </annotation>
 </semantics>
</math>

</p>

<p>the mild slope equation can be cast in the form of an <a href="inhomogeneous_Helmholtz_equation" title="wikilink">inhomogeneous Helmholtz equation</a>:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mpadded width="+1.7pt">
        <mi>ψ</mi>
       </mpadded>
      </mrow>
      <mo rspace="4.2pt">+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <msubsup>
         <mi>k</mi>
         <mi>c</mi>
         <mn>2</mn>
        </msubsup>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>ψ</mi>
       </mpadded>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mn>0</mn>
      <mtext>with</mtext>
     </mrow>
    </mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>k</mi>
       <mi>c</mi>
       <mn>2</mn>
      </msubsup>
     </mpadded>
     <mo rspace="4.2pt">=</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
      </mpadded>
      <mo rspace="4.2pt">-</mo>
      <mfrac>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mrow>
         <mo>(</mo>
         <msqrt>
          <mrow>
           <mpadded width="+1.7pt">
            <msub>
             <mi>c</mi>
             <mi>p</mi>
            </msub>
           </mpadded>
           <msub>
            <mi>c</mi>
            <mi>g</mi>
           </msub>
          </mrow>
         </msqrt>
         <mo>)</mo>
        </mrow>
       </mrow>
       <msqrt>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>p</mi>
          </msub>
         </mpadded>
         <msub>
          <mi>c</mi>
          <mi>g</mi>
         </msub>
        </mrow>
       </msqrt>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>ψ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>c</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>ψ</ci>
      </apply>
     </apply>
     <list>
      <cn type="float">0</cn>
      <mtext>with</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>c</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <root></root>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <ci>p</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <ci>g</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <root></root>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>g</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta\psi\,+\,k_{c}^{2}\,\psi\,=\,0\qquad\text{with}\qquad k_{c}^{2}\,=\,k^{2%
}\,-\,\frac{\Delta\left(\sqrt{c_{p}\,c_{g}}\right)}{\sqrt{c_{p}\,c_{g}}},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Mild-slope_equation:22">
 <semantics>
  <mi mathvariant="normal">Δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta
  </annotation>
 </semantics>
</math>


 is the <a href="Laplace_operator" title="wikilink">Laplace operator</a>.</p>
<h2 id="propagating-waves">Propagating waves</h2>

<p>In spatially <a href="Coherence_(physics)" title="wikilink">coherent</a> fields of propagating waves, it is useful to split the <a href="complex_amplitude" title="wikilink">complex amplitude</a> 

<math display="inline" id="Mild-slope_equation:23">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>η</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta(x,y)
  </annotation>
 </semantics>
</math>

 in its amplitude and phase, both <a href="real_number" title="wikilink">real valued</a>:<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>η</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mi>a</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <msup>
      <mtext>e</mtext>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>i</mi>
       </mpadded>
       <mi>θ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>η</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <mtext>e</mtext>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>θ</ci>
       <interval closure="open">
        <ci>x</ci>
        <ci>y</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta(x,y)\,=\,a(x,y)\,\text{e}^{i\,\theta(x,y)},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Mild-slope_equation:25">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>η</mi>
    <mo rspace="4.2pt" stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <abs></abs>
     <ci>η</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=|\eta|\,
  </annotation>
 </semantics>
</math>

 is the amplitude or <a href="absolute_value" title="wikilink">absolute value</a> of 

<math display="inline" id="Mild-slope_equation:26">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>η</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\,
  </annotation>
 </semantics>
</math>

 and</li>
<li>

<math display="inline" id="Mild-slope_equation:27">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>=</mo>
   <mrow>
    <mi>arg</mi>
    <mrow>
     <mo stretchy="false">{</mo>
     <mi>η</mi>
     <mo rspace="4.2pt" stretchy="false">}</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>θ</ci>
    <apply>
     <arg></arg>
     <ci>η</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta=\arg\{\eta\}\,
  </annotation>
 </semantics>
</math>


 is the wave phase, which is the <a href="Arg_(mathematics)" title="wikilink">argument</a> of 

<math display="inline" id="Mild-slope_equation:28">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta.\,
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>This transforms the mild-slope equation in the following set of equations (apart from locations for which 

<math display="inline" id="Mild-slope_equation:29">
 <semantics>
  <mrow>
   <mo>∇</mo>
   <mi>θ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-∇</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\theta
  </annotation>
 </semantics>
</math>

 is singular):<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>

<math display="inline" id="Mild-slope_equation:30">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>κ</mi>
         <mi>y</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>x</mi>
       </mrow>
      </mfrac>
     </mstyle>
    </mpadded>
    <mo rspace="4.2pt">-</mo>
    <mpadded width="+1.7pt">
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>κ</mi>
         <mi>x</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>y</mi>
       </mrow>
      </mfrac>
     </mstyle>
    </mpadded>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>κ</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>κ</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
    <cn type="float">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{\partial\kappa_{y}}{\partial{x}}\,-\,\frac{\partial\kappa_{%
x}}{\partial{y}}\,=\,0
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Mild-slope_equation:31">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 is the <a class="uri" href="average" title="wikilink">average</a> wave-energy density per unit horizontal area (the sum of the <a href="kinetic_energy" title="wikilink">kinetic</a> and <a href="potential_energy" title="wikilink">potential energy</a> densities),</li>
<li>

<math display="inline" id="Mild-slope_equation:32">
 <semantics>
  <mi>𝜿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}
  </annotation>
 </semantics>
</math>

 is the effective wavenumber vector, with components 

<math display="inline" id="Mild-slope_equation:33">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>κ</mi>
     <mi>x</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>κ</mi>
     <mi>y</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>κ</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>κ</ci>
     <ci>y</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\kappa_{x},\kappa_{y}),\,
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Mild-slope_equation:34">
 <semantics>
  <msub>
   <mi>𝒗</mi>
   <mi>g</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝒗</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{v}_{g}
  </annotation>
 </semantics>
</math>

 is the effective <a href="group_velocity" title="wikilink">group velocity</a> vector,</li>
<li>

<math display="inline" id="Mild-slope_equation:35">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

 is the fluid <a class="uri" href="density" title="wikilink">density</a>, and</li>
<li>

<math display="inline" id="Mild-slope_equation:36">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is the acceleration by the <a href="Earth's_gravity" title="wikilink">Earth's gravity</a>.</li>
</ul>

<p>The last equation shows that wave energy is conserved in the mild-slope equation, and that the wave energy 

<math display="inline" id="Mild-slope_equation:37">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 is transported in the 

<math display="inline" id="Mild-slope_equation:38">
 <semantics>
  <mi>𝜿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}
  </annotation>
 </semantics>
</math>

-direction normal to the wave <a href="crest_(physics)" title="wikilink">crests</a> (in this case of pure wave motion without mean currents).<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> The effective group speed 

<math display="inline" id="Mild-slope_equation:39">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <msub>
    <mi>𝒗</mi>
    <mi>g</mi>
   </msub>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝒗</ci>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\boldsymbol{v}_{g}|
  </annotation>
 </semantics>
</math>

 is different from the group speed 

<math display="inline" id="Mild-slope_equation:40">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>g</mi>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{g}.
  </annotation>
 </semantics>
</math>

</p>

<p>The first equation states that the effective wavenumber 

<math display="inline" id="Mild-slope_equation:41">
 <semantics>
  <mi>𝜿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}
  </annotation>
 </semantics>
</math>

 is <a class="uri" href="irrotational" title="wikilink">irrotational</a>, a direct consequence of the fact it is the derivative of the wave phase 

<math display="inline" id="Mild-slope_equation:42">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

, a <a href="scalar_field" title="wikilink">scalar field</a>. The second equation is the <a href="eikonal_equation" title="wikilink">eikonal equation</a>. It shows the effects of diffraction on the effective wavenumber: only for more-or-less progressive waves, with 

<math display="inline" id="Mild-slope_equation:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∇</mo>
     <mo>⋅</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>p</mi>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>g</mi>
        </msub>
       </mpadded>
       <mrow>
        <mo>∇</mo>
        <mi>a</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≪</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>k</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>p</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>g</mi>
      </msub>
     </mpadded>
     <mi>a</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <apply>
     <ci>normal-⋅</ci>
     <ci>normal-∇</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>g</ci>
     </apply>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot(c_{p}\,c_{g}\,\nabla a)\ll k^{2}\,c_{p}\,c_{g}\,a,
  </annotation>
 </semantics>
</math>

 the splitting into amplitude 

<math display="inline" id="Mild-slope_equation:44">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and phase 

<math display="inline" id="Mild-slope_equation:45">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 leads to consistent-varying and meaningful fields of 

<math display="inline" id="Mild-slope_equation:46">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:47">
 <semantics>
  <mi>𝜿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}
  </annotation>
 </semantics>
</math>

. Otherwise, <em>κ</em><sup>2</sup> can even become negative. When the diffraction effects are totally neglected, the effective wavenumber <em>κ</em> is equal to 

<math display="inline" id="Mild-slope_equation:48">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, and the <a href="geometric_optics" title="wikilink">geometric optics</a> approximation for wave <a class="uri" href="refraction" title="wikilink">refraction</a> can be used.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>When 

<math display="inline" id="Mild-slope_equation:49">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mrow></mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>i</mi>
       <mi>θ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>η</ci>
    <apply>
     <times></times>
     <ci>a</ci>
     <mtext></mtext>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta=a\mbox{ }\exp(i\theta)
  </annotation>
 </semantics>
</math>

 is used in the mild-slope equation, the result is, apart from a factor 

<math display="inline" id="Mild-slope_equation:50">
 <semantics>
  <mrow>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>i</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <exp></exp>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp(i\theta)
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Mild-slope_equation:51">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>p</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>g</mi>
      </msub>
     </mpadded>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <mpadded width="+1.7pt">
           <mi>a</mi>
          </mpadded>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mpadded width="+1.7pt">
            <mi>i</mi>
           </mpadded>
           <mrow>
            <mo>∇</mo>
            <mi>a</mi>
           </mrow>
          </mrow>
          <mo>⋅</mo>
          <mrow>
           <mo>∇</mo>
           <mpadded width="+1.7pt">
            <mi>θ</mi>
           </mpadded>
          </mrow>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">-</mo>
        <mrow>
         <mrow>
          <mpadded width="+1.7pt">
           <mi>a</mi>
          </mpadded>
          <mrow>
           <mo>∇</mo>
           <mi>θ</mi>
          </mrow>
         </mrow>
         <mo>⋅</mo>
         <mrow>
          <mo>∇</mo>
          <mpadded width="+1.7pt">
           <mi>θ</mi>
          </mpadded>
         </mrow>
        </mrow>
       </mrow>
       <mo rspace="4.2pt">+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>i</mi>
        </mpadded>
        <mpadded width="+1.7pt">
         <mi>a</mi>
        </mpadded>
        <mi mathvariant="normal">Δ</mi>
        <mi>θ</mi>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">+</mo>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>c</mi>
          <mi>p</mi>
         </msub>
        </mpadded>
        <msub>
         <mi>c</mi>
         <mi>g</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>∇</mo>
        <mpadded width="+1.7pt">
         <mi>a</mi>
        </mpadded>
       </mrow>
       <mo rspace="4.2pt">+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>i</mi>
        </mpadded>
        <mpadded width="+1.7pt">
         <mi>a</mi>
        </mpadded>
        <mrow>
         <mo>∇</mo>
         <mi>θ</mi>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>k</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>p</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>g</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <mi>a</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>a</ci>
         </apply>
         <apply>
          <ci>normal-⋅</ci>
          <apply>
           <times></times>
           <cn type="float">2</cn>
           <ci>i</ci>
           <apply>
            <ci>normal-∇</ci>
            <ci>a</ci>
           </apply>
          </apply>
          <apply>
           <ci>normal-∇</ci>
           <ci>θ</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <times></times>
          <ci>a</ci>
          <apply>
           <ci>normal-∇</ci>
           <ci>θ</ci>
          </apply>
         </apply>
         <apply>
          <ci>normal-∇</ci>
          <ci>θ</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>a</ci>
        <ci>normal-Δ</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>g</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-∇</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>a</ci>
        <apply>
         <ci>normal-∇</ci>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{p}\,c_{g}\,\left(\Delta a\,+\,2i\,\nabla a\cdot\nabla\theta\,-\,a\,\nabla%
\theta\cdot\nabla\theta\,+\,i\,a\,\Delta\theta\right)\,+\,\nabla\left(c_{p}\,c%
_{g}\right)\cdot\left(\nabla a\,+\,i\,a\,\nabla\theta\right)\,+\,k^{2}\,c_{p}%
\,c_{g}\,a\,=\,0.
  </annotation>
 </semantics>
</math>

</p>

<p>Now both the real part and the imaginary part of this equation have to be equal to zero:</p>

<p>

<math display="inline" id="Mild-slope_equation:52">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>c</mi>
        <mi>p</mi>
       </msub>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>c</mi>
        <mi>g</mi>
       </msub>
      </mpadded>
      <mi mathvariant="normal">Δ</mi>
      <mpadded width="+1.7pt">
       <mi>a</mi>
      </mpadded>
     </mrow>
     <mo rspace="4.2pt">-</mo>
     <mrow>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>p</mi>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>g</mi>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>a</mi>
       </mpadded>
       <mrow>
        <mo>∇</mo>
        <mi>θ</mi>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <mrow>
       <mo>∇</mo>
       <mpadded width="+1.7pt">
        <mi>θ</mi>
       </mpadded>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">+</mo>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>c</mi>
          <mi>p</mi>
         </msub>
        </mpadded>
        <msub>
         <mi>c</mi>
         <mi>g</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo>∇</mo>
      <mpadded width="+1.7pt">
       <mi>a</mi>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>k</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>p</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>g</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <mi>a</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mtext>and</mtext>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>g</ci>
       </apply>
       <ci>normal-Δ</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>g</ci>
        </apply>
        <ci>a</ci>
        <apply>
         <ci>normal-∇</ci>
         <ci>θ</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-∇</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>g</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-∇</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <list>
     <cn type="float">0</cn>
     <mtext>and</mtext>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle c_{p}\,c_{g}\,\Delta a\,-\,c_{p}\,c_{g}\,a\,\nabla\theta\cdot%
\nabla\theta\,+\,\nabla\left(c_{p}\,c_{g}\right)\cdot\nabla a\,+\,k^{2}\,c_{p}%
\,c_{g}\,a\,=\,0\quad\text{and}
  </annotation>
 </semantics>
</math>


</p>

<p>The effective wavenumber vector 

<math display="inline" id="Mild-slope_equation:53">
 <semantics>
  <mi>𝜿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}
  </annotation>
 </semantics>
</math>

 is <em>defined</em> as the gradient of the wave phase:</p>

<p>

<math display="block" id="Mild-slope_equation:54">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>𝜿</mi>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <mo>∇</mo>
    <mi>θ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝜿</ci>
    <apply>
     <ci>normal-∇</ci>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}\,=\,\nabla\theta
  </annotation>
 </semantics>
</math>

   and its <a href="vector_length" title="wikilink">vector length</a> is   

<math display="inline" id="Mild-slope_equation:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>κ</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>𝜿</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>κ</ci>
    <apply>
     <abs></abs>
     <ci>𝜿</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa=|\boldsymbol{\kappa}|.
  </annotation>
 </semantics>
</math>

</p>

<p>Note that 

<math display="inline" id="Mild-slope_equation:56">
 <semantics>
  <mi>𝜿</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜿</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\kappa}
  </annotation>
 </semantics>
</math>

 is an <a class="uri" href="irrotational" title="wikilink">irrotational</a> field, since the <a href="Vector_calculus_identities#Curl_of_the_gradient" title="wikilink">curl of the gradient</a> is zero:</p>

<p>

<math display="block" id="Mild-slope_equation:57">
 <semantics>
  <mrow>
   <mrow>
    <mo rspace="4.2pt">∇</mo>
    <mo rspace="4.2pt">×</mo>
    <mpadded width="+1.7pt">
     <mi>𝜿</mi>
    </mpadded>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-∇</ci>
     <ci>𝜿</ci>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\,\times\,\boldsymbol{\kappa}\,=\,0.
  </annotation>
 </semantics>
</math>

</p>

<p>Now the real and imaginary parts of the transformed mild-slope equation become, first multiplying the imaginary part by 

<math display="inline" id="Mild-slope_equation:58">
 <semantics>
  <mi>a</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Mild-slope_equation:59">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msup>
     <mi>κ</mi>
     <mn>2</mn>
    </msup>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>k</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mo rspace="4.2pt">+</mo>
     <mrow>
      <mstyle displaystyle="true">
       <mfrac>
        <mrow>
         <mo>∇</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <msub>
             <mi>c</mi>
             <mi>p</mi>
            </msub>
           </mpadded>
           <msub>
            <mi>c</mi>
            <mi>g</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>p</mi>
          </msub>
         </mpadded>
         <msub>
          <mi>c</mi>
          <mi>g</mi>
         </msub>
        </mrow>
       </mfrac>
      </mstyle>
      <mo>⋅</mo>
      <mpadded width="+1.7pt">
       <mstyle displaystyle="true">
        <mfrac>
         <mrow>
          <mo>∇</mo>
          <mi>a</mi>
         </mrow>
         <mi>a</mi>
        </mfrac>
       </mstyle>
      </mpadded>
     </mrow>
     <mo rspace="4.2pt">+</mo>
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>a</mi>
       </mrow>
       <mi>a</mi>
      </mfrac>
     </mstyle>
    </mrow>
    <mtext>and</mtext>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>κ</ci>
     <cn type="integer">2</cn>
    </apply>
    <list>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <divide></divide>
        <apply>
         <ci>normal-∇</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <ci>p</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>c</ci>
           <ci>g</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>g</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <ci>normal-∇</ci>
         <ci>a</ci>
        </apply>
        <ci>a</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>a</ci>
       </apply>
       <ci>a</ci>
      </apply>
     </apply>
     <mtext>and</mtext>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\kappa^{2}\,=\,k^{2}\,+\,\frac{\nabla(c_{p}\,c_{g})}{c_{p}\,c_{g}%
}\cdot\frac{\nabla a}{a}\,+\,\frac{\Delta a}{a}\quad\text{and}
  </annotation>
 </semantics>
</math>


</p>

<p>The first equation directly leads to the eikonal equation above for 

<math display="inline" id="Mild-slope_equation:60">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>κ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>κ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \kappa\,
  </annotation>
 </semantics>
</math>

, while the second gives:</p>

<p>

<math display="block" id="Mild-slope_equation:61">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∇</mo>
     <mo>⋅</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>𝜿</mi>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>p</mi>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>g</mi>
        </msub>
       </mpadded>
       <msup>
        <mi>a</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <ci>normal-∇</ci>
     <apply>
      <times></times>
      <ci>𝜿</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot\left(\boldsymbol{\kappa}\,c_{p}\,c_{g}\,a^{2}\right)\,=\,0,
  </annotation>
 </semantics>
</math>

</p>

<p>which—by noting that 

<math display="inline" id="Mild-slope_equation:62">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>p</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>ω</mi>
    <mo>/</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>p</ci>
    </apply>
    <apply>
     <divide></divide>
     <ci>ω</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{p}=\omega/k
  </annotation>
 </semantics>
</math>

 in which the angular frequency 

<math display="inline" id="Mild-slope_equation:63">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 is a constant for time-<a class="uri" href="harmonic" title="wikilink">harmonic</a> motion—leads to the wave-energy conservation equation. </p>
<h2 id="derivation-of-the-mild-slope-equation">Derivation of the mild-slope equation</h2>

<p>The mild-slope equation can be derived by the use of several methods. Here, we will use a <a href="Calculus_of_variations" title="wikilink">variational</a> approach.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> The fluid is assumed to be <a href="viscosity" title="wikilink">inviscid</a> and <a class="uri" href="incompressible" title="wikilink">incompressible</a>, and the flow is assumed to be <a class="uri" href="irrotational" title="wikilink">irrotational</a>. These assumptions are valid ones for surface gravity waves, since the effects of <a class="uri" href="vorticity" title="wikilink">vorticity</a> and <a class="uri" href="viscosity" title="wikilink">viscosity</a> are only significant in the <a href="Stokes_boundary_layer" title="wikilink">Stokes boundary layers</a> (for the oscillatory part of the flow). Because the flow is irrotational, the wave motion can be described using <a href="potential_flow" title="wikilink">potential flow</a> theory.</p>
<h3 id="lukes-variational-principle">Luke's variational principle</h3>

<p>Luke's <a href="Lagrangian_(field_theory)" title="wikilink">Lagrangian</a> formulation gives a variational formulation for <a class="uri" href="non-linear" title="wikilink">non-linear</a> surface gravity waves.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> For the case of a horizontally unbounded domain with a constant <a class="uri" href="density" title="wikilink">density</a> 

<math display="inline" id="Mild-slope_equation:64">
 <semantics>
  <mi>ρ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ρ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho
  </annotation>
 </semantics>
</math>

, a free fluid surface at 

<math display="inline" id="Mild-slope_equation:65">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>ζ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=\zeta(x,y,t)
  </annotation>
 </semantics>
</math>

 and a fixed sea bed at 

<math display="inline" id="Mild-slope_equation:66">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>h</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=-h(x,y),
  </annotation>
 </semantics>
</math>

 Luke's variational principle 

<math display="inline" id="Mild-slope_equation:67">
 <semantics>
  <mrow>
   <mrow>
    <mi>δ</mi>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>ℒ</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\mathcal{L}=0
  </annotation>
 </semantics>
</math>

 uses the <a href="Lagrangian_(field_theory)" title="wikilink">Lagrangian</a></p>

<p>

<math display="block" id="Mild-slope_equation:68">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <msub>
       <mi>t</mi>
       <mn>1</mn>
      </msub>
     </msubsup>
     <mrow>
      <mo largeop="true" symmetric="true">∬</mo>
      <mrow>
       <mpadded width="+2.8pt">
        <mi>L</mi>
       </mpadded>
       <mtext>d</mtext>
       <mpadded width="+2.8pt">
        <mi>x</mi>
       </mpadded>
       <mtext>d</mtext>
       <mpadded width="+2.8pt">
        <mi>y</mi>
       </mpadded>
       <mtext>d</mtext>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ℒ</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">double-integral</csymbol>
      <apply>
       <times></times>
       <ci>L</ci>
       <mtext>d</mtext>
       <ci>x</ci>
       <mtext>d</mtext>
       <ci>y</ci>
       <mtext>d</mtext>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}=\int_{t_{0}}^{t_{1}}\iint L\;\text{d}x\;\text{d}y\;\text{d}t,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Mild-slope_equation:69">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 is the horizontal <a href="Lagrangian_density" title="wikilink">Lagrangian density</a>, given by:</p>

<p>

<math display="block" id="Mild-slope_equation:70">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>h</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>x</mi>
             <mo>,</mo>
             <mi>y</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mrow>
           <mi>ζ</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>x</mi>
            <mo>,</mo>
            <mi>y</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </msubsup>
         <mrow>
          <mrow>
           <mo>[</mo>
           <mrow>
            <mfrac>
             <mrow>
              <mo>∂</mo>
              <mi mathvariant="normal">Φ</mi>
             </mrow>
             <mrow>
              <mo>∂</mo>
              <mi>t</mi>
             </mrow>
            </mfrac>
            <mo rspace="4.2pt">+</mo>
            <mrow>
             <mfrac>
              <mn>1</mn>
              <mn>2</mn>
             </mfrac>
             <mrow>
              <mo>(</mo>
              <mrow>
               <msup>
                <mrow>
                 <mo>(</mo>
                 <mfrac>
                  <mrow>
                   <mo>∂</mo>
                   <mi mathvariant="normal">Φ</mi>
                  </mrow>
                  <mrow>
                   <mo>∂</mo>
                   <mi>x</mi>
                  </mrow>
                 </mfrac>
                 <mo>)</mo>
                </mrow>
                <mn>2</mn>
               </msup>
               <mo>+</mo>
               <msup>
                <mrow>
                 <mo>(</mo>
                 <mfrac>
                  <mrow>
                   <mo>∂</mo>
                   <mi mathvariant="normal">Φ</mi>
                  </mrow>
                  <mrow>
                   <mo>∂</mo>
                   <mi>y</mi>
                  </mrow>
                 </mfrac>
                 <mo>)</mo>
                </mrow>
                <mn>2</mn>
               </msup>
               <mo>+</mo>
               <msup>
                <mrow>
                 <mo>(</mo>
                 <mfrac>
                  <mrow>
                   <mo>∂</mo>
                   <mi mathvariant="normal">Φ</mi>
                  </mrow>
                  <mrow>
                   <mo>∂</mo>
                   <mi>z</mi>
                  </mrow>
                 </mfrac>
                 <mo>)</mo>
                </mrow>
                <mn>2</mn>
               </msup>
              </mrow>
              <mo>)</mo>
             </mrow>
            </mrow>
           </mrow>
           <mo rspace="5.3pt">]</mo>
          </mrow>
          <mtext>d</mtext>
          <mpadded width="+2.8pt">
           <mi>z</mi>
          </mpadded>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>g</mi>
         </mpadded>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <msup>
             <mi>ζ</mi>
             <mn>2</mn>
            </msup>
           </mpadded>
           <mo rspace="4.2pt">-</mo>
           <msup>
            <mi>h</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <set>
       <apply>
        <plus></plus>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <ci>h</ci>
             <interval closure="open">
              <ci>x</ci>
              <ci>y</ci>
             </interval>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>ζ</ci>
           <vector>
            <ci>x</ci>
            <ci>y</ci>
            <ci>t</ci>
           </vector>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <divide></divide>
             <apply>
              <partialdiff></partialdiff>
              <ci>normal-Φ</ci>
             </apply>
             <apply>
              <partialdiff></partialdiff>
              <ci>t</ci>
             </apply>
            </apply>
            <apply>
             <times></times>
             <apply>
              <divide></divide>
              <cn type="integer">1</cn>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <plus></plus>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <divide></divide>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>normal-Φ</ci>
                </apply>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>x</ci>
                </apply>
               </apply>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <divide></divide>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>normal-Φ</ci>
                </apply>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>y</ci>
                </apply>
               </apply>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <apply>
                <divide></divide>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>normal-Φ</ci>
                </apply>
                <apply>
                 <partialdiff></partialdiff>
                 <ci>z</ci>
                </apply>
               </apply>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
          <mtext>d</mtext>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>g</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>ζ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>h</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </set>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=-\rho\,\left\{\int_{-h(x,y)}^{\zeta(x,y,t)}\left[\frac{\partial\Phi}{%
\partial t}+\,\frac{1}{2}\left(\left(\frac{\partial\Phi}{\partial x}\right)^{2%
}+\left(\frac{\partial\Phi}{\partial y}\right)^{2}+\left(\frac{\partial\Phi}{%
\partial z}\right)^{2}\right)\right]\;\text{d}z\;+\,\frac{1}{2}\,g\,(\zeta^{2}%
\,-\,h^{2})\right\},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Mild-slope_equation:71">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Φ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>z</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi(x,y,z,t)
  </annotation>
 </semantics>
</math>

 is the <a href="velocity_potential" title="wikilink">velocity potential</a>, with the <a href="flow_velocity" title="wikilink">flow velocity</a> components being 

<math display="inline" id="Mild-slope_equation:72">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∂</mo>
     <mi mathvariant="normal">Φ</mi>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo>∂</mo>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <partialdiff></partialdiff>
     <ci>normal-Φ</ci>
    </apply>
    <apply>
     <partialdiff></partialdiff>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial\Phi/\partial{x},
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Mild-slope_equation:73">
 <semantics>
  <mrow>
   <mrow>
    <mo>∂</mo>
    <mi mathvariant="normal">Φ</mi>
   </mrow>
   <mo>/</mo>
   <mrow>
    <mo>∂</mo>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <partialdiff></partialdiff>
     <ci>normal-Φ</ci>
    </apply>
    <apply>
     <partialdiff></partialdiff>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial\Phi/\partial{y}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:74">
 <semantics>
  <mrow>
   <mrow>
    <mo>∂</mo>
    <mi mathvariant="normal">Φ</mi>
   </mrow>
   <mo>/</mo>
   <mrow>
    <mo>∂</mo>
    <mi>z</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <partialdiff></partialdiff>
     <ci>normal-Φ</ci>
    </apply>
    <apply>
     <partialdiff></partialdiff>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial\Phi/\partial{z}
  </annotation>
 </semantics>
</math>

 in the 

<math display="inline" id="Mild-slope_equation:75">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Mild-slope_equation:76">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:77">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 directions, respectively. Luke's Lagrangian formulation can also be recast into a <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian formulation</a> in terms of the surface elevation and velocity potential at the free surface.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> Taking the variations of 

<math display="inline" id="Mild-slope_equation:78">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ℒ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Φ</mi>
    <mo>,</mo>
    <mi>ζ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℒ</ci>
    <interval closure="open">
     <ci>normal-Φ</ci>
     <ci>ζ</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{L}(\Phi,\zeta)
  </annotation>
 </semantics>
</math>

 with respect to the potential 

<math display="inline" id="Mild-slope_equation:79">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Φ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>z</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi(x,y,z,t)
  </annotation>
 </semantics>
</math>

 and surface elevation 

<math display="inline" id="Mild-slope_equation:80">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ζ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(x,y,t)
  </annotation>
 </semantics>
</math>

 leads to the <a href="Laplace_equation" title="wikilink">Laplace equation</a> for 

<math display="inline" id="Mild-slope_equation:81">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

 in the fluid interior, as well as all the boundary conditions both on the free surface 

<math display="inline" id="Mild-slope_equation:82">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mrow>
    <mi>ζ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <times></times>
     <ci>ζ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=\zeta(x,y,t)
  </annotation>
 </semantics>
</math>

 as at the bed at 

<math display="inline" id="Mild-slope_equation:83">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>h</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=-h(x,y).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="linear-wave-theory">Linear wave theory</h3>

<p>In case of linear wave theory, the vertical integral in the Lagrangian density 

<math display="inline" id="Mild-slope_equation:84">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 is split into a part from the bed 

<math display="inline" id="Mild-slope_equation:85">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mi>h</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <apply>
     <minus></minus>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=-h
  </annotation>
 </semantics>
</math>

 to the mean surface at 

<math display="inline" id="Mild-slope_equation:86">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=0,
  </annotation>
 </semantics>
</math>

 and a second part from 

<math display="inline" id="Mild-slope_equation:87">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=0
  </annotation>
 </semantics>
</math>

 to the free surface 

<math display="inline" id="Mild-slope_equation:88">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mi>ζ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <ci>ζ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=\zeta
  </annotation>
 </semantics>
</math>

. Using a <a href="Taylor_series" title="wikilink">Taylor series</a> expansion for the second integral around the mean free-surface elevation 

<math display="inline" id="Mild-slope_equation:89">
 <semantics>
  <mrow>
   <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=0,
  </annotation>
 </semantics>
</math>

 and only retaining quadratic terms in 

<math display="inline" id="Mild-slope_equation:90">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:91">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>ζ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta,
  </annotation>
 </semantics>
</math>

 the Lagrangian density 

<math display="inline" id="Mild-slope_equation:92">
 <semantics>
  <msub>
   <mi>L</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{0}
  </annotation>
 </semantics>
</math>

 for linear wave motion becomes</p>

<p>

<math display="block" id="Mild-slope_equation:93">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>L</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>ζ</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <msub>
           <mrow>
            <mo>[</mo>
            <mfrac>
             <mrow>
              <mo>∂</mo>
              <mi mathvariant="normal">Φ</mi>
             </mrow>
             <mrow>
              <mo>∂</mo>
              <mi>t</mi>
             </mrow>
            </mfrac>
            <mo>]</mo>
           </mrow>
           <mrow>
            <mi>z</mi>
            <mo>=</mo>
            <mn>0</mn>
           </mrow>
          </msub>
         </mpadded>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mo>-</mo>
           <mi>h</mi>
          </mrow>
          <mn>0</mn>
         </msubsup>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
          <mrow>
           <mo>[</mo>
           <mrow>
            <msup>
             <mrow>
              <mo>(</mo>
              <mfrac>
               <mrow>
                <mo>∂</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mrow>
                <mo>∂</mo>
                <mi>x</mi>
               </mrow>
              </mfrac>
              <mo>)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
            <mo>+</mo>
            <msup>
             <mrow>
              <mo>(</mo>
              <mfrac>
               <mrow>
                <mo>∂</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mrow>
                <mo>∂</mo>
                <mi>y</mi>
               </mrow>
              </mfrac>
              <mo>)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
            <mo>+</mo>
            <msup>
             <mrow>
              <mo>(</mo>
              <mfrac>
               <mrow>
                <mo>∂</mo>
                <mi mathvariant="normal">Φ</mi>
               </mrow>
               <mrow>
                <mo>∂</mo>
                <mi>z</mi>
               </mrow>
              </mfrac>
              <mo>)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mrow>
           <mo rspace="5.3pt">]</mo>
          </mrow>
          <mtext>d</mtext>
          <mpadded width="+2.8pt">
           <mi>z</mi>
          </mpadded>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>g</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <msup>
           <mi>ζ</mi>
           <mn>2</mn>
          </msup>
         </mpadded>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <set>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>ζ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <divide></divide>
            <apply>
             <partialdiff></partialdiff>
             <ci>normal-Φ</ci>
            </apply>
            <apply>
             <partialdiff></partialdiff>
             <ci>t</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <eq></eq>
           <ci>z</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <minus></minus>
            <ci>h</ci>
           </apply>
          </apply>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <divide></divide>
              <apply>
               <partialdiff></partialdiff>
               <ci>normal-Φ</ci>
              </apply>
              <apply>
               <partialdiff></partialdiff>
               <ci>x</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <divide></divide>
              <apply>
               <partialdiff></partialdiff>
               <ci>normal-Φ</ci>
              </apply>
              <apply>
               <partialdiff></partialdiff>
               <ci>y</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <divide></divide>
              <apply>
               <partialdiff></partialdiff>
               <ci>normal-Φ</ci>
              </apply>
              <apply>
               <partialdiff></partialdiff>
               <ci>z</ci>
              </apply>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <mtext>d</mtext>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>g</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ζ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </set>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{0}=-\rho\,\left\{\zeta\,\left[\frac{\partial\Phi}{\partial t}\right]_{z=0}%
\,+\,\int_{-h}^{0}\frac{1}{2}\left[\left(\frac{\partial\Phi}{\partial x}\right%
)^{2}+\left(\frac{\partial\Phi}{\partial y}\right)^{2}+\left(\frac{\partial%
\Phi}{\partial z}\right)^{2}\right]\;\text{d}z\;+\,\frac{1}{2}\,g\,\zeta^{2}\,%
\right\}.
  </annotation>
 </semantics>
</math>

</p>

<p>The term 

<math display="inline" id="Mild-slope_equation:94">
 <semantics>
  <mrow>
   <mrow>
    <mo>∂</mo>
    <mi mathvariant="normal">Φ</mi>
   </mrow>
   <mo>/</mo>
   <mrow>
    <mo>∂</mo>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <partialdiff></partialdiff>
     <ci>normal-Φ</ci>
    </apply>
    <apply>
     <partialdiff></partialdiff>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \partial\Phi/\partial{t}
  </annotation>
 </semantics>
</math>

 in the vertical integral is dropped since it has become dynamically uninteresting: it gives a zero contribution to the <a href="Euler–Lagrange_equation" title="wikilink">Euler–Lagrange equations</a>, with the upper integration limit now fixed. The same is true for the neglected bottom term proportional to 

<math display="inline" id="Mild-slope_equation:95">
 <semantics>
  <msup>
   <mi>h</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>h</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{2}
  </annotation>
 </semantics>
</math>

 in the potential energy.</p>

<p>The waves propagate in the horizontal 

<math display="inline" id="Mild-slope_equation:96">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

 plane, while the structure of the potential 

<math display="inline" id="Mild-slope_equation:97">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

 is not wave-like in the vertical 

<math display="inline" id="Mild-slope_equation:98">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

-direction. This suggests the use of the following assumption on the form of the potential 

<math display="inline" id="Mild-slope_equation:99">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Φ</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>normal-Φ</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Mild-slope_equation:100">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>;</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <mi>φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>z</ci>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <list>
      <ci>z</ci>
      <ci>x</ci>
      <ci>y</ci>
     </list>
     <ci>φ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi(x,y,z,t)=f(z;x,y)\,\varphi(x,y,t)
  </annotation>
 </semantics>
</math>

   with normalisation   

<math display="inline" id="Mild-slope_equation:101">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo>;</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>x</ci>
      <ci>y</ci>
     </list>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(0;x,y)=1
  </annotation>
 </semantics>
</math>

   at the mean free-surface elevation 

<math display="inline" id="Mild-slope_equation:102">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=0.
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Mild-slope_equation:103">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>φ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(x,y,t)
  </annotation>
 </semantics>
</math>

 is the velocity potential at the mean free-surface level 

<math display="inline" id="Mild-slope_equation:104">
 <semantics>
  <mrow>
   <mi>z</mi>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>z</ci>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z=0.
  </annotation>
 </semantics>
</math>

 Next, the mild-slope assumption is made, in that the vertical shape function 

<math display="inline" id="Mild-slope_equation:105">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 changes slowly in the 

<math display="inline" id="Mild-slope_equation:106">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>x</ci>
    <ci>y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)
  </annotation>
 </semantics>
</math>

-plane, and horizontal derivatives of 

<math display="inline" id="Mild-slope_equation:107">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 can be neglected in the flow velocity. So:</p>

<p>

<math display="block" id="Mild-slope_equation:108">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi mathvariant="normal">Φ</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>x</mi>
          </mrow>
         </mfrac>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi mathvariant="normal">Φ</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>y</mi>
          </mrow>
         </mfrac>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi mathvariant="normal">Φ</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>z</mi>
          </mrow>
         </mfrac>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mpadded>
    <mo rspace="4.2pt">≈</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mpadded width="+1.7pt">
          <mi>f</mi>
         </mpadded>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi>φ</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>x</mi>
          </mrow>
         </mfrac>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mpadded width="+1.7pt">
          <mi>f</mi>
         </mpadded>
         <mfrac>
          <mrow>
           <mo>∂</mo>
           <mi>φ</mi>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <mi>y</mi>
          </mrow>
         </mfrac>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mrow>
            <mo>∂</mo>
            <mi>f</mi>
           </mrow>
           <mrow>
            <mo>∂</mo>
            <mi>z</mi>
           </mrow>
          </mfrac>
         </mpadded>
         <mi>φ</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <matrix>
     <matrixrow>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Φ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>z</ci>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>φ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>φ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>f</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>z</ci>
        </apply>
       </apply>
       <ci>φ</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}\displaystyle\frac{\partial\Phi}{\partial{x}}\\
\displaystyle\frac{\partial\Phi}{\partial{y}}\\
\displaystyle\frac{\partial\Phi}{\partial{z}}\end{pmatrix}\,\approx\,\begin{%
pmatrix}\displaystyle f\,\frac{\partial\varphi}{\partial{x}}\\
\displaystyle f\,\frac{\partial\varphi}{\partial{y}}\\
\displaystyle\frac{\partial{f}}{\partial{z}}\,\varphi\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>As a result:</p>

<p>

<math display="block" id="Mild-slope_equation:109">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>L</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>ρ</mi>
      </mpadded>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mi>ζ</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <mfrac>
           <mrow>
            <mo>∂</mo>
            <mi>φ</mi>
           </mrow>
           <mrow>
            <mo>∂</mo>
            <mi>t</mi>
           </mrow>
          </mfrac>
         </mpadded>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>F</mi>
         </mpadded>
         <mrow>
          <mo>[</mo>
          <mrow>
           <mpadded width="+1.7pt">
            <msup>
             <mrow>
              <mo>(</mo>
              <mfrac>
               <mrow>
                <mo>∂</mo>
                <mi>φ</mi>
               </mrow>
               <mrow>
                <mo>∂</mo>
                <mi>x</mi>
               </mrow>
              </mfrac>
              <mo>)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mpadded>
           <mo rspace="4.2pt">+</mo>
           <msup>
            <mrow>
             <mo>(</mo>
             <mfrac>
              <mrow>
               <mo>∂</mo>
               <mi>φ</mi>
              </mrow>
              <mrow>
               <mo>∂</mo>
               <mi>y</mi>
              </mrow>
             </mfrac>
             <mo>)</mo>
            </mrow>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo rspace="4.2pt">]</mo>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>G</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <msup>
           <mi>φ</mi>
           <mn>2</mn>
          </msup>
         </mpadded>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mpadded>
         <mpadded width="+1.7pt">
          <mi>g</mi>
         </mpadded>
         <mpadded width="+1.7pt">
          <msup>
           <mi>ζ</mi>
           <mn>2</mn>
          </msup>
         </mpadded>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>ρ</ci>
      <set>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>ζ</ci>
         <apply>
          <divide></divide>
          <apply>
           <partialdiff></partialdiff>
           <ci>φ</ci>
          </apply>
          <apply>
           <partialdiff></partialdiff>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>F</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <plus></plus>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <divide></divide>
             <apply>
              <partialdiff></partialdiff>
              <ci>φ</ci>
             </apply>
             <apply>
              <partialdiff></partialdiff>
              <ci>x</ci>
             </apply>
            </apply>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <divide></divide>
             <apply>
              <partialdiff></partialdiff>
              <ci>φ</ci>
             </apply>
             <apply>
              <partialdiff></partialdiff>
              <ci>y</ci>
             </apply>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>G</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>φ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>g</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ζ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </set>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{0}=-\rho\,\left\{\zeta\,\frac{\partial\varphi}{\partial t}\,+\,\frac{1}{2}%
\,F\,\left[\left(\frac{\partial\varphi}{\partial{x}}\right)^{2}\,+\,\left(%
\frac{\partial\varphi}{\partial{y}}\right)^{2}\right]\,+\,\frac{1}{2}\,G\,%
\varphi^{2}\,+\,\frac{1}{2}\,g\,\zeta^{2}\,\right\},
  </annotation>
 </semantics>
</math>

   with   

<math display="inline" id="Mild-slope_equation:110">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>F</mi>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mo>-</mo>
      <mi>h</mi>
     </mrow>
     <mn>0</mn>
    </msubsup>
    <mrow>
     <mpadded width="+2.8pt">
      <msup>
       <mi>f</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mtext>d</mtext>
     <mi>z</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>F</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <ci>h</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">2</cn>
      </apply>
      <mtext>d</mtext>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F\,=\,\int_{-h}^{0}f^{2}\;\text{d}z
  </annotation>
 </semantics>
</math>

   and   

<math display="inline" id="Mild-slope_equation:111">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>G</mi>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mi>h</mi>
      </mrow>
      <mn>0</mn>
     </msubsup>
     <mrow>
      <mpadded width="+2.8pt">
       <msup>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mrow>
           <mtext>d</mtext>
           <mi>f</mi>
          </mrow>
          <mrow>
           <mtext>d</mtext>
           <mi>z</mi>
          </mrow>
         </mfrac>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mpadded>
      <mtext>d</mtext>
      <mi>z</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <ci>h</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <mtext>d</mtext>
         <ci>f</ci>
        </apply>
        <apply>
         <times></times>
         <mtext>d</mtext>
         <ci>z</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <mtext>d</mtext>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G\,=\,\int_{-h}^{0}\left(\frac{\text{d}f}{\text{d}z}\right)^{2}\;\text{d}z.
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="Euler–Lagrange_equation" title="wikilink">Euler–Lagrange equations</a> for this Lagrangian density 

<math display="inline" id="Mild-slope_equation:112">
 <semantics>
  <msub>
   <mi>L</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{0}
  </annotation>
 </semantics>
</math>

 are, with 

<math display="inline" id="Mild-slope_equation:113">
 <semantics>
  <mrow>
   <mi>ξ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ξ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi(x,y,t)
  </annotation>
 </semantics>
</math>

 representing either 

<math display="inline" id="Mild-slope_equation:114">
 <semantics>
  <mi>φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Mild-slope_equation:115">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>ζ</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Mild-slope_equation:116">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>L</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>ξ</mi>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>L</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mo>∂</mo>
           <mi>ξ</mi>
          </mrow>
          <mo>/</mo>
          <mrow>
           <mo>∂</mo>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>x</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>L</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mo>∂</mo>
           <mi>ξ</mi>
          </mrow>
          <mo>/</mo>
          <mrow>
           <mo>∂</mo>
           <mi>x</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>y</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>L</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mo>∂</mo>
           <mi>ξ</mi>
          </mrow>
          <mo>/</mo>
          <mrow>
           <mo>∂</mo>
           <mi>y</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>ξ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>ξ</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>ξ</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>ξ</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial{L_{0}}}{\partial\xi}-\frac{\partial}{\partial{t}}\left(\frac{%
\partial{L_{0}}}{\partial(\partial\xi/\partial{t})}\right)-\frac{\partial}{%
\partial{x}}\left(\frac{\partial{L_{0}}}{\partial(\partial\xi/\partial{x})}%
\right)-\frac{\partial}{\partial{y}}\left(\frac{\partial{L_{0}}}{\partial(%
\partial\xi/\partial{y})}\right)=0.
  </annotation>
 </semantics>
</math>

</p>

<p>Now 

<math display="inline" id="Mild-slope_equation:117">
 <semantics>
  <mi>ξ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ξ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \xi
  </annotation>
 </semantics>
</math>

 is first taken equal to 

<math display="inline" id="Mild-slope_equation:118">
 <semantics>
  <mi>φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi
  </annotation>
 </semantics>
</math>


 and then to 

<math display="inline" id="Mild-slope_equation:119">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>ζ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta.
  </annotation>
 </semantics>
</math>

 As a result, the evolution equations for the wave motion become:<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>

<math display="inline" id="Mild-slope_equation:120">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>ζ</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <partialdiff></partialdiff>
     <ci>ζ</ci>
    </apply>
    <apply>
     <partialdiff></partialdiff>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{\partial\zeta}{\partial t}
  </annotation>
 </semantics>
</math>


</p>

<p>with ∇ the horizontal gradient operator: ∇ ≡(∂/∂<em>x</em> ∂/∂<em>y</em>)<sup>T</sup> where T denotes the <a class="uri" href="transpose" title="wikilink">transpose</a>.</p>

<p>The next step is to choose the shape function 

<math display="inline" id="Mild-slope_equation:121">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and to determine 

<math display="inline" id="Mild-slope_equation:122">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:123">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="vertical-shape-function-from-airy-wave-theory">Vertical shape function from Airy wave theory</h3>

<p>Since the objective is the description of waves over mildly sloping beds, the shape function 

<math display="inline" id="Mild-slope_equation:124">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(z)
  </annotation>
 </semantics>
</math>

 is chosen according to <a href="Airy_wave_theory" title="wikilink">Airy wave theory</a>. This is the linear theory of waves propagating in constant depth 

<math display="inline" id="Mild-slope_equation:125">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h.
  </annotation>
 </semantics>
</math>

 The form of the shape function is:<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:126">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>cosh</mi>
      </mpadded>
      <mrow>
       <mo maxsize="120%" minsize="120%">(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>k</mi>
        </mpadded>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>z</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo maxsize="120%" minsize="120%">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>cosh</mi>
      </mpadded>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>k</mi>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>f</ci>
    <apply>
     <divide></divide>
     <apply>
      <cosh></cosh>
      <apply>
       <times></times>
       <ci>k</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <cosh></cosh>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f=\frac{\cosh\,\bigl(k\,(z+h)\bigr)}{\cosh\,(kh)},
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Mild-slope_equation:127">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k(x,y)
  </annotation>
 </semantics>
</math>

 now in general not a constant, but chosen to vary with 

<math display="inline" id="Mild-slope_equation:128">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:129">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 according to the local depth 

<math display="inline" id="Mild-slope_equation:130">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(x,y)
  </annotation>
 </semantics>
</math>

 and the linear dispersion relation:<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:131">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <msubsup>
      <mi>ω</mi>
      <mn>0</mn>
      <mn>2</mn>
     </msubsup>
    </mpadded>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>g</mi>
     </mpadded>
     <mpadded width="+1.7pt">
      <mi>k</mi>
     </mpadded>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>tanh</mi>
      </mpadded>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>k</mi>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ω</ci>
      <cn type="integer">0</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>k</ci>
     <apply>
      <tanh></tanh>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{0}^{2}\,=\,g\,k\,\tanh\,(kh).
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Mild-slope_equation:132">
 <semantics>
  <msub>
   <mi>ω</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ω</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{0}
  </annotation>
 </semantics>
</math>

 a constant angular frequency, chosen in accordance with the characteristics of the wave field under study. Consequently, the integrals 

<math display="inline" id="Mild-slope_equation:133">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:134">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 become:<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>

<p>

<math display="inline" id="Mild-slope_equation:135">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle F
  </annotation>
 </semantics>
</math>


  The following time-dependent equations give the evolution of the free-surface elevation 

<math display="inline" id="Mild-slope_equation:136">
 <semantics>
  <mrow>
   <mi>ζ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ζ</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(x,y,t)
  </annotation>
 </semantics>
</math>

 and free-surface potential 

<math display="inline" id="Mild-slope_equation:137">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(x,y,t):
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p>

<p>

<math display="inline" id="Mild-slope_equation:138">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>g</mi>
   </mpadded>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>ζ</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>ζ</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle g\,\frac{\partial\zeta}{\partial{t}}
  </annotation>
 </semantics>
</math>


</p>

<p>From the two evolution equations, one of the variables 

<math display="inline" id="Mild-slope_equation:139">
 <semantics>
  <mi>φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Mild-slope_equation:140">
 <semantics>
  <mi>ζ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ζ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta
  </annotation>
 </semantics>
</math>

 can be eliminated, to obtain the time-dependent form of the mild-slope equation:<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:141">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mrow>
        <msup>
         <mo>∂</mo>
         <mn>2</mn>
        </msup>
        <mi>ζ</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msup>
         <mi>t</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo>∇</mo>
      <mo>⋅</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>c</mi>
          <mi>p</mi>
         </msub>
        </mpadded>
        <mpadded width="+1.7pt">
         <msub>
          <mi>c</mi>
          <mi>g</mi>
         </msub>
        </mpadded>
        <mrow>
         <mo>∇</mo>
         <mi>ζ</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <msup>
           <mi>k</mi>
           <mn>2</mn>
          </msup>
         </mpadded>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>p</mi>
          </msub>
         </mpadded>
         <mpadded width="+1.7pt">
          <msub>
           <mi>c</mi>
           <mi>g</mi>
          </msub>
         </mpadded>
        </mrow>
        <mo rspace="4.2pt">-</mo>
        <msubsup>
         <mi>ω</mi>
         <mn>0</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo rspace="4.2pt">)</mo>
      </mrow>
      <mi>ζ</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <partialdiff></partialdiff>
         <cn type="integer">2</cn>
        </apply>
        <ci>ζ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>g</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>ζ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>g</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">0</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>ζ</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\frac{\partial^{2}\zeta}{\partial{t^{2}}}+\nabla\cdot\left(c_{p}\,c_{g}\,%
\nabla\zeta\right)+\left(k^{2}\,c_{p}\,c_{g}\,-\,\omega_{0}^{2}\right)\,\zeta=0,
  </annotation>
 </semantics>
</math>

</p>

<p>and the corresponding equation for the free-surface potential is identical, with 

<math display="inline" id="Mild-slope_equation:142">
 <semantics>
  <mi>ζ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ζ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta
  </annotation>
 </semantics>
</math>

 replaced by 

<math display="inline" id="Mild-slope_equation:143">
 <semantics>
  <mrow>
   <mi>φ</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi.
  </annotation>
 </semantics>
</math>

 The time-dependent mild-slope equation can be used to model waves in a narrow band of frequencies around 

<math display="inline" id="Mild-slope_equation:144">
 <semantics>
  <mrow>
   <msub>
    <mi>ω</mi>
    <mn>0</mn>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ω</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{0}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="monochromatic-waves">Monochromatic waves</h3>

<p>Consider monochromatic waves with complex amplitude 

<math display="inline" id="Mild-slope_equation:145">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>η</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta(x,y)
  </annotation>
 </semantics>
</math>

 and angular frequency 

<math display="inline" id="Mild-slope_equation:146">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mo>:</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>ω</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega:
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Mild-slope_equation:147">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ζ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">=</mo>
    <mrow>
     <mi mathvariant="normal">ℜ</mi>
     <mrow>
      <mo>{</mo>
      <mrow>
       <mi>η</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>y</mi>
        <mo rspace="5.3pt" stretchy="false">)</mo>
       </mrow>
       <msup>
        <mtext>e</mtext>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mpadded width="+1.7pt">
           <mi>i</mi>
          </mpadded>
          <mpadded width="+1.7pt">
           <mi>ω</mi>
          </mpadded>
          <mi>t</mi>
         </mrow>
        </mrow>
       </msup>
      </mrow>
      <mo>}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ζ</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>t</ci>
     </vector>
    </apply>
    <apply>
     <real></real>
     <apply>
      <times></times>
      <ci>η</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <mtext>e</mtext>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>ω</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \zeta(x,y,t)\,=\,\Re\left\{\eta(x,y)\;\text{e}^{-i\,\omega\,t}\right\},
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Mild-slope_equation:148">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Mild-slope_equation:149">
 <semantics>
  <msub>
   <mi>ω</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ω</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{0}
  </annotation>
 </semantics>
</math>

 chosen equal to each other, 

<math display="inline" id="Mild-slope_equation:150">
 <semantics>
  <mrow>
   <mrow>
    <mi>ω</mi>
    <mo>=</mo>
    <msub>
     <mi>ω</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ω</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ω</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega=\omega_{0}.
  </annotation>
 </semantics>
</math>

 Using this in the time-dependent form of the mild-slope equation, recovers the classical mild-slope equation for time-harmonic wave motion:<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></p>

<p>

<math display="block" id="Mild-slope_equation:151">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∇</mo>
     <mo>⋅</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>p</mi>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>c</mi>
         <mi>g</mi>
        </msub>
       </mpadded>
       <mrow>
        <mo>∇</mo>
        <mi>η</mi>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">)</mo>
     </mrow>
    </mrow>
    <mo rspace="4.2pt">+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>k</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>p</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <msub>
       <mi>c</mi>
       <mi>g</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <mi>η</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>g</ci>
       </apply>
       <apply>
        <ci>normal-∇</ci>
        <ci>η</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>g</ci>
      </apply>
      <ci>η</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot\left(c_{p}\,c_{g}\,\nabla\eta\right)\,+\,k^{2}\,c_{p}\,c_{g}\,\eta%
\,=\,0.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="applicability-and-validity-of-the-mild-slope-equation">Applicability and validity of the mild-slope equation</h2>

<p>The standard mild slope equation, without extra terms for bed slope and bed curvature, provides accurate results for the wave field over bed slopes ranging from 0 to about 1/3.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> However, some subtle aspects, like the amplitude of reflected waves, can be completely wrong, even for slopes going to zero. This mathematical curiosity has little practical importance in general since this reflection becomes vanishingly small for small bottom slopes.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>, 2 Parts, 967 pages.</p></li>
<li></li>
<li>

<p>, 740 pages.</p></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Coastal_geography" title="wikilink">Category:Coastal geography</a> <a href="Category:Equations_of_fluid_dynamics" title="wikilink">Category:Equations of fluid dynamics</a> <a href="Category:Water_waves" title="wikilink">Category:Water waves</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">See Dingemans (1997), pp. 248–256 &amp; 378–379.<a href="#fnref4">↩</a></li>
<li id="fn5">See Dingemans (1997), p. 49.<a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7">See Mei (1994), pp. 86–89.<a href="#fnref7">↩</a></li>
<li id="fn8">See Dingemans (1997), pp. 259–262.<a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"></li>
<li id="fn19"></li>
<li id="fn20"></li>
<li id="fn21"></li>
<li id="fn22"></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
</ol>
</section>
</body>
</html>

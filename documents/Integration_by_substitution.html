<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="858">Integration by substitution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Integration by substitution</h1>
<hr/>

<p>In <a class="uri" href="calculus" title="wikilink">calculus</a>, <strong>integration by substitution</strong>, also known as <strong>u-substitution</strong>, is a method for finding <a href="integral" title="wikilink">integrals</a>. Using the <a href="fundamental_theorem_of_calculus" title="wikilink">fundamental theorem of calculus</a> often requires finding an antiderivative. For this and other reasons, integration by substitution is an important tool in mathematics. It is the counterpart to the <a href="chain_rule" title="wikilink">chain rule</a> of <a href="derivative" title="wikilink">differentiation</a>.</p>
<h2 id="substitution-for-single-variable">Substitution for single variable</h2>
<h3 id="relation-to-the-fundamental-theorem-of-calculus">Relation to the fundamental theorem of calculus</h3>

<p>Let 

<math display="inline" id="Integration_by_substitution:0">
<semantics>
<mrow>
<mi>I</mi>
<mi mathvariant="normal">⊆</mi>
<mi mathvariant="normal">ℝ</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>I</ci>
<ci>normal-⊆</ci>
<ci>normal-ℝ</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   I⊆ℝ
  </annotation>
</semantics>
</math>

 be an interval and 

<math display="inline" id="Integration_by_substitution:1">
<semantics>
<mrow>
<mi>φ</mi>
<mo>:</mo>
<mrow>
<mrow>
<mi>a</mi>
<mi>a</mi>
</mrow>
<mo>,</mo>
<mrow>
<mi>b</mi>
<mi mathvariant="normal">→</mi>
<mi>I</mi>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<ci>normal-:</ci>
<ci>φ</ci>
<list>
<apply>
<times></times>
<ci>a</ci>
<ci>a</ci>
</apply>
<apply>
<times></times>
<ci>b</ci>
<ci>normal-→</ci>
<ci>I</ci>
</apply>
</list>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   φ:aa,b→I
  </annotation>
</semantics>
</math>

 be a <a href="smooth_function" title="wikilink">continuously differentiable</a> function. Suppose that 

<math display="inline" id="Integration_by_substitution:2">
<semantics>
<mrow>
<mi></mi>
<mo>:</mo>
<mrow>
<mi>I</mi>
<mi mathvariant="normal">→</mi>
<mi mathvariant="normal">ℝ</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<ci>normal-:</ci>
<csymbol cd="latexml">absent</csymbol>
<apply>
<times></times>
<ci>I</ci>
<ci>normal-→</ci>
<ci>normal-ℝ</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   :I→ℝ
  </annotation>
</semantics>
</math>

 is a <a href="continuous_function" title="wikilink">continuous function</a>. Then</p>

<p>
<math display="block" id="Integration_by_substitution:3">
<semantics>
<mrow>
<mrow>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>a</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>b</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msubsup>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mi>a</mi>
<mi>b</mi>
</msubsup>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>φ</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>t</mi>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<ci>φ</ci>
<ci>a</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>φ</ci>
<ci>b</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>f</ci>
<ci>x</ci>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>a</ci>
</apply>
<ci>b</ci>
</apply>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
<ci>t</ci>
<ci>d</ci>
<ci>t</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{\varphi(a)}^{\varphi(b)}f(x)\,dx=\int_{a}^{b}f(\varphi(t))\varphi^{%
\prime}(t)\,dt.
  </annotation>
</semantics>
</math>
</p>

<p>In other notation: the substitution 

<math display="inline" id="Integration_by_substitution:4">
<semantics>
<mrow>
<mi>x</mi>
<mo>=</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>x</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   x=φ(t)
  </annotation>
</semantics>
</math>

 yields 

<math display="inline" id="Integration_by_substitution:5">
<semantics>
<mrow>
<mfrac>
<mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
<mrow>
<mi>d</mi>
<mi>t</mi>
</mrow>
</mfrac>
<mo>=</mo>
<mrow>
<mi>φ</mi>
<mi mathvariant="normal">′</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<divide></divide>
<apply>
<times></times>
<ci>d</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<ci>d</ci>
<ci>t</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>φ</ci>
<ci>normal-′</ci>
<ci>t</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \frac{dx}{dt}=φ′(t)
  </annotation>
</semantics>
</math>

 and thus, formally, 

<math display="inline" id="Integration_by_substitution:6">
<semantics>
<mrow>
<mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
<mo>=</mo>
<mrow>
<mi>φ</mi>
<mi mathvariant="normal">′</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>t</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>d</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<ci>φ</ci>
<ci>normal-′</ci>
<ci>t</ci>
<ci>d</ci>
<ci>t</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   dx=φ′(t)dt
  </annotation>
</semantics>
</math>

, which is the required substitution for 

<math display="inline" id="Integration_by_substitution:7">
<semantics>
<mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>d</ci>
<ci>x</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   dx
  </annotation>
</semantics>
</math>

. (One could view the method of integration by substitution as a major justification of <a href="Leibniz's_notation" title="wikilink">Leibniz's notation</a> for integrals and derivatives.)</p>

<p>The formula is used to transform one integral into another integral that is easier to compute. Thus, the formula can be used from left to right or from right to left in order to simplify a given integral. When used in the latter manner, it is sometimes known as <strong>u-substitution</strong> or <strong>w-substitution</strong>.</p>

<p>Integration by substitution can be derived from the <a href="fundamental_theorem_of_calculus" title="wikilink">fundamental theorem of calculus</a> as follows. Let 

<math display="inline" id="Integration_by_substitution:8">
<semantics>
<mi>ƒ</mi>
<annotation-xml encoding="MathML-Content">
<ci>ƒ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   ƒ
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="Integration_by_substitution:9">
<semantics>
<mi>φ</mi>
<annotation-xml encoding="MathML-Content">
<ci>φ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   φ
  </annotation>
</semantics>
</math>

 be two functions satisfying the above hypothesis that 

<math display="inline" id="Integration_by_substitution:10">
<semantics>
<mi>ƒ</mi>
<annotation-xml encoding="MathML-Content">
<ci>ƒ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   ƒ
  </annotation>
</semantics>
</math>

 is continuous on 

<math display="inline" id="Integration_by_substitution:11">
<semantics>
<mi>I</mi>
<annotation-xml encoding="MathML-Content">
<ci>I</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   I
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="Integration_by_substitution:12">
<semantics>
<mrow>
<mi>φ</mi>
<mi mathvariant="normal">′</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   φ′
  </annotation>
</semantics>
</math>

 is continuous on the closed interval 

<math display="inline" id="Integration_by_substitution:13">
<semantics>
<mrow>
<mrow>
<mi>a</mi>
<mi>a</mi>
</mrow>
<mo>,</mo>
<mi>b</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<list>
<apply>
<times></times>
<ci>a</ci>
<ci>a</ci>
</apply>
<ci>b</ci>
</list>
</annotation-xml>
<annotation encoding="application/x-tex">
   aa,b
  </annotation>
</semantics>
</math>

. Then the function 

<math display="inline" id="Integration_by_substitution:14">
<semantics>
<mrow>
<mi>ƒ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mi>φ</mi>
<mi mathvariant="normal">′</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>ƒ</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
<ci>φ</ci>
<ci>normal-′</ci>
<ci>t</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   ƒ(φ(t))φ′(t)
  </annotation>
</semantics>
</math>

 is also continuous on 

<math display="inline" id="Integration_by_substitution:15">
<semantics>
<mrow>
<mrow>
<mi>a</mi>
<mi>a</mi>
</mrow>
<mo>,</mo>
<mi>b</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<list>
<apply>
<times></times>
<ci>a</ci>
<ci>a</ci>
</apply>
<ci>b</ci>
</list>
</annotation-xml>
<annotation encoding="application/x-tex">
   aa,b
  </annotation>
</semantics>
</math>

. Hence the integrals</p>

<p>
<math display="block" id="Integration_by_substitution:16">
<semantics>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>a</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>b</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msubsup>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<ci>φ</ci>
<ci>a</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>φ</ci>
<ci>b</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>f</ci>
<ci>x</ci>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{\varphi(a)}^{\varphi(b)}f(x)\,dx
  </annotation>
</semantics>
</math>
</p>

<p>and</p>

<p>
<math display="block" id="Integration_by_substitution:17">
<semantics>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mi>a</mi>
<mi>b</mi>
</msubsup>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>φ</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>t</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>a</ci>
</apply>
<ci>b</ci>
</apply>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
<ci>t</ci>
<ci>d</ci>
<ci>t</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{a}^{b}f(\varphi(t))\varphi^{\prime}(t)\,dt
  </annotation>
</semantics>
</math>
</p>

<p>in fact exist, and it remains to show that they are equal.</p>

<p>Since 

<math display="inline" id="Integration_by_substitution:18">
<semantics>
<mi>ƒ</mi>
<annotation-xml encoding="MathML-Content">
<ci>ƒ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   ƒ
  </annotation>
</semantics>
</math>

 is continuous, it has an <a class="uri" href="antiderivative" title="wikilink">antiderivative</a>
<math display="inline" id="Integration_by_substitution:19">
<semantics>
<mi>F</mi>
<annotation-xml encoding="MathML-Content">
<ci>F</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   F
  </annotation>
</semantics>
</math>

. The <a href="function_composition" title="wikilink">composite function</a>
<math display="inline" id="Integration_by_substitution:20">
<semantics>
<mrow>
<mi>F</mi>
<mi mathvariant="normal">∘</mi>
<mi>φ</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>F</ci>
<ci>normal-∘</ci>
<ci>φ</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   F∘φ
  </annotation>
</semantics>
</math>

 is then defined. Since 

<math display="inline" id="Integration_by_substitution:21">
<semantics>
<mi>F</mi>
<annotation-xml encoding="MathML-Content">
<ci>F</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   F
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="Integration_by_substitution:22">
<semantics>
<mi>φ</mi>
<annotation-xml encoding="MathML-Content">
<ci>φ</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   φ
  </annotation>
</semantics>
</math>

 are differentiable, the <a href="chain_rule" title="wikilink">chain rule</a> gives</p>

<p>
<math display="block" id="Integration_by_substitution:23">
<semantics>
<mrow>
<mrow>
<mrow>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>F</mi>
<mo>∘</mo>
<mi>φ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msup>
<mi>F</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>φ</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>φ</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<and></and>
<apply>
<eq></eq>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<compose></compose>
<ci>F</ci>
<ci>φ</ci>
</apply>
<ci>normal-′</ci>
</apply>
<ci>t</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>F</ci>
<ci>normal-′</ci>
</apply>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
<ci>t</ci>
</apply>
</apply>
<apply>
<eq></eq>
<share href="#.cmml">
</share>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
<ci>t</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   (F\circ\varphi)^{\prime}(t)=F^{\prime}(\varphi(t))\varphi^{\prime}(t)=f(%
\varphi(t))\varphi^{\prime}(t).
  </annotation>
</semantics>
</math>
</p>

<p>Applying the <a href="fundamental_theorem_of_calculus" title="wikilink">fundamental theorem of calculus</a> twice gives</p>

<p>
<math display="inline" id="Integration_by_substitution:24">
<semantics>
<mrow>
<mstyle displaystyle="true">
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mi>a</mi>
<mi>b</mi>
</msubsup>
</mstyle>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>φ</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>t</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>a</ci>
</apply>
<ci>b</ci>
</apply>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>t</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
<ci>t</ci>
<ci>d</ci>
<ci>t</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \displaystyle\int_{a}^{b}f(\varphi(t))\varphi^{\prime}(t)\,dt
  </annotation>
</semantics>
</math>
</p>

<p>which is the substitution rule.</p>
<h3 id="examples">Examples</h3>

<p>Consider the integral</p>

<p>
<math display="block" id="Integration_by_substitution:25">
<semantics>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mn>0</mn>
<mn>2</mn>
</msubsup>
<mrow>
<mi>x</mi>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
</mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<cn type="integer">0</cn>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<times></times>
<ci>x</ci>
<apply>
<cos></cos>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{0}^{2}x\cos(x^{2}+1)\,dx
  </annotation>
</semantics>
</math>
</p>

<p>If we apply the formula from right to left and make the substitution <em>u</em> = <em></em>(<em>x</em>) = <em>x</em><sup>2</sup> + 1, we obtain <em>du</em> = 2<em>x</em> <em>dx</em> and hence; <em>x</em> <em>dx</em> = ½<em>du</em></p>

<p><strong>(1) Definite integral</strong><br/>
<math display="inline" id="Integration_by_substitution:26">
<semantics>
<mrow>
<mstyle displaystyle="true">
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mi>x</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mrow>
<mi>x</mi>
<mo>=</mo>
<mn>2</mn>
</mrow>
</msubsup>
</mstyle>
<mrow>
<mi>x</mi>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
</mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<eq></eq>
<ci>x</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<apply>
<eq></eq>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>x</ci>
<apply>
<cos></cos>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \displaystyle\int_{x=0}^{x=2}x\cos(x^{2}+1)\,dx
  </annotation>
</semantics>
</math>
</p>

<p>It is important to note that since the lower limit <em>x</em> = 0 was replaced with <em>u</em> = 0<sup>2</sup> + 1 = 1, and the upper limit <em>x</em> = 2 replaced with <em>u</em> = 2<sup>2</sup> + 1 = 5, a transformation back into terms of <em>x</em> was unnecessary.</p>

<p>For the integral</p>

<p>
<math display="block" id="Integration_by_substitution:27">
<semantics>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mn>0</mn>
<mn>1</mn>
</msubsup>
<mrow>
<mpadded width="+2.8pt">
<msqrt>
<mrow>
<mn>1</mn>
<mo>-</mo>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
</mrow>
</msqrt>
</mpadded>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<cn type="integer">0</cn>
</apply>
<cn type="integer">1</cn>
</apply>
<apply>
<times></times>
<apply>
<root></root>
<apply>
<minus></minus>
<cn type="integer">1</cn>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{0}^{1}\sqrt{1-x^{2}}\;dx
  </annotation>
</semantics>
</math>
</p>

<p>the formula needs to be used from left to right: the substitution <em>x</em> = sin(<em>u</em>), <em>dx</em> = cos(<em>u</em>) <em>du</em> is useful, because 

<math display="inline" id="Integration_by_substitution:28">
<semantics>
<mrow>
<msqrt>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mn>1</mn>
<mo>-</mo>
<mrow>
<msup>
<mi>sin</mi>
<mn>2</mn>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</msqrt>
<mo>=</mo>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<root></root>
<apply>
<minus></minus>
<cn type="integer">1</cn>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<sin></sin>
<cn type="integer">2</cn>
</apply>
<ci>u</ci>
</apply>
</apply>
</apply>
<apply>
<cos></cos>
<ci>u</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \sqrt{(1-\sin^{2}(u))}=\cos(u)
  </annotation>
</semantics>
</math>

:</p>

<p>
<math display="block" id="Integration_by_substitution:29">
<semantics>
<mrow>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mn>0</mn>
<mn>1</mn>
</msubsup>
<mrow>
<mpadded width="+2.8pt">
<msqrt>
<mrow>
<mn>1</mn>
<mo>-</mo>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
</mrow>
</msqrt>
</mpadded>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mn>0</mn>
<mfrac>
<mi>π</mi>
<mn>2</mn>
</mfrac>
</msubsup>
<mrow>
<msqrt>
<mrow>
<mn>1</mn>
<mo>-</mo>
<mrow>
<msup>
<mi>sin</mi>
<mn>2</mn>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</msqrt>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo rspace="5.3pt" stretchy="false">)</mo>
</mrow>
</mrow>
<mi>d</mi>
<mi>u</mi>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∫</mo>
<mn>0</mn>
<mfrac>
<mi>π</mi>
<mn>2</mn>
</mfrac>
</msubsup>
<mrow>
<mrow>
<msup>
<mi>cos</mi>
<mn>2</mn>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo rspace="5.3pt" stretchy="false">)</mo>
</mrow>
</mrow>
<mi>d</mi>
<mi>u</mi>
</mrow>
</mrow>
<mo>=</mo>
<mfrac>
<mi>π</mi>
<mn>4</mn>
</mfrac>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<and></and>
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<cn type="integer">0</cn>
</apply>
<cn type="integer">1</cn>
</apply>
<apply>
<times></times>
<apply>
<root></root>
<apply>
<minus></minus>
<cn type="integer">1</cn>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<cn type="integer">0</cn>
</apply>
<apply>
<divide></divide>
<ci>π</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<apply>
<root></root>
<apply>
<minus></minus>
<cn type="integer">1</cn>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<sin></sin>
<cn type="integer">2</cn>
</apply>
<ci>u</ci>
</apply>
</apply>
</apply>
<apply>
<cos></cos>
<ci>u</ci>
</apply>
<ci>d</ci>
<ci>u</ci>
</apply>
</apply>
</apply>
<apply>
<eq></eq>
<share href="#.cmml">
</share>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<cn type="integer">0</cn>
</apply>
<apply>
<divide></divide>
<ci>π</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<cos></cos>
<cn type="integer">2</cn>
</apply>
<ci>u</ci>
</apply>
<ci>d</ci>
<ci>u</ci>
</apply>
</apply>
</apply>
<apply>
<eq></eq>
<share href="#.cmml">
</share>
<apply>
<divide></divide>
<ci>π</ci>
<cn type="integer">4</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{0}^{1}\sqrt{1-x^{2}}\;dx=\int_{0}^{\frac{\pi}{2}}\sqrt{1-\sin^{2}(u)}%
\cos(u)\;du=\int_{0}^{\frac{\pi}{2}}\cos^{2}(u)\;du=\frac{\pi}{4}
  </annotation>
</semantics>
</math>
</p>

<p>The resulting integral can be computed using <a href="integration_by_parts" title="wikilink">integration by parts</a> or a <a href="List_of_trigonometric_identities#Double-.2C_triple-.2C_and_half-angle_formulae" title="wikilink">double angle formula</a> followed by one more substitution. One can also note that the function being integrated is the upper right quarter of a circle with a radius of one, and hence integrating the upper right quarter from zero to one is the geometric equivalent to the area of one quarter of the unit circle, or π/4.</p>

<p><strong>(2) Antiderivatives</strong></p>

<p>Substitution can be used to determine <a href="antiderivative" title="wikilink">antiderivatives</a>. One chooses a relation between <em>x</em> and <em>u</em>, determines the corresponding relation between <em>dx</em> and <em>du</em> by differentiating, and performs the substitutions. An antiderivative for the substituted function can hopefully be determined; the original substitution between <em>u</em> and <em>x</em> is then undone.</p>

<p>Similar to our first example above, we can determine the following antiderivative with this method:</p>

<p>
<math display="inline" id="Integration_by_substitution:30">
<semantics>
<mrow>
<mstyle displaystyle="true">
<mrow>
<mo largeop="true" lspace="12.5pt" symmetric="true">∫</mo>
<mrow>
<mi>x</mi>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
</mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
</mstyle>
<mo>=</mo>
<mrow>
<mstyle displaystyle="true">
<mfrac>
<mn>1</mn>
<mn>2</mn>
</mfrac>
</mstyle>
<mstyle displaystyle="true">
<mrow>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mn>2</mn>
<mi>x</mi>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
</mrow>
<mi>d</mi>
<mi>x</mi>
</mrow>
</mrow>
</mstyle>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<int></int>
<apply>
<times></times>
<ci>x</ci>
<apply>
<cos></cos>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
<apply>
<times></times>
<apply>
<divide></divide>
<cn type="integer">1</cn>
<cn type="integer">2</cn>
</apply>
<apply>
<int></int>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>x</ci>
<apply>
<cos></cos>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>d</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \displaystyle{}\quad\int x\cos(x^{2}+1)\,dx=\frac{1}{2}\int 2x\cos(x^{2}+1)\,dx
  </annotation>
</semantics>
</math>
</p>

<p>where <em>C</em> is an arbitrary <a href="constant_of_integration" title="wikilink">constant of integration</a>.</p>

<p>Note that there were no integral boundaries to transform, but in the last step we had to revert the original substitution <em>u</em> = <em>x</em><sup>2</sup> + 1.</p>
<h2 id="substitution-for-multiple-variables">Substitution for multiple variables</h2>

<p>One may also use substitution when integrating functions of several variables. Here the substitution function (<em>v</em><sub>1</sub>,...,<em>v</em><sub><em>n</em></sub>) = <em>φ</em>(<em>u</em><sub>1</sub>, ..., <em>u</em><sub><em>n</em></sub> ) needs to be <a class="uri" href="injective" title="wikilink">injective</a> and continuously differentiable, and the differentials transform as</p>

<p>
<math display="block" id="Integration_by_substitution:31">
<semantics>
<mrow>
<mrow>
<mi>d</mi>
<msub>
<mi>v</mi>
<mn>1</mn>
</msub>
<mi mathvariant="normal">⋯</mi>
<mi>d</mi>
<msub>
<mi>v</mi>
<mi>n</mi>
</msub>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<mo stretchy="false">|</mo>
<mrow>
<mo movablelimits="false">det</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mo>D</mo>
<mi>φ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>u</mi>
<mn>1</mn>
</msub>
<mo>,</mo>
<mi mathvariant="normal">…</mi>
<mo>,</mo>
<msub>
<mi>u</mi>
<mi>n</mi>
</msub>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo rspace="4.2pt" stretchy="false">|</mo>
</mrow>
<mi>d</mi>
<msub>
<mi>u</mi>
<mn>1</mn>
</msub>
<mi mathvariant="normal">⋯</mi>
<mi>d</mi>
<msub>
<mi>u</mi>
<mi>n</mi>
</msub>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>v</ci>
<cn type="integer">1</cn>
</apply>
<ci>normal-⋯</ci>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>v</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<times></times>
<apply>
<abs></abs>
<apply>
<determinant></determinant>
<apply>
<times></times>
<apply>
<ci>normal-D</ci>
<ci>φ</ci>
</apply>
<vector>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>u</ci>
<cn type="integer">1</cn>
</apply>
<ci>normal-…</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>u</ci>
<ci>n</ci>
</apply>
</vector>
</apply>
</apply>
</apply>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>u</ci>
<cn type="integer">1</cn>
</apply>
<ci>normal-⋯</ci>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>u</ci>
<ci>n</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   dv_{1}\cdots dv_{n}=|\det(\operatorname{D}\varphi)(u_{1},\ldots,u_{n})|\,du_{1%
}\cdots du_{n}
  </annotation>
</semantics>
</math>
</p>

<p>where det(D<em>φ</em>)(<em>u</em><sub>1</sub>, ..., <em>u</em><sub><em>n</em></sub> ) denotes the <a class="uri" href="determinant" title="wikilink">determinant</a> of the <a href="Jacobian_matrix" title="wikilink">Jacobian matrix</a> containing the <a href="partial_derivative" title="wikilink">partial derivatives</a> of <em>φ</em>. This formula expresses the fact that the <a href="absolute_value" title="wikilink">absolute value</a> of the determinant of a matrix equals the volume of the <a class="uri" href="parallelotope" title="wikilink">parallelotope</a> spanned by its columns or rows.</p>

<p>More precisely, the <em><a href="change_of_variables" title="wikilink">change of variables</a></em> formula is stated in the next theorem:</p>

<p><strong>Theorem</strong>. Let <em>U</em> be an open set in <strong>R</strong><sup><em>n</em></sup> and <em>φ</em> : <em>U</em> → <strong>R</strong><sup><em>n</em></sup> an <a href="Injective_function" title="wikilink">injective</a> differentiable function with continuous partial derivatives, the Jacobian of which is nonzero for every <em>x</em> in <em>U</em>. Then for any real-valued, compactly supported, continuous function <em>f</em>, with support contained in <em>φ</em>(<em>U</em>),</p>

<p>
<math display="block" id="Integration_by_substitution:32">
<semantics>
<mrow>
<mrow>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>U</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msub>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>𝐯</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>𝐯</mi>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>U</mi>
</msub>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>𝐮</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo>|</mo>
<mrow>
<mo movablelimits="false">det</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mo>D</mo>
<mi>φ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mi>𝐮</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo rspace="4.2pt">|</mo>
</mrow>
<mi>d</mi>
<mi>𝐮</mi>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<ci>φ</ci>
<ci>U</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>f</ci>
<ci>𝐯</ci>
<ci>d</ci>
<ci>𝐯</ci>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>U</ci>
</apply>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>𝐮</ci>
</apply>
<apply>
<abs></abs>
<apply>
<determinant></determinant>
<apply>
<times></times>
<apply>
<ci>normal-D</ci>
<ci>φ</ci>
</apply>
<ci>𝐮</ci>
</apply>
</apply>
</apply>
<ci>d</ci>
<ci>𝐮</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{\varphi(U)}f(\mathbf{v})\,d\mathbf{v}=\int_{U}f(\varphi(\mathbf{u}))%
\left|\det(\operatorname{D}\varphi)(\mathbf{u})\right|\,d\mathbf{u}.
  </annotation>
</semantics>
</math>
</p>

<p>The conditions on the theorem can be weakened in various ways. First, the requirement that <em>φ</em> be continuously differentiable can be replaced by the weaker assumption that <em>φ</em> be merely differentiable and have a continuous inverse . This is guaranteed to hold if <em>φ</em> is continuously differentiable by the <a href="inverse_function_theorem" title="wikilink">inverse function theorem</a>. Alternatively, the requirement that Det(Dφ)≠0 can be eliminated by applying <a href="Sard's_theorem" title="wikilink">Sard's theorem</a> .</p>

<p>For Lebesgue measurable functions, the theorem can be stated in the following form :</p>

<p><strong>Theorem</strong>. Let <em>U</em> be a measurable subset of <strong>R</strong><sup><em>n</em></sup> and <em>φ</em> : <em>U</em> → <strong>R</strong><sup><em>n</em></sup> an <a href="Injective_function" title="wikilink">injective</a> function, and suppose for every <em>x</em> in <em>U</em> there exists <em><span>φ'</span></em>(<em>x</em>) in <strong>R</strong><sup><em>n</em>,<em>n</em></sup> such that <em>φ</em>(<em>y</em>) = <em>φ</em>(<em>x</em>) + <em><span>φ'</span></em>(<em>x</em>) (<em>y</em> − <em>x</em>) + <a href="Landau_symbol#Related_asymptotic_notations" title="wikilink"><em>o</em></a>(||<em>y</em> − <em>x</em>||) as <em>y</em> → <em>x</em>. Then <em>φ</em>(<em>U</em>) is measurable, and for any real-valued function <em>f</em> defined on <em>φ</em>(<em>U</em>),</p>

<p>
<math display="block" id="Integration_by_substitution:33">
<semantics>
<mrow>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>U</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msub>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>v</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mpadded width="+2.8pt">
<mi>v</mi>
</mpadded>
</mrow>
</mrow>
<mo rspace="5.3pt">=</mo>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>U</mi>
</msub>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo rspace="5.3pt" stretchy="false">)</mo>
</mrow>
<mrow>
<mo>|</mo>
<mrow>
<mo movablelimits="false">det</mo>
<mrow>
<msup>
<mi>φ</mi>
<mo>′</mo>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>u</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo rspace="4.2pt">|</mo>
</mrow>
<mi>d</mi>
<mi>u</mi>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<ci>φ</ci>
<ci>U</ci>
</apply>
</apply>
<apply>
<times></times>
<ci>f</ci>
<ci>v</ci>
<ci>d</ci>
<ci>v</ci>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>U</ci>
</apply>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>φ</ci>
<ci>u</ci>
</apply>
<apply>
<abs></abs>
<apply>
<determinant></determinant>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>φ</ci>
<ci>normal-′</ci>
</apply>
<ci>u</ci>
</apply>
</apply>
</apply>
<ci>d</ci>
<ci>u</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{\varphi(U)}f(v)\,dv\;=\;\int_{U}f(\varphi(u))\;\left|\det\varphi^{\prime%
}(u)\right|\,du
  </annotation>
</semantics>
</math>

 in the sense that if either integral exists (or is properly infinite), then so does the other one, and they have the same value.</p>

<p>Another very general version in <a href="measure_theory" title="wikilink">measure theory</a> is the following :</p>

<p><strong>Theorem</strong>. Let <em>X</em> be a <a href="locally_compact" title="wikilink">locally compact</a> <a href="Hausdorff_space" title="wikilink">Hausdorff space</a> equipped with a finite <a href="Radon_measure" title="wikilink">Radon measure</a> μ, and let <em>Y</em> be a <a href="Σ-compact_space" title="wikilink">σ-compact</a> Hausdorff space with a <a href="sigma_finite_measure" title="wikilink">σ-finite</a> Radon measure ρ. Let <em>φ</em> : <em>X</em> → <em>Y</em> be a <a href="continuous_function" title="wikilink">continuous</a> and <a href="absolutely_continuous" title="wikilink">absolutely continuous</a> function (where the latter means that <em>ρ</em>(<em>φ</em>(<em>E</em>)) = 0 whenever <em>μ</em>(<em>E</em>) = 0). Then there exists a real-valued <a href="Borel_algebra" title="wikilink">Borel measurable function</a> <em>w</em> on <em>X</em> such that for every <a href="Lebesgue_integral" title="wikilink">Lebesgue integrable</a> function <em>f</em> : <em>Y</em> → <strong>R</strong>, the function (<em>f</em>  

<math display="inline" id="Integration_by_substitution:34">
<semantics>
<mo>∘</mo>
<annotation-xml encoding="MathML-Content">
<compose></compose>
</annotation-xml>
<annotation encoding="application/x-tex">
   \circ
  </annotation>
</semantics>
</math>
<em>φ</em>)<em>w</em> is Lebesgue integrable on <em>X</em>, and</p>

<p>
<math display="block" id="Integration_by_substitution:35">
<semantics>
<mrow>
<mrow>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>Y</mi>
</msub>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>ρ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>X</mi>
</msub>
<mrow>
<mrow>
<mi>f</mi>
<mo>∘</mo>
<mi>φ</mi>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>w</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>μ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>Y</ci>
</apply>
<apply>
<times></times>
<ci>f</ci>
<ci>y</ci>
<ci>d</ci>
<ci>ρ</ci>
<ci>y</ci>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>X</ci>
</apply>
<apply>
<times></times>
<apply>
<compose></compose>
<ci>f</ci>
<ci>φ</ci>
</apply>
<ci>x</ci>
<ci>w</ci>
<ci>x</ci>
<ci>d</ci>
<ci>μ</ci>
<ci>x</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{Y}f(y)\,d\rho(y)=\int_{X}f\circ\varphi(x)w(x)\,d\mu(x).
  </annotation>
</semantics>
</math>

 Furthermore, it is possible to write</p>

<p>
<math display="block" id="Integration_by_substitution:36">
<semantics>
<mrow>
<mrow>
<mi>w</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<mi>g</mi>
<mo>∘</mo>
<mi>φ</mi>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>w</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<apply>
<compose></compose>
<ci>g</ci>
<ci>φ</ci>
</apply>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   w(x)=g\circ\varphi(x)
  </annotation>
</semantics>
</math>

 for some Borel measurable function <em>g</em> on <em>Y</em>.</p>

<p>In <a href="geometric_measure_theory" title="wikilink">geometric measure theory</a>, integration by substitution is used with <a href="Lipschitz_function" title="wikilink">Lipschitz functions</a>. A bi-Lipschitz function is a Lipschitz function <em>φ</em> : <em>U</em> → <strong>R</strong><sup>n</sup> which is one-to-one, and such that its inverse function <em>φ</em><sup>−1</sup> : <em>φ</em>(<em>U</em>) → <em>U</em> is also Lipschitz. By <a href="Rademacher's_theorem" title="wikilink">Rademacher's theorem</a> a bi-Lipschitz mapping is differentiable <a href="almost_everywhere" title="wikilink">almost everywhere</a>. In particular, the Jacobian determinant of a bi-Lipschitz mapping det D<em>'φ</em> is well-defined almost everywhere. The following result then holds:</p>

<p><strong>Theorem.</strong> Let <em>U</em> be an open subset of <strong>R</strong><sup>n</sup> and <em>φ</em> : <em>U</em> → <strong>R</strong><sup>n</sup> be a bi-Lipschitz mapping. Let <em>f</em> : <em>φ</em>(<em>U</em>) → <strong>R</strong> be measurable. Then</p>

<p>
<math display="block" id="Integration_by_substitution:37">
<semantics>
<mrow>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>U</mi>
</msub>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>f</mi>
<mo>∘</mo>
<mi>φ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo stretchy="false">|</mo>
<mrow>
<mo movablelimits="false">det</mo>
<mrow>
<mi>D</mi>
<mi>φ</mi>
</mrow>
</mrow>
<mo stretchy="false">|</mo>
</mrow>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<mi>φ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>U</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msub>
<mi>f</mi>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>U</ci>
</apply>
<apply>
<times></times>
<apply>
<compose></compose>
<ci>f</ci>
<ci>φ</ci>
</apply>
<apply>
<abs></abs>
<apply>
<determinant></determinant>
<apply>
<times></times>
<ci>D</ci>
<ci>φ</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<ci>φ</ci>
<ci>U</ci>
</apply>
</apply>
<ci>f</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{U}(f\circ\varphi)|\det D\varphi|=\int_{\varphi(U)}f
  </annotation>
</semantics>
</math>

 in the sense that if either integral exists (or is properly infinite), then so does the other one, and they have the same value.</p>

<p>The above theorem was first proposed by <a class="uri" href="Euler" title="wikilink">Euler</a> when he developed the notion of <a href="double_integrals" title="wikilink">double integrals</a> in 1769. Although generalized to triple integrals by <a class="uri" href="Lagrange" title="wikilink">Lagrange</a> in 1773, and used by <a href="Adrien-Marie_Legendre" title="wikilink">Legendre</a>, <a class="uri" href="Laplace" title="wikilink">Laplace</a>, <a class="uri" href="Gauss" title="wikilink">Gauss</a>, and first generalized to <em>n</em> variables by <a href="Mikhail_Ostrogradski" title="wikilink">Mikhail Ostrogradski</a> in 1836, it resisted a fully rigorous formal proof for a surprisingly long time, and was first satisfactorily resolved 125 years later, by <a href="Élie_Cartan" title="wikilink">Élie Cartan</a> in a series of papers beginning in the mid-1890s (; ).</p>
<h2 id="application-in-probability">Application in probability</h2>

<p>Substitution can be used to answer the following important question in probability: given a random variable 

<math display="inline" id="Integration_by_substitution:38">
<semantics>
<mi>X</mi>
<annotation-xml encoding="MathML-Content">
<ci>X</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   X
  </annotation>
</semantics>
</math>

 with probability density 

<math display="inline" id="Integration_by_substitution:39">
<semantics>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{x}
  </annotation>
</semantics>
</math>

 and another random variable 

<math display="inline" id="Integration_by_substitution:40">
<semantics>
<mi>Y</mi>
<annotation-xml encoding="MathML-Content">
<ci>Y</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   Y
  </annotation>
</semantics>
</math>

 related to 

<math display="inline" id="Integration_by_substitution:41">
<semantics>
<mi>X</mi>
<annotation-xml encoding="MathML-Content">
<ci>X</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   X
  </annotation>
</semantics>
</math>

 by the equation 

<math display="inline" id="Integration_by_substitution:42">
<semantics>
<mrow>
<mi>y</mi>
<mo>=</mo>
<mrow>
<mi>ϕ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>y</ci>
<apply>
<times></times>
<ci>ϕ</ci>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   y=\phi(x)
  </annotation>
</semantics>
</math>

, what is the probability density for 

<math display="inline" id="Integration_by_substitution:43">
<semantics>
<mi>Y</mi>
<annotation-xml encoding="MathML-Content">
<ci>Y</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   Y
  </annotation>
</semantics>
</math>

?</p>

<p>It is easiest to answer this question by first answering a slightly different question: what is the probability that 

<math display="inline" id="Integration_by_substitution:44">
<semantics>
<mi>Y</mi>
<annotation-xml encoding="MathML-Content">
<ci>Y</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   Y
  </annotation>
</semantics>
</math>

 takes a value in some particular subset 

<math display="inline" id="Integration_by_substitution:45">
<semantics>
<mi>S</mi>
<annotation-xml encoding="MathML-Content">
<ci>S</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   S
  </annotation>
</semantics>
</math>

? Denote this probability 

<math display="inline" id="Integration_by_substitution:46">
<semantics>
<mrow>
<mi>P</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>Y</mi>
<mo>∈</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<csymbol cd="unknown">P</csymbol>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">Y</csymbol>
<in></in>
<csymbol cd="unknown">S</csymbol>
<ci>normal-)</ci>
</cerror>
</cerror>
</annotation-xml>
<annotation encoding="application/x-tex">
   P(Y\in S)
  </annotation>
</semantics>
</math>

. Of course, if 

<math display="inline" id="Integration_by_substitution:47">
<semantics>
<mi>Y</mi>
<annotation-xml encoding="MathML-Content">
<ci>Y</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   Y
  </annotation>
</semantics>
</math>

 has probability density 

<math display="inline" id="Integration_by_substitution:48">
<semantics>
<msub>
<mi>p</mi>
<mi>y</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>y</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{y}
  </annotation>
</semantics>
</math>

 then the answer is</p>

<p>
<math display="block" id="Integration_by_substitution:49">
<semantics>
<mrow>
<mi>P</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>Y</mi>
<mo>∈</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
<mo>=</mo>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>S</mi>
</msub>
<msub>
<mi>p</mi>
<mi>y</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>y</mi>
<mo>,</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<csymbol cd="unknown">P</csymbol>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">Y</csymbol>
<in></in>
<csymbol cd="unknown">S</csymbol>
<ci>normal-)</ci>
</cerror>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>S</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>y</ci>
</apply>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">y</csymbol>
<ci>normal-)</ci>
</cerror>
<csymbol cd="unknown">d</csymbol>
<csymbol cd="unknown">y</csymbol>
<ci>normal-,</ci>
</cerror>
</annotation-xml>
<annotation encoding="application/x-tex">
   P(Y\in S)=\int_{S}p_{y}(y)\,dy,
  </annotation>
</semantics>
</math>
</p>

<p>but this isn't really useful because we don't know <em>p</em><sub><em>y</em></sub>; it's what we're trying to find in the first place. We can make progress by considering the problem in the variable 

<math display="inline" id="Integration_by_substitution:50">
<semantics>
<mi>X</mi>
<annotation-xml encoding="MathML-Content">
<ci>X</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   X
  </annotation>
</semantics>
</math>

. 

<math display="inline" id="Integration_by_substitution:51">
<semantics>
<mi>Y</mi>
<annotation-xml encoding="MathML-Content">
<ci>Y</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   Y
  </annotation>
</semantics>
</math>

 takes a value in <em>S</em> whenever <em>X</em> takes a value in 

<math display="inline" id="Integration_by_substitution:52">
<semantics>
<mrow>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>S</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \phi^{-1}(S)
  </annotation>
</semantics>
</math>

, so</p>

<p>
<math display="block" id="Integration_by_substitution:53">
<semantics>
<mrow>
<mi>P</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>Y</mi>
<mo>∈</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
<mo>=</mo>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msub>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo rspace="4.2pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>x</mi>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<csymbol cd="unknown">P</csymbol>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">Y</csymbol>
<in></in>
<csymbol cd="unknown">S</csymbol>
<ci>normal-)</ci>
</cerror>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>S</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">x</csymbol>
<ci>normal-)</ci>
</cerror>
<csymbol cd="unknown">d</csymbol>
<csymbol cd="unknown">x</csymbol>
<ci>normal-.</ci>
</cerror>
</annotation-xml>
<annotation encoding="application/x-tex">
   P(Y\in S)=\int_{\phi^{-1}(S)}p_{x}(x)\,dx.
  </annotation>
</semantics>
</math>
</p>

<p>Changing from variable <em>x</em> to <em>y</em> gives</p>

<p>
<math display="block" id="Integration_by_substitution:54">
<semantics>
<mrow>
<mi>P</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>Y</mi>
<mo>∈</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
<mo>=</mo>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mrow>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>S</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msub>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo rspace="5.8pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>x</mi>
<mo>=</mo>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>S</mi>
</msub>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
<mo rspace="5.8pt" stretchy="false">)</mo>
</mrow>
<mo>|</mo>
<mfrac>
<mrow>
<mi>d</mi>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mi>d</mi>
<mi>y</mi>
</mrow>
</mfrac>
<mo rspace="5.8pt">|</mo>
<mi>d</mi>
<mi>y</mi>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<csymbol cd="unknown">P</csymbol>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">Y</csymbol>
<in></in>
<csymbol cd="unknown">S</csymbol>
<ci>normal-)</ci>
</cerror>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>S</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">x</csymbol>
<ci>normal-)</ci>
</cerror>
<csymbol cd="unknown">d</csymbol>
<csymbol cd="unknown">x</csymbol>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>S</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<cerror>
<csymbol cd="ambiguous">fragments</csymbol>
<ci>normal-(</ci>
<csymbol cd="unknown">y</csymbol>
<ci>normal-)</ci>
</cerror>
<ci>normal-)</ci>
</cerror>
<ci>normal-|</ci>
<apply>
<divide></divide>
<apply>
<times></times>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<times></times>
<ci>d</ci>
<ci>y</ci>
</apply>
</apply>
<ci>normal-|</ci>
<csymbol cd="unknown">d</csymbol>
<csymbol cd="unknown">y</csymbol>
<ci>normal-.</ci>
</cerror>
</annotation-xml>
<annotation encoding="application/x-tex">
   P(Y\in S)=\int_{\phi^{-1}(S)}p_{x}(x)~{}dx=\int_{S}p_{x}(\phi^{-1}(y))~{}\left%
|\frac{d\phi^{-1}}{dy}\right|~{}dy.
  </annotation>
</semantics>
</math>
</p>

<p>Combining this with our first equation gives</p>

<p>
<math display="block" id="Integration_by_substitution:55">
<semantics>
<mrow>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>S</mi>
</msub>
<mrow>
<msub>
<mi>p</mi>
<mi>y</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo rspace="5.8pt" stretchy="false">)</mo>
</mrow>
<mi>d</mi>
<mi>y</mi>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mo largeop="true" symmetric="true">∫</mo>
<mi>S</mi>
</msub>
<mrow>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo rspace="5.8pt" stretchy="false">)</mo>
</mrow>
<mrow>
<mo>|</mo>
<mfrac>
<mrow>
<mi>d</mi>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mi>d</mi>
<mi>y</mi>
</mrow>
</mfrac>
<mo rspace="5.8pt">|</mo>
</mrow>
<mi>d</mi>
<mi>y</mi>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>S</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>y</ci>
</apply>
<ci>y</ci>
<ci>d</ci>
<ci>y</ci>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<int></int>
<ci>S</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>y</ci>
</apply>
<apply>
<abs></abs>
<apply>
<divide></divide>
<apply>
<times></times>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<times></times>
<ci>d</ci>
<ci>y</ci>
</apply>
</apply>
</apply>
<ci>d</ci>
<ci>y</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \int_{S}p_{y}(y)~{}dy=\int_{S}p_{x}(\phi^{-1}(y))~{}\left|\frac{d\phi^{-1}}{dy%
}\right|~{}dy
  </annotation>
</semantics>
</math>
</p>

<p>so</p>

<p>
<math display="block" id="Integration_by_substitution:56">
<semantics>
<mrow>
<mrow>
<mrow>
<msub>
<mi>p</mi>
<mi>y</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo rspace="5.8pt" stretchy="false">)</mo>
</mrow>
<mrow>
<mo>|</mo>
<mfrac>
<mrow>
<mi>d</mi>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mrow>
<mrow>
<mi>d</mi>
<mi>y</mi>
</mrow>
</mfrac>
<mo>|</mo>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>y</ci>
</apply>
<ci>y</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>y</ci>
</apply>
<apply>
<abs></abs>
<apply>
<divide></divide>
<apply>
<times></times>
<ci>d</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<times></times>
<ci>d</ci>
<ci>y</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{y}(y)=p_{x}(\phi^{-1}(y))~{}\left|\frac{d\phi^{-1}}{dy}\right|.
  </annotation>
</semantics>
</math>
</p>

<p>In the case where 

<math display="inline" id="Integration_by_substitution:57">
<semantics>
<mi>X</mi>
<annotation-xml encoding="MathML-Content">
<ci>X</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   X
  </annotation>
</semantics>
</math>

 and 

<math display="inline" id="Integration_by_substitution:58">
<semantics>
<mi>Y</mi>
<annotation-xml encoding="MathML-Content">
<ci>Y</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   Y
  </annotation>
</semantics>
</math>

 depend on several uncorrelated variables, i.e. 

<math display="inline" id="Integration_by_substitution:59">
<semantics>
<mrow>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mo>=</mo>
<mrow>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msub>
<mi>x</mi>
<mn>1</mn>
</msub>
<mi mathvariant="normal">…</mi>
<msub>
<mi>x</mi>
<mi>n</mi>
</msub>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<cn type="integer">1</cn>
</apply>
<ci>normal-…</ci>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>x</ci>
<ci>n</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{x}=p_{x}(x_{1}\ldots x_{n})
  </annotation>
</semantics>
</math>

, and 

<math display="inline" id="Integration_by_substitution:60">
<semantics>
<mrow>
<mi>y</mi>
<mo>=</mo>
<mrow>
<mi>ϕ</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>y</ci>
<apply>
<times></times>
<ci>ϕ</ci>
<ci>x</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   y=\phi(x)
  </annotation>
</semantics>
</math>

, 

<math display="inline" id="Integration_by_substitution:61">
<semantics>
<msub>
<mi>p</mi>
<mi>y</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>y</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{y}
  </annotation>
</semantics>
</math>

 can be found by substitution in several variables discussed above. The result is</p>

<p>
<math display="block" id="Integration_by_substitution:62">
<semantics>
<mrow>
<mrow>
<mrow>
<msub>
<mi>p</mi>
<mi>y</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mi>p</mi>
<mi>x</mi>
</msub>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo rspace="5.8pt" stretchy="false">)</mo>
</mrow>
<mrow>
<mo>|</mo>
<mrow>
<mo movablelimits="false">det</mo>
<mrow>
<mo>[</mo>
<mrow>
<mi>D</mi>
<msup>
<mi>ϕ</mi>
<mrow>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mi>y</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>]</mo>
</mrow>
</mrow>
<mo>|</mo>
</mrow>
</mrow>
</mrow>
<mo>.</mo>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>y</ci>
</apply>
<ci>y</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>p</ci>
<ci>x</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>y</ci>
</apply>
<apply>
<abs></abs>
<apply>
<determinant></determinant>
<apply>
<csymbol cd="latexml">delimited-[]</csymbol>
<apply>
<times></times>
<ci>D</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>ϕ</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>y</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   p_{y}(y)=p_{x}(\phi^{-1}(y))~{}\left|\det\left[D\phi^{-1}(y)\right]\right|.
  </annotation>
</semantics>
</math>
</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Probability_density_function" title="wikilink">Probability density function</a></li>
<li><a href="Substitution_of_variables" title="wikilink">Substitution of variables</a></li>
<li><a href="Tangent_half-angle_substitution" title="wikilink">Tangent half-angle substitution</a></li>
<li><a href="Trigonometric_substitution" title="wikilink">Trigonometric substitution</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.encyclopediaofmath.org/index.php/Integration_by_substitution">Integration by substitution</a> at <a href="http://www.encyclopediaofmath.org/">Encyclopedia of Mathematics</a></li>
<li><a href="http://www.encyclopediaofmath.org/index.php/Area_formula">Area formula</a> at <a href="http://www.encyclopediaofmath.org/">Encyclopedia of Mathematics</a></li>
</ul>

<p><a href="es:Métodos_de_integración#Método_de_integración_por_sustitución" title="wikilink">es:Métodos de integración#Método de integración por sustitución</a>"</p>

<p><a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a> <a href="Category:Integral_calculus" title="wikilink">Category:Integral calculus</a></p>
</body>
</html>

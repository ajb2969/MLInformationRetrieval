   Time-dependent density functional theory      Time-dependent density functional theory   Time-dependent density functional theory ( TDDFT ) is a quantum mechanical theory used in physics and chemistry to investigate the properties and dynamics of many-body systems in the presence of time-dependent potentials, such as electric or magnetic fields. The effect of such fields on molecules and solids can be studied with TDDFT to extract features like excitation energies, frequency-dependent response properties, and photoabsorption spectra.  TDDFT is an extension of density functional theory (DFT), and the conceptual and computational foundations are analogous – to show that the (time-dependent) wave function is equivalent to the (time-dependent) electronic density , and then to derive the effective potential of a fictitious non-interacting system which returns the same density as any given interacting system. The issue of constructing such a system is more complex for TDDFT, most notably because the time-dependent effective potential at any given instant depends on value of the density at all previous times. Consequently the development of time-dependent approximations for the implementation of TDDFT is behind that of DFT, with applications routinely ignoring this memory requirement.  Overview  The formal foundation of TDDFT is the Runge-Gross ( RG ) theorem (1984) 1 – the time-dependent analogue of the Hohenberg-Kohn (HK) theorem (1964). 2 The RG theorem shows that, for a given initial wavefunction, there is a unique mapping between the time-dependent external potential of a system and its time-dependent density. This implies that the many-body wavefunction, depending upon 3 N variables, is equivalent to the density, which depends upon only 3, and that all properties of a system can thus be determined from knowledge of the density alone. Unlike in DFT, there is no general minimization principle in time-dependent quantum mechanics. Consequently the proof of the RG theorem is more involved than the HK theorem.  Given the RG theorem, the next step in developing a computationally useful method is to determine the fictitious non-interacting system which has the same density as the physical (interacting) system of interest. As in DFT, this is called the (time-dependent) Kohn-Sham system. This system is formally found as the stationary point of an action functional defined in the Keldysh formalism . 3  The most popular application of TDDFT is in the calculation of the energies of excited states of isolated systems and, less commonly, solids. Such calculations are based on the fact that the linear response function – that is, how the electron density changes when the external potential changes – has poles at the exact excitation energies of a system. Such calculations require, in addition to the exchange-correlation potential, the exchange-correlation kernel – the functional derivative of the exchange-correlation potential with respect to the density. 4 5  Formalism  Runge-Gross theorem  The approach of Runge and Gross considers a single-component system in the presence of a time-dependent scalar field for which the Hamiltonian takes the form         H  ^    (  t  )    =    T  ^   +     V  ^   ext    (  t  )    +   W  ^     ,         normal-^  H   t      normal-^  T      subscript   normal-^  V   ext   t    normal-^  W      \hat{H}(t)=\hat{T}+\hat{V}_{\mathrm{ext}}(t)+\hat{W},     where T is the kinetic energy operator, W the electron-electron interaction, and V ext ( t ) the external potential which along with the number of electrons defines the system. Nominally, the external potential contains the electrons' interaction with the nuclei of the system. For non-trivial time-dependence, an additional explicitly time-dependent potential is present which can arise, for example, from a time-dependent electric or magnetic field. The many-body wavefunction evolves according to the time-dependent Schrödinger equation under a single initial condition ,          H  ^    (  t  )    |   Ψ   (  t  )    ⟩    =   i  ℏ   ∂   ∂  t     |   Ψ   (  t  )    ⟩     ,    |   Ψ   (  0  )    ⟩   =   |  Ψ  ⟩     .     formulae-sequence       normal-^  H   t   ket    normal-Ψ  t       i  Planck-constant-over-2-pi       t     ket    normal-Ψ  t         ket    normal-Ψ  0     ket  normal-Ψ      \hat{H}(t)|\Psi(t)\rangle=i\hbar\frac{\partial}{\partial t}|\Psi(t)\rangle,\ %
 \ \ |\Psi(0)\rangle=|\Psi\rangle.     Employing the Schrödinger equation as its starting point, the Runge-Gross theorem shows that at any time, the density uniquely determines the external potential. This is done in two steps:   Assuming that the external potential can be expanded in a Taylor series about a given time, it is shown that two external potentials differing by more than an additive constant generate different current densities .  Employing the continuity equation , it is then shown that for finite systems, different current densities correspond to different electron densities.   Time-dependent Kohn-Sham system  For a given interaction potential, the RG theorem shows that the external potential uniquely determines the density. The Kohn-Sham approaches chooses a non-interacting system (that for which the interaction potential is zero) in which to form the density that is equal to the interacting system. The advantage of doing so lies in the ease in which non-interacting systems can be solved – the wave function of a non-interacting system can be represented as a Slater determinant of single-particle orbitals , each of which are determined by a single partial differential equation in three variable – and that the kinetic energy of a non-interacting system can be expressed exactly in terms of those orbitals. The problem is thus to determine a potential, denoted as v s ( r , t ) or v KS ( r , t ), that determines a non-interacting Hamiltonian, H s ,          H  ^   s    (  t  )    =    T  ^   +     V  ^   s    (  t  )      ,         subscript   normal-^  H   s   t      normal-^  T      subscript   normal-^  V   s   t      \hat{H}_{s}(t)=\hat{T}+\hat{V}_{s}(t),     which in turn determines a determinantal wave function           H  ^   s    (  t  )    |   Φ   (  t  )    ⟩    =   i   ∂   ∂  t     |   Φ   (  t  )    ⟩     ,    |   Φ   (  0  )    ⟩   =   |  Φ  ⟩     ,     formulae-sequence       subscript   normal-^  H   s   t   ket    normal-Φ  t       i       t     ket    normal-Φ  t         ket    normal-Φ  0     ket  normal-Φ      \hat{H}_{s}(t)|\Phi(t)\rangle=i\frac{\partial}{\partial t}|\Phi(t)\rangle,\ \ %
 \ |\Phi(0)\rangle=|\Phi\rangle,     which is constructed in terms of a set of N orbitals which obey the equation,          (    -    1  2    ∇  2     +    v  s    (  𝐫  ,  t  )     )    ϕ  i    (  𝐫  ,  t  )    =   i   ∂   ∂  t     ϕ  i    (  𝐫  ,  t  )        ϕ  i    (  𝐫  ,  0  )    =    ϕ  i    (  𝐫  )      ,     formulae-sequence              1  2    superscript  normal-∇  2        subscript  v  s    𝐫  t      subscript  ϕ  i    𝐫  t      i       t     subscript  ϕ  i    𝐫  t          subscript  ϕ  i    𝐫  0       subscript  ϕ  i   𝐫      \left(-\frac{1}{2}\nabla^{2}+v_{s}(\mathbf{r},t)\right)\phi_{i}(\mathbf{r},t)=%
 i\frac{\partial}{\partial t}\phi_{i}(\mathbf{r},t)\ \ \ \phi_{i}(\mathbf{r},0)%
 =\phi_{i}(\mathbf{r}),     and generate a time-dependent density         ρ  s    (  𝐫  ,  t  )    =    ∑   i  =  1   N     |    ϕ  i    (  𝐫  ,  t  )    |   2     ,         subscript  ρ  s    𝐫  t      superscript   subscript     i  1    N    superscript       subscript  ϕ  i    𝐫  t     2      \rho_{s}(\mathbf{r},t)=\sum_{i=1}^{N}|\phi_{i}(\mathbf{r},t)|^{2},     such that ρ s is equal to the density of the interacting system at all times:         ρ  s    (  𝐫  ,  t  )    =   ρ   (  𝐫  ,  t  )     .         subscript  ρ  s    𝐫  t      ρ   𝐫  t      \rho_{s}(\mathbf{r},t)=\rho(\mathbf{r},t).     If the potential v s ( r , t ) can be determined, or at the least well-approximated, then the original Schrödinger equation, a single partial differential equation in 3 N variables, has been replaced by N differential equations in 3 dimensions, each differing only in the initial condition.  The problem of determining approximations to the Kohn-Sham potential is challenging. Analogously to DFT, the time-dependent KS potential is decomposed to extract the external potential of the system and the time-dependent Coulomb interaction, v J . The remaining component is the exchange-correlation potential:         v  s    (  𝐫  ,  t  )    =     v  ext    (  𝐫  ,  t  )    +    v  J    (  𝐫  ,  t  )    +    v  xc    (  𝐫  ,  t  )      .         subscript  v  s    𝐫  t         subscript  v  ext    𝐫  t       subscript  v  J    𝐫  t       subscript  v  xc    𝐫  t       v_{s}(\mathbf{r},t)=v_{\rm ext}(\mathbf{r},t)+v_{J}(\mathbf{r},t)+v_{\rm xc}(%
 \mathbf{r},t).\,     In their seminal paper, Runge and Gross approached the definition of the KS potential through an action-based argument starting from the Dirac action        A   [  Ψ  ]    =   ∫   d   t    ⟨   Ψ   (  t  )    |   H  -   i   ∂   ∂  t      |   Ψ   (  t  )    ⟩      .        A   delimited-[]  normal-Ψ        normal-d  t   quantum-operator-product    normal-Ψ  t     H    i       t        normal-Ψ  t        A[\Psi]=\int\mathrm{d}t\ \langle\Psi(t)|H-i\frac{\partial}{\partial t}|\Psi(t)\rangle.     Treated as a functional of the wave function, A [Ψ], variations of the wave function yield the many-body Schrödinger equation as the stationary point. Given the unique mapping between densities and wave function, Runge and Gross then treated the Dirac action as a density functional,        A   [  ρ  ]    =   A   [   Ψ   [  ρ  ]    ]     ,        A   delimited-[]  ρ      A   delimited-[]    normal-Ψ   delimited-[]  ρ        A[\rho]=A[\Psi[\rho]],\,     and derived a formal expression for the exchange-correlation component of the action, which determines the exchange-correlation potential by functional differentiation. Later it was observed that an approach based on the Dirac action yields paradoxical conclusions when considering the causality of the response functions it generates. 6 The density response function, the functional derivative of the density with respect to the external potential, should be causal: a change in the potential at a given time can not affect the density at earlier times. The response functions from the Dirac action however are symmetric in time so lack the required causal structure. An approach which does not suffer from this issue was later introduced with through an action based on the Keldysh formalism of complex-time path integration.  Linear response TDDFT  Linear-response TDDFT can be used if the external perturbation is small in the sense that it does not completely destroy the ground-state structure of the system. In this case one can analyze the linear response of the system. This is a great advantage as, to first order, the variation of the system will depend only on the ground-state wave-function so that we can simply use all the properties of DFT.  Consider a small time-dependent external perturbation    δ   V   e  x  t     (  t  )       δ   superscript  V    e  x  t    t    \delta V^{ext}(t)   . This gives        H  ′    (  t  )    =   H  +   δ   V   e  x  t     (  t  )            superscript  H  normal-′   t     H    δ   superscript  V    e  x  t    t      H^{\prime}(t)=H+\delta V^{ext}(t)           H   K  S   ′    [  ρ  ]    (  t  )    =     H   K  S     [  ρ  ]    +   δ   V  H    [  ρ  ]    (  t  )    +   δ   V   x  c     [  ρ  ]    (  t  )    +   δ   V   e  x  t     (  t  )            subscript   superscript  H  normal-′     K  S     delimited-[]  ρ   t        subscript  H    K  S     delimited-[]  ρ      δ   subscript  V  H    delimited-[]  ρ   t     δ   subscript  V    x  c     delimited-[]  ρ   t     δ   superscript  V    e  x  t    t      H^{\prime}_{KS}[\rho](t)=H_{KS}[\rho]+\delta V_{H}[\rho](t)+\delta V_{xc}[\rho%
 ](t)+\delta V^{ext}(t)   and looking at the linear response of the density       δ  ρ   (   𝐫  t   )    =   χ   (   𝐫  t   ,    𝐫  ′    t  ′    )   δ   V   e  x  t     (    𝐫  ′    t  ′    )          δ  ρ    𝐫  t      χ     𝐫  t      superscript  𝐫  normal-′    superscript  t  normal-′     δ   superscript  V    e  x  t       superscript  𝐫  normal-′    superscript  t  normal-′       \delta\rho(\mathbf{r}t)=\chi(\mathbf{r}t,\mathbf{r^{\prime}}t^{\prime})\delta V%
 ^{ext}(\mathbf{r^{\prime}}t^{\prime})          δ  ρ   (   𝐫  t   )    =    χ   K  S     (   𝐫  t   ,    𝐫  ′    t  ′    )   δ   V   e  f  f     [  ρ  ]    (    𝐫  ′    t  ′    )          δ  ρ    𝐫  t       subscript  χ    K  S       𝐫  t      superscript  𝐫  normal-′    superscript  t  normal-′     δ   superscript  V    e  f  f     delimited-[]  ρ      superscript  𝐫  normal-′    superscript  t  normal-′       \delta\rho(\mathbf{r}t)=\chi_{KS}(\mathbf{r}t,\mathbf{r^{\prime}}t^{\prime})%
 \delta V^{eff}[\rho](\mathbf{r^{\prime}}t^{\prime})   where     δ   V   e  f  f     [  ρ  ]    (  t  )    =    δ   V   e  x  t     (  t  )    +   δ   V  H    [  ρ  ]    (  t  )    +   δ   V   x  c     [  ρ  ]    (  t  )           δ   superscript  V    e  f  f     delimited-[]  ρ   t       δ   superscript  V    e  x  t    t     δ   subscript  V  H    delimited-[]  ρ   t     δ   subscript  V    x  c     delimited-[]  ρ   t      \delta V^{eff}[\rho](t)=\delta V^{ext}(t)+\delta V_{H}[\rho](t)+\delta V_{xc}[%
 \rho](t)   Here and in the following it is assumed that primed variables are integrated.  Within the linear-response domain, the variation of the Hartree (H) and the exchange-correlation (xc) potential to linear order may be expanded with respect to the density variation       δ   V  H    [  ρ  ]    (  𝐫  )    =     δ   V  H    [  ρ  ]     δ  ρ    δ  ρ   =    1   |   𝐫  -   𝐫  ′    |    δ  ρ   (   𝐫  ′   )            δ   subscript  V  H    delimited-[]  ρ   𝐫         δ   subscript  V  H    delimited-[]  ρ      δ  ρ    δ  ρ            1      𝐫   superscript  𝐫  normal-′      δ  ρ   superscript  𝐫  normal-′       \delta V_{H}[\rho](\mathbf{r})=\frac{\delta V_{H}[\rho]}{\delta\rho}\delta\rho%
 =\frac{1}{|\mathbf{r}-\mathbf{r^{\prime}}|}\delta\rho(\mathbf{r^{\prime}})   and       δ   V   x  c     [  ρ  ]    (  𝐫  )    =     δ   V   x  c     [  ρ  ]     δ  ρ    δ  ρ   =    f   x  c     (   𝐫  t   ,    𝐫  ′    t  ′    )   δ  ρ   (   𝐫  ′   )            δ   subscript  V    x  c     delimited-[]  ρ   𝐫         δ   subscript  V    x  c     delimited-[]  ρ      δ  ρ    δ  ρ           subscript  f    x  c       𝐫  t      superscript  𝐫  normal-′    superscript  t  normal-′     δ  ρ   superscript  𝐫  normal-′       \delta V_{xc}[\rho](\mathbf{r})=\frac{\delta V_{xc}[\rho]}{\delta\rho}\delta%
 \rho=f_{xc}(\mathbf{r}t,\mathbf{r^{\prime}}t^{\prime})\delta\rho(\mathbf{r^{%
 \prime}})   Finally, inserting this relation in the response equation for the KS system and comparing the resultant equation with the response equation for the physical system yields the Dyson equation of TDDFT:       χ   (    𝐫  1    t  1    ,    𝐫  2    t  2    )    =     χ   K  S     (    𝐫  𝟏    t  1    ,    𝐫  2    t  2    )    +    χ   K  S     (    𝐫  𝟏    t  1    ,    𝐫  2  ′    t  2  ′    )    (    1   |    𝐫  2  ′   -   𝐫  1  ′    |    +    f   x  c     (    𝐫  2  ′    t  2  ′    ,    𝐫  1  ′    t  1  ′    )     )   χ   (    𝐫  1  ′    t  1  ′    ,    𝐫  2    t  2    )           χ      subscript  𝐫  1    subscript  t  1       subscript  𝐫  2    subscript  t  2           subscript  χ    K  S        subscript  𝐫  1    subscript  t  1       subscript  𝐫  2    subscript  t  2         subscript  χ    K  S        subscript  𝐫  1    subscript  t  1       superscript   subscript  𝐫  2   normal-′    superscript   subscript  t  2   normal-′         1       superscript   subscript  𝐫  2   normal-′    superscript   subscript  𝐫  1   normal-′         subscript  f    x  c        superscript   subscript  𝐫  2   normal-′    superscript   subscript  t  2   normal-′       superscript   subscript  𝐫  1   normal-′    superscript   subscript  t  1   normal-′       χ      superscript   subscript  𝐫  1   normal-′    superscript   subscript  t  1   normal-′       subscript  𝐫  2    subscript  t  2         \chi(\mathbf{r}_{1}t_{1},\mathbf{r}_{2}t_{2})=\chi_{KS}(\mathbf{r_{1}}t_{1},%
 \mathbf{r}_{2}t_{2})+\chi_{KS}(\mathbf{r_{1}}t_{1},\mathbf{r}_{2}^{\prime}t_{2%
 }^{\prime})\left(\frac{1}{|\mathbf{r}_{2}^{\prime}-\mathbf{r}_{1}^{\prime}|}+f%
 _{xc}(\mathbf{r}_{2}^{\prime}t_{2}^{\prime},\mathbf{r}_{1}^{\prime}t_{1}^{%
 \prime})\right)\chi(\mathbf{r}_{1}^{\prime}t_{1}^{\prime},\mathbf{r}_{2}t_{2})     From this last equation it is possible to derive the excitation energies of the system, as these are simply the poles of the response function.  Other linear-response approaches include the Casida formalism (an expansion in electron-hole pairs) and the Sternheimer equation (density-functional perturbation theory).  Key papers      Books on TDDFT     TDDFT codes   Firefly  GAMESS-US  Gaussian  Amsterdam Density Functional  CP2K  Dalton  NWChem  Octopus  pw-teleman library  PARSEC  Q-Chem  Spartan  TeraChem  TURBOMOLE  YAMBO code  ORCA  Jaguar  GPAW   References  External links   tddft.org  Brief introduction of TD-DFT   "  Category:Density functional theory  Category:Computational chemistry  Category:Computational physics  Category:Quantum chemistry  Category:Theoretical chemistry     ↩  ↩  ↩  ↩  ↩  ↩     
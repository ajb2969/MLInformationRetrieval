<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="934">First class constraint</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>First class constraint</h1>
<hr/>

<p>In a constrained Hamiltonian system, a dynamical quantity is called a <strong>first class constraint</strong> if its Poisson bracket with all the other constraints vanishes on the <strong>constraint surface</strong> (the surface implicitly defined by the simultaneous vanishing of all the constraints). A <strong>second class constraint</strong> is one that is not first class.</p>

<p>First and second class constraints were introduced by  as a way of quantizing mechanical systems such as gauge theories where the symplectic form is degenerate.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>The terminology of first and second class constraints is confusingly similar to that of <a href="primary_constraint" title="wikilink">primary and secondary constraints</a>. These divisions are independent: both first and second class constraints can be either primary or secondary, so this gives altogether four different classes of constraints.</p>
<h2 id="poisson-brackets">Poisson brackets</h2>

<p>In <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>, consider a <a href="symplectic_manifold" title="wikilink">symplectic manifold</a> <em>M</em> with a <a href="smooth_function" title="wikilink">smooth</a> Hamiltonian over it (for field theories, <em>M</em> would be infinite-dimensional).</p>

<p>Suppose we have some constraints</p>

<p>

<math display="block" id="First_class_constraint:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{i}(x)=0,
  </annotation>
 </semantics>
</math>

 for <em>n</em> smooth functions</p>

<p>

<math display="block" id="First_class_constraint:1">
 <semantics>
  <msubsup>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>f</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mi>n</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>i</ci>
      </apply>
     </set>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{i}\}_{i=1}^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>These will only be defined <a href="chart_(topology)" title="wikilink">chartwise</a> in general. Suppose that everywhere on the constrained set, the <em>n</em> derivatives of the <em>n</em> functions are all <a href="linearly_independent" title="wikilink">linearly independent</a> and also that the <a href="Poisson_bracket" title="wikilink">Poisson brackets</a></p>

<p>

<math display="block" id="First_class_constraint:2">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>f</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>f</mi>
    <mi>j</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>j</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{i},f_{j}\}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="First_class_constraint:3">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>f</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <mi>H</mi>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>i</ci>
    </apply>
    <ci>H</ci>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{i},H\}
  </annotation>
 </semantics>
</math>

</p>

<p>all vanish on the constrained subspace. This means we can write</p>

<p>

<math display="block" id="First_class_constraint:4">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>f</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>f</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>k</mi>
    </munder>
    <mrow>
     <msubsup>
      <mi>c</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
      <mi>k</mi>
     </msubsup>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>j</ci>
     </apply>
    </set>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{i},f_{j}\}=\sum_{k}c_{ij}^{k}f_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>for some smooth functions</p>

<p>

<math display="block" id="First_class_constraint:5">
 <semantics>
  <msubsup>
   <mi>c</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{ij}^{k}
  </annotation>
 </semantics>
</math>

</p>

<p>(there is a theorem showing this) and</p>

<p>

<math display="block" id="First_class_constraint:6">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>f</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <mi>H</mi>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>j</mi>
    </munder>
    <mrow>
     <msubsup>
      <mi>v</mi>
      <mi>i</mi>
      <mi>j</mi>
     </msubsup>
     <msub>
      <mi>f</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
     <ci>H</ci>
    </set>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <ci>i</ci>
       </apply>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{i},H\}=\sum_{j}v_{i}^{j}f_{j}
  </annotation>
 </semantics>
</math>

</p>

<p>for some smooth functions</p>

<p>

<math display="block" id="First_class_constraint:7">
 <semantics>
  <msubsup>
   <mi>v</mi>
   <mi>i</mi>
   <mi>j</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <ci>i</ci>
    </apply>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i}^{j}
  </annotation>
 </semantics>
</math>

.</p>

<p>This can be done globally, using a <a href="partition_of_unity" title="wikilink">partition of unity</a>. Then, we say we have an irreducible <strong>first-class constraint</strong> (<em>irreducible</em> here is in a different sense from that used in <a href="representation_theory" title="wikilink">representation theory</a>).</p>
<h2 id="geometric-theory">Geometric theory</h2>

<p>For a more elegant way, suppose given a <a href="vector_bundle" title="wikilink">vector bundle</a> over M, with <em>n</em>-dimensional <a class="uri" href="fiber" title="wikilink">fiber</a> <em>V</em>. Equip this vector bundle with a <a href="connection_form" title="wikilink">connection</a>. Suppose too we have a <a href="smooth_section" title="wikilink">smooth section</a> <em>f</em> of this bundle.</p>

<p>Then the <a href="covariant_derivative" title="wikilink">covariant derivative</a> of <em>f</em> with respect to the connection is a smooth <a href="linear_map" title="wikilink">linear map</a> Δ<em>f</em> from the <a href="tangent_bundle" title="wikilink">tangent bundle</a> <em>TM</em> to <em>V</em>, which preserves the <a href="base_point" title="wikilink">base point</a>. Assume this linear map is right <a class="uri" href="invertible" title="wikilink">invertible</a> (i.e. there exists a linear map <em>g</em> such that (Δ<em>f</em>)<em>g</em> is the <a href="identity_function" title="wikilink">identity map</a>) for all the fibers at the zeros of <em>f</em>. Then, according to the <a href="implicit_function_theorem" title="wikilink">implicit function theorem</a>, the subspace of zeros of <em>f</em> is a <a class="uri" href="submanifold" title="wikilink">submanifold</a>.</p>

<p>The ordinary <a href="Poisson_bracket" title="wikilink">Poisson bracket</a> is only defined over 

<math display="inline" id="First_class_constraint:8">
 <semantics>
  <mrow>
   <msup>
    <mi>C</mi>
    <mi mathvariant="normal">∞</mi>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>M</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>C</ci>
     <infinity></infinity>
    </apply>
    <ci>M</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C^{\infty}(M)
  </annotation>
 </semantics>
</math>

, the space of smooth functions over <em>M</em>. However, using the connection, we can extend it to the space of smooth sections of <em>f</em> if we work with the <a href="algebra_bundle" title="wikilink">algebra bundle</a> with the <a href="graded_algebra" title="wikilink">graded algebra</a> of <em>V</em>-tensors as fibers. Assume also that under this Poisson bracket,</p>
<dl>
<dd>{ <em>f</em>, <em>f</em> } = 0
</dd>
</dl>

<p>(note that it's not true that</p>
<dl>
<dd>{ <em>g</em>, <em>g</em> } = 0
</dd>
</dl>

<p>in general for this "extended Poisson bracket" anymore) and</p>
<dl>
<dd>{ <em>f</em>, <em>H</em> } = 0
</dd>
</dl>

<p>on the submanifold of zeros of <em>f</em> (If these brackets also happen to be zero everywhere, then we say the constraints close <a href="off_shell" title="wikilink">off shell</a>). It turns out the right invertibility condition and the commutativity of flows conditions are <em>independent</em> of the choice of connection. So, we can drop the connection provided we are working solely with the restricted subspace.</p>
<h2 id="intuitive-meaning">Intuitive meaning</h2>

<p>What does it all mean intuitively? It means the Hamiltonian and constraint flows all commute with each other <strong>on</strong> the constrained subspace; or alternatively, that if we start on a point on the constrained subspace, then the Hamiltonian and constraint flows all bring the point to another point on the constrained subspace.</p>

<p>Since we wish to restrict ourselves to the constrained subspace only, this suggests that the Hamiltonian, or any other physical <a class="uri" href="observable" title="wikilink">observable</a>, should only be defined on that subspace. Equivalently, we can look at the <a href="equivalence_class" title="wikilink">equivalence class</a> of smooth functions over the symplectic manifold, which agree on the constrained subspace (the <a href="quotient_algebra" title="wikilink">quotient algebra</a> by the <a href="Ideal_(ring_theory)" title="wikilink">ideal</a> generated by the <em>f</em>'s, in other words).</p>

<p>The catch is, the Hamiltonian flows on the constrained subspace depend on the gradient of the Hamiltonian there, not its value. But there's an easy way out of this.</p>

<p>Look at the <a href="orbit_(group_theory)" title="wikilink">orbits</a> of the constrained subspace under the action of the <a href="symplectic_flow" title="wikilink">symplectic flows</a> generated by the <em>f</em>'s. This gives a local <a class="uri" href="foliation" title="wikilink">foliation</a> of the subspace because it satisfies <a href="integrability_condition" title="wikilink">integrability conditions</a> (<a href="Frobenius_theorem_(differential_topology)" title="wikilink">Frobenius theorem</a>). It turns out if we start with two different points on a same orbit on the constrained subspace and evolve both of them under two different Hamiltonians, respectively, which agree on the constrained subspace, then the time evolution of both points under their respective Hamiltonian flows will always lie in the same orbit at equal times. It also turns out if we have two smooth functions <em>A</em><sub>1</sub> and <em>B</em><sub>1</sub>, which are constant over orbits at least on the constrained subspace (i.e. physical observables) (i.e. {A<sub>1</sub>,f}={B<sub>1</sub>,f}=0 over the constrained subspace)and another two A<sub>2</sub> and B<sub>2</sub>, which are also constant over orbits such that A<sub>1</sub> and B<sub>1</sub> agrees with A<sub>2</sub> and B<sub>2</sub> respectively over the restrained subspace, then their Poisson brackets {A<sub>1</sub>, B<sub>1</sub>} and {A<sub>2</sub>, B<sub>2</sub>} are also constant over orbits and agree over the constrained subspace.</p>

<p>In general, one cannot rule out "<a class="uri" href="ergodic" title="wikilink">ergodic</a>" flows (which basically means that an orbit is dense in some open set), or "subergodic" flows (which an orbit dense in some submanifold of dimension greater than the orbit's dimension). We can't have <a class="uri" href="self-intersecting" title="wikilink">self-intersecting</a> orbits.</p>

<p>For most "practical" applications of first-class constraints, we do not see such complications: the <a href="Quotient_space_(topology)" title="wikilink">quotient space</a> of the restricted subspace by the f-flows (in other words, the orbit space) is well behaved enough to act as a <a href="differentiable_manifold" title="wikilink">differentiable manifold</a>, which can be turned into a <a href="symplectic_manifold" title="wikilink">symplectic manifold</a> by projecting the <a href="symplectic_form" title="wikilink">symplectic form</a> of M onto it (this can be shown to be <a href="well_defined" title="wikilink">well defined</a>). In light of the observation about physical observables mentioned earlier, we can work with this more "physical" smaller symplectic manifold, but with 2n fewer dimensions.</p>

<p>In general, the quotient space is a bit "nasty" to work with when doing concrete calculations (not to mention nonlocal when working with <a href="diffeomorphism_constraint" title="wikilink">diffeomorphism constraints</a>), so what is usually done instead is something similar. Note that the restricted submanifold is a <a href="Bundle_(mathematics)" title="wikilink">bundle</a> (but not a <a href="fiber_bundle" title="wikilink">fiber bundle</a> in general) over the quotient manifold. So, instead of working with the quotient manifold, we can work with a <a href="Section_(category_theory)" title="wikilink">section</a> of the bundle instead. This is called <a href="gauge_fixing" title="wikilink">gauge fixing</a>.</p>

<p>The <em>major</em> problem is this bundle might not have a <a href="global_section" title="wikilink">global section</a> in general. This is where the "problem" of <a href="global_anomaly" title="wikilink">global anomalies</a> comes in, for example. See <a href="Gribov_ambiguity" title="wikilink">Gribov ambiguity</a>. This is a flaw in quantizing <a href="gauge_theory" title="wikilink">gauge theories</a> many physicists overlooked.</p>

<p>What have been described are irreducible first-class constraints. Another complication is that Δf might not be <a href="right_invertible" title="wikilink">right invertible</a> on subspaces of the restricted submanifold of <a class="uri" href="codimension" title="wikilink">codimension</a> 1 or greater (which violates the stronger assumption stated earlier in this article). This happens, for example in the <a class="uri" href="cotetrad" title="wikilink">cotetrad</a> formulation of <a href="general_relativity" title="wikilink">general relativity</a>, at the subspace of configurations where the <a href="cotetrad_field" title="wikilink">cotetrad field</a> and the <a href="connection_form" title="wikilink">connection form</a> happen to be zero over some open subset of space. Here, the constraints are the diffeomorphism constraints.</p>

<p>One way to get around this is this: For reducible constraints, we relax the condition on the right invertibility of Δ<em>f</em> into this one: Any smooth function that vanishes at the zeros of <em>f</em> is the fiberwise contraction of <em>f</em> with (a non-unique) smooth section of a 

<math display="inline" id="First_class_constraint:9">
 <semantics>
  <mover accent="true">
   <mi>V</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{V}
  </annotation>
 </semantics>
</math>

-vector bundle where 

<math display="inline" id="First_class_constraint:10">
 <semantics>
  <mover accent="true">
   <mi>V</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>V</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{V}
  </annotation>
 </semantics>
</math>

 is the <a href="dual_vector_space" title="wikilink">dual vector space</a> to the constraint vector space <em>V</em>. This is called the <em>regularity condition</em>.</p>
<h2 id="constrained-hamiltonian-dynamics-from-a-lagrangian-gauge-theory">Constrained Hamiltonian dynamics from a Lagrangian gauge theory</h2>

<p>First of all, we will assume the <a href="action_(physics)" title="wikilink">action</a> is the integral of a local <a class="uri" href="Lagrangian" title="wikilink">Lagrangian</a> that only depends up to the first derivative of the fields. The analysis of more general cases, while possible is more complicated. When going over to the Hamiltonian formalism, we find there are constraints. Recall that in the action formalism, there are <a href="on_shell" title="wikilink">on shell</a> and <a href="off_shell" title="wikilink">off shell</a> configurations. The constraints that hold off shell are called primary constraints while those that only hold on shell are called secondary constraints.</p>
<h2 id="examples">Examples</h2>

<p>Look at the dynamics of a single point particle of mass <em>m</em> with no internal degrees of freedom moving in a <a class="uri" href="pseudo-Riemannian" title="wikilink">pseudo-Riemannian</a> spacetime manifold <em>S</em> with <a href="metric_tensor" title="wikilink">metric</a> <strong>g</strong>. Assume also that the parameter τ describing the trajectory of the particle is arbitrary (i.e. we insist upon <a href="Parametric_curve#Reparametrization_and_equivalence_relation" title="wikilink">reparametrization invariance</a>). Then, its <a href="symplectic_space" title="wikilink">symplectic space</a> is the <a href="cotangent_bundle" title="wikilink">cotangent bundle</a> T*S with the canonical symplectic form ω. If we coordinatize <em>T</em> * <em>S</em> by its position <em>x</em> in the base manifold <em>S</em> and its position within the cotangent space <strong>p</strong>, then we have a constraint</p>
<dl>
<dd><em>f</em> = <em>m</em><sup>2</sup> −<strong>g</strong>(<em>x</em>)<sup>−1</sup>(<strong>p</strong>,<strong>p</strong>) = 0.
</dd>
</dl>

<p>The Hamiltonian <em>H</em> is, surprisingly enough, <em>H</em> = 0. In light of the observation that the Hamiltonian is only defined up to the equivalence class of smooth functions agreeing on the constrained subspace, we can use a new Hamiltonian H'=f instead. Then, we have the interesting case where the Hamiltonian is the same as a constraint! See <a href="Hamiltonian_constraint" title="wikilink">Hamiltonian constraint</a> for more details.</p>

<p>Consider now the case of a <a href="Yang–Mills_theory" title="wikilink">Yang–Mills theory</a> for a real <a href="simple_Lie_algebra" title="wikilink">simple Lie algebra</a> <em>L</em> (with a <a href="negative_definite" title="wikilink">negative definite</a> <a href="Killing_form" title="wikilink">Killing form</a> η) <a href="minimally_coupled" title="wikilink">minimally coupled</a> to a real scalar field σ, which transforms as an <a href="orthogonal_representation" title="wikilink">orthogonal representation</a> ρ with the underlying vector space <em>V</em> under <em>L</em> in (<em>d</em> − 1) + 1 <a href="Minkowski_spacetime" title="wikilink">Minkowski spacetime</a>. For l in <em>L</em>, we write</p>
<dl>
<dd>ρ(l)[σ]
</dd>
</dl>

<p>as</p>
<dl>
<dd>l[σ]
</dd>
</dl>

<p>for simplicity. Let <strong>A</strong> be the <em>L</em>-valued <a href="connection_form" title="wikilink">connection form</a> of the theory. Note that the <strong>A</strong> here differs from the <strong>A</strong> used by physicists by a factor of <em>i</em> and "g". This agrees with the mathematician's convention. The action <em>S</em> is given by</p>

<p>

<math display="block" id="First_class_constraint:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>𝔸</mi>
     <mo>,</mo>
     <mi>σ</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <msup>
       <mi>d</mi>
       <mi>d</mi>
      </msup>
      <mi>x</mi>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>4</mn>
        <msup>
         <mi>g</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msup>
           <mi>𝕘</mi>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mo>⊗</mo>
          <msup>
           <mi>𝕘</mi>
           <mrow>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>𝔽</mi>
         <mo>,</mo>
         <mi>𝔽</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>α</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝕘</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>D</mi>
         <mi>σ</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>D</mi>
         <mi>σ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <interval closure="closed">
      <ci>𝔸</ci>
      <ci>σ</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <ci>d</ci>
       </apply>
       <ci>x</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>η</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">tensor-product</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝕘</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝕘</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <interval closure="open">
         <ci>𝔽</ci>
         <ci>𝔽</ci>
        </interval>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>α</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝕘</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <interval closure="open">
        <apply>
         <times></times>
         <ci>D</ci>
         <ci>σ</ci>
        </apply>
        <apply>
         <times></times>
         <ci>D</ci>
         <ci>σ</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S[\mathbb{A},\sigma]=\int d^{d}x\frac{1}{4g^{2}}\eta((\mathbb{g}^{-1}\otimes%
\mathbb{g}^{-1})(\mathbb{F},\mathbb{F}))+\frac{1}{2}\alpha(\mathbb{g}^{-1}(D%
\sigma,D\sigma))
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>g</strong> is the Minkowski metric, <strong>F</strong> is the <a href="curvature_form" title="wikilink">curvature form</a></p>

<p>

<math display="block" id="First_class_constraint:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mi>𝔸</mi>
    </mrow>
    <mo>+</mo>
    <mi>𝔸</mi>
   </mrow>
   <mo>∧</mo>
   <mi>𝔸</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>𝔸</ci>
     </apply>
     <ci>𝔸</ci>
    </apply>
    <ci>𝔸</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\mathbb{A}+\mathbb{A}\wedge\mathbb{A}
  </annotation>
 </semantics>
</math>

</p>

<p>(no <em>i</em>s or <em>g</em>s!) where the second term is a formal shorthand for pretending the Lie bracket is a commutator, <em>D</em> is the covariant derivative</p>
<dl>
<dd>Dσ = dσ − <strong>A</strong>[σ]
</dd>
</dl>

<p>and α is the orthogonal form for ρ.</p>

<p><em>I hope I have all the signs and factors right. I can't guarantee it.</em></p>

<p>What is the Hamiltonian version of this model? Well, first, we have to split <strong>A</strong> noncovariantly into a time component φ and a spatial part 

<math display="inline" id="First_class_constraint:13">
 <semantics>
  <mover accent="true">
   <mi>A</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{A}
  </annotation>
 </semantics>
</math>

. Then, the resulting symplectic space has the conjugate variables σ, π<sub>σ</sub> (taking values in the underlying vector space of 

<math display="inline" id="First_class_constraint:14">
 <semantics>
  <mover accent="true">
   <mi>ρ</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>ρ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\rho}
  </annotation>
 </semantics>
</math>

, the dual rep of ρ), 

<math display="inline" id="First_class_constraint:15">
 <semantics>
  <mover accent="true">
   <mi>A</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{A}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="First_class_constraint:16">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>π</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mi>A</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>π</ci>
    </apply>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{\pi}_{A}
  </annotation>
 </semantics>
</math>

, φ and π<sub>φ</sub>. for each spatial point, we have the constraints, π<sub>φ</sub>=0 and the <a href="Gaussian_constraint" title="wikilink">Gaussian constraint</a></p>

<p>

<math display="block" id="First_class_constraint:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>D</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>⋅</mo>
     <msub>
      <mover accent="true">
       <mi>π</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>A</mi>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>ρ</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>π</mi>
       <mi>σ</mi>
      </msub>
      <mo>,</mo>
      <mi>σ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>D</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>π</ci>
       </apply>
       <ci>A</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ρ</ci>
       <ci>normal-′</ci>
      </apply>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>π</ci>
        <ci>σ</ci>
       </apply>
       <ci>σ</ci>
      </interval>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{D}\cdot\vec{\pi}_{A}-\rho^{\prime}(\pi_{\sigma},\sigma)=0
  </annotation>
 </semantics>
</math>

</p>

<p>where since ρ is an <a class="uri" href="intertwiner" title="wikilink">intertwiner</a></p>

<p>

<math display="block" id="First_class_constraint:18">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mi>L</mi>
     <mo>⊗</mo>
     <mi>V</mi>
    </mrow>
    <mo>→</mo>
    <mi>V</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>ρ</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>L</ci>
      <ci>V</ci>
     </apply>
     <ci>V</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho:L\otimes V\rightarrow V
  </annotation>
 </semantics>
</math>

,</p>

<p>ρ' is the dualized intertwiner</p>

<p>

<math display="block" id="First_class_constraint:19">
 <semantics>
  <mrow>
   <msup>
    <mi>ρ</mi>
    <mo>′</mo>
   </msup>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>V</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mo>⊗</mo>
     <mi>V</mi>
    </mrow>
    <mo>→</mo>
    <mi>L</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ρ</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>V</ci>
      </apply>
      <ci>V</ci>
     </apply>
     <ci>L</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho^{\prime}:\bar{V}\otimes V\rightarrow L
  </annotation>
 </semantics>
</math>

</p>

<p>(L is self-dual via η). The Hamiltonian,</p>

<p>

<math display="block" id="First_class_constraint:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>H</mi>
      <mi>f</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <msup>
          <mi>d</mi>
          <mrow>
           <mi>d</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>x</mi>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <msup>
          <mi>α</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>π</mi>
           <mi>σ</mi>
          </msub>
          <mo>,</mo>
          <msub>
           <mi>π</mi>
           <mi>σ</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mi>α</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mrow>
            <mover accent="true">
             <mi>D</mi>
             <mo stretchy="false">→</mo>
            </mover>
            <mi>σ</mi>
           </mrow>
           <mo>⋅</mo>
           <mover accent="true">
            <mi>D</mi>
            <mo stretchy="false">→</mo>
           </mover>
          </mrow>
          <mi>σ</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <msup>
         <mi>g</mi>
         <mn>2</mn>
        </msup>
        <mn>2</mn>
       </mfrac>
       <mi>η</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mover accent="true">
          <mi>π</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>A</mi>
        </msub>
        <mo>,</mo>
        <msub>
         <mover accent="true">
          <mi>π</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>A</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>2</mn>
         <msup>
          <mi>g</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
       <mi>η</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝔹</mi>
         <mo>⋅</mo>
         <mi>𝔹</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mi>η</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>π</mi>
          <mi>ϕ</mi>
         </msub>
         <mo>,</mo>
         <mi>f</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
      </mrow>
     </mrow>
     <mo><</mo>
     <msub>
      <mi>π</mi>
      <mi>σ</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mi>ϕ</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>σ</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>></mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>η</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>ϕ</mi>
        <mo>,</mo>
        <mrow>
         <mover accent="true">
          <mi>D</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>⋅</mo>
         <msub>
          <mover accent="true">
           <mi>π</mi>
           <mo stretchy="false">→</mo>
          </mover>
          <mi>A</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>f</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>d</ci>
           <apply>
            <minus></minus>
            <ci>d</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>x</ci>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>α</ci>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <interval closure="open">
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>π</ci>
            <ci>σ</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>π</ci>
            <ci>σ</ci>
           </apply>
          </interval>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <ci>α</ci>
         <apply>
          <times></times>
          <apply>
           <ci>normal-⋅</ci>
           <apply>
            <times></times>
            <apply>
             <ci>normal-→</ci>
             <ci>D</ci>
            </apply>
            <ci>σ</ci>
           </apply>
           <apply>
            <ci>normal-→</ci>
            <ci>D</ci>
           </apply>
          </apply>
          <ci>σ</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>η</ci>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>π</ci>
          </apply>
          <ci>A</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>π</ci>
          </apply>
          <ci>A</ci>
         </apply>
        </interval>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>g</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <ci>η</ci>
        <apply>
         <ci>normal-⋅</ci>
         <ci>𝔹</ci>
         <ci>𝔹</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">limit-from</csymbol>
        <apply>
         <times></times>
         <ci>η</ci>
         <interval closure="open">
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>π</ci>
           <ci>ϕ</ci>
          </apply>
          <ci>f</ci>
         </interval>
        </apply>
        <minus></minus>
       </apply>
      </apply>
     </apply>
     <apply>
      <lt></lt>
      <share href="#.cmml">
      </share>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>π</ci>
       <ci>σ</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>η</ci>
       <interval closure="open">
        <ci>ϕ</ci>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>D</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>π</ci>
          </apply>
          <ci>A</ci>
         </apply>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{f}=\int d^{d-1}x\frac{1}{2}\alpha^{-1}(\pi_{\sigma},\pi_{\sigma})+\frac{1}{%
2}\alpha(\vec{D}\sigma\cdot\vec{D}\sigma)-\frac{g^{2}}{2}\eta(\vec{\pi}_{A},%
\vec{\pi}_{A})-\frac{1}{2g^{2}}\eta(\mathbb{B}\cdot\mathbb{B})-\eta(\pi_{\phi}%
,f)-<\pi_{\sigma},\phi[\sigma]>-\eta(\phi,\vec{D}\cdot\vec{\pi}_{A}).
  </annotation>
 </semantics>
</math>

</p>

<p>The last two terms are a linear combination of the Gaussian constraints and we have a whole family of (gauge equivalent)Hamiltonians parametrized by <em>f</em>. In fact, since the last three terms vanish for the constrained states, we can drop them.</p>
<h2 id="second-class-constraints">Second class constraints</h2>

<p>In a constrained Hamiltonian system, a dynamical quantity is <strong>second class</strong> if its Poisson bracket with at least one constraint is nonvanishing. A constraint that has a nonzero Poisson bracket with at least one other constraint, then, is a <strong>second class constraint</strong>.</p>

<p>See <a href="first_class_constraints" title="wikilink">first class constraints</a> or <a href="Dirac_bracket" title="wikilink">Dirac bracket</a> for the preliminaries.</p>
<h3 id="an-example-a-particle-confined-to-a-sphere">An example: a particle confined to a sphere</h3>

<p>Before going on to the general theory, consider a specific example step by step to motivate the general analysis.</p>

<p>Start with the <a href="action_(physics)" title="wikilink">action</a> describing a <a href="Newtonian_dynamics" title="wikilink">Newtonian</a> particle of <a class="uri" href="mass" title="wikilink">mass</a> m constrained to a surface of radius R within a uniform <a href="gravitational_field" title="wikilink">gravitational field</a> <em>g</em>. When one works in Lagrangian mechanics, there are several ways to implement a constraint: one can switch to generalized coordinates that manifestly solve the constraint, or one can use a Lagrange multiplier while retaining the redundant coordinates so constrained.</p>

<p>In this case, the particle is constrained to a sphere, therefore the natural solution would be to use angular coordinates to describe the position of the particle instead of Cartesian and solve (automatically eliminate) the constraint in that way (the first choice). For pedagogical reasons, instead, consider the problem in Cartesian coordinates, with a Lagrange multiplier term enforcing the constraint.</p>

<p>The action is given by</p>

<p>

<math display="block" id="First_class_constraint:21">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
     <mi>L</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mrow>
         <mfrac>
          <mi>m</mi>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msup>
            <mover accent="true">
             <mi>x</mi>
             <mo>˙</mo>
            </mover>
            <mn>2</mn>
           </msup>
           <mo>+</mo>
           <msup>
            <mover accent="true">
             <mi>y</mi>
             <mo>˙</mo>
            </mover>
            <mn>2</mn>
           </msup>
           <mo>+</mo>
           <msup>
            <mover accent="true">
             <mi>z</mi>
             <mo>˙</mo>
            </mover>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>m</mi>
         <mi>g</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mi>λ</mi>
         <mn>2</mn>
        </mfrac>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <msup>
            <mi>x</mi>
            <mn>2</mn>
           </msup>
           <mo>+</mo>
           <msup>
            <mi>y</mi>
            <mn>2</mn>
           </msup>
           <mo>+</mo>
           <msup>
            <mi>z</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo>-</mo>
          <msup>
           <mi>R</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>S</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
       <ci>L</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <ci>normal-˙</ci>
              <ci>x</ci>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <ci>normal-˙</ci>
              <ci>y</ci>
             </apply>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <ci>normal-˙</ci>
              <ci>z</ci>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>m</ci>
           <ci>g</ci>
           <ci>z</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <ci>λ</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <plus></plus>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>y</ci>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>R</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int dtL=\int dt\left[\frac{m}{2}(\dot{x}^{2}+\dot{y}^{2}+\dot{z}^{2})-mgz+%
\frac{\lambda}{2}(x^{2}+y^{2}+z^{2}-R^{2})\right]
  </annotation>
 </semantics>
</math>

 where the last term is the <a href="Lagrange_multiplier" title="wikilink">Lagrange multiplier</a> term enforcing the constraint.</p>

<p>Of course, as indicated, we could have just used different <a class="uri" href="coordinates" title="wikilink">coordinates</a> and written it as 

<math display="inline" id="First_class_constraint:22">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <mi>m</mi>
          <msup>
           <mi>R</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mn>2</mn>
        </mfrac>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msup>
           <mover accent="true">
            <mi>θ</mi>
            <mo>˙</mo>
           </mover>
           <mn>2</mn>
          </msup>
          <mo>+</mo>
          <mrow>
           <mrow>
            <msup>
             <mi>sin</mi>
             <mn>2</mn>
            </msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>θ</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <msup>
            <mover accent="true">
             <mi>ϕ</mi>
             <mo>˙</mo>
            </mover>
            <mn>2</mn>
           </msup>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>m</mi>
        <mi>g</mi>
        <mi>R</mi>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>θ</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>m</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>R</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <plus></plus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <ci>normal-˙</ci>
            <ci>θ</ci>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <sin></sin>
             <cn type="integer">2</cn>
            </apply>
            <ci>θ</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <ci>normal-˙</ci>
             <ci>ϕ</ci>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>g</ci>
         <ci>R</ci>
         <apply>
          <cos></cos>
          <ci>θ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int dt\left[\frac{mR^{2}}{2}(\dot{\theta}^{2}+\sin^{2}(\theta)\dot{\phi}^{2%
})+mgR\cos(\theta)\right]
  </annotation>
 </semantics>
</math>

 instead, without extra constraints, but we look at the former coordinatization to illustrate constraints.</p>

<p>The <a href="conjugate_momentum" title="wikilink">conjugate momenta</a> are given by</p>

<p>

<math display="block" id="First_class_constraint:23">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>x</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>m</ci>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{x}=m\dot{x}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="First_class_constraint:24">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>y</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <mover accent="true">
     <mi>y</mi>
     <mo>˙</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <times></times>
     <ci>m</ci>
     <apply>
      <ci>normal-˙</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{y}=m\dot{y}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="First_class_constraint:25">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>z</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <mover accent="true">
     <mi>z</mi>
     <mo>˙</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>m</ci>
     <apply>
      <ci>normal-˙</ci>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{z}=m\dot{z}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="First_class_constraint:26">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>λ</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>λ</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{\lambda}=0
  </annotation>
 </semantics>
</math>

 . Note that we can't determine 

<math display="inline" id="First_class_constraint:27">
 <semantics>
  <mover accent="true">
   <mi>λ</mi>
   <mo>˙</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-˙</ci>
    <ci>λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\lambda}
  </annotation>
 </semantics>
</math>

 from the momenta.</p>

<p>The <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian</a> is given by</p>

<p>

<math display="block" id="First_class_constraint:28">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>⋅</mo>
      <mover accent="true">
       <mover accent="true">
        <mi>r</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo>˙</mo>
      </mover>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>λ</mi>
      </msub>
      <mover accent="true">
       <mi>λ</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mi>L</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>λ</mi>
      </msub>
      <mover accent="true">
       <mi>λ</mi>
       <mo>˙</mo>
      </mover>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>m</mi>
      <mi>g</mi>
      <mi>z</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mi>λ</mi>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mi>R</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>H</ci>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <ci>normal-→</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <ci>normal-˙</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>r</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>λ</ci>
        </apply>
        <apply>
         <ci>normal-˙</ci>
         <ci>λ</ci>
        </apply>
       </apply>
      </apply>
      <ci>L</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>λ</ci>
        </apply>
        <apply>
         <ci>normal-˙</ci>
         <ci>λ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>g</ci>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\vec{p}\cdot\dot{\vec{r}}+p_{\lambda}\dot{\lambda}-L=\frac{p^{2}}{2m}+p_{%
\lambda}\dot{\lambda}+mgz-\frac{\lambda}{2}(r^{2}-R^{2})
  </annotation>
 </semantics>
</math>

.</p>

<p>We cannot eliminate 

<math display="inline" id="First_class_constraint:29">
 <semantics>
  <mover accent="true">
   <mi>λ</mi>
   <mo>˙</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-˙</ci>
    <ci>λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\lambda}
  </annotation>
 </semantics>
</math>

 at this stage yet. We are here treating 

<math display="inline" id="First_class_constraint:30">
 <semantics>
  <mover accent="true">
   <mi>λ</mi>
   <mo>˙</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-˙</ci>
    <ci>λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\lambda}
  </annotation>
 </semantics>
</math>

 as a shorthand for a function of the <a href="symplectic_space" title="wikilink">symplectic space</a> which we have yet to determine and <em>not</em> an independent variable. For notational consistency, define 

<math display="inline" id="First_class_constraint:31">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mover accent="true">
    <mi>λ</mi>
    <mo>˙</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <ci>normal-˙</ci>
     <ci>λ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}=\dot{\lambda}
  </annotation>
 </semantics>
</math>

 from now on. The above Hamiltonian with the <mtpl></mtpl> term is the "naive Hamiltonian". Note that since, on-shell, the constraint must be satisfied, one cannot distinguish, on-shell, between the naive Hamiltonian and the above Hamiltonian with the undetermined coefficient, 

<math display="inline" id="First_class_constraint:32">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>λ</mi>
    <mo>˙</mo>
   </mover>
   <mo>=</mo>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-˙</ci>
     <ci>λ</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\lambda}=u_{1}
  </annotation>
 </semantics>
</math>

.</p>

<p>We have the <a href="primary_constraint" title="wikilink">primary constraint</a></p>
<dl>
<dd><mtpl>0}}</mtpl>.
</dd>
</dl>

<p>We require, on the grounds of consistency, that the <a href="Poisson_bracket" title="wikilink">Poisson bracket</a> of all the constraints with the Hamiltonian vanish at the constrained subspace. In other words, the constraints must not evolve in time if they are going to be identically zero along the equations of motion.</p>

<p>From this consistency condition, we immediately get the <a href="First_class_constraints#Constrained_Hamiltonian_dynamics_from_a_Lagrangian_gauge_theory" title="wikilink">secondary constraint</a></p>
<dl>
<dd><mtpl>0}}</mtpl> .
</dd>
</dl>

<p>By the same reasoning, this constraint should be added into the Hamiltonian with an undetermined (not necessarily constant) coefficient 

<math display="inline" id="First_class_constraint:33">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

<sub>2</sub>. At this point, the Hamiltonian is</p>

<p>

<math display="block" id="First_class_constraint:34">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <msup>
        <mi>p</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mi>m</mi>
       <mi>g</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mi>λ</mi>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>r</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>R</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mi>λ</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mi>R</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>g</ci>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>λ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\frac{p^{2}}{2m}+mgz-\frac{\lambda}{2}(r^{2}-R^{2})+u_{1}p_{\lambda}+u_{2}(r%
^{2}-R^{2})
  </annotation>
 </semantics>
</math>

</p>

<p>And from the secondary constraint, we get the tertiary constraint, 

<math display="inline" id="First_class_constraint:35">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>p</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>⋅</mo>
    <mover accent="true">
     <mi>r</mi>
     <mo stretchy="false">→</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <ci>normal-→</ci>
      <ci>r</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{p}\cdot\vec{r}=0
  </annotation>
 </semantics>
</math>

, by demanding, for consistency, that 

<math display="inline" id="First_class_constraint:36">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <msup>
       <mi>r</mi>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mi>R</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo rspace="4.2pt">,</mo>
     <mi>H</mi>
     <mo stretchy="false">}</mo>
    </mrow>
    <mrow>
     <mi>P</mi>
     <mi>B</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <set>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>H</ci>
     </set>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{r^{2}-R^{2},\,H\}_{PB}=0
  </annotation>
 </semantics>
</math>

 on-shell. Again, one should add this constraint into the Hamiltonian, since on-shell no one can tell the difference. Therefore, so far, the Hamiltonian looks like</p>

<p>

<math display="block" id="First_class_constraint:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mfrac>
        <msup>
         <mi>p</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
       </mfrac>
       <mo>+</mo>
       <mrow>
        <mi>m</mi>
        <mi>g</mi>
        <mi>z</mi>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mi>λ</mi>
        <mn>2</mn>
       </mfrac>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msup>
          <mi>r</mi>
          <mn>2</mn>
         </msup>
         <mo>-</mo>
         <msup>
          <mi>R</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>u</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>p</mi>
       <mi>λ</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>u</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>r</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <msup>
         <mi>R</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>u</mi>
        <mn>3</mn>
       </msub>
       <mover accent="true">
        <mi>p</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>r</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>g</ci>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>λ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>λ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\frac{p^{2}}{2m}+mgz-\frac{\lambda}{2}(r^{2}-R^{2})+u_{1}p_{\lambda}+u_{2}(r%
^{2}-R^{2})+u_{3}\vec{p}\cdot\vec{r},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="First_class_constraint:38">
 <semantics>
  <msub>
   <mi>u</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="First_class_constraint:39">
 <semantics>
  <msub>
   <mi>u</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{2}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="First_class_constraint:40">
 <semantics>
  <msub>
   <mi>u</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{3}
  </annotation>
 </semantics>
</math>

 are still completely undetermined. Note that frequently all constraints that are found from consistency conditions are referred to as "secondary constraints" and secondary, tertiary, quaternary, etc. constraints are not distinguished.</p>

<p>The tertiary constraint's consistency condition yields</p>

<p>

<math display="block" id="First_class_constraint:41">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mover accent="true">
       <mi>p</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>⋅</mo>
      <mover accent="true">
       <mi>r</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mo rspace="4.2pt">,</mo>
     <mi>H</mi>
     <mo stretchy="false">}</mo>
    </mrow>
    <mrow>
     <mi>P</mi>
     <mi>B</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <msup>
        <mi>p</mi>
        <mn>2</mn>
       </msup>
       <mi>m</mi>
      </mfrac>
      <mo>-</mo>
      <mrow>
       <mi>m</mi>
       <mi>g</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>λ</mi>
      <msup>
       <mi>r</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <ci>normal-→</ci>
         <ci>p</ci>
        </apply>
        <apply>
         <ci>normal-→</ci>
         <ci>r</ci>
        </apply>
       </apply>
       <ci>H</ci>
      </set>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>B</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>p</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>m</ci>
        </apply>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>g</ci>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>λ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{\vec{p}\cdot\vec{r},\,H\}_{PB}=\frac{p^{2}}{m}-mgz+\lambda r^{2}-2u_{2}r^{2}%
=0.
  </annotation>
 </semantics>
</math>

 This is <em>not</em> a quaternary constraint, but a condition which fixes one of the undetermined coefficients. In particular, it fixes</p>

<p>

<math display="block" id="First_class_constraint:42">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>u</mi>
     <mn>2</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mi>λ</mi>
      <mn>2</mn>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msup>
          <mi>p</mi>
          <mn>2</mn>
         </msup>
         <mrow>
          <mn>2</mn>
          <mi>m</mi>
         </mrow>
        </mfrac>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mi>m</mi>
         <mi>g</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <ci>λ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>m</ci>
        <ci>g</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{2}=\frac{\lambda}{2}+\frac{1}{r^{2}}\left(\frac{p^{2}}{2m}-\frac{1}{2}mgz%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>Now that there are new terms in the Hamiltonian, one should go back and check the consistency conditions for the primary and secondary constraints. The secondary constraint's consistency condition gives</p>

<p>

<math display="block" id="First_class_constraint:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>2</mn>
       <mi>m</mi>
      </mfrac>
      <mover accent="true">
       <mi>r</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>p</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>u</mi>
      <mn>3</mn>
     </msub>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{2}{m}\vec{r}\cdot\vec{p}+2u_{3}r^{2}=0.
  </annotation>
 </semantics>
</math>

 Again, this is <em>not</em> a new constraint; it only determines that</p>

<p>

<math display="block" id="First_class_constraint:44">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>u</mi>
     <mn>3</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mover accent="true">
        <mi>r</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo>⋅</mo>
       <mover accent="true">
        <mi>p</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
      <mrow>
       <mi>m</mi>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{3}=-\frac{\vec{r}\cdot\vec{p}}{mr^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>At this point there are <em>no more constraints or consistency conditions</em> to check.</p>

<p>Putting it all together,</p>

<p>

<math display="block" id="First_class_constraint:45">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mn>2</mn>
         <mo>-</mo>
         <mfrac>
          <msup>
           <mi>R</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>r</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>p</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mfrac>
          <msup>
           <mi>R</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>r</mi>
           <mn>2</mn>
          </msup>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi>m</mi>
       <mi>g</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mover accent="true">
          <mi>r</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>⋅</mo>
         <mover accent="true">
          <mi>p</mi>
          <mo stretchy="false">→</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mi>m</mi>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>p</mi>
      <mi>λ</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>R</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>r</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>p</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>R</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>r</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <ci>m</ci>
        <ci>g</ci>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <ci>normal-→</ci>
          <ci>r</ci>
         </apply>
         <apply>
          <ci>normal-→</ci>
          <ci>p</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>m</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>λ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\left(2-\frac{R^{2}}{r^{2}}\right)\frac{p^{2}}{2m}+\frac{1}{2}\left(1+\frac{%
R^{2}}{r^{2}}\right)mgz-\frac{(\vec{r}\cdot\vec{p})^{2}}{mr^{2}}+u_{1}p_{\lambda}
  </annotation>
 </semantics>
</math>

. When finding the equations of motion, one should use the above Hamiltonian, and as long as one is careful to never use constraints before taking derivatives in the Poisson bracket then one gets the correct equations of motion. That is, the equations of motion are given by</p>

<p>

<math display="block" id="First_class_constraint:46">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mover accent="true">
       <mi>r</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>˙</mo>
     </mover>
     <mo>=</mo>
     <msub>
      <mrow>
       <mo stretchy="false">{</mo>
       <mover accent="true">
        <mi>r</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo rspace="4.2pt">,</mo>
       <mi>H</mi>
       <mo stretchy="false">}</mo>
      </mrow>
      <mrow>
       <mi>P</mi>
       <mi>B</mi>
      </mrow>
     </msub>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mover accent="true">
       <mover accent="true">
        <mi>p</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo>˙</mo>
      </mover>
      <mo>=</mo>
      <msub>
       <mrow>
        <mo stretchy="false">{</mo>
        <mover accent="true">
         <mi>p</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mo rspace="4.2pt">,</mo>
        <mi>H</mi>
        <mo stretchy="false">}</mo>
       </mrow>
       <mrow>
        <mi>P</mi>
        <mi>B</mi>
       </mrow>
      </msub>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mrow>
       <mover accent="true">
        <mi>λ</mi>
        <mo>˙</mo>
       </mover>
       <mo>=</mo>
       <msub>
        <mrow>
         <mo stretchy="false">{</mo>
         <mi>λ</mi>
         <mo rspace="4.2pt">,</mo>
         <mi>H</mi>
         <mo stretchy="false">}</mo>
        </mrow>
        <mrow>
         <mi>P</mi>
         <mi>B</mi>
        </mrow>
       </msub>
      </mrow>
      <mo rspace="12.5pt">,</mo>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>p</mi>
         <mo>˙</mo>
        </mover>
        <mi>λ</mi>
       </msub>
       <mo>=</mo>
       <msub>
        <mrow>
         <mo stretchy="false">{</mo>
         <msub>
          <mi>p</mi>
          <mi>λ</mi>
         </msub>
         <mo>,</mo>
         <mi>H</mi>
         <mo stretchy="false">}</mo>
        </mrow>
        <mrow>
         <mi>P</mi>
         <mi>B</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-˙</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <set>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
       </apply>
       <ci>H</ci>
      </set>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <ci>normal-˙</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <set>
        <apply>
         <ci>normal-→</ci>
         <ci>p</ci>
        </apply>
        <ci>H</ci>
       </set>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <ci>normal-˙</ci>
        <ci>λ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <set>
         <ci>λ</ci>
         <ci>H</ci>
        </set>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-˙</ci>
         <ci>p</ci>
        </apply>
        <ci>λ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <set>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>λ</ci>
         </apply>
         <ci>H</ci>
        </set>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>B</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\vec{r}}=\{\vec{r},\,H\}_{PB},\quad\dot{\vec{p}}=\{\vec{p},\,H\}_{PB},%
\quad\dot{\lambda}=\{\lambda,\,H\}_{PB},\quad\dot{p}_{\lambda}=\{p_{\lambda},H%
\}_{PB}.
  </annotation>
 </semantics>
</math>

</p>

<p>Before analyzing the Hamiltonian, consider the three constraints:</p>

<p>

<math display="block" id="First_class_constraint:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>ϕ</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <msub>
      <mi>p</mi>
      <mi>λ</mi>
     </msub>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mn>2</mn>
      </msub>
      <mo>=</mo>
      <mrow>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mi>R</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mn>3</mn>
      </msub>
      <mo>=</mo>
      <mrow>
       <mover accent="true">
        <mi>p</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mo>⋅</mo>
       <mover accent="true">
        <mi>r</mi>
        <mo stretchy="false">→</mo>
       </mover>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>λ</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <ci>normal-→</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{1}=p_{\lambda},\quad\phi_{2}=r^{2}-R^{2},\quad\phi_{3}=\vec{p}\cdot\vec{%
r}.
  </annotation>
 </semantics>
</math>

 Notice the nontrivial <a href="Poisson_bracket" title="wikilink">Poisson bracket</a> structure of the constraints. In particular,</p>

<p>

<math display="block" id="First_class_constraint:48">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>ϕ</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>ϕ</mi>
     <mn>3</mn>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <msup>
     <mi>r</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>≠</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <cn type="integer">3</cn>
      </apply>
     </set>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{\phi_{2},\phi_{3}\}=2r^{2}\neq 0.
  </annotation>
 </semantics>
</math>

 The above Poisson bracket does not just fail to vanish off-shell, which might be anticipated, but even on-shell it is nonzero. Therefore, 

<math display="inline" id="First_class_constraint:49">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="First_class_constraint:50">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{3}
  </annotation>
 </semantics>
</math>

 are <strong>second class constraints</strong> while 

<math display="inline" id="First_class_constraint:51">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{1}
  </annotation>
 </semantics>
</math>


 is a first class constraint. Note that these constraints satisfy the regularity condition.</p>

<p>Here, we have a symplectic space where the Poisson bracket does not have "nice properties" on the constrained subspace. But <a href="Paul_Dirac" title="wikilink">Dirac</a> noticed that we can turn the underlying <a href="differential_manifold" title="wikilink">differential manifold</a> of the <a href="symplectic_space" title="wikilink">symplectic space</a> into a <a href="Poisson_manifold" title="wikilink">Poisson manifold</a> using a different bracket, called the <a href="Dirac_bracket" title="wikilink">Dirac bracket</a>, such that the Dirac bracket of any (smooth) function with any of the second class constraints always vanishes and a couple of other nice properties.</p>

<p>If one wanted to canonically quantize this system, then, one needs to promote the canonical Dirac brackets<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> not the canonical Poisson brackets to commutation relations.</p>

<p>Examination of the above Hamiltonian shows a number of interesting things happening. One thing to note is that on-shell when the constraints are satisfied the extended Hamiltonian is identical to the naive Hamiltonian, as required. Also, note that 

<math display="inline" id="First_class_constraint:52">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 dropped out of the extended Hamiltonian. Since 

<math display="inline" id="First_class_constraint:53">
 <semantics>
  <msub>
   <mi>ϕ</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϕ</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{1}
  </annotation>
 </semantics>
</math>

 is a first class primary constraint it should be interpreted as a generator of a gauge transformation. The gauge freedom is the freedom to choose 

<math display="inline" id="First_class_constraint:54">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 which has ceased to have any effect on the particle's dynamics. Therefore, that 

<math display="inline" id="First_class_constraint:55">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 dropped out of the Hamiltonian, that 

<math display="inline" id="First_class_constraint:56">
 <semantics>
  <msub>
   <mi>u</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}
  </annotation>
 </semantics>
</math>


 is undetermined, and that 

<math display="inline" id="First_class_constraint:57">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>p</mi>
    <mi>λ</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>λ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{1}=p_{\lambda}
  </annotation>
 </semantics>
</math>

 is first class, are all closely interrelated.</p>

<p>Note that it would be more natural not to start with a Lagrangian with a Lagrange multiplier, but instead take 

<math display="inline" id="First_class_constraint:58">
 <semantics>
  <mrow>
   <msup>
    <mi>r</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <msup>
    <mi>R</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{2}-R^{2}
  </annotation>
 </semantics>
</math>

 as a primary constraint and proceed through the formalism. The result would the elimination of the extraneous 

<math display="inline" id="First_class_constraint:59">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   λ
  </annotation>
 </semantics>
</math>

 dynamical quantity. Perhaps, the example is more edifying in its current form.</p>
<h3 id="example-proca-action">Example: Proca action</h3>

<p>Another example we will use is the <a href="Proca_action" title="wikilink">Proca action</a>. The fields are 

<math display="inline" id="First_class_constraint:60">
 <semantics>
  <mrow>
   <msup>
    <mi>A</mi>
    <mi>μ</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mover accent="true">
     <mi>A</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>,</mo>
    <mi>ϕ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>μ</ci>
    </apply>
    <interval closure="open">
     <apply>
      <ci>normal-→</ci>
      <ci>A</ci>
     </apply>
     <ci>ϕ</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{\mu}=(\vec{A},\phi)
  </annotation>
 </semantics>
</math>

 and the action is</p>

<p>

<math display="block" id="First_class_constraint:61">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <msup>
      <mi>d</mi>
      <mi>d</mi>
     </msup>
     <mi>x</mi>
     <mi>d</mi>
     <mi>t</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <msup>
          <mi>E</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>4</mn>
         </mfrac>
         <msub>
          <mi>B</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
         <msub>
          <mi>B</mi>
          <mrow>
           <mi>i</mi>
           <mi>j</mi>
          </mrow>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mfrac>
          <msup>
           <mi>m</mi>
           <mn>2</mn>
          </msup>
          <mn>2</mn>
         </mfrac>
         <msup>
          <mi>A</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <msup>
          <mi>m</mi>
          <mn>2</mn>
         </msup>
         <mn>2</mn>
        </mfrac>
        <msup>
         <mi>ϕ</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>d</ci>
      </apply>
      <ci>x</ci>
      <ci>d</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>E</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">4</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>B</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>B</ci>
           <apply>
            <times></times>
            <ci>i</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>A</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>m</ci>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\int d^{d}xdt\left[\frac{1}{2}E^{2}-\frac{1}{4}B_{ij}B_{ij}-\frac{m^{2}}{2}A%
^{2}+\frac{m^{2}}{2}\phi^{2}\right]
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="First_class_constraint:62">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>E</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo>∇</mo>
      <mi>ϕ</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mover accent="true">
     <mover accent="true">
      <mi>A</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>˙</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <ci>normal-→</ci>
     <ci>E</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-∇</ci>
       <ci>ϕ</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-˙</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{E}\equiv-\nabla\phi-\dot{\vec{A}}
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="First_class_constraint:63">
 <semantics>
  <mrow>
   <msub>
    <mi>B</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>A</mi>
       <mi>j</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>A</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>B</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B_{ij}\equiv\frac{\partial A_{j}}{\partial x_{i}}-\frac{\partial A_{i}}{%
\partial x_{j}}
  </annotation>
 </semantics>
</math>

. 

<math display="inline" id="First_class_constraint:64">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mover accent="true">
    <mi>A</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>,</mo>
   <mrow>
    <mo>-</mo>
    <mover accent="true">
     <mi>E</mi>
     <mo stretchy="false">→</mo>
    </mover>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <ci>normal-→</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-→</ci>
      <ci>E</ci>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\vec{A},-\vec{E})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="First_class_constraint:65">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>ϕ</mi>
   <mo>,</mo>
   <mi>π</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>ϕ</ci>
    <ci>π</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\phi,\pi)
  </annotation>
 </semantics>
</math>

 are <a href="canonical_variables" title="wikilink">canonical variables</a>. The second class constraints are</p>

<p>

<math display="block" id="First_class_constraint:66">
 <semantics>
  <mrow>
   <mi>π</mi>
   <mo>≈</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>π</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi\approx 0
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="First_class_constraint:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∇</mo>
     <mo>⋅</mo>
     <mover accent="true">
      <mi>E</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>m</mi>
      <mn>2</mn>
     </msup>
     <mi>ϕ</mi>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <ci>normal-∇</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>E</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>ϕ</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla\cdot\vec{E}+m^{2}\phi\approx 0
  </annotation>
 </semantics>
</math>

. The Hamiltonian is given by</p>

<p>

<math display="block" id="First_class_constraint:68">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <msup>
      <mi>d</mi>
      <mi>d</mi>
     </msup>
     <mi>x</mi>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
           <msup>
            <mi>E</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mfrac>
            <mn>1</mn>
            <mn>4</mn>
           </mfrac>
           <msub>
            <mi>B</mi>
            <mrow>
             <mi>i</mi>
             <mi>j</mi>
            </mrow>
           </msub>
           <msub>
            <mi>B</mi>
            <mrow>
             <mi>i</mi>
             <mi>j</mi>
            </mrow>
           </msub>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mrow>
           <mi>π</mi>
           <mo>∇</mo>
          </mrow>
          <mo>⋅</mo>
          <mover accent="true">
           <mi>A</mi>
           <mo stretchy="false">→</mo>
          </mover>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mover accent="true">
          <mi>E</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mo>⋅</mo>
         <mrow>
          <mo>∇</mo>
          <mi>ϕ</mi>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <msup>
           <mi>m</mi>
           <mn>2</mn>
          </msup>
          <mn>2</mn>
         </mfrac>
         <msup>
          <mi>A</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <msup>
          <mi>m</mi>
          <mn>2</mn>
         </msup>
         <mn>2</mn>
        </mfrac>
        <msup>
         <mi>ϕ</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>d</ci>
      </apply>
      <ci>x</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <apply>
             <divide></divide>
             <cn type="integer">1</cn>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>E</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <divide></divide>
             <cn type="integer">1</cn>
             <cn type="integer">4</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>B</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>j</ci>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>B</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>j</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply>
           <ci>normal-⋅</ci>
           <apply>
            <times></times>
            <ci>π</ci>
            <ci>normal-∇</ci>
           </apply>
           <apply>
            <ci>normal-→</ci>
            <ci>A</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <ci>normal-⋅</ci>
          <apply>
           <ci>normal-→</ci>
           <ci>E</ci>
          </apply>
          <apply>
           <ci>normal-∇</ci>
           <ci>ϕ</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>A</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>m</ci>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ϕ</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\int d^{d}x\left[\frac{1}{2}E^{2}+\frac{1}{4}B_{ij}B_{ij}-\pi\nabla\cdot\vec%
{A}+\vec{E}\cdot\nabla\phi+\frac{m^{2}}{2}A^{2}-\frac{m^{2}}{2}\phi^{2}\right]
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Dirac_bracket" title="wikilink">Dirac bracket</a></li>
<li><a href="Holonomic_constraint" title="wikilink">Holonomic constraint</a></li>
<li><a href="Analysis_of_flows" title="wikilink">Analysis of flows</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Classical_mechanics" title="wikilink">Category:Classical mechanics</a> <a href="Category:Theoretical_physics" title="wikilink">Category:Theoretical physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1767">Leapfrog integration</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Leapfrog integration</h1>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a> <strong>leapfrog integration</strong> is a method for numerically integrating <a href="differential_equation" title="wikilink">differential equations</a> of the form</p>

<p>

<math display="block" id="Leapfrog_integration:0">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>¨</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>d</mi>
       <mn>2</mn>
      </msup>
      <mi>x</mi>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <msup>
     <mi>t</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¨</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>x</ci>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>F</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{x}=d^{2}x/dt^{2}=F(x)
  </annotation>
 </semantics>
</math>

, or equivalently of the form</p>

<p>

<math display="block" id="Leapfrog_integration:1">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo>˙</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>d</mi>
       <mi>v</mi>
      </mrow>
      <mo>/</mo>
      <mi>d</mi>
     </mrow>
     <mi>t</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="5.3pt">,</mo>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
      <mo>/</mo>
      <mi>d</mi>
     </mrow>
     <mi>t</mi>
    </mrow>
    <mo>=</mo>
    <mi>v</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <ci>normal-˙</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>v</ci>
        </apply>
        <ci>d</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <times></times>
       <ci>F</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <ci>normal-˙</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>x</ci>
        </apply>
        <ci>d</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <ci>v</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{v}=dv/dt=F(x),\;\dot{x}=dx/dt=v
  </annotation>
 </semantics>
</math>

, particularly in the case of a <a href="dynamical_system" title="wikilink">dynamical system</a> of <a href="classical_mechanics" title="wikilink">classical mechanics</a>.</p>

<p>The method is known by different names in different disciplines. In particular, it is similar to the <strong>Velocity Verlet</strong> method, which is a variant of <a href="Verlet_integration" title="wikilink">Verlet integration</a>. Leapfrog integration is equivalent to updating positions 

<math display="inline" id="Leapfrog_integration:2">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(t)
  </annotation>
 </semantics>
</math>

 and velocities 

<math display="inline" id="Leapfrog_integration:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>v</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo>˙</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>v</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-˙</ci>
      <ci>x</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v(t)=\dot{x}(t)
  </annotation>
 </semantics>
</math>

 at interleaved time points, staggered in such a way that they 'leapfrog' over each other. For example, the position is updated at integer time steps and the velocity is updated at integer-plus-a-half time steps.</p>

<p>Leapfrog integration is a second order method, in contrast to <a href="Euler_integration" title="wikilink">Euler integration</a>, which is only first order, yet requires the same number of function evaluations per step. Unlike Euler integration, it is stable for oscillatory motion, as long as the time-step 

<math display="inline" id="Leapfrog_integration:4">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 is constant, and 

<math display="inline" id="Leapfrog_integration:5">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mn>2</mn>
    <mo>/</mo>
    <mi>ω</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">2</cn>
     <ci>ω</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t\leq 2/\omega
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>In leapfrog integration, the equations for updating position and velocity are</p>

<p>

<math display="inline" id="Leapfrog_integration:6">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle x_{i}
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Leapfrog_integration:7">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 is position at step 

<math display="inline" id="Leapfrog_integration:8">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Leapfrog_integration:9">
 <semantics>
  <msub>
   <mi>v</mi>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mpadded width="+1.7pt">
      <mn>2</mn>
     </mpadded>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{i+1/2\,}
  </annotation>
 </semantics>
</math>

 is the velocity, or first derivative of 

<math display="inline" id="Leapfrog_integration:10">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, at step 

<math display="inline" id="Leapfrog_integration:11">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>+</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mpadded width="+1.7pt">
     <mn>2</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>i</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i+1/2\,
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Leapfrog_integration:12">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}=F(x_{i})
  </annotation>
 </semantics>
</math>

 is the acceleration, or second derivative of 

<math display="inline" id="Leapfrog_integration:13">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

, at step 

<math display="inline" id="Leapfrog_integration:14">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Leapfrog_integration:15">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 is the size of each time step. These equations can be expressed in a form which gives velocity at integer steps as well.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> However, even in this synchronized form, the time-step 

<math display="inline" id="Leapfrog_integration:16">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 must be constant to maintain stability.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="inline" id="Leapfrog_integration:17">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle x_{i+1}
  </annotation>
 </semantics>
</math>


</p>

<p>One use of this equation is in gravity simulations, since in that case the acceleration depends only on the positions of the gravitating masses (and not on their velocities), although higher order integrators (such as <a href="Runge–Kutta_methods" title="wikilink">Runge–Kutta methods</a>) are more frequently used.</p>

<p>There are two primary strengths to Leapfrog integration when applied to mechanics problems. The first is the <a class="uri" href="time-reversibility" title="wikilink">time-reversibility</a> of the Leapfrog method. One can integrate forward <em>n</em> steps, and then reverse the direction of integration and integrate backwards <em>n</em> steps to arrive at the same starting position. The second strength of Leapfrog integration is its <a href="Symplectic_integrator" title="wikilink">symplectic</a> nature, which implies that it conserves the (slightly modified) energy of dynamical systems. This is especially useful when computing orbital dynamics, as many other integration schemes, such as the (order 4) Runge-Kutta method, do not conserve energy and allow the system to drift substantially over time.</p>

<p>Because of its time-reversibility, and because it is a <a href="symplectic_integrator" title="wikilink">symplectic integrator</a>, leapfrog integration is also used in <a href="Hybrid_Monte_Carlo" title="wikilink">Hamiltonian Monte Carlo</a>, a method for drawing random samples from a probability distribution whose overall normalization is unknown.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Numerical_ordinary_differential_equations" title="wikilink">Numerical ordinary differential equations</a></li>
<li><a href="Symplectic_integrator" title="wikilink">Symplectic integration</a></li>
<li><a href="Euler_integration" title="wikilink">Euler integration</a></li>
<li><a href="Verlet_integration" title="wikilink">Verlet integration</a></li>
<li><a href="Runge–Kutta_methods" title="wikilink">Runge–Kutta integration</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://einstein.drexel.edu/courses/Comp_Phys/Integrators/leapfrog/">The Leapfrog Integrator</a>, Drexel University Physics</li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">C. K. Birdsall and A. B. Langdon, <em>Plasma Physics via Computer Simulations</em>, McGraw-Hill Book Company, 1985, p. 56<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://www.artcompsci.org/vol_1/v1_web/node34.html">4.1 Two Ways to Write the Leapfrog</a><a href="#fnref2">↩</a></li>
<li id="fn3">[Skeel, R. D., "Variable Step Size Destabilizes the Stömer/Leapfrog/Verlet Method," BIT Numerical Mathematics, Vol. 33, 1993, pp. 172-175.]<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

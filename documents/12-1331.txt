


Convection–diffusion equation




Convection–diffusion equation

The convection–diffusion equation is a combination of the diffusion and convection (advection) equations, and describes physical phenomena where particles, energy, or other physical quantities are transferred inside a physical system due to two processes: diffusion and convection. Depending on context, the same equation can be called the advection–diffusion equation, drift–diffusion equation,1 or (generic) scalar transport equation.2
Equation
General
The general equation is34


 
  where

c is the variable of interest (species concentration for mass transfer, temperature for heat transfer),
D is the diffusivity (also called diffusion coefficient), such as mass diffusivity for particle motion or thermal diffusivity for heat transport,


 
  is the average velocity that the quantity is moving. For example, in advection, c might be the concentration of salt in a river, and then 
 
 
 
  would be the velocity of the water flow. As another example, c might be the concentration of small bubbles in a calm lake, and then 
 
 
 
  would be the average velocity of bubbles rising towards the surface by buoyancy (see below). For multiphase flows and flows in porous media, 
 
 
 
  is the (hypothetical) superficial velocity.
R describes "sources" or "sinks" of the quantity c. For example, for a chemical species, R>0 means that a chemical reaction is creating more of the species, and R0 might occur if thermal energy is being generated by friction.


 
  represents gradient and 
 
 
 
  represents divergence.

Understanding the terms involved
The right-hand side of the equation is the sum of three contributions.

The first, 
 
 
 
 , describes diffusion. Imagine that c is the concentration of a chemical. When concentration is low somewhere compared to the surrounding areas (e.g. a local minimum of concentration), the substance will diffuse in from the surroundings, so the concentration will increase. Conversely, if concentration is high compared to the surroundings (e.g. a local maximum of concentration), then the substance will diffuse out and the concentration will decrease. The net diffusion is proportional to the Laplacian (or second derivative) of concentration.
The second contribution, 
 
 
 
 , describes convection (or advection). Imagine standing on the bank of a river, measuring the water's salinity (amount of salt) each second. Upstream, somebody dumps a bucket of salt into the river. A while later, you would see the salinity suddenly rise, then fall, as the zone of salty water passes by. Thus, the concentration at a given location can change because of the flow.
The final contribution, R, describes the creation or destruction of the quantity. For example, if c is the concentration of a molecule, then R describes how the molecule can be created or destroyed by chemical reactions. R may be a function of c and of other parameters. Often there are several quantities, each with its own convection-diffusion equation, where the destruction of one quantity entails the creation of another. For example, when methane burns, it involves not only the destruction of methane and oxygen but also the creation of carbon dioxide and water vapor. Therefore, while each of these chemicals has its own convection-diffusion equation, they are "coupled together" and must be solved as a system of simultaneous differential equations.

Common simplifications
In a common situation, the diffusion coefficient is constant, there are no sources or sinks, and the velocity field describes an incompressible flow (i.e., it has zero divergence). Then the formula simplifies to:567



In this form, the convection–diffusion equation combines both parabolic and hyperbolic partial differential equations.
Stationary version
The stationary convection–diffusion equation describes the steady-state behavior of a convective-diffusive system. In steady-state, 
 
 
 
 , so the formula is:



Derivation
The convection–diffusion equation can be derived in a straightforward way8 from the continuity equation, which states that the rate of change for a scalar quantity in a differential control volume is given by flow and diffusion into and out of that part of the system along with any generation or consumption inside the control volume:


 
  where 
 
 
 
  is the total flux and R is a net volumetric source for c. There are two sources of flux in this situation. First, diffusive flux arises due to diffusion. This is typically approximated by Fick's first law:


 
  i.e., the flux of the diffusing material (relative to the bulk motion) in any part of the system is proportional to the local concentration gradient. Second, when there is overall convection or flow, there is an associated flux called advective flux:


 
  The total flux (in a stationary coordinate system) is given by the sum of these two:


 
  Plugging into the continuity equation:



Complex mixing phenomena
In general, D, 
 
 
 
 , and s may vary with space and time. In cases in which they depend on concentration as well, the equation becomes nonlinear, giving rise to many distinctive mixing phenomena such as Rayleigh–Bénard convection when 
 
 
 
  depends on temperature in the heat transfer formulation and reaction-diffusion pattern formation when s depends on concentration in the mass transfer formulation.
Velocity in response to a force
In some cases, the average velocity field 
 
 
 
  exists because of a force; for example, the equation might describe the flow of ions dissolved in a liquid, with an electric field pulling the ions in some direction (as in gel electrophoresis). In this situation, it is usually called the drift-diffusion equation or the Smoluchowski equation,9 after Marian Smoluchowski who described it in 191510 (not to be confused with the Einstein–Smoluchowski relation or Smoluchowski coagulation equation).
Typically, the average velocity is directly proportional to the applied force, giving the equation:1112


 
  where 
 
 
 
  is the force, and 
 
 
 
  characterizes the friction or viscous drag. (The inverse 
 
 
 
  is called mobility.)
Derivation of Einstein relation
When the force is associated with a potential energy

 
  (see conservative force), a steady-state solution to the above equation (i.e. 0 = R = ∂c/∂t) is:


 
  (assuming D and 
 
 
 
  are constant). In other words, there are more particles where the energy is lower. This concentration profile is expected to agree with the Boltzmann distribution (more precisely, the Gibbs measure). From this assumption, the Einstein relation can be proven
 
 
 
 .13
As a stochastic differential equation
The convection–diffusion equation (with no sources or drains, R=0) can be viewed as a stochastic differential equation, describing random motion with diffusivity D and bias 
 
 
 
 . For example, the equation can describe the Brownian motion of a single particle, where the variable c describes the probability distribution for the particle to be in a given position at a given time. The reason the equation can be used that way is because there is no mathematical difference between the probability distribution of a single particle, and the concentration profile of a collection of infinitely many particles (as long as the particles do not interact with each other).
The Langevin equation describes advection, diffusion, and other phenomena in an explicitly stochastic way. One of the simplest forms of the Langevin equation is when its "noise term" is Gaussian; in this case, the Langevin equation is exactly equivalent to the convection–diffusion equation.14 However, the Langevin equation is more general.15
Numerical solution
The convection-diffusion equation can only rarely be solved with a pen and paper. More often, computers are used to numerically approximate the solution to the equation, typically using the finite element method. For more details and algorithms see: Numerical solution of the convection–diffusion equation.
Similar equations in other contexts
The convection–diffusion equation is a relatively simple equation describing flows, or alternatively, describing a stochastically-changing system. Therefore, the same or similar equation arises in many contexts unrelated to flows through space.

It is formally identical to the Fokker–Planck equation for the velocity of a particle.
It is closely related to the Black–Scholes equation and other equations in financial mathematics.
It is closely related to the Navier–Stokes equations, because the flow of momentum in a fluid is mathematically similar to the flow of mass or energy. The correspondence is clearest in the case of an incompressible Newtonian fluid, in which case the Navier–Stokes equation is:



 
  where M is the momentum of the fluid (per unit volume) at each point (equal to the density 
 
 
 
  multiplied by the velocity v), 
 
 
 
  is viscosity, P is fluid pressure, and f is any other body force such as gravity. In this equation, the term on the left-hand side describes the change in momentum at a given point; the first term on the right describes viscosity, which is really the diffusion of momentum; the second term on the right describes the advective flow of momentum; and the last two terms on the right describes the external and internal forces which can act as sources or sinks of momentum.
In semiconductor physics
In semiconductor physics, this equation is called the drift–diffusion equation. The word "drift" is related to drift current and drift velocity. The equation is normally written:











 
  where

n and p are the concentrations (densities) of electrons and holes, respectively,
q>0 is the elementary charge,
Jn and Jp are the electric currents due to electrons and holes respectively,
Jn/-q and Jp/q are the corresponding "particle currents" of electrons and holes respectively,
R represents carrier generation and recombination (R>0 for generation of electron-hole pairs, R<0 for recombination.)
E is the electric field vector


 
  and 
 
 
 
  are electron and hole mobility.

The diffusion coefficient and mobility are related by the Einstein relation as above:


 
  where kB is Boltzmann constant and T is absolute temperature. The drift current and diffusion current refer separately to the two terms in the expressions for J, i.e.:






See also

Conservation equations
Incompressible Navier-Stokes equations
Nernst–Planck equation
Double diffusive convection
Natural convection
Buckley–Leverett equation

References

Granville Sewell, The Numerical Solution of Ordinary and Partial Differential Equations, Academic Press (1988). ISBN 0-12-637475-9

"
Category:Diffusion Category:Parabolic partial differential equations Category:Stochastic differential equations Category:Transport phenomena Category:Equations of physics




Computational Fluid Dynamics in Industrial Combustion by Baukal and Gershtein, p67, [http://books.google.com/books?id=YlSbCgjjLrcC&pg;;=PA67 google books link].↩
Introduction to Climate Modelling, by Thomas Stocker, p57, [http://books.google.com/books?id=D4zulgFb5JwC&pg;;=PA57 google books link]↩
Advective Diffusion Equation, lecture notes by Scott A. Socolofsky and Gerhard H. Jirka, web link↩
↩
↩
↩

 See equation (312)↩
M. v. Smoluchowski, ''Über Brownsche Molekularbewegung unter Einwirkung äußerer Kräfte und den Zusammenhang mit der verallgemeinerten Diffusionsgleichung, Ann. Phys. 353 (4. Folge 48), 1103–1112 (1915), PDF link↩
http://www.ks.uiuc.edu/~kosztin/PHYCS498NSM/LectureNotes/chp4.pdf↩
The Theory of Polymer Dynamics by Doi and Edwards, p46-52, [http://books.google.com/books?id=dMzGyWs3GKcC&pg;;=PA46 google books link]↩








   Convection–diffusion equation      Convection–diffusion equation   The convection–diffusion equation is a combination of the diffusion and convection ( advection ) equations, and describes physical phenomena where particles, energy, or other physical quantities are transferred inside a physical system due to two processes: diffusion and convection . Depending on context, the same equation can be called the advection –diffusion equation , drift –diffusion equation , 1 or (generic) scalar transport equation . 2  Equation  General  The general equation is 3 4        ∂  c    ∂  t    =     ∇  ⋅   (   D   ∇  c    )    -   ∇  ⋅   (    v  →   c   )     +  R           c     t         normal-⋅  normal-∇    D   normal-∇  c      normal-⋅  normal-∇     normal-→  v   c     R     \frac{\partial c}{\partial t}=\nabla\cdot(D\nabla c)-\nabla\cdot(\vec{v}c)+R   where   c is the variable of interest (species concentration for mass transfer , temperature for heat transfer ),  D is the diffusivity (also called diffusion coefficient ), such as mass diffusivity for particle motion or thermal diffusivity for heat transport,      v  →     normal-→  v    \vec{v}   is the average velocity that the quantity is moving. For example, in advection , c might be the concentration of salt in a river, and then    v  →     normal-→  v    \vec{v}   would be the velocity of the water flow. As another example, c might be the concentration of small bubbles in a calm lake, and then    v  →     normal-→  v    \vec{v}   would be the average velocity of bubbles rising towards the surface by buoyancy (see below ). For multiphase flows and flows in porous media ,    v  →     normal-→  v    \vec{v}   is the (hypothetical) superficial velocity .  R describes "sources" or "sinks" of the quantity c . For example, for a chemical species, R >0 means that a chemical reaction is creating more of the species, and R 0 might occur if thermal energy is being generated by friction .     ∇   normal-∇   \nabla   represents gradient and    ∇  ⋅     fragments  normal-∇  normal-⋅    \nabla\cdot   represents divergence .   Understanding the terms involved  The right-hand side of the equation is the sum of three contributions.   The first,    ∇  ⋅   (   D   ∇  c    )      normal-⋅  normal-∇    D   normal-∇  c      \nabla\cdot(D\nabla c)   , describes diffusion . Imagine that c is the concentration of a chemical. When concentration is low somewhere compared to the surrounding areas (e.g. a local minimum of concentration), the substance will diffuse in from the surroundings, so the concentration will increase. Conversely, if concentration is high compared to the surroundings (e.g. a local maximum of concentration), then the substance will diffuse out and the concentration will decrease. The net diffusion is proportional to the Laplacian (or second derivative ) of concentration.  The second contribution,    -   ∇  ⋅   (    v  →   c   )         normal-⋅  normal-∇     normal-→  v   c      -\nabla\cdot(\vec{v}c)   , describes convection (or advection). Imagine standing on the bank of a river, measuring the water's salinity (amount of salt) each second. Upstream, somebody dumps a bucket of salt into the river. A while later, you would see the salinity suddenly rise, then fall, as the zone of salty water passes by. Thus, the concentration at a given location can change because of the flow.  The final contribution, R , describes the creation or destruction of the quantity. For example, if c is the concentration of a molecule, then R describes how the molecule can be created or destroyed by chemical reactions. R may be a function of c and of other parameters. Often there are several quantities, each with its own convection-diffusion equation, where the destruction of one quantity entails the creation of another. For example, when methane burns, it involves not only the destruction of methane and oxygen but also the creation of carbon dioxide and water vapor. Therefore, while each of these chemicals has its own convection-diffusion equation, they are "coupled together" and must be solved as a system of simultaneous differential equations.   Common simplifications  In a common situation, the diffusion coefficient is constant, there are no sources or sinks, and the velocity field describes an incompressible flow (i.e., it has zero divergence ). Then the formula simplifies to: 5 6 7         ∂  c    ∂  t    =    D    ∇  2   c    -    v  →   ⋅   ∇  c      .          c     t        D    superscript  normal-∇  2   c     normal-⋅   normal-→  v    normal-∇  c       \frac{\partial c}{\partial t}=D\nabla^{2}c-\vec{v}\cdot\nabla c.     In this form, the convection–diffusion equation combines both parabolic and hyperbolic  partial differential equations .  Stationary version  The stationary convection–diffusion equation describes the steady-state behavior of a convective-diffusive system. In steady-state,      ∂  c   /   ∂  t    =  0          c     t    0    \partial c/\partial t=0   , so the formula is:       0  =     ∇  ⋅   (   D   ∇  c    )    -   ∇  ⋅   (    v  →   c   )     +  R    .      0       normal-⋅  normal-∇    D   normal-∇  c      normal-⋅  normal-∇     normal-→  v   c     R     0=\nabla\cdot(D\nabla c)-\nabla\cdot(\vec{v}c)+R.     Derivation  The convection–diffusion equation can be derived in a straightforward way 8 from the continuity equation , which states that the rate of change for a scalar quantity in a differential  control volume is given by flow and diffusion into and out of that part of the system along with any generation or consumption inside the control volume:          ∂  c    ∂  t    +   ∇  ⋅   j  →     =  R   ,            c     t     normal-⋅  normal-∇   normal-→  j     R    \frac{\partial c}{\partial t}+\nabla\cdot\vec{j}=R,   where    j  →     normal-→  j    \vec{j}   is the total flux and R is a net volumetric source for c . There are two sources of flux in this situation. First, diffusive flux arises due to diffusion . This is typically approximated by Fick's first law :        j  →   diffusion   =   -    D    ∇  c          subscript   normal-→  j   diffusion       D   normal-∇  c       \vec{j}_{\text{diffusion}}=-D\,\nabla c   i.e., the flux of the diffusing material (relative to the bulk motion) in any part of the system is proportional to the local concentration gradient . Second, when there is overall convection or flow, there is an associated flux called advective flux :        j  →   advective   =     v  →    c        subscript   normal-→  j   advective      normal-→  v   c     \vec{j}_{\text{advective}}=\vec{v}\,c   The total flux (in a stationary coordinate system) is given by the sum of these two:        j  →   =     j  →   diffusion   +    j  →   advective    =    -    D    ∇  c     +     v  →    c     .         normal-→  j      subscript   normal-→  j   diffusion    subscript   normal-→  j   advective               D   normal-∇  c        normal-→  v   c       \vec{j}=\vec{j}_{\text{diffusion}}+\vec{j}_{\text{advective}}=-D\,\nabla c+%
 \vec{v}\,c.   Plugging into the continuity equation:          ∂  c    ∂  t    +   ∇  ⋅   (    -    D    ∇  c     +     v  →    c    )     =  R   .            c     t     normal-⋅  normal-∇        D   normal-∇  c        normal-→  v   c      R    \frac{\partial c}{\partial t}+\nabla\cdot\left(-D\,\nabla c+\vec{v}\,c\right)=R.     Complex mixing phenomena  In general, D ,    v  →     normal-→  v    \vec{v}   , and s may vary with space and time. In cases in which they depend on concentration as well, the equation becomes nonlinear, giving rise to many distinctive mixing phenomena such as Rayleigh–Bénard convection when    v  →     normal-→  v    \vec{v}   depends on temperature in the heat transfer formulation and reaction-diffusion pattern formation when s depends on concentration in the mass transfer formulation.  Velocity in response to a force  In some cases, the average velocity field    v  →     normal-→  v    \vec{v}   exists because of a force; for example, the equation might describe the flow of ions dissolved in a liquid, with an electric field pulling the ions in some direction (as in gel electrophoresis ). In this situation, it is usually called the drift-diffusion equation or the Smoluchowski equation , 9 after Marian Smoluchowski who described it in 1915 10 (not to be confused with the Einstein–Smoluchowski relation or Smoluchowski coagulation equation ).  Typically, the average velocity is directly proportional to the applied force, giving the equation: 11 12        ∂  c    ∂  t    =     ∇  ⋅   (   D   ∇  c    )    -   ∇  ⋅   (    ζ   -  1     F  →   c   )     +  R           c     t         normal-⋅  normal-∇    D   normal-∇  c      normal-⋅  normal-∇     superscript  ζ    1     normal-→  F   c     R     \frac{\partial c}{\partial t}=\nabla\cdot(D\nabla c)-\nabla\cdot(\zeta^{-1}%
 \vec{F}c)+R   where    F  →     normal-→  F    \vec{F}   is the force, and   ζ   ζ   \zeta   characterizes the friction or viscous drag . (The inverse    ζ   -  1      superscript  ζ    1     \zeta^{-1}   is called mobility .)  Derivation of Einstein relation  When the force is associated with a potential energy      F  →   =   -   ∇  U         normal-→  F      normal-∇  U      \vec{F}=-\nabla U   (see conservative force ), a steady-state solution to the above equation (i.e. 0 = R = ∂ c /∂ t ) is:      c  ∝   exp   (   -    D   -  1     ζ   -  1    U    )       proportional-to  c         superscript  D    1     superscript  ζ    1    U       c\propto\exp(-D^{-1}\zeta^{-1}U)   (assuming D and   ζ   ζ   \zeta   are constant). In other words, there are more particles where the energy is lower. This concentration profile is expected to agree with the Boltzmann distribution (more precisely, the Gibbs measure ). From this assumption, the Einstein relation can be proven     D  ζ   =    k  B   T         D  ζ      subscript  k  B   T     D\zeta=k_{B}T   . 13  As a stochastic differential equation  The convection–diffusion equation (with no sources or drains, R =0) can be viewed as a stochastic differential equation , describing random motion with diffusivity D and bias    v  →     normal-→  v    \vec{v}   . For example, the equation can describe the Brownian motion of a single particle, where the variable c describes the probability distribution for the particle to be in a given position at a given time. The reason the equation can be used that way is because there is no mathematical difference between the probability distribution of a single particle, and the concentration profile of a collection of infinitely many particles (as long as the particles do not interact with each other).  The Langevin equation describes advection, diffusion, and other phenomena in an explicitly stochastic way. One of the simplest forms of the Langevin equation is when its "noise term" is Gaussian ; in this case, the Langevin equation is exactly equivalent to the convection–diffusion equation. 14 However, the Langevin equation is more general. 15  Numerical solution  The convection-diffusion equation can only rarely be solved with a pen and paper. More often, computers are used to numerically approximate the solution to the equation, typically using the finite element method . For more details and algorithms see: Numerical solution of the convection–diffusion equation .  Similar equations in other contexts  The convection–diffusion equation is a relatively simple equation describing flows, or alternatively, describing a stochastically-changing system. Therefore, the same or similar equation arises in many contexts unrelated to flows through space.   It is formally identical to the Fokker–Planck equation for the velocity of a particle.  It is closely related to the Black–Scholes equation and other equations in financial mathematics.  It is closely related to the Navier–Stokes equations , because the flow of momentum in a fluid is mathematically similar to the flow of mass or energy. The correspondence is clearest in the case of an incompressible Newtonian fluid, in which case the Navier–Stokes equation is:         ∂  𝐌    ∂  t    =      μ  ρ     ∇  2   𝐌    -   𝐯  ⋅   ∇  𝐌     +   (   𝐟  -   ∇  P    )            𝐌     t            μ  ρ     superscript  normal-∇  2   𝐌     normal-⋅  𝐯   normal-∇  𝐌       𝐟   normal-∇  P       \frac{\partial\mathbf{M}}{\partial t}=\frac{\mu}{\rho}\nabla^{2}\mathbf{M}-%
 \mathbf{v}\cdot\nabla\mathbf{M}+(\mathbf{f}-\nabla\text{P})   where M is the momentum of the fluid (per unit volume) at each point (equal to the density   ρ   ρ   \rho   multiplied by the velocity v ),   μ   μ   \mu   is viscosity, P is fluid pressure, and f is any other body force such as gravity . In this equation, the term on the left-hand side describes the change in momentum at a given point; the first term on the right describes viscosity , which is really the diffusion of momentum; the second term on the right describes the advective flow of momentum; and the last two terms on the right describes the external and internal forces which can act as sources or sinks of momentum.  In semiconductor physics  In semiconductor physics , this equation is called the drift–diffusion equation . The word "drift" is related to drift current and drift velocity . The equation is normally written:        𝐉  n    -  q    =    -    D  n    ∇  n     -   n   μ  n   𝐄           subscript  𝐉  n     q           subscript  D  n    normal-∇  n       n   subscript  μ  n   𝐄      \frac{\mathbf{J}_{n}}{-q}=-D_{n}\nabla n-n\mu_{n}\mathbf{E}           𝐉  p   q   =    -    D  p    ∇  p     +   p   μ  p   𝐄           subscript  𝐉  p   q          subscript  D  p    normal-∇  p       p   subscript  μ  p   𝐄      \frac{\mathbf{J}_{p}}{q}=-D_{p}\nabla p+p\mu_{p}\mathbf{E}           ∂  n    ∂  t    =    -   ∇  ⋅    𝐉  n    -  q      +  R           n     t         normal-⋅  normal-∇     subscript  𝐉  n     q      R     \frac{\partial n}{\partial t}=-\nabla\cdot\frac{\mathbf{J}_{n}}{-q}+R           ∂  p    ∂  t    =    -   ∇  ⋅    𝐉  p   q     +  R           p     t         normal-⋅  normal-∇     subscript  𝐉  p   q     R     \frac{\partial p}{\partial t}=-\nabla\cdot\frac{\mathbf{J}_{p}}{q}+R   where   n and p are the concentrations (densities) of electrons and holes , respectively,  q >0 is the elementary charge ,  J n and J p are the electric currents due to electrons and holes respectively,  J n /- q and J p / q are the corresponding "particle currents" of electrons and holes respectively,  R represents carrier generation and recombination ( R >0 for generation of electron-hole pairs, R <0 for recombination.)  E is the electric field vector      μ  n     subscript  μ  n    \mu_{n}   and    μ  p     subscript  μ  p    \mu_{p}   are electron and hole mobility .   The diffusion coefficient and mobility are related by the Einstein relation as above:         D  n   =     μ  n    k  B   T   /  q    ,    D  p   =     μ  p    k  B   T   /  q     ,     formulae-sequence     subscript  D  n        subscript  μ  n    subscript  k  B   T   q       subscript  D  p        subscript  μ  p    subscript  k  B   T   q      D_{n}=\mu_{n}k_{B}T/q,\quad D_{p}=\mu_{p}k_{B}T/q,   where k B is Boltzmann constant and T is absolute temperature . The drift current and diffusion current refer separately to the two terms in the expressions for J , i.e.:         𝐉   n  ,  drift    /   (   -  q   )    =   -   n   μ  n   𝐄     ,     𝐉   p  ,  drift    /  q   =   p   μ  p   𝐄       formulae-sequence       subscript  𝐉   n  drift      q        n   subscript  μ  n   𝐄          subscript  𝐉   p  drift    q     p   subscript  μ  p   𝐄      \mathbf{J}_{n,\text{drift}}/(-q)=-n\mu_{n}\mathbf{E},\qquad\mathbf{J}_{p,\text%
 {drift}}/q=p\mu_{p}\mathbf{E}             𝐉   n  ,  diffusion    /   (   -  q   )    =   -    D  n    ∇  n      ,     𝐉   p  ,  diffusion    /  q   =   -    D  p    ∇  p       .     formulae-sequence       subscript  𝐉   n  diffusion      q         subscript  D  n    normal-∇  n           subscript  𝐉   p  diffusion    q        subscript  D  p    normal-∇  p        \mathbf{J}_{n,\text{diffusion}}/(-q)=-D_{n}\nabla n,\qquad\mathbf{J}_{p,\text{%
 diffusion}}/q=-D_{p}\nabla p.     See also   Conservation equations  Incompressible Navier-Stokes equations  Nernst–Planck equation  Double diffusive convection  Natural convection  Buckley–Leverett equation   References   Granville Sewell, The Numerical Solution of Ordinary and Partial Differential Equations , Academic Press (1988). ISBN 0-12-637475-9   "  Category:Diffusion  Category:Parabolic partial differential equations  Category:Stochastic differential equations  Category:Transport phenomena  Category:Equations of physics      Computational Fluid Dynamics in Industrial Combustion by Baukal and Gershtein, p67, [ http://books.google.com/books?id=YlSbCgjjLrcC&pg; ;=PA67 google books link]. ↩  Introduction to Climate Modelling , by Thomas Stocker, p57, [ http://books.google.com/books?id=D4zulgFb5JwC&pg; ;=PA57 google books link] ↩  Advective Diffusion Equation , lecture notes by Scott A. Socolofsky and Gerhard H. Jirka, web link ↩  ↩  ↩  ↩   See equation (312) ↩  M. v. Smoluchowski, ''Über Brownsche Molekularbewegung unter Einwirkung äußerer Kräfte und den Zusammenhang mit der verallgemeinerten Diffusionsgleichung, Ann. Phys. 353 (4. Folge 48), 1103–1112 (1915), PDF link ↩  http://www.ks.uiuc.edu/~kosztin/PHYCS498NSM/LectureNotes/chp4.pdf ↩  The Theory of Polymer Dynamics by Doi and Edwards, p46-52, [ http://books.google.com/books?id=dMzGyWs3GKcC&pg; ;=PA46 google books link] ↩        
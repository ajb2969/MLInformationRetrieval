   Legendre sieve      Legendre sieve   In mathematics , the Legendre sieve , named after Adrien-Marie Legendre , is the simplest method in modern sieve theory . It applies the concept of the Sieve of Eratosthenes to find upper or lower bounds on the number of primes within a given set of integers. Because it is a simple extension of Eratosthenes ' idea, it is sometimes called the Legendre–Eratosthenes sieve . 1  Legendre's identity  The central idea of the method is expressed by the following identity, sometimes called the Legendre identity :        S   (  A  ,  P  )    =    ∑   a  ∈  A      ∑   d  ∣  a  ;  d  ∣  P     μ   (  d  )      =    ∑   d  ∣  P     μ   (  d  )    |   A  d   |      ,          S   A  P      subscript     a  A      subscript    fragments  d  normal-∣  a  normal-;  d  normal-∣  P      μ  d            subscript    fragments  d  normal-∣  P      μ  d     subscript  A  d         S(A,P)=\sum_{a\in A}\sum_{d\mid a;\,d\mid P}\mu(d)=\sum_{d\mid P}\mu(d)|A_{d}|,     where A is a set of integers, P is a product of distinct primes,   μ   μ   \mu   is the Möbius function , and    A  d     subscript  A  d    A_{d}   is the set of integers in A divisible by d , and S(A, P) is defined to be:       S   (  A  ,  P  )    =   |   {  n  :    n  ∈  A   ,    (  n  ,  P  )   =  1    }   |         S   A  P       conditional-set  n   formulae-sequence    n  A      n  P   1        S(A,P)=|\{n:n\in A,(n,P)=1\}|     i.e. S ( A , P ) is the count of numbers in A with no factors common with P .  Note that in the most typical case, A is all integers less than or equal to some real number X , P is the product of all primes less than or equal to some integer z \begin{align} S(A,P) & = \sum_{d\mid P}\mu(d)\left\lfloor\frac{X}{d}\right\rfloor \\ & = [X] - \sum_{p_1  (where    ⌊  X  ⌋      X    \lfloor X\rfloor   denotes the floor function ). In this example the fact that the Legendre identity is derived from the Sieve of Eratosthenes is clear: the first term is the number of integers below X , the second term removes the multiples of all primes, the third term adds back the multiples of two primes (which were miscounted by being "crossed out twice"), and so on until all    2   π   (  z  )       superscript  2    π  z     2^{\pi(z)}   (where    π   (  z  )       π  z    \pi(z)   denotes the number of primes below z ) combinations of primes have been covered.  Once S ( A , P ) has been calculated for this special case, it can be used to bound    π   (  X  )       π  X    \pi(X)   using the expression        S   (  A  ,  P  )    ≥     π   (  X  )    -   π   (  z  )     +  1    ,        S   A  P          π  X     π  z    1     S(A,P)\geq\pi(X)-\pi(z)+1,\,     which follows immediately from the definition of S ( A , P ).  Limitations  Unfortunately, the Legendre sieve has a problem with fractional parts of terms accumulating into a large error, which means the sieve only gives very weak bounds in most cases. For this reason it is almost never used in practice, having been superseded by other techniques such as the Brun sieve and Selberg sieve . However, since these more powerful sieves are extensions of the basic ideas of the Legendre sieve, it is useful to first understand how this sieve works.  References  "  Category:Sieve theory     Iwaniec, Henryk. The sieve of Eratosthenes-Legendre . Annali della Scuola Normale Superiore di Pisa - Classe di Scienze, Sér. 4, 4 no. 2 (1977), p. 257-268 MR 453676 ↩     
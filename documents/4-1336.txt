   Convex conjugate      Convex conjugate   In mathematics , convex conjugation is a generalization of the Legendre transformation . It is also known as Legendre–Fenchel transformation or Fenchel transformation (after Adrien-Marie Legendre and Werner Fenchel ).  Definition  Let   X   X   X   be a real  normed vector space , and let    X  *     superscript  X     X^{*}   be the dual space to   X   X   X   . Denote the dual pairing by        ⟨  ⋅  ,  ⋅  ⟩   :     X  *   ×  X   →  ℝ    .     normal-:   normal-⋅  normal-⋅    normal-→     superscript  X    X   ℝ     \langle\cdot,\cdot\rangle:X^{*}\times X\to\mathbb{R}.     For a functional      f  :   X  →   ℝ  ∪   {   +  ∞   }        normal-:  f   normal-→  X    ℝ            f:X\to\mathbb{R}\cup\{+\infty\}     taking values on the extended real number line , the convex conjugate       f  ⋆   :    X  *   →   ℝ  ∪   {   +  ∞   }        normal-:   superscript  f  normal-⋆    normal-→   superscript  X      ℝ            f^{\star}:X^{*}\to\mathbb{R}\cup\{+\infty\}     is defined in terms of the supremum by         f  ⋆    (   x  *   )    :=   sup   {    ⟨   x  *   ,  x  ⟩   -   f   (  x  )     |   x  ∈  X   }     ,     assign     superscript  f  normal-⋆    superscript  x      supremum   conditional-set      superscript  x    x     f  x      x  X       f^{\star}\left(x^{*}\right):=\sup\left\{\left.\left\langle x^{*},x\right%
 \rangle-f\left(x\right)\right|x\in X\right\},     or, equivalently, in terms of the infimum by         f  ⋆    (   x  *   )    :=   -   inf   {    f   (  x  )    -   ⟨   x  *   ,  x  ⟩    |   x  ∈  X   }      .     assign     superscript  f  normal-⋆    superscript  x        infimum   conditional-set      f  x     superscript  x    x      x  X        f^{\star}\left(x^{*}\right):=-\inf\left\{\left.f\left(x\right)-\left\langle x^%
 {*},x\right\rangle\right|x\in X\right\}.     This definition can be interpreted as an encoding of the convex hull of the function's epigraph in terms of its supporting hyperplanes . 1  2  Examples  The convex conjugate of an affine function        f   (  x  )    =    ⟨  a  ,  x  ⟩   -  b    ,    a  ∈   ℝ  n    ,   b  ∈  ℝ       formulae-sequence      f  x      a  x   b     formulae-sequence    a   superscript  ℝ  n      b  ℝ      f(x)=\left\langle a,x\right\rangle-b,\,a\in\mathbb{R}^{n},b\in\mathbb{R}   is        f  ⋆    (   x  *   )    =   {      b  ,       x  *   =  a         +  ∞   ,        x  *   ≠  a   .              superscript  f  normal-⋆    superscript  x      cases  b     superscript  x    a          superscript  x    a      f^{\star}\left(x^{*}\right)=\begin{cases}b,&x^{*}=a\\
 +\infty,&x^{*}\neq a.\end{cases}     The convex conjugate of a power function       f   (  x  )    =   |  x  |         f  x     x     f(x)=\left|x\right|     The convex conjugate of the absolute value function        f  ⋆    (   x  *   )    =   {      0  ,       |   x  *   |   ≤  1        ∞  ,       |   x  *   |   >  1.              superscript  f  normal-⋆    superscript  x      cases  0       superscript  x     1         superscript  x     1.      f^{\star}\left(x^{*}\right)=\begin{cases}0,&\left|x^{*}\right|\leq 1\\
 \infty,&\left|x^{*}\right|>1.\end{cases}   is       f   (  x  )    =   e  x         f  x    superscript  e  x     f(x)=\,\!e^{x}     The convex conjugate of the exponential function       f  ⋆    (   x  *   )    =   {         x  *    ln   x  *     -   x  *    ,       x  *   >  0        0  ,       x  *   =  0        ∞  ,       x  *   <  0.              superscript  f  normal-⋆    superscript  x      cases       superscript  x       superscript  x       superscript  x        superscript  x    0   0     superscript  x    0       superscript  x    0.      f^{\star}\left(x^{*}\right)=\begin{cases}x^{*}\ln x^{*}-x^{*},&x^{*}>0\\
 0,&x^{*}=0\\
 \infty,&x^{*}<0.\end{cases}   is       f   (  x  )    :=    ∫   -  ∞   x    F   (  u  )   d  u    =   E   [   max   (  0  ,   x  -  X   )    ]    =   x  -   E   [   min   (  x  ,  X  )    ]          assign    f  x     superscript   subscript        x     F  u  d  u          normal-E    0    x  X            x   normal-E    x  X        f(x):=\int_{-\infty}^{x}F(u)\,du=\operatorname{E}\left[\max(0,x-X)\right]=x-%
 \operatorname{E}\left[\min(x,X)\right]   Convex conjugate and Legendre transform of the exponential function agree except that the domain of the convex conjugate is strictly larger as the Legendre transform is only defined for positive real numbers.  Connection with expected shortfall (average value at risk)  Let F denote a cumulative distribution function of a random variable  X . Then (integrating by parts),         f  ⋆    (  p  )    =    ∫  0  p     F   -  1     (  q  )   d  q    =     (   p  -  1   )    F   -  1     (  p  )    +   E   [   min   (    F   -  1     (  p  )    ,  X  )    ]     =    p   F   -  1     (  p  )    -   E   [   max   (  0  ,     F   -  1     (  p  )    -  X   )    ]      .           superscript  f  normal-⋆   p     superscript   subscript   0   p      superscript  F    1    q  d  q               p  1    superscript  F    1    p    normal-E       superscript  F    1    p   X              p   superscript  F    1    p    normal-E    0       superscript  F    1    p   X         f^{\star}(p)=\int_{0}^{p}F^{-1}(q)\,dq=(p-1)F^{-1}(p)+\operatorname{E}\left[%
 \min(F^{-1}(p),X)\right]=pF^{-1}(p)-\operatorname{E}\left[\max(0,F^{-1}(p)-X)%
 \right].   has the convex conjugate         f  inc    (  x  )    :=    arg     sup  t     t  ⋅  x     -    ∫  0  1     max   {   t  -   f   (  u  )     ,  0  }    d  u      ,     assign     superscript  f  inc   x          subscript  supremum  t    normal-⋅  t  x       superscript   subscript   0   1         t    f  u    0   normal-d  u       f^{\text{inc}}(x):=\arg\sup_{t}\,t\cdot x-\int_{0}^{1}\max\{t-f(u),0\}\,%
 \mathrm{d}u,     Ordering  A particular interpretation has the transform       f  inc   =  f       superscript  f  inc   f    f^{\text{inc}}=f     as this is a nondecreasing rearrangement of the initial function f; in particular,    f  ≤  g      f  g    f\leq g   for ƒ nondecreasing.  Properties  The convex conjugate of a closed convex function is again a closed convex function. The convex conjugate of a polyhedral convex function (a convex function with polyhedral  epigraph ) is again a polyhedral convex function.  Order reversing  Convex-conjugation is order-reversing : if     f  *   ≥   g  *        superscript  f     superscript  g      f^{*}\geq g^{*}   then     (  f  ≤  g  )   :  ⇔   (  ∀  x  ,  f   (  x  )   ≤  g   (  x  )   )   .     fragments   fragments  normal-(  f   g  normal-)   normal-:  iff   fragments  normal-(  for-all  x  normal-,  f   fragments  normal-(  x  normal-)    g   fragments  normal-(  x  normal-)   normal-)   normal-.    (f\leq g):\iff(\forall x,f(x)\leq g(x)).   . Here       (   f  α   )   α     subscript   subscript  f  α   α    \left(f_{\alpha}\right)_{\alpha}     For a family of functions        (    inf  α    f  α    )   *    (  x  )    =    sup  α     f  α  *    (  x  )      ,         superscript    subscript  infimum  α    subscript  f  α      x     subscript  supremum  α      superscript   subscript  f  α     x      \left(\inf_{\alpha}f_{\alpha}\right)^{*}(x)=\sup_{\alpha}f_{\alpha}^{*}(x),   it follows from the fact that supremums may be interchanged that          (    sup  α    f  α    )   *    (  x  )    ≤    inf  α     f  α  *    (  x  )      .         superscript    subscript  supremum  α    subscript  f  α      x     subscript  infimum  α      superscript   subscript  f  α     x      \left(\sup_{\alpha}f_{\alpha}\right)^{*}(x)\leq\inf_{\alpha}f_{\alpha}^{*}(x).     and from the max–min inequality that      f    *  *      superscript  f    absent      f^{**}     Biconjugate  The convex conjugate of a function is always lower semi-continuous . The biconjugate      f    *  *    ≤  f       superscript  f    absent     f    f^{**}\leq f   (the convex conjugate of the convex conjugate) is also the closed convex hull , i.e. the largest lower semi-continuous convex function with    f  =   f    *  *        f   superscript  f    absent       f=f^{**}   . For proper functions  f ,     f   f   f    if and only if  f is convex and lower semi-continuous by Fenchel–Moreau theorem .  Fenchel's inequality  For any function    f  *     fragments  f     f*   and its convex conjugate    x  ∈  X      x  normal-∈  X    x∈X   , Fenchel's inequality (also known as the Fenchel–Young inequality ) holds for every    p  ∈  X  *     fragments  p  ∈  X     p∈X*   and      ⟨  p  ,  x  ⟩   ≤    f   (  x  )    +    f  *    (  p  )      .       p  x       f  x      superscript  f    p      \left\langle p,x\right\rangle\leq f(x)+f^{*}(p).   :      f  0     subscript  f  0    f_{0}     Convexity  For two functions    f  1     subscript  f  1    f_{1}   and    0  ≤  λ  ≤  1        0  λ       1     0\leq\lambda\leq 1   and a number      (     (   1  -  λ   )    f  0    +   λ   f  1     )   ⋆   ≤     (   1  -  λ   )    f  0  ⋆    +   λ   f  1  ⋆          superscript        1  λ    subscript  f  0      λ   subscript  f  1     normal-⋆         1  λ    superscript   subscript  f  0   normal-⋆      λ   superscript   subscript  f  1   normal-⋆       \left((1-\lambda)f_{0}+\lambda f_{1}\right)^{\star}\leq(1-\lambda)f_{0}^{\star%
 }+\lambda f_{1}^{\star}   the convexity relation     ⋆   normal-⋆   \star   holds. The       (   f  □  g   )    (  x  )    =   inf   {    f   (   x  -  y   )    +   g   (  y  )     |   y  ∈   ℝ  n    }     .          f  normal-□  g   x    infimum   conditional-set      f    x  y      g  y      y   superscript  ℝ  n        \left(f\Box g\right)(x)=\inf\left\{f(x-y)+g(y)\,|\,y\in\mathbb{R}^{n}\right\}.   operation is a convex mapping itself.  Infimal convolution  The infimal convolution (or epi-sum) of two functions f and g is defined as         (    f  1   □  ⋯  □   f  m    )   ⋆   =    f  1  ⋆   +  ⋯  +   f  m  ⋆     .       superscript     subscript  f  1   normal-□  normal-⋯  normal-□   subscript  f  m    normal-⋆      superscript   subscript  f  1   normal-⋆   normal-⋯   superscript   subscript  f  m   normal-⋆      \left(f_{1}\Box\cdots\Box f_{m}\right)^{\star}=f_{1}^{\star}+\cdots+f_{m}^{%
 \star}.     Let f 1 , …, f m be proper, convex and lsc functions on R n . Then the infimal convolution is convex and lsc (but not necessarily proper), 3 and satisfies     f   f   f     The infimal convolution of two functions has a geometric interpretation: The (strict) epigraph of the infimal convolution of two functions is the Minkowski sum of the (strict) epigraphs of those functions. 4  Maximizing argument  If the function      f  ′    (  x  )    =    x  *    (  x  )    :=    arg    sup   x  ⋆     ⟨  x  ,   x  ⋆   ⟩     -    f  ⋆    (   x  ⋆   )              superscript  f  normal-′   x      superscript  x    x     assign           subscript  supremum   superscript  x  normal-⋆     x   superscript  x  normal-⋆         superscript  f  normal-⋆    superscript  x  normal-⋆        f^{\prime}(x)=x^{*}(x):=\arg\sup_{x^{\star}}{\langle x,x^{\star}\rangle}-f^{%
 \star}(x^{\star})   is differentiable, then its derivative is the maximizing argument in the computation of the convex conjugate:         f   ⋆  ′     (   x  ⋆   )    =   x   (   x  ⋆   )    :=    arg    sup  x    ⟨  x  ,   x  ⋆   ⟩     -   f   (  x  )      ;           superscript  f   normal-⋆  normal-′     superscript  x  normal-⋆      x   superscript  x  normal-⋆      assign           subscript  supremum  x    x   superscript  x  normal-⋆        f  x       f^{\star\prime}(x^{\star})=x(x^{\star}):=\arg\sup_{x}{\langle x,x^{\star}%
 \rangle}-f(x);   and       x  =    ∇   f  ⋆     (    ∇  f    (  x  )    )     ,      x     normal-∇   superscript  f  normal-⋆       normal-∇  f   x      x=\nabla f^{\star}(\nabla f(x)),     whence        x  ⋆   =    ∇  f    (    ∇   f  ⋆     (   x  ⋆   )    )     ,       superscript  x  normal-⋆      normal-∇  f      normal-∇   superscript  f  normal-⋆     superscript  x  normal-⋆       x^{\star}=\nabla f(\nabla f^{\star}(x^{\star})),              f  ′′    (  x  )    ⋅   f   ⋆  ′′      (    x  ⋆    (  x  )    )    =  1   ,         normal-⋅     superscript  f  ′′   x    superscript  f   normal-⋆  ′′        superscript  x  normal-⋆   x    1    f^{\prime\prime}(x)\cdot f^{\star\prime\prime}(x^{\star}(x))=1,     and moreover          f   ⋆  ′′     (   x  ⋆   )    ⋅   f  ′′     (   x   (   x  ⋆   )    )    =  1.         normal-⋅     superscript  f   normal-⋆  ′′     superscript  x  normal-⋆     superscript  f  ′′      x   superscript  x  normal-⋆     1.    f^{\star\prime\prime}(x^{\star})\cdot f^{\prime\prime}(x(x^{\star}))=1.         γ  >  0      γ  0    \gamma>0     Scaling properties  If, for some      g    (  x  )    =   α  +   β  x   +    γ  ⋅  f    (    λ  x   +  δ   )           g  x     α    β  x      normal-⋅  γ  f       λ  x   δ       \,g(x)=\alpha+\beta x+\gamma\cdot f(\lambda x+\delta)   ,       g  ⋆    (   x  ⋆   )    =     -  α   -   δ     x  ⋆   -  β   λ     +    γ  ⋅   f  ⋆     (     x  ⋆   -  β    λ  γ    )      .         superscript  g  normal-⋆    superscript  x  normal-⋆          α     δ       superscript  x  normal-⋆   β   λ        normal-⋅  γ   superscript  f  normal-⋆         superscript  x  normal-⋆   β     λ  γ        g^{\star}(x^{\star})=-\alpha-\delta\frac{x^{\star}-\beta}{\lambda}+\gamma\cdot
 f%
 ^{\star}\left(\frac{x^{\star}-\beta}{\lambda\gamma}\right).   , then         f  α    (  x  )    =   -    f  α    (   x  ~   )      ,         subscript  f  α   x        subscript  f  α    normal-~  x       f_{\alpha}(x)=-f_{\alpha}(\tilde{x}),   In case of an additional parameter (α, say) moreover      x  ~     normal-~  x    \tilde{x}   where      (   A  f   )   ⋆   =    f  ⋆    A  ⋆         superscript    A  f   normal-⋆      superscript  f  normal-⋆    superscript  A  normal-⋆      \left(Af\right)^{\star}=f^{\star}A^{\star}   is chosen to be the maximizing argument.  Behavior under linear transformations  Let A be a bounded linear operator from X to Y . For any convex function f on X , one has        (   A  f   )    (  y  )    =   inf   {   f   (  x  )    :    x  ∈  X   ,    A  x   =  y    }            A  f   y    infimum   conditional-set    f  x    formulae-sequence    x  X       A  x   y        (Af)(y)=\inf\{f(x):x\in X,Ax=y\}     where        f   (   A  x   )    =    f   (  x  )    ,   ∀  x     ,    ∀  A   ∈  G      formulae-sequence      f    A  x       f  x    for-all  x        for-all  A   G     f\left(Ax\right)=f(x),\;\forall x,\;\forall A\in G     is the preimage of f w.r.t. A and A * is the adjoint operator of A . 5  A closed convex function f is symmetric with respect to a given set G of orthogonal linear transformations ,      g   (  x  )       g  x    g(x)     if and only if its convex conjugate f * is symmetric with respect to G .  Table of selected convex conjugates  The following table provides Legendre transforms for many common functions as well as a few useful properties. 6          dom   (  g  )      dom  g    \operatorname{dom}(g)           g  *    (   x  *   )        superscript  g     superscript  x      g^{*}(x^{*})          dom   (   g  *   )      dom   superscript  g      \operatorname{dom}(g^{*})          f   (   a  x   )       f    a  x     f(ax)              a  ≠  0      a  0    a\neq 0   (where   X   X   X   )        f  *    (    x  *   a   )        superscript  f       superscript  x    a     f^{*}\left(\frac{x^{*}}{a}\right)          X  *     superscript  X     X^{*}          f   (   x  +  b   )       f    x  b     f(x+b)           X   X   X            f  *    (   x  *   )    -   ⟨  b  ,   x  *   ⟩          superscript  f     superscript  x      b   superscript  x       f^{*}(x^{*})-\langle b,x^{*}\rangle          X  *     superscript  X     X^{*}          a  f   (  x  )       a  f  x    af(x)            a  >  0      a  0    a>0   (where   X   X   X   )       a   f  *    (    x  *   a   )       a   superscript  f       superscript  x    a     af^{*}\left(\frac{x^{*}}{a}\right)          X  *     superscript  X     X^{*}          α  +   β  x   +    γ  ⋅  f    (    λ  x   +  δ   )        α    β  x      normal-⋅  γ  f       λ  x   δ      \alpha+\beta x+\gamma\cdot f(\lambda x+\delta)           X   X   X          -  α  -  δ     x  *   -  β   λ   +  γ  ⋅   f  *    (     x  *   -  β    γ  λ    )    (  γ  >  0  )      fragments   α   δ       superscript  x    β   λ    γ  normal-⋅   superscript  f     fragments  normal-(       superscript  x    β     γ  λ    normal-)     fragments  normal-(  γ   0  normal-)     -\alpha-\delta\frac{x^{*}-\beta}{\lambda}+\gamma\cdot f^{*}\left(\frac{x^{*}-%
 \beta}{\gamma\lambda}\right)\quad(\gamma>0)          X  *     superscript  X     X^{*}            |  x  |   p   p       superscript    x   p   p    \frac{|x|^{p}}{p}            p  >  1      p  1    p>1   (where   ℝ   ℝ   \mathbb{R}   )         |   x  *   |   q   q       superscript     superscript  x     q   q    \frac{|x^{*}|^{q}}{q}            1  p   +   1  q    =  1          1  p     1  q    1    \frac{1}{p}+\frac{1}{q}=1   (where   ℝ   ℝ   \mathbb{R}   )        -   x  p    p         superscript  x  p    p    \frac{-x^{p}}{p}            0  <  p  <  1        0  p       1     0   (where    ℝ  +     subscript  ℝ     \mathbb{R}_{+}   )        -    (   -   x  *    )   q    q         superscript     superscript  x     q    q    \frac{-(-x^{*})^{q}}{q}            1  p   +   1  q    =  1          1  p     1  q    1    \frac{1}{p}+\frac{1}{q}=1   (where    ℝ    -  -      subscript  ℝ    absent      \mathbb{R}_{--}   )        1  +   x  2          1   superscript  x  2      \sqrt{1+x^{2}}           ℝ   ℝ   \mathbb{R}          -    1  -    (   x  *   )   2             1   superscript   superscript  x    2       -\sqrt{1-(x^{*})^{2}}          [   -  1   ,  1  ]       1   1    [-1,1]          -   log   (  x  )          x     -\log(x)            ℝ    +  +      subscript  ℝ    absent      \mathbb{R}_{++}          -   (   1  +   log   (   -   x  *    )     )         1       superscript  x         -(1+\log(-x^{*}))          ℝ    -  -      subscript  ℝ    absent      \mathbb{R}_{--}          e  x     superscript  e  x    e^{x}           ℝ   ℝ   \mathbb{R}          {        x  *    log   (   x  *   )     -   x  *        if   x  *    >  0       0      if   x  *    =  0         cases       superscript  x       superscript  x       superscript  x         if   superscript  x     0   0      if   superscript  x     0     \begin{cases}x^{*}\log(x^{*})-x^{*}&\text{if }x^{*}>0\\
 0&\text{if }x^{*}=0\end{cases}          ℝ  +     subscript  ℝ     \mathbb{R}_{+}          log   (   1  +   e  x    )         1   superscript  e  x      \log\left(1+e^{x}\right)           ℝ   ℝ   \mathbb{R}          {        x  *    log   (   x  *   )     +    (   1  -   x  *    )    log   (   1  -   x  *    )          if  0   <   x  *   <  1       0      if   x  *    =   0  ,  1          cases       superscript  x       superscript  x          1   superscript  x         1   superscript  x              if  0    superscript  x         1    0      if   superscript  x      0  1      \begin{cases}x^{*}\log(x^{*})+(1-x^{*})\log(1-x^{*})&\text{if }0          [  0  ,  1  ]     0  1    [0,1]          -   log   (   1  -   e  x    )            1   superscript  e  x       -\log\left(1-e^{x}\right)           ℝ   ℝ   \mathbb{R}          {        x  *    log   (   x  *   )     -    (   1  +   x  *    )    log   (   1  +   x  *    )          if   x  *    >  0       0      if   x  *    =  0         cases       superscript  x       superscript  x          1   superscript  x         1   superscript  x            if   superscript  x     0   0      if   superscript  x     0     \begin{cases}x^{*}\log(x^{*})-(1+x^{*})\log(1+x^{*})&\text{if }x^{*}>0\\
 0&\text{if }x^{*}=0\end{cases}          ℝ  +     subscript  ℝ     \mathbb{R}_{+}      $\mathbb{R}_+$     See also   Dual problem  Fenchel's duality theorem  Legendre transformation  Young's inequality   References        External links            "  Category:Convex analysis  Category:Duality theories  Category:Transforms     ↩  ↩  ↩  ↩  Ioffe, A.D. and Tichomirov, V.M. (1979), Theorie der Extremalaufgaben . Deutscher Verlag der Wissenschaften. Satz 3.4.3 ↩  ↩     
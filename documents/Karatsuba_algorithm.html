<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="953">Karatsuba algorithm</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Karatsuba algorithm</h1>
<hr/>

<p>The <strong>Karatsuba algorithm</strong> is a fast <a href="multiplication_algorithm" title="wikilink">multiplication algorithm</a>. It was discovered by <a href="Anatolii_Alexeevitch_Karatsuba" title="wikilink">Anatolii Alexeevitch Karatsuba</a> in 1960 and published in 1962.<ref name="kara1962"></ref></p>

<p><code> </code></p>

<p><ref name="kara1995"></ref></p>

<p><code> </code></p>

<p><ref name="knuthV2"></ref></p>

<p><code> Knuth D.E. (1969) </code><em><code>The</code> <code>art</code> <code>of</code> <code>computer</code> <code>programming.</code> <code>v.2.</code></em><code> Addison-Wesley Publ.Co., 724 pp.</code></p>

<p> It reduces the multiplication of two <em>n</em>-digit numbers to at most 

<math display="inline" id="Karatsuba_algorithm:0">
 <semantics>
  <mrow>
   <msup>
    <mi>n</mi>
    <mrow>
     <msub>
      <mi>log</mi>
      <mn>2</mn>
     </msub>
     <mn>3</mn>
    </mrow>
   </msup>
   <mo>≈</mo>
   <msup>
    <mi>n</mi>
    <mn>1.585</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <log></log>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="float">1.585</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{\log_{2}3}\approx n^{1.585}
  </annotation>
 </semantics>
</math>

 single-digit multiplications in general (and exactly 

<math display="inline" id="Karatsuba_algorithm:1">
 <semantics>
  <msup>
   <mi>n</mi>
   <mrow>
    <msub>
     <mi>log</mi>
     <mn>2</mn>
    </msub>
    <mn>3</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <log></log>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{\log_{2}3}
  </annotation>
 </semantics>
</math>

 when <em>n</em> is a power of 2). It is therefore faster than the <a href="long_multiplication" title="wikilink">classical</a> algorithm, which requires <em>n</em><sup>2</sup> single-digit products. For example, the Karatsuba algorithm requires 3<sup>10</sup> = 59,049 single-digit multiplications to multiply two 1024-digit numbers (<em>n</em> = 1024 = 2<sup>10</sup>), whereas the classical algorithm requires (2<sup>10</sup>)<sup>2</sup> = 1,048,576.</p>

<p>The Karatsuba algorithm was the first multiplication algorithm asymptotically faster than the quadratic "grade school" algorithm. The <a href="Toom–Cook_multiplication" title="wikilink">Toom–Cook algorithm</a> is a faster generalization of Karatsuba's method, and the <a href="Schönhage–Strassen_algorithm" title="wikilink">Schönhage–Strassen algorithm</a> is even faster, for sufficiently large <em>n</em>.</p>
<h2 id="history">History</h2>

<p>The standard procedure for multiplication of two <em>n</em>-digit numbers requires a number of elementary operations proportional to 

<math display="inline" id="Karatsuba_algorithm:2">
 <semantics>
  <msup>
   <mi>n</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n^{2}\,\!
  </annotation>
 </semantics>
</math>

, or 

<math display="inline" id="Karatsuba_algorithm:3">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(n^{2})\,\!
  </annotation>
 </semantics>
</math>

 in the <a href="big-O_notation" title="wikilink">big-O notation</a>. In 1952, <a href="Andrey_Kolmogorov" title="wikilink">Andrey Kolmogorov</a> conjectured that the classical algorithm was <em><a href="asymptotically_optimal" title="wikilink">asymptotically optimal</a>,</em> meaning that any algorithm for that task would require 

<math display="inline" id="Karatsuba_algorithm:4">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Ω</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega(n^{2})\,\!
  </annotation>
 </semantics>
</math>

 elementary operations.</p>

<p>In 1960, Kolmogorov organized a seminar on mathematical problems in <a class="uri" href="cybernetics" title="wikilink">cybernetics</a> at the <a href="Moscow_State_University" title="wikilink">Moscow State University</a>, where he stated the 

<math display="inline" id="Karatsuba_algorithm:5">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Ω</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega(n^{2})\,\!
  </annotation>
 </semantics>
</math>

 conjecture and other problems in the <a href="Computational_complexity_theory" title="wikilink">complexity of computation</a>. Within a week, Karatsuba, then a 23-year-old student, found an algorithm (later it was called "divide and conquer") that multiplies two <em>n</em>-digit numbers in 

<math display="inline" id="Karatsuba_algorithm:6">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mrow>
      <msub>
       <mi>log</mi>
       <mn>2</mn>
      </msub>
      <mn>3</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <log></log>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(n^{\log_{2}3})
  </annotation>
 </semantics>
</math>

 elementary steps, thus disproving the conjecture. Kolmogorov was very agitated about the discovery; he communicated it at the next meeting of the seminar, which was then terminated. Kolmogorov did some lectures on the Karatsuba result at the conferences all over the world (see, for example, "Proceedings of the international congress of mathematicians 1962", pp. 351--356, and also "6 Lectures delivered at the International Congress of Mathematicians in Stockholm, 1962") and published the method in 1962, in the <a href="Proceedings_of_the_USSR_Academy_of_Sciences" title="wikilink">Proceedings of the USSR Academy of Sciences</a>. The article had been written by Kolmogorov and contained two results on multiplication, Karatsuba's algorithm and a separate result by <a href="Yuri_Petrovich_Ofman" title="wikilink">Yuri Ofman</a>; it listed "A. Karatsuba and Yu. Ofman" as the authors. Karatsuba only became aware of the paper when he received the reprints from the publisher.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="algorithm">Algorithm</h2>
<h3 id="the-basic-step">The basic step</h3>

<p>The basic step of Karatsuba's algorithm is a formula that allows us to compute the product of two large numbers 

<math display="inline" id="Karatsuba_algorithm:7">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Karatsuba_algorithm:8">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 using three multiplications of smaller numbers, each with about half as many digits as 

<math display="inline" id="Karatsuba_algorithm:9">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Karatsuba_algorithm:10">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, plus some additions and digit shifts.</p>

<p>Let 

<math display="inline" id="Karatsuba_algorithm:11">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Karatsuba_algorithm:12">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 be represented as 

<math display="inline" id="Karatsuba_algorithm:13">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-digit strings in some <a href="radix" title="wikilink">base</a> 

<math display="inline" id="Karatsuba_algorithm:14">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

. For any positive integer 

<math display="inline" id="Karatsuba_algorithm:15">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 less than 

<math display="inline" id="Karatsuba_algorithm:16">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, one can write the two given numbers as</p>

<p>

<math display="inline" id="Karatsuba_algorithm:17">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>B</mi>
      <mi>m</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=x_{1}B^{m}+x_{0}
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Karatsuba_algorithm:18">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>B</mi>
      <mi>m</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=y_{1}B^{m}+y_{0}
  </annotation>
 </semantics>
</math>

,</p>

<p>where 

<math display="inline" id="Karatsuba_algorithm:19">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Karatsuba_algorithm:20">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}
  </annotation>
 </semantics>
</math>

 are less than 

<math display="inline" id="Karatsuba_algorithm:21">
 <semantics>
  <msup>
   <mi>B</mi>
   <mi>m</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{m}
  </annotation>
 </semantics>
</math>

. The product is then</p>

<p>

<math display="inline" id="Karatsuba_algorithm:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>B</mi>
        <mi>m</mi>
       </msup>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>x</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>B</mi>
        <mi>m</mi>
       </msup>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>y</mi>
       <mn>0</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   xy=(x_{1}B^{m}+x_{0})(y_{1}B^{m}+y_{0})
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Karatsuba_algorithm:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>z</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>B</mi>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>z</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>B</mi>
      <mi>m</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>z</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   xy=z_{2}B^{2m}+z_{1}B^{m}+z_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="inline" id="Karatsuba_algorithm:24">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{2}=x_{1}y_{1}
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Karatsuba_algorithm:25">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1}=x_{1}y_{0}+x_{0}y_{1}
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Karatsuba_algorithm:26">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{0}=x_{0}y_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>These formulae require four multiplications, and were known to <a href="Charles_Babbage" title="wikilink">Charles Babbage</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Karatsuba observed that 

<math display="inline" id="Karatsuba_algorithm:27">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mi>y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   xy
  </annotation>
 </semantics>
</math>

 can be computed in only three multiplications, at the cost of a few extra additions. With 

<math display="inline" id="Karatsuba_algorithm:28">
 <semantics>
  <msub>
   <mi>z</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Karatsuba_algorithm:29">
 <semantics>
  <msub>
   <mi>z</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{2}
  </annotation>
 </semantics>
</math>

 as before we can calculate</p>

<p>

<math display="inline" id="Karatsuba_algorithm:30">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>z</mi>
     <mn>2</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>z</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1}=(x_{1}+x_{0})(y_{1}+y_{0})-z_{2}-z_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>which holds since</p>

<p>

<math display="inline" id="Karatsuba_algorithm:31">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1}=x_{1}y_{0}+x_{0}y_{1}
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Karatsuba_algorithm:32">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>x</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{1}=(x_{1}+x_{0})(y_{1}+y_{0})-x_{1}y_{1}-x_{0}y_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>A more efficient implementation of Karatsuba multiplication can be set as <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> 

<math display="inline" id="Karatsuba_algorithm:33">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>b</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>b</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>b</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>b</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>b</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   xy=(b^{2}+b)x_{1}y_{1}-b(x_{1}-x_{0})(y_{1}-y_{0})+(b+1)x_{0}y_{0}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Karatsuba_algorithm:34">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <msup>
    <mi>B</mi>
    <mi>m</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b=B^{m}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="example">Example</h3>

<p>To compute the product of 12345 and 6789, choose <em>B</em> = 10 and <em>m</em> = 3. Then we decompose the input operands using the resulting base (<em>B</em><sup><em>m</em></sup> = <em>1000</em>), as:</p>
<dl>
<dd>12345 = <strong>12</strong> · <em>1000</em> + <strong>345</strong>
</dd>
<dd>6789 = <strong>6</strong> · <em>1000</em> + <strong>789</strong>
</dd>
</dl>

<p>Only three multiplications, which operate on smaller integers, are used to compute three partial results:</p>
<dl>
<dd><em>z</em><sub>2</sub> = <strong>12</strong> <strong>×</strong> <strong>6</strong> = 72
</dd>
<dd><em>z</em><sub>0</sub> = <strong>345</strong> <strong>×</strong> <strong>789</strong> = 272205
</dd>
<dd><em>z</em><sub>1</sub> = (<strong>12</strong> + <strong>345</strong>) <strong>×</strong> (<strong>6</strong> + <strong>789</strong>) − <em>z</em><sub>2</sub> − <em>z</em><sub>0</sub> = 357 <strong>×</strong> 795 − 72 − 272205 = 283815 − 72 − 272205 = 11538
</dd>
</dl>

<p>We get the result by just adding these three partial results, shifted accordingly (and then taking carries into account by decomposing these three inputs in base <em>1000</em> like for the input operands):</p>
<dl>
<dd>result = <em>z</em><sub>2</sub> · <em>B</em><sup>2<em>m</em></sup> + <em>z</em><sub>1</sub> · <em>B</em><sup><em>m</em></sup> + <em>z</em><sub>0</sub>, i.e.
</dd>
<dd>result = 72 · <em>1000</em><sup>2</sup> + 11538 · <em>1000</em> + 272205 = <strong>83810205</strong>.
</dd>
</dl>

<p>Note that the intermediate third multiplication operates on an input domain which is less than twice larger than for the two first multiplications, its output domain is less than four times larger, and base-<em>1000</em> carries computed from the first two multiplications must be taken into account when computing these two subtractions; but note also that this partial result <em>z</em><sub>1</sub> cannot be negative: to compute these subtractions, equivalent additions using complements to <em>1000</em><sup>2</sup> can also be used, keeping only the two least significant base-<em>1000</em> digits for each number:</p>
<dl>
<dd><em>z</em><sub>1</sub> = 283815 − 72 − 272205 = (283815 + 999928 + 727795) <strong>mod</strong> <em>1000</em><sup>2</sup> = 2011538 <strong>mod</strong> <em>1000</em><sup>2</sup> = 11538.
</dd>
</dl>
<h3 id="recursive-application">Recursive application</h3>

<p>If <em>n</em> is four or more, the three multiplications in Karatsuba's basic step involve operands with fewer than <em>n</em> digits. Therefore, those products can be computed by <a href="recursion" title="wikilink">recursive</a> calls of the Karatsuba algorithm. The recursion can be applied until the numbers are so small that they can (or must) be computed directly.</p>

<p>In a computer with a full 32-bit by 32-bit <a href="Multiplication_ALU" title="wikilink">multiplier</a>, for example, one could choose <em>B</em> = 2<sup>31</sup> = 2,147,483,648 or <em>B</em> = 10<sup>9</sup> = 1,000,000,000, and store each digit as a separate 32-bit binary word. Then the sums <em>x</em><sub>1</sub> + <em>x</em><sub>0</sub> and <em>y</em><sub>1</sub> + <em>y</em><sub>0</sub> will not need an extra binary word for storing the carry-over digit (as in <a href="carry-save_adder" title="wikilink">carry-save adder</a>), and the Karatsuba recursion can be applied until the numbers to multiply are only 1-digit long.</p>
<h2 id="efficiency-analysis">Efficiency analysis</h2>

<p>Karatsuba's basic step works for any base <em>B</em> and any <em>m</em>, but the recursive algorithm is most efficient when <em>m</em> is equal to <em>n</em>/2, rounded up. In particular, if <em>n</em> is 2<sup><em>k</em></sup>, for some integer <em>k</em>, and the recursion stops only when <em>n</em> is 1, then the number of single-digit multiplications is 3<sup><em>k</em></sup>, which is <em>n</em><sup><em>c</em></sup> where <em>c</em> = log<sub>2</sub>3.</p>

<p>Since one can extend any inputs with zero digits until their length is a power of two, it follows that the number of elementary multiplications, for any <em>n</em>, is at most 

<math display="inline" id="Karatsuba_algorithm:35">
 <semantics>
  <mrow>
   <msup>
    <mn>3</mn>
    <mrow>
     <mo stretchy="false">⌈</mo>
     <mrow>
      <msub>
       <mi>log</mi>
       <mn>2</mn>
      </msub>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">⌉</mo>
    </mrow>
   </msup>
   <mo>≤</mo>
   <mrow>
    <mn>3</mn>
    <msup>
     <mi>n</mi>
     <mrow>
      <msub>
       <mi>log</mi>
       <mn>2</mn>
      </msub>
      <mn>3</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">3</cn>
     <apply>
      <ceiling></ceiling>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3^{\lceil\log_{2}n\rceil}\leq 3n^{\log_{2}3}\,\!
  </annotation>
 </semantics>
</math>

.</p>

<p>Since the additions, subtractions, and digit shifts (multiplications by powers of <em>B</em>) in Karatsuba's basic step take time proportional to <em>n</em>, their cost becomes negligible as <em>n</em> increases. More precisely, if <em>t</em>(<em>n</em>) denotes the total number of elementary operations that the algorithm performs when multiplying two <em>n</em>-digit numbers, then</p>

<p>

<math display="block" id="Karatsuba_algorithm:36">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>3</mn>
     <mi>t</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo stretchy="false">⌈</mo>
       <mrow>
        <mi>n</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
       <mo stretchy="false">⌉</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mi>d</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>t</ci>
      <apply>
       <ceiling></ceiling>
       <apply>
        <divide></divide>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(n)=3t(\lceil n/2\rceil)+cn+d
  </annotation>
 </semantics>
</math>

</p>

<p>for some constants <em>c</em> and <em>d</em>. For this <a href="recurrence_relation" title="wikilink">recurrence relation</a>, the <a href="master_theorem" title="wikilink">master theorem</a> gives the <a href="big_O_notation" title="wikilink">asymptotic</a> bound 

<math display="inline" id="Karatsuba_algorithm:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Θ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>n</mi>
      <mrow>
       <msub>
        <mi>log</mi>
        <mn>2</mn>
       </msub>
       <mn>3</mn>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Θ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>n</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(n)=\Theta(n^{\log_{2}3})\,\!
  </annotation>
 </semantics>
</math>

.</p>

<p>It follows that, for sufficiently large <em>n</em>, Karatsuba's algorithm will perform fewer shifts and single-digit additions than longhand multiplication, even though its basic step uses more additions and shifts than the straightforward formula. For small values of <em>n</em>, however, the extra shift and add operations may make it run slower than the longhand method. The point of positive return depends on the <a href="computer_platform" title="wikilink">computer platform</a> and context. As a rule of thumb, Karatsuba is usually faster when the multiplicands are longer than 320–640 bits.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="pseudocode">Pseudocode</h2>
<pre class="pli"><code>procedure karatsuba(num1, num2)
  if (num1 &lt; 10) or (num2 &lt; 10)
    return num1*num2
  /* calculates the size of the numbers */
  m = max(size_base10(num1), size_base10(num2))
  m2 = m/2
  /* split the digit sequences about the middle */
  high1, low1 = split_at(num1, m2)
  high2, low2 = split_at(num2, m2)
  /* 3 calls made to numbers approximately half the size */
  z0 = karatsuba(low1,low2)
  z1 = karatsuba((low1+high1),(low2+high2))
  z2 = karatsuba(high1,high2)
  return (z2*10^(2*m2))+((z1-z2-z0)*10^(m2))+(z0)</code></pre>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.cs.pitt.edu/~kirk/cs1501/animations/Karatsuba.html">Karatsuba's Algorithm for Polynomial Multiplication</a></li>
<li></li>
<li><a href="http://utilitymill.com/utility/Karatsuba_Multiplication">Karatsuba multiplication Algorithm – Web Based Calculator (GPL)</a></li>
<li>Bernstein, D. J., "<a href="http://cr.yp.to/papers/m3.pdf">Multidigit multiplication for mathematicians</a>". Covers Karatsuba and many other multiplication algorithms.</li>
<li><a href="http://www.ccas.ru/personal/karatsuba/divcen.htm">Karatsuba Multiplication on Fast Algorithms and the FEE</a></li>
<li><a href="https://github.com/yaojingguo/cpp-code/blob/master/kmul.cc">Karatsuba multiplication in C++</a></li>
</ul>

<p>"</p>

<p><a href="Category:Computer_arithmetic_algorithms" title="wikilink">Category:Computer arithmetic algorithms</a> <a class="uri" href="Category:Multiplication" title="wikilink">Category:Multiplication</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2">Charles Babbage, Chapter VIII – Of the Analytical Engine, Larger Numbers Treated, [<a class="uri" href="http://books.google.com/books?id=Fa1JAAAAMAAJ&amp;pg">http://books.google.com/books?id=Fa1JAAAAMAAJ&amp;pg;</a>;=PA125 Passages from the Life of a Philosopher], Longman Green, London, 1864; page 125.<a href="#fnref2">↩</a></li>
<li id="fn3">Torbjörn Granlund and the GMP development team, <em>The GNU Multiple Precision Arithmetic Library Manual, version 6.0.0</em>, Free Software Foundation, Inc., March 2014.<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="http://gmplib.org/manual/Karatsuba-Multiplication.html">1</a><a href="http://ozark.hendrix.edu/~burch/proj/karat/comment1.html">2</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

   Proofs involving ordinary least squares      Proofs involving ordinary least squares   The purpose of this page is to provide supplementary materials for the Ordinary least squares article, reducing the load of the main article with mathematics and improving its accessibility, while at the same time retaining the completeness of exposition.  Least squares estimator for β  Using matrix notation, the sum of squared residuals is given by       S   (  b  )    =     (   y  -   X  b    )   ′    (   y  -   X  b    )          S  b      superscript    y    X  b    normal-′     y    X  b       S(b)=(y-Xb)^{\prime}(y-Xb)\,     Where     ′     normal-′    {}^{\prime}   denotes the matrix transpose.  Since this is a quadratic expression and S ( b ) ≥ 0, the global minimum will be found by differentiating it with respect to b :      0  =     d  S    d   b  ′      (   β  ^   )    =      d   d   b  ′      (      y  ′   y   -    b  ′    X  ′   y   -    y  ′   X  b    +    b  ′    X  ′   X  b    )    |    b  =   β  ^     =    -   2   X  ′   y    +   2   X  ′   X   β  ^           0        d  S     d   superscript  b  normal-′      normal-^  β          evaluated-at      d    d   superscript  b  normal-′            superscript  y  normal-′   y      superscript  b  normal-′    superscript  X  normal-′   y      superscript  y  normal-′   X  b       superscript  b  normal-′    superscript  X  normal-′   X  b       b   normal-^  β                2   superscript  X  normal-′   y      2   superscript  X  normal-′   X   normal-^  β        0=\frac{dS}{db^{\prime}}(\hat{\beta})=\frac{d}{db^{\prime}}\bigg(y^{\prime}y-b%
 ^{\prime}X^{\prime}y-y^{\prime}Xb+b^{\prime}X^{\prime}Xb\bigg)\bigg|_{b=\hat{%
 \beta}}=-2X^{\prime}y+2X^{\prime}X\hat{\beta}     By assumption matrix X has full column rank, and therefore X'X is invertible and the least squares estimator for β is given by       β  ^   =     (    X  ′   X   )    -  1     X  ′    y         normal-^  β      superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   y     \hat{\beta}=(X^{\prime}X)^{-1}X^{\prime}y\,     Unbiasedness and Variance of    β  ^     normal-^  β    \hat{\beta}     Plug y = Xβ + ε into the formula for    β  ^     normal-^  β    \hat{\beta}   and then use the Law of iterated expectation :         E   [   β  ^   ]        =   E   [     (    X  ′   X   )    -  1     X  ′    (    X  β   +  ε   )    ]            =   β  +   E   [     (    X  ′   X   )    -  1     X  ′   ε   ]             =   β  +   E   [   E   [     (    X  ′   X   )    -  1     X  ′   ε   |  X  ]    ]             =   β  +   E   [     (    X  ′   X   )    -  1     X  ′    E   [  ε  |  X  ]     ]           =  β   ,          normal-E   normal-^  β      absent   normal-E     superscript     superscript  X  normal-′   X     1     superscript  X  normal-′       X  β   ε         missing-subexpression     absent    β   normal-E     superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   ε         missing-subexpression     absent    β   normal-E   normal-E     superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   ε   X         missing-subexpression     absent    β   normal-E     superscript     superscript  X  normal-′   X     1     superscript  X  normal-′    normal-E  ε  X         absent  β      \begin{aligned}\displaystyle\operatorname{E}[\,\hat{\beta}]&\displaystyle=%
 \operatorname{E}\Big[(X^{\prime}X)^{-1}X^{\prime}(X\beta+\varepsilon)\Big]\\
 &\displaystyle=\beta+\operatorname{E}\Big[(X^{\prime}X)^{-1}X^{\prime}%
 \varepsilon\Big]\\
 &\displaystyle=\beta+\operatorname{E}\Big[\operatorname{E}\Big[(X^{\prime}X)^{%
 -1}X^{\prime}\varepsilon|X\Big]\Big]\\
 &\displaystyle=\beta+\operatorname{E}\Big[(X^{\prime}X)^{-1}X^{\prime}%
 \operatorname{E}[\varepsilon|X]\Big]&\displaystyle=\beta,\\
 \end{aligned}     where E[ ε | X ] = 0 by assumptions of the model.  For the variance, let     σ  2   I       superscript  σ  2   I    \sigma^{2}I   denote the covariance matrix of   ε   ε   \varepsilon   . Then,         E   [    (    β  ^   -  β   )     (    β  ^   -  β   )   T    ]        =   E   [    (     (    X  ′   X   )    -  1     X  ′   ε   )     (     (    X  ′   X   )    -  1     X  ′   ε   )   T    ]             =    σ  2     (    X  ′   X   )    -  1      ,               normal-E       normal-^  β   β    superscript     normal-^  β   β   T       absent   normal-E       superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   ε    superscript     superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   ε   T         missing-subexpression     absent     superscript  σ  2    superscript     superscript  X  normal-′   X     1        absent     \begin{aligned}\displaystyle\operatorname{E}[\,(\hat{\beta}-\beta)(\hat{\beta}%
 -\beta)^{T}]&\displaystyle=\operatorname{E}\Big[((X^{\prime}X)^{-1}X^{\prime}%
 \varepsilon)((X^{\prime}X)^{-1}X^{\prime}\varepsilon)^{T}\Big]\\
 &\displaystyle=\sigma^{2}(X^{\prime}X)^{-1},\\
 \displaystyle\par
 \par
 \end{aligned}     where we used the fact that     β  ^   -  β       normal-^  β   β    \hat{\beta}-\beta   is just an affine transformation of   ε   ε   \varepsilon   by the matrix      (    X  ′   X   )    -  1     X  ′        superscript     superscript  X  normal-′   X     1     superscript  X  normal-′     (X^{\prime}X)^{-1}X^{\prime}   ( see article on the multivariate normal distribution under the affine transformation section).  For a simple linear regression model, where    β  =    [   β  0   ,   β  1   ]   T       β   superscript    subscript  β  0    subscript  β  1    T     \beta=[\beta_{0},\beta_{1}]^{T}   (    β  0     subscript  β  0    \beta_{0}   is the y-intercept and    β  1     subscript  β  1    \beta_{1}   is the slope), one obtains          σ  2     (    X  ′   X   )    -  1         =    σ  2     (    ∑    x  i    x  i  ′      )    -  1             =    σ  2     (    ∑     (  1  ,   x  i   )   ′    (  1  ,   x  i   )      )    -  1             =    σ  2     (    ∑   (     1     x  i        x  i      x  i  2      )     )    -  1             =    σ  2     (     n     ∑   x  i         ∑   x  i       ∑   x  i  2       )    -  1             =     σ  2   ⋅    1    n   ∑   x  i  2     -    (   ∑   x  i    )   2        (      ∑   x  i  2       -   ∑   x  i          -   ∑   x  i       n     )            =     σ  2   ⋅    1   n    ∑   i  =  1   n     (    x  i   -   x  ¯    )   2         (      ∑   x  i  2       -   ∑   x  i          -   ∑   x  i       n     )              superscript  σ  2    superscript     superscript  X  normal-′   X     1       absent     superscript  σ  2    superscript       subscript  x  i    superscript   subscript  x  i   normal-′       1         missing-subexpression     absent     superscript  σ  2    superscript       superscript   1   subscript  x  i    normal-′    1   subscript  x  i        1         missing-subexpression     absent     superscript  σ  2    superscript      1   subscript  x  i      subscript  x  i    superscript   subscript  x  i   2        1         missing-subexpression     absent     superscript  σ  2    superscript    n     subscript  x  i         subscript  x  i       superscript   subscript  x  i   2        1         missing-subexpression     absent     normal-⋅   superscript  σ  2     1      n     superscript   subscript  x  i   2      superscript     subscript  x  i    2           superscript   subscript  x  i   2         subscript  x  i            subscript  x  i     n         missing-subexpression     absent     normal-⋅   superscript  σ  2     1    n    superscript   subscript     i  1    n    superscript     subscript  x  i    normal-¯  x    2            superscript   subscript  x  i   2         subscript  x  i            subscript  x  i     n         \begin{aligned}\displaystyle\sigma^{2}(X^{\prime}X)^{-1}&\displaystyle=\sigma^%
 {2}\left(\sum x_{i}x_{i}^{\prime}\right)^{-1}\\
 &\displaystyle=\sigma^{2}\left(\sum(1,x_{i})^{\prime}(1,x_{i})\right)^{-1}\\
 &\displaystyle=\sigma^{2}\left(\sum\begin{pmatrix}1&x_{i}\\
 x_{i}&x_{i}^{2}\end{pmatrix}\right)^{-1}\\
 &\displaystyle=\sigma^{2}\begin{pmatrix}n&\sum x_{i}\\
 \sum x_{i}&\sum x_{i}^{2}\end{pmatrix}^{-1}\\
 &\displaystyle=\sigma^{2}\cdot\frac{1}{n\sum x_{i}^{2}-(\sum x_{i})^{2}}\begin%
 {pmatrix}\sum x_{i}^{2}&-\sum x_{i}\\
 -\sum x_{i}&n\end{pmatrix}\\
 &\displaystyle=\sigma^{2}\cdot\frac{1}{n\sum_{i=1}^{n}{(x_{i}-\bar{x})^{2}}}%
 \begin{pmatrix}\sum x_{i}^{2}&-\sum x_{i}\\
 -\sum x_{i}&n\end{pmatrix}\\
 \end{aligned}          V  a  r   (   β  1   )         =     σ  2     ∑   i  =  1   n     (    x  i   -   x  ¯    )   2       .           V  a  r   subscript  β  1      absent     superscript  σ  2     superscript   subscript     i  1    n    superscript     subscript  x  i    normal-¯  x    2         \begin{aligned}\displaystyle Var(\beta_{1})&\displaystyle=\frac{\sigma^{2}}{%
 \sum_{i=1}^{n}{(x_{i}-\bar{x})^{2}}}.\end{aligned}     Expected value of     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}     First we will plug in the expression for y into the estimator, and use the fact that X'M = MX = 0 (matrix M projects onto the space orthogonal to X ):        σ  ^   2   =     1  n     y  ′   M  y   =     1  n      (    X  β   +  ε   )   ′   M   (    X  β   +  ε   )    =     1  n     ε  ′   M  ε          superscript   normal-^  σ   2       1  n    superscript  y  normal-′   M  y            1  n    superscript      X  β   ε   normal-′   M      X  β   ε             1  n    superscript  ε  normal-′   M  ε      \hat{\sigma}^{2}=\tfrac{1}{n}y^{\prime}My=\tfrac{1}{n}(X\beta+\varepsilon)^{%
 \prime}M(X\beta+\varepsilon)=\tfrac{1}{n}\varepsilon^{\prime}M\varepsilon     Now we can recognize ε'Mε as a 1×1 matrix, such matrix is equal to its own trace . This is useful because by properties of trace operator, tr ( AB )= tr ( BA ), and we can use this to separate disturbance ε from matrix M which is a function of regressors X :       E    σ  ^   2    =     1  n     E   [   tr   (    ε  ′   M  ε   )    ]     =     1  n     tr   (   E   [   M  ε   ε  ′    ]    )            normal-E   superscript   normal-^  σ   2        1  n    normal-E   tr     superscript  ε  normal-′   M  ε               1  n    tr   normal-E    M  ε   superscript  ε  normal-′          \operatorname{E}\,\hat{\sigma}^{2}=\tfrac{1}{n}\operatorname{E}\big[%
 \operatorname{tr}(\varepsilon^{\prime}M\varepsilon)\big]=\tfrac{1}{n}%
 \operatorname{tr}\big(\operatorname{E}[M\varepsilon\varepsilon^{\prime}]\big)     Using the Law of iterated expectation this can be written as       E    σ  ^   2    =     1  n     tr   (   E   [    M    E   [   ε   ε  ′    |  X  ]     ]    )     =     1  n     tr   (   E   [    σ  2   M  I   ]    )     =     1  n     σ  2    E   [   tr  M   ]            normal-E   superscript   normal-^  σ   2        1  n    tr   normal-E    M   normal-E    ε   superscript  ε  normal-′    X                1  n    tr   normal-E     superscript  σ  2   M  I               1  n    superscript  σ  2    normal-E   tr  M        \operatorname{E}\,\hat{\sigma}^{2}=\tfrac{1}{n}\operatorname{tr}\Big(%
 \operatorname{E}\big[M\,\operatorname{E}[\varepsilon\varepsilon^{\prime}|X]%
 \big]\Big)=\tfrac{1}{n}\operatorname{tr}\big(\operatorname{E}[\sigma^{2}MI]%
 \big)=\tfrac{1}{n}\sigma^{2}\operatorname{E}\big[\operatorname{tr}\,M\big]     Recall that M = I − P where P is the projection onto linear space spanned by columns of matrix X . By properties of a projection matrix , it has p = rank( X ) eigenvalues equal to 1, and all other eigenvalues are equal to 0. Trace of a matrix is equal to the sum of its characteristic values, thus tr( P )= p , and tr( M ) = n − p . Therefore       E    σ  ^   2    =     n  -  p   n    σ  2         normal-E   superscript   normal-^  σ   2          n  p   n    superscript  σ  2      \operatorname{E}\,\hat{\sigma}^{2}=\frac{n-p}{n}\sigma^{2}     Note: in the later section “Maximum likelihood” we show that under the additional assumption that errors are distributed normally, the estimator     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}   is proportional to a chi-squared distribution with n – p degrees of freedom, from which the formula for expected value would immediately follow. However the result we have shown in this section is valid regardless of the distribution of the errors, and thus has importance on its own.  Consistency and asymptotic normality of    β  ^     normal-^  β    \hat{\beta}     Estimator    β  ^     normal-^  β    \hat{\beta}   can be written as       β  ^   =     (     1  n     X  ′   X   )    -  1      1  n     X  ′   y   =   β  +     (     1  n     X  ′   X   )    -  1      1  n     X  ′   ε    =    β   +     (    1  n     ∑   i  =  1   n     x  i    x  i  ′      )    -  1     (    1  n     ∑   i  =  1   n     x  i    ε  i      )            normal-^  β      superscript      1  n    superscript  X  normal-′   X     1      1  n    superscript  X  normal-′   y          β     superscript      1  n    superscript  X  normal-′   X     1      1  n    superscript  X  normal-′   ε           β     superscript      1  n     superscript   subscript     i  1    n      subscript  x  i    subscript   superscript  x  normal-′   i        1        1  n     superscript   subscript     i  1    n      subscript  x  i    subscript  ε  i           \hat{\beta}=\big(\tfrac{1}{n}X^{\prime}X\big)^{-1}\tfrac{1}{n}X^{\prime}y=%
 \beta+\big(\tfrac{1}{n}X^{\prime}X\big)^{-1}\tfrac{1}{n}X^{\prime}\varepsilon=%
 \beta\;+\;\bigg(\frac{1}{n}\sum_{i=1}^{n}x_{i}x^{\prime}_{i}\bigg)^{\!\!-1}%
 \bigg(\frac{1}{n}\sum_{i=1}^{n}x_{i}\varepsilon_{i}\bigg)   We can use the law of large numbers to establish that         1  n     ∑   i  =  1   n     x  i     x  i  ′         →  𝑝     E   [    x  i    x  i  ′    ]    =    Q   x  x    n    ,     1  n     ∑   i  =  1   n     x  i     ε  i         →  𝑝     E   [    x  i    ε  i    ]    =  0      formulae-sequence      p  normal-→       1  n     superscript   subscript     i  1    n      subscript  x  i    subscript   superscript  x  normal-′   i       normal-E     subscript  x  i    superscript   subscript  x  i   normal-′             subscript  Q    x  x    n         p  normal-→       1  n     superscript   subscript     i  1    n      subscript  x  i    subscript  ε  i       normal-E     subscript  x  i    subscript  ε  i          0      \frac{1}{n}\sum_{i=1}^{n}x_{i}x^{\prime}_{i}\ \xrightarrow{p}\ \operatorname{E%
 }[x_{i}x_{i}^{\prime}]=\frac{Q_{xx}}{n},\qquad\frac{1}{n}\sum_{i=1}^{n}x_{i}%
 \varepsilon_{i}\ \xrightarrow{p}\ \operatorname{E}[x_{i}\varepsilon_{i}]=0   By Slutsky's theorem and continuous mapping theorem these results can be combined to establish consistency of estimator    β  ^     normal-^  β    \hat{\beta}   :        β  ^      →  𝑝     β  +    Q   x  x    -  1    ⋅  0    =  β        p  normal-→    normal-^  β     β   normal-⋅   superscript   subscript  Q    x  x      1    0         β     \hat{\beta}\ \xrightarrow{p}\ \beta+Q_{xx}^{-1}\cdot 0=\beta     The central limit theorem tells us that         1   n      ∑   i  =  1   n     x  i     ε  i         →  𝑑     𝒩   (  0  ,  V  )     ,      d  normal-→       1    n      superscript   subscript     i  1    n      subscript  x  i    subscript  ε  i        𝒩   0  V      \frac{1}{\sqrt{n}}\sum_{i=1}^{n}x_{i}\varepsilon_{i}\ \xrightarrow{d}\ %
 \mathcal{N}\big(0,\,V\big),   where    V  =   Var   [    x  i    ε  i    ]    =   E   [    ε  i  2    x  i     x  i  ′     ]    =   E   [    E   [   ε  i  2   |   x  i   ]     x  i     x  i  ′     ]    =    σ  2     Q   x  x    n          V   Var     subscript  x  i    subscript  ε  i           normal-E     superscript   subscript  ε  i   2    subscript  x  i    subscript   superscript  x  normal-′   i           normal-E     normal-E   superscript   subscript  ε  i   2    subscript  x  i     subscript  x  i    subscript   superscript  x  normal-′   i             superscript  σ  2      subscript  Q    x  x    n       V=\operatorname{Var}[x_{i}\varepsilon_{i}]=\operatorname{E}[\,\varepsilon_{i}^%
 {2}x_{i}x^{\prime}_{i}\,]=\operatorname{E}\big[\,\operatorname{E}[\varepsilon_%
 {i}^{2}|x_{i}]\;x_{i}x^{\prime}_{i}\,\big]=\sigma^{2}\frac{Q_{xx}}{n}     Applying Slutsky's theorem again we'll have        n    (    β  ^   -  β   )    =     (    1  n     ∑   i  =  1   n     x  i    x  i  ′      )    -  1     (    1   n      ∑   i  =  1   n     x  i    ε  i      )      →  𝑑        Q   x  x    -  1    n   ⋅  𝒩    (  0  ,    σ  2     Q   x  x    n    )    =   𝒩   (  0  ,    σ  2    Q   x  x    -  1    n   )              n      normal-^  β   β       superscript      1  n     superscript   subscript     i  1    n      subscript  x  i    subscript   superscript  x  normal-′   i        1        1    n      superscript   subscript     i  1    n      subscript  x  i    subscript  ε  i          d  normal-→        normal-⋅     superscript   subscript  Q    x  x      1    n   𝒩    0     superscript  σ  2      subscript  Q    x  x    n             𝒩   0     superscript  σ  2    superscript   subscript  Q    x  x      1    n        \sqrt{n}(\hat{\beta}-\beta)=\bigg(\frac{1}{n}\sum_{i=1}^{n}x_{i}x^{\prime}_{i}%
 \bigg)^{\!\!-1}\bigg(\frac{1}{\sqrt{n}}\sum_{i=1}^{n}x_{i}\varepsilon_{i}\bigg%
 )\ \xrightarrow{d}\ Q_{xx}^{-1}n\cdot\mathcal{N}\big(0,\sigma^{2}\frac{Q_{xx}}%
 {n}\big)=\mathcal{N}\big(0,\sigma^{2}Q_{xx}^{-1}n\big)     Maximum likelihood approach  Maximum likelihood estimation is a generic technique for estimating the unknown parameters in a statistical model by constructing a log-likelihood function corresponding to the joint distribution of the data, then maximizing this function over all possible parameter values. In order to apply this method, we have to make an assumption about the distribution of y given X so that the log-likelihood function can be constructed. The connection of maximum likelihood estimation to OLS arises when this distribution is modeled as a multivariate normal .  Specifically, assume that the errors ε have multivariate normal distribution with mean 0 and variance matrix σ 2 I . Then the distribution of y conditionally on X is      y  |   X   ∼  𝒩   (  X  β  ,   σ  2   I  )      fragments  y  normal-|  X  similar-to  N   fragments  normal-(  X  β  normal-,   superscript  σ  2   I  normal-)     y|X\ \sim\ \mathcal{N}(X\beta,\,\sigma^{2}I)   and the log-likelihood function of the data will be      ℒ   (  β  ,   σ  2   |  X  )      fragments  L   fragments  normal-(  β  normal-,   superscript  σ  2   normal-|  X  normal-)     \displaystyle\mathcal{L}(\beta,\sigma^{2}|X)   Differentiating this expression with respect to β and σ 2 we'll find the ML estimates of these parameters:          ∂  ℒ    ∂   β  ′      =   -     1   2   σ  2       (    -   2   X  ′   y    +   2   X  ′   X  β    )     =  0     ⇒   β  ^    =     (    X  ′   X   )    -  1     X  ′   y       formulae-sequence          ℒ      superscript  β  normal-′           1    2   superscript  σ  2           2   superscript  X  normal-′   y      2   superscript  X  normal-′   X  β           0       normal-⇒   normal-^  β       superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   y      \displaystyle\frac{\partial\mathcal{L}}{\partial\beta^{\prime}}=-\frac{1}{2%
 \sigma^{2}}\Big(-2X^{\prime}y+2X^{\prime}X\beta\Big)=0\quad\Rightarrow\quad%
 \hat{\beta}=(X^{\prime}X)^{-1}X^{\prime}y   We can check that this is indeed a maximum by looking at the Hessian matrix of the log-likelihood function.  Finite sample distribution  Since we have assumed in this section that the distribution of error terms is known to be normal, it becomes possible to derive the explicit expressions for the distributions of estimators    β  ^     normal-^  β    \hat{\beta}   and     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}   :       β  ^   =     (    X  ′   X   )    -  1     X  ′   y   =     (    X  ′   X   )    -  1     X  ′    (    X  β   +  ε   )    =   β  +     (    X  ′   X   )    -  1     X  ′   𝒩   (  0  ,    σ  2   I   )            normal-^  β      superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   y           superscript     superscript  X  normal-′   X     1     superscript  X  normal-′       X  β   ε           β     superscript     superscript  X  normal-′   X     1     superscript  X  normal-′   𝒩   0     superscript  σ  2   I         \hat{\beta}=(X^{\prime}X)^{-1}X^{\prime}y=(X^{\prime}X)^{-1}X^{\prime}(X\beta+%
 \varepsilon)=\beta+(X^{\prime}X)^{-1}X^{\prime}\mathcal{N}(0,\sigma^{2}I)   so that by the affine transformation properties of multivariate normal distribution       β  ^   |   X   ∼  𝒩   (  β  ,   σ  2     (   X  ′   X  )    -  1    )   .     fragments   normal-^  β   normal-|  X  similar-to  N   fragments  normal-(  β  normal-,   superscript  σ  2    superscript   fragments  normal-(   superscript  X  normal-′   X  normal-)     1    normal-)   normal-.    \hat{\beta}|X\ \sim\ \mathcal{N}(\beta,\,\sigma^{2}(X^{\prime}X)^{-1}).     Similarly the distribution of     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}   follows from       σ  ^   2     superscript   normal-^  σ   2    \displaystyle\hat{\sigma}^{2}   where    M  =   I  -   X    (    X  ′   X   )    -  1     X  ′         M    I    X   superscript     superscript  X  normal-′   X     1     superscript  X  normal-′       M=I-X(X^{\prime}X)^{-1}X^{\prime}   is the symmetric projection matrix onto subspace orthogonal to X , and thus ''MX = X'M = ''0. We have argued before that this matrix has rank of n–p , and thus by properties of chi-squared distribution ,        n   σ  2       σ  ^   2   |  X  =    (  ε  /  σ  )   ′   M   (  ε  /  σ  )   ∼   χ   n  -  p   2      fragments    n   superscript  σ  2     superscript   normal-^  σ   2   normal-|  X    superscript   fragments  normal-(  ε   σ  normal-)   normal-′   M   fragments  normal-(  ε   σ  normal-)   similar-to   subscript   superscript  χ  2     n  p      \tfrac{n}{\sigma^{2}}\hat{\sigma}^{2}|X=(\varepsilon/\sigma)^{\prime}M(%
 \varepsilon/\sigma)\ \sim\ \chi^{2}_{n-p}     Moreover, the estimators    β  ^     normal-^  β    \hat{\beta}   and     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}   turn out to be independent (conditional on X ), a fact which is fundamental for construction of the classical t- and F-tests. The independence can be easily seen from following: the estimator    β  ^     normal-^  β    \hat{\beta}   represents coefficients of vector decomposition of     y  ^   =   X   β  ^    =   P  y   =    X  β   +   P  ε           normal-^  y     X   normal-^  β           P  y            X  β     P  ε       \hat{y}=X\hat{\beta}=Py=X\beta+P\varepsilon   by the basis of columns of X , as such    β  ^     normal-^  β    \hat{\beta}   is a function of Pε . At the same time, the estimator     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}   is a norm of vector Mε divided by n , and thus this estimator is a function of Mε . Now, random variables (Pε, Mε) are jointly normal as a linear transformation of ε , and they are also uncorrelated because ''PM = ''0. By properties of multivariate normal distribution, this means that Pε and Mε are independent, and therefore estimators    β  ^     normal-^  β    \hat{\beta}   and     σ  ^   2     superscript   normal-^  σ   2    \hat{\sigma}^{2}   will be independent as well.  "  Category:Article proofs  Category:Regression analysis  Category:Least squares   
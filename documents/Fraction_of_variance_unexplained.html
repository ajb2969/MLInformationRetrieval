<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="723">Fraction of variance unexplained</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Fraction of variance unexplained</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, the <strong>fraction of variance unexplained (FVU)</strong> in the context of a <a href="Regression_analysis" title="wikilink">regression task</a> is the fraction of variance of the <a class="uri" href="regressand" title="wikilink">regressand</a> (dependent variable) <em>Y</em> which cannot be explained, i.e., which is not correctly predicted, by the <a href="explanatory_variable" title="wikilink">explanatory variables</a> <em>X</em>.</p>

<p>For a more general concept, see <a href="explained_variation" title="wikilink">explained variation</a>.</p>
<h2 id="formal-definition">Formal definition</h2>

<p>Suppose we are given a regression function <em>ƒ</em> yielding for each <em>y<sub>i</sub></em>, 1 ≤ <em>i</em> ≤ <em>N</em>, an estimate 

<math display="inline" id="Fraction_of_variance_unexplained:0">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo>^</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>y</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{y}_{i}=f(x_{i})
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Fraction_of_variance_unexplained:1">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 is the vector of the <em>i</em><sup>th</sup> observations on all the explanatory variables. We define the fraction of variance unexplained (FVU) as:</p>

<p>

<math display="inline" id="Fraction_of_variance_unexplained:2">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>V</mi>
      <mi>A</mi>
      <msub>
       <mi>R</mi>
       <mi>err</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>V</mi>
      <mi>A</mi>
      <msub>
       <mi>R</mi>
       <mi>tot</mi>
      </msub>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mrow>
       <mi>S</mi>
       <msub>
        <mi>S</mi>
        <mi>err</mi>
       </msub>
      </mrow>
      <mo>/</mo>
      <mi>n</mi>
     </mrow>
     <mrow>
      <mrow>
       <mi>S</mi>
       <msub>
        <mi>S</mi>
        <mi>tot</mi>
       </msub>
      </mrow>
      <mo>/</mo>
      <mi>n</mi>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <mrow>
      <mi>S</mi>
      <msub>
       <mi>S</mi>
       <mi>err</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>S</mi>
      <msub>
       <mi>S</mi>
       <mi>tot</mi>
      </msub>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mi>S</mi>
       <msub>
        <mi>S</mi>
        <mi>reg</mi>
       </msub>
      </mrow>
      <mrow>
       <mi>S</mi>
       <msub>
        <mi>S</mi>
        <mi>tot</mi>
       </msub>
      </mrow>
     </mfrac>
    </mstyle>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>V</ci>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <ci>err</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>V</ci>
       <ci>A</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <ci>tot</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>err</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>tot</ci>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>err</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>tot</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>reg</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>tot</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle={VAR_{\rm err}\over VAR_{\rm tot}}={SS_{\rm err}/n\over SS_{\rm
tot%
}/n}={SS_{\rm err}\over SS_{\rm tot}}=1-{SS_{\rm reg}\over SS_{\rm tot}}
  </annotation>
 </semantics>
</math>


</p>

<p>where <em>R</em><sup>2</sup> is the <a href="coefficient_of_determination" title="wikilink">coefficient of determination</a> and <em>VAR</em><sub>err</sub> and <em>VAR</em><sub>tot</sub> are the variance of the estimated residuals and the sample variance of the dependent variable. <em>SS</em><sub><em>err</em></sub> (the sum of squared predictions errors, equivalently the <a href="residual_sum_of_squares" title="wikilink">residual sum of squares</a>), <em>SS</em><sub><em>tot</em></sub> (the <a href="total_sum_of_squares" title="wikilink">total sum of squares</a>), and <em>SS</em><sub><em>reg</em></sub> (the sum of squares of the regression, equivalently the <a href="explained_sum_of_squares" title="wikilink">explained sum of squares</a>) are given by</p>

<p>

<math display="inline" id="Fraction_of_variance_unexplained:3">
 <semantics>
  <mrow>
   <mi>S</mi>
   <msub>
    <mi>S</mi>
    <mi>err</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>err</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle SS_{\rm err}
  </annotation>
 </semantics>
</math>


</p>

<p>Alternatively, the fraction of variance unexplained can be defined as follows:</p>

<p>

<math display="block" id="Fraction_of_variance_unexplained:4">
 <semantics>
  <mrow>
   <mrow>
    <mtext>FVU</mtext>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mtext>MSE</mtext>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>f</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mtext>var</mtext>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>Y</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>FVU</mtext>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <mtext>MSE</mtext>
      <ci>f</ci>
     </apply>
     <apply>
      <times></times>
      <mtext>var</mtext>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>Y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{FVU}=\frac{\text{MSE}(f)}{\text{var}[Y]},
  </annotation>
 </semantics>
</math>

</p>

<p>where MSE(<em>f</em>) is the <a href="mean_squared_error" title="wikilink">mean squared error</a> of the regression function <em>ƒ</em>.</p>
<h2 id="explanation">Explanation</h2>

<p>It is useful to consider the second definition to understand FVU. When trying to predict <em>Y</em>, the most naïve regression function that we can think of is the constant function predicting the mean of <em>Y</em>, i.e., 

<math display="inline" id="Fraction_of_variance_unexplained:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">¯</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-¯</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x_{i})=\bar{y}
  </annotation>
 </semantics>
</math>

. It follows that the MSE of this function equals the variance of <em>Y</em>; that is, <em>SS</em><sub>err</sub> = <em>SS</em><sub>tot</sub>, and <em>SS</em><sub>reg</sub> = 0. In this case, no variation in <em>Y</em> can be accounted for, and the FVU then has its maximum value of 1.</p>

<p>More generally, the FVU will be 1 if the explanatory variables <em>X</em> tell us nothing about <em>Y</em> in the sense that the predicted values of <em>Y</em> do not <a href="covariance" title="wikilink">covary</a> with <em>Y</em>. But as prediction gets better and the MSE can be reduced, the FVU goes down. In the case of perfect prediction where 

<math display="inline" id="Fraction_of_variance_unexplained:6">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>y</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{y}_{i}=y_{i}
  </annotation>
 </semantics>
</math>

 for all <em>i</em>, the MSE is 0, <em>SS</em><sub>err</sub> = 0, <em>SS</em><sub>reg</sub> = <em>SS</em><sub>tot</sub>, and the FVU is 0.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Coefficient_of_determination" title="wikilink">Coefficient of determination</a></li>
<li><a class="uri" href="Correlation" title="wikilink">Correlation</a></li>
<li><a href="Regression_analysis" title="wikilink">Regression analysis</a></li>
<li><a href="Linear_regression" title="wikilink">Linear regression</a></li>
</ul>

<p>"</p>

<p><a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Parametric_statistics" title="wikilink">Category:Parametric statistics</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Statistical_ratios" title="wikilink">Category:Statistical ratios</a> <a href="Category:Least_squares" title="wikilink">Category:Least squares</a></p>
</body>
</html>

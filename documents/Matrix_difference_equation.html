<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="31">Matrix difference equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Matrix difference equation</h1>
<hr/>

<p>A <strong>matrix difference equation</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> is a <a href="difference_equation" title="wikilink">difference equation</a> in which the value of a <a href="Euclidean_vector#Representations" title="wikilink">vector</a> (or sometimes, a matrix) of variables at one point in time is related to its own value at one or more previous points in time, using <a href="Matrix_(mathematics)" title="wikilink">matrices</a>. Occasionally, the time-varying entity may itself be a matrix instead of a vector. The <strong>order</strong> of the equation is the maximum time gap between any two indicated values of the variable vector. For example,</p>

<p>

<math display="block" id="Matrix_difference_equation:0">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}=Ax_{t-1}+Bx_{t-2}
  </annotation>
 </semantics>
</math>

</p>

<p>is an example of a second-order matrix difference equation, in which <em>x</em> is an <em>n</em> × 1 vector of variables and <em>A</em> and <em>B</em> are <em>n×n</em> matrices. This equation is homogeneous because there is no vector constant term added to the end of the equation. The same equation might also be written as</p>

<p>

<math display="block" id="Matrix_difference_equation:1">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <msub>
      <mi>x</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <plus></plus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t+2}=Ax_{t+1}+Bx_{t}
  </annotation>
 </semantics>
</math>

</p>

<p>or as</p>

<p>

<math display="block" id="Matrix_difference_equation:2">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=Ax_{n-1}+Bx_{n-2}
  </annotation>
 </semantics>
</math>

.</p>

<p>The most commonly encountered matrix difference equations are first-order.</p>
<h2 id="non-homogeneous-first-order-matrix-difference-equations-and-the-steady-state">Non-homogeneous first-order matrix difference equations and the steady state</h2>

<p>An example of a non-homogeneous first-order matrix difference equation is</p>

<p>

<math display="block" id="Matrix_difference_equation:3">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>b</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}=Ax_{t-1}+b\,
  </annotation>
 </semantics>
</math>

</p>

<p>with additive constant vector <em>b</em>. The steady state of this system is a value <em>x*</em> of the vector <em>x</em> which, if reached, would not be deviated from subsequently. <em>x*</em> is found by setting 

<math display="inline" id="Matrix_difference_equation:4">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>t</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msup>
    <mi>x</mi>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}=x_{t-1}=x^{*}
  </annotation>
 </semantics>
</math>

 in the difference equation and solving for <em>x*</em> to obtain</p>

<p>

<math display="block" id="Matrix_difference_equation:5">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>I</mi>
       <mo>-</mo>
       <mi>A</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mpadded width="+1.7pt">
     <mi>b</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <times></times>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <ci>I</ci>
        <ci>A</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{*}=[I-A]^{-1}b\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Matrix_difference_equation:6">
 <semantics>
  <mi>I</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>I</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I
  </annotation>
 </semantics>
</math>

 is the <em>n×n</em> <a href="identity_matrix" title="wikilink">identity matrix</a>, and where it is assumed that 

<math display="inline" id="Matrix_difference_equation:7">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mi>I</mi>
    <mo>-</mo>
    <mi>A</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <minus></minus>
     <ci>I</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [I-A]
  </annotation>
 </semantics>
</math>

 is invertible. Then the non-homogeneous equation can be rewritten in homogeneous form in terms of deviations from the steady state:</p>

<p>

<math display="block" id="Matrix_difference_equation:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>t</mi>
      </msub>
      <mo>-</mo>
      <msup>
       <mi>x</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <msup>
        <mi>x</mi>
        <mo>*</mo>
       </msup>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [x_{t}-x^{*}]=A[x_{t-1}-x^{*}].\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="stability-of-the-first-order-case">Stability of the first-order case</h2>

<p>The first-order matrix difference equation [<em>x</em><sub><em>t</em></sub> - <em>x</em>*] = <em>A</em>[<em>x</em><sub><em>t</em>-1</sub>-<em>x</em>*] is <a href="stability_theory" title="wikilink">stable</a>—that is, 

<math display="inline" id="Matrix_difference_equation:9">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}
  </annotation>
 </semantics>
</math>

 converges asymptotically to the steady state <em>x*</em>—if and only if all <a href="eigenvalue" title="wikilink">eigenvalues</a> of the transition matrix <em>A</em> (whether real or complex) have an <a href="absolute_value" title="wikilink">absolute value</a> which is less than 1.</p>
<h2 id="solution-of-the-first-order-case">Solution of the first-order case</h2>

<p>Assume that the equation has been put in the homogeneous form 

<math display="inline" id="Matrix_difference_equation:10">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>t</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=Ay_{t-1}
  </annotation>
 </semantics>
</math>


. Then we can iterate and substitute repeatedly from the <a href="initial_condition" title="wikilink">initial condition</a> 

<math display="inline" id="Matrix_difference_equation:11">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{0}
  </annotation>
 </semantics>
</math>

, which is the initial value of the vector <em>y</em> and which must be known in order to find the solution:</p>

<p>

<math display="block" id="Matrix_difference_equation:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1}=Ay_{0},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Matrix_difference_equation:13">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>2</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mi>A</mi>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>A</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{2}=Ay_{1}=AAy_{0}=A^{2}y_{0},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Matrix_difference_equation:14">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>3</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <msup>
      <mi>A</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>A</mi>
      <mn>3</mn>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{3}=Ay_{2}=AA^{2}y_{0}=A^{3}y_{0},
  </annotation>
 </semantics>
</math>

</p>

<p>and so forth.</p>

<p>Assume A is diagonalizable. By <a href="mathematical_induction" title="wikilink">induction</a>, we obtain the solution in terms of <em>t</em>:</p>

<p>

<math display="block" id="Matrix_difference_equation:15">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>A</mi>
      <mi>t</mi>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>P</mi>
     <msup>
      <mi>D</mi>
      <mi>t</mi>
     </msup>
     <msup>
      <mi>P</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>P</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=A^{t}y_{0}=PD^{t}P^{-1}y_{0},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>P</em> is an <em>n</em> × <em>n</em> matrix whose columns are the <a href="eigenvector" title="wikilink">eigenvectors</a> of <em>A</em> (assuming the eigenvalues are all distinct) and <em>D</em> is an <em>n</em> × <em>n</em> diagonal matrix whose diagonal elements are the eigenvalues of <em>A</em>. This solution motivates the above stability result

<math display="block" id="Matrix_difference_equation:16">
 <semantics>
  <msup>
   <mi>A</mi>
   <mi>t</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{t}
  </annotation>
 </semantics>
</math>

 shrinks to the zero matrix over time if and only if the eigenvalues of <em>A</em> are all less than unity in absolute value.</p>
<h2 id="extracting-the-dynamics-of-a-single-scalar-variable-from-a-first-order-matrix-system">Extracting the dynamics of a single scalar variable from a first-order matrix system</h2>

<p>Starting from the <em>n</em>-dimensional system 

<math display="inline" id="Matrix_difference_equation:17">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}=Ay_{t-1},
  </annotation>
 </semantics>
</math>

 we can extract the dynamics of one of the state variables, say 

<math display="inline" id="Matrix_difference_equation:18">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1}.
  </annotation>
 </semantics>
</math>

 The above solution equation for 

<math display="inline" id="Matrix_difference_equation:19">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{t}
  </annotation>
 </semantics>
</math>

 shows that the solution for 

<math display="inline" id="Matrix_difference_equation:20">
 <semantics>
  <msub>
   <mi>y</mi>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mi>t</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <list>
     <cn type="integer">1</cn>
     <ci>t</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1,t}
  </annotation>
 </semantics>
</math>


 is in terms of the <em>n</em> eigenvalues of <em>A</em>. Therefore the equation describing the evolution of 

<math display="inline" id="Matrix_difference_equation:21">
 <semantics>
  <msub>
   <mi>y</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1}
  </annotation>
 </semantics>
</math>

 by itself must have a solution involving those same eigenvalues. This description intuitively motivates the equation of evolution of 

<math display="inline" id="Matrix_difference_equation:22">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1},
  </annotation>
 </semantics>
</math>

 which is</p>

<p>

<math display="block" id="Matrix_difference_equation:23">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">…</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>y</mi>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>t</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <list>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </list>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <list>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </list>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <list>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>n</ci>
        </apply>
       </list>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1,t}=a_{1}y_{1,t-1}+a_{2}y_{1,t-2}+\dots+a_{n}y_{1,t-n}
  </annotation>
 </semantics>
</math>

</p>

<p>where the parameters 

<math display="inline" id="Matrix_difference_equation:24">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

 are from the <a href="Characteristic_equation_(calculus)" title="wikilink">characteristic equation</a> of the matrix <em>A</em>:</p>

<p>

<math display="block" id="Matrix_difference_equation:25">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>λ</mi>
     <mi>n</mi>
    </msup>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>λ</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>2</mn>
     </msub>
     <msup>
      <mi>λ</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>-</mo>
    <mi mathvariant="normal">…</mi>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>λ</mi>
      <mn>0</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>λ</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda^{n}-a_{1}\lambda^{n-1}-a_{2}\lambda^{n-2}-\dots-a_{n}\lambda^{0}=0.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus each individual scalar variable of an <em>n</em>-dimensional first-order linear system evolves according to a univariate <em>n</em><sup>th</sup> degree difference equation, which has the same stability property (stable or unstable) as does the matrix difference equation.</p>
<h2 id="solution-and-stability-of-higher-order-cases">Solution and stability of higher-order cases</h2>

<p>Matrix difference equations of higher order—that is, with a time lag longer than one period—can be solved, and their stability analyzed, by converting them into first-order form using a block matrix. For example, suppose we have the second-order equation</p>

<p>

<math display="block" id="Matrix_difference_equation:26">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{t}=Ax_{t-1}+Bx_{t-2}
  </annotation>
 </semantics>
</math>

</p>

<p>with the variable vector <em>x</em> being <em>n</em>×1 and <em>A</em> and <em>B</em> being <em>n</em>×<em>n</em>. This can be stacked in the form</p>

<p>

<math display="block" id="Matrix_difference_equation:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mi>t</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mtext>A</mtext>
        </mtd>
        <mtd columnalign="center">
         <mtext>B</mtext>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mtext>I</mtext>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>t</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>t</mi>
           <mo>-</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <mtext>A</mtext>
       <mtext>B</mtext>
      </matrixrow>
      <matrixrow>
       <mtext>I</mtext>
       <cn type="integer">0</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}x_{t}\\
x_{t-1}\\
\end{pmatrix}=\begin{pmatrix}\text{A}&\text{B}\\
\text{I}&0\\
\end{pmatrix}\begin{pmatrix}x_{t-1}\\
x_{t-2}\end{pmatrix},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Matrix_difference_equation:28">
 <semantics>
  <mi>I</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>I</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I
  </annotation>
 </semantics>
</math>

 is the <em>n</em>×<em>n</em> <a href="identity_matrix" title="wikilink">identity matrix</a> and 0 is the <em>n</em>×<em>n</em> <a href="zero_matrix" title="wikilink">zero matrix</a>. Then denoting the 2<em>n</em>×1 stacked vector of current and once-lagged variables as 

<math display="inline" id="Matrix_difference_equation:29">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{t}
  </annotation>
 </semantics>
</math>

 and the 2<em>n</em>×2<em>n</em> block matrix as <em>L</em>, we have as before the solution</p>

<p>

<math display="block" id="Matrix_difference_equation:30">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>L</mi>
      <mi>t</mi>
     </msup>
     <msub>
      <mi>z</mi>
      <mn>0</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{t}=L^{t}z_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>Also as before, this stacked equation and thus the original second-order equation are stable if and only if all eigenvalues of the matrix <em>L</em> are smaller than unity in absolute value.</p>
<h2 id="nonlinear-matrix-difference-equations-riccati-equations">Nonlinear matrix difference equations: Riccati equations</h2>

<p>In <a href="linear-quadratic-Gaussian_control" title="wikilink">linear-quadratic-Gaussian control</a>, there arises a nonlinear matrix equation for the evolution backwards through time of a current-and-future-cost <em>matrix</em>, denoted below as <em>H</em>. This equation is called a discrete dynamic <a href="Riccati_equation" title="wikilink">Riccati equation</a>, and it arises when a variable vector evolving according to a linear matrix difference equation is to be controlled by manipulating an <a href="exogeny" title="wikilink">exogenous</a> vector in order to optimize a <a href="quadratic_function" title="wikilink">quadratic</a> <a href="Multi-objective_optimization" title="wikilink">cost function</a>. This Riccati equation assumes the following form or a similar form:</p>

<p>

<math display="block" id="Matrix_difference_equation:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mrow>
      <mi>t</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>K</mi>
      <mo>+</mo>
      <mrow>
       <msup>
        <mi>A</mi>
        <mo>′</mo>
       </msup>
       <msub>
        <mi>H</mi>
        <mi>t</mi>
       </msub>
       <mi>A</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>A</mi>
       <mo>′</mo>
      </msup>
      <msub>
       <mi>H</mi>
       <mi>t</mi>
      </msub>
      <mi>C</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msup>
           <mi>C</mi>
           <mo>′</mo>
          </msup>
          <msub>
           <mi>H</mi>
           <mi>t</mi>
          </msub>
          <mi>C</mi>
         </mrow>
         <mo>+</mo>
         <mi>R</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <msup>
       <mi>C</mi>
       <mo>′</mo>
      </msup>
      <msub>
       <mi>H</mi>
       <mi>t</mi>
      </msub>
      <mi>A</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <apply>
      <minus></minus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <ci>K</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>A</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>t</ci>
       </apply>
       <ci>A</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>t</ci>
      </apply>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>C</ci>
          <ci>normal-′</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>t</ci>
         </apply>
         <ci>C</ci>
        </apply>
        <ci>R</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>C</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>t</ci>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{t-1}=K+A^{\prime}H_{t}A-A^{\prime}H_{t}C(C^{\prime}H_{t}C+R)^{-1}C^{\prime}%
H_{t}A,\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>H</em>, <em>K</em>, and <em>A</em> are <em>n</em>×<em>n</em>, <em>C</em> is <em>n</em>×<em>k</em>, <em>R</em> is <em>k</em>×<em>k</em>, <em>n</em> is the number of elements in the vector to be controlled, and <em>k</em> is the number of elements in the control vector. The parameter matrices <em>A</em> and <em>C</em> are from the linear equation, and the parameter matrices <em>K</em> and <em>R</em> are from the quadratic cost function. See <a href="Algebraic_Riccati_equation#Context_of_the_discrete-time_algebraic_Riccati_equation" title="wikilink">here</a> for details.</p>

<p>In general this equation cannot be solved analytically for 

<math display="inline" id="Matrix_difference_equation:32">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{t}
  </annotation>
 </semantics>
</math>

 in terms of <em>t</em> ; rather, the sequence of values for 

<math display="inline" id="Matrix_difference_equation:33">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{t}
  </annotation>
 </semantics>
</math>

 is found by iterating the Riccati equation. However, it was shown in <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> that this Riccati equation can be solved analytically if <em>R</em> is the zero matrix and <em>n</em>=<em>k</em>+1, by reducing it to a scalar <a href="rational_difference_equation" title="wikilink">rational difference equation</a>; moreover, for any <em>k</em> and <em>n</em> if the transition matrix <em>A</em> is nonsingular then the Riccati equation can be solved analytically in terms of the eigenvalues of a matrix, although these may need to be found numerically.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>In most contexts the evolution of <em>H</em> backwards through time is stable, meaning that <em>H</em> converges to a particular fixed matrix <em>H</em>* which may be irrational even if all the other matrices are rational. See also <a href="Stochastic_control#Discrete_time" title="wikilink">Stochastic control#Discrete time</a>.</p>

<p>A related Riccati equation<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> is</p>

<p>

<math display="block" id="Matrix_difference_equation:34">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>E</mi>
       <mo>+</mo>
       <mrow>
        <mi>B</mi>
        <msub>
         <mi>X</mi>
         <mi>t</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>C</mi>
        <mo>+</mo>
        <mrow>
         <mi>A</mi>
         <msub>
          <mi>X</mi>
          <mi>t</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>E</ci>
       <apply>
        <times></times>
        <ci>B</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t+1}=-(E+BX_{t})(C+AX_{t})^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>in which the matrices <em>X</em>, <em>A</em>, <em>B</em>, <em>C</em>, and <em>E</em> are all <em>n</em>×<em>n</em>. This equation can be solved explicitly. Suppose 

<math display="inline" id="Matrix_difference_equation:35">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>N</mi>
     <mi>t</mi>
    </msub>
    <msubsup>
     <mi>D</mi>
     <mi>t</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=N_{t}D_{t}^{-1}
  </annotation>
 </semantics>
</math>


, which certainly holds for <em>t</em>=0 with <em>N</em><sub>0</sub> = <em>X</em><sub>0</sub> and with <em>D</em><sub>0</sub> equal to the identity matrix. Then using this in the difference equation yields</p>

<p>

<math display="block" id="Matrix_difference_equation:36">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>E</mi>
       <mo>+</mo>
       <mrow>
        <mi>B</mi>
        <msub>
         <mi>N</mi>
         <mi>t</mi>
        </msub>
        <msubsup>
         <mi>D</mi>
         <mi>t</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>D</mi>
      <mi>t</mi>
     </msub>
     <msubsup>
      <mi>D</mi>
      <mi>t</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>C</mi>
        <mo>+</mo>
        <mrow>
         <mi>A</mi>
         <msub>
          <mi>N</mi>
          <mi>t</mi>
         </msub>
         <msubsup>
          <mi>D</mi>
          <mi>t</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>E</ci>
       <apply>
        <times></times>
        <ci>B</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>t</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>t</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>C</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>t</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>D</ci>
           <ci>t</ci>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t+1}=-(E+BN_{t}D_{t}^{-1})D_{t}D_{t}^{-1}(C+AN_{t}D_{t}^{-1})^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Matrix_difference_equation:37">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <msub>
         <mi>D</mi>
         <mi>t</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>B</mi>
        <msub>
         <mi>N</mi>
         <mi>t</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>C</mi>
          <mo>+</mo>
          <mrow>
           <mi>A</mi>
           <msub>
            <mi>N</mi>
            <mi>t</mi>
           </msub>
           <msubsup>
            <mi>D</mi>
            <mi>t</mi>
            <mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <msub>
         <mi>D</mi>
         <mi>t</mi>
        </msub>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>E</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>B</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <apply>
          <plus></plus>
          <ci>C</ci>
          <apply>
           <times></times>
           <ci>A</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>N</ci>
            <ci>t</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>D</ci>
             <ci>t</ci>
            </apply>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>D</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =-(ED_{t}+BN_{t})[(C+AN_{t}D_{t}^{-1})D_{t}]^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Matrix_difference_equation:38">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>E</mi>
        <msub>
         <mi>D</mi>
         <mi>t</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>B</mi>
        <msub>
         <mi>N</mi>
         <mi>t</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mi>C</mi>
         <msub>
          <mi>D</mi>
          <mi>t</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>A</mi>
         <msub>
          <mi>N</mi>
          <mi>t</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>E</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>B</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>C</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>D</ci>
           <ci>t</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>A</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>N</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =-(ED_{t}+BN_{t})[CD_{t}+AN_{t}]^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Matrix_difference_equation:39">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>N</mi>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <msubsup>
      <mi>D</mi>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <apply>
        <plus></plus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =N_{t+1}D_{t+1}^{-1},
  </annotation>
 </semantics>
</math>

</p>

<p>so by induction the form 

<math display="inline" id="Matrix_difference_equation:40">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>N</mi>
     <mi>t</mi>
    </msub>
    <msubsup>
     <mi>D</mi>
     <mi>t</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=N_{t}D_{t}^{-1}
  </annotation>
 </semantics>
</math>


 holds for all <em>t</em>. Then the evolution of <em>N</em> and <em>D</em> can be written as</p>

<p>

<math display="block" id="Matrix_difference_equation:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>N</mi>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>D</mi>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mi>B</mi>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mi>E</mi>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>A</mi>
        </mtd>
        <mtd columnalign="center">
         <mi>C</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>N</mi>
          <mi>t</mi>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>D</mi>
          <mi>t</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mi>J</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>N</mi>
          <mi>t</mi>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>D</mi>
          <mi>t</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <apply>
         <plus></plus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <plus></plus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <ci>B</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>E</ci>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>A</ci>
        <ci>C</ci>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>t</ci>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>t</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>J</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>t</ci>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>D</ci>
         <ci>t</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}N_{t+1}\\
D_{t+1}\end{pmatrix}=\begin{pmatrix}-B&-E\\
A&C\end{pmatrix}\begin{pmatrix}N_{t}\\
D_{t}\end{pmatrix}\equiv J\begin{pmatrix}N_{t}\\
D_{t}\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus</p>

<p>

<math display="block" id="Matrix_difference_equation:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>N</mi>
         <mi>t</mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>D</mi>
         <mi>t</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>J</mi>
      <mi>t</mi>
     </msup>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>N</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>D</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>t</ci>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>t</ci>
      </apply>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>J</ci>
      <ci>t</ci>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}N_{t}\\
D_{t}\end{pmatrix}=J^{t}\begin{pmatrix}N_{0}\\
D_{0}\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Matrix_differential_equation" title="wikilink">Matrix differential equation</a></li>
<li><a href="Difference_equation" title="wikilink">Difference equation</a></li>
<li><a href="Dynamical_system" title="wikilink">Dynamical system</a></li>
<li><a href="Matrix_Riccati_equation#Mathematical_description_of_the_problem_and_solution" title="wikilink">Matrix Riccati equation#Mathematical description of the problem and solution</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Linear_algebra" title="wikilink">Category:Linear algebra</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a href="Category:Recurrence_relations" title="wikilink">Category:Recurrence relations</a> <a href="Category:Dynamical_systems" title="wikilink">Category:Dynamical systems</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Cull, Paul; Flahive, Mary; and Robson, Robbie. <em>Difference Equations: From Rabbits to Chaos</em>, Springer, 2005, chapter 7; ISBN 0-387-23234-6.<a href="#fnref1">↩</a></li>
<li id="fn2">Chiang, Alpha C., <em>Fundamental Methods of Mathematical Economics</em>, third edition, McGraw-Hill, 1984: 608–612.<a href="#fnref2">↩</a></li>
<li id="fn3">Balvers, Ronald J., and Mitchell, Douglas W., "Reducing the dimensionality of linear quadratic control problems," <em><a href="Journal_of_Economic_Dynamics_and_Control" title="wikilink">Journal of Economic Dynamics and Control</a></em> 31, 2007, 141–159.<a href="#fnref3">↩</a></li>
<li id="fn4">Vaughan, D. R., "A nonrecursive algebraic solution for the discrete Riccati equation," <em>IEEE Transactions on Automatic Control</em> 15, 1970, 597-599.<a href="#fnref4">↩</a></li>
<li id="fn5">Martin, C. F., and Ammar, G., "The geometry of the matrix Riccati equation and associated eigenvalue method," in Bittani, Laub, and Willems (eds.), <em>The Riccati Equation</em>, Springer-Verlag, 1991.<a href="#fnref5">↩</a></li>
</ol>
</section>
</body>
</html>

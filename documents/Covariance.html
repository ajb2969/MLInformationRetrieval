<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="490">Covariance</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Covariance</h1>
<hr/>

<p>In <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>covariance</strong> is a measure of how much two <a href="random_variable" title="wikilink">random variables</a> change together. If the greater values of one variable mainly correspond with the greater values of the other variable, and the same holds for the smaller values, i.e., the variables tend to show similar behavior, the covariance is positive.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In the opposite case, when the greater values of one variable mainly correspond to the smaller values of the other, i.e., the variables tend to show opposite behavior, the covariance is negative. The sign of the covariance therefore shows the tendency in the linear relationship between the variables. The magnitude of the covariance is not easy to interpret. The <a href="Covariance_and_correlation" title="wikilink">normalized version of the covariance</a>, the <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">correlation coefficient</a>, however, shows by its magnitude the strength of the linear relation.</p>

<p>A distinction must be made between (1) the covariance of two random variables, which is a <a href="Statistical_population" title="wikilink">population</a> <a href="Statistical_parameter" title="wikilink">parameter</a> that can be seen as a property of the <a href="joint_probability_distribution" title="wikilink">joint probability distribution</a>, and (2) the <a href="sample_(statistics)" title="wikilink">sample</a> covariance, which serves as an <a href="Statistical_estimation" title="wikilink">estimated</a> value of the parameter.</p>
<h2 id="definition">Definition</h2>

<p>The covariance between two <a href="Joint_distribution" title="wikilink">jointly distributed</a> <a href="real_number" title="wikilink">real</a>-valued <a href="random_variable" title="wikilink">random variables</a> <em>X</em> and <em>Y</em> with finite <a href="second_moment" title="wikilink">second moments</a> is defined as<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Covariance:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>œÉ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo maxsize="120%" minsize="120%">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <mrow>
          <mo>E</mo>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>X</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>Y</mi>
         <mo>-</mo>
         <mrow>
          <mo>E</mo>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>Y</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>œÉ</ci>
     <interval closure="open">
      <ci>X</ci>
      <ci>Y</ci>
     </interval>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>X</ci>
       <apply>
        <ci>normal-E</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>Y</ci>
       <apply>
        <ci>normal-E</ci>
        <ci>Y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(X,Y)=\operatorname{E}{\big[(X-\operatorname{E}[X])(Y-\operatorname{E}[Y%
])\big]},
  </annotation>
 </semantics>
</math>

 where E[<em>X</em>] is the <a href="expected_value" title="wikilink">expected value</a> of <em>X</em>, also known as the mean of <em>X</em>. By using the linearity property of expectations, this can be simplified to</p>

<p>

<math display="inline" id="Covariance:1">
 <semantics>
  <mrow>
   <mi>œÉ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>œÉ</ci>
    <interval closure="open">
     <ci>X</ci>
     <ci>Y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sigma(X,Y)
  </annotation>
 </semantics>
</math>


 However, when 

<math display="inline" id="Covariance:2">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>X</mi>
      <mi>Y</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>‚âà</mo>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>Y</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[XY]\approx\operatorname{E}[X]\operatorname{E}[Y]
  </annotation>
 </semantics>
</math>

, this last equation is prone to <a href="catastrophic_cancellation" title="wikilink">catastrophic cancellation</a> when computed with floating point arithmetic and thus should be avoided in computer programs when the data has not been centered before.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>For <a href="random_vector" title="wikilink">random vectors</a> 

<math display="inline" id="Covariance:3">
 <semantics>
  <mrow>
   <mi>ùêó</mi>
   <mo>‚àà</mo>
   <msup>
    <mi>‚Ñù</mi>
    <mi>m</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>ùêó</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>‚Ñù</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}\in\mathbb{R}^{m}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Covariance:4">
 <semantics>
  <mrow>
   <mi>ùêò</mi>
   <mo>‚àà</mo>
   <msup>
    <mi>‚Ñù</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>ùêò</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>‚Ñù</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Y}\in\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

, the <em>m√ón</em> <a href="cross_covariance" title="wikilink">cross covariance</a> matrix (also known as <strong>dispersion matrix</strong> or <strong>variance‚Äìcovariance matrix</strong>,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> or simply called <a href="covariance_matrix" title="wikilink">covariance matrix</a>) is equal to</p>

<p>

<math display="inline" id="Covariance:5">
 <semantics>
  <mrow>
   <mi>œÉ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo>,</mo>
    <mi>ùêò</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>œÉ</ci>
    <interval closure="open">
     <ci>ùêó</ci>
     <ci>ùêò</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sigma(\mathbf{X},\mathbf{Y})
  </annotation>
 </semantics>
</math>


</p>

<p>where <strong>m</strong><sup>T</sup> is the <a class="uri" href="transpose" title="wikilink">transpose</a> of the vector (or matrix) <strong>m</strong>.</p>

<p>The (<em>i</em>,<em>j</em>)-th element of this matrix is equal to the covariance Cov(<em>X<sub>i</sub></em>, <em>Y<sub>j</sub></em>) between the <em>i</em>-th scalar component of <em>X</em> and the <em>j</em>-th scalar component of <em>Y</em>. In particular, Cov(<em>Y</em>,¬†<em>X</em>) is the <a class="uri" href="transpose" title="wikilink">transpose</a> of Cov(<em>X</em>,¬†<em>Y</em>).</p>

<p>For a vector 

<math display="inline" id="Covariance:6">
 <semantics>
  <mrow>
   <mi>ùêó</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>X</mi>
         <mn>1</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>X</mi>
         <mn>2</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">‚Ä¶</mi>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>X</mi>
         <mi>m</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêó</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-‚Ä¶</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>m</ci>
       </apply>
      </matrixrow>
     </matrix>
     <ci>normal-T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=\begin{bmatrix}X_{1}&X_{2}&\dots&X_{m}\end{bmatrix}^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

 of <em>m</em> jointly distributed random variables with finite second moments, its <a href="covariance_matrix" title="wikilink">covariance matrix</a> is defined as</p>

<p>

<math display="block" id="Covariance:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Œ£</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>œÉ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ùêó</mi>
      <mo>,</mo>
      <mi>ùêó</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Œ£</ci>
     <ci>ùêó</ci>
    </apply>
    <apply>
     <times></times>
     <ci>œÉ</ci>
     <interval closure="open">
      <ci>ùêó</ci>
      <ci>ùêó</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma(\mathbf{X})=\sigma(\mathbf{X},\mathbf{X}).
  </annotation>
 </semantics>
</math>

</p>

<p>Random variables whose covariance is zero are called <a class="uri" href="uncorrelated" title="wikilink">uncorrelated</a>.</p>

<p>The <a href="unit_of_measurement" title="wikilink">units of measurement</a> of the covariance Cov(<em>X</em>,¬†<em>Y</em>) are those of <em>X</em> times those of <em>Y</em>. By contrast, <a href="correlation" title="wikilink">correlation coefficients</a>, which depend on the covariance, are a <a href="dimensionless_number" title="wikilink">dimensionless</a> measure of linear dependence. (In fact, correlation coefficients can simply be understood as a normalized version of covariance.)</p>

<p>The covariance of two discrete sets can be equivalently expressed, without directly referring to the mean<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Covariance:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mrow>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>x</mi>
            <mi>i</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>x</mi>
            <mi>j</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>‚ãÖ</mo>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>y</mi>
            <mi>i</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>y</mi>
            <mi>j</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi mathvariant="normal">T</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>i</mi>
      </munder>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>j</mi>
         <mo>></mo>
         <mi>i</mi>
        </mrow>
       </munder>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>x</mi>
           <mi>j</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>‚ãÖ</mo>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <msub>
            <mi>y</mi>
            <mi>i</mi>
           </msub>
           <mo>-</mo>
           <msub>
            <mi>y</mi>
            <mi>j</mi>
           </msub>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi mathvariant="normal">T</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>cov</ci>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <ci>normal-‚ãÖ</ci>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>i</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>j</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>i</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>j</ci>
           </apply>
          </apply>
          <ci>normal-T</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <gt></gt>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <ci>normal-‚ãÖ</ci>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>j</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>i</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>j</ci>
           </apply>
          </apply>
          <ci>normal-T</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(X,Y)=\frac{1}{n^{2}}\sum_{i=1}^{n}\sum_{j=1}^{n}\frac{1}{2}%
(x_{i}-x_{j})\cdot(y_{i}-y_{j})^{\mathrm{T}}=\frac{1}{n^{2}}\sum_{i}\sum_{j>i}%
(x_{i}-x_{j})\cdot(y_{i}-y_{j})^{\mathrm{T}}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="properties">Properties</h2>
<ul>
<li><a class="uri" href="Variance" title="wikilink">Variance</a> is a special case of the covariance when the two variables are identical:</li>
</ul>

<p>

<math display="block" id="Covariance:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>œÉ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>œÉ</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>œÉ</ci>
     <interval closure="open">
      <ci>X</ci>
      <ci>X</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(X,X)=\sigma^{2}(X).
  </annotation>
 </semantics>
</math>

</p>
<ul>
<li>If <em>X</em>, <em>Y</em>, <em>W</em>, and <em>V</em> are real-valued random variables and <em>a</em>, <em>b</em>, <em>c</em>, <em>d</em> are constant ("constant" in this context means non-random), then the following facts are a consequence of the definition of covariance:</li>
</ul>

<p>

<math display="inline" id="Covariance:10">
 <semantics>
  <mrow>
   <mi>œÉ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>a</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>œÉ</ci>
    <interval closure="open">
     <ci>X</ci>
     <ci>a</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sigma(X,a)
  </annotation>
 </semantics>
</math>


</p>

<p>For a sequence <em>X</em><sub>1</sub>, ..., <em>X</em><sub><em>n</em></sub> of random variables, and constants <em>a</em><sub>1</sub>, ..., <em>a</em><sub><em>n</em></sub>, we have</p>

<p>

<math display="inline" id="Covariance:11">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Œ£</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>ùêó</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Œ£</ci>
    <ci>ùêó</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma(\mathbf{X})
  </annotation>
 </semantics>
</math>

 be a <a href="random_vector" title="wikilink">random vector</a> with covariance matrix 

<math display="inline" id="Covariance:12">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, and let 

<math display="inline" id="Covariance:13">
 <semantics>
  <mi>ùêó</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 be a matrix that can act on 

<math display="inline" id="Covariance:14">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mi>ùêó</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>ùêó</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\mathbf{X}
  </annotation>
 </semantics>
</math>

. The covariance matrix of the vector 

<math display="block" id="Covariance:15">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œ£</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>ùêó</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>A</mi>
    </mpadded>
    <mi mathvariant="normal">Œ£</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ùêó</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>A</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Œ£</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>ùêó</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <ci>normal-Œ£</ci>
     <ci>ùêó</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma(A\mathbf{X})=A\,\Sigma(\mathbf{X})\,A^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

 is:</p>

<p>

<math display="block" id="Covariance:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mi>X</mi>
       <mi>Y</mi>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>X</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>‚ãÖ</mo>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>Y</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-‚ãÖ</ci>
     <apply>
      <ci>normal-E</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}\left[XY\right]=\operatorname{E}[X]\cdot\operatorname{E}[Y].
  </annotation>
 </semantics>
</math>

.</p>

<p>This is a direct result of the linearity of <a href="expected_value" title="wikilink">expectation</a> and is useful when applying a <a href="linear_transformation" title="wikilink">linear transformation</a>, such as a <a href="whitening_transformation" title="wikilink">whitening transformation</a>, to a vector.</p>
<h3 id="uncorrelatedness-and-independence">Uncorrelatedness and independence</h3>

<p>If <em>X</em> and <em>Y</em> are <a href="statistical_independence" title="wikilink">independent</a>, then their covariance is zero. This follows because under independence,</p>

<p>

<math display="inline" id="Covariance:17">
 <semantics>
  <mrow>
   <mi>œÉ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>œÉ</ci>
    <interval closure="open">
     <ci>X</ci>
     <ci>Y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sigma(X,Y)
  </annotation>
 </semantics>
</math>


</p>

<p>The converse, however, is not generally true. For example, let <em>X</em> be uniformly distributed in [-1, 1] and let <em>Y</em>¬†=¬†X<sup>2</sup>. Clearly, <em>X</em> and <em>Y</em> are dependent, but</p>

<p>

<math display="block" id="Covariance:18">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mi>œÉ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>‚â§</mo>
   <msqrt>
    <mrow>
     <msup>
      <mi>œÉ</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>œÉ</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <abs></abs>
     <apply>
      <times></times>
      <ci>œÉ</ci>
      <interval closure="open">
       <ci>X</ci>
       <ci>Y</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>œÉ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>X</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>œÉ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |\sigma(X,Y)|\leq\sqrt{\sigma^{2}(X)\sigma^{2}(Y)}
  </annotation>
 </semantics>
</math>

 In this case, the relationship between <em>Y</em> and <em>X</em> is non-linear, while correlation and covariance are measures of linear dependence between two variables. This example shows that if two variables are uncorrelated, that does not in general imply that they are independent. However, if two variables are <a href="Multivariate_normal_distribution" title="wikilink">jointly normally distributed</a> (but not if they are merely <a href="Normally_distributed_and_uncorrelated_does_not_imply_independent" title="wikilink">individually normally distributed</a>), uncorrelatedness <em>does</em> imply independence.</p>
<h3 id="relationship-to-inner-products">Relationship to inner products</h3>

<p>Many of the properties of covariance can be extracted elegantly by observing that it satisfies similar properties to those of an <a href="inner_product" title="wikilink">inner product</a>:</p>
<ol>
<li><a href="bilinear_operator" title="wikilink">bilinear</a>: for constants <em>a</em> and <em>b</em> and random variables <em>X</em>, <em>Y</em>, <em>Z</em>, œÉ(<em>aX</em>¬†+¬†<em>bY</em>,¬†<em>Z</em>) =¬†<em>a</em>¬†œÉ(<em>X</em>,¬†<em>Z</em>)¬†+¬†<em>b</em>¬†œÉ(<em>Y</em>,¬†<em>Z</em>);</li>
<li>symmetric: œÉ(<em>X</em>,¬†<em>Y</em>) = œÉ(<em>Y</em>,¬†<em>X</em>);</li>
<li><a href="definite_bilinear_form" title="wikilink">positive semi-definite</a>: œÉ<sup>2</sup>(<em>X</em>) = œÉ(<em>X</em>,¬†<em>X</em>)¬†‚â•¬†0 for all random variables <em>X</em>, and œÉ(<em>X</em>,¬†<em>X</em>) =¬†0 implies that <em>X</em> is a constant random variable¬†(<em>K</em>).</li>
</ol>

<p>In fact these properties imply that the covariance defines an inner product over the <a href="quotient_space_(linear_algebra)" title="wikilink">quotient vector space</a> obtained by taking the subspace of random variables with finite second moment and identifying any two that differ by a constant. (This identification turns the positive semi-definiteness above into positive definiteness.) That quotient vector space is isomorphic to the subspace of random variables with finite second moment and mean zero; on that subspace, the covariance is exactly the <a href="Lp_space" title="wikilink">L<sup>2</sup></a> inner product of real-valued functions on the sample space.</p>

<p>As a result for random variables with finite variance, the inequality</p>

<p>

<math display="block" id="Covariance:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>Z</mi>
    <mo>=</mo>
    <mrow>
     <mi>X</mi>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>œÉ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>X</mi>
         <mo>,</mo>
         <mi>Y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <msup>
         <mi>œÉ</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mi>Y</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Z</ci>
    <apply>
     <minus></minus>
     <ci>X</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>œÉ</ci>
        <interval closure="open">
         <ci>X</ci>
         <ci>Y</ci>
        </interval>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>œÉ</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>Y</ci>
       </apply>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z=X-\frac{\sigma(X,Y)}{\sigma^{2}(Y)}Y.
  </annotation>
 </semantics>
</math>

</p>

<p>holds via the <a href="Cauchy‚ÄìSchwarz_inequality" title="wikilink">Cauchy‚ÄìSchwarz inequality</a>.</p>

<p>Proof: If œÉ<sup>2</sup>(<em>Y</em>) = 0, then it holds trivially. Otherwise, let random variable</p>

<p>

<math display="inline" id="Covariance:20">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>‚â§</mo>
   <mrow>
    <msup>
     <mi>œÉ</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <cn type="integer">0</cn>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle 0\leq\sigma^{2}(Z)
  </annotation>
 </semantics>
</math>


</p>

<p>Then we have</p>

<p>

<math display="inline" id="Covariance:21">
 <semantics>
  <mrow>
   <mover accent="true">
    <mover accent="true">
     <mi>q</mi>
     <mo>¬Ø</mo>
    </mover>
    <mo>¬Ø</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>q</mi>
      <mrow>
       <mi>j</mi>
       <mi>k</mi>
      </mrow>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¬Ø</ci>
     <apply>
      <ci>normal-¬Ø</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\overline{\overline{q}}=\left[[q_{jk}]\right]
  </annotation>
 </semantics>
</math>


</p>
<h2 id="calculating-the-sample-covariance">Calculating the sample covariance</h2>

<p>The sample covariance of <em>N</em> observations of <em>K</em> variables is the <em>K</em>-by-<em>K</em> <a href="Matrix_(mathematics)" title="wikilink">matrix</a> 

<math display="block" id="Covariance:22">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>X</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>X</mi>
          <mo stretchy="false">¬Ø</mo>
         </mover>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>X</mi>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>X</mi>
          <mo stretchy="false">¬Ø</mo>
         </mover>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>X</ci>
         </apply>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¬Ø</ci>
          <ci>X</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}=\frac{1}{N-1}\sum_{i=1}^{N}\left(X_{ij}-\bar{X}_{j}\right)\left(X_{ik}-%
\bar{X}_{k}\right)
  </annotation>
 </semantics>
</math>

 with the entries</p>

<p>

<math display="inline" id="Covariance:23">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

,</p>

<p>which is an estimate of the covariance between variable 

<math display="inline" id="Covariance:24">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 and variable 

<math display="inline" id="Covariance:25">
 <semantics>
  <mi>ùêó</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêó</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{X}
  </annotation>
 </semantics>
</math>

.</p>

<p>The sample mean and the sample covariance matrix are <a href="Bias_of_an_estimator" title="wikilink">unbiased estimates</a> of the <a class="uri" href="mean" title="wikilink">mean</a> and the <a href="covariance_matrix" title="wikilink">covariance matrix</a> of the <a href="random_vector" title="wikilink">random vector</a> 

<math display="inline" id="Covariance:26">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle N-1
  </annotation>
 </semantics>
</math>


, a row vector whose <em>j</em>th element (<em>j = 1, ..., K</em>) is one of the random variables. The reason the sample covariance matrix has 

<math display="inline" id="Covariance:27">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle N
  </annotation>
 </semantics>
</math>

 in the denominator rather than 

<math display="inline" id="Covariance:28">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(X)
  </annotation>
 </semantics>
</math>

 is essentially that the population mean 

<math display="inline" id="Covariance:29">
 <semantics>
  <mover accent="true">
   <mi>ùêó</mi>
   <mo stretchy="false">¬Ø</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¬Ø</ci>
    <ci>ùêó</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\bar{X}}
  </annotation>
 </semantics>
</math>

 is not known and is replaced by the sample mean 

<math display="inline" id="Covariance:30">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(X)
  </annotation>
 </semantics>
</math>

. If the population mean 

<math display="block" id="Covariance:31">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>X</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <mrow>
         <mi>E</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>X</mi>
           <mi>j</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>X</mi>
         <mrow>
          <mi>i</mi>
          <mi>k</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <mrow>
         <mi>E</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>X</mi>
           <mi>k</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>E</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>E</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{jk}=\frac{1}{N}\sum_{i=1}^{N}\left(X_{ij}-E(X_{j})\right)\left(X_{ik}-E(X_{%
k})\right)
  </annotation>
 </semantics>
</math>

 is known, the analogous unbiased estimate is given by</p>

<p><span class="LaTeX">$$q_{jk}=\frac{1}{N}\sum_{i=1}^N \left(  X_{ij}-E(X_j)\right)  \left( X_{ik}-E(X_k)\right)$$</span></p>
<h2 id="comments">Comments</h2>

<p>The covariance is sometimes called a measure of "linear dependence" between the two random variables. That does not mean the same thing as in the context of <a href="linear_algebra" title="wikilink">linear algebra</a> (see <a href="linear_dependence" title="wikilink">linear dependence</a>). When the covariance is normalized, one obtains the <a href="correlation_matrix" title="wikilink">correlation coefficient</a>. From it, one can obtain the <a href="Pearson_coefficient" title="wikilink">Pearson coefficient</a>, which gives the goodness of the fit for the best possible linear function describing the relation between the variables. In this sense covariance is a linear gauge of dependence.</p>
<h2 id="applications">Applications</h2>
<h3 id="in-genetics-and-molecular-biology">In genetics and molecular biology</h3>

<p>Covariance is an important measure in biology. Certain sequences of DNA are conserved more than others among species, and thus to study secondary and tertiary structures of proteins, or of RNA structures, sequences are compared in closely related species. If sequence changes are found or no changes at all are found in noncoding RNA (such as microRNA), sequences are found to be necessary for common structural motifs, such as an RNA loop.</p>
<h3 id="in-financial-economics">In financial economics</h3>

<p>Covariances play a key role in <a href="financial_economics" title="wikilink">financial economics</a>, especially in <a href="Modern_portfolio_theory" title="wikilink">portfolio theory</a> and in the <a href="capital_asset_pricing_model" title="wikilink">capital asset pricing model</a>. Covariances among various assets' returns are used to determine, under certain assumptions, the relative amounts of different assets that investors should (in a <a href="Normative_economics" title="wikilink">normative analysis</a>) or are predicted to (in a <a href="Positive_economics" title="wikilink">positive analysis</a>) choose to hold in a context of <a href="Diversification_(finance)" title="wikilink">diversification</a>.</p>
<h3 id="in-meteorological-data-assimilation">In meteorological data assimilation</h3>

<p>The covariance matrix is important in estimating the initial conditions required for running weather forecast models.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Algorithms_for_calculating_variance#Covariance" title="wikilink">Algorithms for calculating covariance</a></li>
<li><a href="Analysis_of_covariance" title="wikilink">Analysis of covariance</a></li>
<li><a class="uri" href="Autocovariance" title="wikilink">Autocovariance</a></li>
<li><a href="Correlation_and_dependence" title="wikilink">Correlation and dependence</a></li>
<li><a href="Covariance_function" title="wikilink">Covariance function</a></li>
<li><a href="Covariance_mapping" title="wikilink">Covariance mapping</a></li>
<li><a href="Covariance_matrix" title="wikilink">Covariance matrix</a></li>
<li><a href="Covariance_operator" title="wikilink">Covariance operator</a></li>
<li><a href="Distance_covariance" title="wikilink">Distance covariance</a>, or Brownian covariance.</li>
<li><a href="Eddy_covariance" title="wikilink">Eddy covariance</a></li>
<li><a href="Law_of_total_covariance" title="wikilink">Law of total covariance</a></li>
<li><a href="Propagation_of_uncertainty" title="wikilink">Propagation of uncertainty</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li><a href="http://mathworld.wolfram.com/Covariance.html">MathWorld page on calculating the sample covariance</a></li>
<li><a href="http://www.r-tutor.com/elementary-statistics/numerical-measures/covariance">Covariance Tutorial using R</a></li>
</ul>

<p>"</p>

<p><a href="Category:Covariance_and_correlation" title="wikilink">Category:Covariance and correlation</a> <a href="Category:Algebra_of_random_variables" title="wikilink">Category:Algebra of random variables</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a class="uri" href="http://mathworld.wolfram.com/Covariance.html">http://mathworld.wolfram.com/Covariance.html</a><a href="#fnref1">‚Ü©</a></li>
<li id="fn2">Oxford Dictionary of Statistics, Oxford University Press, 2002, p. 104.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="Donald_E._Knuth" title="wikilink">Donald E. Knuth</a> (1998). <em><a href="The_Art_of_Computer_Programming" title="wikilink">The Art of Computer Programming</a></em>, volume 2: <em>Seminumerical Algorithms</em>, 3rd edn., p. 232. Boston: Addison-Wesley.<a href="#fnref3">‚Ü©</a></li>
<li id="fn4">W. J. Krzanowski, <em>Principles of Multivariate Analysis</em>, Chap. 7.1, Oxford University Press, New York, 1988<a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

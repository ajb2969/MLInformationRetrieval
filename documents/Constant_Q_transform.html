<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="870">Constant Q transform</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Constant Q transform</h1>
<hr/>

<p>In mathematics and <a href="signal_processing" title="wikilink">signal processing</a>, the <strong>Constant Q Transform</strong> transforms a data series to the frequency domain. It is related to the <a href="Fourier_Transform" title="wikilink">Fourier Transform</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> and very closely related to the complex <a href="Morlet_wavelet" title="wikilink">Morlet wavelet</a> transform.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>The transform can be thought of as a series of logarithmically spaced filters, with the <em>k</em>-th filter having a spectral width some multiple of the previous filter's width, i.e.</p>

<p>

<math display="inline" id="Constant_Q_transform:0">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>δ</mi>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <msup>
         <mn>2</mn>
         <mfrac>
          <mn>1</mn>
          <mi>n</mi>
         </mfrac>
        </msup>
        <mo>*</mo>
        <mi>δ</mi>
       </mrow>
       <msub>
        <mi>f</mi>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mi></mi>
      <mo>=</mo>
      <mrow>
       <mrow>
        <msup>
         <mrow>
          <mo>(</mo>
          <msup>
           <mn>2</mn>
           <mfrac>
            <mn>1</mn>
            <mi>n</mi>
           </mfrac>
          </msup>
          <mo>)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
        <mo>*</mo>
        <mi>δ</mi>
       </mrow>
       <msub>
        <mi>f</mi>
        <mi>min</mi>
       </msub>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>δ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cn type="integer">2</cn>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <ci>n</ci>
          </apply>
         </apply>
         <ci>k</ci>
        </apply>
        <ci>δ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>min</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle\delta f_{k}&\displaystyle=2^{\frac{1}{n}}*\delta f%
_{k-1}\\
&\displaystyle=\left({2^{\frac{1}{n}}}\right)^{k}*\delta f_{\mathrm{min}}\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>where δ<em>f<sub>k</sub></em> is the bandwidth of the kth filter, <em>f</em><sub>min</sub> is the centre frequency of the lowest filter, and <em>n</em> is the number of filters per <a href="octave_(electronics)" title="wikilink">octave</a>.</p>
<h2 id="calculation-of-the-transform">Calculation of the Transform</h2>

<p>The short-time Fourier Transform of <em>x</em>[<em>n</em>] for a frame shifted to sample <em>m</em> is calculated as follows:</p>

<p>

<math display="block" id="Constant_Q_transform:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <mrow>
     <mi>W</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>m</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>x</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <msup>
      <mi>e</mi>
      <mfrac>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>j</mi>
         <mn>2</mn>
         <mi>π</mi>
         <mi>k</mi>
         <mi>n</mi>
        </mrow>
       </mrow>
       <mi>N</mi>
      </mfrac>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>X</ci>
     <interval closure="closed">
      <ci>k</ci>
      <ci>m</ci>
     </interval>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>W</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <ci>x</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>j</ci>
          <cn type="integer">2</cn>
          <ci>π</ci>
          <ci>k</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X[k,m]=\sum_{n=0}^{N-1}W[n-m]x[n]e^{\frac{-j2\pi kn}{N}}
  </annotation>
 </semantics>
</math>

</p>

<p>Given a data series, sampled at <em>f<sub>s</sub></em> = 1/<em>T</em>, <em>T</em> being the sampling period of our data, for each frequency bin we can define the following:</p>
<ul>
<li>Filter width, δ<em>f<sub>k</sub></em></li>
</ul>
<ul>
<li><em>Q</em>, the "quality factor". This is shown below to be the integer number of cycles processed at a center frequency <em>f<sub>k</sub></em>. As such, this somewhat defines the time complexity of the transform.</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Constant_Q_transform:2">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>f</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mi>δ</mi>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=\frac{f_{k}}{\delta f_{k}}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<ul>
<li>Window length for the <em>k</em>-th bin</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Constant_Q_transform:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <msub>
      <mi>f</mi>
      <mi>s</mi>
     </msub>
     <mrow>
      <mi>δ</mi>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mi>S</mi>
      <msub>
       <mi>f</mi>
       <mi>k</mi>
      </msub>
     </mfrac>
     <mo>)</mo>
    </mrow>
    <mi>Q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <ci>δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <ci>Q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N[k]=\left(\frac{f_{s}}{\delta f_{k}}\right)=\left(\frac{S}{f_{k}}\right)Q
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>As <em>S</em>/<em>f<sub>k</sub></em> is the number of samples processed per cycle at frequency <em>f<sub>k</sub></em>, <em>Q</em> is the number of integer cycles processed at this center frequency.
</dd>
</dl>

<p>The equivalent transform kernel can be found by using the following substitutions:</p>
<ul>
<li>The window length of each bin is now a function of the bin number:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Constant_Q_transform:4">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>Q</mi>
    <mfrac>
     <msub>
      <mi>f</mi>
      <mi>s</mi>
     </msub>
     <msub>
      <mi>f</mi>
      <mi>k</mi>
     </msub>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>N</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>Q</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=N[k]=Q\frac{f_{s}}{f_{k}}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<ul>
<li>The relative power of each bin will decrease with higher frequencies, as these sum over fewer terms. To compensate for this, we normalize by <em>N</em>[<em>k</em>].</li>
</ul>
<ul>
<li>Any windowing function will be a function of window length, and likewise a function of window number. For example, the equivalent Hamming window would be,</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Constant_Q_transform:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>W</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>k</mi>
      <mo>,</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>α</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mn>2</mn>
          <mi>π</mi>
          <mi>n</mi>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>k</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mi>α</mi>
     <mo>=</mo>
     <mrow>
      <mn>25</mn>
      <mo>/</mo>
      <mn>46</mn>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mn>0</mn>
     <mo>⩽</mo>
     <mi>n</mi>
     <mo>⩽</mo>
     <mrow>
      <mrow>
       <mi>N</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>W</ci>
      <interval closure="closed">
       <ci>k</ci>
       <ci>n</ci>
      </interval>
     </apply>
     <apply>
      <minus></minus>
      <ci>α</ci>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>α</ci>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>π</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <times></times>
          <ci>N</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>α</ci>
      <apply>
       <divide></divide>
       <cn type="integer">25</cn>
       <cn type="integer">46</cn>
      </apply>
     </apply>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">0</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>N</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>k</ci>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W[k,n]=\alpha-\left(1-\alpha\right)\cos\left(\frac{2\pi n}{N[k]}\right),\alpha%
=25/46,0\leqslant n\leqslant N[k]-1
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<ul>
<li>Our digital frequency, 

<math display="inline" id="Constant_Q_transform:6">
 <semantics>
  <mfrac>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
    <mi>k</mi>
   </mrow>
   <mi>N</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
     <ci>k</ci>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{2\pi k}{N}
  </annotation>
 </semantics>
</math>

, becomes 

<math display="inline" id="Constant_Q_transform:7">
 <semantics>
  <mfrac>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
    <mi>Q</mi>
   </mrow>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
     <ci>Q</ci>
    </apply>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{2\pi Q}{N[k]}
  </annotation>
 </semantics>
</math>

</li>
</ul>

<p>After these modifications, we are left with:</p>

<p>

<math display="block" id="Constant_Q_transform:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>k</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>N</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>k</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mrow>
        <mi>N</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>k</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </munderover>
     <mrow>
      <mi>W</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>k</mi>
       <mo>,</mo>
       <mi>n</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>n</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <msup>
       <mi>e</mi>
       <mfrac>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>j</mi>
          <mn>2</mn>
          <mi>π</mi>
          <mi>Q</mi>
          <mi>n</mi>
         </mrow>
        </mrow>
        <mrow>
         <mi>N</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>k</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mfrac>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>X</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>N</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>k</ci>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>W</ci>
       <interval closure="closed">
        <ci>k</ci>
        <ci>n</ci>
       </interval>
       <ci>x</ci>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>j</ci>
           <cn type="integer">2</cn>
           <ci>π</ci>
           <ci>Q</ci>
           <ci>n</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>N</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X[k]=\frac{1}{N[k]}\sum_{n=0}^{N[k]-1}W[k,n]x[n]e^{\frac{-j2\pi Qn}{N[k]}}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="fast-calculation-using-fft">Fast calculation using FFT</h2>

<p>The direct calculation of the Constant Q transform is slow when compared against the <a href="Fast_Fourier_Transform" title="wikilink">Fast Fourier Transform</a> (FFT). However, the FFT can itself be employed, in conjunction with the use of a <a href="Kernel_(statistics)" title="wikilink">kernel</a>, to perform the equivalent calculation but much faster.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="comparison-with-the-fourier-transform">Comparison with the Fourier Transform</h2>

<p>In general, the transform is well suited to musical data, and this can be seen in some of its advantages compared to the Fast Fourier Transform. As the output of the transform is effectively amplitude/phase against log frequency, fewer frequency bins are required to cover a given range effectively, and this proves useful where frequencies span several octaves. As the range of human hearing covers approximately ten octaves from 20 Hz to around 20 kHz, this reduction in output data is significant.</p>

<p>The transform exhibits a reduction in frequency resolution with higher frequency bins—which is desirable for auditory applications. The transform mirrors the human auditory system, whereby at lower frequencies spectral resolution is better, whereas temporal resolution improves at higher frequencies. At the bottom of the piano scale (about 30 Hz), a difference of 1 semitone is a difference of approximately 1.5 Hz, whereas at the top of the musical scale (about 5 kHz), a difference of 1 semitone is a difference of approximately 200 Hz.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> So for musical data the exponential frequency resolution of Constant Q is ideal.</p>

<p>In addition, the harmonics of musical notes form a pattern characteristic of the timbre of the instrument in this transform. Assuming the same relative strengths of each harmonic, as the fundamental frequency changes, the relative position of these harmonics remains constant. This can make identification of instruments much easier.</p>

<p>Relative to the Fourier Transform, implementation of this transform is more tricky. This is due to the varying number of samples used in the calculation of each frequency bin, which also affects the length of any windowing function implemented.</p>

<p>Also note that because the frequency scale is logarithmic, there is no true zero-frequency / DC term present, perhaps limiting possible utility of the transform.</p>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Integral_transforms" title="wikilink">Category:Integral transforms</a> <a href="Category:Harmonic_analysis" title="wikilink">Category:Harmonic analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Judith C. Brown, <a href="http://www.wellesley.edu/Physics/brown/pubs/cq1stPaper.pdf">Calculation of a constant Q spectral transform</a>, <em>J. Acoust. Soc. Am.</em>, 89(1):425–434, 1991.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="https://ccrma.stanford.edu/~jos/sasp/Continuous_Wavelet_Transform.html">Continuous Wavelet Transform</a> "When the mother wavelet can be interpreted as a windowed sinusoid (such as the Morlet wavelet), the wavelet transform can be interpreted as a constant-Q Fourier transform. Before the theory of wavelets, constant-Q Fourier transforms (such as obtained from a classic third-octave filter bank) were not easy to invert, because the basis signals were not orthogonal."<a href="#fnref2">↩</a></li>
<li id="fn3">Judith C. Brown and Miller S. Puckette, <a href="http://academics.wellesley.edu/Physics/brown/pubs/effalgV92P2698-P2701.pdf">An efficient algorithm for the calculation of a constant Q transform</a>, <em>J. Acoust. Soc. Am.</em>, 92(5):2698–2701, 1992.<a href="#fnref3">↩</a></li>
<li id="fn4"><a class="uri" href="http://newt.phys.unsw.edu.au/jw/graphics/notes.GIF">http://newt.phys.unsw.edu.au/jw/graphics/notes.GIF</a><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

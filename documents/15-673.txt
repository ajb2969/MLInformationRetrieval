   Hybrid difference scheme      Hybrid difference scheme   The hybrid difference scheme 1 2 is a method used in the numerical solution for convectionâ€“diffusion problems. It was first introduces by Spalding (1970). It is a combination of central difference scheme and upwind difference scheme as it exploits the favorable properties of both of these schemes. 3 4  Introduction 5  Hybrid difference scheme is a method used in the numerical solution for convection-diffusion problems. These problems play important roles in computational fluid dynamics. It can be described by the general partial equation as follows: 6         âˆ‚   âˆ‚  t     (   Ï  Ï•   )    +   âˆ‡   (   Ï  ð®  Ï•   )     =    âˆ‡   (   Î“  â‹…   grad  Ï•    )    +   S  Ï•                 t      Ï  Ï•     normal-âˆ‡    Ï  ð®  Ï•        normal-âˆ‡   normal-â‹…  normal-Î“   grad  Ï•      subscript  S  Ï•      \frac{\partial}{\partial t}(\rho\phi)+\nabla(\rho\mathbf{u}\phi)\,=\nabla(%
 \Gamma\cdot\operatorname{grad}\phi)+S_{\phi}        absent   \;   ( 1 )  Where,   Ï   Ï   \rho   is density,   ð®   ð®   \mathbf{u}   is the velocity vector,   Î“   normal-Î“   \Gamma   is the diffusion coefficient and    S  Ï•     subscript  S  Ï•    S_{\phi}   is the source term. In this equation property,   Ï•   Ï•   \phi   can be temperature, internal energy or component of velocity vector   ð®   ð®   \mathbf{u}   in x, y and z directions.  For one-dimensional analysis of convection-diffusion problem in steady state and without the source the equation reduces to,       Ï•   (  0  )    =   Ï•  0         Ï•  0    subscript  Ï•  0     \phi(0)\,=\phi_{0}   ( 2 )  With boundary conditions,     Ï•   (  L  )    =   Ï•  L         Ï•  L    subscript  Ï•  L     \phi(L)\,=\phi_{L}   and    Ï•  0     subscript  Ï•  0    \phi_{0}   , where L is the length,    Ï•  L     subscript  Ï•  L    \phi_{L}   and      âˆ«   C  V      âˆ‡   (   Ï  ð®  Ï•   )     d   V      =    âˆ«  A     ð§  â‹…   (   Ï  ð®  Ï•   )    d  A          subscript     C  V      normal-âˆ‡    Ï  ð®  Ï•      d  V       subscript   A      normal-â‹…  ð§    Ï  ð®  Ï•    d  A      \int_{CV}\nabla(\rho\mathbf{u}\phi)dV\,=\int_{A}\mathbf{n}\cdot(\rho\mathbf{u}%
 \phi)dA   are the given values.  Grid generation  Integrating equation 2 over the control volume containing node N, and using the Gaussâ€™ theorem i.e.,       absent   \;         (   Ï  u  A  Ï•   )   r   -    (   Ï  u  A  Ï•   )   l        subscript    Ï  u  A  Ï•   r    subscript    Ï  u  A  Ï•   l     \left(\rho uA\phi\right)_{r}-\left(\rho uA\phi\right)_{l}   ( 3 )  Yields the following result,        (   Î“  A    âˆ‚  Ï•    âˆ‚  x     )   r   -    (   Î“  A    âˆ‚  Ï•    âˆ‚  x     )   l        subscript    normal-Î“  A      Ï•     x     r    subscript    normal-Î“  A      Ï•     x     l     \left(\Gamma A\frac{\partial\phi}{\partial x}\right)_{r}-\left(\Gamma A\frac{%
 \partial\phi}{\partial x}\right)_{l}   =     absent   \;         (   Ï  u  A   )   r   -    (   Ï  u  A   )   l        subscript    Ï  u  A   r    subscript    Ï  u  A   l     \left(\rho uA\right)_{r}-\left(\rho uA\right)_{l}   ( 4 )  Where, A is the cross-sectional area of the control volume. The equation must also satisfy the continuity equation, i.e.,       absent   \;   = 0     F   =   Ï  u  A       F    Ï  u  A     F\,=\rho uA   ( 5 )  Now let us define variables F and D to represent the convection mass flux and diffusion conductance at cell faces,       absent   \;        absent   \;   and     D   =    Î“  A    Î´  x        D      normal-Î“  A     Î´  x      D\,=\frac{\Gamma A}{\delta x}        absent   \;          F  r    Ï•  r    -    F  l     Ï•  l      =     D  r    (    Ï•  R   -   Ï•  N    )    -    D  l    (    Ï•  N   -   Ï•  L    )              subscript  F  r    subscript  Ï•  r       subscript  F  l    subscript  Ï•  l          subscript  D  r      subscript  Ï•  R    subscript  Ï•  N        subscript  D  l      subscript  Ï•  N    subscript  Ï•  L        F_{r}\phi_{r}-F_{l}\phi_{l}\,=D_{r}(\phi_{R}-\phi_{N})-D_{l}(\phi_{N}-\phi_{L})   ( 6 )  Hence, equations ( 4 ) and ( 5 ) transform into the following equations:       absent   \;         F  r   -    F  l     =  0         subscript  F  r    subscript  F  l    0    F_{r}-F_{l}\,=0   ( 7 )       absent   \;        P   e    =    F  D    =    Ï  u     Î“  /  Î´   x            P  e     F  D            Ï  u       normal-Î“  Î´   x       Pe\,=\frac{F}{D}\,=\frac{\rho u}{\Gamma/\delta x}   ( 8 )  Where, the lower case letters denote the values at the faces and the upper case letters denote that at the nodes. We also define a non-dimensional parameter Peclet number (Pe) as a measure of the relative strengths of convection and diffusion,       absent   \;         Ï•  r    =     Ï•  R   +   Ï•  N    2        subscript  Ï•  r        subscript  Ï•  R    subscript  Ï•  N    2     \phi_{r}\,=\frac{\phi_{R}+\phi_{N}}{2}   ( 9 )  For a low Peclet number (|Pe| 7 ==  In the above equations ( 7 ) and ( 8 ), we observe that the values require are at the faces, instead of the nodes. Hence approximations are required to fulfill this.  In the central difference scheme we replace the value at the face with the average of the values at the adjacent nodes,       absent   \;        absent   \;   and      Ï•  l    =     Ï•  N   +   Ï•  L    2        subscript  Ï•  l        subscript  Ï•  N    subscript  Ï•  L    2     \phi_{l}\,=\frac{\phi_{N}+\phi_{L}}{2}        absent   \;         a  N     Ï•  N     =     a  R    Ï•  R    +    a  L    Ï•  L            subscript  a  N    subscript  Ï•  N         subscript  a  R    subscript  Ï•  R       subscript  a  L    subscript  Ï•  L       a_{N}\phi_{N}\,=a_{R}\phi_{R}+a_{L}\phi_{L}   ( 10 )  [[ File:The grid used for discretisation in Upwind Difference Scheme for negative Peclet number (Pe 0)..png|thumb|300 px|Fig 3: The grid used for discretisation in Upwind Difference Scheme for negative Peclet number (Pe 7 ) and rearranging we get the following result,       absent   \;       a  L     subscript  a  L    a_{L}   ( 11 )  where,            a  R     subscript  a  R    a_{R}          a  N     subscript  a  N    a_{N}           D  l   +    F  l   2        subscript  D  l      subscript  F  l   2     D_{l}+\frac{F_{l}}{2}               D  r   +    F  r   2        subscript  D  r      subscript  F  r   2     D_{r}+\frac{F_{r}}{2}           a  r   +   a  l   +   (    F  r   -   F  l    )        subscript  a  r    subscript  a  l      subscript  F  r    subscript  F  l      a_{r}+a_{l}+(F_{r}-F_{l})            Ï•  l    =   Ï•  L        subscript  Ï•  l    subscript  Ï•  L     \phi_{l}\,=\phi_{L}          In the Upwind scheme we replace the value at the face with the value at the adjacent upstream node. For example for the flow to the right (Pe>0)as shown in the diagram, we replace the values as follows;       absent   \;        absent   \;   and      Ï•  r    =   Ï•  N        subscript  Ï•  r    subscript  Ï•  N     \phi_{r}\,=\phi_{N}        absent   \;        absent   \;   ( 12 )  And for PeÂ  \phi_{r}\,= \phi_{R}     absent   \;   and      Ï•  l    =   Ï•  N        subscript  Ï•  l    subscript  Ï•  N     \phi_{l}\,=\phi_{N}        absent   \;       a  L     subscript  a  L    a_{L}   ( 13 )  By putting these values in equation ( 7 ) and rearranging we get the same equation as equation ( 11 ), with the following values of the coefficients:            a  R     subscript  a  R    a_{R}          a  N     subscript  a  N    a_{N}           D  l   +   max   (   F  l   ,  0  )         subscript  D  l      subscript  F  l   0     D_{l}+\max(F_{l},0)               D  r   +   max   (   F  r   ,  0  )         subscript  D  r      subscript  F  r   0     D_{r}+\max(F_{r},0)           a  r   +   a  l   +   (    F  r   -   F  l    )        subscript  a  r    subscript  a  l      subscript  F  r    subscript  F  l      a_{r}+a_{l}+(F_{r}-F_{l})            Ï•  l    =   [     (   1  +   2   P   e  l      )     Ï•  L   2    +    (   1  -   2   P   e  l      )     Ï•  R   2     ]        subscript  Ï•  l    delimited-[]        1    2    P   subscript  e  l         subscript  Ï•  L   2        1    2    P   subscript  e  l         subscript  Ï•  R   2        \phi_{l}\,=\left[\left(1+\frac{2}{Pe_{l}}\right)\frac{\phi_{L}}{2}+\left(1-%
 \frac{2}{Pe_{l}}\right)\frac{\phi_{R}}{2}\right]\,          Hybrid difference scheme 8 9  The hybrid difference scheme of Spalding (1970) is a combination of the central difference scheme and upwind difference scheme. It makes use of the central difference scheme, which is second order accurate, for small Peclet numbers (|Pe|Â Â 2) it uses the Upwind difference scheme, which first order accurate but takes into account the convection of the fluid.  As it can be seen in figure 4 that for PeÂ =Â 0, it is a linear distribution and for high Pe it takes the upstream value depending on the flow direction. For example the value at the left face, in different circumstances is,       absent   \;        absent   \;   for     -  2   <   P   e  l    <  2          2     P   subscript  e  l         2     -2        absent   \;         Ï•  l    =   Ï•  L        subscript  Ï•  l    subscript  Ï•  L     \phi_{l}\,=\phi_{L}   ( 14 )       absent   \;        absent   \;   for    P   e  l   â‰¥  2      P   subscript  e  l   â‰¥  2    Pe_{l}\text{â‰¥}2        absent   \;         Ï•  l    =   Ï•  N        subscript  Ï•  l    subscript  Ï•  N     \phi_{l}\,=\phi_{N}   ( 15 )       absent   \;        absent   \;   for     P   e  l   â‰¤   -  2        P   subscript  e  l   â‰¤   2    Pe_{l}\text{â‰¤}-2        absent   \;       a  L     subscript  a  L    a_{L}   ( 16 )  Substituting these values in equation ( 7 ) we get the same equation ( 11 ) with the values of the coefficients as follows,            a  R     subscript  a  R    a_{R}          a  N     subscript  a  N    a_{N}          max   [   F  l   ,   (    D  l   +    F  l   2    )   ,  0  ]        subscript  F  l      subscript  D  l      subscript  F  l   2    0    \max\left[F_{l},\left(D_{l}+\frac{F_{l}}{2}\right),0\right]              max   [   F  r   ,   (    D  r   +    F  r   2    )   ,  0  ]        subscript  F  r      subscript  D  r      subscript  F  r   2    0    \max\left[F_{r},\left(D_{r}+\frac{F_{r}}{2}\right),0\right]           a  r   +   a  l   +   (    F  r   -   F  l    )        subscript  a  r    subscript  a  l      subscript  F  r    subscript  F  l      a_{r}+a_{l}+(F_{r}-F_{l})      $$a_{r} + a_{l} + (F_{r} - F_{l})$$       Advantages and disadvantages of the hybrid difference scheme  It exploits the favourable properties of the central difference and upwind scheme. It switches to upwind difference scheme when central difference scheme produces inaccurate results for high Peclet numbers. It produces physically realistic solution and has proved to be helpful in the prediction of practical flows.  The only disadvantage associated with hybrid difference scheme is that the accuracy in terms of Taylor series truncation error is only first order.  References  External links   http://proceedings.fyper.com/eccomascfd2006/documents/595.pdf  http://www.internonlinearscience.org/upload/papers/20110228093510102.pdf  http://www.internonlinearscience.org/upload/papers/20110227034844410.pdf   See also   Upwind differencing scheme for convection   "  Category:Transport phenomena  Category:Diffusion     â†©  â†©  Scarborough, J.B.(1958) Numerical Mathematical Analysis, 4th edn, Johns Hopkins University Press, Baltimore, MD. â†©  Spalding, D.B. (1972). A Novel Finite-difference Formulation for Differential Expression Involving Both First and Second Derivatives, Int. J. Numer. Methods Eng., Vol. 4. â†©  Pollard, A. and Siu, A. L. W. (1982). The Calculation of Some Laminar Flows Using Various Discretization Schemes, Comput. Methods Appl. Mech. Eng., Vol. 35. â†©  Borris, J.P. and Brook, D.L. (1976). Solution of the Continuity Equation by the Method of Flux Corrected Transport, J. Comput. Phys., Vol. 16. â†©  Roache, P.J.(1976) Computational Fluid Dynamics, Hermosa, Albuquerque, NM. â†©       
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="390">Line–sphere intersection</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Line–sphere intersection</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>The three possible line-sphere intersections:<br/>
1. No intersection.<br/>
2. Point intersection.<br/>
3. Two point intersection.</figcaption>
</figure>

<p>In <a href="analytic_geometry" title="wikilink">analytic geometry</a>, a <a href="line_(mathematics)" title="wikilink">line</a> and a <a class="uri" href="sphere" title="wikilink">sphere</a> can <a href="intersection_(set_theory)" title="wikilink">intersect</a> in three ways: no intersection at all, at exactly one point, or in two points. Methods for distinguishing these cases, and determining equations for the points in the latter cases, are useful in a number of circumstances. For example, this is a common calculation to perform during <a href="ray_tracing_(graphics)" title="wikilink">ray tracing</a> (Eberly 2006:698).</p>
<h2 id="calculation-using-vectors-in-3d">Calculation using vectors in 3D</h2>

<p>In <a href="vector_notation" title="wikilink">vector notation</a>, the equations are as follows:</p>

<p>Equation for a <a class="uri" href="sphere" title="wikilink">sphere</a></p>

<p>
<math display="block" id="Line–sphere_intersection:0">
<semantics>
<mrow>
<msup>
<mrow>
<mo>∥</mo>
<mrow>
<mi>𝐱</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>=</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<apply>
<minus></minus>
<ci>𝐱</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \left\|\mathbf{x}-\mathbf{c}\right\|^{2}=r^{2}
  </annotation>
</semantics>
</math>
</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:1">
<semantics>
<mi>𝐜</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐜</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{c}
  </annotation>
</semantics>
</math>

 - center point</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:2">
<semantics>
<mi>r</mi>
<annotation-xml encoding="MathML-Content">
<ci>r</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   r
  </annotation>
</semantics>
</math>

 - radius</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:3">
<semantics>
<mi>𝐱</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐱</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
</semantics>
</math>

 - points on the sphere</p>

<p>Equation for a line starting at 

<math display="inline" id="Line–sphere_intersection:4">
<semantics>
<mi>𝐨</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐨</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{o}
  </annotation>
</semantics>
</math>
</p>

<p>
<math display="block" id="Line–sphere_intersection:5">
<semantics>
<mrow>
<mi>𝐱</mi>
<mo>=</mo>
<mrow>
<mi>𝐨</mi>
<mo>+</mo>
<mrow>
<mi>d</mi>
<mi>𝐥</mi>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>𝐱</ci>
<apply>
<plus></plus>
<ci>𝐨</ci>
<apply>
<times></times>
<ci>d</ci>
<ci>𝐥</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{x}=\mathbf{o}+d\mathbf{l}
  </annotation>
</semantics>
</math>
</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:6">
<semantics>
<mi>d</mi>
<annotation-xml encoding="MathML-Content">
<ci>d</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   d
  </annotation>
</semantics>
</math>

 - distance along line from starting point</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:7">
<semantics>
<mi>𝐥</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐥</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{l}
  </annotation>
</semantics>
</math>

 - direction of line (a <a href="unit_vector" title="wikilink">unit vector</a>)</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:8">
<semantics>
<mi>𝐨</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐨</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{o}
  </annotation>
</semantics>
</math>

 - origin of the line</p>

<p>:*

<math display="inline" id="Line–sphere_intersection:9">
<semantics>
<mi>𝐱</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐱</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
</semantics>
</math>

 - points on the line</p>

<p>Searching for points that are on the line and on the sphere means combining the equations and solving for 

<math display="inline" id="Line–sphere_intersection:10">
<semantics>
<mi>d</mi>
<annotation-xml encoding="MathML-Content">
<ci>d</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   d
  </annotation>
</semantics>
</math>

:</p>
<dl>
<dd>Equations combined


<p>
<math display="block" id="Line–sphere_intersection:11">
<semantics>
<mrow>
<mrow>
<msup>
<mrow>
<mo>∥</mo>
<mrow>
<mrow>
<mi>𝐨</mi>
<mo>+</mo>
<mrow>
<mi>d</mi>
<mi>𝐥</mi>
</mrow>
</mrow>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>=</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<mo>⇔</mo>
<mrow>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>𝐨</mi>
<mo>+</mo>
<mrow>
<mi>d</mi>
<mi>𝐥</mi>
</mrow>
</mrow>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>𝐨</mi>
<mo>+</mo>
<mrow>
<mi>d</mi>
<mi>𝐥</mi>
</mrow>
</mrow>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<ci>normal-⇔</ci>
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<apply>
<minus></minus>
<apply>
<plus></plus>
<ci>𝐨</ci>
<apply>
<times></times>
<ci>d</ci>
<ci>𝐥</ci>
</apply>
</apply>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<eq></eq>
<apply>
<ci>normal-⋅</ci>
<apply>
<minus></minus>
<apply>
<plus></plus>
<ci>𝐨</ci>
<apply>
<times></times>
<ci>d</ci>
<ci>𝐥</ci>
</apply>
</apply>
<ci>𝐜</ci>
</apply>
<apply>
<minus></minus>
<apply>
<plus></plus>
<ci>𝐨</ci>
<apply>
<times></times>
<ci>d</ci>
<ci>𝐥</ci>
</apply>
</apply>
<ci>𝐜</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \left\|\mathbf{o}+d\mathbf{l}-\mathbf{c}\right\|^{2}=r^{2}\Leftrightarrow(%
\mathbf{o}+d\mathbf{l}-\mathbf{c})\cdot(\mathbf{o}+d\mathbf{l}-\mathbf{c})=r^{2}
  </annotation>
</semantics>
</math>
</p>
</dd>
<dd>Expanded


<p>
<math display="block" id="Line–sphere_intersection:12">
<semantics>
<mrow>
<mrow>
<mrow>
<msup>
<mi>d</mi>
<mn>2</mn>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mi>𝐥</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mn>2</mn>
<mi>d</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo>=</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>d</ci>
<cn type="integer">2</cn>
</apply>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<ci>𝐥</ci>
</apply>
</apply>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>d</ci>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
<apply>
<ci>normal-⋅</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   d^{2}(\mathbf{l}\cdot\mathbf{l})+2d(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))+(%
\mathbf{o}-\mathbf{c})\cdot(\mathbf{o}-\mathbf{c})=r^{2}
  </annotation>
</semantics>
</math>
</p>
</dd>
<dd>Rearranged


<p>
<math display="block" id="Line–sphere_intersection:13">
<semantics>
<mrow>
<mrow>
<mrow>
<mrow>
<msup>
<mi>d</mi>
<mn>2</mn>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mi>𝐥</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mn>2</mn>
<mi>d</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<mo>-</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<minus></minus>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>d</ci>
<cn type="integer">2</cn>
</apply>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<ci>𝐥</ci>
</apply>
</apply>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>d</ci>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
<apply>
<ci>normal-⋅</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<cn type="integer">0</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   d^{2}(\mathbf{l}\cdot\mathbf{l})+2d(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))+(%
\mathbf{o}-\mathbf{c})\cdot(\mathbf{o}-\mathbf{c})-r^{2}=0
  </annotation>
</semantics>
</math>
</p>
</dd>
<dd>The form of a <a href="quadratic_formula" title="wikilink">quadratic formula</a> is now observable. (This quadratic equation is an example of Joachimsthal's Equation <a href="http://mathworld.wolfram.com/JoachimsthalsEquation.html">1</a>.)


<p>
<math display="block" id="Line–sphere_intersection:14">
<semantics>
<mrow>
<mrow>
<mrow>
<mi>a</mi>
<msup>
<mi>d</mi>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>b</mi>
<mi>d</mi>
</mrow>
<mo>+</mo>
<mi>c</mi>
</mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>a</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>d</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<ci>b</ci>
<ci>d</ci>
</apply>
<ci>c</ci>
</apply>
<cn type="integer">0</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   ad^{2}+bd+c=0
  </annotation>
</semantics>
</math>
</p>
</dd>
<dd>where
<ul>
<li>
<math display="inline" id="Line–sphere_intersection:15">
<semantics>
<mrow>
<mi>a</mi>
<mo>=</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mi>𝐥</mi>
</mrow>
<mo>=</mo>
<msup>
<mrow>
<mo>∥</mo>
<mi>𝐥</mi>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<and></and>
<apply>
<eq></eq>
<ci>a</ci>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<ci>𝐥</ci>
</apply>
</apply>
<apply>
<eq></eq>
<share href="#.cmml">
</share>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<ci>𝐥</ci>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   a=\mathbf{l}\cdot\mathbf{l}=\left\|\mathbf{l}\right\|^{2}
  </annotation>
</semantics>
</math>
</li>
<li>
<math display="inline" id="Line–sphere_intersection:16">
<semantics>
<mrow>
<mi>b</mi>
<mo>=</mo>
<mrow>
<mn>2</mn>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>b</ci>
<apply>
<times></times>
<cn type="integer">2</cn>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   b=2(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))
  </annotation>
</semantics>
</math>
</li>
<li>
<math display="inline" id="Line–sphere_intersection:17">
<semantics>
<mrow>
<mi>c</mi>
<mo>=</mo>
<mrow>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>-</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<mo>=</mo>
<mrow>
<msup>
<mrow>
<mo>∥</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>-</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<and></and>
<apply>
<eq></eq>
<ci>c</ci>
<apply>
<minus></minus>
<apply>
<ci>normal-⋅</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
<apply>
<eq></eq>
<share href="#.cmml">
</share>
<apply>
<minus></minus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   c=(\mathbf{o}-\mathbf{c})\cdot(\mathbf{o}-\mathbf{c})-r^{2}=\left\|\mathbf{o}-%
\mathbf{c}\right\|^{2}-r^{2}
  </annotation>
</semantics>
</math>
</li>
</ul>
</dd>
<dd>Simplified


<p>
<math display="block" id="Line–sphere_intersection:18">
<semantics>
<mrow>
<mi>d</mi>
<mo>=</mo>
<mfrac>
<mrow>
<mrow>
<mo>-</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>±</mo>
<msqrt>
<mrow>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>-</mo>
<mrow>
<msup>
<mrow>
<mo>∥</mo>
<mi>𝐥</mi>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mrow>
<mo>∥</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>-</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</msqrt>
</mrow>
<msup>
<mrow>
<mo>∥</mo>
<mi>𝐥</mi>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
</mfrac>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>d</ci>
<apply>
<divide></divide>
<apply>
<csymbol cd="latexml">plus-or-minus</csymbol>
<apply>
<minus></minus>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
<apply>
<root></root>
<apply>
<minus></minus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<ci>𝐥</ci>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<minus></minus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<ci>𝐥</ci>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   d=\frac{-(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))\pm\sqrt{(\mathbf{l}\cdot(%
\mathbf{o}-\mathbf{c}))^{2}-\left\|\mathbf{l}\right\|^{2}(\left\|\mathbf{o}-%
\mathbf{c}\right\|^{2}-r^{2})}}{\left\|\mathbf{l}\right\|^{2}}
  </annotation>
</semantics>
</math>
</p>
</dd>
<dd>Note that 

<math display="inline" id="Line–sphere_intersection:19">
<semantics>
<mi>𝐥</mi>
<annotation-xml encoding="MathML-Content">
<ci>𝐥</ci>
</annotation-xml>
<annotation encoding="application/x-tex">
   \mathbf{l}
  </annotation>
</semantics>
</math>

 is a unit vector, and thus 

<math display="inline" id="Line–sphere_intersection:20">
<semantics>
<mrow>
<msup>
<mrow>
<mo>∥</mo>
<mi>𝐥</mi>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>=</mo>
<mn>1</mn>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<ci>𝐥</ci>
</apply>
<cn type="integer">2</cn>
</apply>
<cn type="integer">1</cn>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \left\|\mathbf{l}\right\|^{2}=1
  </annotation>
</semantics>
</math>

. Thus, we can simplify this further to


<p>
<math display="block" id="Line–sphere_intersection:21">
<semantics>
<mrow>
<mi>d</mi>
<mo>=</mo>
<mrow>
<mrow>
<mo>-</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>±</mo>
<msqrt>
<mrow>
<mrow>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>-</mo>
<msup>
<mrow>
<mo>∥</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
</msqrt>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>d</ci>
<apply>
<csymbol cd="latexml">plus-or-minus</csymbol>
<apply>
<minus></minus>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
</apply>
<apply>
<root></root>
<apply>
<plus></plus>
<apply>
<minus></minus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   d=-(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))\pm\sqrt{(\mathbf{l}\cdot(\mathbf{o%
}-\mathbf{c}))^{2}-\left\|\mathbf{o}-\mathbf{c}\right\|^{2}+r^{2}}
  </annotation>
</semantics>
</math>
</p>
</dd>
</dl>
<ul>
<li>If the value under the square-root (

<math display="inline" id="Line–sphere_intersection:22">
<semantics>
<mrow>
<mrow>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐥</mi>
<mo>⋅</mo>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mn>2</mn>
</msup>
<mo>-</mo>
<msup>
<mrow>
<mo>∥</mo>
<mrow>
<mi>𝐨</mi>
<mo>-</mo>
<mi>𝐜</mi>
</mrow>
<mo>∥</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<msup>
<mi>r</mi>
<mn>2</mn>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<plus></plus>
<apply>
<minus></minus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<ci>normal-⋅</ci>
<ci>𝐥</ci>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="latexml">norm</csymbol>
<apply>
<minus></minus>
<ci>𝐨</ci>
<ci>𝐜</ci>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>r</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   (\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))^{2}-\left\|\mathbf{o}-\mathbf{c}%
\right\|^{2}+r^{2}
  </annotation>
</semantics>
</math>

) is less than zero, then it is clear that no solutions exist, i.e. the line does not intersect the sphere (case 1).</li>
<li>If it is zero, then exactly one solution exists, i.e. the line just touches the sphere in one point (case 2).</li>
<li>If it is greater than zero, two solutions exist, and thus the line touches the sphere in two points (case 3).</li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Analytic_geometry" title="wikilink">Analytic geometry</a></li>
<li><a href="Line-plane_intersection" title="wikilink">Line-plane intersection</a></li>
<li><a href="Plane_(mathematics)" title="wikilink">Line of intersection between two planes</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>David H. Eberly (2006), <em>3D game engine design: a practical approach to real-time computer graphics</em>, 2nd edition, Morgan Kaufmann. ISBN 0-12-229063-1</li>
</ul>

<p>"</p>

<p><a href="Category:Analytic_geometry" title="wikilink">Category:Analytic geometry</a></p>
</body>
</html>

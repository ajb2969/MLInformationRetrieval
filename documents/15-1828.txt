   Variable elimination      Variable elimination   Variable elimination (VE) is a simple and general exact inference algorithm in probabilistic graphical models , such as Bayesian networks and Markov random fields . 1 2 It can be used for inference of maximum a posteriori (MAP) state or estimation of marginal distribution over a subset of variables. The algorithm has exponential time complexity, but could be efficient in practice for the low- treewidth graphs, if the proper elimination order is used.  Inference  The most common query type is in the form    p   (  X  |  E  =  e  )      fragments  p   fragments  normal-(  X  normal-|  E   e  normal-)     p(X|E=e)   where   X   X   X   and   E   E   E   are disjoint subsets of   U   U   U   , and   E   E   E   is observed taking value   e   e   e   . A basic algorithm to computing p(X|E = e) is called variable elimination (VE), first put forth in. 3 Algorithm 1, called sum-out (SO), eliminates a single variable   v   v   v   from a set   ϕ   ϕ   \phi   of potentials, 4 and returns the resulting set of potentials. The algorithm collect-relevant simply returns those potentials in   ϕ   ϕ   \phi   involving variable   v   v   v   .  Algorithm 1 sum-out(   v   v   v   ,   ϕ   ϕ   \phi   )     Φ   normal-Φ   \Phi   = collect-relevant(   v   v   v   ,   ϕ   ϕ   \phi   )     Ψ   normal-Ψ   \Psi   = the product of all potentials in   Φ   normal-Φ   \Phi         τ  =    ∑  v   Ψ       τ    subscript   v   normal-Ψ     \tau=\sum_{v}\Psi     return      (   ϕ  -  Ψ   )   ∪   {  τ  }         ϕ  normal-Ψ    τ     (\phi-\Psi)\cup\{\tau\}     Algorithm 2, taken from, 5 computes    p   (  X  |  E  =  e  )      fragments  p   fragments  normal-(  X  normal-|  E   e  normal-)     p(X|E=e)   from a discrete Bayesian network B. VE calls SO to eliminate variables one by one. More specifically, in Algorithm 2,   ϕ   ϕ   \phi   is the set C of CPTs for B,   X   X   X   is a list of query variables,   E   E   E   is a list of observed variables,   e   e   e   is the corresponding list of observed values, and   σ   σ   \sigma   is an elimination ordering for variables    U  -   X  E       U    X  E     U-XE   , where    X  E      X  E    XE   denotes    X  ∪  E      X  E    X\cup E   .  Algorithm 2 VE(    ϕ  ,  X  ,  E  ,  e  ,  σ     ϕ  X  E  e  σ    \phi,X,E,e,\sigma   )   Multiply evidence potentials with appropriate CPTs While σ is not empty  Remove the first variable   v   v   v   from   σ   σ   \sigma        ϕ   ϕ   \phi   = sum-out    (  v  ,  ϕ  )     v  ϕ    (v,\phi)         p   (  X  ,  E  =  e  )      fragments  p   fragments  normal-(  X  normal-,  E   e  normal-)     p(X,E=e)   = the product of all potentials    Ψ  ∈  ϕ      normal-Ψ  ϕ    \Psi\in\phi      return     p   (  X  ,  E  =  e  )   /   ∑  X   p   (  X  ,  E  =  e  )      fragments  p   fragments  normal-(  X  normal-,  E   e  normal-)     subscript   X   p   fragments  normal-(  X  normal-,  E   e  normal-)     p(X,E=e)/\sum_{X}p(X,E=e)     References  "  Category:Graphical models     Zhang, N.L., Poole, D.: A Simple Approach to Bayesian Network Computations. In:7th Canadian Conference on Artificial Intelligence, pp. 171–178. Springer, New York(1994) ↩  Zhang, N.L., Poole, D.:A Simple Approach to Bayesian Network Computations.In: 7th Canadian Conference on Artificial Intelligence,pp. 171--178. Springer, New York (1994) ↩   Koller, D., Friedman, N.: Probabilistic Graphical Models: Principles and Techniques. MIT Press, Cambridge, MA (2009) ↩      
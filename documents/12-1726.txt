   Geographical distance      Geographical distance   Geographical distance is the distance measured along the surface of the earth . The formulae in this article calculate distances between points which are defined by geographical coordinates in terms of latitude and longitude . This distance is an element in solving the second (inverse) geodetic problem .  Introduction  Calculating the distance between geographical coordinates is based on some level of abstraction; it does not provide an exact distance, which is unattainable if one attempted to account for every irregularity in the surface of the earth. 1 Common abstractions for the surface between two geographic points are:   Flat surface;  Spherical surface;  Ellipsoidal surface.   All abstractions above ignore changes in elevation. Calculation of distances which account for changes in elevation relative to the idealized surface are not discussed in this article.  Nomenclature  Distance,    D  ,    D   D,\,\!   is calculated between two points,    P  1     subscript  P  1    P_{1}\,\!   and    P  2     subscript  P  2    P_{2}\,\!   . The geographical coordinates of the two points, as (latitude, longitude) pairs, are    (   ϕ  1   ,   λ  1   )      subscript  ϕ  1    subscript  λ  1     (\phi_{1},\lambda_{1})\,\!   and     (   ϕ  2   ,   λ  2   )   ,      subscript  ϕ  2    subscript  λ  2     (\phi_{2},\lambda_{2}),\,\!   respectively. Which of the two points is designated as    P  1     subscript  P  1    P_{1}\,\!   is not important for the calculation of distance.  Latitude and longitude coordinates on maps are usually expressed in degrees . In the given forms of the formulae below, one or more values must be expressed in the specified units to obtain the correct result. Where geographic coordinates are used as the argument of a trigonometric function, the values may be expressed in any angular units compatible with the method used to determine the value of the trigonometric function. Many electronic calculators allow calculations of trigonometric functions in either degrees or radians . The calculator mode must be compatible with the units used for geometric coordinates.  Differences in latitude and longitude are labeled and calculated as follows:         Δ  ϕ        =    ϕ  2   -   ϕ  1     ;        Δ  λ        =    λ  2   -   λ  1     .           normal-Δ  ϕ     absent     subscript  ϕ  2    subscript  ϕ  1         normal-Δ  λ     absent     subscript  λ  2    subscript  λ  1        \begin{aligned}\displaystyle\Delta\phi&\displaystyle=\phi_{2}-\phi_{1};\\
 \displaystyle\Delta\lambda&\displaystyle=\lambda_{2}-\lambda_{1}.\end{aligned}\,\!     It is not important whether the result is positive or negative when used in the formulae below.  "Mean latitude" is labeled and calculated as follows:        ϕ  m   =     ϕ  1   +   ϕ  2    2    .       subscript  ϕ  m        subscript  ϕ  1    subscript  ϕ  2    2     \phi_{m}=\frac{\phi_{1}+\phi_{2}}{2}.\,\!     Colatitude is labeled and calculated as follows:   For latitudes expressed in radians:      θ  =    π  2   -  ϕ    ;      θ      π  2   ϕ     \theta=\frac{\pi}{2}-\phi;\,\!      For latitudes expressed in degrees:      θ  =    90  ∘   -  ϕ    .      θ     superscript  90    ϕ     \theta=90^{\circ}-\phi.\,\!       Unless specified otherwise, the radius of the earth for the calculations below is:     R   R   R\,\!   = 6,371.009 kilometers = 3,958.761 statute miles = 3,440.069 nautical miles .      D    D   D\!   = Distance between the two points, as measured along the surface of the earth and in the same units as the value used for radius unless specified otherwise.  Singularities and discontinuity of latitude/longitude  Longitude has singularities at the Poles (longitude is undefined) and a discontinuity at the ± 180° meridian . Also, planar projections of the circles of constant latitude are highly curved near the Poles. Hence, the above equations for delta latitude/longitude (    Δ   ϕ       normal-Δ  ϕ    \Delta\phi\!   ,    Δ   λ       normal-Δ  λ    \Delta\lambda\!   ) and mean latitude (     ϕ  m      subscript  ϕ  m    \phi_{m}\!   ) may not give the expected answer for positions near the Poles or the ±180° meridian. Consider e.g. the value of    Δ   λ       normal-Δ  λ    \Delta\lambda\!   (“east displacement”) when     λ  1      subscript  λ  1    \lambda_{1}\!   and     λ  2      subscript  λ  2    \lambda_{2}\!   are on either side of the ±180° meridian, or the value of     ϕ  m      subscript  ϕ  m    \phi_{m}\!   (“mean latitude”) for the two positions (     ϕ  1      subscript  ϕ  1    \phi_{1}\!   =89°,     λ  1      subscript  λ  1    \lambda_{1}\!   =45°) and (     ϕ  2      subscript  ϕ  2    \phi_{2}\!   =89°,     λ  2      subscript  λ  2    \lambda_{2}\!   =−135°).  If a calculation based on latitude/longitude should be valid for all Earth positions, it should be verified that the discontinuity and the Poles are handled correctly. Another solution is to use n -vector instead of latitude/longitude, since this representation does not have discontinuities or singularities.  Flat-surface formulae  A planar approximation for the surface of the earth may be useful over small distances. The accuracy of distance calculations using this approximation become increasingly inaccurate as:   The separation between the points becomes greater;  A point becomes closer to a geographic pole.   The shortest distance between two points in plane is a straight line. The Pythagorean theorem is used to calculate the distance between points in a plane.  Even over short distances, the accuracy of geographic distance calculations which assume a flat Earth depend on the method by which the latitude and longitude coordinates have been projected onto the plane. The projection of global latitude and longitude coordinates onto a plane is the realm of cartography .  The formulae presented in this section provide varying degrees of accuracy.  Spherical Earth projected to a plane  This formula takes into account the variation in distance between meridians with latitude:       D  =   R      (   Δ  ϕ   )   2   +    (    cos   (   ϕ  m   )    Δ  λ   )   2       ,      D    R       superscript    normal-Δ  ϕ   2    superscript       subscript  ϕ  m    normal-Δ  λ   2        D=R\sqrt{(\Delta\phi)^{2}+(\cos(\phi_{m})\Delta\lambda)^{2}},      where:     Δ  ϕ      normal-Δ  ϕ    \Delta\phi\,\!   and    Δ  λ      normal-Δ  λ    \Delta\lambda\,\!   are in radians;      ϕ  m     subscript  ϕ  m    \phi_{m}\,\!   must be in units compatible with the method used for determining     cos   (   ϕ  m   )    .       subscript  ϕ  m     \cos(\phi_{m}).\,\!        To convert latitude or longitude to radians use       1  ∘   =    (   π  /  180   )   radians    .       superscript  1        π  180   radians     1^{\circ}=(\pi/180)\,\mathrm{radians}.        Note: This approximation is very fast and produces fairly accurate result for small distances . Also, when ordering locations by distance, such as in a database query, it is much faster to order by squared distance, eliminating the need for computing the square root.   Ellipsoidal Earth projected to a plane  The FCC prescribes essentially the following formulae in 47 CFR 73.208 for distances not exceeding 475 km /295 miles: 2       D  =      (    K  1   Δ  ϕ   )   2   +    (    K  2   Δ  λ   )   2      ,      D       superscript     subscript  K  1   normal-Δ  ϕ   2    superscript     subscript  K  2   normal-Δ  λ   2       D=\sqrt{(K_{1}\Delta\phi)^{2}+(K_{2}\Delta\lambda)^{2}},      where    D   D   D\,\!   = Distance in kilometers;      Δ  ϕ      normal-Δ  ϕ    \Delta\phi\,\!   and    Δ  λ      normal-Δ  λ    \Delta\lambda\,\!   are in degrees;      ϕ  m     subscript  ϕ  m    \phi_{m}\,\!   must be in units compatible with the method used for determining     cos   (   ϕ  m   )    ;       subscript  ϕ  m     \cos(\phi_{m});\,\!     : \begin{align}    K_1&=111.13209-0.56605\cos(2\phi_m)+0.00120\cos(4\phi_m);\\ K_2&=111.41513\cos(\phi_m)-0.09455\cos(3\phi_m)+0.00012\cos(5\phi_m).\end{align}\,\!   It may be interesting to note that:      K  1   =   M   π  180         subscript  K  1     M    π  180      K_{1}=M\frac{\pi}{180}\,\!   = kilometers per degree of latitude difference;       K  2   =    cos   (   ϕ  m   )    N   π  180         subscript  K  2        subscript  ϕ  m    N    π  180      K_{2}=\cos(\phi_{m})N\frac{\pi}{180}\,\!   = kilometers per degree of longitude difference;   where   M   M   M\,\!   and   N   N   N\,\!   are the m eridional'' and its perpendicular, or " n ormal''", radii of curvature (the expressions in the FCC formula are derived from the binomial series expansion form of   M   M   M\,\!   and   N   N   N\,\!   , set to the Clarke 1866  reference ellipsoid ).     Polar coordinate flat-Earth formula       D  =   R       θ  1  2    +    θ  2  2     -   2   θ  1    θ  2    cos   (   Δ  λ   )         ,      D    R         subscript   superscript  θ  2   1    subscript   superscript  θ  2   2      2   subscript  θ  1    subscript  θ  2       normal-Δ  λ          D=R\sqrt{\theta^{2}_{1}\;\boldsymbol{+}\;\theta^{2}_{2}\;\mathbf{-}\;2\theta_{%
 1}\theta_{2}\cos(\Delta\lambda)},      where the colatitude values are in radians. For a latitude measured in degrees, the colatitude in radians may be calculated as follows     θ  =    π  180    (    90  ∘   -  ϕ   )     .      θ      π  180      superscript  90    ϕ      \theta=\frac{\pi}{180}(90^{\circ}-\phi).\,\!      Spherical-surface formulae  If we are willing to accept a possible error of 0.5%, we can use formulas of spherical trigonometry on the sphere that best approximates the surface of the earth.  The shortest distance along the surface of a sphere between two points on the surface is along the great-circle which contains the two points.  The great-circle distance article gives the formula for calculating the distance along a great-circle on a sphere about the size of the Earth. That article includes an example of the calculation.  Tunnel distance  A tunnel between points on Earth is defined by a line through three-dimensional space between the points of interest. The great circle chord length may be calculated as follows for the corresponding unit sphere:        Δ  X   =     cos   (   ϕ  2   )     cos   (   λ  2   )     -    cos   (   ϕ  1   )     cos   (   λ  1   )       ;        normal-Δ  X          subscript  ϕ  2       subscript  λ  2          subscript  ϕ  1       subscript  λ  1        \displaystyle\Delta{X}=\cos(\phi_{2})\cos(\lambda_{2})-\cos(\phi_{1})\cos(%
 \lambda_{1});     The tunnel distance between points on the surface of a spherical Earth is    D  =   R   C  h        D    R   subscript  C  h      D=RC_{h}   . For short distances (    D  ≪  R     much-less-than  D  R    D\ll R   ), this underestimates the great circle distance by     D    (   D  /  R   )   2    /  24        D   superscript    D  R   2    24    D(D/R)^{2}/24   .  Ellipsoidal-surface formulae  An ellipsoid approximates the surface of the earth much better than a sphere or a flat surface does. The shortest distance along the surface of an ellipsoid between two points on the surface is along the geodesic . Geodesics follow more complicated paths than great circles and in particular, they usually don't return to their starting positions after one circuit of the earth. This is illustrated in the figure on the right where f is taken to be 1/50 to accentuate the effect. Finding the geodesic between two points on the earth, the so-called inverse geodetic problem , was the focus of many mathematicians and geodesists over the course of the 18th and 19th centuries with major contributions by Clairaut, 3 Legendre, 4 Bessel, 5 and Helmert. 6 Rapp 7 provides a good summary of this work.  Methods for computing the geodesic distance are widely available in geographical information systems , software libraries, standalone utilities, and online tools. The most widely used algorithm is by Vincenty, 8 who uses a series which is accurate to third order in the flattening of the ellipsoid, i.e., about 0.5 mm; however, the algorithm fails to converge for points that are nearly anti-podal . (For details, see Vincenty's formulae .) This defect is cured in the algorithm given by Karney, 9 who employs series which are accurate to sixth order in the flattening. This results in an algorithm which is accurate to full double precision and which converges for arbitrary pairs of points on the earth. This algorithm is implemented in GeographicLib. 10  The exact methods above are feasible when carrying out calculations on a computer. They are intended to give millimeter accuracy on lines of any length; we can use simpler formulas if we don't need millimeter accuracy, or if we do need millimeter accuracy but the line is short. Rapp, 11 Chap. 6, describes the Puissant method, the Gauss mid-latitude method, and the Bowring method. 12  Lambert's formula for long lines  Lambert's formulae 13 give accuracy on the order of 10 meters over thousands of kilometers. First convert the latitudes    ϕ  1     subscript  ϕ  1    \scriptstyle\phi_{1}   ,    ϕ  2     subscript  ϕ  2    \scriptstyle\phi_{2}   of the two points to reduced latitudes     β  1     subscript  β  1    \scriptstyle\beta_{1}   ,    β  2     subscript  β  2    \scriptstyle\beta_{2}         tan  β   =    (   1  -  f   )    tan  ϕ     ,        β       1  f     ϕ      \tan\beta=(1-f)\tan\phi,     where   f   f   f   is the flattening. Then calculate the central angle    σ   σ   \sigma   in radians between two points    (   β  1   ,   λ  1   )      subscript  β  1    subscript  λ  1     (\beta_{1},\;\lambda_{1})   and    (   β  2   ,   λ  2   )      subscript  β  2    subscript  λ  2     (\beta_{2},\;\lambda_{2})   on a sphere in the usual way ( law of cosines or haversine formula ), with longitudes     λ  1      subscript  λ  1    \lambda_{1}\;   and     λ  2      subscript  λ  2    \lambda_{2}\;   being the same on the sphere as on the spheroid.       P  =     β  1   +   β  2    2     Q  =     β  2   -   β  1    2       formulae-sequence    P       subscript  β  1    subscript  β  2    2      Q       subscript  β  2    subscript  β  1    2      P=\frac{\beta_{1}+\beta_{2}}{2}\qquad Q=\frac{\beta_{2}-\beta_{1}}{2}        X  =    (   σ  -   sin  σ    )       sin  2   P     cos  2   Q      cos  2    σ  2        Y  =    (   σ  +   sin  σ    )       cos  2   P     sin  2   Q      sin  2    σ  2          formulae-sequence    X      σ    σ          superscript   2   P     superscript   2   Q      superscript   2     σ  2         Y      σ    σ          superscript   2   P     superscript   2   Q      superscript   2     σ  2         X=(\sigma-\sin\sigma)\frac{\sin^{2}P\cos^{2}Q}{\cos^{2}\frac{\sigma}{2}}\qquad%
 \qquad Y=(\sigma+\sin\sigma)\frac{\cos^{2}P\sin^{2}Q}{\sin^{2}\frac{\sigma}{2}}       distance  =   a   (   σ  -    f  2    (   X  +  Y   )     )        distance    a    σ      f  2     X  Y        \mathrm{distance}=a\bigl(\sigma-\tfrac{f}{2}(X+Y)\bigr)     where   a   a   a   is the equatorial radius of the chosen spheroid.  On the GRS 80 spheroid Lambert's formula is off by   0 North 0 West to 40 North 120 West, 12.6 meters  0N 0W to 40N 60W, 6.6 meters  40N 0W to 40N 60W, 0.85 meter   Bowring's method for short lines  Bowring maps the points to a sphere of radius R′ , with latitude and longitude represented as φ′ and λ′. Define        A  =    1  +    e   ′  2      cos  4    ϕ  1        ,   B  =    1  +    e   ′  2      cos  2    ϕ  1         ,     formulae-sequence    A      1     superscript  e   normal-′  2      superscript   4    subscript  ϕ  1          B      1     superscript  e   normal-′  2      superscript   2    subscript  ϕ  1          A=\sqrt{1+e^{\prime 2}\cos^{4}\phi_{1}},\quad B=\sqrt{1+e^{\prime 2}\cos^{2}%
 \phi_{1}},   where the second eccentricity squared is        e   ′  2    =     a  2   -   b  2     b  2    =    f   (   2  -  f   )      (   1  -  f   )   2     .         superscript  e   normal-′  2         superscript  a  2    superscript  b  2     superscript  b  2             f    2  f     superscript    1  f   2       e^{\prime 2}=\frac{a^{2}-b^{2}}{b^{2}}=\frac{f(2-f)}{(1-f)^{2}}.   The spherical radius is        R  ′   =      1  +   e   ′  2       B  2    a    .       superscript  R  normal-′           1   superscript  e   normal-′  2       superscript  B  2    a     R^{\prime}=\frac{\sqrt{1+e^{\prime 2}}}{B^{2}}a.   (The Gaussian curvature of the ellipsoid at φ 1 is 1/ R′ 2 .) The spherical coordinates are given by      ϕ  1  ′     superscript   subscript  ϕ  1   normal-′    \displaystyle\phi_{1}^{\prime}   where     Δ  ϕ   =    ϕ  2   -   ϕ  1          normal-Δ  ϕ      subscript  ϕ  2    subscript  ϕ  1      \Delta\phi=\phi_{2}-\phi_{1}   ,     Δ   ϕ  ′    =    ϕ  2  ′   -   ϕ  1  ′          normal-Δ   superscript  ϕ  normal-′       superscript   subscript  ϕ  2   normal-′    superscript   subscript  ϕ  1   normal-′      \Delta\phi^{\prime}=\phi_{2}^{\prime}-\phi_{1}^{\prime}   ,     Δ  λ   =    λ  2   -   λ  1          normal-Δ  λ      subscript  λ  2    subscript  λ  1      \Delta\lambda=\lambda_{2}-\lambda_{1}   ,     Δ   λ  ′    =    λ  2  ′   -   λ  1  ′          normal-Δ   superscript  λ  normal-′       superscript   subscript  λ  2   normal-′    superscript   subscript  λ  1   normal-′      \Delta\lambda^{\prime}=\lambda_{2}^{\prime}-\lambda_{1}^{\prime}   . The resulting problem on the sphere may be solved using the techniques for great-circle navigation to give approximations for the spheroidal distance and bearing. Detailed formulas are given by Rapp, 14 §6.5.  See also   Earth radius  Spherical Earth  Great-circle distance  Great-circle navigation  Vincenty's formulae  Meridian arc   References  External links    An online geodesic calculator (based on GeographicLib).  An online geodesic bibliography .  Tripstance tool - Online distance calculator .   "  Category:Cartography  Category:Earth  Category:Geodesy     http://www.cartography.org.uk/default.asp?contentID=749 ↩  http://edocket.access.gpo.gov/cfr_2005/octqtr/pdf/47cfr73.208.pdf ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩      
   Partial fraction decomposition      Partial fraction decomposition   In algebra , the partial fraction decomposition or partial fraction expansion of a rational fraction (that is a fraction such that the numerator and the denominator are both polynomials ) is the operation that consists in expressing the fraction as a sum of a polynomial (possibly zero) and one or several fractions with a simpler denominator.  The importance of the partial fraction decomposition lies in the fact that it provides an algorithm for computing the antiderivative of a rational function .  In symbols, one can use partial fraction expansion to change a rational fraction in the form       f   (  x  )     g   (  x  )          f  x     g  x     \frac{f(x)}{g(x)}     where ƒ and g are polynomials, into an expression of the form       ∑  j      f  j    (  x  )      g  j    (  x  )         subscript   j        subscript  f  j   x      subscript  g  j   x      \sum_{j}\frac{f_{j}(x)}{g_{j}(x)}     where g j ( x ) are polynomials that are factors of g ( x ), and are in general of lower degree. Thus, the partial fraction decomposition may be seen as the inverse procedure of the more elementary operation of addition of rational fractions , which produces a single rational fraction with a numerator and denominator usually of high degree. The full decomposition pushes the reduction as far as it can go: in other words, the factorization of g is used as much as possible. Thus, the outcome of a full partial fraction expansion expresses that fraction as a sum of a polynomial and one of several fractions, such that:   the denominator of each fraction is a power of an irreducible (not factorable) polynomial and  the numerator is a polynomial of smaller degree than this irreducible polynomial.   As factorization of polynomials may be difficult, a coarser decomposition is often preferred, which consists of replacing factorization by square-free factorization . This amounts to replace "irreducible" by "square-free" in the preceding description of the outcome.  Basic principles  Assume a rational function     R   (  x  )    =    f   (  x  )     g   (  x  )           R  x       f  x     g  x      R(x)=\frac{f(x)}{g(x)}   in one indeterminate  x has a denominator that factors as       g   (  x  )    =     P   (  x  )    ⋅  Q    (  x  )          g  x      normal-⋅    P  x   Q   x     g(x)=P(x)\cdot Q(x)\,     over a field  K (we can take this to be real numbers , or complex numbers ). Assume further that P and Q have no common factor. By Bézout's identity for polynomials , there exist polynomials C ( x ) and D ( x ) such that        C  P   +   D  Q    =  1          C  P     D  Q    1    CP+DQ=1     Thus     1   g   (  x  )     =     C  P   +   D  Q     P  Q    =    C  Q   +   D  P            1    g  x          C  P     D  Q      P  Q             C  Q     D  P       \frac{1}{g(x)}=\frac{CP+DQ}{PQ}=\frac{C}{Q}+\frac{D}{P}   and hence R may be written as       R  =    f   (  x  )     g   (  x  )     =     D  f   (  x  )    P   +    C  f   (  x  )    Q     ,        R      f  x     g  x               D  f  x   P       C  f  x   Q       R=\frac{f(x)}{g(x)}=\frac{Df(x)}{P}+\frac{Cf(x)}{Q},     where all numerators are polynomials.  Using this idea inductively we can write R ( x ) as a sum with denominators powers of irreducible polynomials . To take this further, if required, write:       G   (  x  )     F    (  x  )   n          G  x     F   superscript  x  n      \frac{G(x)}{F(x)^{n}}     as a sum with denominators powers of F and numerators of degree less than F , plus a possible extra polynomial. This can be done by the Euclidean algorithm , polynomial case. The result is the following theorem :  {p_i^j}.  If deg ƒ = 0.}}  Therefore, when the field K is the complex numbers, we can assume that each p i has degree 1 (by the fundamental theorem of algebra ) the numerators will be constant. When K is the real numbers, some of the p i might be quadratic, so, in the partial fraction decomposition, a quotient of a linear polynomial by a power of a quadratic might occur.  In the preceding theorem, one may replace "distinct irreducible polynomials" by " pairwise coprime polynomials that are coprime with their derivative". For example, the p i may be the factors of the square-free factorization of g . When K is the field of the rational numbers, as it is typically the case in computer algebra , this allows to replace factorization by greatest common divisor to compute the partial fraction decomposition.  Application to symbolic integration  For the purpose of symbolic integration , the preceding result may be refined into  {p_i^{j-1}}\right)' + \sum_{i=1}^k \frac{c_{i1}}{p_i}.  where    X  ′     superscript  X  normal-′    X^{\prime}   denotes the derivative of    X  .    X   X.   }}  This reduces the computation of the antiderivative of a rational function to the integration of the last sum, which is called the logarithmic part , because its antiderivative is a linear combination of logarithms. In fact, we have         c   i  1     p  i    =    ∑    α  j   :     p  i    (   α  j   )    =  0         c   i  1     (   α  j   )      p  i  ′    (   α  j   )      1   x  -   α  j        .         subscript  c    i  1     subscript  p  i      subscript    normal-:   subscript  α  j        subscript  p  i    subscript  α  j    0            subscript  c    i  1     subscript  α  j       subscript   superscript  p  normal-′   i    subscript  α  j       1    x   subscript  α  j         \frac{c_{i1}}{p_{i}}=\sum_{\alpha_{j}:p_{i}(\alpha_{j})=0}\frac{c_{i1}(\alpha_%
 {j})}{p^{\prime}_{i}(\alpha_{j})}\frac{1}{x-\alpha_{j}}.     There are various methods to compute above decomposition. The one that is the simplest to describe is probably the so-called Hermite 's method. As the degree of c ij is bounded by the degree of p i , and the degree of b is the difference of the degrees of f and g (if this difference is non negative; otherwise, b =0), one may write these unknowns polynomials as polynomials with unknown coefficients. Reducing the two members of above formula to the same denominator and writing that the coefficients of each power of x are the same in the two numerators, one gets a system of linear equations which can be solved to obtain the desired values for the unknowns coefficients.  Procedure  Given two polynomials    P   (  x  )       P  x    P(x)   and     Q   (  x  )    =    (   x  -   α  1    )    (   x  -   α  2    )   ⋯   (   x  -   α  n    )          Q  x       x   subscript  α  1      x   subscript  α  2    normal-⋯    x   subscript  α  n       Q(x)=(x-\alpha_{1})(x-\alpha_{2})\cdots(x-\alpha_{n})   , where the α i are distinct constants and deg P \frac{P(x)}{Q(x)} = \frac{c_1}{x-\alpha_1} + \frac{c_2}{x-\alpha_2} + \cdots + \frac{c_n}{x-\alpha_n}  and solving for the c i constants, by substitution, by equating the coefficients of terms involving the powers of x , or otherwise. (This is a variant of the method of undetermined coefficients .)  A more direct computation, which is strongly related with Lagrange interpolation consists in writing        P   (  x  )     Q   (  x  )     =    ∑   i  =  1   n      P   (   α  i   )      Q  ′    (   α  i   )      1   (   x  -   α  i    )              P  x     Q  x      superscript   subscript     i  1    n         P   subscript  α  i       superscript  Q  normal-′    subscript  α  i       1    x   subscript  α  i         \frac{P(x)}{Q(x)}=\sum_{i=1}^{n}\frac{P(\alpha_{i})}{Q^{\prime}(\alpha_{i})}%
 \frac{1}{(x-\alpha_{i})}   where    Q  ′     superscript  Q  normal-′    Q^{\prime}   is the derivative of the polynomial   Q   Q   Q   .  This approach does not account for several other cases, but can be modified accordingly:   If deg P    ≥     \geq   deg Q , then it is necessary to perform the Euclidean division of P by Q , using polynomial long division , giving P ( x ) = E ( x ) Q ( x ) + R ( x ) with deg R  < n . Dividing by Q ( x ) this gives            P   (  x  )     Q   (  x  )     =    E   (  x  )    +    R   (  x  )     Q   (  x  )       ,          P  x     Q  x        E  x       R  x     Q  x       \frac{P(x)}{Q(x)}=E(x)+\frac{R(x)}{Q(x)},       and then seek partial fractions for the remainder fraction (which by definition satisfies deg R < deg Q ).    If Q ( x ) contains factors which are irreducible over the given field, then the numerator N ( x ) of each partial fraction with such a factor F ( x ) in the denominator must be sought as a polynomial with deg N < deg F , rather than as a constant. For example, take the following decomposition over R :             x  2   +  1     (   x  +  2   )    (   x  -  1   )    \color   B  l  u  e   (    x  2   +  x  +  1   )     =    a   x  +  2    +   b   x  -  1    +      \color   O  l  i  v  e  G  r  e  e  n  c  x   +  d      \color   B  l  u  e   x  2    +  x  +  1      .           superscript  x  2   1       x  2     x  1   \color  B  l  u  e     superscript  x  2   x  1         a    x  2      b    x  1          \color  O  l  i  v  e  G  r  e  e  n  c  x   d       \color  B  l  u  e   superscript  x  2    x  1       \frac{x^{2}+1}{(x+2)(x-1)\color{Blue}(x^{2}+x+1)}=\frac{a}{x+2}+\frac{b}{x-1}+%
 \frac{\color{OliveGreen}cx+d}{\color{Blue}x^{2}+x+1}.         Suppose Q ( x ) = ( x − α ) r S ( x ) and S ( α ) ≠ 0. Then Q ( x ) has a zero α of multiplicity  r , and in the partial fraction decomposition, r of the partial fractions will involve the powers of ( x − α ). For illustration, take S ( x ) = 1 to get the following decomposition:            P   (  x  )     Q   (  x  )     =    P   (  x  )      (   x  -  α   )   r    =     c  1    x  -  α    +    c  2     (   x  -  α   )   2    +  ⋯  +    c  r     (   x  -  α   )   r      .            P  x     Q  x        P  x    superscript    x  α   r              subscript  c  1     x  α       subscript  c  2    superscript    x  α   2    normal-⋯     subscript  c  r    superscript    x  α   r        \frac{P(x)}{Q(x)}=\frac{P(x)}{(x-\alpha)^{r}}=\frac{c_{1}}{x-\alpha}+\frac{c_{%
 2}}{(x-\alpha)^{2}}+\cdots+\frac{c_{r}}{(x-\alpha)^{r}}.        Illustration  In an example application of this procedure, can be decomposed in the form          3  x   +  5     (   1  -   2  x    )   2    =    A    (   1  -   2  x    )   2    +   B   (   1  -   2  x    )      .            3  x   5    superscript    1    2  x    2        A   superscript    1    2  x    2      B    1    2  x        \frac{3x+5}{(1-2x)^{2}}=\frac{A}{(1-2x)^{2}}+\frac{B}{(1-2x)}.     Clearing denominators shows that . Expanding and equating the coefficients of powers of x gives   5 = A + B and 3 x = −2 Bx    Solving for A and B yields A = 13/2 and B = −3/2. Hence,          3  x   +  5     (   1  -   2  x    )   2    =     13  /  2     (   1  -   2  x    )   2    +    -   3  /  2     (   1  -   2  x    )      .            3  x   5    superscript    1    2  x    2          13  2    superscript    1    2  x    2          3  2      1    2  x        \frac{3x+5}{(1-2x)^{2}}=\frac{13/2}{(1-2x)^{2}}+\frac{-3/2}{(1-2x)}.     Residue method  Over the complex numbers, suppose ƒ ( x ) is a rational proper fraction, and can be decomposed into        f   (  x  )    =    ∑  i    (     a   i  1     x  -   x  i     +    a   i  2      (   x  -   x  i    )   2    +  ⋯  +    a   i   k  i       (   x  -   x  i    )    k  i      )     .        f  x     subscript   i        subscript  a    i  1      x   subscript  x  i        subscript  a    i  2     superscript    x   subscript  x  i    2    normal-⋯     subscript  a    i   subscript  k  i      superscript    x   subscript  x  i     subscript  k  i         f(x)=\sum_{i}\left(\frac{a_{i1}}{x-x_{i}}+\frac{a_{i2}}{(x-x_{i})^{2}}+\cdots+%
 \frac{a_{ik_{i}}}{(x-x_{i})^{k_{i}}}\right).     Let         g   i  j     (  x  )    =     (   x  -   x  i    )    j  -  1    f   (  x  )     ,         subscript  g    i  j    x      superscript    x   subscript  x  i      j  1    f  x     g_{ij}(x)=(x-x_{i})^{j-1}f(x),     then according to the uniqueness of Laurent series , a ij is the coefficient of the term ( x − x i ) −1 in the Laurent expansion of g ij ( x ) about the point x i , i.e., its residue        a   i  j    =   Res   (   g   i  j    ,   x  i   )     .       subscript  a    i  j     Res   subscript  g    i  j     subscript  x  i      a_{ij}=\operatorname{Res}(g_{ij},x_{i}).     This is given directly by the formula        a   i  j    =    1    (    k  i   -  j   )   !      lim   x  →   x  i        d    k  i   -  j     d   x    k  i   -  j       (     (   x  -   x  i    )    k  i    f   (  x  )    )       ,       subscript  a    i  j        1       subscript  k  i   j       subscript    normal-→  x   subscript  x  i          superscript  d     subscript  k  i   j      d   superscript  x     subscript  k  i   j         superscript    x   subscript  x  i     subscript  k  i    f  x        a_{ij}=\frac{1}{(k_{i}-j)!}\lim_{x\to x_{i}}\frac{d^{k_{i}-j}}{dx^{k_{i}-j}}%
 \left((x-x_{i})^{k_{i}}f(x)\right),     or in the special case when x i is a simple root,        a   i  1    =    P   (   x  i   )      Q  ′    (   x  i   )      ,       subscript  a    i  1        P   subscript  x  i       superscript  Q  normal-′    subscript  x  i       a_{i1}=\frac{P(x_{i})}{Q^{\prime}(x_{i})},     when        f   (  x  )    =    P   (  x  )     Q   (  x  )      .        f  x       P  x     Q  x      f(x)=\frac{P(x)}{Q(x)}.     Note that P ( x ) and Q ( x ) may or may not be polynomials.  Over the reals  Partial fractions are used in real-variable  integral calculus to find real-valued antiderivatives of rational functions . Partial fraction decomposition of real rational functions is also used to find their Inverse Laplace transforms . For applications of partial fraction decomposition over the reals , see   Application to symbolic integration , above  Partial fractions in Laplace transforms   General result  Let ƒ ( x ) be any rational function over the real numbers . In other words, suppose there exist real polynomials functions p ( x ) and q ( x )≠ 0, such that       f   (  x  )    =    p   (  x  )     q   (  x  )           f  x       p  x     q  x      f(x)=\frac{p(x)}{q(x)}     By dividing both the numerator and the denominator by the leading coefficient of q ( x ), we may assume without loss of generality that q ( x ) is monic . By the fundamental theorem of algebra , we can write       q   (  x  )    =     (   x  -   a  1    )    j  1    ⋯    (   x  -   a  m    )    j  m      (    x  2   +    b  1   x   +   c  1    )    k  1    ⋯    (    x  2   +    b  n   x   +   c  n    )    k  n           q  x      superscript    x   subscript  a  1     subscript  j  1    normal-⋯   superscript    x   subscript  a  m     subscript  j  m     superscript     superscript  x  2      subscript  b  1   x    subscript  c  1     subscript  k  1    normal-⋯   superscript     superscript  x  2      subscript  b  n   x    subscript  c  n     subscript  k  n       q(x)=(x-a_{1})^{j_{1}}\cdots(x-a_{m})^{j_{m}}(x^{2}+b_{1}x+c_{1})^{k_{1}}%
 \cdots(x^{2}+b_{n}x+c_{n})^{k_{n}}     where a 1 ,..., a m , b 1 ,..., b n , c 1 ,..., c n are real numbers with b i 2 − 4 c i 1,..., j m , k 1 ,..., k n are positive integers. The terms ( x − a i ) are the linear factors of q ( x ) which correspond to real roots of q ( x ), and the terms ( x i 2 + b i x + c i ) are the irreducible quadratic factors of q ( x ) which correspond to pairs of complex conjugate roots of q ( x ).  Then the partial fraction decomposition of ƒ ( x ) is the following:       f   (  x  )    =    p   (  x  )     q   (  x  )     =    P   (  x  )    +    ∑   i  =  1   m     ∑   r  =  1    j  i      A   i  r      (   x  -   a  i    )   r      +    ∑   i  =  1   n     ∑   r  =  1    k  i        B   i  r    x   +   C   i  r       (    x  2   +    b  i   x   +   c  i    )   r               f  x       p  x     q  x             P  x     superscript   subscript     i  1    m     superscript   subscript     r  1     subscript  j  i       subscript  A    i  r     superscript    x   subscript  a  i    r        superscript   subscript     i  1    n     superscript   subscript     r  1     subscript  k  i           subscript  B    i  r    x    subscript  C    i  r      superscript     superscript  x  2      subscript  b  i   x    subscript  c  i    r          f(x)=\frac{p(x)}{q(x)}=P(x)+\sum_{i=1}^{m}\sum_{r=1}^{j_{i}}\frac{A_{ir}}{(x-a%
 _{i})^{r}}+\sum_{i=1}^{n}\sum_{r=1}^{k_{i}}\frac{B_{ir}x+C_{ir}}{(x^{2}+b_{i}x%
 +c_{i})^{r}}     Here, P ( x ) is a (possibly zero) polynomial, and the A ir , B ir , and C ir are real constants. There are a number of ways the constants can be found.  The most straightforward method is to multiply through by the common denominator q ( x ). We then obtain an equation of polynomials whose left-hand side is simply p ( x ) and whose right-hand side has coefficients which are linear expressions of the constants A ir , B ir , and C ir . Since two polynomials are equal if and only if their corresponding coefficients are equal, we can equate the coefficients of like terms. In this way, a system of linear equations is obtained which always has a unique solution. This solution can be found using any of the standard methods of linear algebra . It can also be found with limits (see Example 5 ).  Examples  Example 1       f   (  x  )    =   1     x  2   +   2  x    -  3          f  x     1       superscript  x  2     2  x    3      f(x)=\frac{1}{x^{2}+2x-3}     Here, the denominator splits into two distinct linear factors:       q   (  x  )    =     x  2   +   2  x    -  3   =    (   x  +  3   )    (   x  -  1   )            q  x        superscript  x  2     2  x    3            x  3     x  1       q(x)=x^{2}+2x-3=(x+3)(x-1)     so we have the partial fraction decomposition       f   (  x  )    =   1     x  2   +   2  x    -  3    =    A   x  +  3    +   B   x  -  1             f  x     1       superscript  x  2     2  x    3             A    x  3      B    x  1        f(x)=\frac{1}{x^{2}+2x-3}=\frac{A}{x+3}+\frac{B}{x-1}     Multiplying through by x 2 + 2 x − 3, we have the polynomial identity      1  =    A   (   x  -  1   )    +   B   (   x  +  3   )         1      A    x  1      B    x  3       1=A(x-1)+B(x+3)     Substituting x = −3 into this equation gives A = −1/4, and substituting x = 1 gives B = 1/4, so that       f   (  x  )    =   1     x  2   +   2  x    -  3    =    1  4    (     -  1    x  +  3    +   1   x  -  1     )            f  x     1       superscript  x  2     2  x    3             1  4         1     x  3      1    x  1         f(x)=\frac{1}{x^{2}+2x-3}=\frac{1}{4}\left(\frac{-1}{x+3}+\frac{1}{x-1}\right)     '''  Example 2       f   (  x  )    =     x  3   +  16      x  3   -   4   x  2     +   8  x           f  x        superscript  x  3   16        superscript  x  3     4   superscript  x  2       8  x       f(x)=\frac{x^{3}+16}{x^{3}-4x^{2}+8x}     After long-division , we have       f   (  x  )    =   1  +      4   x  2    -   8  x    +  16      x  3   -   4   x  2     +   8  x      =   1  +      4   x  2    -   8  x    +  16    x   (     x  2   -   4  x    +  8   )              f  x     1          4   superscript  x  2      8  x    16        superscript  x  3     4   superscript  x  2       8  x             1          4   superscript  x  2      8  x    16     x       superscript  x  2     4  x    8         f(x)=1+\frac{4x^{2}-8x+16}{x^{3}-4x^{2}+8x}=1+\frac{4x^{2}-8x+16}{x(x^{2}-4x+8)}     Since (−4) 2 − 4×8 = −16 2 − 4 x + 8 is irreducible, and the partial fraction decomposition over the reals has the shape          4   x  2    -   8  x    +  16    x   (     x  2   -   4  x    +  8   )     =    A  x   +     B  x   +  C      x  2   -   4  x    +  8                 4   superscript  x  2      8  x    16     x       superscript  x  2     4  x    8         A  x         B  x   C        superscript  x  2     4  x    8       \frac{4x^{2}-8x+16}{x(x^{2}-4x+8)}=\frac{A}{x}+\frac{Bx+C}{x^{2}-4x+8}     Multiplying through by x 3 − 4 x 2 + 8 x , we have the polynomial identity         4   x  2    -   8  x    +  16   =    A   (     x  2   -   4  x    +  8   )    +    (    B  x   +  C   )   x              4   superscript  x  2      8  x    16       A       superscript  x  2     4  x    8          B  x   C   x      4x^{2}-8x+16=A(x^{2}-4x+8)+(Bx+C)x     Taking x = 0, we see that 16 = 8 A , so A = 2. Comparing the x 2 coefficients, we see that 4 = A + B = 2 + B , so B = 2. Comparing linear coefficients, we see that −8 = −4 A + C = −8 + C , so C = 0. Altogether,       f   (  x  )    =   1  +   2   (    1  x   +   x     x  2   -   4  x    +  8     )           f  x     1    2      1  x     x       superscript  x  2     4  x    8         f(x)=1+2\left(\frac{1}{x}+\frac{x}{x^{2}-4x+8}\right)     Example 3  This example illustrates almost all the "tricks" we might need to use, short of consulting a computer algebra system .       f   (  x  )    =           x  9   -   2   x  6     +   2   x  5     -   7   x  4     +   13   x  3     -   11   x  2     +   12  x    -  4           x  7   -   3   x  6     +   5   x  5     -   7   x  4     +   7   x  3     -   5   x  2     +   3  x    -  1          f  x                    superscript  x  9     2   superscript  x  6       2   superscript  x  5       7   superscript  x  4       13   superscript  x  3       11   superscript  x  2       12  x    4                  superscript  x  7     3   superscript  x  6       5   superscript  x  5       7   superscript  x  4       7   superscript  x  3       5   superscript  x  2       3  x    1      f(x)=\frac{x^{9}-2x^{6}+2x^{5}-7x^{4}+13x^{3}-11x^{2}+12x-4}{x^{7}-3x^{6}+5x^{%
 5}-7x^{4}+7x^{3}-5x^{2}+3x-1}     After long-division and factoring the denominator, we have       f   (  x  )    =    x  2   +   3  x   +  4  +        2   x  6    -   4   x  5     +   5   x  4     -   3   x  3     +   x  2   +   3  x       (   x  -  1   )   3     (    x  2   +  1   )   2            f  x      superscript  x  2     3  x   4              2   superscript  x  6      4   superscript  x  5       5   superscript  x  4       3   superscript  x  3      superscript  x  2     3  x       superscript    x  1   3    superscript     superscript  x  2   1   2        f(x)=x^{2}+3x+4+\frac{2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x}{(x-1)^{3}(x^{2}+1)%
 ^{2}}     The partial fraction decomposition takes the form            2   x  6    -   4   x  5     +   5   x  4     -   3   x  3     +   x  2   +   3  x       (   x  -  1   )   3     (    x  2   +  1   )   2     =    A   x  -  1    +   B    (   x  -  1   )   2    +   C    (   x  -  1   )   3    +     D  x   +  E     x  2   +  1    +     F  x   +  G     (    x  2   +  1   )   2                     2   superscript  x  6      4   superscript  x  5       5   superscript  x  4       3   superscript  x  3      superscript  x  2     3  x       superscript    x  1   3    superscript     superscript  x  2   1   2         A    x  1      B   superscript    x  1   2      C   superscript    x  1   3          D  x   E      superscript  x  2   1          F  x   G    superscript     superscript  x  2   1   2       \frac{2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x}{(x-1)^{3}(x^{2}+1)^{2}}=\frac{A}{x%
 -1}+\frac{B}{(x-1)^{2}}+\frac{C}{(x-1)^{3}}+\frac{Dx+E}{x^{2}+1}+\frac{Fx+G}{(%
 x^{2}+1)^{2}}     Multiplying through by ( x − 1) 3 ( x 2 + 1) 2 we have the polynomial identity           2    x  6    -   4   x  5     +   5   x  4     -   3   x  3     +   x  2   +   3  x               2   superscript  x  6      4   superscript  x  5       5   superscript  x  4       3   superscript  x  3      superscript  x  2     3  x     \displaystyle{}\quad 2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x     Taking x = 1 gives 4 = 4 C , so C = 1. Similarly, taking x = i gives 2 + 2 i = ( Fi + G )(2 + 2 i ), so Fi + G = 1, so F = 0 and G = 1 by equating real and imaginary parts. With C = G = 1 and F = 0, taking x = 0 we get A − B + 1 − E − 1 = 0, thus E = A − B .  We now have the identity          2   x  6    -   4   x  5     +   5   x  4     -   3   x  3     +   x  2   +   3  x               2   superscript  x  6      4   superscript  x  5       5   superscript  x  4       3   superscript  x  3      superscript  x  2     3  x     \displaystyle{}2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x     Expanding and sorting by exponents of x we get          2   x  6    -   4   x  5     +   5   x  4     -   3   x  3     +   x  2   +   3  x               2   superscript  x  6      4   superscript  x  5       5   superscript  x  4       3   superscript  x  3      superscript  x  2     3  x     \displaystyle{}2x^{6}-4x^{5}+5x^{4}-3x^{3}+x^{2}+3x     We can now compare the coefficients and see that      A  +  D      A  D    \displaystyle A+D     with A = 2 − D and − A −3 D =−4 we get A = D = 1 and so B = 0, furthermore is C = 1, E = A − B = 1, F = 0 and G = 1.  The partial fraction decomposition of ƒ ( x ) is thus        f   (  x  )    =    x  2   +   3  x   +  4  +   1   (   x  -  1   )    +   1    (   x  -  1   )   3    +    x  +  1     x  2   +  1    +   1    (    x  2   +  1   )   2      .        f  x      superscript  x  2     3  x   4    1    x  1      1   superscript    x  1   3        x  1      superscript  x  2   1      1   superscript     superscript  x  2   1   2       f(x)=x^{2}+3x+4+\frac{1}{(x-1)}+\frac{1}{(x-1)^{3}}+\frac{x+1}{x^{2}+1}+\frac{%
 1}{(x^{2}+1)^{2}}.     Alternatively, instead of expanding, one can obtain other linear dependences on the coefficients computing some derivatives at x=1 and at x=i in the above polynomial identity. (To this end, recall that the derivative at x=a of (x−a) m p(x) vanishes if m > 1 and it is just p(a) if m=1 .) Thus, for instance the first derivative at x=1 gives           2  ⋅  6   -   4  ⋅  5    +   5  ⋅  4    -   3  ⋅  3    +  2  +  3   =    A  ⋅   (   0  +  0   )    +   B  ⋅   (   4  +  0   )    +  8  +   D  ⋅  0                 normal-⋅  2  6    normal-⋅  4  5     normal-⋅  5  4     normal-⋅  3  3    2  3      normal-⋅  A    0  0     normal-⋅  B    4  0    8   normal-⋅  D  0      2\cdot 6-4\cdot 5+5\cdot 4-3\cdot 3+2+3=A\cdot(0+0)+B\cdot(4+0)+8+D\cdot 0   that is 8 = 4B + 8 so B=0 .  Example 4 (residue method)       f   (  z  )    =     z  2   -  5     (    z  2   -  1   )    (    z  2   +  1   )     =     z  2   -  5     (   z  +  1   )    (   z  -  1   )    (   z  +  i   )    (   z  -  i   )             f  z        superscript  z  2   5        superscript  z  2   1      superscript  z  2   1               superscript  z  2   5       z  1     z  1     z  i     z  i        f(z)=\frac{z^{2}-5}{(z^{2}-1)(z^{2}+1)}=\frac{z^{2}-5}{(z+1)(z-1)(z+i)(z-i)}     Thus, f ( z ) can be decomposed into rational functions whose denominators are z +1, z −1, z +i, z −i. Since each term is of power one, −1, 1, − i and i are simple poles.  Hence, the residues associated with each pole, given by        P   (   z  i   )      Q  ′    (   z  i   )     =     z  i  2   -  5    4   z  i  3             P   subscript  z  i       superscript  Q  normal-′    subscript  z  i          superscript   subscript  z  i   2   5     4   superscript   subscript  z  i   3       \frac{P(z_{i})}{Q^{\prime}(z_{i})}=\frac{z_{i}^{2}-5}{4z_{i}^{3}}   , are      1  ,   -  1   ,     3  i   2    ,   -     3  i   2        1    1       3  i   2         3  i   2      1,-1,\tfrac{3i}{2},-\tfrac{3i}{2}   , respectively, and       f   (  z  )    =      1   z  +  1    -   1   z  -  1     +     3  i   2    1   z  +  i      -     3  i   2    1   z  -  i            f  z           1    z  1      1    z  1           3  i   2     1    z  i            3  i   2     1    z  i        f(z)=\frac{1}{z+1}-\frac{1}{z-1}+\frac{3i}{2}\frac{1}{z+i}-\frac{3i}{2}\frac{1%
 }{z-i}   .  Example 5 (limit method)  Limits can be used to find a partial fraction decomposition. 1       f   (  x  )    =   1    x  3   -  1          f  x     1     superscript  x  3   1      f(x)=\frac{1}{x^{3}-1}     First, factor the denominator:       f   (  x  )    =   1    (   x  -  1   )    (    x  2   +  x  +  1   )           f  x     1      x  1      superscript  x  2   x  1       f(x)=\frac{1}{(x-1)(x^{2}+x+1)}     The decomposition takes the form of       1    (   x  -  1   )    (    x  2   +  x  +  1   )     =    A   x  -  1    +     B  x   +  C     x  2   +  x  +  1           1      x  1      superscript  x  2   x  1         A    x  1          B  x   C      superscript  x  2   x  1       \frac{1}{(x-1)(x^{2}+x+1)}=\frac{A}{x-1}+\frac{Bx+C}{x^{2}+x+1}     As    x  →  1     normal-→  x  1    x\to 1   , the A term dominates, so the right-hand side approaches    A   x  -  1       A    x  1     \frac{A}{x-1}   . Thus, we have       1    (   x  -  1   )    (    x  2   +  x  +  1   )     =   A   x  -  1          1      x  1      superscript  x  2   x  1       A    x  1      \frac{1}{(x-1)(x^{2}+x+1)}=\frac{A}{x-1}         A  =    lim   x  →  1     1    x  2   +  x  +  1     =   1  3         A    subscript    normal-→  x  1      1     superscript  x  2   x  1            1  3      A=\lim_{x\to 1}{\frac{1}{x^{2}+x+1}}=\frac{1}{3}     As    x  →  ∞     normal-→  x     x\to\infty   , the right-hand side is          lim   x  →  ∞     A   x  -  1     +     B  x   +  C     x  2   +  x  +  1     =    A  x   +    B  x    x  2     =    A  +  B   x    .            subscript    normal-→  x       A    x  1           B  x   C      superscript  x  2   x  1         A  x       B  x    superscript  x  2              A  B   x      \lim_{x\to\infty}{\frac{A}{x-1}+\frac{Bx+C}{x^{2}+x+1}}=\frac{A}{x}+\frac{Bx}{%
 x^{2}}=\frac{A+B}{x}.           A  +  B   x   =    lim   x  →  ∞     1    x  3   -  1     =  0            A  B   x     subscript    normal-→  x       1     superscript  x  3   1          0     \frac{A+B}{x}=\lim_{x\to\infty}{\frac{1}{x^{3}-1}}=0     Thus,    B  =   -   1  3        B      1  3      B=-\frac{1}{3}   .  At    x  =  0      x  0    x=0   ,     -  1   =    -  A   +  C         1       A   C     -1=-A+C   . Therefore,    C  =   -   2  3        C      2  3      C=-\frac{2}{3}   .  The decomposition is thus      1  3    x  -  1    +     -    1  3   x    -   2  3      x  2   +  x  +  1            1  3     x  1              1  3   x      2  3       superscript  x  2   x  1      \frac{\frac{1}{3}}{x-1}+\frac{-\frac{1}{3}x-\frac{2}{3}}{x^{2}+x+1}   .  The role of the Taylor polynomial  The partial fraction decomposition of a rational function can be related to Taylor's theorem as follows. Let       P   (  x  )    ,   Q   (  x  )    ,    A  1    (  x  )    ,  …  ,    A  r    (  x  )         P  x     Q  x      subscript  A  1   x   normal-…     subscript  A  r   x     P(x),Q(x),A_{1}(x),\dots,A_{r}(x)     be real or complex polynomials; assume that       Q  =     ∏   j  =  1   r      (   x  -   λ  j    )    ν  j      ,      Q    superscript   subscript  product    j  1    r    superscript    x   subscript  λ  j     subscript  ν  j       \textstyle Q=\prod_{j=1}^{r}(x-\lambda_{j})^{\nu_{j}},     that        deg   (  P  )    <   deg   (  Q  )    =     ∑   j  =  1   r     ν  j     ,         degree  P    degree  Q          superscript   subscript     j  1    r    subscript  ν  j       \textstyle\deg(P)<\deg(Q)=\sum_{j=1}^{r}\nu_{j},     and that         deg   A  j    <    ν  j   for  j   =  1   ,   …  ,  r    .     formulae-sequence       degree   subscript  A  j       subscript  ν  j   for  j        1     normal-…  r     \textstyle\deg A_{j}<\nu_{j}\text{ for }j=1,\dots,r.     Define also         Q  i   =     ∏   j  ≠  i       (   x  -   λ  j    )    ν  j     =     Q    (   x  -   λ  i    )    ν  i      for  i   =  1   ,   …  ,  r    .     formulae-sequence       subscript  Q  i     subscript  product    j  i     superscript    x   subscript  λ  j     subscript  ν  j              Q   superscript    x   subscript  λ  i     subscript  ν  i     for  i        1     normal-…  r     \textstyle Q_{i}=\prod_{j\neq i}(x-\lambda_{j})^{\nu_{j}}=\frac{Q}{(x-\lambda_%
 {i})^{\nu_{i}}}\text{ for }i=1,\dots,r.     Then we have       P  Q   =    ∑   j  =  1   r     A  j     (   x  -   λ  j    )    ν  j            P  Q     superscript   subscript     j  1    r      subscript  A  j    superscript    x   subscript  λ  j     subscript  ν  j        \frac{P}{Q}=\sum_{j=1}^{r}\frac{A_{j}}{(x-\lambda_{j})^{\nu_{j}}}     if, and only if, for each   i   i   \textstyle i   the polynomial     A  i    (  x  )        subscript  A  i   x    \textstyle A_{i}(x)   is the Taylor polynomial of    P   Q  i       P   subscript  Q  i     \textstyle\frac{P}{Q_{i}}   of order     ν  i   -  1       subscript  ν  i   1    \textstyle\nu_{i}-1   at the point    λ  i     subscript  λ  i    \textstyle\lambda_{i}   :         A  i    (  x  )    :=    ∑   k  =  0     ν  i   -  1      1   k  !      (   P   Q  i    )    (  k  )     (   λ  i   )     (   x  -   λ  i    )   k      .     assign     subscript  A  i   x     superscript   subscript     k  0       subscript  ν  i   1        1    k     superscript    P   subscript  Q  i    k    subscript  λ  i    superscript    x   subscript  λ  i    k       A_{i}(x):=\sum_{k=0}^{\nu_{i}-1}\frac{1}{k!}\left(\frac{P}{Q_{i}}\right)^{(k)}%
 (\lambda_{i})\ (x-\lambda_{i})^{k}.     Taylor's theorem (in the real or complex case) then provides a proof of the existence and uniqueness of the partial fraction decomposition, and a characterization of the coefficients.  Sketch of the proof: The above partial fraction decomposition implies, for each 1 ≤ i ≤ r , a polynomial expansion        P   Q  i    =    A  i   +   O   (    (   x  -   λ  i    )    ν  i    )            P   subscript  Q  i       subscript  A  i     O   superscript    x   subscript  λ  i     subscript  ν  i        \frac{P}{Q_{i}}=A_{i}+O((x-\lambda_{i})^{\nu_{i}})\qquad   , as     x  →   λ  i    ;     normal-→  x   subscript  λ  i     x\to\lambda_{i};     so    A  i     subscript  A  i    \textstyle A_{i}   is the Taylor polynomial of    P   Q  i       P   subscript  Q  i     \textstyle\frac{P}{Q_{i}}   , because of the unicity of the polynomial expansion of order     ν  i   -  1       subscript  ν  i   1    \textstyle\nu_{i}-1   , and by assumption     deg   A  i    <   ν  i        degree   subscript  A  i     subscript  ν  i     \textstyle\deg A_{i}<\nu_{i}   .  Conversely, if the    A  i     subscript  A  i    \textstyle A_{i}   are the Taylor polynomials, the above expansions at each    λ  i     subscript  λ  i    \textstyle\lambda_{i}   hold, therefore we also have        P  -    Q  i    A  i     =   O   (    (   x  -   λ  i    )    ν  i    )           P     subscript  Q  i    subscript  A  i       O   superscript    x   subscript  λ  i     subscript  ν  i       P-Q_{i}A_{i}=O((x-\lambda_{i})^{\nu_{i}})\qquad   , as     x  →   λ  i    ,     normal-→  x   subscript  λ  i     x\to\lambda_{i},     which implies that the polynomial    P  -    Q  i    A  i        P     subscript  Q  i    subscript  A  i      \textstyle P-Q_{i}A_{i}   is divisible by      (   x  -   λ  i    )    ν  i    .     superscript    x   subscript  λ  i     subscript  ν  i     \textstyle(x-\lambda_{i})^{\nu_{i}}.     For    j  ≠  i      j  i    \textstyle j\neq i   also     Q  j    A  j        subscript  Q  j    subscript  A  j     \textstyle Q_{j}A_{j}   is divisible by     (   x  -   λ  i    )    ν  i      superscript    x   subscript  λ  i     subscript  ν  i     \textstyle(x-\lambda_{i})^{\nu_{i}}   , so we have in turn that    P  -    ∑   j  =  1   r     Q  j    A  j         P    superscript   subscript     j  1    r      subscript  Q  j    subscript  A  j       \textstyle P-\sum_{j=1}^{r}Q_{j}A_{j}   is divisible by   Q   Q   \textstyle Q   . Since     deg   (   P  -    ∑   j  =  1   r     Q  j    A  j      )    <   deg   (  Q  )         degree    P    superscript   subscript     j  1    r      subscript  Q  j    subscript  A  j        degree  Q     \textstyle\deg\left(P-\sum_{j=1}^{r}Q_{j}A_{j}\right)<\deg(Q)   we then have     P  -    ∑   j  =  1   r     Q  j    A  j      =  0        P    superscript   subscript     j  1    r      subscript  Q  j    subscript  A  j      0    \textstyle P-\sum_{j=1}^{r}Q_{j}A_{j}=0   , and we find the partial fraction decomposition dividing by   Q   Q   \textstyle Q   .  Fractions of integers  The idea of partial fractions can be generalized to other integral domains , say the ring of integers where prime numbers take the role of irreducible denominators. For example:        1  18   =    1  2   -   1  3   -   1   3  2      .        1  18       1  2     1  3     1   superscript  3  2       \frac{1}{18}=\frac{1}{2}-\frac{1}{3}-\frac{1}{3^{2}}.     Notes  References                 External links     1 Make partial fraction decompositions with Scilab .   "  Category:Algebra  Category:Elementary algebra  Category:Partial fractions     ↩     
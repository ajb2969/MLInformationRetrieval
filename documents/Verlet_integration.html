<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="753">Verlet integration</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Verlet integration</h1>
<hr/>

<p><strong>Verlet integration</strong> () is a numerical method used to <a href="Time_integration_method" title="wikilink">integrate</a> <a href="Isaac_Newton" title="wikilink">Newton's</a> <a href="equations_of_motion" title="wikilink">equations of motion</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> It is frequently used to calculate <a href="Trajectory" title="wikilink">trajectories</a> of particles in <a href="molecular_dynamics" title="wikilink">molecular dynamics</a> simulations and <a href="computer_graphics" title="wikilink">computer graphics</a>. The algorithm was first used in 1791 by <a href="Jean_Baptiste_Joseph_Delambre" title="wikilink">Delambre</a>, and has been rediscovered many times since then, most recently by <a href="Loup_Verlet" title="wikilink">Loup Verlet</a> in the 1960s for use in molecular dynamics. It was also used by <a href="Philip_Herbert_Cowell" title="wikilink">Cowell</a> and <a href="Andrew_Claude_de_la_Cherois_Crommelin" title="wikilink">Crommelin</a> in 1909 to compute the orbit of <a href="Halley's_Comet" title="wikilink">Halley's Comet</a>, and by <a href="Carl_Størmer" title="wikilink">Carl Størmer</a> in 1907 to study the motion of electrical particles in a <a href="magnetic_field" title="wikilink">magnetic field</a>. The Verlet integrator provides good <a href="numerical_stability" title="wikilink">numerical stability</a>, as well as other properties that are important in <a href="physical_system" title="wikilink">physical systems</a> such as <a class="uri" href="time-reversibility" title="wikilink">time-reversibility</a> and <a href="Symplectic_integrator" title="wikilink">preservation of the symplectic form on phase space</a>, at no significant additional computational cost over the simple <a href="Euler_method" title="wikilink">Euler method</a>. Verlet integration was used by <a href="Carl_Størmer" title="wikilink">Carl Størmer</a> to compute the trajectories of particles moving in a magnetic field (hence it is also called <strong>Störmer's method</strong>)<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and was popularized in molecular dynamics by French physicist <a href="Loup_Verlet" title="wikilink">Loup Verlet</a> in 1967.</p>
<h2 id="basic-störmerverlet">Basic Störmer–Verlet</h2>

<p>For a <a href="differential_equation" title="wikilink">differential equation</a> of second order of the type 

<math display="inline" id="Verlet_integration:0">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>¨</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>A</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¨</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{\vec{x}}(t)=\vec{A}(\vec{x}(t))
  </annotation>
 </semantics>
</math>

 with initial conditions 

<math display="inline" id="Verlet_integration:1">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t_{0})=\vec{x}_{0}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Verlet_integration:2">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>˙</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-˙</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\vec{x}}(t_{0})=\vec{v}_{0}
  </annotation>
 </semantics>
</math>

, an approximate numerical solution 

<math display="inline" id="Verlet_integration:3">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>≈</mo>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{n}\approx\vec{x}(t_{n})
  </annotation>
 </semantics>
</math>


 at the times 

<math display="inline" id="Verlet_integration:4">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>n</mi>
     </mpadded>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{n}=t_{0}+n\,\Delta t
  </annotation>
 </semantics>
</math>

 with step size 

<math display="inline" id="Verlet_integration:5">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t>0
  </annotation>
 </semantics>
</math>

 can be obtained by the following method:</p>
<ul>
<li>set 

<math display="inline" id="Verlet_integration:6">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mover accent="true">
        <mi>v</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mn>0</mn>
      </msub>
     </mpadded>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>A</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mn>0</mn>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>v</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{1}=\vec{x}_{0}+\vec{v}_{0}\,\Delta t+\frac{1}{2}A(\vec{x}_{0})\,%
\Delta t^{2}
  </annotation>
 </semantics>
</math>

</li>
<li>for <em>n=1,2,...</em> iterate</li>
</ul>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>\vec x_{n+1}=2 \vec x_n- \vec x_{n-1}+ A(\vec x_n)\,\Delta t^2. </p>
<h3 id="equations-of-motion">Equations of motion</h3>

<p>Newton's equation of motion for conservative physical systems is</p>

<p>

<math display="block" id="Verlet_integration:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>M</mi>
    <mover accent="true">
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>¨</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo>∇</mo>
      <mi>V</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>M</ci>
      <apply>
       <ci>normal-¨</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>F</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-∇</ci>
        <ci>V</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\ddot{\vec{x}}(t)=F(\vec{x}(t))=-\nabla V(\vec{x}(t))
  </annotation>
 </semantics>
</math>

 or individually</p>

<p>

<math display="block" id="Verlet_integration:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>m</mi>
     <mi>k</mi>
    </msub>
    <msub>
     <mover accent="true">
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mo>¨</mo>
     </mover>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <msub>
       <mo>∇</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>k</mi>
       </msub>
      </msub>
      <mi>V</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¨</ci>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-∇</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <ci>V</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{k}\ddot{\vec{x}}_{k}(t)=F_{k}(\vec{x}(t))=-\nabla_{\vec{x}_{k}}V(\vec{x}(t))
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li><em>t</em> is the time,</li>
<li>

<math display="inline" id="Verlet_integration:9">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>N</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>N</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t)=(\vec{x}_{1}(t),\ldots,\vec{x}_{N}(t))
  </annotation>
 </semantics>
</math>

 is the ensemble of the position vector of <em>N</em> objects,</li>
<li><em>V</em> is the scalar potential function,</li>
<li><em>F</em> is the negative <a href="Potential_gradient" title="wikilink">gradient of the potential</a> giving the ensemble of forces on the particles,</li>
<li><em>M</em> is the <a href="mass_matrix" title="wikilink">mass matrix</a>, typically diagonal with blocks with mass 

<math display="inline" id="Verlet_integration:10">
 <semantics>
  <msub>
   <mi>m</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{k}
  </annotation>
 </semantics>
</math>

 for every particle.</li>
</ul>

<p>This equation, for various choices of the potential function <em>V</em>, can be used to describe the evolution of diverse physical systems, from the motion of <a href="molecular_dynamics" title="wikilink">interacting molecules</a> to the <a href="N-body_problem" title="wikilink">orbit of the planets</a>.</p>

<p>After a transformation to bring the mass to the right side and forgetting the structure of multiple particles, the equation may be simplified to</p>

<p>

<math display="block" id="Verlet_integration:11">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>¨</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¨</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{\vec{x}}(t)=A(\vec{x}(t))
  </annotation>
 </semantics>
</math>

 with some suitable vector valued function <em>A</em> representing the position dependent acceleration. Typically, an initial position 

<math display="inline" id="Verlet_integration:12">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(0)=\vec{x}_{0}
  </annotation>
 </semantics>
</math>

 and an initial velocity 

<math display="inline" id="Verlet_integration:13">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mo>˙</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-˙</ci>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(0)=\dot{\vec{x}}(0)=\vec{v}_{0}
  </annotation>
 </semantics>
</math>


 are also given.</p>
<h3 id="verlet-integration-without-velocities">Verlet integration (without velocities)</h3>

<p>To discretize and numerically solve this <a href="initial_value_problem" title="wikilink">initial value problem</a>, a time step 

<math display="inline" id="Verlet_integration:14">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t>0
  </annotation>
 </semantics>
</math>

 is chosen and the sampling point sequence 

<math display="inline" id="Verlet_integration:15">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{n}=n\Delta t
  </annotation>
 </semantics>
</math>

 considered. The task is to construct a sequence of points 

<math display="inline" id="Verlet_integration:16">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{n}
  </annotation>
 </semantics>
</math>

 that closely follow the points 

<math display="inline" id="Verlet_integration:17">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>t</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t_{n})
  </annotation>
 </semantics>
</math>

 on the trajectory of the exact solution.</p>

<p>Where <a href="Euler's_method" title="wikilink">Euler's method</a> uses the <a href="forward_difference" title="wikilink">forward difference</a> approximation to the first derivative in differential equations of order one, Verlet Integration can be seen as using the <a href="central_difference" title="wikilink">central difference</a> approximation to the second derivative:</p>

<p>

<math display="block" id="Verlet_integration:18">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi mathvariant="normal">Δ</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msub>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mfrac>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>a</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Δ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-→</ci>
           <ci>x</ci>
          </apply>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\Delta^{2}\vec{x}_{n}}{\Delta t^{2}}=\frac{\frac{\vec{x}_{n+1}-\vec{x}_{%
n}}{\Delta t}-\frac{\vec{x}_{n}-\vec{x}_{n-1}}{\Delta t}}{\Delta t}=\frac{\vec%
{x}_{n+1}-2\vec{x}_{n}+\vec{x}_{n-1}}{\Delta t^{2}}=\vec{a}_{n}=A(\vec{x}_{n})
  </annotation>
 </semantics>
</math>

</p>

<p><em>Verlet integration</em> in the form used as the <em>Störmer method</em><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> uses this equation to obtain the next position vector from the previous two without using the velocity as</p>

<p>

<math display="block" id="Verlet_integration:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mrow>
        <mn>2</mn>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mover accent="true">
          <mi>a</mi>
          <mo stretchy="false">→</mo>
         </mover>
         <mi>n</mi>
        </msub>
       </mpadded>
       <mi mathvariant="normal">Δ</mi>
       <msup>
        <mi>t</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>a</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>A</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-→</ci>
          <ci>x</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>a</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{n+1}=2\vec{x}_{n}-\vec{x}_{n-1}+\vec{a}_{n}\,\Delta t^{2},\qquad\vec{%
a}_{n}=A(\vec{x}_{n}).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="discretization-error">Discretization error</h3>

<p>The time symmetry inherent in the method reduces the level of local errors introduced into the integration by the discretization by removing all odd degree terms, here the terms in 

<math display="inline" id="Verlet_integration:20">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 of degree three. The local error is quantified by inserting the exact values 

<math display="inline" id="Verlet_integration:21">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t_{n-1}),\vec{x}(t_{n}),\vec{x}(t_{n+1})
  </annotation>
 </semantics>
</math>

 into the iteration and computing the <a href="Taylor_expansion" title="wikilink">Taylor expansions</a> at time 

<math display="inline" id="Verlet_integration:22">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <msub>
    <mi>t</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=t_{n}
  </annotation>
 </semantics>
</math>

 of the position vector 

<math display="inline" id="Verlet_integration:23">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>±</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t\pm\Delta t)
  </annotation>
 </semantics>
</math>

 in different time directions.</p>

<p>

<math display="inline" id="Verlet_integration:24">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\vec{x}(t+\Delta t)
  </annotation>
 </semantics>
</math>


 where 

<math display="inline" id="Verlet_integration:25">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}
  </annotation>
 </semantics>
</math>

 is the position, 

<math display="inline" id="Verlet_integration:26">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mover accent="true">
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>˙</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <ci>normal-˙</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}=\dot{\vec{x}}
  </annotation>
 </semantics>
</math>


 the velocity, 

<math display="inline" id="Verlet_integration:27">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>a</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mo>=</mo>
   <mover accent="true">
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mo>¨</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-→</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <ci>normal-¨</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}=\ddot{\vec{x}}
  </annotation>
 </semantics>
</math>

 the acceleration and 

<math display="inline" id="Verlet_integration:28">
 <semantics>
  <mover accent="true">
   <mi>b</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{b}
  </annotation>
 </semantics>
</math>

 the <a href="Jerk_(physics)" title="wikilink">jerk</a> (third derivative of the position with respect to the time) 

<math display="inline" id="Verlet_integration:29">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

.</p>

<p>Adding these two expansions gives</p>

<p>

<math display="block" id="Verlet_integration:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <mi>t</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mover accent="true">
       <mi>a</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒪</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <msup>
         <mi>t</mi>
         <mn>4</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>t</ci>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝒪</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)=2\vec{x}(t)-\vec{x}(t-\Delta t)+\vec{a}(t)\Delta t^{2}+%
\mathcal{O}(\Delta t^{4}).\,
  </annotation>
 </semantics>
</math>

 We can see that the first and third-order terms from the Taylor expansion cancel out, thus making the Verlet integrator an order more accurate than integration by simple Taylor expansion alone.</p>

<p>Caution should be applied to the fact that the acceleration here is computed from the exact solution, 

<math display="inline" id="Verlet_integration:31">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>a</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>a</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}(t)=A(\vec{x}(t))
  </annotation>
 </semantics>
</math>


, whereas in the iteration it is computed at the central iteration point, 

<math display="inline" id="Verlet_integration:32">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>a</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>a</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}_{n}=A(\vec{x}_{n})
  </annotation>
 </semantics>
</math>

. In computing the global error, that is the distance between exact solution and approximation sequence, those two terms do not cancel exactly, influencing the order of the global error.</p>
<h3 id="a-simple-example">A simple example</h3>

<p>To gain insight into the relation of local and global errors it is helpful to examine simple examples where the exact as well as the approximative solution can be expressed in explicit formulas. The standard example for this task is the <a href="exponential_function" title="wikilink">exponential function</a>.</p>

<p>Consider the linear differential equation 

<math display="inline" id="Verlet_integration:33">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo>¨</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>w</mi>
     <mn>2</mn>
    </msup>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¨</ci>
      <ci>x</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>x</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{x}(t)=w^{2}x(t)
  </annotation>
 </semantics>
</math>

 with a constant <em>w</em>. Its exact basis solutions are 

<math display="inline" id="Verlet_integration:34">
 <semantics>
  <msup>
   <mi>e</mi>
   <mrow>
    <mi>w</mi>
    <mi>t</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{wt}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Verlet_integration:35">
 <semantics>
  <msup>
   <mi>e</mi>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>w</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>w</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-wt}
  </annotation>
 </semantics>
</math>

.</p>

<p>The Störmer method applied to this differential equation leads to a linear <a href="recurrence_relation" title="wikilink">recurrence relation</a></p>

<p>

<math display="inline" id="Verlet_integration:36">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>+</mo>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle x_{n+1}-2x_{n}+x_{n-1}
  </annotation>
 </semantics>
</math>


 It can be solved by finding the roots of its characteristic polynomial 

<math display="inline" id="Verlet_integration:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>q</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mrow>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>w</mi>
            <mi>h</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>q</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <times></times>
           <ci>w</ci>
           <ci>h</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{2}-2(1+\tfrac{1}{2}(wh)^{2})q+1=0
  </annotation>
 </semantics>
</math>

. These are</p>

<p>

<math display="block" id="Verlet_integration:38">
 <semantics>
  <mrow>
   <msub>
    <mi>q</mi>
    <mo>±</mo>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>w</mi>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>±</mo>
    <mrow>
     <mi>w</mi>
     <mi>h</mi>
     <msqrt>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>4</mn>
         </mfrac>
        </mstyle>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>w</mi>
           <mi>h</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
     </msqrt>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <csymbol cd="latexml">plus-or-minus</csymbol>
    </apply>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <times></times>
         <ci>w</ci>
         <ci>h</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>w</ci>
      <ci>h</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <times></times>
           <ci>w</ci>
           <ci>h</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{\pm}=1+\tfrac{1}{2}(wh)^{2}\pm wh\sqrt{1+\tfrac{1}{4}(wh)^{2}}
  </annotation>
 </semantics>
</math>

. The basis solutions of the linear recurrence are 

<math display="inline" id="Verlet_integration:39">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>q</mi>
    <mo>+</mo>
    <mpadded lspace="2.8pt" width="+2.8pt">
     <mi>n</mi>
    </mpadded>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <plus></plus>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=q_{+}^{\;n}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Verlet_integration:40">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>q</mi>
    <mo>-</mo>
    <mpadded lspace="2.8pt" width="+2.8pt">
     <mi>n</mi>
    </mpadded>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <minus></minus>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=q_{-}^{\;n}
  </annotation>
 </semantics>
</math>

. To compare them with the exact solutions, Taylor expansions are computed.</p>

<p>

<math display="inline" id="Verlet_integration:41">
 <semantics>
  <msub>
   <mi>q</mi>
   <mo>+</mo>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle q_{+}
  </annotation>
 </semantics>
</math>


 The quotient of this series with the one of the exponential 

<math display="inline" id="Verlet_integration:42">
 <semantics>
  <msup>
   <mi>e</mi>
   <mrow>
    <mi>w</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{wh}
  </annotation>
 </semantics>
</math>

 starts with 

<math display="inline" id="Verlet_integration:43">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>24</mn>
     </mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>w</mi>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒪</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>h</mi>
      <mn>5</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">24</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <ci>w</ci>
        <ci>h</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>𝒪</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">5</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\tfrac{1}{24}(wh)^{3}+\mathcal{O}(h^{5})
  </annotation>
 </semantics>
</math>

, so</p>

<p>

<math display="inline" id="Verlet_integration:44">
 <semantics>
  <msub>
   <mi>q</mi>
   <mo>+</mo>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle q_{+}
  </annotation>
 </semantics>
</math>


 From there it follows that for the first basis solution the error can be computed as</p>

<p>

<math display="inline" id="Verlet_integration:45">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>q</mi>
    <mo>+</mo>
    <mpadded lspace="2.8pt" width="+2.8pt">
     <mi>n</mi>
    </mpadded>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>q</ci>
      <plus></plus>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle x_{n}=q_{+}^{\;n}
  </annotation>
 </semantics>
</math>


 That is, although the local discretization error is of order 4, due to the second order of the differential equation the global error is of order 2, with a constant that grows exponentially in time.</p>
<h3 id="starting-the-iteration">Starting the iteration</h3>

<p>Note that at the start of the Verlet-iteration at step 

<math display="inline" id="Verlet_integration:46">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=1
  </annotation>
 </semantics>
</math>

, time 

<math display="inline" id="Verlet_integration:47">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <msub>
    <mi>t</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=t_{1}=\Delta t
  </annotation>
 </semantics>
</math>

, computing 

<math display="inline" id="Verlet_integration:48">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{2}
  </annotation>
 </semantics>
</math>


, one already needs the position vector 

<math display="inline" id="Verlet_integration:49">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{1}
  </annotation>
 </semantics>
</math>

 at time 

<math display="inline" id="Verlet_integration:50">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <msub>
    <mi>t</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=t_{1}
  </annotation>
 </semantics>
</math>

. At first sight this could give problems, because the initial conditions are known only at the initial time 

<math display="inline" id="Verlet_integration:51">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">0</cn>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{0}=0
  </annotation>
 </semantics>
</math>

. However, from these the acceleration 

<math display="inline" id="Verlet_integration:52">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>a</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>a</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}_{0}=A(\vec{x}_{0})
  </annotation>
 </semantics>
</math>

 is known, and a suitable approximation for the first time step position can be obtained using the <a href="Taylor_polynomial" title="wikilink">Taylor polynomial</a> of degree two:</p>

<p>

<math display="block" id="Verlet_integration:53">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mn>1</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>v</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msub>
       <mover accent="true">
        <mi>a</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mn>0</mn>
      </msub>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒪</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <msup>
         <mi>t</mi>
         <mn>3</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>v</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>a</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>𝒪</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{1}=\vec{x}_{0}+\vec{v}_{0}\Delta t+\tfrac{1}{2}\vec{a}_{0}\Delta t^{2%
}\approx\vec{x}(\Delta t)+\mathcal{O}(\Delta t^{3}).\,
  </annotation>
 </semantics>
</math>

</p>

<p>The error on the first time step calculation then is of order 

<math display="inline" id="Verlet_integration:54">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒪</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>3</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒪</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(\Delta t^{3})
  </annotation>
 </semantics>
</math>

. This is not considered a problem because on a simulation of over a large amount of timesteps, the error on the first timestep is only a negligibly small amount of the total error, which at time 

<math display="inline" id="Verlet_integration:55">
 <semantics>
  <msub>
   <mi>t</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{n}
  </annotation>
 </semantics>
</math>

 is of the order 

<math display="inline" id="Verlet_integration:56">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒪</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>L</mi>
       <msub>
        <mi>t</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </msup>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒪</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>L</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(e^{Lt_{n}}\Delta t^{2})
  </annotation>
 </semantics>
</math>

, both for the distance of the position vectors 

<math display="inline" id="Verlet_integration:57">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{n}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Verlet_integration:58">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>t</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t_{n})
  </annotation>
 </semantics>
</math>

 as for the distance of the divided differences 

<math display="inline" id="Verlet_integration:59">
 <semantics>
  <mfrac>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>-</mo>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>n</mi>
    </msub>
   </mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{\vec{x}_{n+1}-\vec{x}_{n}}{\Delta t}
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Verlet_integration:60">
 <semantics>
  <mfrac>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>t</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tfrac{\vec{x}(t_{n+1})-\vec{x}(t_{n})}{\Delta t}
  </annotation>
 </semantics>
</math>

. Moreover, to obtain this second order global error, the initial error needs to be of at least third order.</p>
<h3 id="non-constant-time-differences">Non-constant time differences</h3>

<p>A disadvantage of the Störmer–Verlet method is that if the time-step (

<math display="inline" id="Verlet_integration:61">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

) changes, the method does not approximate the solution to the differential equation. This is particularly an issue for game designers, who may be integrating at a variable framerate.</p>

<p>This can be corrected using the formula:<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Verlet_integration:62">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <msub>
          <mi>t</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>/</mo>
        <mi mathvariant="normal">Δ</mi>
       </mrow>
       <msub>
        <mi>t</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi mathvariant="normal">Δ</mi>
     <msubsup>
      <mi>t</mi>
      <mi>i</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <ci>normal-Δ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{i+1}=\vec{x}_{i}+(\vec{x}_{i}-\vec{x}_{i-1})(\Delta t_{i}/\Delta t_{i%
-1})+\vec{a}\Delta t_{i}^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>A more exact derivation uses the Taylor series (to second order) at 

<math display="inline" id="Verlet_integration:63">
 <semantics>
  <msub>
   <mi>t</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{i}
  </annotation>
 </semantics>
</math>

 for times 

<math display="inline" id="Verlet_integration:64">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>t</mi>
     <mi>i</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>t</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{i+1}=t_{i}+\Delta t_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Verlet_integration:65">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mrow>
     <mi>i</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>t</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>t</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <minus></minus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{i-1}=t_{i}-\Delta t_{i-1}
  </annotation>
 </semantics>
</math>

 to obtain after elimination of 

<math display="inline" id="Verlet_integration:66">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:67">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mi>i</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msub>
       <mi>t</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msub>
       <mi>t</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mover accent="true">
       <mi>a</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>i</mi>
     </msub>
    </mpadded>
    <mfrac>
     <mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <msub>
        <mi>t</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <msub>
        <mi>t</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mn>2</mn>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\vec{x}_{i+1}-\vec{x}_{i}}{\Delta t_{i}}+\frac{\vec{x}_{i-1}-\vec{x}_{i}%
}{\Delta t_{i-1}}=\vec{a}_{i}\,\frac{\Delta t_{i}+\Delta t_{i-1}}{2}
  </annotation>
 </semantics>
</math>

 so that the iteration formula becomes</p>

<p>

<math display="block" id="Verlet_integration:68">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mfrac>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <msub>
        <mi>t</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <msub>
        <mi>t</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mover accent="true">
        <mi>a</mi>
        <mo stretchy="false">→</mo>
       </mover>
       <mi>i</mi>
      </msub>
     </mpadded>
     <mpadded width="+1.7pt">
      <mfrac>
       <mrow>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <msub>
          <mi>t</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <msub>
          <mi>t</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mn>2</mn>
      </mfrac>
     </mpadded>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>t</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>a</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <apply>
           <minus></minus>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}_{i+1}=\vec{x}_{i}+(\vec{x}_{i}-\vec{x}_{i-1})\frac{\Delta t_{i}}{%
\Delta t_{i-1}}+\vec{a}_{i}\,\frac{\Delta t_{i}+\Delta t_{i-1}}{2}\,\Delta t_{i}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="computing-velocities-störmerverlet-method">Computing velocities – Störmer–Verlet method</h3>

<p>The velocities are not explicitly given in the basic Störmer equation, but often they are necessary for the calculation of certain physical quantities like the kinetic energy. This can create technical challenges in <a href="molecular_dynamics" title="wikilink">molecular dynamics</a> simulations, because kinetic energy and instantaneous temperatures at time 

<math display="inline" id="Verlet_integration:69">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 cannot be calculated for a system until the positions are known at time 

<math display="inline" id="Verlet_integration:70">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>+</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>t</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t+\Delta t
  </annotation>
 </semantics>
</math>

. This deficiency can either be dealt with using the Velocity Verlet algorithm, or estimating the velocity using the position terms and the <a href="mean_value_theorem" title="wikilink">mean value theorem</a>:</p>

<p>

<math display="block" id="Verlet_integration:71">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒪</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <msup>
         <mi>t</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝒪</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t)=\frac{\vec{x}(t+\Delta t)-\vec{x}(t-\Delta t)}{2\Delta t}+\mathcal{%
O}(\Delta t^{2}).
  </annotation>
 </semantics>
</math>

</p>

<p>Note that this velocity term is a step behind the position term, since this is for the velocity at time 

<math display="inline" id="Verlet_integration:72">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

, not 

<math display="inline" id="Verlet_integration:73">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>+</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>t</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t+\Delta t
  </annotation>
 </semantics>
</math>

, meaning that 

<math display="inline" id="Verlet_integration:74">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <mn>2</mn>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{n}=\tfrac{\vec{x}_{n+1}-\vec{x}_{n-1}}{2\Delta t}
  </annotation>
 </semantics>
</math>

 is an order two approximation to 

<math display="inline" id="Verlet_integration:75">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>t</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t_{n})
  </annotation>
 </semantics>
</math>

. With the same argument, but halving the time step, 

<math display="inline" id="Verlet_integration:76">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mi>n</mi>
     </msub>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-→</ci>
        <ci>x</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}_{n+1/2}=\tfrac{\vec{x}_{n+1}-\vec{x}_{n}}{\Delta t}
  </annotation>
 </semantics>
</math>

 is an order two approximation to 

<math display="inline" id="Verlet_integration:77">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>t</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t_{n+1/2})
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Verlet_integration:78">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>t</mi>
     <mi>n</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{n+1/2}=t_{n}+\tfrac{1}{2}\Delta t
  </annotation>
 </semantics>
</math>

.</p>

<p>One can shorten the interval to approximate the velocity at time 

<math display="inline" id="Verlet_integration:79">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>+</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>t</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t+\Delta t
  </annotation>
 </semantics>
</math>

 at the cost of accuracy:</p>

<p>

<math display="block" id="Verlet_integration:80">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒪</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>x</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝒪</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t+\Delta t)=\frac{\vec{x}(t+\Delta t)-\vec{x}(t)}{\Delta t}+\mathcal{O%
}(\Delta t).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="velocity-verlet">Velocity Verlet</h2>

<p>A related, and more commonly used, algorithm is the <strong>Velocity Verlet</strong> algorithm,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> similar to the <a href="leapfrog_method" title="wikilink">leapfrog method</a>, except that the velocity and position are calculated at the same value of the time variable (Leapfrog does not, as the name suggests). This uses a similar approach but explicitly incorporates velocity, solving the first-timestep problem in the Basic Verlet algorithm:</p>

<p>

<math display="block" id="Verlet_integration:81">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mpadded>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <msup>
       <mi>t</mi>
       <mn>2</mn>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <ci>t</ci>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>t</ci>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)=\vec{x}(t)+\vec{v}(t)\,\Delta t+\frac{1}{2}\,\vec{a}(t)%
\Delta t^{2}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:82">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>a</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mover accent="true">
         <mi>a</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <ci>normal-→</ci>
          <ci>a</ci>
         </apply>
         <ci>t</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <ci>normal-→</ci>
          <ci>a</ci>
         </apply>
         <apply>
          <plus></plus>
          <ci>t</ci>
          <apply>
           <times></times>
           <ci>normal-Δ</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t+\Delta t)=\vec{v}(t)+\frac{\vec{a}(t)+\vec{a}(t+\Delta t)}{2}\Delta t\,
  </annotation>
 </semantics>
</math>

</p>

<p>It can be shown that the error on the Velocity Verlet is of the same order as the Basic Verlet. Note that the Velocity algorithm is not necessarily more memory consuming, because it's not necessary to keep track of the velocity at every timestep during the simulation. The standard implementation scheme of this algorithm is:</p>
<ol>
<li>Calculate

<math display="block" id="Verlet_integration:83">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
       </mpadded>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
     </mpadded>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>t</ci>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}\left(t+\tfrac{1}{2}\,\Delta t\right)=\vec{v}(t)+\tfrac{1}{2}\,\vec{a}(%
t)\,\Delta t\,
  </annotation>
 </semantics>
</math>

</li>
<li>Calculate

<math display="block" id="Verlet_integration:84">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mstyle displaystyle="false">
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mstyle>
        </mpadded>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo rspace="4.2pt">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)=\vec{x}(t)+\vec{v}\left(t+\tfrac{1}{2}\,\Delta t\right)\,%
\Delta t\,
  </annotation>
 </semantics>
</math>

</li>
<li>Derive 

<math display="inline" id="Verlet_integration:85">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>a</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}(t+\Delta t)
  </annotation>
 </semantics>
</math>

 from the interaction potential using 

<math display="inline" id="Verlet_integration:86">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)
  </annotation>
 </semantics>
</math>

</li>
<li>Calculate

<math display="block" id="Verlet_integration:87">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mover accent="true">
       <mi>v</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>t</mi>
        <mo>+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mstyle displaystyle="false">
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
          </mstyle>
         </mpadded>
         <mi mathvariant="normal">Δ</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mstyle displaystyle="false">
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mstyle>
      </mpadded>
      <mover accent="true">
       <mi>a</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>t</mi>
        <mo>+</mo>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t+\Delta t)=\vec{v}\left(t+\tfrac{1}{2}\,\Delta t\right)+\tfrac{1}{2}%
\,\vec{a}(t+\Delta t)\Delta t,
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>Eliminating the half-step velocity, this algorithm may be shortened to</p>
<ol>
<li>Calculate

<math display="block" id="Verlet_integration:88">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
     </mpadded>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <ci>t</ci>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>a</ci>
      </apply>
      <ci>t</ci>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)=\vec{x}(t)+\vec{v}(t)\,\Delta t+\tfrac{1}{2}\,\vec{a}(t)\,%
\Delta t^{2}
  </annotation>
 </semantics>
</math>

</li>
<li>Derive 

<math display="inline" id="Verlet_integration:89">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>a</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}(t+\Delta t)
  </annotation>
 </semantics>
</math>

 from the interaction potential using 

<math display="inline" id="Verlet_integration:90">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)
  </annotation>
 </semantics>
</math>

</li>
<li>Calculate

<math display="block" id="Verlet_integration:91">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>v</mi>
     <mo stretchy="false">→</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>v</mi>
      <mo stretchy="false">→</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
     </mpadded>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mover accent="true">
         <mi>a</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mover accent="true">
         <mi>a</mi>
         <mo stretchy="false">→</mo>
        </mover>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>t</mi>
          <mo>+</mo>
          <mrow>
           <mi mathvariant="normal">Δ</mi>
           <mi>t</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+1.7pt">
      <mi>t</mi>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-→</ci>
      <ci>v</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <ci>normal-→</ci>
       <ci>v</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>a</ci>
        </apply>
        <ci>t</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-→</ci>
         <ci>a</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>t</ci>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t+\Delta t)=\vec{v}(t)+\tfrac{1}{2}\,\left(\vec{a}(t)+\vec{a}(t+\Delta
t%
)\right)\Delta t\,
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p>Note, however, that this algorithm assumes that acceleration 

<math display="inline" id="Verlet_integration:92">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>a</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{a}(t+\Delta t)
  </annotation>
 </semantics>
</math>

 only depends on position 

<math display="inline" id="Verlet_integration:93">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(t+\Delta t)
  </annotation>
 </semantics>
</math>

, and does not depend on velocity 

<math display="inline" id="Verlet_integration:94">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>v</mi>
    <mo stretchy="false">→</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-→</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{v}(t+\Delta t)
  </annotation>
 </semantics>
</math>

.</p>

<p>One might note that the long-term results of <strong>Velocity Verlet</strong>, and similarly of <strong>Leapfrog</strong> are one order better than the <a href="semi-implicit_Euler_method" title="wikilink">semi-implicit Euler method</a>. The algorithms are almost identical up to a shifted by half of a timestep in the velocity. This is easily proven by rotating the above loop to start at Step 3 and then noticing that the acceleration term in Step 1 could be eliminated by combining Steps 2 and 4. The only difference is that the midpoint velocity in <strong>velocity Verlet</strong> is considered the final velocity in semi-implicit Euler method.</p>

<p>The global error of all Euler methods is of order one, whereas the global error of this method is, similar to the <a href="midpoint_method" title="wikilink">midpoint method</a>, of order two. Additionally, if the acceleration indeed results from the forces in a conservative mechanical or <a href="Hamiltonian_system" title="wikilink">Hamiltonian system</a>, the energy of the approximation essentially oscillates around the constant energy of the exactly solved system, with a global error bound again of order one for semi-explicit Euler and order two for Verlet-leapfrog. The same goes for all other conservered quantities of the system like linear or angular momentum, that are always preserved or nearly preserved in a <a href="symplectic_integrator" title="wikilink">symplectic integrator</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>The Velocity Verlet method is a special case of the <a href="Newmark-beta_method" title="wikilink">Newmark-beta method</a> with 

<math display="inline" id="Verlet_integration:95">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>β</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta=0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Verlet_integration:96">
 <semantics>
  <mrow>
   <mi>γ</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>γ</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma=1/2
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="error-terms">Error terms</h2>

<p>The local error in position of the Verlet integrator is 

<math display="inline" id="Verlet_integration:97">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>4</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

 as described above, and the local error in velocity is 

<math display="inline" id="Verlet_integration:98">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\Delta t^{2})
  </annotation>
 </semantics>
</math>

.</p>

<p>The global error in position, in contrast, is 

<math display="inline" id="Verlet_integration:99">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\Delta t^{2})
  </annotation>
 </semantics>
</math>

 and the global error in velocity is 

<math display="inline" id="Verlet_integration:100">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\Delta t^{2})
  </annotation>
 </semantics>
</math>

. These can be derived by noting the following:</p>

<p>

<math display="block" id="Verlet_integration:101">
 <semantics>
  <mrow>
   <mrow>
    <mi>error</mi>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo>+</mo>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>error</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+\Delta t)\bigr)=O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Verlet_integration:102">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo>+</mo>
        <mrow>
         <mi mathvariant="normal">Δ</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
     <msup>
      <mi>x</mi>
      <mi>′′</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mn>0</mn>
       </msub>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <msup>
        <mi>t</mi>
        <mn>4</mn>
       </msup>
      </mrow>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>x</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <ci>normal-Δ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>′′</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(t_{0}+2\Delta t)=2x(t_{0}+\Delta t)-x(t_{0})+\Delta t^{2}x^{\prime\prime}(t_%
{0}+\Delta t)+O(\Delta t^{4})\,
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore:</p>

<p>

<math display="block" id="Verlet_integration:103">
 <semantics>
  <mrow>
   <mrow>
    <mi>error</mi>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <mi mathvariant="normal">Δ</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi mathvariant="normal">e</mi>
     <mi mathvariant="normal">r</mi>
     <mi mathvariant="normal">r</mi>
     <mi mathvariant="normal">o</mi>
     <mi mathvariant="normal">r</mi>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mrow>
       <mi>x</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>t</mi>
          <mn>0</mn>
         </msub>
         <mo>+</mo>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <mi>t</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <msup>
        <mi>t</mi>
        <mn>4</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mn>3</mn>
    </mpadded>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>error</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>normal-Δ</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>normal-e</ci>
       <ci>normal-r</ci>
       <ci>normal-r</ci>
       <ci>normal-o</ci>
       <ci>normal-r</ci>
       <apply>
        <times></times>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>O</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>O</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+2\Delta t)\bigr)=2\mathrm{error}\bigl(x(t_{0}+%
\Delta t)\bigr)+O(\Delta t^{4})=3\,O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>Similarly:</p>

<p>

<math display="block" id="Verlet_integration:104">
 <semantics>
  <mrow>
   <mi>error</mi>
   <mrow>
    <mo maxsize="120%" minsize="120%">(</mo>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mn>3</mn>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
     <mo>=</mo>
     <mpadded width="+1.7pt">
      <mn>6</mn>
     </mpadded>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">error</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
      <plus></plus>
      <cn type="integer">3</cn>
      <csymbol cd="unknown">Δ</csymbol>
      <csymbol cd="unknown">t</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-)</ci>
      <eq></eq>
      <cn type="integer">6</cn>
      <csymbol cd="unknown">O</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Δ</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+3\Delta t)\bigl)=6\,O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:105">
 <semantics>
  <mrow>
   <mi>error</mi>
   <mrow>
    <mo maxsize="120%" minsize="120%">(</mo>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mn>4</mn>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
     <mo>=</mo>
     <mpadded width="+1.7pt">
      <mn>10</mn>
     </mpadded>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">error</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
      <plus></plus>
      <cn type="integer">4</cn>
      <csymbol cd="unknown">Δ</csymbol>
      <csymbol cd="unknown">t</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-)</ci>
      <eq></eq>
      <cn type="integer">10</cn>
      <csymbol cd="unknown">O</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Δ</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+4\Delta t)\bigl)=10\,O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:106">
 <semantics>
  <mrow>
   <mi>error</mi>
   <mrow>
    <mo maxsize="120%" minsize="120%">(</mo>
    <mi>x</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>t</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mn>5</mn>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
     <mo>=</mo>
     <mpadded width="+1.7pt">
      <mn>15</mn>
     </mpadded>
     <mi>O</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">error</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">x</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
      <plus></plus>
      <cn type="integer">5</cn>
      <csymbol cd="unknown">Δ</csymbol>
      <csymbol cd="unknown">t</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-)</ci>
      <eq></eq>
      <cn type="integer">15</cn>
      <csymbol cd="unknown">O</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Δ</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>t</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+5\Delta t)\bigl)=15\,O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>Which can be generalized to (it can be shown by induction, but it is given here without proof):</p>

<p>

<math display="block" id="Verlet_integration:107">
 <semantics>
  <mrow>
   <mrow>
    <mi>error</mi>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo>+</mo>
        <mrow>
         <mi>n</mi>
         <mi mathvariant="normal">Δ</mi>
         <mi>t</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mn>2</mn>
     </mfrac>
    </mpadded>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>error</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>O</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+n\Delta t)\bigr)=\frac{n(n+1)}{2}\,O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>If we consider the global error in position between 

<math display="inline" id="Verlet_integration:108">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(t)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Verlet_integration:109">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mi>T</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <ci>t</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(t+T)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Verlet_integration:110">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=n\Delta t
  </annotation>
 </semantics>
</math>

, it is clear that:</p>

<p>

<math display="block" id="Verlet_integration:111">
 <semantics>
  <mrow>
   <mrow>
    <mi>error</mi>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>0</mn>
        </msub>
        <mo>+</mo>
        <mi>T</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <msup>
        <mi>T</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>2</mn>
        <mi mathvariant="normal">Δ</mi>
        <msup>
         <mi>t</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <mi>T</mi>
       <mrow>
        <mn>2</mn>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <msup>
       <mi>t</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>error</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>T</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>T</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <ci>O</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigl(x(t_{0}+T)\bigr)=\left(\frac{T^{2}}{2\Delta t^{2}}+\frac{T%
}{2\Delta t}\right)O(\Delta t^{4})
  </annotation>
 </semantics>
</math>

</p>

<p>And therefore, the global (cumulative) error over a constant interval of time is given by:</p>

<p>

<math display="block" id="Verlet_integration:112">
 <semantics>
  <mrow>
   <mi>error</mi>
   <mo maxsize="120%" minsize="120%">(</mo>
   <mi>x</mi>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>t</mi>
    <mn>0</mn>
   </msub>
   <mo>+</mo>
   <mi>T</mi>
   <mo stretchy="false">)</mo>
   <mo maxsize="120%" minsize="120%">)</mo>
   <mo>=</mo>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Δ</mi>
    <msup>
     <mi>t</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">error</csymbol>
    <ci>normal-(</ci>
    <csymbol cd="unknown">x</csymbol>
    <ci>normal-(</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">0</cn>
    </apply>
    <plus></plus>
    <csymbol cd="unknown">T</csymbol>
    <ci>normal-)</ci>
    <ci>normal-)</ci>
    <eq></eq>
    <csymbol cd="unknown">O</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Δ</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{error}\bigr(x(t_{0}+T)\bigl)=O(\Delta t^{2})
  </annotation>
 </semantics>
</math>

</p>

<p>Because the velocity is determined in a non-cumulative way from the positions in the Verlet integrator, the global error in velocity is also 

<math display="inline" id="Verlet_integration:113">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(\Delta t^{2})
  </annotation>
 </semantics>
</math>

.</p>

<p>In molecular dynamics simulations, the global error is typically far more important than the local error, and the Verlet integrator is therefore known as a second-order integrator.</p>
<h2 id="constraints">Constraints</h2>

<p>The most notable thing that is now easier due to using Verlet integration rather than Eulerian is that constraints between particles are very easy to do. A constraint is a connection between multiple points that limits them in some way, perhaps setting them at a specific distance or keeping them apart, or making sure they are closer than a specific distance. Often physics systems use springs between the points in order to keep them in the locations they are supposed to be. However, using springs of infinite stiffness between two points usually gives the best results coupled with the verlet algorithm. Here's how:</p>

<p>

<math display="block" id="Verlet_integration:114">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>-</mo>
    <mpadded width="+1.7pt">
     <msubsup>
      <mi>x</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{1}=x_{2}^{(t)}-x_{1}^{(t)}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:115">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>∥</mo>
    <msub>
     <mi>d</mi>
     <mn>1</mn>
    </msub>
    <mo rspace="4.2pt">∥</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{2}=\|d_{1}\|\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:116">
 <semantics>
  <mrow>
   <msub>
    <mi>d</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <msub>
       <mi>d</mi>
       <mn>2</mn>
      </msub>
      <mo>-</mo>
      <mi>r</mi>
     </mrow>
     <msub>
      <mi>d</mi>
      <mn>2</mn>
     </msub>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>d</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{3}=\frac{d_{2}-r}{d_{2}}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:117">
 <semantics>
  <mrow>
   <msubsup>
    <mi>x</mi>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mn>1</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>d</mi>
       <mn>3</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}^{(t+\Delta t)}=\tilde{x}_{1}^{(t+\Delta t)}+\frac{1}{2}d_{1}d_{3}\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Verlet_integration:118">
 <semantics>
  <mrow>
   <msubsup>
    <mi>x</mi>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <mpadded width="+1.7pt">
      <msub>
       <mi>d</mi>
       <mn>3</mn>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-~</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}^{(t+\Delta t)}=\tilde{x}_{2}^{(t+\Delta t)}-\frac{1}{2}d_{1}d_{3}\,
  </annotation>
 </semantics>
</math>

</p>

<p>The 

<math display="inline" id="Verlet_integration:119">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mi>i</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}^{(t)}
  </annotation>
 </semantics>
</math>

 variables are the positions of the points <em>i</em> at time <em>t</em>, the 

<math display="inline" id="Verlet_integration:120">
 <semantics>
  <msubsup>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mi>i</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-~</ci>
      <ci>x</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{x}_{i}^{(t)}
  </annotation>
 </semantics>
</math>

 are the <em>unconstrained</em> positions (<em>i.e.</em> the point positions before applying the constraints) of the points <em>i</em> at time <em>t</em>, the d variables are temporary (they are added for <a href="wiktionary:optimize" title="wikilink">optimization</a> as the results of their expressions are needed multiple times), and <em>r</em> is the distance that is supposed to be between the two points. Currently this is in one dimension; however, it is easily expanded to two or three. Simply find the delta (first equation) of each dimension, and then add the deltas squared to the inside of the square root of the second equation (<a href="Pythagorean_theorem" title="wikilink">Pythagorean theorem</a>). Then, duplicate the last two equations for the number of dimensions there are. This is where verlet makes constraints simple – instead of say, applying a velocity to the points that would eventually satisfy the constraint, you can simply position the point where it should be and the verlet integrator takes care of the rest.</p>

<p>Problems, however, arise when multiple constraints position a vertex. One way to solve this is to loop through all the vertices in a simulation in a criss cross manner, so that at every vertex the constraint relaxation of the last vertex is already used to speed up the spread of the information. Either use fine time steps for the simulation, use a fixed number of constraint solving steps per time step, or solve constraints until they are met by a specific deviation.</p>

<p>When approximating the constraints locally to first order this is the same as the <a href="Gauss–Seidel_method" title="wikilink">Gauss–Seidel method</a>. For small <a href="Matrix_(mathematics)" title="wikilink">matrices</a> it is known that <a href="LU_decomposition" title="wikilink">LU decomposition</a> is faster. Large systems can be divided into clusters (for example: each <a href="ragdoll_physics" title="wikilink">ragdoll</a> = cluster). Inside clusters the LU method is used, between clusters the <a href="Gauss–Seidel_method" title="wikilink">Gauss–Seidel method</a> is used. The matrix code can be reused: The dependency of the forces on the positions can be approximated locally to first order, and the verlet integration can be made more implicit.</p>

<p>For big matrices sophisticated solvers (look especially for "The sizes of these small dense matrices can be tuned to match the sweet spot" in <a href="http://crd.lbl.gov/~xiaoye/SuperLU/superlu_ug.pdf">1</a>) for sparse matrices exist, any self made Verlet integration has to compete with these. The usage of (clusters of) matrices is not generally more precise or stable, but addresses the specific problem, that a force on one vertex of a sheet of cloth should reach any other vertex in a low number of time steps even if a fine grid is used for the cloth <a href="http://www.cs.cmu.edu/~baraff/papers/index.html">2</a> (link needs refinement) and not form a <a href="sound_wave" title="wikilink">sound wave</a>.</p>

<p>Another way to solve <a href="holonomic_constraints" title="wikilink">holonomic constraints</a> is to use <a href="constraint_algorithm" title="wikilink">constraint algorithms</a>.</p>
<h2 id="collision-reactions">Collision reactions</h2>

<p>One way of reacting to collisions is to use a penalty-based system which basically applies a set force to a point upon contact. The problem with this is that it is very difficult to choose the force imparted. Use too strong a force and objects will become unstable, too weak and the objects will penetrate each other. Another way is to use projection collision reactions which takes the offending point and attempts to move it the shortest distance possible to move it out of the other object.</p>

<p>The Verlet integration would automatically handle the velocity imparted via the collision in the latter case, however note that this is not guaranteed to do so in a way that is consistent with <a href="collision" title="wikilink">collision physics</a> (that is, changes in momentum are not guaranteed to be realistic). Instead of implicitly changing the velocity term, one would need to explicitly control the final velocities of the objects colliding (by changing the recorded position from the previous time step).</p>

<p>The two simplest methods for deciding on a new velocity are perfectly <a href="elastic_collision" title="wikilink">elastic collisions</a> and <a href="inelastic_collision" title="wikilink">inelastic collisions</a>. A slightly more complicated strategy that offers more control would involve using the <a href="coefficient_of_restitution" title="wikilink">coefficient of restitution</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Courant–Friedrichs–Lewy_condition" title="wikilink">Courant–Friedrichs–Lewy condition</a></li>
<li><a href="Energy_drift" title="wikilink">Energy drift</a></li>
<li><a href="Symplectic_integrator" title="wikilink">Symplectic integrator</a></li>
<li><a href="Leapfrog_integration" title="wikilink">Leapfrog integration</a></li>
<li><a href="Beeman's_algorithm" title="wikilink">Beeman's algorithm</a></li>
</ul>
<h2 id="literature">Literature</h2>
<references>

<p><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> <a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://verlet.googlecode.com/">Verlet Integration Demo and Code as a Java Applet</a></li>
<li><a href="http://www.gamasutra.com/resource_guide/20030121/jacobson_pfv.htm">Advanced Character Physics by Thomas Jakobsen</a></li>
<li><a href="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html">The Verlet algorithm</a></li>
<li><a href="http://www.ch.embnet.org/MD_tutorial/pages/MD.Part1.html">Theory of Molecular Dynamics Simulations</a> – bottom of page</li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_differential_equations" title="wikilink">Category:Numerical differential equations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html">webpage</a> with a description of the Störmer method<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

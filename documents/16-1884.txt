   IQ imbalance      IQ imbalance   IQ imbalance is a performance-limiting issue in the design of direct conversion receivers , also known as zero intermediate frequency (IF) or homodyne receivers. Such a design translates the received radio frequency (RF, or passband ) signal directly from the carrier frequency (fc) to baseband using only one mixing stage. The traditional heterodyne receiver structure needs an IF stage between the RF and baseband signals. The direct conversion receiver structure has several advantages, like no IF stage, no image rejection filter, and easy integration due to low component count. However, a direction conversion RF front-end suffers from two major drawbacks, one is IQ imbalance and the other is DC offset . When designing a homodyne receiver, control of IQ imbalance is necessary to limit signal demodulation error.  IQ imbalances occur due to mismatches between the parallel sections of the receiver chain dealing with the in-phase (I) and quadrature (Q) signal paths. The LO generates and then delayed by 90 degrees. When mixed with the original signal, this produces the I signal whereas the Q signal is generated by mixing with the LO that is delayed by 90 degrees. In the analog domain, the delay is never exactly 90 degrees. Similarly, analog gain is never perfectly matched for each of the signal paths.  Definition  A direct conversion receiver uses two quadrature sinusoidal  signals to perform the so-called quadrature  down conversion . This process requires shifting the local oscillator (LO) signal by 90 degrees to produce a quadrature sinusoidal component. When mismatches exist between the gain and phase of the two sinusoidal signals and/or along the two branches of down-conversion mixers, amplifiers, and low-pass filters, the quadrature baseband signals will be corrupted.  Suppose the received passband signal is identical to the transmitted signal and is given by        y   (  t  )    =   R  e   {   x   (  t  )    e   j  2  œÄ   f  c   t     }    =     x  I    (  t  )    cos   (   2  œÄ   f  c   t   )     -    x  Q    (  t  )    sin   (   2  œÄ   f  c   t   )         w  h  e  r   e   x   (  t  )    =     x  I    (  t  )    +   j   x  Q    (  t  )   i   s   t  h   e   t  r  a  n  s  m  i  t  t  e   d   b  a  s  e  b  a  n   d   s  i  g  n  a  l        formulae-sequence        y  t     R  e     x  t   superscript  e    j  2  œÄ   subscript  f  c   t                 subscript  x  I   t      2  œÄ   subscript  f  c   t        subscript  x  Q   t      2  œÄ   subscript  f  c   t            w  h  e  r  e  x  t        subscript  x  I   t     j   subscript  x  Q   t  i  s  t  h  e  t  r  a  n  s  m  i  t  t  e  d  b  a  s  e  b  a  n  d  s  i  g  n  a  l       y(t)=Re\{x(t)e^{j2\pi f_{c}t}\}=x_{I}(t)\cos(2\pi f_{c}t)-x_{Q}(t)\sin(2\pi f_%
 {c}t)\ \ \ \ \ where\ x(t)=x_{I}(t)+jx_{Q}(t)\ is\ the\ transmitted\ baseband%
 \ signal     Assume that the gain error is    20   log   [    (   1  +   œµ  A    )   /   (   1  -   œµ  A    )    ]        20        1   subscript  œµ  A      1   subscript  œµ  A        20\log[(1+\epsilon_{A})/(1-\epsilon_{A})]    dB and the phase error is    Œµ  Œ∏     subscript  Œµ  Œ∏    \varepsilon_{\theta}   degrees. Then we can model such imbalance using mismatched local oscillator output signals.       2   (   1  +   œµ  A    )    cos   (    2  œÄ   f  c   t   -    Œµ  Œ∏   /  2    )     ,      2    1   subscript  œµ  A          2  œÄ   subscript  f  c   t      subscript  Œµ  Œ∏   2       2(1+\epsilon_{A})\cos(2\pi f_{c}t-\varepsilon_{\theta}/2),        -   2   (   1  -   œµ  A    )    cos   (    2  œÄ   f  c   t   +    Œµ  Œ∏   /  2    )      .        2    1   subscript  œµ  A          2  œÄ   subscript  f  c   t      subscript  Œµ  Œ∏   2        -2(1-\epsilon_{A})\cos(2\pi f_{c}t+\varepsilon_{\theta}/2).     Multiplying the passband signal by the two LO signals and passing through a pair of low-pass filters , one obtains the demodulated baseband signals as         x  I    (  t  )    =    (   1  +   Œµ  A    )    [     x  I    (  t  )    cos   (    Œµ  Œ∏   /  2   )     -    x  Q    (  t  )    sin   (    Œµ  Œ∏   /  2   )      ]     ,         subscript  x  I   t       1   subscript  Œµ  A     delimited-[]       subscript  x  I   t       subscript  Œµ  Œ∏   2        subscript  x  Q   t       subscript  Œµ  Œ∏   2          x_{I}(t)=(1+\varepsilon_{A})[x_{I}(t)\cos(\varepsilon_{\theta}/2)-x_{Q}(t)\sin%
 (\varepsilon_{\theta}/2)],          x  Q    (  t  )    =    (   1  -   Œµ  A    )    [     x  Q    (  t  )    cos   (    Œµ  Œ∏   /  2   )     -    x  I    (  t  )    sin   (    Œµ  Œ∏   /  2   )      ]     .         subscript  x  Q   t       1   subscript  Œµ  A     delimited-[]       subscript  x  Q   t       subscript  Œµ  Œ∏   2        subscript  x  I   t       subscript  Œµ  Œ∏   2          x_{Q}(t)=(1-\varepsilon_{A})[x_{Q}(t)\cos(\varepsilon_{\theta}/2)-x_{I}(t)\sin%
 (\varepsilon_{\theta}/2)].     The above equations clearly indicate that IQ imbalance causes interference between the I and Q baseband signals.  To analyze IQ imbalance in the frequency domain, above equation can be rewritten as       x   (  t  )    =     x  I    (  t  )    +   j   x  Q    (  t  )     =     [    cos   (    Œµ  Œ∏   /  2   )    +   j   Œµ  A    sin   (    Œµ  Œ∏   /  2   )      ]   x   (  t  )    +    [     Œµ  A    cos   (    Œµ  Œ∏   /  2   )     -   j   Œµ  A    sin   (    Œµ  Œ∏   /  2   )      ]    x  *    (  t  )     =     Œ∑  Œ±   x   (  t  )    +    Œ∑  Œ≤    x  *    (  t  )             x  t        subscript  x  I   t     j   subscript  x  Q   t              delimited-[]         subscript  Œµ  Œ∏   2      j   subscript  Œµ  A        subscript  Œµ  Œ∏   2       x  t      delimited-[]       subscript  Œµ  A        subscript  Œµ  Œ∏   2       j   subscript  Œµ  A        subscript  Œµ  Œ∏   2        superscript  x    t              subscript  Œ∑  Œ±   x  t      subscript  Œ∑  Œ≤    superscript  x    t       x(t)=x_{I}(t)+jx_{Q}(t)=[\cos(\varepsilon_{\theta}/2)+j\varepsilon_{A}\sin(%
 \varepsilon_{\theta}/2)]x(t)+[\varepsilon_{A}\cos(\varepsilon_{\theta}/2)-j%
 \varepsilon_{A}\sin(\varepsilon_{\theta}/2)]x^{*}(t)=\eta_{\alpha}x(t)+\eta_{%
 \beta}x^{*}(t)     where     (  .  )   *     superscript   fragments  normal-(  normal-.  normal-)      (.)^{*}   denotes the complex conjugate . In an OFDM system, the baseband signal consists of several subcarriers . Complex-conjugating the baseband signal of the kth subcarrier carrying data    X  k     subscript  X  k    X_{k}   is identical to carrying    X  k  *     subscript   superscript  X    k    X^{*}_{k}   on the (-k)th subcarrier :        (    (   X   k  ,   I  +   j   X   k  ,  Q        )    e   j  2  œÄ  k   f  S   t     )   *   =    (    X   k  ,  I    -   j   X   k  ,  Q      )    e   -   j  2  œÄ  k   f  S   t      =    X  k  *    e   j  2  œÄ   (   -  k   )    f  S   t            superscript     subscript  X   k    I    j   subscript  X   k  Q         superscript  e    j  2  œÄ  k   subscript  f  S   t            subscript  X   k  I      j   subscript  X   k  Q       superscript  e      j  2  œÄ  k   subscript  f  S   t              subscript   superscript  X    k    superscript  e    j  2  œÄ    k    subscript  f  S   t        ((X_{k,I+jX_{k,Q}})e^{j2\pi kf_{S}t})^{*}=(X_{k,I}-jX_{k,Q})e^{-j2\pi kf_{S}t}%
 =X^{*}_{k}e^{j2\pi(-k)f_{S}t}     where    f  S     subscript  f  S    f_{S}   is the subcarrier spacing.  Equivalently, the received baseband  OFDM signal under the IQ imbalance effect is given by       X  k   =     Œ∑  Œ±    X  k    +    Œ∑  Œ≤    X   -  k   *          subscript  X  k        subscript  Œ∑  Œ±    subscript  X  k       subscript  Œ∑  Œ≤    subscript   superscript  X      k        X_{k}=\eta_{\alpha}X_{k}+\eta_{\beta}X^{*}_{-k}     In conclusion, besides a complex gain imposed on the current sub carrier data Xk, IQ imbalance also introduces ICI from the mirror subcarrier. The ICI term makes OFDM receivers very sensitive to the IQ imbalance effect. To solve this problem, the designer can request a stringent specification of the matching of the two branches in the frond-end or compensate for the imbalance in the baseband  receiver .  Simulation  IQ imbalance can be simulated by computing the gain and phase imbalance and applying them to the baseband signal by means of several real multipliers and adders.  Synchronization Errors  The time-domain baseband Signals with IQ imbalance can be represented by       z   i  ,  n    =     Œ∑  Œ±   z   (  t  )    +      Œ∑  Œ≤    z  *    (  t  )    |    t  =  i   (  N  +  N  |  g  )    T  s   +   N  g    T  s   +  n   T  s           subscript  z   i  n         subscript  Œ∑  Œ±   z  t    evaluated-at     subscript  Œ∑  Œ≤    superscript  z    t    fragments  t   i   fragments  normal-(  N   N  normal-|  g  normal-)    subscript  T  s     subscript  N  g    subscript  T  s    n   subscript  T  s        z_{i,n}=\eta_{\alpha}z(t)+\eta_{\beta}z^{*}(t)|_{t=i(N+N|g)T_{s}+N_{g}T_{s}+nT%
 _{s}}     Note that    Œ∑  Œ±     subscript  Œ∑  Œ±    \eta_{\alpha}   and    Œ∑  Œ≤     subscript  Œ∑  Œ≤    \eta_{\beta}   can be assumed to be time-invariant and frequency-invariant, meaning that they are constant over several sub carriers and symbols. With this property, multiple OFDM  subcarriers and symbols can be used to jointly estimate    Œ∑  Œ±     subscript  Œ∑  Œ±    \eta_{\alpha}   and    Œ∑  Œ≤     subscript  Œ∑  Œ≤    \eta_{\beta}   to increase the accuracy. Transforming to the frequency domain, we have the frequency-domain OFDM signals under the influence of IQ imbalance given by       z   i  ,  k    =     Œ∑  Œ±    H   i  ,  k     X   i  ,  k     +    Œ∑  Œ≤    H   i  ,   -  k    *    X   i  ,   -  k    *    +   V   i  ,  k          subscript  z   i  k         subscript  Œ∑  Œ±    subscript  H   i  k     subscript  X   i  k        subscript  Œ∑  Œ≤    subscript   superscript  H     i    k      subscript   superscript  X     i    k       subscript  V   i  k       z_{i,k}=\eta_{\alpha}H_{i,k}X_{i,k}+\eta_{\beta}H^{*}_{i,-k}X^{*}_{i,-k}+V_{i,k}     Note that the second term represents interference coming from the mirrored subcarrier    X   i  ,   -  k       subscript  X   i    k      X_{i,-k}     IQ imbalance estimation in MIMO-OFDM systems  In MIMO-OFDM systems, each RF channel has its own down-converting circuit. Therefore, the IQ imbalance for each RF channel is independent of those for the other RF channels. Considering a 2 x 2 MIMO system as an example, the received frequency-domain signal is given by      {       Z   i  ,  k    (  0  )    =     Œ∑  Œ±   (  0  )     (     H   i  ,  k    (  0  ,  0  )     X   i  ,  k    (  0  )     +    H   i  ,  k    (  0  ,  1  )     X   i  ,  k    (  1  )      )    +    Œ∑  Œ≤   (  0  )      (     H   i  ,   -  k     (  0  ,  0  )     X   i  ,   -  k     (  0  )     +    H   i  ,   -  k     (  0  ,  1  )     X   i  ,   -  k     (  1  )      )   *    +   V   i  ,  k    (  0  )             Z   i  ,  k    (  1  )    =     Œ∑  Œ±   (  1  )     (     H   i  ,  k    (  1  ,  0  )     X   i  ,  k    (  0  )     +    H   i  ,  k    (  1  ,  1  )     X   i  ,  k    (  1  )      )    +    Œ∑  Œ≤   (  1  )      (     H   i  ,   -  k     (  1  ,  0  )     X   i  ,   -  k     (  0  )     +    H   i  ,   -  k     (  1  ,  1  )     X   i  ,   -  k     (  1  )      )   *    +   V   i  ,  k    (  1  )             cases     subscript   superscript  Z  0    i  k         subscript   superscript  Œ∑  0   Œ±        subscript   superscript  H   0  0     i  k     subscript   superscript  X  0    i  k        subscript   superscript  H   0  1     i  k     subscript   superscript  X  1    i  k          subscript   superscript  Œ∑  0   Œ≤    superscript       subscript   superscript  H   0  0     i    k      subscript   superscript  X  0    i    k         subscript   superscript  H   0  1     i    k      subscript   superscript  X  1    i    k           subscript   superscript  V  0    i  k      otherwise     subscript   superscript  Z  1    i  k         subscript   superscript  Œ∑  1   Œ±        subscript   superscript  H   1  0     i  k     subscript   superscript  X  0    i  k        subscript   superscript  H   1  1     i  k     subscript   superscript  X  1    i  k          subscript   superscript  Œ∑  1   Œ≤    superscript       subscript   superscript  H   1  0     i    k      subscript   superscript  X  0    i    k         subscript   superscript  H   1  1     i    k      subscript   superscript  X  1    i    k           subscript   superscript  V  1    i  k      otherwise    \begin{cases}Z^{(0)}_{i,k}=\eta^{(0)}_{\alpha}(H^{(0,0)}_{i,k}X^{(0)}_{i,k}+H^%
 {(0,1)}_{i,k}X^{(1)}_{i,k})+\eta^{(0)}_{\beta}(H^{(0,0)}_{i,-k}X^{(0)}_{i,-k}+%
 H^{(0,1)}_{i,-k}X^{(1)}_{i,-k})^{*}+V^{(0)}_{i,k}\\
 Z^{(1)}_{i,k}=\eta^{(1)}_{\alpha}(H^{(1,0)}_{i,k}X^{(0)}_{i,k}+H^{(1,1)}_{i,k}%
 X^{(1)}_{i,k})+\eta^{(1)}_{\beta}(H^{(1,0)}_{i,-k}X^{(0)}_{i,-k}+H^{(1,1)}_{i,%
 -k}X^{(1)}_{i,-k})^{*}+V^{(1)}_{i,k}\end{cases}     where    Œ∑  Œ±   (  q  )      subscript   superscript  Œ∑  q   Œ±    \eta^{(q)}_{\alpha}   and    Œ∑  Œ≤   (  q  )      subscript   superscript  Œ∑  q   Œ≤    \eta^{(q)}_{\beta}   are the IQ imbalance coefficients of the qth receive RF channel.  Estimation of    Œ∑  Œ±   (  q  )      subscript   superscript  Œ∑  q   Œ±    \eta^{(q)}_{\alpha}   and    Œ∑  Œ≤   (  q  )      subscript   superscript  Œ∑  q   Œ≤    \eta^{(q)}_{\beta}   is the same for each RF channel. Therefore, we take the first RF channel as an example. The received signals at the pilot subcarriers of the first RF channel are stacked into a vector    z   i  ,  Œ±    (  q  )      subscript   superscript  z  q    i  Œ±     z^{(q)}_{i,\alpha}   ,       ùê≥   i  ,  Œ±    (  0  )    =   [      z   i  ,   Œ±  0     (  0  )         z   i  ,   Œ±  1     (  0  )        ‚ãÆ       z   i  ,    Œ±  J   -  1     (  0  )       ]   =     ùêÄ   i  ,  Œ±    (  0  )     [      Œ∑  Œ±   (  0  )         Œ∑  Œ≤   (  0  )       ]    +   ùêØ   i  ,  Œ±    (  0  )            subscript   superscript  ùê≥  0    i  Œ±       subscript   superscript  z  0    i    Œ±  0        subscript   superscript  z  0    i    Œ±  1       normal-‚ãÆ     subscript   superscript  z  0    i      Œ±  J   1                 subscript   superscript  ùêÄ  0    i  Œ±       subscript   superscript  Œ∑  0   Œ±      subscript   superscript  Œ∑  0   Œ≤       subscript   superscript  ùêØ  0    i  Œ±        \mathbf{z}^{(0)}_{i,\alpha}=\begin{bmatrix}z^{(0)}_{i,\alpha 0}\\
 z^{(0)}_{i,\alpha 1}\\
 \vdots\\
 z^{(0)}_{i,\alpha J-1}\end{bmatrix}=\mathbf{A}^{(0)}_{i,\alpha}\begin{bmatrix}%
 \eta^{(0)}_{\alpha}\\
 \eta^{(0)}_{\beta}\end{bmatrix}+\mathbf{v}^{(0)}_{i,\alpha}     where    ùêÄ   i  ,  Œ±    (  0  )      subscript   superscript  ùêÄ  0    i  Œ±     \mathbf{A}^{(0)}_{i,\alpha}   is the    ùêâ  √ó  2      ùêâ  2    \mathbf{J}\times 2   matrix       ùêÄ   i  ,  Œ±    (  0  )    =   [      (     H   i  ,   Œ±  0     (  0  ,  0  )     X   i  ,   Œ±  0     (  0  )     +    H   i  ,   Œ±  0     (  0  ,  1  )     X   i  ,   Œ±  0     (  1  )      )       (     H   i  ,   Œ±   J  -  1      (  0  ,  0  )     X   i  ,   Œ±   J  -  1      (  0  )     +    H   i  ,   Œ±   J  -  1      (  0  ,  1  )     X   i  ,   Œ±   J  -  1      (  1  )      )   *        (     H   i  ,   Œ±  1     (  0  ,  0  )     X   i  ,   Œ±  1     (  0  )     +    H   i  ,   Œ±  1     (  0  ,  1  )     X   i  ,   Œ±  1     (  1  )      )       (     H   i  ,   Œ±   J  -  2      (  0  ,  0  )     X   i  ,   Œ±   J  -  2      (  0  )     +    H   i  ,   Œ±   J  -  2      (  0  ,  1  )     X   i  ,   Œ±   J  -  2      (  1  )      )   *       ‚ãÆ    ‚ãÆ       (     H   i  ,   Œ±   J  -  1      (  0  ,  0  )     X   i  ,   Œ±   J  -  1      (  0  )     +    H   i  ,   Œ±   J  -  1      (  0  ,  1  )     X   i  ,   Œ±   J  -  1      (  1  )      )       (     H   i  ,   Œ±  0     (  0  ,  0  )     X   i  ,   Œ±  0     (  0  )     +    H   i  ,   Œ±  0     (  0  ,  1  )     X   i  ,   Œ±  0     (  1  )      )   *      ]        subscript   superscript  ùêÄ  0    i  Œ±           subscript   superscript  H   0  0     i    Œ±  0      subscript   superscript  X  0    i    Œ±  0         subscript   superscript  H   0  1     i    Œ±  0      subscript   superscript  X  1    i    Œ±  0        superscript       subscript   superscript  H   0  0     i   subscript  Œ±    J  1       subscript   superscript  X  0    i   subscript  Œ±    J  1          subscript   superscript  H   0  1     i   subscript  Œ±    J  1       subscript   superscript  X  1    i   subscript  Œ±    J  1                 subscript   superscript  H   0  0     i    Œ±  1      subscript   superscript  X  0    i    Œ±  1         subscript   superscript  H   0  1     i    Œ±  1      subscript   superscript  X  1    i    Œ±  1        superscript       subscript   superscript  H   0  0     i   subscript  Œ±    J  2       subscript   superscript  X  0    i   subscript  Œ±    J  2          subscript   superscript  H   0  1     i   subscript  Œ±    J  2       subscript   superscript  X  1    i   subscript  Œ±    J  2            normal-‚ãÆ  normal-‚ãÆ         subscript   superscript  H   0  0     i   subscript  Œ±    J  1       subscript   superscript  X  0    i   subscript  Œ±    J  1          subscript   superscript  H   0  1     i   subscript  Œ±    J  1       subscript   superscript  X  1    i   subscript  Œ±    J  1         superscript       subscript   superscript  H   0  0     i   subscript  Œ±  0      subscript   superscript  X  0    i   subscript  Œ±  0         subscript   superscript  H   0  1     i   subscript  Œ±  0      subscript   superscript  X  1    i   subscript  Œ±  0             \mathbf{A}^{(0)}_{i,\alpha}=\begin{bmatrix}(H^{(0,0)}_{i,\alpha 0}X^{(0)}_{i,%
 \alpha 0}+H^{(0,1)}_{i,\alpha 0}X^{(1)}_{i,\alpha 0})&(H^{(0,0)}_{i,\alpha_{J-%
 1}}X^{(0)}_{i,\alpha_{J-1}}+H^{(0,1)}_{i,\alpha_{J-1}}X^{(1)}_{i,\alpha_{J-1}}%
 )^{*}\\
 (H^{(0,0)}_{i,\alpha 1}X^{(0)}_{i,\alpha 1}+H^{(0,1)}_{i,\alpha 1}X^{(1)}_{i,%
 \alpha 1})&(H^{(0,0)}_{i,\alpha_{J-2}}X^{(0)}_{i,\alpha_{J-2}}+H^{(0,1)}_{i,%
 \alpha_{J-2}}X^{(1)}_{i,\alpha_{J-2}})^{*}\\
 \vdots&\vdots\\
 (H^{(0,0)}_{i,\alpha_{J-1}}X^{(0)}_{i,\alpha_{J-1}}+H^{(0,1)}_{i,\alpha_{J-1}}%
 X^{(1)}_{i,\alpha_{J-1}})&(H^{(0,0)}_{i,\alpha_{0}}X^{(0)}_{i,\alpha_{0}}+H^{(%
 0,1)}_{i,\alpha_{0}}X^{(1)}_{i,\alpha_{0}})^{*}\\
 \end{bmatrix}     Clearly, the above formula is similar to that of the SISO case and can be solved using the LS method. Moreover, the estimation complexity can be reduced by using fewer pilot subcarriers in the estimation.  IQ imbalance compensation  The IQ imbalance can be compensated in either the time domain or the frequency domain. In the time domain, the compensated signal Zm in the current mth sample point is given by        z  ¬Ø   m   =       Œ∑  ^   Œ±  *    z  m    -     Œ∑  ^   Œ≤    z  m  *        |    Œ∑  ^   Œ±   |   2   -    |    Œ∑  ^   Œ≤   |   2     =      Œ∑  ^   Œ±  *      |    Œ∑  ^   Œ±   |   2   -    |    Œ∑  ^   Œ≤  *   |   2      (    z  m   -      Œ∑  ^   Œ≤     Œ∑  ^   Œ±  *     z  m  *     )           subscript   normal-¬Ø  z   m          subscript   superscript   normal-^  Œ∑     Œ±    subscript  z  m       subscript   normal-^  Œ∑   Œ≤    subscript   superscript  z    m        superscript     subscript   normal-^  Œ∑   Œ±    2    superscript     subscript   normal-^  Œ∑   Œ≤    2               subscript   superscript   normal-^  Œ∑     Œ±      superscript     subscript   normal-^  Œ∑   Œ±    2    superscript     subscript   superscript   normal-^  Œ∑     Œ≤    2        subscript  z  m        subscript   normal-^  Œ∑   Œ≤    subscript   superscript   normal-^  Œ∑     Œ±     subscript   superscript  z    m         \overline{z}_{m}=\frac{\widehat{\eta}^{*}_{\alpha}z_{m}-\widehat{\eta}_{\beta}%
 z^{*}_{m}}{|\widehat{\eta}_{\alpha}|^{2}-|\widehat{\eta}_{\beta}|^{2}}=\frac{%
 \widehat{\eta}^{*}_{\alpha}}{|\widehat{\eta}_{\alpha}|^{2}-|\widehat{\eta}^{*}%
 _{\beta}|^{2}}(z_{m}-\frac{\widehat{\eta}_{\beta}}{\widehat{\eta}^{*}_{\alpha}%
 }z^{*}_{m})     We can see that, by using the ratio      Œ∑  ^   Œ≤     Œ∑  ^   Œ±  *        subscript   normal-^  Œ∑   Œ≤    subscript   superscript   normal-^  Œ∑     Œ±     \frac{\widehat{\eta}_{\beta}}{\widehat{\eta}^{*}_{\alpha}}   to mitigate the IQ imbalance, there is a loss factor      Œ∑  ^   Œ±  *   /   (     |    Œ∑  ^   Œ±   |   2   -    |    Œ∑  ^   Œ≤   |   2    )        subscript   superscript   normal-^  Œ∑     Œ±      superscript     subscript   normal-^  Œ∑   Œ±    2    superscript     subscript   normal-^  Œ∑   Œ≤    2      \widehat{\eta}^{*}_{\alpha}/(|\widehat{\eta}_{\alpha}|^{2}-|\widehat{\eta}_{%
 \beta}|^{2})   . When the noise is added before the IQ imbalance, the SNR remains the same, because both noise and signal suffer this loss. However, if the noise is added after IQ imbalance, the effective SNR degrades. In this case,    Œ∑  Œ±     subscript  Œ∑  Œ±    \eta_{\alpha}   and    Œ∑  Œ≤     subscript  Œ∑  Œ≤    \eta_{\beta}   , respectively, should be computed.  Compared with the time-domain approach, compensating in the frequency domain is more complicated because the mirrored subcarrier is needed. The frequency domain compensated signal at the ith symbol and the kth subcarrier        Z  ¬Ø    i  ,  k    =       Œ∑  ^   Œ±  *    Z   i  ,  k     -     Œ∑  ^   Œ≤    Z   i  ,  k   *        |    Œ∑  ^   Œ±   |   2   -    |    Œ∑  ^   Œ≤   |   2          subscript   normal-¬Ø  Z    i  k           subscript   superscript   normal-^  Œ∑     Œ±    subscript  Z   i  k        subscript   normal-^  Œ∑   Œ≤    subscript   superscript  Z     i  k         superscript     subscript   normal-^  Œ∑   Œ±    2    superscript     subscript   normal-^  Œ∑   Œ≤    2       \overline{Z}_{i,k}=\frac{\widehat{\eta}^{*}_{\alpha}Z_{i,k}-\widehat{\eta}_{%
 \beta}Z^{*}_{i,k}}{|\widehat{\eta}_{\alpha}|^{2}-|\widehat{\eta}_{\beta}|^{2}}     Nevertheless, in reality, the time-domain compensation is less preferred because it introduces larger latency between IQ imbalance estimation and compensation.  IQ imbalance estimation  Frequency-domain OFDM signals under the influence of IQ imbalance is given by       z   i  ,  k    =     Œ∑  Œ±    H   i  ,  k     X   i  ,  k     +    Œ∑  Œ≤    H   i  ,   -  k    *    X   i  ,   -  k    *    +   V   i  ,  k          subscript  z   i  k         subscript  Œ∑  Œ±    subscript  H   i  k     subscript  X   i  k        subscript  Œ∑  Œ≤    subscript   superscript  H     i    k      subscript   superscript  X     i    k       subscript  V   i  k       z_{i,k}=\eta_{\alpha}H_{i,k}X_{i,k}+\eta_{\beta}H^{*}_{i,-k}X^{*}_{i,-k}+V_{i,k}     the IQ imbalance coefficients    Œ∑  Œ±     subscript  Œ∑  Œ±    \eta_{\alpha}   and    Œ∑  Œ≤     subscript  Œ∑  Œ≤    \eta_{\beta}   are mixed with the channel frequency responses, making both the IQ imbalance estimation and channel estimation difficult.  In the first half of the training sequence, only sub carriers ranging from 1 to N/2 - 1 transmit pilot symbols; the remaining subcarriers are not used. In the second half, the sub carriers from -1 to -N/2 are used for pilot transmission. Such a training scheme easily decouples the IQ imbalance and the channel frequency response. Assuming the value of the pilot symbols is + 1, the received signals at subcarriers from 1 to N/2 - 1 are given by        Z   i  ,  k    =     Œ∑  Œ±    H   i  ,  k     +   V   i  ,  k       k  =   1  ,  ‚ãØ  ,    N  /  2   -  1        formulae-sequence     subscript  Z   i  k         subscript  Œ∑  Œ±    subscript  H   i  k      subscript  V   i  k        k   1  normal-‚ãØ      N  2   1       Z_{i,k}=\eta_{\alpha}H_{i,k}+V_{i,k}\ \ \ \ k=1,\cdots,N/2-1   ,  while the received signals at the mirrored sub carriers take the form        Z   i  ,   -  k     =     Œ∑  Œ≤    H   i  ,  k   *    +   V   i  ,   -  k        k  =   1  ,  ‚ãØ  ,    N  /  2   -  1        formulae-sequence     subscript  Z   i    k          subscript  Œ∑  Œ≤    subscript   superscript  H     i  k      subscript  V   i    k         k   1  normal-‚ãØ      N  2   1       Z_{i,-k}=\eta_{\beta}H^{*}_{i,k}+V_{i,-k}\ \ \ \ k=1,\cdots,N/2-1     From the two sets of received signals, the ratio     Œ∑  Œ≤    Œ∑  Œ±  *        subscript  Œ∑  Œ≤    subscript   superscript  Œ∑    Œ±     \frac{\eta_{\beta}}{\eta^{*}_{\alpha}}   can be easily estimated by     Z   i  ,   -  k     /   Z   i  ,  k   *        subscript  Z   i    k      subscript   superscript  Z     i  k      Z_{i,-k}/Z^{*}_{i,k}   . The second half of the training sequence can be used in a similar way. Furthermore, the accuracy of this ratio estimation can be improved by averaging over several training symbols and several sub carriers. Although the IQ imbalance estimation using this training symbol is simple, this method suffers from low spectrum efficiency, as quite a few OFDM symbols must be reserved for training. Note that, when the thermal noise is added before the IQ imbalance, the ratio     Œ∑  Œ≤    Œ∑  Œ±  *        subscript  Œ∑  Œ≤    subscript   superscript  Œ∑    Œ±     \frac{\eta_{\beta}}{\eta^{*}_{\alpha}}   is sufficient to compensate the IQ imbalance. However, when the noise is added after the IQ imbalance, compensation using only     Œ∑  Œ≤    Œ∑  Œ±  *        subscript  Œ∑  Œ≤    subscript   superscript  Œ∑    Œ±     \frac{\eta_{\beta}}{\eta^{*}_{\alpha}}   can degrade the ensuing demodulation performance.  References   M. Valkama, M. Renfors, and V. Koivunen, 2 00 1 . "Advanced methods for 1/ Q imbalance compensation in communication receivers," IEEE Transactions on Signal ProceSSing, 49, 2335-2344  J. Tubbax, B . Come, L. V. der Perre, S. Donnay, M. Engels, H. D. Man, and M. Moonen, 2005. " Compensation of IQ imbalance and phase noise in OFDM systems," IEEE Transactions on Wreless Communications, 4, 872-877.  T.D Chiueh, PY Tsai, IW L, "Baseband Receiver Design for Wireless MIMO_OFDM Communications 2nd"   "   
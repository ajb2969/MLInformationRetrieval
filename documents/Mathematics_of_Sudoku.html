<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1480">Mathematics of Sudoku</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Mathematics of Sudoku</h1>
<hr/>

<p>The <a href="class_(set_theory)" title="wikilink">class</a> of <strong><a class="uri" href="Sudoku" title="wikilink">Sudoku</a></strong> <a href="puzzle" title="wikilink">puzzles</a> consists of a partially completed row-column grid of cells partitioned into <em>N</em> regions each of size <em>N</em> cells, to be filled in using a prescribed set of <em>N</em> distinct symbols (typically the numbers {1, ..., <em>N</em>}), so that each row, column and region contains exactly one of each element of the set. The puzzle can be investigated using <a class="uri" href="mathematics" title="wikilink">mathematics</a>.</p>
<h2 id="overview">Overview</h2>

<p>The mathematical analysis of Sudoku falls into two main areas: analyzing the properties of a) completed grids and b) puzzles. Grid analysis has largely focused on counting (enumerating) possible solutions for different <em>variants</em>. Puzzle analysis centers on the initial <em>given</em> values. The techniques used in either are largely the same: <a class="uri" href="combinatorics" title="wikilink">combinatorics</a> and <a href="permutation_group" title="wikilink">permutation group theory</a>, augmented by the application of programming tools.</p>

<p>There are many <a href="Sudokian" title="wikilink">Sudoku variants</a>, (partially) characterized by the size (<em>N</em>) and shape of their regions. For classic Sudoku, <em>N</em>=9 and the regions are 3x3 squares (called blocks or boxes). A rectangular Sudoku uses rectangular regions of row-column dimension <em>R</em>×<em>C</em>. For <em>R</em>×1 (and 1×<em>C</em>), i.e. where the region is a row or column, Sudoku becomes a <a href="Latin_square" title="wikilink">Latin square</a>.</p>

<p>Other Sudoku variants also exist, such as those with irregularly-shaped regions or with additional constraints (<a href="#Sudoku_with_additional_constraints" title="wikilink">hypercube</a>) or different (<a href='#Sum_number_place_("Killer_Sudoku")' title="wikilink">Samunamupure</a>) constraint types. See <a href="Sudokian" title="wikilink">Sudoku — Variants</a> for a discussion of variants and <a href="List_of_Sudoku_terms_and_jargon" title="wikilink">Sudoku terms and jargon</a> for an expanded listing.</p>

<p>The mathematics of Sudoku is a relatively new area of exploration, mirroring the popularity of Sudoku itself. <a href="NP-complete" title="wikilink">NP-completeness</a> was documented late 2002.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Published enumeration results began appearing in 2004.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>In contrast with the two main mathematical approaches of Sudoku mentioned above, an approach resting on mathematical logic and dealing with the resolution of the puzzles from the viewpoint of a player has recently been proposed in Denis Berthier's book "The Hidden Logic of Sudoku". This formalizes certain mathematical symmetries of the game and elicits resolution rules based on them, such as "hidden xy-chains".</p>
<h3 id="mathematical-context">Mathematical context</h3>

<p>The general problem of solving Sudoku puzzles on <em>n</em><sup>2</sup> × <em>n</em><sup>2</sup> boards of <em>n</em> × <em>n</em> blocks is known to be <a class="uri" href="NP-complete" title="wikilink">NP-complete</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a>  For <em>n</em>=3 (classical Sudoku), however, this result is of little relevance: <a href="algorithm" title="wikilink">algorithms</a> such as <a href="Dancing_Links" title="wikilink">Dancing Links</a> can solve puzzles in fractions of a second.</p>

<p>Solving Sudoku puzzles can be expressed as a <a href="graph_coloring" title="wikilink">graph coloring</a> problem. Consider the 9 × 9 = 3<sup>2</sup> × 3<sup>2</sup> case. The aim of the puzzle in its standard form is to construct a proper 9-coloring of a particular graph, given a partial 9-coloring. The graph in question has 81 vertices, one vertex for each cell of the grid. The vertices can be labeled with the ordered pairs (<em>x</em>, <em>y</em>), where <em>x</em> and <em>y</em> are integers between 1 and 9. In this case, two distinct vertices labeled by (<em>x</em>, <em>y</em>) and (<em>x</em>′, <em>y</em>′) are joined by an edge if and only if:</p>
<ul>
<li><em>x</em> = <em>x</em>′ (same column) or,</li>
<li><em>y</em> = <em>y</em>′ (same row) or,</li>
<li>⌈ <em>x</em>/3 ⌉ = ⌈ <em>x</em>′/3 ⌉ and ⌈ <em>y</em>/3 ⌉ = ⌈ <em>y</em>′/3 ⌉ (same 3 × 3 cell)</li>
</ul>

<p>The puzzle is then completed by assigning an integer between 1 and 9 to each vertex, in such a way that vertices that are joined by an edge do not have the same integer assigned to them.</p>

<p>A valid Sudoku solution grid is also a <a href="Latin_square" title="wikilink">Latin square</a>. There are significantly fewer valid Sudoku solution grids than Latin squares because Sudoku imposes the additional regional constraint. Nonetheless, the number of valid Sudoku solution grids for the standard 9×9 grid was calculated by Bertram Felgenhauer and Frazer Jarvis in 2005 to be 6,670,903,752,021,072,936,960 <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a>.  The number computed by Felgenhauer and Jarvis confirmed a result first identified by QSCGZ in September 2003.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> This number is equal to 9! × 72<sup>2</sup> × 2<sup>7</sup> × 27,704,267,971, the last factor of which is <a href="prime_number" title="wikilink">prime</a>. The result was derived through logic and <a href="brute_force_search" title="wikilink">brute force</a> <a class="uri" href="computation" title="wikilink">computation</a>. Russell and Jarvis also showed that when symmetries were taken into account, there were 5,472,730,538 solutions <a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> . The number of valid Sudoku solution grids for the 16×16 derivation is not known.</p>

<p>The number of minimal 9×9 Sudoku puzzles is not precisely known. (A minimal puzzle is one in which no clue can be deleted without losing uniqueness of the solution.) However, statistical techniques combined with the definition of a new type of generator (),<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> allow to show that there are approximately (with 0.065% relative error):</p>
<ul>
<li>3.10 × 10<sup>37</sup> minimal puzzles,</li>
<li>2.55 × 10<sup>25</sup> non-essentially-equivalent minimal puzzles.</li>
</ul>

<p>The maximum number of givens that can be provided while still not rendering the solution unique, regardless of variation, is four short of a full grid; if two instances of two numbers each are missing and the cells they are to occupy are the corners of an orthogonal rectangle, and exactly two of these cells are within one region, there are two ways the numbers can be added. The inverse of this would be the fewest givens that render a solution unique. Japanese puzzle enthusiasts have found a number of valid puzzles with 17 givens,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> and 18 with the givens in rotationally symmetric cells. Researchers at University College, Dublin have shown by exhaustive search that no valid puzzles with just 16 givens exist.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h4 id="sudokus-from-group-tables">Sudokus from group tables</h4>

<p>As in the case of <a href="Latin_square" title="wikilink">Latin squares</a> the (addition- or) <a href="multiplication_table" title="wikilink">multiplication tables</a> (<a href="Cayley_table" title="wikilink">Cayley tables</a>) of finite groups can be used to construct Sudokus and related tables of numbers. Namely, one has to take <a href="Subgroups" title="wikilink">subgroups</a> and <a href="quotient_group" title="wikilink">quotient groups</a> into account:</p>

<p>Take for example 

<math display="inline" id="Mathematics_of_Sudoku:0">
 <semantics>
  <mrow>
   <msub>
    <mi>ℤ</mi>
    <mi>n</mi>
   </msub>
   <mo>⊕</mo>
   <msub>
    <mi>ℤ</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">direct-sum</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{n}\oplus\mathbb{Z}_{n}
  </annotation>
 </semantics>
</math>

 the group of pairs, adding each component separately modulo some 

<math display="inline" id="Mathematics_of_Sudoku:1">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

. By omitting one of the components, we suddenly find ourselves in 

<math display="inline" id="Mathematics_of_Sudoku:2">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{n}
  </annotation>
 </semantics>
</math>

 (and this mapping is obviously compatible with the respective additions, i.e. it is a group homomorphism). One also says that the latter is a <a href="quotient_group" title="wikilink">quotient group</a> of the former, because some once different elements become equal in the new group. However, it is also a <a class="uri" href="subgroup" title="wikilink">subgroup</a>, because we can simply fill the missing component with 

<math display="inline" id="Mathematics_of_Sudoku:3">
 <semantics>
  <mn>0</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">0</cn>
  </annotation-xml>
 </semantics>
</math>

 to get back to 

<math display="inline" id="Mathematics_of_Sudoku:4">
 <semantics>
  <mrow>
   <msub>
    <mi>ℤ</mi>
    <mi>n</mi>
   </msub>
   <mo>⊕</mo>
   <msub>
    <mi>ℤ</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">direct-sum</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℤ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{n}\oplus\mathbb{Z}_{n}
  </annotation>
 </semantics>
</math>


.</p>

<p>Under this view, we write down the example 

<math display="inline" id="Mathematics_of_Sudoku:5">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=3
  </annotation>
 </semantics>
</math>

: </p>

<p>Each Sudoku region looks the same on the second component (namely like the subgroup 

<math display="inline" id="Mathematics_of_Sudoku:6">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{3}
  </annotation>
 </semantics>
</math>

), because these are added regardless of the first one. On the other hand, the first components are equal in each block, and if we imagine each block as one cell, these first components show the same pattern (namely the quotient group 

<math display="inline" id="Mathematics_of_Sudoku:7">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{3}
  </annotation>
 </semantics>
</math>

). As already outlined in the article of <a href="Latin_square" title="wikilink">Latin squares</a>, this really is a Latin square of order 

<math display="inline" id="Mathematics_of_Sudoku:8">
 <semantics>
  <mn>9</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">9</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   9
  </annotation>
 </semantics>
</math>

.</p>

<p>Now, to yield a Sudoku, let us permute the rows (or equivalently the columns) in such a way, that each block is redistributed exactly once into each block — for example order them 

<math display="inline" id="Mathematics_of_Sudoku:9">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>7</mn>
   <mo>,</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo>,</mo>
   <mn>8</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>6</mn>
   <mo>,</mo>
   <mn>9</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">4</cn>
    <cn type="integer">7</cn>
    <cn type="integer">2</cn>
    <cn type="integer">5</cn>
    <cn type="integer">8</cn>
    <cn type="integer">3</cn>
    <cn type="integer">6</cn>
    <cn type="integer">9</cn>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,4,7,2,5,8,3,6,9
  </annotation>
 </semantics>
</math>


. This of course preserves the Latin square property. Furthermore, in each block the lines have distinct first component by construction and each line in a block has distinct entries via the second component, because the blocks' second components originally formed a Latin square of order 

<math display="inline" id="Mathematics_of_Sudoku:10">
 <semantics>
  <mn>3</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">3</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3
  </annotation>
 </semantics>
</math>

 (from the subgroup 

<math display="inline" id="Mathematics_of_Sudoku:11">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{3}
  </annotation>
 </semantics>
</math>

).</p>

<p>Thus we really get a Sudoku (Rename the pairs to numbers 1...9 if you wish)! With the example and the row permutation above, we yield:</p>

<p>For this method to work, one generally does not need a product of two equally-sized groups. A so-called short <a href="exact_sequence" title="wikilink">exact sequence</a> of finite groups of appropriate size already does the job. Try for example the group 

<math display="inline" id="Mathematics_of_Sudoku:12">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{4}
  </annotation>
 </semantics>
</math>

 with quotient- and subgroup 

<math display="inline" id="Mathematics_of_Sudoku:13">
 <semantics>
  <msub>
   <mi>ℤ</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ℤ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}_{2}
  </annotation>
 </semantics>
</math>

. It seems clear (already from enumeration arguments), that not all Sudokus can be generated this way.</p>
<h3 id="terminology">Terminology</h3>

<p>A <em>puzzle</em> is a partially completed <em>grid</em>. The initial puzzle values are known as <em>givens</em> or <em>clues</em>. The <em>regions</em> are also called <em>boxes</em> or <em>blocks</em>. The use of the term <em>square</em> is generally avoided because of ambiguity. Horizontally adjacent blocks constitute a <em>band</em> (the vertical equivalent is called a <em>stack</em>).</p>

<p>A <em>proper</em> puzzle has a unique solution. The constraint'' 'each digit appears in each row, column and region' '' is called the <em>One Rule</em>.</p>

<p>See basic terms <a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> or the <a href="List_of_Sudoku_terms_and_jargon" title="wikilink">List of Sudoku terms and jargon</a> for an expanded list of terminology.</p>
<h3 id="variants">Variants</h3>

<p>Sudoku regions are <a class="uri" href="polyominoes" title="wikilink">polyominoes</a>. Although the classic 9x9 Sudoku is made of square nonominoes, it is possible to apply the rules of Sudoku to puzzles of other sizes – the 2x2 and 4x4 square puzzles, for example. Only N<sup>2</sup>xN<sup>2</sup> Sudoku puzzles can be tiled with square polyominoes. Another popular variant is made of rectangular regions – for example, 2x3 <a href="hexomino" title="wikilink">hexominoes</a> tiled in a 6x6 grid. The following notation is used for discussing this variant. <em>R</em>x<em>C</em> denotes a rectangular region with <em>R</em> rows and <em>C</em> columns. The implied grid configuration has <em>R</em> blocks per band (<em>C</em> blocks per stack), <em>C</em>×<em>R</em> bands×stacks and grid dimensions <em>N</em>x<em>N</em>, with <em>N</em> = <em>R</em> · <em>C</em>. Puzzles of size NxN, where N is prime can only be tiled with irregular N-ominoes. Each NxN grid can be tiled multiple ways with N-ominoes. Before enumerating the number of solutions to a Sudoku grid of size NxN, it is necessary to determine how many N-omino tilings exist for a given size (including the standard square tilings, as well as the rectangular tilings).</p>

<p>The size ordering of Sudoku puzzle can be used to define an integer series, e.g. for square Sudoku, the integer series of possible solutions .</p>

<p>Sudoku with square <em>N</em>x<em>N</em> regions are more symmetrical than immediately obvious from the <em>One Rule</em>. Each row and column intersects N regions and shares N cells with each. The number of bands and stacks also equals N. Rectangular Sudoku do not have these properties. The "3x3" Sudoku is additionally unique: N is also the number of row-column-region constraints from the <em>One Rule</em> (i.e. there are N=3 types of <em>units</em>).</p>

<p>See the <a href="List_of_Sudoku_terms_and_jargon" title="wikilink">List of Sudoku terms and jargon</a> for an expanded list and classification of variants.</p>
<h3 id="definition-of-terms-and-labels">Definition of terms and labels</h3>

<p>Let</p>
<ul>
<li>s be a solution to a Sudoku grid with specific dimensions, satisfying the <em>One Rule</em> constraints</li>
<li>S = {s}, be the set of all solutions</li>
<li>|S|, the <em>cardinality</em> of S, is the number of elements in S, i.e. the number of solutions, also known as the <em>size</em> of S.</li>
</ul>

<p>The number of solutions depends on the grid dimensions, rules applied and the definition of distinct solutions. For the 3×3 region grid, the conventions for labeling the rows, columns, blocks (boxes) are as shown. Bands are numbered top to bottom, stacks left to right. By extension the labeling scheme applies to any rectangular Sudoku grid.</p>

<p>Term labels for box-row and box-column <em>triplets</em> are also shown.</p>
<ul>
<li>triplet — an unordered <a href="combinations_and_permutations" title="wikilink">combination</a> of 3 values used in a box-row (or box-column), e.g. a triplet = {3, 5, 7} means the values 3, 5, 7 occur in a box-row (column) without specifying their location order. A triplet has 6 (3!) ordered <a href="combinations_and_permutations" title="wikilink">permutations</a>. By convention, triplet values are represented by their ordered digits. Triplet objects are labeled as:</li>
<li>r<em>BR</em>, identifies a row triplet for box <em>B</em> and (grid) row <em>R</em>, e.g. r56 is the triplet for box 5, row 6, using the grid row label.</li>
<li>c<em>BC</em>, identifies similarly a column triplet for box <em>B</em> and (grid) column row <em>C</em>.</li>
</ul>

<p>The {a, b, c} notation also reflects that fact a triplet is a <a class="uri" href="subset" title="wikilink">subset</a> of the allowed digits. For regions of arbitrary dimension, the related object is known as a <em>minicol(umn)</em> or <em>minirow</em>.</p>
<h2 id="enumerating-sudoku-solutions">Enumerating Sudoku solutions</h2>

<p>The answer to the question 'How many Sudokus are there?' depends on the definition of when similar solutions are considered different.</p>
<h3 id="enumerating-all-possible-sudoku-solutions">Enumerating all possible Sudoku solutions</h3>

<p>For the enumeration of <em>all</em> possible solutions, two solutions are considered distinct if any of their corresponding (81) cell values differ. Symmetry relations between similar solutions are ignored., e.g. the rotations of a solution are considered distinct. Symmetries play a significant role in the enumeration strategy, but not in the count of <em>all</em> possible solutions.</p>
<h4 id="enumerating-the-sudoku-99-grid-solutions-directly">Enumerating the Sudoku 9×9 grid solutions directly</h4>

<p>The first known solution to complete enumeration was posted by QSCGZ to the <em>rec.puzzles</em> <a class="uri" href="newsgroup" title="wikilink">newsgroup</a> in 2003,<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a><a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> obtaining 6,670,903,752,021,072,936,960 () distinct solutions.</p>

<p>In a 2005 study, Felgenhauer and Jarvis<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> analyzed the <a href="combinations_and_permutations" title="wikilink">permutations</a> of the top band used in valid solutions. Once the Band1 <a href="symmetry_in_mathematics" title="wikilink">symmetries</a> and <a href="equivalence_class" title="wikilink">equivalence classes</a> for the partial grid solutions were identified, the completions of the lower two bands were constructed and counted for each equivalence class. Summing completions over the equivalence classes, weighted by class size, gives the total number of solutions as 6,670,903,752,021,072,936,960, confirming the value obtained by QSCGZ. The value was subsequently confirmed numerous times independently. The <a href="#Method_and_algorithm_details_for_the_9×9_grid_direct_enumeration" title="wikilink">Algorithm details</a> section (below) describes the method.</p>
<h4 id="enumeration-using-band-generation">Enumeration using band generation</h4>

<p>A second enumeration technique based on <em>band generation</em> was later developed that is significantly less computationally intensive.</p>
<h3 id="enumerating-essentially-different-sudoku-solutions">Enumerating essentially different Sudoku solutions</h3>

<p>Two valid grids are <em>essentially</em> the same if one can be derived from the other.</p>
<h4 id="sudoku-preserving-symmetries">Sudoku preserving symmetries</h4>

<p>The following operations always translate a valid Sudoku grid into another valid grid: (values represent permutations for classic Sudoku)</p>
<ul>
<li>Relabeling symbols (9!)</li>
<li>Band permutations (3!)</li>
<li>Row permutations within a band (3!<sup>3</sup>)</li>
<li>Stack permutations (3!)</li>
<li>Column permutations within a stack (3!<sup>3</sup>)</li>
<li>Reflection, transposition and rotation (2). (Given any transposition or quarter-turn rotation in conjunction with the above permutations, any combination of reflections, transpositions and rotations can be produced, so these operations only contribute a factor of 2.)</li>
</ul>

<p>These operations define a symmetry relation between equivalent grids. Excluding relabeling, and with respect to the 81 grid cell values, the operations form a <a class="uri" href="subgroup" title="wikilink">subgroup</a> of the <a href="symmetric_group" title="wikilink">symmetric group</a> S<sub>81</sub>, of order 3!<sup>8</sup>×2 = 3359232.</p>

<p>It has been shown that any fixed operation on the tiles that always translates a valid Sudoku grid into another valid grid can be generated from the operations listed above (excluding relabeling).</p>
<h4 id="identifying-distinct-solutions-with-burnsides-lemma">Identifying distinct solutions with Burnside's Lemma</h4>

<p>For a solution, the set of equivalent solutions which can be reached using these operations (excluding relabeling), form an <a href="Orbit_(group_theory)" title="wikilink">orbit</a> of the <a href="symmetric_group" title="wikilink">symmetric group</a>. The number of essentially different solutions is then the number of orbits, which can be computed using <a href="Burnside's_lemma" title="wikilink">Burnside's lemma</a>. The Burnside <em>fixed points</em> are solutions that differ only by relabeling. Using this technique, Jarvis/Russell <a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> computed the number of essentially different (symmetrically distinct) solutions as 5,472,730,538.</p>
<h2 id="enumeration-results">Enumeration results</h2>

<p>Enumeration results for many Sudoku variants have been calculated: these are summarised below.</p>
<h3 id="sudoku-with-rectangular-regions">Sudoku with rectangular regions</h3>

<p>In the table, "Dimensions" are those of the regions (e.g. 3x3 in normal Sudoku). The "Rel Err" column indicates how a simple approximation, using the generalised method of Kevin Kilfoil,<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> compares to the true grid count: it is an underestimate in all cases evaluated so far.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Dimensions</p></th>
<th style="text-align: left;">
<p>Nr Grids</p></th>
<th style="text-align: left;">
<p>Attribution</p></th>
<th style="text-align: left;">
<p>Verified?</p></th>
<th style="text-align: left;">
<p>Rel Err</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>1x?</p></td>
<td style="text-align: left;">
<p><em>see <a href="Latin_squares" title="wikilink">Latin squares</a></em></p></td>
<td style="text-align: left;">
<p>n/a</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2×2</p></td>
<td style="text-align: left;">
<p>288</p></td>
<td style="text-align: left;">
<p>various <a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
<td style="text-align: left;">
<p>-11.1%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2×3</p></td>
<td style="text-align: left;">
<p>28200960 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen <a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
<td style="text-align: left;">
<p>-5.88%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2×4</p></td>
<td style="text-align: left;">
<p>29136487207403520 = c. </p></td>
<td style="text-align: left;">
<p>Russell <a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
<td style="text-align: left;">
<p>-1.91%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2×5</p></td>
<td style="text-align: left;">
<p>1903816047972624930994913280000 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen <a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
<td style="text-align: left;">
<p>-0.375%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2×6</p></td>
<td style="text-align: left;">
<p>38296278920738107863746324732012492486187417600000 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen <a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
<td style="text-align: left;">
<p>-0.238%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3×3</p></td>
<td style="text-align: left;">
<p>6670903752021072936960 = c. </p></td>
<td style="text-align: left;">
<p>Felgenhauer/Jarvis <a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
<td style="text-align: left;">
<p>-0.207%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3×4</p></td>
<td style="text-align: left;">
<p>81171437193104932746936103027318645818654720000 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
<td style="text-align: left;">
<p>-0.132%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3×5</p></td>
<td style="text-align: left;">
<p><strong>unknown</strong>, estimated c. </p></td>
<td style="text-align: left;">
<p>Silver <a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></p></td>
<td style="text-align: left;">
<p>n/a</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4×4</p></td>
<td style="text-align: left;">
<p><strong>unknown</strong>, estimated c. </p></td>
<td style="text-align: left;">
<p>Silver <a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a></p></td>
<td style="text-align: left;">
<p>n/a</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4×5</p></td>
<td style="text-align: left;">
<p><strong>unknown</strong>, estimated c. </p></td>
<td style="text-align: left;">
<p>Silver <a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a></p></td>
<td style="text-align: left;">
<p>n/a</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5×5</p></td>
<td style="text-align: left;">
<p><strong>unknown</strong>, estimated c. </p></td>
<td style="text-align: left;">
<p>Silver / Pettersen <a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a></p></td>
<td style="text-align: left;">
<p>n/a</p></td>
</tr>
</tbody>
</table>

<p>The standard 3×3 calculation can be carried out in less than a second on a PC. The 3×4 (= 4×3) problem is much harder and took 2568 hours to solve, split over several computers.</p>
<h3 id="sudoku-bands">Sudoku bands</h3>

<p>For large (<em>R</em>,<em>C</em>), the method of Kevin Kilfoil <a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> (generalised method:<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a>) is used to estimate the number of grid completions. The method asserts that the Sudoku row and column constraints are, to first approximation, <a href="Statistical_independence#Conditionally_independent_random_variables" title="wikilink">conditionally independent</a> given the box constraint. Omitting a little algebra, this gives the Kilfoil-Silver-Pettersen formula:</p>

<p>

<math display="block" id="Mathematics_of_Sudoku:14">
 <semantics>
  <mrow>
   <mtext>Number of Grids</mtext>
   <mo>≃</mo>
   <mfrac>
    <mrow>
     <msubsup>
      <mi>b</mi>
      <mrow>
       <mi>R</mi>
       <mo>,</mo>
       <mi>C</mi>
      </mrow>
      <mi>C</mi>
     </msubsup>
     <mo>×</mo>
     <msubsup>
      <mi>b</mi>
      <mrow>
       <mi>C</mi>
       <mo>,</mo>
       <mi>R</mi>
      </mrow>
      <mi>R</mi>
     </msubsup>
    </mrow>
    <msup>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>R</mi>
        <mi>C</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mi>R</mi>
      <mi>C</mi>
     </mrow>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to-or-equals</csymbol>
    <mtext>Number of Grids</mtext>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <list>
         <ci>R</ci>
         <ci>C</ci>
        </list>
       </apply>
       <ci>C</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <list>
         <ci>C</ci>
         <ci>R</ci>
        </list>
       </apply>
       <ci>R</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <factorial></factorial>
       <apply>
        <times></times>
        <ci>R</ci>
        <ci>C</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>R</ci>
       <ci>C</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{Number of Grids}\simeq\frac{b_{R,C}^{C}\times b_{C,R}^{R}}{(RC)!^{RC}}
  </annotation>
 </semantics>
</math>

 where <em>b</em><sub>R,C</sub> is the number of ways of completing a Sudoku band <a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> of <em>R</em> horizontally adjacent <em>R</em>×<em>C</em> boxes. Petersen's algorithm,<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a> as implemented by Silver,<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a> is currently the fastest known technique for exact evaluation of these <em>b</em><sub>R,C</sub>.</p>

<p>The band counts <strong>for problems whose full Sudoku grid-count is unknown</strong> are listed below. As in the previous section, "Dimensions" are those of the regions.</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Dimensions</p></th>
<th style="text-align: left;">
<p>Nr Bands</p></th>
<th style="text-align: left;">
<p>Attribution</p></th>
<th style="text-align: left;">
<p>Verified?</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>2×<em>C</em></p></td>
<td style="text-align: left;">
<p>(2<em>C</em>)! (<em>C</em>!)<sup>2</sup></p></td>
<td style="text-align: left;">
<p>(obvious result)</p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3×<em>C</em></p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Mathematics_of_Sudoku:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>3</mn>
      <mi>C</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>C</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>6</mn>
   </msup>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mrow>
       <mn>0</mn>
       <mi mathvariant="normal">…</mi>
       <mi>C</mi>
      </mrow>
     </mrow>
    </msub>
    <msup>
     <mrow>
      <mo>(</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>C</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>k</mi>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mo>)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <factorial></factorial>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <factorial></factorial>
      <ci>C</ci>
     </apply>
     <cn type="integer">6</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <apply>
        <times></times>
        <cn type="integer">0</cn>
        <ci>normal-…</ci>
        <ci>C</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>C</ci>
       <ci>k</ci>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (3C)!(C!)^{6}\sum_{k=0\ldots C}{C\choose k}^{3}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>Pettersen <a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4×<em>C</em></p></td>
<td style="text-align: left;">
<p>(long expression: see below)</p></td>
<td style="text-align: left;">
<p>Pettersen <a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a></p></td>
<td style="text-align: left;">
<p>Yes <a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4×4</p></td>
<td style="text-align: left;">
<p>16! × 4!<sup>12</sup> × 1273431960 = c. </p></td>
<td style="text-align: left;">
<p>Silver <a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4×5</p></td>
<td style="text-align: left;">
<p>20! × 5!<sup>12</sup> × 879491145024 = c. </p></td>
<td style="text-align: left;">
<p>Russell <a class="footnoteRef" href="#fn38" id="fnref38"><sup>38</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4×6</p></td>
<td style="text-align: left;">
<p>24! × 6!<sup>12</sup> × 677542845061056 = c. </p></td>
<td style="text-align: left;">
<p>Russell <a class="footnoteRef" href="#fn39" id="fnref39"><sup>39</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4×7</p></td>
<td style="text-align: left;">
<p>28! × 7!<sup>12</sup> × 563690747238465024 = c. </p></td>
<td style="text-align: left;">
<p>Russell <a class="footnoteRef" href="#fn40" id="fnref40"><sup>40</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>(calculations up to 4×100 have been performed by Silver,<a class="footnoteRef" href="#fn41" id="fnref41"><sup>41</sup></a> but are not listed here)</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5×3</p></td>
<td style="text-align: left;">
<p>15! × 3!<sup>20</sup> × 324408987992064 = c. </p></td>
<td style="text-align: left;">
<p>Silver <a class="footnoteRef" href="#fn42" id="fnref42"><sup>42</sup></a></p></td>
<td style="text-align: left;">
<p>Yes<sup><strong>#</strong></sup></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5×4</p></td>
<td style="text-align: left;">
<p>20! × 4!<sup>20</sup> × 518910423730214314176 = c. </p></td>
<td style="text-align: left;">
<p>Silver <a class="footnoteRef" href="#fn43" id="fnref43"><sup>43</sup></a></p></td>
<td style="text-align: left;">
<p>Yes<sup><strong>#</strong></sup></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5×5</p></td>
<td style="text-align: left;">
<p>25! × 5!<sup>20</sup> × 1165037550432885119709241344 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn44" id="fnref44"><sup>44</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5×6</p></td>
<td style="text-align: left;">
<p>30! × 6!<sup>20</sup> × 3261734691836217181002772823310336 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn45" id="fnref45"><sup>45</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5×7</p></td>
<td style="text-align: left;">
<p>35! × 7!<sup>20</sup> × 10664509989209199533282539525535793414144 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn46" id="fnref46"><sup>46</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5×8</p></td>
<td style="text-align: left;">
<p>40! × 8!<sup>20</sup> × 39119312409010825966116046645368393936122855616 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn47" id="fnref47"><sup>47</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5×9</p></td>
<td style="text-align: left;">
<p>45! × 9!<sup>20</sup> × 156805448016006165940259131378329076911634037242834944 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn48" id="fnref48"><sup>48</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5×10</p></td>
<td style="text-align: left;">
<p>50! × 10!<sup>20</sup> × 674431748701227492664421138490224315931126734765581948747776 = c. </p></td>
<td style="text-align: left;">
<p>Pettersen / Silver <a class="footnoteRef" href="#fn49" id="fnref49"><sup>49</sup></a></p></td>
<td style="text-align: left;">
<p>No</p></td>
</tr>
</tbody>
</table>

<p></p>
</dd>
</dl>
<dl>
<dd><sup><strong>#</strong> : same author, different method</sup>
</dd>
</dl>

<p>The expression for the 4×C case is: 

<math display="inline" id="Mathematics_of_Sudoku:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>4</mn>
      <mi>C</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>C</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>12</mn>
   </msup>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>a</mi>
      <mo>,</mo>
      <mi>b</mi>
      <mo>,</mo>
      <mi>c</mi>
     </mrow>
    </msub>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <msup>
         <mrow>
          <mi>C</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mrow>
         <mrow>
          <mi>a</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
         <mrow>
          <mi>b</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
         <mrow>
          <mi>c</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
        </mrow>
       </mfrac>
       <mo>⋅</mo>
       <mrow>
        <msub>
         <mo largeop="true" symmetric="true">∑</mo>
         <mstyle scriptlevel="+1">
          <mtable columnspacing="0.4em" rowspacing="0.2ex">
           <mtr>
            <mtd>
             <mrow>
              <msub>
               <mi>k</mi>
               <mn>12</mn>
              </msub>
              <mo>,</mo>
              <msub>
               <mi>k</mi>
               <mn>13</mn>
              </msub>
              <mo>,</mo>
              <msub>
               <mi>k</mi>
               <mn>14</mn>
              </msub>
              <mo>,</mo>
             </mrow>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mrow>
              <msub>
               <mi>k</mi>
               <mn>23</mn>
              </msub>
              <mo>,</mo>
              <msub>
               <mi>k</mi>
               <mn>24</mn>
              </msub>
              <mo>,</mo>
              <msub>
               <mi>k</mi>
               <mn>34</mn>
              </msub>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
         </mstyle>
        </msub>
        <mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>a</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <msub>
               <mi>k</mi>
               <mn>12</mn>
              </msub>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>b</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <msub>
               <mi>k</mi>
               <mn>13</mn>
              </msub>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>c</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <msub>
               <mi>k</mi>
               <mn>14</mn>
              </msub>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>c</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <msub>
               <mi>k</mi>
               <mn>23</mn>
              </msub>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>b</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <msub>
               <mi>k</mi>
               <mn>24</mn>
              </msub>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="+1">
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>a</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <msub>
               <mi>k</mi>
               <mn>34</mn>
              </msub>
             </mtd>
            </mtr>
           </mtable>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <factorial></factorial>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <factorial></factorial>
      <ci>C</ci>
     </apply>
     <cn type="integer">12</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <list>
       <ci>a</ci>
       <ci>b</ci>
       <ci>c</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <factorial></factorial>
          <ci>C</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <ci>a</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>b</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>c</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <ci>STACKED</ci>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">12</cn>
           </apply>
           <ci>normal-,</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">13</cn>
           </apply>
           <ci>normal-,</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">14</cn>
           </apply>
           <ci>normal-,</ci>
          </cerror>
          <list>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">23</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">24</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">34</cn>
           </apply>
          </list>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>a</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">12</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>b</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">13</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>c</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">14</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>c</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">23</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>b</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">24</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>a</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">34</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (4C)!(C!)^{12}\sum_{a,b,c}{\left(\frac{C!^{2}}{a!b!c!}\cdot\sum_{k_{12},k_{13}%
,k_{14},\atop k_{23},k_{24},k_{34}}{{a\choose k_{12}}{b\choose k_{13}}{c%
\choose k_{14}}{c\choose k_{23}}{b\choose k_{24}}{a\choose k_{34}}}\right)^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<dl>
<dd>the outer summand is taken over all <em>a</em>,<em>b</em>,<em>c</em> such that 0&lt;=<em>a</em>,<em>b</em>,<em>c</em> and <em>a</em>+<em>b</em>+<em>c</em>=2<em>C</em>
</dd>
<dd>the inner summand is taken over all <em>k</em><sub>12</sub>,<em>k</em><sub>13</sub>,<em>k</em><sub>14</sub>,<em>k</em><sub>23</sub>,<em>k</em><sub>24</sub>,<em>k</em><sub>34</sub> ≥ 0 such that
<dl>
<dd><em>k</em><sub>12</sub>,<em>k</em><sub>34</sub> ≤ <em>a</em>    and
</dd>
<dd><em>k</em><sub>13</sub>,<em>k</em><sub>24</sub> ≤ <em>b</em>    and
</dd>
<dd><em>k</em><sub>14</sub>,<em>k</em><sub>23</sub> ≤ <em>c</em>    and
</dd>
<dd><em>k</em><sub>12</sub>+<em>k</em><sub>13</sub>+<em>k</em><sub>14</sub> = <em>a</em>-<em>k</em><sub>12</sub>+<em>k</em><sub>23</sub>+<em>k</em><sub>24</sub> = <em>b</em>-<em>k</em><sub>13</sub>+<em>c</em>-<em>k</em><sub>23</sub>+<em>k</em><sub>34</sub> = <em>c</em>-<em>k</em><sub>14</sub>+<em>b</em>-<em>k</em><sub>24</sub>+<em>a</em>-<em>k</em><sub>34</sub> = <em>C</em>
</dd>
</dl>
</dd>
</dl>
<h3 id="sudoku-with-additional-constraints">Sudoku with additional constraints</h3>

<p>The following are all restrictions of 3x3 Sudokus. The type names have not been standardised: click on the attribution links to see the definitions.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Type</p></th>
<th style="text-align: left;">
<p>Nr Grids</p></th>
<th style="text-align: left;">
<p>Attribution</p></th>
<th style="text-align: left;">
<p>Verified?</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Quasi-Magic Sudoku</p></td>
<td style="text-align: left;">
<p>248832</p></td>
<td style="text-align: left;">
<p>Jones, Perkins and Roach <a class="footnoteRef" href="#fn50" id="fnref50"><sup>50</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3doku</p></td>
<td style="text-align: left;">
<p>104015259648</p></td>
<td style="text-align: left;">
<p>Stertenbrink <a class="footnoteRef" href="#fn51" id="fnref51"><sup>51</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Disjoint Groups</p></td>
<td style="text-align: left;">
<p>201105135151764480</p></td>
<td style="text-align: left;">
<p>Russell <a class="footnoteRef" href="#fn52" id="fnref52"><sup>52</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Hypercube</p></td>
<td style="text-align: left;">
<p>37739520</p></td>
<td style="text-align: left;">
<p>Stertenbrink <a class="footnoteRef" href="#fn53" id="fnref53"><sup>53</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Magic Sudoku</p></td>
<td style="text-align: left;">
<p>5971968</p></td>
<td style="text-align: left;">
<p>Stertenbrink <a class="footnoteRef" href="#fn54" id="fnref54"><sup>54</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Sudoku X</p></td>
<td style="text-align: left;">
<p>55613393399531520</p></td>
<td style="text-align: left;">
<p>Russell <a class="footnoteRef" href="#fn55" id="fnref55"><sup>55</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>NRC Sudoku</p></td>
<td style="text-align: left;">
<p>6337174388428800</p></td>
<td style="text-align: left;">
<p>Brouwer <a class="footnoteRef" href="#fn56" id="fnref56"><sup>56</sup></a></p></td>
<td style="text-align: left;">
<p>Yes</p></td>
</tr>
</tbody>
</table>

<p>All Sudokus remain valid (no repeated numbers in any row, column or region) under the action of the <a href="#Sudoku_preserving_symmetries" title="wikilink">Sudoku preserving symmetries</a> (see also Jarvis <a class="footnoteRef" href="#fn57" id="fnref57"><sup>57</sup></a>). Some Sudokus are special in that some operations merely have the effect of relabelling the digits; several of these are enumerated below.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Transformation</p></th>
<th style="text-align: left;">
<p>Nr Grids</p></th>
<th style="text-align: left;">
<p>Verified?</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Transposition</p></td>
<td style="text-align: left;">
<p>10980179804160</p></td>
<td style="text-align: left;">
<p>Indirectly</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Quarter Turn</p></td>
<td style="text-align: left;">
<p>4737761280</p></td>
<td style="text-align: left;">
<p>Indirectly</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Half Turn</p></td>
<td style="text-align: left;">
<p>56425064693760</p></td>
<td style="text-align: left;">
<p>Indirectly</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Band cycling</p></td>
<td style="text-align: left;">
<p>5384326348800</p></td>
<td style="text-align: left;">
<p>Indirectly</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Within-band row cycling</p></td>
<td style="text-align: left;">
<p>39007939461120</p></td>
<td style="text-align: left;">
<p>Indirectly</p></td>
</tr>
</tbody>
</table>

<p>Further calculations of this ilk combine to show that the number of essentially different Sudoku grids is 5,472,730,538, for example as demonstrated by Jarvis / Russell <a class="footnoteRef" href="#fn58" id="fnref58"><sup>58</sup></a> and verified by Pettersen.<a class="footnoteRef" href="#fn59" id="fnref59"><sup>59</sup></a> Similar methods have been applied to the 2x3 case, where Jarvis / Russell <a class="footnoteRef" href="#fn60" id="fnref60"><sup>60</sup></a> showed that there are 49 essentially different grids (see also the article by Bailey, Cameron and Connelly <a class="footnoteRef" href="#fn61" id="fnref61"><sup>61</sup></a>), to the 2x4 case, where Russell <a class="footnoteRef" href="#fn62" id="fnref62"><sup>62</sup></a> showed that there are 1,673,187 essentially different grids (verified by Pettersen <a class="footnoteRef" href="#fn63" id="fnref63"><sup>63</sup></a>), and to the 2x5 case where Pettersen <a class="footnoteRef" href="#fn64" id="fnref64"><sup>64</sup></a> showed that there are 4,743,933,602,050,718 essentially different grids (not verified).</p>
<h2 id="minimum-number-of-givens">Minimum number of givens</h2>

<p> <em>Proper puzzles</em> have a unique solution. An <em>irreducible puzzle</em> (or <em>minimal puzzle</em>) is a proper puzzle from which no givens can be removed leaving it a proper puzzle (with a single solution). It is possible to construct minimal puzzles with different numbers of givens. This section discusses the minimum number of givens for proper puzzles.</p>
<h3 id="ordinary-sudoku">Ordinary Sudoku</h3>

<p>A paper by Gary McGuire, Bastian Tugemann, and Gilles Civario, released on 1 January 2012 proved through exhaustive computer search that the minimum number of givens is 17 in general Sudoku.<a class="footnoteRef" href="#fn65" id="fnref65"><sup>65</sup></a> A few 17-clue puzzles with diagonal symmetry were provided by Ed Russell, after a search through equivalence transformations of <a href="Gordon_Royle" title="wikilink">Gordon Royle</a>'s database of 17-clue puzzles.<a class="footnoteRef" href="#fn66" id="fnref66"><sup>66</sup></a> When the positions of the givens are constrained to be half-turn rotationally symmetric, there exist 18-clue puzzles although it is not known whether this number is minimal.<a class="footnoteRef" href="#fn67" id="fnref67"><sup>67</sup></a></p>
<h3 id="sudoku-with-rectangular-regions-1">Sudoku with rectangular regions</h3>
<ul>
<li>4×4: a 55-clue puzzle<a class="footnoteRef" href="#fn68" id="fnref68"><sup>68</sup></a> has been provided. It is not known if this is the best possible.</li>
<li>5×5: a 151-clue puzzle<a class="footnoteRef" href="#fn69" id="fnref69"><sup>69</sup></a> has been provided. It is not known if this is the best possible.</li>
</ul>
<h3 id="sudoku-with-additional-constraints-1">Sudoku with additional constraints</h3>

<p> Additional constraints (here, on 3×3 Sudokus) lead to a smaller minimum number of clues.</p>
<ul>
<li>3doku: <em>no results for this variant</em></li>
<li>Disjoint Groups: some 12-clue puzzles<a class="footnoteRef" href="#fn70" id="fnref70"><sup>70</sup></a> have been demonstrated by Glenn Fowler. Later also 11-clue puzzles are found. It is not known if this is the best possible.</li>
</ul>
<ul>
<li>Hypercube: various 8-clue puzzles<a class="footnoteRef" href="#fn71" id="fnref71"><sup>71</sup></a> (the best possible) have been demonstrated by Guenter Stertenbrink.</li>
<li>Magic Sudoku: a 7-clue example<a class="footnoteRef" href="#fn72" id="fnref72"><sup>72</sup></a> has been provided by Guenter Stertenbrink. It is not known if this is the best possible.</li>
<li>Sudoku X: a list of 7193 12-clue puzzles<a class="footnoteRef" href="#fn73" id="fnref73"><sup>73</sup></a> has been collected by Ruud van der Werf. It is not known if this is the best possible.</li>
<li>NRC Sudoku: an 11-clue example<a class="footnoteRef" href="#fn74" id="fnref74"><sup>74</sup></a> has been provided by Andries Brouwer. It is not known if this is the best possible.</li>
<li>2-Quasi-Magic Sudoku: a 4-clue example<a class="footnoteRef" href="#fn75" id="fnref75"><sup>75</sup></a> has been provided by Tony Forbes. It is suspected that this is the best possible.</li>
</ul>
<h3 id="sudoku-with-irregular-regions">Sudoku with irregular regions</h3>

<p>"Du-sum-oh"<a class="footnoteRef" href="#fn76" id="fnref76"><sup>76</sup></a> (a.k.a. "geometry number place") puzzles replace the 3×3 (or <em>R</em>×<em>C</em>) regions of Sudoku with irregular shapes of a fixed size. Bob Harris has proved<a class="footnoteRef" href="#fn77" id="fnref77"><sup>77</sup></a> that it is always possible to create <em>N</em>-1 clue du-sum-ohs on an <em>N</em>×<em>N</em> grid, and has constructed several examples. Johan de Ruiter has proved<a class="footnoteRef" href="#fn78" id="fnref78"><sup>78</sup></a> that for any <em>N</em>&gt;3 there exist polyomino tilings that can not be turned into a Sudoku puzzle with <em>N</em> irregular shapes of size <em>N</em>.</p>
<h3 id="sum-number-place-killer-sudoku">Sum number place ("Killer Sudoku")</h3>

<p>In sum number place (Samunamupure), the regions are of irregular shape and various sizes. The usual constraints of no repeated value in any row, column or region apply. The clues are given as sums of values within regions (e.g. a 4-cell region with sum 10 must consist of values 1,2,3,4 in some order). The minimum number of clues for Samunamupure is not known, nor even conjectured.</p>

<p>A variant on Miyuki Misawa's web site<a class="footnoteRef" href="#fn79" id="fnref79"><sup>79</sup></a> replaces sums with relations: the clues are symbols <strong>=</strong>, <strong></strong> showing the relative values of (some but not all) adjacent region sums. She demonstrates an example with only eight relations. It is not known whether this is the best possible.</p>
<h2 id="method-and-algorithm-details-for-the-99-grid-direct-enumeration">Method and algorithm details for the 9×9 grid direct enumeration</h2>

<p>The strategy begins by analyzing the <a href="combinations_and_permutations" title="wikilink">permutations</a> of the top band used in valid solutions. Once the Band1 <a href="symmetry_in_mathematics" title="wikilink">symmetries</a> and <a href="equivalence_class" title="wikilink">equivalence class</a> for the partial solutions are identified, the completions of the lower two bands are constructed and counted for each equivalence class. Summing the completions over the equivalence classes gives the total number of solutions as 6,670,903,752,021,072,936,960 (c. ).</p>
<h3 id="counting-the-top-band-permutations">Counting the top band permutations</h3>

<p>The Band1 algorithm proceeds as follows:</p>
<ul>
<li>Choose a canonical labeling of the digits by assigning values for B1, e.g.</li>
</ul>
<pre><code>1 2 3
4 5 6
7 8 9</code></pre>
<dl>
<dd>Compute the rest of the Band1 permutations relative to the B1 canonical choice.
</dd>
</dl>
<ul>
<li>Compute the permutations of B2 by <a href="Partition_of_a_set" title="wikilink">partitioning</a> the B1 cell values over the B2 row <a href="#Definition_of_terms_and_labels" title="wikilink">triplets</a>. From the triplet combinations compute the B2 permutations. There are k=0..3 ways to choose the:</li>
</ul>
<dl>
<dd>B1 r11 values for B2 r22, the rest must go to r16,
</dd>
<dd>B1 r12 values for B2 r23, the rest must go to r16,
</dd>
<dd>B1 r13 values for B2 r21, the rest must go to r16, i.e.

<p>

<math display="block" id="Mathematics_of_Sudoku:17">
 <semantics>
  <mrow>
   <mtext>N combinations for B2</mtext>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>0..3</mn>
     </mrow>
    </munder>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mn>3</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>N combinations for B2</mtext>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>k</ci>
       <cn type="float">0..3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <cn type="integer">3</cn>
       <ci>k</ci>
      </apply>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mbox{N combinations for B2}=\sum_{k=0..3}{{3\choose k}^{3}}
  </annotation>
 </semantics>
</math>

 (This expression may be generalized to any <em>R</em>×3 box band variant. (Pettersen <a class="footnoteRef" href="#fn80" id="fnref80"><sup>80</sup></a>). Thus B2 contributes 56 × 6<sup>3</sup> permutations.</p>
<ul>
<li>The choices for B3 triplets are row-wise determined by the B1 B2 row triplets. B3 always contributes 6<sup>3</sup> permutations.</li>
</ul>

<p>The permutations for Band1 are 9! × 56 × 6<sup>6</sup> = 9! × 2612736 ~ .</p>
<h4 id="band1-permutation-details">Band1 permutation details</h4>

<p>The permutations of B1 are the number of ways to relabel the 9 digits, 9! = 362880. Counting the permutations for B2 is more complicated, because the choices for B2 depend on the values in B1. (This is a visual representation of the expression given above.) The conditional calculation needs a branch (sub-calculation) for each alternative. Fortunately, there are just 4 cases for the top B2 triplet (r21): it contains either 0, 1, 2, or 3 of the digits from the B1 middle row triplet(r12). Once this B2 top row choice is made, the rest of the B2 combinations are fixed. The Band1 row triplet labels are shown on the right.</p>

<p>(Note: Conditional combinations becomes an increasingly difficult as the computation progresses through the grid. At this point the impact is minimal.)</p>

<p>Case 0: No Overlap. The choices for the triplets can be determined by elimination.</p>
<dl>
<dt>r21 can't be r11 or r12 so it must be = r13; r31 must be = r12 etc.</dt>
</dl>

<p>The Case 0 diagram shows this configuration, where the pink cells are triplet values that can be arranged in any order within the triplet. Each triplet has 3! = 6 permutations. The 6 triplets contribute 6<sup>6</sup> permutations.</p>

<p>Case 3: 3 Digits Match: triplet r21 = r12. The same logic as case 0 applies, but with a different triplet usage. Triplet r22 must be = r13, etc. The number of permutations is again 6<sup>6</sup>. (Felgenhauer/Jarvis <a class="footnoteRef" href="#fn81" id="fnref81"><sup>81</sup></a> call the cases 0 and 3 the <em>pure match</em> case.</p>

<p>Case 1: 1 Match for r21 from r12</p>

<p>In the Case 1 diagram, B1 cells show canonical values, which are color-coded to show their row-wise distribution in B2 triplets. Colors reflect distribution but not location or values. For this case: the B2 top row triplet (r21) has 1 value from B1 middle triplet, the other colorings can now be deduced. E.g. the B2 bottom row triplet (r23) coloring is forced by r21: the other 2 B1 middle values must go to bottom, etc. Fill in the number of B2 options for each color, 3..1, beginning top left. The B3 color-coding is omitted since the B3 choices are row-wise determined by B1, B2. B3 always contributes 3! permutations per row triplet, or 6<sup>3</sup> for the block.</p>

<p>For B2, the triplet values can appear in any position, so a 3! permutation factor still applies, for each triplet. However, since some of the values were paired relative to their origin, using the raw option counts would overcount the number of permutations, due to interchangeability within the pairing. The option counts need to be divided by the permuted size of their grouping (2), here 2!.= 2 (See <a href="Combinations" title="wikilink">n Choose k</a>) The pair in each row cancels the 2s for the B2 option counts, leaving a B2 contribution of 3<sup>3</sup> × 6<sup>3</sup>. The B2×B3 combined contribution is 3<sup>3</sup> × 6<sup>6</sup>.</p>

<p>Case 2: 2 Matches for r21 from r12. The same logic as case 1 applies, but with the B2 option count column groupings reversed. Case 3 also contributes 3<sup>3</sup>×6<sup>6</sup> permutations.</p>

<p>Totaling the 4 cases for Band1 B1..B3 gives 9! × 2 × (3<sup>3</sup> + 1) × 6<sup>6</sup> = 9! 56 × 6<sup>6</sup> permutations.</p>
<h3 id="band1-symmetries-and-equivalence-classes">Band1 symmetries and equivalence classes</h3>

<p><em>Symmetries</em> are used to reduce the computational effort to enumerate the Band1 permutations.</p>

<p>A <a href="symmetry_in_mathematics" title="wikilink">symmetry in mathematics</a> is an operation that preserves a quality of an object. For a Sudoku solution grid, a symmetry is a transformation whose result is also a solution grid. The following symmetries apply independently for the top band:</p>
<ul>
<li>Block B1 values may be relabeled, giving 9! permutations</li>
<li>Blocks B1..3 may be interchanged, with 3!=6 permutations</li>
<li>Rows 1..3 may be interchanged, with 3!=6 permutations</li>
<li>Within each block, the 3 columns may be interchanged, giving 6<sup>3</sup> permutations.</li>
</ul>

<p>Combined, the symmetries give 9! × 6<sup>5</sup> = 362880 × 7776 equivalent permutations for each Band1 solution.</p>

<p>A symmetry defines an <a href="equivalence_relation" title="wikilink">equivalence relation</a>, here, between the solutions, and <a href="Partition_of_a_set" title="wikilink">partitions</a> the solutions into a set of <a href="equivalence_class" title="wikilink">equivalence classes</a>. The Band1 row, column and block symmetries divide the 56*6^6 permutations into (not less than) 336 (56×6) equivalence classes with (up to) 6<sup>5</sup> permutations in each, and 9! relabeling permutations for each class. (<em>Min/Max</em> caveats apply since some permutations may not yield distinct elements due to relabeling.)</p>

<p>Since the solution for any member of an equivalence class can be generated from the solution of any other member, we only need to enumerate the solutions for a single member in order to enumerate all solutions over all classes. Let</p>
<ul>
<li>sb : be a valid permutation of the top band</li>
<li>Sb = [sb] : be an equivalence class, relative to sb and some <a href="equivalence_relation" title="wikilink">equivalence relation</a></li>
<li>Sb.z = |Sb| : the size of Sb, be the number of sb elements (permutations) in [sb]</li>
<li>Sb.n : be the number of Band2,3 completions for (any) sb in Sb</li>
<li>{Sb} : be the set of all Sb equivalence classes relative to the <a href="equivalence_relation" title="wikilink">equivalence relation</a></li>
<li>{Sb}.z = |{Sb}| : be the number of equivalence classes</li>
</ul>

<p>The total number of solutions <em>N</em> is then:</p>

<p>

<math display="block" id="Mathematics_of_Sudoku:18">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mi>S</mi>
       <mi>b</mi>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </munder>
    <mrow>
     <mtext>Sb.z</mtext>
     <mo>×</mo>
     <mtext>Sb.n</mtext>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <set>
       <apply>
        <times></times>
        <ci>S</ci>
        <ci>b</ci>
       </apply>
      </set>
     </apply>
     <apply>
      <times></times>
      <mtext>Sb.z</mtext>
      <mtext>Sb.n</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=\sum_{\{Sb\}}\mbox{Sb.z}\times\mbox{Sb.n}
  </annotation>
 </semantics>
</math>

</p>
</dd>
</dl>
<h4 id="solution-and-counting-permutation-symmetry">Solution and counting permutation symmetry</h4>

<p>The Band1 symmetries (above) are <em>solution permutation symmetries</em> defined so that a permuted solution is also a solution. For the purpose of enumerating solutions, a <em>counting symmetry</em> for grid completion can be used to define band equivalence classes that yield a minimal number of classes.</p>

<p><em>Counting symmetry</em> partitions valid Band1 permutations into classes that place the same completion constraints on lower bands; all members of a band <em>counting symmetry</em> equivalence class must have the same number of grid completions since the completion constraints are equivalent. Counting symmetry constraints are identified by the Band1 column triplets (a column value set, no implied element order). Using band counting symmetry, a minimal generating set of 44 equivalence classes <a class="footnoteRef" href="#fn82" id="fnref82"><sup>82</sup></a> was established.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>The following sequence demonstrates mapping a band configuration to a counting symmetry equivalence class. Begin with a valid band configuration.</p></td>
<td style="text-align: left;">
<p>{{Sudoku 3x9 band|b1c=white|b2c=d8f0ff|align=right</p></td>
<td style="text-align: left;">
<p>title=Band1 Example</p></td>
<td style="text-align: left;">
<p>s1=1 |s2=2 |s3=3 |s4=5 |s5=8 |s6=6 |s7=7 |s8=4 |s9=9</p></td>
<td style="text-align: left;">
<p>s10=4|s11=5|s12=6|s13=9|s14=1|s15=7|s16=8|s17=2|s18=3</p></td>
<td style="text-align: left;">
<p>s19=7|s20=8|s21=9|s22=4|s23=3|s24=2|s25=5|s26=1|s27=6 }}</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Build column triplets by ordering the column values within each column. This is not a valid Sudoku band, but does place the same constraints on the lower bands as the example.</p></td>
<td style="text-align: left;">
<p>{{Sudoku 3x9 band|b1c=white|b2c=d8f0ff|align=right</p></td>
<td style="text-align: left;">
<p>title=Column Triplets</p></td>
<td style="text-align: left;">
<p>s1=1 |s2=2 |s3=3 |s4=4 |s5=1 |s6=2 |s7=5 |s8=1 |s9=3</p></td>
<td style="text-align: left;">
<p>s10=4|s11=5|s12=6|s13=5|s14=3|s15=6|s16=7|s17=2|s18=6</p></td>
<td style="text-align: left;">
<p>s19=7|s20=8|s21=9|s22=9|s23=8|s24=7|s25=8|s26=4|s27=9</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Construct an equivalence class ID from the B2, B3 column triplet values. Use column and box swaps to achieve the lowest lexicographical ID. The last figure shows the column and box ordering for the ID: 124 369 578 138 267 459. All Band1 permutations with this counting symmetry ID will have the same number of grid completions as the original example. An extension of this process can be used to build the largest possible <em>band counting symmetry</em> equivalence classes.</p></td>
<td style="text-align: left;">
<p>{{Sudoku 3x9 band|b1c=white|b3c=d8f0ff|align=right</p></td>
<td style="text-align: left;">
<p>title=Ordered Column Triplets</p></td>
<td style="text-align: left;">
<p>s1=1 |s2=2 |s3=3 |s4=1 |s5=3 |s6=5 |s7=1 |s8=2 |s9=4</p></td>
<td style="text-align: left;">
<p>s10=4|s11=5|s12=6|s13=2|s14=6|s15=7|s16=3|s17=6|s18=5</p></td>
<td style="text-align: left;">
<p>s19=7|s20=8|s21=9|s22=4|s23=9|s24=8|s25=8|s26=7|s27=9</p></td>
</tr>
</tbody>
</table>

<p>Note, while column triplets are used to construct and identify the equivalence classes, the class members themselves are the valid Band1 permutations: class size (Sb.z) reflects column triplet permutations compatible with the <em>One Rule</em> solution requirements. <em>Counting symmetry</em> is a completion property and applies only to a partial grid (band or stack). <em>Solution symmetry</em> for preserving solutions can be applied to either partial grids (bands, stacks) or full grid solutions. Lastly note, <em>counting symmetry</em> is more restrictive than simple numeric completion count equality: two (distinct) bands belong to the same <em>counting symmetry</em> equivalence class only if they impose equivalent completion constraints.</p>
<h4 id="band-1-reduction-details">Band 1 reduction details</h4>

<p>Symmetries group similar object into <a href="equivalence_class" title="wikilink">equivalence classes</a>. Two numbers need to be distinguished for equivalence classes, and band symmetries as used here, a third:</p>
<ul>
<li>the number of equivalence classes ({Sb}.n).</li>
<li>the <a class="uri" href="cardinality" title="wikilink">cardinality</a>, size or number of elements in an equivalence class, which may vary by class (Sb.z)</li>
<li>the number of Band2,3 completions compatible with a member of a Band1 equivalence class (Sb.n)</li>
</ul>

<p>The Band1 (6<sup>5</sup>) symmetries divide the (56×6<sup>6</sup>) Band1 valid permutations into (not less than) 336 (56×6) equivalence classes with (up to) 6^5 permutations each. The <em>not less than</em> and <em>up to</em> caveats are necessary, since some combinations of the transformations may not produce distinct results, when relabeling is required (see below). Consequently some equivalence classes may contain less than 6<sup>5</sup> distinct permutations and the theoretical minimum number of classes may not be achieved.</p>

<p>Each of the valid Band1 permutations can be expanded (completed) into a specific number of solutions with the Band2,3 permutations. By virtue of their similarity, each member of an equivalence class will have the same number of completions. Consequently we only need to construct the solutions for one member of each equivalence class and then multiply the number of solutions by the size of the equivalence class.</p>

<p>We are still left with the task of identifying and calculating the size of each equivalence class. Further progress requires the dexterous application of computational techniques to catalogue (classify and count) the permutations into equivalence classes.</p>

<p>Felgenhauer/Jarvis <a class="footnoteRef" href="#fn83" id="fnref83"><sup>83</sup></a> catalogued the Band1 permutations using <a href="lexicographical_order" title="wikilink">lexicographical ordered</a> IDs based on the ordered digits from blocks B2,3. Block 1 uses a canonical digit assignment and is not needed for a unique ID. Equivalence class identification and linkage uses the lowest ID within the class.</p>

<p>Application of the (2×6<sup>2</sup>) B2,3 symmetry permutations produces 36288 (28×6<sup>4</sup>) equivalence classes, each of size 72. Since the size is fixed, the computation only needs to find the 36288 equivalence class IDs. (Note: in this case, for any Band1 permutation, applying these permutations to achieve the lowest ID provides an index to the associated equivalence class.)</p>

<p>Application of the rest of the block, column and row symmetries provided further reduction, i.e. allocation of the 36288 IDs into fewer, larger equivalence classes. When the B1 canonical labeling is lost through a transformation, the result is relabeled to the canonical B1 usage and then catalogued under this ID. This approach generated 416 equivalence classes, somewhat less effective than the theoretical 336 minimum limit for a full reduction.</p>

<p>Application of <em>counting symmetry</em> patterns for <em>duplicate paired</em> digits achieved reduction to 174 and then to 71 equivalence classes. The introduction of equivalence classes based on <em>band counting symmetry</em> (subsequent to Felgenhauer/Jarvis by Russell <a class="footnoteRef" href="#fn84" id="fnref84"><sup>84</sup></a>) reduced the equivalence classes to a minimum generating set of 44.</p>

<p>The diversity of the ~, 56×6<sup>6</sup> Band1 permutations can be reduced to a set of 44 Band1 equivalence classes. Each of the 44 equivalence classes can be expanded to millions of distinct full solutions, but the entire solution space has a common origin in these 44. The 44 equivalence classes play a central role in other enumeration approaches as well, and speculation will return to the characteristics of the 44 classes when puzzle properties are explored later.</p>
<h3 id="band-2-3-completion-and-results">Band 2-3 completion and results</h3>

<p>Enumerating the Sudoku solutions breaks into an initial setup stage and then into two nested loops. Initially all the valid Band1 permutations are grouped into equivalence classes, who each impose a common constraint on the Band2,3 completions. For each of the Band1 equivalence classes, all possible Band2,3 solutions need to be enumerated. An outer Band1 loop iterates over the 44 equivalence classes. In the inner loop, all lower band completions for each of the Band1 equivalence class are found and counted.</p>

<p>The computation required for the lower band solution search can be minimised by the same type of symmetry application used for Band1. There are 6! (720) permutations for the 6 values in column 1 of Band2,3. Applying the lower band (2) and row within band (6×6) permutations creates 10 equivalence classes of size 72. At this point, completing 10 sets of solutions for the remaining 48 cells with a recursive descent, <a class="uri" href="backtracking" title="wikilink">backtracking</a> algorithm is feasible with 2 GHz class PC so further simplification is not required to carry out the enumeration.</p>

<p>Using this approach, the number of ways of filling in a blank Sudoku grid has been shown to be 6,670,903,752,021,072,936,960 ().<a class="footnoteRef" href="#fn85" id="fnref85"><sup>85</sup></a></p>

<p>The result, as confirmed by Russell,<a class="footnoteRef" href="#fn86" id="fnref86"><sup>86</sup></a> also contains the distribution of solution counts for the 44 equivalence classes. The listed values are before application of the 9! factor for labeling and the two 72 factors (72<sup>2</sup> = 5184) for each of Stack 2,3 and Band2,3 permutations. The number of completions for each class is consistently on the order of 100,000,000, while the number of Band1 permutations covered by each class however varies from 4 – 3240. Within this wide size range, there are clearly two clusters. Ranked by size, the lower 33 classes average ~400 permutations/class, while the upper 11 average ~2100. The disparity in consistency between the distributions for size and number of completions or the separation into two clusters by size is yet to be examined.</p>
<h2 id="constraints-of-clue-geometry">Constraints of Clue Geometry</h2>

<p>It has been postulated that no proper sudoku can have clues limited to the range of positions in the pattern below.<a class="footnoteRef" href="#fn87" id="fnref87"><sup>87</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>A range of clue positions insufficient for a proper sudoku</figcaption>
</figure>

<p>The largest rectangular orthogonal "hole" (region with no clues) in a proper sudoku is believed to be a rectangle of 30 cells (a 5 x 6 rectangular area).<a class="footnoteRef" href="#fn88" id="fnref88"><sup>88</sup></a> <a class="footnoteRef" href="#fn89" id="fnref89"><sup>89</sup></a> One such example is the following with 22 clues: </p>

<p>The largest total number of empty groups (rows, columns, and squares) in a sudoku is believed to be nine. One example is the following; a sudoku which has 3 empty squares, 3 empty rows, and 3 empty columns and gives 22 clues.<a class="footnoteRef" href="#fn90" id="fnref90"><sup>90</sup></a> <a class="footnoteRef" href="#fn91" id="fnref91"><sup>91</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>Sudoku with nine empty groups</figcaption>
</figure>
<h2 id="automorphic-sudokus">Automorphic Sudokus</h2>

<p>Automorphic sudokus are sudoku puzzles which solve to an automorphic grid. A grid is automorphic if it can be transformed in a way that leads back to the original grid, when that same transformation would not otherwise lead back to the original grid. An example of a grid which is automorphic would be a grid which can be rotated 180 degrees resulting in a new grid where the new cell values are a permutation of the original grid. An example of an automorphic sudoku which solves to such a grid is below.<a class="footnoteRef" href="#fn92" id="fnref92"><sup>92</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>Example of an Automorphic Sudoku</figcaption>
</figure>

<p>Notice that if this sudoku is rotated 180 degrees, and the clues relabeled with the permutation (123456789) -&gt; (987654321), it returns to the same sudoku. Expressed another way, this sudoku has the property that every 180 degree rotational pair of clues (a, b) follows the rule (a) + (b) = 10.</p>

<p>Since this sudoku is automorphic, so too its solution grid must be automorphic. Furthermore, every cell which is solved has a symmetrical partner which is solved with the same technique (and the pair would take the form a + b = 10).</p>

<p>In this example the automorphism is easy to identify, but in general automorphism is not always obvious. There are several types of transformations of a sudoku, and therefore automorphism can take several different forms too. Among the population of all sudoku grids, those that are automorphic are rare. They are considered interesting because of their intrinsic mathematical symmetry.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Sudoku" title="wikilink">Sudoku</a> — main Sudoku article</li>
<li><a href="List_of_Sudoku_terms_and_jargon" title="wikilink">List of Sudoku terms and jargon</a></li>
<li><a href="Dancing_Links" title="wikilink">Dancing Links</a> — Donald Knuth</li>
<li><a href="Algorithmics_of_sudoku" title="wikilink">Algorithmics of sudoku</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://plus.maths.org/latestnews/jan-apr06/sudoku/index.html">V. Elser's difference-map algorithm also solves Sudoku</a></li>
<li><a href="http://www.visual-prolog.com/vip/example/pdcExample/sudoku.htm">Sudoku Puzzle — an Exercise in Constraint Programming and Visual Prolog 7</a> by Carsten Kehler Holst (in <a href="Visual_Prolog" title="wikilink">Visual Prolog</a>)</li>
<li><a href="http://www.ams.org/notices/200706/tx070600708p.pdf">Sudoku Squares and Chromatic Polynomials</a> by Herzberg and Murty, treats Sudoku puzzles as <a href="graph_coloring" title="wikilink">vertex coloring</a> problems in <a href="graph_theory" title="wikilink">graph theory</a>.</li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Sudoku" title="wikilink">Category:Sudoku</a> <a href="Category:Latin_squares" title="wikilink">Category:Latin squares</a> <a href="Category:Recreational_mathematics" title="wikilink">Category:Recreational mathematics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">.<a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"> <a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15">.<a href="#fnref15">↩</a></li>
<li id="fn16"></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"></li>
<li id="fn31"></li>
<li id="fn32"><a href="#fnref32">↩</a></li>
<li id="fn33"><a href="#fnref33">↩</a></li>
<li id="fn34"></li>
<li id="fn35"><a href="#fnref35">↩</a></li>
<li id="fn36"><a href="#fnref36">↩</a></li>
<li id="fn37"></li>
<li id="fn38"><a href="#fnref38">↩</a></li>
<li id="fn39"></li>
<li id="fn40"></li>
<li id="fn41"><a href="#fnref41">↩</a></li>
<li id="fn42"></li>
<li id="fn43"></li>
<li id="fn44"></li>
<li id="fn45"></li>
<li id="fn46"><a href="#fnref46">↩</a></li>
<li id="fn47"></li>
<li id="fn48"></li>
<li id="fn49"></li>
<li id="fn50"><a href="#fnref50">↩</a></li>
<li id="fn51"><a href="#fnref51">↩</a></li>
<li id="fn52"><a href="#fnref52">↩</a></li>
<li id="fn53"><a href="#fnref53">↩</a></li>
<li id="fn54"><a href="#fnref54">↩</a></li>
<li id="fn55"><a href="#fnref55">↩</a></li>
<li id="fn56"><a href="#fnref56">↩</a></li>
<li id="fn57"></li>
<li id="fn58"></li>
<li id="fn59"><a href="#fnref59">↩</a></li>
<li id="fn60"><a href="#fnref60">↩</a></li>
<li id="fn61"><a href="#fnref61">↩</a></li>
<li id="fn62"><a href="#fnref62">↩</a></li>
<li id="fn63"><a href="#fnref63">↩</a></li>
<li id="fn64"><a href="#fnref64">↩</a></li>
<li id="fn65"><a href="#fnref65">↩</a></li>
<li id="fn66"><a href="#fnref66">↩</a></li>
<li id="fn67">. See in particular Figure 7, p. 7.<a href="#fnref67">↩</a></li>
<li id="fn68"><a href="#fnref68">↩</a></li>
<li id="fn69"></li>
<li id="fn70"><a href="#fnref70">↩</a></li>
<li id="fn71"><a href="#fnref71">↩</a></li>
<li id="fn72"><a href="#fnref72">↩</a></li>
<li id="fn73"><a href="#fnref73">↩</a></li>
<li id="fn74"></li>
<li id="fn75"><a href="#fnref75">↩</a></li>
<li id="fn76"><a href="#fnref76">↩</a></li>
<li id="fn77"><a href="#fnref77">↩</a></li>
<li id="fn78"><a href="#fnref78">↩</a></li>
<li id="fn79"><a href="http://www7a.biglobe.ne.jp/~sumnumberplace/79790008/"></a><a href="#fnref79">↩</a></li>
<li id="fn80"></li>
<li id="fn81"></li>
<li id="fn82"><a href="#fnref82">↩</a></li>
<li id="fn83"></li>
<li id="fn84"></li>
<li id="fn85"></li>
<li id="fn86"></li>
<li id="fn87"><a href="#fnref87">↩</a></li>
<li id="fn88"><a href="#fnref88">↩</a></li>
<li id="fn89"><a href="#fnref89">↩</a></li>
<li id="fn90"><a href="#fnref90">↩</a></li>
<li id="fn91"><a href="#fnref91">↩</a></li>
<li id="fn92"><a href="#fnref92">↩</a></li>
</ol>
</section>
</body>
</html>

   Lambert's problem      Lambert's problem   In celestial mechanics  Lambert's problem is concerned with the determination of an orbit from two position vectors and the time of flight, solved by Johann Heinrich Lambert . It has important applications in the areas of rendezvous, targeting, guidance, and preliminary orbit determination. 1 Suppose a body under the influence of a central gravitational force is observed to travel from point P 1 on its conic trajectory, to a point P 2 in a time T . The time of flight is related to other variables by Lambert’s theorem, which states:   The transfer time of a body moving between two points on a conic trajectory is a function only of the sum of the distances of the two points from the origin of the force, the linear distance between the points, and the semimajor axis of the conic. 2    Stated another way, Lambert's problem is the boundary value problem for the differential equation        r  ¯   ¨   =   -   μ  ⋅     r  ^    r  2            normal-¨   normal-¯  r       normal-⋅  μ     normal-^  r    superscript  r  2        \ddot{\bar{r}}=-\mu\cdot\frac{\hat{r}}{r^{2}}\     of the two-body problem for which the Kepler orbit is the general solution.  The precise formulation of Lambert's problem is as follows:  Two different times       t   1    ,   t  2       subscript  t  1    subscript  t  2     \ t_{1}\ ,\ t_{2}   and two position vectors       r  ¯   1   =    r  1     r  ^   1     ,     r  ¯   2   =    r  2     r  ^   2        formulae-sequence     subscript   normal-¯  r   1      subscript  r  1    subscript   normal-^  r   1        subscript   normal-¯  r   2      subscript  r  2    subscript   normal-^  r   2       \bar{r}_{1}=r_{1}{\hat{r}}_{1},\ \bar{r}_{2}=r_{2}{\hat{r}}_{2}   are given.  Find the solution     r  ¯    (  t  )        normal-¯  r   t    \bar{r}(t)   satisfying the differential equation above for which        r  ¯    (   t  1   )    =    r  ¯   1          normal-¯  r    subscript  t  1     subscript   normal-¯  r   1     \bar{r}(t_{1})=\bar{r}_{1}            r  ¯    (   t  2   )    =    r  ¯   2    .         normal-¯  r    subscript  t  2     subscript   normal-¯  r   2     \bar{r}(t_{2})=\bar{r}_{2}.     Initial geometrical analysis  [[Image:Lambert Fig1.png|thumb|right|300px| Figure 1:      F  1     subscript  F  1    F_{1}   : The centre of attraction      P  1     subscript  P  1    P_{1}   : The point corresponding to vector     r  ¯   1     subscript   normal-¯  r   1    \bar{r}_{1}       P  2     subscript  P  2    P_{2}   : The point corresponding to vector     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}   ]] [[Image:Lambert Fig2.png|thumb|right|300px| Figure 2:  Hyperbola with the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   as foci passing through    F  1     subscript  F  1    F_{1}   ]] [[Image:Lambert Fig3.png|thumb|right|300px| Figure 3:  Ellipse with the points    F  1     subscript  F  1    F_{1}   and    F  2     subscript  F  2    F_{2}   as foci passing through    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   ]]  The three points       F  1     subscript  F  1    F_{1}   : The centre of attraction     P  1     subscript  P  1    P_{1}   : The point corresponding to vector     r  ¯   1     subscript   normal-¯  r   1    \bar{r}_{1}        P  2     subscript  P  2    P_{2}   : The point corresponding to vector     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}      form a triangle in the plane defined by the vectors     r  ¯   1     subscript   normal-¯  r   1    \bar{r}_{1}   and     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}   as illustrated in figure 1. The distance between the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   is    2  d      2  d    2d   , the distance between the points    P  1     subscript  P  1    P_{1}   and    F  1     subscript  F  1    F_{1}   is     r  1   =    r  m   -  A        subscript  r  1      subscript  r  m   A     r_{1}=r_{m}-A   and the distance between the points    P  2     subscript  P  2    P_{2}   and    F  1     subscript  F  1    F_{1}   is     r  2   =    r  m   +  A        subscript  r  2      subscript  r  m   A     r_{2}=r_{m}+A   . The value   A   A   A   is positive or negative depending on which of the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   that is furthest away from the point    F  1     subscript  F  1    F_{1}   . The geometrical problem to solve is to find all ellipses that go through the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   and have a focus at the point    F  1     subscript  F  1    F_{1}     The points    F  1     subscript  F  1    F_{1}   ,    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   define a hyperbola going through the point    F  1     subscript  F  1    F_{1}   with foci at the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   . The point    F  1     subscript  F  1    F_{1}   is either on the left or on the right branch of the hyperbola depending on the sign of   A   A   A   . The semi-major axis of this hyperbola is    |  A  |      A    |A|   and the eccentricity   E   E   E   is    d   |  A  |       d    A     \frac{d}{|A|}   . This hyperbola is illustrated in figure 2.  Relative the usual canonical coordinate system defined by the major and minor axis of the hyperbola its equation is         x  2    A  2    -    y  2    B  2     =   1   (  1  )             superscript  x  2    superscript  A  2       superscript  y  2    superscript  B  2      1  1     \frac{x^{2}}{A^{2}}-\frac{y^{2}}{B^{2}}=1\quad(1)     with       B  =    |  A  |      E  2   -  1     =     d  2   -   A  2       (  2  )      formulae-sequence      B      A        superscript  E  2   1               superscript  d  2    superscript  A  2       2    B=|A|\sqrt{E^{2}-1}=\sqrt{d^{2}-A^{2}}\quad(2)     For any point on the same branch of the hyperbola as    F  1     subscript  F  1    F_{1}   the difference between the distances    r  2     subscript  r  2    r_{2}   to point    P  2     subscript  P  2    P_{2}   and    r  1     subscript  r  1    r_{1}   to point    P  1     subscript  P  1    P_{1}   is        r  2   -   r  1    =    2  A    (  3  )           subscript  r  2    subscript  r  1       2  A   3     r_{2}-r_{1}=2A\quad(3)     For any point    F  2     subscript  F  2    F_{2}   on the other branch of the hyperbola corresponding relation is        s  1   -   s  2    =    2  A    (  4  )           subscript  s  1    subscript  s  2       2  A   4     s_{1}-s_{2}=2A\quad(4)     i.e.        r  1   +   s  1    =     r  2   +   s  2     (  5  )           subscript  r  1    subscript  s  1        subscript  r  2    subscript  s  2    5     r_{1}+s_{1}=r_{2}+s_{2}\quad(5)     But this means that the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   both are on the ellipse having the focal points    F  1     subscript  F  1    F_{1}   and    F  2     subscript  F  2    F_{2}   and the semi-major axis       a  =     r  1   +   s  1    2   =     r  2   +   s  2    2     (  6  )      formulae-sequence      a       subscript  r  1    subscript  s  1    2             subscript  r  2    subscript  s  2    2     6    a=\frac{r_{1}+s_{1}}{2}=\frac{r_{2}+s_{2}}{2}\quad(6)     The ellipse corresponding to an arbitrary selected point    F  2     subscript  F  2    F_{2}   is displayed in figure 3.  Solution of Lambert's problem assuming an elliptic transfer orbit  First one separates the cases of having the orbital pole in the direction      r  ¯   1   ×    r  ¯   2        subscript   normal-¯  r   1    subscript   normal-¯  r   2     \bar{r}_{1}\times\bar{r}_{2}   or in the direction    -     r  ¯   1   ×    r  ¯   2           subscript   normal-¯  r   1    subscript   normal-¯  r   2      -\bar{r}_{1}\times\bar{r}_{2}   . In the first case the transfer angle   α   α   \alpha   for the first passage through     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}   will be in the interval    0  <  α  <   180  ∘         0  α        superscript  180       \ 0<\alpha<180^{\circ}   and in the second case it will be in the interval     180  ∘   <  α  <   360  ∘          superscript  180    α        superscript  360       180^{\circ}<\alpha<360^{\circ}   . Then     r  ¯    (  t  )        normal-¯  r   t    \bar{r}(t)   will continue to pass through     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}   every orbital revolution.  In case      r  ¯   1   ×    r  ¯   2        subscript   normal-¯  r   1    subscript   normal-¯  r   2     \bar{r}_{1}\times\bar{r}_{2}   is zero, i.e.     r  ¯   1     subscript   normal-¯  r   1    \bar{r}_{1}   and     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}   have opposite directions, all orbital planes containing corresponding line are equally adequate and the transfer angle   α   α   \alpha   for the first passage through     r  ¯   2     subscript   normal-¯  r   2    \bar{r}_{2}   will be    180  ∘     superscript  180     180^{\circ}   .  For any   α   α   \alpha   with    0  <  α  <   \infin         0  α       \infin     \ 0<\alpha<\infin   the triangle formed by    P  1     subscript  P  1    P_{1}   ,    P  2     subscript  P  2    P_{2}   and    F  1     subscript  F  1    F_{1}   are as in figure 1 with      d  =        r  1    2   +   r  2    2    -   2   r  1    r  2    cos  α      2    (  7  )        d            superscript   subscript  r  1   2    superscript   subscript  r  2   2      2   subscript  r  1    subscript  r  2     α      2   7     d=\frac{\sqrt{{r_{1}}^{2}+{r_{2}}^{2}-2r_{1}r_{2}\cos\alpha}}{2}\quad(7)     and the semi-major axis (with sign!) of the hyperbola discussed above is      A  =      r  2   -   r  1    2    (  8  )        A        subscript  r  2    subscript  r  1    2   8     A=\frac{r_{2}-r_{1}}{2}\quad(8)     The eccentricity (with sign!) for the hyperbola is      E  =    d  A    (  9  )        E     d  A   9     E=\frac{d}{A}\quad(9)     and the semi-minor axis is       B  =    |  A  |      E  2   -  1     =     d  2   -   A  2       (  10  )      formulae-sequence      B      A        superscript  E  2   1               superscript  d  2    superscript  A  2       10    B=|A|\sqrt{E^{2}-1}=\sqrt{d^{2}-A^{2}}\quad(10)   The coordinates of the point    F  1     subscript  F  1    F_{1}   relative the canonical coordinate system for the hyperbola are (note that   E   E   E   has the sign of     r  2   -   r  1        subscript  r  2    subscript  r  1     r_{2}-r_{1}   )       x  0   =    -    r  m   E     (  11  )         subscript  x  0         subscript  r  m   E    11     x_{0}=-\frac{r_{m}}{E}\quad(11)          y  0   =    B      (    x  0   A   )   2   -  1      (  12  )         subscript  y  0      B       superscript     subscript  x  0   A   2   1     12     y_{0}=B\sqrt{{\left(\frac{x_{0}}{A}\right)}^{2}-1}\quad(12)     where       r  m   =      r  2   +   r  1    2    (  13  )         subscript  r  m         subscript  r  2    subscript  r  1    2   13     r_{m}=\frac{r_{2}+r_{1}}{2}\quad(13)     Using the y-coordinate of the point    F  2     subscript  F  2    F_{2}   on the other branch of the hyperbola as free parameter the x-coordinate of    F  2     subscript  F  2    F_{2}   is (note that   A   A   A   has the sign of     r  2   -   r  1        subscript  r  2    subscript  r  1     r_{2}-r_{1}   )      x  =    A    1  +    (   y  B   )   2       (  14  )        x     A      1   superscript    y  B   2      14     x=A\sqrt{1+{\left(\frac{y}{B}\right)}^{2}}\quad(14)     The semi-major axis of the ellipse passing through the points    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   having the foci    F  1     subscript  F  1    F_{1}   and    F  2     subscript  F  2    F_{2}   is       a  =     r  1   +   s  1    2   =      r  2   +   s  2    2    =     r  m   +   E  x    2     (  15  )      formulae-sequence      a       subscript  r  1    subscript  s  1    2             subscript  r  2    subscript  s  2    2             subscript  r  m     E  x    2     15    a=\frac{r_{1}+s_{1}}{2}=\frac{r_{2}+s_{2}}{2}\ =\frac{r_{m}+Ex}{2}\quad(15)     The distance between the foci is          (    x  0   -  x   )   2   +    (    y  0   -  y   )   2      (  16  )           superscript     subscript  x  0   x   2    superscript     subscript  y  0   y   2     16    \sqrt{{(x_{0}-x)}^{2}+{(y_{0}-y)}^{2}}\quad(16)     and the eccentricity is consequently      e  =        (    x  0   -  x   )   2   +    (    y  0   -  y   )   2      2  a     (  17  )        e          superscript     subscript  x  0   x   2    superscript     subscript  y  0   y   2       2  a    17     e=\frac{\sqrt{{(x_{0}-x)}^{2}+{(y_{0}-y)}^{2}}}{2a}\quad(17)     The true anomaly    θ  1     subscript  θ  1    \theta_{1}   at point    P  1     subscript  P  1    P_{1}   depends on the direction of motion, i.e. if    sin  α      α    \sin\alpha   is positive or negative. In both cases one has that       cos   θ  1    =    -      (    x  0   +  d   )    f  x    +    y  0    f  y      r  1      (  18  )           subscript  θ  1                subscript  x  0   d    subscript  f  x       subscript  y  0    subscript  f  y      subscript  r  1     18     \cos\theta_{1}=-\frac{(x_{0}+d)f_{x}+y_{0}f_{y}}{r_{1}}\quad(18)     where       f  x   =      x  0   -  x       (    x  0   -  x   )   2   +    (    y  0   -  y   )   2       (  19  )         subscript  f  x         subscript  x  0   x        superscript     subscript  x  0   x   2    superscript     subscript  y  0   y   2      19     f_{x}=\frac{x_{0}-x}{\sqrt{{(x_{0}-x)}^{2}+{(y_{0}-y)}^{2}}}\quad(19)          f  y   =      y  0   -  y       (    x  0   -  x   )   2   +    (    y  0   -  y   )   2       (  20  )         subscript  f  y         subscript  y  0   y        superscript     subscript  x  0   x   2    superscript     subscript  y  0   y   2      20     f_{y}=\frac{y_{0}-y}{\sqrt{{(x_{0}-x)}^{2}+{(y_{0}-y)}^{2}}}\quad(20)     is the unit vector in the direction from    P  2     subscript  P  2    P_{2}   to    P  1     subscript  P  1    P_{1}   expressed in the canonical coordinates.  If    sin  α      α    \sin\alpha   is positive then       sin   θ  1    =       (    x  0   +  d   )    f  y    -    y  0    f  x      r  1     (  21  )           subscript  θ  1              subscript  x  0   d    subscript  f  y       subscript  y  0    subscript  f  x      subscript  r  1    21     \sin\theta_{1}=\frac{(x_{0}+d)f_{y}-y_{0}f_{x}}{r_{1}}\quad(21)     If    sin  α      α    \sin\alpha   is negative then       sin   θ  1    =    -      (    x  0   +  d   )    f  y    -    y  0    f  x      r  1      (  22  )           subscript  θ  1                subscript  x  0   d    subscript  f  y       subscript  y  0    subscript  f  x      subscript  r  1     22     \sin\theta_{1}=-\frac{(x_{0}+d)f_{y}-y_{0}f_{x}}{r_{1}}\quad(22)     With   semi-major axis  eccentricity  initial true anomaly   being known functions of the parameter y the time for the true anomaly to increase with the amount   α   α   \alpha   is also a known function of y. If     t  2   -   t  1        subscript  t  2    subscript  t  1     t_{2}-t_{1}   is in the range that can be obtained with an elliptic Kepler orbit corresponding y value can then be found using an iterative algorithm.  In the special case that     r  1   =   r  2        subscript  r  1    subscript  r  2     r_{1}=r_{2}   (or very close)    A  =  0      A  0    A=0   and the hyperbola with two branches deteriorates into one single line orthogonal to the line between    P  1     subscript  P  1    P_{1}   and    P  2     subscript  P  2    P_{2}   with the equation      x  =   0   (   1  ′   )        x   0   superscript  1  normal-′      x=0\quad(1^{\prime})     Equations (11) and (12) are then replaced with       x  0   =   0   (   11  ′   )         subscript  x  0    0   superscript  11  normal-′      x_{0}=0\quad(11^{\prime})          y  0   =      r  m    2   -   d  2      (   12  ′   )         subscript  y  0         superscript   subscript  r  m   2    superscript  d  2      superscript  12  normal-′      y_{0}=\sqrt{{r_{m}}^{2}-d^{2}}\quad(12^{\prime})     (14) is replaced by      x  =   0   (   14  ′   )        x   0   superscript  14  normal-′      x=0\quad(14^{\prime})     and (15) is replaced by      a  =      r  m   +     d  2   +   y  2      2    (   15  ′   )        a        subscript  r  m        superscript  d  2    superscript  y  2      2    superscript  15  normal-′      a=\frac{r_{m}+\sqrt{d^{2}+y^{2}}}{2}\quad(15^{\prime})     Numerical example  [[Image:Lambert Fig4.png|thumb|right|300px| Figure 4: The transfer time with   r 1 = 10000 km  r 2 = 16000 km  α = 120°   as a function of y when y varies from −20000 km to 50000 km. The transfer time decreases from 20741 seconds with y = −20000 km to 2856 seconds with y = 50000 km. For any value between 2856 seconds and 20741 seconds the Lambert's problem can be solved using an y -value between −20000 km and 50000 km ]]  Assume the following values for an Earth centred Kepler orbit   r 1 = 10000 km  r 2 = 16000 km  α = 100°   These are the numerical values that correspond to figures 1, 2, and 3.  Selecting the parameter y as 30000 km one gets a transfer time of 3072 seconds assuming the gravitational constant to be   μ   μ   \mu   = 398603 km 3 /s 2 . Corresponding orbital elements are   semi-major axis = 23001 km  eccentricity = 0.566613  true anomaly at time t 1 = −7.577°  true anomaly at time t 2 = 92.423°   This y -value corresponds to Figure 3.  With   r 1 = 10000 km  r 2 = 16000 km  α = 260°   one gets the same ellipse with the opposite direction of motion, i.e.   true anomaly at time t 1 = 7.577°  true anomaly at time t 2 = 267.577° = 360° − 92.423°   and a transfer time of 31645 seconds.  The radial and tangential velocity components can then be computed with the formulas (see the Kepler orbit article)       V  r   =     μ  p    ⋅  e  ⋅   sin  θ         subscript  V  r    normal-⋅      μ  p    e    θ      V_{r}=\sqrt{\frac{\mu}{p}}\cdot e\cdot\sin\theta           V  t   =     μ  p    ⋅   (   1  +   e  ⋅   cos  θ     )     .       subscript  V  t    normal-⋅      μ  p      1   normal-⋅  e    θ        V_{t}=\sqrt{\frac{\mu}{p}}\cdot(1+e\cdot\cos\theta).     The transfer times from P 1 to P 2 for other values of y are displayed in Figure 4.  Practical applications  The most typical use of this algorithm to solve Lambert's problem is certainly for the design of interplanetary missions. A spacecraft traveling from the Earth to for example Mars can in first approximation be considered to follow a heliocentric elliptic Kepler orbit from the position of the Earth at the time of launch to the position of Mars at the time of arrival. By comparing the initial and the final velocity vector of this heliocentric Kepler orbit with corresponding velocity vectors for the Earth and Mars a quite good estimate of the required launch energy and of the maneuvres needed for the capture at Mars can be obtained. This approach is often used in conjunction with the Patched Conic Approximation . This is also a method for Orbit determination . If two positions of a spacecraft at different times are known with good precision from for example a GPS fix the complete orbit can be derived with this algorithm, i.e. an interpolation and an extrapolation of these two position fixes is obtained.  Open source code to solve Lambert's problem  From MATLAB central  PyKEP a Python library for space flight mechanics and astrodynamics (contains a Lambert's solver, implemented in C++ and exposed to python via boost python)  References  "  Category:Orbits  Category:Conic sections     E. R. Lancaster & R. C. Blanchard, A Unified Form of Lambert’s Theorem , Goddard Space Flight Center, 1968 ↩  James F. Jordon, The Application of Lambert’s Theorem to the Solution of Interplanetary Transfer Problems , Jet Propulsion Laboratory, 1964 ↩     
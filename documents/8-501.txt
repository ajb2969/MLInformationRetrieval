   Total variation diminishing      Total variation diminishing   In numerical methods , total variation diminishing (TVD) is a property of certain discretization schemes used to solve hyperbolic partial differential equations . The most notable application of this method is in computational fluid dynamics . The concept of TVD was introduced by Ami Harten . 1  Model equation  In systems described by partial differential equations , such as the following hyperbolic advection equation ,         P
                           a
                           r
                           t
                            
                           I
                         
                         u
                       
                       
                         
                           I
                         
                         u  P
                           a
                           r
                           t
                            
                           I
                           I
                         
                         t
                       
                       
                         
                           I
                           I
                         
                         t   +   a   P
                             a
                             r
                             t
                              
                             I
                             I
                             I
                           
                           u
                         
                         
                           
                             I
                             I
                             I
                           
                           u  P
                             a
                             r
                             t
                              
                             I
                             V
                           
                           x
                         
                         
                           
                             I
                             V
                           
                           x     =  0   ,          P
                           a
                           r
                           t
                            
                           I
                         
                         u
                       
                       
                         
                           I
                         
                         u  P
                           a
                           r
                           t
                            
                           I
                           I
                         
                         t
                       
                       
                         
                           I
                           I
                         
                         t     a    P
                             a
                             r
                             t
                              
                             I
                             I
                             I
                           
                           u
                         
                         
                           
                             I
                             I
                             I
                           
                           u  P
                             a
                             r
                             t
                              
                             I
                             V
                           
                           x
                         
                         
                           
                             I
                             V
                           
                           x     0    \frac{\@@section{part}{Pt1}{I}{Part~I}{{\@tag[][]{I}u}}{{\@tag[][]{Part~I}u}}}%
 {\@@section{part}{Pt2}{II}{Part~II}{{\@tag[][]{II}t}}{{\@tag[][]{Part~II}t}}}+%
 a\frac{\@@section{part}{Pt3}{III}{Part~III}{{\@tag[][]{III}u}}{{\@tag[][]{Part%
 ~III}u}}}{\@@section{part}{Pt4}{IV}{Part~IV}{{\@tag[][]{IV}x}}{{\@tag[][]{Part%
 ~IV}x}}}=0,     the total variation (TV) is given by,        T  V   =   ∫    |   P
                                 a
                                 r
                                 t
                                  
                                 V
                               
                               u
                             
                             
                               
                                 V
                               
                               u  P
                                 a
                                 r
                                 t
                                  
                                 V
                                 I
                               
                               x
                             
                             
                               
                                 V
                                 I
                               
                               x   |   d  x     ,        T  V           P
                                 a
                                 r
                                 t
                                  
                                 V
                               
                               u
                             
                             
                               
                                 V
                               
                               u  P
                                 a
                                 r
                                 t
                                  
                                 V
                                 I
                               
                               x
                             
                             
                               
                                 V
                                 I
                               
                               x    d  x      TV=\int\left|\frac{\@@section{part}{Pt5}{V}{Part~V}{{\@tag[][]{V}u}}{{\@tag[][%
 ]{Part~V}u}}}{\@@section{part}{Pt6}{VI}{Part~VI}{{\@tag[][]{VI}x}}{{\@tag[][]{%
 Part~VI}x}}}\right|dx,     and the total variation for the discrete case is,        T  V   =    ∑  j    |    u   j  +  1    -   u  j    |     .        T  V     subscript   j        subscript  u    j  1     subscript  u  j        TV=\sum_{j}\left|u_{j+1}-u_{j}\right|.     A numerical method is said to be total variation diminishing (TVD) if,        T  V   (   u   n  +  1    )    ≤   T  V   (   u  n   )     .        T  V   superscript  u    n  1       T  V   superscript  u  n      TV\left(u^{n+1}\right)\leq TV\left(u^{n}\right).     Characteristics  A numerical scheme is said to be monotonicity preserving if the following properties are maintained:   If    u  n     superscript  u  n    u^{n}   is monotonically increasing (or decreasing) in space, then so is    u   n  +  1      superscript  u    n  1     u^{n+1}   .   proved the following properties for a numerical scheme,   A monotone scheme is TVD, and    A TVD scheme is monotonicity preserving.   Application in CFD  In Computational Fluid Dynamics , TVD scheme is employed to capture sharper shock predictions without any misleading oscillations when variation of field variable “Ø” is discontinuous. To capture the variation fine grids (∆x = very small) are needed and the computation becomes heavy and therefore uneconomic. The use of coarse grids with central difference scheme , upwind scheme , hybrid difference scheme , and power law scheme gives false shock predictions. TVD scheme enables sharper shock predictions on coarse grids saving computation time and as the scheme preserves monotonicity there are no spurious oscillations in the solution.  Discretisation  Consider the steady state one-dimensional convection diffusion equation,       ∇  ⋅   (   ρ  𝐮  ϕ   )    =    ∇  ⋅   (   Γ   ∇  ϕ    )    +    S  ϕ          normal-⋅  normal-∇    ρ  𝐮  ϕ       normal-⋅  normal-∇    normal-Γ   normal-∇  ϕ      subscript  S  ϕ      \nabla\cdot(\rho\mathbf{u}\phi)\,=\nabla\cdot(\Gamma\nabla\phi)+S_{\phi}\;     Where,   ρ   ρ   \rho   is the density,   𝐮   𝐮   \mathbf{u}   is the velocity vector,   ϕ   ϕ   \phi   is the property being transported,   Γ   normal-Γ   \Gamma   is the coefficient of diffusion and    S  ϕ     subscript  S  ϕ    S_{\phi}   is the source term responsible for generation of the property   ϕ   ϕ   \phi     Making the flux balance of this property about a control volume we get,        ∫  A     𝐧  ⋅   (   ρ  𝐮  ϕ   )    d  A    =     ∫  A     𝐧  ⋅   (   Γ   ∇  ϕ    )    d  A    +    ∫  C    V    S  ϕ    d  V           subscript   A      normal-⋅  𝐧    ρ  𝐮  ϕ    d  A        subscript   A      normal-⋅  𝐧    normal-Γ   normal-∇  ϕ     d  A      subscript   C     V   subscript  S  ϕ   d  V       \int_{A}\mathbf{n}\cdot(\rho\mathbf{u}\phi)\,dA=\int_{A}\mathbf{n}\cdot(\Gamma%
 \nabla\phi)\,dA+\int_{C}VS_{\phi}\,dV        absent   \;     Here   𝐧   𝐧   \mathbf{n}   is the normal to the surface of control volume.  Ignoring the source term, the equation further reduces to:         (   ρ  𝐮  ϕ  A   )   r   -    (   ρ  𝐮  ϕ  A   )   l    =     (   Γ  A    ∂  ϕ    ∂  x     )   r   -    (   Γ  A    ∂  ϕ    ∂  x     )   l           subscript    ρ  𝐮  ϕ  A   r    subscript    ρ  𝐮  ϕ  A   l       subscript    normal-Γ  A      ϕ     x     r    subscript    normal-Γ  A      ϕ     x     l      (\rho\mathbf{u}\phi A)_{r}-(\rho\mathbf{u}\phi A)_{l}=\left(\Gamma A\frac{%
 \partial\phi}{\partial x}\right)_{r}-\left(\Gamma A\frac{\partial\phi}{%
 \partial x}\right)_{l}     (Figure)  A picture showing the control volume with velocities at the faces,nodes and the distance between them, where 'P' is the node at the center.   Assuming        ∂  ϕ    ∂  x    =    δ  ϕ    δ  x            ϕ     x        δ  ϕ     δ  x      \frac{\partial\phi}{\partial x}=\frac{\delta\phi}{\delta x}   and        A  r   =   A  l    ;       subscript  A  r    subscript  A  l     A_{r}=A_{l};\,     The equation reduces to          (   ρ  𝐮  ϕ   )   r   -     (   ρ  𝐮  ϕ   )   l     =     (    Γ   δ  x    δ  ϕ   )   r   -    (    Γ   δ  x    δ  ϕ   )   l     .         subscript    ρ  𝐮  ϕ   r    subscript    ρ  𝐮  ϕ   l       subscript      normal-Γ    δ  x    δ  ϕ   r    subscript      normal-Γ    δ  x    δ  ϕ   l      (\rho\mathbf{u}\phi)_{r}-(\rho\mathbf{u}\phi)_{l}\,=\left(\frac{\Gamma}{\delta
 x%
 }\delta\phi\right)_{r}-\left(\frac{\Gamma}{\delta x}\delta\phi\right)_{l}.     Say,         F  r   =    (   ρ  𝐮   )   r    ;    and   F  l    =    (   ρ  𝐮   )   l     ;     formulae-sequence     subscript  F  r    subscript    ρ  𝐮   r        and   subscript  F  l     subscript    ρ  𝐮   l      F_{r}=(\rho\mathbf{u})_{r};\text{ and }F_{l}=(\rho\mathbf{u})_{l};            D  l   =    (   Γ   δ  x    )   l    ;    D  r   =    (   Γ   δ  x    )   r     ;     formulae-sequence     subscript  D  l    subscript    normal-Γ    δ  x    l       subscript  D  r    subscript    normal-Γ    δ  x    r      D_{l}=\left(\frac{\Gamma}{\delta x}\right)_{l};\qquad D_{r}=\left(\frac{\Gamma%
 }{\delta x}\right)_{r};     From the figure:         δ   ϕ  r    =    ϕ  R   -   ϕ  P     ;    and  δ   x  r    =   x   P  R      ;     formulae-sequence      δ   subscript  ϕ  r       subscript  ϕ  R    subscript  ϕ  P         and  δ   subscript  x  r     subscript  x    P  R       \delta\phi_{r}=\phi_{R}-\phi_{P};\text{ and }\delta x_{r}=x_{PR};            δ   ϕ  l    =    ϕ  P   -   ϕ  L     ;    and  δ   x  l    =   x   L  P      ;     formulae-sequence      δ   subscript  ϕ  l       subscript  ϕ  P    subscript  ϕ  L         and  δ   subscript  x  l     subscript  x    L  P       \delta\phi_{l}=\phi_{P}-\phi_{L};\text{ and }\delta x_{l}=x_{LP};     The equation becomes,        F  r    ϕ  r    -    F  l    ϕ  l     =     D  r    (    ϕ  R   -   ϕ  P    )    -    D  l    (    ϕ  P   -   ϕ  L    )      ;           subscript  F  r    subscript  ϕ  r       subscript  F  l    subscript  ϕ  l          subscript  D  r      subscript  ϕ  R    subscript  ϕ  P        subscript  D  l      subscript  ϕ  P    subscript  ϕ  L        F_{r}\phi_{r}-F_{l}\phi_{l}=D_{r}(\phi_{R}-\phi_{P})-D_{l}(\phi_{P}-\phi_{L});     Also the continuity equation has to be satisfied,           (   ρ  𝐮   )   r   -     (   ρ  𝐮   )   l     =  0   ;       (   O  R   )    F  r    -   F  l    =  0   ;     (   O  R   )    F  r    =   F  l   =  F     ;     formulae-sequence       subscript    ρ  𝐮   r    subscript    ρ  𝐮   l    0    formulae-sequence          O  R    subscript  F  r     subscript  F  l    0           O  R    subscript  F  r     subscript  F  l        F       (\rho\mathbf{u})_{r}-(\rho\mathbf{u})_{l}\,=0;(OR)F_{r}-F_{l}=0;(OR)F_{r}=F_{l%
 }=F;     Assuming diffusivity is a homogeneous property and equal grid spacing we can say        Γ  l   =   Γ  r    ;    δ   x   L  P     =   δ   x   P  R     =   δ  x       formulae-sequence     subscript  normal-Γ  l    subscript  normal-Γ  r          δ   subscript  x    L  P       δ   subscript  x    P  R            δ  x       \Gamma_{l}=\Gamma_{r};\qquad\delta x_{LP}=\delta x_{PR}=\delta x     we get     D  l   =   D  r   =  D         subscript  D  l    subscript  D  r        D     D_{l}=D_{r}=D   The equation further reduces to     F   (    ϕ  r   -   ϕ  l    )    =   D   (     ϕ  R   -   2   ϕ  P     +   ϕ  L    )          F     subscript  ϕ  r    subscript  ϕ  l       D       subscript  ϕ  R     2   subscript  ϕ  P      subscript  ϕ  L       F(\phi_{r}-\phi_{l})=D(\phi_{R}-2\phi_{P}+\phi_{L})   This can be written as     P   (    ϕ  r   -   ϕ  l    )    =   (     ϕ  R   -   2   ϕ  P     +   ϕ  L    )         P     subscript  ϕ  r    subscript  ϕ  l          subscript  ϕ  R     2   subscript  ϕ  P      subscript  ϕ  L      P(\phi_{r}-\phi_{l})=(\phi_{R}-2\phi_{P}+\phi_{L})   , where P is the Péclet number .       P  =   F  D   =    ρ  𝐮  δ  x   Γ    .        P    F  D            ρ  𝐮  δ  x   normal-Γ      P=\frac{F}{D}=\frac{\rho\mathbf{u}\delta x}{\Gamma}.     TVD scheme  Total variation diminishing scheme 2 3 makes an assumption for the values of    ϕ  r     subscript  ϕ  r    \phi_{r}   and    ϕ  l     subscript  ϕ  l    \phi_{l}   to be substituted in the discretized equation as follows:       P   ϕ  r    =     1  2    (   P  +   |  P  |    )    [     f  r  +    ϕ  R    +    (   1  -   f  r  +    )    ϕ  L     ]    +    1  2    (   P  -   |  P  |    )    [     f  r  -    ϕ  P    +    (   1  -   f  r  -    )    ϕ   R  R      ]           P   subscript  ϕ  r          1  2     P    P     delimited-[]       superscript   subscript  f  r      subscript  ϕ  R        1   superscript   subscript  f  r       subscript  ϕ  L           1  2     P    P     delimited-[]       superscript   subscript  f  r      subscript  ϕ  P        1   superscript   subscript  f  r       subscript  ϕ    R  R           P\phi_{r}=\frac{1}{2}(P+|P|)[f_{r}^{+}\phi_{R}+(1-f_{r}^{+})\phi_{L}]+\frac{1}%
 {2}(P-|P|)[f_{r}^{-}\phi_{P}+(1-f_{r}^{-})\phi_{RR}]          P   ϕ  l    =     1  2    (   P  +   |  P  |    )    [     f  l  +    ϕ  P    +    (   1  -   f  l  +    )    ϕ   L  L      ]    +    1  2    (   P  -   |  P  |    )    [     f  l  -    ϕ  L    +    (   1  -   f  l  -    )    ϕ  R     ]           P   subscript  ϕ  l          1  2     P    P     delimited-[]       superscript   subscript  f  l      subscript  ϕ  P        1   superscript   subscript  f  l       subscript  ϕ    L  L            1  2     P    P     delimited-[]       superscript   subscript  f  l      subscript  ϕ  L        1   superscript   subscript  f  l       subscript  ϕ  R          P\phi_{l}=\frac{1}{2}(P+|P|)[f_{l}^{+}\phi_{P}+(1-f_{l}^{+})\phi_{LL}]+\frac{1%
 }{2}(P-|P|)[f_{l}^{-}\phi_{L}+(1-f_{l}^{-})\phi_{R}]     Where   P   P   P   is the Peclet number and   f   f   f   is the weighing function to be determined from,      f  =   f   (  ϵ  )    =   f     ϕ  U   -   ϕ   U  U       ϕ  D   -   ϕ   U  U             f    f  ϵ          f       subscript  ϕ  U    subscript  ϕ    U  U        subscript  ϕ  D    subscript  ϕ    U  U          f=f(\epsilon)=f\frac{\phi_{U}-\phi_{UU}}{\phi_{D}-\phi_{UU}}     where U refers to upstream, UU refers to upstream of U and D refers to downstream.  Note that    f  +     superscript  f     f^{+}   is the weighing function when the flow is in positive direction i.e., from left to right and    f  -     superscript  f     f^{-}   is the weighing function when the flow is in the negative direction from right to left. So,        f  r  +   is a function of      ϕ  P   -   ϕ  L      ϕ  R   -   ϕ  L       .       superscript   subscript  f  r     is a function of       subscript  ϕ  P    subscript  ϕ  L       subscript  ϕ  R    subscript  ϕ  L       \displaystyle f_{r}^{+}\text{ is a function of }\dfrac{\phi_{P}-\phi_{L}}{\phi%
 _{R}-\phi_{L}}.     If the flow is in positive direction then, peclet number   P   P   P   is positive and the term     (   P  -   |  P  |    )   =  0        P    P    0    (P-|P|)=0   , so the function    f  -     superscript  f     f^{-}   won’t play any role in the assumption of Ør and Øl. Likewise when the flow is in negative direction,   P   P   P   is negative and the term     (   P  +   |  P  |    )   =  0        P    P    0    (P+|P|)=0   , so the function    f  +     superscript  f     f^{+}   won’t play any role in the assumption of    ϕ  r     subscript  ϕ  r    \phi_{r}   and    ϕ  r     subscript  ϕ  r    \phi_{r}   .  It therefore takes into account the values of property depending on the direction of flow and using the weighted functions tries to achieve monotonicity in the solution thereby producing results with no spurious shocks.  Limitations  Monotone schemes are attractive for solving engineering and scientific problems because they do not produce non-physical solutions. Godunov's theorem proves that linear schemes which preserve monotonicity are, at most, only first order accurate. Higher order linear schemes, although more accurate for smooth solutions, are not TVD and tend to introduce spurious oscillations (wiggles) where discontinuities or shocks arise. To overcome these drawbacks, various high-resolution , non-linear techniques have been developed, often using flux/slope limiters .  See also   Flux limiters  Godunov's theorem  High-resolution scheme  MUSCL scheme  Sergei K. Godunov  Total variation   References  Further reading   Hirsch, C. (1990), Numerical Computation of Internal and External Flows , Vol 2, Wiley.  Laney, C. B. (1998), Computational Gas Dynamics , Cambridge University Press.  Toro, E. F. (1999), Riemann Solvers and Numerical Methods for Fluid Dynamics , Springer-Verlag.  Tannehill, J. C., Anderson, D. A. , and Pletcher, R. H. (1997), Computational Fluid Mechanics and Heat Transfer , 2nd Ed., Taylor & Francis.  Wesseling, P. (2001), Principles of Computational Fluid Dynamics , Springer-Verlag.  Anil W. Date Introduction to Computational Fluid Dynamics , Cambridge University Press.   "  Category:Numerical differential equations  Category:Computational fluid dynamics     ↩  ↩  ↩     
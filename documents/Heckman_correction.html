<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="279">Heckman correction</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Heckman correction</h1>
<hr>The '''Heckman correction''' (the two-stage method, Heckman's [[lambda]] or the Heckit method<ref>Heckit: 'Heck-' from Heckman and '-it' as in [[probit]], [[Tobit model|tobit]], and [[logit]].</ref>) is any of a number of related statistical methods developed by [[James Heckman]] at the [[University of Chicago]] in 1976 to 1979 which allow the researcher to correct for [[selection bias]].<ref>{{cite journal | doi = 10.2307/1912352 | la
<p>st1 = Heckman | first1 = J. | year = 1979 | title = Sample selection bias as a specification error | jstor = 1912352| journal = Econometrica | volume = 47 | issue = 1| pages = 153–61 }} Selection bias problems are endemic to applied <a href="econometrics" title="wikilink">econometric</a> problems,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> which make Heckman’s original technique, and subsequent refinements by both himself and others, indispensable to applied <a href="econometrician" title="wikilink">econometricians</a>. Heckman received the <a href="Nobel_Memorial_Prize_in_Economic_Sciences" title="wikilink">Economics Nobel Prize</a> in 2000 for this achievement.</p>
<h2 id="method">Method</h2>

<p>Statistical analyses based on non-randomly selected samples can lead to erroneous conclusions and poor policy. The Heckman correction, a two-step statistical approach, offers a means of correcting for non-randomly selected samples.</p>

<p>Heckman discussed bias from using nonrandom selected samples to estimate behavioral relationships as a specification error. He suggests a two-stage estimation method to correct the bias. The correction is easy to implement and has a firm basis in statistical theory. Heckman’s correction involves a <a href="normal_distribution" title="wikilink">normality</a> assumption, provides a test for sample selection bias and formula for bias corrected model.</p>

<p>Suppose that a researcher wants to estimate the determinants of wage offers, but has access to wage observations for only those who work. Since people who work are selected non-randomly from the population, estimating the determinants of wages from the subpopulation who work may introduce bias. The Heckman correction takes place in two stages.</p>

<p>In the first stage, the researcher formulates a model, based on <a href="economic_theory" title="wikilink">economic theory</a>, for the probability of working. The canonical specification for this relationship is a <a class="uri" href="probit" title="wikilink">probit</a> regression of the form</p>

<p>

<math display="block" id="Heckman_correction:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Prob</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>D</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">|</mo>
      <mi>Z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Φ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>Z</mi>
       <mi>γ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Prob</ci>
     <apply>
      <eq></eq>
      <ci>D</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>Z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <apply>
      <times></times>
      <ci>Z</ci>
      <ci>γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Prob}(D=1|Z)=\Phi(Z\gamma),\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>D</em> indicates employment (<em>D</em> = 1 if the respondent is employed and <em>D</em> = 0 otherwise), <em>Z</em> is a vector of explanatory variables, 

<math display="inline" id="Heckman_correction:1">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 is a vector of unknown parameters, and Φ is the <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> of the standard <a href="normal_distribution" title="wikilink">normal distribution</a>. Estimation of the model yields results that can be used to predict this employment probability for each individual.</p>

<p>In the second stage, the researcher corrects for self-selection by incorporating a transformation of these predicted individual probabilities as an additional explanatory variable. The wage equation may be specified,</p>

<p>

<math display="block" id="Heckman_correction:2">
 <semantics>
  <mrow>
   <msup>
    <mi>w</mi>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>X</mi>
     <mi>β</mi>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mi>u</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>w</ci>
     <times></times>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>X</ci>
      <ci>β</ci>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w^{*}=X\beta+u\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Heckman_correction:3">
 <semantics>
  <msup>
   <mi>w</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>w</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w^{*}
  </annotation>
 </semantics>
</math>

 denotes an underlying wage offer, which is not observed if the respondent does not work. The conditional expectation of wages given the person works is then</p>

<p>

<math display="block" id="Heckman_correction:4">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>w</mi>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>D</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mi>X</mi>
   <mi>β</mi>
   <mo>+</mo>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>u</mi>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>D</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo rspace="4.2pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">D</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">X</csymbol>
    <csymbol cd="unknown">β</csymbol>
    <plus></plus>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">D</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[w|X,D=1]=X\beta+E[u|X,D=1].\,
  </annotation>
 </semantics>
</math>

</p>

<p>Under the assumption that the <a href="errors_and_residuals_in_statistics" title="wikilink">error terms</a> are <a href="multivariate_normal_distribution" title="wikilink">jointly normal</a>, we have</p>

<p>

<math display="block" id="Heckman_correction:5">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>w</mi>
    <mo stretchy="false">|</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>D</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mi>X</mi>
   <mi>β</mi>
   <mo>+</mo>
   <mi>ρ</mi>
   <msub>
    <mi>σ</mi>
    <mi>u</mi>
   </msub>
   <mi>λ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Z</mi>
    <mi>γ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="4.2pt">,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">w</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">D</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">X</csymbol>
    <csymbol cd="unknown">β</csymbol>
    <plus></plus>
    <csymbol cd="unknown">ρ</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>u</ci>
    </apply>
    <csymbol cd="unknown">λ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <csymbol cd="unknown">γ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[w|X,D=1]=X\beta+\rho\sigma_{u}\lambda(Z\gamma),\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>ρ</em> is the correlation between unobserved determinants of propensity to work 

<math display="inline" id="Heckman_correction:6">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon
  </annotation>
 </semantics>
</math>

 and unobserved determinants of wage offers <em>u</em>, <em>σ</em><sub> <em>u</em></sub> is the standard deviation of 

<math display="inline" id="Heckman_correction:7">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Heckman_correction:8">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 is the <a href="inverse_Mills_ratio" title="wikilink">inverse Mills ratio</a> evaluated at 

<math display="inline" id="Heckman_correction:9">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mi>γ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Z</ci>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z\gamma
  </annotation>
 </semantics>
</math>

. This equation demonstrates Heckman's insight that sample selection can be viewed as a form of <a href="omitted-variables_bias" title="wikilink">omitted-variables bias</a>, as conditional on both <em>X</em> and on 

<math display="inline" id="Heckman_correction:10">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 it is as if the sample is randomly selected. The wage equation can be estimated by replacing 

<math display="inline" id="Heckman_correction:11">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 with Probit estimates from the first stage, constructing the 

<math display="inline" id="Heckman_correction:12">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 term, and including it as an additional explanatory variable in <a href="Ordinary_least_squares" title="wikilink">linear regression</a> estimation of the wage equation. Since 

<math display="inline" id="Heckman_correction:13">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mi>u</mi>
   </msub>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>u</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{u}>0
  </annotation>
 </semantics>
</math>

, the coefficient on 

<math display="inline" id="Heckman_correction:14">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 can only be zero if 

<math display="inline" id="Heckman_correction:15">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=0
  </annotation>
 </semantics>
</math>

, so testing the null that the coefficient on 

<math display="inline" id="Heckman_correction:16">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 is zero is equivalent to testing for sample selectivity.</p>

<p>Heckman's achievements have generated a large number of empirical applications in economics as well as in other social sciences. The original method has subsequently been generalized, by Heckman and by others.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="disadvantages">Disadvantages</h2>
<ul>
<li>The two-step estimator discussed above is a limited information maximum likelihood (LIML) estimator. In asymptotic theory and in finite samples as demonstrated by Monte Carlo simulations, the full information (FIML) estimator exhibits better statistical properties. However, the FIML estimator is more computationally difficult to implement.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></li>
</ul>
<ul>
<li>The covariance matrix generated by OLS estimation of the second stage is inconsistent. Correct standard errors and other statistics can be generated from an asymptotic approximation or by resampling, such as through a <a href="bootstrap_(statistics)" title="wikilink">bootstrap</a>.</li>
</ul>
<ul>
<li>The canonical model assumes the errors are jointly normal. If that assumption fails, the estimator is generally inconsistent and can provide misleading inference in small samples.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Semiparametric and other robust alternatives can be used in such cases.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
</ul>
<ul>
<li>The model obtains formal identification from the normality assumption when the same covariates appear in the selection equation and the equation of interest, but identification will be tenuous unless there are many observations in the tails where there is substantial nonlinearity in the inverse Mills ratio. Generally, an exclusion restriction is required to generate credible estimates: there must be at least one variable which appears with a non-zero coefficient in the selection equation but does not appear in the equation of interest, essentially an <a href="instrumental_variable" title="wikilink">instrument</a>. If no such variable is available, it may be difficult to correct for sampling selectivity.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
</ul>
<h2 id="implementations-in-statistics-packages">Implementations in statistics packages</h2>
<ul>
<li><a href="R_(programming_language)" title="wikilink">R</a>: Heckman-type procedures are available as part of the <code>sampleSelection</code> package.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></li>
<li><a class="uri" href="Stata" title="wikilink">Stata</a>: the command <code>heckman</code> provides the Heckman selection model.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Propensity_score_matching" title="wikilink">Propensity score matching</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.britannica.com/eb/topic-734492/Heckman-correction">Encyclopædia Britannica article</a></li>
<li><a href="http://www.columbia.edu/~ap2231/ET/et18-oct00.htm">Article</a> on Heckman-MacFadden Nobel Prize.</li>
<li><a href="http://www.nobelprize.org/nobel_prizes/economics/laureates/2000/heckman.html">Nobel prize official description.</a></li>
</ul>

<p>"</p>

<p><a href="Category:Sampling_(statistics)" title="wikilink">Category:Sampling (statistics)</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a class="uri" href="Category:Econometrics" title="wikilink">Category:Econometrics</a> <a href="Category:Statistical_terminology" title="wikilink">Category:Statistical terminology</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
</ol>
</section>
</ref></hr></body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="901">Importance sampling</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Importance sampling</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>importance sampling</strong> is a general technique for estimating properties of a particular <a href="probability_distribution" title="wikilink">distribution</a>, while only having samples generated from a different distribution than the distribution of interest. It is related to <a href="umbrella_sampling" title="wikilink">umbrella sampling</a> in <a href="computational_physics" title="wikilink">computational physics</a>. Depending on the application, the term may refer to the process of sampling from this alternative distribution, the process of inference, or both.</p>
<h2 id="basic-theory">Basic theory</h2>

<p>Let 

<math display="inline" id="Importance_sampling:0">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>:</mo>
   <mrow>
    <mi mathvariant="normal">Œ©</mi>
    <mo>‚Üí</mo>
    <mi>‚Ñù</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>X</ci>
    <apply>
     <ci>normal-‚Üí</ci>
     <ci>normal-Œ©</ci>
     <ci>‚Ñù</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X:\Omega\to\mathbb{R}
  </annotation>
 </semantics>
</math>

 be a <a href="random_variable" title="wikilink">random variable</a> in some <a href="probability_space" title="wikilink">probability space</a> 

<math display="inline" id="Importance_sampling:1">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi mathvariant="normal">Œ©</mi>
   <mo>,</mo>
   <mi class="ltx_font_mathcaligraphic">‚Ñ±</mi>
   <mo>,</mo>
   <mi>P</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>normal-Œ©</ci>
    <ci>‚Ñ±</ci>
    <ci>P</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\Omega,\mathcal{F},P)
  </annotation>
 </semantics>
</math>

. We wish to estimate the <a href="expected_value" title="wikilink">expected value</a> of <em>X</em> under <em>P</em>, denoted <strong>E</strong>[<em>X;P</em>]. If we have random samples 

<math display="inline" id="Importance_sampling:2">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1},\ldots,x_{n}
  </annotation>
 </semantics>
</math>

, generated according to <em>P</em>, then an empirical estimate of <strong>E</strong>[<em>X;P</em>] is</p>

<p>

<math display="block" id="Importance_sampling:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mover accent="true">
       <mi>ùêÑ</mi>
       <mo>^</mo>
      </mover>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo>;</mo>
      <mi>P</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ùêÑ</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <list>
      <ci>X</ci>
      <ci>P</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\mathbf{E}}_{n}[X;P]=\frac{1}{n}\sum_{i=1}^{n}x_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>The basic idea of importance sampling is to change the probability measure <em>P</em> so that the estimation of <strong>E</strong>[<em>X;P</em>] is easier. Choose a random variable 

<math display="inline" id="Importance_sampling:4">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>‚â•</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>L</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L\geq 0
  </annotation>
 </semantics>
</math>

 such that <strong>E</strong><em>[L;P]=1</em> and that <em>P</em>-<a href="almost_everywhere" title="wikilink">almost everywhere</a> 

<math display="inline" id="Importance_sampling:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>œâ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>‚â†</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>œâ</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(\omega)\neq 0
  </annotation>
 </semantics>
</math>

. With the variate <em>L</em> we define another probability 

<math display="inline" id="Importance_sampling:6">
 <semantics>
  <mrow>
   <msup>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mo>:=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>L</mi>
    </mpadded>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>P</ci>
     <ci>L</ci>
    </apply>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P^{(L)}:=L\,P
  </annotation>
 </semantics>
</math>

 that satisfies</p>

<p>

<math display="block" id="Importance_sampling:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>ùêÑ</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo>;</mo>
      <mi>P</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>ùêÑ</mi>
     <mrow>
      <mo>[</mo>
      <mfrac>
       <mi>X</mi>
       <mi>L</mi>
      </mfrac>
      <mo>;</mo>
      <msup>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>L</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ùêÑ</ci>
     <list>
      <ci>X</ci>
      <ci>P</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <ci>ùêÑ</ci>
     <list>
      <apply>
       <divide></divide>
       <ci>X</ci>
       <ci>L</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <ci>L</ci>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{E}[X;P]=\mathbf{E}\left[\frac{X}{L};P^{(L)}\right].
  </annotation>
 </semantics>
</math>

</p>

<p>The variable <em>X/L</em> will thus be sampled under <em>P<sup>(L)</sup></em> to estimate 

<math display="inline" id="Importance_sampling:8">
 <semantics>
  <mrow>
   <mi>ùêÑ</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>X</mi>
    <mo>;</mo>
    <mi>P</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùêÑ</ci>
    <list>
     <ci>X</ci>
     <ci>P</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{E}[X;P]
  </annotation>
 </semantics>
</math>

 as above. This procedure will improve the estimation when 

<math display="inline" id="Importance_sampling:9">
 <semantics>
  <mrow>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo>[</mo>
     <mfrac>
      <mi>X</mi>
      <mi>L</mi>
     </mfrac>
     <mo>;</mo>
     <msup>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>L</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>X</mi>
     <mo>;</mo>
     <mi>P</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <ci>var</ci>
     <apply>
      <divide></divide>
      <ci>X</ci>
      <ci>L</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>P</ci>
      <ci>L</ci>
     </apply>
    </apply>
    <apply>
     <ci>var</ci>
     <ci>X</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}\left[\frac{X}{L};P^{(L)}\right]<\operatorname{var}[X;P]
  </annotation>
 </semantics>
</math>

. Another case of interest is when <em>X/L</em> is easier to sample under <em>P<sup>(L)</sup></em> than <em>X</em> under <em>P</em>.</p>

<p>When <em>X</em> is of constant sign over Œ©, the best variable <em>L</em> would clearly be 

<math display="inline" id="Importance_sampling:10">
 <semantics>
  <mrow>
   <msup>
    <mi>L</mi>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <mfrac>
    <mi>X</mi>
    <mrow>
     <mi>ùêÑ</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo>;</mo>
      <mi>P</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>‚â•</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <times></times>
     </apply>
     <apply>
      <divide></divide>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>ùêÑ</ci>
       <list>
        <ci>X</ci>
        <ci>P</ci>
       </list>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{*}=\frac{X}{\mathbf{E}[X;P]}\geq 0
  </annotation>
 </semantics>
</math>

, so that <em>X/L*</em> is the searched constant <strong>E</strong><em>[X;P]</em> and a single sample under <em>P<sup>(L*)</sup></em> suffices to give its value. Unfortunately we cannot take that choice, because <strong>E</strong><em>[X;P]</em> is precisely the value we are looking for! However this theoretical best case <em>L*</em> gives us an insight into what importance sampling does:</p>

<p>

<math display="inline" id="Importance_sampling:11">
 <semantics>
  <mrow>
   <mo>‚àÄ</mo>
   <mi>a</mi>
   <mo>‚àà</mo>
   <mi>‚Ñù</mi>
   <mo rspace="5.3pt">,</mo>
   <msup>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>L</mi>
      <mo>*</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>‚àà</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>a</mi>
     <mo>;</mo>
     <mi>a</mi>
     <mo>+</mo>
     <mi>d</mi>
     <mi>a</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="latexml">for-all</csymbol>
    <csymbol cd="unknown">a</csymbol>
    <in></in>
    <csymbol cd="unknown">R</csymbol>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <times></times>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <in></in>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-;</ci>
      <csymbol cd="unknown">a</csymbol>
      <plus></plus>
      <csymbol cd="unknown">d</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\forall a\in\mathbb{R},\;P^{(L^{*})}(X\in[a;a+da])
  </annotation>
 </semantics>
</math>


 to the right, 

<math display="inline" id="Importance_sampling:12">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>a</mi>
   </mpadded>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>‚àà</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>a</mi>
     <mo>;</mo>
     <mi>a</mi>
     <mo>+</mo>
     <mi>d</mi>
     <mi>a</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">a</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <in></in>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-;</ci>
      <csymbol cd="unknown">a</csymbol>
      <plus></plus>
      <csymbol cd="unknown">d</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\,P(X\in[a;a+da])
  </annotation>
 </semantics>
</math>

 is one of the infinitesimal elements that sum up to <strong>E</strong><em>[X;P]</em>:</p>

<p>

<math display="block" id="Importance_sampling:13">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>X</mi>
    <mo>;</mo>
    <mi>P</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <msubsup>
    <mo largeop="true" symmetric="true">‚à´</mo>
    <mrow>
     <mi>a</mi>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mi mathvariant="normal">‚àû</mi>
     </mrow>
    </mrow>
    <mrow>
     <mo>+</mo>
     <mi mathvariant="normal">‚àû</mi>
    </mrow>
   </msubsup>
   <mpadded width="+1.7pt">
    <mi>a</mi>
   </mpadded>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>‚àà</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>a</mi>
     <mo>;</mo>
     <mi>a</mi>
     <mo>+</mo>
     <mi>d</mi>
     <mi>a</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-;</ci>
     <csymbol cd="unknown">P</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <apply>
       <eq></eq>
       <ci>a</ci>
       <apply>
        <minus></minus>
        <infinity></infinity>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <infinity></infinity>
     </apply>
    </apply>
    <csymbol cd="unknown">a</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <in></in>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-;</ci>
      <csymbol cd="unknown">a</csymbol>
      <plus></plus>
      <csymbol cd="unknown">d</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-]</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[X;P]=\int_{a=-\infty}^{+\infty}a\,P(X\in[a;a+da])
  </annotation>
 </semantics>
</math>

 therefore, <strong>a good probability change <em>P<sup>(L)</sup></em> in importance sampling will redistribute the law of <em>X</em> so that its samples' frequencies are sorted directly according to their weights in</strong> <strong>E</strong><em>[X;P]</em>. Hence the name "importance sampling."</p>

<p>Note that whenever 

<math display="inline" id="Importance_sampling:14">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 is the uniform distribution and 

<math display="inline" id="Importance_sampling:15">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Œ©</mi>
   <mo>=</mo>
   <mi>‚Ñù</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Œ©</ci>
    <ci>‚Ñù</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega=\mathbb{R}
  </annotation>
 </semantics>
</math>

, we are just estimating the integral of the real function 

<math display="inline" id="Importance_sampling:16">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>:</mo>
   <mrow>
    <mi>‚Ñù</mi>
    <mo>‚Üí</mo>
    <mi>‚Ñù</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>X</ci>
    <apply>
     <ci>normal-‚Üí</ci>
     <ci>‚Ñù</ci>
     <ci>‚Ñù</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X:\mathbb{R}\to\mathbb{R}
  </annotation>
 </semantics>
</math>

, so the method can also be used for estimating simple integrals.</p>
<h2 id="application-to-probabilistic-inference">Application to probabilistic inference</h2>

<p>Such methods are frequently used to estimate posterior densities or expectations in state and/or parameter estimation problems in probabilistic models that are too hard to treat analytically, for example in <a href="Bayesian_network" title="wikilink">Bayesian networks</a>.</p>
<h2 id="application-to-simulation">Application to simulation</h2>

<p><strong>Importance sampling</strong> is a <a href="variance_reduction" title="wikilink">variance reduction</a> technique that can be used in the <a href="Monte_Carlo_method" title="wikilink">Monte Carlo method</a>. The idea behind importance sampling is that certain values of the input <a href="random_variables" title="wikilink">random variables</a> in a <a class="uri" href="simulation" title="wikilink">simulation</a> have more impact on the parameter being estimated than others. If these "important" values are emphasized by sampling more frequently, then the <a class="uri" href="estimator" title="wikilink">estimator</a> variance can be reduced. Hence, the basic methodology in importance sampling is to choose a distribution which "encourages" the important values. This use of "biased" distributions will result in a biased estimator if it is applied directly in the simulation. However, the simulation outputs are weighted to correct for the use of the biased distribution, and this ensures that the new importance sampling estimator is unbiased. The weight is given by the <a href="Likelihood-ratio_test" title="wikilink">likelihood ratio</a>, that is, the <a href="Radon‚ÄìNikodym_derivative" title="wikilink">Radon‚ÄìNikodym derivative</a> of the true underlying distribution with respect to the biased simulation distribution.</p>

<p>The fundamental issue in implementing importance sampling simulation is the choice of the biased distribution which encourages the important regions of the input variables. Choosing or designing a good biased distribution is the "art" of importance sampling. The rewards for a good distribution can be huge run-time savings; the penalty for a bad distribution can be longer run times than for a general Monte Carlo simulation without importance sampling.</p>

<p>Consider 

<math display="inline" id="Importance_sampling:17">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 to be the sample and 

<math display="inline" id="Importance_sampling:18">
 <semantics>
  <mfrac>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{f(X)}{g(X)}
  </annotation>
 </semantics>
</math>


 to be the likelihood ratio, where 

<math display="inline" id="Importance_sampling:19">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 is the probability density (mass) function of the desired distribution and 

<math display="inline" id="Importance_sampling:20">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 is the probability density (mass) function of the biased/proposal/sample distribution. Then the problem can be characterize by choosing the sample distribution 

<math display="inline" id="Importance_sampling:21">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 that minimizes the variance of the scaled sample:</p>

<p>

<math display="block" id="Importance_sampling:22">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <munder>
     <mi>min</mi>
     <mi>g</mi>
    </munder>
    <mrow>
     <msub>
      <mo>Var</mo>
      <mi>g</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>X</mi>
       <mfrac>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <times></times>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <min></min>
      <ci>g</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Var</ci>
       <ci>g</ci>
      </apply>
      <apply>
       <times></times>
       <ci>X</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>f</ci>
         <ci>X</ci>
        </apply>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>X</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{*}=\min_{g}\operatorname{Var}_{g}\left(X\frac{f(X)}{g(X)}\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>It can be shown that the following distribution minimizes the above variance:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Importance_sampling:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>g</mi>
      <mo>*</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>X</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo largeop="true" symmetric="true">‚à´</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>x</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <times></times>
     </apply>
     <ci>X</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <abs></abs>
       <ci>X</ci>
      </apply>
      <ci>f</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <abs></abs>
        <ci>x</ci>
       </apply>
       <ci>f</ci>
       <ci>x</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{*}(X)=\frac{|X|f(X)}{\int|x|f(x)dx}.
  </annotation>
 </semantics>
</math>

</p>

<p>It is easy to see that when 

<math display="inline" id="Importance_sampling:24">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>‚â•</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>X</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\geq 0
  </annotation>
 </semantics>
</math>

, this variance becomes 0.</p>
<h3 id="mathematical-approach">Mathematical approach</h3>

<p>Consider estimating by simulation the probability 

<math display="inline" id="Importance_sampling:25">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>p</mi>
    <mi>t</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{t}\,
  </annotation>
 </semantics>
</math>

 of an event 

<math display="inline" id="Importance_sampling:26">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>‚â•</mo>
   <mpadded width="+5pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>X</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {X\geq t\ }
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Importance_sampling:27">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is a random variable with <a href="probability_distribution" title="wikilink">distribution</a> 

<math display="inline" id="Importance_sampling:28">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>


 and <a href="probability_density_function" title="wikilink">probability density function</a> 

<math display="inline" id="Importance_sampling:29">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>F</mi>
     <mo>‚Ä≤</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>F</ci>
      <ci>normal-‚Ä≤</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=F^{\prime}(x)\,
  </annotation>
 </semantics>
</math>

, where prime denotes <a class="uri" href="derivative" title="wikilink">derivative</a>. A 

<math display="inline" id="Importance_sampling:30">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

-length <a href="independent_and_identically_distributed" title="wikilink">independent and identically distributed</a> (i.i.d.) sequence 

<math display="inline" id="Importance_sampling:31">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}\,
  </annotation>
 </semantics>
</math>

 is generated from the distribution 

<math display="inline" id="Importance_sampling:32">
 <semantics>
  <mi>F</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>F</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F
  </annotation>
 </semantics>
</math>

, and the number 

<math display="inline" id="Importance_sampling:33">
 <semantics>
  <msub>
   <mi>k</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{t}
  </annotation>
 </semantics>
</math>


 of random variables that lie above the threshold 

<math display="inline" id="Importance_sampling:34">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 are counted. The random variable 

<math display="inline" id="Importance_sampling:35">
 <semantics>
  <msub>
   <mi>k</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{t}
  </annotation>
 </semantics>
</math>

 is characterized by the <a href="Binomial_distribution" title="wikilink">Binomial distribution</a></p>

<p>

<math display="block" id="Importance_sampling:36">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>k</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>K</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <msubsup>
    <mi>p</mi>
    <mi>t</mi>
    <mi>k</mi>
   </msubsup>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo>-</mo>
     <msub>
      <mi>p</mi>
      <mi>t</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>K</mi>
     <mo>-</mo>
     <mi>k</mi>
    </mrow>
   </msup>
   <mo rspace="24.2pt">,</mo>
   <mi>k</mi>
   <mo>=</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <mi>K</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <ci>K</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>t</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <cn type="integer">1</cn>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>t</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <apply>
      <minus></minus>
      <ci>K</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <ci>normal-,</ci>
    <csymbol cd="unknown">k</csymbol>
    <eq></eq>
    <cn type="integer">0</cn>
    <ci>normal-,</ci>
    <cn type="integer">1</cn>
    <ci>normal-,</ci>
    <ci>normal-‚Ä¶</ci>
    <ci>normal-,</ci>
    <csymbol cd="unknown">K</csymbol>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(k_{t}=k)={K\choose k}p_{t}^{k}(1-p_{t})^{K-k},\,\quad\quad k=0,1,\dots,K.
  </annotation>
 </semantics>
</math>

</p>

<p>One can show that 

<math display="inline" id="Importance_sampling:37">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mi>t</mi>
      </msub>
      <mo>/</mo>
      <mi>K</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>p</mi>
    <mi>t</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>t</ci>
      </apply>
      <ci>K</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[k_{t}/K]=p_{t}
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Importance_sampling:38">
 <semantics>
  <mrow>
   <mrow>
    <mo>var</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mi>t</mi>
      </msub>
      <mo>/</mo>
      <mi>K</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>p</mi>
      <mi>t</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>p</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <mi>K</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>var</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>t</ci>
      </apply>
      <ci>K</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{var}[k_{t}/K]=p_{t}(1-p_{t})/K
  </annotation>
 </semantics>
</math>


, so in the limit 

<math display="inline" id="Importance_sampling:39">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>‚Üí</mo>
   <mi mathvariant="normal">‚àû</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <ci>K</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K\to\infty
  </annotation>
 </semantics>
</math>

 we are able to obtain 

<math display="inline" id="Importance_sampling:40">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{t}
  </annotation>
 </semantics>
</math>

. Note that the variance is low if 

<math display="inline" id="Importance_sampling:41">
 <semantics>
  <mrow>
   <msub>
    <mi>p</mi>
    <mi>t</mi>
   </msub>
   <mo>‚âà</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{t}\approx 1
  </annotation>
 </semantics>
</math>

. Importance sampling is concerned with the determination and use of an alternate density function 

<math display="inline" id="Importance_sampling:42">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>f</mi>
    <mo>*</mo>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{*}\,
  </annotation>
 </semantics>
</math>

(for X), usually referred to as a biasing density, for the simulation experiment. This density allows the event 

<math display="inline" id="Importance_sampling:43">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>‚â•</mo>
   <mpadded width="+5pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>X</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {X\geq t\ }
  </annotation>
 </semantics>
</math>


 to occur more frequently, so the sequence lengths 

<math display="inline" id="Importance_sampling:44">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 gets smaller for a given <a class="uri" href="estimator" title="wikilink">estimator</a> variance. Alternatively, for a given 

<math display="inline" id="Importance_sampling:45">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

, use of the biasing density results in a variance smaller than that of the conventional Monte Carlo estimate. From the definition of 

<math display="inline" id="Importance_sampling:46">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>p</mi>
    <mi>t</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{t}\,
  </annotation>
 </semantics>
</math>

, we can introduce 

<math display="inline" id="Importance_sampling:47">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>f</mi>
    <mo>*</mo>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{*}\,
  </annotation>
 </semantics>
</math>

 as below.</p>

<p>

<math display="inline" id="Importance_sampling:48">
 <semantics>
  <msub>
   <mi>p</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle p_{t}
  </annotation>
 </semantics>
</math>


</p>

<p>where</p>

<p>

<math display="block" id="Importance_sampling:49">
 <semantics>
  <mrow>
   <mrow>
    <mi>W</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mo>‚ãÖ</mo>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>‚â°</mo>
   <mfrac>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mo>‚ãÖ</mo>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>f</mi>
      <mo>*</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mo>‚ãÖ</mo>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>W</ci>
     <ci>normal-‚ãÖ</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>normal-‚ãÖ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <times></times>
      </apply>
      <ci>normal-‚ãÖ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W(\cdot)\equiv\frac{f(\cdot)}{f_{*}(\cdot)}
  </annotation>
 </semantics>
</math>

</p>

<p>is a likelihood ratio and is referred to as the weighting function. The last equality in the above equation motivates the estimator</p>

<p>

<math display="block" id="Importance_sampling:50">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mn>1</mn>
     <mi>K</mi>
    </mfrac>
   </mpadded>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>K</mi>
   </munderover>
   <mn>1</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo>‚â•</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>W</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="24.2pt">,</mo>
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
   <mo>‚àº</mo>
   <msub>
    <mi>f</mi>
    <mo>*</mo>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>p</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>K</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>K</ci>
    </apply>
    <cn type="integer">1</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <geq></geq>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">W</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>i</ci>
    </apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <times></times>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{p}_{t}=\frac{1}{K}\,\sum_{i=1}^{K}1(X_{i}\geq t)W(X_{i}),\,\quad\quad X_{%
i}\sim f_{*}
  </annotation>
 </semantics>
</math>

</p>

<p>This is the importance sampling estimator of 

<math display="inline" id="Importance_sampling:51">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>p</mi>
    <mi>t</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{t}\,
  </annotation>
 </semantics>
</math>

 and is unbiased. That is, the estimation procedure is to generate i.i.d. samples from 

<math display="inline" id="Importance_sampling:52">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>f</mi>
    <mo>*</mo>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{*}\,
  </annotation>
 </semantics>
</math>

 and for each sample which exceeds 

<math display="inline" id="Importance_sampling:53">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>t</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\,
  </annotation>
 </semantics>
</math>

, the estimate is incremented by the weight 

<math display="inline" id="Importance_sampling:54">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>W</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>W</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W\,
  </annotation>
 </semantics>
</math>

 evaluated at the sample value. The results are averaged over 

<math display="inline" id="Importance_sampling:55">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>K</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K\,
  </annotation>
 </semantics>
</math>

 trials. The variance of the importance sampling estimator is easily shown to be</p>

<p>

<math display="inline" id="Importance_sampling:56">
 <semantics>
  <mrow>
   <msub>
    <mo>var</mo>
    <mo>*</mo>
   </msub>
   <msub>
    <mover accent="true">
     <mi>p</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mi>t</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>var</ci>
     <times></times>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>p</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{var}_{*}\hat{p}_{t}
  </annotation>
 </semantics>
</math>


</p>

<p>Now, the importance sampling problem then focuses on finding a biasing density 

<math display="inline" id="Importance_sampling:57">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>f</mi>
    <mo>*</mo>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{*}\,
  </annotation>
 </semantics>
</math>

 such that the variance of the importance sampling estimator is less than the variance of the general Monte Carlo estimate. For some biasing density function, which minimizes the variance, and under certain conditions reduces it to zero, it is called an optimal biasing density function.</p>
<h3 id="conventional-biasing-methods">Conventional biasing methods</h3>

<p>Although there are many kinds of biasing methods, the following two methods are most widely used in the applications of importance sampling.</p>
<h4 id="scaling">Scaling</h4>

<p>Shifting probability mass into the event region 

<math display="inline" id="Importance_sampling:58">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>‚â•</mo>
   <mpadded width="+5pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>X</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {X\geq t\ }
  </annotation>
 </semantics>
</math>

 by positive scaling of the random variable 

<math display="inline" id="Importance_sampling:59">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>X</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\,
  </annotation>
 </semantics>
</math>

 with a number greater than unity has the effect of increasing the variance (mean also) of the density function. This results in a heavier tail of the density, leading to an increase in the event probability. Scaling is probably one of the earliest biasing methods known and has been extensively used in practice. It is simple to implement and usually provides conservative simulation gains as compared to other methods.</p>

<p>In importance sampling by scaling, the simulation density is chosen as the density function of the scaled random variable 

<math display="inline" id="Importance_sampling:60">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mpadded width="+1.7pt">
    <mi>X</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>a</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   aX\,
  </annotation>
 </semantics>
</math>

, where usually 

<math display="inline" id="Importance_sampling:61">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>a</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a>1
  </annotation>
 </semantics>
</math>

 for tail probability estimation. By transformation,</p>

<p>

<math display="block" id="Importance_sampling:62">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mo>*</mo>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>a</mi>
    </mfrac>
    <mi>f</mi>
    <mrow>
     <mo maxsize="210%" minsize="210%">(</mo>
     <mfrac>
      <mi>x</mi>
      <mi>a</mi>
     </mfrac>
     <mo maxsize="210%" minsize="210%" rspace="4.2pt">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <times></times>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>a</ci>
     </apply>
     <ci>f</ci>
     <apply>
      <divide></divide>
      <ci>x</ci>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{*}(x)=\frac{1}{a}f\bigg(\frac{x}{a}\bigg)\,
  </annotation>
 </semantics>
</math>

</p>

<p>and the weighting function is</p>

<p>

<math display="block" id="Importance_sampling:63">
 <semantics>
  <mrow>
   <mrow>
    <mi>W</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>/</mo>
         <mi>a</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>W</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>a</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <divide></divide>
        <ci>x</ci>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W(x)=a\frac{f(x)}{f(x/a)}\,
  </annotation>
 </semantics>
</math>

</p>

<p>While scaling shifts probability mass into the desired event region, it also pushes mass into the complementary region 

<math display="inline" id="Importance_sampling:64">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>n</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\,
  </annotation>
 </semantics>
</math>

 is a sum of 

<math display="inline" id="Importance_sampling:65">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>n</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\,
  </annotation>
 </semantics>
</math>

 random variables, the spreading of mass takes place in an 

<math display="inline" id="Importance_sampling:66">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>n</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\,
  </annotation>
 </semantics>
</math>

 dimensional space. The consequence of this is a decreasing importance sampling gain for increasing 

<math display="block" id="Importance_sampling:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>f</mi>
      <mo>*</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>c</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mi>c</mi>
    <mo>></mo>
    <mpadded width="+1.7pt">
     <mn>0</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <times></times>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <ci>c</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <ci>c</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{*}(x)=f(x-c),\quad c>0\,
  </annotation>
 </semantics>
</math>

, and is called the dimensionality effect.</p>
<h4 id="translation">Translation</h4>

<p>Another simple and effective biasing technique employs translation of the density function (and hence random variable) to place much of its probability mass in the rare event region. Translation does not suffer from a dimensionality effect and has been successfully used in several applications relating to simulation of <a href="digital_communication" title="wikilink">digital communication</a> systems. It often provides better simulation gains than scaling. In biasing by translation, the simulation density is given by</p>

<p>

<math display="inline" id="Importance_sampling:68">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>c</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Importance_sampling:69">
 <semantics>
  <mrow>
   <msubsup>
    <mi>œÉ</mi>
    <mrow>
     <mi>M</mi>
     <mi>C</mi>
    </mrow>
    <mn>2</mn>
   </msubsup>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <msubsup>
     <mi>œÉ</mi>
     <mrow>
      <mi>I</mi>
      <mi>S</mi>
     </mrow>
     <mn>2</mn>
    </msubsup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{MC}/\sigma^{2}_{IS}\,
  </annotation>
 </semantics>
</math>

 is the amount of shift and is to be chosen to minimize the variance of the importance sampling estimator.</p>
<h3 id="effects-of-system-complexity">Effects of system complexity</h3>

<p>The fundamental problem with importance sampling is that designing good biased distributions becomes more complicated as the system complexity increases. Complex systems are the systems with long memory since complex processing of a few inputs is much easier to handle. This dimensionality or memory can cause problems in three ways:</p>
<ul>
<li>long memory (severe <a href="intersymbol_interference" title="wikilink">intersymbol interference</a> (ISI))</li>
<li>unknown memory (<a href="Viterbi_decoder" title="wikilink">Viterbi decoders</a>)</li>
<li>possibly infinite memory (adaptive equalizers)</li>
</ul>

<p>In principle, the importance sampling ideas remain the same in these situations, but the design becomes much harder. A successful approach to combat this problem is essentially breaking down a simulation into several smaller, more sharply defined subproblems. Then importance sampling strategies are used to target each of the simpler subproblems. Examples of techniques to break the simulation down are conditioning and error-event simulation (EES) and regenerative simulation.</p>
<h3 id="evaluation-of-importance-sampling">Evaluation of importance sampling</h3>

<p>In order to identify successful importance sampling techniques, it is useful to be able to quantify the run-time savings due to the use of the importance sampling approach. The performance measure commonly used is 

<math display="inline" id="Importance_sampling:70">
 <semantics>
  <mrow>
   <msubsup>
    <mi>œÉ</mi>
    <mrow>
     <mi>M</mi>
     <mi>C</mi>
    </mrow>
    <mn>2</mn>
   </msubsup>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <msubsup>
     <mi>œÉ</mi>
     <mrow>
      <mi>I</mi>
      <mi>S</mi>
     </mrow>
     <mn>2</mn>
    </msubsup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{MC}/\sigma^{2}_{IS}\,
  </annotation>
 </semantics>
</math>

, and this can be interpreted as the speed-up factor by which the importance sampling estimator achieves the same precision as the MC estimator. This has to be computed empirically since the estimator variances are not likely to be analytically possible when their mean is intractable. Other useful concepts in quantifying an importance sampling estimator are the variance bounds and the notion of asymptotic efficiency.</p>
<h3 id="variance-cost-function">Variance cost function</h3>

<p>Variance is not the only possible <a href="Loss_function" title="wikilink">cost function</a> for a simulation, and other cost functions, such as the mean absolute deviation, are used in various statistical applications. Nevertheless, the variance is the primary cost function addressed in the literature, probably due to the use of variances in <a href="confidence_interval" title="wikilink">confidence intervals</a> and in the performance measure 

<math display="inline" id="Importance_sampling:71">
 <semantics>
  <mrow>
   <msubsup>
    <mi>œÉ</mi>
    <mrow>
     <mi>M</mi>
     <mi>C</mi>
    </mrow>
    <mn>2</mn>
   </msubsup>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <msubsup>
     <mi>œÉ</mi>
     <mrow>
      <mi>I</mi>
      <mi>S</mi>
     </mrow>
     <mn>2</mn>
    </msubsup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>M</ci>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>œÉ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{MC}/\sigma^{2}_{IS}\,
  </annotation>
 </semantics>
</math>

.</p>

<p>An associated issue is the fact that the ratio <span class="LaTeX">$\sigma^2_{MC} / \sigma^2_{IS} \,$</span> overestimates the run-time savings due to importance sampling since it does not include the extra computing time required to compute the weight function. Hence, some people evaluate the net run-time improvement by various means. Perhaps a more serious overhead to importance sampling is the time taken to devise and program the technique and analytically derive the desired weight function.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Monte_Carlo_method" title="wikilink">Monte Carlo method</a></li>
<li><a href="variance_reduction" title="wikilink">variance reduction</a></li>
<li><a href="Stratified_sampling" title="wikilink">Stratified sampling</a></li>
<li><a href="Monte_Carlo_integration#Recursive_stratified_sampling" title="wikilink">Recursive stratified sampling</a></li>
<li><a href="VEGAS_algorithm" title="wikilink">VEGAS algorithm</a></li>
<li><a href="Particle_filter" title="wikilink">Particle filter</a> ‚Äî a sequential Monte Carlo method, which uses importance sampling</li>
<li><a href="Auxiliary_field_Monte_Carlo" title="wikilink">Auxiliary field Monte Carlo</a></li>
<li><a href="Rejection_sampling" title="wikilink">Rejection sampling</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www-sigproc.eng.cam.ac.uk/smc/">Sequential Monte Carlo Methods (Particle Filtering)</a> homepage on University of Cambridge</li>
<li><a href="http://www.iop.org/EJ/abstract/0143-0807/22/4/315">Introduction to importance sampling in rare-event simulations</a> European journal of Physics. PDF document.</li>
<li><a href="http://portal.acm.org/citation.cfm?id=1030470">Adaptive monte carlo methods for rare event simulation: adaptive monte carlo methods for rare event simulations</a> Winter Simulation Conference</li>
</ul>

<p>"</p>

<p><a href="Category:Monte_Carlo_methods" title="wikilink">Category:Monte Carlo methods</a> <a href="Category:Variance_reduction" title="wikilink">Category:Variance reduction</a> <a href="Category:Stochastic_simulation" title="wikilink">Category:Stochastic simulation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Rubinstein, R. Y., &amp; Kroese, D. P. (2011). Simulation and the Monte Carlo method (Vol. 707). John Wiley &amp; Sons.<a href="#fnref1">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

   Jacobi's formula      Jacobi's formula   In matrix calculus , Jacobi's formula expresses the derivative of the determinant of a matrix A in terms of the adjugate of A and the derivative of A . 1 If A is a differentiable map from the real numbers to n × n matrices,         d   d  t     det   A   (  t  )      =   tr   (   adj   (   A   (  t  )    )     d  A   (  t  )     d  t     )     .          d    d  t        A  t       tr    adj    A  t       d  A  t     d  t        \frac{d}{dt}\det A(t)=\mathrm{tr}\left(\mathrm{adj}(A(t))\,\frac{dA(t)}{dt}%
 \right)~{}.     Equivalently, if dA stands for the differential of A , the formula is        d   det   (  A  )     =   tr   (   adj   (  A  )   d  A   )     .        d    A      tr    adj  A  d  A      d\det(A)=\mathrm{tr}(\mathrm{adj}(A)\,dA).     It is named after the mathematician C.G.J. Jacobi .  Derivation  We first prove a preliminary lemma:  Lemma. Let A and B be a pair of square matrices of the same dimension n . Then         ∑  i     ∑  j     A   i  j     B   i  j       =   tr   (    A  T   B   )     .        subscript   i     subscript   j      subscript  A    i  j     subscript  B    i  j         tr     superscript  A  normal-T   B      \sum_{i}\sum_{j}A_{ij}B_{ij}=\mathrm{tr}(A^{\rm T}B).     Proof. The product AB of the pair of matrices has components         (   A  B   )    j  k    =    ∑  i     A   j  i     B   i  k       .       subscript    A  B     j  k      subscript   i      subscript  A    j  i     subscript  B    i  k        (AB)_{jk}=\sum_{i}A_{ji}B_{ik}.\,     Replacing the matrix A by its transpose  A T is equivalent to permuting the indices of its components:         (    A  T   B   )    j  k    =    ∑  i     A   i  j     B   i  k       .       subscript     superscript  A  normal-T   B     j  k      subscript   i      subscript  A    i  j     subscript  B    i  k        (A^{\rm T}B)_{jk}=\sum_{i}A_{ij}B_{ik}.     The result follows by taking the trace of both sides:        tr   (    A  T   B   )    =    ∑  j     (    A  T   B   )    j  j     =    ∑  j     ∑  i     A   i  j     B   i  j       =    ∑  i     ∑  j     A   i  j     B   i  j        .  □     formulae-sequence        tr     superscript  A  normal-T   B      subscript   j    subscript     superscript  A  normal-T   B     j  j            subscript   j     subscript   i      subscript  A    i  j     subscript  B    i  j              subscript   i     subscript   j      subscript  A    i  j     subscript  B    i  j         normal-□    \mathrm{tr}(A^{\rm T}B)=\sum_{j}(A^{\rm T}B)_{jj}=\sum_{j}\sum_{i}A_{ij}B_{ij}%
 =\sum_{i}\sum_{j}A_{ij}B_{ij}.\ \square     Theorem. (Jacobi's formula) For any differentiable map A from the real numbers to n × n matrices,        d   det   (  A  )     =   tr   (   adj   (  A  )   d  A   )     .        d    A      tr    adj  A  d  A      d\det(A)=\mathrm{tr}(\mathrm{adj}(A)\,dA).     Proof.  Laplace's formula for the determinant of a matrix A can be stated as        det   (  A  )    =    ∑  j     A   i  j     adj  T     (  A  )    i  j       .        A     subscript   j      subscript  A    i  j     superscript  adj  normal-T    subscript  A    i  j        \det(A)=\sum_{j}A_{ij}\mathrm{adj}^{\rm T}(A)_{ij}.     Notice that the summation is performed over some arbitrary row i of the matrix.  The determinant of A can be considered to be a function of the elements of A :       det   (  A  )    =    F    (   A  11   ,   A  12   ,  …  ,   A  21   ,   A  22   ,  …  ,   A   n  n    )          A     F    subscript  A  11    subscript  A  12   normal-…   subscript  A  21    subscript  A  22   normal-…   subscript  A    n  n        \det(A)=F\,(A_{11},A_{12},\ldots,A_{21},A_{22},\ldots,A_{nn})     so that, by the chain rule , its differential is        d   det   (  A  )     =    ∑  i     ∑  j       ∂  F    ∂   A   i  j       d   A   i  j        .        d    A      subscript   i     subscript   j         F      subscript  A    i  j      d   subscript  A    i  j         d\det(A)=\sum_{i}\sum_{j}{\partial F\over\partial A_{ij}}\,dA_{ij}.     This summation is performed over all n × n elements of the matrix.  To find ∂ F /∂ A ij consider that on the right hand side of Laplace's formula, the index i can be chosen at will. (In order to optimize calculations: Any other choice would eventually yield the same result, but it could be much harder). In particular, it can be chosen to match the first index of ∂ / ∂ A ij :        ∂   det   (  A  )      ∂   A   i  j      =    ∂    ∑  k     A   i  k     adj  T     (  A  )    i  k        ∂   A   i  j      =    ∑  k     ∂   (    A   i  k     adj  T     (  A  )    i  k     )     ∂   A   i  j                    A       subscript  A    i  j             subscript   k      subscript  A    i  k     superscript  adj  normal-T    subscript  A    i  k          subscript  A    i  j             subscript   k          subscript  A    i  k     superscript  adj  normal-T    subscript  A    i  k         subscript  A    i  j          {\partial\det(A)\over\partial A_{ij}}={\partial\sum_{k}A_{ik}\mathrm{adj}^{\rm
 T%
 }(A)_{ik}\over\partial A_{ij}}=\sum_{k}{\partial(A_{ik}\mathrm{adj}^{\rm T}(A)%
 _{ik})\over\partial A_{ij}}     Thus, by the product rule,         ∂   det   (  A  )      ∂   A   i  j      =     ∑  k      ∂   A   i  k      ∂   A   i  j       adj  T     (  A  )    i  k      +    ∑  k     A   i  k       ∂   adj  T      (  A  )    i  k      ∂   A   i  j          .             A       subscript  A    i  j          subscript   k          subscript  A    i  k        subscript  A    i  j       superscript  adj  normal-T    subscript  A    i  k        subscript   k      subscript  A    i  k           superscript  adj  normal-T     subscript  A    i  k        subscript  A    i  j           {\partial\det(A)\over\partial A_{ij}}=\sum_{k}{\partial A_{ik}\over\partial A_%
 {ij}}\mathrm{adj}^{\rm T}(A)_{ik}+\sum_{k}A_{ik}{\partial\,\mathrm{adj}^{\rm T%
 }(A)_{ik}\over\partial A_{ij}}.     Now, if an element of a matrix A ij and a cofactor adj T ( A ) ik of element A ik lie on the same row (or column), then the cofactor will not be a function of A ij , because the cofactor of A ik is expressed in terms of elements not in its own row (nor column). Thus,          ∂   adj  T      (  A  )    i  k      ∂   A   i  j      =  0   ,             superscript  adj  normal-T     subscript  A    i  k        subscript  A    i  j      0    {\partial\,\mathrm{adj}^{\rm T}(A)_{ik}\over\partial A_{ij}}=0,     so         ∂   det   (  A  )      ∂   A   i  j      =    ∑  k     adj  T     (  A  )    i  k      ∂   A   i  k      ∂   A   i  j         .             A       subscript  A    i  j        subscript   k      superscript  adj  normal-T    subscript  A    i  k         subscript  A    i  k        subscript  A    i  j          {\partial\det(A)\over\partial A_{ij}}=\sum_{k}\mathrm{adj}^{\rm T}(A)_{ik}{%
 \partial A_{ik}\over\partial A_{ij}}.     All the elements of A are independent of each other, i.e.         ∂   A   i  k      ∂   A   i  j      =   δ   j  k     ,           subscript  A    i  k        subscript  A    i  j       subscript  δ    j  k      {\partial A_{ik}\over\partial A_{ij}}=\delta_{jk},     where δ is the Kronecker delta , so         ∂   det   (  A  )      ∂   A   i  j      =    ∑  k     adj  T     (  A  )    i  k     δ   j  k      =    adj  T     (  A  )    i  j      .               A       subscript  A    i  j        subscript   k      superscript  adj  normal-T    subscript  A    i  k     subscript  δ    j  k              superscript  adj  normal-T    subscript  A    i  j        {\partial\det(A)\over\partial A_{ij}}=\sum_{k}\mathrm{adj}^{\rm T}(A)_{ik}%
 \delta_{jk}=\mathrm{adj}^{\rm T}(A)_{ij}.     Therefore,        d   (   det   (  A  )    )    =    ∑  i     ∑  j     adj  T      (  A  )    i  j     d   A   i  j        ,        d    A      subscript   i     subscript   j      superscript  adj  normal-T    subscript  A    i  j    d   subscript  A    i  j         d(\det(A))=\sum_{i}\sum_{j}\mathrm{adj}^{\rm T}(A)_{ij}\,dA_{ij},     and applying the Lemma yields        d   (   det   (  A  )    )    =   tr   (   adj   (  A  )   d  A   )     .  □     formulae-sequence      d    A      tr    adj  A  d  A     normal-□    d(\det(A))=\mathrm{tr}(\mathrm{adj}(A)\,dA).\ \square     Corollary  For any invertible matrix  A , the inverse A −1 is related to the adjugate by A −1 = (det A ) −1 adj A . It follows that if A ( t ) is invertible for all t , then        d   d  t     det   A   (  t  )      =    (   det   A   (  t  )     )   tr   (   A     (  t  )    -  1      d   d  t    A   (  t  )    )            d    d  t        A  t           A  t    tr    A   superscript  t    1      d    d  t    A  t      \frac{d}{dt}\det A(t)=(\det A(t))\,\mathrm{tr}\left(A(t)^{-1}\,\frac{d}{dt}A(t%
 )\right)   which can be alternatively written as         d   d  t    log   det   A   (  t  )      =   tr   (   A     (  t  )    -  1      d   d  t    A   (  t  )    )     .          d    d  t         A  t       tr    A   superscript  t    1      d    d  t    A  t      \frac{d}{dt}\log\det A(t)=\mathrm{tr}\left(A(t)^{-1}\,\frac{d}{dt}A(t)\right).     Furthermore, taking A ( t ) = exp( tB ) in the first equation, we obtain         d   d  t     det   e   t  B      =   tr   (  B  )    det   e   t  B       ,          d    d  t       superscript  e    t  B        tr  B     superscript  e    t  B        \frac{d}{dt}\det e^{tB}=\mathrm{tr}\left(B\right)\det e^{tB},   solved by   a useful relation connecting the trace to the determinant of the associated matrix exponential .  Alternative Derivation  A quicker proof of Jacobi's formula is as follows. By the chain rule, we have         d   d  t    det   (   A   (  t  )    )    =   (    ∇  det    (   A   (  t  )    )    )    :    (    d   d  t    A   (  t  )    )   =   tr   (   adj   (   A   (  t  )    )    d   d  t    A   (  t  )    )        normal-:        d    d  t    det    A  t       normal-∇  det     A  t           d    d  t    A  t     tr    adj    A  t     d    d  t    A  t       \frac{d}{dt}\mbox{det}\left(A\left(t\right)\right)=\left(\nabla\mbox{det}\left%
 (A\left(t\right)\right)\right):\left(\frac{d}{dt}A\left(t\right)\right)=\mbox{%
 tr}\left(\mbox{adj}\left(A\left(t\right)\right)\frac{d}{dt}A\left(t\right)\right)     where (:) denotes tensor double-contraction.  Notes  References      "  Category:Determinants  Category:Matrix theory  Category:Articles containing proofs     , Part Three, Section 8.3 ↩     
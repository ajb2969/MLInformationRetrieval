   Leibniz integral rule      Leibniz integral rule   In calculus , Leibniz's rule for differentiation under the integral sign , named after Gottfried Leibniz , tells us that if we have an integral of the form       ∫   y  0    y  1     f   (  x  ,  y  )   d  y       superscript   subscript    subscript  y  0     subscript  y  1      f   x  y   normal-d  y     \int_{y_{0}}^{y_{1}}f(x,y)\,\mathrm{d}y     then for x in ( x 0 , x 1 ) the derivative of this integral is thus expressible        d   d  x     (    ∫   y  0    y  1     f   (  x  ,  y  )   d  y    )    =    ∫   y  0    y  1      f  x    (  x  ,  y  )   d  y            normal-d    normal-d  x      superscript   subscript    subscript  y  0     subscript  y  1      f   x  y   normal-d  y       superscript   subscript    subscript  y  0     subscript  y  1       subscript  f  x    x  y   normal-d  y      {\mathrm{d}\over\mathrm{d}x}\left(\int_{y_{0}}^{y_{1}}f(x,y)\,\mathrm{d}y%
 \right)=\int_{y_{0}}^{y_{1}}f_{x}(x,y)\,\mathrm{d}y     provided that f and its partial derivative '' f x '' are both continuous over a region in the form [ x 0 , x 1 ] × [ y 0 , y 1 ].  Thus under certain conditions, one may interchange the integral and partial differential operators . This important result is particularly useful in the differentiation of integral transforms . An example of such is the moment generating function in probability theory, a variation of the Laplace transform , which can be differentiated to generate the moments of a random variable . Whether Leibniz's integral rule applies is essentially a question about the interchange of limits .  Formal statement  Let f ( x , θ) be a function such that f θ ( x , θ) exists, and is continuous. Then,        d   d  θ     (    ∫   a   (  θ  )     b   (  θ  )      f   (  x  ,  θ  )   d  x    )    =      ∫   a   (  θ  )     b   (  θ  )        ∂  θ   f    (  x  ,  θ  )   d   x     +     f   (   b   (  θ  )    ,  θ  )    ⋅   b  ′     (  θ  )     -     f   (   a   (  θ  )    ,  θ  )    ⋅   a  ′     (  θ  )             normal-d    normal-d  θ      superscript   subscript     a  θ      b  θ      f   x  θ   normal-d  x           superscript   subscript     a  θ      b  θ        subscript   θ   f    x  θ   normal-d  x       normal-⋅    f     b  θ   θ     superscript  b  normal-′    θ       normal-⋅    f     a  θ   θ     superscript  a  normal-′    θ      \frac{\mathrm{d}}{\mathrm{d}\theta}\left(\int_{a(\theta)}^{b(\theta)}f(x,%
 \theta)\,\mathrm{d}x\right)=\int_{a(\theta)}^{b(\theta)}\partial_{\theta}f(x,%
 \theta)\,\mathrm{d}x\,+\,f\big(b(\theta),\theta\big)\cdot b^{\prime}(\theta)\,%
 -\,f\big(a(\theta),\theta\big)\cdot a^{\prime}(\theta)     where the partial derivative of f indicates that inside the integral only the variation of f ( x , ) with θ is considered in taking the derivative.  Three-dimensional, time-dependent case  A Leibniz integral rule for three dimensions is: 1        d   d  t      ∬   Σ   (  t  )        𝐅   (  𝐫  ,  t  )    ⋅  d   𝐀     =     ∬   Σ   (  t  )        (     𝐅  t    (  𝐫  ,  t  )    +    [    ∇  ⋅  𝐅    (  𝐫  ,  t  )    ]   𝐯    )   ⋅  d    𝐀     -    ∮    ∂  Σ    (  t  )        [    𝐯  ×  𝐅    (  𝐫  ,  t  )    ]   ⋅  d   𝐬             normal-d    normal-d  t      subscript  double-integral    normal-Σ  t       normal-⋅    𝐅   𝐫  t    normal-d   𝐀         subscript  double-integral    normal-Σ  t       normal-⋅       subscript  𝐅  t    𝐫  t       delimited-[]     normal-⋅  normal-∇  𝐅    𝐫  t     𝐯    normal-d   𝐀      subscript  contour-integral      normal-Σ   t       normal-⋅   delimited-[]      𝐯  𝐅    𝐫  t     normal-d   𝐬       \frac{\mathrm{d}}{\mathrm{d}t}\iint_{\Sigma(t)}\mathbf{F}(\mathbf{r},t)\cdot%
 \mathrm{d}\mathbf{A}=\iint_{\Sigma(t)}\left(\mathbf{F}_{t}(\mathbf{r},t)+\left%
 [\mathrm{\nabla}\cdot\mathbf{F}(\mathbf{r},t)\right]\mathbf{v}\right)\cdot%
 \mathrm{d}\mathbf{A}\,-\,\oint_{\partial\Sigma(t)}\left[\mathbf{v}\times%
 \mathbf{F}(\mathbf{r},t)\right]\cdot\mathrm{d}\mathbf{s}     where:    F ( r , t ) is a vector field at the spatial position r at time t   Σ is a moving surface in three-space bounded by the closed curve ∂Σ  d A is a vector element of the surface Σ  d s is a vector element of the curve ∂Σ  v is the velocity of movement of the region Σ  ∇⋅ is the vector divergence   × is the vector cross product   The double integrals are surface integrals over the surface Σ, and the line integral is over the bounding curve ∂Σ.     Measure theory statement  Let   X   X   X   be an open subset of   ℝ   ℝ   \mathbb{R}   , and   Ω   normal-Ω   \Omega   be a measure space . Suppose    f  :    X  ×  Ω   →  ℝ      normal-:  f   normal-→    X  normal-Ω   ℝ     f:X\times\Omega\rightarrow\mathbb{R}   satisfies the following conditions:    (1)    f   (  x  ,  ω  )       f   x  ω     f(x,\omega)   is a Lebesgue-integrable function of   ω   ω   \omega   for each    x  ∈  X      x  X    x\in X          (2) For almost all    ω  ∈  Ω      ω  normal-Ω    \omega\in\Omega   , the derivative    f  x     subscript  f  x    f_{x}   exists for all    x  ∈  X      x  X    x\in X          (3) There is an integrable function    θ  :   Ω  →  ℝ      normal-:  θ   normal-→  normal-Ω  ℝ     \theta:\Omega\rightarrow\mathbb{R}   such that     |    f  x    (  x  ,  ω  )    |   ≤   θ   (  ω  )             subscript  f  x    x  ω       θ  ω     |f_{x}(x,\omega)|\leq\theta(\omega)   for all    x  ∈  X      x  X    x\in X   and almost every    ω  ∈  Ω      ω  normal-Ω    \omega\in\Omega        Then for all    x  ∈  X      x  X    x\in X             d   d  x       ∫  Ω     f   (  x  ,  ω  )   d  ω     =     ∫  Ω      f  x    (  x  ,  ω  )   d  ω            normal-d    normal-d  x      subscript   normal-Ω     f   x  ω   normal-d  ω       subscript   normal-Ω      subscript  f  x    x  ω   normal-d  ω      \frac{\mathrm{d}}{\mathrm{d}x}\int_{\Omega}\,f(x,\omega)\mathrm{d}\omega=\int_%
 {\Omega}\,f_{x}(x,\omega)\mathrm{d}\omega        Proofs  Proof of basic form  Let:  So that, using difference quotients ——— Substitute equation (1) into equation (2), combine the integrals (since the difference of two integrals equals the integral of the difference) and use the fact that 1/ h is a constant:       u  ′    (  x  )        superscript  u  normal-′   x    \displaystyle u^{\prime}(x)     Provided that the limit can be passed under the integral sign, we obtain        u  ′    (  x  )    =    ∫   y  0    y  1      f  x    (  x  ,  y  )   d  y           superscript  u  normal-′   x     superscript   subscript    subscript  y  0     subscript  y  1       subscript  f  x    x  y   normal-d  y      u^{\prime}(x)=\int_{y_{0}}^{y_{1}}f_{x}(x,y)\,\mathrm{d}y     We claim that the passage of the limit under the integral sign is valid. Indeed, the bounded convergence theorem (a corollary of the dominated convergence theorem ) of real analysis states that if a sequence of functions on a set of finite measure is uniformly bounded and converges pointwise, then passage of the limit under the integral is valid. To complete the proof, we show that these hypotheses are satisfied by the family of difference quotients         f  n    (  y  )    =     f   (   x  +   1  n    ,  y  )    -   f   (  x  ,  y  )      1  n     .         subscript  f  n   y         f     x    1  n    y      f   x  y       1  n      f_{n}(y)=\frac{f(x+\tfrac{1}{n},y)-f(x,y)}{\tfrac{1}{n}}.     Continuity of f x ( x , y ) and compactness implies that f x ( x , y ) is uniformly bounded. Uniform boundedness of the difference quotients follows from uniform boundedness of f x ( x , y ) and the mean value theorem , since for all y and n, there exists z in the interval [ x , x + 1/ n ] such that         f  x    (  z  ,  y  )    =     f   (   x  +   1  n    ,  y  )    -   f   (  x  ,  y  )      1  n     .         subscript  f  x    z  y          f     x    1  n    y      f   x  y       1  n      f_{x}(z,y)=\frac{f(x+\tfrac{1}{n},y)-f(x,y)}{\tfrac{1}{n}}.     The difference quotients converge pointwise to f x ( x , y ) since f x ( x , y ) exists. This completes the proof.  For a simpler proof using Fubini's theorem , see the references.  Variable limits form  For a monovariant function g :        d   d  x     (    ∫    f  1    (  x  )      f  2    (  x  )      g   (  t  )   d  t    )    =    g   [    f  2    (  x  )    ]    f  2  ′    (  x  )    -   g   [    f  1    (  x  )    ]    f  1  ′    (  x  )             normal-d    normal-d  x      superscript   subscript      subscript  f  1   x       subscript  f  2   x      g  t  normal-d  t         g   delimited-[]     subscript  f  2   x     superscript   subscript  f  2   normal-′   x     g   delimited-[]     subscript  f  1   x     superscript   subscript  f  1   normal-′   x      {\mathrm{d}\over\mathrm{d}x}\left(\int_{f_{1}(x)}^{f_{2}(x)}g(t)\,\mathrm{d}t%
 \right)=g[f_{2}(x)]{f_{2}^{\prime}(x)}-g[f_{1}(x)]{f_{1}^{\prime}(x)}     This follows from the chain rule .  General form with variable limits  Now, set        φ   (  α  )    =    ∫  a  b    f   (  x  ,  α  )   d  x     ,        φ  α     superscript   subscript   a   b     f   x  α   normal-d  x      \varphi(\alpha)=\int_{a}^{b}f(x,\alpha)\,\mathrm{d}x,     where a and b are functions of α that exhibit increments Δ a and Δ b , respectively, when α is increased by Δα. Then,      Δ  φ      normal-Δ  φ    \displaystyle\Delta\varphi     A form of the mean value theorem ,      ∫  a  b    f   (  x  )   d  x    =    (   b  -  a   )   f   (  ξ  )          superscript   subscript   a   b     f  x  normal-d  x        b  a   f  ξ     \int_{a}^{b}f(x)\,\mathrm{d}x=(b-a)f(\xi)   , where a \Delta\varphi = -\Delta a f(\xi_1, \alpha + \Delta\alpha) + \int_a^b [f(x, \alpha + \Delta\alpha) - f(x,\alpha)]\,\mathrm{d}x + \Delta b f(\xi_2, \alpha + \Delta\alpha)  Dividing by Δα, and letting Δα → 0, and noticing ξ 1 → a and ξ 2 → b and using the result        lim    Δ  α   →  0      ∫  a  b        f   (  x  ,   α  +   Δ  α    )    -   f   (  x  ,  α  )      Δ  α     d  x     =    ∫  a  b     f  α    (  x  ,  α  )   d  x          subscript    normal-→    normal-Δ  α   0      superscript   subscript   a   b           f   x    α    normal-Δ  α        f   x  α       normal-Δ  α    normal-d  x       superscript   subscript   a   b      subscript  f  α    x  α   normal-d  x      \lim_{\Delta\alpha\to 0}\int_{a}^{b}\frac{f(x,\alpha+\Delta\alpha)-f(x,\alpha)%
 }{\Delta\alpha}\,\mathrm{d}x=\int_{a}^{b}f_{\alpha}(x,\alpha)\,\mathrm{d}x     yields the general form of the Leibniz integral rule below:        d  φ    d  α    =      ∫  a  b     f  α    (  x  ,  α  )   d  x    +   f   (  b  ,  α  )     d  b    d  α      -   f   (  a  ,  α  )     d  a    d  α              normal-d  φ     normal-d  α          superscript   subscript   a   b      subscript  f  α    x  α   normal-d  x      f   b  α       normal-d  b     normal-d  α        f   a  α       normal-d  a     normal-d  α        \frac{\mathrm{d}\varphi}{\mathrm{d}\alpha}=\int_{a}^{b}f_{\alpha}(x,\alpha)\,%
 \mathrm{d}x+f(b,\alpha)\frac{\mathrm{d}b}{\mathrm{d}\alpha}-f(a,\alpha)\frac{%
 \mathrm{d}a}{\mathrm{d}\alpha}     Three-dimensional, time-dependent form  At time t the surface Σ in Figure 1 contains a set of points arranged about a centroid C ( t ) and function F ( r , t ) can be written as F ( C ( t ) + r − C (t), t ) = F ( C ( t ) + I , t ), with I independent of time. Variables are shifted to a new frame of reference attached to the moving surface, with origin at C ( t ). For a rigidly translating surface, the limits of integration are then independent of time, so:        d   d  t     (    ∬   Σ   (  t  )        d   𝐀  𝐫    ⋅  𝐅    (  𝐫  ,  t  )     )    =    ∬  Σ      d   𝐀  𝐈    ⋅   d   d  t     𝐅   (    𝐂   (  t  )    +  𝐈   ,  t  )             normal-d    normal-d  t      subscript  double-integral    normal-Σ  t       normal-⋅    normal-d   subscript  𝐀  𝐫    𝐅    𝐫  t        subscript  double-integral  normal-Σ      normal-⋅    normal-d   subscript  𝐀  𝐈      normal-d    normal-d  t     𝐅       𝐂  t   𝐈   t       \frac{\mathrm{d}}{\mathrm{d}t}\left(\iint_{\Sigma(t)}\mathrm{d}\mathbf{A}_{%
 \mathbf{r}}\cdot\mathbf{F}(\mathbf{r},t)\right)=\iint_{\Sigma}\mathrm{d}%
 \mathbf{A}_{\mathbf{I}}\cdot\frac{\mathrm{d}}{\mathrm{d}t}\mathbf{F}(\mathbf{C%
 }(t)+\mathbf{I},t)     where the limits of integration confining the integral to the region Σ no longer are time dependent so differentiation passes through the integration to act on the integrand only:        d   d  t    𝐅   (    𝐂   (  t  )    +  𝐈   ,  t  )    =     𝐅  t    (    𝐂   (  t  )    +  𝐈   ,  t  )    +    𝐯  ⋅   ∇  𝐅     (    𝐂   (  t  )    +  𝐈   ,  t  )     =     𝐅  t    (  𝐫  ,  t  )    +    𝐯  ⋅   ∇  𝐅     (  𝐫  ,  t  )               normal-d    normal-d  t    𝐅       𝐂  t   𝐈   t         subscript  𝐅  t        𝐂  t   𝐈   t       normal-⋅  𝐯   normal-∇  𝐅         𝐂  t   𝐈   t               subscript  𝐅  t    𝐫  t       normal-⋅  𝐯   normal-∇  𝐅     𝐫  t        \frac{\mathrm{d}}{\mathrm{d}t}\mathbf{F}(\mathbf{C}(t)+\mathbf{I},t)=\mathbf{F%
 }_{t}(\mathbf{C}(t)+\mathbf{I},t)+\mathbf{v\cdot\nabla F}(\mathbf{C}(t)+%
 \mathbf{I},t)=\mathbf{F}_{t}(\mathbf{r},t)+\mathbf{v}\cdot\nabla\mathbf{F}(%
 \mathbf{r},t)     with the velocity of motion of the surface defined by:      𝐯  =    d   d  t    𝐂   (  t  )        𝐯      normal-d    normal-d  t    𝐂  t     \mathbf{v}=\frac{\mathrm{d}}{\mathrm{d}t}\mathbf{C}(t)     This equation expresses the material derivative of the field, that is, the derivative with respect to a coordinate system attached to the moving surface. Having found the derivative, variables can be switched back to the original frame of reference. We notice that (see article on ''' curl ''' ):       ∇  ×   (   𝐯  ×  𝐅   )    =     (    ∇  ⋅  𝐅   +   𝐅  ⋅  ∇    )   𝐯   -    (    ∇  ⋅  𝐯   +   𝐯  ⋅  ∇    )   𝐅          normal-∇    𝐯  𝐅           normal-⋅  normal-∇  𝐅    normal-⋅  𝐅  normal-∇    𝐯        normal-⋅  normal-∇  𝐯    normal-⋅  𝐯  normal-∇    𝐅      \mathbf{\nabla\times}\left(\mathbf{v\times F}\right)=(\nabla\cdot\mathbf{F}+%
 \mathbf{F}\cdot\nabla)\mathbf{v}-(\nabla\cdot\mathbf{v}+\mathbf{v}\cdot\nabla)%
 \mathbf{F}     and that Stokes theorem allows the surface integral of the curl over Σ to be made a line integral over ∂Σ:         d   d  t     (    ∬   Σ   (  t  )        𝐅   (  𝐫  ,  t  )    ⋅  d   𝐀    )    =     ∬   Σ   (  t  )        (      𝐅  t    (  𝐫  ,  t  )    +    (   𝐅  ⋅  ∇   )   𝐯   +    (   ∇  ⋅  𝐅   )   𝐯    -    (   ∇  ⋅  𝐯   )   𝐅    )   ⋅  d    𝐀     -    ∮    ∂  Σ    (  t  )        (   𝐯  ×  𝐅   )   ⋅  d   𝐬      .          normal-d    normal-d  t      subscript  double-integral    normal-Σ  t       normal-⋅    𝐅   𝐫  t    normal-d   𝐀         subscript  double-integral    normal-Σ  t       normal-⋅         subscript  𝐅  t    𝐫  t       normal-⋅  𝐅  normal-∇   𝐯      normal-⋅  normal-∇  𝐅   𝐯       normal-⋅  normal-∇  𝐯   𝐅    normal-d   𝐀      subscript  contour-integral      normal-Σ   t       normal-⋅    𝐯  𝐅   normal-d   𝐬       \frac{\mathrm{d}}{\mathrm{d}t}\left(\iint_{\Sigma(t)}\mathbf{F}(\mathbf{r},t)%
 \cdot\mathrm{d}\mathbf{A}\right)=\iint_{\Sigma(t)}\big(\mathbf{F}_{t}(\mathbf{%
 r},t)+\left(\mathbf{F\cdot\nabla}\right)\mathbf{v}+\left(\mathbf{\nabla\cdot F%
 }\right)\mathbf{v}-(\nabla\cdot\mathbf{v})\mathbf{F}\big)\,\cdot\,\mathrm{d}%
 \mathbf{A}\,-\,\oint_{\partial\Sigma(t)}\left(\mathbf{\mathbf{v}\times F}%
 \right)\mathbf{\cdot}\,\mathrm{d}\mathbf{s}.     The sign of the line integral is based on the right-hand rule for the choice of direction of line element d s . To establish this sign, for example, suppose the field F points in the positive z -direction, and the surface Σ is a portion of the xy -plane with perimeter ∂Σ. We adopt the normal to Σ to be in the positive z -direction. Positive traversal of ∂Σ is then counterclockwise (right-hand rule with thumb along z -axis). Then the integral on the left-hand side determines a positive flux of F through Σ. Suppose Σ translates in the positive x -direction at velocity v . An element of the boundary of Σ parallel to the y -axis, say d s , sweeps out an area v t × d s in time t . If we integrate around the boundary ∂Σ in a counterclockwise sense, v t × d s points in the negative z -direction on the left side of ∂Σ (where d s points downward), and in the positive z -direction on the right side of ∂Σ (where d s points upward), which makes sense because Σ is moving to the right, adding area on the right and losing it on the left. On that basis, the flux of F is increasing on the right of ∂Σ and decreasing on the left. However, the dot-product v × F • d s = − F × v • d s = − F • v × d s . Consequently, the sign of the line integral is taken as negative.  If v is a constant,        d   d  t      ∬   Σ   (  t  )        𝐅   (  𝐫  ,  t  )    ⋅  d   𝐀     =     ∬   Σ   (  t  )        (     𝐅  t    (  𝐫  ,  t  )    +    (   ∇  ⋅  𝐅   )   𝐯    )   ⋅  d   𝐀    -    ∮    ∂  Σ    (  t  )        (   𝐯  ×  𝐅   )   ⋅  d   𝐬             normal-d    normal-d  t      subscript  double-integral    normal-Σ  t       normal-⋅    𝐅   𝐫  t    normal-d   𝐀         subscript  double-integral    normal-Σ  t       normal-⋅       subscript  𝐅  t    𝐫  t       normal-⋅  normal-∇  𝐅   𝐯    normal-d   𝐀      subscript  contour-integral      normal-Σ   t       normal-⋅    𝐯  𝐅   normal-d   𝐬       \frac{\mathrm{d}}{\mathrm{d}t}\iint_{\Sigma(t)}\mathbf{F}(\mathbf{r},t)\cdot%
 \mathrm{d}\mathbf{A}=\iint_{\Sigma(t)}\big(\mathbf{F}_{t}(\mathbf{r},t)+\left(%
 \mathbf{\nabla\cdot F}\right)\mathbf{v}\big)\cdot\mathrm{d}\mathbf{A}-\oint_{%
 \partial\Sigma(t)}\left(\mathbf{\mathbf{v}\times F}\right)\mathbf{\cdot}\,%
 \mathrm{d}\mathbf{s}     which is the quoted result. This proof does not consider the possibility of the surface deforming as it moves.  See also   Chain rule  Leibniz rule (generalized product rule)  Differentiation under the integral sign  Reynolds transport theorem a generalization of Leibniz rule   References and notes  External links   "The Leibniz Rule" by Rob Harron   "  Category:Gottfried Leibniz  Category:Multivariable calculus  Category:Integral calculus  Category:Articles containing proofs     ↩     
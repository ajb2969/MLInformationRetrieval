<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="235">Common spatial pattern</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Common spatial pattern</h1>
<hr/>

<p><strong>Common spatial pattern</strong> (<strong>CSP</strong>) is a mathematical procedure used in <a href="signal_processing" title="wikilink">signal processing</a> for separating a <a href="Multivariate_analysis" title="wikilink">multivariate</a> signal into <a href="Additive_map" title="wikilink">additive</a> subcomponents which have maximum differences in <a class="uri" href="variance" title="wikilink">variance</a> between two <a href="Window_function" title="wikilink">windows</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="details">Details</h2>

<p>Let 

<math display="inline" id="Common_spatial_pattern:0">
 <semantics>
  <msub>
   <mi>𝐗</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐗</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}_{1}
  </annotation>
 </semantics>
</math>

 of size 

<math display="inline" id="Common_spatial_pattern:1">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>n</mi>
   <mo>,</mo>
   <msub>
    <mi>t</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>n</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">1</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n,t_{1})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Common_spatial_pattern:2">
 <semantics>
  <msub>
   <mi>𝐗</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐗</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}_{2}
  </annotation>
 </semantics>
</math>

 of size 

<math display="inline" id="Common_spatial_pattern:3">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>n</mi>
   <mo>,</mo>
   <msub>
    <mi>t</mi>
    <mn>2</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>n</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <cn type="integer">2</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (n,t_{2})
  </annotation>
 </semantics>
</math>

 be two windows of a multivariate <a href="Signal_(electrical_engineering)" title="wikilink">signal</a>, where 

<math display="inline" id="Common_spatial_pattern:4">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is the number of signals and 

<math display="inline" id="Common_spatial_pattern:5">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Common_spatial_pattern:6">
 <semantics>
  <msub>
   <mi>t</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{2}
  </annotation>
 </semantics>
</math>

 are the respective number of samples.</p>

<p>The CSP algorithm determines the component 

<math display="inline" id="Common_spatial_pattern:7">
 <semantics>
  <msup>
   <mi>𝐰</mi>
   <mtext>T</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐰</ci>
    <mtext>T</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}^{\text{T}}
  </annotation>
 </semantics>
</math>

 such that the ratio of <a class="uri" href="variance" title="wikilink">variance</a> (or second-order <a href="Moment_(mathematics)" title="wikilink">moment</a>) is maximized between the two windows:</p>

<p>

<math display="block" id="Common_spatial_pattern:8">
 <semantics>
  <mrow>
   <mi>𝐰</mi>
   <mo>=</mo>
   <mrow>
    <mi>arg</mi>
    <mrow>
     <munder>
      <mi>max</mi>
      <mi>𝐰</mi>
     </munder>
     <mfrac>
      <msup>
       <mrow>
        <mo>∥</mo>
        <msub>
         <mi>𝐰𝐗</mi>
         <mn>1</mn>
        </msub>
        <mo>∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <msup>
       <mrow>
        <mo>∥</mo>
        <msub>
         <mi>𝐰𝐗</mi>
         <mn>2</mn>
        </msub>
        <mo>∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐰</ci>
    <apply>
     <arg></arg>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <max></max>
       <ci>𝐰</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐰𝐗</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐰𝐗</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}={\arg\max}_{\mathbf{w}}\frac{\left\|\mathbf{wX}_{1}\right\|^{2}}{%
\left\|\mathbf{wX}_{2}\right\|^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>The solution is given by computing the two <a href="covariance_matrix" title="wikilink">covariance matrices</a>:</p>

<p>

<math display="block" id="Common_spatial_pattern:9">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐑</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>𝐗</mi>
      <mn>1</mn>
     </msub>
     <msubsup>
      <mi>𝐗</mi>
      <mn>1</mn>
      <mtext>T</mtext>
     </msubsup>
    </mrow>
    <msub>
     <mi>t</mi>
     <mn>1</mn>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐑</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐗</ci>
        <cn type="integer">1</cn>
       </apply>
       <mtext>T</mtext>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}_{1}=\frac{\mathbf{X}_{1}\mathbf{X}_{1}^{\text{T}}}{t_{1}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Common_spatial_pattern:10">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐑</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>𝐗</mi>
      <mn>2</mn>
     </msub>
     <msubsup>
      <mi>𝐗</mi>
      <mn>2</mn>
      <mtext>T</mtext>
     </msubsup>
    </mrow>
    <msub>
     <mi>t</mi>
     <mn>2</mn>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐑</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐗</ci>
        <cn type="integer">2</cn>
       </apply>
       <mtext>T</mtext>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}_{2}=\frac{\mathbf{X}_{2}\mathbf{X}_{2}^{\text{T}}}{t_{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>Then, the <a href="Matrix_diagonalization#Simultaneous_diagonalization" title="wikilink">simultaneous diagonalization</a> of those two <a href="Matrix_(mathematics)" title="wikilink">matrices</a> (also called <a href="Eigendecomposition_of_a_matrix#Generalized_eigenvalue_problem" title="wikilink">generalized eigenvalue decomposition</a>) is realized. We find the matrix of <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvectors</a> 

<math display="inline" id="Common_spatial_pattern:11">
 <semantics>
  <mrow>
   <mi>𝐏</mi>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <msub>
        <mi>𝐩</mi>
        <mn>1</mn>
       </msub>
      </mtd>
      <mtd columnalign="center">
       <mi mathvariant="normal">⋯</mi>
      </mtd>
      <mtd columnalign="center">
       <msub>
        <mi>𝐩</mi>
        <mi>n</mi>
       </msub>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐏</ci>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐩</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐩</ci>
       <ci>n</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}=\begin{bmatrix}\mathbf{p}_{1}&\cdots&\mathbf{p}_{n}\end{bmatrix}
  </annotation>
 </semantics>
</math>

 and the <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> 

<math display="inline" id="Common_spatial_pattern:12">
 <semantics>
  <mi>𝐃</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐃</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{D}
  </annotation>
 </semantics>
</math>

 of <a href="Eigenvalues_and_eigenvectors" title="wikilink">eigenvalues</a> 

<math display="inline" id="Common_spatial_pattern:13">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>λ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo>,</mo>
   <msub>
    <mi>λ</mi>
    <mi>n</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⋯</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>n</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{\lambda_{1},\cdots,\lambda_{n}\}
  </annotation>
 </semantics>
</math>

 sorted by decreasing order such that:</p>

<p>

<math display="block" id="Common_spatial_pattern:14">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐏</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msub>
     <mi>𝐑</mi>
     <mn>1</mn>
    </msub>
    <mi>𝐏</mi>
   </mrow>
   <mo>=</mo>
   <mi>𝐃</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐏</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐑</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>𝐏</ci>
    </apply>
    <ci>𝐃</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}^{-1}\mathbf{R}_{1}\mathbf{P}=\mathbf{D}
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Common_spatial_pattern:15">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐏</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msub>
     <mi>𝐑</mi>
     <mn>2</mn>
    </msub>
    <mi>𝐏</mi>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>𝐈</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐏</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐑</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>𝐏</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐈</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}^{-1}\mathbf{R}_{2}\mathbf{P}=\mathbf{I}_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Common_spatial_pattern:16">
 <semantics>
  <msub>
   <mi>𝐈</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐈</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{I}_{n}
  </annotation>
 </semantics>
</math>

 the <a href="identity_matrix" title="wikilink">identity matrix</a>.</p>

<p>This is equivalent to the <a href="Eigendecomposition_of_a_matrix" title="wikilink">eigendecomposition</a> of 

<math display="inline" id="Common_spatial_pattern:17">
 <semantics>
  <mrow>
   <msubsup>
    <mi>𝐑</mi>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi>𝐑</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐑</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐑</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}_{2}^{-1}\mathbf{R}_{1}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Common_spatial_pattern:18">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>𝐑</mi>
     <mn>2</mn>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <msub>
     <mi>𝐑</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>𝐏𝐃𝐏</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐑</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐑</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝐏𝐃𝐏</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}_{2}^{-1}\mathbf{R}_{1}=\mathbf{PDP}^{-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Common_spatial_pattern:19">
 <semantics>
  <msup>
   <mi>𝐰</mi>
   <mtext>T</mtext>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐰</ci>
    <mtext>T</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}^{\text{T}}
  </annotation>
 </semantics>
</math>

 will correspond to the first column of 

<math display="inline" id="Common_spatial_pattern:20">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Common_spatial_pattern:21">
 <semantics>
  <mrow>
   <mi>𝐰</mi>
   <mo>=</mo>
   <msubsup>
    <mi>𝐩</mi>
    <mn>1</mn>
    <mtext>T</mtext>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐰</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <cn type="integer">1</cn>
     </apply>
     <mtext>T</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}=\mathbf{p}_{1}^{\text{T}}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="discussion">Discussion</h2>
<h3 id="relation-between-variance-ratio-and-eigenvalue">Relation between variance ratio and eigenvalue</h3>

<p>The eigenvectors composing 

<math display="inline" id="Common_spatial_pattern:22">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 are components with variance ratio between the two windows equal to their corresponding eigenvalue:</p>

<p>

<math display="block" id="Common_spatial_pattern:23">
 <semantics>
  <mrow>
   <msub>
    <mi>λ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <msubsup>
        <mi>𝐩</mi>
        <mi>i</mi>
        <mtext>T</mtext>
       </msubsup>
       <msub>
        <mi>𝐗</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <msup>
     <mrow>
      <mo>∥</mo>
      <mrow>
       <msubsup>
        <mi>𝐩</mi>
        <mi>i</mi>
        <mtext>T</mtext>
       </msubsup>
       <msub>
        <mi>𝐗</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>∥</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐩</ci>
          <ci>i</ci>
         </apply>
         <mtext>T</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐗</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐩</ci>
          <ci>i</ci>
         </apply>
         <mtext>T</mtext>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐗</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\lambda}_{i}=\frac{\left\|\mathbf{p}_{i}^{\text{T}}\mathbf{X}_{1}%
\right\|^{2}}{\left\|\mathbf{p}_{i}^{\text{T}}\mathbf{X}_{2}\right\|^{2}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="other-components">Other components</h3>

<p>The <a href="vector_subspace" title="wikilink">vectorial subspace</a> 

<math display="inline" id="Common_spatial_pattern:24">
 <semantics>
  <msub>
   <mi>E</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>E</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{i}
  </annotation>
 </semantics>
</math>

 generated by the 

<math display="inline" id="Common_spatial_pattern:25">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 first eigenvectors 

<math display="inline" id="Common_spatial_pattern:26">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>𝐩</mi>
       <mn>1</mn>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋯</mi>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>𝐩</mi>
       <mi>i</mi>
      </msub>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <ci>i</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}\mathbf{p}_{1}&\cdots&\mathbf{p}_{i}\end{bmatrix}
  </annotation>
 </semantics>
</math>

 will be the subspace maximizing the variance ratio of all components belonging to it:</p>

<p>

<math display="block" id="Common_spatial_pattern:27">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>arg</mi>
    <mrow>
     <munder>
      <mi>max</mi>
      <mi>E</mi>
     </munder>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>min</mi>
           <mrow>
            <mi>p</mi>
            <mo>∈</mo>
            <mi>E</mi>
           </mrow>
          </msub>
          <mstyle displaystyle="false">
           <mfrac>
            <msup>
             <mrow>
              <mo>∥</mo>
              <mrow>
               <msup>
                <mi>𝐩</mi>
                <mtext>T</mtext>
               </msup>
               <msub>
                <mi>𝐗</mi>
                <mn>1</mn>
               </msub>
              </mrow>
              <mo>∥</mo>
             </mrow>
             <mn>2</mn>
            </msup>
            <msup>
             <mrow>
              <mo>∥</mo>
              <mrow>
               <msup>
                <mi>𝐩</mi>
                <mtext>T</mtext>
               </msup>
               <msub>
                <mi>𝐗</mi>
                <mn>2</mn>
               </msub>
              </mrow>
              <mo>∥</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mfrac>
          </mstyle>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <arg></arg>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <max></max>
       <ci>E</ci>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <min></min>
          <apply>
           <in></in>
           <ci>p</ci>
           <ci>E</ci>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>𝐩</ci>
              <mtext>T</mtext>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>𝐗</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>𝐩</ci>
              <mtext>T</mtext>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>𝐗</ci>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{i}={\arg\max}_{E}\begin{pmatrix}\min_{p\in E}\frac{\left\|\mathbf{p^{\text{%
T}}X}_{1}\right\|^{2}}{\left\|\mathbf{p^{\text{T}}X}_{2}\right\|^{2}}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>On the same way, the vectorial subpsace 

<math display="inline" id="Common_spatial_pattern:28">
 <semantics>
  <msub>
   <mi>F</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{j}
  </annotation>
 </semantics>
</math>

 generated by the 

<math display="inline" id="Common_spatial_pattern:29">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

 last eigenvectors 

<math display="inline" id="Common_spatial_pattern:30">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mtable>
    <mtr>
     <mtd columnalign="center">
      <msub>
       <mi>𝐩</mi>
       <mrow>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mi>j</mi>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="center">
      <mi mathvariant="normal">⋯</mi>
     </mtd>
     <mtd columnalign="center">
      <msub>
       <mi>𝐩</mi>
       <mi>n</mi>
      </msub>
     </mtd>
    </mtr>
   </mtable>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>j</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐩</ci>
      <ci>n</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}\mathbf{p}_{n-j+1}&\cdots&\mathbf{p}_{n}\end{bmatrix}
  </annotation>
 </semantics>
</math>

 will be the subspace minimizing the variance ratio of all components belonging to it:</p>

<p>

<math display="block" id="Common_spatial_pattern:31">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>arg</mi>
    <mrow>
     <munder>
      <mi>min</mi>
      <mi>F</mi>
     </munder>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <msub>
           <mi>max</mi>
           <mrow>
            <mi>p</mi>
            <mo>∈</mo>
            <mi>F</mi>
           </mrow>
          </msub>
          <mstyle displaystyle="false">
           <mfrac>
            <msup>
             <mrow>
              <mo>∥</mo>
              <mrow>
               <msup>
                <mi>𝐩</mi>
                <mtext>T</mtext>
               </msup>
               <msub>
                <mi>𝐗</mi>
                <mn>1</mn>
               </msub>
              </mrow>
              <mo>∥</mo>
             </mrow>
             <mn>2</mn>
            </msup>
            <msup>
             <mrow>
              <mo>∥</mo>
              <mrow>
               <msup>
                <mi>𝐩</mi>
                <mtext>T</mtext>
               </msup>
               <msub>
                <mi>𝐗</mi>
                <mn>2</mn>
               </msub>
              </mrow>
              <mo>∥</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mfrac>
          </mstyle>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <ci>j</ci>
    </apply>
    <apply>
     <arg></arg>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <ci>F</ci>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <max></max>
          <apply>
           <in></in>
           <ci>p</ci>
           <ci>F</ci>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>𝐩</ci>
              <mtext>T</mtext>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>𝐗</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="latexml">norm</csymbol>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>𝐩</ci>
              <mtext>T</mtext>
             </apply>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>𝐗</ci>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{j}={\arg\min}_{F}\begin{pmatrix}\max_{p\in F}\frac{\left\|\mathbf{p^{\text{%
T}}X}_{1}\right\|^{2}}{\left\|\mathbf{p^{\text{T}}X}_{2}\right\|^{2}}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="variance-or-second-order-moment">Variance or second-order moment</h3>

<p>CSP can be applied after a <a class="uri" href="mean" title="wikilink">mean</a> subtraction (a.k.a. "mean centering") on signals in order to realize a variance ratio optimization. Otherwize CSP optimizes the ratio of second-order moment.</p>
<h3 id="choice-of-windows-x1-and-x2">Choice of windows X<sub>1</sub> and X<sub>2</sub></h3>
<ul>
<li>The standard use consists on choosing the windows to correspond to two periods of time with different activation of sources (e.g. during rest and during a specific task).</li>
</ul>
<ul>
<li>It is also possible to choose the two windows to correspond to two different frequency bands in order to find components with specific frequency pattern.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Those frequency bands can be on temporal or on frequential basis. Since the matrix 

<math display="inline" id="Common_spatial_pattern:32">
 <semantics>
  <mi>𝐏</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐏</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{P}
  </annotation>
 </semantics>
</math>

 depends only of the covariance matrices, the same results can be obtained if the processing is applied on the <a href="Fourier_transform" title="wikilink">Fourier transform</a> of the signals.</li>
</ul>
<ul>
<li>Y. Wang <a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> has proposed a particular choice for the first window 

<math display="inline" id="Common_spatial_pattern:33">
 <semantics>
  <msub>
   <mi>𝐗</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐗</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}_{1}
  </annotation>
 </semantics>
</math>

 in order to extract components which have a specific period. 

<math display="inline" id="Common_spatial_pattern:34">
 <semantics>
  <msub>
   <mi>𝐗</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐗</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}_{1}
  </annotation>
 </semantics>
</math>

 was the mean of the different periods for the examined signals.</li>
</ul>
<ul>
<li>If there is only one window, 

<math display="inline" id="Common_spatial_pattern:35">
 <semantics>
  <msub>
   <mi>𝐑</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐑</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}_{2}
  </annotation>
 </semantics>
</math>

 can be considered as the identity matrix and then CSP corresponds to <a href="Principal_component_analysis" title="wikilink">Principal component analysis</a>.</li>
</ul>
<h2 id="applications">Applications</h2>

<p>This method can be applied to several multivariate signal but it seems that most works on it concern <a href="electroencephalography" title="wikilink">electroencephalographic</a> signals.</p>

<p>Particularly, the method is mostly used on <a href="brain–computer_interface" title="wikilink">brain–computer interface</a> in order to retrieve the component signal which best transduce the cerebral activity for a specific task (e.g. hand movement).<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>It can also be used to separate artifacts from electroencephalographics signals.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Blind_signal_separation" title="wikilink">Blind signal separation</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Zoltan J. Koles, Michael S. Lazaret and Steven Z. Zhou, <a href="http://www.springerlink.com/content/l378x271583v34p7/">"Spatial patterns underlying population differences in the background EEG"</a>, Brain topography, Vol. 2 (4) pp. 275-284, 1990<a href="#fnref1">↩</a></li>
<li id="fn2">S. Boudet, <a href="http://www.theses.fr/2008LIL10156">"Filtrage d'artefacts par analyse multicomposantes de l'électroencephalogramme de patients épileptiques."</a>, PhD. Thesis: Unviversité de Lille 1, 07/2008<a href="#fnref2">↩</a></li>
<li id="fn3">Y. Wang, "Reduction of cardiac artifacts in magnetoencephalogram." Proc. of the 12th Int. Conf. on Biomagnetism, 2000<a href="#fnref3">↩</a></li>
<li id="fn4">G. Pfurtscheller, C. Gugeret and H. Ramoser <a href="http://www.springerlink.com/content/164875w6w5211303/">"EEG-based brain-computer interface using subject-specific spatial filters"</a>, Engineering applications of bio-inspired artificial neural networks, Lecture Notes in Computer Science, 1999, Vol. 1607/1999, pp. 248-254<a href="#fnref4">↩</a></li>
<li id="fn5"></li>
</ol>
</section>
</body>
</html>

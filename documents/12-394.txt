   Spectral theory of ordinary differential equations      Spectral theory of ordinary differential equations  In [[mathematics]], the '''spectral theory of ordinary differential equations''' is the part of [[spectral theory]] concerned with the determination of the [[Spectrum of an operator#Spectrum of unbounded operators|spectrum]] and [[eigenfunction|eigenfunction expansion]] associated with a linear ordinary  differential  equation . In his dissertation Hermann  Weyl generalized the classical Sturm–Liouville  theory on a finite closed  interval to second order differential  operators with singularities at the endpoints of the interval, possibly semi-infinite or infinite. Unlike the classical case, the spectrum may no longer consist of just a countable set of eigenvalues, but may also contain a continuous part. In this case the eigenfunction expansion involves an integral over the continuous part with respect to a spectral  measure , given by the Titchmarsh – Kodaira  formula . The theory was put in its final simplified form for singular differential equations of even degree by Kodaira and others, using von  Neumann 's spectral  theorem . It has had important applications in quantum  mechanics , operator  theory and harmonic  analysis on semisimple  Lie  groups .  Introduction  Spectral theory for second order ordinary differential equations on a compact interval was developed by Jacques Charles François Sturm and Joseph Liouville in the nineteenth century and is now known as Sturm–Liouville theory . In modern language it is an application of the spectral theorem for compact operators due to David Hilbert . In his dissertation, published in 1910, Hermann Weyl extended this theory to second order ordinary differential equations with singularities at the endpoints of the interval, now allowed to be infinite or semi-infinite. He simultaneously developed a spectral theory adapted to these special operators and introduced boundary conditions in terms of his celebrated dichotomy between limit points and limit circles .  In the 1920s John von Neumann established a general spectral theorem for unbounded  self-adjoint operators , which Kunihiko Kodaira used to streamline Weyl's method. Kodaira also generalised Weyl's method to singular ordinary differential equations of even order and obtained a simple formula for the spectral measure . The same formula had also been obtained independently by E. C. Titchmarsh in 1946 (scientific communication between Japan and the United Kingdom had been interrupted by World War II ). Titchmarsh had followed the method of the German mathematician Emil Hilb , who derived the eigenfunction expansions using complex function theory instead of operator theory . Other methods avoiding the spectral theorem were later developed independently by Levitan, Levinson and Yoshida, who used the fact that the resolvent of the singular differential operator could be approximated by compact resolvents corresponding to Sturm–Liouville problems for proper subintervals. Another method was found by Mark Grigoryevich Krein ; his use of direction functionals was subsequently generalised by Izrail Glazman to arbitrary ordinary differential equations of even order.  Weyl applied his theory to Carl Friedrich Gauss 's hypergeometric differential equation , thus obtaining a far-reaching generalisation of the transform formula of Gustav Ferdinand Mehler (1881) for the Legendre differential equation , rediscovered by the Russian physicist Vladimir Fock in 1943, and usually called the Mehler–Fock transform . The corresponding ordinary differential operator is the radial part of the Laplacian operator on 2-dimensional hyperbolic space . More generally, the Plancherel theorem for SL(2,R) of Harish Chandra and Gelfand – Naimark can be deduced from Weyl's theory for the hypergeometric equation, as can the theory of spherical functions for the isometry groups of higher dimensional hyperbolic spaces. Harish Chandra's later development of the Plancherel theorem for general real semisimple Lie groups was strongly influenced by the methods Weyl developed for eigenfunction expansions associated with singular ordinary differential equations. Equally importantly the theory also laid the mathematical foundations for the analysis of the Schrödinger equation and scattering matrix in quantum mechanics .  Solutions of ordinary differential equations  Reduction to standard form  Let D be the second order differential operator on (a,b) given by        D  f   (  x  )    =    -   p   (  x  )    f  ′′    (  x  )     +   r   (  x  )    f  ′    (  x  )    +   q   (  x  )   f   (  x  )      ,        D  f  x         p  x   superscript  f  ′′   x      r  x   superscript  f  normal-′   x     q  x  f  x      Df(x)=-p(x)f^{\prime\prime}(x)+r(x)f^{\prime}(x)+q(x)f(x),     where p is a strictly positive continuously differentiable function and q and r are continuous real-valued functions.  For x 0 in ( a , b ), define the Liouville transformation ψ by       ψ   (  x  )    =    ∫   x  0   x    p     (  t  )    -   1  /  2      d  t          ψ  x     superscript   subscript    subscript  x  0    x     p   superscript  t      1  2     d  t      \psi(x)=\int_{x_{0}}^{x}p(t)^{-1/2}\,dt     If      U  :     L  2    (  a  ,  b  )    ↦    L  2    (   ψ   (  a  )    ,   ψ   (  b  )    )        normal-:  U   maps-to     superscript  L  2    a  b       superscript  L  2      ψ  a     ψ  b        U:L^{2}(a,b)\mapsto L^{2}(\psi(a),\psi(b))     is the unitary operator defined by         (   U  f   )    (   ψ   (  x  )    )    =    f   (  x  )    ×    (    ψ  ′    (  x  )    )    -   1  /  2       ,    ∀  x   ∈   (  a  ,  b  )       formulae-sequence        U  f     ψ  x        f  x    superscript     superscript  ψ  normal-′   x       1  2          for-all  x    a  b      (Uf)(\psi(x))=f(x)\times\left(\psi^{\prime}(x)\right)^{-1/2},\ \ \forall x\in(%
 a,b)     then       U   d   d  x     U   -  1    g   =     g  ′    ψ  ′    +    1  2   g    ψ  ′′    ψ  ′            U    normal-d    normal-d  x     superscript  U    1    g        superscript  g  normal-′    superscript  ψ  normal-′        1  2   g     superscript  ψ  ′′    superscript  ψ  normal-′        U\frac{\mathrm{d}}{\mathrm{d}x}U^{-1}g=g^{\prime}\psi^{\prime}+\frac{1}{2}g%
 \frac{\psi^{\prime\prime}}{\psi^{\prime}}     and      U     d  2    d   x  2       U   -  1    g      U     superscript  normal-d  2     normal-d   superscript  x  2      superscript  U    1    g    \displaystyle U\frac{\mathrm{d}^{2}}{\mathrm{d}x^{2}}U^{-1}g     Hence,        U  D   U   -  1    g   =    -   g  ′′    +   R   g  ′    +   Q  g     ,        U  D   superscript  U    1    g        superscript  g  ′′      R   superscript  g  normal-′      Q  g      UDU^{-1}g=-g^{\prime\prime}+Rg^{\prime}+Qg,     where      R  =     p  ′   +  r    p   1  /  2         R       superscript  p  normal-′   r    superscript  p    1  2       R=\frac{p^{\prime}+r}{p^{1/2}}     and      Q  =     q  -    r   p  ′     4  p     +    p  ′′   4    -    p   ′  2     8  p         Q        q      r   superscript  p  normal-′      4  p        superscript  p  ′′   4       superscript  p   normal-′  2      8  p       Q=q-\frac{rp^{\prime}}{4p}+\frac{p^{\prime\prime}}{4}-\frac{p^{\prime 2}}{8p}     The term in ''g' '' can be removed using an Euler  integrating factor . If ''S' / S'' = − R /2, then h = Sg satisfies         (   S  U  D   U   -  1     S   -  1     )   h   =    -   h  ′′    +   V  h     ,          S  U  D   superscript  U    1     superscript  S    1     h        superscript  h  ′′      V  h      (SUDU^{-1}S^{-1})h=-h^{\prime\prime}+Vh,     where the potential  V is given by      V  =   Q  +    S  ′′   S        V    Q     superscript  S  ′′   S      V=Q+\frac{S^{\prime\prime}}{S}     The differential operator can thus always be reduced to one of the form 1        D  f   =    -   f  ′′    +   q  f     .        D  f        superscript  f  ′′      q  f      Df=-f^{\prime\prime}+qf.     Existence theorem  The following is a version of the classical Picard existence theorem for second order differential equations with values in a Banach space  E . 2  Let α, β be arbitrary elements of E , A a bounded operator on E and q a continuous function on [ a , b ].  Then, for c = a or b , the differential equation   Df = Af    has a unique solution f in C 2 ([ a , b ], E ) satisfying the initial conditions   f ( c ) = β, f '( c ) = α.   In fact a solution of the differential equation with these initial conditions is equivalent to a solution of the integral equation   f = h + T  f    with T the bounded linear map on C ([ a , b ], E ) defined by        T  f   (  x  )    =    ∫  c  x    K   (  x  ,  y  )   f   (  y  )   d  y     ,        T  f  x     superscript   subscript   c   x     K   x  y   f  y  d  y      Tf(x)=\int_{c}^{x}K(x,y)f(y)\,dy,     where K is the Volterra kernel   K ( x , t )= ( x − t )( q ( t ) − A )   and   h ( x ) = α( x − c ) + β.   Since || T k || tends to 0, this integral equation has a unique solution given by the Neumann series   f = ( I − T ) −1  h = h + T  h + T 2  h + T 3  h + ···   This iterative scheme is often called Picard iteration after the French mathematician Charles Émile Picard .  Fundamental eigenfunctions  If f is twice continuously differentiable (i.e. C 2 ) on ( a , b ) satisfying Df = λ f , then f is called an eigenfunction of L with eigenvalue λ.   In the case of a compact interval [ a , b ] and q continuous on [ a , b ], the existence theorem implies that for c = a or b and every complex number λ there a unique C 2 eigenfunction f λ on [ a , b ] with f λ (c) and f ' λ (c) prescribed. Moreover, for each x in [ a , b ], f λ (x) and f ' λ (x) are holomorphic functions of λ.    For an arbitrary interval ( a , b ) and q continuous on ( a , b ), the existence theorem implies that for c in ( a , b ) and every complex number λ there a unique C 2 eigenfunction f λ on ( a , b ) with f λ (c) and f ' λ (c) prescribed. Moreover, for each x in ( a , b ), f λ (x) and f ' λ (x) are holomorphic functions of λ.   Green's formula  If f and g are C 2 functions on ( a , b ), the Wronskian  W ( f , g ) is defined by   W ( f , g ) (x) = f ( x ) g '( x ) − f '( x ) g ( x ).   Green's formula - which in this one-dimensional case is a simple integration by parts - states that for x , y in ( a , b )          ∫  x  y     (   D  f   )   g    -   f   (   D  g   )   d  t    =    W   (  f  ,  g  )    (  y  )    -   W   (  f  ,  g  )    (  x  )      .          superscript   subscript   x   y       D  f   g      f    D  g   d  t        W   f  g   y     W   f  g   x      \int_{x}^{y}(Df)g-f(Dg)\,dt=W(f,g)(y)-W(f,g)(x).     When q is continuous and f , g  C 2 on the compact interval [ a , b ], this formula also holds for x = a or y = b .  When f and g are eigenfunctions for the same eigenvalue, then         d   d  x    W   (  f  ,  g  )    =  0   ,          d    d  x    W   f  g    0    {d\over dx}W(f,g)=0,     so that W ( f , g ) is independent of x .  Classical Sturm–Liouville theory  Let [ a , b ] be a finite closed interval, q a real-valued continuous function on [ a , b ] and let H 0 be the space of C 2 functions f on [ a , b ] satisfying the Robin boundary conditions           cos    α   f     (  a  )    -    sin    α    f  ′      (  a  )     =  0   ,      cos    β   f     (  b  )    -    sin    β    f  ′      (  b  )     =  0    ,     formulae-sequence            α  f    a         α   superscript  f  normal-′     a    0             β  f    b         β   superscript  f  normal-′     b    0     \cos\alpha\,f(a)-\sin\alpha\,f^{\prime}(a)=0,\qquad\cos\beta\,f(b)-\sin\beta\,%
 f^{\prime}(b)=0,     with inner product        (  f  ,  g  )   =    ∫  a  b    f   (  x  )      g   (  x  )    ¯    d  x     .       f  g     superscript   subscript   a   b     f  x   normal-¯    g  x    d  x      (f,g)=\int_{a}^{b}f(x)\overline{g(x)}\,dx.     In practise usually one of the two standard boundary conditions:   Dirichlet boundary condition  f ( c ) = 0  Neumann boundary condition  f '( c ) = 0   is imposed at each endpoint c = a , b .  The differential operator D given by       D  f   =    -   f  ′′    +   q  f          D  f        superscript  f  ′′      q  f      Df=-f^{\prime\prime}+qf     acts on H 0 . A function f in H 0 is called an eigenfunction of D (for the above choice of boundary values) if Df = λ f for some complex number λ, the corresponding eigenvalue . By Green's formula, D is formally self-adjoint on H 0 , since the Wronskian W(f,g) vanishes if both f,g satisfy the boundary conditions:   ( Df , g ) = ( f , Dg ) for f , g in H 0 .   As a consequence, exactly as for a self-adjoint matrix in finite dimensions,   the eigenvalues of D are real;  the eigenspaces for distinct eigenvalues are orthogonal .   It turns out that the eigenvalues can be described by the maximum-minimum principle of Rayleigh – Ritz  3 (see below). In fact it is easy to see a priori that the eigenvalues are bounded below because the operator D is itself bounded below on H 0 :  :*     (   D  f   ,  f  )   ≥   M   (  f  ,  f  )           D  f   f     M   f  f      (Df,f)\geq M(f,f)   for some finite (possibly negative) constant   M   M   M   .  In fact integrating by parts          (   D  f   ,  f  )   =     [   -    f  ′    f  ¯     ]   a  b   +   ∫    |   f  ′   |   2    +   ∫   q    |  f  |   2       .         D  f   f      superscript   subscript   delimited-[]       superscript  f  normal-′    normal-¯  f      a   b      superscript     superscript  f  normal-′    2        q   superscript    f   2        (Df,f)=[-f^{\prime}\overline{f}]_{a}^{b}+\int|f^{\prime}|^{2}+\int q|f|^{2}.        For Dirichlet or Neumann boundary conditions, the first term vanishes and the inequality holds with M = inf q .  For general Robin boundary conditions the first term can be estimated using an elementary Peter-Paul version of Sobolev's inequality :    " Given ε > 0, there is constant R >0 such that |f(x)| 2 ≤ ε (f', f') + R (f, f) for all f in C 1 [a, b]. "     In fact, since    | f ( b ) − f ( x )| ≤ ( b − a ) ½ ·|| f '|| 2 ,     only an estimate for f ( b ) is needed and this follows by replacing f ( x ) in the above inequality by ( x − a ) n ·( b − a ) − n · f ( x ) for n sufficiently large.  Green's function (regular case)  From the theory of ordinary differential equations, there are unique fundamental eigenfunctions φ λ (x), χ λ (x) such that   D φ λ = λ φ λ , φ λ ( a ) = sin α, φ λ '( a ) = cos α  D χ λ = λ χ λ , χ λ ( b ) = sin β, χ λ '( b ) = cos β   which at each point, together with their first derivatives, depend holomorphically on λ. Let   ω(λ) = W(φ λ , χ λ ),   an entire holomorphic function .  This function ω(λ) plays the rôle of the characteristic polynomial of D . Indeed the uniqueness of the fundamental eigenfunctions implies that its zeros are precisely the eigenvalues of D and that each non-zero eigenspace is one-dimensional. In particular there are at most countably many eigenvalues of D and, if there are infinitely many, they must tend to infinity. It turns out that the zeros of ω(λ) also have mutilplicity one (see below).  If λ is not an eigenvalue of D on H 0 , define the Green's function by   G λ ( x , y ) = φ λ ( x ) χ λ ( y ) / ω(λ) for x ≥ y and χ λ ( x ) φ λ ( y ) / ω(λ) for y ≥ x .   This kernel defines an operator on the inner product space C[ a , b ] via         (    G  λ   f   )    (  x  )    =    ∫  a  b     G  λ    (  x  ,  y  )   f   (  y  )   d  y     .           subscript  G  λ   f   x     superscript   subscript   a   b      subscript  G  λ    x  y   f  y  d  y      (G_{\lambda}f)(x)=\int_{a}^{b}G_{\lambda}(x,y)f(y)\,dy.     Since G λ ( x , y ) is continuous on [ a , b ] x [ a , b ], it defines a Hilbert–Schmidt operator on the Hilbert space completion H of C[ a , b ] = H 1 (or equivalently of the dense subspace H 0 ), taking values in H 1 . This operator carries H 1 into H 0 . When λ is real, G λ ( x , y ) = G λ ( y , x ) is also real, so defines a self-adjoint operator on H . Moreover   G λ ( D − λ) =I on H 0  G λ carries H 1 into H 0 , and ( D − λ) G λ = I on H 1 .   Thus the operator G λ can be identified with the resolvent ( D − λ) −1 .  Spectral theorem  Theorem. ''The eigenvalues of D are real of multiplicity one and form an increasing sequence λ 1 2 0.  The kth eigenvalue of D is given by the minimax principle        λ  k   =     max     dim   G   =   k  -  1        min   f  ⟂  G      (   D  f   ,  f  )    (  f  ,  f  )       .       subscript  λ  k     subscript       dim  G     k  1       subscript    perpendicular-to  f  G         D  f   f    f  f        \lambda_{k}=\max_{{\rm dim}\,G=k-1}\,\min_{f\perp G}{(Df,f)\over(f,f)}.     In particular if q 1 ≤ q 2 , then         λ  k    (   D  1   )    ≤    λ  k    (   D  2   )     .         subscript  λ  k    subscript  D  1       subscript  λ  k    subscript  D  2      \lambda_{k}(D_{1})\leq\lambda_{k}(D_{2}).     In fact let T = G λ for λ large and negative. Then T defines a compact self-adjoint operator on the Hilbert space H . By the spectral theorem for compact self-adjoint operators, H has an orthonormal basis consisting of eigenvectors ψ n of T with T ψ n = μ n ψ n , where μ n tends to zero. The range of T contains H 0 so is dense. Hence 0 is not an eigenvector of T . The resolvent properties of T imply that ψ n lies in H 0 and that   D ψ n = (λ + 1/μ n ) ψ n    The minimax principle follows because if        λ   (  G  )    =    min   f  ⟂  G      (   D  f   ,  f  )    (  f  ,  f  )      ,        λ  G     subscript    perpendicular-to  f  G         D  f   f    f  f       \lambda(G)=\min_{f\perp G}{(Df,f)\over(f,f)},     then λ( G )= λ k for the linear span of the first k − 1 eigenfunctions. For any other ( k − 1)-dimensional subspace G , some f in the linear span of the first k eigenvectors must be orthogonal to G . Hence λ( G ) ≤ ( Df , f )/( f , f ) ≤ λ k .  Wronskian as a Fredholm determinant  For simplicity, suppose that m ≤ q ( x ) ≤ M on [0,π] with Dirichlet boundary conditions. The minimax principle shows that         n  2   +  m   ≤    λ  n    (  D  )    ≤    n  2   +  M    .           superscript  n  2   m      subscript  λ  n   D           superscript  n  2   M      n^{2}+m\leq\lambda_{n}(D)\leq n^{2}+M.     It follows that the resolvent ( D − λ) −1 is a trace-class operator whenever λ is not an eigenvalue of D and hence that the Fredholm determinant det I − μ( D − λ) −1 is defined.  The Dirichlet boundary conditions imply that   ω(λ)= φ λ ( b ).   Using Picard iteration, Titchmarsh showed that φ λ ( b ), and hence ω(λ), is an entire function of finite order 1/2:   ω(λ) = O(e √|λ| )   At a zero μ of ω(λ), φ μ ( b ) = 0. Moreover       ψ   (  x  )    =       ∂  λ    φ  λ     (  x  )    |    λ  =  μ          ψ  x    evaluated-at      subscript   λ    subscript  φ  λ    x     λ  μ      \psi(x)=\partial_{\lambda}\varphi_{\lambda}(x)|_{\lambda=\mu}     satisfies ( D − μ)ψ = φ μ . Thus   ω(λ) = (λ − μ)ψ( b ) + O( (λ − μ) 2 ).   This implies that 4   μ is a simple zero of ω(λ).   For otherwise ψ( b ) = 0, so that ψ would have to lie in H 0 . But then   (φ μ , φ μ ) = (( D − μ)ψ, φ μ ) = (ψ, ( D − μ)φ μ ) = 0,   a contradiction.  On the other hand the distribution of the zeros of the entire function ω(λ) is already known from the minimax principle.  By the Hadamard factorization theorem , it follows that 5         ω   (  λ  )    =   C   ∏   (   1  -   λ  /   λ  n     )      ,        ω  λ     C   product    1    λ   subscript  λ  n         \omega(\lambda)=C\prod(1-\lambda/\lambda_{n}),      for some non-zero constant C .  Hence         det    (   I  -   μ    (   D  -  λ   )    -  1      )    =   ∏   (   1  -   μ    λ  n   -  λ     )    =   ∏    1  -    (   λ  +  μ   )   /   λ  n      1  -   λ  /   λ  n       =    ω   (   λ  +  μ   )     ω   (  λ  )      .          det    I    μ   superscript    D  λ     1        product    1    μ     subscript  λ  n   λ            product      1      λ  μ    subscript  λ  n       1    λ   subscript  λ  n                ω    λ  μ      ω  λ       {\rm det}\,(I-\mu(D-\lambda)^{-1})=\prod\left(1-{\mu\over\lambda_{n}-\lambda}%
 \right)=\prod{1-(\lambda+\mu)/\lambda_{n}\over 1-\lambda/\lambda_{n}}={\omega(%
 \lambda+\mu)\over\omega(\lambda)}.     In particular if 0 is not an eigenvalue of D        ω   (  μ  )    =     ω   (  0  )    ⋅   det     (   I  -   μ   D   -  1      )     .        ω  μ      normal-⋅    ω  0   det     I    μ   superscript  D    1         \omega(\mu)=\omega(0)\cdot{\rm det}\,(I-\mu D^{-1}).     Tools from abstract spectral theory  Functions of bounded variation  A function ρ( x ) of bounded variation 6 on a closed interval [ a , b ] is a complex-valued function such that its total variation  V (ρ), the supremum of the variations       ∑   r  =  0    k  -  1     |    ρ   (   x   r  +  1    )    -   ρ   (   x  r   )     |       superscript   subscript     r  0      k  1          ρ   subscript  x    r  1       ρ   subscript  x  r        \sum_{r=0}^{k-1}|\rho(x_{r+1})-\rho(x_{r})|     over all dissections      a  =   x  0   <   x  1   <  …  <   x  k   =  b        a   subscript  x  0         subscript  x  1        normal-…        subscript  x  k        b     a=x_{0}     is finite. The real and imaginary parts of ρ are real-valued functions of bounded variation. If ρ is real-valued and normalised so that ρ(a)=0, it has a canonical decomposition as the difference of two bounded non-decreasing functions:        ρ   (  x  )    =     ρ  +    (  x  )    -    ρ  -    (  x  )      ,        ρ  x        subscript  ρ    x      subscript  ρ    x      \rho(x)=\rho_{+}(x)-\rho_{-}(x),     where ρ + ( x ) and ρ – ( x ) are the total positive and negative variation of ρ over [ a , x ].  If f is a continuous function on [ a , b ] its Riemann–Stieltjes integral with respect to ρ       ∫  a  b    f   (  x  )   d  ρ   (  x  )        superscript   subscript   a   b     f  x  d  ρ  x     \int_{a}^{b}f(x)\,d\rho(x)     is defined to be the limit of approximating sums       ∑   r  =  0    k  -  1     f   (   x  r   )    (    ρ   (   x   r  +  1    )    -   ρ   (   x  r   )     )        superscript   subscript     r  0      k  1      f   subscript  x  r       ρ   subscript  x    r  1       ρ   subscript  x  r        \sum_{r=0}^{k-1}f(x_{r})(\rho(x_{r+1})-\rho(x_{r}))     as the mesh of the dissection, given by sup | x r +1 - x r |, tends to zero.  This integral satisfies       |    ∫  a  b    f   (  x  )   d  ρ   (  x  )     |   ≤    V   (  ρ  )    ⋅    ∥  f  ∥   ∞            superscript   subscript   a   b     f  x  d  ρ  x      normal-⋅    V  ρ    subscript   norm  f        \left|\int_{a}^{b}f(x)\,d\rho(x)\right|\leq V(\rho)\cdot\|f\|_{\infty}     and thus defines a bounded linear functional  d ρ on C [ a , b ] with norm ||d ρ||= V''(ρ).  Every bounded linear functional μ on C [ a , b ] has an absolute value |μ| defined for non-negative f by 7         |  μ  |    (  f  )    =    sup   0  ≤   |  g  |   ≤  f     |   μ   (  g  )    |     .          μ   f     subscript  supremum      0    g        f         μ  g       |\mu|(f)=\sup_{0\leq|g|\leq f}|\mu(g)|.     The form |μ| extends linearly to a bounded linear form on C[ a , b ] with norm ||μ|| and satisfies the characterizing inequality   |μ( f )| ≤ |μ|(| f |)   for f in C[ a , b ]. If μ is real , i.e. is real-valued on real-valued functions, then      μ  =    |  μ  |   -   (    |  μ  |   -  μ   )    ≡    μ  +   -   μ  -          μ      μ       μ   μ            subscript  μ     subscript  μ        \mu=|\mu|-(|\mu|-\mu)\equiv\mu_{+}-\mu_{-}     gives a canonical decomposition as a difference of positive forms, i.e. forms that are non-negative on non-negative functions.  Every positive form μ extends uniquely to the linear span of non-negative bounded lower semicontinuous functions  g by the formula 8        μ   (  g  )    =   lim   μ   (   f  n   )      ,        μ  g       μ   subscript  f  n       \mu(g)=\lim\mu(f_{n}),     where the non-negative continuous functions f n increase pointwise to g .  The same therefore applies to an arbitrary bounded linear form μ, so that a function ρ of bounded variation may be defined by 9        ρ   (  x  )    =   μ   (   χ   [  a  ,  x  ]    )     ,        ρ  x     μ   subscript  χ   a  x       \rho(x)=\mu(\chi_{[a,x]}),     where χ A denotes the characteristic function of a subset A of [ a , b ]. Thus μ = d ρ and ||μ|| = || d ρ||. Moreover μ + = d ρ + and μ – = d ρ – .  This correspondence between functions of bounded variation and bounded linear forms is a special case of the Riesz representation theorem .  The support of μ = d ρ is the complement of all points x in [ a , b ] where ρ is constant on some neighborhood of x ; by definition it is a closed subset A of [ a , b ]. Moreover μ((1-χ A ) f ) =0, so that μ( f ) = 0 if f vanishes on A .  Spectral measure  Let H be a Hilbert space and   T   T   T   a self-adjoint bounded operator on H with    0  ≤  T  ≤  I        0  T       I     0\leq T\leq I   , so that the spectrum     σ   (  T  )       σ  T    \sigma(T)   of   T   T   T   is contained in    [  0  ,  1  ]     0  1    [0,1]   . If    p   (  t  )       p  t    p(t)   is a complex polynomial, then by the spectral mapping theorem       σ   (   p   (  T  )    )    =   p   (   σ   (  T  )    )          σ    p  T      p    σ  T      \sigma(p(T))=p(\sigma(T))     and hence       ∥   p   (  T  )    ∥   ≤    ∥  p  ∥   ∞        norm    p  T     subscript   norm  p       \|p(T)\|\leq\|p\|_{\infty}     where    ∥   ∥  ∞      fragments  parallel-to   subscript  parallel-to      \|\,\|_{\infty}   denotes the uniform norm on    C   [  0  ,  1  ]       C   0  1     C[0,1]   . By the Weierstrass approximation theorem , polynomials are uniformly dense in    C   [  0  ,  1  ]       C   0  1     C[0,1]   . It follows that    f   (  T  )       f  T    f(T)   can be defined     ∀  f   ∈   C   [  0  ,  1  ]         for-all  f     C   0  1      \forall f\in C[0,1]   , with       σ   (   f   (  T  )    )    =   f   (   σ   (  T  )    )          σ    f  T      f    σ  T      \sigma(f(T))=f(\sigma(T))   and     ∥   f   (  T  )    ∥   ≤    ∥  f  ∥   ∞        norm    f  T     subscript   norm  f       \|f(T)\|\leq\|f\|_{\infty}   .  If    0  ≤  g  ≤  1        0  g       1     0\leq g\leq 1   is a lower semicontinuous function on    [  0  ,  1  ]     0  1    [0,1]   , for example the characteristic function    χ   [  0  ,  α  ]      subscript  χ   0  α     \chi_{[0,\alpha]}   of a subinterval of    [  0  ,  1  ]     0  1    [0,1]   , then   g   g   g   is a pointwise increasing limit of non-negative     f  n   ∈   C   [  0  ,  1  ]         subscript  f  n     C   0  1      f_{n}\in C[0,1]   .  According to Szőkefalvi-Nagy , 10 if   ξ   ξ   \xi   is a vector in H , then the vectors       η  n   =    f  n    (  T  )   ξ        subscript  η  n      subscript  f  n   T  ξ     \eta_{n}=f_{n}(T)\xi     form a Cauchy sequence in H , since, for    n  ≥  m      n  m    n\geq m   ,         ∥    η  n   -   η  m    ∥   2   ≤    (   η  n   ,  ξ  )   -   (   η  m   ,  ξ  )     ,       superscript   norm     subscript  η  n    subscript  η  m     2       subscript  η  n   ξ     subscript  η  m   ξ      \|\eta_{n}-\eta_{m}\|^{2}\leq(\eta_{n},\xi)-(\eta_{m},\xi),     and     (   η  n   ,  ξ  )   =   (    f  n    (  T  )   ξ   ,  ξ  )         subscript  η  n   ξ       subscript  f  n   T  ξ   ξ     (\eta_{n},\xi)=(f_{n}(T)\xi,\xi)   is bounded and increasing, so has a limit.  It follows that    g   (  T  )       g  T    g(T)   can be defined by 11       g   (  T  )   ξ   =   lim    f  n    (  T  )   ξ          g  T  ξ        subscript  f  n   T  ξ      g(T)\xi=\lim f_{n}(T)\xi   .  If   ξ   ξ   \xi   and   η   η   \eta   are vectors in H , then        μ   ξ  ,  η     (  f  )    =   (   f   (  T  )   ξ   ,  η  )          subscript  μ   ξ  η    f      f  T  ξ   η     \mu_{\xi,\eta}(f)=(f(T)\xi,\eta)     defines a bounded linear form    μ   ξ  ,  η      subscript  μ   ξ  η     \mu_{\xi,\eta}   on H . By the Riesz representation theorem       μ   ξ  ,  η    =   d   ρ   ξ  ,  η          subscript  μ   ξ  η      d   subscript  ρ   ξ  η       \mu_{\xi,\eta}=d\rho_{\xi,\eta}     for a unique normalised function    ρ   ξ  ,  η      subscript  ρ   ξ  η     \rho_{\xi,\eta}   of bounded variation on    [  0  ,  1  ]     0  1    [0,1]   .      d   ρ   ξ  ,  η        d   subscript  ρ   ξ  η      d\rho_{\xi,\eta}   (or sometimes slightly incorrectly    ρ   ξ  ,  η      subscript  ρ   ξ  η     \rho_{\xi,\eta}   itself) is called the spectral measure determined by   ξ   ξ   \xi   and   η   η   \eta   .  The operator    g   (  T  )       g  T    g(T)   is accordingly uniquely characterised by the equation        (   g   (  T  )   ξ   ,  η  )   =    μ   ξ  ,  η     (  g  )    =    ∫  0  1    g   (  λ  )   d   ρ   ξ  ,  η     (  λ  )      .           g  T  ξ   η      subscript  μ   ξ  η    g          superscript   subscript   0   1     g  λ  d   subscript  ρ   ξ  η    λ       (g(T)\xi,\eta)=\mu_{\xi,\eta}(g)=\int_{0}^{1}g(\lambda)\,d\rho_{\xi,\eta}(%
 \lambda).     The spectral projection     E   (  λ  )       E  λ    E(\lambda)   is defined by        E   (  λ  )    =    χ   [  0  ,  λ  ]     (  T  )     ,        E  λ      subscript  χ   0  λ    T     E(\lambda)=\chi_{[0,\lambda]}(T),     so that         ρ   ξ  ,  η     (  λ  )    =   (   E   (  λ  )   ξ   ,  η  )    .         subscript  ρ   ξ  η    λ      E  λ  ξ   η     \rho_{\xi,\eta}(\lambda)=(E(\lambda)\xi,\eta).     It follows that        g   (  T  )    =    ∫  0  1    g   (  λ  )   d  E   (  λ  )      ,        g  T     superscript   subscript   0   1     g  λ  d  E  λ      g(T)=\int_{0}^{1}g(\lambda)\,dE(\lambda),     which is understood in the sense that for any vectors   ξ   ξ   \xi   and   η   η   \eta   ,        (   g   (  T  )   ξ   ,  η  )   =    ∫  0  1    g   (  λ  )   d   (   E   (  λ  )   ξ   ,  η  )     =    ∫  0  1    g   (  λ  )   d   ρ   ξ  ,  η     (  λ  )      .           g  T  ξ   η     superscript   subscript   0   1     g  λ  d     E  λ  ξ   η            superscript   subscript   0   1     g  λ  d   subscript  ρ   ξ  η    λ       (g(T)\xi,\eta)=\int_{0}^{1}g(\lambda)\,d(E(\lambda)\xi,\eta)=\int_{0}^{1}g(%
 \lambda)\,d\rho_{\xi,\eta}(\lambda).     For a single vector     ξ  ,   μ  ξ    =   μ   ξ  ,  ξ         ξ   subscript  μ  ξ     subscript  μ   ξ  ξ      \xi,\,\mu_{\xi}=\mu_{\xi,\xi}   is a positive form on    [  0  ,  1  ]     0  1    [0,1]   (in other words proportional to a probability measure on    [  0  ,  1  ]     0  1    [0,1]   ) and     ρ  ξ   =   ρ   ξ  ,  ξ         subscript  ρ  ξ    subscript  ρ   ξ  ξ      \rho_{\xi}=\rho_{\xi,\xi}   is non-negative and non-decreasing. Polarisation shows that all the forms    μ   ξ  ,  η      subscript  μ   ξ  η     \mu_{\xi,\eta}   can naturally be expressed in terms of such positive forms, since       μ   ξ  ,  η    =    1  4    (     μ   ξ  +  η    +   i   μ   ξ  +   i  η       -   μ   ξ  -  η    -   i   μ   ξ  -   i  η       )         subscript  μ   ξ  η        1  4        subscript  μ    ξ  η      i   subscript  μ    ξ    i  η        subscript  μ    ξ  η      i   subscript  μ    ξ    i  η          \mu_{\xi,\eta}=\frac{1}{4}\bigg(\mu_{\xi+\eta}+i\mu_{\xi+i\eta}-\mu_{\xi-\eta}%
 -i\mu_{\xi-i\eta}\bigg)     If the vector   ξ   ξ   \xi   is such that the linear span of the vectors    (    T  n   ξ   )       superscript  T  n   ξ    (T^{n}\xi)   is dense in H , i.e.   ξ   ξ   \xi   is a cyclic vector for   T   T   T   , then the map   U   U   U   defined by        U   (  f  )    =   f   (  T  )   ξ    ,    C   [  0  ,  1  ]    →  H      formulae-sequence      U  f     f  T  ξ     normal-→    C   0  1    H     U(f)=f(T)\xi,\,C[0,1]\rightarrow H     satisfies        (   U   f  1    ,   U   f  2    )   =    ∫  0  1     f  1    (  λ  )       f  2    (  λ  )    ¯    d   ρ  ξ    (  λ  )      .         U   subscript  f  1      U   subscript  f  2       superscript   subscript   0   1      subscript  f  1   λ   normal-¯     subscript  f  2   λ    d   subscript  ρ  ξ   λ      (Uf_{1},Uf_{2})=\int_{0}^{1}f_{1}(\lambda)\overline{f_{2}(\lambda)}\,d\rho_{%
 \xi}(\lambda).     Let     L  2    (   [  0  ,  1  ]   ,   d   ρ  ξ    )        subscript  L  2     0  1     d   subscript  ρ  ξ       L_{2}([0,1],d\rho_{\xi})   denote the Hilbert space completion of    C   [  0  ,  1  ]       C   0  1     C[0,1]   associated with the possibly degenerate inner product on the right hand side. 12 Thus   U   U   U   extends to a unitary transformation of     L  2    (   [  0  ,  1  ]   ,   ρ  ξ   )        subscript  L  2     0  1    subscript  ρ  ξ      L_{2}([0,1],\rho_{\xi})   onto H .    U  T   U  ∗       U  T   superscript  U  normal-∗     UTU^{\ast}   is then just multiplication by   λ   λ   \lambda   on     L  2    (   [  0  ,  1  ]   ,   d   ρ  ξ    )        subscript  L  2     0  1     d   subscript  ρ  ξ       L_{2}([0,1],d\rho_{\xi})   ; and more generally    U  f   (  T  )    U  ∗       U  f  T   superscript  U  normal-∗     Uf(T)U^{\ast}   is multiplication by    f   (  λ  )       f  λ    f(\lambda)   . In this case, the support of    d   ρ  ξ       d   subscript  ρ  ξ     d\rho_{\xi}   is exactly    σ   (  T  )       σ  T    \sigma(T)   , so that   the self-adjoint operator becomes a multiplication operator on the space of functions on its spectrum with inner product given by the spectral measure .   Weyl–Titchmarsh–Kodaira theory  The eigenfunction expansion associated with singular differential operators of the form       D  f   =    -    (   p   f  ′    )   ′    +   q  f          D  f        superscript    p   superscript  f  normal-′    normal-′      q  f      Df=-(pf^{\prime})^{\prime}+qf     on an open interval ( a , b ) requires an initial analysis of the behaviour of the fundamental eigenfunctions near the endpoints a and b to determine possible boundary conditions there. Unlike the regular Sturm–Liouville case, in some circumstances spectral values of D can have multiplicity 2. In the development outlined below standard assumptions will be imposed on p and q that guarantee that the spectrum of D has multiplicity one everywhere and is bounded below. This includes almost all important applications; modifications required for the more general case will be discussed later.  Having chosen the boundary conditions, as in the classical theory the resolvent of D , ( D + R ) −1 for ''R '' large and positive, is given by an operator T corresponding to a Green's function constructed from two fundamental eigenfunctions. In the classical case T was a compact self-adjoint operator; in this case T is just a self-adjoint bounded operator with 0 ≤ T ≤ I. The abstract theory of spectral measure can therefore be applied to T to give the eigenfunction expansion for D .  The central idea in the proof of Weyl and Kodaira can be explained informally as follows. Assume that the spectrum of D lies in [1,∞) and that T = D −1 and let       E   (  λ  )    =    χ   [   λ   -  1    ,  1  ]     (  T  )          E  λ      subscript  χ    superscript  λ    1    1    T     E(\lambda)=\chi_{[\lambda^{-1},1]}(T)     be the spectral projection of D corresponding to the interval [1,λ]. For an arbitrary function f define        f   (  x  ,  λ  )    =    (   E   (  λ  )   f   )    (  x  )     .        f   x  λ        E  λ  f   x     f(x,\lambda)=(E(\lambda)f)(x).     f ( x ,λ) may be regarded as a differentiable map into the space of functions of bounded variation ρ; or equivalently as a differentiable map      x  ↦    (    d  λ   f   )    (  x  )       maps-to  x       subscript  d  λ   f   x     x\mapsto(d_{\lambda}f)(x)     into the Banach space E of bounded linear functionals d ρ on C[α,β] whenever [α,β] is a compact subinterval of [1, ∞).  Weyl's fundamental observation was that d λ  f satisfies a second order ordinary differential equation taking values in E :        D   (    d  λ   f   )    =    λ  ⋅   d  λ    f    .        D     subscript  d  λ   f       normal-⋅  λ   subscript  d  λ    f     D(d_{\lambda}f)=\lambda\cdot d_{\lambda}f.     After imposing initial conditions on the first two derivatives at a fixed point c , this equation can be solved explicitly in terms of the two fundamental eigenfunctions and the "initial value" functionals          (    d  λ   f   )    (  c  )    =    d  λ   f   (  c  ,  ⋅  )     ,      (    d  λ   f   )   ′    (  c  )    =    d  λ    f  x    (  c  ,  ⋅  )      .     formulae-sequence         subscript  d  λ   f   c      subscript  d  λ   f   c  normal-⋅          superscript     subscript  d  λ   f   normal-′   c      subscript  d  λ    subscript  f  x    c  normal-⋅       (d_{\lambda}f)(c)=d_{\lambda}f(c,\cdot),\quad(d_{\lambda}f)^{\prime}(c)=d_{%
 \lambda}f_{x}(c,\cdot).     This point of view may now be turned on its head: f ( c ,λ) and f x ( c ,λ) may be written as         f   (  c  ,  λ  )    =   (  f  ,    ξ  1    (  λ  )    )    ,     f  x    (  c  ,  λ  )    =   (  f  ,    ξ  2    (  λ  )    )     ,     formulae-sequence      f   c  λ     f     subscript  ξ  1   λ          subscript  f  x    c  λ     f     subscript  ξ  2   λ       f(c,\lambda)=(f,\xi_{1}(\lambda)),\quad f_{x}(c,\lambda)=(f,\xi_{2}(\lambda)),     where ξ 1 (λ) and ξ 2 (λ) are given purely in terms of the fundamental eigenfunctions. The functions of bounded variation        σ   i  j     (  λ  )    =   (    ξ  i    (  λ  )    ,    ξ  j    (  λ  )    )          subscript  σ    i  j    λ       subscript  ξ  i   λ      subscript  ξ  j   λ      \sigma_{ij}(\lambda)=(\xi_{i}(\lambda),\xi_{j}(\lambda))     determine a spectral measure on the spectrum of D and can be computed explicitly from the behaviour of the fundamental eigenfunctions (the Titchmarsh–Kodaira formula).  Limit circle and limit point for singular equations  Let q ( x ) be a continuous real-valued function on (0,∞) and let D be the second order differential operator       D  f   =    -   f  ′′    +   q  f          D  f        superscript  f  ′′      q  f      Df=-f^{\prime\prime}+qf     on (0,∞). Fix a point c in (0,∞) and, for λ complex, let     φ  λ   ,   θ  λ       subscript  φ  λ    subscript  θ  λ     \varphi_{\lambda},\theta_{\lambda}   be the unique fundamental eigenfunctions of D on (0,∞) satisfying         (   D  -  λ   )    φ  λ    =  0   ,     (   D  -  λ   )    θ  λ    =  0      formulae-sequence        D  λ    subscript  φ  λ    0         D  λ    subscript  θ  λ    0     (D-\lambda)\varphi_{\lambda}=0,\quad(D-\lambda)\theta_{\lambda}=0     together with the initial conditions at c         φ  λ    (  c  )    =  1   ,      φ  λ  ′    (  c  )    =  0   ,      θ  λ    (  c  )    =  0   ,     θ  λ  ′    (  c  )    =  1.        formulae-sequence       subscript  φ  λ   c   1    formulae-sequence       superscript   subscript  φ  λ   normal-′   c   0    formulae-sequence       subscript  θ  λ   c   0        superscript   subscript  θ  λ   normal-′   c   1.       \varphi_{\lambda}(c)=1,\,\varphi_{\lambda}^{\prime}(c)=0,\,\theta_{\lambda}(c)%
 =0,\,\theta_{\lambda}^{\prime}(c)=1.     Then their Wronskian satisfies        W   (   φ  λ   ,   θ  λ   )    =     φ  λ    θ  λ  ′    -    θ  λ    φ  λ  ′     ≡  1   ,          W    subscript  φ  λ    subscript  θ  λ          subscript  φ  λ    superscript   subscript  θ  λ   normal-′       subscript  θ  λ    superscript   subscript  φ  λ   normal-′          1     W(\varphi_{\lambda},\theta_{\lambda})=\varphi_{\lambda}\theta_{\lambda}^{%
 \prime}-\theta_{\lambda}\varphi_{\lambda}^{\prime}\equiv 1,     since it is constant and equal to 1 at c .  Let λ be non-real and 0 \mu is such that    f  =   φ  +   μ  θ        f    φ    μ  θ      f=\varphi+\mu\theta   satisfies the boundary condition       cos    β   f     (  x  )    -    sin    β    f  ′      (  x  )     =  0              β  f    x         β   superscript  f  normal-′     x    0    \cos\beta\,f(x)-\sin\beta\,f^{\prime}(x)=0   for some   β   β   \beta   (or, equivalently,       f  ′    (  x  )    /  f    (  x  )            superscript  f  normal-′   x   f   x    f^{\prime}(x)/f(x)   is real) then, using integration by parts, one obtains        Im   (  λ  )     ∫  c  x     |   φ  +   μ  θ    |   2     =   Im   (  μ  )     .        Im  λ    superscript   subscript   c   x    superscript      φ    μ  θ     2       Im  μ     {\rm Im}(\lambda)\int_{c}^{x}|\varphi+\mu\theta|^{2}={\rm Im}(\mu).     The set of these   μ   μ   \mu   is a circle in the complex   μ   μ   \mu   -plane. Points   μ   μ   \mu   in its interior are characterized by        ∫  c  x     |   φ  +   μ  θ    |   2    <    Im   (  μ  )     Im   (  λ  )           superscript   subscript   c   x    superscript      φ    μ  θ     2        Im  μ     Im  λ      \int_{c}^{x}|\varphi+\mu\theta|^{2}<{{\rm Im}(\mu)\over{\rm Im}(\lambda)}     if x > c and by        ∫  x  c     |   φ  +   μ  θ    |   2    <    Im   (  μ  )     Im   (  λ  )           superscript   subscript   x   c    superscript      φ    μ  θ     2        Im  μ     Im  λ      \int_{x}^{c}|\varphi+\mu\theta|^{2}<{{\rm Im}(\mu)\over{\rm Im}(\lambda)}     if x  x be the closed disc enclosed by the circle. By definition these closed discs are nested and decrease as x approaches 0 or ∞. So in the limit, the circles tend either to a limit circle or a limit point at each end. If   μ   μ   \mu   is a limit point or a point on the limit circle at 0 or ∞, then    f  =   φ  +   μ  θ        f    φ    μ  θ      f=\varphi+\mu\theta   is square integrable (L 2 ) near 0 or ∞, since   μ   μ   \mu   lies in D x for all x>c (in the ∞ case) and so      ∫  c  x     |   φ  +   μ  θ    |   2    <    Im   (  μ  )     Im   (  λ  )           superscript   subscript   c   x    superscript      φ    μ  θ     2        Im  μ     Im  λ      \int_{c}^{x}|\varphi+\mu\theta|^{2}<{{\rm Im}(\mu)\over{\rm Im}(\lambda)}   is bounded independent of x . In particular: 13   there are always non-zero solutions of Df = λf which are square integrable near 0 or ∞ ;  there is exactly one non-zero solution (up to scalar multiples) of Df = λf which is square integrable near 0 or ∞ precisely in the limit point case .   On the other hand if Dg = λ' g for another value λ', then       h   (  x  )    =    g   (  x  )    -    (    λ  ′   -  λ   )     ∫  c  x     (     φ  λ    (  x  )    θ  λ    (  y  )    -    θ  λ    (  x  )    φ  λ    (  y  )     )   g   (  y  )   d  y            h  x       g  x        superscript  λ  normal-′   λ     superscript   subscript   c   x          subscript  φ  λ   x   subscript  θ  λ   y      subscript  θ  λ   x   subscript  φ  λ   y    g  y  d  y        h(x)=g(x)-(\lambda^{\prime}-\lambda)\int_{c}^{x}(\varphi_{\lambda}(x)\theta_{%
 \lambda}(y)-\theta_{\lambda}(x)\varphi_{\lambda}(y))g(y)\,dy     satisfies Dh = λ h , so that        g   (  x  )    =     c  1    φ  λ    +    c  2    θ  λ    +    (    λ  ′   -  λ   )     ∫  c  x     (     φ  λ    (  x  )    θ  λ    (  y  )    -    θ  λ    (  x  )    φ  λ    (  y  )     )   g   (  y  )   d  y       .        g  x        subscript  c  1    subscript  φ  λ       subscript  c  2    subscript  θ  λ         superscript  λ  normal-′   λ     superscript   subscript   c   x          subscript  φ  λ   x   subscript  θ  λ   y      subscript  θ  λ   x   subscript  φ  λ   y    g  y  d  y        g(x)=c_{1}\varphi_{\lambda}+c_{2}\theta_{\lambda}+(\lambda^{\prime}-\lambda)%
 \int_{c}^{x}(\varphi_{\lambda}(x)\theta_{\lambda}(y)-\theta_{\lambda}(x)%
 \varphi_{\lambda}(y))g(y)\,dy.     Using this to estimate g , it follows that 14   the limit point/limit circle behaviour at 0 or ∞ is independent of the choice of λ .   More generally if Dg = (λ – r ) g for some function r ( x ), then 15        g   (  x  )    =      c  1    φ  λ    +    c  2    θ  λ     -    ∫  c  x     (     φ  λ    (  x  )    θ  λ    (  y  )    -    θ  λ    (  x  )    φ  λ    (  y  )     )   r   (  y  )   g   (  y  )   d  y      .        g  x          subscript  c  1    subscript  φ  λ       subscript  c  2    subscript  θ  λ       superscript   subscript   c   x          subscript  φ  λ   x   subscript  θ  λ   y      subscript  θ  λ   x   subscript  φ  λ   y    r  y  g  y  d  y       g(x)=c_{1}\varphi_{\lambda}+c_{2}\theta_{\lambda}-\int_{c}^{x}(\varphi_{%
 \lambda}(x)\theta_{\lambda}(y)-\theta_{\lambda}(x)\varphi_{\lambda}(y))r(y)g(y%
 )\,dy.     From this it follows that 16   if r is continuous at 0, then D + r is limit point or limit circle at 0 precisely when D is ,   so that in particular 17   if q(x)- a/x 2 is continuous at 0, then D is limit point at 0 if and only if a ≥ ¾ .   Similarly   if r has a finite limit at ∞, then D + r is limit point or limit circle at ∞ precisely when D is ,   so that in particular 18   if q has a finite limit at ∞, then D is limit point at ∞ .   Many more elaborate criteria to be limit point or limit circle can be found in the mathematical literature.  Green's function (singular case)  Consider the differential operator        D  0   f   =    -    (    p  0    f  ′    )   ′    +    q  0   f           subscript  D  0   f        superscript     subscript  p  0    superscript  f  normal-′    normal-′       subscript  q  0   f      D_{0}f=-(p_{0}f^{\prime})^{\prime}+q_{0}f     on (0,∞) with q 0 positive and continuous on (0,∞) and p 0 continuously differentiable in [0,∞), positive in (0,∞) and p 0 (0)=0.  Moreover assume that after reduction to standard form D 0 becomes the equivalent operator       D  f   =    -   f  ′′    +   q  f          D  f        superscript  f  ′′      q  f      Df=-f^{\prime\prime}+qf     on (0,∞) where q has a finite limit at ∞. Thus   D is limit point at ∞ .   At 0, D may be either limit circle or limit point. In either case there is an eigenfunction Φ 0 with D Φ 0 =0 and Φ 0 square integrable near 0. In the limit circle case, Φ 0 determines a boundary condition at 0:       W   (  f  ,   Φ  0   )    (  0  )    =  0.        W   f   subscript  normal-Φ  0    0   0.    W(f,\Phi_{0})(0)=0.     For λ complex, let Φ λ and Χ λ satisfy   ( D – λ)Φ λ = 0, ( D – λ)Χ λ = 0    Χ λ square integrable near infinity    Φ λ square integrable at 0 if 0 is limit point    Φ λ satisfies the boundary condition above if 0 is limit circle .   Let        ω   (  λ  )    =   W   (   Φ  λ   ,    \Chi   λ   )     ,        ω  λ     W    subscript  normal-Φ  λ    subscript  \Chi  λ       \omega(\lambda)=W(\Phi_{\lambda},\Chi_{\lambda}),     a constant which vanishes precisely when Φ λ and Χ λ are proportional, i.e. λ is an eigenvalue of D for these boundary conditions.  On the other hand, this cannot occur if Im λ ≠ 0 or if λ is negative. 19  Indeed if D f = λ f with q 0 – λ ≥ δ >0, then by Green's formula ( Df , f ) = ( f , Df ), since W ( f , f * ) is constant. So λ must be real. If f is taken to be real-valued in the D 0 realization, then for 0  [p_0 ff^\prime]_x^y = \int_x^y (q_0 -\lambda)|f|^2 + p_0 (f^\prime)^2 .  Since p 0 (0) = 0 and f is integrable near 0, p 0 f  f ' must vanish at 0. Setting x = 0, it follows that f ( y ) f '( y ) >0, so that f 2 is increasing, contradicting the square integrability of f near ∞.  Thus, adding a positive scalar to q , it may be assumed that   ω(λ) ≠ 0 when λ is not in [1,∞) .   If ω(λ) ≠ 0, the Green's function  G λ ( x , y ) at λ is defined by       G  λ    (  x  ,  y  )   =   Φ  λ    (  x  )     \Chi   λ    (  y  )   /  ω   (  λ  )    (  x  ≤  y  )   ,    \Chi   λ    (  x  )    Φ  λ    (  y  )   /  ω   (  λ  )    (  x  ≥  y  )   .     fragments   subscript  G  λ    fragments  normal-(  x  normal-,  y  normal-)     subscript  normal-Φ  λ    fragments  normal-(  x  normal-)    subscript  \Chi  λ    fragments  normal-(  y  normal-)    ω   fragments  normal-(  λ  normal-)    fragments  normal-(  x   y  normal-)   normal-,   subscript  \Chi  λ    fragments  normal-(  x  normal-)    subscript  normal-Φ  λ    fragments  normal-(  y  normal-)    ω   fragments  normal-(  λ  normal-)    fragments  normal-(  x   y  normal-)   normal-.    G_{\lambda}(x,y)=\Phi_{\lambda}(x)\Chi_{\lambda}(y)/\omega(\lambda)\,\,(x\leq y%
 ),\,\,\,\,\Chi_{\lambda}(x)\Phi_{\lambda}(y)/\omega(\lambda)\,\,(x\geq y).     and is independent of the choice of λ and Χ λ .  In the examples there will be a third "bad" eigenfunction Ψ λ defined and holomorphic for λ not in [1, ∞) such that Ψ λ satisfies the boundary conditions at neither 0 nor ∞. This means that for λ not in [1, ∞)   W (Φ λ ,Ψ λ ) is nowhere vanishing;  W (Χ λ ,Ψ λ ) is nowhere vanishing.   In this case Χ λ is proportional to Φ λ + m (λ) Ψ λ , where   m (λ) = – W (Φ λ ,Χ λ ) / W (Ψ λ ,Χ λ ).   Let H 1 be the space of square integrable continuous functions on (0,∞) and let H 0 be   the space of C 2 functions f on (0,∞) of compact support if D is limit point at 0  the space of C 2 functions f on (0,∞) with W ( f ,Φ 0 )=0 at 0 and with f = 0 near ∞ if D is limit circle at 0.   Define T = G 0 by         (   T  f   )    (  x  )    =    ∫  0  ∞     G  0    (  x  ,  y  )   f   (  y  )   d  y     .          T  f   x     superscript   subscript   0        subscript  G  0    x  y   f  y  d  y      (Tf)(x)=\int_{0}^{\infty}G_{0}(x,y)f(y)\,dy.     Then T  D = I on H 0 , D  T = I on H 1 and the operator D is bounded below on H 0 :        (   D  f   ,  f  )   ≥   (  f  ,  f  )    .         D  f   f    f  f     (Df,f)\geq(f,f).     Thus T is a self-adjoint bounded operator with 0 ≤ T ≤ I .  Formally T = D −1 . The corresponding operators G λ defined for λ not in [1,∞) can be formally identified with        (   D  -  λ   )    -  1    =   T    (   I  -   λ  T    )    -  1          superscript    D  λ     1      T   superscript    I    λ  T      1       (D-\lambda)^{-1}=T(I-\lambda T)^{-1}     and satisfy G λ ( D – λ) = I on H 0 , ( D – λ) G λ = I on H 1 .  Spectral theorem and Titchmarsh–Kodaira formula  Theorem . 20 21 22  For every real number λ let ρ(λ) be defined by the  Titchmarsh–Kodaira formula :        ρ   (  λ  )    =    lim   δ  ↓  0      lim   ε  ↓  0      1  π     ∫  δ   λ  +  δ      Im   m   (   t  +   i  ε    )   d  t        .        ρ  λ     subscript    normal-↓  δ  0      subscript    normal-↓  ε  0        1  π     superscript   subscript   δ     λ  δ      Im  m    t    i  ε    d  t         \rho(\lambda)=\lim_{\delta\downarrow 0}\lim_{\varepsilon\downarrow 0}{1\over%
 \pi}\int_{\delta}^{\lambda+\delta}{\rm Im}\,m(t+i\varepsilon)\,dt.     Then ρ(λ) is a lower semicontinuous non-decreasing function of λ and if         (   U  f   )    (  λ  )    =    ∫  0  ∞    f   (  x  )   Φ   (  x  ,  λ  )   d  x     ,          U  f   λ     superscript   subscript   0       f  x  normal-Φ   x  λ   d  x      (Uf)(\lambda)=\int_{0}^{\infty}f(x)\Phi(x,\lambda)\,dx,     then U defines a unitary transformation of L 2 (0,∞) onto L 2 ([1,∞), dρ) such that UDU −1 ''corresponds to multiplication by λ. ''  The inverse transformation U −1 is given by         (    U   -  1    g   )    (  x  )    =    ∫  1  ∞    g   (  λ  )   Φ   (  x  ,  λ  )   d  ρ   (  λ  )      .           superscript  U    1    g   x     superscript   subscript   1       g  λ  normal-Φ   x  λ   d  ρ  λ      (U^{-1}g)(x)=\int_{1}^{\infty}g(\lambda)\Phi(x,\lambda)\,d\rho(\lambda).     The spectrum of D equals the support of dρ.  Kodaira gave a streamlined version 23 24 of Weyl's original proof. 25 ( M.H. Stone had previously shown 26 how part of Weyl's work could be simplified using von Neumann's spectral theorem.)  In fact for T = D −1 with 0 ≤ T ≤ I , the spectral projection E (λ) of T is defined by       E   (  λ  )    =    χ   [   λ   -  1    ,  1  ]     (  T  )          E  λ      subscript  χ    superscript  λ    1    1    T     E(\lambda)=\chi_{[\lambda^{-1},1]}(T)     It is also the spectral projection of D corresponding to the interval [1,λ].  For f in H 1 define        f   (  x  ,  λ  )    =    (   E   (  λ  )   f   )    (  x  )     .        f   x  λ        E  λ  f   x     f(x,\lambda)=(E(\lambda)f)(x).     f ( x ,λ) may be regarded as a differentiable map into the space of functions ρ of bounded variation; or equivalently as a differentiable map      x  ↦    (    d  λ   f   )    (  x  )       maps-to  x       subscript  d  λ   f   x     x\mapsto(d_{\lambda}f)(x)     into the Banach space E of bounded linear functionals d ρ on C[α,β] for any compact subinterval [α,β] of [1, ∞).  The functionals (or measures) d λ  f ( x ) satisfies the following E -valued second order ordinary differential equation:        D   (    d  λ   f   )    =    λ  ⋅   d  λ    f    ,        D     subscript  d  λ   f       normal-⋅  λ   subscript  d  λ    f     D(d_{\lambda}f)=\lambda\cdot d_{\lambda}f,     with initial conditions at c in (0,∞)          (    d  λ   f   )    (  c  )    =    d  λ   f   (  c  ,  ⋅  )    =   μ   (  0  )     ,      (    d  λ   f   )   ′    (  c  )    =    d  λ    f  x    (  c  ,  ⋅  )    =   μ   (  1  )      .     formulae-sequence           subscript  d  λ   f   c      subscript  d  λ   f   c  normal-⋅          superscript  μ  0            superscript     subscript  d  λ   f   normal-′   c      subscript  d  λ    subscript  f  x    c  normal-⋅          superscript  μ  1       (d_{\lambda}f)(c)=d_{\lambda}f(c,\cdot)=\mu^{(0)},\quad(d_{\lambda}f)^{\prime}%
 (c)=d_{\lambda}f_{x}(c,\cdot)=\mu^{(1)}.     If φ λ and χ λ are the special eigenfunctions adapted to c , then         d  λ   f   (  x  )    =     φ  λ    (  x  )    μ   (  0  )     +    χ  λ    (  x  )    μ   (  1  )       .         subscript  d  λ   f  x        subscript  φ  λ   x   superscript  μ  0       subscript  χ  λ   x   superscript  μ  1       d_{\lambda}f(x)=\varphi_{\lambda}(x)\mu^{(0)}+\chi_{\lambda}(x)\mu^{(1)}.     Moreover        μ   (  k  )    =    d  λ    (  f  ,   ξ  λ   (  k  )    )     ,       superscript  μ  k      subscript  d  λ    f   subscript   superscript  ξ  k   λ       \mu^{(k)}=d_{\lambda}(f,\xi^{(k)}_{\lambda}),     where        ξ  λ   (  k  )    =   D  E   (  λ  )    η   (  k  )      ,       subscript   superscript  ξ  k   λ     D  E  λ   superscript  η  k      \xi^{(k)}_{\lambda}=DE(\lambda)\eta^{(k)},     with       η  z   (  0  )     (  y  )   =   G  z    (  c  ,  y  )   ,   η  z   (  1  )     (  x  )   =   ∂  x    G  z    (  c  ,  y  )   ,   (  z  ∉   [  1  ,  ∞  )   )   .     fragments   superscript   subscript  η  z   0    fragments  normal-(  y  normal-)     subscript  G  z    fragments  normal-(  c  normal-,  y  normal-)   normal-,   superscript   subscript  η  z   1    fragments  normal-(  x  normal-)     subscript   x    subscript  G  z    fragments  normal-(  c  normal-,  y  normal-)   normal-,   fragments  normal-(  z    fragments  normal-[  1  normal-,   normal-)   normal-)   normal-.    \eta_{z}^{(0)}(y)=G_{z}(c,y),\,\,\,\,\eta_{z}^{(1)}(x)=\partial_{x}G_{z}(c,y),%
 \,\,\,\,(z\notin[1,\infty)).     (As the notation suggests, ξ λ (0) and ξ λ (1) do not depend on the choice of z .)  Setting         σ   i  j     (  λ  )    =   (   ξ  λ   (  i  )    ,   ξ  λ   (  j  )    )    ,         subscript  σ    i  j    λ     subscript   superscript  ξ  i   λ    subscript   superscript  ξ  j   λ      \sigma_{ij}(\lambda)=(\xi^{(i)}_{\lambda},\xi^{(j)}_{\lambda}),     it follows that         d  λ    (   E   (  λ  )    η  z   (  i  )     ,   η  z   (  j  )    )    =      |   λ  -  z   |    -  2    ⋅   d  λ     σ   i  j     (  λ  )     .         subscript  d  λ      E  λ   superscript   subscript  η  z   i     superscript   subscript  η  z   j        normal-⋅   superscript      λ  z      2     subscript  d  λ     subscript  σ    i  j    λ     d_{\lambda}(E(\lambda)\eta_{z}^{(i)},\eta_{z}^{(j)})=|\lambda-z|^{-2}\cdot d_{%
 \lambda}\sigma_{ij}(\lambda).     On the other hand there are holomorphic functions a (λ), b (λ) such that   φ λ + a (λ) χ λ is proportional to Φ λ ;  φ λ + b (λ) χ λ is proportional to Χ λ .   Since W (φ λ ,χ λ ) = 1, the Green's function is given by       G  λ    (  x  ,  y  )   =      (     φ  λ    (  x  )    +   a   (  λ  )    χ  λ    (  x  )     )    (     φ  λ    (  y  )    +   b   (  λ  )    χ  λ    (  y  )     )      b   (  λ  )    -   a   (  λ  )        (  x  ≤  y  )   ,      (     φ  λ    (  x  )    +   b   (  λ  )    χ  λ    (  x  )     )    (     φ  λ    (  y  )    +   a   (  λ  )    χ  λ    (  y  )     )      b   (  λ  )    -   a   (  λ  )        (  y  ≤  x  )   .     fragments   subscript  G  λ    fragments  normal-(  x  normal-,  y  normal-)             subscript  φ  λ   x     a  λ   subscript  χ  λ   x         subscript  φ  λ   y     b  λ   subscript  χ  λ   y         b  λ     a  λ      fragments  normal-(  x   y  normal-)   normal-,           subscript  φ  λ   x     b  λ   subscript  χ  λ   x         subscript  φ  λ   y     a  λ   subscript  χ  λ   y         b  λ     a  λ      fragments  normal-(  y   x  normal-)   normal-.    G_{\lambda}(x,y)={(\varphi_{\lambda}(x)+a(\lambda)\chi_{\lambda}(x))(\varphi_{%
 \lambda}(y)+b(\lambda)\chi_{\lambda}(y))\over b(\lambda)-a(\lambda)}\,\,(x\leq
 y%
 ),\,\,\,\,{(\varphi_{\lambda}(x)+b(\lambda)\chi_{\lambda}(x))(\varphi_{\lambda%
 }(y)+a(\lambda)\chi_{\lambda}(y))\over b(\lambda)-a(\lambda)}\,\,(y\leq x).     Direct calculation 27 shows that        (   η  z   (  i  )    ,   η  z   (  j  )    )   =      Im    M   i  j     (  z  )    /   Im    z    ,        superscript   subscript  η  z   i    superscript   subscript  η  z   j          Im   subscript  M    i  j    z   Im   z     (\eta_{z}^{(i)},\eta_{z}^{(j)})={\rm Im}\,M_{ij}(z)/{\rm Im}\,z,     where the so-called ''' characteristic matrix ''' M ij ( z ) is given by           M  00    (  z  )    =    a   (  z  )   b   (  z  )      a   (  z  )    -   b   (  z  )       ,     M  01    (  z  )    =    M  10    (  z  )    =     a   (  z  )    +   b   (  z  )      2   (    a   (  z  )    -   b   (  z  )     )       ,     M  11    (  z  )    =   1    a   (  z  )    -   b   (  z  )        .     formulae-sequence   formulae-sequence       subscript  M  00   z       a  z  b  z       a  z     b  z             subscript  M  01   z      subscript  M  10   z              a  z     b  z      2      a  z     b  z              subscript  M  11   z     1      a  z     b  z        M_{00}(z)={a(z)b(z)\over a(z)-b(z)},\,\,M_{01}(z)=M_{10}(z)={a(z)+b(z)\over 2(%
 a(z)-b(z))},\,\,M_{11}(z)={1\over a(z)-b(z)}.     Hence         ∫   -  ∞   ∞      (    Im   z   )   ⋅     |   λ  -  z   |    -  2      d   σ   i  j     (  λ  )     =   Im   M   i  j     (  z  )     ,        superscript   subscript             normal-⋅    Im  z    superscript      λ  z      2     d   subscript  σ    i  j    λ      Im   subscript  M    i  j    z     \int_{-\infty}^{\infty}({\rm Im}\,z)\cdot|\lambda-z|^{-2}\,d\sigma_{ij}(%
 \lambda)={\rm Im}M_{ij}(z),     which immediately implies         σ   i  j     (  λ  )    =    lim   δ  ↓  0      lim   ε  ↓  0      ∫  δ   λ  +  δ      Im    M   i  j     (   t  +   i  ε    )   d  t       .         subscript  σ    i  j    λ     subscript    normal-↓  δ  0      subscript    normal-↓  ε  0      superscript   subscript   δ     λ  δ      Im   subscript  M    i  j      t    i  ε    d  t        \sigma_{ij}(\lambda)=\lim_{\delta\downarrow 0}\lim_{\varepsilon\downarrow 0}%
 \int_{\delta}^{\lambda+\delta}{\rm Im}\,M_{ij}(t+i\varepsilon)\,dt.     (This is a special case of the "Stietljes inversion formula" .)  Setting ψ λ (0) =φ λ and ψ λ (1) =χ λ , it follows that         (   E   (  μ  )   f   )    (  x  )    =    ∑   i  .  j      ∫  0  μ     ∫  0  ∞     ψ  λ   (  i  )     (  x  )    ψ  λ   (  j  )     (  y  )   f   (  y  )   d   y   d   σ   i  j     (  λ  )       =    ∫  0  μ     ∫  0  ∞     Φ  λ    (  x  )    Φ  λ    (  y  )   f   (  y  )   d   y   d  ρ   (  λ  )       .            E  μ  f   x     subscript    formulae-sequence  i  j      superscript   subscript   0   μ     superscript   subscript   0        subscript   superscript  ψ  i   λ   x   subscript   superscript  ψ  j   λ   y  f  y  d  y  d   subscript  σ    i  j    λ             superscript   subscript   0   μ     superscript   subscript   0        subscript  normal-Φ  λ   x   subscript  normal-Φ  λ   y  f  y  d  y  d  ρ  λ        (E(\mu)f)(x)=\sum_{i.j}\int_{0}^{\mu}\int_{0}^{\infty}\psi^{(i)}_{\lambda}(x)%
 \psi^{(j)}_{\lambda}(y)f(y)\,dy\,d\sigma_{ij}(\lambda)=\int_{0}^{\mu}\int_{0}^%
 {\infty}\Phi_{\lambda}(x)\Phi_{\lambda}(y)f(y)\,dy\,d\rho(\lambda).     This identity is equivalent to the spectral theorem and Titchmarsh–Kodaira formula.  Application to the hypergeometric equation  The Mehler–Fock transform 28 29 30 concerns the eigenfunction expansion associated with the Legendre differential operator  D       D  f   =   -    (    (    x  2   -  1   )    f  ′    )   ′    =    -    (    x  2   -  1   )    f  ′′     -   2  x   f  ′             D  f      superscript       superscript  x  2   1    superscript  f  normal-′    normal-′                  superscript  x  2   1    superscript  f  ′′       2  x   superscript  f  normal-′        Df=-((x^{2}-1)f^{\prime})^{\prime}=-(x^{2}-1)f^{\prime\prime}-2xf^{\prime}     on (1,∞). The eigenfunctions are the Legendre functions 31        P    -   1  /  2    +   i   λ       (   cosh  r   )    =    1   2  π      ∫  0   2  π        (     sin  θ   +   i   e   -  r     cos  θ       cos  θ   -   i   e   -  r     sin  θ      )     1  2   +   i   λ       d  θ            subscript  P        1  2      i    λ        r        1    2  π      superscript   subscript   0     2  π       superscript        θ     i   superscript  e    r      θ         θ     i   superscript  e    r      θ          1  2     i    λ      d  θ       P_{-1/2+i\sqrt{\lambda}}(\cosh r)={1\over 2\pi}\int_{0}^{2\pi}\left({\sin%
 \theta+ie^{-r}\cos\theta\over\cos\theta-ie^{-r}\sin\theta}\right)^{{1\over 2}+%
 i\sqrt{\lambda}}\,d\theta     with eigenvalue λ ≥ 0. The two Mehler–Fock transformations are 32       U  f   (  λ  )    =    ∫  1  ∞    f   (  x  )    P    -   1  /  2    +   i   λ       (  x  )   d  x          U  f  λ     superscript   subscript   1       f  x   subscript  P        1  2      i    λ      x  d  x      Uf(\lambda)=\int_{1}^{\infty}f(x)\,P_{-1/2+i\sqrt{\lambda}}(x)\,dx     and         U   -  1    g   (  x  )    =    ∫  0  ∞    g   (  λ  )    1  2    tanh   π    λ    d  λ       .         superscript  U    1    g  x     superscript   subscript   0       g  λ    1  2       π    λ   d  λ        U^{-1}g(x)=\int_{0}^{\infty}g(\lambda)\,{1\over 2}\tanh\pi\sqrt{\lambda}\,d\lambda.     (Often this is written in terms of the variable τ = √λ.)  Mehler and Fock studied this differential operator because it arose as the radial component of the Laplacian on 2-dimensional hyperbolic space. More generally, 33 consider the group G = SU(1,1) consisting of complex matrices of the form      (     α    β       β  ¯      α  ¯      )      α  β     normal-¯  β    normal-¯  α      \left(\begin{matrix}\alpha&\beta\\
 \overline{\beta}&\overline{\alpha}\end{matrix}\right)     with determinant |α| 2 − |β| 2 = 1.  Application to the hydrogen atom  Generalisations and alternative approaches  A Weyl function can be defined at a singular endpoint   a   a   a   giving rise to a singular version of Weyl–Titchmarsh–Kodaira theory. 34 this applies for example to the case of radial Schrödinger operators        D  f   =    -   f  ′′    +     l   (   l  +  1   )     x  2    f   +   V   (  x  )   f     ,   x  ∈   (  0  ,  ∞  )       formulae-sequence      D  f        superscript  f  ′′          l    l  1     superscript  x  2    f     V  x  f       x   0       Df=-f^{\prime\prime}+\frac{l(l+1)}{x^{2}}f+V(x)f,\qquad x\in(0,\infty)     The whole theory can also be extended to the case where the coefficients are allowed to be measures. 35  Gelfand–Levitan theory  Notes  References                                                                 "  Category:Ordinary differential equations  Category:Operator theory  Category:Spectral theory     ↩  , Chapter X. ↩  ↩  ↩  , §8.2. ↩  ↩  , page 40 . ↩  ↩  ↩  ↩  This is a limit in the strong operator topology . ↩  A bona fide inner product is defined on the quotient by the subspace of null functions   f   f   f   , i.e. those with      μ  ξ    (    |  f  |   2   )    =  0         subscript  μ  ξ    subscript    f   2    0    \mu_{\xi}(|f|_{2})=0   . Alternatively in this case the support of the measure is    σ   (  T  )       σ  T    \sigma(T)   , so the right hand side defines a (non-degenerate) inner product on    C   (   σ   (  T  )    )       C    σ  T     C(\sigma(T))   . ↩  ↩   ↩   ↩  ↩    , Chapter III. ↩  ↩  ; for omitted details, see ↩  ↩   , Chapter X. ↩  ↩  ↩  ↩  ↩  ↩  ↩  , Chapter VI. ↩  ↩  ↩     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1894">Lanczos approximation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Lanczos approximation</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p>In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, the <strong>Lanczos approximation</strong> is a method for computing the <a href="Gamma_function" title="wikilink">Gamma function</a> numerically, published by <a href="Cornelius_Lanczos" title="wikilink">Cornelius Lanczos</a> in 1964. It is a practical alternative to the more popular <a href="Stirling's_approximation" title="wikilink">Stirling's approximation</a> for calculating the Gamma function with fixed precision.</p>
<h2 id="introduction">Introduction</h2>

<p>The Lanczos approximation consists of the formula</p>

<p>

<math display="block" id="Lanczos_approximation:0">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
     </mrow>
    </msqrt>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mi>g</mi>
       <mo>+</mo>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mrow>
    </msup>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>z</mi>
        <mo>+</mo>
        <mi>g</mi>
        <mo>+</mo>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </msup>
    <msub>
     <mi>A</mi>
     <mi>g</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <ci>g</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <ci>g</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>g</ci>
     </apply>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z+1)=\sqrt{2\pi}{\left(z+g+\frac{1}{2}\right)}^{z+\frac{1}{2}}e^{-\left%
(z+g+\frac{1}{2}\right)}A_{g}(z)
  </annotation>
 </semantics>
</math>

</p>

<p>for the Gamma function, with</p>

<p>

<math display="block" id="Lanczos_approximation:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>A</mi>
      <mi>g</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msub>
       <mi>p</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>g</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>g</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <mi>z</mi>
       <mrow>
        <mi>z</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>g</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <mrow>
        <mi>z</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>z</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>z</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>z</mi>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>g</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>g</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>g</ci>
      <apply>
       <divide></divide>
       <ci>z</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>g</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <ci>z</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <ci>z</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{g}(z)=\frac{1}{2}p_{0}(g)+p_{1}(g)\frac{z}{z+1}+p_{2}(g)\frac{z(z-1)}{(z+1)%
(z+2)}+\cdots.
  </annotation>
 </semantics>
</math>

</p>

<p>Here <em>g</em> is a <a href="Constant_(mathematics)" title="wikilink">constant</a> that may be chosen arbitrarily subject to the restriction that Re(<em>z</em>) &gt; 1/2.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The coefficients <em>p</em>, which depend on <em>g</em>, are slightly more difficult to calculate (see below). Although the formula as stated here is only valid for arguments in the right complex <a class="uri" href="half-plane" title="wikilink">half-plane</a>, it can be extended to the entire <a href="complex_plane" title="wikilink">complex plane</a> by the <a href="reflection_formula" title="wikilink">reflection formula</a>,</p>

<p>

<math display="block" id="Lanczos_approximation:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
      <mo rspace="5.3pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mi>π</mi>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mi>π</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
     <ci>normal-Γ</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <divide></divide>
     <ci>π</ci>
     <apply>
      <sin></sin>
      <apply>
       <times></times>
       <ci>π</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(1-z)\;\Gamma(z)={\pi\over\sin\pi z}.
  </annotation>
 </semantics>
</math>

</p>

<p>The series <em>A</em> is <a href="convergent_series" title="wikilink">convergent</a>, and may be truncated to obtain an approximation with the desired precision. By choosing an appropriate <em>g</em> (typically a small integer), only some 5-10 terms of the series are needed to compute the Gamma function with typical <a href="single_precision" title="wikilink">single</a> or <a href="double_precision" title="wikilink">double</a> <a href="floating_point" title="wikilink">floating-point</a> precision. If a fixed <em>g</em> is chosen, the coefficients can be calculated in advance and the sum is recast into the following form:</p>

<p>

<math display="block" id="Lanczos_approximation:3">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mi>g</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>c</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mfrac>
      <msub>
       <mi>c</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mi>k</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <ci>g</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{g}(z)=c_{0}+\sum_{k=1}^{N}\frac{c_{k}}{z+k}
  </annotation>
 </semantics>
</math>

</p>

<p>Thus computing the Gamma function becomes a matter of evaluating only a small number of <a href="elementary_function" title="wikilink">elementary functions</a> and multiplying by stored constants. The Lanczos approximation was popularized by <em><a href="Numerical_Recipes" title="wikilink">Numerical Recipes</a></em>, according to which computing the Gamma function becomes "not much more difficult than other built-in functions that we take for granted, such as sin <em>x</em> or <em>e</em><sup><em>x</em></sup>". The method is also implemented in the <a href="GNU_Scientific_Library" title="wikilink">GNU Scientific Library</a>.</p>
<h2 id="coefficients">Coefficients</h2>

<p>The coefficients are given by</p>

<p>

<math display="block" id="Lanczos_approximation:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>a</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>k</mi>
    </munderover>
    <mrow>
     <mi>C</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>a</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mfrac>
      <msqrt>
       <mn>2</mn>
      </msqrt>
      <mi>π</mi>
     </mfrac>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>a</mi>
        <mo>-</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mstyle displaystyle="false">
            <mfrac>
             <mn>1</mn>
             <mn>2</mn>
            </mfrac>
           </mstyle>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>a</mi>
        <mo>+</mo>
        <mi>g</mi>
        <mo>+</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mstyle displaystyle="false">
            <mfrac>
             <mn>1</mn>
             <mn>2</mn>
            </mfrac>
           </mstyle>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>a</mi>
         <mo>+</mo>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <mi>g</mi>
       <mo>+</mo>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
     <ci>g</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>C</ci>
      <interval closure="open">
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>k</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>a</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </interval>
      <apply>
       <divide></divide>
       <apply>
        <root></root>
        <cn type="integer">2</cn>
       </apply>
       <ci>π</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <apply>
        <minus></minus>
        <ci>a</ci>
        <matrix>
         <matrixrow>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
         </matrixrow>
        </matrix>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>a</ci>
        <ci>g</ci>
        <matrix>
         <matrixrow>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">2</cn>
          </apply>
         </matrixrow>
        </matrix>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>a</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <plus></plus>
        <ci>a</ci>
        <ci>g</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}(g)=\sum_{a=0}^{k}C(2k+1,2a+1)\frac{\sqrt{2}}{\pi}\left(a-\begin{matrix}%
\frac{1}{2}\end{matrix}\right)!{\left(a+g+\begin{matrix}\frac{1}{2}\end{matrix%
}\right)}^{-\left(a+\frac{1}{2}\right)}e^{a+g+\frac{1}{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Lanczos_approximation:5">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>C</ci>
    <interval closure="open">
     <ci>i</ci>
     <ci>j</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(i,j)
  </annotation>
 </semantics>
</math>

 denoting the (<em>i</em>, <em>j</em>)th element of the <a href="Chebyshev_polynomial" title="wikilink">Chebyshev polynomial</a> coefficient <a href="matrix_(mathematics)" title="wikilink">matrix</a> which can be calculated <a href="recursion" title="wikilink">recursively</a> from the identities</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <interval closure="open">
      <cn type="integer">1</cn>
      <cn type="integer">1</cn>
     </interval>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(1,1)=1\,
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <interval closure="open">
      <cn type="integer">2</cn>
      <cn type="integer">2</cn>
     </interval>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(2,2)=1\,
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>C</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo>,</mo>
      <mn>1</mn>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <interval closure="open">
      <ci>i</ci>
      <cn type="integer">1</cn>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>C</ci>
      <interval closure="open">
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(i,1)=-C(i-2,1)\,
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:9">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mo>,</mo>
    <mn>4</mn>
    <mo>,</mo>
    <mpadded width="+1.7pt">
     <mi mathvariant="normal">…</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">3</cn>
     <cn type="integer">4</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=3,4,\dots\,
  </annotation>
 </semantics>
</math>


</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>i</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>j</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <interval closure="open">
      <ci>i</ci>
      <ci>j</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>C</ci>
     <interval closure="open">
      <apply>
       <minus></minus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(i,j)=2C(i-1,j-1)\,
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mi>j</mi>
    <mo>=</mo>
    <mn>3</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>4</mn>
    <mo>,</mo>
    <mpadded width="+1.7pt">
     <mi mathvariant="normal">…</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <list>
     <cn type="integer">4</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=j=3,4,\dots\,
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>C</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>j</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>C</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo>,</mo>
      <mi>j</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>C</ci>
     <interval closure="open">
      <ci>i</ci>
      <ci>j</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>C</ci>
      <interval closure="open">
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <ci>C</ci>
      <interval closure="open">
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>j</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C(i,j)=2C(i-1,j-1)-C(i-2,j)\,
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Lanczos_approximation:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>i</mi>
     <mo>></mo>
     <mi>j</mi>
     <mo>=</mo>
     <mn>2</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mn>3</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <gt></gt>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <list>
     <cn type="integer">3</cn>
     <ci>normal-…</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i>j=2,3,\dots.
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>Paul Godfrey describes how to obtain the coefficients and also the value of the truncated series <em>A</em> as a <a href="matrix_multiplication" title="wikilink">matrix product</a>.</p>
<h2 id="derivation">Derivation</h2>

<p>Lanczos derived the formula from <a href="Leonhard_Euler" title="wikilink">Leonhard Euler</a>'s <a class="uri" href="integral" title="wikilink">integral</a></p>

<p>

<math display="block" id="Lanczos_approximation:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mi>t</mi>
        <mi>z</mi>
       </msup>
      </mpadded>
      <mpadded width="+1.7pt">
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mi>t</mi>
        </mrow>
       </msup>
      </mpadded>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z+1)=\int_{0}^{\infty}t^{z}\,e^{-t}\,dt,
  </annotation>
 </semantics>
</math>

</p>

<p>performing a sequence of basic manipulations to obtain</p>

<p>

<math display="block" id="Lanczos_approximation:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>z</mi>
        <mo>+</mo>
        <mi>g</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>z</mi>
         <mo>+</mo>
         <mi>g</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi>e</mi>
      </msubsup>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>v</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mrow>
             <mi>log</mi>
             <mi>v</mi>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
        <mrow>
         <mi>z</mi>
         <mo>-</mo>
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mrow>
       </msup>
       <mpadded width="+1.7pt">
        <msup>
         <mi>v</mi>
         <mi>g</mi>
        </msup>
       </mpadded>
       <mi>d</mi>
       <mi>v</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <ci>g</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <ci>e</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <times></times>
          <ci>v</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <log></log>
            <ci>v</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>z</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <ci>g</ci>
       </apply>
       <ci>d</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(z+1)=(z+g+1)^{z+1}e^{-(z+g+1)}\int_{0}^{e}[v(1-\log v)]^{z-\frac{1}{2}}%
v^{g}\,dv,
  </annotation>
 </semantics>
</math>

</p>

<p>and deriving a series for the integral.</p>
<h2 id="simple-implementation">Simple implementation</h2>

<p>The following implementation in the <a href="Python_(programming_language)" title="wikilink">Python programming language</a> works for complex arguments and typically gives 15 correct decimal places:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> gamma(z):             <span class="co"># great function from Wiki, but maybe could use memorization?</span>
    epsilon <span class="op">=</span> <span class="fl">0.0000001</span>
    <span class="kw">def</span> withinepsilon(x):
        <span class="cf">return</span> <span class="bu">abs</span>(x <span class="op">-</span> <span class="bu">abs</span>(x)) <span class="op">&lt;=</span> epsilon

    <span class="im">from</span> cmath <span class="im">import</span> sin,sqrt,pi,exp

    p <span class="op">=</span> [ <span class="fl">676.5203681218851</span>,   <span class="op">-</span><span class="fl">1259.1392167224028</span>,  <span class="fl">771.32342877765313</span>,
         <span class="op">-</span><span class="fl">176.61502916214059</span>,     <span class="fl">12.507343278686905</span>, <span class="op">-</span><span class="fl">0.13857109526572012</span>,
            <span class="fl">9.9843695780195716e-6</span>, <span class="fl">1.5056327351493116e-7</span>]
    z <span class="op">=</span> <span class="bu">complex</span>(z)

    <span class="co"># Reflection formula</span>
    <span class="cf">if</span> z.real <span class="op">&lt;</span> <span class="fl">0.5</span>:
        result <span class="op">=</span> pi <span class="op">/</span> (sin(pi<span class="op">*</span>z) <span class="op">*</span> gamma(<span class="dv">1</span><span class="op">-</span>z))
    <span class="cf">else</span>:
        z <span class="op">-=</span> <span class="dv">1</span>
        x <span class="op">=</span> <span class="fl">0.99999999999980993</span>

        <span class="cf">for</span> (i, pval) <span class="op">in</span> <span class="bu">enumerate</span>(p):
            x <span class="op">+=</span> pval<span class="op">/</span>(z<span class="op">+</span>i<span class="dv">+1</span>)

        t <span class="op">=</span> z <span class="op">+</span> <span class="bu">len</span>(p) <span class="op">-</span> <span class="fl">0.5</span>
        result <span class="op">=</span> sqrt(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span> t<span class="op">**</span>(z<span class="fl">+0.5</span>) <span class="op">*</span> exp(<span class="op">-</span>t) <span class="op">*</span> x

    <span class="cf">if</span> withinepsilon(result.imag):
        <span class="cf">return</span> result.real
    <span class="cf">return</span> result</code></pre></div>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Stirling's_approximation" title="wikilink">Stirling's approximation</a></li>
<li><a href="Spouge's_approximation" title="wikilink">Spouge's approximation</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Gamma_and_related_functions" title="wikilink">Category:Gamma and related functions</a> <a href="Category:Numerical_analysis" title="wikilink">Category:Numerical analysis</a> <a href="Category:Articles_with_example_Python_code" title="wikilink">Category:Articles with example Python code</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Pugh thesis<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>


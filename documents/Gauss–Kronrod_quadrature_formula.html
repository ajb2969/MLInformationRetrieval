<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="859">Gauss–Kronrod quadrature formula</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Gauss–Kronrod quadrature formula</h1>
<hr/>

<p>In <a href="numerical_mathematics" title="wikilink">numerical mathematics</a>, the <strong>Gauss–Kronrod quadrature formula</strong> is a method for <a href="numerical_integration" title="wikilink">numerical integration</a> (calculating approximate values of <a href="integral" title="wikilink">integrals</a>). Gauss–Kronrod quadrature is a variant of <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a>, in which the evaluation points are chosen so that an accurate approximation can be computed by re-using the information produced by the computation of a less accurate approximation. It is an example of what is called a <a href="nested_quadrature_rule" title="wikilink">nested quadrature rule</a>: for the same set of function evaluation points, it has two quadrature rules, one higher order and one lower order (the latter called an <em>embedded</em> rule). The difference between these two approximations is used to estimate the calculational error of the integration.</p>

<p>These formulas are named after <a href="Alexander_Kronrod" title="wikilink">Alexander Kronrod</a>, who invented them in the 1960s, and <a href="Carl_Friedrich_Gauss" title="wikilink">Carl Friedrich Gauss</a>. Gauss–Kronrod quadrature is used in the <a class="uri" href="QUADPACK" title="wikilink">QUADPACK</a> library, the <a href="GNU_Scientific_Library" title="wikilink">GNU Scientific Library</a>, the <a href="NAG_Numerical_Libraries" title="wikilink">NAG Numerical Libraries</a> and <a href="R_(programming_language)" title="wikilink">R</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="description">Description</h2>

<p>The problem in numerical integration is to approximate definite integrals of the form</p>

<p>

<math display="block" id="Gauss–Kronrod_quadrature_formula:0">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>a</mi>
     <mi>b</mi>
    </msubsup>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>a</ci>
     </apply>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx.
  </annotation>
 </semantics>
</math>

</p>

<p>Such integrals can be approximated, for example, by <em>n</em>-point <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a></p>

<p>

<math display="block" id="Gauss–Kronrod_quadrature_formula:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>a</mi>
      <mi>b</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>a</ci>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx\approx\sum_{i=1}^{n}w_{i}f(x_{i}).
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>w</em><sub><em>i</em></sub>, <em>x</em><sub><em>i</em></sub> are the weights and points at which to evaluate the function <em>f</em>(<em>x</em>).</p>

<p>If the interval [<em>a</em>, <em>b</em>] is subdivided, the Gauss evaluation points of the new subintervals never coincide with the previous evaluation points (except at the midpoint for odd numbers of evaluation points), and thus the integrand must be evaluated at every point. Gauss–Kronrod formulas are extensions of the Gauss quadrature formulas generated by adding 

<math display="inline" id="Gauss–Kronrod_quadrature_formula:2">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n+1
  </annotation>
 </semantics>
</math>

 points to an 

<math display="inline" id="Gauss–Kronrod_quadrature_formula:3">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-point rule in such a way that the resulting rule is of order 

<math display="inline" id="Gauss–Kronrod_quadrature_formula:4">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>n</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2n+1
  </annotation>
 </semantics>
</math>

. These extra points are the zeros of <a href="Stieltjes_polynomials" title="wikilink">Stieltjes polynomials</a>. This allows for computing higher-order estimates while reusing the function values of a lower-order estimate. The difference between a Gauss quadrature rule and its Kronrod extension are often used as an estimate of the approximation error.</p>
<h2 id="example">Example</h2>

<p>A popular example combines a 7-point Gauss rule with a 15-point Kronrod rule . Because the Gauss points are incorporated into the Kronrod points, a total of only 15 function evaluations yields both a quadrature estimate and an error estimate.</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>(G7,K15) on [−1,1]</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Gauss nodes</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>±0.94910 79123 42759</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>±0.74153 11855 99394</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>±0.40584 51513 77397</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p> 0.00000 00000 00000</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Kronrod nodes</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>±0.99145 53711 20813</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>±0.94910 79123 42759</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>±0.86486 44233 59769</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>±0.74153 11855 99394</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>±0.58608 72354 67691</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>±0.40584 51513 77397</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>±0.20778 49550 07898</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p> 0.00000 00000 00000</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>The recommended error estimate is 

<math display="inline" id="Gauss–Kronrod_quadrature_formula:5">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>200</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mrow>
        <mi>G</mi>
        <mn>7</mn>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>K</mi>
        <mn>15</mn>
       </mrow>
      </mrow>
      <mo stretchy="false">|</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mn>1.5</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <times></times>
     <cn type="integer">200</cn>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>G</ci>
        <cn type="integer">7</cn>
       </apply>
       <apply>
        <times></times>
        <ci>K</ci>
        <cn type="integer">15</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="float">1.5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (200|G7-K15|)^{1.5}
  </annotation>
 </semantics>
</math>

.</p>

<p>showed how to find further extensions of this type.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Clenshaw–Curtis_quadrature" title="wikilink">Clenshaw–Curtis quadrature</a>, another nested quadrature rule with similar accuracy</li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li>

<p>(Authorized translation from the Russian)</p></li>
<li>

<p>(Reference guide for QUADPACK)</p></li>
<li>

<p>. Erratum in <em>Math. Comput.</em> <strong>23</strong>: 892.</p></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.netlib.org/slatec/src/qpdoc.f">QUADPACK (part of SLATEC)</a>, source code <a href="http://www.netlib.org/slatec/src">1</a>. QUADPACK is a collection of algorithms, in <a class="uri" href="Fortran" title="wikilink">Fortran</a>, for numerical integration based on Gauss-Kronrod rules. <a class="uri" href="SLATEC" title="wikilink">SLATEC</a> (at <a class="uri" href="Netlib" title="wikilink">Netlib</a>) is a large public domain library for numerical computing.</li>
<li><a href="http://www.alglib.net/integral/autogk61.php">ALGLIB source code in C#, C++, Delphi &amp; Visual Basic</a></li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_integration_(quadrature)" title="wikilink">Category:Numerical integration (quadrature)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/integrate.html"></a><a class="uri" href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/integrate.html">http://stat.ethz.ch/R-manual/R-patched/library/stats/html/integrate.html</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

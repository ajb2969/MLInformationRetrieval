   Lady Windermere's Fan (mathematics)      Lady Windermere's Fan (mathematics)   In mathematics , Lady Windermere's Fan is a telescopic identity employed to relate global and local error of a numerical algorithm . The name is derived from Oscar Wilde 's play Lady Windermere's Fan, A Play About a Good Woman .  Lady Windermere's Fan for a function of one variable  Let    E   (  œÑ  ,   t  0   ,   y   (   t  0   )    )       E   œÑ   subscript  t  0     y   subscript  t  0       E(\ \tau,t_{0},y(t_{0})\ )   be the exact solution operator so that:         y   (    t  0   +  œÑ   )    =   E   (  œÑ  ,   t  0   ,   y   (   t  0   )    )   y   (   t  0   )          y     subscript  t  0   œÑ      E   œÑ   subscript  t  0     y   subscript  t  0     y   subscript  t  0      y(t_{0}+\tau)=E(\tau,t_{0},y(t_{0}))\ y(t_{0})        with    t  0     subscript  t  0    t_{0}   denoting the initial time and    y   (  t  )       y  t    y(t)   the function to be approximated with a given    y   (   t  0   )       y   subscript  t  0     y(t_{0})   .  Further let    y  n     subscript  y  n    y_{n}   ,     n  ‚àà  ùí©   ,   n  ‚â§  N      formulae-sequence    n  ùí©     n  N     n\in\mathcal{N},\ n\leq N   be the numerical approximation at time    t  n     subscript  t  n    t_{n}   ,     t  0   <   t  n   ‚â§  T  =   t  N          subscript  t  0    subscript  t  n        T        subscript  t  N      t_{0}   .    y  n     subscript  y  n    y_{n}   can be attained by means of the approximation operator     Œ¶   (   h  n   ,   t  n   ,   y   (   t  n   )    )       normal-Œ¶    subscript  h  n    subscript  t  n     y   subscript  t  n       \Phi(\ h_{n},t_{n},y(t_{n})\ )   so that:          y  n   =   Œ¶   (   h   n  -  1    ,   t   n  -  1    ,   y   (   t   n  -  1    )    )    y   n  -  1           subscript  y  n     normal-Œ¶    subscript  h    n  1     subscript  t    n  1      y   subscript  t    n  1       subscript  y    n  1       y_{n}=\Phi(\ h_{n-1},t_{n-1},y(t_{n-1})\ )\ y_{n-1}\quad   with     h  n   =    t   n  +  1    -   t  n         subscript  h  n      subscript  t    n  1     subscript  t  n      h_{n}=t_{n+1}-t_{n}        The approximation operator represents the numerical scheme used. For a simple explicit forward euler scheme with step witdth   h   h   h   this would be      Œ¶  Euler    (  h  ,   t   n  -  1    ,   y   (   t   n  -  1    )    )   y   (   t   n  -  1    )    =    (   1  +   h   d   d  t      )   y   (   t   n  -  1    )           subscript  normal-Œ¶  Euler    h   subscript  t    n  1      y   subscript  t    n  1      y   subscript  t    n  1         1    h    d    d  t      y   subscript  t    n  1       \Phi_{\text{Euler}}(\ h,t_{n-1},y(t_{n-1})\ )\ y(t_{n-1})=(1+h\frac{d}{dt})\ y%
 (t_{n-1})     The local error     d  n     subscript  d  n    d_{n}   is then given by:         d  n   :=  D   (   h   n  -  1    ,   t   n  -  1    ,  y   (    t   n  -  1     )    y   n  -  1    :=   [  Œ¶   (   h   n  -  1    ,   t   n  -  1    ,  y   (   t   n  -  1    )   )   -  E   (   h   n  -  1    ,   t   n  -  1    ,  y   (   t   n  -  1    )   )   ]    y   n  -  1        fragments   subscript  d  n   assign  D   fragments  normal-(   subscript  h    n  1    normal-,   subscript  t    n  1    normal-,  y   fragments  normal-(   subscript  t    n  1    normal-)    subscript  y    n  1    assign   fragments  normal-[  Œ¶   fragments  normal-(   subscript  h    n  1    normal-,   subscript  t    n  1    normal-,  y   fragments  normal-(   subscript  t    n  1    normal-)   normal-)    E   fragments  normal-(   subscript  h    n  1    normal-,   subscript  t    n  1    normal-,  y   fragments  normal-(   subscript  t    n  1    normal-)   normal-)   normal-]    subscript  y    n  1       d_{n}:=D(\ h_{n-1},t_{n-1},y(t_{n-1}\ )\ y_{n-1}:=\left[\Phi(\ h_{n-1},t_{n-1}%
 ,y(t_{n-1})\ )-E(\ h_{n-1},t_{n-1},y(t_{n-1})\ )\right]\ y_{n-1}        In abbreviation we write:         Œ¶   (   h  n   )    :=   Œ¶   (   h  n   ,   t  n   ,   y   (   t  n   )    )       assign    normal-Œ¶   subscript  h  n      normal-Œ¶    subscript  h  n    subscript  t  n     y   subscript  t  n        \Phi(h_{n}):=\Phi(\ h_{n},t_{n},y(t_{n})\ )          E   (   h  n   )    :=   E   (   h  n   ,   t  n   ,   y   (   t  n   )    )       assign    E   subscript  h  n      E    subscript  h  n    subscript  t  n     y   subscript  t  n        E(h_{n}):=E(\ h_{n},t_{n},y(t_{n})\ )          D   (   h  n   )    :=   D   (   h  n   ,   t  n   ,   y   (   t  n   )    )       assign    D   subscript  h  n      D    subscript  h  n    subscript  t  n     y   subscript  t  n        D(h_{n}):=D(\ h_{n},t_{n},y(t_{n})\ )        Then Lady Windermere's Fan for a function of a single variable   t   t   t   writes as:        y  N   -   y   (   t  N   )     =     ‚àè   j  =  0    N  -  1     Œ¶   (   h  j   )    (    y  0   -   y   (   t  0   )     )     +     ‚àë   n  =  1   N      ‚àè   j  =  n    N  -  1     Œ¶   (   h  j   )    d  n              subscript  y  N     y   subscript  t  N         superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j      subscript  y  0     y   subscript  t  0         superscript   subscript     n  1    N     superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j    subscript  d  n         y_{N}-y(t_{N})=\prod_{j=0}^{N-1}\Phi(h_{j})\ (y_{0}-y(t_{0}))+\sum_{n=1}^{N}\ %
 \prod_{j=n}^{N-1}\Phi(h_{j})\ d_{n}     with a global error of     y  N   -   y   (   t  N   )         subscript  y  N     y   subscript  t  N      y_{N}-y(t_{N})     Explanation          y  N   -   y   (   t  N   )         =    y  N   -        ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )   y   (   t  0   )     +     ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )   y   (   t  0   )      ‚èü     =  0    -   y   (   t  N   )             =     y  N   -     ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )   y   (   t  0   )      +         ‚àë   n  =  0    N  -  1         ‚àè   j  =  n    N  -  1      Œ¶   (   h  j   )   y   (   t  n   )      -      ‚àë   n  =  1   N        ‚àè   j  =  n    N  -  1      Œ¶   (   h  j   )   y   (   t  n   )       ‚èü      =      ‚àè   n  =  0    N  -  1      Œ¶   (   h  n   )   y   (   t  n   )     -     ‚àë   n  =  N   N      [     ‚àè   j  =  n    N  -  1      Œ¶   (   h  j   )     ]   y   (   t  n   )         =      ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )   y   (   t  0   )     -   y   (   t  N   )                 =        ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )    y  0     -     ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )   y   (   t  0   )      +      ‚àë   n  =  1   N        ‚àè   j  =   n  -  1     N  -  1      Œ¶   (   h  j   )   y   (   t   n  -  1    )       -      ‚àë   n  =  1   N        ‚àè   j  =  n    N  -  1      Œ¶   (   h  j   )   y   (   t  n   )               =      ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )    (    y  0   -   y   (   t  0   )     )     +      ‚àë   n  =  1   N        ‚àè   j  =  n    N  -  1      Œ¶   (   h  j   )    [    Œ¶   (   h   n  -  1    )    -   E   (   h   n  -  1    )     ]   y   (   t   n  -  1    )               =      ‚àè   j  =  0    N  -  1      Œ¶   (   h  j   )    (    y  0   -   y   (   t  0   )     )     +      ‚àë   n  =  1   N        ‚àè   j  =  n    N  -  1      Œ¶   (   h  j   )    d  n                 subscript  y  N     y   subscript  t  N       absent     subscript  y  N    subscript   normal-‚èü      superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  0       superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  0         absent  0      y   subscript  t  N         missing-subexpression     absent       subscript  y  N     superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  0       subscript   normal-‚èü      superscript   subscript     n  0      N  1      superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  n        superscript   subscript     n  1    N     superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  n           absent      superscript   subscript  product    n  0      N  1      normal-Œ¶   subscript  h  n   y   subscript  t  n       superscript   subscript     n  N    N      delimited-[]    superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j      y   subscript  t  n         absent      superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  0       y   subscript  t  N             missing-subexpression     absent          superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j    subscript  y  0       superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  0        superscript   subscript     n  1    N     superscript   subscript  product    j    n  1       N  1      normal-Œ¶   subscript  h  j   y   subscript  t    n  1          superscript   subscript     n  1    N     superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j   y   subscript  t  n           missing-subexpression     absent      superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j      subscript  y  0     y   subscript  t  0         superscript   subscript     n  1    N     superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j    delimited-[]      normal-Œ¶   subscript  h    n  1       E   subscript  h    n  1       y   subscript  t    n  1            missing-subexpression     absent      superscript   subscript  product    j  0      N  1      normal-Œ¶   subscript  h  j      subscript  y  0     y   subscript  t  0         superscript   subscript     n  1    N     superscript   subscript  product    j  n      N  1      normal-Œ¶   subscript  h  j    subscript  d  n           \begin{aligned}\displaystyle y_{N}-y(t_{N})&\displaystyle{}=y_{N}-\underbrace{%
 \prod_{j=0}^{N-1}\Phi(h_{j})\ y(t_{0})+\prod_{j=0}^{N-1}\Phi(h_{j})\ y(t_{0})}%
 _{=0}-y(t_{N})\\
 &\displaystyle{}=y_{N}-\prod_{j=0}^{N-1}\Phi(h_{j})\ y(t_{0})+\underbrace{\sum%
 _{n=0}^{N-1}\ \prod_{j=n}^{N-1}\Phi(h_{j})\ y(t_{n})-\sum_{n=1}^{N}\ \prod_{j=%
 n}^{N-1}\Phi(h_{j})\ y(t_{n})}_{=\prod_{n=0}^{N-1}\Phi(h_{n})\ y(t_{n})-\sum_{%
 n=N}^{N}\left[\prod_{j=n}^{N-1}\Phi(h_{j})\right]\ y(t_{n})=\prod_{j=0}^{N-1}%
 \Phi(h_{j})\ y(t_{0})-y(t_{N})}\\
 &\displaystyle{}=\prod_{j=0}^{N-1}\Phi(h_{j})\ y_{0}-\prod_{j=0}^{N-1}\Phi(h_{%
 j})\ y(t_{0})+\sum_{n=1}^{N}\ \prod_{j=n-1}^{N-1}\Phi(h_{j})\ y(t_{n-1})-\sum_%
 {n=1}^{N}\ \prod_{j=n}^{N-1}\Phi(h_{j})\ y(t_{n})\\
 &\displaystyle{}=\prod_{j=0}^{N-1}\Phi(h_{j})\ (y_{0}-y(t_{0}))+\sum_{n=1}^{N}%
 \ \prod_{j=n}^{N-1}\Phi(h_{j})\left[\Phi(h_{n-1})-E(h_{n-1})\right]\ y(t_{n-1}%
 )\\
 &\displaystyle{}=\prod_{j=0}^{N-1}\Phi(h_{j})\ (y_{0}-y(t_{0}))+\sum_{n=1}^{N}%
 \ \prod_{j=n}^{N-1}\Phi(h_{j})\ d_{n}\end{aligned}     See also   Baker‚ÄìCampbell‚ÄìHausdorff formula  Numerical error   "  Category:Numerical analysis   
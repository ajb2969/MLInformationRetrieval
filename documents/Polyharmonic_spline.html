<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="839">Polyharmonic spline</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Polyharmonic spline</h1>
<hr/>

<p><strong>Polyharmonic splines</strong> are used for <a href="function_approximation" title="wikilink">function approximation</a> and data <a class="uri" href="interpolation" title="wikilink">interpolation</a>. They are very useful for interpolation of scattered data in many dimensions. A special case are <a href="thin_plate_spline" title="wikilink">thin plate splines</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="definition">Definition</h2>
<blockquote>

<p>

<math display="inline" id="Polyharmonic_spline:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐱</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </msubsup>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
      </mpadded>
      <mi>ϕ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo fence="true">||</mo>
        <mrow>
         <mi>𝐱</mi>
         <mo>-</mo>
         <msub>
          <mi>𝐜</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo fence="true">||</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mi>𝐯</mi>
       <mi>T</mi>
      </msup>
     </mpadded>
     <mrow>
      <mo>[</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>𝐱</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>y</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <ci>ϕ</ci>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>𝐱</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐜</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐯</ci>
       <ci>T</ci>
      </apply>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <ci>𝐱</ci>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y(\mathbf{x})\,=\,\sum_{i=1}^{N}w_{i}\,\phi(||\mathbf{x}-\mathbf{c}_{i}||)+%
\mathbf{v}^{T}\,\begin{bmatrix}1\\
\mathbf{x}\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>where</p>
<figure><b>(Figure)</b>
<figcaption>Polyharmonic basis functions</figcaption>
</figure>
<ul>
<li>

<math display="inline" id="Polyharmonic_spline:1">
 <semantics>
  <mrow>
   <mi>𝐱</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>n</mi>
       <mi>x</mi>
      </mrow>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐱</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </list>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}=[x_{1},x_{2},\cdots,x_{nx}]^{T}
  </annotation>
 </semantics>
</math>

 is a real-valued vector of nx independent variables,</li>
<li>

<math display="inline" id="Polyharmonic_spline:2">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐜</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>c</mi>
      <mrow>
       <mn>1</mn>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>c</mi>
      <mrow>
       <mn>2</mn>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>,</mo>
     <msub>
      <mi>c</mi>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mi>x</mi>
       </mrow>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐜</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <list>
        <cn type="integer">1</cn>
        <ci>i</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <list>
        <cn type="integer">2</cn>
        <ci>i</ci>
       </list>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <list>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>x</ci>
        </apply>
        <ci>i</ci>
       </list>
      </apply>
     </list>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{c}_{i}=[c_{1,i},c_{2,i},\cdots,c_{nx,i}]^{T}
  </annotation>
 </semantics>
</math>

 are N vectors of the same size as 

<math display="inline" id="Polyharmonic_spline:3">
 <semantics>
  <mi>𝐱</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐱</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
 </semantics>
</math>

 (often called centers) that the interpolated curve shall pass</li>
<li>

<math display="inline" id="Polyharmonic_spline:4">
 <semantics>
  <mrow>
   <mi>𝐰</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>w</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>w</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>,</mo>
     <msub>
      <mi>w</mi>
      <mi>N</mi>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐰</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>N</ci>
      </apply>
     </list>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{w}=[w_{1},w_{2},\cdots,w_{N}]^{T}
  </annotation>
 </semantics>
</math>

 are the N weights of the basis functions.</li>
<li>

<math display="inline" id="Polyharmonic_spline:5">
 <semantics>
  <mrow>
   <mi>𝐯</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>v</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>v</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">⋯</mi>
     <mo>,</mo>
     <msub>
      <mi>v</mi>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mi>x</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐯</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </list>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}=[v_{1},v_{2},\cdots,v_{nx+1}]^{T}
  </annotation>
 </semantics>
</math>

 are the nx+1 weights of the polynomial.</li>
<li>The linear polynomial with the weighting factors 

<math display="inline" id="Polyharmonic_spline:6">
 <semantics>
  <mi>𝐯</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐯</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}
  </annotation>
 </semantics>
</math>

 improves the interpolation close to the "boundary" and especially the extrapolation "outside" of the centers 

<math display="inline" id="Polyharmonic_spline:7">
 <semantics>
  <msub>
   <mi>𝐜</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐜</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{c}_{i}
  </annotation>
 </semantics>
</math>

. If this is not desired, this term can also be removed (see also figure below).</li>
</ul>

<p>The basis functions of <strong>polyharmonic splines</strong> are <a href="radial_basis_function" title="wikilink">radial basis functions</a> of the form:</p>
<blockquote>

<p>

<math display="inline" id="Polyharmonic_spline:8">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <mrow>
      <mrow>
       <mi>ϕ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mo>{</mo>
       <mtable>
        <mtr>
         <mtd columnalign="left">
          <msup>
           <mi>r</mi>
           <mi>k</mi>
          </msup>
         </mtd>
         <mtd columnalign="left">
          <mrow>
           <mrow>
            <mrow>
             <mtext>with</mtext>
             <mi>k</mi>
            </mrow>
            <mo>=</mo>
            <mrow>
             <mn>1</mn>
             <mo>,</mo>
             <mn>3</mn>
             <mo>,</mo>
             <mn>5</mn>
             <mo>,</mo>
             <mi mathvariant="normal">…</mi>
            </mrow>
           </mrow>
           <mo>,</mo>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="left">
          <mrow>
           <msup>
            <mi>r</mi>
            <mi>k</mi>
           </msup>
           <mrow>
            <mi>ln</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>r</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mtd>
         <mtd columnalign="left">
          <mrow>
           <mrow>
            <mtext>with</mtext>
            <mi>k</mi>
           </mrow>
           <mo>=</mo>
           <mrow>
            <mn>2</mn>
            <mo>,</mo>
            <mn>4</mn>
            <mo>,</mo>
            <mn>6</mn>
            <mo>,</mo>
            <mi mathvariant="normal">…</mi>
           </mrow>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="center">
     <mrow>
      <mi>r</mi>
      <mo>=</mo>
      <msub>
       <mrow>
        <mo fence="true">||</mo>
        <mrow>
         <mi>𝐱</mi>
         <mo>-</mo>
         <msub>
          <mi>𝐜</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo fence="true">||</mo>
       </mrow>
       <mn>2</mn>
      </msub>
      <mo>=</mo>
      <msqrt>
       <mrow>
        <mpadded width="+1.7pt">
         <msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>𝐱</mi>
            <mo>-</mo>
            <msub>
             <mi>𝐜</mi>
             <mi>i</mi>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>T</mi>
         </msup>
        </mpadded>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>𝐱</mi>
          <mo>-</mo>
          <msub>
           <mi>𝐜</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msqrt>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>ϕ</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">cases</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <eq></eq>
        <apply>
         <times></times>
         <mtext>with</mtext>
         <ci>k</ci>
        </apply>
        <list>
         <cn type="integer">1</cn>
         <cn type="integer">3</cn>
         <cn type="integer">5</cn>
         <ci>normal-…</ci>
        </list>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <ln></ln>
         <ci>r</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <apply>
         <times></times>
         <mtext>with</mtext>
         <ci>k</ci>
        </apply>
        <list>
         <cn type="integer">2</cn>
         <cn type="integer">4</cn>
         <cn type="integer">6</cn>
         <ci>normal-…</ci>
        </list>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>𝐱</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐜</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <share href="#.cmml">
       </share>
       <apply>
        <root></root>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <ci>𝐱</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐜</ci>
            <ci>i</ci>
           </apply>
          </apply>
          <ci>T</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>𝐱</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐜</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{matrix}\phi(r)=\begin{cases}r^{k}&\mbox{with }k=1,3,5,\dots,\\
r^{k}\ln(r)&\mbox{with }k=2,4,6,\dots\end{cases}\\
r=||\mathbf{x}-\mathbf{c}_{i}||_{2}=\sqrt{(\mathbf{x}-\mathbf{c}_{i})^{T}\,(%
\mathbf{x}-\mathbf{c}_{i})}\end{matrix}
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>Other values of exponent k are not useful (such as 

<math display="inline" id="Polyharmonic_spline:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>r</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(r)=r^{2}
  </annotation>
 </semantics>
</math>

), because a solution of the interpolation problem might no longer exist. To avoid problems at r=0 (since ln(0) = -∞), the polyharmonic splines with the natural logarithm might be implemented as:</p>
<blockquote>

<p>

<math display="inline" id="Polyharmonic_spline:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msup>
         <mi>r</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mi>r</mi>
           <mi>r</mi>
          </msup>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <mi>r</mi>
        </mrow>
        <mo><</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msup>
         <mi>r</mi>
         <mi>k</mi>
        </msup>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>r</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <mi>r</mi>
        </mrow>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <ln></ln>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <lt></lt>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <ci>r</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <ln></ln>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <geq></geq>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <ci>r</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(r)=\begin{cases}r^{k-1}\ln(r^{r})&\mbox{for }r<1\\
r^{k}\ln(r)&\mbox{for }r\geq 1\end{cases}
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>The weights 

<math display="inline" id="Polyharmonic_spline:11">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Polyharmonic_spline:12">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{j}
  </annotation>
 </semantics>
</math>

 are determined such that the function passes through 

<math display="inline" id="Polyharmonic_spline:13">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 given points 

<math display="inline" id="Polyharmonic_spline:14">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>𝐜</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐜</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{c}_{i},y_{i})
  </annotation>
 </semantics>
</math>

 (i=1,2,...,N) and fulfill the 

<math display="inline" id="Polyharmonic_spline:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mi>x</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   nx+1
  </annotation>
 </semantics>
</math>

 orthogonality conditions:</p>
<blockquote>

<p>

<math display="inline" id="Polyharmonic_spline:16">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>=</mo>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </msubsup>
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>,</mo>
   <mn>0</mn>
   <mo>=</mo>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </msubsup>
   <mpadded width="+1.7pt">
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
   </mpadded>
   <mpadded width="+8.4pt">
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>j</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cn type="integer">0</cn>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <ci>normal-,</ci>
    <cn type="float">0</cn>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <list>
      <ci>j</ci>
      <ci>i</ci>
     </list>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <eq></eq>
     <cn type="integer">1</cn>
     <ci>normal-,</ci>
     <cn type="integer">2</cn>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">n</csymbol>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0=\sum_{i=1}^{N}w_{i},\;\;0=\sum_{i=1}^{N}w_{i}\,c_{j,i}\;\;\;(j=1,2,...,nx)
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>To compute the weights, a symmetric, linear system of equations has to be solved:</p>
<blockquote>

<p>

<math display="inline" id="Polyharmonic_spline:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mpadded width="+2.8pt">
      <mrow>
       <mo>[</mo>
       <mtable>
        <mtr>
         <mtd columnalign="center">
          <mi>𝐀</mi>
         </mtd>
         <mtd columnalign="center">
          <msup>
           <mi>𝐕</mi>
           <mi>T</mi>
          </msup>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi>𝐕</mi>
         </mtd>
         <mtd columnalign="center">
          <mn>𝟎</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mpadded>
     <mpadded width="+2.8pt">
      <mrow>
       <mo>[</mo>
       <mtable>
        <mtr>
         <mtd columnalign="center">
          <mi>𝐰</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi>𝐯</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
     </mpadded>
    </mrow>
    <mo rspace="5.3pt">=</mo>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mi>𝐲</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>𝟎</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <ci>𝐀</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐕</ci>
        <ci>T</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>𝐕</ci>
       <cn type="integer">0</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <ci>𝐰</ci>
      </matrixrow>
      <matrixrow>
       <ci>𝐯</ci>
      </matrixrow>
     </matrix>
    </apply>
    <matrix>
     <matrixrow>
      <ci>𝐲</ci>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}\mathbf{A}&\mathbf{V}^{T}\\
\mathbf{V}&\mathbf{0}\end{bmatrix}\;\begin{bmatrix}\mathbf{w}\\
\mathbf{v}\end{bmatrix}\;=\;\begin{bmatrix}\mathbf{y}\\
\mathbf{0}\end{bmatrix}\;\;\;\;
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>where</p>
<blockquote>

<p>

<math display="inline" id="Polyharmonic_spline:18">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo fence="true">||</mo>
       <mrow>
        <msub>
         <mi>𝐜</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>𝐜</mi>
         <mi>j</mi>
        </msub>
       </mrow>
       <mo fence="true">||</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="10.9pt">,</mo>
   <mrow>
    <mrow>
     <mi>𝐕</mi>
     <mo>=</mo>
     <mrow>
      <mo>[</mo>
      <mtable>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>𝐜</mi>
          <mn>1</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>𝐜</mi>
          <mn>2</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋯</mi>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>𝐜</mi>
          <mi>N</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo rspace="10.9pt">,</mo>
    <mrow>
     <mi>𝐲</mi>
     <mo>=</mo>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>N</mi>
       </msub>
       <mo stretchy="false">]</mo>
      </mrow>
      <mi>T</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <list>
       <ci>i</ci>
       <ci>j</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <ci>ϕ</ci>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐜</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐜</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>𝐕</ci>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
        <ci>normal-⋯</ci>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐜</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐜</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐜</ci>
         <ci>N</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <ci>𝐲</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <list>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>N</ci>
        </apply>
       </list>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{i,j}=\phi(||\mathbf{c}_{i}-\mathbf{c}_{j}||),\;\;\;\mathbf{V}=\begin{%
bmatrix}1&1&\cdots&1\\
\mathbf{c}_{1}&\mathbf{c}_{2}&\cdots&\mathbf{c}_{N}\end{bmatrix},\;\;\;\mathbf%
{y}=[y_{1},y_{2},\cdots,y_{N}]^{T}
  </annotation>
 </semantics>
</math>

</p>
</blockquote>

<p>Under very mild conditions (essentially, that at least nx+1 points are not in a subspace; e.g. for nx=2 that at least 3 points are not on a straight line), the system matrix of the linear system of equations is nonsingular and therefore a unique solution of the equation system exists.</p>

<p>Once the weights are determined, interpolation requires to just evaluate the top most formula for the provided 

<math display="inline" id="Polyharmonic_spline:19">
 <semantics>
  <mi>𝐱</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐱</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}
  </annotation>
 </semantics>
</math>

.</p>

<p>Many practical details to implement and use polyharmonic splines are given in the book of Fasshauer.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> In Iske<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> polyharmonic splines are treated as special cases of other multiresolution methods in scattered data modelling.</p>
<h2 id="examples">Examples</h2>

<p>The next figure shows the interpolation through four points (marked by "circles") using different types of polyharmonic splines. The "curvature" of the interpolated curves grows with the order of the spline and the extrapolation at the left boundary (x 2) which gives a good interpolation as well. Finally, the figure includes also the non-polyharmonic spline phi = r<sup>2</sup> to demonstrate, that this radial basis function is not able to pass through the predefined points (the linear equation has no solution and is solved in a least squares sense).</p>
<figure><b>(Figure)</b>
<figcaption>Interpolation with different polyharmonic splines that shall pass the 4 predefined points marked by a circle (the interpolation with phi = r<sup>2</sup> is not useful, since the linear equation system of the interpolation problem has no solution; it is solved in a least squares sense, but then does not pass the centers)</figcaption>
</figure>

<p>The next figure shows the same interpolation as in the first figure, with the only exception that the points to be interpolated are scaled by a factor of 100 (and the case phi = r<sup>2</sup> is no longer included). Since phi = (scale*r)<sup>k</sup> = (scale<sup>k</sup>)*r<sup>k</sup>, the factor (scale<sup>k</sup>) can be extracted from matrix <strong>A</strong> of the linear equation system and therefore the solution is not influenced by the scaling. This is different for the logarithmic form of the spline, although the scaling has not much influence. This analysis is reflected in the figure, where the interpolation shows not much differences. Note, for other radial basis functions, such as phi = exp(-k*r<sup>2</sup>) with k=1, the interpolation is no longer reasonable and it would be necessary to adapt k.</p>
<figure><b>(Figure)</b>
<figcaption> The same interpolation as in the first figure, but the points to be interpolated are scaled by 100</figcaption>
</figure>

<p>The next figure shows the same interpolation as in the first figure, with the only exception that the polynomial term of the function is not taken into account (and the case phi = r<sup>2</sup> is no longer included). As can be seen from the figure, the extrapolation for x e^{-k\cdot r^2} needs to be tuned, so that k is selected according to the underlying grid of the independent variables. If this grid is non-uniform, a proper selection of k to achieve a good interpolation result is difficult or impossible.</p>

<p>Main disadvantages are:</p>
<ul>
<li>To determine the weights, a linear system of equations must be solved, which is <strong>non-sparse</strong>. The solution of a non-sparse linear system becomes no longer practical if the dimension n is larger as about 1000 (since the storage requirements are O(n<sup>2</sup>) and the number of operations to solve the linear system is O(n<sup>3</sup>). For example n=10000 requires about 100 Mbyte of storage and 1000 Gflops of operations).</li>
</ul>
<ul>
<li>To perform the interpolation of M data points requires operations in the order of O(M*N). In many applications, like image processing, M is much larger than N, and if both numbers are large, this is no longer practical.</li>
</ul>

<p>Recently, methods have been developed to overcome the aforementioned difficulties. For example Beatson et al.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> present a method to interpolate polyharmonic splines at one point in 3 dimensions in O(log(N)) instead of O(N).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Inverse_distance_weighting" title="wikilink">Inverse distance weighting</a></li>
<li><a href="Radial_basis_function" title="wikilink">Radial basis function</a></li>
<li><a href="Subdivision_surface" title="wikilink">Subdivision surface</a> (emerging alternative to spline-based surfaces)</li>
<li><a href="Spline_(mathematics)" title="wikilink">Spline</a></li>
<li><a href="Thin_plate_spline" title="wikilink">Thin plate spline</a> (a special case of a polyharmonic spline)</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Splines" title="wikilink">Category:Splines</a> <a class="uri" href="Category:Interpolation" title="wikilink">Category:Interpolation</a> <a href="Category:Multivariate_interpolation" title="wikilink">Category:Multivariate interpolation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">R.L. Harder and R.N. Desmarais: <a href="http://www.mendeley.com/research/interpolation-using-surface-splines-1">Interpolation using surface splines</a>. Journal of Aircraft, 1972, Issue 2, pp. 189-191<a href="#fnref1">↩</a></li>
<li id="fn2">J. Duchon: Splines minimizing rotation-invariant semi-norms in Sobolev spaces. Constructive Theory of Functions of Several Variables, W. Schempp and K. Zeller (eds), Springer, Berlin, pp.85-100<a href="#fnref2">↩</a></li>
<li id="fn3">G.F. Fasshauer G.F.: <a href="http://books.google.com/books?id=gtqBdMEqryEC">Meshfree Approximation Methods with MATLAB</a>. World Scientific Publishing Company, 2007, ISPN-10: 9812706348<a href="#fnref3">↩</a></li>
<li id="fn4">A. Iske: <a href="http://www.springeronline.com/sgw/cda/frontpage/0,10735,5-10042-22-22344683-0,00.html">Multiresolution Methods in Scattered Data Modelling</a>, Lecture Notes in Computational Science and Engineering, 2004, Vol. 37, ISBN 3-540-20479-2, Springer-Verlag, Heidelberg.<a href="#fnref4">↩</a></li>
<li id="fn5">R.K. Beatson, M.J.D. Powell, and A.M. Tan A.M.: <a href="http://imajna.oxfordjournals.org/cgi/content/short/27/3/427">Fast evaluation of polyharmonic splines in three dimensions</a>. IMA Journal of Numerical Analysis, 2007, 27, pp. 427-450.<a href="#fnref5">↩</a></li>
</ol>
</section>
</body>
</html>

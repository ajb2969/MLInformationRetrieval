   Line–line intersection      Line–line intersection   In Euclidean geometry , the intersection of a line and a line can be the empty set , a point , or a line. Distinguishing these cases and finding the intersection point have use, for example, in computer graphics , motion planning , and collision detection .  In three-dimensional Euclidean geometry, if two lines are not in the same plane they are called skew lines and have no point of intersection. If they are in the same plane there are three possibilities: if they coincide (are not distinct lines) they have an infinitude of points in common (namely all of the points on either of them); if they are distinct but have the same slope they are said to be parallel and have no points in common; otherwise they have a single point of intersection.  The distinguishing features of non-Euclidean geometry are the number and locations of possible intersections between two lines and the number of possible lines with no intersections (parallel lines) with a given line.  Intersection of two lines  A necessary condition for two lines to intersect is that they are in the same plane—that is, are not skew lines. Satisfaction of this condition is equivalent to the tetrahedron with vertices at two of the points on one line and two of the points on the other line being degenerate in the sense of having zero volume . For the algebraic form of this condition, see Skew lines#Testing for skewness .  Given two points on each line  First we consider the intersection of two lines     L  1      subscript  L  1    L_{1}\,   and     L  2      subscript  L  2    L_{2}\,   in 2-dimensional space, with line     L  1      subscript  L  1    L_{1}\,   being defined by two distinct points    (   x  1   ,   y  1   )      subscript  x  1    subscript  y  1     (x_{1},y_{1})\,   and    (   x  2   ,   y  2   )      subscript  x  2    subscript  y  2     (x_{2},y_{2})\,   , and line     L  2      subscript  L  2    L_{2}\,   being defined by two distinct points    (   x  3   ,   y  3   )      subscript  x  3    subscript  y  3     (x_{3},y_{3})\,   and    (   x  4   ,   y  4   )      subscript  x  4    subscript  y  4     (x_{4},y_{4})\,   . 1  The intersection    P    P   P\,   of line     L  1      subscript  L  1    L_{1}\,   and     L  2      subscript  L  2    L_{2}\,   can be defined using determinants .        P  x   =    |      |      x  1      y  1        x  2      y  2      |      |      x  1     1       x  2     1     |             |      x  3      y  3        x  4      y  4      |      |      x  3     1       x  4     1     |      |    |      |      x  1     1       x  2     1     |      |      y  1     1       y  2     1     |             |      x  3     1       x  4     1     |      |      y  3     1       y  4     1     |      |       P  y   =    |      |      x  1      y  1        x  2      y  2      |      |      y  1     1       y  2     1     |             |      x  3      y  3        x  4      y  4      |      |      y  3     1       y  4     1     |      |    |      |      x  1     1       x  2     1     |      |      y  1     1       y  2     1     |             |      x  3     1       x  4     1     |      |      y  3     1       y  4     1     |      |        formulae-sequence     subscript  P  x              subscript  x  1    subscript  y  1      subscript  x  2    subscript  y  2           subscript  x  1   1     subscript  x  2   1       absent         subscript  x  3    subscript  y  3      subscript  x  4    subscript  y  4           subscript  x  3   1     subscript  x  4   1                 subscript  x  1   1     subscript  x  2   1          subscript  y  1   1     subscript  y  2   1       absent         subscript  x  3   1     subscript  x  4   1          subscript  y  3   1     subscript  y  4   1             subscript  P  y              subscript  x  1    subscript  y  1      subscript  x  2    subscript  y  2           subscript  y  1   1     subscript  y  2   1       absent         subscript  x  3    subscript  y  3      subscript  x  4    subscript  y  4           subscript  y  3   1     subscript  y  4   1                 subscript  x  1   1     subscript  x  2   1          subscript  y  1   1     subscript  y  2   1       absent         subscript  x  3   1     subscript  x  4   1          subscript  y  3   1     subscript  y  4   1            P_{x}=\frac{\begin{vmatrix}\begin{vmatrix}x_{1}&y;_{1}\\
 x_{2}&y;_{2}\end{vmatrix}&\begin{vmatrix}x_{1}&1\\
 x_{2}&1\end{vmatrix}\\
 \\
 \begin{vmatrix}x_{3}&y;_{3}\\
 x_{4}&y;_{4}\end{vmatrix}&\begin{vmatrix}x_{3}&1\\
 x_{4}&1\end{vmatrix}\end{vmatrix}}{\begin{vmatrix}\begin{vmatrix}x_{1}&1\\
 x_{2}&1\end{vmatrix}&\begin{vmatrix}y_{1}&1\\
 y_{2}&1\end{vmatrix}\\
 \\
 \begin{vmatrix}x_{3}&1\\
 x_{4}&1\end{vmatrix}&\begin{vmatrix}y_{3}&1\\
 y_{4}&1\end{vmatrix}\end{vmatrix}}\,\!\qquad P_{y}=\frac{\begin{vmatrix}\begin%
 {vmatrix}x_{1}&y;_{1}\\
 x_{2}&y;_{2}\end{vmatrix}&\begin{vmatrix}y_{1}&1\\
 y_{2}&1\end{vmatrix}\\
 \\
 \begin{vmatrix}x_{3}&y;_{3}\\
 x_{4}&y;_{4}\end{vmatrix}&\begin{vmatrix}y_{3}&1\\
 y_{4}&1\end{vmatrix}\end{vmatrix}}{\begin{vmatrix}\begin{vmatrix}x_{1}&1\\
 x_{2}&1\end{vmatrix}&\begin{vmatrix}y_{1}&1\\
 y_{2}&1\end{vmatrix}\\
 \\
 \begin{vmatrix}x_{3}&1\\
 x_{4}&1\end{vmatrix}&\begin{vmatrix}y_{3}&1\\
 y_{4}&1\end{vmatrix}\end{vmatrix}}\,\!     The determinants can be written out as:       (   P  x   ,   P  y   )   =  (     fragments   fragments  normal-(   subscript  P  x   normal-,   subscript  P  y   normal-)    normal-(    \displaystyle(P_{x},P_{y})=\bigg(     Note that the intersection point is for the infinitely long lines defined by the points, rather than the line segments between the points, and can produce an intersection point beyond the lengths of the line segments. If (rather than solving for the point in a single step), the solution in terms of first degree Bézier parameters is first found, then this intermediate result can be checked for 0.0 ≤ t ≤ 1.0 and 0.0 ≤ u ≤ 1.0 (where t and u are the driving variables).  When the two lines are parallel or coincident the denominator term is zero:         (    x  1   -   x  2    )    (    y  3   -   y  4    )    -    (    y  1   -   y  2    )    (    x  3   -   x  4    )     =   0  if the lines are parallel              subscript  x  1    subscript  x  2       subscript  y  3    subscript  y  4          subscript  y  1    subscript  y  2       subscript  x  3    subscript  x  4        0  if the lines are parallel     (x_{1}-x_{2})(y_{3}-y_{4})-(y_{1}-y_{2})(x_{3}-x_{4})=0\text{ if the lines are%
  parallel}     If the lines are very close to being parallel, then a computer solution may encounter numeric problems in the solution described above, and so recognition of this condition may require an appropriately "fuzzy" test in practical application. A more robust and general solution may be obtained by rotation of the line segments to drive one of them horizontal, whence the solution of the rotated parametric form of the second line is easily obtained. Careful discussion of the special cases is required (parallel lines/coincident lines, overlapping/non-overlapping intervals).  Given the equations of the lines  The   x   x   x   and   y   y   y   coordinates of the point of intersection of two non-vertical lines can easily be found using the following substitutions and rearrangements.  Suppose that two lines have the equations    y  =    a  x   +  c       y      a  x   c     y=ax+c   and    y  =    b  x   +  d       y      b  x   d     y=bx+d   where   a   a   a   and   b   b   b   are the slopes (gradients) of the lines and where   c   c   c   and   d   d   d   are the y -intercepts of the lines. At the point where the two lines intersect (if they do), both   y   y   y   coordinates will be the same, hence the following equality:        a  x   +  c   =    b  x   +  d           a  x   c       b  x   d     ax+c=bx+d   .  We can rearrange this expression in order to extract the value of   x   x   x   ,        a  x   -   b  x    =   d  -  c           a  x     b  x      d  c     ax-bx=d-c   , and so,      x  =    d  -  c    a  -  b        x      d  c     a  b      x=\frac{d-c}{a-b}   .  To find the y coordinate, all we need to do is substitute the value of x into either one of the two line equations, for example, into the first:      y  =    a    d  -  c    a  -  b     +  c       y      a      d  c     a  b     c     y=a\frac{d-c}{a-b}+c   .  Hence, the point of intersection is       P   (    d  -  c    a  -  b    ,    a    d  -  c    a  -  b     +  c   )    =   P   (    d  -  c    a  -  b    ,     a  d   -   b  c     a  -  b    )          P       d  c     a  b        a      d  c     a  b     c       P       d  c     a  b          a  d     b  c      a  b        P\left(\frac{d-c}{a-b},a\frac{d-c}{a-b}+c\right)=P\left(\frac{d-c}{a-b},\frac{%
 ad-bc}{a-b}\right)   . Note if a = b then the two lines are parallel . If c ≠ d as well, the lines are different and there is no intersection, otherwise the two lines are identical.  Using homogeneous coordinates  By using homogeneous coordinates , the intersection point of two implicitly defined lines can be determined quite easily. In 2D, every point can be defined as a projection of a 3D point, given as the ordered triple (X,Y,W). The mapping from 3D to 2D coordinates is (x,y) = (X/W, Y/W). 2D points can be converted to homogeneous coordinates by defining them as (x,y,1). Thus, the implicit equation of a line can be given in homogeneous coordinates as:        a  X   +   b  Y   +   c  W    =  0  ⇒     L   (  a  ,  b  ,  c  )    ⋅  P    (  X  ,  Y  ,  W  )    =  0            a  X     b  Y     c  W    0    normal-⇒       normal-⋅    L   a  b  c    P    X  Y  W         0     aX+bY+cW=0\Rightarrow L(a,b,c)\cdot P(X,Y,W)=0     We can do a similar operation with the cross product to get the intersection of 2 lines:         L   (   a  1   ,   b  1   ,   c  1   )    ×  L    (   a  2   ,   b  2   ,   c  2   )    =   P   (  X  ,  Y  ,  W  )              L    subscript  a  1    subscript  b  1    subscript  c  1     L     subscript  a  2    subscript  b  2    subscript  c  2       P   X  Y  W      L(a_{1},b_{1},c_{1})\times L(a_{2},b_{2},c_{2})=P(X,Y,W)     This returns the intersection point in homogeneous coordinates. In the special case of W = 0, we say that the intersection point is at infinity. This means the lines are parallel. As an aside, the implicit coefficients of a line can be obtained by the cross product of two points:         P   (   x  1   ,   y  1   ,   w  1   )    ×  P    (   x  2   ,   y  2   ,   w  2   )    =   L   (  a  ,  b  ,  c  )              P    subscript  x  1    subscript  y  1    subscript  w  1     P     subscript  x  2    subscript  y  2    subscript  w  2       L   a  b  c      P(x_{1},y_{1},w_{1})\times P(x_{2},y_{2},w_{2})=L(a,b,c)     n -line intersection  Existence of and expression for the intersection  In two dimensions  In two dimensions, more than two lines almost certainly do not intersect at a single point. To determine if they do and, if so, to find the intersection point, write the i -th equation ( i = 1, ..., n ) as       (   a   i  1     a   i  2    )     (  x  y  )   T    =   b  i    ,          subscript  a    i  1     subscript  a    i  2      superscript   x  y   T     subscript  b  i     (a_{i1}\quad a_{i2})(x\quad y)^{T}=b_{i},   and stack these equations into matrix form as        A  w   =  b   ,        A  w   b    Aw=b,     where the i -th row of the n × 2 matrix A is    (   a   i  1    ,   a   i  2    )      subscript  a    i  1     subscript  a    i  2      (a_{i1},a_{i2})   , w is the 2 × 1 vector ( x, y ) T , and the i -th element of the column vector b is b i . If A has independent columns, its rank is 2. Then if and only if the rank of the augmented matrix [ A | b ] is also 2, there exists a solution of the matrix equation and thus an intersection point of the n lines. The intersection point, if it exists, is given by       w  =    A  g   b   =     (    A  T   A   )    -  1     A  T   b    ,        w     superscript  A  g   b           superscript     superscript  A  T   A     1     superscript  A  T   b      w=A^{g}b=(A^{T}A)^{-1}A^{T}b,     where    A  g     superscript  A  g    A^{g}   is the Moore-Penrose generalized inverse of   A   A   A   (which has the form shown because A has full column rank). Alternatively, the solution can be found by jointly solving any two independent equations. But if the rank of A is only 1, then if the rank of the augmented matrix is 2 there is no solution but if its rank is 1 then all of the lines coincide with each other.  In three dimensions  The above approach can be readily extended to three dimensions. In three or more dimensions, even two lines almost certainly do not intersect; pairs of non-parallel lines that do not intersect are called skew lines . But if an intersection does exist it can be found, as follows.  In three dimensions a line is represented by the intersection of two planes, each of which has an equation of the form       (   a   i  1     a   i  2     a   i  3    )     (  x  y  z  )   T    =   b  i    .          subscript  a    i  1     subscript  a    i  2     subscript  a    i  3      superscript   x  y  z   T     subscript  b  i     (a_{i1}\quad a_{i2}\quad a_{i3})(x\quad y\quad z)^{T}=b_{i}.   Thus a set of n lines can be represented by 2 n equations in the 3-dimensional coordinate vector w = ( x , y , z ) T :       A  w   =  b        A  w   b    Aw=b     where now A is 2 n × 3 and b is 2 n × 1. As before there is a unique intersection point if and only if A has full column rank and the augmented matrix [ A | b ] does not, and the unique intersection if it exists is given by       w  =     (    A  T   A   )    -  1     A  T   b    .      w     superscript     superscript  A  T   A     1     superscript  A  T   b     w=(A^{T}A)^{-1}A^{T}b.     Nearest point to non-intersecting lines  In two or more dimensions, we can usually find a point that is mutually closest to two or more lines in a least-squares sense.  In two dimensions  In the two-dimensional case, first, represent line i as a point,    p  i     subscript  p  i    p_{i}   , on the line and a unit  normal vector ,     n  ^   i     subscript   normal-^  n   i    \hat{n}_{i}   , perpendicular to that line. That is, if    x  1     subscript  x  1    x_{1}   and    x  2     subscript  x  2    x_{2}   are points on line 1, then let     p  1   =   x  1        subscript  p  1    subscript  x  1     p_{1}=x_{1}   and let        n  ^   1   :=     [     0     -  1       1    0     ]    (    x  2   -   x  1    )    /   ∥    x  2   -   x  1    ∥       assign   subscript   normal-^  n   1         0    1     1  0       subscript  x  2    subscript  x  1      norm     subscript  x  2    subscript  x  1        \hat{n}_{1}:=\begin{bmatrix}0&-1\\
 1&0\end{bmatrix}(x_{2}-x_{1})/\|x_{2}-x_{1}\|     which is the unit vector along the line, rotated by 90 degrees.  Note that the distance from a point, x to the line    (  p  ,   n  ^   )     p   normal-^  n     (p,\hat{n})   is given by        d   (  x  ,   (  p  ,  n  )   )    =   ∥    (   x  -  p   )   ⋅   n  ^    ∥   =   ∥     (   x  -  p   )   ⊤    n  ^    ∥   =      (   x  -  p   )   ⊤    n  ^     n  ^   ⊤    (   x  -  p   )      .          d   x   p  n      norm   normal-⋅    x  p    normal-^  n           norm     superscript    x  p   top    normal-^  n               superscript    x  p   top    normal-^  n    superscript   normal-^  n   top     x  p        d(x,(p,n))=\|(x-p)\cdot\hat{n}\|=\|(x-p)^{\top}\hat{n}\|=\sqrt{(x-p)^{\top}%
 \hat{n}\hat{n}^{\top}(x-p)}.     And so the squared distance from a point, x , to a line is        d    (  x  ,   (  p  ,  n  )   )   2    =     (   x  -  p   )   ⊤    (    n  ^     n  ^   ⊤    )    (   x  -  p   )     .        d   superscript   x   p  n    2       superscript    x  p   top      normal-^  n    superscript   normal-^  n   top      x  p      d(x,(p,n))^{2}=(x-p)^{\top}(\hat{n}\hat{n}^{\top})(x-p).     The sum of squared distances to many lines is the cost function :        E   (  x  )    =    ∑  i      (   x  -   p  i    )   ⊤    (     n  ^   i     n  ^   i  ⊤    )    (   x  -   p  i    )      .        E  x     subscript   i      superscript    x   subscript  p  i    top      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top      x   subscript  p  i        E(x)=\sum_{i}(x-p_{i})^{\top}(\hat{n}_{i}\hat{n}_{i}^{\top})(x-p_{i}).     This can be rearranged:      E   (  x  )       E  x    \displaystyle E(x)     To find the minimum, we differentiate with respect to x and set the result equal to the zero vector:         ∂  E    (  x  )     ∂  x    =  0  =    2   (    ∑  i      n  ^   i     n  ^   i  ⊤     )   x   -   2   (    ∑  i      n  ^   i     n  ^   i  ⊤    p  i     )                 E   x     x    0           2    subscript   i      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top     x     2    subscript   i      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top    subscript  p  i          \frac{\partial E(x)}{\partial x}=0=2\left(\sum_{i}\hat{n}_{i}\hat{n}_{i}^{\top%
 }\right)x-2\left(\sum_{i}\hat{n}_{i}\hat{n}_{i}^{\top}p_{i}\right)     so        (    ∑  i      n  ^   i     n  ^   i  ⊤     )   x   =    ∑  i      n  ^   i     n  ^   i  ⊤    p  i             subscript   i      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top     x     subscript   i      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top    subscript  p  i       \left(\sum_{i}\hat{n}_{i}\hat{n}_{i}^{\top}\right)x=\sum_{i}\hat{n}_{i}\hat{n}%
 _{i}^{\top}p_{i}     and so       x  =     (    ∑  i      n  ^   i     n  ^   i  ⊤     )    -  1     (    ∑  i      n  ^   i     n  ^   i  ⊤    p  i     )     .      x     superscript    subscript   i      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top       1      subscript   i      subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top    subscript  p  i        x=\left(\sum_{i}\hat{n}_{i}\hat{n}_{i}^{\top}\right)^{-1}\left(\sum_{i}\hat{n}%
 _{i}\hat{n}_{i}^{\top}p_{i}\right).     In three dimensions  While     n  ^   i     subscript   normal-^  n   i    \hat{n}_{i}   is not well-defined in more than two dimensions, this can be generalized to any number of dimensions by noting that      n  ^   i     n  ^   i  ⊤        subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top     \hat{n}_{i}\hat{n}_{i}^{\top}   is simply the (symmetric) matrix with all eigenvalues unity except for a zero eigenvalue in the direction along the line providing a seminorm on the distance between    p  i     subscript  p  i    p_{i}   and another point giving the distance to the line. In any number of dimensions, if     v  ^   i     subscript   normal-^  v   i    \hat{v}_{i}   is a unit vector along the i -th line, then        n  ^   i     n  ^   i  ⊤        subscript   normal-^  n   i    superscript   subscript   normal-^  n   i   top     \hat{n}_{i}\hat{n}_{i}^{\top}   becomes    I  -     v  ^   i     v  ^   i  ⊤        I     subscript   normal-^  v   i    superscript   subscript   normal-^  v   i   top      I-\hat{v}_{i}\hat{v}_{i}^{\top}     where I is the identity matrix, and so       x  =     (     ∑  i   I   -     v  ^   i     v  ^   i  ⊤     )    -  1     (    ∑  i     (   I  -     v  ^   i     v  ^   i  ⊤     )    p  i     )     .      x     superscript      subscript   i   I      subscript   normal-^  v   i    superscript   subscript   normal-^  v   i   top       1      subscript   i       I     subscript   normal-^  v   i    superscript   subscript   normal-^  v   i   top      subscript  p  i        x=\left(\sum_{i}I-\hat{v}_{i}\hat{v}_{i}^{\top}\right)^{-1}\left(\sum_{i}(I-%
 \hat{v}_{i}\hat{v}_{i}^{\top})p_{i}\right).     See also   Line segment intersection  Line intersection in projective space  Distance from a point to a line  Parallel postulate   References    External links   Distance between Lines and Segments with their Closest Point of Approach , applicable to two, three, or more dimensions.   "  Category:Euclidean geometry  Category:Linear algebra  Category:Geometric algorithms     ↩     
   Machin-like formula      Machin-like formula   In mathematics , Machin-like formulae are a popular technique for computing π to a large number of digits . They are generalizations of John Machin 's formula from 1706:       π  4   =    4   arctan   1  5     -   arctan   1  239           π  4       4      1  5         1  239       \frac{\pi}{4}=4\arctan\frac{1}{5}-\arctan\frac{1}{239}     which he used to compute π to 100 decimal places.  Machin-like formulas have the form:  Where    a  n     subscript  a  n    a_{n}   and    b  n     subscript  b  n    b_{n}   are positive integers such that     a  n   <   b  n        subscript  a  n    subscript  b  n     a_{n}   ,    c  n     subscript  c  n    c_{n}   is a signed non-zero integer, and    c  0     subscript  c  0    c_{0}   is a positive integer.  These formulae are used in conjunction with the Taylor series expansion for arctangent :  Derivation  In Angle addition formula we learned the following equations:       sin   (   α  +  β   )    =     sin  α    cos  β    +    cos  α    sin  β             α  β          α     β        α     β       \sin(\alpha+\beta)=\sin\alpha\cos\beta+\cos\alpha\sin\beta          cos   (   α  +  β   )    =     cos  α    cos  β    -    sin  α    sin  β             α  β          α     β        α     β       \cos(\alpha+\beta)=\cos\alpha\cos\beta-\sin\alpha\sin\beta     Simple algebraic manipulations of these equations yield the following:  if        -   π  2    <    arctan    a  1    b  1     +   arctan    a  2    b  2      <   π  2    .            π  2           subscript  a  1    subscript  b  1          subscript  a  2    subscript  b  2             π  2      -\frac{\pi}{2}<\arctan\frac{a_{1}}{b_{1}}+\arctan\frac{a_{2}}{b_{2}}<\frac{\pi%
 }{2}.     All of the Machin-like formulae can be derived by repeated application of this equation. As an example, we show the derivation of Machin's original formula:      2   arctan   1  5        2      1  5      2\arctan\frac{1}{5}            =    arctan   1  5    +   arctan   1  5         absent        1  5        1  5       =\arctan\frac{1}{5}+\arctan\frac{1}{5}               =   arctan     1  *  5   +   1  *  5      5  *  5   -   1  *  1          absent          1  5     1  5        5  5     1  1        =\arctan\frac{1*5+1*5}{5*5-1*1}               =   arctan   10  24        absent      10  24      =\arctan\frac{10}{24}               =   arctan   5  12        absent      5  12      =\arctan\frac{5}{12}            4   arctan   1  5        4      1  5      4\arctan\frac{1}{5}            =    2   arctan   1  5     +   2   arctan   1  5          absent      2      1  5       2      1  5        =2\arctan\frac{1}{5}+2\arctan\frac{1}{5}               =    arctan   5  12    +   arctan   5  12         absent        5  12        5  12       =\arctan\frac{5}{12}+\arctan\frac{5}{12}               =   arctan     5  *  12   +   5  *  12      12  *  12   -   5  *  5          absent          5  12     5  12        12  12     5  5        =\arctan\frac{5*12+5*12}{12*12-5*5}               =   arctan   120  119        absent      120  119      =\arctan\frac{120}{119}             4   arctan   1  5     -   π  4         4      1  5       π  4     4\arctan\frac{1}{5}-\frac{\pi}{4}            =    4   arctan   1  5     -   arctan   1  1         absent      4      1  5         1  1       =4\arctan\frac{1}{5}-\arctan\frac{1}{1}               =    4   arctan   1  5     +   arctan    -  1   1         absent      4      1  5           1   1       =4\arctan\frac{1}{5}+\arctan\frac{-1}{1}               =    arctan   120  119    +   arctan    -  1   1         absent        120  119          1   1       =\arctan\frac{120}{119}+\arctan\frac{-1}{1}               =   arctan     120  *  1   +    (   -  1   )   *  119      119  *  1   -   120  *   (   -  1   )           absent          120  1       1   119        119  1     120    1         =\arctan\frac{120*1+(-1)*119}{119*1-120*(-1)}               =   arctan   1  239        absent      1  239      =\arctan\frac{1}{239}             π  4   =    4   arctan   1  5     -   arctan   1  239           π  4       4      1  5         1  239       \frac{\pi}{4}=4\arctan\frac{1}{5}-\arctan\frac{1}{239}     An insightful way to visualize equation  is to picture what happens when two complex numbers are multiplied together:       (    b  1   +    a  1   i    )   *   (    b  2   +    a  2   i    )          subscript  b  1      subscript  a  1   i       subscript  b  2      subscript  a  2   i      (b_{1}+a_{1}i)*(b_{2}+a_{2}i)            =      b  1    b  2    +    a  2    b  1   i   +    a  1    b  2   i    -    a  1    a  2         absent         subscript  b  1    subscript  b  2       subscript  a  2    subscript  b  1   i      subscript  a  1    subscript  b  2   i       subscript  a  1    subscript  a  2       =b_{1}b_{2}+a_{2}b_{1}i+a_{1}b_{2}i-a_{1}a_{2}         The angle associated with a complex number    (    b  n   +    a  n   i    )       subscript  b  n      subscript  a  n   i     (b_{n}+a_{n}i)   is given by:      arctan    a  n    b  n           subscript  a  n    subscript  b  n      \arctan\frac{a_{n}}{b_{n}}     Thus, in equation , the angle associated with the product is:      arctan      a  1    b  2    +    a  2    b  1        b  1    b  2    -    a  1    a  2                 subscript  a  1    subscript  b  2       subscript  a  2    subscript  b  1          subscript  b  1    subscript  b  2       subscript  a  1    subscript  a  2        \arctan\frac{a_{1}b_{2}+a_{2}b_{1}}{b_{1}b_{2}-a_{1}a_{2}}     Note that this is the same expression as occurs in equation . Thus equation  can be interpreted as saying that the act of multiplying two complex numbers is equivalent to adding their associated angles (see multiplication of complex numbers ).  The expression:       c  n    arctan    a  n    b  n          subscript  c  n        subscript  a  n    subscript  b  n       c_{n}\arctan\frac{a_{n}}{b_{n}}     is the angle associated with:       (    b  n   +    a  n   i    )    c  n      superscript     subscript  b  n      subscript  a  n   i     subscript  c  n     (b_{n}+a_{n}i)^{c_{n}}     Equation  can be re-written as:       k  *    (   1  +  i   )    c  0     =    ∏   n  =  1   N     (    b  n   +    a  n   i    )    c  n           k   superscript    1  i    subscript  c  0       superscript   subscript  product    n  1    N    superscript     subscript  b  n      subscript  a  n   i     subscript  c  n       k*(1+i)^{c_{0}}=\prod_{n=1}^{N}(b_{n}+a_{n}i)^{c_{n}}     Where   k   k   k   is an arbitrary constant that accounts for the difference in magnitude between the vectors on the two sides of the equation. The magnitudes can be ignored, only the angles are significant.  Using Complex Numbers  Other formulas may be generated using complex numbers. For example the angle of a complex number    (   a  +   b  i    )      a    b  i     (a+bi)   is given by    arctan   b  a         b  a     \arctan\frac{b}{a}   and when you multiply complex numbers you add their angles. If a=b then    arctan   b  a         b  a     \arctan\frac{b}{a}   is 45 degrees or    π  4      π  4    \frac{\pi}{4}   . This means that if the real part and complex part are equal then the arctangent will equal    π  4      π  4    \frac{\pi}{4}   . Since the arctangent of one has a very slow convergence rate if we find two complex numbers that when multiplied will result in the same real and imaginary part we will have a Machin-like formula. An example is    (   2  +  i   )      2  i    (2+i)   and    (   3  +  i   )      3  i    (3+i)   . If we multiply these out we will get    (   5  +   5  i    )      5    5  i     (5+5i)   . Therefore      arctan   1  2    +   arctan   1  3     =   π  4             1  2        1  3       π  4     \arctan\frac{1}{2}+\arctan\frac{1}{3}=\frac{\pi}{4}   .  If you want to use complex numbers to show that     π  4   =    4   arctan   1  5     -   arctan   1  239           π  4       4      1  5         1  239       \frac{\pi}{4}=4\arctan\frac{1}{5}-\arctan\frac{1}{239}   you first must know that when multiplying angles you put the complex number to the power of the number that you are multiplying by. So       (   5  +  i   )   4    (    -  239   +  i   )    =   -    2  2    (   13  4   )    (   1  +  i   )            superscript    5  i   4       239   i         superscript  2  2    superscript  13  4     1  i       (5+i)^{4}(-239+i)=-2^{2}(13^{4})(1+i)   and since the real part and imaginary part are equal then,      4   arctan   1  5     -   arctan   1  239     =   π  4           4      1  5         1  239       π  4     4\arctan\frac{1}{5}-\arctan\frac{1}{239}=\frac{\pi}{4}     Two-term formulas  In the special case where    a  n     subscript  a  n    a_{n}   is one, there are exactly four solutions having only two terms. 1 These are Euler 's:       π  4   =    arctan   1  2    +   arctan   1  3           π  4         1  2        1  3       \frac{\pi}{4}=\arctan\frac{1}{2}+\arctan\frac{1}{3}     Hermann's:       π  4   =    2   arctan   1  2     -   arctan   1  7           π  4       2      1  2         1  7       \frac{\pi}{4}=2\arctan\frac{1}{2}-\arctan\frac{1}{7}     Hutton's (or Vega's 2 ):       π  4   =    2   arctan   1  3     +   arctan   1  7           π  4       2      1  3         1  7       \frac{\pi}{4}=2\arctan\frac{1}{3}+\arctan\frac{1}{7}     and Machin's:       π  4   =    4   arctan   1  5     -   arctan   1  239           π  4       4      1  5         1  239       \frac{\pi}{4}=4\arctan\frac{1}{5}-\arctan\frac{1}{239}     In the general case, where the value of    a  n     subscript  a  n    a_{n}   is not restricted, there are countless other solutions. Example:  Example  The adjacent diagram demonstrates the relationship between the arctangents and their areas. From the diagram, we have the following:      area   (   P  O  N   )       area    P  O  N     \displaystyle{\rm area}(PON)     More terms  The 2002 record for digits of π, 1,241,100,000,000, was obtained by Yasumasa Kanada of Tokyo University . The Calculation was performed on a 64-node Hitachi  supercomputer with 1 terabyte of main memory, performing 2 trillion operations per second. The following two equations were both used:       π  4   =      12   arctan   1  49     +   32   arctan   1  57      -   5   arctan   1  239      +   12   arctan   1  110443            π  4           12      1  49       32      1  57        5      1  239        12      1  110443        \frac{\pi}{4}=12\arctan\frac{1}{49}+32\arctan\frac{1}{57}-5\arctan\frac{1}{239%
 }+12\arctan\frac{1}{110443}      Kikuo Takano (1982).        π  4   =      44   arctan   1  57     +   7   arctan   1  239      -   12   arctan   1  682      +   24   arctan   1  12943            π  4           44      1  57       7      1  239        12      1  682        24      1  12943        \frac{\pi}{4}=44\arctan\frac{1}{57}+7\arctan\frac{1}{239}-12\arctan\frac{1}{68%
 2}+24\arctan\frac{1}{12943}      F. C. M. Störmer (1896).   The most efficient currently known Machin-like formulas for computing π:        π  4    =         π  4   absent    \displaystyle\frac{\pi}{4}=      黃見利 (Hwang Chien-Lih) (1997).         π  4    =         π  4   absent    \displaystyle\frac{\pi}{4}=      黃見利 (Hwang Chien-Lih) (2003).         π  4    =         π  4   absent    \displaystyle\frac{\pi}{4}=      (M.Wetherfield) (2004).   Efficiency  It is not the goal of this section to estimate the actual run time of any given algorithm. Instead, the intention is merely to devise a relative metric by which two algorithms can be compared against each other.  Let    N  d     subscript  N  d    N_{d}   be the number of digits to which   π   π   \pi   is to be calculated.  Let    N  t     subscript  N  t    N_{t}   be the number of terms in the Taylor series (see equation ).  Let    u  n     subscript  u  n    u_{n}   be the amount of time spent on each digit (for each term in the Taylor series).  The Taylor series will converge when:        (    (    b  n    a  n    )   2   )    N  t    =   10   N  d         superscript   superscript     subscript  b  n    subscript  a  n    2    subscript  N  t     superscript  10   subscript  N  d      \left(\left(\frac{b_{n}}{a_{n}}\right)^{2}\right)^{N_{t}}=10^{N_{d}}     Thus:       N  t   =    N  d     ln  10    2   ln    b  n    a  n             subscript  N  t     subscript  N  d       10     2       subscript  b  n    subscript  a  n          N_{t}=N_{d}\quad\frac{\ln 10}{2\ln\frac{b_{n}}{a_{n}}}     For the first term in the Taylor series, all    N  d     subscript  N  d    N_{d}   digits must be processed. In the last term of the Taylor series, however, there's only one digit remaining to be processed. In all of the intervening terms, the number of digits to be processed can be approximated by linear interpolation. Thus the total is given by:        N  d    N  t    2         subscript  N  d    subscript  N  t    2    \frac{N_{d}N_{t}}{2}     The run time is given by:       t  i  m  e   =     u  n    N  d    N  t    2         t  i  m  e        subscript  u  n    subscript  N  d    subscript  N  t    2     time=\frac{u_{n}N_{d}N_{t}}{2}     Combining equations, the run time is given by:       t  i  m  e   =     u  n    N  d    2    ln  10     4   ln    b  n    a  n       =    k   u  n     ln    b  n    a  n              t  i  m  e        subscript  u  n    superscript   subscript  N  d   2     10      4       subscript  b  n    subscript  a  n                k   subscript  u  n         subscript  b  n    subscript  a  n         time=\frac{u_{n}{N_{d}}^{2}\ln 10}{4\ln\frac{b_{n}}{a_{n}}}=\frac{ku_{n}}{\ln%
 \frac{b_{n}}{a_{n}}}     Where   k   k   k   is a constant that combines all of the other constants. Since this is a relative metric, the value of   k   k   k   can be ignored.  The total time, across all the terms of equation , is given by:       t  i  m  e   =    ∑   n  =  1   N     u  n    ln    b  n    a  n             t  i  m  e     superscript   subscript     n  1    N      subscript  u  n        subscript  b  n    subscript  a  n         time=\sum_{n=1}^{N}\frac{u_{n}}{\ln\frac{b_{n}}{a_{n}}}       u  n     subscript  u  n    u_{n}   cannot be modelled accurately without detailed knowledge of the specific software. Regardless, we present one possible model.  The software spends most of its time evaluating the Taylor series from equation . The primary loop can be summarized in the following pseudo code:        1  :  t  e  r  m  *  =   a  n    2      fragments  1  normal-:   t  e  r  m       superscript   subscript  a  n   2     1:\quad term\quad*=\quad{a_{n}}^{2}              2  :  t  e  r  m  /  =  -   b  n    2      fragments  2  normal-:   t  e  r  m        superscript   subscript  b  n   2     2:\quad term\quad/=\quad-{b_{n}}^{2}              3  :  t  m  p  =  t  e  r  m  /   (  2  *  n  +  1  )      fragments  3  normal-:   t  m  p     t  e  r  m      fragments  normal-(  2   n   1  normal-)     3:\quad tmp\quad=\quad term\quad/\quad(2*n+1)              4  :  s  u  m  +  =  t  m  p     fragments  4  normal-:   s  u  m      t  m  p    4:\quad sum\quad+=\quad tmp        In this particular model, it is assumed that each of these steps takes approximately the same amount of time. Depending on the software used, this may be a very good approximation or it may be a poor one.  The unit of time is defined such that one step of the pseudo code corresponds to one unit. To execute the loop, in its entirety, requires four units of time.    u  n     subscript  u  n    u_{n}   is defined to be four.  Note, however, that if    a  n     subscript  a  n    a_{n}   is equal to one, then step one can be skipped. The loop only takes three units of time.    u  n     subscript  u  n    u_{n}   is defined to be three.  As an example, consider the equation:  The following table shows the estimated time for each of the terms:          a  n     subscript  a  n    a_{n}          b  n     subscript  b  n    b_{n}           b  n    a  n        subscript  b  n    subscript  a  n     \frac{b_{n}}{a_{n}}          ln    b  n    a  n           subscript  b  n    subscript  a  n      \ln\frac{b_{n}}{a_{n}}          u  n     subscript  u  n    u_{n}          t  i  m  e      t  i  m  e    time          74684   14967113   200.41   5.3003   4   0.75467     1   239   239.00   5.4765   3   0.54780     20138   15351991   762.34   6.6364   4   0.60274     The total time is 0.75467 + 0.54780 + 0.60274 = 1.9052  Compare this with equation . The following table shows the estimated time for each of the terms:          a  n     subscript  a  n    a_{n}          b  n     subscript  b  n    b_{n}           b  n    a  n        subscript  b  n    subscript  a  n     \frac{b_{n}}{a_{n}}          ln    b  n    a  n           subscript  b  n    subscript  a  n      \ln\frac{b_{n}}{a_{n}}          u  n     subscript  u  n    u_{n}          t  i  m  e      t  i  m  e    time          24478   873121   35.670   3.5743   4   1.1191     685601   69049993   100.71   4.6123   4   0.8672     The total time is 1.1191 + 0.8672 = 1.9863  The conclusion, based on this particular model, is that equation  is slightly faster than equation , regardless of the fact that equation  has more term(s). This result is typical of the general trend. The dominant factor is the ratio between    a  n     subscript  a  n    a_{n}   and    b  n     subscript  b  n    b_{n}   . In order to achieve a high ratio, it is necessary to add additional terms. Often, there's a net savings in time.  References  External links    The constant π  Machin's Merit at MathPages  Archimedes' constant pi - Machin's formula gives a proof for the John Machin`s formula   "  Category:Pi algorithms     ↩      
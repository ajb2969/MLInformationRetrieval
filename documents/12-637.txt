   Transfer-matrix method (optics)      Transfer-matrix method (optics)   (Figure)  Propagation of a ray through a layer   The transfer-matrix method is a method used in optics and acoustics to analyze the propagation of electromagnetic or acoustic waves through a stratified (layered) medium. 1 This is for example relevant for the design of anti-reflective coatings and dielectric mirrors .  The reflection of light from a single interface between two media is described by the Fresnel equations . However, when there are multiple interfaces , such as in the figure, the reflections themselves are also partially transmitted and then partially reflected. Depending on the exact path length, these reflections can interfere destructively or constructively. The overall reflection of a layer structure is the sum of an infinite number of reflections, which is cumbersome to calculate.  The transfer-matrix method is based on the fact that, according to Maxwell's equations , there are simple continuity conditions for the electric field across boundaries from one medium to the next. If the field is known at the beginning of a layer, the field at the end of the layer can be derived from a simple matrix operation. A stack of layers can then be represented as a system matrix, which is the product of the individual layer matrices. The final step of the method involves converting the system matrix back into reflection and transmission coefficients .  Formalism for electromagnetic waves  Below is described how the transfer matrix is applied to electromagnetic waves (for example light) of a given frequency propagating through a stack of layers at normal incidence . It can be generalized to deal with incidence at an angle, absorbing media , and media with magnetic properties . We assume that the stack layers are normal to the    z    z   z\,   axis and that the field within one layer can be represented as the superposition of a left- and right-traveling wave with wave number     k    k   k\,   ,       E   (  z  )    =     E  r    e   i  k  z     +    E  l     e   -   i  k  z              E  z        subscript  E  r    superscript  e    i  k  z        subscript  E  l    superscript  e      i  k  z         E(z)=E_{r}e^{ikz}+E_{l}e^{-ikz}\,   . Because it follows from Maxwell's equation that    E    E   E\,   and    F  =     d  E   /  d    z        F        d  E   d   z     F=dE/dz\,   must be continuous across a boundary, it is convenient to represent the field as the vector    (   E   (  z  )    ,   F   (  z  )    )       E  z     F  z     (E(z),F(z))\,   , where       F   (  z  )    =    i  k   E  r    e   i  k  z     -   i  k   E  l     e   -   i  k  z              F  z       i  k   subscript  E  r    superscript  e    i  k  z       i  k   subscript  E  l    superscript  e      i  k  z         F(z)=ikE_{r}e^{ikz}-ikE_{l}e^{-ikz}\,   . Since there are two equations relating    E    E   E\,   and    F    F   F\,   to     E  r      subscript  E  r    E_{r}\,   and     E  l      subscript  E  l    E_{l}\,   , these two representations are equivalent. In the new representation, propagation over a distance    L    L   L\,   into the positive    z    z   z\,   direction is described by the matrix       M  =   (      cos   k  L        1  k    sin   k  L          -   k   sin   k  L         cos   k  L       )    ,      M        k  L        1  k       k  L           k      k  L          k  L        M=\left(\begin{array}[]{cc}\cos kL&\frac{1}{k}\sin kL\\
 -k\sin kL&\cos kL\end{array}\right),   and       (      E   (   z  +  L   )         F   (   z  +  L   )       )   =   M  ⋅   (      E   (  z  )         F   (  z  )       )            E    z  L        F    z  L       normal-⋅  M      E  z       F  z        \left(\begin{array}[]{c}E(z+L)\\
 F(z+L)\end{array}\right)=M\cdot\left(\begin{array}[]{c}E(z)\\
 F(z)\end{array}\right)   Such a matrix can represent propagation through a layer if    k    k   k\,   is the wave number in the medium and    L    L   L\,   the thickness of the layer: For a system with    N    N   N\,   layers, each layer    j    j   j\,   has a transfer matrix     M  j      subscript  M  j    M_{j}\,   , where    j    j   j\,   increases towards higher    z    z   z\,   values. The system transfer matrix is then        M  s   =    M  N   ⋅  …  ⋅   M  2   ⋅   M  1     .       subscript  M  s    normal-⋅   subscript  M  N   normal-…   subscript  M  2    subscript  M  1      M_{s}=M_{N}\cdot\ldots\cdot M_{2}\cdot M_{1}.     Typically, one would like to know the reflectance and transmittance of the layer structure. If the layer stack starts at    z  =   0       z  0    z=0\,   , then for negative    z    z   z\,   , the field is described as          E  L    (  z  )    =     E  0    e   i   k  L   z     +   r   E  0    e   -   i   k  L   z        ,   z  <  0    ,     formulae-sequence       subscript  E  L   z        subscript  E  0    superscript  e    i   subscript  k  L   z       r   subscript  E  0    superscript  e      i   subscript  k  L   z          z  0     E_{L}(z)=E_{0}e^{ik_{L}z}+rE_{0}e^{-ik_{L}z},\qquad z<0,   where     E  0      subscript  E  0    E_{0}\,   is the amplitude of the incoming wave,     k  L      subscript  k  L    k_{L}\,   the wave number in the left medium, and    r    r   r\,   is the amplitude (not intensity!) reflectance coefficient of the layer structure. On the other side of the layer structure, the field consists of a right-propagating transmitted field          E  R    (  z  )    =   t   E  0    e   i   k  R   z      ,   z  >   L  ′     ,     formulae-sequence       subscript  E  R   z     t   subscript  E  0    superscript  e    i   subscript  k  R   z        z   superscript  L  normal-′      E_{R}(z)=tE_{0}e^{ik_{R}z},\qquad z>L^{\prime},   where    t    t   t\,   is the amplitude transmittance,     k  R      subscript  k  R    k_{R}\,   is the wave number in the rightmost medium, and    L  ′     superscript  L  normal-′    L^{\prime}   is the total thickness. If     F  L   =     d   E  L    /  d    z         subscript  F  L         d   subscript  E  L    d   z     F_{L}=dE_{L}/dz\,   and     F  R   =     d   E  R    /  d    z         subscript  F  R         d   subscript  E  R    d   z     F_{R}=dE_{R}/dz\,   , then we can solve       (      E   (   z  R   )         F   (   z  R   )       )   =   M  ⋅   (      E   (  0  )         F   (  0  )       )            E   subscript  z  R        F   subscript  z  R       normal-⋅  M      E  0       F  0        \left(\begin{array}[]{c}E(z_{R})\\
 F(z_{R})\end{array}\right)=M\cdot\left(\begin{array}[]{c}E(0)\\
 F(0)\end{array}\right)   in terms of the matrix elements     M   m  n       subscript  M    m  n     M_{mn}\,   of the system matrix     M  s      subscript  M  s    M_{s}\,   and obtain      t  =   2  i   k  L    e   -   i   k  R   L      [      M  11    M  22    -    M  12    M  21       -   M  21    +    k  L    k  R    M  12    +   i   (     k  R    M  11    +    k  L    M  22     )      ]        t    2  i   subscript  k  L    superscript  e      i   subscript  k  R   L      delimited-[]         subscript  M  11    subscript  M  22       subscript  M  12    subscript  M  21          subscript  M  21       subscript  k  L    subscript  k  R    subscript  M  12      i       subscript  k  R    subscript  M  11       subscript  k  L    subscript  M  22            t=2ik_{L}e^{-ik_{R}L}\left[\frac{M_{11}M_{22}-M_{12}M_{21}}{-M_{21}+k_{L}k_{R}%
 M_{12}+i(k_{R}M_{11}+k_{L}M_{22})}\right]     and      r  =   [     (    M  21   +    k  L    k  R    M  12     )   +   i   (     k  L    M  22    -    k  R    M  11     )       (    -   M  21    +    k  L    k  R    M  12     )   +   i   (     k  L    M  22    +    k  R    M  11     )      ]       r   delimited-[]         subscript  M  21      subscript  k  L    subscript  k  R    subscript  M  12       i       subscript  k  L    subscript  M  22       subscript  k  R    subscript  M  11              subscript  M  21       subscript  k  L    subscript  k  R    subscript  M  12       i       subscript  k  L    subscript  M  22       subscript  k  R    subscript  M  11           r=\left[\frac{(M_{21}+k_{L}k_{R}M_{12})+i(k_{L}M_{22}-k_{R}M_{11})}{(-M_{21}+k%
 _{L}k_{R}M_{12})+i(k_{L}M_{22}+k_{R}M_{11})}\right]   .  The transmittance and reflectance (i.e., the fractions of the incident intensity     |   E  0   |   2     superscript     subscript  E  0    2    \left|E_{0}\right|^{2}   transmitted and reflected by the layer) are often of more practical use and are given by    T  =     |  t  |   2        T   superscript    t   2     T=|t|^{2}\,   and    R  =     |  r  |   2        R   superscript    r   2     R=|r|^{2}\,   , respectively (at normal incidence).  Example  As an illustration, consider a single layer of glass with a refractive index n and thickness d suspended in air at a wave number k (in air). In glass, the wave number is     k  ′   =   n   k         superscript  k  normal-′     n  k     k^{\prime}=nk\,   . The transfer matrix is      M  =   (      cos    k  ′   d        sin   (    k  ′   d   )    /   k  ′         -    k  ′    sin    k  ′   d         cos    k  ′   d       )       M         superscript  k  normal-′   d           superscript  k  normal-′   d     superscript  k  normal-′           superscript  k  normal-′        superscript  k  normal-′   d           superscript  k  normal-′   d        M=\left(\begin{array}[]{cc}\cos k^{\prime}d&\sin(k^{\prime}d)/k^{\prime}\\
 -k^{\prime}\sin k^{\prime}d&\cos k^{\prime}d\end{array}\right)   . The amplitude reflection coefficient can be simplified to      r  =     (    1  /  n   -  n   )    sin    k  ′   d        (   n  +   1  /  n    )    sin    k  ′   d     +   2  i   cos   (    k  ′   d   )           r          1  n   n        superscript  k  normal-′   d           n    1  n         superscript  k  normal-′   d       2  i       superscript  k  normal-′   d         r=\frac{(1/n-n)\sin k^{\prime}d}{(n+1/n)\sin k^{\prime}d+2i\cos(k^{\prime}d)}   . This configuration effectively describes a Fabry–Pérot interferometer or etalon: for      k  ′   d   =   0  ,  π  ,   2  π   ,   ⋯           superscript  k  normal-′   d    0  π    2  π   normal-⋯     k^{\prime}d=0,\pi,2\pi,\cdots\,   , the reflection vanishes.  Acoustic waves  It is possible to apply the transfer-matrix method to sound waves. Instead of the electric field E and its derivative F , the displacement u and the stress     σ  =     C  d  u   /  d   z       σ        C  d  u   d   z     \sigma=Cdu/dz   , where   C   C   C   is the p-wave modulus , should be used.  Abeles matrix formalism  The Abeles matrix method is a computationally fast and easy way to calculate the specular reflectivity from a stratified interface, as a function of the perpendicular momentum transfer , Q z .        Q  z   =     4  π   λ    sin  θ    =   2   k  z           subscript  Q  z         4  π   λ     θ           2   subscript  k  z       Q_{z}=\frac{4\pi}{\lambda}\sin\theta=2k_{z}      {{-}}  Where θ is the angle of incidence/reflection of the incident radiation and λ is the wavelength of the radiation. The measured reflectivity depends on the variation in the scattering length density (SLD) profile, ( ρ ( z )) perpendicular to the interface. Although the scattering length density profile is normally a continuously varying function, the interfacial structure can often be well approximated by a slab model in which layers of thickness ( d n ), scattering length density ( ρ n ) and roughness (σ n,n+1 ) are sandwiched between the super- and sub-phases. One then uses a refinement procedure to minimise the differences between the theoretical and measured reflectivity curves, by changing the parameters that describe each layer.  In this description the interface is split into n layers. Since the incident neutron beam is refracted by each of the layers the wavevector, k , in layer n , is given by:        k  n   =     k  z    2   -   4  π   (    ρ  n   -   ρ  0    )           subscript  k  n        superscript   subscript  k  z   2     4  π     subscript  ρ  n    subscript  ρ  0         k_{n}=\sqrt{{k_{z}}^{2}-4\pi({\rho}_{n}-{\rho}_{0})}      The Fresnel reflection coefficient between layer n and n+1 is then given by:        r   n  ,   n  +  1     =     k  n   -   k   n  +  1       k  n   +   k   n  +  1           subscript  r   n    n  1          subscript  k  n    subscript  k    n  1        subscript  k  n    subscript  k    n  1        r_{n,n+1}=\frac{k_{n}-k_{n+1}}{k_{n}+k_{n+1}}      Since the interface between each layer is unlikely to be perfectly smooth the roughness/diffuseness of each interface modifies the Fresnel coefficient and is accounted for by an error function , as described by Nevot and Croce (1980) .        r   n  ,   n  +  1     =      k  n   -   k   n  +  1       k  n   +   k   n  +  1       exp   (   -   2   k  n    k   n  +  1     σ   n  ,   n  +  1      2     )          subscript  r   n    n  1            subscript  k  n    subscript  k    n  1        subscript  k  n    subscript  k    n  1            2   subscript  k  n    subscript  k    n  1     superscript   subscript  σ   n    n  1     2         r_{n,n+1}=\frac{k_{n}-k_{n+1}}{k_{n}+k_{n+1}}\exp(-2k_{n}k_{n+1}{\sigma_{n,n+1%
 }}^{2})      A phase factor, β is introduced, which accounts for the thickness of each layer.        β  0   =  0       subscript  β  0   0    \beta_{0}=0            β  n   =   i   k  n    d  n         subscript  β  n     i   subscript  k  n    subscript  d  n      \beta_{n}=ik_{n}d_{n}      where     i  2   =   -  1        superscript  i  2     1     i^{2}=-1   . A characteristic matrix, c n is then calculated for each layer.        c  n   =   [      exp   (   β  n   )        r   n  ,   n  +  1      exp   (   β  n   )           r   n  ,   n  +  1      exp   (   -   β  n    )        exp   (   -   β  n    )       ]        subscript  c  n    delimited-[]       subscript  β  n       subscript  r   n    n  1        subscript  β  n          subscript  r   n    n  1          subscript  β  n           subscript  β  n          c_{n}=\left[\begin{array}[]{cc}\exp\left(\beta_{n}\right)&r_{n,n+1}\exp\left(%
 \beta_{n}\right)\\
 r_{n,n+1}\exp\left(-\beta_{n}\right)&\exp\left(-\beta_{n}\right)\end{array}\right]      The resultant matrix is defined as the product of these characteristic matrices       M  =    ∏  n    c  n        M    subscript  product  n    subscript  c  n      M=\prod_{n}c_{n}       from which the reflectivity is calculated       R  =    |    M  10    M  00    |   2       R   superscript       subscript  M  10    subscript  M  00     2     R=\left|\frac{M_{10}}{M_{00}}\right|^{2}      See also   Neutron reflectometry  Ellipsometry  X-ray reflectivity   References    Abeles matrix formalism   O. S. Heavens. Optical Properties of Thin Films . Butterworth, London (1955).  L. Nevot, P. Croce, Revue de physique appliquée , 15 , 761 (1980).  F. Abeles, Le Journal de Physique et le Radium , "La théorie générale des couches minces", 11 , 307–310 (1950).   External links  Derivations and explanations   Lecture notes by Dr. Raymond C. Rumpf , see Lectures 2-5 here . These include course notes with detailed derivations and explanations, recorded lectures, and other resources to help you develop your own TMM codes.  Lecture notes by Bo Sernelius , see Lecture 13 . This derivation is more general than the one above, including light that is incident at a non-normal angle, and with specific light polarizations .  Manual for a transfer-matrix calculating program lists and explains the equations used, including formulas to calculate the absorption and Poynting vector at any given point.  A self-contained first-principles derivation of the transmission and reflection probabilities from a multilayer with complex indices of refraction.   Computer programs  There are a number of computer programs that implement this calculation:   FreeSnell is a stand-alone computer program that implements the transfer-matrix method, including more advanced aspects such as granular films.  Thinfilm is a web interface that implements the transfer-matrix method, outputting reflection and transmission coefficients, and also ellipsometric parameters Psi and Delta.  Luxpop.com is another web interface that implements the transfer-matrix method.  Transfer-matrix calculating programs in Python and in Mathematica .  EMPy ("Electromagnetic Python") software .  motofit is a program for analysing neutron and X-ray reflectometry data.  OpenFilters is a program for designing optical filters.  Py_matrix is an open source Python code that implements the transfer-matrix method for multilayers with arbitrary dielectric tensors. It was especially created for plasmonic and magnetoplasmonic calculations.   "  Category:Physical optics  Category:Neutron-related techniques  Category:Scattering theory  Category:Electromagnetism     Born, M.; Wolf, E., Principles of optics: electromagnetic theory of propagation, interference and diffraction of light . Oxford, Pergamon Press, 1964. ↩     
   Pépin's test      Pépin's test   In mathematics , Pépin's test is a primality test , which can be used to determine whether a Fermat number is prime . It is a variant of Proth's test . The test is named for a French mathematician, Théophile Pépin .  Description of the test  Let     F  n   =    2   2  n    +  1        subscript  F  n      superscript  2   superscript  2  n    1     F_{n}=2^{2^{n}}+1   be the n th Fermat number. Pépin's test states that for n > 0,      F  n     subscript  F  n    F_{n}   is prime if and only if      3    (    F  n   -  1   )   /  2    ≡    -  1      (   mod   F  n    )     .       superscript  3       subscript  F  n   1   2     annotated    1    pmod   subscript  F  n       3^{(F_{n}-1)/2}\equiv-1\;\;(\mathop{{\rm mod}}F_{n}).   The expression    3    (    F  n   -  1   )   /  2      superscript  3       subscript  F  n   1   2     3^{(F_{n}-1)/2}   can be evaluated modulo    F  n     subscript  F  n    F_{n}   by repeated squaring . This makes the test a fast polynomial-time algorithm. However, Fermat numbers grow so rapidly that only a handful of Fermat numbers can be tested in a reasonable amount of time and space.  Other bases may be used in place of 3, for example 5, 6, 7, or 10 .  Proof of correctness  Sufficiency: assume that the congruence       3    (    F  n   -  1   )   /  2    ≡    -  1      (   mod   F  n    )         superscript  3       subscript  F  n   1   2     annotated    1    pmod   subscript  F  n       3^{(F_{n}-1)/2}\equiv-1\;\;(\mathop{{\rm mod}}F_{n})   holds. Then     3    F  n   -  1    ≡   1     (   mod   F  n    )         superscript  3     subscript  F  n   1     annotated  1   pmod   subscript  F  n       3^{F_{n}-1}\equiv 1\;\;(\mathop{{\rm mod}}F_{n})   , thus the multiplicative order of 3 modulo    F  n     subscript  F  n    F_{n}   divides      F  n   -  1   =   2   2  n           subscript  F  n   1    superscript  2   superscript  2  n      F_{n}-1=2^{2^{n}}   , which is a power of two. On the other hand, the order does not divide     (    F  n   -  1   )   /  2         subscript  F  n   1   2    (F_{n}-1)/2   , and therefore it must be equal to     F  n   -  1       subscript  F  n   1    F_{n}-1   . In particular, there are at least     F  n   -  1       subscript  F  n   1    F_{n}-1   numbers below    F  n     subscript  F  n    F_{n}   coprime to    F  n     subscript  F  n    F_{n}   , and this can happen only if    F  n     subscript  F  n    F_{n}   is prime.  Necessity: assume that    F  n     subscript  F  n    F_{n}   is prime. By Euler's criterion ,       3    (    F  n   -  1   )   /  2    ≡    (   3   F  n    )      (   mod   F  n    )         superscript  3       subscript  F  n   1   2     annotated    3   subscript  F  n     pmod   subscript  F  n       3^{(F_{n}-1)/2}\equiv\left(\frac{3}{F_{n}}\right)\;\;(\mathop{{\rm mod}}F_{n})   , where    (   3   F  n    )      3   subscript  F  n     \left(\frac{3}{F_{n}}\right)   is the Legendre symbol . By repeated squaring, we find that     2   2  n    ≡   1     (   mod  3   )         superscript  2   superscript  2  n     annotated  1   pmod  3      2^{2^{n}}\equiv 1\;\;(\mathop{{\rm mod}}3)   , thus     F  n   ≡   2     (   mod  3   )         subscript  F  n    annotated  2   pmod  3      F_{n}\equiv 2\;\;(\mathop{{\rm mod}}3)   , and     (    F  n   3   )   =   -  1          subscript  F  n   3     1     \left(\frac{F_{n}}{3}\right)=-1   . As     F  n   ≡   1     (   mod  4   )         subscript  F  n    annotated  1   pmod  4      F_{n}\equiv 1\;\;(\mathop{{\rm mod}}4)   , we conclude     (   3   F  n    )   =   -  1         3   subscript  F  n      1     \left(\frac{3}{F_{n}}\right)=-1   from the law of quadratic reciprocity .  Historical Pépin tests  Because of the sparsity of the Fermat numbers, the Pépin test has only been run eight times (on Fermat numbers whose primality statuses were not already known). 1 2 3 Mayer, Papadopoulos and Crandall speculate that in fact, because of the size of the still undetermined Fermat numbers, it will take decades before technology allows any more Pépin tests to be run. 4 the smallest untested Fermat number with no known prime factor is    F  33     subscript  F  33    F_{33}   which has 2,585,827,973 digits.      Year   Provers   Fermat number   Pépin test result   Factor found later?       1905   Morehead & Western       F  7     subscript  F  7    F_{7}      composite   Yes (1970)     1909   Morehead & Western       F  8     subscript  F  8    F_{8}      composite   Yes (1980)     1952   Robinson       F  10     subscript  F  10    F_{10}      composite   Yes (1953)     1960   Paxson       F  13     subscript  F  13    F_{13}      composite   Yes (1974)     1961   Selfridge & Hurwitz       F  14     subscript  F  14    F_{14}      composite   Yes (2010)     1987   Buell & Young       F  20     subscript  F  20    F_{20}      composite   No     1993   Crandall , Doenias, Norrie & Young       F  22     subscript  F  22    F_{22}      composite   Yes (2010)     1999   Mayer, Papadopoulos & Crandall       F  24     subscript  F  24    F_{24}      composite   No       Notes  References   P. Pépin, Sur la formule     2   2  n    +  1       superscript  2   superscript  2  n    1    2^{2^{n}}+1    , Comptes Rendus Acad. Sci. Paris 85 (1877), pp. 329–333.   External links   The Prime Glossary: Pepin's test   "  Category:Primality tests     Conjecture 4. Fermat primes are finite - Pepin tests story, according to Leonid Durman ↩  Wilfrid Keller: Fermat factoring status ↩  R. M. Robinson (1954): Mersenne and Fermat numbers ↩  Richard E. Crandall, Ernst W. Mayer & Jason S. Papadopoulos, The twenty-fourth Fermat number is composite (2003) ↩     
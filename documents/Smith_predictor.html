<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1187">Smith predictor</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Smith predictor</h1>
<hr/>

<p>The <strong>Smith predictor</strong> (invented by <a href="Otto_J._M._Smith" title="wikilink">O. J. M. Smith</a> in 1957) is a type of predictive <a href="Controller_(control_theory)" title="wikilink">controller</a> for systems with pure time delay. The idea can be illustrated as follows.</p>

<p>Suppose the plant consists of 

<math display="inline" id="Smith_predictor:0">
<semantics>
<mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>G</ci>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   G(z)
  </annotation>
</semantics>
</math>

 followed by a pure time delay 

<math display="inline" id="Smith_predictor:1">
<semantics>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   z^{-k}
  </annotation>
</semantics>
</math>

.</p>

<p>As a first step, suppose we only consider 

<math display="inline" id="Smith_predictor:2">
<semantics>
<mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>G</ci>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   G(z)
  </annotation>
</semantics>
</math>

 (the plant without a delay) and design a controller 

<math display="inline" id="Smith_predictor:3">
<semantics>
<mrow>
<mi>C</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>C</ci>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   C(z)
  </annotation>
</semantics>
</math>

 with a <a href="closed-loop_transfer_function" title="wikilink">closed-loop transfer function</a>
<math display="inline" id="Smith_predictor:4">
<semantics>
<mrow>
<mrow>
<mi>H</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mfrac>
<mrow>
<mi>C</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mrow>
<mn>1</mn>
<mo>+</mo>
<mrow>
<mi>C</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</mfrac>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<times></times>
<ci>H</ci>
<ci>z</ci>
</apply>
<apply>
<divide></divide>
<apply>
<times></times>
<ci>C</ci>
<ci>z</ci>
<ci>G</ci>
<ci>z</ci>
</apply>
<apply>
<plus></plus>
<cn type="integer">1</cn>
<apply>
<times></times>
<ci>C</ci>
<ci>z</ci>
<ci>G</ci>
<ci>z</ci>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   H(z)=\frac{C(z)G(z)}{1+C(z)G(z)}
  </annotation>
</semantics>
</math>

 that we consider satisfactory.</p>

<p>Next, our objective is to design a controller 

<math display="inline" id="Smith_predictor:5">
<semantics>
<mrow>
<mover accent="true">
<mi>C</mi>
<mo stretchy="false">¯</mo>
</mover>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<apply>
<ci>normal-¯</ci>
<ci>C</ci>
</apply>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \bar{C}(z)
  </annotation>
</semantics>
</math>

 for the plant 

<math display="inline" id="Smith_predictor:6">
<semantics>
<mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>G</ci>
<ci>z</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   G(z)z^{-k}
  </annotation>
</semantics>
</math>

 so that the closed loop transfer function 

<math display="inline" id="Smith_predictor:7">
<semantics>
<mrow>
<mover accent="true">
<mi>H</mi>
<mo stretchy="false">¯</mo>
</mover>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<apply>
<ci>normal-¯</ci>
<ci>H</ci>
</apply>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \bar{H}(z)
  </annotation>
</semantics>
</math>

 equals 

<math display="inline" id="Smith_predictor:8">
<semantics>
<mrow>
<mi>H</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>H</ci>
<ci>z</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   H(z)z^{-k}
  </annotation>
</semantics>
</math>

.</p>

<p>Solving 

<math display="inline" id="Smith_predictor:9">
<semantics>
<mrow>
<mfrac>
<mrow>
<mover accent="true">
<mi>C</mi>
<mo stretchy="false">¯</mo>
</mover>
<mi>G</mi>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<mrow>
<mn>1</mn>
<mo>+</mo>
<mrow>
<mover accent="true">
<mi>C</mi>
<mo stretchy="false">¯</mo>
</mover>
<mi>G</mi>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
</mrow>
</mfrac>
<mo>=</mo>
<mrow>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
<mfrac>
<mrow>
<mi>C</mi>
<mi>G</mi>
</mrow>
<mrow>
<mn>1</mn>
<mo>+</mo>
<mrow>
<mi>C</mi>
<mi>G</mi>
</mrow>
</mrow>
</mfrac>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<ci>normal-¯</ci>
<ci>C</ci>
</apply>
<ci>G</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
<apply>
<plus></plus>
<cn type="integer">1</cn>
<apply>
<times></times>
<apply>
<ci>normal-¯</ci>
<ci>C</ci>
</apply>
<ci>G</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
<apply>
<divide></divide>
<apply>
<times></times>
<ci>C</ci>
<ci>G</ci>
</apply>
<apply>
<plus></plus>
<cn type="integer">1</cn>
<apply>
<times></times>
<ci>C</ci>
<ci>G</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \frac{\bar{C}Gz^{-k}}{1+\bar{C}Gz^{-k}}=z^{-k}\frac{CG}{1+CG}
  </annotation>
</semantics>
</math>

, we obtain 

<math display="inline" id="Smith_predictor:10">
<semantics>
<mrow>
<mover accent="true">
<mi>C</mi>
<mo stretchy="false">¯</mo>
</mover>
<mo>=</mo>
<mfrac>
<mi>C</mi>
<mrow>
<mn>1</mn>
<mo>+</mo>
<mrow>
<mi>C</mi>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mn>1</mn>
<mo>-</mo>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</mfrac>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<ci>normal-¯</ci>
<ci>C</ci>
</apply>
<apply>
<divide></divide>
<ci>C</ci>
<apply>
<plus></plus>
<cn type="integer">1</cn>
<apply>
<times></times>
<ci>C</ci>
<ci>G</ci>
<apply>
<minus></minus>
<cn type="integer">1</cn>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \bar{C}=\frac{C}{1+CG(1-z^{-k})}
  </annotation>
</semantics>
</math>

. The controller is implemented as shown in the following figure, where 

<math display="inline" id="Smith_predictor:11">
<semantics>
<mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>G</ci>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   G(z)
  </annotation>
</semantics>
</math>

 has been changed to 

<math display="inline" id="Smith_predictor:12">
<semantics>
<mrow>
<mover accent="true">
<mi>G</mi>
<mo stretchy="false">^</mo>
</mover>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<apply>
<ci>normal-^</ci>
<ci>G</ci>
</apply>
<ci>z</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \hat{G}(z)
  </annotation>
</semantics>
</math>

 to indicate that it is a model used by the controller.</p>
<figure><b>(Figure)</b>
<figcaption>Smith_predictor_1.svg</figcaption>
</figure>

<p>Note that there are two feedback loops. The outer control loop feeds the output back to the input, as usual. However, this loop alone would not provide satisfactory control, because of the delay; this loop is feeding back outdated information. Intuitively, for the k seconds during which no fresh information is available, the system is controlled by the inner loop which contains a predictor of what the (unobservable) output of the plant G currently is.</p>

<p>To check that this works, a re-arrangement can be made as follows:</p>
<figure><b>(Figure)</b>
<figcaption>Smith_predictor_2.svg</figcaption>
</figure>

<p>Here we can see that if the model used in the controller, 

<math display="inline" id="Smith_predictor:13">
<semantics>
<mrow>
<mover accent="true">
<mi>G</mi>
<mo stretchy="false">^</mo>
</mover>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<apply>
<ci>normal-^</ci>
<ci>G</ci>
</apply>
<ci>z</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \hat{G}(z)z^{-k}
  </annotation>
</semantics>
</math>

, matches the plant 

<math display="inline" id="Smith_predictor:14">
<semantics>
<mrow>
<mi>G</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>z</mi>
<mo stretchy="false">)</mo>
</mrow>
<msup>
<mi>z</mi>
<mrow>
<mo>-</mo>
<mi>k</mi>
</mrow>
</msup>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>G</ci>
<ci>z</ci>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>z</ci>
<apply>
<minus></minus>
<ci>k</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   G(z)z^{-k}
  </annotation>
</semantics>
</math>

 perfectly, then the outer and middle feedback loops cancel each other, and the controller generates the "correct" control action.</p>
<h2 id="references">References</h2>

<p>K. Warwick and D. Rees, <em>Industrial Digital Control Systems</em>, IET, 1988. [<a class="uri" href="http://books.google.com/books?id=4dURB2NTstAC&amp;pg">http://books.google.com/books?id=4dURB2NTstAC&amp;pg;</a>;=PA100&amp;dq;=%22smith+predictor%22+inauthor:warwick&amp;lr;=&amp;as;_brr=0&amp;ei;=-a_OSIz6BJWKyQSOwJDjBA&amp;sig;=ACfU3U36uGEHj5Azv-prDeRtQ0SE51QkVg]</p>

<p>Smith predictor on-line simulator <a href="http://www.pidlab.com/en/smith-predictor">1</a></p>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://reference.wolfram.com/mathematica/ref/SmithDelayCompensator.html">Compute the Smith predictor in Mathematica</a></li>
</ul>

<p>"</p>

<p><a href="Category:Control_theory" title="wikilink">Category:Control theory</a></p>
</body>
</html>

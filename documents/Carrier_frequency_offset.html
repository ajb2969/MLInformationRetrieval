<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1880">Carrier frequency offset</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Carrier frequency offset</h1>
<hr/>

<p><strong>Carrier frequency offset (CFO)</strong> is one of many non-idealities in <a class="uri" href="baseband" title="wikilink">baseband</a> receiver design. In designing a <a class="uri" href="baseband" title="wikilink">baseband</a> receiver, we should notice not only the degradation invoked by non-ideal <a class="uri" href="channel" title="wikilink">channel</a> and <a class="uri" href="noise" title="wikilink">noise</a>, we should also regard <a class="uri" href="RF" title="wikilink">RF</a> and analog parts as the main consideration. Those nonuidealities include sampling clock offset, <a href="IQ_imbalance" title="wikilink">IQ imbalance</a>, <a href="power_amplifier" title="wikilink">power amplifier</a>, <a href="phase_noise" title="wikilink">phase noise</a> and <strong>carrier frequency offset</strong> nonlinearity.</p>

<p>Carrier frequency offset often occurs when the local oscillator signal for down-conversion in the receiver does not synchronize with the carrier signal contained in the received signal. This phenomenon can be attributed to two important factors: frequency mismatch in the <a class="uri" href="transmitter" title="wikilink">transmitter</a> and the <a href="Receiver_(radio)" title="wikilink">receiver</a> oscillators; and the <a href="Doppler_effect" title="wikilink">Doppler effect</a> as the <a class="uri" href="transmitter" title="wikilink">transmitter</a> or the <a href="Receiver_(radio)" title="wikilink">receiver</a> is moving.</p>

<p>When this occurs, the received signal will be shifted in frequency. For an <a href="Orthogonal_frequency-division_multiple_access" title="wikilink">OFDM</a> system, the <a class="uri" href="orthogonality" title="wikilink">orthogonality</a> among sub carriers is maintained only if the <a href="Receiver_(radio)" title="wikilink">receiver</a> uses a local oscillation signal that is synchronous with the carrier signal contained in the received signal. Otherwise, mismatch in carrier frequency can result in inter-carrier interference (ICI).The oscillators in the <a class="uri" href="transmitter" title="wikilink">transmitter</a> and the <a href="Receiver_(radio)" title="wikilink">receiver</a> can never be oscillating at identical frequency. Hence, <strong>carrier frequency offset</strong> always exists even if there is no <a href="Doppler_effect" title="wikilink">Doppler effect</a>.</p>

<p>In a standard-compliant communication system, such as the <a href="IEEE_802.11" title="wikilink">IEEE 802.11</a> <a class="uri" href="WLAN" title="wikilink">WLAN</a> the oscillator precision tolerance is specified to be less than ±20 ppm, so that <strong>CFO</strong> is in the range from - 40 ppm to +40 ppm.</p>
<h2 id="example">Example</h2>

<p>If the TX oscillator runs at a frequency that is 20 ppm above the nominal frequency and if the <a href="RX_meter" title="wikilink">RX</a> oscillator is running at 20 ppm below, then the received <a class="uri" href="baseband" title="wikilink">baseband</a> signal will have a CFO of 40 ppm. With a carrier frequency of 5.2 GHz in this standard, the CFO is up to ±208 kHz. In addition, if the <a class="uri" href="transmitter" title="wikilink">transmitter</a> or the <a href="Receiver_(radio)" title="wikilink">receiver</a> is moving, the <a href="Doppler_effect" title="wikilink">Doppler effect</a> adds some hundreds of hertz in frequency spreading.</p>

<p>Compared to the CFO resulting from the oscillator mismatch, the <a href="Doppler_effect" title="wikilink">Doppler effect</a> in this case is relatively minor.</p>
<h2 id="effects-of-synchronization-error">Effects of synchronization error</h2>

<p>Given a carrier frequency offset,Δ

<math display="inline" id="Carrier_frequency_offset:0">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

, the received <a href="continuous-time_signal" title="wikilink">continuous-time signal</a> will be rotated by a constant frequency and is in the form of</p>

<p>

<math display="inline" id="Carrier_frequency_offset:1">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mrow>
     <mrow>
      <mi>z</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>e</mi>
       <mrow>
        <mi>j</mi>
        <mn>2</mn>
        <mi>π</mi>
        <mi mathvariant="normal">Δ</mi>
        <mi>f</mi>
        <mi>t</mi>
       </mrow>
      </msup>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>t</mi>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>N</mi>
         <mo>+</mo>
         <msub>
          <mi>N</mi>
          <mi>g</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>T</mi>
        <mi>s</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>N</mi>
        <mi>g</mi>
       </msub>
       <msub>
        <mi>T</mi>
        <mi>s</mi>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>n</mi>
       <msub>
        <mi>T</mi>
        <mi>s</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <list>
      <ci>i</ci>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <ci>z</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <ci>normal-Δ</ci>
        <ci>f</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>t</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>g</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>g</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{i,n}=z(t)e^{j2\pi\Delta ft}|_{t=i(N+N_{g})T_{s}+N_{g}T_{s}+nT_{s}}
  </annotation>
 </semantics>
</math>

</p>

<p>The carrier frequency offset can first be normalized with respect to the sub carrier spacing (

<math display="inline" id="Carrier_frequency_offset:2">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>S</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
   <mo>/</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>N</mi>
    <msub>
     <mi>T</mi>
     <mi>s</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>S</ci>
    </apply>
    <eq></eq>
    <cn type="integer">1</cn>
    <divide></divide>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">N</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>s</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{S}=1/(NT_{s}))
  </annotation>
 </semantics>
</math>

 and then decomposed into the integral component 

<math display="inline" id="Carrier_frequency_offset:3">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>ϵ</mi>
    <mi>I</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>I</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\epsilon_{I})
  </annotation>
 </semantics>
</math>

 and fractional component 

<math display="inline" id="Carrier_frequency_offset:4">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>ϵ</mi>
    <mi>f</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\epsilon_{f})
  </annotation>
 </semantics>
</math>

, that is, 

<math display="inline" id="Carrier_frequency_offset:5">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>f</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>ϵ</mi>
       <mi>I</mi>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>ϵ</mi>
       <mi>f</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>I</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta f=(\epsilon_{I}+\epsilon_{f})f_{S}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Carrier_frequency_offset:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mn>0.5</mn>
   </mrow>
   <mo>≤</mo>
   <msub>
    <mi>ϵ</mi>
    <mi>f</mi>
   </msub>
   <mo><</mo>
   <mn>0.5</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <minus></minus>
      <cn type="float">0.5</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <cn type="float">0.5</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -0.5\leq\epsilon_{f}<0.5
  </annotation>
 </semantics>
</math>

. The received frequency-domain signal then becomes</p>

<p>

<math display="inline" id="Carrier_frequency_offset:7">
 <semantics>
  <mrow>
   <msub>
    <mi>Z</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <msub>
       <mi>ϵ</mi>
       <mi>I</mi>
      </msub>
     </mrow>
    </mrow>
   </msub>
   <msub>
    <mi>H</mi>
    <mrow>
     <mi>k</mi>
     <mo>-</mo>
     <msub>
      <mi>ϵ</mi>
      <mi>I</mi>
     </msub>
    </mrow>
   </msub>
   <mfrac>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>π</mi>
       <msub>
        <mi>ϵ</mi>
        <mi>f</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>π</mi>
         <msub>
          <mi>ϵ</mi>
          <mi>f</mi>
         </msub>
        </mrow>
        <mo>/</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mn>2</mn>
    <mi>π</mi>
    <mfrac>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>N</mi>
         <mo>+</mo>
         <msub>
          <mi>N</mi>
          <mi>g</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>N</mi>
       <mi>g</mi>
      </msub>
     </mrow>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ϵ</mi>
      <mi>f</mi>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>ϵ</mi>
      <mi>I</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mi>π</mi>
    <mfrac>
     <mrow>
      <mi>N</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </mfrac>
    <msub>
     <mi>ϵ</mi>
     <mi>f</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mrow>
      <mi>l</mi>
      <mo>=</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>N</mi>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>l</mi>
      <mo>≠</mo>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <msub>
        <mi>ϵ</mi>
        <mi>I</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mi>N</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>l</mi>
    </mrow>
   </msub>
   <msub>
    <mi>H</mi>
    <mi>l</mi>
   </msub>
   <mfrac>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>π</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>ϵ</mi>
           <mi>I</mi>
          </msub>
          <mo>+</mo>
          <msub>
           <mi>ϵ</mi>
           <mi>f</mi>
          </msub>
          <mo>+</mo>
          <mi>l</mi>
         </mrow>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>π</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <msub>
             <mi>ϵ</mi>
             <mi>I</mi>
            </msub>
            <mo>+</mo>
            <msub>
             <mi>ϵ</mi>
             <mi>f</mi>
            </msub>
            <mo>+</mo>
            <mi>l</mi>
           </mrow>
           <mo>-</mo>
           <mi>k</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>/</mo>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
   <mo>×</mo>
   <mi>exp</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mn>2</mn>
    <mi>π</mi>
    <mfrac>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>N</mi>
         <mo>+</mo>
         <msub>
          <mi>N</mi>
          <mi>g</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>N</mi>
       <mi>g</mi>
      </msub>
     </mrow>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>ϵ</mi>
      <mi>I</mi>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>ϵ</mi>
      <mi>f</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>exp</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>j</mi>
     <mi>π</mi>
     <mfrac>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>ϵ</mi>
       <mi>I</mi>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>ϵ</mi>
       <mi>f</mi>
      </msub>
      <mo>+</mo>
      <mi>l</mi>
      <mo>-</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>V</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <list>
      <ci>i</ci>
      <ci>k</ci>
     </list>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <list>
      <ci>i</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>I</ci>
       </apply>
      </apply>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <apply>
      <minus></minus>
      <ci>k</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>I</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sin></sin>
      <apply>
       <times></times>
       <ci>π</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>f</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <sin></sin>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>π</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϵ</ci>
          <ci>f</ci>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <cn type="integer">2</cn>
     <csymbol cd="unknown">π</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>g</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>g</ci>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>f</ci>
      </apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>I</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <csymbol cd="unknown">π</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϵ</ci>
      <ci>f</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <csymbol cd="ambiguous">formulae-sequence</csymbol>
       <apply>
        <eq></eq>
        <ci>l</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <ci>N</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <neq></neq>
        <ci>l</ci>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϵ</ci>
          <ci>I</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <list>
      <ci>i</ci>
      <ci>l</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>l</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <sin></sin>
      <apply>
       <times></times>
       <ci>π</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϵ</ci>
          <ci>I</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ϵ</ci>
          <ci>f</ci>
         </apply>
         <ci>l</ci>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <sin></sin>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>π</ci>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ϵ</ci>
            <ci>I</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ϵ</ci>
            <ci>f</ci>
           </apply>
           <ci>l</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <times></times>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">j</csymbol>
     <cn type="integer">2</cn>
     <csymbol cd="unknown">π</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <plus></plus>
         <ci>N</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>N</ci>
          <ci>g</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>N</ci>
        <ci>g</ci>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>I</ci>
      </apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>f</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <exp></exp>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">j</csymbol>
      <csymbol cd="unknown">π</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>N</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>I</ci>
       </apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ϵ</ci>
        <ci>f</ci>
       </apply>
       <plus></plus>
       <csymbol cd="unknown">l</csymbol>
       <minus></minus>
       <csymbol cd="unknown">k</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <list>
       <ci>i</ci>
       <ci>k</ci>
      </list>
     </apply>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{i,k}=X_{i,k-\epsilon_{I}}H_{k-\epsilon_{I}}\frac{\sin(\pi\epsilon_{f})}{N%
\sin(\pi\epsilon_{f}/N)}\exp(j2\pi\frac{i(N+N_{g})+N_{g}}{N}(\epsilon_{f}+%
\epsilon_{I}))\exp(j\pi\frac{N-1}{N}\epsilon_{f})+\sum_{l=-N/2,l\neq k-%
\epsilon_{I}}^{N/2-1}{X_{i,l}H_{l}\frac{\sin(\pi(\epsilon_{I}+\epsilon_{f}+l-k%
))}{N\sin(\pi(\epsilon_{I}+\epsilon_{f}+l-k)/N)}}\times\exp(j2\pi\frac{i(N+N_{%
g})+N_{g}}{N}{(\epsilon_{I}+\epsilon_{f}})\exp(j\pi\frac{N-1}{N}(\epsilon_{I}+%
\epsilon_{f}+l-k))+V_{i,k}
  </annotation>
 </semantics>
</math>

</p>

<p>The second term of the equation denotes the ICI, namely signals from other <a class="uri" href="subcarriers" title="wikilink">subcarriers</a> that interfere with the desired <a class="uri" href="subcarrier" title="wikilink">subcarrier</a> signal. Also note that 

<math display="inline" id="Carrier_frequency_offset:8">
 <semantics>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <list>
     <ci>i</ci>
     <ci>k</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{i,k}
  </annotation>
 </semantics>
</math>

 is the channel noise component. The fractional carrier frequency offset, 

<math display="inline" id="Carrier_frequency_offset:9">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>f</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{f}
  </annotation>
 </semantics>
</math>

, results in attenuation in magnitude, <a href="phase_shift" title="wikilink">phase shift</a>, and ICI, while the integer carrier frequency offset, 

<math display="inline" id="Carrier_frequency_offset:10">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>I</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>I</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{I}
  </annotation>
 </semantics>
</math>

, causes index shift as well as phase shift in the received frequency-domain signals. Note that the phase shift is identical in every <a class="uri" href="subcarrier" title="wikilink">subcarrier</a> and is also proportional to the symbol index 

<math display="inline" id="Carrier_frequency_offset:11">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="carrier-frequency-offset-estimation">Carrier frequency offset estimation</h2>
<h3 id="fractional-cfo-estimation">Fractional CFO estimation</h3>
<h4 id="maximum-likelihood-ml-estimation">Maximum likelihood (ML) estimation</h4>

<p>An estimate of the CFO, if within a certain limit, can be obtained simultaneously when the coarse symbol timing is acquired by the <a href="algorithm" title="wikilink">algorithms</a> mentioned earlier. The ML CFO estimator is given by</p>

<p>

<math display="inline" id="Carrier_frequency_offset:12">
 <semantics>
  <mrow>
   <mover accent="true">
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>f</mi>
    </mrow>
    <mo>^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <mi>L</mi>
      <msub>
       <mi>T</mi>
       <mi>s</mi>
      </msub>
     </mrow>
    </mfrac>
    <mpadded width="+5pt">
     <mi mathvariant="normal">∠</mi>
    </mpadded>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>r</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mi>R</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <msub>
        <mi>z</mi>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mi>r</mi>
        </mrow>
       </msub>
       <msubsup>
        <mi>z</mi>
        <mrow>
         <mi>m</mi>
         <mo>-</mo>
         <mi>r</mi>
         <mo>-</mo>
         <mi>L</mi>
        </mrow>
        <mo>*</mo>
       </msubsup>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <ci>L</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-∠</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>r</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>R</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <ci>r</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <times></times>
        </apply>
        <apply>
         <minus></minus>
         <ci>m</ci>
         <ci>r</ci>
         <ci>L</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Delta f}=\frac{1}{2\pi LT_{s}}\angle\ (\sum_{r=0}^{R-1}{z_{m-r}z^{*}%
_{m-r-L}})
  </annotation>
 </semantics>
</math>

</p>

<p>Note that the phase can only be resolved in 

<math display="inline" id="Carrier_frequency_offset:13">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mrow>
    <mo>-</mo>
    <mi>π</mi>
   </mrow>
   <mo>,</mo>
   <mi>π</mi>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <apply>
     <minus></minus>
     <ci>π</ci>
    </apply>
    <ci>π</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left[-\pi,\pi\right]
  </annotation>
 </semantics>
</math>

, and the above formula estimates only the part of the CFO that is within 

<math display="inline" id="Carrier_frequency_offset:14">
 <semantics>
  <mrow>
   <mo>[</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>2</mn>
       <mi>L</mi>
       <msub>
        <mi>T</mi>
        <mi>s</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>2</mn>
      <mi>L</mi>
      <msub>
       <mi>T</mi>
       <mi>s</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>L</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>L</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left[-1/(2LT_{s}),1/(2LT_{s})\right]
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Carrier_frequency_offset:15">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mi>z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Hz
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="Carrier_frequency_offset:16">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>=</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>L</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L=N
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Carrier_frequency_offset:17">
 <semantics>
  <mrow>
   <mover accent="true">
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>f</mi>
    </mrow>
    <mo>^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>ϵ</mi>
      <mo>^</mo>
     </mover>
     <mi>f</mi>
    </msub>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ϵ</ci>
      </apply>
      <ci>f</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Delta f}=\widehat{\epsilon}_{f}f_{S}
  </annotation>
 </semantics>
</math>

, the part of the CFO that is within plus and minus half the <a class="uri" href="subcarrier" title="wikilink">subcarrier</a> spacing, also known as the fractional CFO. In the case in which 

<math display="inline" id="Carrier_frequency_offset:18">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mo>></mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>f</mi>
      <msub>
       <mi>T</mi>
       <mi>s</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>L</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L>1/(\Delta fT_{s})
  </annotation>
 </semantics>
</math>

, frequency ambiguity occurs, and the total CFO must be resolved by additional integer CFO estimation.</p>
<h4 id="blue">Blue</h4>

<p>If the preamble has U identical repetitions, where 

<math display="inline" id="Carrier_frequency_offset:19">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>></mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>U</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U>2
  </annotation>
 </semantics>
</math>

, then another best linear unbiased estimator (BLUE) exploiting the correlation of the repeated segments is possible. Assume that there are R samples in a segment, so, in total, 

<math display="inline" id="Carrier_frequency_offset:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mi>R</mi>
   </mrow>
   <mo>=</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <ci>R</ci>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   UR=N
  </annotation>
 </semantics>
</math>

 samples are available. The BLUE estimation algorithm starts with computing several linear <a href="Autocorrelation" title="wikilink">auto-correlation</a> functions with 

<math display="inline" id="Carrier_frequency_offset:21">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mi>R</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>u</ci>
    <ci>R</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   uR
  </annotation>
 </semantics>
</math>

 samples of delay,</p>

<p>

<math display="inline" id="Carrier_frequency_offset:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mrow>
       <mi>B</mi>
       <mi>L</mi>
       <mi>U</mi>
       <mi>E</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mi>N</mi>
        <mo>-</mo>
        <mrow>
         <mi>u</mi>
         <mi>R</mi>
        </mrow>
       </mrow>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>m</mi>
         <mo>=</mo>
         <mrow>
          <mi>u</mi>
          <mi>R</mi>
         </mrow>
        </mrow>
        <mrow>
         <mi>N</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>m</mi>
        </msub>
        <msubsup>
         <mi>z</mi>
         <mrow>
          <mi>m</mi>
          <mo>-</mo>
          <mrow>
           <mi>u</mi>
           <mi>R</mi>
          </mrow>
         </mrow>
         <mo>*</mo>
        </msubsup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mn>0</mn>
     <mo>≤</mo>
     <mi>u</mi>
     <mo>≤</mo>
     <mi>K</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <ci>L</ci>
       <ci>U</ci>
       <ci>E</ci>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <apply>
         <times></times>
         <ci>u</ci>
         <ci>R</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>m</ci>
          <apply>
           <times></times>
           <ci>u</ci>
           <ci>R</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <times></times>
         </apply>
         <apply>
          <minus></minus>
          <ci>m</ci>
          <apply>
           <times></times>
           <ci>u</ci>
           <ci>R</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="float">0</cn>
      <ci>u</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi_{BLUE(u)}=\frac{1}{N-uR}\sum_{m=uR}^{N-1}{z_{m}z^{*}_{m-uR}},\ \ \ \ \ \ %
\ 0\leq u\leq K.
  </annotation>
 </semantics>
</math>

</p>

<p>Then the phase differences between all pairs of auto-correlation functions with delay difference 

<math display="inline" id="Carrier_frequency_offset:23">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 are computed,</p>

<p>

<math display="inline" id="Carrier_frequency_offset:24">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <merror class="ltx_ERROR undefined undefined">
     <mtext>\ang</mtext>
    </merror>
    <mrow>
     <mo>{</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mrow>
       <mi>B</mi>
       <mi>L</mi>
       <mi>U</mi>
       <mi>E</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>}</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>-</mo>
   <merror class="ltx_ERROR undefined undefined">
    <mtext>\ang</mtext>
   </merror>
   <mrow>
    <mo>{</mo>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mrow>
      <mi>B</mi>
      <mi>L</mi>
      <mi>U</mi>
      <mi>E</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo>-</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>}</mo>
   </mrow>
   <mo stretchy="false">]</mo>
   <msub>
    <mi></mi>
    <mrow>
     <mn>2</mn>
     <mi>π</mi>
    </mrow>
   </msub>
   <mn>1</mn>
   <mo>≤</mo>
   <mi>u</mi>
   <mo>≤</mo>
   <mi>K</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ϕ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">u</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <mtext>\ang</mtext>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-{</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <apply>
        <times></times>
        <ci>B</ci>
        <ci>L</ci>
        <ci>U</ci>
        <ci>E</ci>
       </apply>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">u</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-}</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
    <minus></minus>
    <mtext>\ang</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <ci>L</ci>
       <ci>U</ci>
       <ci>E</ci>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">u</csymbol>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-}</ci>
    </cerror>
    <ci>normal-]</ci>
    <apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
    </apply>
    <cn type="float">1</cn>
    <leq></leq>
    <csymbol cd="unknown">u</csymbol>
    <leq></leq>
    <csymbol cd="unknown">K</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(u)=[\ang\left\{\Phi_{BLUE}(u)\right\}]-\ang\left\{\Phi_{BLUE}(u-1)\right%
\}]_{2\pi}\ \ \ \ \ 1\leq u\leq K,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Carrier_frequency_offset:25">
 <semantics>
  <msub>
   <mrow>
    <mo rspace="7.5pt" stretchy="false">[</mo>
    <mo rspace="7.5pt">⋅</mo>
    <mo stretchy="false">]</mo>
   </mrow>
   <mrow>
    <mn>2</mn>
    <mi>π</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>normal-⋅</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>π</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [\ \cdot\ ]_{2\pi}
  </annotation>
 </semantics>
</math>

 denotes a modulo-

<math display="inline" id="Carrier_frequency_offset:26">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>π</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\pi
  </annotation>
 </semantics>
</math>

 operation and 

<math display="inline" id="Carrier_frequency_offset:27">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 is a design parameter less than 

<math display="inline" id="Carrier_frequency_offset:28">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

. Note that each 

<math display="inline" id="Carrier_frequency_offset:29">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(u)
  </annotation>
 </semantics>
</math>

 represents an estimate of the CFO, scaled by a constant. The smaller the constant 

<math display="inline" id="Carrier_frequency_offset:30">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

, the better accuracy it achieves. To gain an effective CFO estimate, the BLUE estimator uses a weighted average of all 

<math display="inline" id="Carrier_frequency_offset:31">
 <semantics>
  <mrow>
   <mi>ϕ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ϕ</ci>
    <ci>u</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(u)
  </annotation>
 </semantics>
</math>

 and computes</p>

<p>

<math display="inline" id="Carrier_frequency_offset:32">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>f</mi>
      </mrow>
      <mo>^</mo>
     </mover>
     <mo>/</mo>
     <msub>
      <mi>f</mi>
      <mi>S</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mi>U</mi>
      <mrow>
       <mn>2</mn>
       <mi>π</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>u</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>K</mi>
       </msubsup>
       <mrow>
        <msub>
         <mi>w</mi>
         <mi>u</mi>
        </msub>
        <mi>ϕ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>u</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-^</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>U</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>u</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>u</ci>
       </apply>
       <ci>ϕ</ci>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Delta f}/f_{S}=\frac{U}{2\pi}(\sum_{u=1}^{K}{w_{u}\phi(u)}),
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="inline" id="Carrier_frequency_offset:33">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mi>u</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>3</mn>
    <mfrac>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>U</mi>
         <mo>-</mo>
         <mi>u</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>U</mi>
          <mo>-</mo>
          <mi>u</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>K</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>U</mi>
         <mo>-</mo>
         <mi>K</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mi>K</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mn>4</mn>
           <msup>
            <mi>K</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>6</mn>
           <mi>U</mi>
           <mi>K</mi>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>3</mn>
          <msup>
           <mi>U</mi>
           <mn>2</mn>
          </msup>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>u</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>U</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>U</ci>
          <ci>u</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>K</ci>
        <apply>
         <minus></minus>
         <ci>U</ci>
         <ci>K</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <cn type="integer">4</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>K</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">6</cn>
           <ci>U</ci>
           <ci>K</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>U</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{u}=3\frac{(U-u)(U-u+1)-K(U-K)}{K(4K^{2}-6UK+3U^{2}-1)}
  </annotation>
 </semantics>
</math>

</p>

<p>The optimal 

<math display="inline" id="Carrier_frequency_offset:34">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 value for achieving the minimal variance of 

<math display="inline" id="Carrier_frequency_offset:35">
 <semantics>
  <mover accent="true">
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>f</mi>
   </mrow>
   <mo>^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\Delta f}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Carrier_frequency_offset:36">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>U</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U/2
  </annotation>
 </semantics>
</math>

. The range of estimated carrier frequency offset is 

<math display="inline" id="Carrier_frequency_offset:37">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mi>U</mi>
      <msub>
       <mi>f</mi>
       <mi>S</mi>
      </msub>
     </mrow>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mover accent="true">
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>f</mi>
    </mrow>
    <mo>^</mo>
   </mover>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mi>U</mi>
     <msub>
      <mi>f</mi>
      <mi>S</mi>
     </msub>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>U</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>S</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <ci>normal-^</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>f</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>U</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>S</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -Uf_{S}/2\leq\widehat{\Delta f}\leq Uf_{S}/2
  </annotation>
 </semantics>
</math>

.</p>

<p>With some modification, this estimator can also be applied to preambles consisting of several repeated segments with specific sign changes. With proper acquired symbol timing, the received 

<math display="inline" id="Carrier_frequency_offset:38">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 segments of the preamble are multiplied by their respective signs, and then the same method as the BLUE estimator can be applied.</p>
<h3 id="integer-cfo-estimation">Integer CFO estimation</h3>

<p>In the <a href="IEEE_802.16e" title="wikilink">IEEE 802.16e</a> <a class="uri" href="OFDM" title="wikilink">OFDM</a> mode standard, the oscillator deviation is within ±8 ppm. With the highest possible carrier frequency of 10.68 GHz, the maximum CFO is about ± 171 kHz when the transmitter LO and the receiver LO both have the largest yet opposite-sign frequency deviations, which is also equivalent to ± 1 1 sub carrier spacing 

<math display="inline" id="Carrier_frequency_offset:39">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>f</mi>
    <mi>S</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f_{S})
  </annotation>
 </semantics>
</math>

 . In the 6 MHz <a class="uri" href="DVB-T" title="wikilink">DVB-T</a> system, assuming that the oscillator deviation is within ±20 ppm and the carrier frequency is around 800 MHz, the maximum CFO can be up to ±38 <a class="uri" href="subcarrier" title="wikilink">subcarrier</a> spacing 

<math display="inline" id="Carrier_frequency_offset:40">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>f</mi>
    <mi>S</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f_{S})
  </annotation>
 </semantics>
</math>

 in the 8K transmission mode. From the previous discussion, it is clear that the estimated CFO obtained simultaneously in the coarse symbol boundary detection has ambiguity in frequency. In the following, algorithms for resolving such frequency ambiguity in the estimated carrier frequency offset will be presented.</p>
<h4 id="time-domain-correlation">Time-domain correlation</h4>

<p>In the <a class="uri" href="802.16e" title="wikilink">802.16e</a> <a class="uri" href="OFDM" title="wikilink">OFDM</a> mode, the initial estimated CFO is within 

<math display="inline" id="Carrier_frequency_offset:41">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msub>
      <mi>f</mi>
      <mi>S</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mn>2</mn>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>S</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [-2f_{S},2f_{S}]
  </annotation>
 </semantics>
</math>

. Besides this estimation, additional frequency offset of 

<math display="inline" id="Carrier_frequency_offset:42">
 <semantics>
  <mrow>
   <mo>±</mo>
   <mrow>
    <mn>12</mn>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <cn type="integer">12</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pm 12f_{S}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Carrier_frequency_offset:43">
 <semantics>
  <mrow>
   <mo>±</mo>
   <mrow>
    <mn>8</mn>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <cn type="integer">8</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pm 8f_{S}
  </annotation>
 </semantics>
</math>

, or 

<math display="inline" id="Carrier_frequency_offset:44">
 <semantics>
  <mrow>
   <mo>±</mo>
   <mrow>
    <mn>4</mn>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pm 4f_{S}
  </annotation>
 </semantics>
</math>

, is possible given a CFO range of 

<math display="inline" id="Carrier_frequency_offset:45">
 <semantics>
  <mrow>
   <mo>±</mo>
   <mrow>
    <mn>11</mn>
    <msub>
     <mi>f</mi>
     <mi>S</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <times></times>
     <cn type="integer">11</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pm 11f_{S}
  </annotation>
 </semantics>
</math>

. In order to estimate this additional integer CFO, a matched filter matching the fractional CFO-compensated received signal against the modulated long preamble waveforms can be used. The coefficients of the matched filter are the complex conjugate of the long preamble and they are modulated by a sinusoidal wave whose frequency is a possible integer CFO mentioned above. The output of the matched filter will have a maximum peak value if its coefficients are modulated by the carrier with the correct integer CFO. It is possible to deploy one such matched filter for each possible integer CFO. In this case, seven matched filters are needed. However, we can use only one set of matched filter hardware that handles different integer CFOs sequentially. In addition, as suggested previously in the symbol timing detection subsection, the coefficients of the matched filter can be quantized to -1, 0, 1 to reduce hardware complexity.</p>
<h2 id="carrier-frequency-offset-estimation-in-mimo-ofdm-system">Carrier frequency offset estimation in MIMO-OFDM system</h2>

<p>In <a class="uri" href="MIMO-OFDM" title="wikilink">MIMO-OFDM</a> systems, the transmit antennas are often co-located, so are the receive antennas.</p>

<p>Hence, it is valid to assume that only one oscillator is referenced in either the transmitter side or the receiver side. As a result, a single CFO set is to be estimated for the multiple receive antennas. The ML estimation for the fractional CFO is quite popular in <a class="uri" href="MIMO-OFDM" title="wikilink">MIMO-OFDM</a> systems.</p>

<p>Another fractional CFO estimation algorithm for <a class="uri" href="MIMO-OFDM" title="wikilink">MIMO-OFDM</a> systems applies different weights to the receive Signals according to the respective degrees of channel fading</p>

<p>The preamble is designed so that each transmit antenna uses non-overlapping sub carriers to facilitate separation of signals from different transmit antennas. At each receive antenna, the cross-correlation between the received Signal and the known preamble is examined.</p>

<p>The magnitude of the cross-correlation output reflects the channel fading between the corresponding transmit and receive antenna pair.</p>

<p>Based on the channel fading information, weights are applied to the received signals to emphasize those with stronger channel gains and at the same time to suppress those that are deeply faded.</p>

<p>Then, the CFO is estimated based on the phase of delay correlation of weighted Signals.For integer CFO, frequency-domain cross-correlation and frequency-domain PN correlation can be used with slight modification. First, the received signals must be compensated by the estimated fractional CFO.</p>

<p>Then, the compensated Signals are transformed into the frequency domain. The frequency-domain cross-correlation algorithm for one specific receive antenna is similar to that in the <a href="Single-input_single-output_system" title="wikilink">SISO</a> case</p>
<h2 id="residual-cfo-and-sco-estimation">Residual CFO and SCO Estimation</h2>

<p>Although the CFO in the received Signal has been estimated and compensated in the receiver,some residual CFO may still exist. Besides, the CFO contained in the received signal may very well be time-varying and, thus, it needs to be continuously tracked.</p>

<p>The received signal also suffers from <a href="sampling_clock_offset" title="wikilink">sampling clock offset</a> (SCO), which may cause a gradual drift of the safe <a href="Discrete-time_Fourier_transform" title="wikilink">DFT</a> window in addition to extra phase shift in the received <a href="Frequency_domain" title="wikilink">frequency-domain</a> Signals. In <a class="uri" href="framebased" title="wikilink">framebased</a> <a href="Orthogonal_frequency-division_multiple_access" title="wikilink">OFDM</a> systems, both the residual CFO tracking and the SCO tracking are inevitable, because the <a href="Receiver_(radio)" title="wikilink">receiver</a> may operate for a long period of time. In packet-based <a href="Orthogonal_frequency-division_multiple_access" title="wikilink">OFDM</a> systems, however, the influences of these two offsets depend on the packet length and the magnitude of the offsets.</p>

<p>The SCO may not be easily estimated from the <a href="Time_domain" title="wikilink">time-domain</a> signal. However, it can be examined through the <a href="phase_shift" title="wikilink">phase shift</a> of the frequency-domain pilot Signals. The residual CFO can also be estimated in a similar way. In many <a href="Orthogonal_frequency-division_multiple_access" title="wikilink">OFDM</a> wireless communication standards, for example, <a class="uri" href="DVB-T" title="wikilink">DVB-T</a>, <a href="IEEE_802.11" title="wikilink">IEEE 802.11</a> a/g/n, and <a href="IEEE_802.16" title="wikilink">IEEE 802.16e</a> <a href="Orthogonal_frequency-division_multiple_access" title="wikilink">OFDM</a> mode, dedicated pilot <a class="uri" href="subcarriers" title="wikilink">subcarriers</a> are allocated to facilitate receiver synchronization.</p>

<p>The phase shifts in the received <a href="Frequency_domain" title="wikilink">frequency-domain</a> Signals caused by the CFO are identical at all <a class="uri" href="subcarriers" title="wikilink">subcarriers</a> provided that the ICI is ignored. On the other hand, the SCO causes <a href="phase_shifts" title="wikilink">phase shifts</a> that are proportional to the respective sub carrier indices.</p>

<p>The received Signals contain ICI and <a class="uri" href="noise" title="wikilink">noise</a>, and therefore the phases deviate from the two ideal straight lines. Conventionally, the SCO can be estimated by computing a slope from the plot of measured pilot <a class="uri" href="subcarrier" title="wikilink">subcarrier</a> phase differences versus pilot <a class="uri" href="subcarrier" title="wikilink">subcarrier</a> indices. Moreover, joint estimation of CFO and SCO has also been studied extensively.</p>
<h2 id="carrier-frequency-offset-compensation">Carrier Frequency Offset Compensation</h2>

<p>In order to suppress the ICI and thereby reduce SNR degradation, the residual CFO must be sufficiently small. For example, when using the 64QAM constellation, it is better to keep the residual CFO below O. OI/s to ensure that DSNR </p>
</body>
</html>

   Inverse distance weighting      Inverse distance weighting   Inverse Distance Weighting ( IDW ) is a type of deterministic method for multivariate interpolation with a known scattered set of points. The assigned values to unknown points are calculated with a weighted average of the values available at the known points.  The name given to this type of methods was motivated by the weighted average applied, since it resorts to the inverse of the distance to each known point ("amount of proximity") when assigning weights.  Definition of the Problem  The expected result is a discrete assignment of the unknown function   u   u   u   in a study region:       u   (  x  )    :    x  →  ℝ   ,   x  ∈   𝐃   \sub    ℝ  n         normal-:    u  x    formulae-sequence   normal-→  x  ℝ     x    𝐃  \sub   superscript  ℝ  n        u(x):x\rightarrow\mathbb{R},\quad x\in\mathbf{D}\sub\mathbb{R}^{n}     where   𝐃   𝐃   \mathbf{D}   is the study region.  The set of   N   N   N   known data points can be described as a list of tuples :      [   (   x  1   ,   u  1   )   ,   (   x  2   ,   u  2   )   ,  …  ,   (   x  N   ,   u  N   )   ]       subscript  x  1    subscript  u  1      subscript  x  2    subscript  u  2    normal-…    subscript  x  N    subscript  u  N      [(x_{1},u_{1}),(x_{2},u_{2}),...,(x_{N},u_{N})]     The function is to be "smooth" (continuous and once differentiable), to be exact (     u   (   x  i   )    =   u  i         u   subscript  x  i     subscript  u  i     u(x_{i})=u_{i}   ) and to meet the user's intuitive expectations about the phenomenon under investigation. Furthermore, the function should be suitable for a computer application at a reasonable cost (nowadays, a basic implementation will probably make use of parallel resources ).  Shepard's method  Historical Reference  At the Harvard Laboratory for Computer Graphics and Spatial Analysis, beginning in 1965, a varied collection of scientists converged to rethink, among other things, what we now call geographic information systems . 1  The motive force behind the Laboratory, Howard Fisher, conceived an improved computer mapping program that he called SYMAP, which, from the start, Fisher wanted to improve on the interpolation. He showed Harvard College freshmen his work on SYMAP, and many of them participated in Laboratory events. One freshman, Donald Shepard, decided to overhaul the interpolation in SYMAP, resulting in his famous article from 1968. 2  Shepard’s algorithm was also influenced by the theoretical approach of William Warntz and others at the Lab who worked with spatial analysis. He conducted a number of experiments with the exponent of distance, deciding on something closer to the gravity model (exponent of -2). Shepard implemented not just basic inverse distance weighting, but also he allowed barriers (permeable and absolute) to interpolation.  Other research centers were working on interpolation at this time, particularly University of Kansas and their SURFACE II program. Still, the features of SYMAP were state-of-the-art, even though programmed by an undergraduate.  Basic Form  (Figure)  Shepard's interpolation for different power parameters p , from scattered points on the surface    z  =   exp   (    -   x  2    -   y  2    )        z         superscript  x  2     superscript  y  2       z=\exp(-x^{2}-y^{2})   .   A general form of finding an interpolated value   u   u   u   at a given point   x   x   x   based on samples     u  i   =   u   (   x  i   )         subscript  u  i     u   subscript  x  i      u_{i}=u(x_{i})   for    i  =   1  ,  2  ,  …  ,  N       i   1  2  normal-…  N     i=1,2,...,N   using IDW is an interpolating function:       u   (  𝐱  )    =   {           ∑   i  =  1   N      w  i    (  𝐱  )    u  i        ∑   i  =  1   N      w  i    (  𝐱  )       ,       if  d   (  𝐱  ,   𝐱  i   )    ≠   0  for all  i          u  i   ,       if  d   (  𝐱  ,   𝐱  i   )    =   0  for some  i              u  𝐱    cases      superscript   subscript     i  1    N      subscript  w  i   𝐱   subscript  u  i       superscript   subscript     i  1    N      subscript  w  i   𝐱         if  d   𝐱   subscript  𝐱  i       0  for all  i     subscript  u  i       if  d   𝐱   subscript  𝐱  i       0  for some  i       u(\mathbf{x})=\begin{cases}\frac{\displaystyle\sum_{i=1}^{N}{w_{i}(\mathbf{x})%
 u_{i}}}{\displaystyle\sum_{i=1}^{N}{w_{i}(\mathbf{x})}},&\text{if }d(\mathbf{x%
 },\mathbf{x}_{i})\neq 0\text{ for all }i\\
 u_{i},&\text{if }d(\mathbf{x},\mathbf{x}_{i})=0\text{ for some }i\end{cases}     where        w  i    (  𝐱  )    =   1   d    (  𝐱  ,   𝐱  i   )   p            subscript  w  i   𝐱     1    d   superscript   𝐱   subscript  𝐱  i    p       w_{i}(\mathbf{x})=\frac{1}{d(\mathbf{x},\mathbf{x}_{i})^{p}}     is a simple IDW weighting function, as defined by Shepard, 3  x denotes an interpolated (arbitrary) point, x i is an interpolating (known) point,   d   d   d   is a given distance ( metric operator) from the known point x i to the unknown point x , N is the total number of known points used in interpolation and   p   p   p   is a positive real number, called the power parameter.  Here weight decreases as distance increases from the interpolated points. Greater values of   p   p   p   assign greater influence to values closest to the interpolated point, with the result turning into a mosaic of tiles (a Voronoi diagram ) with nearly constant interpolated value for large values of p . For two dimensions, power parameters    p  ≤  2      p  2    p\leq 2   cause the interpolated values to be dominated by points far away, since with a density   ρ   ρ   \rho   of data points and neighboring points between distances    r  0     subscript  r  0    r_{0}   to   R   R   R   , the summed weight is approximately         ∑  j    w  j    ≈    ∫   r  0   R     2  π  r  ρ  d  r    r  p     =   2  π  ρ    ∫   r  0   R     r   1  -  p    d  r      ,          subscript   j    subscript  w  j      superscript   subscript    subscript  r  0    R       2  π  r  ρ  d  r    superscript  r  p            2  π  ρ    superscript   subscript    subscript  r  0    R      superscript  r    1  p    d  r        \sum_{j}w_{j}\approx\int_{r_{0}}^{R}\frac{2\pi r\rho dr}{r^{p}}=2\pi\rho\int_{%
 r_{0}}^{R}r^{1-p}dr,   which diverges for    R  →  ∞     normal-→  R     R\rightarrow\infty   and    p  ≤  2      p  2    p\leq 2   . For N dimensions, the same argument holds for    p  ≤  N      p  N    p\leq N   . For the choice of value for p , one can consider the degree of smoothing desired in the interpolation, the density and distribution of samples being interpolated, and the maximum distance over which an individual sample is allowed to influence the surrounding ones.  Shepard's method is a consequence of minimization of a functional related to a measure of deviations between tuples of interpolating points { x , u } and i tuples of interpolated points { x i , u i }, defined as:        ϕ   (  𝐱  ,  u  )    =    (    ∑   i  =  0   N      (   u  -   u  i    )   2    d    (  𝐱  ,   𝐱  i   )   p      )    1  p     ,        ϕ   𝐱  u     superscript    superscript   subscript     i  0    N      superscript    u   subscript  u  i    2     d   superscript   𝐱   subscript  𝐱  i    p        1  p      \phi(\mathbf{x},u)=\left(\sum_{i=0}^{N}{\frac{(u-u_{i})^{2}}{d(\mathbf{x},%
 \mathbf{x}_{i})^{p}}}\right)^{\frac{1}{p}},   derived from the minimizing condition:        P
                           a
                           r
                           t
                            
                           I
                         
                         ϕ
                       
                       
                         
                           I
                         
                         ϕ   (  𝐱  ,  u  )    P
                         a
                         r
                         t
                          
                         I
                         I
                       
                       u
                     
                     
                       
                         I
                         I
                       
                       u   =  0.          P
                           a
                           r
                           t
                            
                           I
                         
                         ϕ
                       
                       
                         
                           I
                         
                         ϕ   𝐱  u    P
                         a
                         r
                         t
                          
                         I
                         I
                       
                       u
                     
                     
                       
                         I
                         I
                       
                       u   0.    \frac{\@@section{part}{Pt1}{I}{Part~I}{{\@tag[][]{I}\phi}}{{\@tag[][]{Part~I}%
 \phi}}(\mathbf{x},u)}{\@@section{part}{Pt2}{II}{Part~II}{{\@tag[][]{II}u}}{{%
 \@tag[][]{Part~II}u}}}=0.     The method can easily be extended to other dimensional spaces and it is in fact a generalization of Lagrange approximation into a multidimensional spaces. A modified version of the algorithm designed for trivariate interpolation was developed by Robert J. Renka and is available in Netlib as algorithm 661 in the toms library.  Example in 1 Dimension  (Figure)  Shepard's interpolation in 1 dimension, from 4 scattered points and using p=2 .   Łukaszyk-Karmowski metric  Yet another modification of the Shepard's method was proposed by Łukaszyk 4 also in applications to experimental mechanics. The proposed weighting function had the form:         w  k    (  𝐱  )    =   1    (    D    *  *     (  𝐱  ,   𝐱  k   )    )    1  2      ,         subscript  w  k   𝐱     1   superscript     subscript  D    absent      𝐱   subscript  𝐱  k       1  2       w_{k}(\mathbf{x})=\frac{1}{(D_{**}(\mathbf{x},\mathbf{x}_{k}))^{\frac{1}{2}}},   where     D    *  *     (  𝐱  ,   𝐱  k   )        subscript  D    absent      𝐱   subscript  𝐱  k      D_{**}(\mathbf{x},\mathbf{x}_{k})   is the Łukaszyk–Karmowski metric chosen also with regard to the statistical error  probability distributions of measurement of the interpolated points.  Modified Shepard's Method  Another modification of Shepard's method calculates interpolated value using only nearest neighbors within R-sphere (instead of full sample). Weights are slightly modified in this case:        w  k    (  𝐱  )    =    (    max   (  0  ,   R  -   d   (  𝐱  ,   𝐱  k   )     )     R  d   (  𝐱  ,   𝐱  k   )     )   2          subscript  w  k   𝐱    superscript      0    R    d   𝐱   subscript  𝐱  k         R  d   𝐱   subscript  𝐱  k      2     w_{k}(\mathbf{x})=\left(\frac{\max(0,R-d(\mathbf{x},\mathbf{x}_{k}))}{Rd(%
 \mathbf{x},\mathbf{x}_{k})}\right)^{2}     When combined with fast spatial search structure (like kd-tree ) it becomes efficient N*logN interpolation method suitable for large-scale problems.  References    See also   Multivariate interpolation   "  Category:Geostatistics  Category:Multivariate interpolation     ↩  ↩   ↩     
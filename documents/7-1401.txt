   Pólya enumeration theorem      Pólya enumeration theorem   The Pólya enumeration theorem , also known as the Redfield–Pólya Theorem , is a theorem in combinatorics that both follows and ultimately generalizes Burnside's lemma on the number of orbits of a group action on a set. The theorem was first published by John Howard Redfield in 1927. In 1937 it was independently rediscovered by George Pólya , who then greatly popularized the result by applying it to many counting problems, in particular to the enumeration of chemical compounds .  The Pólya enumeration theorem can also be incorporated into symbolic combinatorics and the theory of combinatorial species .  A simplified, unweighted version  Let X be a finite set and let G be a group of permutations of X (or a finite symmetry group that acts on X ). The set X may represent a finite set of beads, and G may be a chosen group of permutations of the beads. For example, if X is a necklace of n beads in a circle, then rotational symmetry is relevant so G is the cyclic group  C n , while if X is a bracelet of n beads in a circle, rotations and reflections are relevant so G is the dihedral group  D n of order 2n . Suppose further that Y is a finite set of colors — the colors of the beads — so that Y X is the set of colored arrangements of beads, and suppose that there are     |  Y  |   =  t        Y   t    \left|Y\right|=t   colors. (More formally, a given "coloring" is a function    X  →  Y     normal-→  X  Y    X\to Y   .) Then the Pólya enumeration theorem counts the number of orbits under G of colored arrangements of beads by the following formula:       |    Y  X   /  G   |   =    1   |  G  |      ∑   g  ∈  G     t   c   (  g  )                superscript  Y  X   G        1    G      subscript     g  G     superscript  t    c  g        |Y^{X}/G|=\frac{1}{|G|}\sum_{g\in G}t^{c(g)}   where     |  Y  |   =  t        Y   t    \left|Y\right|=t   and c ( g ) is the number of cycles of the group element g as a permutation of X .  The full, weighted version  In the more general and more important version of the theorem, the colors are also weighted in one or more ways, and there could be an infinite number of colors provided that the set of colors has a generating function with finite coefficients. In the univariate case, suppose that       f   (  x  )    =    f  0   +    f  1   x   +    f  2    x  2    +  ⋯         f  x      subscript  f  0      subscript  f  1   x      subscript  f  2    superscript  x  2    normal-⋯     f(x)=f_{0}+f_{1}x+f_{2}x^{2}+\cdots   is the generating function of the set of colors, so that there are f n colors of weight n for each n ≥ 0. In the multivariate case, the weight of each color is a vector of integers and there is a generating function f(a,b,...) that tabulates the number of colors with each given vector of weights.  The enumeration theorem employs another multivariate generating function called the cycle index :         Z  G    (   t  1   ,   t  2   ,  …  ,   t  n   )    =    1   |  G  |      ∑   g  ∈  G      t  1    j  1    (  g  )      t  2    j  2    (  g  )     ⋯   t  n    j  n    (  g  )         .         subscript  Z  G     subscript  t  1    subscript  t  2   normal-…   subscript  t  n         1    G      subscript     g  G       superscript   subscript  t  1      subscript  j  1   g     superscript   subscript  t  2      subscript  j  2   g    normal-⋯   superscript   subscript  t  n      subscript  j  n   g         Z_{G}(t_{1},t_{2},\ldots,t_{n})=\frac{1}{|G|}\sum_{g\in G}t_{1}^{j_{1}(g)}t_{2%
 }^{j_{2}(g)}\cdots t_{n}^{j_{n}(g)}.   Here the k th weight j k ( g ) is the number of k -cycles of g as a permutation of X . The theorem then says that the generating function F of colored arrangements is the cycle index, composed with the generating function f of the colors, composed with powers of the variables of f :       F   (  x  )    =    Z  G    (   f   (  x  )    ,   f   (   x  2   )    ,   f   (   x  3   )    ,  …  ,   f   (   x  n   )    )          F  x      subscript  Z  G      f  x     f   superscript  x  2      f   superscript  x  3    normal-…    f   superscript  x  n        F(x)=Z_{G}(f(x),f(x^{2}),f(x^{3}),\ldots,f(x^{n}))   or in the multivariate case:        F   (  a  ,  b  ,  …  )    =    Z  G    (   f   (  a  ,  b  ,  …  )    ,   f   (   a  2   ,   b  2   ,  …  )    ,   f   (   a  3   ,   b  3   ,  …  )    ,  …  ,   f   (   a  n   ,   b  n   ,  …  )    )     .        F   a  b  normal-…       subscript  Z  G      f   a  b  normal-…      f    superscript  a  2    superscript  b  2   normal-…      f    superscript  a  3    superscript  b  3   normal-…    normal-…    f    superscript  a  n    superscript  b  n   normal-…        F(a,b,\ldots)=Z_{G}(f(a,b,\ldots),f(a^{2},b^{2},\ldots),f(a^{3},b^{3},\ldots),%
 \ldots,f(a^{n},b^{n},\ldots)).   To reduce to the simplified version, if there are t colors of weight 0, then        |    Y  X   /  G   |   =    Z  G    (  t  ,  t  ,  …  ,  t  )     .           superscript  Y  X   G       subscript  Z  G    t  t  normal-…  t      |Y^{X}/G|=Z_{G}(t,t,\ldots,t).     In the celebrated application of counting trees (see below) and acyclic molecules, an arrangement of "colored beads" is actually an arrangement of arrangements, such as branches of a rooted tree. Thus the generating function f for the colors is derived from the generating function F for arrangements, and the Pólya enumeration theorem becomes a recursive formula.  Examples  Graphs on three and four vertices  A graph on m vertices can be interpreted as an arrangement of colored beads. The arrangement X is the set of    (      m      2      )     binomial  m  2    {\left({{m}\atop{2}}\right)}   possible edges, while the set of colors Y = {black,white} corresponds to edges that are present (black) or absent (white). The Pólya enumeration theorem can be used to calculate the number of graphs up to isomorphism with a fixed number of vertices, or the generating function of these graphs according to the number of edges they have. For the latter purpose, we can say that a black or present edge has weight 1, while an absent or white edge has weight 0. Thus     f   (  t  )    =   1  +  t         f  t     1  t     f(t)=1+t   is the generating function for the set of colors. The relevant symmetry group is    G  =   S  m       G   subscript  S  m     G=S_{m}   , the symmetric group on m letters; an isomorphism class of graphs is equivalent to an orbit of graphs under this group. It acts as a subgroup of    S   (      m      2      )      subscript  S   binomial  m  2     S_{{\left({{m}\atop{2}}\right)}}   , the group of permutations of all of the edges.    The 8 graphs on three vertices without quotienting by symmetry are shown at the right. There are four isomorphism classes of graphs, also shown at the right.  The cycle index of the permutation group of the edges is         Z  G    (   t  1   ,   t  2   ,   t  3   )    =     t  1  3   +   3   t  1    t  2    +   2   t  3     6    .         subscript  Z  G     subscript  t  1    subscript  t  2    subscript  t  3          superscript   subscript  t  1   3     3   subscript  t  1    subscript  t  2      2   subscript  t  3     6     Z_{G}(t_{1},t_{2},t_{3})=\frac{t_{1}^{3}+3t_{1}t_{2}+2t_{3}}{6}.   Thus, according to the enumeration theorem, the generating function of graphs on 3 vertices up to isomorphism is        F   (  t  )    =    Z  G    (   t  +  1   ,    t  2   +  1   ,    t  3   +  1   )    =      (   t  +  1   )   3   +   3   (   t  +  1   )    (    t  2   +  1   )    +   2   (    t  3   +  1   )     6    ,          F  t      subscript  Z  G      t  1      superscript  t  2   1      superscript  t  3   1               superscript    t  1   3     3    t  1      superscript  t  2   1      2     superscript  t  3   1     6      F(t)=Z_{G}(t+1,t^{2}+1,t^{3}+1)=\frac{(t+1)^{3}+3(t+1)(t^{2}+1)+2(t^{3}+1)}{6},   which simplifies to       F   (  t  )    =    t  3   +   t  2   +  t  +  1.         F  t      superscript  t  3    superscript  t  2   t  1.     F(t)=t^{3}+t^{2}+t+1.   Thus there is one graph each with 0 to 3 edges.  The cycle index of the edge permutation group for graphs on four vertices is:         Z  G    (   t  1   ,   t  2   ,   t  3   ,   t  4   )    =     t  1  6   +   9   t  1  2    t  2  2    +   8   t  3  2    +   6   t  2    t  4     24    .         subscript  Z  G     subscript  t  1    subscript  t  2    subscript  t  3    subscript  t  4          superscript   subscript  t  1   6     9   superscript   subscript  t  1   2    superscript   subscript  t  2   2      8   superscript   subscript  t  3   2      6   subscript  t  2    subscript  t  4     24     Z_{G}(t_{1},t_{2},t_{3},t_{4})=\frac{t_{1}^{6}+9t_{1}^{2}t_{2}^{2}+8t_{3}^{2}+%
 6t_{2}t_{4}}{24}.   Hence       F   (  t  )    =    Z  G    (   t  +  1   ,    t  2   +  1   ,    t  3   +  1   ,    t  4   +  1   )    =       (   t  +  1   )   6   +   9    (   t  +  1   )   2     (    t  2   +  1   )   2    +   8    (    t  3   +  1   )   2    +   6   (    t  2   +  1   )    (    t  4   +  1   )     24            F  t      subscript  Z  G      t  1      superscript  t  2   1      superscript  t  3   1      superscript  t  4   1               superscript    t  1   6     9   superscript    t  1   2    superscript     superscript  t  2   1   2      8   superscript     superscript  t  3   1   2      6     superscript  t  2   1      superscript  t  4   1     24      F(t)=Z_{G}(t+1,t^{2}+1,t^{3}+1,t^{4}+1)=\frac{(t+1)^{6}+9(t+1)^{2}(t^{2}+1)^{2%
 }+8(t^{3}+1)^{2}+6(t^{2}+1)(t^{4}+1)}{24}\,   which simplifies to       F   (  t  )    =    t  6   +   t  5   +   2   t  4    +   3   t  3    +   2   t  2    +  t  +  1.         F  t      superscript  t  6    superscript  t  5     2   superscript  t  4      3   superscript  t  3      2   superscript  t  2    t  1.     F(t)=t^{6}+t^{5}+2t^{4}+3t^{3}+2t^{2}+t+1.   These graphs are shown at the right.  Rooted ternary trees  The set T 3 of rooted ternary trees consists of rooted trees where every node has exactly three children (leaves or subtrees). Small ternary trees are shown at right. Note that ternary trees with n vertices are equivalent to trees with n vertices of degree at most 3. In general, rooted trees are isomorphic when one can be obtained from the other by permuting the children of its nodes. In other words, the group that acts on the children of a node is the symmetric group S 3 . We define the weight of such a ternary tree to be the number of nodes (or non-leaf vertices).  We can view a rooted, ternary tree as a recursive object which is either a leaf or three branches which are themselves rooted ternary trees. These branches are equivalent to beads; the cycle index of the symmetric group S 3 that acts on them is then         Z   S  3     (   t  1   ,   t  2   ,   t  3   )    =     t  1  3   +   3   t  1    t  2    +   2   t  3     6    .         subscript  Z   subscript  S  3      subscript  t  1    subscript  t  2    subscript  t  3          superscript   subscript  t  1   3     3   subscript  t  1    subscript  t  2      2   subscript  t  3     6     Z_{S_{3}}(t_{1},t_{2},t_{3})=\frac{t_{1}^{3}+3t_{1}t_{2}+2t_{3}}{6}.   The Polya enumeration theorem then yields a functional equation for the generating function T ( x ) of the rooted ternary trees:        T   (  x  )    =   1  +   x     T    (  x  )   3    +   3  T   (  x  )   T   (   x  2   )    +   2  T   (   x  3   )     6      .        T  x     1    x        T   superscript  x  3      3  T  x  T   superscript  x  2      2  T   superscript  x  3     6       T(x)=1+x\frac{T(x)^{3}+3T(x)T(x^{2})+2T(x^{3})}{6}.   This is equivalent to the following recurrence formula for the number t n of rooted ternary trees with n nodes:       t  0   =  1       subscript  t  0   1    t_{0}=1   and       t   n  +  1    =    1  6    (     ∑    a  +  b  +  c   =  n      t  a    t  b    t  c     +   3    ∑    a  +   2  b    =  n      t  a    t  b      +   2    ∑    3  a   =  n     t  a      )         subscript  t    n  1        1  6       subscript       a  b  c   n       subscript  t  a    subscript  t  b    subscript  t  c       3    subscript       a    2  b    n       subscript  t  a    subscript  t  b        2    subscript       3  a   n     subscript  t  a         t_{n+1}=\frac{1}{6}\left(\sum_{a+b+c=n}t_{a}t_{b}t_{c}+3\sum_{a+2b=n}t_{a}t_{b%
 }+2\sum_{3a=n}t_{a}\right)   where a , b and c are nonnegative integers.  The first few values of    t  n     subscript  t  n    t_{n}   are   1, 1, 1, 2, 4, 8, 17, 39, 89, 211, 507, 1238, 3057, 7639, 19241   Colored cubes  How many ways are there to color the sides of a 3-dimensional cube with t colors, up to rotation of the cube? The rotation group C of the cube acts on the six sides of the cube, which are equivalent to beads. Its cycle index is         Z  C    (   t  1   ,   t  2   ,   t  3   ,   t  4   )    =     t  1  6   +   6   t  1  2    t  4    +   3   t  1  2    t  2  2    +   8   t  3  2    +   6   t  2  3     24    .         subscript  Z  C     subscript  t  1    subscript  t  2    subscript  t  3    subscript  t  4          superscript   subscript  t  1   6     6   superscript   subscript  t  1   2    subscript  t  4      3   superscript   subscript  t  1   2    superscript   subscript  t  2   2      8   superscript   subscript  t  3   2      6   superscript   subscript  t  2   3     24     Z_{C}(t_{1},t_{2},t_{3},t_{4})=\frac{t_{1}^{6}+6t_{1}^{2}t_{4}+3t_{1}^{2}t_{2}%
 ^{2}+8t_{3}^{2}+6t_{2}^{3}}{24}.   Thus there are        Z  C    (  t  ,  t  ,  t  ,  t  )    =     t  6   +   3   t  4    +   12   t  3    +   8   t  2     24          subscript  Z  C    t  t  t  t         superscript  t  6     3   superscript  t  4      12   superscript  t  3      8   superscript  t  2     24     Z_{C}(t,t,t,t)=\frac{t^{6}+3t^{4}+12t^{3}+8t^{2}}{24}   colorings.  Proof of theorem  The simplified form of the Pólya enumeration theorem follows from Burnside's lemma , which says that the number of orbits of colorings is the average of the number of elements of    Y  X     superscript  Y  X    Y^{X}   fixed by the permutation g of G over all permutations g . The weighted version of the theorem has essentially the same proof, but with a refined form of Burnside's lemma for weighted enumeration. It is equivalent to apply Burnside's lemma separately to orbits of different weight.  For clearer notation, let     x  1   ,   x  2   ,  …      subscript  x  1    subscript  x  2   normal-…    x_{1},x_{2},\ldots   be the variables of the generating function f of   Y   Y   Y   . Given a vector of weights   ω   ω   \omega   , let    x  ω     superscript  x  ω    x^{\omega}   denote the corresponding monomial term of f . Applying Burnside's lemma to orbits of weight   ω   ω   \omega   , the number of orbits of this weight is       1   |  G  |      ∑   g  ∈  G     |    (   Y  X   )    ω  ,  g    |          1    G      subscript     g  G       subscript   superscript  Y  X    ω  g        \frac{1}{|G|}\sum_{g\in G}|(Y^{X})_{\omega,g}|   where     (   Y  X   )    ω  ,  g      subscript   superscript  Y  X    ω  g     (Y^{X})_{\omega,g}   is the set of colorings of weight   ω   ω   \omega   that are also fixed by g . If we then sum over all possible weights, we obtain        F   (   x  1   ,   x  2   ,  …  )    =    1   |  G  |      ∑   g  ∈   G  ,  ω       x  ω    |    (   Y  X   )    ω  ,  g    |       .        F    subscript  x  1    subscript  x  2   normal-…        1    G      subscript     g   G  ω        superscript  x  ω      subscript   superscript  Y  X    ω  g          F(x_{1},x_{2},\ldots)=\frac{1}{|G|}\sum_{g\in G,\omega}x^{\omega}|(Y^{X})_{%
 \omega,g}|.     Meanwhile g has a cycle structure     j  1   ,   j  2   ,  …  ,   j  n       subscript  j  1    subscript  j  2   normal-…   subscript  j  n     j_{1},j_{2},\ldots,j_{n}   which contributes       t  1    j  1    (  g  )      t  2    j  2    (  g  )     ⋯   t  n    j  n    (  g  )          superscript   subscript  t  1      subscript  j  1   g     superscript   subscript  t  2      subscript  j  2   g    normal-⋯   superscript   subscript  t  n      subscript  j  n   g      t_{1}^{j_{1}(g)}t_{2}^{j_{2}(g)}\cdots t_{n}^{j_{n}(g)}   to the cycle index of G . The element g fixes an element of    Y  X     superscript  Y  X    Y^{X}   if and only if it is constant on every cycle q of g . The generating function by weight of a cycle q of | q | identical elements from the set of objects enumerated by f is       f   (   x  1   |  q  |    ,   x  2   |  q  |    ,   x  3   |  q  |    ,  …  )    .      f    superscript   subscript  x  1     q     superscript   subscript  x  2     q     superscript   subscript  x  3     q    normal-…     f(x_{1}^{|q|},x_{2}^{|q|},x_{3}^{|q|},\ldots).   It follows that the generating function by weight of the points fixed by g is the product of the above term over all cycles of g , i.e.         ∑  ω     x  ω    |    (   Y  X   )    ω  ,  g    |     =    ∏   q  ∈  g     f   (   x  1   |  q  |    ,   x  2   |  q  |    ,   x  3   |  q  |    ,  …  )      ,        subscript   ω      superscript  x  ω      subscript   superscript  Y  X    ω  g         subscript  product    q  g      f    superscript   subscript  x  1     q     superscript   subscript  x  2     q     superscript   subscript  x  3     q    normal-…       \sum_{\omega}x^{\omega}|(Y^{X})_{\omega,g}|=\prod_{q\in g}f(x_{1}^{|q|},x_{2}^%
 {|q|},x_{3}^{|q|},\ldots),   which equals       f    (   x  1   ,   x  2   ,  …  )     j  1    (  g  )     f    (   x  1  2   ,   x  2  2   ,  …  )     j  2    (  g  )     ⋯  f    (   x  1  n   ,   x  2  n   ,  …  )     j  n    (  g  )      .      f   superscript    subscript  x  1    subscript  x  2   normal-…      subscript  j  1   g    f   superscript    superscript   subscript  x  1   2    superscript   subscript  x  2   2   normal-…      subscript  j  2   g    normal-⋯  f   superscript    superscript   subscript  x  1   n    superscript   subscript  x  2   n   normal-…      subscript  j  n   g      f(x_{1},x_{2},\ldots)^{j_{1}(g)}f(x_{1}^{2},x_{2}^{2},\ldots)^{j_{2}(g)}\cdots
 f%
 (x_{1}^{n},x_{2}^{n},\ldots)^{j_{n}(g)}.   Substituting this for     ∑  ω     x  ω    |    (   Y  X   )    ω  ,  g    |        subscript   ω      superscript  x  ω      subscript   superscript  Y  X    ω  g        \sum_{\omega}x^{\omega}|(Y^{X})_{\omega,g}|\,   in the sum over all g yields the substituted cycle index as claimed.  References        External links   Applying the Pólya-Burnside Enumeration Theorem by Hector Zenil and Oleksandr Pavlyk, The Wolfram Demonstrations Project .   Frederic Chyzak Enumerating alcohols and other classes of chemical molecules, an example of Pólya theory .  Marko Riedel, Pólya's enumeration theorem and the symbolic method .   "  Category:Enumerative combinatorics  Category:Articles containing proofs  Category:Graph enumeration  Category:Theorems in combinatorics   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="500">Index of coincidence</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Index of coincidence</h1>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, <strong>coincidence counting</strong> is the technique (invented by <a href="William_F._Friedman" title="wikilink">William F. Friedman</a><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a>) of putting two texts side-by-side and counting the number of times that identical letters appear in the same position in both texts. This count, either as a ratio of the total or normalized by dividing by the expected count for a random source model, is known as the <strong>index of coincidence</strong>, or <strong>IC</strong> for short.</p>
<h2 id="calculation">Calculation</h2>

<p>The index of coincidence provides a measure of how likely it is to draw two matching letters by randomly selecting two letters from a given text. The chance of drawing a given letter in the text is (number of times that letter appears / length of the text). The chance of drawing that same letter again (without replacement) is (appearances - 1 / text length - 1). The product of these two values gives you the chance of drawing that letter twice in a row. One can find this product for each letter that appears in the text, then sum these products to get a chance of drawing two of a kind. This probability can then be normalized by multiplying it by some coefficient, typically 26 in English.</p>

<p>

<math display="block" id="Index_of_coincidence:0">
 <semantics>
  <mrow>
   <mi>ùêàùêÇ</mi>
   <mo>=</mo>
   <mrow>
    <mi>c</mi>
    <mo>√ó</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>n</mi>
          <mi mathvariant="normal">a</mi>
         </msub>
         <mi>N</mi>
        </mfrac>
        <mo>√ó</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>n</mi>
           <mi mathvariant="normal">a</mi>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>n</mi>
          <mi mathvariant="normal">b</mi>
         </msub>
         <mi>N</mi>
        </mfrac>
        <mo>√ó</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>n</mi>
           <mi mathvariant="normal">b</mi>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">‚Ä¶</mi>
      <mo>+</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>n</mi>
          <mi mathvariant="normal">z</mi>
         </msub>
         <mi>N</mi>
        </mfrac>
        <mo>√ó</mo>
        <mfrac>
         <mrow>
          <msub>
           <mi>n</mi>
           <mi mathvariant="normal">z</mi>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêàùêÇ</ci>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>normal-a</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>normal-a</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>normal-b</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>normal-b</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>normal-z</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>normal-z</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{IC}=c\times\left({\left({\frac{n_{\mathrm{a}}}{N}\times\frac{n_{%
\mathrm{a}}-1}{N-1}}\right)+\left({\frac{n_{\mathrm{b}}}{N}\times\frac{n_{%
\mathrm{b}}-1}{N-1}}\right)+...+\left({\frac{n_{\mathrm{z}}}{N}\times\frac{n_{%
\mathrm{z}}-1}{N-1}}\right)}\right)
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd>Where <em>c</em> is the normalizing coefficient (26 for English), <em>n</em><sub>a</sub> is the number of times the letter "a" appears in the text, and <em>N</em> is the length of the text.
</dd>
</dl>

<p>We can express the index of coincidence <strong>IC</strong> for a given letter-frequency distribution as a summation:</p>

<p>

<math display="block" id="Index_of_coincidence:1">
 <semantics>
  <mrow>
   <mi>ùêàùêÇ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mstyle displaystyle="true">
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>c</mi>
      </munderover>
     </mstyle>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>n</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mi>N</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>N</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mi>c</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêàùêÇ</ci>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>N</ci>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{IC}=\frac{\displaystyle\sum_{i=1}^{c}n_{i}(n_{i}-1)}{N(N-1)/c}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>N</em> is the length of the text and <em>n</em><sub>1</sub> through <em>n<sub>c</sub></em> are the <a href="Letter_frequencies" title="wikilink">frequencies</a> (as integers) of the <em>c</em> letters of the alphabet (<em>c</em> = 26 for monocase <a href="English_language" title="wikilink">English</a>). The sum of the <em>n<sub>i</sub></em> is necessarily <em>N</em>.</p>

<p>The products 

<math display="inline" id="Index_of_coincidence:2">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>n</mi>
     <mi mathvariant="normal">‚àí</mi>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>normal-‚àí</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n(n‚àí1)
  </annotation>
 </semantics>
</math>

 count the number of <a class="uri" href="combinations" title="wikilink">combinations</a> of <em>n</em> elements taken two at a time. (Actually this counts each pair twice; the extra factors of 2 occur in both numerator and denominator of the formula and thus cancel out.) Each of the <em>n<sub>i</sub></em> occurrences of the <em>i</em>-th letter matches each of the remaining <mtpl></mtpl> occurrences of the same letter. There are a total of 

<math display="inline" id="Index_of_coincidence:3">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>N</mi>
     <mi mathvariant="normal">‚àí</mi>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <ci>normal-‚àí</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N(N‚àí1)
  </annotation>
 </semantics>
</math>

 letter pairs in the entire text, and 1/<em>c</em> is the probability of a match for each pair, assuming a uniform <a class="uri" href="random" title="wikilink">random</a> distribution of the characters (the "null model"; see below). Thus, this formula gives the ratio of the total number of coincidences observed to the total number of coincidences that one would expect from the null model.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>The expected average value for the IC can be computed from the relative letter frequencies <mtpl></mtpl> of the source language:</p>

<p>

<math display="block" id="Index_of_coincidence:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ùêàùêÇ</mi>
     <mi>expected</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mstyle displaystyle="true">
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>c</mi>
       </munderover>
      </mstyle>
      <mmultiscripts>
       <mi>f</mi>
       <mi>i</mi>
       <none></none>
       <none></none>
       <mn>2</mn>
      </mmultiscripts>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mi>c</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêàùêÇ</ci>
     <ci>expected</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{IC}_{\mathrm{expected}}=\frac{\displaystyle\sum_{i=1}^{c}{f_{i}}^{2}}{%
1/c}.
  </annotation>
 </semantics>
</math>

</p>

<p>If all 

<math display="inline" id="Index_of_coincidence:5">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 letters of an alphabet were equally distributed, the expected index would be 1.0. The actual monographic IC for <a href="telegraph" title="wikilink">telegraphic</a> English text is around 1.73, reflecting the unevenness of <a href="natural_language" title="wikilink">natural-language</a> letter distributions.</p>

<p>Sometimes values are reported without the normalizing denominator, for example 

<math display="inline" id="Index_of_coincidence:6">
 <semantics>
  <mrow>
   <mn>0.067</mn>
   <mo>=</mo>
   <mrow>
    <mn>1.73</mn>
    <mo>/</mo>
    <mn>26</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="float">0.067</cn>
    <apply>
     <divide></divide>
     <cn type="float">1.73</cn>
     <cn type="integer">26</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0.067=1.73/26
  </annotation>
 </semantics>
</math>

 for English; such values may be called <em>Œ∫</em><sub>p</sub> ("kappa-plaintext") rather than IC, with <em>Œ∫</em><sub>r</sub> ("kappa-random") used to denote the denominator 

<math display="inline" id="Index_of_coincidence:7">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/c
  </annotation>
 </semantics>
</math>

 (which is the expected coincidence rate for a uniform distribution of the same alphabet, 

<math display="inline" id="Index_of_coincidence:8">
 <semantics>
  <mrow>
   <mn>0.0385</mn>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mn>26</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <cn type="float">0.0385</cn>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">26</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0.0385=1/26
  </annotation>
 </semantics>
</math>

 for English).</p>
<h2 id="application">Application</h2>

<p>The index of coincidence is useful both in the analysis of <a href="natural_language" title="wikilink">natural-language</a> <a class="uri" href="plaintext" title="wikilink">plaintext</a> and in the analysis of <a href="encryption" title="wikilink">ciphertext</a> (<a class="uri" href="cryptanalysis" title="wikilink">cryptanalysis</a>). Even when only ciphertext is available for testing and plaintext letter identities are disguised, coincidences in ciphertext can be caused by coincidences in the underlying plaintext. This technique is used to <a href="Vigen%C3%A8re_cipher#Cryptanalysis" title="wikilink">cryptanalyze</a> the <a href="Vigen√®re_cipher" title="wikilink">Vigen√®re cipher</a>, for example. For a repeating-key <a href="polyalphabetic_cipher" title="wikilink">polyalphabetic cipher</a> arranged into a matrix, the coincidence rate within each column will usually be highest when the width of the matrix is a multiple of the key length, and this fact can be used to determine the key length, which is the first step in cracking the system.</p>

<p>Coincidence counting can help determine when two texts are written in the same language using the same <a class="uri" href="alphabet" title="wikilink">alphabet</a>. (This technique has been used to examine the purported <a href="Bible_code" title="wikilink">Bible code</a>). The <em>causal</em> coincidence count for such texts will be distinctly higher than the <em>accidental</em> coincidence count for texts in different languages, or texts using different alphabets, or gibberish texts.</p>

<p>To see why, imagine an "alphabet" of only the two letters A and B. Suppose that in our "language", the letter A is used 75% of the time, and the letter B is used 25% of the time. If two texts in this language are laid side by side, then the following pairs can be expected:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Pair</p></th>
<th style="text-align: left;">
<p>Probability</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>AA</p></td>
<td style="text-align: left;">
<p>56.25%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>BB</p></td>
<td style="text-align: left;">
<p>6.25%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>AB</p></td>
<td style="text-align: left;">
<p>18.75%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>BA</p></td>
<td style="text-align: left;">
<p>18.75%</p></td>
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>Overall, the probability of a "coincidence" is 62.5% (56.25% for AA + 6.25% for BB).</p>

<p>Now consider the case when <em>both</em> messages are encrypted using the simple monoalphabetic <a href="substitution_cipher" title="wikilink">substitution cipher</a> which replaces A with B and vice versa:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Pair</p></th>
<th style="text-align: left;">
<p>Probability</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>AA</p></td>
<td style="text-align: left;">
<p>6.25%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>BB</p></td>
<td style="text-align: left;">
<p>56.25%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>AB</p></td>
<td style="text-align: left;">
<p>18.75%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>BA</p></td>
<td style="text-align: left;">
<p>18.75%</p></td>
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>The overall probability of a coincidence in this situation is 62.5% (6.25% for AA + 56.25% for BB), exactly the same as for the unencrypted "plaintext" case. In effect, the new alphabet produced by the substitution is just a uniform renaming of the original character identities, which does not affect whether they match.</p>

<p>Now suppose that only <em>one</em> message (say, the second) is encrypted using the same substitution cipher (A,B)‚Üí(B,A). The following pairs can now be expected:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Pair</p></th>
<th style="text-align: left;">
<p>Probability</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>AA</p></td>
<td style="text-align: left;">
<p>18.75%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>BB</p></td>
<td style="text-align: left;">
<p>18.75%</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>AB</p></td>
<td style="text-align: left;">
<p>56.25%</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>BA</p></td>
<td style="text-align: left;">
<p>6.25%</p></td>
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>Now the probability of a coincidence is only 37.5% (18.75% for AA + 18.75% for BB). This is noticeably lower than the probability when same-language, same-alphabet texts were used. Evidently, coincidences are more likely when the most frequent letters in each text are the same.</p>

<p>The same principle applies to real languages like English, because certain letters, like E, occur much more frequently than other letters‚Äîa fact which is used in <a href="frequency_analysis_(cryptanalysis)" title="wikilink">frequency analysis</a> of <a href="substitution_cipher" title="wikilink">substitution ciphers</a>. Coincidences involving the letter E, for example, are relatively likely. So when any two English texts are compared, the coincidence count will be higher than when an English text and a foreign-language text are used.</p>

<p>It can easily be imagined that this effect can be subtle. For example, similar languages will have a higher coincidence count than dissimilar languages. Also, it isn't hard to generate random text with a frequency distribution similar to real text, artificially raising the coincidence count. Nevertheless, this technique can be used effectively to identify when two texts are likely to contain meaningful information in the same language using the same alphabet, to discover periods for repeating keys, and to uncover many other kinds of nonrandom phenomena within or among ciphertexts.</p>

<p>Expected values for various languages<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> are:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Language</p></th>
<th style="text-align: left;">
<p>Index of Coincidence</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>English</p></td>
<td style="text-align: left;">
<p>1.73</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>French</p></td>
<td style="text-align: left;">
<p>2.02</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>German</p></td>
<td style="text-align: left;">
<p>2.05</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Italian</p></td>
<td style="text-align: left;">
<p>1.94</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Portuguese</p></td>
<td style="text-align: left;">
<p>1.94</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Russian</p></td>
<td style="text-align: left;">
<p>1.76</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Spanish</p></td>
<td style="text-align: left;">
<p>1.94</p></td>
</tr>
<tr class="even">
</tr>
</tbody>
</table>
<h2 id="generalization">Generalization</h2>

<p>The above description is only an introduction to use of the index of coincidence, which is related to the general concept of <a class="uri" href="correlation" title="wikilink">correlation</a>. Various forms of Index of Coincidence have been devised; the "delta" I.C. (given by the formula above) in effect measures the <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a> of a single distribution, whereas a "kappa" I.C. is used when matching two text strings.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Although in some applications constant factors such as 

<math display="inline" id="Index_of_coincidence:9">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Index_of_coincidence:10">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 can be ignored, in more general situations there is considerable value in truly <em>indexing</em> each I.C. against the value to be expected for the <a href="null_hypothesis" title="wikilink">null hypothesis</a> (usually: no match and a uniform random symbol distribution), so that in every situation the <a href="expected_value" title="wikilink">expected value</a> for no correlation is 1.0. Thus, any form of I.C. can be expressed as the ratio of the number of coincidences actually observed to the number of coincidences expected (according to the null model), using the particular test setup.</p>

<p>From the foregoing, it is easy to see that the formula for kappa I.C.' is</p>

<p>

<math display="block" id="Index_of_coincidence:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùêàùêÇ</mi>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mstyle displaystyle="true">
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
      </mstyle>
      <mrow>
       <mo stretchy="false">[</mo>
       <msub>
        <mi>a</mi>
        <mi>j</mi>
       </msub>
       <mo>=</mo>
       <msub>
        <mi>b</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>N</mi>
      <mo>/</mo>
      <mi>c</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùêàùêÇ</ci>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-[</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>j</ci>
       </apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>j</ci>
       </apply>
       <ci>normal-]</ci>
      </cerror>
     </cerror>
     <apply>
      <divide></divide>
      <ci>N</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{IC}=\frac{\displaystyle\sum_{j=1}^{N}[a_{j}=b_{j}]}{N/c},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Index_of_coincidence:12">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the common aligned length of the two texts <em>A</em> and <em>B</em>, and the bracketed term is defined as 1 if the 

<math display="inline" id="Index_of_coincidence:13">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

-th letter of text <em>A</em> matches the 

<math display="inline" id="Index_of_coincidence:14">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

-th letter of text <em>B</em>, otherwise 0.</p>

<p>A related concept, the "bulge" of a distribution, measures the discrepancy between the observed I.C. and the null value of 1.0. The number of cipher alphabets used in a <a href="polyalphabetic_cipher" title="wikilink">polyalphabetic cipher</a> may be estimated by dividing the expected bulge of the delta I.C. for a single alphabet by the observed bulge for the message, although in many cases (such as when a <a href="Vigen√®re_cipher" title="wikilink">repeating key</a> was used) better techniques are available.</p>
<h2 id="example">Example</h2>

<p>As a practical illustration of the use of I.C., suppose that we have intercepted the following ciphertext message:</p>
<pre><code><nowiki>
QPWKA LVRXC QZIKG RBPFA EOMFL  JMSDZ VDHXC XJYEB IMTRQ WNMEA
IZRVK CVKVL XNEIC FZPZC ZZHKM  LVZVZ IZRRQ WDKEC HOSNY XXLSP
MYKVQ XJTDC IOMEE XDQVS RXLRL  KZHOV
</nowiki></code></pre>

<p>(The grouping into five characters is just a <a href="Telegraphy" title="wikilink">telegraphic</a> convention and has nothing to do with actual word lengths.) Suspecting this to be an English plaintext encrypted using a <a href="Vigen√®re_cipher" title="wikilink">Vigen√®re cipher</a> with normal A‚ÄìZ components and a short repeating keyword, we can consider the ciphertext "stacked" into some number of columns, for example seven:</p>
<pre><code><nowiki>
QPWKALV
RXCQZIK
GRBPFAE
OMFLJMS
DZVDHXC
XJYEBIM
TRQWN‚Ä¶
</nowiki></code></pre>

<p>If the key size happens to have been the same as the assumed number of columns, then all the letters within a single column will have been enciphered using the same key letter, in effect a simple <a href="Caesar_cipher" title="wikilink">Caesar cipher</a> applied to a random selection of English plaintext characters. The corresponding set of ciphertext letters should have a roughness of frequency distribution similar to that of English, although the letter identities have been permuted (shifted by a constant amount corresponding to the key letter). Therefore if we compute the aggregate delta I.C. for all columns ("delta bar"), it should be around 1.73. On the other hand, if we have incorrectly guessed the key size (number of columns), the aggregate delta I.C. should be around 1.00. So we compute the delta I.C. for assumed key sizes from one to ten:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Size</p></th>
<th style="text-align: left;">
<p>Delta-bar I.C.</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>1.12</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1.19</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>1.05</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>1.17</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>1.82</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>0.99</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>1.00</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>1.05</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p>1.16</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>2.07</p></td>
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>We see that the key size is most likely five. If the actual size is five, we would expect a width of ten to also report a high I.C., since each of its columns also corresponds to a simple Caesar encipherment, and we confirm this. So we should stack the ciphertext into five columns:</p>
<pre><code><nowiki>
QPWKA
LVRXC
QZIKG
RBPFA
EOMFL
JMSDZ
VDH‚Ä¶
</nowiki></code></pre>

<p>We can now try to determine the most likely key letter for each column considered separately, by performing trial Caesar decryption of the entire column for each of the 26 possibilities A‚ÄìZ for the key letter, and choosing the key letter that produces the highest correlation between the decrypted column letter frequencies and the relative <a href="letter_frequencies" title="wikilink">letter frequencies</a> for normal English text. That correlation, which we don't need to worry about normalizing, can be readily computed as</p>

<p>

<math display="block" id="Index_of_coincidence:15">
 <semantics>
  <mrow>
   <mi>œá</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>c</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>f</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>œá</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>c</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\chi}=\sum_{i=1}^{c}n_{i}f_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Index_of_coincidence:16">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{i}
  </annotation>
 </semantics>
</math>

 are the observed column letter frequencies and 

<math display="inline" id="Index_of_coincidence:17">
 <semantics>
  <msub>
   <mi>f</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>f</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{i}
  </annotation>
 </semantics>
</math>

 are the relative letter frequencies for English. When we try this, the best-fit key letters are reported to be "<code>EVERY</code>," which we recognize as an actual word, and using that for Vigen√®re decryption produces the plaintext:</p>
<pre><code><nowiki>
MUSTC HANGE MEETI NGLOC ATION FROMB RIDGE TOUND ERPAS 
SSINC EENEM YAGEN TSARE BELIE VEDTO HAVEB EENAS SIGNE 
DTOWA TCHBR IDGES TOPME ETING TIMEU NCHAN GEDXX
</nowiki></code></pre>

<p>from which one obtains:</p>
<pre><code><nowiki>
MUST CHANGE MEETING LOCATION FROM BRIDGE TO UNDERPASS
SINCE ENEMY AGENTS ARE BELIEVED TO HAVE BEEN ASSIGNED
TO WATCH BRIDGE STOP  MEETING TIME UNCHANGED  XX
</nowiki></code></pre>

<p>after word divisions have been restored at the obvious positions. "<code>XX</code>" are evidently "null" characters used to pad out the final group for transmission.</p>

<p>This entire procedure could easily be packaged into an automated algorithm for breaking such ciphers. Due to normal statistical fluctuation, such an algorithm will occasionally make wrong choices, especially when analyzing short ciphertext messages.</p>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Kasiski_examination" title="wikilink">Kasiski examination</a></li>
<li><a href="Topics_in_cryptography" title="wikilink">Topics in cryptography</a></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Cryptography" title="wikilink">Category:Cryptography</a> <a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a> <a href="Category:Summary_statistics_for_contingency_tables" title="wikilink">Category:Summary statistics for contingency tables</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"> The original application ignored normalization.<a href="#fnref1">‚Ü©</a></li>
<li id="fn2"> Published in two parts.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><a href="#fnref4">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

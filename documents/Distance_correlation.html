<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="197">Distance correlation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Distance correlation</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a> and in <a href="probability_theory" title="wikilink">probability theory</a>, <strong>distance correlation</strong> is a measure of <a href="statistical_dependence" title="wikilink">statistical dependence</a> between two <a href="random_variable" title="wikilink">random variables</a> or two <a href="random_vector" title="wikilink">random vectors</a> of arbitrary, not necessarily equal <a href="Euclidean_vector" title="wikilink">dimension</a>. An important property is that this measure of dependence is zero if and only if the <a href="multivariate_random_variable" title="wikilink">random variables</a> are <a href="statistically_independent" title="wikilink">statistically independent</a>. This measure is derived from a number of other quantities that are used in its specification, specifically: <strong>distance variance</strong>, <strong>distance standard deviation</strong> and <strong>distance covariance</strong>. These take the same roles as the ordinary <a href="Moment_(mathematics)" title="wikilink">moments</a> with corresponding names in the specification of the <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">Pearson product-moment correlation coefficient</a>.</p>

<p>These distance-based measures can be put into an indirect relationship to the ordinary moments by an <a href="#Alternative_formulation:_Brownian_covariance" title="wikilink">alternative formulation</a> (described below) using ideas related to <a href="Brownian_motion" title="wikilink">Brownian motion</a>, and this has led to the use of names such as <strong>Brownian covariance</strong> and <strong>Brownian distance covariance</strong>.</p>
<figure><b>(Figure)</b>
<figcaption>Several sets of (<em>x</em>, <em>y</em>) points, with the Distance correlation coefficient of <em>x</em> and <em>y</em> for each set. Compare to the graph on <a class="uri" href="correlation" title="wikilink">correlation</a></figcaption>
</figure>
<h2 id="background">Background</h2>

<p>The classical measure of dependence, the <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">Pearson correlation coefficient</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is mainly sensitive to a linear relationship between two variables. Distance correlation was introduced in 2005 by <a href="Gabor_J_Szekely" title="wikilink">Gabor J Szekely</a> in several lectures to address this deficiency of Pearson’s <a class="uri" href="correlation" title="wikilink">correlation</a>, namely that it can easily be zero for dependent variables. Correlation = 0 (uncorrelatedness) does not imply independence while distance correlation = 0 does imply independence. The first results on distance correlation were published in 2007 and 2009.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> It was proved that distance covariance is the same as the Brownian covariance.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> These measures are examples of <a href="energy_distance" title="wikilink">energy distances</a>.</p>
<h2 id="definitions">Definitions</h2>
<h3 id="distance-covariance">Distance covariance</h3>

<p>Let us start with the definition of the <strong>sample distance covariance</strong>. Let (<em>X</em><sub><em>k</em></sub>, <em>Y</em><sub><em>k</em></sub>), <em>k</em>= 1, 2, ..., <em>n</em> be a <a href="statistical_sample" title="wikilink">statistical sample</a> from a pair of real valued or vector valued random variables (<em>X</em>, <em>Y</em>). First, compute all pairwise <a href="Euclidean_distance" title="wikilink">distances</a></p>

<p>

<math display="inline" id="Distance_correlation:0">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>j</mi>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <list>
     <ci>j</ci>
     <ci>k</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle a_{j,k}
  </annotation>
 </semantics>
</math>


</p>

<p>where || ⋅ || denotes <a href="Euclidean_norm" title="wikilink">Euclidean norm</a>. That is, compute the <em>n</em> by <em>n</em> distance matrices (<em>a</em><sub><em>j</em>, <em>k</em></sub>) and (<em>b</em><sub><em>j</em>, <em>k</em></sub>). Then take all doubly centered distances</p>

<p>

<math display="block" id="Distance_correlation:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi>j</mi>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
     </msub>
     <mo>:=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>a</mi>
        <mrow>
         <mi>j</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>a</mi>
         <mo>¯</mo>
        </mover>
        <mrow>
         <mi>j</mi>
         <mo>.</mo>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>a</mi>
         <mo>¯</mo>
        </mover>
        <mrow>
         <mo>.</mo>
         <mi>k</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <msub>
       <mover accent="true">
        <mi>a</mi>
        <mo>¯</mo>
       </mover>
       <mrow>
        <mo>.</mo>
        <mo>.</mo>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <msub>
      <mi>B</mi>
      <mrow>
       <mi>j</mi>
       <mo>,</mo>
       <mi>k</mi>
      </mrow>
     </msub>
     <mo>:=</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>b</mi>
        <mrow>
         <mi>j</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>b</mi>
         <mo>¯</mo>
        </mover>
        <mrow>
         <mi>j</mi>
         <mo>.</mo>
        </mrow>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>b</mi>
         <mo>¯</mo>
        </mover>
        <mrow>
         <mo>.</mo>
         <mi>k</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <msub>
       <mover accent="true">
        <mi>b</mi>
        <mo>¯</mo>
       </mover>
       <mrow>
        <mo>.</mo>
        <mo>.</mo>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <list>
       <ci>j</ci>
       <ci>k</ci>
      </list>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <list>
         <ci>j</ci>
         <ci>k</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>a</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">j</csymbol>
         <ci>normal-.</ci>
        </cerror>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>a</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-.</ci>
         <csymbol cd="unknown">k</csymbol>
        </cerror>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>a</ci>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-.</ci>
        <ci>normal-.</ci>
       </cerror>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>B</ci>
      <list>
       <ci>j</ci>
       <ci>k</ci>
      </list>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <list>
         <ci>j</ci>
         <ci>k</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>b</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">j</csymbol>
         <ci>normal-.</ci>
        </cerror>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>b</ci>
        </apply>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <ci>normal-.</ci>
         <csymbol cd="unknown">k</csymbol>
        </cerror>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>b</ci>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-.</ci>
        <ci>normal-.</ci>
       </cerror>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{j,k}:=a_{j,k}-\overline{a}_{j.}-\overline{a}_{.k}+\overline{a}_{..},\qquad B%
_{j,k}:=b_{j,k}-\overline{b}_{j.}-\overline{b}_{.k}+\overline{b}_{..},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Distance_correlation:2">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>a</mi>
    <mo>¯</mo>
   </mover>
   <mrow>
    <mi>j</mi>
    <mo>.</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>a</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <csymbol cd="unknown">j</csymbol>
     <ci>normal-.</ci>
    </cerror>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\overline{a}_{j.}
  </annotation>
 </semantics>
</math>

 is the 

<math display="inline" id="Distance_correlation:3">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

-th row mean, 

<math display="inline" id="Distance_correlation:4">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>a</mi>
    <mo>¯</mo>
   </mover>
   <mrow>
    <mo>.</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>a</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-.</ci>
     <csymbol cd="unknown">k</csymbol>
    </cerror>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\overline{a}_{.k}
  </annotation>
 </semantics>
</math>

 is the 

<math display="inline" id="Distance_correlation:5">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-th column mean, and 

<math display="inline" id="Distance_correlation:6">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>a</mi>
    <mo>¯</mo>
   </mover>
   <mrow>
    <mo>.</mo>
    <mo>.</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-¯</ci>
     <ci>a</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-.</ci>
     <ci>normal-.</ci>
    </cerror>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\overline{a}_{..}
  </annotation>
 </semantics>
</math>


 is the <a href="grand_mean" title="wikilink">grand mean</a> of the distance matrix of the <em>X</em> sample. The notation is similar for the <em>b</em> values. (In the matrices of centered distances (<em>A</em><sub><em>j</em>, <em>k</em></sub>) and (<em>B</em><sub><em>j</em>,<em>k</em></sub>) all rows and all columns sum to zero.) The squared <strong>sample distance covariance</strong> is simply the arithmetic average of the products <em>A</em><sub><em>j</em>, ''k <em></em></sub>B''<sub><em>j</em>, <em>k</em></sub>:</p>

<p>

<math display="block" id="Distance_correlation:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo>dCov</mo>
      <mi>n</mi>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mrow>
         <mi>j</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>A</mi>
         <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>k</mi>
         </mrow>
        </msub>
       </mpadded>
       <msub>
        <mi>B</mi>
        <mrow>
         <mi>j</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>dCov</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <list>
          <ci>j</ci>
          <ci>k</ci>
         </list>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <list>
         <ci>j</ci>
         <ci>k</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <list>
         <ci>j</ci>
         <ci>k</ci>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}_{n}(X,Y):=\frac{1}{n^{2}}\sum_{j,k=1}^{n}A_{j,k}\,B_{j%
,k}.
  </annotation>
 </semantics>
</math>

 The statistic <em>T</em><sub><em>n</em></sub> = <em>n</em> dCov<sup>2</sup><sub><em>n</em></sub>(<em>X</em>, <em>Y</em>) determines a consistent multivariate test of independence of random vectors in arbitrary dimensions. For an implementation see <em>dcov.test</em> function in the <em>energy</em> package for <a href="R_(programming_language)" title="wikilink">R</a>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The population value of <strong>distance covariance</strong> can be defined along the same lines. Let <em>X</em> be a random variable that takes values in a <em>p</em>-dimensional Euclidean space with probability distribution 

<math display="inline" id="Distance_correlation:8">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   μ
  </annotation>
 </semantics>
</math>

 and let <em>Y</em> be a random variable that takes values in a <em>q</em>-dimensional Euclidean space with probability distribution 

<math display="inline" id="Distance_correlation:9">
 <semantics>
  <mi>ν</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ν</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ν
  </annotation>
 </semantics>
</math>

, and suppose that <em>X</em> and <em>Y</em> have finite expectations. Write</p>

<p>

<math display="block" id="Distance_correlation:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>μ</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>:=</mo>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <mi>x</mi>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>D</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>μ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>:=</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <msub>
          <mi>a</mi>
          <mi>μ</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>μ</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo>,</mo>
        <msup>
         <mi>x</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>:=</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mi>x</mi>
          <mo>-</mo>
          <msup>
           <mi>x</mi>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>a</mi>
          <mi>μ</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>a</mi>
          <mi>μ</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <msup>
           <mi>x</mi>
           <mo>′</mo>
          </msup>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>D</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>μ</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>μ</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>X</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <csymbol cd="latexml">assign</csymbol>
      <apply>
       <times></times>
       <ci>D</ci>
       <ci>μ</ci>
      </apply>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>μ</ci>
        </apply>
        <ci>X</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">assign</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <ci>μ</ci>
       </apply>
       <interval closure="open">
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
       </interval>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>x</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>μ</ci>
         </apply>
         <ci>x</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>μ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>D</ci>
        <ci>μ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{\mu}(x):=\operatorname{E}[\|X-x\|],\quad D(\mu):=\operatorname{E}[a_{\mu}(X%
)],\quad d_{\mu}(x,x^{\prime}):=\|x-x^{\prime}\|-a_{\mu}(x)-a_{\mu}(x^{\prime}%
)+D(\mu).
  </annotation>
 </semantics>
</math>

</p>

<p>Finally, define the population value of squared distance covariance of <em>X</em> and <em>Y</em> as</p>

<p>

<math display="block" id="Distance_correlation:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mo>dCov</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo maxsize="120%" minsize="120%">[</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>μ</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>,</mo>
        <msup>
         <mi>X</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>d</mi>
        <mi>ν</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>,</mo>
        <msup>
         <mi>Y</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>μ</ci>
      </apply>
      <interval closure="open">
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-′</ci>
       </apply>
      </interval>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>ν</ci>
      </apply>
      <interval closure="open">
       <ci>Y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <ci>normal-′</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y):=\operatorname{E}\big[d_{\mu}(X,X^{\prime})d_{\nu%
}(Y,Y^{\prime})\big].
  </annotation>
 </semantics>
</math>

</p>

<p>One can show that this is equivalent to the following definition:</p>

<p>

<math display="inline" id="Distance_correlation:12">
 <semantics>
  <mrow>
   <msup>
    <mo>dCov</mo>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCov</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{dCov}^{2}(X,Y)
  </annotation>
 </semantics>
</math>


</p>

<p>where <strong><em>E</em></strong> denotes expected value, and 

<math display="inline" id="Distance_correlation:13">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>X</ci>
    <ci>Y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle(X,Y),
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Distance_correlation:14">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>X</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>Y</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Y</ci>
     <ci>normal-′</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle(X^{\prime},Y^{\prime}),
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:15">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mi>X</mi>
    <mi>′′</mi>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>Y</mi>
    <mi>′′</mi>
   </msup>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>X</ci>
     <ci>′′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Y</ci>
     <ci>′′</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle(X^{\prime\prime},Y^{\prime\prime})
  </annotation>
 </semantics>
</math>

 are independent and identically distributed. Distance covariance can be expressed in terms of Pearson’s covariance, <strong>cov</strong>, as follows:</p>

<p>

<math display="block" id="Distance_correlation:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mo>dCov</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>cov</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <msup>
          <mi>X</mi>
          <mo>′</mo>
         </msup>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>Y</mi>
         <mo>-</mo>
         <msup>
          <mi>Y</mi>
          <mo>′</mo>
         </msup>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo>cov</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mi>X</mi>
          <mo>-</mo>
          <msup>
           <mi>X</mi>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mi>Y</mi>
          <mo>-</mo>
          <msup>
           <mi>Y</mi>
           <mi>′′</mi>
          </msup>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>cov</ci>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>X</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <ci>Y</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Y</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <ci>cov</ci>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>X</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>Y</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Y</ci>
          <ci>′′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y)=\operatorname{cov}(\|X-X^{\prime}\|,\|Y-Y^{\prime%
}\|)-2\operatorname{cov}(\|X-X^{\prime}\|,\|Y-Y^{\prime\prime}\|).
  </annotation>
 </semantics>
</math>

</p>

<p>This identity shows that the distance covariance is not the same as the covariance of distances, cov(||<em>X</em>-''X' <em>||, ||</em>Y<em>-</em>Y' '' ||). This can be zero even if <em>X</em> and <em>Y</em> are not independent.</p>

<p>Alternately, the squared distance covariance can be defined as the weighted <mtpl></mtpl> norm of the distance between the joint <a href="Characteristic_function_(probability_theory)" title="wikilink">characteristic function</a> of the random variables and the product of their marginal characteristic functions:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> 

<math display="inline" id="Distance_correlation:17">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mo>dCov</mo>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>p</mi>
      </msub>
      <msub>
       <mi>c</mi>
       <mi>q</mi>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <msup>
       <mi>ℝ</mi>
       <mrow>
        <mi>p</mi>
        <mo>+</mo>
        <mi>q</mi>
       </mrow>
      </msup>
     </msub>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo>|</mo>
         <mrow>
          <mrow>
           <msub>
            <mi>ϕ</mi>
            <mrow>
             <mi>X</mi>
             <mo>,</mo>
             <mi>Y</mi>
            </mrow>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>s</mi>
            <mo>,</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <msub>
            <mi>ϕ</mi>
            <mi>X</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>s</mi>
            <mo stretchy="false">)</mo>
           </mrow>
           <msub>
            <mi>ϕ</mi>
            <mi>Y</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>t</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mrow>
        <msubsup>
         <mrow>
          <mo stretchy="false">|</mo>
          <mi>s</mi>
          <mo stretchy="false">|</mo>
         </mrow>
         <mi>p</mi>
         <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>p</mi>
         </mrow>
        </msubsup>
        <msubsup>
         <mrow>
          <mo stretchy="false">|</mo>
          <mi>t</mi>
          <mo stretchy="false">|</mo>
         </mrow>
         <mi>q</mi>
         <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>q</mi>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
      <mi>d</mi>
      <mpadded width="+1.7pt">
       <mi>t</mi>
      </mpadded>
      <mi>d</mi>
      <mi>s</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>q</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ℝ</ci>
        <apply>
         <plus></plus>
         <ci>p</ci>
         <ci>q</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <abs></abs>
          <apply>
           <minus></minus>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <list>
              <ci>X</ci>
              <ci>Y</ci>
             </list>
            </apply>
            <interval closure="open">
             <ci>s</ci>
             <ci>t</ci>
            </interval>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <ci>X</ci>
            </apply>
            <ci>s</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ϕ</ci>
             <ci>Y</ci>
            </apply>
            <ci>t</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <abs></abs>
            <ci>s</ci>
           </apply>
           <ci>p</ci>
          </apply>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>p</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <abs></abs>
            <ci>t</ci>
           </apply>
           <ci>q</ci>
          </apply>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>q</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>t</ci>
       <ci>d</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y)=\frac{1}{c_{p}c_{q}}\int_{\mathbb{R}^{p+q}}\frac{%
\left|\phi_{X,Y}(s,t)-\phi_{X}(s)\phi_{Y}(t)\right|^{2}}{|s|_{p}^{1+p}|t|_{q}^%
{1+q}}dt\,ds
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>ϕ</em><sub><em>X</em>, <em>Y</em></sub>(<em>s</em>, <em>t</em>), <mtpl></mtpl> and <mtpl></mtpl> are the <a href="Characteristic_function_(probability_theory)" title="wikilink">characteristic functions</a> of  <em>X</em>, and <em>Y</em>, respectively, <em>p</em>, <em>q</em> denote the Euclidean dimension of <em>X</em> and <em>Y</em>, and thus of <em>s</em> and <em>t</em>, and <em>c</em><sub><em>p</em></sub>, <em>c</em><sub><em>q</em></sub> are constants. The weight function 

<math display="inline" id="Distance_correlation:18">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>p</mi>
     </msub>
     <msub>
      <mi>c</mi>
      <mi>q</mi>
     </msub>
     <msubsup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>s</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>p</mi>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>t</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mi>q</mi>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>q</mi>
      </mrow>
     </msubsup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>p</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>q</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <abs></abs>
        <ci>s</ci>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <abs></abs>
        <ci>t</ci>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ({c_{p}c_{q}}{|s|_{p}^{1+p}|t|_{q}^{1+q}})^{-1}
  </annotation>
 </semantics>
</math>

 is chosen to produce a scale equivariant and rotation invariant measure that doesn't go to zero for dependent variables.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> One interpretation<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> of the characteristic function definition is that the variables <em>e<sup>isX</sup></em> and <em>e<sup>itY</sup></em> are cyclic representations of <em>X</em> and <em>Y</em> with different periods given by <em>s</em> and <em>t</em>, and the expression <mtpl></mtpl> in the numerator of the characteristic function definition of distance covariance is simply the classical covariance of <em>e<sup>isX</sup></em> and <em>e<sup>itY</sup></em>. The characteristic function definition clearly shows that dCov<sup>2</sup>(<em>X</em>, <em>Y</em>) = 0 if and only if <em>X</em> and <em>Y</em> are independent.</p>
<h3 id="distance-variance">Distance variance</h3>

<p>The <em>distance variance</em> is a special case of distance covariance when the two variables are identical. The population value of distance variance is the square root of</p>

<p>

<math display="block" id="Distance_correlation:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mo>dVar</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <msup>
         <mrow>
          <mo>∥</mo>
          <mrow>
           <mi>X</mi>
           <mo>-</mo>
           <msup>
            <mi>X</mi>
            <mo>′</mo>
           </msup>
          </mrow>
          <mo>∥</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msup>
        <mo>E</mo>
        <mn>2</mn>
       </msup>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mi>X</mi>
          <mo>-</mo>
          <msup>
           <mi>X</mi>
           <mo>′</mo>
          </msup>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mrow>
          <mo>∥</mo>
          <mrow>
           <mi>X</mi>
           <mo>-</mo>
           <msup>
            <mi>X</mi>
            <mo>′</mo>
           </msup>
          </mrow>
          <mo rspace="4.2pt">∥</mo>
         </mrow>
         <mrow>
          <mo>∥</mo>
          <mrow>
           <mi>X</mi>
           <mo>-</mo>
           <msup>
            <mi>X</mi>
            <mi>′′</mi>
           </msup>
          </mrow>
          <mo>∥</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dVar</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>X</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-E</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>X</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>X</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <ci>normal-′</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>X</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <ci>′′</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dVar}^{2}(X):=\operatorname{E}[\|X-X^{\prime}\|^{2}]+%
\operatorname{E}^{2}[\|X-X^{\prime}\|]-2\operatorname{E}[\|X-X^{\prime}\|\,\|X%
-X^{\prime\prime}\|],
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Distance_correlation:20">
 <semantics>
  <mo>E</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}
  </annotation>
 </semantics>
</math>

 denotes the expected value, 

<math display="inline" id="Distance_correlation:21">
 <semantics>
  <msup>
   <mi>X</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>X</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\prime}
  </annotation>
 </semantics>
</math>

 is an independent and identically distributed copy of 

<math display="inline" id="Distance_correlation:22">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:23">
 <semantics>
  <msup>
   <mi>X</mi>
   <mi>′′</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>X</ci>
    <ci>′′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\prime\prime}
  </annotation>
 </semantics>
</math>

 is independent of 

<math display="inline" id="Distance_correlation:24">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:25">
 <semantics>
  <msup>
   <mi>X</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>X</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\prime}
  </annotation>
 </semantics>
</math>

 and has the same distribution as 

<math display="inline" id="Distance_correlation:26">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:27">
 <semantics>
  <msup>
   <mi>X</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>X</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{\prime}
  </annotation>
 </semantics>
</math>

.</p>

<p>The <em>sample distance variance</em> is the square root of</p>

<p>

<math display="block" id="Distance_correlation:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo>dVar</mo>
      <mi>n</mi>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <msubsup>
      <mo>dCov</mo>
      <mi>n</mi>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mfrac>
     </mstyle>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi mathvariant="normal">ℓ</mi>
       </mrow>
      </munder>
      <msubsup>
       <mi>A</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi mathvariant="normal">ℓ</mi>
       </mrow>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>dVar</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>X</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>dCov</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>X</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <list>
         <ci>k</ci>
         <ci>normal-ℓ</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <list>
          <ci>k</ci>
          <ci>normal-ℓ</ci>
         </list>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dVar}^{2}_{n}(X):=\operatorname{dCov}^{2}_{n}(X,X)=\tfrac{1}{n^{%
2}}\sum_{k,\ell}A_{k,\ell}^{2},
  </annotation>
 </semantics>
</math>

 which is a relative of <a href="Corrado_Gini" title="wikilink">Corrado Gini</a>’s <a href="Mean_absolute_difference" title="wikilink">mean difference</a> introduced in 1912 (but Gini did not work with centered distances).</p>
<h3 id="distance-standard-deviation">Distance standard deviation</h3>

<p>The <em>distance standard deviation</em> is the square root of the <em>distance variance</em>.</p>
<h3 id="distance-correlation">Distance correlation</h3>

<p>The <em>distance correlation</em> <a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> of two random variables is obtained by dividing their <em>distance covariance</em> by the product of their <em>distance standard deviations</em>. The distance correlation is</p>

<p>

<math display="block" id="Distance_correlation:29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>dCor</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>dCov</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo>,</mo>
       <mi>Y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <msqrt>
      <mrow>
       <mrow>
        <mo>dVar</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>X</mi>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>dVar</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Y</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>dCor</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>dCov</ci>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <apply>
        <ci>dVar</ci>
        <ci>X</ci>
       </apply>
       <apply>
        <ci>dVar</ci>
        <ci>Y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCor}(X,Y)=\frac{\operatorname{dCov}(X,Y)}{\sqrt{\operatorname{%
dVar}(X)\,\operatorname{dVar}(Y)}},
  </annotation>
 </semantics>
</math>

 and the <em>sample distance correlation</em> is defined by substituting the sample distance covariance and distance variances for the population coefficients above.</p>

<p>For easy computation of sample distance correlation see the <em>dcor</em> function in the <em>energy</em> package for <a href="R_(programming_language)" title="wikilink">R</a>.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h2 id="properties">Properties</h2>
<h3 id="distance-correlation-1">Distance correlation</h3>

<p>(i) 

<math display="inline" id="Distance_correlation:30">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mrow>
    <msub>
     <mo>dCor</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>dCor</ci>
       <ci>n</ci>
      </apply>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq\operatorname{dCor}_{n}(X,Y)\leq 1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:31">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mrow>
    <mo>dCor</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <apply>
      <ci>dCor</ci>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq\operatorname{dCor}(X,Y)\leq 1
  </annotation>
 </semantics>
</math>

.</p>

<p>(ii) 

<math display="inline" id="Distance_correlation:32">
 <semantics>
  <mrow>
   <mrow>
    <mo>dCor</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>dCor</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCor}(X,Y)=0
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="Distance_correlation:33">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:34">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are independent.</p>

<p>(iii) 

<math display="inline" id="Distance_correlation:35">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>dCor</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>dCor</ci>
      <ci>n</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCor}_{n}(X,Y)=1
  </annotation>
 </semantics>
</math>

 implies that dimensions of the linear subspaces spanned by 

<math display="inline" id="Distance_correlation:36">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:37">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 samples respectively are almost surely equal and if we assume that these subspaces are equal, then in this subspace 

<math display="inline" id="Distance_correlation:38">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>=</mo>
   <mrow>
    <mi>A</mi>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mi>b</mi>
     </mpadded>
     <mi>𝐂</mi>
     <mi>X</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Y</ci>
    <apply>
     <plus></plus>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>𝐂</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y=A+b\,\mathbf{C}X
  </annotation>
 </semantics>
</math>

 for some vector 

<math display="inline" id="Distance_correlation:39">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, scalar 

<math display="inline" id="Distance_correlation:40">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

, and <a href="orthonormal_matrix" title="wikilink">orthonormal matrix</a> 

<math display="inline" id="Distance_correlation:41">
 <semantics>
  <mi>𝐂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="distance-covariance-1">Distance covariance</h3>

<p>(i) 

<math display="inline" id="Distance_correlation:42">
 <semantics>
  <mrow>
   <mrow>
    <mo>dCov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <ci>dCov</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}(X,Y)\geq 0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:43">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>dCov</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>dCov</ci>
      <ci>n</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}_{n}(X,Y)\geq 0
  </annotation>
 </semantics>
</math>

.</p>

<p>(ii) 

<math display="inline" id="Distance_correlation:44">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mo>dCov</mo>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>b</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>𝐂</mi>
         <mn>1</mn>
        </msub>
       </mpadded>
       <mi>X</mi>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
      <mo>+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>b</mi>
         <mn>2</mn>
        </msub>
       </mpadded>
       <mpadded width="+1.7pt">
        <msub>
         <mi>𝐂</mi>
         <mn>2</mn>
        </msub>
       </mpadded>
       <mi>Y</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mi>b</mi>
        <mn>1</mn>
       </msub>
      </mpadded>
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo stretchy="false">|</mo>
    </mrow>
    <mrow>
     <msup>
      <mo>dCov</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐂</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>X</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐂</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>Y</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <abs></abs>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>dCov</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(a_{1}+b_{1}\,\mathbf{C}_{1}\,X,a_{2}+b_{2}\,\mathbf{C}%
_{2}\,Y)=|b_{1}\,b_{2}|\operatorname{dCov}^{2}(X,Y)
  </annotation>
 </semantics>
</math>

 for all constant vectors 

<math display="inline" id="Distance_correlation:45">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1},a_{2}
  </annotation>
 </semantics>
</math>

, scalars 

<math display="inline" id="Distance_correlation:46">
 <semantics>
  <mrow>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>b</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{1},b_{2}
  </annotation>
 </semantics>
</math>

, and orthonormal matrices 

<math display="inline" id="Distance_correlation:47">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐂</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>𝐂</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐂</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐂</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}_{1},\mathbf{C}_{2}
  </annotation>
 </semantics>
</math>

.</p>

<p>(iii) If the random vectors 

<math display="inline" id="Distance_correlation:48">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">1</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{1},Y_{1})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:49">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mn>2</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">2</cn>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{2},Y_{2})
  </annotation>
 </semantics>
</math>

 are independent then</p>

<p>

<math display="block" id="Distance_correlation:50">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>dCov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>X</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>X</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>Y</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>Y</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≤</mo>
    <mrow>
     <mrow>
      <mo>dCov</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>X</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>Y</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo>dCov</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>X</mi>
        <mn>2</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>Y</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <ci>dCov</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>dCov</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <ci>dCov</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}(X_{1}+X_{2},Y_{1}+Y_{2})\leq\operatorname{dCov}(X_{1},Y_{1%
})+\operatorname{dCov}(X_{2},Y_{2}).
  </annotation>
 </semantics>
</math>

 Equality holds if and only if 

<math display="inline" id="Distance_correlation:51">
 <semantics>
  <msub>
   <mi>X</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:52">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{1}
  </annotation>
 </semantics>
</math>

 are both constants, or 

<math display="inline" id="Distance_correlation:53">
 <semantics>
  <msub>
   <mi>X</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:54">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{2}
  </annotation>
 </semantics>
</math>

 are both constants, or 

<math display="inline" id="Distance_correlation:55">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>X</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{1},X_{2},Y_{1},Y_{2}
  </annotation>
 </semantics>
</math>

 are mutually independent.</p>

<p>(iv) 

<math display="inline" id="Distance_correlation:56">
 <semantics>
  <mrow>
   <mrow>
    <mo>dCov</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>dCov</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}(X,Y)=0
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="Distance_correlation:57">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:58">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are independent.</p>

<p>This last property is the most important effect of working with centered distances.</p>

<p>The statistic 

<math display="inline" id="Distance_correlation:59">
 <semantics>
  <mrow>
   <msubsup>
    <mo>dCov</mo>
    <mi>n</mi>
    <mn>2</mn>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}_{n}(X,Y)
  </annotation>
 </semantics>
</math>

 is a biased estimator of 

<math display="inline" id="Distance_correlation:60">
 <semantics>
  <mrow>
   <msup>
    <mo>dCov</mo>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCov</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y)
  </annotation>
 </semantics>
</math>

. Under independence of X and Y <a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>

<math display="block" id="Distance_correlation:61">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <msubsup>
        <mo>dCov</mo>
        <mi>n</mi>
        <mn>2</mn>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>,</mo>
        <mi>Y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <mo>{</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <msup>
          <mo>dCov</mo>
          <mn>2</mn>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo>,</mo>
          <mi>Y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo>E</mo>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mo>∥</mo>
           <mrow>
            <mi>X</mi>
            <mo>-</mo>
            <msup>
             <mi>X</mi>
             <mo>′</mo>
            </msup>
           </mrow>
           <mo>∥</mo>
          </mrow>
          <mo rspace="4.2pt" stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mrow>
         <mo>E</mo>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mo>∥</mo>
           <mrow>
            <mi>Y</mi>
            <mo>-</mo>
            <msup>
             <mi>Y</mi>
             <mo>′</mo>
            </msup>
           </mrow>
           <mo>∥</mo>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>}</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>X</mi>
         <mo>-</mo>
         <msup>
          <mi>X</mi>
          <mo>′</mo>
         </msup>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mo rspace="4.2pt" stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>Y</mi>
         <mo>-</mo>
         <msup>
          <mi>Y</mi>
          <mo>′</mo>
         </msup>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>dCov</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>X</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <set>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>dCov</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>X</ci>
          <ci>Y</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <ci>normal-E</ci>
          <apply>
           <csymbol cd="latexml">norm</csymbol>
           <apply>
            <minus></minus>
            <ci>X</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>X</ci>
             <ci>normal-′</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <ci>normal-E</ci>
          <apply>
           <csymbol cd="latexml">norm</csymbol>
           <apply>
            <minus></minus>
            <ci>Y</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>Y</ci>
             <ci>normal-′</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </set>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>X</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-E</ci>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>Y</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Y</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}[\operatorname{dCov}^{2}_{n}(X,Y)]=\frac{n-1}{n^{2}}\left\{(n-%
2)\operatorname{dCov}^{2}(X,Y)+\operatorname{E}[\|X-X^{\prime}\|]\,%
\operatorname{E}[\|Y-Y^{\prime}\|]\right\}=\frac{n-1}{n^{2}}\operatorname{E}[%
\|X-X^{\prime}\|]\,\operatorname{E}[\|Y-Y^{\prime}\|].
  </annotation>
 </semantics>
</math>

</p>

<p>An unbiased estimator of 

<math display="inline" id="Distance_correlation:62">
 <semantics>
  <mrow>
   <msup>
    <mo>dCov</mo>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCov</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y)
  </annotation>
 </semantics>
</math>

 is given by Székely and Rizzo.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h3 id="distance-variance-1">Distance variance</h3>

<p>(i) 

<math display="inline" id="Distance_correlation:63">
 <semantics>
  <mrow>
   <mrow>
    <mo>dVar</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>dVar</ci>
     <ci>X</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dVar}(X)=0
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="Distance_correlation:64">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>X</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <apply>
     <ci>normal-E</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=\operatorname{E}[X]
  </annotation>
 </semantics>
</math>

 almost surely.</p>

<p>(ii) 

<math display="inline" id="Distance_correlation:65">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>dVar</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>dVar</ci>
      <ci>n</ci>
     </apply>
     <ci>X</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dVar}_{n}(X)=0
  </annotation>
 </semantics>
</math>

 if and only if every sample observation is identical.</p>

<p>(iii) 

<math display="inline" id="Distance_correlation:66">
 <semantics>
  <mrow>
   <mrow>
    <mo>dVar</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mo>+</mo>
      <mrow>
       <mpadded width="+1.7pt">
        <mi>b</mi>
       </mpadded>
       <mpadded width="+1.7pt">
        <mi>𝐂</mi>
       </mpadded>
       <mi>X</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>b</mi>
     <mo stretchy="false">|</mo>
    </mrow>
    <mrow>
     <mo>dVar</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>dVar</ci>
     <apply>
      <plus></plus>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>𝐂</ci>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <abs></abs>
      <ci>b</ci>
     </apply>
     <apply>
      <ci>dVar</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dVar}(A+b\,\mathbf{C}\,X)=|b|\operatorname{dVar}(X)
  </annotation>
 </semantics>
</math>

 for all constant vectors 

<math display="inline" id="Distance_correlation:67">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, scalars 

<math display="inline" id="Distance_correlation:68">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

, and orthonormal matrices 

<math display="inline" id="Distance_correlation:69">
 <semantics>
  <mi>𝐂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}
  </annotation>
 </semantics>
</math>

.</p>

<p>(iv) If 

<math display="inline" id="Distance_correlation:70">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:71">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are independent then 

<math display="inline" id="Distance_correlation:72">
 <semantics>
  <mrow>
   <mrow>
    <mo>dVar</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>X</mi>
      <mo>+</mo>
      <mi>Y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <mrow>
     <mo>dVar</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>dVar</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <ci>dVar</ci>
     <apply>
      <plus></plus>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>dVar</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>dVar</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dVar}(X+Y)\leq\operatorname{dVar}(X)+\operatorname{dVar}(Y)
  </annotation>
 </semantics>
</math>

.</p>

<p>Equality holds in (iv) if and only if one of the random variables 

<math display="inline" id="Distance_correlation:73">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Distance_correlation:74">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 is a constant.</p>
<h2 id="generalization">Generalization</h2>

<p>Distance covariance can be generalized to include powers of Euclidean distance. Define</p>

<p>

<math display="inline" id="Distance_correlation:75">
 <semantics>
  <mrow>
   <msup>
    <mo>dCov</mo>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo>;</mo>
    <mi>α</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCov</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
    <ci>α</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{dCov}^{2}(X,Y;\alpha)
  </annotation>
 </semantics>
</math>


</p>

<p>Then for every 

<math display="inline" id="Distance_correlation:76">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mi>α</mi>
   <mo><</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>α</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<\alpha<2
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Distance_correlation:77">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:78">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are independent if and only if 

<math display="inline" id="Distance_correlation:79">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mo>dCov</mo>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo>;</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
     <ci>α</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y;\alpha)=0
  </annotation>
 </semantics>
</math>

. It is important to note that this characterization does not hold for exponent 

<math display="inline" id="Distance_correlation:80">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>α</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=2
  </annotation>
 </semantics>
</math>

; in this case for bivariate 

<math display="inline" id="Distance_correlation:81">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>X</mi>
   <mo>,</mo>
   <mi>Y</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>X</ci>
    <ci>Y</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X,Y)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Distance_correlation:82">
 <semantics>
  <mrow>
   <mo>dCor</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo>;</mo>
    <mrow>
     <mi>α</mi>
     <mo>=</mo>
     <mn>2</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>dCor</ci>
    <ci>X</ci>
    <ci>Y</ci>
    <apply>
     <eq></eq>
     <ci>α</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCor}(X,Y;\alpha=2)
  </annotation>
 </semantics>
</math>

 is a deterministic function of the Pearson correlation.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> If 

<math display="inline" id="Distance_correlation:83">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi mathvariant="normal">ℓ</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <list>
     <ci>k</ci>
     <ci>normal-ℓ</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k,\ell}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:84">
 <semantics>
  <msub>
   <mi>b</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi mathvariant="normal">ℓ</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>b</ci>
    <list>
     <ci>k</ci>
     <ci>normal-ℓ</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b_{k,\ell}
  </annotation>
 </semantics>
</math>

 are 

<math display="inline" id="Distance_correlation:85">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 powers of the corresponding distances, 

<math display="inline" id="Distance_correlation:86">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mi>α</mi>
   <mo>≤</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>α</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<\alpha\leq 2
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Distance_correlation:87">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 sample distance covariance can be defined as the nonnegative number for which</p>

<p>

<math display="block" id="Distance_correlation:88">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo>dCov</mo>
      <mi>n</mi>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo>;</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi mathvariant="normal">ℓ</mi>
       </mrow>
      </munder>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>A</mi>
         <mrow>
          <mi>k</mi>
          <mo>,</mo>
          <mi mathvariant="normal">ℓ</mi>
         </mrow>
        </msub>
       </mpadded>
       <msub>
        <mi>B</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mi mathvariant="normal">ℓ</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>dCov</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>k</ci>
        <ci>normal-ℓ</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <list>
         <ci>k</ci>
         <ci>normal-ℓ</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <list>
         <ci>k</ci>
         <ci>normal-ℓ</ci>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}_{n}(X,Y;\alpha):=\frac{1}{n^{2}}\sum_{k,\ell}A_{k,\ell%
}\,B_{k,\ell}.
  </annotation>
 </semantics>
</math>

</p>

<p>One can extend 

<math display="inline" id="Distance_correlation:89">
 <semantics>
  <mo>dCov</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>dCov</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}
  </annotation>
 </semantics>
</math>

 to <a href="metric_space" title="wikilink">metric-space</a>-valued <a href="random_variables" title="wikilink">random variables</a> 

<math display="inline" id="Distance_correlation:90">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Distance_correlation:91">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

: If 

<math display="inline" id="Distance_correlation:92">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 has law 

<math display="inline" id="Distance_correlation:93">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 in a metric space with metric 

<math display="inline" id="Distance_correlation:94">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

, then define 

<math display="inline" id="Distance_correlation:95">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>μ</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo>,</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>μ</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <ci>d</ci>
      <interval closure="open">
       <ci>X</ci>
       <ci>x</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{\mu}(x):=\operatorname{E}[d(X,x)]
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Distance_correlation:96">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>μ</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>μ</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>μ</ci>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(\mu):=\operatorname{E}[a_{\mu}(X)]
  </annotation>
 </semantics>
</math>

, and (provided 

<math display="inline" id="Distance_correlation:97">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>μ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{\mu}
  </annotation>
 </semantics>
</math>

 is finite, i.e., 

<math display="inline" id="Distance_correlation:98">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 has finite first moment), 

<math display="inline" id="Distance_correlation:99">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>d</mi>
     <mi>μ</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo>,</mo>
       <msup>
        <mi>x</mi>
        <mo>′</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>μ</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>μ</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>x</mi>
        <mo>′</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>d</ci>
      <ci>μ</ci>
     </apply>
     <interval closure="open">
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-′</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>d</ci>
       <interval closure="open">
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <ci>normal-′</ci>
        </apply>
       </interval>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>μ</ci>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>μ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>μ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{\mu}(x,x^{\prime}):=d(x,x^{\prime})-a_{\mu}(x)-a_{\mu}(x^{\prime})+D(\mu)
  </annotation>
 </semantics>
</math>

. Then if 

<math display="inline" id="Distance_correlation:100">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 has law 

<math display="inline" id="Distance_correlation:101">
 <semantics>
  <mi>ν</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ν</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu
  </annotation>
 </semantics>
</math>

 (in a possibly different metric space with finite first moment), define</p>

<p>

<math display="block" id="Distance_correlation:102">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mo>dCov</mo>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo maxsize="120%" minsize="120%">[</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>μ</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo>,</mo>
        <msup>
         <mi>X</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>d</mi>
        <mi>ν</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>,</mo>
        <msup>
         <mi>Y</mi>
         <mo>′</mo>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo maxsize="120%" minsize="120%">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>μ</ci>
      </apply>
      <interval closure="open">
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-′</ci>
       </apply>
      </interval>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>ν</ci>
      </apply>
      <interval closure="open">
       <ci>Y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <ci>normal-′</ci>
       </apply>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y):=\operatorname{E}\big[d_{\mu}(X,X^{\prime})d_{\nu%
}(Y,Y^{\prime})\big].
  </annotation>
 </semantics>
</math>

 This is non-negative for all such 

<math display="inline" id="Distance_correlation:103">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>,</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>X</ci>
    <ci>Y</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X,Y
  </annotation>
 </semantics>
</math>

 iff both metric spaces have negative type.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> Here, a metric space 

<math display="inline" id="Distance_correlation:104">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>M</mi>
   <mo>,</mo>
   <mi>d</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>M</ci>
    <ci>d</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (M,d)
  </annotation>
 </semantics>
</math>

 has negative type if 

<math display="inline" id="Distance_correlation:105">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>M</mi>
   <mo>,</mo>
   <msup>
    <mi>d</mi>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </msup>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>M</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (M,d^{1/2})
  </annotation>
 </semantics>
</math>

 is <a href="isometry" title="wikilink">isometric</a> to a subset of a <a href="Hilbert_space" title="wikilink">Hilbert space</a>.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> If both metric spaces have strong negative type, then 

<math display="inline" id="Distance_correlation:106">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mo>dCov</mo>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>dCov</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y)=0
  </annotation>
 </semantics>
</math>

 iff 

<math display="inline" id="Distance_correlation:107">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>,</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>X</ci>
    <ci>Y</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X,Y
  </annotation>
 </semantics>
</math>

 are independent.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>
<h2 id="alternative-definition-of-distance-covariance">Alternative definition of distance covariance</h2>

<p>The original <a href="Distance_correlation#Distance_covariance" title="wikilink">distance covariance</a> has been defined as the square root of 

<math display="inline" id="Distance_correlation:108">
 <semantics>
  <mrow>
   <msup>
    <mo>dCov</mo>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCov</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y)
  </annotation>
 </semantics>
</math>

, rather than the squared coefficient itself. 

<math display="inline" id="Distance_correlation:109">
 <semantics>
  <mrow>
   <mo>dCov</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>dCov</ci>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}(X,Y)
  </annotation>
 </semantics>
</math>

 has the property that it is the <a href="energy_distance" title="wikilink">energy distance</a> between the joint distribution of 

<math display="inline" id="Distance_correlation:110">
 <semantics>
  <mrow>
   <mo>X</mo>
   <mo>,</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>normal-X</ci>
    <ci>Y</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{X},Y
  </annotation>
 </semantics>
</math>

 and the product of its marginals. Under this definition, however, the distance variance, rather than the distance standard deviation, is measured in the same units as the 

<math display="inline" id="Distance_correlation:111">
 <semantics>
  <mo>X</mo>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{X}
  </annotation>
 </semantics>
</math>

 distances.</p>

<p>Alternately, one could define <strong><em>distance covariance</em></strong> to be the square of the energy distance: 

<math display="inline" id="Distance_correlation:112">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mo>dCov</mo>
     <mn>2</mn>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCov</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCov}^{2}(X,Y).
  </annotation>
 </semantics>
</math>

 In this case, the distance standard deviation of 

<math display="inline" id="Distance_correlation:113">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is measured in the same units as 

<math display="inline" id="Distance_correlation:114">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 distance, and there exists an unbiased estimator for the population distance covariance.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>

<p>Under these alternate definitions, the distance correlation is also defined as the square 

<math display="inline" id="Distance_correlation:115">
 <semantics>
  <mrow>
   <msup>
    <mo>dCor</mo>
    <mn>2</mn>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>dCor</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{dCor}^{2}(X,Y)
  </annotation>
 </semantics>
</math>

, rather than the square root.</p>
<h2 id="alternative-formulation-brownian-covariance">Alternative formulation: Brownian covariance</h2>

<p>Brownian covariance is motivated by generalization of the notion of covariance to stochastic processes. The square of the covariance of random variables X and Y can be written in the following form:</p>

<p>

<math display="block" id="Distance_correlation:116">
 <semantics>
  <mrow>
   <mo>cov</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mo>E</mo>
   <mrow>
    <mo>[</mo>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mi>X</mi>
     <mo>-</mo>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <msup>
      <mi>X</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msup>
     <mo>-</mo>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>X</mi>
       <msup>
        <mi></mi>
        <mo>′</mo>
       </msup>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <mi>Y</mi>
     <mo>-</mo>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
    <mrow>
     <mo maxsize="120%" minsize="120%">(</mo>
     <msup>
      <mi>Y</mi>
      <msup>
       <mi></mi>
       <mo>′</mo>
      </msup>
     </msup>
     <mo>-</mo>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>Y</mi>
       <msup>
        <mi></mi>
        <mo>′</mo>
       </msup>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo maxsize="120%" minsize="120%">)</mo>
    </mrow>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>cov</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
    <eq></eq>
    <ci>normal-E</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">X</csymbol>
      <minus></minus>
      <ci>normal-E</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <minus></minus>
      <ci>normal-E</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Y</csymbol>
      <minus></minus>
      <ci>normal-E</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">Y</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Y</ci>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <minus></minus>
      <ci>normal-E</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}(X,Y)^{2}=\operatorname{E}\left[\big(X-\operatorname{E}(X)%
\big)\big(X^{\mathrm{{}^{\prime}}}-\operatorname{E}(X^{\mathrm{{}^{\prime}}})%
\big)\big(Y-\operatorname{E}(Y)\big)\big(Y^{\mathrm{{}^{\prime}}}-%
\operatorname{E}(Y^{\mathrm{{}^{\prime}}})\big)\right]
  </annotation>
 </semantics>
</math>

</p>

<p>where E denotes the <a href="expected_value" title="wikilink">expected value</a> and the prime denotes independent and identically distributed copies. We need the following generalization of this formula. If U(s), V(t) are arbitrary random processes defined for all real s and t then define the U-centered version of X by</p>

<p>

<math display="block" id="Distance_correlation:117">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>U</mi>
   </msub>
   <mo>:=</mo>
   <mrow>
    <mrow>
     <mi>U</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mo>E</mo>
      <mi>X</mi>
     </msub>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mi>U</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>∣</mo>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mi>U</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>U</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-E</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <times></times>
       <ci>U</ci>
       <ci>X</ci>
      </apply>
      <set>
       <apply>
        <times></times>
        <ci>U</ci>
        <ci>t</ci>
       </apply>
      </set>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{U}:=U(X)-\operatorname{E}_{X}\left[U(X)\mid\left\{U(t)\right\}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>whenever the subtracted conditional expected value exists and denote by Y<sub>V</sub> the V-centered version of Y.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a><a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> The (U,V) covariance of (X,Y) is defined as the nonnegative number whose square is</p>

<p>

<math display="block" id="Distance_correlation:118">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo>cov</mo>
     <mrow>
      <mi>U</mi>
      <mo>,</mo>
      <mi>V</mi>
     </mrow>
     <mn>2</mn>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo>[</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>U</mi>
      </msub>
      <msubsup>
       <mi>X</mi>
       <mi>U</mi>
       <msup>
        <mi></mi>
        <mo>′</mo>
       </msup>
      </msubsup>
      <msub>
       <mi>Y</mi>
       <mi>V</mi>
      </msub>
      <msubsup>
       <mi>Y</mi>
       <mi>V</mi>
       <msup>
        <mi></mi>
        <mo>′</mo>
       </msup>
      </msubsup>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>cov</ci>
       <list>
        <ci>U</ci>
        <ci>V</ci>
       </list>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>U</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>U</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <ci>V</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <ci>V</ci>
       </apply>
       <apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}_{U,V}^{2}(X,Y):=\operatorname{E}\left[X_{U}X_{U}^{\mathrm{{%
}^{\prime}}}Y_{V}Y_{V}^{\mathrm{{}^{\prime}}}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>whenever the right-hand side is nonnegative and finite. The most important example is when U and V are two-sided independent <a href="Brownian_motion" title="wikilink">Brownian motions</a> /<a href="Wiener_process" title="wikilink">Wiener processes</a> with expectation zero and covariance |s| + |t| - |s-t| = 2 min(s,t). (This is twice the covariance of the standard Wiener process; here the factor 2 simplifies the computations.) In this case the (U,V) covariance is called <strong>Brownian covariance</strong> and is denoted by</p>

<p>

<math display="block" id="Distance_correlation:119">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>cov</mo>
     <mi>W</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>cov</ci>
     <ci>W</ci>
    </apply>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}_{W}(X,Y).
  </annotation>
 </semantics>
</math>

</p>

<p>There is a surprising coincidence: The Brownian covariance is the same as the distance covariance:</p>

<p>

<math display="block" id="Distance_correlation:120">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>cov</mo>
      <mi mathvariant="normal">W</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>dCov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>cov</ci>
      <ci>normal-W</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <ci>dCov</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}_{\mathrm{W}}(X,Y)=\operatorname{dCov}(X,Y),
  </annotation>
 </semantics>
</math>

 and thus <strong>Brownian correlation</strong> is the same as distance correlation.</p>

<p>On the other hand, if we replace the Brownian motion with the deterministic identity function <em>id</em> then Cov<sub>id</sub>(X,Y) is simply the absolute value of the classical Pearson <a class="uri" href="covariance" title="wikilink">covariance</a>,</p>

<p>

<math display="block" id="Distance_correlation:121">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo>cov</mo>
      <mi>id</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mo>cov</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>X</mi>
       <mo>,</mo>
       <mi>Y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>cov</ci>
      <ci>id</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <abs></abs>
     <apply>
      <ci>cov</ci>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{cov}_{\mathrm{id}}(X,Y)=\left|\operatorname{cov}(X,Y)\right|.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="RV_coefficient" title="wikilink">RV coefficient</a></li>
<li>For a related third-order statistic, see <a href="Skewness#Distance_skewness" title="wikilink">Distance skewness</a>.</li>
<li></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>Bickel, P.J. and Xu, Y. (2009) "Discussion of: Brownian distance covariance", <em>Annals of Applied Statistics</em>, 3 (4), 1266–1269.  <a href="http://arxiv4.library.cornell.edu/PS_cache/arxiv/pdf/0912/0912.3295v2.pdf">Free access to article</a></li>
<li>Gini, C. (1912). Variabilità e Mutabilità. Bologna: Tipografia di Paolo Cuppini.</li>
<li>Pearson, K. (1895). "Note on regression and inheritance in the case of two parents", <em><a href="Proceedings_of_the_Royal_Society" title="wikilink">Proceedings of the Royal Society</a></em>, 58, 240–242</li>
<li>Pearson, K. (1920). "Notes on the history of correlation", <em><a class="uri" href="Biometrika" title="wikilink">Biometrika</a></em>, 13, 25–45.</li>
<li>Székely, G. J. Rizzo, M. L. and Bakirov, N. K. (2007). "Measuring and testing independence by correlation of distances", <em><a href="The_Annals_of_Statistics" title="wikilink">The Annals of Statistics</a></em>, 35/6, 2769–2794.  <a href="http://personal.bgsu.edu/~mrizzo/energy/AOS0283-reprint.pdf">Reprint</a></li>
<li>Székely, G. J. and Rizzo, M. L. (2009). "Brownian distance covariance", <em>Annals of Applied Statistics</em>, 3/4, 1233–1303.  <a href="http://personal.bgsu.edu/~mrizzo/energy/AOAS312.pdf">Reprint</a></li>
<li>Kosorok, M. R. (2009) "Discussion of: Brownian Distance Covariance", <em>Annals of Applied Statistics</em>, 3/4, 1270–1278.  <a href="http://arxiv.org/PS_cache/arxiv/pdf/1010/1010.0822v1.pdf">Free access to article</a></li>
<li>Székely, G.J. and Rizzo, M.L. (2014) Partial distance correlation with methods for dissimilarities, The Annals of Statistics, 42/6, 2382-2412.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://personal.bgsu.edu/~mrizzo/energy.htm">E-statistics (energy statistics)</a></li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_dependence" title="wikilink">Category:Statistical dependence</a> <a href="Category:Statistical_distance_measures" title="wikilink">Category:Statistical distance measures</a> <a href="Category:Theory_of_probability_distributions" title="wikilink">Category:Theory of probability distributions</a> <a href="Category:Multivariate_statistics" title="wikilink">Category:Multivariate statistics</a> <a href="Category:Covariance_and_correlation" title="wikilink">Category:Covariance and correlation</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Pearson (1895)<a href="#fnref1">↩</a></li>
<li id="fn2">Székely, Rizzo and Bakirov (2007)<a href="#fnref2">↩</a></li>
<li id="fn3">Székely &amp; Rizzo (2009)<a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"><a href="http://cran.us.r-project.org/web/packages/energy/index.html">energy package for R</a><a href="#fnref5">↩</a></li>
<li id="fn6">Székely &amp; Rizzo (2009) Theorem 7, (3.7), p. 1249.<a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13">Székely and Rizzo (2009), Rejoinder<a href="#fnref13">↩</a></li>
<li id="fn14">Székely &amp; Rizzo (2014)<a href="#fnref14">↩</a></li>
<li id="fn15">Székely &amp; Rizzo (2007) Theorem 7, p. 2785.<a href="#fnref15">↩</a></li>
<li id="fn16">Lyons, R. (2011) "Distance covariance in metric spaces". <a href="#fnref16">↩</a></li>
<li id="fn17">Klebanov, L. B. (2005) <em>N-distances and their Applications</em>, Karolinum Press, Charles University, Prague.<a href="#fnref17">↩</a></li>
<li id="fn18"></li>
<li id="fn19">Székely &amp; Rizzo (2014)<a href="#fnref19">↩</a></li>
<li id="fn20"></li>
<li id="fn21">Bickel &amp; Xu (2009)<a href="#fnref21">↩</a></li>
<li id="fn22">Kosorok (2009)<a href="#fnref22">↩</a></li>
</ol>
</section>
</body>
</html>

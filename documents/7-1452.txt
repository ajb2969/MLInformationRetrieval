   SMS4      SMS4   SMS4 is a block cipher used in the Chinese National Standard for Wireless LAN WAPI (Wired Authentication and Privacy Infrastructure).  SMS4 was a proposed cipher to be used in IEEE 802.11i standard, but has so far been rejected by ISO . One of the reasons for the rejection has been opposition to the WAPI fast-track proposal by the IEEE .  The SMS4 algorithm was invented by Prof. LU Shu-wang(吕述望). The algorithm was declassified in January, 2006. A few details of the SMS4 cipher are:   It has a block size of 128 bits.  Uses an 8-bit S-box  The key size is 128 bits.  The only operations used are XOR, circular shifts and S-Box applications  Performs 32 rounds to process one block.  Each round updates a quarter (32 bits) of the internal state.  A non-linear key schedule is used to produce the round keys.  Decryption is using the same keys as encryption, but in reversed order.   Terms and Definitions  Word and Byte  Define    Z  2  e     subscript   superscript  Z  e   2    Z^{e}_{2}   as a vector set of e bits.      Z  2  32     subscript   superscript  Z  32   2    Z^{32}_{2}   is a word .      Z  2  8     subscript   superscript  Z  8   2    Z^{8}_{2}   is a byte .  S-box  S-box is fixed for 8-bit input and 8-bit output, noted as Sbox().  Keys and Key Parameters  The length of encryption keys are 128-bit, represented as     M  K   =   (   M   K  0    ,   M   K  1    ,   M   K  2    ,   M   K  3    )         M  K      M   subscript  K  0      M   subscript  K  1      M   subscript  K  2      M   subscript  K  3       MK=(MK_{0},\ MK_{1},\ MK_{2},\ MK_{3})   , in which    M    K  i     (  i  =  0  ,  1  ,  2  ,  3  )      fragments  M   subscript  K  i    fragments  normal-(  i   0  normal-,  1  normal-,  2  normal-,  3  normal-)     MK_{i}\ (i=0,\ 1,\ 2,\ 3)   is a word.  A round key is represented as    (   r   k  0    ,   r   k  1    ,  …  ,   r   k  31    )       r   subscript  k  0      r   subscript  k  1    normal-…    r   subscript  k  31      (rk_{0},\ rk_{1},\ \ldots,\ rk_{31})   . It is generated by the encryption key.       F  K   =   (   F   K  0    ,   F   K  1    ,   F   K  2    ,   F   K  3    )         F  K      F   subscript  K  0      F   subscript  K  1      F   subscript  K  2      F   subscript  K  3       FK=(FK_{0},\ FK_{1},\ FK_{2},\ FK_{3})   is a system parameter.       C  K   =   (   C   K  0    ,   C   K  1    ,  …  ,   C   K  31    )         C  K      C   subscript  K  0      C   subscript  K  1    normal-…    C   subscript  K  31       CK=(CK_{0},\ CK_{1},\ \ldots,\ CK_{31})   is a fixed parameter.      F   K  i       F   subscript  K  i     FK_{i}   and    C   K  i       C   subscript  K  i     CK_{i}   are words, used for extension of the algorithm.  External links   Chinese document describing the SMS4 cipher  English translation of the Chinese document  Linear and Differential Cryptanalysis of Reduced SMS4 Block Cipher  Example of SMS4 implemented as a Spreadsheet  Page of Prof. LU Shu-wang(吕述望) in Chinese  Example of SMS4 implemented in ANSI C   "  Category:Block ciphers   
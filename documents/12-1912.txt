   Imaginary hyperelliptic curve      Imaginary hyperelliptic curve   A hyperelliptic curve is a particular kind of algebraic curve . There exist hyperelliptic curves of every genus     g  ≥  1      g  1    g\geq 1   . If the genus of a hyperelliptic curve equals 1, we simply call the curve an elliptic curve . Hence we can see hyperelliptic curves as generalizations of elliptic curves. There is a well-known group structure on the set of points lying on an elliptic curve over some field    K   K   K   , which we can describe geometrically with chords and tangents. Generalizing this group structure to the hyperelliptic case is not straightforward. We cannot define the same group law on the set of points lying on a hyperelliptic curve, instead a group structure can be defined on the so-called Jacobian of a hyperelliptic curve. The computations differ depending on the number of points at infinity. This article is about imaginary hyperelliptic curves , these are hyperelliptic curves with exactly 1 point at infinity. Real hyperelliptic curves have two points at infinity.  Formal definition  Hyperelliptic curves can be defined over fields of any characteristic . Hence we consider an arbitrary field   K   K   K   and its algebraic closure     K  ¯     normal-¯  K    \overline{K}   . An (imaginary) hyperelliptic curve of genus   g   g   g   over   K   K   K   is given by an equation of the form       C  :     y  2   +   h   (  x  )   y    =   f   (  x  )    ∈   K   [  x  ,  y  ]        normal-:  C         superscript  y  2     h  x  y      f  x          K   x  y        C:y^{2}+h(x)y=f(x)\in K[x,y]      where     h   (  x  )    ∈   K   [  x  ]          h  x     K   delimited-[]  x      h(x)\in K[x]   is a polynomial of degree not larger than   g   g   g   and     f   (  x  )    ∈   K   [  x  ]          f  x     K   delimited-[]  x      f(x)\in K[x]   is a monic polynomial of degree     2  g   +  1        2  g   1    2g+1   . Furthermore we require the curve to have no singular points . In our setting, this entails that no point     (  x  ,  y  )   ∈    K  ¯   ×   K  ¯         x  y      normal-¯  K    normal-¯  K      (x,y)\in\overline{K}\times\overline{K}   satisfies both      y  2   +   h   (  x  )   y    =   f   (  x  )           superscript  y  2     h  x  y      f  x     y^{2}+h(x)y=f(x)   and the equations      2  y   +   h   (  x  )     =  0          2  y     h  x    0    2y+h(x)=0   and      h  ′    (  x  )   y   =    f  ′    (  x  )           superscript  h  normal-′   x  y      superscript  f  normal-′   x     h^{\prime}(x)y=f^{\prime}(x)   . This definition differs from the definition of a general hyperelliptic curve in the fact that   f   f   f   can also have degree     2  g   +  2        2  g   2    2g+2   in the general case. From now on we drop the adjective imaginary and simply talk about hyperelliptic curves, as is often done in literature. Note that the case    g  =  1      g  1    g=1   corresponds to   f   f   f   being a cubic polynomial, agreeing with the definition of an elliptic curve. If we view the curve as lying in the projective plane      ℙ  2    (  K  )        superscript  ℙ  2   K    \mathbb{P}^{2}(K)   with coordinates    (   X  :  Y  :  Z   )       normal-:  X  Y    normal-:    Z     (X:Y:Z)   , we see that there is a particular point lying on the curve, namely the point at infinity     (   0  :  1  :  0   )       normal-:  0  1    normal-:    0     (0:1:0)   denoted by   O   O   O   . So we could write    C  =    {    (  x  ,  y  )   ∈   K  2    |     y  2   +   h   (  x  )   y    =   f   (  x  )     }   ∪   {  O  }        C     conditional-set     x  y    superscript  K  2         superscript  y  2     h  x  y      f  x      O      C=\{(x,y)\in K^{2}|y^{2}+h(x)y=f(x)\}\cup\{O\}   .  Suppose the point    P  =   (  a  ,  b  )       P   a  b     P=(a,b)   not equal to   O   O   O   lies on the curve and consider     P  ¯   =   (  a  ,    -  b   -   h   (  a  )     )        normal-¯  P    a      b     h  a       \overline{P}=(a,-b-h(a))   . As      (    -  b   -   h   (  a  )     )   2   +   h   (  a  )    (    -  b   -   h   (  a  )     )         superscript      b     h  a    2     h  a      b     h  a       (-b-h(a))^{2}+h(a)(-b-h(a))   can be simplified to     b  2   +   h   (  a  )   b        superscript  b  2     h  a  b     b^{2}+h(a)b   , we see that    P  ¯     normal-¯  P    \overline{P}   is also a point on the curve.    P  ¯     normal-¯  P    \overline{P}   is called the opposite of   P   P   P   and   P   P   P   is called a Weierstrass point if    P  =   P  ¯       P   normal-¯  P     P=\overline{P}   , i.e.     h   (  a  )    =   -   2  b          h  a       2  b      h(a)=-2b   . Furthermore, the opposite of   O   O   O   is simply defined as     O  ¯   =  O       normal-¯  O   O    \overline{O}=O   .  Alternative definition  The definition of a hyperelliptic curve can be slightly simplified if we require that the characteristic of   K   K   K   is not equal to 2. To see this we consider the change of variables    x  →  x     normal-→  x  x    x\rightarrow x   and    y  →   y  -    h   (  x  )    2       normal-→  y    y      h  x   2      y\rightarrow y-\frac{h(x)}{2}   , which makes sense if char     (  K  )   ≠  2      K  2    (K)\not=2   . Under this change of variables we rewrite      y  2   +   h   (  x  )   y    =   f   (  x  )           superscript  y  2     h  x  y      f  x     y^{2}+h(x)y=f(x)   to       (   y  -    h   (  x  )    2    )   2   +   h   (  x  )    (   y  -    h   (  x  )    2    )     =   f   (  x  )           superscript    y      h  x   2    2     h  x    y      h  x   2        f  x     \left(y-\frac{h(x)}{2}\right)^{2}+h(x)\left(y-\frac{h(x)}{2}\right)=f(x)   which, in turn, can be rewritten to     y  2   =    f   (  x  )    +    h    (  x  )   2    4         superscript  y  2       f  x       h   superscript  x  2    4      y^{2}=f(x)+\frac{h(x)^{2}}{4}   . As     deg   (  h  )    ≤  g       degree  h   g    \deg(h)\leq g   we know that     deg   (   h  2   )    ≤   2  g        degree   superscript  h  2      2  g     \deg(h^{2})\leq 2g   and hence     f   (  x  )    +    h    (  x  )   2    4         f  x       h   superscript  x  2    4     f(x)+\frac{h(x)^{2}}{4}   is a monic polynomial of degree     2  g   +  1        2  g   1    2g+1   . This means that over a field   K   K   K   with char     (  K  )   ≠  2      K  2    (K)\not=2   every hyperelliptic curve of genus   g   g   g   is isomorphic to one given by an equation of the form    C  :    y  2   =   f   (  x  )        normal-:  C     superscript  y  2     f  x      C:y^{2}=f(x)   where   f   f   f   is a monic polynomial of degree     2  g   +  1        2  g   1    2g+1   and the curve has no singular points. Note that for curves of this form it is easy to check whether the non-singularity criterion is met. A point    P  =   (  a  ,  b  )       P   a  b     P=(a,b)   on the curve is singular if and only if    b  =  0      b  0    b=0   and      f  ′    (  a  )    =  0         superscript  f  normal-′   a   0    f^{\prime}(a)=0   . As    b  =  0      b  0    b=0   and     b  2   =   f   (  a  )         superscript  b  2     f  a     b^{2}=f(a)   , it must be the case that     f   (  a  )    =  0        f  a   0    f(a)=0   and thus   a   a   a   is a multiple root of   f   f   f   . We conclude that the curve    C  :    y  2   =   f   (  x  )        normal-:  C     superscript  y  2     f  x      C:y^{2}=f(x)   has no singular points if and only if   f   f   f   has no multiple roots. Even though the definition of a hyperelliptic curve is quite easy when char     (  K  )   ≠  2      K  2    (K)\not=2   , we should not forget about fields of characteristic 2 as hyperelliptic curve cryptography makes extensive use of such fields.  Example  As an example consider    C  :    y  2   =   f   (  x  )        normal-:  C     superscript  y  2     f  x      C:y^{2}=f(x)   where     f   (  x  )    =     x  5   -   2   x  4    -   7   x  3     +   8   x  2    +   12  x    =   x   (   x  +  1   )    (   x  -  3   )    (   x  +  2   )    (   x  -  2   )            f  x        superscript  x  5     2   superscript  x  4      7   superscript  x  3       8   superscript  x  2      12  x           x    x  1     x  3     x  2     x  2       f(x)=x^{5}-2x^{4}-7x^{3}+8x^{2}+12x=x(x+1)(x-3)(x+2)(x-2)   over   ℝ   ℝ   \mathbb{R}   . As   f   f   f   has degree 5 and the roots are all distinct,   C   C   C   is a curve of genus    g  =  2      g  2    g=2   . Its graph is depicted in Figure 1.  From this picture it is immediately clear that we cannot use the chords and tangents method to define a group law on the set of points of a hyperelliptic curve. The group law on elliptic curves is based on the fact that a straight line through two points lying on an elliptic curve has a unique third intersection point with the curve. Note that this is always true since   O   O   O   lies on the curve. From the graph of   C   C   C   it is clear that this does not need to hold for an arbitrary hyperelliptic curve. Actually, Bézout's theorem states that a straight line and a hyperelliptic curve of genus 2 intersect in 5 points. So, a straight line through two point lying on   C   C   C   does not have a unique third intersection point, it has three other intersection points.  Coordinate ring  The coordinate ring of   C   C   C   over   K   K   K    is defined as        K    [  C  ]    =    K   [  x  ,  y  ]    /   (     y  2   +   h   (  x  )   y    -   f   (  x  )     )          K   delimited-[]  C        K   x  y         superscript  y  2     h  x  y      f  x       \;K[C]=K[x,y]/(y^{2}+h(x)y-f(x))   .  The polynomial       r    (  x  ,  y  )    =     y  2   +   h   (  x  )   y    -   f   (  x  )           r   x  y         superscript  y  2     h  x  y      f  x      \,r(x,y)=y^{2}+h(x)y-f(x)   is irreducible over    K  ¯     normal-¯  K    \overline{K}   , so        K  ¯    [  C  ]    =     K  ¯    [  x  ,  y  ]    /   (     y  2   +   h   (  x  )   y    -   f   (  x  )     )           normal-¯  K    delimited-[]  C         normal-¯  K    x  y         superscript  y  2     h  x  y      f  x       \overline{K}[C]=\overline{K}[x,y]/(y^{2}+h(x)y-f(x))   is an integral domain .  Proof . If    r   (  x  ,  y  )       r   x  y     r(x,y)   were reducible over    K  ¯     normal-¯  K    \overline{K}   , it would factor as     (   y  -   u   (  x  )     )   ·   (   y  -   v   (  x  )     )         y    u  x    normal-·    y    v  x      (y-u(x)){{·}}(y-v(x))   for some    u  ,  v     u  v    u,v   ∈    K  ¯     normal-¯  K    \overline{K}   . But then     u   (  x  )   ·  v   (  x  )    =   f   (  x  )          u  x  normal-·  v  x     f  x     u(x){{·}}v(x)=f(x)   so it has degree     2  g   +  1        2  g   1    2g+1   , and      u   (  x  )    +   v   (  x  )     =   h   (  x  )            u  x     v  x      h  x     u(x)+v(x)=h(x)   so it has degree smaller than   g   g   g   , which is impossible.  Note that any polynomial function      G   (  x  ,  y  )    ∈    K  ¯    [  C  ]          G   x  y       normal-¯  K    delimited-[]  C      G(x,y)\in\overline{K}[C]   can be written uniquely as       G    (  x  ,  y  )    =    u   (  x  )    -   v   (  x  )   y          G   x  y        u  x     v  x  y      \,G(x,y)=u(x)-v(x)y   with    u   (  x  )       u  x    u(x)   ,    v   (  x  )       v  x    v(x)   '' ∈     K  ¯    [  x  ]        normal-¯  K    delimited-[]  x     \overline{K}[x]     Norm and degree  The conjugate of a polynomial function     G   (  x  ,  y  )    =    u   (  x  )    -   v   (  x  )   y          G   x  y        u  x     v  x  y      G(x,y)=u(x)-v(x)y   in     K  ¯    [  C  ]        normal-¯  K    delimited-[]  C     \overline{K}[C]   is defined to be        G  ¯    (  x  ,  y  )    =    u   (  x  )    +   v   (  x  )    (    h   (  x  )    +  y   )            normal-¯  G    x  y        u  x     v  x      h  x   y       \overline{G}(x,y)=u(x)+v(x)(h(x)+y)   .  The norm of   G   G   G   is the polynomial function     N   (  G  )    =   G   G  ¯          N  G     G   normal-¯  G      N(G)=G\overline{G}   . Note that u(x) 2 + u(x)v(x)h(x) - v(x) 2 f(x)}} , so    N   (  G  )       N  G    N(G)   is a polynomial in only one variable .  If     G   (  x  ,  y  )    =    u   (  x  )    -   v   (  x  )   ·  y          G   x  y        u  x     v  x  normal-·  y      G(x,y)=u(x)-v(x){{·}}y   , then the degree of   G   G   G   is defined as        deg    (  G  )    =   max   [   2   deg   (  u  )     ,    2  g   +  1  +   2   deg   (  v  )      ]         degree  G       2   degree  u        2  g   1    2   degree  v        \,\deg(G)=\max[2\deg(u),2g+1+2\deg(v)]   . Properties:        deg    (  G  )    =    deg  x    (   N   (  G  )    )         degree  G     subscript  degree  x     N  G      \;\deg(G)=\deg_{x}(N(G))           deg    (   G  H   )    =    deg   (  G  )    +   deg   (  H  )          degree    G  H       degree  G    degree  H      \;\deg(GH)=\deg(G)+\deg(H)          deg   (  G  )    =   deg   (   G  ¯   )         degree  G    degree   normal-¯  G      \deg(G)=\deg(\overline{G})     Function field  The function field     K   (  C  )       K  C    K(C)   of   C   C   C   over   K   K   K   is the field of fractions of    K  C  C      K  C  C    KCC   , and the function field     K  ¯    (  C  )        normal-¯  K   C    \overline{K}(C)   of   C   C   C   over    K  ¯     normal-¯  K    \overline{K}   is the field of fractions of     K  ¯    [  C  ]        normal-¯  K    delimited-[]  C     \overline{K}[C]   . The elements of     K  ¯    (  C  )        normal-¯  K   C    \overline{K}(C)   are called rational functions on   C   C   C   . For   R   R   R   such a rational function, and   P   P   P   a finite point on   C   C   C   ,   R   R   R   is said to be defined at   P   P   P   if there exist polynomial functions    G  ,  H     G  H    G,H   such that    R  =   G  /  H       R    G  H     R=G/H   and    H   (  P  )   ≠  0      H  P  normal-≠  0    H(P)≠0   , and then the value of   R   R   R   at   P   P   P   is        R    (  P  )    =     G   (  P  )    /  H    (  P  )          R  P         G  P   H   P     \,R(P)=G(P)/H(P)   . For   P   P   P   a point on   C   C   C   that is not finite, i.e.   P   P   P   =   O   O   O   , we define    R   (  P  )       R  P    R(P)   as: :If      deg    (  G  )    <   deg   (  H  )         degree  G    degree  H     \;\deg(G)<\deg(H)   then     R   (  O  )    =  0        R  O   0    R(O)=0   , i.e. R has a zero at O .   If      deg    (  G  )    >   deg   (  H  )         degree  G    degree  H     \;\deg(G)>\deg(H)   then    R   (  O  )       R  O    R(O)   is not defined, i.e. R has a pole at O .  If      deg    (  G  )    =   deg   (  H  )         degree  G    degree  H     \;\deg(G)=\deg(H)   then    R   (  O  )       R  O    R(O)   is the ratio of the leading coefficients of   G   G   G   and   H   H   H   .   For    R  ∈    K  ¯     (  C  )   *        R     normal-¯  K    superscript  C       R\in\overline{K}(C)^{*}   and    P  ∈  C      P  C    P\in C   ,   If      R    (  P  )    =  0        R  P   0    \;R(P)=0   then   R   R   R   is said to have a zero at   P   P   P   ,  If   R   R   R   is not defined at   P   P   P   then   R   R   R   is said to have a pole at   P   P   P   , and we write     R   (  P  )    =  ∞        R  P      R(P)=\infty   .   Order of a polynomial function at a point  For    G  =    u   (  x  )    -    v   (  x  )    ⋅  y    ∈    K  ¯     [  C  ]   2          G      u  x    normal-⋅    v  x   y            normal-¯  K    superscript   delimited-[]  C   2       G=u(x)-v(x)\cdot y\in\overline{K}[C]^{2}   and    P  ∈  C      P  C    P\in C   , the order of   G   G   G   at   P   P   P   is defined as:        o   r   d  P    (  G  )    =   r  +  s         o  r   subscript  d  P   G     r  s     \;ord_{P}(G)=r+s   if    P  =   (  a  ,  b  )       P   a  b     P=(a,b)   is a finite point which is not Weierstrass. Here   r   r   r   is the highest power of    (   x  -  a   )      x  a    (x-a)   which divides both    u   (  x  )       u  x    u(x)   and    v   (  x  )       v  x    v(x)   . Write (x - a) r (u 0 (x) - v 0 (x)y)}} and if 0}} , then   s   s   s   is the highest power of    (   x  -  a   )      x  a    (x-a)   which divides u 0 2 + u 0 v 0 h - v 0 2 f}} , otherwise,    s  =  0      s  0    s=0   .        o   r   d  P    (  G  )    =    2  r   +  s         o  r   subscript  d  P   G       2  r   s     \;ord_{P}(G)=2r+s   if    P  =   (  a  ,  b  )       P   a  b     P=(a,b)   is a finite Weierstrass point, with   r   r   r   and   s   s   s   as above.        o   r   d  P    (  G  )    =   -   deg   (  G  )           o  r   subscript  d  P   G      degree  G      \;ord_{P}(G)=-\deg(G)   if    P  =  O      P  O    P=O   .  The divisor and the Jacobian  In order to define the Jacobian, we first need the notion of a divisor. Consider a hyperelliptic curve   C   C   C   over some field   K   K   K   . Then we define a divisor   D   D   D   to be a formal sum of points in   C   C   C   , i.e.    D  =    ∑   P  ∈  C      c  P    [  P  ]         D    subscript     P  C       subscript  c  P    delimited-[]  P       D=\sum_{P\in C}{c_{P}[P]}   where     c  P   ∈   \Z        subscript  c  P   \Z    c_{P}\in\Z   and furthermore    {   c  P   |    c  P   ≠  0   }     conditional-set   subscript  c  P      subscript  c  P   0     \{c_{P}|c_{P}\not=0\}   is a finite set. This means that a divisor is a finite formal sum of scalar multiples of points. Note that there is no simplification of     c  P    [  P  ]        subscript  c  P    delimited-[]  P     c_{P}[P]   given by a single point (as one might expect from the analogy with elliptic curves). Furthermore we define the degree of   D   D   D   as     deg   (  D  )    =    ∑   P  ∈  C     c  P    ∈   \Z          degree  D     subscript     P  C     subscript  c  P         \Z     \deg(D)=\sum_{P\in C}{c_{P}}\in\Z   . The set of all divisors    Div   (  C  )       Div  C    \mathrm{Div}(C)   of the curve   C   C   C   forms an Abelian group where the addition is defined pointwise as follows       ∑   P  ∈  C      c  P    [  P  ]     +    ∑   P  ∈  C      d  P    [  P  ]      =    ∑   P  ∈  C      (    c  P   +   d  P    )    [  P  ]             subscript     P  C       subscript  c  P    delimited-[]  P       subscript     P  C       subscript  d  P    delimited-[]  P        subscript     P  C         subscript  c  P    subscript  d  P     delimited-[]  P       \sum_{P\in C}{c_{P}[P]}+\sum_{P\in C}{d_{P}[P]}=\sum_{P\in C}{(c_{P}+d_{P})[P]}   . It is easy to see that    0  =    ∑   P  ∈  C     0   [  P  ]         0    subscript     P  C      0   delimited-[]  P       0=\sum_{P\in C}{0[P]}   acts as the identity element and that the inverse of     ∑   P  ∈  C      c  P    [  P  ]        subscript     P  C       subscript  c  P    delimited-[]  P      \sum_{P\in C}{c_{P}[P]}   equals     ∑   P  ∈  C    -    c  P    [  P  ]         subscript     P  C       subscript  c  P    delimited-[]  P      \sum_{P\in C}{-c_{P}[P]}   . The set      Div  0    (  C  )    =   {   D  ∈   Div   (  C  )     |    deg   (  D  )    =  0   }          superscript  Div  0   C    conditional-set    D    Div  C       degree  D   0      \mathrm{Div}^{0}(C)=\{D\in\mathrm{Div}(C)|\deg(D)=0\}   of all divisors of degree 0 can easily be checked to be a subgroup of    Div   (  C  )       Div  C    \mathrm{Div}(C)   .  Proof . Consider the map    φ  :    Div   (  C  )    →  ℤ      normal-:  φ   normal-→    Div  C   ℤ     \varphi:\mathrm{Div}(C)\rightarrow\mathbb{Z}   defined by     φ   (  D  )    =   deg   (  D  )          φ  D    degree  D     \varphi(D)=\deg(D)   , note that   ℤ   ℤ   \mathbb{Z}   forms a group under the usual addition. Then     φ   (     ∑   P  ∈  C      c  P    [  P  ]     +    ∑   P  ∈  C      d  P    [  P  ]      )    =   φ   (    ∑   P  ∈  C      (    c  P   +   d  P    )    [  P  ]     )    =     ∑   P  ∈  C     c  P    +   d  P    =     ∑   P  ∈  C     c  p    +    ∑   P  ∈  C     d  p     =    φ   (    ∑   P  ∈  C      c  P    [  P  ]     )    +   φ   (    ∑   P  ∈  C      d  P    [  P  ]     )             φ      subscript     P  C       subscript  c  P    delimited-[]  P       subscript     P  C       subscript  d  P    delimited-[]  P         φ    subscript     P  C         subscript  c  P    subscript  d  P     delimited-[]  P               subscript     P  C     subscript  c  P     subscript  d  P             subscript     P  C     subscript  c  p      subscript     P  C     subscript  d  p              φ    subscript     P  C       subscript  c  P    delimited-[]  P        φ    subscript     P  C       subscript  d  P    delimited-[]  P          \varphi(\sum_{P\in C}{c_{P}[P]}+\sum_{P\in C}{d_{P}[P]})=\varphi(\sum_{P\in C}%
 {(c_{P}+d_{P})[P]})=\sum_{P\in C}{c_{P}+d_{P}}=\sum_{P\in C}{c_{p}}+\sum_{P\in
 C%
 }{d_{p}}=\varphi(\sum_{P\in C}{c_{P}[P]})+\varphi(\sum_{P\in C}{d_{P}[P]})   and hence   φ   φ   \varphi   is a group homomorphism . Now,     Div  0    (  C  )        superscript  Div  0   C    \mathrm{Div}^{0}(C)   is the kernel of this homomorphism and thus it is a subgroup of    Div   (  C  )       Div  C    \mathrm{Div}(C)   .  Consider a function    f  ∈    K  ¯     (  C  )   *        f     normal-¯  K    superscript  C       f\in\overline{K}(C)^{*}   , then we can look at the formal sum div     (  f  )   =    ∑   P  ∈  C      ord  P    (  f  )    [  P  ]         f    subscript     P  C       subscript  ord  P   f   delimited-[]  P       (f)=\sum_{P\in C}{\mathrm{ord}_{P}(f)[P]}   . Here ord     (  f  )    P      subscript   fragments  normal-(  f  normal-)   P    {}_{P}(f)   denotes the order of   f   f   f   at   P   P   P   . We have that ord      (  f  )    P    <  0     fragments   subscript   fragments  normal-(  f  normal-)   P    0    {}_{P}(f)<0   if   f   f   f   has a pole of order -ord     (  f  )    P      subscript   fragments  normal-(  f  normal-)   P    {}_{P}(f)   at   P   P   P   , ord      (  f  )    P    =  0     fragments   subscript   fragments  normal-(  f  normal-)   P    0    {}_{P}(f)=0   if   f   f   f   is defined and non-zero at   P   P   P   and ord      (  f  )    P    >  0     fragments   subscript   fragments  normal-(  f  normal-)   P    0    {}_{P}(f)>0   if   f   f   f   has a zero of order ord     (  f  )    P      subscript   fragments  normal-(  f  normal-)   P    {}_{P}(f)   at   P   P   P   . 1 It can be shown that   f   f   f   has only a finite number of zeroes and poles, 2 and thus only finitely many of the ord     (  f  )    P      subscript   fragments  normal-(  f  normal-)   P    {}_{P}(f)   are non-zero. This implies that div    (  f  )    f   (f)   is a divisor. Moreover, as      ∑   P  ∈  C      ord  P    (  f  )     =  0        subscript     P  C       subscript  ord  P   f    0    \sum_{P\in C}{\mathrm{ord}_{P}(f)}=0   , 3 it is the case that div    (  f  )    f   (f)   is a divisor of degree 0. Such divisors, i.e. divisors coming from some rational function   f   f   f   , are called principal divisors and the set of all principal divisors    Princ   (  C  )       Princ  C    \mathrm{Princ}(C)   is a subgroup of     Div  0    (  C  )        superscript  Div  0   C    \mathrm{Div}^{0}(C)   .  Proof . The identity element    0  =    ∑   P  ∈  C     0   [  P  ]         0    subscript     P  C      0   delimited-[]  P       0=\sum_{P\in C}{0[P]}   comes from a constant function which is non-zero. Suppose      D  1   =    ∑   P  ∈  C      ord  P    (  f  )    [  P  ]      ,    D  2   =    ∑   P  ∈  C      ord  P    (  g  )    [  P  ]     ∈   Princ   (  C  )        formulae-sequence     subscript  D  1     subscript     P  C       subscript  ord  P   f   delimited-[]  P           subscript  D  2     subscript     P  C       subscript  ord  P   g   delimited-[]  P            Princ  C       D_{1}=\sum_{P\in C}{\mathrm{ord}_{P}(f)[P]},D_{2}=\sum_{P\in C}{\mathrm{ord}_{%
 P}(g)[P]}\in\mathrm{Princ}(C)   are two principal divisors coming from   f   f   f   and   g   g   g   respectively. Then      D  1   -   D  2    =    ∑   P  ∈  C      (     ord  P    (  f  )    -    ord  P    (  g  )     )    [  P  ]            subscript  D  1    subscript  D  2      subscript     P  C           subscript  ord  P   f      subscript  ord  P   g     delimited-[]  P       D_{1}-D_{2}=\sum_{P\in C}{(\mathrm{ord}_{P}(f)-\mathrm{ord}_{P}(g))[P]}   comes from the function    f  /  g      f  g    f/g   , and thus     D  1   -   D  2        subscript  D  1    subscript  D  2     D_{1}-D_{2}   is a principal divisor, too. We conclude that    Princ   (  C  )       Princ  C    \mathrm{Princ}(C)   is closed under addition and inverses, making it into a subgroup.  We can now define the quotient group      J   (  C  )    :=      Div  0    (  C  )    /  Princ    (  C  )       assign    J  C          superscript  Div  0   C   Princ   C     J(C):=\mathrm{Div}^{0}(C)/\mathrm{Princ}(C)   which is called the Jacobian or the Picard group of   C   C   C   . Two divisors      D  1   ,   D  2    ∈    Div  0    (  C  )          subscript  D  1    subscript  D  2       superscript  Div  0   C     D_{1},D_{2}\in\mathrm{Div}^{0}(C)   are called equivalent if they belong to the same element of    J   (  C  )       J  C    J(C)   , this is the case if and only if     D  1   -   D  2        subscript  D  1    subscript  D  2     D_{1}-D_{2}   is a principal divisor. Consider for example a hyperelliptic curve    C  :     y  2   +   h   (  x  )   y    =   f   (  x  )        normal-:  C       superscript  y  2     h  x  y      f  x      C:y^{2}+h(x)y=f(x)   over a field   K   K   K   and a point    P  =   (  a  ,  b  )       P   a  b     P=(a,b)   on   C   C   C   . For    n  ∈   ℤ    >  0        n   subscript  ℤ    absent  0      n\in\mathbb{Z}_{>0}   the rational function     f   (  x  )    =    (   x  -  a   )   n         f  x    superscript    x  a   n     f(x)=(x-a)^{n}   has a zero of order   n   n   n   at both   P   P   P   and    P  ¯     normal-¯  P    \overline{P}   and it has a pole of order    2  n      2  n    2n   at   O   O   O   . Therefore we find div     (  f  )   =     n  P   +   n   P  ¯     -   2  n  O        f        n  P     n   normal-¯  P       2  n  O      (f)=nP+n\overline{P}-2nO   and we can simplify this to div     (  f  )   =    2  n  P   -   2  n  O        f      2  n  P     2  n  O      (f)=2nP-2nO   if   P   P   P   is a Weierstrass point.  Example: the Jacobian of an elliptic curve  For elliptic curves the Jacobian turns out to simply be isomorphic to the usual group on the set of points on this curve, this is basically a corollary of the Abel-Jacobi theorem . To see this consider an elliptic curve   E   E   E   over a field   K   K   K   . The first step is to relate a divisor   D   D   D   to every point   P   P   P   on the curve. To a point   P   P   P   on   E   E   E   we associate the divisor     D  P   =    1   [  P  ]    -   1   [  O  ]          subscript  D  P       1   delimited-[]  P      1   delimited-[]  O       D_{P}=1[P]-1[O]   , in particular   O   O   O   in linked to the identity element     O  -  O   =  0        O  O   0    O-O=0   . In a straightforward fashion we can now relate an element of    J   (  E  )       J  E    J(E)   to each point   P   P   P   by linking   P   P   P   to the class of    D  P     subscript  D  P    D_{P}   , denoted by    [   D  P   ]     delimited-[]   subscript  D  P     [D_{P}]   . Then the map    φ  :   E  →   J   (  E  )        normal-:  φ   normal-→  E    J  E      \varphi:E\rightarrow J(E)   from the group of points on   E   E   E   to the Jacobian of   E   E   E   defined by     φ   (  P  )    =   [   D  P   ]         φ  P    delimited-[]   subscript  D  P      \varphi(P)=[D_{P}]   is a group homomorphism. This can be shown by looking at three points on   E   E   E   adding up to   O   O   O   , i.e. we take     P  ,  Q  ,  R   ∈  E       P  Q  R   E    P,Q,R\in E   with     P  +  Q  +  R   =  O        P  Q  R   O    P+Q+R=O   or     P  +  Q   =   -  R         P  Q     R     P+Q=-R   . We now relate the addition law on the Jacobian to the geometric group law on elliptic curves. Adding   P   P   P   and   Q   Q   Q   geometrically means drawing a straight line through   P   P   P   and   Q   Q   Q   , this line intersects the curve in one other point. We then define    P  +  Q      P  Q    P+Q   as the opposite of this point. Hence in the case     P  +  Q  +  R   =  O        P  Q  R   O    P+Q+R=O   we have that these three points are collinear, thus there is some linear    f  ∈   K   [  x  ,  y  ]        f    K   x  y      f\in K[x,y]   such that   P   P   P   ,   Q   Q   Q   and   R   R   R   satisfy     f   (  x  ,  y  )    =  0        f   x  y    0    f(x,y)=0   . Now,      φ   (  P  )    +   φ   (  Q  )    +   φ   (  R  )     =    [   D  P   ]   +   [   D  Q   ]   +   [   D  R   ]    =   [     [  P  ]   +   [  Q  ]   +   [  R  ]    -   3   [  O  ]     ]             φ  P     φ  Q     φ  R       delimited-[]   subscript  D  P     delimited-[]   subscript  D  Q     delimited-[]   subscript  D  R           delimited-[]       delimited-[]  P    delimited-[]  Q    delimited-[]  R      3   delimited-[]  O         \varphi(P)+\varphi(Q)+\varphi(R)=[D_{P}]+[D_{Q}]+[D_{R}]=[[P]+[Q]+[R]-3[O]]   which is the identity element of    J   (  E  )       J  E    J(E)   as      [  P  ]   +   [  Q  ]   +   [  R  ]    -   3   [  O  ]           delimited-[]  P    delimited-[]  Q    delimited-[]  R      3   delimited-[]  O      [P]+[Q]+[R]-3[O]   is the divisor on the rational function   f   f   f   and thus it is a principal divisor. We conclude that      φ   (  P  )    +   φ   (  Q  )    +   φ   (  R  )     =   φ   (  O  )    =   φ   (   P  +  Q  +  R   )              φ  P     φ  Q     φ  R      φ  O          φ    P  Q  R       \varphi(P)+\varphi(Q)+\varphi(R)=\varphi(O)=\varphi(P+Q+R)   .  The Abel-Jacobi theorem states that a divisor    D  =    ∑   P  ∈  E      c  P    [  P  ]         D    subscript     P  E       subscript  c  P    delimited-[]  P       D=\sum_{P\in E}{c_{P}[P]}   is principal if and only if   D   D   D   has degree 0 and      ∑   P  ∈  E      c  P   P    =  O        subscript     P  E       subscript  c  P   P    O    \sum_{P\in E}{c_{P}P}=O   under the usual addition law for points on cubic curves. As two divisors      D  1   ,   D  2    ∈    Div  0    (  E  )          subscript  D  1    subscript  D  2       superscript  Div  0   E     D_{1},D_{2}\in\mathrm{Div}^{0}(E)   are equivalent if and only if     D  1   -   D  2        subscript  D  1    subscript  D  2     D_{1}-D_{2}   is principal, we conclude that     D  1   =    ∑   P  ∈  E      c  P    [  P  ]          subscript  D  1     subscript     P  E       subscript  c  P    delimited-[]  P       D_{1}=\sum_{P\in E}{c_{P}[P]}   and     D  2   =    ∑   P  ∈  E      d  P    [  P  ]          subscript  D  2     subscript     P  E       subscript  d  P    delimited-[]  P       D_{2}=\sum_{P\in E}{d_{P}[P]}   are equivalent if and only if      ∑   P  ∈  E      c  P   P    =    ∑   P  ∈  E      d  P   P          subscript     P  E       subscript  c  P   P      subscript     P  E       subscript  d  P   P      \sum_{P\in E}{c_{P}P}=\sum_{P\in E}{d_{P}P}   . Now, every nontrivial divisor of degree 0 is equivalent to a divisor of the form     [  P  ]   -   [  O  ]        delimited-[]  P    delimited-[]  O     [P]-[O]   , this implies that we have found a way to ascribe a point on   E   E   E   to every class    [   D  P   ]     delimited-[]   subscript  D  P     [D_{P}]   . Namely, to     [   D  P   ]   =   [    1   [  P  ]    -   1   [  O  ]     ]        delimited-[]   subscript  D  P     delimited-[]      1   delimited-[]  P      1   delimited-[]  O        [D_{P}]=[1[P]-1[O]]   we ascribe the point      (   P  -  O   )   +  O   =  P          P  O   O   P    (P-O)+O=P   . This maps extends to the neutral element 0 which is maped to     0  +  O   =  O        0  O   O    0+O=O   . As such the map    ψ  :    J   (  E  )    →  E      normal-:  ψ   normal-→    J  E   E     \psi:J(E)\rightarrow E   defined by     ψ   (   [   D  P   ]   )    =  P        ψ   delimited-[]   subscript  D  P     P    \psi([D_{P}])=P   is the inverse of   φ   φ   \varphi   . So   φ   φ   \varphi   is in fact a group isomorphism , proving that   E   E   E   and    J   (  E  )       J  E    J(E)   are isomorphic.  The Jacobian of a hyperelliptic curve  The general hyperelliptic case is a bit more complicated. Consider a hyperelliptic curve    C  :     y  2   +   h   (  x  )   y    =   f   (  x  )        normal-:  C       superscript  y  2     h  x  y      f  x      C:y^{2}+h(x)y=f(x)   of genus   g   g   g   over a field   K   K   K   . A divisor   D   D   D   of   C   C   C   is called reduced if it has the form    D  =     ∑   i  =  1   k    [   P  i   ]    -   k   [  O  ]         D      superscript   subscript     i  1    k    delimited-[]   subscript  P  i       k   delimited-[]  O       D=\sum_{i=1}^{k}{[P_{i}]}-k[O]   where    k  ≤  g      k  g    k\leq g   ,     P  i   ≠  O       subscript  P  i   O    P_{i}\not=O   for all    i  =   1  ,  …  ,  k       i   1  normal-…  k     i=1,...,k   and     P  i   ≠    P  j   ¯        subscript  P  i    normal-¯   subscript  P  j      P_{i}\not=\overline{P_{j}}   for    i  ≠  j      i  j    i\not=j   . Note that a reduced divisor always has degree 0, also it is possible that     P  i   =   P  j        subscript  P  i    subscript  P  j     P_{i}=P_{j}   if    i  ≠  j      i  j    i\not=j   , but only if    P  i     subscript  P  i    P_{i}   is not a Weierstrass point. It can be proven that for each divisor    D  ∈    Div  0    (  C  )        D     superscript  Div  0   C     D\in\mathrm{Div}^{0}(C)   there is a unique reduced divisor    D  ′     superscript  D  normal-′    D^{\prime}   such that   D   D   D   is equivalent to    D  ′     superscript  D  normal-′    D^{\prime}   . 4 Hence every class of the quotient group    J   (  C  )       J  C    J(C)   has precisely one reduced divisor. Instead of looking at    J   (  C  )       J  C    J(C)   we can thus look at the set of all reduced divisors.  Reduced divisors and their Mumford representation  A convenient way to look at reduced divisors is via their Mumford representation. A divisor in this representation consists of a pair of polynomials     u  ,  v   ∈   K   [  x  ]         u  v     K   delimited-[]  x      u,v\in K[x]   such that   u   u   u   is monic,     deg   (  v  )    <   deg   (  u  )    ≤  g         degree  v    degree  u        g     \deg(v)<\deg(u)\leq g   and    u  |   v  2   +  v  h  -  f     fragments  u  normal-|   superscript  v  2    v  h   f    u|v^{2}+vh-f   . Every non-trivial reduced divisor can be represented by a unique pair of such polynomials. This can be seen by factoring     u   (  x  )    =    ∏   i  =  1   k    (   x  -   x  i    )          u  x     superscript   subscript  product    i  1    k     x   subscript  x  i       u(x)=\prod_{i=1}^{k}{(x-x_{i})}   in    K  ¯     normal-¯  K    \overline{K}   which can be done as such as   u   u   u   is monic. The last condition on   u   u   u   and   v   v   v   then implies that the point     P  i   =   (   x  i   ,   v   (   x  i   )    )        subscript  P  i     subscript  x  i     v   subscript  x  i       P_{i}=(x_{i},v(x_{i}))   lies on   C   C   C   for every    i  =   1  ,  …  ,  k       i   1  normal-…  k     i=1,...,k   . Thus    D  =     ∑   i  =  1   k    [   P  i   ]    -   k   [  O  ]         D      superscript   subscript     i  1    k    delimited-[]   subscript  P  i       k   delimited-[]  O       D=\sum_{i=1}^{k}{[P_{i}]}-k[O]   is a divisor and in fact it can be shown to be a reduced divisor. For example the condition     deg   (  u  )    ≤  g       degree  u   g    \deg(u)\leq g   ensures that    k  ≤  g      k  g    k\leq g   . This gives the 1-1 correspondence between reduced divisors and divisors in Mumford representation. As an example,    0  =    ∑   P  ∈  C     0   [  P  ]         0    subscript     P  C      0   delimited-[]  P       0=\sum_{P\in C}{0[P]}   is the unique reduced divisor belonging to the identity element of    J   (  C  )       J  C    J(C)   . Its Mumford representation is     u   (  x  )    =  1        u  x   1    u(x)=1   and     v   (  x  )    =  0        v  x   0    v(x)=0   . Going back and forth between reduced divisors and their Mumford representation is now an easy task. For example consider the hyperelliptic curve    C  :    y  2   =     x  5   -   4   x  4    -   14   x  3     +   36   x  2    +   45  x    =   x   (   x  +  1   )    (   x  -  3   )    (   x  +  3   )    (   x  -  5   )        normal-:  C       superscript  y  2        superscript  x  5     4   superscript  x  4      14   superscript  x  3       36   superscript  x  2      45  x           x    x  1     x  3     x  3     x  5        C:y^{2}=x^{5}-4x^{4}-14x^{3}+36x^{2}+45x=x(x+1)(x-3)(x+3)(x-5)   of genus 2 over the real numbers. We can find the following points on the curve    P  =   (  1  ,  8  )       P   1  8     P=(1,8)   ,    Q  =   (  3  ,  0  )       Q   3  0     Q=(3,0)   and    R  =   (  5  ,  0  )       R   5  0     R=(5,0)   . Then we can define reduced divisors    D  =     [  P  ]   +   [  Q  ]    -   2   [  O  ]         D       delimited-[]  P    delimited-[]  Q      2   delimited-[]  O       D=[P]+[Q]-2[O]   and     D  ′   =     [  P  ]   +   [  R  ]    -   2   [  O  ]          superscript  D  normal-′        delimited-[]  P    delimited-[]  R      2   delimited-[]  O       D^{\prime}=[P]+[R]-2[O]   . The Mumford representation of   D   D   D   consists of polynomials   u   u   u   and   v   v   v   with     deg   (  v  )    <   deg   (  u  )    ≤  g  =  2         degree  v    degree  u        g       2     \deg(v)<\deg(u)\leq g=2   and we know that the first coordinates of   P   P   P   and   Q   Q   Q   , i.e. 1 and 3, must be zeroes of   u   u   u   . Hence we have     u   (  x  )    =    (   x  -  1   )    (   x  -  3   )    =     x  2   -   4  x    +  3           u  x       x  1     x  3              superscript  x  2     4  x    3      u(x)=(x-1)(x-3)=x^{2}-4x+3   . As    P  =   (  1  ,   v   (  1  )    )       P   1    v  1      P=(1,v(1))   and    Q  =   (  3  ,   v   (  3  )    )       Q   3    v  3      Q=(3,v(3))   it must be the case that     v   (  1  )    =  8        v  1   8    v(1)=8   and     v   (  3  )    =  0        v  3   0    v(3)=0   and thus   v   v   v   has degree 1. There is exactly one polynomial of degree 1 with these properties, namely     v   (  x  )    =    -   4  x    +  12         v  x         4  x    12     v(x)=-4x+12   . Thus the Mumford representation of   D   D   D   is     u   (  x  )    =     x  2   -   4  x    +  3         u  x        superscript  x  2     4  x    3     u(x)=x^{2}-4x+3   and     v   (  x  )    =    -   4  x    +  12         v  x         4  x    12     v(x)=-4x+12   . In a similar fashion we can find the Mumford representation    (   u  ′   ,   v  ′   )      superscript  u  normal-′    superscript  v  normal-′     (u^{\prime},v^{\prime})   of    D  ′     superscript  D  normal-′    D^{\prime}   , we have      u  ′    (  x  )    =    (   x  -  1   )    (   x  -  5   )    =     x  2   -   6  x    +  5            superscript  u  normal-′   x       x  1     x  5              superscript  x  2     6  x    5      u^{\prime}(x)=(x-1)(x-5)=x^{2}-6x+5   and     v   (  x  )    =    -   2  x    +  10         v  x         2  x    10     v(x)=-2x+10   . If a point     P  i   =   (   x  i   ,   y  i   )        subscript  P  i     subscript  x  i    subscript  y  i      P_{i}=(x_{i},y_{i})   appears with multiplicity n , the polynomial v needs to satisfy       (   d   d  t    )   j     [     v    (  x  )   2    +   v   (  x  )   h   (  x  )     -   f   (  x  )     ]    |   x  =   x  i       =  0         superscript    d    d  t    j    subscript   delimited-[]        v   superscript  x  2      v  x  h  x      f  x      subscript  normal-|    x   subscript  x  i       0    \left(\frac{d}{dt}\right)^{j}\left[v(x)^{2}+v(x)h(x)-f(x)\right]_{|_{x=x_{i}}}=0   for    0  ≤  j  ≤    n  i   -  1         0  j          subscript  n  i   1      0\leq j\leq n_{i}-1   .  Cantor's algorithm  There is an algorithm which takes two reduced divisors    D  1     subscript  D  1    D_{1}   and    D  2     subscript  D  2    D_{2}   in their Mumford representation and produces the unique reduced divisor   D   D   D   , again in its Mumford representation, such that   D   D   D   is equivalent to     D  1   +   D  2        subscript  D  1    subscript  D  2     D_{1}+D_{2}   . 5 As every element of the Jacobian can be represented by the one reduced divisor it contains, the algorithm allows to perform the group operation on these reduced divisors given in their Mumford representation. The algorithm was originally developed by David G. Cantor (not to be confused with Georg Cantor ), explaining the name of the algorithm. Cantor only looked at the case     h   (  x  )    =  0        h  x   0    h(x)=0   , the general case is due to Koblitz . The input is two reduced divisors     D  1   =   (   u  1   ,   v  1   )        subscript  D  1     subscript  u  1    subscript  v  1      D_{1}=(u_{1},v_{1})   and     D  2   =   (   u  2   ,   v  2   )        subscript  D  2     subscript  u  2    subscript  v  2      D_{2}=(u_{2},v_{2})   in their Mumford representation of the hyperelliptic curve    C  :     y  2   +   h   (  x  )   y    =   f   (  x  )        normal-:  C       superscript  y  2     h  x  y      f  x      C:y^{2}+h(x)y=f(x)   of genus   g   g   g   over the field   K   K   K   . The algorithm works as follows   Using the extended Euclidean algorithm compute the polynomials      d  1   ,   e  1   ,   e  2    ∈   K   [  x  ]          subscript  d  1    subscript  e  1    subscript  e  2      K   delimited-[]  x      d_{1},e_{1},e_{2}\in K[x]   such that     d  1   =   gcd   (   u  1   ,   u  2   )         subscript  d  1      subscript  u  1    subscript  u  2      d_{1}=\gcd(u_{1},u_{2})   and     d  1   =     e  1    u  1    +    e  2    u  2          subscript  d  1        subscript  e  1    subscript  u  1       subscript  e  2    subscript  u  2       d_{1}=e_{1}u_{1}+e_{2}u_{2}   .  Again with the use of the extended Euclidean algorithm compute the polynomials     d  ,   c  1   ,   c  2    ∈   K   [  x  ]         d   subscript  c  1    subscript  c  2      K   delimited-[]  x      d,c_{1},c_{2}\in K[x]   with    d  =   gcd   (   d  1   ,    v  1   +   v  2   +  h   )        d     subscript  d  1      subscript  v  1    subscript  v  2   h      d=\gcd(d_{1},v_{1}+v_{2}+h)   and    d  =     c  1    d  1    +    c  2    (    v  1   +   v  2   +  h   )         d       subscript  c  1    subscript  d  1       subscript  c  2      subscript  v  1    subscript  v  2   h       d=c_{1}d_{1}+c_{2}(v_{1}+v_{2}+h)   .  Put     s  1   =    c  1    e  1         subscript  s  1      subscript  c  1    subscript  e  1      s_{1}=c_{1}e_{1}   ,     s  2   =    c  1    e  2         subscript  s  2      subscript  c  1    subscript  e  2      s_{2}=c_{1}e_{2}   and     s  3   =   c  2        subscript  s  3    subscript  c  2     s_{3}=c_{2}   , which gives    d  =     s  1    u  1    +    s  2    u  2    +    s  3    (    v  1   +   v  2   +  h   )         d       subscript  s  1    subscript  u  1       subscript  s  2    subscript  u  2       subscript  s  3      subscript  v  1    subscript  v  2   h       d=s_{1}u_{1}+s_{2}u_{2}+s_{3}(v_{1}+v_{2}+h)   .  Set    u  =     u  1    u  2     d  2        u       subscript  u  1    subscript  u  2     superscript  d  2      u=\frac{u_{1}u_{2}}{d^{2}}   and    v  =       s  1    u  1    v  2    +    s  2    u  2    v  1    +    s  3    (     v  1    v  2    +  f   )     d   mod  u       v   modulo         subscript  s  1    subscript  u  1    subscript  v  2       subscript  s  2    subscript  u  2    subscript  v  1       subscript  s  3        subscript  v  1    subscript  v  2    f     d   u     v=\frac{s_{1}u_{1}v_{2}+s_{2}u_{2}v_{1}+s_{3}(v_{1}v_{2}+f)}{d}\mod u   .  Set     u  ′   =    f  -   v  h   -   v  2    u        superscript  u  normal-′       f    v  h    superscript  v  2    u     u^{\prime}=\frac{f-vh-v^{2}}{u}   and     v  ′   =     -  h   -  v   mod   u  ′         superscript  v  normal-′    modulo      h   v    superscript  u  normal-′      v^{\prime}=-h-v\mod u^{\prime}   .  If     deg   (   u  ′   )    >  g       degree   superscript  u  normal-′    g    \deg(u^{\prime})>g   , then set    u  =   u  ′       u   superscript  u  normal-′     u=u^{\prime}   and    v  =   v  ′       v   superscript  v  normal-′     v=v^{\prime}   and repeat step 5 until     deg   (   u  ′   )    ≤  g       degree   superscript  u  normal-′    g    \deg(u^{\prime})\leq g   .  Make    u  ′     superscript  u  normal-′    u^{\prime}   monic by dividing through its leading coefficient.  Output    D  =   (   u  ′   ,   v  ′   )       D    superscript  u  normal-′    superscript  v  normal-′      D=(u^{\prime},v^{\prime})   .   The proof that the algorithm is correct can be found in . 6  Example  As an example consider the curve      C  :    y  2   =     x  5   -   4   x  4    -   14   x  3     +   36   x  2    +   45  x    =   x   (   x  +  1   )    (   x  -  3   )    (   x  +  3   )    (   x  -  5   )        normal-:  C       superscript  y  2        superscript  x  5     4   superscript  x  4      14   superscript  x  3       36   superscript  x  2      45  x           x    x  1     x  3     x  3     x  5        C:y^{2}=x^{5}-4x^{4}-14x^{3}+36x^{2}+45x=x(x+1)(x-3)(x+3)(x-5)     of genus 2 over the real numbers. For the points      P  =   (  1  ,  8  )       P   1  8     P=(1,8)   ,    Q  =   (  3  ,  0  )       Q   3  0     Q=(3,0)   and    R  =   (  5  ,  0  )       R   5  0     R=(5,0)   and the reduced divisors       D  1   =     [  P  ]   +   [  Q  ]    -   2   [  O  ]          subscript  D  1        delimited-[]  P    delimited-[]  Q      2   delimited-[]  O       D_{1}=[P]+[Q]-2[O]   and     D  2   =     [  P  ]   +   [  R  ]    -   2   [  O  ]          subscript  D  2        delimited-[]  P    delimited-[]  R      2   delimited-[]  O       D_{2}=[P]+[R]-2[O]   we know that      (     u  1   =     x  2   -   4  x    +  3    ,    v  1   =    -   4  x    +  12     )     formulae-sequence     subscript  u  1        superscript  x  2     4  x    3       subscript  v  1         4  x    12      (u_{1}=x^{2}-4x+3,v_{1}=-4x+12)   , and      (     u  2   =     x  2   -   6  x    +  5    ,    v  2   =    -   2  x    +  10     )     formulae-sequence     subscript  u  2        superscript  x  2     6  x    5       subscript  v  2         2  x    10      (u_{2}=x^{2}-6x+5,v_{2}=-2x+10)   are the Mumford representations of    D  1     subscript  D  1    D_{1}   and    D  2     subscript  D  2    D_{2}   respectively.  We can compute their sum using Cantor's algorithm. We begin by computing       d  1   =   gcd   (   u  1   ,   u  2   )    =   x  -  1          subscript  d  1      subscript  u  1    subscript  u  2           x  1      d_{1}=\gcd(u_{1},u_{2})=x-1   , and       d  1   =     e  1    u  1    +    e  2    u  2          subscript  d  1        subscript  e  1    subscript  u  1       subscript  e  2    subscript  u  2       d_{1}=e_{1}u_{1}+e_{2}u_{2}   for     e  1   =   1  2        subscript  e  1     1  2     e_{1}=\frac{1}{2}   , and     e  2   =   -   1  2         subscript  e  2       1  2      e_{2}=-\frac{1}{2}   .  In the second step we find      d  =   gcd   (   d  1   ,    v  1   +   v  2   +  h   )    =   gcd   (   x  -  1   ,    -   6  x    +  22   )    =  1        d     subscript  d  1      subscript  v  1    subscript  v  2   h             x  1         6  x    22         1     d=\gcd(d_{1},v_{1}+v_{2}+h)=\gcd(x-1,-6x+22)=1   and      1  =     c  1    d  1    +    c  2    (    v  1   +   v  2   +  h   )         1       subscript  c  1    subscript  d  1       subscript  c  2      subscript  v  1    subscript  v  2   h       1=c_{1}d_{1}+c_{2}(v_{1}+v_{2}+h)   for     c  1   =   3  8        subscript  c  1     3  8     c_{1}=\frac{3}{8}   and     c  2   =   1  16        subscript  c  2     1  16     c_{2}=\frac{1}{16}   .  Now we can compute       s  1   =    c  1    e  1    =   3  16          subscript  s  1      subscript  c  1    subscript  e  1           3  16      s_{1}=c_{1}e_{1}=\frac{3}{16}   ,       s  2   =    c  1    e  2    =   -   3  16           subscript  s  2      subscript  c  1    subscript  e  2             3  16       s_{2}=c_{1}e_{2}=-\frac{3}{16}   and       s  3   =   c  2   =   1  16          subscript  s  3    subscript  c  2          1  16      s_{3}=c_{2}=\frac{1}{16}   . So      u  =     u  1    u  2     d  2    =    u  1    u  2    =       x  4   -   10   x  3     +   32   x  2     -   38  x    +  15         u       subscript  u  1    subscript  u  2     superscript  d  2            subscript  u  1    subscript  u  2                  superscript  x  4     10   superscript  x  3       32   superscript  x  2       38  x    15      u=\frac{u_{1}u_{2}}{d^{2}}=u_{1}u_{2}=x^{4}-10x^{3}+32x^{2}-38x+15   and      v  =       s  1    u  1    v  2    +    s  2    u  2    v  1    +    s  3    (     v  1    v  2    +  f   )     d   mod  u       v   modulo         subscript  s  1    subscript  u  1    subscript  v  2       subscript  s  2    subscript  u  2    subscript  v  1       subscript  s  3        subscript  v  1    subscript  v  2    f     d   u     v=\frac{s_{1}u_{1}v_{2}+s_{2}u_{2}v_{1}+s_{3}(v_{1}v_{2}+f)}{d}\mod u            =     1  16    (     x  5   -   4   x  4    -   8   x  3    -   10   x  2     +   119  x   +  30   )    mod  u       absent   modulo      1  16        superscript  x  5     4   superscript  x  4      8   superscript  x  3      10   superscript  x  2       119  x   30    u     =\frac{1}{16}(x^{5}-4x^{4}-8x^{3}-10x^{2}+119x+30)\mod u          =    1  4    (      5   x  3    -   41   x  2     +   83  x    -  15   )        absent      1  4           5   superscript  x  3      41   superscript  x  2       83  x    15      =\frac{1}{4}(5x^{3}-41x^{2}+83x-15)   .     Lastly we find       u  ′   =    f  -   v  2    u   =    1  16    (     -   25   x  2     +   176  x    -  15   )           superscript  u  normal-′       f   superscript  v  2    u            1  16           25   superscript  x  2       176  x    15       u^{\prime}=\frac{f-v^{2}}{u}=\frac{1}{16}(-25x^{2}+176x-15)   and       v  ′   =    -  v   mod   u  ′    =   -    72  125    (    17  x   -  5   )            superscript  v  normal-′    modulo    v    superscript  u  normal-′               72  125       17  x   5        v^{\prime}=-v\mod u^{\prime}=-\frac{72}{125}(17x-5)   . After making    u  ′     superscript  u  normal-′    u^{\prime}   monic we conclude that      D  =   (     -   25   x  2     +   176  x    -  15   ,   -    72  125    (    17  x   -  5   )     )       D           25   superscript  x  2       176  x    15         72  125       17  x   5        D=(-25x^{2}+176x-15,-\frac{72}{125}(17x-5))   is equivalent to     D  1   +   D  2        subscript  D  1    subscript  D  2     D_{1}+D_{2}   .  More on Cantor's algorithm  Cantor's algorithm as presented here has a general form, it holds for hyperelliptic curves of any genus and over any field. However, the algorithm is not very efficient. For example, it requires the use of the extended Euclidean algorithm. If we fix the genus of the curve or the characteristic of the field (or both), we can make the algorithm more efficient. For some special cases we even get explicit addition and doubling formulas which are very fast. For example, there are explicit formulas for hyperelliptic curves of genus 2 7  8 and genus 3.  For hyperelliptic curves it is also fairly easy to visualize the adding of two reduced divisors. Suppose we have a hyperelliptic curve of genus 2 over the real numbers of the form      C  :    y  2   =   f   (  x  )        normal-:  C     superscript  y  2     f  x      C:y^{2}=f(x)   and two reduced divisors       D  1   =     [  P  ]   +   [  Q  ]    -   2   [  O  ]          subscript  D  1        delimited-[]  P    delimited-[]  Q      2   delimited-[]  O       D_{1}=[P]+[Q]-2[O]   and       D  2   =     [  R  ]   +   [  S  ]    -   2   [  O  ]          subscript  D  2        delimited-[]  R    delimited-[]  S      2   delimited-[]  O       D_{2}=[R]+[S]-2[O]   . Assume that        P  ,  Q   ≠   R  ¯    ,   S  ¯      formulae-sequence     P  Q    normal-¯  R     normal-¯  S     P,Q\not=\overline{R},\overline{S}   , this case has to be treated separately. There is exactly 1 cubic polynomial       a   (  x  )    =     a  0    x  3    +    a  1    x  2    +    a  2   x   +   a  3          a  x        subscript  a  0    superscript  x  3       subscript  a  1    superscript  x  2       subscript  a  2   x    subscript  a  3      a(x)=a_{0}x^{3}+a_{1}x^{2}+a_{2}x+a_{3}   going through the four points      P  ,  Q  ,  R  ,  S     P  Q  R  S    P,Q,R,S   . Note here that it could be possible that for example    P  =  Q      P  Q    P=Q   , hence we must take multiplicities into account. Putting    y  =   a   (  x  )        y    a  x     y=a(x)   we find that       y  2   =   f   (  x  )    =    a  2    (  x  )           superscript  y  2     f  x           superscript  a  2   x      y^{2}=f(x)=a^{2}(x)   and hence        f   (  x  )    -    a  2    (  x  )     =  0          f  x      superscript  a  2   x    0    f(x)-a^{2}(x)=0   . As     f   (  x  )    -    a  2    (  x  )          f  x      superscript  a  2   x     f(x)-a^{2}(x)   is a polynomial of degree 6, we have that     f   (  x  )    -    a  2    (  x  )          f  x      superscript  a  2   x     f(x)-a^{2}(x)   has six zeroes and hence    a   (  x  )       a  x    a(x)   has besides    P  ,  Q  ,  R  ,  S     P  Q  R  S    P,Q,R,S   two more intersection points with   C   C   C   , call them   T   T   T   and   U   U   U   , with    T  ≠   U  ¯       T   normal-¯  U     T\not=\overline{U}   . Now,    P  ,  Q  ,  R  ,  S  ,  T  ,  U     P  Q  R  S  T  U    P,Q,R,S,T,U   are intersection points of   C   C   C   with an algebraic curve. As such we know that the divisor      D  =     [  P  ]   +   [  Q  ]   +   [  R  ]   +   [  S  ]   +   [  T  ]   +   [  U  ]    -   6   [  O  ]         D       delimited-[]  P    delimited-[]  Q    delimited-[]  R    delimited-[]  S    delimited-[]  T    delimited-[]  U      6   delimited-[]  O       D=[P]+[Q]+[R]+[S]+[T]+[U]-6[O]   is principal which implies that the divisor        [  P  ]   +   [  Q  ]   +   [  R  ]   +   [  S  ]    -   4   [  O  ]           delimited-[]  P    delimited-[]  Q    delimited-[]  R    delimited-[]  S      4   delimited-[]  O      [P]+[Q]+[R]+[S]-4[O]   is equivalent to the divisor      -   (     [  T  ]   +   [  U  ]    -   2   [  O  ]     )            delimited-[]  T    delimited-[]  U      2   delimited-[]  O       -([T]+[U]-2[O])   . Furthermore the divisor        [  P  ]   +   [   P  ¯   ]    -   2   [  O  ]           delimited-[]  P    delimited-[]   normal-¯  P       2   delimited-[]  O      [P]+[\overline{P}]-2[O]   is principal for every point    P  =   (  a  ,  b  )       P   a  b     P=(a,b)   on   C   C   C   as it comes from the rational function     b   (  x  )    =   x  -  a         b  x     x  a     b(x)=x-a   . This gives that    -   (    [  P  ]   -   [  O  ]    )          delimited-[]  P    delimited-[]  O      -([P]-[O])   and     [   P  ¯   ]   -   [  O  ]        delimited-[]   normal-¯  P     delimited-[]  O     [\overline{P}]-[O]   are equivalent. Combining these two properties we conclude that        D  1   +   D  2    =    (     [  P  ]   +   [  Q  ]    -   2   [  O  ]     )   +   (     [  R  ]   +   [  S  ]    -   2   [  O  ]     )           subscript  D  1    subscript  D  2           delimited-[]  P    delimited-[]  Q      2   delimited-[]  O          delimited-[]  R    delimited-[]  S      2   delimited-[]  O        D_{1}+D_{2}=([P]+[Q]-2[O])+([R]+[S]-2[O])   is equivalent to the reduced divisor        [   T  ¯   ]   +   [   U  ¯   ]    -   2   [  O  ]           delimited-[]   normal-¯  T     delimited-[]   normal-¯  U       2   delimited-[]  O      [\overline{T}]+[\overline{U}]-2[O]   . In a picture this looks like Figure 2. It is possible to explicitly compute the coefficients of    a   (  x  )       a  x    a(x)   , in this way we can arrive at explicit formulas for adding two reduced divisors.  (Figure)  Figure 2: Example of adding two elements of the Jacobian   References  "  Category:Algebraic curves     Isabelle Déchène, The Picard Group, or how to build a group from a set ↩  Alfred J. Menezes, Yi-Hong Wu, Robert J. Zuccherato, An elementary introduction to hyperelliptic curves , page 15 ↩   Alfred J. Menezes, Yi-Hong Wu, Robert J. Zuccherato, An elementary introduction to hyperelliptic curves , page 20 ↩  Alfred J. Menezes, Yi-Hong Wu, Robert J. Zuccherato, An elementary introduction to hyperelliptic curves , page 22–27 ↩  ↩  Frank Leitenberger, About the Group Law for the Jacobi Variety of a Hyperelliptic Curve ↩  ↩     
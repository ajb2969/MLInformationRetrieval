<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="414">Mod n cryptanalysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Mod n cryptanalysis</h1>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, <strong>mod <em>n</em> cryptanalysis</strong> is an <a href="cryptanalysis" title="wikilink">attack</a> applicable to <a href="block_cipher" title="wikilink">block</a> and <a href="stream_cipher" title="wikilink">stream ciphers</a>. It is a form of <a href="partitioning_cryptanalysis" title="wikilink">partitioning cryptanalysis</a> that exploits unevenness in how the <a class="uri" href="cipher" title="wikilink">cipher</a> operates over <a href="equivalence_class" title="wikilink">equivalence classes</a> (congruence classes) <a href="modular_arithmetic" title="wikilink">modulo <em>n</em></a>. The method was first suggested in 1999 by <a href="John_Kelsey_(cryptanalyst)" title="wikilink">John Kelsey</a>, <a href="Bruce_Schneier" title="wikilink">Bruce Schneier</a>, and <a href="David_A._Wagner" title="wikilink">David Wagner</a> and applied to RC5P (a variant of <a class="uri" href="RC5" title="wikilink">RC5</a>) and <a href="M6_(cipher)" title="wikilink">M6</a> (a family of block ciphers used in the <a class="uri" href="FireWire" title="wikilink">FireWire</a> standard). These attacks used the properties of binary addition and bit rotation modulo a <a href="Fermat_prime" title="wikilink">Fermat prime</a>.</p>
<h2 id="mod-3-analysis-of-rc5p">Mod 3 analysis of RC5P</h2>

<p>For RC5P, analysis was conducted modulo 3. It was observed that the operations in the cipher (rotation and addition, both on 32-bit words) were somewhat biased over congruence classes mod 3. To illustrate the approach, consider left rotation by a single bit:</p>

<p>

<math display="block" id="Mod_n_cryptanalysis:0">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>⋘</mo>
   <mn>1</mn>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>X</mi>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>X</mi>
        </mrow>
        <mo><</mo>
        <msup>
         <mn>2</mn>
         <mn>31</mn>
        </msup>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mi>X</mi>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo>-</mo>
         <msup>
          <mn>2</mn>
          <mn>32</mn>
         </msup>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>X</mi>
        </mrow>
        <mo>≥</mo>
        <msup>
         <mn>2</mn>
         <mn>31</mn>
        </msup>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">X</csymbol>
    <csymbol cd="latexml">very-much-less-than</csymbol>
    <cn type="integer">1</cn>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <matrix>
      <matrixrow>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>X</ci>
       </apply>
       <apply>
        <lt></lt>
        <apply>
         <times></times>
         <mtext>if</mtext>
         <ci>X</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <cn type="integer">31</cn>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>X</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <cn type="integer">32</cn>
        </apply>
       </apply>
       <apply>
        <geq></geq>
        <apply>
         <times></times>
         <mtext>if</mtext>
         <ci>X</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <cn type="integer">2</cn>
         <cn type="integer">31</cn>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\lll 1=\left\{\begin{matrix}2X,&\mbox{if }X<2^{31}\\
2X+1-2^{32},&\mbox{if }X\geq 2^{31}\end{matrix}\right.
  </annotation>
 </semantics>
</math>

</p>

<p>Then, because</p>

<p>

<math display="block" id="Mod_n_cryptanalysis:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mn>2</mn>
     <mn>32</mn>
    </msup>
    <mo>≡</mo>
    <mrow>
     <mn>1</mn>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>3</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <cn type="integer">32</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <cn type="integer">1</cn>
     <apply>
      <ci>pmod</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{32}\equiv 1\;\;(\mathop{{\rm mod}}3),\,
  </annotation>
 </semantics>
</math>

</p>

<p>we can deduce that</p>

<p>

<math display="block" id="Mod_n_cryptanalysis:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>⋘</mo>
    <mn>1</mn>
    <mo>≡</mo>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>X</mi>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mn>3</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">very-much-less-than</csymbol>
     <ci>X</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>X</ci>
      </apply>
      <apply>
       <ci>pmod</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\lll 1\equiv 2X\;\;(\mathop{{\rm mod}}3).
  </annotation>
 </semantics>
</math>

</p>

<p>Thus left rotation by a single bit has a simple description modulo 3. Analysis of other operations (data dependent rotation and modular addition) reveals similar, notable biases. Although there are some theoretical problems analysing the operations in combination, the bias can be detected experimentally for the entire cipher. In (Kelsey et al., 1999), experiments were conducted up to seven rounds, and based on this they conjecture that as many as nineteen or twenty rounds of RC5P can be distinguished from random using this attack. There is also a corresponding method for recovering the secret <a href="key_(cryptography)" title="wikilink">key</a>.</p>

<p>Against M6 there are attacks mod 5 and mod 257 that are even more effective.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a> <a href="Category:Modular_arithmetic" title="wikilink">Category:Modular arithmetic</a></p>
</body>
</html>

   Šidák correction for t-test      Šidák correction for t-test   One of the application of Student's t-test is to test the location of one sequence of independent and identically distributed random variables . If we want to test the locations of multiple sequences of such variables, Šidák correction should be applied in order to calibrate the level of the Student's t-test. Moreover, if we want to test the locations of nearly infinitely many sequences of variables, then Šidák correction should be used, but with caution. More specifically, the validity of Šidák correction depends on how fast the number of sequences goes to infinity.  Introduction of Šidák correction  Suppose we are interested in m different null hypotheses,     H  1   ,  …  ,   H  m       subscript  H  1   normal-…   subscript  H  m     H_{1},...,H_{m}   , and would like to check if all of them are true. Now the hypothesis test scheme becomes       H   n  u  l  l    :      normal-:   subscript  H    n  u  l  l    absent    H_{null}:    all of     H  i     subscript  H  i    H_{i}    are true;       H   a  l  t  e  r  n  a  t  i  v  e    :      normal-:   subscript  H    a  l  t  e  r  n  a  t  i  v  e    absent    H_{alternative}:    at least one of     H  i     subscript  H  i    H_{i}    is false.  Let   α   α   \alpha   be the level of this test, that is, the probability that we falsely reject    H   n  u  l  l      subscript  H    n  u  l  l     H_{null}   when it is true. Now we aim to design a test with certain level   α   α   \alpha   . Suppose when testing each null hypothesis    H  i     subscript  H  i    H_{i}   , the statistic we use is    t  i     subscript  t  i    t_{i}   . If these    t  i     subscript  t  i    t_{i}   's are independent, then a test for    H   n  u  l  l      subscript  H    n  u  l  l     H_{null}   can be developed by the following procedures, known as Šidák correction.   Step 1, we test each of m null hypotheses at level    1  -    (   1  -  α   )    1  m        1   superscript    1  α     1  m      1-(1-\alpha)^{\frac{1}{m}}   .    Step 2, if any of these m null hypotheses is rejected, we reject    H   n  u  l  l      subscript  H    n  u  l  l     H_{null}   .   Šidák correction for finitely many t-test  Suppose       Y   i  j    =    μ  i   +   ϵ   i  j      ,    i  =   1  ,  …  ,  N    ,   j  =   1  ,  …  ,  n      ,     formulae-sequence     subscript  Y    i  j       subscript  μ  i    subscript  ϵ    i  j       formulae-sequence    i   1  normal-…  N      j   1  normal-…  n       Y_{ij}=\mu_{i}+\epsilon_{ij},i=1,...,N,j=1,...,n,   where for each i ,     ϵ   i  1    ,  …  ,   ϵ   i  n        subscript  ϵ    i  1    normal-…   subscript  ϵ    i  n      \epsilon_{i1},...,\epsilon_{in}   are independently and identically distributed, for each j      ϵ   1  j    ,  …  ,   ϵ   N  j        subscript  ϵ    1  j    normal-…   subscript  ϵ    N  j      \epsilon_{1j},...,\epsilon_{Nj}   are independent but not necessarily identically distributed, and    ϵ   i  j      subscript  ϵ    i  j     \epsilon_{ij}   has finite fourth moment.  Our goal is to design a test for     H   n  u  l  l    :     μ  i   =  0   ,    ∀  i   =   1  ,  …  ,  N        normal-:   subscript  H    n  u  l  l     formulae-sequence     subscript  μ  i   0      for-all  i    1  normal-…  N       H_{null}:\mu_{i}=0,\forall i=1,...,N   with level   α   α   \alpha   . This test can be based on the t-statistic of each sequences, that is,       t  i   =     Y  ¯   i     S  i   /   n          subscript  t  i      subscript   normal-¯  Y   i      subscript  S  i     n       t_{i}=\frac{\bar{Y}_{i}}{S_{i}/\sqrt{n}}    , where        Y  ¯   i   =    1  n     ∑   j  =  1   n    Y   i  j           subscript   normal-¯  Y   i       1  n     superscript   subscript     j  1    n    subscript  Y    i  j        \bar{Y}_{i}=\frac{1}{n}\sum_{j=1}^{n}Y_{ij}    ,      S  i  2   =    1  n     ∑   j  =  1   n     (    Y   i  j    -    Y  ¯   i    )   2          superscript   subscript  S  i   2       1  n     superscript   subscript     j  1    n    superscript     subscript  Y    i  j     subscript   normal-¯  Y   i    2       S_{i}^{2}=\frac{1}{n}\sum_{j=1}^{n}(Y_{ij}-\bar{Y}_{i})^{2}    .  Using Šidák correction, we reject    H   n  u  l  l      subscript  H    n  u  l  l     H_{null}   if any of the t-tests based on the t-statistics above reject at level    1  -    (   1  -  α   )    1  /  N        1   superscript    1  α     1  N      1-(1-\alpha)^{1/N}   . More specifically, we reject    H   n  u  l  l      subscript  H    n  u  l  l     H_{null}   when        ∃  i   =   1  ,  …  ,  N    ,    |   t  i   |   >   ζ   α  ,  N        formulae-sequence      i    1  normal-…  N         subscript  t  i     subscript  ζ   α  N       \exists i=1,...,N,|t_{i}|>\zeta_{\alpha,N}    , where      P   (  |  Z  |  >   ζ   α  ,  N    )   =  1  -    (  1  -  α  )    1  /  N       fragments  P   fragments  normal-(  normal-|  Z  normal-|    subscript  ζ   α  N    normal-)    1    superscript   fragments  normal-(  1   α  normal-)     1  N      P(|Z|>\zeta_{\alpha,N})=1-(1-\alpha)^{1/N}    ,     Z  ∼   N   (  0  ,  1  )       similar-to  Z    N   0  1      Z\sim N(0,1)     The test defined above has asymptotic level   α   α   \alpha   , because      l  e  v  e  l  =   P   n  u  l  l     (  reject   H   n  u  l  l    )   =   P   n  u  l  l     (  ∃  i  =  1  ,  …  ,  N  ,  |   t  i   |  >   ζ   α  ,  N    )      fragments  l  e  v  e  l    subscript  P    n  u  l  l     fragments  normal-(  reject   subscript  H    n  u  l  l    normal-)     subscript  P    n  u  l  l     fragments  normal-(   i   1  normal-,  normal-…  normal-,  N  normal-,  normal-|   subscript  t  i   normal-|    subscript  ζ   α  N    normal-)     level=P_{null}(\text{reject }H_{null})=P_{null}(\exists i=1,...,N,|t_{i}|>%
 \zeta_{\alpha,N})         =  1  -   P   n  u  l  l     (  ∀  i  =  1  ,  …  ,  N  |   t  i   |  ≤   ζ   α  ,  N    =  1  -   Π   i  =  1   N    P   n  u  l  l     (  |   t  i   |  ≤   ζ   α  ,  N    )       fragments   1    subscript  P    n  u  l  l     fragments  normal-(  for-all  i   1  normal-,  normal-…  normal-,  N  normal-|   subscript  t  i   normal-|    subscript  ζ   α  N     1    superscript   subscript  normal-Π    i  1    N    subscript  P    n  u  l  l     fragments  normal-(  normal-|   subscript  t  i   normal-|    subscript  ζ   α  N    normal-)      =1-P_{null}(\forall i=1,...,N|t_{i}|\leq\zeta_{\alpha,N}=1-\Pi_{i=1}^{N}P_{%
 null}(|t_{i}|\leq\zeta_{\alpha,N})       →  1  -   Π   i  =  1   N   P   (  |   Z  i   |  ≤   ζ   α  ,  N    )   where   Z  i   ∼  N   (  0  ,  1  )      fragments  normal-→  1    superscript   subscript  normal-Π    i  1    N   P   fragments  normal-(  normal-|   subscript  Z  i   normal-|    subscript  ζ   α  N    normal-)   where   subscript  Z  i   similar-to  N   fragments  normal-(  0  normal-,  1  normal-)     \rightarrow 1-\Pi_{i=1}^{N}P(|Z_{i}|\leq\zeta_{\alpha,N})\text{ where }Z_{i}%
 \sim N(0,1)        =  α      absent  α    =\alpha     Šidák correction for infinitely many t-test  In some cases, the number of sequences,   N   N   N   , increase as the data size of each sequences,   n   n   n   , increase. In particular, suppose     N   (  n  )    →   ∞  as  n   →  ∞       normal-→    N  n      as  n     normal-→        N(n)\rightarrow\infty\text{ as }n\rightarrow\infty   . If this is true, then we will need to test a null including infinitely many hypotheses, that is        H   n  u  l  l    :    all of   H  i   are true,  i   =   1  ,  2  ,  …     .     normal-:   subscript  H    n  u  l  l        all of   subscript  H  i   are true,  i    1  2  normal-…      H_{null}:\text{ all of }H_{i}\text{ are true, }i=1,2,....     To design a test, Šidák correction may be applied, as in the case of finitely many t-test. However, when     N   (  n  )    →   ∞  as  n   →  ∞       normal-→    N  n      as  n     normal-→        N(n)\rightarrow\infty\text{ as }n\rightarrow\infty   , the Šidák correction for t-test may not achieve the level we want, that is, the true level of the test may not converges to the nominal level   α   α   \alpha   as n goes to infinity. This result is related to high-dimensional statistics and is proven by Fan, Hall and Yao (2007). 1 Specifically, if we want the true level of the test converges to the nominal level   α   α   \alpha   , then we need a restraint on how fast     N   (  n  )    →  ∞     normal-→    N  n      N(n)\rightarrow\infty   . Indeed,   When all of    ϵ   i  j      subscript  ϵ    i  j     \epsilon_{ij}   have distribution symmetric about zero, then it is sufficient to require     log  N   =   o   (   n   1  /  3    )          N     o   superscript  n    1  3       \log N=o(n^{1/3})   to guarantee the true level converges to   α   α   \alpha   .    When the distributions of    ϵ   i  j      subscript  ϵ    i  j     \epsilon_{ij}   are asymmetric, then it is necessary to impose     log  N   =   o   (   n   1  /  2    )          N     o   superscript  n    1  2       \log N=o(n^{1/2})   to ensure the true level converges to   α   α   \alpha   .    Actually, if we apply bootstrapping method to the calibration of level, then we will only need     log  N   =   o   (   n   1  /  3    )          N     o   superscript  n    1  3       \log N=o(n^{1/3})   even if    ϵ   i  j      subscript  ϵ    i  j     \epsilon_{ij}   has asymmetric distribution.   The results above are based on Central Limit Theorem . According to Central Limit Theorem, each of our t-statistics    t  i     subscript  t  i    t_{i}   possesses asymptotic standard normal distribution, and so the difference between the distribution of each    t  i     subscript  t  i    t_{i}   and the standard normal distribution is asymptotically negligible. The question is, if we aggregate all the differences between the distribution of each    t  i     subscript  t  i    t_{i}   and the standard normal distribution, is this aggregation of differences still asymptotically ignorable?  When we have finitely many    t  i     subscript  t  i    t_{i}   , the answer is yes. But when we have infinitely many    t  i     subscript  t  i    t_{i}   , the answer some time becomes no. This is because in the latter case we are summing up infinitely many infinitesimal terms. If the number of the terms goes to infinity too fast, that is,     N   (  n  )    →  ∞     normal-→    N  n      N(n)\rightarrow\infty   too fast, then the sum may not be zero, the distribution of the t-statistics can not be approximated by the standard normal distribution, the true level does not converges to the nominal level   α   α   \alpha   , and then the Šidák correction fails.  See also   Šidák correction  Multiple comparisons  Bonferroni correction  Familywise error rate  Closed testing procedure   Notes  References     "  Category:Multiple comparisons     ↩     
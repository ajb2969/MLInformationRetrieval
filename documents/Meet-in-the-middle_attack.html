<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="808">Meet-in-the-middle attack</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Meet-in-the-middle attack</h1>
<hr/>

<p>The <strong>Meet-in-the-Middle attack</strong> (MITM) is a generic <a href="space–time_tradeoff" title="wikilink">space–time tradeoff</a> <a href="cryptography" title="wikilink">cryptographic</a> attack.</p>
<h2 id="description">Description</h2>

<p>MITM is a generic attack, applicable on several cryptographic systems. The internal structure of a specific system is therefore unimportant to this attack.</p>

<p>An attacker requires the ability to encrypt and decrypt, and the possession of pairs of plaintexts and corresponding ciphertexts.</p>

<p>When trying to improve the security of a block cipher, a tempting idea is to simply use several independent <a href="cryptographic_key" title="wikilink">keys</a> to encrypt the data several times using a sequence of functions (encryptions). Then one might think that this doubles or even <em>n</em>-tuples the security of the multiple-encryption scheme, depending on the number of encryptions the data must go through.</p>

<p>The Meet-in-the-Middle attack attempts to find a value using both of the range (ciphertext) and domain (plaintext) of the composition of several functions (or block ciphers) such that the forward mapping through the first functions is the same as the backward mapping (inverse image) through the last functions, quite literally <em>meeting</em> in the middle of the composed function.</p>

<p>The Multidimensional MITM (MD-MITM) uses a combination of several simultaneous MITM-attacks like described above, where the meeting happens in multiple positions in the composed function.</p>

<p>An exhaustive search on all possible combination of keys (simple brute-force) would take <em>2<sup>k·j</sup></em> attempts if <em>j</em> encryptions has been used with different keys in each encryption, where each key is <em>k</em> bits long. MITM or MD-MITM improves on this performance.</p>
<h2 id="history">History</h2>

<p>It was first developed as an attack on an attempted expansion of a <a href="block_cipher" title="wikilink">block cipher</a> by <a href="Whitfield_Diffie" title="wikilink">Diffie</a> and <a href="Martin_Hellman" title="wikilink">Hellman</a> in 1977.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>Diffie and Hellman, however, devised a <a href="space-time_tradeoff" title="wikilink">space-time tradeoff</a> that could break the scheme in only double the time to break the single-encryption scheme.</p>

<p>In 2011, Bo Zhu and Guang Gong investigated the <em>Multidimensional Meet-in-the-Middle attack</em> and presented new attacks on the block ciphers <a href="GOST_(block_cipher)" title="wikilink">GOST</a>, <a class="uri" href="KTANTAN" title="wikilink">KTANTAN</a> and <a class="uri" href="Hummingbird-2" title="wikilink">Hummingbird-2</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="mitm-1d-mitm">MITM (1D-MITM)</h2>

<p>Assume the attacker knows a set of plaintext <em>P</em> and ciphertext <em>C</em> that satisfies the following:</p>

<p>

<math display="inline" id="Meet-in-the-middle_attack:0">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle C
  </annotation>
 </semantics>
</math>


</p>

<p>where <em>ENC</em> is the encryption function, <em>DEC</em> the decryption function defined as <em>ENC<sup>−1</sup></em> (inverse mapping) and <em>k<sub>1</sub></em> and <em>k<sub>2</sub></em> are two keys.</p>

<p>The attacker can then compute <em>ENC<sub>k<sub>1</sub></sub>(P)</em> for all possible keys <em>k<sub>1</sub></em> and then decrypt the ciphertext by computing <em>DEC<sub>k<sub>2</sub></sub>(C)</em> for each <em>k<sub>2</sub></em>. Any matches between these two resulting sets are likely to reveal the correct keys. (To speed up the comparison, the <em>ENC<sub>k<sub>1</sub></sub>(P)</em> set can be stored in an in-memory lookup table, then each <em>DEC<sub>k<sub>2</sub></sub>(C)</em> can be matched against the values in the lookup table to find the candidate keys)</p>

<p>This attack is one of the reasons why DES was replaced by <a href="Triple_DES" title="wikilink">Triple DES</a> — "Double DES" does not provide much additional security against exhaustive key search for an attacker with 2<sup>56</sup> space.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> However, Triple DES with a "triple length" (168-bit) key is vulnerable to a meet-in-the-middle attack in 2<sup>56</sup> space and 2<sup>112</sup> operations.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p><a href="File:1D_MITMNEW.png" title="wikilink">thumb|upright=1.5|An illustration of 1D-MITM attack</a></p>

<p>Once the matches are discovered, they can be verified with a second test-set of plaintext and ciphertext.</p>
<h3 id="mitm-algorithm">MITM algorithm</h3>

<p>Compute the following:</p>
<ul>
<li>

<math display="inline" id="Meet-in-the-middle_attack:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mi>u</mi>
     <mi>b</mi>
     <mi>C</mi>
     <mi>i</mi>
     <mi>p</mi>
     <mi>h</mi>
     <mi>e</mi>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>E</mi>
     <mi>N</mi>
     <msub>
      <mi>C</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>k</mi>
       <msub>
        <mi>f</mi>
        <mn>1</mn>
       </msub>
      </msub>
      <mo>,</mo>
      <mi>P</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="5.3pt">,</mo>
   <mrow>
    <mrow>
     <mo>∀</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
    </mrow>
    <mo>∈</mo>
    <mi>K</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>u</ci>
      <ci>b</ci>
      <ci>C</ci>
      <ci>i</ci>
      <ci>p</ci>
      <ci>h</ci>
      <ci>e</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>P</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}=ENC_{f_{1}}(k_{f_{1}},P),\;\forall k_{f_{1}}\in K
  </annotation>
 </semantics>
</math>

:
<dl>
<dd>and save each 

<math display="inline" id="Meet-in-the-middle_attack:2">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 together with corresponding 

<math display="inline" id="Meet-in-the-middle_attack:3">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 in a set A
</dd>
</dl></li>
<li>

<math display="inline" id="Meet-in-the-middle_attack:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mi>u</mi>
     <mi>b</mi>
     <mi>C</mi>
     <mi>i</mi>
     <mi>p</mi>
     <mi>h</mi>
     <mi>e</mi>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>D</mi>
     <mi>E</mi>
     <msub>
      <mi>C</mi>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>k</mi>
       <msub>
        <mi>b</mi>
        <mn>1</mn>
       </msub>
      </msub>
      <mo>,</mo>
      <mi>C</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="5.3pt">,</mo>
   <mrow>
    <mrow>
     <mo>∀</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
     </msub>
    </mrow>
    <mo>∈</mo>
    <mi>K</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>u</ci>
      <ci>b</ci>
      <ci>C</ci>
      <ci>i</ci>
      <ci>p</ci>
      <ci>h</ci>
      <ci>e</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>C</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}=DEC_{b_{1}}(k_{b_{1}},C),\;\forall k_{b_{1}}\in K
  </annotation>
 </semantics>
</math>

:
<dl>
<dd>and compare each new 

<math display="inline" id="Meet-in-the-middle_attack:5">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 with the set A
</dd>
</dl></li>
</ul>

<p>When a match is found, keep <em>k<sub>f<sub>1</sub></sub>,k<sub>b<sub>1</sub></sub></em> as candidate key-pair in a table <em>T</em>. Test pairs in <em>T</em> on a new pair of <em>(P,C)</em> to confirm validity. If the key-pair does not work on this new pair, do MITM again on a new pair of <em>(P,C)</em>.</p>
<h3 id="mitm-complexity">MITM complexity</h3>

<p>If the keysize is <em>k</em>, this attack uses only 2<sup>k+1</sup>encryptions (and decryptions) (and <em>O(2<sup>k</sup>)</em> memory in case a look-up table have been built for the set of forward computations) in contrast to the naive attack, which needs 2<sup>2·k</sup> encryptions but <em>O(1)</em> space.</p>
<h2 id="multidimensional-mitm">Multidimensional-MITM</h2>

<p>While 1D-MITM can be efficient, a more sophisticated attack has been developed: <strong>Multi Dimensional-Meet In The Middle attack</strong>, also abbreviated <strong>MD-MITM</strong>. This is more preferred when the data has been encrypted using more than 2 encryptions with different keys. Instead of meeting in the middle (one place in the sequence), the MD-MITM attack attempts to reach several specific intermediate states using the forward and backward computations at several positions in the cipher.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>Assume that the attack has to be mounted on a block cipher, where the encryption and decryption is defined as before:</p>

<p>

<math display="inline" id="Meet-in-the-middle_attack:6">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>k</mi>
      <mi>n</mi>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>E</mi>
      <mi>N</mi>
      <msub>
       <mi>C</mi>
       <msub>
        <mi>k</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">…</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>E</mi>
          <mi>N</mi>
          <msub>
           <mi>C</mi>
           <msub>
            <mi>k</mi>
            <mn>1</mn>
           </msub>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>P</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">…</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-…</ci>
       <apply>
        <times></times>
        <ci>E</ci>
        <ci>N</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>P</ci>
       </apply>
       <ci>normal-…</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=ENC_{k_{n}}(ENC_{k_{n-1}}(...(ENC_{k_{1}}(P))...))
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Meet-in-the-middle_attack:7">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>D</mi>
      <mi>E</mi>
      <msub>
       <mi>C</mi>
       <msub>
        <mi>k</mi>
        <mn>2</mn>
       </msub>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi mathvariant="normal">…</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>D</mi>
          <mi>E</mi>
          <msub>
           <mi>C</mi>
           <msub>
            <mi>k</mi>
            <mi>n</mi>
           </msub>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>C</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">…</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-…</ci>
       <apply>
        <times></times>
        <ci>D</ci>
        <ci>E</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>C</ci>
       </apply>
       <ci>normal-…</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=DEC_{k_{1}}(DEC_{k_{2}}(...(DEC_{k_{n}}(C))...))
  </annotation>
 </semantics>
</math>

</p>

<p>that is a plaintext P is encrypted multiple times using a repetition of the same block cipher</p>

<p><a href="File:MD_MITMNEW.png" title="wikilink">thumb|center|upright=4|An illustration of MD-MITM attack</a></p>

<p>The MD-MITM has been used for cryptanalysis of among many, the <a href="GOST_(block_cipher)" title="wikilink">GOST block cipher</a>, where it has been shown that a 3D-MITM has significantly reduced the time complexity for an attack on it.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h3 id="md-mitm-algorithm">MD-MITM algorithm</h3>

<p>Compute the following:</p>
<ul>
<li><strong>

<math display="inline" id="Meet-in-the-middle_attack:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>f</mi>
      <mn>1</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>P</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}=ENC_{f_{1}}(k_{f_{1}},P)
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:9">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:10">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</strong>:</li>
</ul>
<dl>
<dd>and save each 

<math display="inline" id="Meet-in-the-middle_attack:11">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 together with corresponding 

<math display="inline" id="Meet-in-the-middle_attack:12">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 in a set 

<math display="inline" id="Meet-in-the-middle_attack:13">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{1}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
<ul>
<li><strong>

<math display="inline" id="Meet-in-the-middle_attack:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>b</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </msub>
     <mo>,</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>C</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{n+1}=DEC_{b_{n+1}}(k_{b_{n+1}},C)
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:15">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{n+1}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:16">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</strong>:</li>
</ul>
<dl>
<dd>and save each 

<math display="inline" id="Meet-in-the-middle_attack:17">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{n+1}
  </annotation>
 </semantics>
</math>

 together with corresponding 

<math display="inline" id="Meet-in-the-middle_attack:18">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{n+1}}
  </annotation>
 </semantics>
</math>

 in a set 

<math display="inline" id="Meet-in-the-middle_attack:19">
 <semantics>
  <msub>
   <mi>H</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{n+1}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>

<p>For each possible guess on the intermediate state 

<math display="inline" id="Meet-in-the-middle_attack:20">
 <semantics>
  <msub>
   <mi>s</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{1}
  </annotation>
 </semantics>
</math>

 compute the following:</p>
<ul>
<li><strong>

<math display="inline" id="Meet-in-the-middle_attack:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}=DEC_{b_{1}}(k_{b_{1}},s_{1})
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:22">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{1}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:23">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</strong>:</li>
</ul>
<dl>
<dd>and for each match between this 

<math display="inline" id="Meet-in-the-middle_attack:24">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 and the set 

<math display="inline" id="Meet-in-the-middle_attack:25">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{1}
  </annotation>
 </semantics>
</math>

, save 

<math display="inline" id="Meet-in-the-middle_attack:26">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{1}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Meet-in-the-middle_attack:27">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 in a new set 

<math display="inline" id="Meet-in-the-middle_attack:28">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{1}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
<ul>
<li><strong>

<math display="inline" id="Meet-in-the-middle_attack:29">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>f</mi>
      <mn>2</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}=ENC_{f_{2}}(k_{f_{2}},s_{1})
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:30">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>2</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{2}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:31">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</strong>:</li>
</ul>
<dl>
<dd>and save each 

<math display="inline" id="Meet-in-the-middle_attack:32">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}
  </annotation>
 </semantics>
</math>

 together with corresponding 

<math display="inline" id="Meet-in-the-middle_attack:33">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>2</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{2}}
  </annotation>
 </semantics>
</math>

 in a set 

<math display="inline" id="Meet-in-the-middle_attack:34">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{2}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
<dl>
<dd>For each possible guess on an intermediate state 

<math display="inline" id="Meet-in-the-middle_attack:35">
 <semantics>
  <msub>
   <mi>s</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{2}
  </annotation>
 </semantics>
</math>

 compute the following:
<dl>
<dd><strong>1 

<math display="inline" id="Meet-in-the-middle_attack:36">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>b</mi>
      <mn>2</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}=DEC_{b_{2}}(k_{b_{2}},s_{2})
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:37">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>2</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{2}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:38">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</strong>
<dl>
<dd>and for each match between this 

<math display="inline" id="Meet-in-the-middle_attack:39">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}
  </annotation>
 </semantics>
</math>

 and the set 

<math display="inline" id="Meet-in-the-middle_attack:40">
 <semantics>
  <msub>
   <mi>H</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{2}
  </annotation>
 </semantics>
</math>

, check also whether
</dd>
<dd>it matches with 

<math display="inline" id="Meet-in-the-middle_attack:41">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{1}
  </annotation>
 </semantics>
</math>

 and then save the combination of sub-keys together in a new set 

<math display="inline" id="Meet-in-the-middle_attack:42">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{2}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd><strong>2 ...</strong>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd>For each possible guess on an intermediate state 

<math display="inline" id="Meet-in-the-middle_attack:43">
 <semantics>
  <msub>
   <mi>s</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{n}
  </annotation>
 </semantics>
</math>

 compute the following:
<dl>
<dd>'''a) 

<math display="inline" id="Meet-in-the-middle_attack:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>b</mi>
      <mi>n</mi>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mi>n</mi>
      </msub>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>n</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{n}=DEC_{b_{n}}(k_{b_{n}},s_{n})
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:45">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mi>n</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{n}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:46">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 '''
<dl>
<dd>and for each match between this 

<math display="inline" id="Meet-in-the-middle_attack:47">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{n}
  </annotation>
 </semantics>
</math>

 and the set 

<math display="inline" id="Meet-in-the-middle_attack:48">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{n}
  </annotation>
 </semantics>
</math>

, check also whether
</dd>
<dd>it matches with 

<math display="inline" id="Meet-in-the-middle_attack:49">
 <semantics>
  <msub>
   <mi>T</mi>
   <mrow>
    <mi>n</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <apply>
     <minus></minus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{n-1}
  </annotation>
 </semantics>
</math>

, save 

<math display="inline" id="Meet-in-the-middle_attack:50">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mi>n</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{n}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Meet-in-the-middle_attack:51">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mi>n</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{n}}
  </annotation>
 </semantics>
</math>

 in a new set
</dd>
<dd>

<math display="inline" id="Meet-in-the-middle_attack:52">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{n}
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><dl>
<dd><strong>b) 

<math display="inline" id="Meet-in-the-middle_attack:53">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>n</mi>
      </msub>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mrow>
       <msub>
        <mi>f</mi>
        <mi>n</mi>
       </msub>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mi>n</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>n</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>n</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{n+1}=ENC_{f_{n}+1}(k_{f_{n}+1},s_{n})
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:54">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{n+1}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:55">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</strong>
<dl>
<dd>and for each match between this 

<math display="inline" id="Meet-in-the-middle_attack:56">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{n+1}
  </annotation>
 </semantics>
</math>

 and the set 

<math display="inline" id="Meet-in-the-middle_attack:57">
 <semantics>
  <msub>
   <mi>H</mi>
   <mrow>
    <mi>n</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{n+1}
  </annotation>
 </semantics>
</math>

, check also
</dd>
<dd>whether it matches with 

<math display="inline" id="Meet-in-the-middle_attack:58">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{n}
  </annotation>
 </semantics>
</math>

. If this is the case then:"
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>

<p>Use the found combination of sub-keys 

<math display="inline" id="Meet-in-the-middle_attack:59">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>f</mi>
     <mn>1</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>b</mi>
     <mn>1</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>f</mi>
     <mn>2</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>b</mi>
     <mn>2</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>b</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k_{f_{1}},k_{b_{1}},k_{f_{2}},k_{b_{2}},...,k_{f_{n+1}},k_{b_{n+1}})
  </annotation>
 </semantics>
</math>

 on another pair of plaintext/ciphertext to verify the correctness of the key.</p>

<p>Note the nested element in the algorithm. The guess on every possible value on <em>s<sub>j</sub></em> is done for each guess on the previous <em>s<sub>j-1</sub></em>. This make up an element of exponential complexity to overall time complexity of this MD-MITM attack.</p>
<h3 id="md-mitm-complexity">MD-MITM complexity</h3>

<p>Time complexity of this attack without brute force, is 

<math display="inline" id="Meet-in-the-middle_attack:60">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{|k_{f_{1}}|}+2^{|k_{b_{n+1}}|}+2^{|s_{1}|}
  </annotation>
 </semantics>
</math>

⋅

<math display="inline" id="Meet-in-the-middle_attack:61">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-(</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2^{|k_{b_{1}}|}+2^{|k_{f_{2}}|}+2^{|s_{2}|}
  </annotation>
 </semantics>
</math>

⋅

<math display="inline" id="Meet-in-the-middle_attack:62">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>k</mi>
       <msub>
        <mi>b</mi>
        <mn>2</mn>
       </msub>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </msup>
    <mo>+</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>k</mi>
       <msub>
        <mi>f</mi>
        <mn>3</mn>
       </msub>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
    </msup>
    <mo>+</mo>
    <mi mathvariant="normal">…</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <plus></plus>
     <ci>normal-…</ci>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2^{|k_{b_{2}}|}+2^{|k_{f_{3}}|}+...))
  </annotation>
 </semantics>
</math>

</p>

<p>Regarding the memory complexity, it is easy to see that 

<math display="inline" id="Meet-in-the-middle_attack:63">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>T</mi>
    <mn>3</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>T</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">3</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{2},T_{3},...,T_{n}
  </annotation>
 </semantics>
</math>

 are much smaller than the first built table of candidate values

<math display="block" id="Meet-in-the-middle_attack:64">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{1}
  </annotation>
 </semantics>
</math>

 as i increases, the candidate values contained in 

<math display="inline" id="Meet-in-the-middle_attack:65">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{i}
  </annotation>
 </semantics>
</math>

 must satisfy more conditions thereby fewer candidates will pass on to the end destination 

<math display="inline" id="Meet-in-the-middle_attack:66">
 <semantics>
  <msub>
   <mi>T</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>An upper bound of the memory complexity of MD-MITM is then</p>

<p>

<math display="inline" id="Meet-in-the-middle_attack:67">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <mrow>
    <msup>
     <mn>2</mn>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>k</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>s</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mrow>
    </msup>
    <mi mathvariant="normal">…</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <abs></abs>
        <ci>k</ci>
       </apply>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>s</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-…</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{|k_{f_{1}}|}+2^{|k_{b_{n+1}}|}+2^{|k|-|s_{n}|}...
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Meet-in-the-middle_attack:68">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 denotes the length of the whole key (combined).</p>

<p>The data complexity depends on the probability that a wrong key may pass (obtain a false positive), which is 

<math display="inline" id="Meet-in-the-middle_attack:69">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>l</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/2^{|l|}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Meet-in-the-middle_attack:70">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 is the intermediate state in the first MITM phase. The size of the intermediate state and the block size is often the same! Considering also how many keys that are left for testing after the first MITM-phase, it is 

<math display="inline" id="Meet-in-the-middle_attack:71">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>k</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>/</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>l</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{|k|}/2^{|l|}
  </annotation>
 </semantics>
</math>

.</p>

<p>Therefore after the first MITM phase, there are 

<math display="inline" id="Meet-in-the-middle_attack:72">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>k</mi>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo>-</mo>
    <mi>b</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <minus></minus>
     <apply>
      <abs></abs>
      <ci>k</ci>
     </apply>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{|k|-b}
  </annotation>
 </semantics>
</math>

⋅

<math display="inline" id="Meet-in-the-middle_attack:73">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mi>b</mi>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>k</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mi>b</mi>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <ci>b</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <apply>
       <abs></abs>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{-b}=2^{|k|-2b}
  </annotation>
 </semantics>
</math>

 ,where $|b|$ is the block size.</p>

<p>For each time the final candidate value of the keys are tested on a new plaintext/ciphertext-pair, the amount of keys that will pass will be multiplied by the probability that a key may pass which is 

<math display="inline" id="Meet-in-the-middle_attack:74">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>b</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/2^{|b|}
  </annotation>
 </semantics>
</math>

.</p>

<p>The part of brute force testing (testing the candidate key on new <em>(P,C)</em>-pairs, have time complexity 

<math display="inline" id="Meet-in-the-middle_attack:75">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>k</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mo>-</mo>
     <mi>b</mi>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>k</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mi>b</mi>
     </mrow>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>k</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>3</mn>
      <mi>b</mi>
     </mrow>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>k</mi>
      <mo stretchy="false">|</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mn>4</mn>
      <mi>b</mi>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <apply>
       <abs></abs>
       <ci>k</ci>
      </apply>
      <ci>b</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <apply>
       <abs></abs>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <apply>
       <abs></abs>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <apply>
       <abs></abs>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{|k|-b}+2^{|k|-2b}+2^{|k|-3b}+2^{|k|-4b}
  </annotation>
 </semantics>
</math>

...</p>

<p>,clearly for increasing multiples of b in the exponent, number tends to zero.</p>

<p>The conclusion on data complexity is by similar reasoning restricted by that around ⌈

<math display="inline" id="Meet-in-the-middle_attack:76">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>k</mi>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>/</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <abs></abs>
     <ci>k</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |k|/n
  </annotation>
 </semantics>
</math>

⌉ <em>(P,C)</em>-pairs.</p>

<p>Below is a specific example of how a 2D-MITM is mounted:</p>
<h2 id="a-general-example-of-2d-mitm">A general example of 2D-MITM</h2>

<p>This is a general description of how 2D-MITM is mounted on a block cipher encryption.</p>

<p>In Two-dimensional MITM (2D-MITM) the method is to reach 2 intermediate states inside the multiple encryption of the plaintext. See below figure:</p>

<p><a href="File:2D_MITMNEW.png" title="wikilink">thumb|upright=2|An illustration of 2D-MITM attack</a></p>
<h3 id="d-mitm-algorithm">2D-MITM algorithm</h3>

<p>Compute the following:</p>
<ul>
<li><em>' 

<math display="inline" id="Meet-in-the-middle_attack:77">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>f</mi>
      <mn>1</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <mi>P</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>P</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}=ENC_{f_{1}}(k_{f_{1}},P)
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:78">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:79">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</em>'</li>
</ul>
<dl>
<dd>and save each 

<math display="inline" id="Meet-in-the-middle_attack:80">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 together with corresponding 

<math display="inline" id="Meet-in-the-middle_attack:81">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 in a set A
</dd>
</dl>
<ul>
<li>''' 

<math display="inline" id="Meet-in-the-middle_attack:82">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>b</mi>
      <mn>2</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <mi>C</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>C</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}=DEC_{b_{2}}(k_{b_{2}},C)
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:83">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>2</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{2}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:84">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

</li>
</ul>
<dl>
<dd>and save each 

<math display="inline" id="Meet-in-the-middle_attack:85">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}
  </annotation>
 </semantics>
</math>

 together with corresponding 

<math display="inline" id="Meet-in-the-middle_attack:86">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>2</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{2}}
  </annotation>
 </semantics>
</math>

 in a set B.
</dd>
</dl>

<p>For each possible guess on an intermediate state <em>s</em> between 

<math display="inline" id="Meet-in-the-middle_attack:87">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Meet-in-the-middle_attack:88">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}
  </annotation>
 </semantics>
</math>

 compute the following:</p>
<dl>
<dd>1 

<math display="inline" id="Meet-in-the-middle_attack:89">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>E</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>b</mi>
      <mn>1</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>s</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}=DEC_{b_{1}}(k_{b_{1}},s)
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:90">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{1}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:91">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>


<dl>
<dd>and for each match between this 

<math display="inline" id="Meet-in-the-middle_attack:92">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{1}
  </annotation>
 </semantics>
</math>

 and the set A, save 

<math display="inline" id="Meet-in-the-middle_attack:93">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>b</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>b</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{b_{1}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Meet-in-the-middle_attack:94">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{1}}
  </annotation>
 </semantics>
</math>

 in a new set T.
</dd>
</dl>
</dd>
</dl>
<dl>
<dd>2 

<math display="inline" id="Meet-in-the-middle_attack:95">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>b</mi>
    <mi>C</mi>
    <mi>i</mi>
    <mi>p</mi>
    <mi>h</mi>
    <mi>e</mi>
    <msub>
     <mi>r</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mi>N</mi>
    <msub>
     <mi>C</mi>
     <msub>
      <mi>f</mi>
      <mn>2</mn>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo>,</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>b</ci>
     <ci>C</ci>
     <ci>i</ci>
     <ci>p</ci>
     <ci>h</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>s</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}=ENC_{f_{2}}(k_{f_{2}},s)
  </annotation>
 </semantics>
</math>

 ∀ 

<math display="inline" id="Meet-in-the-middle_attack:96">
 <semantics>
  <msub>
   <mi>k</mi>
   <msub>
    <mi>f</mi>
    <mn>2</mn>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{f_{2}}
  </annotation>
 </semantics>
</math>

 ∈ 

<math display="inline" id="Meet-in-the-middle_attack:97">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>


<dl>
<dd>and for each match between this 

<math display="inline" id="Meet-in-the-middle_attack:98">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>b</mi>
   <mi>C</mi>
   <mi>i</mi>
   <mi>p</mi>
   <mi>h</mi>
   <mi>e</mi>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>b</ci>
    <ci>C</ci>
    <ci>i</ci>
    <ci>p</ci>
    <ci>h</ci>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SubCipher_{2}
  </annotation>
 </semantics>
</math>

 and the set B, check also whether it matches with T for
</dd>
<dd>if this is the case then:
</dd>
</dl>
</dd>
</dl>

<p>Use the found combination of sub-keys 

<math display="inline" id="Meet-in-the-middle_attack:99">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>f</mi>
     <mn>1</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>b</mi>
     <mn>1</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>f</mi>
     <mn>2</mn>
    </msub>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <msub>
     <mi>b</mi>
     <mn>2</mn>
    </msub>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k_{f_{1}},k_{b_{1}},k_{f_{2}},k_{b_{2}})
  </annotation>
 </semantics>
</math>

 on another pair of plaintext/ciphertext to verify the correctness of the key.</p>
<h3 id="d-mitm-complexity">2D-MITM complexity</h3>

<p>Time complexity of this attack without brute force, is 

<math display="inline" id="Meet-in-the-middle_attack:100">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>f</mi>
       <mn>1</mn>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>k</mi>
      <msub>
       <mi>b</mi>
       <mn>2</mn>
      </msub>
     </msub>
     <mo stretchy="false">|</mo>
    </mrow>
   </msup>
   <mo>+</mo>
   <mrow>
    <msup>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">|</mo>
      <mi>s</mi>
      <mo stretchy="false">|</mo>
     </mrow>
    </msup>
    <mo>⋅</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">|</mo>
        <msub>
         <mi>k</mi>
         <msub>
          <mi>b</mi>
          <mn>1</mn>
         </msub>
        </msub>
        <mo stretchy="false">|</mo>
       </mrow>
      </msup>
      <mo>+</mo>
      <msup>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">|</mo>
        <msub>
         <mi>k</mi>
         <msub>
          <mi>f</mi>
          <mn>2</mn>
         </msub>
        </msub>
        <mo stretchy="false">|</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <abs></abs>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <abs></abs>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>b</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>f</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{|k_{f_{1}}|}+2^{|k_{b_{2}}|}+2^{|s|}\cdot\left(2^{|k_{b_{1}}|}+2^{|k_{f_{2}%
}|}\right)
  </annotation>
 </semantics>
</math>

 where |⋅| denotes the length.</p>

<p>Main memory consumption is restricted by the construction of the sets <em>A</em> and <em>B</em> where <em>T</em> is much smaller than the others.</p>

<p>For data complexity see subsection on complexity for MD-MITM.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Space–time_tradeoff" title="wikilink">Space–time tradeoff</a></li>
<li><a href="Birthday_attack" title="wikilink">Birthday attack</a></li>
<li><a href="Triple_DES" title="wikilink">Triple DES</a></li>
<li><a href="Data_Encryption_Standard" title="wikilink">Data Encryption Standard</a></li>
<li><a href="GOST_(block_cipher)" title="wikilink">GOST</a></li>
<li><a href="Brute-force_attack" title="wikilink">Brute-force attack</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"> <a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
</ol>
</section>
</body>
</html>

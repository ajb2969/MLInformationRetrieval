   Euler–Maclaurin formula      Euler–Maclaurin formula   In mathematics , the Euler–Maclaurin formula provides a powerful connection between integrals (see calculus ) and sums. It can be used to approximate integrals by finite sums, or conversely to evaluate finite sums and infinite series using integrals and the machinery of calculus. For example, many asymptotic expansions are derived from the formula, and Faulhaber's formula for the sum of powers is an immediate consequence.  The formula was discovered independently by Leonhard Euler and Colin Maclaurin around 1735 (and later generalized as Darboux's formula ). Euler needed it to compute slowly converging infinite series while Maclaurin used it to calculate integrals.  The formula  If   m   m   m   and   n   n   n   are natural numbers and    f   (  x  )       f  x    f(x)   is a complex or real valued continuous function for real numbers    x   x   x   in the interval    [  m  ,  n  ]     m  n    [m,n]   , then the integral      I  =    ∫  m  n    f   (  x  )   d  x        I    superscript   subscript   m   n     f  x  d  x      I=\int_{m}^{n}f(x)\,dx     can be approximated by the sum (or vice versa)      S  =    f   (   m  +  1   )    +  ⋯  +   f   (   n  -  1   )    +   f   (  n  )         S      f    m  1    normal-⋯    f    n  1      f  n      S=f\left(m+1\right)+\cdots+f\left(n-1\right)+f(n)     (see trapezoidal rule ). The Euler–Maclaurin formula provides expressions for the difference between the sum and the integral in terms of the higher derivatives evaluated at the end points of the interval, that is to say when    x  =  m      x  m    x=m   and   n   n   n   .  Explicitly, for a natural number   p   p   p   and a function    f   (  x  )       f  x    f(x)   that is   p   p   p   times continuously differentiable in the interval    [  m  ,  n  ]     m  n    [m,n]   , we have       S  -  I   =     ∑   k  =  1   p      B  k    k  !     (     f   (   k  -  1   )     (  n  )    -    f   (   k  -  1   )     (  m  )     )     +  R         S  I       superscript   subscript     k  1    p        subscript  B  k     k         superscript  f    k  1    n      superscript  f    k  1    m      R     S-I=\sum_{k=1}^{p}{\frac{B_{k}}{k!}\left(f^{(k-1)}(n)-f^{(k-1)}(m)\right)}+R     where is the   k   k   k   th Bernoulli number , with 1}} , +1/2}} , 1/6}} , 0}} , −1/30}} , 0}} , 1/42}} , 0}} , −1/30}} ..., and   R   R   R   is an error term which is normally small for suitable values of   p   p   p   and depends on    n  ,  m  ,  p     n  m  p    n,m,p   and   f   f   f   .  The formula is often written with the subscript taking only even values, since the odd Bernoulli numbers are zero except for B 1 , in which case we have         ∑   i  =   m  +  1    n    f   (  i  )     =     ∫  m  n    f   (  x  )   d  x    +    B  1    (    f   (  n  )    -   f   (  m  )     )    +    ∑   k  =  1   p      B   2  k      (   2  k   )   !     (     f   (    2  k   -  1   )     (  n  )    -    f   (    2  k   -  1   )     (  m  )     )     +  R    .        superscript   subscript     i    m  1     n     f  i        subscript   superscript   n   m     f  x  d  x       subscript  B  1       f  n     f  m       superscript   subscript     k  1    p        subscript  B    2  k        2  k          superscript  f      2  k   1    n      superscript  f      2  k   1    m      R     \sum_{i=m+1}^{n}f(i)=\int^{n}_{m}f(x)\,dx+B_{1}\left(f(n)-f(m)\right)+\sum_{k=%
 1}^{p}\frac{B_{2k}}{(2k)!}\left(f^{(2k-1)}(n)-f^{(2k-1)}(m)\right)+R.     The Bernoulli polynomials and periodic function  The formula is derived below using repeated integration by parts applied to successive intervals    [  r  ,   r  +  1   ]     r    r  1     [r,r+1]   for integers    r  =   m  ,   m  +  1   ,  ⋯  ,   n  -  1        r   m    m  1   normal-⋯    n  1      r=m,m+1,\cdots,n-1   . The derivation uses the periodic Bernoulli functions,     P  k    (  x  )        subscript  P  k   x    P_{k}(x)   which are defined in terms of the Bernoulli polynomials      B  k    (  x  )        subscript  B  k   x    B_{k}(x)   for    k  =   0  ,  1  ,   2  ⋯        k   0  1    2  normal-⋯      k=0,1,2\cdots   .  the Bernoulli polynomials may be defined recursively by       B  0    (  x  )        subscript  B  0   x    \displaystyle B_{0}(x)     and the periodic Bernoulli functions are defined as        P  n    (  x  )    =    B  n    (   x  -   ⌊  x  ⌋    )           subscript  P  n   x      subscript  B  n     x    x       P_{n}(x)=B_{n}\left(x-\lfloor x\rfloor\right)     where    ⌊  x  ⌋      normal-⌊  x  normal-⌋    ⌊x⌋   denotes the largest integer that is not greater than   x   x   x   so that    x  -   ⌊  x  ⌋       x    normal-⌊  x  normal-⌋     x-⌊x⌋   always lies in the interval    0  ,  1     0  1    0,1   .  It can be shown that      B  k    (  1  )    =    B  k    (  0  )           subscript  B  k   1      subscript  B  k   0     B_{k}(1)=B_{k}(0)   for all    k  ≠  1      k  1    k\neq 1   so that except for     P  1    (  x  )        subscript  P  1   x    P_{1}(x)   , all the periodic Bernoulli functions are continuous. The functions     P  k    (  x  )        subscript  P  k   x    P_{k}(x)   are sometimes written as      B  ~   k    (  x  )        subscript   normal-~  B   k   x    \tilde{B}_{k}(x)   .  The remainder term  The remainder term   R   R   R   can be written as      R  =    ∫  m  n     f   (   2  p   )     (  x  )       P   2  p     (  x  )      (   2  p   )   !     d  x        R    superscript   subscript   m   n      superscript  f    2  p    x       subscript  P    2  p    x       2  p     d  x      R=\int_{m}^{n}f^{(2p)}(x){P_{2p}(x)\over(2p)!}\,dx     or equivalently, integrating by parts, assuming ƒ (2 p ) is differentiable again and recalling that all odd Bernoulli numbers (but the first one) are zero:       R  =   -    ∫  m  n     f   (    2  p   +  1   )     (  x  )       P   (    2  p   +  1   )     (  x  )      (    2  p   +  1   )   !     d  x       p  >  0      formulae-sequence    R      superscript   subscript   m   n      superscript  f      2  p   1    x       subscript  P      2  p   1    x         2  p   1     d  x        p  0     R=-\int_{m}^{n}f^{(2p+1)}(x){P_{(2p+1)}(x)\over(2p+1)!}\,dx\quad p>0     When n > 0, it can be shown that       |    B  n    (  x  )    |   ≤     2  ⋅   n  !      (   2  π   )   n    ζ   (  n  )             subscript  B  n   x         normal-⋅  2    n     superscript    2  π   n    ζ  n     \left|B_{n}\left(x\right)\right|\leq\frac{2\cdot n!}{\left(2\pi\right)^{n}}%
 \zeta\left(n\right)     where   ζ   ζ   ζ   denotes the Riemann zeta function ; one approach to prove this inequality is to obtain the Fourier series for the polynomials . The bound is achieved for even   n   n   n   when   x   x   x   is zero. The term    ζ   (  n  )       ζ  n    ζ(n)   may be omitted for odd   n   n   n   but the proof in this case is more complex (see Lehmer: 1 )  Using this inequality, the size of the remainder term can be estimated using       |  R  |   ≤     2  ζ   (   2  p   )      (   2  π   )    2  p       ∫  m  n     |    f   (   2  p   )     (  x  )    |   d  x           R         2  ζ    2  p     superscript    2  π     2  p       superscript   subscript   m   n          superscript  f    2  p    x    d  x       \left|R\right|\leq\frac{2\zeta(2p)}{(2\pi)^{2p}}\int_{m}^{n}\left|f^{(2p)}(x)%
 \right|\ \,dx     Applicable formula  We can use the formula as a means of approximating a finite integral, with the following simple formula: 2      I  =    ∫   x  0    x  N     f   (  x  )   d  x    =      h   (     f  0   2   +   f  1   +    f  2   …   +   f   N  -  1    +    f  N   2    )    +     h  2   12    [    f  0  ′   -   f  N  ′    ]     -     h  4   720    [    f  0  ′′′   -   f  N  ′′′    ]     +  …         I    superscript   subscript    subscript  x  0     subscript  x  N      f  x  d  x                 h       subscript  f  0   2    subscript  f  1      subscript  f  2   normal-…    subscript  f    N  1       subscript  f  N   2          superscript  h  2   12    delimited-[]     subscript   superscript  f  normal-′   0    subscript   superscript  f  normal-′   N            superscript  h  4   720    delimited-[]     subscript   superscript  f  ′′′   0    subscript   superscript  f  ′′′   N       normal-…      I=\int_{x_{0}}^{x_{N}}f(x)\,dx=h\left(\frac{f_{0}}{2}+f_{1}+f_{2}...+f_{N-1}+%
 \frac{f_{N}}{2}\right)+\frac{h^{2}}{12}[f^{\prime}_{0}-f^{\prime}_{N}]-\frac{h%
 ^{4}}{720}[f^{\prime\prime\prime}_{0}-f^{\prime\prime\prime}_{N}]+...   .  Where   N   N   N   is the number of points in the interval of integration from    x  0     subscript  x  0    x_{0}   to    x  N     subscript  x  N    x_{N}   and   h   h   h   is the distance between points so that    h  =    (    x  N   -   x  0    )   /  N       h       subscript  x  N    subscript  x  0    N     h=(x_{N}-x_{0})/N   . Note the series above is usually not convergent; indeed, often the terms will increase rapidly after a number of iterations. Thus, attention generally needs to be paid to the remainder term.  This may be viewed as an extension of the trapezoid rule by the inclusion of correction terms. 3  Applications  The Basel problem  The Basel problem asks to determine the sum       1  +   1  4   +   1  9   +   1  16   +   1  25   +  ⋯   =    ∑   n  =  1   ∞    1   n  2           1    1  4     1  9     1  16     1  25   normal-⋯     superscript   subscript     n  1        1   superscript  n  2       1+\frac{1}{4}+\frac{1}{9}+\frac{1}{16}+\frac{1}{25}+\cdots=\sum_{n=1}^{\infty}%
 \frac{1}{n^{2}}     Euler computed this sum to 20 decimal places with only a few terms of the Euler–Maclaurin formula in 1735. This probably convinced him that the sum equals π 2 / 6, which he proved in the same year. 4  Parseval's identity for the Fourier series of f ( x ) = x gives the same result.  Sums involving a polynomial  If f is a polynomial and p is big enough, then the remainder term vanishes. For instance, if f ( x ) = x 3 , we can choose p = 2 to obtain after simplification        ∑   i  =  0   n    i  3    =    (    n   (   n  +  1   )    2   )   2         superscript   subscript     i  0    n    superscript  i  3     superscript      n    n  1    2   2     \sum_{i=0}^{n}i^{3}=\left(\frac{n(n+1)}{2}\right)^{2}     (see Faulhaber's formula ).  Numerical integration  The Euler–Maclaurin formula is also used for detailed error analysis in numerical quadrature . It explains the superior performance of the trapezoidal rule on smooth periodic functions and is used in certain extrapolation methods . Clenshaw–Curtis quadrature is essentially a change of variables to cast an arbitrary integral in terms of integrals of periodic functions where the Euler–Maclaurin approach is very accurate (in that particular case the Euler–Maclaurin formula takes the form of a discrete cosine transform ). This technique is known as a periodizing transformation.  Asymptotic expansion of sums  In the context of computing asymptotic expansions of sums and series , usually the most useful form of the Euler–Maclaurin formula is        ∑   n  =  a   b    f   (  n  )     ∼     ∫  a  b    f   (  x  )   d  x    +     f   (  b  )    +   f   (  a  )     2   +     ∑   k  =  1   ∞       B   2  k      (   2  k   )   !     (     f   (    2  k   -  1   )     (  b  )    -    f   (    2  k   -  1   )     (  a  )     )         similar-to    superscript   subscript     n  a    b     f  n        superscript   subscript   a   b     f  x  d  x          f  b     f  a    2     superscript   subscript     k  1           subscript  B    2  k        2  k          superscript  f      2  k   1    b      superscript  f      2  k   1    a         \sum_{n=a}^{b}f(n)\sim\int_{a}^{b}f(x)\,dx+\frac{f(b)+f(a)}{2}+\sum_{k=1}^{%
 \infty}\,\frac{B_{2k}}{(2k)!}\left(f^{(2k-1)}(b)-f^{(2k-1)}(a)\right)     where a and b are integers. 5 Often the expansion remains valid even after taking the limits    a  →   -  ∞      normal-→  a        {\scriptstyle a\to-\infty}   or    b  →   +  ∞      normal-→  b        {\scriptstyle b\to+\infty}   , or both. In many cases the integral on the right-hand side can be evaluated in closed form in terms of elementary functions even though the sum on the left-hand side cannot. Then all the terms in the asymptotic series can be expressed in terms of elementary functions. For example,        ∑   k  =  0   ∞    1    (   z  +  k   )   2     ∼       ∫  0  ∞      1    (   z  +  k   )   2     d  k    ⏟     =   1  z     +   1   2   z  2     +    ∑   t  =  1   ∞     B   2  t     z    2  t   +  1          similar-to    superscript   subscript     k  0        1   superscript    z  k   2        subscript   normal-⏟    superscript   subscript   0         1   superscript    z  k   2    d  k       absent    1  z       1    2   superscript  z  2       superscript   subscript     t  1         subscript  B    2  t     superscript  z      2  t   1         \sum_{k=0}^{\infty}\frac{1}{(z+k)^{2}}\sim\underbrace{\int_{0}^{\infty}\frac{1%
 }{(z+k)^{2}}\,dk}_{=\frac{1}{z}}+\frac{1}{2z^{2}}+\sum_{t=1}^{\infty}\frac{B_{%
 2t}}{z^{2t+1}}     Here the left-hand side is equal to     ψ   (  1  )     (  z  )        superscript  ψ  1   z    {\scriptstyle\psi^{(1)}(z)}   , namely the first-order polygamma function defined through      ψ   (  1  )     (  z  )    =      d  2    d   z  2       ln  Γ    (  z  )           superscript  ψ  1   z        superscript  d  2     d   superscript  z  2       normal-Γ   z     {\scriptstyle\psi^{(1)}(z)=\frac{d^{2}}{dz^{2}}\ln\Gamma(z)}   ; the gamma function     Γ   (  z  )       normal-Γ  z    {\scriptstyle\Gamma(z)}   is equal to     (   z  -  1   )   !        z  1     {\scriptstyle(z-1)!}   if   z   z   {\scriptstyle z}   is a positive integer . This results in an asymptotic expansion for     ψ   (  1  )     (  z  )        superscript  ψ  1   z    {\scriptstyle\psi^{(1)}(z)}   . That expansion, in turn, serves as the starting point for one of the derivations of precise error estimates for Stirling's approximation of the factorial function.  Examples          ∑   k  =  1   n    1   k  s     =     1   n   s  -  1     +   s    ∫  1  n      ⌊  x  ⌋    x   s  +  1     d  x      with     s  ∈    \R   ∖   {  1  }        formulae-sequence      superscript   subscript     k  1    n     1   superscript  k  s          1   superscript  n    s  1       s    superscript   subscript   1   n         x    superscript  x    s  1     d  x      with      s    \R   1       \sum_{k=1}^{n}\frac{1}{k^{s}}=\frac{1}{n^{s-1}}+s\int_{1}^{n}\frac{\lfloor x%
 \rfloor}{x^{s+1}}dx\qquad\text{with }\quad s\in\R\setminus\{1\}             ∑   k  =  1   n    1  k    =     log  n   +   1  2   +   1   2  n     -    ∫  1  n      x  -   ⌊  x  ⌋     x  2    d  x           superscript   subscript     k  1    n     1  k          n     1  2     1    2  n       superscript   subscript   1   n         x    x     superscript  x  2    d  x       \sum_{k=1}^{n}\frac{1}{k}=\log n+\frac{1}{2}+\frac{1}{2n}-\int_{1}^{n}\frac{x-%
 \lfloor x\rfloor}{x^{2}}dx      Proofs  Derivation by mathematical induction  We follow the argument given in Apostol. 6  The Bernoulli polynomials  and the periodic Bernoulli functions for    n  =   0  ,  1  ,  2  ,  …       n   0  1  2  normal-…     n=0,1,2,...   were introduced above.  The first several Bernoulli polynomials are       B  1    (  x  )        subscript  B  1   x    \displaystyle B_{1}(x)     The values are the Bernoulli numbers . Notice that for    n  ≠   1      n  normal-≠  normal-  1    n≠ 1   we have         B  n    (  0  )    =    B  n    (  1  )    =   B  n     (   n  th Bernoulli number   )      formulae-sequence         subscript  B  n   0      subscript  B  n   1         subscript  B  n       n  th Bernoulli number     B_{n}(0)=B_{n}(1)=B_{n}\quad(n\text{th Bernoulli number})     For    n  =  1      n  1    n=1   ,        B  1    (  0  )    =   -    B  1    (  1  )     =   B  1            subscript  B  1   0        subscript  B  1   1          subscript  B  1      B_{1}(0)=-B_{1}(1)=B_{1}     The functions agree with the Bernoulli polynomials on the interval    0  ,    1      0    normal-  1     0, 1   and are periodic with period 1. Furthermore, except when    n  =  1      n  1    n=1   , they are also continuous. Thus,         P  n    (  0  )    =    P  n    (  1  )    =   B  n    ,   n  ≠  1      formulae-sequence         subscript  P  n   0      subscript  P  n   1         subscript  B  n       n  1     P_{n}(0)=P_{n}(1)=B_{n},n\neq 1     Let   k   k   k   be an integer, and consider the integral        ∫  k   k  +  1     f   (  x  )   d  x    =    ∫  k   k  +  1      u   d  v          superscript   subscript   k     k  1      f  x  d  x      superscript   subscript   k     k  1      u  d  v      \int_{k}^{k+1}f(x)\,dx=\int_{k}^{k+1}u\,dv     where     u   u   \displaystyle u     Integrating by parts , we get        ∫  k   k  +  1      f   (  x  )   d  x       superscript   subscript   k     k  1      f  x  d  x     \displaystyle\int_{k}^{k+1}f(x)\,dx     Summing the above from k = 0 to k = n − 1, we get         ∫  0  1     f   (  x  )   d  x    +  ⋯  +     ∫   n  -  1   n     f   (  x  )   d  x          superscript   subscript   0   1     f  x  d  x    normal-⋯    superscript   subscript     n  1    n     f  x  d  x      \displaystyle\int_{0}^{1}f(x)\,dx+\cdots+\int_{n-1}^{n}f(x)\,dx     Adding ( f ( n ) - f (0))/2 to both sides and rearranging, we have        ∑   k  =  1   n    f   (  k  )     =      ∫  0  n    f   (  x  )   d  x    +     f   (  n  )    -   f   (  0  )     2   +    ∫  0  n     f  ′    (  x  )    P  1    (  x  )   d  x      (  1  )          superscript   subscript     k  1    n     f  k         superscript   subscript   0   n     f  x  d  x          f  n     f  0    2     superscript   subscript   0   n      superscript  f  normal-′   x   subscript  P  1   x  d  x     1     \sum_{k=1}^{n}f(k)=\int_{0}^{n}f(x)\,dx+{f(n)-f(0)\over 2}+\int_{0}^{n}f^{%
 \prime}(x)P_{1}(x)\,dx\qquad(1)     The last two terms therefore give the error when the integral is taken to approximate the sum.  Next, consider        ∫  k   k  +  1      f  ′    (  x  )    P  1    (  x  )   d  x    =    ∫  k   k  +  1      u   d  v          superscript   subscript   k     k  1       superscript  f  normal-′   x   subscript  P  1   x  d  x      superscript   subscript   k     k  1      u  d  v      \int_{k}^{k+1}f^{\prime}(x)P_{1}(x)\,dx=\int_{k}^{k+1}u\,dv     where     u   u   \displaystyle u     Integrating by parts again, we get        [   u  v   ]   k   k  +  1    -     ∫  k   k  +  1       v   d  u         superscript   subscript   delimited-[]    u  v    k     k  1      superscript   subscript   k     k  1      v  d  u      \displaystyle\Big[uv\Big]_{k}^{k+1}-\int_{k}^{k+1}v\,du     Then summing from k = 0 to k = n − 1, and then replacing the last integral in (1) with what we have thus shown to be equal to it, we have         ∑   k  =  1   n    f   (  k  )     =      ∫  0  n    f   (  x  )   d  x    +     f   (  n  )    -   f   (  0  )     2   +     B  2   2    (     f  ′    (  n  )    -    f  ′    (  0  )     )     -    1  2     ∫  0  n     f  ′′    (  x  )    P  2    (  x  )   d  x       .        superscript   subscript     k  1    n     f  k          superscript   subscript   0   n     f  x  d  x          f  n     f  0    2        subscript  B  2   2        superscript  f  normal-′   n      superscript  f  normal-′   0          1  2     superscript   subscript   0   n      superscript  f  ′′   x   subscript  P  2   x  d  x        \sum_{k=1}^{n}f(k)=\int_{0}^{n}f(x)\,dx+{f(n)-f(0)\over 2}+\frac{B_{2}}{2}(f^{%
 \prime}(n)-f^{\prime}(0))-{1\over 2}\int_{0}^{n}f^{\prime\prime}(x)P_{2}(x)\,dx.     By now the reader will have guessed that this process can be iterated. In this way we get a proof of the Euler–Maclaurin summation formula which can be formalized by mathematical induction , in which the induction step relies on integration by parts and on the identities for periodic Bernoulli functions.  See also   Cesàro summation  Euler summation  Gauss–Kronrod quadrature formula  Darboux's formula   Notes  References    , pp. 16, 806, 886   Gourdon, Xavier; Sebah, Pascal Introduction on Bernoulli's numbers , (2002)    "  Category:Approximation theory  Category:Asymptotic analysis  Category:Hilbert space  Category:Numerical integration (quadrature)  Category:Articles containing proofs  Category:Theorems in analysis  Category:Summability methods     ↩  ↩   Pengelley, David J. "Dances between continuous and discrete: Euler's summation formula" , in: Robert Bradley and Ed Sandifer (Eds), Proceedings, Euler 2K+2 Conference (Rumford, Maine, 2002) , Euler Society , 2003. ↩  , 23.1.30 ↩  ↩     
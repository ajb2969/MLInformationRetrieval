<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="333">Recurrence quantification analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Recurrence quantification analysis</h1>
<hr/>

<p><strong>Recurrence quantification analysis (RQA)</strong> is a method of <a class="uri" href="nonlinear" title="wikilink">nonlinear</a> <a href="data_analysis" title="wikilink">data analysis</a> (cf. <a href="chaos_theory" title="wikilink">chaos theory</a>) for the investigation of <a href="dynamical_systems" title="wikilink">dynamical systems</a>. It quantifies the number and duration of recurrences of a dynamical system presented by its <a href="phase_space" title="wikilink">phase space</a> trajectory.</p>
<h2 id="background">Background</h2>

<p>The recurrence quantification analysis was developed in order to quantify differently appearing <a href="recurrence_plot" title="wikilink">recurrence plots</a> (RPs) based on the small-scale structures therein. <a href="Recurrence_plot" title="wikilink">Recurrence plots</a> are tools which visualise the recurrence behaviour of the <a href="phase_space" title="wikilink">phase space</a> trajectory of <a href="dynamical_systems" title="wikilink">dynamical systems</a>. They mostly contain single dots and lines which are parallel to the mean diagonal (<em>line of identity</em>, LOI) or which are vertical/horizontal. Lines parallel to the LOI are referred to as <em>diagonal lines</em> and the vertical structures as <em>vertical lines</em>. Because an RP is usually symmetric, horizontal and vertical lines correspond to each other, and, hence, only vertical lines are considered. The lines correspond to a typical behaviour of the phase space trajectory: whereas the diagonal lines represent such segments of the phase space trajectory which run parallel for some time, the vertical lines represent segments which remain in the same <a href="phase_space" title="wikilink">phase space</a> region for some time.</p>

<p>If only a <a href="time_series" title="wikilink">time series</a> is available, the phase space can be reconstructed by using a time delay embedding (see <a href="Takens'_theorem" title="wikilink">Takens' theorem</a>):</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:0">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">‚Üí</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>u</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mi>u</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>+</mo>
     <mi>œÑ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>+</mo>
     <mi>œÑ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>m</mi>
      <mo>-</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>,</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <ci>normal-‚Üí</ci>
     <ci>x</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">i</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">u</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">i</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-,</ci>
     <csymbol cd="unknown">u</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">i</csymbol>
      <plus></plus>
      <csymbol cd="unknown">œÑ</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-,</ci>
     <ci>normal-‚Ä¶</ci>
     <ci>normal-,</ci>
     <csymbol cd="unknown">u</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">i</csymbol>
      <plus></plus>
      <csymbol cd="unknown">œÑ</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">m</csymbol>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-,</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{x}(i)=(u(i),u(i+\tau),\ldots,u(i+\tau(m-1)),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Recurrence_quantification_analysis:1">
 <semantics>
  <mrow>
   <mi>u</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>u</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u(i)
  </annotation>
 </semantics>
</math>

 is the time series, 

<math display="inline" id="Recurrence_quantification_analysis:2">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 the embedding dimension and 

<math display="inline" id="Recurrence_quantification_analysis:3">
 <semantics>
  <mi>œÑ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>œÑ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 the time delay.</p>

<p>The RQA quantifies the small-scale structures of recurrence plots, which present the number and duration of the recurrences of a dynamical system. The measures introduced for the RQA were developed heuristically between 1992 and 2002 (Zbilut &amp; Webber 1992; Webber &amp; Zbilut 1994; Marwan et al. 2002). They are actually <a href="measure_of_complexity" title="wikilink">measures of complexity</a>. The main advantage of the recurrence quantification analysis is that it can provide useful information even for short and non-stationary data, where other methods fail.</p>

<p>RQA can be applied to almost every kind of data. It is widely used in <a class="uri" href="physiology" title="wikilink">physiology</a>, but was also successfully applied on problems from <a class="uri" href="engineering" title="wikilink">engineering</a>, <a class="uri" href="chemistry" title="wikilink">chemistry</a>, <a href="Earth_sciences" title="wikilink">Earth sciences</a> etc.</p>
<h2 id="rqa-measures">RQA measures</h2>

<p>The simplest measure is the <strong>recurrence rate</strong>, which is the density of recurrence points in a recurrence plot:</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:4">
 <semantics>
  <mrow>
   <mrow>
    <mtext>RR</mtext>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <msup>
       <mi>N</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mi>j</mi>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mi>ùêë</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>RR</mtext>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <list>
          <ci>i</ci>
          <ci>j</ci>
         </list>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>ùêë</ci>
       <interval closure="open">
        <ci>i</ci>
        <ci>j</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{RR}=\frac{1}{N^{2}}\sum_{i,j=1}^{N}\mathbf{R}(i,j).
  </annotation>
 </semantics>
</math>

</p>

<p>The recurrence rate corresponds with the probability that a specific state will recur. It is almost equal with the definition of the <a href="correlation_sum" title="wikilink">correlation sum</a>, where the LOI is excluded from the computation.</p>

<p>The next measure is the percentage of recurrence points which form diagonal lines in the recurrence plot of minimal length 

<math display="inline" id="Recurrence_quantification_analysis:5">
 <semantics>
  <msub>
   <mi mathvariant="normal">‚Ñì</mi>
   <mi>min</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-‚Ñì</ci>
    <min></min>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell_{\min}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:6">
 <semantics>
  <mrow>
   <mrow>
    <mtext>DET</mtext>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mi mathvariant="normal">‚Ñì</mi>
        <mo>=</mo>
        <msub>
         <mi mathvariant="normal">‚Ñì</mi>
         <mi>min</mi>
        </msub>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <mrow>
       <mpadded width="+1.7pt">
        <mi mathvariant="normal">‚Ñì</mi>
       </mpadded>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">‚Ñì</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mi>j</mi>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <mrow>
       <mi>R</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>DET</mtext>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>normal-‚Ñì</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-‚Ñì</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-‚Ñì</ci>
       <ci>P</ci>
       <ci>normal-‚Ñì</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <list>
          <ci>i</ci>
          <ci>j</ci>
         </list>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>R</ci>
       <interval closure="open">
        <ci>i</ci>
        <ci>j</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{DET}=\frac{\sum_{\ell=\ell_{\min}}^{N}\ell\,P(\ell)}{\sum_{i,j=1}^{N}R(i%
,j)},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Recurrence_quantification_analysis:7">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">‚Ñì</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>normal-‚Ñì</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\ell)
  </annotation>
 </semantics>
</math>

 is the <a href="frequency_distribution" title="wikilink">frequency distribution</a> of the lengths 

<math display="inline" id="Recurrence_quantification_analysis:8">
 <semantics>
  <mi mathvariant="normal">‚Ñì</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-‚Ñì</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell
  </annotation>
 </semantics>
</math>

 of the diagonal lines. This measure is called <strong>determinism</strong> and is related with the <a class="uri" href="predictability" title="wikilink">predictability</a> of the <a href="dynamical_system" title="wikilink">dynamical system</a>, because <a href="white_noise" title="wikilink">white noise</a> has a recurrence plot with almost only single dots and very few diagonal lines, whereas a <a href="deterministic_process" title="wikilink">deterministic process</a> has a recurrence plot with very few single dots but many long diagonal lines.</p>

<p>The amount of recurrence points which form vertical lines can be quantified in the same way:</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:9">
 <semantics>
  <mrow>
   <mrow>
    <mtext>LAM</mtext>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mi>v</mi>
        <mo>=</mo>
        <msub>
         <mi>v</mi>
         <mi>min</mi>
        </msub>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <mrow>
       <mi>v</mi>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>v</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mi>v</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <mrow>
       <mi>v</mi>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>v</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>LAM</mtext>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>v</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>P</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>v</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>P</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{LAM}=\frac{\sum_{v=v_{\min}}^{N}vP(v)}{\sum_{v=1}^{N}vP(v)},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Recurrence_quantification_analysis:10">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>v</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(v)
  </annotation>
 </semantics>
</math>

 is the frequency distribution of the lengths 

<math display="inline" id="Recurrence_quantification_analysis:11">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 of the vertical lines, which have at least a length of 

<math display="inline" id="Recurrence_quantification_analysis:12">
 <semantics>
  <msub>
   <mi>v</mi>
   <mi>min</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <min></min>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{\min}
  </annotation>
 </semantics>
</math>

. This measure is called <strong>laminarity</strong> and is related with the amount of <a href="laminar_phase" title="wikilink">laminar phases</a> in the system (<a class="uri" href="intermittency" title="wikilink">intermittency</a>).</p>

<p>The lengths of the diagonal and vertical lines can be measured as well. The <strong>averaged diagonal line length</strong></p>

<p>

<math display="block" id="Recurrence_quantification_analysis:13">
 <semantics>
  <mrow>
   <mtext>L</mtext>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mrow>
       <mi mathvariant="normal">‚Ñì</mi>
       <mo>=</mo>
       <msub>
        <mi mathvariant="normal">‚Ñì</mi>
        <mi>min</mi>
       </msub>
      </mrow>
      <mi>N</mi>
     </msubsup>
     <mrow>
      <mpadded width="+1.7pt">
       <mi mathvariant="normal">‚Ñì</mi>
      </mpadded>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">‚Ñì</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mrow>
       <mi mathvariant="normal">‚Ñì</mi>
       <mo>=</mo>
       <msub>
        <mi mathvariant="normal">‚Ñì</mi>
        <mi>min</mi>
       </msub>
      </mrow>
      <mi>N</mi>
     </msubsup>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">‚Ñì</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>L</mtext>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>normal-‚Ñì</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-‚Ñì</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-‚Ñì</ci>
       <ci>P</ci>
       <ci>normal-‚Ñì</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>normal-‚Ñì</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-‚Ñì</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>normal-‚Ñì</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{L}=\frac{\sum_{\ell=\ell_{\min}}^{N}\ell\,P(\ell)}{\sum_{\ell=\ell_{\min%
}}^{N}P(\ell)}
  </annotation>
 </semantics>
</math>

</p>

<p>is related with the <em>predictability time</em> of the dynamical system and the <strong>trapping time</strong>, measuring the average length of the vertical lines,</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>T</mi>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mrow>
       <mi>v</mi>
       <mo>=</mo>
       <msub>
        <mi>v</mi>
        <mi>min</mi>
       </msub>
      </mrow>
      <mi>N</mi>
     </msubsup>
     <mrow>
      <mi>v</mi>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mrow>
       <mi>v</mi>
       <mo>=</mo>
       <msub>
        <mi>v</mi>
        <mi>min</mi>
       </msub>
      </mrow>
      <mi>N</mi>
     </msubsup>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>T</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>v</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>P</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>v</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TT=\frac{\sum_{v=v_{\min}}^{N}vP(v)}{\sum_{v=v_{\min}}^{N}P(v)}
  </annotation>
 </semantics>
</math>

</p>

<p>is related with the <em>laminarity time</em> of the dynamical system, i.e. how long the system remains in a specific state.</p>

<p>Because the length of the diagonal lines is related on the time how long segments of the <a href="phase_space" title="wikilink">phase space</a> trajectory run parallel, i.e. on the <a class="uri" href="divergence" title="wikilink">divergence</a> behaviour of the trajectories, it was sometimes stated that the <a href="Multiplicative_inverse" title="wikilink">reciprocal</a> of the maximal length of the diagonal lines (without LOI) would be an estimator for the positive maximal <a href="Lyapunov_exponent" title="wikilink">Lyapunov exponent</a> of the dynamical system. Therefore, the <strong>maximal diagonal line length</strong> 

<math display="inline" id="Recurrence_quantification_analysis:15">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>max</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <max></max>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{\max}
  </annotation>
 </semantics>
</math>

 or the <strong>divergence</strong></p>

<p>

<math display="block" id="Recurrence_quantification_analysis:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mi>I</mi>
    <mi>V</mi>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <msub>
     <mi>L</mi>
     <mi>max</mi>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>I</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <max></max>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   DIV=\frac{1}{L_{\max}}
  </annotation>
 </semantics>
</math>

</p>

<p>are also measures of the RQA. However, the relationship between these measures with the positive maximal Lyapunov exponent is not as easy as stated, but even more complex (to calculate the Lyapunov exponent from an RP, the whole frequency distribution of the diagonal lines has to be considered). The divergence can have the trend of the positive maximal Lyapunov exponent, but not more. Moreover, also RPs of white noise processes can have a really long diagonal line, although very seldom, just by a finite probability. It is obvious that therefore the divergence cannot reflect the maximal Lyapunov exponent.</p>

<p>The <a class="uri" href="probability" title="wikilink">probability</a> 

<math display="inline" id="Recurrence_quantification_analysis:17">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">‚Ñì</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>normal-‚Ñì</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\ell)
  </annotation>
 </semantics>
</math>

 that a diagonal line has exactly length 

<math display="inline" id="Recurrence_quantification_analysis:18">
 <semantics>
  <mi mathvariant="normal">‚Ñì</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-‚Ñì</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell
  </annotation>
 </semantics>
</math>

 can be estimated from the frequency distribution 

<math display="inline" id="Recurrence_quantification_analysis:19">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">‚Ñì</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>normal-‚Ñì</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\ell)
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Recurrence_quantification_analysis:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi mathvariant="normal">‚Ñì</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">‚Ñì</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mstyle displaystyle="false">
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mi mathvariant="normal">‚Ñì</mi>
        <mo>=</mo>
        <msub>
         <mi>l</mi>
         <mi>min</mi>
        </msub>
       </mrow>
       <mi>N</mi>
      </msubsup>
     </mstyle>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi mathvariant="normal">‚Ñì</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>normal-‚Ñì</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>normal-‚Ñì</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>normal-‚Ñì</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>l</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>normal-‚Ñì</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\ell)=\frac{P(\ell)}{\sum_{\ell=l_{\min}}^{N}P(\ell)}
  </annotation>
 </semantics>
</math>

. The <a href="Shannon_entropy" title="wikilink">Shannon entropy</a> of this probability,</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:21">
 <semantics>
  <mrow>
   <mrow>
    <mtext>ENTR</mtext>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mi mathvariant="normal">‚Ñì</mi>
        <mo>=</mo>
        <msub>
         <mi mathvariant="normal">‚Ñì</mi>
         <mi>min</mi>
        </msub>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">‚Ñì</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>ln</mi>
        <mi>p</mi>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">‚Ñì</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>ENTR</mtext>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>normal-‚Ñì</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-‚Ñì</ci>
          <min></min>
         </apply>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>normal-‚Ñì</ci>
       <apply>
        <ln></ln>
        <ci>p</ci>
       </apply>
       <ci>normal-‚Ñì</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{ENTR}=-\sum_{\ell=\ell_{\min}}^{N}p(\ell)\ln p(\ell),
  </annotation>
 </semantics>
</math>

</p>

<p>reflects the complexity of the deterministic structure in the system. However, this entropy depends sensitively on the bin number and, thus, may differ for different realisations of the same process, as well as for different data preparations.</p>

<p>The last measure of the RQA quantifies the thinning-out of the recurrence plot. The <strong>trend</strong> is the regression coefficient of a linear relationship between the density of recurrence points in a line parallel to the LOI and its distance to the LOI. More exactly, let us consider the recurrence rate in a diagonal line parallel to LOI of distance <em>k</em> (<em>diagonal-wise recurrence rate</em>):</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:22">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mtext>RR</mtext>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mrow>
        <mrow>
         <mi>j</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
        <mo>=</mo>
        <mi>k</mi>
       </mrow>
       <mrow>
        <mi>N</mi>
        <mo>-</mo>
        <mi>k</mi>
       </mrow>
      </munderover>
      <mrow>
       <mi>ùêë</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <mtext>RR</mtext>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <ci>N</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <apply>
          <minus></minus>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>ùêë</ci>
       <interval closure="open">
        <ci>i</ci>
        <ci>j</ci>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{RR}_{k}=\frac{1}{N-k}\sum_{j-i=k}^{N-k}\mathbf{R}(i,j),
  </annotation>
 </semantics>
</math>

</p>

<p>then the trend is defined by</p>

<p>

<math display="block" id="Recurrence_quantification_analysis:23">
 <semantics>
  <mrow>
   <mrow>
    <mtext>TREND</mtext>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mover accent="true">
        <mi>N</mi>
        <mo stretchy="false">~</mo>
       </mover>
      </msubsup>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mrow>
          <mover accent="true">
           <mi>N</mi>
           <mo stretchy="false">~</mo>
          </mover>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>R</mi>
          <msub>
           <mi>R</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mo stretchy="false">‚ü®</mo>
          <mrow>
           <mi>R</mi>
           <msub>
            <mi>R</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo stretchy="false">‚ü©</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mover accent="true">
        <mi>N</mi>
        <mo stretchy="false">~</mo>
       </mover>
      </msubsup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mrow>
          <mover accent="true">
           <mi>N</mi>
           <mo stretchy="false">~</mo>
          </mover>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>TREND</mtext>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <apply>
         <divide></divide>
         <apply>
          <ci>normal-~</ci>
          <ci>N</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>R</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-‚ü®‚ü©</csymbol>
         <apply>
          <times></times>
          <ci>R</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>R</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <apply>
         <divide></divide>
         <apply>
          <ci>normal-~</ci>
          <ci>N</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{TREND}=\frac{\sum_{i=1}^{\tilde{N}}(i-\tilde{N}/2)(RR_{i}-\langle RR_{i}%
\rangle)}{\sum_{i=1}^{\tilde{N}}(i-\tilde{N}/2)^{2}},
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Recurrence_quantification_analysis:24">
 <semantics>
  <mrow>
   <mo stretchy="false">‚ü®</mo>
   <mo>‚ãÖ</mo>
   <mo stretchy="false">‚ü©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-‚ü®‚ü©</csymbol>
    <ci>normal-‚ãÖ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\cdot\rangle
  </annotation>
 </semantics>
</math>

 as the average value and 

<math display="inline" id="Recurrence_quantification_analysis:25">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>N</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo><</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <ci>normal-~</ci>
     <ci>N</ci>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{N}<N
  </annotation>
 </semantics>
</math>

. This latter relation should ensure to avoid the edge effects of too low recurrence point densities in the edges of the recurrence plot. The measure <em>trend</em> provides information about the stationarity of the system.</p>

<p>Similar to the diagonal-wise defined recurrence rate, the other measures based on the diagonal lines (DET, L, ENTR) can be defined diagonal-wise. These definitions are useful to study interrelations or <a class="uri" href="synchronisation" title="wikilink">synchronisation</a> between different systems (using <a href="recurrence_plot" title="wikilink">recurrence plots</a> or <a href="recurrence_plot#Extensions" title="wikilink">cross recurrence plots</a>).</p>
<h2 id="time-dependent-rqa">Time-dependent RQA</h2>

<p>Instead of computing the RQA measures of the entire recurrence plot, they can be computed in small windows moving over the recurrence plot along the LOI. This provides time-dependent RQA measures which allow detecting, e.g., chaos-chaos transitions (Marwan et al. 2002). <strong>Note:</strong> the choice of the size of the window can strongly influence the measure <em>trend</em>.</p>
<h2 id="example">Example</h2>
<figure><b>(Figure)</b>
<figcaption>Bifurcation diagram for the Logistic map.</figcaption>
</figure>

<p> </p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Recurrence_plot" title="wikilink">Recurrence plot</a>, a powerful visualisation tool of recurrences in dynamical (and other) systems.</li>
<li><a href="Approximate_entropy" title="wikilink">Approximate entropy</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a class="uri" href="http://www.recurrence-plot.tk/">http://www.recurrence-plot.tk/</a></li>
<li><a class="uri" href="http://www.scitopics.com/Recurrence_Quantification_Analysis.html">http://www.scitopics.com/Recurrence_Quantification_Analysis.html</a></li>
</ul>

<p>"</p>

<p><a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a> <a href="Category:Dynamical_systems" title="wikilink">Category:Dynamical systems</a> <a href="Category:Chaos_theory" title="wikilink">Category:Chaos theory</a> <a href="Category:Nonlinear_time_series_analysis" title="wikilink">Category:Nonlinear time series analysis</a></p>
</body>
</html>

   Discretization of Navier–Stokes equations      Discretization of Navier–Stokes equations   Discretization of the Navier–Stokes equations is a reformulation of the equations in such a way that they can be applied to computational fluid dynamics . Several methods of discretization can be applied.  Finite volume method  Incompressible flow  We begin with the incompressible form of the momentum equation. The equation has been divided through by the density ( P = p/ρ ) and density has been absorbed into the body force term.         ∂   u  i     ∂  t    +    ∂    u  i    u  j      ∂   x  j      =    -    ∂  P    ∂   x  i      +   ν     ∂  2    u  i      ∂   x  j     ∂   x  j       +   f  i               subscript  u  i      t           subscript  u  i    subscript  u  j        subscript  x  j              P      subscript  x  i        ν      superscript   2    subscript  u  i         subscript  x  j       subscript  x  j        subscript  f  i      \frac{\partial u_{i}}{\partial t}+\frac{\partial u_{i}u_{j}}{\partial x_{j}}=-%
 \frac{\partial P}{\partial x_{i}}+\nu\frac{\partial^{2}u_{i}}{\partial x_{j}%
 \partial x_{j}}+f_{i}     The equation is integrated over the control volume of a computational cell.        ∭  V     [     ∂   u  i     ∂  t    +    ∂    u  i    u  j      ∂   x  j      ]   d  V    =    ∭  V     [    -    ∂  P    ∂   x  i      +   ν     ∂  2    u  i      ∂   x  j     ∂   x  j       +   f  i    ]   d  V          subscript  triple-integral  V      delimited-[]         subscript  u  i      t           subscript  u  i    subscript  u  j        subscript  x  j       d  V      subscript  triple-integral  V      delimited-[]          P      subscript  x  i        ν      superscript   2    subscript  u  i         subscript  x  j       subscript  x  j        subscript  f  i     d  V      \iiint_{V}\left[\frac{\partial u_{i}}{\partial t}+\frac{\partial u_{i}u_{j}}{%
 \partial x_{j}}\right]dV=\iiint_{V}\left[-\frac{\partial P}{\partial x_{i}}+%
 \nu\frac{\partial^{2}u_{i}}{\partial x_{j}\partial x_{j}}+f_{i}\right]dV     The time-dependent term and the body force term are assumed constant over the volume of the cell. The divergence theorem is applied to the advection, pressure gradient, and diffusion terms.          ∂   u  i     ∂  t    V   +    ∬  A     u  i    u  j    n  j   d  A     =    -    ∬  A    P   n  i   d  A     +    ∬  A    ν    ∂   u  i     ∂   x  j      n  j   d  A    +    f  i   V                 subscript  u  i      t    V     subscript  double-integral  A      subscript  u  i    subscript  u  j    subscript  n  j   d  A           subscript  double-integral  A     P   subscript  n  i   d  A       subscript  double-integral  A     ν       subscript  u  i       subscript  x  j      subscript  n  j   d  A       subscript  f  i   V      \frac{\partial u_{i}}{\partial t}V+\iint_{A}u_{i}u_{j}n_{j}dA=-\iint_{A}Pn_{i}%
 dA+\iint_{A}\nu\frac{\partial u_{i}}{\partial x_{j}}n_{j}dA+f_{i}V     where n is the normal of the surface of the control volume and V is the volume. If the control volume is a polyhedron and values are assumed constant over each face, the area integrals can be written as summations over each face.          ∂   u  i     ∂  t    V   +    ∑   n  b  r      (    u  i    u  j    n  j   A   )    n  b  r      =    -    ∑   n  b  r      (   P   n  i   A   )    n  b  r      +    ∑   n  b  r      (   ν    ∂   u  i     ∂   x  j      n  j   A   )    n  b  r     +    f  i   V                 subscript  u  i      t    V     subscript     n  b  r     subscript     subscript  u  i    subscript  u  j    subscript  n  j   A     n  b  r            subscript     n  b  r     subscript    P   subscript  n  i   A     n  b  r        subscript     n  b  r     subscript    ν       subscript  u  i       subscript  x  j      subscript  n  j   A     n  b  r        subscript  f  i   V      \frac{\partial u_{i}}{\partial t}V+\sum_{nbr}\left(u_{i}u_{j}n_{j}A\right)_{%
 nbr}=-\sum_{nbr}\left(Pn_{i}A\right)_{nbr}+\sum_{nbr}\left(\nu\frac{\partial u%
 _{i}}{\partial x_{j}}n_{j}A\right)_{nbr}+f_{i}V     where the subscript nbr denotes the value at any given face.  Two-dimensional uniformly-spaced Cartesian grid  For a two-dimensional Cartesian grid, the equation can be expanded to                  ∂   u  i     ∂  t     Δ  x  Δ  y   -    (    u  i   u  Δ  y   )   w    +    (    u  i   u  Δ  y   )   e    -    (    u  i   v  Δ  x   )   s    +    (    u  i   v  Δ  x   )   n    =           -    (   P   n  i   Δ  y   )   w    -    (   P   n  i   Δ  y   )   e   -    (   P   n  i   Δ  x   )   s   -    (   P   n  i   Δ  x   )   n             -    (   ν     ∂   u  i     ∂  x     Δ  y   )   w    +    (   ν     ∂   u  i     ∂  x     Δ  y   )   e    -    (   ν     ∂   u  i     ∂  y     Δ  x   )   s    +    (   ν     ∂   u  i     ∂  y     Δ  x   )   n   +   f  i           missing-subexpression                    subscript  u  i      t    normal-Δ  x  normal-Δ  y    subscript     subscript  u  i   u  normal-Δ  y   w     subscript     subscript  u  i   u  normal-Δ  y   e     subscript     subscript  u  i   v  normal-Δ  x   s     subscript     subscript  u  i   v  normal-Δ  x   n    absent      missing-subexpression        subscript    P   subscript  n  i   normal-Δ  y   w     subscript    P   subscript  n  i   normal-Δ  y   e    subscript    P   subscript  n  i   normal-Δ  x   s    subscript    P   subscript  n  i   normal-Δ  x   n       missing-subexpression            subscript    ν       subscript  u  i      x    normal-Δ  y   w     subscript    ν       subscript  u  i      x    normal-Δ  y   e     subscript    ν       subscript  u  i      y    normal-Δ  x   s     subscript    ν       subscript  u  i      y    normal-Δ  x   n    subscript  f  i       \begin{aligned}&\displaystyle\frac{\partial u_{i}}{\partial t}\Delta x\Delta y%
 -\left(u_{i}u\Delta y\right)_{w}+\left(u_{i}u\Delta y\right)_{e}-\left(u_{i}v%
 \Delta x\right)_{s}+\left(u_{i}v\Delta x\right)_{n}=\\
 &\displaystyle-\left(Pn_{i}\Delta y\right)_{w}-\left(Pn_{i}\Delta y\right)_{e}%
 -\left(Pn_{i}\Delta x\right)_{s}-\left(Pn_{i}\Delta x\right)_{n}\\
 &\displaystyle-\left(\nu\frac{\partial u_{i}}{\partial x}\Delta y\right)_{w}+%
 \left(\nu\frac{\partial u_{i}}{\partial x}\Delta y\right)_{e}-\left(\nu\frac{%
 \partial u_{i}}{\partial y}\Delta x\right)_{s}+\left(\nu\frac{\partial u_{i}}{%
 \partial y}\Delta x\right)_{n}+f_{i}\end{aligned}     On a staggered grid , the x-momentum equation is                  ∂  u    ∂  t     Δ  x  Δ  y   -    (   u  u  Δ  y   )   w    +    (   u  u  Δ  y   )   e    -    (   u  v  Δ  x   )   s    +    (   u  v  Δ  x   )   n    =              +    (   P  Δ  y   )   w    -    (   P  Δ  y   )   e   -    (   ν     ∂  u    ∂  x     Δ  y   )   w    +    (   ν     ∂  u    ∂  x     Δ  y   )   e    -    (   ν     ∂  u    ∂  y     Δ  x   )   s    +    (   ν     ∂  u    ∂  y     Δ  x   )   n   +   f  x           missing-subexpression                   u     t    normal-Δ  x  normal-Δ  y    subscript    u  u  normal-Δ  y   w     subscript    u  u  normal-Δ  y   e     subscript    u  v  normal-Δ  x   s     subscript    u  v  normal-Δ  x   n    absent      missing-subexpression              subscript    P  normal-Δ  y   w     subscript    P  normal-Δ  y   e    subscript    ν      u     x    normal-Δ  y   w     subscript    ν      u     x    normal-Δ  y   e     subscript    ν      u     y    normal-Δ  x   s     subscript    ν      u     y    normal-Δ  x   n    subscript  f  x       \begin{aligned}&\displaystyle\frac{\partial u}{\partial t}\Delta x\Delta y-%
 \left(uu\Delta y\right)_{w}+\left(uu\Delta y\right)_{e}-\left(uv\Delta x\right%
 )_{s}+\left(uv\Delta x\right)_{n}=\\
 &\displaystyle+\left(P\Delta y\right)_{w}-\left(P\Delta y\right)_{e}-\left(\nu%
 \frac{\partial u}{\partial x}\Delta y\right)_{w}+\left(\nu\frac{\partial u}{%
 \partial x}\Delta y\right)_{e}-\left(\nu\frac{\partial u}{\partial y}\Delta x%
 \right)_{s}+\left(\nu\frac{\partial u}{\partial y}\Delta x\right)_{n}+f_{x}%
 \end{aligned}     and the y-momentum equation is                  ∂  v    ∂  t     Δ  x  Δ  y   -    (   v  u  Δ  y   )   w    +    (   v  u  Δ  y   )   e    -    (   v  v  Δ  x   )   s    +    (   v  v  Δ  x   )   n    =              +    (   P  Δ  x   )   s    -    (   P  Δ  x   )   n   -    (   ν     ∂  v    ∂  x     Δ  y   )   w    +    (   ν     ∂  v    ∂  x     Δ  y   )   e    -    (   ν     ∂  v    ∂  y     Δ  x   )   s    +    (   ν     ∂  v    ∂  y     Δ  x   )   n   +   f  y           missing-subexpression                   v     t    normal-Δ  x  normal-Δ  y    subscript    v  u  normal-Δ  y   w     subscript    v  u  normal-Δ  y   e     subscript    v  v  normal-Δ  x   s     subscript    v  v  normal-Δ  x   n    absent      missing-subexpression              subscript    P  normal-Δ  x   s     subscript    P  normal-Δ  x   n    subscript    ν      v     x    normal-Δ  y   w     subscript    ν      v     x    normal-Δ  y   e     subscript    ν      v     y    normal-Δ  x   s     subscript    ν      v     y    normal-Δ  x   n    subscript  f  y       \begin{aligned}&\displaystyle\frac{\partial v}{\partial t}\Delta x\Delta y-%
 \left(vu\Delta y\right)_{w}+\left(vu\Delta y\right)_{e}-\left(vv\Delta x\right%
 )_{s}+\left(vv\Delta x\right)_{n}=\\
 &\displaystyle+\left(P\Delta x\right)_{s}-\left(P\Delta x\right)_{n}-\left(\nu%
 \frac{\partial v}{\partial x}\Delta y\right)_{w}+\left(\nu\frac{\partial v}{%
 \partial x}\Delta y\right)_{e}-\left(\nu\frac{\partial v}{\partial y}\Delta x%
 \right)_{s}+\left(\nu\frac{\partial v}{\partial y}\Delta x\right)_{n}+f_{y}%
 \end{aligned}     The goal at this point is to determine expressions for the face-values for u , v , and P and to approximate the derivatives using finite difference approximations. For this example we will use backward difference for the time derivative and central difference for the spacial derivatives. For both momentum equations, the time derivative becomes        ∂   u  i     ∂  t    =     u  i  n   -   u  i   n  -  1      Δ  t             subscript  u  i      t         superscript   subscript  u  i   n    superscript   subscript  u  i     n  1       normal-Δ  t      \frac{\partial u_{i}}{\partial t}=\frac{u_{i}^{n}-u_{i}^{n-1}}{\Delta t}     where n is the current time index and Δt is the time-step. As an example for the spacial derivatives, derivative in the west-face diffusion term in the x-momentum equation becomes        (    ∂  u    ∂  x    )   w   =     u   I  ,  J    -   u    I  -  1   ,  J      Δ  x         subscript      u     x    w        subscript  u   I  J     subscript  u     I  1   J       normal-Δ  x      \left(\frac{\partial u}{\partial x}\right)_{w}=\frac{u_{I,J}-u_{I-1,J}}{\Delta
 x}     where I and J are the indices of the x-momentum cell of interest.  "  Category:Fluid dynamics   
   Correlogram      Correlogram     In the analysis of data, a correlogram is an image of correlation statistics. For example, in time series analysis , a correlogram, also known as an autocorrelation plot , is a plot of the sample autocorrelations      r  h      subscript  r  h    r_{h}\,   versus    h    h   h\,   (the time lags).  If cross-correlation is used, the result is called a cross-correlogram . The correlogram is a commonly used tool for checking randomness in a data set . This randomness is ascertained by computing autocorrelations for data values at varying time lags. If random, such autocorrelations should be near zero for any and all time-lag separations. If non-random, then one or more of the autocorrelations will be significantly non-zero.  In addition, correlograms are used in the model identification stage for Box–Jenkins  autoregressive moving average  time series models. Autocorrelations should be near-zero for randomness; if the analyst does not check for randomness, then the validity of many of the statistical conclusions becomes suspect. The correlogram is an excellent way of checking for such randomness.  Sometimes, corrgrams , color-mapped matrices of correlation strengths in multivariate analysis , 1 are also called correlograms. 2 3  Applications  The correlogram can help provide answers to the following questions:   Are the data random?  Is an observation related to an adjacent observation?  Is an observation related to an observation twice-removed? (etc.)  Is the observed time series white noise ?  Is the observed time series sinusoidal?  Is the observed time series autoregressive?  What is an appropriate model for the observed time series?  Is the model       Y  =   constant  +  error       Y    constant  error     Y=\mathrm{constant}+\mathrm{error}   valid and sufficient?   Is the formula     s   Y  ¯    =   s  /   N         subscript  s   normal-¯  Y      s    N      s_{\bar{Y}}=s/\sqrt{N}   valid?   Importance  Randomness (along with fixed model, fixed variation, and fixed distribution) is one of the four assumptions that typically underlie all measurement processes. The randomness assumption is critically important for the following three reasons:   Most standard statistical tests depend on randomness. The validity of the test conclusions is directly linked to the validity of the randomness assumption.  Many commonly used statistical formulae depend on the randomness assumption, the most common formula being the formula for determining the standard deviation of the sample mean:        s   Y  ¯    =   s  /   N         subscript  s   normal-¯  Y      s    N      s_{\bar{Y}}=s/\sqrt{N}   where s is the standard deviation of the data. Although heavily used, the results from using this formula are of no value unless the randomness assumption holds.   For univariate data, the default model is       Y  =   constant  +  error       Y    constant  error     Y=\mathrm{constant}+\mathrm{error}   If the data are not random, this model is incorrect and invalid, and the estimates for the parameters (such as the constant) become nonsensical and invalid.  Estimation of autocorrelations  The autocorrelation coefficient at lag h is given by       r  h   =    c  h   /    c  0          subscript  r  h      subscript  c  h    subscript  c  0      r_{h}=c_{h}/c_{0}\,   where c h is the autocovariance function       c  h   =    1  N     ∑   t  =  1    N  -  h      (    Y  t   -   Y  ¯    )    (    Y   t  +  h    -   Y  ¯    )           subscript  c  h       1  N     superscript   subscript     t  1      N  h         subscript  Y  t    normal-¯  Y       subscript  Y    t  h     normal-¯  Y         c_{h}=\frac{1}{N}\sum_{t=1}^{N-h}\left(Y_{t}-\bar{Y}\right)\left(Y_{t+h}-\bar{%
 Y}\right)   and c 0 is the variance function       c  0   =    1  N     ∑   t  =  1   N     (    Y  t   -   Y  ¯    )   2          subscript  c  0       1  N     superscript   subscript     t  1    N    superscript     subscript  Y  t    normal-¯  Y    2       c_{0}=\frac{1}{N}\sum_{t=1}^{N}\left(Y_{t}-\bar{Y}\right)^{2}     The resulting value of r h will range between -1 and +1.  Alternate estimate  Some sources may use the following formula for the autocovariance function:       c  h   =    1   N  -  h      ∑   t  =  1    N  -  h      (    Y  t   -   Y  ¯    )    (    Y   t  +  h    -   Y  ¯    )           subscript  c  h       1    N  h      superscript   subscript     t  1      N  h         subscript  Y  t    normal-¯  Y       subscript  Y    t  h     normal-¯  Y         c_{h}=\frac{1}{N-h}\sum_{t=1}^{N-h}\left(Y_{t}-\bar{Y}\right)\left(Y_{t+h}-%
 \bar{Y}\right)   Although this definition has less bias , the (1/ N ) formulation has some desirable statistical properties and is the form most commonly used in the statistics literature. See pages 20 and 49-50 in Chatfield for details.  Statistical inference with correlograms  In the same graph one can draw upper and lower bounds for autocorrelation with significance level    α    α   \alpha\,   :      B  =   ±    z   1  -   α  /  2     S  E   (   r  h   )         B   plus-or-minus     subscript  z    1    α  2     S  E   subscript  r  h       B=\pm z_{1-\alpha/2}SE(r_{h})\,   with     r  h      subscript  r  h    r_{h}\,   as the estimated autocorrelation at lag    h    h   h\,   .  If the autocorrelation is higher (lower) than this upper (lower) bound, the null hypothesis that there is no autocorrelation at and beyond a given lag is rejected at a significance level of    α    α   \alpha\,   . This test is an approximate one and assumes that the time-series is Gaussian .  In the above, z 1-α/2 is the quantile of the normal distribution ; SE is the standard error, which can be computed by Bartlett 's formula for MA(l) processes:       S  E   (   r  1   )    =   1   N          S  E   subscript  r  1      1    N      SE(r_{1})=\frac{1}{\sqrt{N}}          S  E   (   r  h   )    =     1  +   2    ∑   i  =  1    h  -  1     r  i  2      N          S  E   subscript  r  h          1    2    superscript   subscript     i  1      h  1     subscript   superscript  r  2   i      N      SE(r_{h})=\sqrt{\frac{1+2\sum_{i=1}^{h-1}r^{2}_{i}}{N}}   for    h  >   1.       h  1.    h>1.\,     In the picture above we can reject the null hypothesis that there is no autocorrelation between time-points which are adjacent (lag=1). For the other periods one cannot reject the null hypothesis of no autocorrelation.  Note that there are two distinct formulas for generating the confidence bands:  1. If the correlogram is being used to test for randomness (i.e., there is no time dependence in the data), the following formula is recommended:      ±    z   1  -   α  /  2      N       plus-or-minus     subscript  z    1    α  2       N      \pm\frac{z_{1-\alpha/2}}{\sqrt{N}}   where N is the sample size , z is the quantile function of the standard normal distribution and α is the significance level . In this case, the confidence bands have fixed width that depends on the sample size.  2. Correlograms are also used in the model identification stage for fitting ARIMA models. In this case, a moving average model is assumed for the data and the following confidence bands should be generated:      ±    z   1  -   α  /  2        1  N    (   1  +   2    ∑   i  =  1   k    r  i  2      )         plus-or-minus     subscript  z    1    α  2           1  N     1    2    superscript   subscript     i  1    k    superscript   subscript  r  i   2           \pm z_{1-\alpha/2}\sqrt{\frac{1}{N}\left(1+2\sum_{i=1}^{k}r_{i}^{2}\right)}   where k is the lag. In this case, the confidence bands increase as the lag increases.  Software  Correlograms are available in most general purpose statistical software programs. In R , the function acf and pacf can be used to produce such a plot.  Related techniques   Partial autocorrelation plot  Lag plot  Spectral plot  Seasonal subseries plot  Scaled Correlation   References  Further reading       External links   Autocorrelation Plot   "  Category:Statistical charts and diagrams  Category:Time series analysis     ↩  ↩  ↩     
   Tensor product model transformation      Tensor product model transformation   In mathematics, the tensor product (TP) model transformation was proposed by Baranyi and Yam 1  2 3 for quasi-LPV (qLPV) control theory. It transforms a function (which can be given via closed formulas or neural networks , fuzzy logic , etc.) into TP function form if such a transformation is possible. If an exact transformation is not possible, then the method determines a TP function that is an approximation of the given function. Hence, the TP model transformation can provide a trade-off between approximation accuracy and complexity. 4  A free MATLAB implementation of the TP model transformation can be downloaded at 1 or at MATLAB Central 2 . A key underpinning of the transformation is the higher-order singular value decomposition . 5  Besides being a transformation of functions, the TP model transformation is also a new concept in qLPV based control which plays a central role in the providing a valuable means of bridging between identification and polytopic systems theories. The TP model transformation is uniquely effective in manipulating the convex hull of polytopic forms, and, as a result has revealed and proved the fact that convex hull manipulation is a necessary and crucial step in achieving optimal solutions and decreasing conservativeness in modern LMI based control theory. Thus, although it is a transformation in a mathematical sense, it has established a conceptually new direction in control theory and has laid the ground for further new approaches towards optimality. Further details on the control theoretical aspects of the TP model transformation can be found here: TP model transformation in control theory .  The TP model transformation motivated the definition of the "HOSVD canonical form of TP functions", 6 on which further information can be found here . It has been proved that the TP model transformation is capable of numerically reconstructing this HOSVD based canonical form. 7 Thus, the TP model transformation can be viewed as a numerical method to compute the HOSVD of functions, which provides exact results if the given function has a TP function structure and approximative results otherwise.  The TP model transformation has recently been extended in order to derive various types of convex TP functions and to manipulate them. This feature has led to new optimization approaches in qLPV system analysis and design, as described here: TP model transformation in control theory .  Definitions   Finite element TP function: A given function    f   (  𝐱  )       f  𝐱    f({\mathbf{x}})   , where    𝐱  ∈   R  N       𝐱   superscript  R  N     \mathbf{x}\in R^{N}   , is a TP function if it has the structure:           f   (  𝐱  )    =    ∑    i  1   =  1    I  1      ∑    i  2   =  1    I  2     …    ∑    i  N   =  1    I  N      ∏   n  =  1   N     w   n  ,   i  n      (   x  n   )    s    i  1   ,   i  2   ,  …  ,   i  N            ,        f  𝐱     superscript   subscript      subscript  i  1   1     subscript  I  1      superscript   subscript      subscript  i  2   1     subscript  I  2      normal-…    superscript   subscript      subscript  i  N   1     subscript  I  N      superscript   subscript  product    n  1    N      subscript  w   n   subscript  i  n      subscript  x  n    subscript  s    subscript  i  1    subscript  i  2   normal-…   subscript  i  N             f(\mathbf{x})=\sum_{i_{1}=1}^{I_{1}}\sum_{i_{2}=1}^{I_{2}}\ldots\sum_{i_{N}=1}%
 ^{I_{N}}\prod_{n=1}^{N}w_{n,i_{n}}(x_{n})s_{i_{1},i_{2},\ldots,i_{N}},        that is, using compact tensor notation (using the tensor product operation   ⊗   tensor-product   \otimes   of 8 ):          f   (  𝐱  )    =   𝒮    ⊗   n  =  1   N     𝐰  n    (   x  n   )       ,        f  𝐱     𝒮    superscript   subscript  tensor-product    n  1    N      subscript  𝐰  n    subscript  x  n        f(\mathbf{x})=\mathcal{S}\mathop{\otimes}_{n=1}^{N}\mathbf{w}_{n}(x_{n}),        where core tensor    𝒮  ∈   ℛ    I  1   ×   I  2   ×  …  ×   I  N         𝒮   superscript  ℛ     subscript  I  1    subscript  I  2   normal-…   subscript  I  N       \mathcal{S}\in\mathcal{R}^{I_{1}\times I_{2}\times\ldots\times I_{N}}   is constructed from    s    i  1    i  2   …   i  N       subscript  s     subscript  i  1    subscript  i  2   normal-…   subscript  i  N      s_{i_{1}i_{2}\ldots i_{N}}   , and row vector     𝐰  n    (   x  n   )   ,   (  n  =  1  …  N  )      fragments   subscript  𝐰  n    fragments  normal-(   subscript  x  n   normal-)   normal-,   fragments  normal-(  n   1  normal-…  N  normal-)     \mathbf{w}_{n}(x_{n}),(n=1\ldots N)   contains continuous univariate weighting functions     w   n  ,   i  n      (   x  n   )   ,   (   i  n   =  1  …   I  n   )      fragments   subscript  w   n   subscript  i  n      fragments  normal-(   subscript  x  n   normal-)   normal-,   fragments  normal-(   subscript  i  n    1  normal-…   subscript  I  n   normal-)     w_{n,i_{n}}(x_{n}),(i_{n}=1\ldots I_{n})   . The function     w   n  ,   i  n      (   x  n   )        subscript  w   n   subscript  i  n      subscript  x  n     w_{n,i_{n}}(x_{n})   is the    i  n     subscript  i  n    i_{n}   -th weighting function defined on the   n   n   n   -th dimension, and    x  n     subscript  x  n    x_{n}   is the   n   n   n   -the element of vector   𝐱   𝐱   \mathbf{x}   . Finite element means that    I  n     subscript  I  n    I_{n}   is bounded for all   n   n   n   . For qLPV modelling and control applications a higher structure of TP functions are referred to as TP model.   Finite element TP model (TP model in short): This is a higher structure of TP function:           ℱ   (  𝐱  )    =    𝒮   ⊠   n  =  1   N    𝐰  n     (   x  n   )     .        ℱ  𝐱       superscript   subscript  normal-⊠    n  1    N   𝒮   subscript  𝐰  n     subscript  x  n      \mathcal{F}(\mathbf{x})=\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(x_{n}).        Here    𝒴  =   ℱ   (  𝐱  )        𝒴    ℱ  𝐱     \mathcal{Y}=\mathcal{F}({\mathbf{x}})   is a tensor as    𝒴  ∈   ℛ     L  1   ×   L  2   ×  …    L  O         𝒴   superscript  ℛ       subscript  L  1    subscript  L  2   normal-…    subscript  L  O       \mathcal{Y}\in\mathcal{R}^{L_{1}\times L_{2}\times\ldots L_{O}}   , thus the size of the core tensor is    𝒮  ∈   ℛ    I  1   ×   I  2   ×  …  ×   I  N   ×   L  1   ×   L  2   ×  …  ×   L  O         𝒮   superscript  ℛ     subscript  I  1    subscript  I  2   normal-…   subscript  I  N    subscript  L  1    subscript  L  2   normal-…   subscript  L  O       \mathcal{S}\in\mathcal{R}^{I_{1}\times I_{2}\times\ldots\times I_{N}\times L_{%
 1}\times L_{2}\times...\times L_{O}}   . The product operator   ⊠   normal-⊠   \boxtimes   has the same role as   ⊗   tensor-product   \otimes   , but expresses the fact that the tensor product is applied on the     L  1   ×   L  2   ×  …  ×   L  O        subscript  L  1    subscript  L  2   normal-…   subscript  L  O     L_{1}\times L_{2}\times...\times L_{O}   sized tensor elements of the core tensor   𝒮   𝒮   \mathcal{S}   . Vector   𝐱   𝐱   \mathbf{x}   is an element of the closed hypercube    Ω  =    [   a  1   ,   b  1   ]   ×   [   a  2   ,   b  2   ]   ×  …  ×   [   a  N   ,   b  N   ]    ⊂   R  N         normal-Ω      subscript  a  1    subscript  b  1      subscript  a  2    subscript  b  2    normal-…    subscript  a  N    subscript  b  N           superscript  R  N      \Omega=[a_{1},b_{1}]\times[a_{2},b_{2}]\times...\times[a_{N},b_{N}]\subset R^{N}   .   Finite element convex TP function or model: A TP function or model is convex if the wighting functions hold:          ∀  n   :     ∑    i  n   =  1    I  n      w   n  ,   i  n      (   x  n   )     =  1      normal-:   for-all  n       superscript   subscript      subscript  i  n   1     subscript  I  n       subscript  w   n   subscript  i  n      subscript  x  n     1     \forall n:\sum_{i_{n}=1}^{I_{n}}w_{n,i_{n}}(x_{n})=1   and       w   n  ,   i  n      (   x  n   )    ∈   [  0  ,  1  ]    .         subscript  w   n   subscript  i  n      subscript  x  n     0  1     w_{n,i_{n}}(x_{n})\in[0,1].        This means that    f   (  𝐱  )       f  𝐱    f(\mathbf{x})   is inside the convex hull defined by the core tensor for all    𝐱  ∈  Ω      𝐱  normal-Ω    \mathbf{x}\in\Omega   .   TP model transformation: Assume a given TP model    𝒴  =   ℱ   (  𝐱  )        𝒴    ℱ  𝐱     \mathcal{Y}=\mathcal{F}(\mathbf{x})   , where    𝐱  ∈  Ω  ⊂   R  N         𝐱  normal-Ω        superscript  R  N      \mathbf{x}\in\Omega\subset R^{N}   , whose TP structure maybe unknown (e.g. it is given by neural networks). The TP model transformation determines its TP structure as          ℱ   (  𝐱  )    =    𝒮   ⊠   n  =  1   N    𝐰  n     (   x  n   )          ℱ  𝐱       superscript   subscript  normal-⊠    n  1    N   𝒮   subscript  𝐰  n     subscript  x  n      \mathcal{F}(\mathbf{x})=\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(x_{n})   ,     namely it generates the core tensor   𝒮   𝒮   \mathcal{S}   and the weighting functions     𝐰  n    (   x  n   )        subscript  𝐰  n    subscript  x  n     \mathbf{w}_{n}(x_{n})   for all    n  =   1  …  N       n    1  normal-…  N     n=1\ldots N   . Its free MATLAB implementation is downloadable at 3 or at MATLAB Central 4 .  If the given    ℱ   (  𝐱  )       ℱ  𝐱    \mathcal{F}(\mathbf{x})   does not have TP structure (i.e. it is not in the class of TP models), then the TP model transformation determines its approximation: 9          ℱ   (  𝐱  )    ≈    𝒮   ⊠   n  =  1   N    𝐰  n     (   x  n   )     ,        ℱ  𝐱       superscript   subscript  normal-⊠    n  1    N   𝒮   subscript  𝐰  n     subscript  x  n      \mathcal{F}(\mathbf{x})\approx\mathcal{S}\boxtimes_{n=1}^{N}\mathbf{w}_{n}(x_{%
 n}),        where trade-off is offered by the TP model transformation between complexity (number of components in the core tensor or the number of weighting functions) and the approximation accuracy. The TP model can be generated according to various constrains. Typical TP models generated by the TP model transformation are:   HOSVD canonical form of TP functions or TP model (qLPV models),  Various kinds of TP type polytopic form or convex TP model forms (this advantage is used in qLPV system analysis and design).   Properties of the TP model transformation   It is a non-heuristic and tractable numerical method firstly proposed in control theory. 10 11  It transforms the given function into finite element TP structure. If this structure does not exist, then the transformation gives an approximation under a constraint on the number of elements.  It can be executed uniformly (irrespective of whether the model is given in the form of analytical equations resulting from physical considerations, or as an outcome of soft computing based identification techniques (such as neural networks or fuzzy logic based methods, or as a result of a black-box identification), without analytical interaction, within a reasonable amount of time. Thus, the transformation replaces the analytical and in many cases complex and not obvious conversions to numerical, tractable, straightforward operations.  It generates the HOSVD-based canonical form of TP functions, 12 which is a unique representation. It was proven by Szeidl 13 that the TP model transformation numerically reconstructs the HOSVD of functions. This form extracts the unique structure of a given TP function in the same sense as the HOSVD does for tensors and matrices, in a way such that:   :* the number of weighting functions are minimized per dimensions (hence the size of the core tensor);  :* the weighting functions are one variable functions of the parameter vector in an orthonormed system for each parameter (singular functions);  :* the sub tensors of the core tensor are also in orthogonal positions;  :* the core tensor and the weighting functions are ordered according to the higher-order singular values of the parameter vector;  :* it has a unique form (except for some special cases such as there are equal singular values);  :* introduces and defines the rank of the TP function by the dimensions of the parameter vector;   The above point can be extended to TP models (qLPV models to determine the HOSVD based canonical from of qLPV model to order the main component of the qLPV model). Since the core tensor is    N  +  O      N  O    N+O   dimensional, but the weighting functions are determined only for dimensions    n  =   1  …  N       n    1  normal-…  N     n=1\ldots N   , namely the core tensor is constructed from   O   O   O   dimensional elements, therefore the resulting TP form is not unique.    The core step of the TP model transformation was extended to generate different types of convex TP functions or TP models (TP type polytopic qLPV models), in order to focus on the systematic (numerical and automatic) modification of the convex hull instead of developing new LMI equations for feasible controller design (this is the widely adopted approach). It is worth noting that both the TP model transformation and the LMI-based control design methods are numerically executable one after the other, and this makes the resolution of a wide class of problems possible in a straightforward and tractable, numerical way.  The TP model transformation is capable of performing trade-off between complexity and accuracy of TP functions 14 via discarding the higher-order singular values, in the same manner as the tensor HOSVD is used for complexity reduction.   References    External links   TP Tool – home page   "  Category:Control theory     ↩  ↩  ↩  ↩   ↩   ↩      ↩      
   Kendall rank correlation coefficient      Kendall rank correlation coefficient   In statistics , the Kendall rank correlation coefficient , commonly referred to as Kendall's tau coefficient (after the Greek letter τ ), is a statistic used to measure the association between two measured quantities. A tau test is a non-parametric  hypothesis test for statistical dependence based on the tau coefficient.  It is a measure of rank correlation : the similarity of the orderings of the data when ranked by each of the quantities. It is named after Maurice Kendall , who developed it in 1938, 1 though Gustav Fechner had proposed a similar measure in the context of time series in 1897. 2  Definition  Let ( x 1 , y 1 ), ( x 2 , y 2 ), …, ( x n , y n ) be a set of observations of the joint random variables X and Y respectively, such that all the values of ( x i ) and ( y i ) are unique. Any pair of observations ( x i , y i ) and ( x j , y j ) are said to be concordant if the ranks for both elements agree: that is, if both x i > x j and y i > y j or if both x i  j and y i  j . They are said to be discordant , if x i > x j and y i  j or if x i  j and y i > y j . If x i = x j or y i = y j , the pair is neither concordant nor discordant.  The Kendall τ coefficient is defined as:       τ  =     (  number of concordant pairs  )   -   (  number of discordant pairs  )      1  2   n   (   n  -  1   )      .      τ      number of concordant pairs  number of discordant pairs       1  2   n    n  1       \tau=\frac{(\text{number of concordant pairs})-(\text{number of discordant %
 pairs})}{\frac{1}{2}n(n-1)}.    3  Properties  The denominator is the total number of pair combinations, so the coefficient must be in the range −1 ≤ τ ≤ 1.   If the agreement between the two rankings is perfect (i.e., the two rankings are the same) the coefficient has value 1.  If the disagreement between the two rankings is perfect (i.e., one ranking is the reverse of the other) the coefficient has value −1.  If X and Y are independent , then we would expect the coefficient to be approximately zero.   Hypothesis test  The Kendall rank coefficient is often used as a test statistic in a statistical hypothesis test to establish whether two variables may be regarded as statistically dependent. This test is non-parametric , as it does not rely on any assumptions on the distributions of X or Y or the distribution of ( X , Y ).  Under the null hypothesis of independence of X and Y , the sampling distribution of τ has an expected value of zero. The precise distribution cannot be characterized in terms of common distributions, but may be calculated exactly for small samples; for larger samples, it is common to use an approximation to the normal distribution , with mean zero and variance       2   (    2  n   +  5   )     9  n   (   n  -  1   )          2      2  n   5      9  n    n  1      \frac{2(2n+5)}{9n(n-1)}   . 4  Accounting for ties  A pair {( x i , y i ), ( x j , y j )} is said to be tied if x i = x j or y i = y j ; a tied pair is neither concordant nor discordant. When tied pairs arise in the data, the coefficient may be modified in a number of ways to keep it in the range [−1, 1]:  Tau-a  The Tau-a statistic tests the strength of association of the cross tabulations . Both variables have to be ordinal . Tau-a will not make any adjustment for ties. It is defined as:       τ  A   =     n  c   -   n  d     n  0         subscript  τ  A        subscript  n  c    subscript  n  d     subscript  n  0      \tau_{A}=\frac{n_{c}-n_{d}}{n_{0}}     where n c , n d and n 0 are defined as in the next section.  Tau-b  The Tau-b statistic, unlike Tau-a, makes adjustments for ties. 5 Values of Tau-b range from −1 (100% negative association, or perfect inversion) to +1 (100% positive association, or perfect agreement). A value of zero indicates the absence of association.  The Kendall Tau-b coefficient is defined as:       τ  B   =     n  c   -   n  d       (    n  0   -   n  1    )    (    n  0   -   n  2    )           subscript  τ  B        subscript  n  c    subscript  n  d           subscript  n  0    subscript  n  1       subscript  n  0    subscript  n  2         \tau_{B}=\frac{n_{c}-n_{d}}{\sqrt{(n_{0}-n_{1})(n_{0}-n_{2})}}     where      n  0     subscript  n  0    \displaystyle n_{0}     Tau-c  Tau-c differs from Tau-b as in being more suitable for rectangular tables than for square tables.  Significance tests  When two quantities are statistically independent, the distribution of   τ   τ   \tau   is not easily characterizable in terms of known distributions. However, for    τ  A     subscript  τ  A    \tau_{A}   the following statistic,    z  A     subscript  z  A    z_{A}   , is approximately distributed as a standard normal when the variables are statistically independent:       z  A   =    3   (    n  c   -   n  d    )       n   (   n  -  1   )    (    2  n   +  5   )    /  2          subscript  z  A       3     subscript  n  c    subscript  n  d           n    n  1       2  n   5    2       z_{A}={3(n_{c}-n_{d})\over\sqrt{n(n-1)(2n+5)/2}}     Thus, to test whether two variables are statistically dependent, one computes    z  A     subscript  z  A    z_{A}   , and finds the cumulative probability for a standard normal distribution at    -   |   z  A   |          subscript  z  A      -|z_{A}|   . For a 2-tailed test, multiply that number by two to obtain the p -value. If the p -value is below a given significance level, one rejects the null hypothesis (at that significance level) that the quantities are statistically independent.  Numerous adjustments should be added to    z  A     subscript  z  A    z_{A}   when accounting for ties. The following statistic,    z  B     subscript  z  B    z_{B}   , has the same distribution as the    τ  B     subscript  τ  B    \tau_{B}   distribution, and is again approximately equal to a standard normal distribution when the quantities are statistically independent:       z  B   =     n  c   -   n  d     v         subscript  z  B        subscript  n  c    subscript  n  d      v      z_{B}={n_{c}-n_{d}\over\sqrt{v}}     where        v    =       (    v  0   -   v  t   -   v  u    )   /  18   +   v  1   +   v  2         v  0     =     n   (   n  -  1   )    (    2  n   +  5   )         v  t     =      ∑  i     t  i    (    t  i   -  1   )    (    2   t  i    +  5   )          v  u     =      ∑  j     u  j    (    u  j   -  1   )    (    2   u  j    +  5   )          v  1     =      ∑  i     t  i    (    t  i   -  1   )     ∑  j      u  j    (    u  j   -  1   )    /   (   2  n   (   n  -  1   )    )            v  2     =      ∑  i     t  i    (    t  i   -  1   )    (    t  i   -  2   )     ∑  j      u  j    (    u  j   -  1   )    (    u  j   -  2   )    /   (   9  n   (   n  -  1   )    (   n  -  2   )    )             v          subscript  v  0    subscript  v  t    subscript  v  u    18    subscript  v  1    subscript  v  2       subscript  v  0      n    n  1       2  n   5       subscript  v  t      subscript   i      subscript  t  i      subscript  t  i   1       2   subscript  t  i    5        subscript  v  u      subscript   j      subscript  u  j      subscript  u  j   1       2   subscript  u  j    5        subscript  v  1      subscript   i      subscript  t  i      subscript  t  i   1     subscript   j        subscript  u  j      subscript  u  j   1      2  n    n  1           subscript  v  2      subscript   i      subscript  t  i      subscript  t  i   1      subscript  t  i   2     subscript   j        subscript  u  j      subscript  u  j   1      subscript  u  j   2      9  n    n  1     n  2           \begin{array}[]{ccl}v&=&(v_{0}-v_{t}-v_{u})/18+v_{1}+v_{2}\\
 v_{0}&=&n(n-1)(2n+5)\\
 v_{t}&=&\sum_{i}t_{i}(t_{i}-1)(2t_{i}+5)\\
 v_{u}&=&\sum_{j}u_{j}(u_{j}-1)(2u_{j}+5)\\
 v_{1}&=&\sum_{i}t_{i}(t_{i}-1)\sum_{j}u_{j}(u_{j}-1)/(2n(n-1))\\
 v_{2}&=&\sum_{i}t_{i}(t_{i}-1)(t_{i}-2)\sum_{j}u_{j}(u_{j}-1)(u_{j}-2)/(9n(n-1%
 )(n-2))\end{array}     pvrank 6 is a very recent R package that computes rank correlations and their p-values with various options for tied ranks. It is possible to compute exact Kendall coefficient test p-values for n ≤ 60.  Algorithms  The direct computation of the numerator     n  c   -   n  d        subscript  n  c    subscript  n  d     n_{c}-n_{d}   , involves two nested iterations, as characterized by the following pseudo-code:  numer := 0  for i:=2..N do   for j:=1..(i-1) do  numer := numer + sign(x[i] - x[j]) * sign(y[i] - y[j])  return numer  Although quick to implement, this algorithm is    O   (   n  2   )       O   superscript  n  2     O(n^{2})   in complexity and becomes very slow on large samples. A more sophisticated algorithm 7 built upon the Merge Sort algorithm can be used to compute the numerator in    O   (   n  ⋅   log  n    )       O   normal-⋅  n    n      O(n\cdot\log{n})   time.  Begin by ordering your data points sorting by the first quantity,   x   x   x   , and secondarily (among ties in   x   x   x   ) by the second quantity,   y   y   y   . With this initial ordering,   y   y   y   is not sorted, and the core of the algorithm consists of computing how many steps a Bubble Sort would take to sort this initial   y   y   y   . An enhanced Merge Sort algorithm, with    O   (   n   log  n    )       O    n    n      O(n\log n)   complexity, can be applied to compute the number of swaps,    S   (  y  )       S  y    S(y)   , that would be required by a Bubble Sort to sort    y  i     subscript  y  i    y_{i}   . Then the numerator for   τ   τ   \tau   is computed as:         n  c   -   n  d    =      n  0   -   n  1   -   n  2    +   n  3    -   2  S   (  y  )      ,         subscript  n  c    subscript  n  d           subscript  n  0    subscript  n  1    subscript  n  2     subscript  n  3      2  S  y      n_{c}-n_{d}=n_{0}-n_{1}-n_{2}+n_{3}-2S(y),     where    n  3     subscript  n  3    n_{3}   is computed like    n  1     subscript  n  1    n_{1}   and    n  2     subscript  n  2    n_{2}   , but with respect to the joint ties in   x   x   x   and   y   y   y   .  A Merge Sort partitions the data to be sorted,   y   y   y   into two roughly equal halves,    y  left     subscript  y  left    y_{\mathrm{left}}   and    y  right     subscript  y  right    y_{\mathrm{right}}   , then sorts each half recursive, and then merges the two sorted halves into a fully sorted vector. The number of Bubble Sort swaps is equal to:       S   (  y  )    =    S   (   y  left   )    +   S   (   y  right   )    +   M   (   Y  left   ,   Y  right   )           S  y       S   subscript  y  left      S   subscript  y  right      M    subscript  Y  left    subscript  Y  right        S(y)=S(y_{\mathrm{left}})+S(y_{\mathrm{right}})+M(Y_{\mathrm{left}},Y_{\mathrm%
 {right}})     where    Y  left     subscript  Y  left    Y_{\mathrm{left}}   and    Y  right     subscript  Y  right    Y_{\mathrm{right}}   are the sorted versions of    y  left     subscript  y  left    y_{\mathrm{left}}   and    y  right     subscript  y  right    y_{\mathrm{right}}   , and    M   (  ⋅  ,  ⋅  )       M   normal-⋅  normal-⋅     M(\cdot,\cdot)   characterizes the Bubble Sort swap-equivalent for a merge operation.    M   (  ⋅  ,  ⋅  )       M   normal-⋅  normal-⋅     M(\cdot,\cdot)   is computed as depicted in the following pseudo-code:  function M(L[1..n], R[1..m])  i := 1  j := 1  nSwaps := 0   while i x and a sorted version of    y   y   y    . With these, the factors     t  i     subscript  t  i    t_{i}    and     u  j     subscript  u  j    u_{j}    used to compute     τ  B     subscript  τ  B    \tau_{B}    are easily obtained in a single linear-time pass through the sorted arrays.  A second algorithm with    O   (   n  ⋅   log  n    )       O   normal-⋅  n    n      O(n\cdot\log{n})   time complexity, based on AVL trees , was devised by David Christensen. 8 Yet another algorithm for    O   (   n  ⋅   log  n    )       O   normal-⋅  n    n      O(n\cdot\log{n})   time complexity was proposed more recently. 9  See also   Correlation  Kendall tau distance  Kendall's W  Spearman's rank correlation coefficient  Goodman and Kruskal's gamma  Theil–Sen estimator   References    Kendall, M. (1948) Rank Correlation Methods , Charles Griffin & Company Limited  Bonett, DG & Wright, TA (2000) Sample size requirements for Pearson, Kendall, and Spearman correlations , Psychometrika, 65, 23–28.   External links   Tied rank calculation  Software for computing Kendall's tau on very large datasets  Online software: computes Kendall's tau rank correlation  The CORR Procedure: Statistical Computations – McDonough School of Business   de:Rangkorrelationskoeffizient#Kendalls Tau "  Category:Covariance and correlation  Category:Non-parametric statistics  Category:Statistical tests  Category:Statistical dependence     ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="234">Perturbation theory</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Perturbation theory</h1>
<hr/>

<p><strong>Perturbation theory</strong> comprises mathematical methods for finding an <a href="approximation_theory" title="wikilink">approximate solution</a> to a problem, by starting from the exact solution of a related problem. A critical feature of the technique is a middle step that breaks the problem into "solvable" and "perturbation" parts.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Perturbation theory is applicable if the problem at hand cannot be solved exactly, but can be formulated by adding a "small" term to the mathematical description of the exactly solvable problem.</p>

<p>Perturbation theory leads to an expression for the desired solution in terms of a <a href="formal_power_series" title="wikilink">formal power series</a> in some "small" parameter ‚Äì known as a <strong>perturbation series</strong> ‚Äì that quantifies the deviation from the exactly solvable problem. The leading term in this power series is the solution of the exactly solvable problem, while further terms describe the deviation in the solution, due to the deviation from the initial problem. Formally, we have for the approximation to the full solution 

<math display="inline" id="Perturbation_theory:0">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

, a series in the small parameter (here called 

<math display="inline" id="Perturbation_theory:1">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

), like the following:</p>

<p>

<math display="block" id="Perturbation_theory:2">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>A</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>Œµ</mi>
      <mn>1</mn>
     </msup>
     <msub>
      <mi>A</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>Œµ</mi>
      <mn>2</mn>
     </msup>
     <msub>
      <mi>A</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">‚ãØ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œµ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œµ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-‚ãØ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=A_{0}+\varepsilon^{1}A_{1}+\varepsilon^{2}A_{2}+\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>In this example, <mtpl></mtpl> would be the known solution to the exactly solvable initial problem and <mtpl></mtpl> represent the <strong>higher-order terms</strong> which may be found iteratively by some systematic procedure. For small 

<math display="inline" id="Perturbation_theory:3">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 these higher-order terms in the series become successively smaller.</p>

<p>An approximate "perturbation solution" is obtained by truncating the series, usually by keeping only the first two terms, the initial solution and the "first-order" perturbation correction</p>

<p>

<math display="block" id="Perturbation_theory:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>‚âà</mo>
    <mrow>
     <msub>
      <mi>A</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <mi>Œµ</mi>
      <mpadded width="+3.3pt">
       <msub>
        <mi>A</mi>
        <mn>1</mn>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>A</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\approx A_{0}+\varepsilon A_{1}~{}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="general-description">General description</h2>

<p>Perturbation theory is closely related to methods used in <a href="numerical_analysis" title="wikilink">numerical analysis</a>. The earliest use of what would now be called <em>perturbation theory</em> was to deal with the otherwise unsolvable mathematical problems of <a href="celestial_mechanics" title="wikilink">celestial mechanics</a>: for example the <a href="orbit_of_the_Moon" title="wikilink">orbit of the Moon</a>, which moves noticeably differently from a simple <a href="Kepler's_laws_of_planetary_motion" title="wikilink">Keplerian ellipse</a> because of the competing gravitation of the Earth and the <a class="uri" href="Sun" title="wikilink">Sun</a>.</p>

<p>Perturbation methods start with a simplified form of the original problem, which is <em>simple enough</em> to be solved exactly. In <a href="celestial_mechanics" title="wikilink">celestial mechanics</a>, this is usually a <a href="Kepler's_laws_of_planetary_motion" title="wikilink">Keplerian ellipse</a>. Under non relativistic gravity, an ellipse is exactly correct when there are only two gravitating bodies (say, the Earth and the <a class="uri" href="Moon" title="wikilink">Moon</a>) but not quite correct when there are three or more objects (say, the Earth, <a class="uri" href="Moon" title="wikilink">Moon</a>, <a class="uri" href="Sun" title="wikilink">Sun</a>, and the rest of the <a href="solar_system" title="wikilink">solar system</a>).</p>

<p>The solved, but simplified problem is then <em>"perturbed"</em> to make the conditions that the perturbed solution actually satisfies closer to the real problem, such as including the gravitational attraction of a third body (the <a class="uri" href="Sun" title="wikilink">Sun</a>). The "conditions" are a formula (or several) that represent reality, often something arising from a physical law like <a href="Newton's_second_law" title="wikilink">Newton's second law, the force-acceleration equation</a>,</p>

<p>

<math display="block" id="Perturbation_theory:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùîΩ</mi>
    <mo>=</mo>
    <mrow>
     <mi>m</mi>
     <mpadded width="+3.3pt">
      <mi>ùïí</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùîΩ</ci>
    <apply>
     <times></times>
     <ci>m</ci>
     <ci>ùïí</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}=m\mathbb{a}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>In the case of the example, the force 

<math display="inline" id="Perturbation_theory:6">
 <semantics>
  <mi>ùêÖ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêÖ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}
  </annotation>
 </semantics>
</math>

 is calculated based on the number of gravitationally relevant bodies; the acceleration 

<math display="inline" id="Perturbation_theory:7">
 <semantics>
  <mi>ùêö</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùêö</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{a}
  </annotation>
 </semantics>
</math>

 is obtained, using calculus, from the path of the <a class="uri" href="Moon" title="wikilink">Moon</a> in its orbit. Both of these come in two forms: approximate values for force and acceleration, which result from simplifications, and hypothetical exact values for force and acceleration, which would require the complete answer to calculate.</p>

<p>The slight changes that result from accommodating the perturbation, which themselves may have been simplified yet again, are used as corrections to the approximate solution. Because of simplifications introduced along every step of the way, the corrections are never perfect, and the conditions met by the corrected solution do not perfectly match the equation demanded by reality. However, even only one cycle of corrections often provides an excellent approximate answer to what the real solution should be.</p>

<p>There is no requirement to stop at only one cycle of corrections. A partially corrected solution can be re-used as the new starting point for yet another cycle of perturbations and corrections. In principle, cycles of finding increasingly better corrections could go on indefinitely. In practice, one typically stops at one or two cycles of corrections. The usual difficulty with the method is that the corrections progressively make the new solutions very much more complicated, so each cycle is much more difficult to manage than the previous cycle of corrections. <a href="Isaac_Newton" title="wikilink">Isaac Newton</a> is reported to have said, regarding the problem of the <a class="uri" href="Moon" title="wikilink">Moon</a>'s orbit, that <em>"It causeth my head to ache."</em><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>This general procedure is a widely used mathematical tool in advanced sciences and engineering: start with a simplified problem and gradually add corrections that make the formula that the corrected problem matches closer and closer to the formula that represents reality. It is the natural extension to <a href="function_(mathematics)" title="wikilink">mathematical functions</a> of the "guess, check, and fix" method used by <a href="Methods_of_computing_square_roots#Babylonian_method" title="wikilink">older civilisations</a> to compute certain numbers, such as square roots.</p>
<h2 id="examples">Examples</h2>

<p>Examples for the "mathematical description" are: an <a href="algebraic_equation" title="wikilink">algebraic equation</a>, a <a href="differential_equation" title="wikilink">differential equation</a> (e.g., the <a href="equations_of_motion" title="wikilink">equations of motion</a> in <a href="celestial_mechanics" title="wikilink">celestial mechanics</a> or a <a href="wave_equation" title="wikilink">wave equation</a>), a <a href="Thermodynamic_free_energy" title="wikilink">free energy</a> (in <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>), a <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> operator (in <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>).</p>

<p>Examples for the kind of solution to be found perturbatively: the solution of the equation (e.g., the <a class="uri" href="trajectory" title="wikilink">trajectory</a> of a particle), the <a href="average" title="wikilink">statistical average</a> of some physical quantity (e.g., average magnetization), the <a href="ground_state" title="wikilink">ground state</a> energy of a quantum mechanical problem.</p>

<p>Examples for the exactly solvable problems to start with: <a href="linear_equation" title="wikilink">linear equations</a>, including linear equations of motion (<a href="harmonic_oscillator" title="wikilink">harmonic oscillator</a>, <a href="linear_wave_equation" title="wikilink">linear wave equation</a>), statistical or quantum-mechanical systems of non-interacting particles (or in general, Hamiltonians or free energies containing only terms quadratic in all degrees of freedom).</p>

<p>Examples of "perturbations" to deal with: Nonlinear contributions to the equations of motion, <a href="interaction" title="wikilink">interactions</a> between particles, terms of higher powers in the Hamiltonian/Free Energy.</p>

<p>For physical problems involving interactions between particles, the terms of the perturbation series may be displayed (and manipulated) using <a href="Feynman_diagram" title="wikilink">Feynman diagrams</a>.</p>
<h2 id="history">History</h2>

<p>Perturbation theory was first proposed for the solution of problems in celestial mechanics, in the context of the motions of planets in the solar system. Since the planets are very remote from each other, and since their mass is small as compared to the mass of the Sun, the gravitational forces between the planets can be neglected, and the planetary motion is considered, to a first approximation, as taking place along Kepler's orbits, which are defined by the equations of the <a href="two-body_problem" title="wikilink">two-body problem</a>, the two bodies being the planet and the Sun.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Since astronomic data came to be known with much greater accuracy, it became necessary to consider how the motion of a planet around the Sun is affected by other planets. This was the origin of the <a href="three-body_problem" title="wikilink">three-body problem</a>; thus, in studying the system Moon‚ÄìEarth‚ÄìSun the mass ratio between the Moon and the Earth was chosen as the small parameter. <a class="uri" href="Lagrange" title="wikilink">Lagrange</a> and <a class="uri" href="Laplace" title="wikilink">Laplace</a> were the first to advance the view that the constants which describe the motion of a planet around the Sun are "perturbed" , as it were, by the motion of other planets and vary as a function of time; hence the name "perturbation theory" .<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Perturbation theory was investigated by the classical scholars ‚Äî <a class="uri" href="Laplace" title="wikilink">Laplace</a>, <a class="uri" href="Poisson" title="wikilink">Poisson</a>, <a class="uri" href="Gauss" title="wikilink">Gauss</a> ‚Äî as a result of which the computations could be performed with a very high accuracy. <a href="Discovery_of_Neptune" title="wikilink">The discovery of the planet Neptune</a> in 1848 by <a href="John_Couch_Adams" title="wikilink">John Couch Adams</a> and <a href="Urbain_Le_Verrier" title="wikilink">Urbain Le Verrier</a>, based on the deviations in motion of the planet <a class="uri" href="Uranus" title="wikilink">Uranus</a>, represented a triumph of perturbation theory.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The development of basic perturbation theory for <a href="differential_equation" title="wikilink">differential equations</a> was fairly complete by the middle of the 19th century. It was at that time that <a href="Charles-Eug√®ne_Delaunay" title="wikilink">Charles-Eug√®ne Delaunay</a> was studying the perturbative expansion for the <a href="Earth-Moon-Sun_system" title="wikilink">Earth-Moon-Sun system</a>, and discovered the so-called "problem of small denominators". Here, the denominator appearing in the <em>n</em>-th term of the perturbative expansion could become arbitrarily small, causing the <em>n</em>-th correction to be as large or larger than the first-order correction. At the turn of the 20th¬†century, this problem led <a href="Henri_Poincar√©" title="wikilink">Henri Poincar√©</a> to make one of the first deductions of the existence of <a href="chaos_theory" title="wikilink">chaos</a>, or what is poetically called the "<a href="butterfly_effect" title="wikilink">butterfly effect</a>": that even a very small perturbation can ultimately have a very large effect on a system.</p>

<p>Perturbation theory saw a particularly dramatic expansion and evolution with the arrival of <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>. Although perturbation theory was used in the semi-classical theory of the <a href="Bohr_atom" title="wikilink">Bohr atom</a>, the calculations were monstrously complicated, and subject to somewhat ambiguous interpretation. The discovery of Heisenberg's <a href="matrix_mechanics" title="wikilink">matrix mechanics</a> allowed a vast simplification of the application of perturbation theory. Notable examples are the <a href="Stark_effect" title="wikilink">Stark effect</a> and the <a href="Zeeman_effect" title="wikilink">Zeeman effect</a>, which have a simple enough theory to be included in standard undergraduate textbooks in quantum mechanics. Other early applications include the <a href="fine_structure" title="wikilink">fine structure</a> and the <a href="hyperfine_structure" title="wikilink">hyperfine structure</a> in the <a href="hydrogen_atom" title="wikilink">hydrogen atom</a>.</p>

<p>In modern times, perturbation theory underlies much of <a href="quantum_chemistry" title="wikilink">quantum chemistry</a> and <a href="quantum_field_theory" title="wikilink">quantum field theory</a>. In chemistry, perturbation theory was used to obtain the first solutions for the <a href="helium_atom" title="wikilink">helium atom</a>.</p>

<p>In the middle of the 20th¬†century, <a href="Richard_Feynman" title="wikilink">Richard Feynman</a> realized that the perturbative expansion could be given a dramatic and beautiful graphical representation in terms of what are now called <a href="Feynman_diagrams" title="wikilink">Feynman diagrams</a>. Although originally applied only in <a href="quantum_field_theory" title="wikilink">quantum field theory</a>, such diagrams now find increasing use in any area where perturbative expansions are studied. </p>

<p>A partial resolution of the small-divisor problem was given by the statement of the <a href="KAM_theorem" title="wikilink">KAM theorem</a> in 1954. Developed by <a href="Andrey_Kolmogorov" title="wikilink">Andrey Kolmogorov</a>, <a href="Vladimir_Arnold" title="wikilink">Vladimir Arnold</a> and <a href="J√ºrgen_Moser" title="wikilink">J√ºrgen Moser</a>, this theorem stated the conditions under which a system of partial differential equations will have only mildly chaotic behaviour under small perturbations.</p>

<p>In the late 20th¬†century, broad dissatisfaction with perturbation theory in the quantum physics community, including not only the difficulty of going beyond second order in the expansion, but also questions about whether the perturbative expansion is even <a href="convergent_series" title="wikilink">convergent</a>, has led to a strong interest in the area of <a class="uri" href="non-perturbative" title="wikilink">non-perturbative</a> analysis, that is, the study of <a href="exactly_solvable_model" title="wikilink">exactly solvable models</a>. The prototypical model is the <a href="Korteweg‚Äìde_Vries_equation" title="wikilink">Korteweg‚Äìde Vries equation</a>, a highly non-linear equation for which the interesting solutions, the <a href="soliton" title="wikilink">solitons</a>, cannot be reached by perturbation theory, even if the perturbations were carried out to infinite order. Much of the theoretical work in non-perturbative analysis goes under the name of <a href="quantum_group" title="wikilink">quantum groups</a> and <a href="non-commutative_geometry" title="wikilink">non-commutative geometry</a>.</p>
<h2 id="perturbation-orders">Perturbation orders</h2>

<p>The standard exposition of perturbation theory is given in terms of the order to which the perturbation is carried out: <strong>first-order perturbation theory</strong> or <strong>second-order perturbation theory</strong>, and whether the perturbed states are degenerate (that is, <a href="singular_perturbation" title="wikilink">singular</a>), in which case extra care must be taken, and the theory is slightly more elaborate.</p>
<h2 id="first-order-non-singular-perturbation-theory">First-order non-singular perturbation theory</h2>

<p>This section develops, in simple terms,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> the general theory for the perturbative solution to a <a href="differential_equation" title="wikilink">differential equation</a> to the first order. To keep the exposition simple, a crucial assumption is made: that the solutions to the unperturbed system are not <em><a href="Degenerate_energy_levels" title="wikilink">degenerate</a></em>, so that the perturbation series can be inverted. There are ways of dealing with the degenerate (or <em><a href="singular_perturbation" title="wikilink">singular</a></em>) case; these require extra care.</p>

<p>Suppose one wants to solve a differential equation of the form</p>

<p>

<math display="block" id="Perturbation_theory:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>Œª</mi>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <ci>Œª</ci>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Dg(x)=\lambda g(x)~{},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Perturbation_theory:9">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 is some specific <a href="differential_operator" title="wikilink">differential operator</a>, and 

<math display="inline" id="Perturbation_theory:10">
 <semantics>
  <mi>Œª</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œª</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œª
  </annotation>
 </semantics>
</math>

 is an <a class="uri" href="eigenvalue" title="wikilink">eigenvalue</a>. Many problems involving ordinary or partial differential equations can be cast in this form.</p>

<p>It is presumed that the differential operator can be written in the form</p>

<p>

<math display="block" id="Perturbation_theory:11">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
    <mo>+</mo>
    <mrow>
     <mi>Œµ</mi>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=D^{(0)}+\varepsilon D^{(1)}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Perturbation_theory:12">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 is presumed to be small, and that, furthermore, the complete set of solutions for <mtpl></mtpl> are known.</p>

<p>That is, one has a set of solutions 

<math display="inline" id="Perturbation_theory:13">
 <semantics>
  <mrow>
   <msubsup>
    <mi>f</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(0)}_{n}(x)
  </annotation>
 </semantics>
</math>

, labelled by some arbitrary index 

<math display="inline" id="Perturbation_theory:14">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, such that</p>

<p>

<math display="block" id="Perturbation_theory:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>Œª</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œª</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{(0)}f^{(0)}_{n}(x)=\lambda^{(0)}_{n}f^{(0)}_{n}(x).
  </annotation>
 </semantics>
</math>

</p>

<p>Furthermore, one assumes that the set of solutions 

<math display="inline" id="Perturbation_theory:16">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <msubsup>
     <mi>f</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f^{(0)}_{n}(x)\}
  </annotation>
 </semantics>
</math>

 form an <a class="uri" href="orthonormal" title="wikilink">orthonormal</a> set,</p>

<p>

<math display="block" id="Perturbation_theory:17">
 <semantics>
  <mrow>
   <mrow>
    <mo largeop="true" symmetric="true">‚à´</mo>
    <mrow>
     <msubsup>
      <mi>f</mi>
      <mi>m</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>Œ¥</mi>
    <mrow>
     <mi>m</mi>
     <mi>n</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>m</ci>
      </apply>
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Œ¥</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int f^{(0)}_{m}(x)f^{(0)}_{n}(x)\,dx=\delta_{mn}
  </annotation>
 </semantics>
</math>

 with <mtpl></mtpl> the <a href="Kronecker_delta" title="wikilink">Kronecker delta</a> function.</p>

<p>To zeroth order, one expects that the solutions 

<math display="inline" id="Perturbation_theory:18">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)
  </annotation>
 </semantics>
</math>

 are then somehow "close" to one of the unperturbed solutions 

<math display="inline" id="Perturbation_theory:19">
 <semantics>
  <mrow>
   <msubsup>
    <mi>f</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(0)}_{n}(x)
  </annotation>
 </semantics>
</math>

. That is,</p>

<p>

<math display="block" id="Perturbation_theory:20">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ùí™</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Œµ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ùí™</ci>
      <ci>Œµ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=f^{(0)}_{n}(x)+\mathcal{O}(\varepsilon)
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Perturbation_theory:21">
 <semantics>
  <mrow>
   <mrow>
    <mi>Œª</mi>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>Œª</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">ùí™</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Œµ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œª</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œª</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ùí™</ci>
      <ci>Œµ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda=\lambda^{(0)}_{n}+\mathcal{O}(\varepsilon).
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Perturbation_theory:22">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ùí™</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùí™</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}
  </annotation>
 </semantics>
</math>

 denotes the relative size, in <a href="big-O_notation" title="wikilink">big-O notation</a>, of the perturbation.</p>

<p>To solve this problem, one assumes that the solution 

<math display="inline" id="Perturbation_theory:23">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)
  </annotation>
 </semantics>
</math>

 can be written as a linear combination of the 

<math display="inline" id="Perturbation_theory:24">
 <semantics>
  <mrow>
   <msubsup>
    <mi>f</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(0)}_{n}(x)
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Perturbation_theory:25">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mi>m</mi>
    </munder>
    <mrow>
     <msub>
      <mi>c</mi>
      <mi>m</mi>
     </msub>
     <msubsup>
      <mi>f</mi>
      <mi>m</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>m</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=\sum_{m}c_{m}f^{(0)}_{m}(x)
  </annotation>
 </semantics>
</math>

 with all of the constants 

<math display="inline" id="Perturbation_theory:26">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>m</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ùí™</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Œµ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <times></times>
     <ci>ùí™</ci>
     <ci>Œµ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{m}=\mathcal{O}(\varepsilon)
  </annotation>
 </semantics>
</math>

 except for 

<math display="inline" id="Perturbation_theory:27">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Perturbation_theory:28">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ùí™</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>ùí™</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=\mathcal{O}(1)
  </annotation>
 </semantics>
</math>

.</p>

<p>Substituting this last expansion into the differential equation, taking the inner product of the result with 

<math display="inline" id="Perturbation_theory:29">
 <semantics>
  <mrow>
   <msubsup>
    <mi>f</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(0)}_{n}(x)
  </annotation>
 </semantics>
</math>

, and making use of orthogonality, one obtains</p>

<p>

<math display="block" id="Perturbation_theory:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
      <msubsup>
       <mi>Œª</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>Œµ</mi>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mi>m</mi>
       </munder>
       <mrow>
        <msub>
         <mi>c</mi>
         <mi>m</mi>
        </msub>
        <mrow>
         <mo largeop="true" symmetric="true">‚à´</mo>
         <mrow>
          <msubsup>
           <mi>f</mi>
           <mi>n</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
          <msup>
           <mi>D</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msup>
          <msubsup>
           <mi>f</mi>
           <mi>m</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
           </mrow>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo rspace="4.2pt" stretchy="false">)</mo>
          </mrow>
          <mi>d</mi>
          <mi>x</mi>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>Œª</mi>
     <mpadded width="+3.3pt">
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Œª</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>m</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">0</cn>
           </apply>
           <ci>n</ci>
          </apply>
          <ci>x</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>D</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">0</cn>
           </apply>
           <ci>m</ci>
          </apply>
          <ci>x</ci>
          <ci>d</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>Œª</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}\lambda^{(0)}_{n}+\varepsilon\sum_{m}c_{m}\int f^{(0)}_{n}(x)D^{(1)}f^{(0%
)}_{m}(x)\,dx=\lambda c_{n}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>This can be trivially rewritten as a simple <a href="linear_algebra" title="wikilink">linear algebra</a> problem of finding the <a class="uri" href="eigenvalue" title="wikilink">eigenvalue</a> of a <a href="matrix_(mathematics)" title="wikilink">matrix</a>, where</p>

<p>

<math display="block" id="Perturbation_theory:31">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mi>m</mi>
    </munder>
    <mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi>n</mi>
       <mi>m</mi>
      </mrow>
     </msub>
     <msub>
      <mi>c</mi>
      <mi>m</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>Œª</mi>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>Œª</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{m}A_{nm}c_{m}=\lambda c_{n}
  </annotation>
 </semantics>
</math>

 where the matrix elements <mtpl></mtpl> are given by</p>

<p>

<math display="block" id="Perturbation_theory:32">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>n</mi>
      <mi>m</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>Œ¥</mi>
       <mrow>
        <mi>n</mi>
        <mi>m</mi>
       </mrow>
      </msub>
      <msubsup>
       <mi>Œª</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>Œµ</mi>
      <mrow>
       <mo largeop="true" symmetric="true">‚à´</mo>
       <mrow>
        <msubsup>
         <mi>f</mi>
         <mi>n</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <msup>
         <mi>D</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>1</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msup>
        <msubsup>
         <mi>f</mi>
         <mi>m</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mi>d</mi>
        <mpadded width="+3.3pt">
         <mi>x</mi>
        </mpadded>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>A</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œ¥</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Œª</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>m</ci>
        </apply>
        <ci>x</ci>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{nm}=\delta_{nm}\lambda^{(0)}_{n}+\varepsilon\int f^{(0)}_{n}(x)D^{(1)}f^{(0%
)}_{m}(x)\,dx~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Rather than solving this full matrix equation, one notes that, of all the <mtpl></mtpl> in the linear equation, only one, namely <mtpl></mtpl>, is not small. Thus, to the <em>first order</em> in 

<math display="inline" id="Perturbation_theory:33">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

, the linear equation may be solved trivially as</p>

<p>

<math display="block" id="Perturbation_theory:34">
 <semantics>
  <mrow>
   <mi>Œª</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>Œª</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>0</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mo>+</mo>
    <mrow>
     <mi>Œµ</mi>
     <mrow>
      <mo largeop="true" symmetric="true">‚à´</mo>
      <mrow>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>D</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œª</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œª</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>x</ci>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda=\lambda^{(0)}_{n}+\varepsilon\int f^{(0)}_{n}(x)D^{(1)}f^{(0)}_{n}(x)%
\,dx
  </annotation>
 </semantics>
</math>

 since all of the other terms in the linear equation are of order 

<math display="inline" id="Perturbation_theory:35">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>Œµ</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùí™</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Œµ</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(\varepsilon^{2})
  </annotation>
 </semantics>
</math>

. The above gives the solution of the eigenvalue to first order in perturbation theory.</p>

<p>The function 

<math display="inline" id="Perturbation_theory:36">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)
  </annotation>
 </semantics>
</math>

 to first order is obtained through similar reasoning. Substituting</p>

<p>

<math display="block" id="Perturbation_theory:37">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>Œµ</mi>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=f^{(0)}_{n}(x)+\varepsilon f^{(1)}_{n}(x)
  </annotation>
 </semantics>
</math>

 so that</p>

<p>

<math display="block" id="Perturbation_theory:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mi>D</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msup>
      <mo>+</mo>
      <mrow>
       <mi>Œµ</mi>
       <msup>
        <mi>D</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>Œµ</mi>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msubsup>
       <mi>Œª</mi>
       <mi>n</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mo>+</mo>
      <mrow>
       <mi>Œµ</mi>
       <msubsup>
        <mi>Œª</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>Œµ</mi>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <times></times>
       <ci>Œµ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>D</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>Œµ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Œª</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <ci>Œµ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Œª</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>Œµ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(D^{(0)}+\varepsilon D^{(1)}\right)\left(f^{(0)}_{n}(x)+\varepsilon f^{(1%
)}_{n}(x)\right)=\left(\lambda^{(0)}_{n}+\varepsilon\lambda^{(1)}_{n}\right)%
\left(f^{(0)}_{n}(x)+\varepsilon f^{(1)}_{n}(x)\right)
  </annotation>
 </semantics>
</math>

 gives an equation for 

<math display="inline" id="Perturbation_theory:39">
 <semantics>
  <mrow>
   <msubsup>
    <mi>f</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(1)}_{n}(x)
  </annotation>
 </semantics>
</math>

.</p>

<p>It may be solved integrating with the <a href="partition_of_unity" title="wikilink">partition of unity</a></p>

<p>

<math display="block" id="Perturbation_theory:40">
 <semantics>
  <mrow>
   <mrow>
    <mi>Œ¥</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mi>y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mi>n</mi>
    </munder>
    <mrow>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi>f</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Œ¥</ci>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>x</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta(x-y)=\sum_{n}f^{(0)}_{n}(x)f^{(0)}_{n}(y)
  </annotation>
 </semantics>
</math>

 to give</p>

<p>

<math display="block" id="Perturbation_theory:41">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>f</mi>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>m</mi>
      </mpadded>
      <mspace width="veryverythickmathspace">
      </mspace>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi></mi>
        <mo>‚â†</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <mrow>
       <msubsup>
        <mi>f</mi>
        <mi>m</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <msubsup>
        <mi>Œª</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mo>-</mo>
       <msubsup>
        <mi>Œª</mi>
        <mi>m</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">‚à´</mo>
      <mrow>
       <msubsup>
        <mi>f</mi>
        <mi>m</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>D</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msup>
       <msubsup>
        <mi>f</mi>
        <mi>n</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </msubsup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <csymbol cd="latexml">annotated</csymbol>
       <ci>m</ci>
       <apply>
        <neq></neq>
        <csymbol cd="latexml">absent</csymbol>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>m</ci>
        </apply>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Œª</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Œª</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>m</ci>
        </apply>
        <ci>y</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>f</ci>
          <cn type="integer">0</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>y</ci>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(1)}_{n}(x)=\sum_{m\,(\neq n)}\frac{f^{(0)}_{m}(x)}{\lambda^{(0)}_{n}-%
\lambda^{(0)}_{m}}\int f^{(0)}_{m}(y)D^{(1)}f^{(0)}_{n}(y)\,dy
  </annotation>
 </semantics>
</math>

 which finally gives the exact solution to the perturbed differential equation to first order in the perturbation 

<math display="inline" id="Perturbation_theory:42">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

.</p>

<p>Several observations may be made about the form of this solution. First, the sum over functions with differences of eigenvalues in the denominator evokes the <a href="Resolvent_formalism" title="wikilink">resolvent</a> in <a href="Fredholm_theory" title="wikilink">Fredholm theory</a>. This is no accident; the resolvent acts essentially as a kind of <a href="Green's_function" title="wikilink">Green's function</a> or <a class="uri" href="propagator" title="wikilink">propagator</a>, passing the perturbation along. Higher-order perturbations resemble this form, with an additional sum over a resolvent appearing at each order.</p>

<p>The form of this solution also illustrates the idea behind the small-divisor problem. If, for whatever reason, two eigenvalues are close, so that the difference 

<math display="inline" id="Perturbation_theory:43">
 <semantics>
  <mrow>
   <msubsup>
    <mi>Œª</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>-</mo>
   <msubsup>
    <mi>Œª</mi>
    <mi>m</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Œª</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Œª</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda^{(0)}_{n}-\lambda^{(0)}_{m}
  </annotation>
 </semantics>
</math>

 becomes small, the corresponding term in the above sum will become disproportionately large. In particular, if this happens in higher-order terms, the higher-order perturbation may become as large or larger in magnitude than the first-order perturbation. Such a situation calls into question the validity of utilizing a perturbative analysis to begin with, which can be understood to be a fairly catastrophic situation; it is frequently encountered in <a href="chaos_theory" title="wikilink">chaotic dynamical systems</a>, and requires the development of techniques other than perturbation theory to solve the problem.</p>

<p>Curiously, the situation is not at all bad if two or more eigenvalues are <em>exactly equal</em>. This case is referred to as <a href="singular_perturbation" title="wikilink">singular</a> or degenerate perturbation theory, addressed below. The <a href="Degenerate_energy_levels" title="wikilink">degeneracy</a> of eigenvalues indicates that the unperturbed system has some sort of <a href="symmetry_(physics)" title="wikilink">symmetry</a>, and that the generators of that symmetry commute with the unperturbed differential operator. Typically, the perturbing term does not possess the symmetry, and so the full solutions do not, either; one says that the perturbation <em>lifts</em> or <em>breaks</em> the degeneracy. In this case, the perturbation can still be performed, as in following sections; however, care must be taken to work in a basis for the unperturbed states, so that these map one-to-one to the perturbed states, rather than being a mixture.</p>
<h2 id="perturbation-theory-of-degenerate-states">Perturbation theory of degenerate states</h2>

<p>One may note that a problem occurs in the above first order perturbation theory when two or more eigenfunctions of the unperturbed system correspond to the same eigenvalue, i.e. when the eigenvalue equation becomes</p>

<p>

<math display="block" id="Perturbation_theory:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>D</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msup>
     <msubsup>
      <mi>f</mi>
      <mrow>
       <mi>n</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>Œª</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <msubsup>
      <mi>f</mi>
      <mrow>
       <mi>n</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="5.8pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </apply>
      <list>
       <ci>n</ci>
       <ci>i</ci>
      </list>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œª</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </apply>
      <list>
       <ci>n</ci>
       <ci>i</ci>
      </list>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{(0)}f^{(0)}_{n,i}(x)=\lambda^{(0)}_{n}f^{(0)}_{n,i}(x)~{},
  </annotation>
 </semantics>
</math>

 and the index 

<math display="inline" id="Perturbation_theory:45">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 labels <em>several states with the same eigenvalue</em> 

<math display="inline" id="Perturbation_theory:46">
 <semantics>
  <msubsup>
   <mi>Œª</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Œª</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda^{(0)}_{n}
  </annotation>
 </semantics>
</math>

. The expression for the eigenfunctions which has energy differences in the denominators becomes infinite. In that case, degenerate perturbation theory must be applied.</p>

<p>The degeneracy must first be removed for higher order perturbation theory. First, consider the eigenfunction which is a linear combination of eigenfunctions with the same eigenvalue only,</p>

<p>

<math display="block" id="Perturbation_theory:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mi>k</mi>
     </munder>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <msubsup>
       <mi>f</mi>
       <mrow>
        <mi>n</mi>
        <mo>,</mo>
        <mi>k</mi>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <list>
        <ci>n</ci>
        <ci>k</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </apply>
       <list>
        <ci>n</ci>
        <ci>k</ci>
       </list>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(x)=\sum_{k}c_{n,k}f^{(0)}_{n,k}(x)~{},
  </annotation>
 </semantics>
</math>

 which, again from the orthogonality of 

<math display="inline" id="Perturbation_theory:48">
 <semantics>
  <msubsup>
   <mi>f</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
    <list>
     <ci>n</ci>
     <ci>k</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{(0)}_{n,k}
  </annotation>
 </semantics>
</math>

, leads to the following equation,</p>

<p>

<math display="block" id="Perturbation_theory:49">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>c</mi>
      <mrow>
       <mi>n</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <msubsup>
      <mi>Œª</mi>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>Œµ</mi>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <msub>
        <mi>c</mi>
        <mrow>
         <mi>n</mi>
         <mo>,</mo>
         <mi>k</mi>
        </mrow>
       </msub>
       <mrow>
        <mo largeop="true" symmetric="true">‚à´</mo>
        <mrow>
         <msubsup>
          <mi>f</mi>
          <mrow>
           <mi>n</mi>
           <mo>,</mo>
           <mi>i</mi>
          </mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>0</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </msubsup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <msup>
          <mi>D</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>1</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </msup>
         <msubsup>
          <mi>f</mi>
          <mrow>
           <mi>n</mi>
           <mo>,</mo>
           <mi>k</mi>
          </mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mn>0</mn>
           <mo stretchy="false">)</mo>
          </mrow>
         </msubsup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo rspace="4.2pt" stretchy="false">)</mo>
         </mrow>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>Œª</mi>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <list>
        <ci>n</ci>
        <ci>i</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Œª</ci>
        <cn type="integer">0</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <list>
          <ci>n</ci>
          <ci>k</ci>
         </list>
        </apply>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">0</cn>
           </apply>
           <list>
            <ci>n</ci>
            <ci>i</ci>
           </list>
          </apply>
          <ci>x</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>D</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>f</ci>
            <cn type="integer">0</cn>
           </apply>
           <list>
            <ci>n</ci>
            <ci>k</ci>
           </list>
          </apply>
          <ci>x</ci>
          <ci>d</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>Œª</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <list>
       <ci>n</ci>
       <ci>i</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n,i}\lambda^{(0)}_{n}+\varepsilon\sum_{k}c_{n,k}\int f^{(0)}_{n,i}(x)D^{(1)%
}f^{(0)}_{n,k}(x)\,dx=\lambda c_{n,i}
  </annotation>
 </semantics>
</math>

 for each 

<math display="inline" id="Perturbation_theory:50">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

.</p>

<p>As for the majority of low quantum numbers 

<math display="inline" id="Perturbation_theory:51">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Perturbation_theory:52">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 changes over a <em>small range of integers</em>, so often the later equation can be solved analytically as an at most 

<math display="inline" id="Perturbation_theory:53">
 <semantics>
  <mrow>
   <mn>4</mn>
   <mi mathvariant="normal">√ó</mi>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">4</cn>
    <ci>normal-√ó</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4√ó4
  </annotation>
 </semantics>
</math>

 matrix equation. Once the degeneracy is removed, the first and any order of the above perturbation theory may be further applied relying on the new eigenfunctions.</p>
<h2 id="example-of-second-order-singular-perturbation-theory">Example of second-order singular perturbation theory</h2>

<p>Consider the following equation for the unknown variable 

<math display="inline" id="Perturbation_theory:54">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Perturbation_theory:55">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <mi>Œµ</mi>
      <msup>
       <mi>x</mi>
       <mn>5</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=1+\varepsilon x^{5}.
  </annotation>
 </semantics>
</math>

</p>

<p>For the initial problem with 

<math display="inline" id="Perturbation_theory:56">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œµ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ=0
  </annotation>
 </semantics>
</math>

, the solution is <mtpl> 1}}</mtpl>. For small 

<math display="inline" id="Perturbation_theory:57">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 the lowest-order approximation may be found by inserting the <a class="uri" href="ansatz" title="wikilink">ansatz</a></p>

<p>

<math display="block" id="Perturbation_theory:58">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>Œµ</mi>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">‚ãØ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-‚ãØ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=x_{0}+\varepsilon x_{1}+\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>into the equation and demanding the equation to be fulfilled up to terms that involve powers of 

<math display="inline" id="Perturbation_theory:59">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 higher than the first. This yields <mtpl> 1}}</mtpl>. In the same way, the higher orders may be found. However, even in this simple example it may be observed that for (arbitrarily) small positive 

<math display="inline" id="Perturbation_theory:60">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 there are four other solutions to the equation (with very large magnitude). The reason we don't find these solutions in the above perturbation method is because these solutions diverge when 

<math display="inline" id="Perturbation_theory:61">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mi mathvariant="normal">‚Üí</mi>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Œµ</ci>
    <ci>normal-‚Üí</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ‚Üí0
  </annotation>
 </semantics>
</math>

 while the ansatz assumes regular behavior in this limit.</p>

<p>The four additional solutions can be found using the methods of <strong><a href="singular_perturbation" title="wikilink">singular perturbation</a> theory</strong>. In this case this works as follows. Since the four solutions diverge at 

<math display="inline" id="Perturbation_theory:62">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œµ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ=0
  </annotation>
 </semantics>
</math>

, it makes sense to rescale 

<math display="inline" id="Perturbation_theory:63">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. We put</p>

<p>

<math display="block" id="Perturbation_theory:64">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>y</mi>
    <msup>
     <mi>Œµ</mi>
     <mrow>
      <mo>-</mo>
      <mi>ŒΩ</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>y</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Œµ</ci>
      <apply>
       <minus></minus>
       <ci>ŒΩ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=y\varepsilon^{-\nu}
  </annotation>
 </semantics>
</math>

</p>

<p>such that in terms of 

<math display="inline" id="Perturbation_theory:65">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 the solutions stay finite. This means that we need to choose the exponent 

<math display="inline" id="Perturbation_theory:66">
 <semantics>
  <mi>ŒΩ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ŒΩ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ŒΩ
  </annotation>
 </semantics>
</math>

 to match the rate at which the solutions diverge. In terms of 

<math display="inline" id="Perturbation_theory:67">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 the equation reads:</p>

<p>

<math display="block" id="Perturbation_theory:68">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>Œµ</mi>
     <mrow>
      <mo>-</mo>
      <mi>ŒΩ</mi>
     </mrow>
    </msup>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>Œµ</mi>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mn>5</mn>
        <mi>ŒΩ</mi>
       </mrow>
      </mrow>
     </msup>
     <msup>
      <mi>y</mi>
      <mn>5</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Œµ</ci>
      <apply>
       <minus></minus>
       <ci>ŒΩ</ci>
      </apply>
     </apply>
     <ci>y</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œµ</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">5</cn>
         <ci>ŒΩ</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">5</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon^{-\nu}y=1+\varepsilon^{1-5\nu}y^{5}
  </annotation>
 </semantics>
</math>

</p>

<p>The 'right' value for 

<math display="inline" id="Perturbation_theory:69">
 <semantics>
  <mi>ŒΩ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ŒΩ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ŒΩ
  </annotation>
 </semantics>
</math>

 is obtained when the exponent of 

<math display="inline" id="Perturbation_theory:70">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 in the prefactor of the term proportional to 

<math display="inline" id="Perturbation_theory:71">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 is equal to the exponent of 

<math display="inline" id="Perturbation_theory:72">
 <semantics>
  <mi>Œµ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œµ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ
  </annotation>
 </semantics>
</math>

 in the prefactor of the term proportional to <mtpl></mtpl>, i.e. when 

<math display="inline" id="Perturbation_theory:73">
 <semantics>
  <mrow>
   <mi>ŒΩ</mi>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mn>4</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ŒΩ</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ŒΩ=\frac{1}{4}
  </annotation>
 </semantics>
</math>

. This is called 'significant degeneration'. If we choose 

<math display="inline" id="Perturbation_theory:74">
 <semantics>
  <mi>ŒΩ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ŒΩ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ŒΩ
  </annotation>
 </semantics>
</math>

 larger, then the four solutions will collapse to zero in terms of 

<math display="inline" id="Perturbation_theory:75">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 and they will become degenerate with the solution we found above. If we choose 

<math display="inline" id="Perturbation_theory:76">
 <semantics>
  <mi>ŒΩ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ŒΩ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ŒΩ
  </annotation>
 </semantics>
</math>

 smaller, then the four solutions will still diverge to infinity.</p>

<p>Putting 

<math display="inline" id="Perturbation_theory:77">
 <semantics>
  <mrow>
   <mi>ŒΩ</mi>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mn>4</mn>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ŒΩ</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ŒΩ=\frac{1}{4}
  </annotation>
 </semantics>
</math>

 in the above equation yields:</p>

<p>

<math display="block" id="Perturbation_theory:78">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>Œµ</mi>
     <mfrac>
      <mn>1</mn>
      <mn>4</mn>
     </mfrac>
    </msup>
    <mo>+</mo>
    <msup>
     <mi>y</mi>
     <mn>5</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Œµ</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <cn type="integer">5</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\varepsilon^{\frac{1}{4}}+y^{5}
  </annotation>
 </semantics>
</math>

</p>

<p>This equation can be solved using ordinary perturbation theory in the same way as regular expansion for 

<math display="inline" id="Perturbation_theory:79">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 was obtained. Since the expansion parameter is now <mtpl></mtpl> we put:</p>

<p>

<math display="block" id="Perturbation_theory:80">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>Œµ</mi>
      <mfrac>
       <mn>1</mn>
       <mn>4</mn>
      </mfrac>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>Œµ</mi>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </msup>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">‚ãØ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œµ</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œµ</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-‚ãØ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=y_{0}+\varepsilon^{\frac{1}{4}}y_{1}+\varepsilon^{\frac{1}{2}}y_{2}+\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>There are five solutions for  We must disregard the solution 

<math display="inline" id="Perturbation_theory:81">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=0
  </annotation>
 </semantics>
</math>

 since it corresponds to the original regular solution which appears to be at zero for 

<math display="inline" id="Perturbation_theory:82">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Œµ</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ=0
  </annotation>
 </semantics>
</math>

, because in the limit 

<math display="inline" id="Perturbation_theory:83">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mi mathvariant="normal">‚Üí</mi>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Œµ</ci>
    <ci>normal-‚Üí</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµ‚Üí0
  </annotation>
 </semantics>
</math>

 we are rescaling by an infinite amount. The next term is <mtpl> ‚àí‚Äâ}}</mtpl>. In terms of 

<math display="inline" id="Perturbation_theory:84">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 the four solutions are thus given as:</p>

<p>

<math display="inline" id="Perturbation_theory:85">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>Œµ</mi>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>4</mn>
      </mfrac>
     </mrow>
    </msup>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>0</mn>
       </msub>
       <mo>-</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>4</mn>
        </mfrac>
        <msup>
         <mi>Œµ</mi>
         <mfrac>
          <mn>1</mn>
          <mn>4</mn>
         </mfrac>
        </msup>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">‚ãØ</mi>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Œµ</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>Œµ</ci>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <cn type="integer">4</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <ci>normal-‚ãØ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\varepsilon^{-\frac{1}{4}}\left[y_{0}-\tfrac{1}{4}\varepsilon^{\frac{1}{4}}+%
\cdots\right]
  </annotation>
 </semantics>
</math>

</p>
<h2 id="example-of-degenerate-perturbation-theory-stark-effect-in-resonant-rotating-wave">Example of degenerate perturbation theory ‚Äì Stark effect in resonant rotating wave</h2>

<p>Let us consider a hydrogen atom rotating with a constant angular frequency 

<math display="inline" id="Perturbation_theory:86">
 <semantics>
  <mi>œâ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>œâ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   œâ
  </annotation>
 </semantics>
</math>

 in an electric field. The Hamiltonian is given by:</p>

<p>

<math display="block" id="Perturbation_theory:87">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>Œµ</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>Œµ</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=H_{0}+\varepsilon x
  </annotation>
 </semantics>
</math>

</p>

<p>where the unperturbed Hamiltonian is</p>

<p>

<math display="block" id="Perturbation_theory:88">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <msup>
        <mi>ùê©</mi>
        <mn>2</mn>
       </msup>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mo>-</mo>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mi>r</mi>
      </mfrac>
     </mstyle>
     <mo>-</mo>
     <mrow>
      <mi>œâ</mi>
      <msub>
       <mi>L</mi>
       <mi>z</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ùê©</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <ci>œâ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}=\tfrac{\mathbf{p}^{2}}{2}-\tfrac{1}{r}-\omega L_{z},
  </annotation>
 </semantics>
</math>

</p>

<p>and <mtpl></mtpl> is the operator for the 

<math display="inline" id="Perturbation_theory:89">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

-component of angular momentum: <mtpl> <em>i</em>.}}</mtpl> The perturbation 

<math display="inline" id="Perturbation_theory:90">
 <semantics>
  <mrow>
   <mi>Œµ</mi>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>Œµ</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Œµx
  </annotation>
 </semantics>
</math>

 can be seen as the strength of the applied electric field multiplied by one of the space coordinates (This calculation is in <a href="atomic_units" title="wikilink">atomic units</a>, so that every quantity is dimensionless).</p>

<p>The eigenvalues of <mtpl></mtpl> are</p>

<p>

<math display="block" id="Perturbation_theory:91">
 <semantics>
  <mrow>
   <msub>
    <mi>E</mi>
    <mrow>
     <mi>n</mi>
     <mo>,</mo>
     <mi>m</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>m</mi>
     <mi>œâ</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <list>
      <ci>n</ci>
      <ci>m</ci>
     </list>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>œâ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{n,m}=-\tfrac{1}{2}n^{2}-m\omega
  </annotation>
 </semantics>
</math>

</p>

<p>For the lowest energy eigenstates of Hydrogen 

<math display="inline" id="Perturbation_theory:92">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true">|</mo>
    <mrow>
     <mi>n</mi>
     <mo>,</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>m</mi>
    </mrow>
    <mo>‚ü©</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo fence="true">|</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
    <mo>‚ü©</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <list>
      <ci>n</ci>
      <ci>l</ci>
      <ci>m</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </list>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|n,l,m\right\rangle,\left|1,0,0\right\rangle
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Perturbation_theory:93">
 <semantics>
  <mrow>
   <mo fence="true">|</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1</mn>
   </mrow>
   <mo>‚ü©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <list>
     <cn type="integer">2</cn>
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|2,1,1\right\rangle
  </annotation>
 </semantics>
</math>

 in the resonance <mtpl> 0}}</mtpl> their energies are therefore equal <mtpl> <em>E</em><sub>2,1</sub> {{=}} ‚àí‚Äâ,}}</mtpl> while the eigenstates are different.</p>

<p>The eigenvalue equation for the Hamiltonian takes the form</p>

<p>

<math display="block" id="Perturbation_theory:94">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>E</mi>
         <mrow>
          <mn>1</mn>
          <mo>,</mo>
          <mn>0</mn>
         </mrow>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>Œµ</mi>
         <mi>d</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>Œµ</mi>
         <mi>d</mi>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>E</mi>
         <mrow>
          <mn>1</mn>
          <mo>,</mo>
          <mn>0</mn>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <list>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </list>
       </apply>
       <apply>
        <times></times>
        <ci>Œµ</ci>
        <ci>d</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <times></times>
        <ci>Œµ</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <list>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </list>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <ci>a</ci>
      </matrixrow>
      <matrixrow>
       <ci>b</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <matrix>
      <matrixrow>
       <ci>a</ci>
      </matrixrow>
      <matrixrow>
       <ci>b</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{bmatrix}E_{1,0}&{\varepsilon}d\\
{\varepsilon}d&E_{1,0}\end{bmatrix}\begin{bmatrix}a\\
b\end{bmatrix}=E\begin{bmatrix}a\\
b\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>

<p>

<math display="block" id="Perturbation_theory:95">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <mrow>
    <mstyle displaystyle="false">
     <mfrac>
      <mn>128</mn>
      <mn>243</mn>
     </mfrac>
    </mstyle>
    <msub>
     <mi>a</mi>
     <mn>0</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">128</cn>
      <cn type="integer">243</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=\tfrac{128}{243}a_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>which leads to the quadratic equation which can be readily solved</p>

<p>

<math display="block" id="Perturbation_theory:96">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>E</mi>
        <mrow>
         <mn>1</mn>
         <mo>,</mo>
         <mn>0</mn>
        </mrow>
       </msub>
       <mo>-</mo>
       <mi>E</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
     <msup>
      <mi>Œµ</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <list>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </list>
       </apply>
       <ci>E</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Œµ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(E_{1,0}-E\right)^{2}-d^{2}\varepsilon^{2}=0
  </annotation>
 </semantics>
</math>

</p>

<p>with the solution</p>

<p>

<math display="inline" id="Perturbation_theory:97">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mi>œá</mi>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">‚ü©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>œá</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle|\chi 1\rangle
  </annotation>
 </semantics>
</math>


</p>

<p>These states are the Stark states in the rotating frame, they are Trojan (higher eigenvalue) and anti-Trojan wavepackets.</p>
<h2 id="commentary">Commentary</h2>

<p>Both regular and singular perturbation theory are frequently used in physics and engineering. Regular perturbation theory may only be used to find those solutions of a problem that evolve smoothly out of the initial solution when changing the parameter (that are "<a href="adiabatic" title="wikilink">adiabatically</a> connected" to the initial solution). A well-known example from physics where regular perturbation theory fails is in fluid dynamics when one treats the viscosity as a small parameter. Close to a boundary, the fluid velocity goes to zero, even for very small viscosity (the <a href="no-slip_condition" title="wikilink">no-slip condition</a>). For zero viscosity, it is not possible to impose this boundary condition and a regular perturbative expansion amounts to an expansion about an unrealistic physical solution. Singular perturbation theory can, however, be applied here and this amounts to 'zooming in' at the boundaries (using the <a href="method_of_matched_asymptotic_expansions" title="wikilink">method of matched asymptotic expansions</a>).</p>

<p>Perturbation theory can fail when the system can transition to a different "phase" of matter, with a qualitatively different behaviour, that cannot be modelled by the physical formulas put into the perturbation theory (e.g., a solid crystal melting into a liquid). In some cases, this failure manifests itself by divergent behavior of the perturbation series. Such divergent series can sometimes be resummed using techniques such as <a href="Borel_summation" title="wikilink">Borel resummation</a>.</p>

<p>Perturbation techniques can be also used to find approximate solutions to non-linear differential equations. Examples of techniques used to find approximate solutions to these types of problems are the <a href="Lindstedt‚ÄìPoincar√©_technique" title="wikilink">Lindstedt‚ÄìPoincar√© technique</a> and the <a href="method_of_multiple_time_scales" title="wikilink">method of multiple time scales</a>.</p>

<p>There is absolutely no guarantee that perturbative methods result in a convergent solution. In fact, <a href="asymptotic_series" title="wikilink">asymptotic series</a> are the norm.</p>
<h2 id="perturbation-theory-in-chemistry">Perturbation theory in chemistry</h2>

<p>Many of the <a href="ab_initio_quantum_chemistry_methods" title="wikilink">ab initio quantum chemistry methods</a> use perturbation theory directly or are closely related methods. Implicit perturbation theory<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> works with the complete Hamiltonian from the very beginning and never specifies a perturbation operator as such. <a href="M√∏ller‚ÄìPlesset_perturbation_theory" title="wikilink">M√∏ller‚ÄìPlesset perturbation theory</a> uses the difference between the <a class="uri" href="Hartree‚ÄìFock" title="wikilink">Hartree‚ÄìFock</a> Hamiltonian and the exact non-relativistic Hamiltonian as the perturbation. The zero-order energy is the sum of orbital energies. The first-order energy is the Hartree‚ÄìFock energy and electron correlation is included at second-order or higher. Calculations to second, third or fourth order are very common and the code is included in most <a href="Computational_chemistry#Software_packages" title="wikilink">ab initio quantum chemistry programs</a>. A related but more accurate method is the <a href="coupled_cluster" title="wikilink">coupled cluster</a> method.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Cosmological_perturbation_theory" title="wikilink">Cosmological perturbation theory</a></li>
<li><a href="Dynamic_nuclear_polarisation" title="wikilink">Dynamic nuclear polarisation</a></li>
<li>Alternative approach to perturbation theory<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></li>
<li><a href="Eigenvalue_perturbation" title="wikilink">Eigenvalue perturbation</a></li>
<li><a href="Interval_FEM" title="wikilink">Interval FEM</a></li>
<li><a href="Orders_of_approximation" title="wikilink">Orders of approximation</a></li>
<li><a href="Structural_stability" title="wikilink">Structural stability</a></li>
<li><a href="Lyapunov_stability" title="wikilink">Lyapunov stability</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.cims.nyu.edu/~eve2/reg_pert.pdf">Introduction to regular perturbation theory</a> by <a href="Eric_Vanden-Eijnden" title="wikilink">Eric Vanden-Eijnden</a> (PDF)</li>
<li><a href="http://www.scholarpedia.org/article/Multiple_Scale_Analysis">Perturbation Method of Multiple Scales</a></li>
</ul>

<p>"</p>

<p><a href="Category:Perturbation_theory" title="wikilink"> </a> <a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a> <a href="Category:Functional_analysis" title="wikilink">Category:Functional analysis</a> <a href="Category:Ordinary_differential_equations" title="wikilink">Category:Ordinary differential equations</a> <a href="Category:Mathematical_physics" title="wikilink">Category:Mathematical physics</a> <a href="Category:Computational_chemistry" title="wikilink">Category:Computational chemistry</a> <a href="Category:Asymptotic_analysis" title="wikilink">Category:Asymptotic analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2">.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3">Perturbation theory. N. N. Bogolyubov, jr. (originator), Encyclopedia of Mathematics. URL: <a class="uri" href="http://www.encyclopediaofmath.org/index.php?title=Perturbation_theory&amp;oldid">http://www.encyclopediaofmath.org/index.php?title=Perturbation_theory&amp;oldid;</a>;=11676<a href="#fnref3">‚Ü©</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6">*Sakurai, J.J., and Napolitano, J. (1964,2011). <em>Modern quantum mechanics</em> (2nd ed.), Addison Wesley ISBN 978-0-8053-8291-4 . Chapter 5<a href="#fnref6">‚Ü©</a></li>
<li id="fn7"><a href="#fnref7">‚Ü©</a></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

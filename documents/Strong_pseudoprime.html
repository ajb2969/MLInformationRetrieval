<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1668">Strong pseudoprime</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Strong pseudoprime</h1>
<hr/>

<p>In <a href="number_theory" title="wikilink">number theory</a>, a <a href="probable_prime" title="wikilink">probable prime</a> is a number that passes a <a href="primality_test" title="wikilink">primality test</a>. A <strong>strong probable prime</strong> is a number that passes a <em>strong</em> version of a primality test. A <strong>strong pseudoprime</strong> is a <a href="composite_number" title="wikilink">composite number</a> that passes a strong version of a primality test. All primes pass these tests, but a small fraction of composites also pass, making them "<a href="pseudoprime" title="wikilink">false primes</a>".</p>

<p>Unlike the <a href="Fermat_pseudoprime" title="wikilink">Fermat pseudoprimes</a>, for which there exist numbers that are <a class="uri" href="pseudoprimes" title="wikilink">pseudoprimes</a> to all <a class="uri" href="coprime" title="wikilink">coprime</a> bases (the <a href="Carmichael_numbers" title="wikilink">Carmichael numbers</a>), there are no composites that are strong pseudoprimes to all bases.</p>
<h2 id="formal-definition">Formal definition</h2>

<p>Formally, a composite number <em>n</em> = <em>d</em> · 2<sup><em>s</em></sup> + 1 with <em>d</em> being odd is called a strong (Fermat) pseudoprime to a <a href="relatively_prime" title="wikilink">relatively prime</a> base <em>a</em> when one of the following conditions holds:</p>

<p>

<math display="block" id="Strong_pseudoprime:0">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mi>d</mi>
   </msup>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <ci>d</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{d}\equiv 1\mod n
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="block" id="Strong_pseudoprime:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>a</mi>
      <mrow>
       <mi>d</mi>
       <mo>⋅</mo>
       <msup>
        <mn>2</mn>
        <mi>r</mi>
       </msup>
      </mrow>
     </msup>
     <mo>≡</mo>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
      <mi>n</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mtext>for some</mtext>
      <mn>0</mn>
     </mrow>
     <mo>≤</mo>
     <mi>r</mi>
     <mo><</mo>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <apply>
       <ci>normal-⋅</ci>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">modulo</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <apply>
       <times></times>
       <mtext>for some</mtext>
       <cn type="integer">0</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <lt></lt>
      <share href="#.cmml">
      </share>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{d\cdot 2^{r}}\equiv-1\mod n\quad\mbox{ for some }0\leq r<s.
  </annotation>
 </semantics>
</math>

</p>

<p>(If a number <em>n</em> satisfies one of the above conditions and we don't yet know whether it is prime, it is more precise to refer to it as a strong <a href="probable_prime" title="wikilink">probable prime</a> to base <em>a</em>. But if we know that <em>n</em> is not prime, then one may use the term strong pseudoprime.)</p>

<p>The definition of a strong pseudoprime depends on the base used; different bases have different strong pseudoprimes. The definition is trivially met if <mtpl></mtpl> so these trivial bases are often excluded.</p>

<p><a href="Richard_K._Guy" title="wikilink">Guy</a> mistakenly gives a definition with only the first condition, which is not satisfied by all primes.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="properties-of-strong-pseudoprimes">Properties of strong pseudoprimes</h2>

<p>A strong pseudoprime to base <em>a</em> is always an <a href="Euler-Jacobi_pseudoprime" title="wikilink">Euler-Jacobi pseudoprime</a>, an <a href="Euler_pseudoprime" title="wikilink">Euler pseudoprime</a> <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and a <a href="Fermat_pseudoprime" title="wikilink">Fermat pseudoprime</a> to that base, but not all Euler and Fermat pseudoprimes are strong pseudoprimes. <a href="Carmichael_number" title="wikilink">Carmichael numbers</a> may be strong pseudoprimes to some bases—for example, 561 is a strong pseudoprime to base 50—but not to all bases.</p>

<p>A composite number <em>n</em> is a strong pseudoprime to at most one quarter of all bases below <em>n</em>;<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> thus, there are no "strong Carmichael numbers", numbers that are strong pseudoprimes to all bases. Thus given a random base, the probability that a number is a strong pseudoprime to that base is less than 1/4, forming the basis of the widely used <a href="Miller-Rabin_primality_test" title="wikilink">Miller-Rabin primality test</a>. However, Arnault <a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> gives a 397-digit composite number that is a strong pseudoprime to <em>every</em> base less than 307. One way to prevent such a number from wrongfully being declared probably prime is to combine a strong probable prime test with a <a href="Lucas_pseudoprime" title="wikilink">Lucas probable prime</a> test, as in the <a href="Baillie-PSW_primality_test" title="wikilink">Baillie-PSW primality test</a>.</p>

<p>There are infinitely many strong pseudoprimes to any base.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="examples">Examples</h2>

<p>The first strong pseudoprimes to base 2 are</p>
<dl>
<dd>2047, 3277, 4033, 4681, 8321, 15841, 29341, 42799, 49141, 52633, 65281, 74665, 80581, 85489, 88357, 90751, ... .
</dd>
</dl>

<p>The first to base 3 are</p>
<dl>
<dd>121, 703, 1891, 3281, 8401, 8911, 10585, 12403, 16531, 18721, 19345, 23521, 31621, 44287, 47197, 55969, 63139, 74593, 79003, 82513, 87913, 88573, 97567, ... .
</dd>
</dl>

<p>The first to base 5 are</p>
<dl>
<dd>781, 1541, 5461, 5611, 7813, 13021, 14981, 15751, 24211, 25351, 29539, 38081, 40501, 44801, 53971, 79381, ... .
</dd>
</dl>

<p>For base 4, see , and for base 6 to 100, see  to .</p>

<p>By testing the above conditions to several bases, one gets somewhat more powerful primality tests than by using one base alone. For example, there are only 13 numbers less than 25·10<sup>9</sup> that are strong pseudoprimes to bases 2, 3, and 5 simultaneously. They are listed in Table 7 of.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> The smallest such number is 25326001. This means that, if <em>n</em> is less than 25326001 and <em>n</em> is a strong probable prime to bases 2, 3, and 5, then <em>n</em> is prime.</p>

<p>Carrying this further, 3825123056546413051 is the smallest number that is a strong pseudoprime to the 9 bases 2, 3, 5, 7, 11, 13, 17, 19, and 23.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> <a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> So, if <em>n</em> is less than 3825123056546413051 and <em>n</em> is a strong probable prime to these 9 bases, then <em>n</em> is prime.</p>

<p>By removing the restriction of using the first <em>n</em> prime bases, even better tests can be constructed, requiring at most 7 bases to conclusively test all 64-bit inputs.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>Looking at the first strong pseudoprime to increasing single bases, we find the following least strong pseudoprime to bases 2 to 100:</p>
<dl>
<dd>2047, 121, 341, 781, 217, 25, 9, 91, 9, 133, 91, 85, 15, 1687, 15, 9, 25, 9, 21, 221, 21, 169, 25, 217, 9, 121, 9, 15, 49, 15, 25, 545, 33, 9, 35, 9, 39, 133, 39, 21, 451, 21, 9, 481, 9, 65, 49, 25, 49, 25, 51, 9, 55, 9, 55, 25, 57, 15, 481, 15, 9, 529, 9, 33, 65, 33, 25, 35, 69, 9, 85, 9, 15, 91, 15, 39, 77, 39, 9, 91, 9, 21, 85, 21, 85, 247, 87, 9, 91, 9, 91, 25, 93, 1891, 95, 49, 9, 25, 9
</dd>
</dl>
<h2 id="references">References</h2>

<p>"</p>

<p><a class="uri" href="Category:Pseudoprimes" title="wikilink">Category:Pseudoprimes</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="Richard_K._Guy" title="wikilink">Guy</a>, <em>Pseudoprimes. Euler Pseudoprimes. Strong Pseudoprimes.</em> §A12 in <em>Unsolved Problems in Number Theory</em>, 2nd ed. New York: Springer-Verlag, pp. 27-30, 1994.<a href="#fnref1">↩</a></li>
<li id="fn2"><mtpl></mtpl><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="Louis_Monier" title="wikilink">Monier</a>, <em>Evaluation and Comparison of Two Efficient Probabilistic Primality Testing Algorithms.</em> <em>Theoretical Computer Science</em>, 12 pp. 97-108, 1980.<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="Michael_O._Rabin" title="wikilink">Rabin</a>, <em>Probabilistic Algorithm for Testing Primality.</em> <em>Journal of Number Theory</em>, 12 pp. 128-138, 1980.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
</ol>
</section>
</body>
</html>

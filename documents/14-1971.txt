   Posterior predictive distribution      Posterior predictive distribution   In statistics , and especially Bayesian statistics , the posterior predictive distribution is the distribution of unobserved observations (prediction) conditional on the observed data. 1 Described as the distribution that a new i.i.d. data point    x  ~     normal-~  x    \tilde{x}   would have, given a set of N existing i.i.d. observations    ùêó  =   {   x  1   ,  ‚Ä¶  ,   x  N   }       ùêó    subscript  x  1   normal-‚Ä¶   subscript  x  N      \mathbf{X}=\{x_{1},\dots,x_{N}\}   . In a frequentist context, this might be derived by computing the maximum likelihood estimate (or some other estimate) of the parameter(s) given the observed data, and then plugging them into the distribution function of the new observations.  However, the concept of posterior predictive distribution is normally used in a Bayesian context, where it makes use of the entire posterior distribution of the parameter(s) given the observed data to yield a probability distribution over an interval rather than simply a point estimate. Specifically, it is computed by marginalising over the parameters, using the posterior distribution:      p   (   x  ~   |  ùêó  ,  Œ±  )   =   ‚à´  Œ∏   p   (   x  ~   |  Œ∏  )   p   (  Œ∏  |  ùêó  ,  Œ±  )   d  Œ∏     fragments  p   fragments  normal-(   normal-~  x   normal-|  X  normal-,  Œ±  normal-)     subscript   Œ∏   p   fragments  normal-(   normal-~  x   normal-|  Œ∏  normal-)   p   fragments  normal-(  Œ∏  normal-|  X  normal-,  Œ±  normal-)   normal-d  Œ∏    p(\tilde{x}|\mathbf{X},\alpha)=\int_{\theta}p(\tilde{x}|\theta)\,p(\theta|%
 \mathbf{X},\alpha)\operatorname{d}\!\theta     where    Œ∏    Œ∏   \theta\,   represents the parameter(s) and    Œ±    Œ±   \alpha\,   the hyperparameter(s) . Any of     x  ~   ,  Œ∏  ,  Œ±      normal-~  x   Œ∏  Œ±    \tilde{x},\theta,\alpha   may be vectors (or equivalently, may stand for multiple parameters).  Note that this is equivalent to the expected value of the distribution of the new data point, when the expectation is taken over the posterior distribution, i.e.:      p   (   x  ~   |  ùêó  ,  Œ±  )   =   ùîº   Œ∏  |  ùêó  ,  Œ±     [  p   (   x  ~   |  Œ∏  )   ]      fragments  p   fragments  normal-(   normal-~  x   normal-|  X  normal-,  Œ±  normal-)     subscript  ùîº   fragments  Œ∏  normal-|  X  normal-,  Œ±     fragments  normal-[  p   fragments  normal-(   normal-~  x   normal-|  Œ∏  normal-)   normal-]     p(\tilde{x}|\mathbf{X},\alpha)=\mathbb{E}_{\theta|\mathbf{X},\alpha}\Big[p(%
 \tilde{x}|\theta)\Big]     (To get an intuition for this, keep in mind that expected value is a type of average. The predictive probability of seeing a particular value of a new observation will vary depending on the parameters of the distribution of the observation. In this case, we don't know the exact value of the parameters, but we have a posterior distribution over them, that specifies what we believe the parameters to be, given the data we've already seen. Logically, then, to get "the" predictive probability, we should average all of the various predictive probabilities over the different possible parameter values, weighting them according to how strongly we believe in them. This is exactly what this expected value does. Compare this to the approach in frequentist statistics , where a single estimate of the parameters, e.g. a maximum likelihood estimate , would be computed, and this value plugged in. This is equivalent to averaging over a posterior distribution with no variance , i.e. where we are completely certain of the parameter having a single value. The result is weighted too strongly towards the mode of the posterior, and takes no account of other possible values, unlike in the Bayesian approach.)  Prior vs. posterior predictive distribution  The prior predictive distribution , in a Bayesian context, is the distribution of a data point marginalized over its prior distribution. That is, if     x  ~   ‚àº  F   (   x  ~   |  Œ∏  )      fragments   normal-~  x   similar-to  F   fragments  normal-(   normal-~  x   normal-|  Œ∏  normal-)     \tilde{x}\sim F(\tilde{x}|\theta)   and    Œ∏  ‚àº  G   (  Œ∏  |  Œ±  )      fragments  Œ∏  similar-to  G   fragments  normal-(  Œ∏  normal-|  Œ±  normal-)     \theta\sim G(\theta|\alpha)   , then the prior predictive distribution is the corresponding distribution    H   (   x  ~   |  Œ±  )      fragments  H   fragments  normal-(   normal-~  x   normal-|  Œ±  normal-)     H(\tilde{x}|\alpha)   , where       p  H    (   x  ~   |  Œ±  )   =   ‚à´  Œ∏    p  F    (   x  ~   |  Œ∏  )    p  G    (  Œ∏  |  Œ±  )   d  Œ∏     fragments   subscript  p  H    fragments  normal-(   normal-~  x   normal-|  Œ±  normal-)     subscript   Œ∏    subscript  p  F    fragments  normal-(   normal-~  x   normal-|  Œ∏  normal-)    subscript  p  G    fragments  normal-(  Œ∏  normal-|  Œ±  normal-)   normal-d  Œ∏    p_{H}(\tilde{x}|\alpha)=\int_{\theta}p_{F}(\tilde{x}|\theta)\,p_{G}(\theta|%
 \alpha)\operatorname{d}\!\theta     Note that this is similar to the posterior predictive distribution except that the marginalization (or equivalently, expectation) is taken with respect to the prior distribution instead of the posterior distribution.  Furthermore, if the prior distribution    G   (  Œ∏  |  Œ±  )      fragments  G   fragments  normal-(  Œ∏  normal-|  Œ±  normal-)     G(\theta|\alpha)   is a conjugate prior , then the posterior predictive distribution will belong to the same family of distributions as the prior predictive distribution. This is easy to see. If the prior distribution    G   (  Œ∏  |  Œ±  )      fragments  G   fragments  normal-(  Œ∏  normal-|  Œ±  normal-)     G(\theta|\alpha)   is conjugate, then      p   (  Œ∏  |  ùêó  ,  Œ±  )   =   p  G    (  Œ∏  |   Œ±  ‚Ä≤   )   ,     fragments  p   fragments  normal-(  Œ∏  normal-|  X  normal-,  Œ±  normal-)     subscript  p  G    fragments  normal-(  Œ∏  normal-|   superscript  Œ±  normal-‚Ä≤   normal-)   normal-,    p(\theta|\mathbf{X},\alpha)=p_{G}(\theta|\alpha^{\prime}),     i.e. the posterior distribution also belongs to    G   (  Œ∏  |  Œ±  )   ,     fragments  G   fragments  normal-(  Œ∏  normal-|  Œ±  normal-)   normal-,    G(\theta|\alpha),   but simply with a different parameter    Œ±  ‚Ä≤     superscript  Œ±  normal-‚Ä≤    \alpha^{\prime}   instead of the original parameter    Œ±  .    Œ±   \alpha.   Then,      p   (   x  ~   |  ùêó  ,  Œ±  )      fragments  p   fragments  normal-(   normal-~  x   normal-|  X  normal-,  Œ±  normal-)     \displaystyle p(\tilde{x}|\mathbf{X},\alpha)     Hence, the posterior predictive distribution follows the same distribution H as the prior predictive distribution, but with the posterior values of the hyperparameters substituted for the prior ones.  The prior predictive distribution is in the form of a compound distribution , and in fact is often used to define a compound distribution , because of the lack of any complicating factors such as the dependence on the data   ùêó   ùêó   \mathbf{X}   and the issue of conjugacy. For example, the Student's t-distribution can be defined as the prior predictive distribution of a normal distribution with known mean  Œº but unknown variance  œÉ x 2 , with a conjugate prior scaled-inverse-chi-squared distribution placed on œÉ x 2 , with hyperparameters ŒΩ and œÉ 2 . The resulting compound distribution    t   (  x  |  Œº  ,  ŒΩ  ,   œÉ  2   )      fragments  t   fragments  normal-(  x  normal-|  Œº  normal-,  ŒΩ  normal-,   superscript  œÉ  2   normal-)     t(x|\mu,\nu,\sigma^{2})   is indeed a non-standardized Student's t-distribution , and follows one of the two most common parameterizations of this distribution. Then, the corresponding posterior predictive distribution would again be Student's t, with the updated hyperparameters     ŒΩ  ‚Ä≤   ,   œÉ   2   ‚Ä≤       superscript  ŒΩ  normal-‚Ä≤    superscript   superscript  œÉ  2   normal-‚Ä≤     \nu^{\prime},{\sigma^{2}}^{\prime}   that appear in the posterior distribution also directly appearing in the posterior predictive distribution.  Note in some cases that the appropriate compound distribution is defined using a different parameterization than the one that would be most natural for the predictive distributions in the current problem at hand. Often this results because the prior distribution used to define the compound distribution is different from the one used in the current problem. For example, as indicated above, the Student's t-distribution was defined in terms of a scaled-inverse-chi-squared distribution placed on the variance. However, it is more common to use an inverse gamma distribution as the conjugate prior in this situation. The two are in fact equivalent except for parameterization; hence, the Student's t-distribution can still be used for either predictive distribution, but the hyperparameters must be reparameterized before being plugged in.  In exponential families  Most, but not all, common families of distributions belong to the exponential family of distributions. Exponential families have a large number of useful properties. One of which is that all members have conjugate prior distributions ‚Äî whereas very few other distributions have conjugate priors.  Prior predictive distribution in exponential families  Another useful property is that the probability density function of the compound distribution corresponding to the prior predictive distribution of an exponential family distribution marginalized over its conjugate prior distribution can be determined analytically. Assume that    F   (  x  |  ùúΩ  )      fragments  F   fragments  normal-(  x  normal-|  Œ∏  normal-)     F(x|\boldsymbol{\theta})   is a member of the exponential family with parameter   ùúΩ   ùúΩ   \boldsymbol{\theta}   that is parametrized according to the natural parameter     ùúº  =   ùúº   (  ùúΩ  )        ùúº    ùúº  ùúΩ     \boldsymbol{\eta}=\boldsymbol{\eta}(\boldsymbol{\theta})   , and is distributed as       p  F    (  x  |  ùúº  )   =  h   (  x  )   g   (  ùúº  )    e    ùúº  T   ùêì   (  x  )        fragments   subscript  p  F    fragments  normal-(  x  normal-|  Œ∑  normal-)    h   fragments  normal-(  x  normal-)   g   fragments  normal-(  Œ∑  normal-)    superscript  e     superscript  ùúº  normal-T   ùêì  x      p_{F}(x|\boldsymbol{\eta})=h(x)g(\boldsymbol{\eta})e^{\boldsymbol{\eta}^{\rm T%
 }\mathbf{T}(x)}     while    G   (  ùúº  |  ùùå  ,  ŒΩ  )      fragments  G   fragments  normal-(  Œ∑  normal-|  œá  normal-,  ŒΩ  normal-)     G(\boldsymbol{\eta}|\boldsymbol{\chi},\nu)   is the appropriate conjugate prior, distributed as       p  G    (  ùúº  |  ùùå  ,  ŒΩ  )   =  f   (  ùùå  ,  ŒΩ  )   g    (  ùúº  )   ŒΩ    e    ùúº  T   ùùå       fragments   subscript  p  G    fragments  normal-(  Œ∑  normal-|  œá  normal-,  ŒΩ  normal-)    f   fragments  normal-(  œá  normal-,  ŒΩ  normal-)   g   superscript   fragments  normal-(  Œ∑  normal-)   ŒΩ    superscript  e     superscript  ùúº  normal-T   ùùå      p_{G}(\boldsymbol{\eta}|\boldsymbol{\chi},\nu)=f(\boldsymbol{\chi},\nu)g(%
 \boldsymbol{\eta})^{\nu}e^{\boldsymbol{\eta}^{\rm T}\boldsymbol{\chi}}     Then the prior predictive distribution   H   H   H   (the result of compounding   F   F   F   with   G   G   G   ) is       p  H    (  x  |  ùùå  ,  ŒΩ  )      fragments   subscript  p  H    fragments  normal-(  x  normal-|  œá  normal-,  ŒΩ  normal-)     \displaystyle p_{H}(x|\boldsymbol{\chi},\nu)     The last line follows from the previous one by recognizing that the function inside the integral is the density function of a random variable distributed as    G   (  ùúº  |  ùùå  +  ùêì   (  x  )   ,  ŒΩ  +  1  )      fragments  G   fragments  normal-(  Œ∑  normal-|  œá   T   fragments  normal-(  x  normal-)   normal-,  ŒΩ   1  normal-)     G(\boldsymbol{\eta}|\boldsymbol{\chi}+\mathbf{T}(x),\nu+1)   , excluding the normalizing function    f   (  ‚Ä¶  )       f  normal-‚Ä¶    f(\dots)\,   . Hence the result of the integration will be the reciprocal of the normalizing function.  The above result is independent of choice of parametrization of   ùúΩ   ùúΩ   \boldsymbol{\theta}   , as none of   ùúΩ   ùúΩ   \boldsymbol{\theta}   ,   ùúº   ùúº   \boldsymbol{\eta}   and    g   (  ‚Ä¶  )       g  normal-‚Ä¶    g(\dots)\,   appears. (Note that    g   (  ‚Ä¶  )       g  normal-‚Ä¶    g(\dots)\,   is a function of the parameter and hence will assume different forms depending on choice of parametrization.) For standard choices of   F   F   F   and   G   G   G   , it is often easier to work directly with the usual parameters rather than rewrite in terms of the natural parameters .  Note also that the reason the integral is tractable is that it involves computing the normalization constant of a density defined by the product of a prior distribution and a likelihood . When the two are conjugate , the product is a posterior distribution , and by assumption, the normalization constant of this distribution is known. As shown above, the density function of the compound distribution follows a particular form, consisting of the product of the function    h   (  x  )       h  x    h(x)   that forms part of the density function for   F   F   F   , with the quotient of two forms of the normalization "constant" for   G   G   G   , one derived from a prior distribution and the other from a posterior distribution. The beta-binomial distribution is a good example of how this process works.  Despite the analytical tractability of such distributions, they are in themselves usually not members of the exponential family . For example, the three-parameter Student's t distribution , beta-binomial distribution and Dirichlet-multinomial distribution are all predictive distributions of exponential-family distributions (the normal distribution , binomial distribution and multinomial distributions , respectively), but none are members of the exponential family. This can be seen above due to the presence of functional dependence on    ùùå  +   ùêì   (  x  )        ùùå    ùêì  x     \boldsymbol{\chi}+\mathbf{T}(x)   . In an exponential-family distribution, it must be possible to separate the entire density function into multiplicative factors of three types: (1) factors containing only variables, (2) factors containing only parameters, and (3) factors whose logarithm factorizes between variables and parameters. The presence of    ùùå  +   ùêì   (  x  )   œá       ùùå    ùêì  x  œá     \boldsymbol{\chi}+\mathbf{T}(x){\chi}   makes this impossible unless the "normalizing" function    f   (  ‚Ä¶  )       f  normal-‚Ä¶    f(\dots)\,   either ignores the corresponding argument entirely or uses it only in the exponent of an expression.  Posterior predictive distribution in exponential families  As noted above, when a conjugate prior is being used, the posterior predictive distribution belongs to the same family as the prior predictive distribution, and is determined simply by plugging the updated hyperparameters for the posterior distribution of the parameter(s) into the formula for the prior predictive distribution. Using the general form of the posterior update equations for exponential-family distributions (see the appropriate section in the exponential family article ), we can write out an explicit formula for the posterior predictive distribution:         p   (   x  ~   |  ùêó  ,  ùùå  ,  ŒΩ  )      =      p  H    (   x  ~   |  ùùå  +  ùêì   (  ùêó  )   ,  ŒΩ  +  N  )           fragments  p   fragments  normal-(   normal-~  x   normal-|  X  normal-,  œá  normal-,  ŒΩ  normal-)      fragments   subscript  p  H    fragments  normal-(   normal-~  x   normal-|  œá   T   fragments  normal-(  X  normal-)   normal-,  ŒΩ   N  normal-)       \begin{array}[]{lcl}p(\tilde{x}|\mathbf{X},\boldsymbol{\chi},\nu)&=&p_{H}\left%
 (\tilde{x}|\boldsymbol{\chi}+\mathbf{T}(\mathbf{X}),\nu+N\right)\end{array}     where       ùêì   (  ùêó  )    =    ‚àë   i  =  1   N    ùêì   (   x  i   )           ùêì  ùêó     superscript   subscript     i  1    N     ùêì   subscript  x  i       \mathbf{T}(\mathbf{X})=\sum_{i=1}^{N}\mathbf{T}(x_{i})     This shows that the posterior predictive distribution of a series of observations, in the case where the observations follow an exponential family with the appropriate conjugate prior , has the same probability density as the compound distribution, with parameters as specified above.  Note in particular that the observations themselves enter only in the form      ùêì   (  ùêó  )    =    ‚àë   i  =  1   N    ùêì   (   x  i   )      .        ùêì  ùêó     superscript   subscript     i  1    N     ùêì   subscript  x  i       \mathbf{T}(\mathbf{X})=\sum_{i=1}^{N}\mathbf{T}(x_{i}).   This is termed the sufficient statistic of the observations, because it tells us everything we need to know about the observations in order to compute a posterior or posterior predictive distribution based on them (or, for that matter, anything else based on the likelihood of the observations, such as the marginal likelihood ).  Joint predictive distribution, marginal likelihood  It is also possible to consider the result of compounding a joint distribution over a fixed number of independent identically distributed samples with a prior distribution over a shared parameter. In a Bayesian setting, this comes up in various contexts: computing the prior or posterior predictive distribution of multiple new observations, and computing the marginal likelihood of observed data (the denominator in Bayes' law ). When the distribution of the samples is from the exponential family and the prior distribution is conjugate, the resulting compound distribution will be tractable and follow a similar form to the expression above. It is easy to show, in fact, that the joint compound distribution of a set    ùêó  =   {   x  1   ,  ‚Ä¶  ,   x  N   }       ùêó    subscript  x  1   normal-‚Ä¶   subscript  x  N      \mathbf{X}=\{x_{1},\dots,x_{N}\}   for   N   N   N   observations is       p  H    (  ùêó  |  ùùå  ,  ŒΩ  )   =   (   ‚àè   i  =  1   N   h   (   x  i   )   )     f   (  ùùå  ,  ŒΩ  )     f   (   ùùå  +   ùêì   (  ùêó  )     ,   ŒΩ  +  N   )        fragments   subscript  p  H    fragments  normal-(  X  normal-|  œá  normal-,  ŒΩ  normal-)     fragments  normal-(   superscript   subscript  product    i  1    N   h   fragments  normal-(   subscript  x  i   normal-)   normal-)       f   ùùå  ŒΩ      f     ùùå    ùêì  ùêó      ŒΩ  N        p_{H}(\mathbf{X}|\boldsymbol{\chi},\nu)=\left(\prod_{i=1}^{N}h(x_{i})\right)%
 \dfrac{f(\boldsymbol{\chi},\nu)}{f\left(\boldsymbol{\chi}+\mathbf{T}(\mathbf{X%
 }),\nu+N\right)}     This result and the above result for a single compound distribution extend trivially to the case of a distribution over a vector-valued observation, such as a multivariate Gaussian distribution .  Relation to Gibbs sampling  Note also that collapsing out a node in a collapsed Gibbs sampler is equivalent to compounding . As a result, when a set of independent identically distributed (i.i.d.) nodes all depend on the same prior node, and that node is collapsed out, the resulting conditional probability of one node given the others as well as the parents of the collapsed-out node (but not conditioning on any other nodes, e.g. any child nodes) is the same as the posterior predictive distribution of all the remaining i.i.d. nodes (or more correctly, formerly i.i.d. nodes, since collapsing introduces dependencies among the nodes). That is, it is generally possible to implement collapsing out of a node simply by attaching all parents of the node directly to all children, and replacing the former conditional probability distribution associated with each child with the corresponding posterior predictive distribution for the child conditioned on its parents and the other formerly i.i.d. nodes that were also children of the removed node. For an example, for more specific discussion and for some cautions about certain tricky issues, see the Dirichlet-multinomial distribution article.  See also   Compound probability distribution  Marginal probability  Prediction interval#Bayesian statistics   References  "  Category:Probability theory  Category:Bayesian statistics     ‚Ü©     
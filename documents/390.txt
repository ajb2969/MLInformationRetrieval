   Line–sphere intersection      Line–sphere intersection   (Figure)  The three possible line-sphere intersections: 1. No intersection. 2. Point intersection. 3. Two point intersection.   In analytic geometry , a line and a sphere can intersect in three ways: no intersection at all, at exactly one point, or in two points. Methods for distinguishing these cases, and determining equations for the points in the latter cases, are useful in a number of circumstances. For example, this is a common calculation to perform during ray tracing (Eberly 2006:698).  Calculation using vectors in 3D  In vector notation , the equations are as follows:  Equation for a sphere        ∥   𝐱  -  𝐜   ∥   2   =   r  2        superscript   norm    𝐱  𝐜    2    superscript  r  2     \left\|\mathbf{x}-\mathbf{c}\right\|^{2}=r^{2}     :*   𝐜   𝐜   \mathbf{c}   - center point  :*   r   r   r   - radius  :*   𝐱   𝐱   \mathbf{x}   - points on the sphere  Equation for a line starting at   𝐨   𝐨   \mathbf{o}         𝐱  =   𝐨  +   d  𝐥        𝐱    𝐨    d  𝐥      \mathbf{x}=\mathbf{o}+d\mathbf{l}     :*   d   d   d   - distance along line from starting point  :*   𝐥   𝐥   \mathbf{l}   - direction of line (a unit vector )  :*   𝐨   𝐨   \mathbf{o}   - origin of the line  :*   𝐱   𝐱   \mathbf{x}   - points on the line  Searching for points that are on the line and on the sphere means combining the equations and solving for   d   d   d   :   Equations combined        ∥    𝐨  +   d  𝐥    -  𝐜   ∥   2   =   r  2    ⇔     (    𝐨  +   d  𝐥    -  𝐜   )   ⋅   (    𝐨  +   d  𝐥    -  𝐜   )    =   r  2       normal-⇔     superscript   norm      𝐨    d  𝐥    𝐜    2    superscript  r  2       normal-⋅      𝐨    d  𝐥    𝐜       𝐨    d  𝐥    𝐜     superscript  r  2      \left\|\mathbf{o}+d\mathbf{l}-\mathbf{c}\right\|^{2}=r^{2}\Leftrightarrow(%
 \mathbf{o}+d\mathbf{l}-\mathbf{c})\cdot(\mathbf{o}+d\mathbf{l}-\mathbf{c})=r^{2}      Expanded        d  2    (   𝐥  ⋅  𝐥   )    +   2  d   (   𝐥  ⋅   (   𝐨  -  𝐜   )    )    +    (   𝐨  -  𝐜   )   ⋅   (   𝐨  -  𝐜   )     =   r  2            superscript  d  2    normal-⋅  𝐥  𝐥      2  d   normal-⋅  𝐥    𝐨  𝐜      normal-⋅    𝐨  𝐜     𝐨  𝐜      superscript  r  2     d^{2}(\mathbf{l}\cdot\mathbf{l})+2d(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))+(%
 \mathbf{o}-\mathbf{c})\cdot(\mathbf{o}-\mathbf{c})=r^{2}      Rearranged         d  2    (   𝐥  ⋅  𝐥   )    +   2  d   (   𝐥  ⋅   (   𝐨  -  𝐜   )    )    +    (   𝐨  -  𝐜   )   ⋅   (   𝐨  -  𝐜   )     -   r  2    =  0             superscript  d  2    normal-⋅  𝐥  𝐥      2  d   normal-⋅  𝐥    𝐨  𝐜      normal-⋅    𝐨  𝐜     𝐨  𝐜      superscript  r  2    0    d^{2}(\mathbf{l}\cdot\mathbf{l})+2d(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))+(%
 \mathbf{o}-\mathbf{c})\cdot(\mathbf{o}-\mathbf{c})-r^{2}=0      The form of a quadratic formula is now observable. (This quadratic equation is an example of Joachimsthal's Equation 1 .)       a   d  2    +   b  d   +  c   =  0          a   superscript  d  2      b  d   c   0    ad^{2}+bd+c=0      where      a  =   𝐥  ⋅  𝐥   =    ∥  𝐥  ∥   2         a   normal-⋅  𝐥  𝐥         superscript   norm  𝐥   2      a=\mathbf{l}\cdot\mathbf{l}=\left\|\mathbf{l}\right\|^{2}         b  =   2   (   𝐥  ⋅   (   𝐨  -  𝐜   )    )        b    2   normal-⋅  𝐥    𝐨  𝐜       b=2(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))         c  =     (   𝐨  -  𝐜   )   ⋅   (   𝐨  -  𝐜   )    -   r  2    =     ∥   𝐨  -  𝐜   ∥   2   -   r  2          c     normal-⋅    𝐨  𝐜     𝐨  𝐜     superscript  r  2            superscript   norm    𝐨  𝐜    2    superscript  r  2       c=(\mathbf{o}-\mathbf{c})\cdot(\mathbf{o}-\mathbf{c})-r^{2}=\left\|\mathbf{o}-%
 \mathbf{c}\right\|^{2}-r^{2}       Simplified     d  =     -   (   𝐥  ⋅   (   𝐨  -  𝐜   )    )    ±      (   𝐥  ⋅   (   𝐨  -  𝐜   )    )   2   -     ∥  𝐥  ∥   2    (     ∥   𝐨  -  𝐜   ∥   2   -   r  2    )         ∥  𝐥  ∥   2        d     plus-or-minus     normal-⋅  𝐥    𝐨  𝐜          superscript   normal-⋅  𝐥    𝐨  𝐜    2      superscript   norm  𝐥   2      superscript   norm    𝐨  𝐜    2    superscript  r  2         superscript   norm  𝐥   2      d=\frac{-(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))\pm\sqrt{(\mathbf{l}\cdot(%
 \mathbf{o}-\mathbf{c}))^{2}-\left\|\mathbf{l}\right\|^{2}(\left\|\mathbf{o}-%
 \mathbf{c}\right\|^{2}-r^{2})}}{\left\|\mathbf{l}\right\|^{2}}      Note that   𝐥   𝐥   \mathbf{l}   is a unit vector, and thus      ∥  𝐥  ∥   2   =  1       superscript   norm  𝐥   2   1    \left\|\mathbf{l}\right\|^{2}=1   . Thus, we can simplify this further to     d  =    -   (   𝐥  ⋅   (   𝐨  -  𝐜   )    )    ±       (   𝐥  ⋅   (   𝐨  -  𝐜   )    )   2   -    ∥   𝐨  -  𝐜   ∥   2    +   r  2          d   plus-or-minus     normal-⋅  𝐥    𝐨  𝐜            superscript   normal-⋅  𝐥    𝐨  𝐜    2    superscript   norm    𝐨  𝐜    2     superscript  r  2        d=-(\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))\pm\sqrt{(\mathbf{l}\cdot(\mathbf{o%
 }-\mathbf{c}))^{2}-\left\|\mathbf{o}-\mathbf{c}\right\|^{2}+r^{2}}        If the value under the square-root (       (   𝐥  ⋅   (   𝐨  -  𝐜   )    )   2   -    ∥   𝐨  -  𝐜   ∥   2    +   r  2          superscript   normal-⋅  𝐥    𝐨  𝐜    2    superscript   norm    𝐨  𝐜    2     superscript  r  2     (\mathbf{l}\cdot(\mathbf{o}-\mathbf{c}))^{2}-\left\|\mathbf{o}-\mathbf{c}%
 \right\|^{2}+r^{2}   ) is less than zero, then it is clear that no solutions exist, i.e. the line does not intersect the sphere (case 1).  If it is zero, then exactly one solution exists, i.e. the line just touches the sphere in one point (case 2).  If it is greater than zero, two solutions exist, and thus the line touches the sphere in two points (case 3).   See also   Analytic geometry  Line-plane intersection  Line of intersection between two planes   References   David H. Eberly (2006), 3D game engine design: a practical approach to real-time computer graphics , 2nd edition, Morgan Kaufmann. ISBN 0-12-229063-1   "  Category:Analytic geometry   
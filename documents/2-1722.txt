   Fatou's lemma      Fatou's lemma   In mathematics , Fatou's lemma establishes an inequality relating the integral (in the sense of Lebesgue ) of the limit inferior of a sequence of functions to the limit inferior of integrals of these functions. The lemma is named after Pierre Fatou .  Fatou's lemma can be used to prove the Fatou–Lebesgue theorem and Lebesgue's dominated convergence theorem .  Standard statement of Fatou's lemma  Let f 1 , f 2 , f 3 , . . . be a sequence of non-negative  measurable functions on a measure space ( S , Σ , μ ). Define the function f : S → [0, ∞] a.e. pointwise limit by         f   (  s  )    =    lim inf   n  →  ∞      f  n    (  s  )      ,   s  ∈  S    .     formulae-sequence      f  s     subscript  limit-infimum   normal-→  n        subscript  f  n   s       s  S     f(s)=\liminf_{n\to\infty}f_{n}(s),\qquad s\in S.   Then f is measurable and         ∫  S     f   d  μ    ≤    lim inf   n  →  ∞      ∫  S      f  n    d   μ       .        subscript   S     f  d  μ      subscript  limit-infimum   normal-→  n       subscript   S      subscript  f  n   d  μ       \int_{S}f\,d\mu\leq\liminf_{n\to\infty}\int_{S}f_{n}\,d\mu\,.     Note: The functions are allowed to attain the value +∞ and the integrals may also be infinite.  Proof  Fatou's lemma may be proved directly as in the first proof presented below, which is an elaboration on the one that can be found in Royden (see the references). The second proof is shorter but uses the monotone convergence theorem – which is usually proved using Fatou's lemma and thus could create a circular argument.    Direct proof    We will prove something a bit weaker here. Namely, we will allow f n to converge μ- almost everywhere on a subset E of S. We seek to show that         ∫  E     f   d  μ    ≤    lim inf   n  →  ∞      ∫  E      f  n    d   μ       .        subscript   E     f  d  μ      subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d  μ       \int_{E}f\,d\mu\leq\liminf_{n\to\infty}\int_{E}f_{n}\,d\mu\,.   Let      K  =   {   x  ∈  E   |     f  n    (  x  )    →   f   (  x  )     }       K   conditional-set    x  E    normal-→     subscript  f  n   x     f  x       K=\{x\in E|f_{n}(x)\rightarrow f(x)\}   . Then μ(E-K)=0 and          ∫  E     f   d  μ    =    ∫  K     f   d  μ     ,     ∫  E      f  n    d  μ    =    ∫  K      f  n    d   μ    ∀  n     ∈  𝒩    .     formulae-sequence      subscript   E     f  d  μ      subscript   K     f  d  μ           subscript   E      subscript  f  n   d  μ      subscript   K      subscript  f  n   d  μ   for-all  n          𝒩      \int_{E}f\,d\mu=\int_{K}f\,d\mu,~{}~{}~{}\int_{E}f_{n}\,d\mu=\int_{K}f_{n}\,d%
 \mu~{}\forall n\in\mathcal{N}.   Thus, replacing E by K we may assume that f n converge to f  pointwise on E. Next, by the definition of the Lebesgue Integral, it is enough to show that if φ is any non-negative simple function less than or equal to f, then        ∫  E     φ   d  μ    ≤    lim inf   n  →  ∞      ∫  E      f  n    d  μ           subscript   E     φ  d  μ      subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d  μ       \int_{E}\varphi\,d\mu\leq\liminf_{n\rightarrow\infty}\int_{E}f_{n}\,d\mu     We first consider the case when      ∫  E   φ   =  ∞        subscript   E   φ      \int_{E}\varphi=\infty   . Let a be the minimum non-negative value of φ (it exists since the integral of φ is infinite). Define      A  =   {   x  ∈  E   |    φ   (  x  )    >   a  /  2    }       A   conditional-set    x  E       φ  x     a  2       A=\{x\in E|\varphi(x)>a/2\}   We must have that μ(A) is infinite since         ∫  E   φ   ≤   M  μ   (  A  )     ,        subscript   E   φ     M  μ  A     \int_{E}\varphi\leq M\mu(A),   where M is the (necessarily finite) maximum value of that φ attains.  Next, we define        A  n   =   {   x  ∈  E   |     f  k    (  x  )    >    a  /   2     ∀  k    ≥  n   }    .       subscript  A  n    conditional-set    x  E          subscript  f  k   x       a  2    for-all  k         n       A_{n}=\{x\in E|f_{k}(x)>a/2~{}\forall k\geq n\}.   We have that       A  ⊆    ⋃  n    A  n    ⇒   μ   (    ⋃  n    A  n    )    =  ∞   .        A    subscript   n    subscript  A  n      normal-⇒      μ    subscript   n    subscript  A  n              A\subseteq\bigcup_{n}A_{n}\Rightarrow\mu(\bigcup_{n}A_{n})=\infty.   But A n is a nested increasing sequence of functions and hence, by the continuity from below μ ,         lim   n  →  ∞     μ   (   A  n   )     =  ∞   .        subscript    normal-→  n       μ   subscript  A  n        \lim_{n\rightarrow\infty}\mu(A_{n})=\infty.   . At the same time,         ∫  E      f  n    d  μ    ≥    ∫   A  n       f  n    d  μ    ≥    a  2   μ   (   A  n   )    ⇒    lim inf   n  →  ∞      ∫  E      f  n    d  μ     =  ∞  =    ∫  E     φ   d  μ     ,          subscript   E      subscript  f  n   d  μ      subscript    subscript  A  n       subscript  f  n   d  μ             a  2   μ   subscript  A  n      normal-⇒      subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d  μ                  subscript   E     φ  d  μ       \int_{E}f_{n}\,d\mu\geq\int_{A_{n}}f_{n}\,d\mu\geq\frac{a}{2}\mu(A_{n})%
 \Rightarrow\liminf_{n\to\infty}\int_{E}f_{n}\,d\mu=\infty=\int_{E}\varphi\,d\mu,   proving the claim in this case.  The remaining case is when      ∫  E   φ   <  ∞        subscript   E   φ      \int_{E}\varphi<\infty   . We must have that μ(A) is finite. Denote, as above, by M the maximum value of φ and fix ε>0. Define        A  n   =   {   x  ∈  E   |     f  k    (  x  )    >    (   1  -  ϵ   )   φ   (  x  )    ∀  k    ≥  n   }    .       subscript  A  n    conditional-set    x  E          subscript  f  k   x       1  ϵ   φ  x   for-all  k         n       A_{n}=\{x\in E|f_{k}(x)>(1-\epsilon)\varphi(x)~{}\forall k\geq n\}.   Then A n is a nested increasing sequence of sets whose union contains A. Thus, A-A n is a decreasing sequence of sets with empty intersection. Since A has finite measure (this is why we needed to consider the two separate cases),        lim   n  →  ∞     μ   (   A  -   A  n    )     =  0.        subscript    normal-→  n       μ    A   subscript  A  n      0.    \lim_{n\rightarrow\infty}\mu(A-A_{n})=0.   Thus, there exists n such that         μ   (   A  -   A  k    )    <  ϵ   ,    ∀  k   ≥  n    .     formulae-sequence      μ    A   subscript  A  k     ϵ      for-all  k   n     \mu(A-A_{k})<\epsilon,~{}\forall k\geq n.   Hence, for    k  ≥  n      k  n    k\geq n            ∫  E      f  k    d  μ    ≥    ∫   A  k       f  k    d  μ    ≥    (   1  -  ϵ   )     ∫   A  k      φ   d  μ      .          subscript   E      subscript  f  k   d  μ      subscript    subscript  A  k       subscript  f  k   d  μ             1  ϵ     subscript    subscript  A  k      φ  d  μ        \int_{E}f_{k}\,d\mu\geq\int_{A_{k}}f_{k}\,d\mu\geq(1-\epsilon)\int_{A_{k}}%
 \varphi\,d\mu.   At the same time,         ∫  E     φ   d  μ    =    ∫  A     φ   d  μ    =     ∫   A  k      φ   d  μ    +    ∫   A  -   A  k       φ   d  μ      .          subscript   E     φ  d  μ      subscript   A     φ  d  μ             subscript    subscript  A  k      φ  d  μ      subscript     A   subscript  A  k       φ  d  μ        \int_{E}\varphi\,d\mu=\int_{A}\varphi\,d\mu=\int_{A_{k}}\varphi\,d\mu+\int_{A-%
 A_{k}}\varphi\,d\mu.   Hence,         (   1  -  ϵ   )     ∫   A  k      φ   d  μ     ≥     (   1  -  ϵ   )     ∫  E     φ   d  μ     -    ∫   A  -   A  k       φ   d  μ      .          1  ϵ     subscript    subscript  A  k      φ  d  μ           1  ϵ     subscript   E     φ  d  μ       subscript     A   subscript  A  k       φ  d  μ       (1-\epsilon)\int_{A_{k}}\varphi\,d\mu\geq(1-\epsilon)\int_{E}\varphi\,d\mu-%
 \int_{A-A_{k}}\varphi\,d\mu.   Combining these inequalities gives that         ∫  E      f  k    d  μ    ≥     (   1  -  ϵ   )     ∫  E     φ   d  μ     -    ∫   A  -   A  k       φ   d  μ     ≥     ∫  E     φ   d  μ    -   ϵ   (     ∫  E     φ   d  μ    +  M   )      .          subscript   E      subscript  f  k   d  μ          1  ϵ     subscript   E     φ  d  μ       subscript     A   subscript  A  k       φ  d  μ              subscript   E     φ  d  μ      ϵ      subscript   E     φ  d  μ    M        \int_{E}f_{k}\,d\mu\geq(1-\epsilon)\int_{E}\varphi\,d\mu-\int_{A-A_{k}}\varphi%
 \,d\mu\geq\int_{E}\varphi\,d\mu-\epsilon\left(\int_{E}\varphi\,d\mu+M\right).   Hence, sending ε to 0 and taking the liminf in n, we get that         lim inf   n  →  ∞      ∫  E      f  n    d  μ     ≥    ∫  E     φ   d  μ     ,        subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d  μ       subscript   E     φ  d  μ      \liminf_{n\rightarrow\infty}\int_{E}f_{n}\,d\mu\geq\int_{E}\varphi\,d\mu,   completing the proof.      Proof using the monotone convergence theorem    For every natural number k define pointwise the function        g  k   =    inf   n  ≥  k     f  n     .       subscript  g  k     subscript  infimum    n  k     subscript  f  n      g_{k}=\inf_{n\geq k}f_{n}.   Then the sequence g 1 , g 2 , . . . of functions is increasing, meaning that g k ≤ g k +1 for all k , and converges pointwise to the limit inferior f .  For all k ≤ n we have g k ≤ f n , so that by the monotonicity of the integral         ∫  E      g  k    d  μ    ≤    ∫  E      f  n    d  μ     ,        subscript   E      subscript  g  k   d  μ      subscript   E      subscript  f  n   d  μ      \int_{E}g_{k}\,d\mu\leq\int_{E}f_{n}\,d\mu,   hence         ∫  E      g  k    d  μ    ≤    inf   n  ≥  k      ∫  E      f  n    d  μ      .        subscript   E      subscript  g  k   d  μ      subscript  infimum    n  k      subscript   E      subscript  f  n   d  μ       \int_{E}g_{k}\,d\mu\leq\inf_{n\geq k}\int_{E}f_{n}\,d\mu.   Using the monotone convergence theorem for the first equality, then the last inequality from above, and finally the definition of the limit inferior, it follows that         ∫  E     f   d  μ    =    lim   k  →  ∞      ∫  E      g  k    d  μ     ≤    lim   k  →  ∞      inf   n  ≥  k      ∫  E      f  n    d  μ      =    lim inf   n  →  ∞      ∫  E      f  n    d   μ       .          subscript   E     f  d  μ      subscript    normal-→  k       subscript   E      subscript  g  k   d  μ            subscript    normal-→  k       subscript  infimum    n  k      subscript   E      subscript  f  n   d  μ             subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d  μ        \int_{E}f\,d\mu=\lim_{k\to\infty}\int_{E}g_{k}\,d\mu\leq\lim_{k\to\infty}\inf_%
 {n\geq k}\int_{E}f_{n}\,d\mu=\liminf_{n\to\infty}\int_{E}f_{n}\,d\mu\,.       Examples for strict inequality  Equip the space   S   S   S   with the Borel σ-algebra and the Lebesgue measure .   Example for a probability space : Let    S  =   [  0  ,  1  ]       S   0  1     S=[0,1]   denote the unit interval . For every natural number    n   n   n   define          f_n(x)=\begin{cases}n&\text{for }x\in (0,1/n),\\ 0&\text{otherwise.} \end{cases}   Example with uniform convergence : Let   S   S   S   denote the set of all real numbers . Define          f_n(x)=\begin{cases}\frac1n&\text{for }x\in [0,n],\\ 0&\text{otherwise.} \end{cases}  These sequences     (   f  n   )    n  ∈  𝒩      subscript   subscript  f  n     n  𝒩     (f_{n})_{n\in\mathcal{N}}   converge on   S   S   S   pointwise (respectively uniformly) to the zero function (with zero integral), but every    f  n     subscript  f  n    f_{n}   has integral one.  The role of non-negativity  A suitable assumption concerning the negative parts of the sequence f 1 , f 2 , . . . of functions is necessary for Fatou's lemma, as the following example shows. Let S denote the half line [0,∞) with the Borel σ-algebra and the Lebesgue measure. For every natural number n define        f  n    (  x  )    =   {      -    1  n          for  x   ∈   [  n  ,   2  n   ]    ,       0    otherwise.             subscript  f  n   x    cases      1  n        for  x    n    2  n     0  otherwise.     f_{n}(x)=\begin{cases}-\frac{1}{n}&\text{for }x\in[n,2n],\\
 0&\text{otherwise.}\end{cases}   This sequence converges uniformly on S to the zero function (with zero integral) and for every x ≥ 0 we even have f n ( x ) = 0 for all n > x (so for every point x the limit 0 is reached in a finite number of steps). However, every function f n has integral −1, hence the inequality in Fatou's lemma fails.  Reverse Fatou lemma  Let f 1 , f 2 , . . . be a sequence of extended real -valued measurable functions defined on a measure space ( S , Σ , μ ). If there exists an integrable function g on S such that f n ≤ g for all n , then         lim sup   n  →  ∞      ∫  S      f  n    d  μ     ≤    ∫  S     lim sup   n  →  ∞       f  n    d  μ      .        subscript  limit-supremum   normal-→  n       subscript   S      subscript  f  n   d  μ       subscript   S     subscript  limit-supremum   normal-→  n        subscript  f  n   d  μ       \limsup_{n\to\infty}\int_{S}f_{n}\,d\mu\leq\int_{S}\limsup_{n\to\infty}f_{n}\,%
 d\mu.     Note: Here g integrable means that g is measurable and that      ∫  S     g   d  μ    <  ∞        subscript   S     g  d  μ       \textstyle\int_{S}g\,d\mu<\infty   .  Proof  Apply Fatou's lemma to the non-negative sequence given by g – f n .  Extensions and variations of Fatou's lemma  Integrable lower bound  Let f 1 , f 2 , . . . be a sequence of extended real-valued measurable functions defined on a measure space ( S , Σ , μ ). If there exists a non-negative integrable function g on S such that f n ≥ − g for all n , then         ∫  S     lim inf   n  →  ∞       f  n    d  μ     ≤    lim inf   n  →  ∞      ∫  S      f  n    d  μ      .        subscript   S     subscript  limit-infimum   normal-→  n        subscript  f  n   d  μ       subscript  limit-infimum   normal-→  n       subscript   S      subscript  f  n   d  μ       \int_{S}\liminf_{n\to\infty}f_{n}\,d\mu\leq\liminf_{n\to\infty}\int_{S}f_{n}\,%
 d\mu.     Proof  Apply Fatou's lemma to the non-negative sequence given by f n + g .  Pointwise convergence  If in the previous setting the sequence f 1 , f 2 , . . . converges pointwise to a function f  μ - almost everywhere on S , then         ∫  S     f   d  μ    ≤    lim inf   n  →  ∞      ∫  S      f  n    d   μ       .        subscript   S     f  d  μ      subscript  limit-infimum   normal-→  n       subscript   S      subscript  f  n   d  μ       \int_{S}f\,d\mu\leq\liminf_{n\to\infty}\int_{S}f_{n}\,d\mu\,.     Proof  Note that f has to agree with the limit inferior of the functions f n almost everywhere, and that the values of the integrand on a set of measure zero have no influence on the value of the integral.  Convergence in measure  The last assertion also holds, if the sequence f 1 , f 2 , . . . converges in measure to a function f .  Proof  There exists a subsequence such that         lim   k  →  ∞      ∫  S      f   n  k     d  μ     =    lim inf   n  →  ∞      ∫  S      f  n    d  μ      .        subscript    normal-→  k       subscript   S      subscript  f   subscript  n  k    d  μ       subscript  limit-infimum   normal-→  n       subscript   S      subscript  f  n   d  μ       \lim_{k\to\infty}\int_{S}f_{n_{k}}\,d\mu=\liminf_{n\to\infty}\int_{S}f_{n}\,d\mu.   Since this subsequence also converges in measure to f , there exists a further subsequence, which converges pointwise to f almost everywhere, hence the previous variation of Fatou's lemma is applicable to this subsubsequence.  Fatou's Lemma with Varying Measures  In all of the above statements of Fatou's Lemma, the integration was carried out with respect to a single fixed measure μ. Suppose that μ n is a sequence of measures on the measurable space ( S , Σ ) such that (see Convergence of measures )          μ  n    (  E  )    →   μ   (  E  )     ,    ∀  E   ∈  Σ    .     formulae-sequence   normal-→     subscript  μ  n   E     μ  E       for-all  E   normal-Σ     \mu_{n}(E)\to\mu(E),~{}\forall E\in\Sigma.   Then, with f n non-negative integrable functions and f being their pointwise limit inferior, we have         ∫  S     f   d  μ    ≤    lim inf   n  →  ∞      ∫  S      f  n    d   μ  n       .        subscript   S     f  d  μ      subscript  limit-infimum   normal-→  n       subscript   S      subscript  f  n   d   subscript  μ  n        \int_{S}f\,d\mu\leq\liminf_{n\to\infty}\int_{S}f_{n}\,d\mu_{n}.           Proof       We will prove something a bit stronger here. Namely, we will allow f n to converge μ- almost everywhere on a subset E of S. We seek to show that         ∫  E     f   d  μ    ≤    lim inf   n  →  ∞      ∫  E      f  n    d    μ  n        .        subscript   E     f  d  μ      subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d   subscript  μ  n        \int_{E}f\,d\mu\leq\liminf_{n\to\infty}\int_{E}f_{n}\,d\mu_{n}\,.   Let      K  =   {   x  ∈  E   |     f  n    (  x  )    →   f   (  x  )     }       K   conditional-set    x  E    normal-→     subscript  f  n   x     f  x       K=\{x\in E|f_{n}(x)\rightarrow f(x)\}   . Then μ(E-K)=0 and          ∫  E     f   d  μ    =    ∫   E  -  K      f   d  μ     ,     ∫  E      f  n    d  μ    =    ∫   E  -  K       f  n    d   μ    ∀  n     ∈  𝒩    .     formulae-sequence      subscript   E     f  d  μ      subscript     E  K      f  d  μ           subscript   E      subscript  f  n   d  μ      subscript     E  K       subscript  f  n   d  μ   for-all  n          𝒩      \int_{E}f\,d\mu=\int_{E-K}f\,d\mu,~{}~{}~{}\int_{E}f_{n}\,d\mu=\int_{E-K}f_{n}%
 \,d\mu~{}\forall n\in\mathcal{N}.   Thus, replacing E by E-K we may assume that f n converge to f  pointwise on E. Next, note that for any simple function φ we have         ∫  E     ϕ   d  μ    =    lim   n  →  ∞      ∫  E     ϕ   d   μ  n       .        subscript   E     ϕ  d  μ      subscript    normal-→  n       subscript   E     ϕ  d   subscript  μ  n        \int_{E}\phi\,d\mu=\lim_{n\to\infty}\int_{E}\phi\,d\mu_{n}.   Hence, by the definition of the Lebesgue Integral, it is enough to show that if φ is any non-negative simple function less than or equal to f, then        ∫  E     ϕ   d  μ    ≤    lim inf   n  →  ∞      ∫  E      f  n    d   μ  n            subscript   E     ϕ  d  μ      subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d   subscript  μ  n        \int_{E}\phi\,d\mu\leq\liminf_{n\rightarrow\infty}\int_{E}f_{n}\,d\mu_{n}   Let a be the minimum non-negative value of φ. Define      A  =   {   x  ∈  E   |    ϕ   (  x  )    >  a   }       A   conditional-set    x  E       ϕ  x   a      A=\{x\in E|\phi(x)>a\}   We first consider the case when      ∫  E     ϕ   d  μ    =  ∞        subscript   E     ϕ  d  μ       \int_{E}\phi\,d\mu=\infty   . We must have that μ(A) is infinite since         ∫  E     ϕ   d  μ    ≤   M  μ   (  A  )     ,        subscript   E     ϕ  d  μ      M  μ  A     \int_{E}\phi\,d\mu\leq M\mu(A),   where M is the (necessarily finite) maximum value of that φ attains. Next, we define        A  n   =   {   x  ∈  E   |     f  k    (  x  )    >    a    ∀  k    ≥  n   }    .       subscript  A  n    conditional-set    x  E          subscript  f  k   x     a   for-all  k         n       A_{n}=\{x\in E|f_{k}(x)>a~{}\forall k\geq n\}.   We have that       A  ⊆    ⋃  n    A  n    ⇒   μ   (    ⋃  n    A  n    )    =  ∞   .        A    subscript   n    subscript  A  n      normal-⇒      μ    subscript   n    subscript  A  n              A\subseteq\bigcup_{n}A_{n}\Rightarrow\mu(\bigcup_{n}A_{n})=\infty.   But A n is a nested increasing sequence of functions and hence, by the continuity from below μ ,         lim   n  →  ∞     μ   (   A  n   )     =  ∞   .        subscript    normal-→  n       μ   subscript  A  n        \lim_{n\rightarrow\infty}\mu(A_{n})=\infty.   . Thus,         lim   n  →  ∞      μ  n    (   A  n   )     =   μ   (   A  n   )    =  ∞   .          subscript    normal-→  n        subscript  μ  n    subscript  A  n       μ   subscript  A  n             \lim_{n\to\infty}\mu_{n}(A_{n})=\mu(A_{n})=\infty.   . At the same time,         ∫  E      f  n    d   μ  n     ≥   a   μ  n    (   A  n   )    ⇒    lim inf   n  →  ∞      ∫  E      f  n    d   μ  n      =  ∞  =    ∫  E     ϕ   d  μ     ,          subscript   E      subscript  f  n   d   subscript  μ  n       a   subscript  μ  n    subscript  A  n      normal-⇒      subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d   subscript  μ  n                   subscript   E     ϕ  d  μ       \int_{E}f_{n}\,d\mu_{n}\geq a\mu_{n}(A_{n})\Rightarrow\liminf_{n\to\infty}\int%
 _{E}f_{n}\,d\mu_{n}=\infty=\int_{E}\phi\,d\mu,   proving the claim in this case. The remaining case is when      ∫  E     ϕ   d  μ    <  ∞        subscript   E     ϕ  d  μ       \int_{E}\phi\,d\mu<\infty   . We must have that μ(A) is finite. Denote, as above, by M the maximum value of φ and fix ε>0. Define        A  n   =   {   x  ∈  E   |     f  k    (  x  )    >    (   1  -  ϵ   )   ϕ   (  x  )    ∀  k    ≥  n   }    .       subscript  A  n    conditional-set    x  E          subscript  f  k   x       1  ϵ   ϕ  x   for-all  k         n       A_{n}=\{x\in E|f_{k}(x)>(1-\epsilon)\phi(x)~{}\forall k\geq n\}.   Then A n is a nested increasing sequence of sets whose union contains A. Thus, A-A n is a decreasing sequence of sets with empty intersection. Since A has finite measure (this is why we needed to consider the two separate cases),        lim   n  →  ∞     μ   (   A  -   A  n    )     =  0.        subscript    normal-→  n       μ    A   subscript  A  n      0.    \lim_{n\rightarrow\infty}\mu(A-A_{n})=0.   Thus, there exists n such that         μ   (   A  -   A  k    )    <  ϵ   ,    ∀  k   ≥  n    .     formulae-sequence      μ    A   subscript  A  k     ϵ      for-all  k   n     \mu(A-A_{k})<\epsilon,~{}\forall k\geq n.   Therefore, since         lim   n  →  ∞      μ  n    (   A  -   A  k    )     =   μ   (   A  -   A  k    )     ,        subscript    normal-→  n        subscript  μ  n     A   subscript  A  k        μ    A   subscript  A  k       \lim_{n\to\infty}\mu_{n}(A-A_{k})=\mu(A-A_{k}),   there exists N such that          μ  k    (   A  -   A  k    )    <  ϵ   ,    ∀  k   ≥  N    .     formulae-sequence       subscript  μ  k     A   subscript  A  k     ϵ      for-all  k   N     \mu_{k}(A-A_{k})<\epsilon,~{}\forall k\geq N.   Hence, for    k  ≥  N      k  N    k\geq N            ∫  E      f  k    d   μ  k     ≥    ∫   A  k       f  k    d   μ  k     ≥    (   1  -  ϵ   )     ∫   A  k      ϕ   d   μ  k       .          subscript   E      subscript  f  k   d   subscript  μ  k       subscript    subscript  A  k       subscript  f  k   d   subscript  μ  k              1  ϵ     subscript    subscript  A  k      ϕ  d   subscript  μ  k         \int_{E}f_{k}\,d\mu_{k}\geq\int_{A_{k}}f_{k}\,d\mu_{k}\geq(1-\epsilon)\int_{A_%
 {k}}\phi\,d\mu_{k}.   At the same time,         ∫  E     ϕ   d   μ  k     =    ∫  A     ϕ   d   μ  k     =     ∫   A  k      ϕ   d   μ  k     +    ∫   A  -   A  k       ϕ   d   μ  k       .          subscript   E     ϕ  d   subscript  μ  k       subscript   A     ϕ  d   subscript  μ  k              subscript    subscript  A  k      ϕ  d   subscript  μ  k       subscript     A   subscript  A  k       ϕ  d   subscript  μ  k         \int_{E}\phi\,d\mu_{k}=\int_{A}\phi\,d\mu_{k}=\int_{A_{k}}\phi\,d\mu_{k}+\int_%
 {A-A_{k}}\phi\,d\mu_{k}.   Hence,         (   1  -  ϵ   )     ∫   A  k      ϕ   d   μ  k      ≥     (   1  -  ϵ   )     ∫  E     ϕ   d   μ  k      -    ∫   A  -   A  k       ϕ   d   μ  k       .          1  ϵ     subscript    subscript  A  k      ϕ  d   subscript  μ  k            1  ϵ     subscript   E     ϕ  d   subscript  μ  k        subscript     A   subscript  A  k       ϕ  d   subscript  μ  k        (1-\epsilon)\int_{A_{k}}\phi\,d\mu_{k}\geq(1-\epsilon)\int_{E}\phi\,d\mu_{k}-%
 \int_{A-A_{k}}\phi\,d\mu_{k}.   Combining these inequalities gives that         ∫  E      f  k    d   μ  k     ≥     (   1  -  ϵ   )     ∫  E     ϕ   d   μ  k      -    ∫   A  -   A  k       ϕ   d   μ  k      ≥     ∫  E     ϕ   d   μ  k     -   ϵ   (     ∫  E     ϕ   d   μ  k     +  M   )      .          subscript   E      subscript  f  k   d   subscript  μ  k           1  ϵ     subscript   E     ϕ  d   subscript  μ  k        subscript     A   subscript  A  k       ϕ  d   subscript  μ  k               subscript   E     ϕ  d   subscript  μ  k       ϵ      subscript   E     ϕ  d   subscript  μ  k     M        \int_{E}f_{k}\,d\mu_{k}\geq(1-\epsilon)\int_{E}\phi\,d\mu_{k}-\int_{A-A_{k}}%
 \phi\,d\mu_{k}\geq\int_{E}\phi\,d\mu_{k}-\epsilon\left(\int_{E}\phi\,d\mu_{k}+%
 M\right).   Hence, sending ε to 0 and taking the liminf in n, we get that         lim inf   n  →  ∞      ∫  E      f  n    d   μ  k      ≥    ∫  E     ϕ   d  μ     ,        subscript  limit-infimum   normal-→  n       subscript   E      subscript  f  n   d   subscript  μ  k        subscript   E     ϕ  d  μ      \liminf_{n\rightarrow\infty}\int_{E}f_{n}\,d\mu_{k}\geq\int_{E}\phi\,d\mu,   completing the proof.       Fatou's lemma for conditional expectations  In probability theory , by a change of notation, the above versions of Fatou's lemma are applicable to sequences of random variables  X 1 , X 2 , . . . defined on a probability space     (  Ω  ,  ℱ  ,  ℙ  )     normal-Ω  ℱ  ℙ    \scriptstyle(\Omega,\,\mathcal{F},\,\mathbb{P})   ; the integrals turn into expectations . In addition, there is also a version for conditional expectations .  Standard version  Let X 1 , X 2 , . . . be a sequence of non-negative random variables on a probability space    (  Ω  ,  ℱ  ,  ℙ  )     normal-Ω  ℱ  ℙ    \scriptstyle(\Omega,\mathcal{F},\mathbb{P})   and let     𝒢   ⊂  ℱ      𝒢  ℱ    \scriptstyle\mathcal{G}\,\subset\,\mathcal{F}   be a sub- σ-algebra . Then      𝔼   [   lim inf   n  →  ∞      X  n    |  𝒢  ]   ≤    lim inf   n  →  ∞     𝔼   [   X  n   |  𝒢  ]      fragments  E   fragments  normal-[   subscript  limit-infimum   normal-→  n      subscript  X  n   normal-|  G  normal-]     subscript  limit-infimum   normal-→  n     E   fragments  normal-[   subscript  X  n   normal-|  G  normal-]     \mathbb{E}\Bigl[\liminf_{n\to\infty}X_{n}\,\Big|\,\mathcal{G}\Bigr]\leq\liminf%
 _{n\to\infty}\,\mathbb{E}[X_{n}|\mathcal{G}]    almost surely .  Note: Conditional expectation for non-negative random variables is always well defined, finite expectation is not needed.  Proof  Besides a change of notation, the proof is very similar to the one for the standard version of Fatou's lemma above, however the monotone convergence theorem for conditional expectations has to be applied.  Let X denote the limit inferior of the X n . For every natural number k define pointwise the random variable        Y  k   =    inf   n  ≥  k     X  n     .       subscript  Y  k     subscript  infimum    n  k     subscript  X  n      Y_{k}=\inf_{n\geq k}X_{n}.   Then the sequence Y 1 , Y 2 , . . . is increasing and converges pointwise to X . For k ≤ n , we have Y k ≤ X n , so that      𝔼   [   Y  k   |  𝒢  ]   ≤  𝔼   [   X  n   |  𝒢  ]      fragments  E   fragments  normal-[   subscript  Y  k   normal-|  G  normal-]    E   fragments  normal-[   subscript  X  n   normal-|  G  normal-]     \mathbb{E}[Y_{k}|\mathcal{G}]\leq\mathbb{E}[X_{n}|\mathcal{G}]   almost surely by the monotonicity of conditional expectation , hence      𝔼   [   Y  k   |  𝒢  ]   ≤   inf   n  ≥  k    𝔼   [   X  n   |  𝒢  ]      fragments  E   fragments  normal-[   subscript  Y  k   normal-|  G  normal-]     subscript  infimum    n  k    E   fragments  normal-[   subscript  X  n   normal-|  G  normal-]     \mathbb{E}[Y_{k}|\mathcal{G}]\leq\inf_{n\geq k}\mathbb{E}[X_{n}|\mathcal{G}]   almost surely, because the countable union of the exceptional sets of probability zero is again a null set . Using the definition of X , its representation as pointwise limit of the Y k , the monotone convergence theorem for conditional expectations, the last inequality, and the definition of the limit inferior, it follows that almost surely      𝔼   [   lim inf   n  →  ∞      X  n    |  𝒢  ]      fragments  E   fragments  normal-[   subscript  limit-infimum   normal-→  n      subscript  X  n   normal-|  G  normal-]     \displaystyle\mathbb{E}\Bigl[\liminf_{n\to\infty}X_{n}\,\Big|\,\mathcal{G}\Bigr]     Extension to uniformly integrable negative parts  Let X 1 , X 2 , . . . be a sequence of random variables on a probability space    (  Ω  ,  ℱ  ,  ℙ  )     normal-Ω  ℱ  ℙ    \scriptstyle(\Omega,\mathcal{F},\mathbb{P})   and let     𝒢   ⊂  ℱ      𝒢  ℱ    \scriptstyle\mathcal{G}\,\subset\,\mathcal{F}   be a sub- σ-algebra . If the negative parts         X  n  -   :=   max   {   -   X  n    ,  0  }     ,   n  ∈  ℕ    ,     formulae-sequence   assign   superscript   subscript  X  n          subscript  X  n    0      n  ℕ     X_{n}^{-}:=\max\{-X_{n},0\},\qquad n\in{\mathbb{N}},     are uniformly integrable with respect to the conditional expectation, in the sense that, for ε > 0 there exists a c > 0 such that      𝔼   [   X  n  -     1   {   X  n  -   >  c  }     |  𝒢  ]   <  ε  ,  for all  n  ∈  ℕ  ,  almost surely     fragments  E   fragments  normal-[   superscript   subscript  X  n      subscript  1   fragments  normal-{   superscript   subscript  X  n      c  normal-}    normal-|  G  normal-]    ε  normal-,  for all  n   N  normal-,  almost surely    \mathbb{E}\bigl[X_{n}^{-}1_{\{X_{n}^{-}>c\}}\,|\,\mathcal{G}\bigr]<\varepsilon%
 ,\qquad\text{for all }n\in\mathbb{N},\,\text{almost surely}   , then      𝔼   [   lim inf   n  →  ∞      X  n    |  𝒢  ]   ≤    lim inf   n  →  ∞     𝔼   [   X  n   |  𝒢  ]      fragments  E   fragments  normal-[   subscript  limit-infimum   normal-→  n      subscript  X  n   normal-|  G  normal-]     subscript  limit-infimum   normal-→  n     E   fragments  normal-[   subscript  X  n   normal-|  G  normal-]     \mathbb{E}\Bigl[\liminf_{n\to\infty}X_{n}\,\Big|\,\mathcal{G}\Bigr]\leq\liminf%
 _{n\to\infty}\,\mathbb{E}[X_{n}|\mathcal{G}]   almost surely.  Note: On the set where      X  :=    lim inf   n  →  ∞     X  n       assign  X    subscript  limit-infimum   normal-→  n      subscript  X  n      X:=\liminf_{n\to\infty}X_{n}     satisfies      𝔼   [  max   {  X  ,  0  }   |  𝒢  ]   =  ∞  ,     fragments  E   fragments  normal-[    fragments  normal-{  X  normal-,  0  normal-}   normal-|  G  normal-]     normal-,    \mathbb{E}[\max\{X,0\}\,|\,\mathcal{G}]=\infty,     the left-hand side of the inequality is considered to be plus infinity. The conditional expectation of the limit inferior might not be well defined on this set, because the conditional expectation of the negative part might also be plus infinity.  Proof  Let ε > 0. Due to uniform integrability with respect to the conditional expectation, there exists a c > 0 such that      𝔼   [   X  n  -     1   {   X  n  -   >  c  }     |  𝒢  ]   <  ε  for all  n  ∈  ℕ  ,  almost surely  .     fragments  E   fragments  normal-[   superscript   subscript  X  n      subscript  1   fragments  normal-{   superscript   subscript  X  n      c  normal-}    normal-|  G  normal-]    ε  italic-  for all  n   N  normal-,  almost surely  normal-.    \mathbb{E}\bigl[X_{n}^{-}1_{\{X_{n}^{-}>c\}}\,|\,\mathcal{G}\bigr]<\varepsilon%
 \qquad\text{for all }n\in\mathbb{N},\,\text{almost surely}.     Since        X  +  c   ≤    lim inf   n  →  ∞      (    X  n   +  c   )   +     ,        X  c     subscript  limit-infimum   normal-→  n      superscript     subscript  X  n   c        X+c\leq\liminf_{n\to\infty}(X_{n}+c)^{+},     where x + := max{ x ,0} denotes the positive part of a real x , monotonicity of conditional expectation (or the above convention) and the standard version of Fatou's lemma for conditional expectations imply      𝔼   [   X   |  𝒢  ]   +  c  ≤  𝔼   [   lim inf   n  →  ∞       (   X  n   +  c  )   +    |  𝒢  ]   ≤   lim inf   n  →  ∞    𝔼   [     (   X  n   +  c  )   +    |  𝒢  ]      fragments  E   fragments  normal-[  X  normal-|  G  normal-]    c   E   fragments  normal-[   subscript  limit-infimum   normal-→  n      superscript   fragments  normal-(   subscript  X  n    c  normal-)     normal-|  G  normal-]     subscript  limit-infimum   normal-→  n     E   fragments  normal-[   superscript   fragments  normal-(   subscript  X  n    c  normal-)     normal-|  G  normal-]     \mathbb{E}[X\,|\,\mathcal{G}]+c\leq\mathbb{E}\Bigl[\liminf_{n\to\infty}(X_{n}+%
 c)^{+}\,\Big|\,\mathcal{G}\Bigr]\leq\liminf_{n\to\infty}\mathbb{E}[(X_{n}+c)^{%
 +}\,|\,\mathcal{G}]   almost surely.  Since         (    X  n   +  c   )   +   =    (    X  n   +  c   )   +    (    X  n   +  c   )   -    ≤    X  n   +  c  +    X  n  -    1   {   X  n  -   >  c  }       ,         superscript     subscript  X  n   c          subscript  X  n   c    superscript     subscript  X  n   c              subscript  X  n   c     superscript   subscript  X  n      subscript  1   fragments  normal-{   superscript   subscript  X  n      c  normal-}         (X_{n}+c)^{+}=(X_{n}+c)+(X_{n}+c)^{-}\leq X_{n}+c+X_{n}^{-}1_{\{X_{n}^{-}>c\}},     we have      𝔼   [     (   X  n   +  c  )   +    |  𝒢  ]   ≤  𝔼   [    X  n    |  𝒢  ]   +  c  +  ε     fragments  E   fragments  normal-[   superscript   fragments  normal-(   subscript  X  n    c  normal-)     normal-|  G  normal-]    E   fragments  normal-[   subscript  X  n   normal-|  G  normal-]    c   ε    \mathbb{E}[(X_{n}+c)^{+}\,|\,\mathcal{G}]\leq\mathbb{E}[X_{n}\,|\,\mathcal{G}]%
 +c+\varepsilon   almost surely,  hence      𝔼   [   X   |  𝒢  ]   ≤   lim inf   n  →  ∞    𝔼   [    X  n    |  𝒢  ]   +  ε     fragments  E   fragments  normal-[  X  normal-|  G  normal-]     subscript  limit-infimum   normal-→  n     E   fragments  normal-[   subscript  X  n   normal-|  G  normal-]    ε    \mathbb{E}[X\,|\,\mathcal{G}]\leq\liminf_{n\to\infty}\mathbb{E}[X_{n}\,|\,%
 \mathcal{G}]+\varepsilon   almost surely.  This implies the assertion.  References     External links     "  Category:Inequalities  Category:Lemmas  Category:Theorems in measure theory  Category:Real analysis  Category:Articles containing proofs   



Partition function (statistical mechanics)




Partition function (statistical mechanics)

In physics, a partition function describes the statistical properties of a system in thermodynamic equilibrium. They are functions of temperature and other parameters, such as the volume enclosing a gas. Most of the aggregate thermodynamic variables of the system, such as the total energy, free energy, entropy, and pressure, can be expressed in terms of the partition function or its derivatives.
There are actually several different types of partition functions, each corresponding to different types of statistical ensemble (or, equivalently, different types of free energy.) The canonical partition function applies to a canonical ensemble, in which the system is allowed to exchange heat with the environment at fixed temperature, volume, and number of particles. The grand canonical partition function applies to a grand canonical ensemble, in which the system can exchange both heat and particles with the environment, at fixed temperature, volume, and chemical potential. Other types of partition functions can be defined for different circumstances; see partition function (mathematics) for generalizations.
Canonical partition function
Definition
As a beginning assumption, assume that a thermodynamically large system is in thermal contact with the environment, with a temperature T, and both the volume of the system and the number of constituent particles are fixed. This kind of system is called a canonical ensemble. The appropriate mathematical expression for the canonical partition function depends on the degrees of freedom of the system, whether the context is classical mechanics or quantum mechanics, and whether the spectrum of states is discrete or continuous.
Classical discrete system
For a canonical ensemble that is classical and discrete, the canonical partition function is defined as
$$Z = \sum_{s} \mathrm{e}^{- \beta E_s}$$ where
$$s$$ is the index for the microstates of the system,
$$\beta$$ is the thermodynamic beta defined as $\tfrac{1}{k_B T}$,
$$E_s$$ is the total energy of the system in the respective microstate.
Classical continuous system
For a canonical ensemble that is classical and continuous, the canonical partition function is defined as
$$Z = \frac{1}{h^3} \int \mathrm{e}^{- \beta H(q,p)} ~d^{3}q ~d^{3}p$$ where
$$h$$ is the Planck constant,
$$\beta$$ is the thermodynamic beta defined as $\tfrac{1}{k_B T}$,
$$H(q,p)$$ is the Hamiltonian of the system,
$$q$$ is the canonical position,
$$p$$ is the canonical momentum.
Quantum mechanical discrete system
For a canonical ensemble that is quantum mechanical and discrete, the canonical partition function is defined as
$$Z = \operatorname{tr} (\mathrm{e}^{- \beta \hat{H}})$$ where
$$\beta$$ is the thermodynamic beta defined as $\tfrac{1}{k_B T}$,
$$\hat{H}$$ is the Hamiltonian operator.
Quantum mechanical continuous system
For a canonical ensemble that is quantum mechanical and continuous, the canonical partition function is defined as:
$$Z = \frac{1}{h} \int \langle q,p | \mathrm{e}^{- \beta \hat{H}} | q,p \rangle ~dq ~dp$$ where
$$h$$ is the Planck constant,
$$\beta$$ is the thermodynamic beta defined as $\tfrac{1}{k_B T}$,
$$\hat{H}$$ is the Hamiltonian operator,
$$q$$ is the canonical position,
$$p$$ is the canonical momentum.
The exponential factor exp(−βEs) is known as the Boltzmann factor.
In systems with multiple quantum states s sharing the same Es, it is said that the energy levels of the system are degenerate. In the case of degenerate energy levels, we can write the partition function in terms of the contribution from energy levels (indexed by j) as follows:
$$Z = \sum_{j} g_j \cdot \mathrm{e}^{- \beta E_j}$$,
where gj is the degeneracy factor, or number of quantum states s which have the same energy level defined by Ej = Es.
The above treatment applies to quantum statistical mechanics, where a physical system inside a finite-sized box will typically have a discrete set of energy eigenstates, which we can use as the states s above. In classical statistical mechanics, it is not really correct to express the partition function as a sum of discrete terms, as we have done. In classical mechanics, the position and momentum variables of a particle can vary continuously, so the set of microstates is actually uncountable. In this case we must describe the partition function using an integral rather than a sum. For instance, the partition function of a gas of N identical classical particles is
$$Z=\frac{1}{N! h^{3N}} \int \, \exp[-\beta H(p_1 \cdots p_N, x_1
 \cdots x_N)] \;  d^3p_1 \cdots  d^3p_N \,  d^3x_1 \cdots  d^3x_N$$
where

pi indicate particle momenta
 
xi indicate particle positions
 
d3 is a shorthand notation serving as a reminder that the pi and xi are vectors in three-dimensional space, and
 
H is the classical Hamiltonian.
 

The reason for the factorial factor N! is discussed below. For simplicity, we will use the discrete form of the partition function in this article. Our results will apply equally well to the continuous form. The extra constant factor introduced in the denominator was introduced because, unlike the discrete form, the continuous form shown above is not dimensionless. To make it into a dimensionless quantity, we must divide it by h3N where h is some quantity with units of action (usually taken to be Planck's constant).
In quantum mechanics, the partition function can be more formally written as a trace over the state space (which is independent of the choice of basis):
$$Z = \operatorname{tr} ( \mathrm{e} ^{-\beta\hat{H}} )$$ ,
where Ĥ is the quantum Hamiltonian operator. The exponential of an operator can be defined using the exponential power series. The classical form of Z is recovered when the trace is expressed in terms of coherent states 1 and when quantum-mechanical uncertainties in the position and momentum of a particle are regarded as negligible. Formally, one inserts under the trace for each degree of freedom the identity:
$$\boldsymbol{1} = \int |x,p\rangle\,\langle x,p|~\frac{ dx\, dp}{h}$$ where $|$x, p$\rangle$ is a normalised Gaussian wavepacket centered at position x and momentum p. Thus,
$$Z = \int \operatorname{tr} \left(  \mathrm{e}^{-\beta\hat{H}}  |x,p\rangle\,\langle x,p| \right)
   \frac{ dx\, dp}{h}
   = \int\langle x,p| \mathrm{e} ^{-\beta\hat{H}}|x,p\rangle ~\frac{ dx\, dp}{h}$$ A coherent state is an approximate eigenstate of both operators $\hat{x}$ and $\hat{p}$, hence also of the Hamiltonian Ĥ, with errors of the size of the uncertainties. If Δx and Δp can be regarded as zero, the action of Ĥ reduces to multiplication by the classical Hamiltonian, and Z reduces to the classical configuration integral.
Consider a system S embedded into a heat bath B. Let the total energy of both systems be E. Let pi denote the probability that the system S is in microstate i with energy Ei. According to the fundamental postulate of statistical mechanics (which states that all attainable microstates of a system are equally probable), the probability pi will be proportional to the number of microstates in the total closed system where S is in microstate i with energy Ei. Equivalently, pi will be proportional to the number of microstates of the heat bath B with energy E - Ei:
$\begin{align}
 p_i = \Omega \left(E - E_i\right) \\
 \end{align}$
The number of microstates of the heat bath at a given energy E is denoted by Ω(E). Assuming that the heat bath's internal energy is much larger than the energy of S (E>>Ei), we can Taylor expand Ω to first order in Ei and use the thermodynamic relation $\partial S/\partial E = 1/T$:
$\begin{align}
 k \ln p_i = k \ln \Omega \left( E - E_i \right) & \approx k \ln \Omega \left(E\right) - \frac{\partial\left(k \ln \Omega\left(E\right)\right)}{\partial E}  E_i \\
 & \approx k \ln \Omega \left(E\right) - \frac{\partial S_B}{\partial E}  E_i \\
 & \approx k \ln \Omega \left(E\right) - \frac{E_i}{T} \\
 
 \Rightarrow k \ln p_i & \propto k \ln \Omega \left(E\right) - \frac{E_i}{T} \\
 \Rightarrow  p_i & \propto   e^{\ln \Omega \left(E\right) - \frac{E_i}{kT}} \\
 \Rightarrow  p_i & \propto   \Omega \left(E\right) e^{ - \frac{E_i}{kT}} \\
 \Rightarrow  p_i & \propto   e^{- \frac{E_i}{kT}}.
 \end{align}$
Since the total probability to find the system in some microstate (the sum of all pi) must be equal to 1, we can define the partition function as the normalisation constant:
$\begin{align}
 Z & :=  \sum_i  e^{- \beta E_i} 
 \end{align}$ 
Meaning and significance
It may not be obvious why the partition function, as we have defined it above, is an important quantity. First, let us consider what goes into it. The partition function is a function of the temperature T and the microstate energies E1, E2, E3, etc. The microstate energies are determined by other thermodynamic variables, such as the number of particles and the volume, as well as microscopic quantities like the mass of the constituent particles. This dependence on microscopic variables is the central point of statistical mechanics. With a model of the microscopic constituents of a system, one can calculate the microstate energies, and thus the partition function, which will then allow us to calculate all the other thermodynamic properties of the system.
The partition function can be related to thermodynamic properties because it has a very important statistical meaning. The probability Ps that the system occupies microstate s is
$$P_s = \frac{1}{Z} \mathrm{e}^{- \beta E_s}.$$
Thus, as shown above, the partition function plays the role of a normalizing constant (note that it does not depend on s), ensuring that the probabilities sum up to one:
$$\sum_s P_s = \frac{1}{Z} \sum_s \mathrm{e}^{- \beta E_s} = \frac{1}{Z} Z
 = 1.$$
This is the reason for calling Z the "partition function": it encodes how the probabilities are partitioned among the different microstates, based on their individual energies. The letter Z stands for the German word Zustandssumme, "sum over states". The usefulness of the partition function stems from the fact that it can be used to relate macroscopic thermodynamic quantities to the microscopic details of a system through the derivatives of its partition function.
Calculating the thermodynamic total energy
In order to demonstrate the usefulness of the partition function, let us calculate the thermodynamic value of the total energy. This is simply the expected value, or ensemble average for the energy, which is the sum of the microstate energies weighted by their probabilities:
$$\langle E \rangle = \sum_s E_s P_s = \frac{1}{Z} \sum_s E_s
 e^{- \beta E_s} = - \frac{1}{Z} \frac{\partial}{\partial \beta}
 Z(\beta, E_1, E_2, \cdots) = - \frac{\partial \ln Z}{\partial \beta}$$
or, equivalently,
$$\langle E\rangle = k_B T^2 \frac{\partial \ln Z}{\partial T}.$$
Incidentally, one should note that if the microstate energies depend on a parameter λ in the manner
$$E_s = E_s^{(0)} + \lambda A_s \qquad \mbox{for all}\; s$$
then the expected value of A is
$$\langle A\rangle = \sum_s A_s P_s = -\frac{1}{\beta}
 \frac{\partial}{\partial\lambda} \ln Z(\beta,\lambda).$$
This provides us with a method for calculating the expected values of many microscopic quantities. We add the quantity artificially to the microstate energies (or, in the language of quantum mechanics, to the Hamiltonian), calculate the new partition function and expected value, and then set λ to zero in the final expression. This is analogous to the source field method used in the path integral formulation of quantum field theory.
Derivation
According to the second law of thermodynamics, a system assumes a configuration of maximum entropy at thermodynamic equilibrium. We seek a probability distribution of states $p_i$ which maximizes the entropy
$$S = - k_B \sum_i p_i \ln(p_i)$$
subject to two physical constraints:

1. The probabilities of all states add to unity.
 



$\sum_i p_i = 1$





2. In the canonical ensemble, the average energy is fixed.
 



$\langle E \rangle = \sum_i p_i E_i = U$




Using the method of Lagrange multipliers, we rewrite $S$ as:
$$S = - k_B \sum_i p_i \ln(p_i) + \lambda_1 (\sum_i p_i - 1) + \lambda_2 (\sum_i p_i E_i - U)$$
To immediately obtain $\lambda_2$, we differentiate $S$ with respect to the average energy $U$ and apply the first law of thermodynamics:
$$\frac{\partial S}{\partial U} = -\lambda_2 = \frac{1}{T}$$
Differentiating and extremizing $S$ with respect to $p_i$ leads to:
$$\begin{align}
 0 & = \frac{\partial S}{\partial p_i} =  -k_B \ln(p_i) - k_B + \lambda_1 - \frac{E_i}{T}
 \end{align}$$
Isolating for $p_i$ yields:
$$\begin{align}
 p_i & = \mathrm{e}^{\frac{1}{k_B} (-1 + \lambda_1 - \frac{E_i}{T})} \\
 & = \mathrm{e}^{\frac{1}{k_B} (-1 + \lambda_1)} \mathrm{e}^{-\beta E_i}
 \end{align}$$
where $\beta := \frac{1}{k_B T}$. To obtain $\lambda_1$, we substitute the probability into the first constraint:
$$\begin{align}
 1 & = \sum_i p_i \\
 & = \mathrm{e}^{\frac{1}{k_B} (-1 + \lambda_1)} \sum_i \mathrm{e}^{-\beta E_i}
 \end{align}$$
$$\mathrm{e}^{\frac{1}{k_B} (-1 + \lambda_1)} = \frac{1}{\sum_i \mathrm{e}^{-\beta E_i}}$$
We now define the partition function:
$$Z = \sum_i \mathrm{e}^{-\beta E_i}$$
Rewriting $p_i$ in terms of $Z$ gives:
$$\begin{align}
 p_i & = \mathrm{e}^{\frac{1}{k_B} (-1 + \lambda_1)} \mathrm{e}^{-\beta E_i} \\
 & = \frac{1}{Z} \mathrm{e}^{-\beta E_i}
 \end{align}$$
Rewriting $U$ in terms of $Z$ gives:
$$\begin{align}
 U & = \sum_i p_i E_i \\
 & = \frac{1}{Z} \sum_i \mathrm{e}^{-\beta E_i} E_i
 \end{align}$$
Finally, rewriting $S$ in terms of $Z$ gives:
$$\begin{align}
 S & = - k_B \sum_i p_i \ln(p_i) \\
 & = \frac{k_B}{Z} \sum_i \mathrm{e}^{-\beta E_i} (\beta E_i + \ln(Z)) \\
 & = \frac{U}{T} + k_B \ln(Z)
 \end{align}$$
Relation to thermodynamic variables
In this section, we will state the relationships between the partition function and the various thermodynamic parameters of the system. These results can be derived using the method of the previous section and the various thermodynamic relations.
As we have already seen, the thermodynamic energy is
$$\langle E \rangle = - \frac{\partial \ln Z}{\partial \beta}.$$
The variance in the energy (or "energy fluctuation") is
$$\langle (\Delta E)^2 \rangle \equiv \langle (E - \langle
 E\rangle)^2 \rangle = \frac{\partial^2 \ln Z}{\partial \beta^2}.$$
The heat capacity is
$$C_v = \frac{\partial \langle E\rangle}{\partial T} = \frac{1}{k_B T^2} \langle (\Delta E)^2 \rangle.$$
The entropy is
$$S \equiv -k_B\sum_s P_s\ln P_s= k_B (\ln Z + \beta \langle E\rangle)=\frac{\partial}{\partial T}(k_B T \ln Z) =-\frac{\partial A}{\partial T}$$
where A is the Helmholtz free energy defined as A = U − TS, where U = $\langle$E$\rangle$ is the total energy and S is the entropy, so that
$$A = \langle E\rangle -TS= - k_B T \ln Z.$$
Partition functions of subsystems
Suppose a system is subdivided into N sub-systems with negligible interaction energy, that is, we can assume the particles are essentially non-interacting. If the partition functions of the sub-systems are ζ1, ζ2, ..., ζN, then the partition function of the entire system is the product of the individual partition functions:
$$Z =\prod_{j=1}^{N} \zeta_j.$$
If the sub-systems have the same physical properties, then their partition functions are equal, ζ1 = ζ2 = ... = ζ, in which case
$$Z = \zeta^N.$$
However, there is a well-known exception to this rule. If the sub-systems are actually identical particles, in the quantum mechanical sense that they are impossible to distinguish even in principle, the total partition function must be divided by a N! (N factorial):
$$Z = \frac{\zeta^N}{N!}.$$
This is to ensure that we do not "over-count" the number of microstates. While this may seem like a strange requirement, it is actually necessary to preserve the existence of a thermodynamic limit for such systems. This is known as the Gibbs paradox.
Grand canonical partition function
We can define a grand canonical partition function for a grand canonical ensemble, which describes the statistics of a constant-volume system that can exchange both heat and particles with a reservoir. The reservoir has a constant temperature T, and a chemical potential μ.
The grand canonical partition function, denoted by $\mathcal{Z}$, is the following sum over microstates
$$\mathcal{Z}(\mu, V, T) = \sum_{i} \exp((N_i\mu - E_i)/k_B T).$$ Here, each microstate is labelled by $i$, and has total particle number $N_i$ and total energy $E_i$. This partition function is closely related to the Grand potential, $\Phi_{\rm G}$, by the relation
$$-k_B T \ln \mathcal{Z} = \Phi_{\rm G} = \langle E \rangle - TS - \mu \langle N\rangle.$$ This can be contrasted to the canonical partition function above, which is related instead to the Helmholtz free energy.
It is important to note that the number of microstates in the grand canonical ensemble may be much larger than in the canonical ensemble, since here we consider not only variations in energy but also in particle number. Again, the utility of the grand canonical partition function is that it is related to the probability that the system is in state $i$:
$$p_i = \frac{1}{\mathcal Z} \exp((N_i\mu - E_i)/k_B T) .$$
An important application of the grand canonical ensemble is in deriving exactly the statistics of a non-interacting many-body quantum gas (Fermi–Dirac statistics for fermions, Bose–Einstein statistics for bosons), however it is much more generally applicable than that. The grand canonical ensemble may also be used to describe classical systems, or even interacting quantum gases.
The grand partition function is sometimes written (equivalently) in terms of alternate variables as2
$$\mathcal{Z}(z, V, T) = \sum_{N_i} z^{N_i} Z(N_i, V, T),$$ where $z \equiv \exp(\mu/kT)$ is known as the activity or fugacity and $Z(N_i, V, T)$ is the canonical partition function.
See also

Partition function (mathematics)
Partition function (quantum field theory)
Virial theorem
Widom insertion method

References



Huang, Kerson, "Statistical Mechanics", John Wiley & Sons, New York, 1967.
A. Isihara, "Statistical Physics", Academic Press, New York, 1971.
Kelly, James J, (Lecture notes)
L. D. Landau and E. M. Lifshitz, "Statistical Physics, 3rd Edition Part 1", Butterworth-Heinemann, Oxford, 1996.
Vu-Quoc, L., Configuration integral, 2008

"
Category:Concepts in physics  



J. R. Klauder, B.-S. Skagerstam, Coherent States --- Applications in Physics and Mathematical Physics, World Scientific, 1985, p. 71-73.↩
↩





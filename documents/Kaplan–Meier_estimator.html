<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1968">Kaplan–Meier estimator</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Kaplan–Meier estimator</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>An example of a Kaplan–Meier plot for two conditions associated with patient survival.</figcaption>
</figure>

<p>The <strong>Kaplan–Meier estimator</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> also known as the <strong>product limit estimator</strong>, is a <a href="non-parametric_statistics" title="wikilink">non-parametric</a> <a class="uri" href="statistic" title="wikilink">statistic</a> used to estimate the <a href="survival_function" title="wikilink">survival function</a> from lifetime data. In medical research, it is often used to measure the fraction of patients living for a certain amount of time after treatment. In other fields, Kaplan–Meier estimators may be used to measure the length of time people remain unemployed after a job loss,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> the time-to-failure of machine parts, or how long fleshy fruits remain on plants before they are removed by <a href="Frugivore" title="wikilink">frugivores</a>. The <a class="uri" href="estimator" title="wikilink">estimator</a> is named after <a href="Edward_L._Kaplan" title="wikilink">Edward L. Kaplan</a> and <a href="Paul_Meier_(statistician)" title="wikilink">Paul Meier</a>, who each submitted similar manuscripts to the <em><a href="Journal_of_the_American_Statistical_Association" title="wikilink">Journal of the American Statistical Association</a></em>. The journal editor, <a href="John_Tukey" title="wikilink">John Tukey</a>, convinced them to combine their work into one paper, which has been cited about 34,000 times since its publication.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="basic-concepts">Basic concepts</h2>

<p>A plot of the Kaplan–Meier estimator is a series of declining horizontal steps which, with a large enough sample size, approaches the true survival function for that population. The value of the survival function between successive distinct sampled observations ("clicks") is assumed to be constant.</p>

<p>An important advantage of the Kaplan–Meier curve is that the method can take into account some types of <a href="Censoring_(statistics)" title="wikilink">censored data</a>, particularly <em>right-censoring</em>, which occurs if a patient withdraws from a study, is lost to follow-up, or is alive without event occurrence at last follow-up. On the plot, small vertical tick-marks indicate individual patients whose survival times have been right-censored. When no truncation or censoring occurs, the Kaplan–Meier curve is the complement of the <a href="empirical_distribution_function" title="wikilink">empirical distribution function</a>.</p>

<p>In <a href="medical_statistics" title="wikilink">medical statistics</a>, a typical application might involve grouping patients into categories, for instance, those with Gene A profile and those with Gene B profile. In the graph, patients with Gene B die much more quickly than those with gene A. After two years, about 80% of the Gene A patients survive, but less than half of patients with Gene B.</p>

<p>In order to generate a Kaplan–Meier estimator, at least two pieces of data are required for each patient (or each subject): the status at last observation (event occurrence or right-censored) and the time to event (or time to censoring). If the survival functions between two or more groups are to be compared, then a third piece of data is required: the group assignment of each subject.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="formulation">Formulation</h2>

<p>Let <em>S</em>(<em>t</em>) be the probability that a member from a given population will have a lifetime exceeding time, <em>t</em>. For a sample of size <em>N</em> from this population, let the observed times until death of the <em>N</em> sample members be</p>

<p>

<math display="block" id="Kaplan–Meier_estimator:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>t</mi>
     <mn>1</mn>
    </msub>
    <mo>≤</mo>
    <msub>
     <mi>t</mi>
     <mn>2</mn>
    </msub>
    <mo>≤</mo>
    <msub>
     <mi>t</mi>
     <mn>3</mn>
    </msub>
    <mo>≤</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>≤</mo>
    <msub>
     <mi>t</mi>
     <mi>N</mi>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <cn type="integer">3</cn>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>normal-⋯</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>t</ci>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{1}\leq t_{2}\leq t_{3}\leq\cdots\leq t_{N}.
  </annotation>
 </semantics>
</math>

</p>

<p>Corresponding to each <em>t</em><sub><em>i</em></sub> is <em>n</em><sub><em>i</em></sub>, the number "at risk" just prior to time <em>t</em><sub><em>i</em></sub>, and <em>d</em><sub><em>i</em></sub>, the number of deaths at time <em>t</em><sub><em>i</em></sub>.</p>

<p>Note that the intervals between events are typically not uniform. For example, a small data set might begin with 10 cases. Suppose subject 1 dies on day 3, subjects 2 and 3 die on day 11 and subject 4 is <a href="lost_to_follow-up" title="wikilink">lost to follow-up</a> (censored) at day 9. Data up to day 11 would be as follows.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>

<math display="inline" id="Kaplan–Meier_estimator:1">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

</p></th>
<th style="text-align: left;">
<p>1</p></th>
<th style="text-align: left;">
<p>2</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Kaplan–Meier_estimator:2">
 <semantics>
  <msub>
   <mi>t</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{i}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>11</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Kaplan–Meier_estimator:3">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{i}
  </annotation>
 </semantics>
</math>


</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Kaplan–Meier_estimator:4">
 <semantics>
  <msub>
   <mi>n</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>n</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{i}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p>8</p></td>
</tr>
</tbody>
</table>

<p>The Kaplan–Meier estimator is the <a class="uri" href="nonparametric" title="wikilink">nonparametric</a> maximum likelihood estimate of <em>S</em>(<em>t</em>), where the maximum is taken over the set of all piecewise constant survival curves with breakpoints at the event times <em>t</em><sub><em>i</em></sub>. It is a product of the form</p>

<p>

<math display="block" id="Kaplan–Meier_estimator:5">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>T</mi>
    <mo>></mo>
    <mi>t</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
   <mo>-</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>T</mi>
    <mo>≤</mo>
    <mi>t</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
   <mo>-</mo>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="4.2pt">.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">S</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">T</csymbol>
     <gt></gt>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">1</cn>
    <minus></minus>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">T</csymbol>
     <leq></leq>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">1</cn>
    <minus></minus>
    <csymbol cd="unknown">F</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">t</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S(t)=P[T>t]=1-P[T\leq t]=1-F(t).\,
  </annotation>
 </semantics>
</math>

</p>

<p>The two definitions differ only at the observed event times. The latter definition is <a href="Right_continuous#Directional_continuity" title="wikilink">right-continuous</a> whereas the former definition is left-continuous.</p>

<p>Let <em>T</em> be the random variable that measures the time of failure and let <em>F</em>(<em>t</em>) be its <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a>. Note that</p>

<p>

<math display="inline" id="Kaplan–Meier_estimator:6">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>S</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-^</ci>
     <ci>S</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\hat{S}(t)
  </annotation>
 </semantics>
</math>

</p>

<p>Consequently, the right-continuous definition of 

<math display="block" id="Kaplan–Meier_estimator:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mo>Var</mo>
      <mo>^</mo>
     </mover>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mover accent="true">
        <mi>S</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>S</mi>
      <mo>^</mo>
     </mover>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mi>i</mi>
        </msub>
        <mo>≤</mo>
        <mi>t</mi>
       </mrow>
      </munder>
      <mfrac>
       <msub>
        <mi>d</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <msub>
         <mi>n</mi>
         <mi>i</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>n</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>d</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>Var</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-^</ci>
       <ci>S</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-^</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>t</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <leq></leq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \widehat{\operatorname{Var}}(\widehat{S}(t))=\widehat{S}(t)^{2}\sum\limits_{t_%
{i}\leq t}\frac{d_{i}}{n_{i}(n_{i}-d_{i})}.
  </annotation>
 </semantics>
</math>

 may be preferred in order to make the estimate compatible with a right-continuous estimate of <em>F</em>(<em>t</em>).</p>
<h2 id="statistical-considerations">Statistical considerations</h2>

<p>The Kaplan–Meier estimator is a <a class="uri" href="statistic" title="wikilink">statistic</a>, and several estimators are used to approximate its <a class="uri" href="variance" title="wikilink">variance</a>. One of the most common such estimators is Greenwood's formula:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p><span class="LaTeX">$$\widehat{\operatorname{Var}}( \widehat S(t) ) = \widehat S(t)^2  \sum\limits_{t_i\le t} \frac{d_i}{n_i(n_i-d_i)}.$$</span></p>

<p>In some cases, one may wish to compare different Kaplan–Meier curves. This may be done by several methods including:</p>
<ul>
<li>The <a href="log_rank_test" title="wikilink">log rank test</a></li>
<li>The <a href="proportional_hazards_models" title="wikilink">Cox proportional hazards test</a></li>
</ul>
<h2 id="implementations-in-statistics-packages">Implementations in statistics packages</h2>
<ul>
<li><a href="R_(programming_language)" title="wikilink">R</a>: the Kaplan–Meier estimator is available as part of the <code>survival</code> package.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
<li><a class="uri" href="Stata" title="wikilink">Stata</a>: the command <code>sts</code> returns the Kaplan–Meier estimator.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Nelson–Aalen_estimator" title="wikilink">Nelson–Aalen estimator</a></li>
<li><a href="Median_lethal_dose" title="wikilink">Median lethal dose</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.cancerguide.org/scurve_km.html">Calculating Kaplan–Meier curves by Steve Dunn</a></li>
<li><a href="http://stat.ethz.ch/education/semesters/ss2011/seminar/contents/presentation_2.pdf">Kaplan–Meier Survival Curves and the Log-Rank Test</a></li>
</ul>

<p>"</p>

<p><a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Actuarial_science" title="wikilink">Category:Actuarial science</a> <a href="Category:Survival_analysis" title="wikilink">Category:Survival analysis</a> <a href="Category:Reliability_engineering" title="wikilink">Category:Reliability engineering</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Kaplan, E.L. in a retrospective on the seminal paper in "This week's citation classic". <em>Current Contents</em> <strong>24</strong>, 14 (1983). <a href="http://www.garfield.library.upenn.edu/classics1983/A1983QS51100001.pdf">Available from UPenn as PDF.</a><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

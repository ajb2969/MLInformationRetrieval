   Optimal estimation      Optimal estimation   In applied statistics, optimal estimation is a regularized  matrix  inverse method based on Bayes theorem . It is used very commonly in the geosciences , particularly for atmospheric sounding . A matrix inverse problem looks like this:       ğ€   x  â†’    =   y  â†’         ğ€   normal-â†’  x     normal-â†’  y     \mathbf{A}\vec{x}=\vec{y}   The essential concept is to transform the matrix, A , into a conditional probability and the variables,    x  â†’     normal-â†’  x    \vec{x}   and    y  â†’     normal-â†’  y    \vec{y}   into probability distributions by assuming Gaussian statistics and using empirically-determined covariance matrices.  Derivation  Typically, one expects the statistics of most measurements to be Gaussian . So for example for    P   (   y  â†’   |   x  â†’   )      fragments  P   fragments  normal-(   normal-â†’  y   normal-|   normal-â†’  x   normal-)     P(\vec{y}|\vec{x})   , we can write:      P   (   y  â†’   |   x  â†’   )   =   1     (   2  Ï€   )     m  n   /  2     |   ğ‘º  ğ’š   |     exp   [  -   1  2     (  ğ‘¨   x  â†’   -   y  â†’   )   T    ğ‘º  ğ’š     -  1     (  ğ‘¨   x  â†’   -   y  â†’   )   ]      fragments  P   fragments  normal-(   normal-â†’  y   normal-|   normal-â†’  x   normal-)      1     superscript    2  Ï€       m  n   2       subscript  ğ‘º  ğ’š        fragments  normal-[     1  2    superscript   fragments  normal-(  A   normal-â†’  x     normal-â†’  y   normal-)   T    superscript   subscript  ğ‘º  ğ’š     1     fragments  normal-(  A   normal-â†’  x     normal-â†’  y   normal-)   normal-]     P(\vec{y}|\vec{x})=\frac{1}{(2\pi)^{mn/2}|\boldsymbol{S_{y}}|}\exp\left[-\frac%
 {1}{2}(\boldsymbol{A}\vec{x}-\vec{y})^{T}\boldsymbol{S_{y}}^{-1}(\boldsymbol{A%
 }\vec{x}-\vec{y})\right]     where m and n are the numbers of elements in    x  â†’     normal-â†’  x    \vec{x}   and    y  â†’     normal-â†’  y    \vec{y}   respectively   ğ‘¨   ğ‘¨   \boldsymbol{A}   is the matrix to be solved (the linear or linearised forward model) and    ğ‘º  ğ’š     subscript  ğ‘º  ğ’š    \boldsymbol{S_{y}}   is the covariance matrix of the vector    y  â†’     normal-â†’  y    \vec{y}   . This can be similarly done for    x  â†’     normal-â†’  x    \vec{x}   :       P   (   x  â†’   )    =    1     (   2  Ï€   )    m  /  2     |   ğ‘º   ğ’™  ğ’‚    |      exp   [   -    1  2     (    x  â†’   -    x  a   ^    )   T    ğ‘º   ğ’™  ğ’‚      -  1     (    x  â†’   -    x  a   ^    )     ]           P   normal-â†’  x        1     superscript    2  Ï€     m  2       subscript  ğ‘º   subscript  ğ’™  ğ’‚               1  2    superscript     normal-â†’  x    normal-^   subscript  x  a     T    superscript   subscript  ğ‘º   subscript  ğ’™  ğ’‚      1       normal-â†’  x    normal-^   subscript  x  a           P(\vec{x})=\frac{1}{(2\pi)^{m/2}|\boldsymbol{S_{x_{a}}}|}\exp\left[-\frac{1}{2%
 }(\vec{x}-\widehat{x_{a}})^{T}\boldsymbol{S_{x_{a}}}^{-1}(\vec{x}-\widehat{x_{%
 a}})\right]     Here    P   (   x  â†’   )       P   normal-â†’  x     P(\vec{x})   is taken to be the so-called "a-priori" distribution     x  a   ^     normal-^   subscript  x  a     \widehat{x_{a}}   denotes the a-priori values for    x  â†’     normal-â†’  x    \vec{x}   while    ğ‘º   ğ’™  ğ’‚      subscript  ğ‘º   subscript  ğ’™  ğ’‚     \boldsymbol{S_{x_{a}}}   is its covariance matrix.  The nice thing about the Gaussian distributions is that only two parameters are needed to describe them and so the whole problem can be converted once again to matrices. Assuming that    P   (   x  â†’   |   y  â†’   )      fragments  P   fragments  normal-(   normal-â†’  x   normal-|   normal-â†’  y   normal-)     P(\vec{x}|\vec{y})   takes the following form:      P   (   x  â†’   |   y  â†’   )   =   1     (   2  Ï€   )     m  n   /  2     |   ğ‘º  ğ’™   |     exp   [  -   1  2     (   x  â†’   -   x  ^   )   T    ğ‘º  ğ’™     -  1     (   x  â†’   -   x  ^   )   ]      fragments  P   fragments  normal-(   normal-â†’  x   normal-|   normal-â†’  y   normal-)      1     superscript    2  Ï€       m  n   2       subscript  ğ‘º  ğ’™        fragments  normal-[     1  2    superscript   fragments  normal-(   normal-â†’  x     normal-^  x   normal-)   T    superscript   subscript  ğ‘º  ğ’™     1     fragments  normal-(   normal-â†’  x     normal-^  x   normal-)   normal-]     P(\vec{x}|\vec{y})=\frac{1}{(2\pi)^{mn/2}|\boldsymbol{S_{x}}|}\exp\left[-\frac%
 {1}{2}(\vec{x}-\widehat{x})^{T}\boldsymbol{S_{x}}^{-1}(\vec{x}-\widehat{x})\right]       P   (   y  â†’   )       P   normal-â†’  y     P(\vec{y})   may be neglected since, for a given value of    x  â†’     normal-â†’  x    \vec{x}   , it is simply a constant scaling term. Now it is possible to solve for both the expectation value of    x  â†’     normal-â†’  x    \vec{x}   ,    x  ^     normal-^  x    \widehat{x}   , and for its covariance matrix by equating    P   (   x  â†’   |   y  â†’   )      fragments  P   fragments  normal-(   normal-â†’  x   normal-|   normal-â†’  y   normal-)     P(\vec{x}|\vec{y})   and    P   (   y  â†’   |   x  â†’   )   P   (   x  â†’   )      fragments  P   fragments  normal-(   normal-â†’  y   normal-|   normal-â†’  x   normal-)   P   fragments  normal-(   normal-â†’  x   normal-)     P(\vec{y}|\vec{x})P(\vec{x})   . This produces the following equations:       ğ‘º  ğ’™   =    (     ğ‘¨  T    ğ‘º  ğ’š   -  ğŸ    ğ‘¨   +   ğ‘º   ğ’™  ğ’‚    -  ğŸ     )    -  1         subscript  ğ‘º  ğ’™    superscript       superscript  ğ‘¨  T    superscript   subscript  ğ‘º  ğ’š     1    ğ‘¨    superscript   subscript  ğ‘º   subscript  ğ’™  ğ’‚      1       1      \boldsymbol{S_{x}}=(\boldsymbol{A}^{T}\boldsymbol{S_{y}^{-1}}\boldsymbol{A}+%
 \boldsymbol{S_{x_{a}}^{-1}})^{-1}          x  ^   =     x  a   ^   +    ğ‘º  ğ’™    ğ‘¨  T    ğ‘º  ğ’š     -  1     (    y  â†’   -   ğ‘¨    x  a   ^     )          normal-^  x      normal-^   subscript  x  a       subscript  ğ‘º  ğ’™    superscript  ğ‘¨  T    superscript   subscript  ğ‘º  ğ’š     1       normal-â†’  y     ğ‘¨   normal-^   subscript  x  a          \widehat{x}=\widehat{x_{a}}+\boldsymbol{S_{x}}\boldsymbol{A}^{T}\boldsymbol{S_%
 {y}}^{-1}(\vec{y}-\boldsymbol{A}\widehat{x_{a}})     Because we are using Gaussians, the expected value is equivalent to the maximum likely value, and so this is also a form of maximum likelihood estimation.  Typically with optimal estimation, in addition to the vector of retrieved quantities, one extra matrix is returned along with the covariance matrix. This is sometimes called the resolution matrix or the averaging kernel and is calculated as follows:      ğ‘¹  =     (     ğ‘¨  T    ğ‘º  ğ’š     -  1    ğ‘¨   +   ğ‘º   ğ’™  ğ’‚      -  1     )    -  1     ğ‘¨  T    ğ‘º  ğ’š     -  1    ğ‘¨       ğ‘¹     superscript       superscript  ğ‘¨  T    superscript   subscript  ğ‘º  ğ’š     1    ğ‘¨    superscript   subscript  ğ‘º   subscript  ğ’™  ğ’‚      1       1     superscript  ğ‘¨  T    superscript   subscript  ğ‘º  ğ’š     1    ğ‘¨     \boldsymbol{R}=(\boldsymbol{A}^{T}\boldsymbol{S_{y}}^{-1}\boldsymbol{A}+%
 \boldsymbol{S_{x_{a}}}^{-1})^{-1}\boldsymbol{A}^{T}\boldsymbol{S_{y}}^{-1}%
 \boldsymbol{A}     This tells us, for a given element of the retrieved vector, how much of the other elements of the vector are mixed in. In the case of a retrieval of profile information, it typical indicates the altitude resolution for a given altitude. For instance if the resolution vectors for all the altitudes contain non-zero elements (to a numerical tolerance) in their four nearest neighbours, then the altitude resolution is only one fourth that of the actual grid size.  References           "  Category:Inverse problems  Category:Remote sensing   
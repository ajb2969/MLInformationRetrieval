   Woodbury matrix identity      Woodbury matrix identity   In mathematics (specifically linear algebra ), the Woodbury matrix identity , named after Max A. Woodbury 1 2 says that the inverse of a rank- k correction of some matrix can be computed by doing a rank- k correction to the inverse of the original matrix. Alternative names for this formula are the matrix inversion lemma , Sherman–Morrison–Woodbury formula or just Woodbury formula . However, the identity appeared in several papers before the Woodbury report. 3  The Woodbury matrix identity is 4         (   A  +   U  C  V    )    -  1    =    A   -  1    -    A   -  1    U    (    C   -  1    +   V   A   -  1    U    )    -  1    V   A   -  1       ,       superscript    A    U  C  V      1       superscript  A    1       superscript  A    1    U   superscript     superscript  C    1      V   superscript  A    1    U      1    V   superscript  A    1        \left(A+UCV\right)^{-1}=A^{-1}-A^{-1}U\left(C^{-1}+VA^{-1}U\right)^{-1}VA^{-1},   where A , U , C and V all denote matrices of the correct ( conformable ) sizes. Specifically, A is n -by- n , U is n -by- k , C is k -by- k and V is k -by- n . This can be derived using blockwise matrix inversion .  For a more general formula for which the matrix C need not be invertible or even square , see Binomial inverse theorem .  In the special case where C is the 1-by-1 unit matrix, this identity reduces to the Sherman–Morrison formula . In the special case when C is the identity matrix I , the matrix    I  +   V   A   -  1    U       I    V   superscript  A    1    U     I+VA^{-1}U   is known in numerical linear algebra and numerical partial differential equations as the capacitance matrix . 5  Direct proof  The formula can be proven by checking that    (   A  +   U  C  V    )      A    U  C  V     (A+UCV)   times its alleged inverse on the right side of the Woodbury identity gives the identity matrix:       (   A  +   U  C  V    )    [    A   -  1    -    A   -  1    U    (    C   -  1    +   V   A   -  1    U    )    -  1    V   A   -  1      ]         A    U  C  V     delimited-[]     superscript  A    1       superscript  A    1    U   superscript     superscript  C    1      V   superscript  A    1    U      1    V   superscript  A    1         \displaystyle\left(A+UCV\right)\left[A^{-1}-A^{-1}U\left(C^{-1}+VA^{-1}U\right%
 )^{-1}VA^{-1}\right]     Derivation via blockwise elimination  Deriving the Woodbury matrix identity is easily done by solving the following block matrix inversion problem         [     A    U      V     -   C   -  1        ]    [     X      Y     ]    =   [     I      0     ]    .          A  U    V     superscript  C    1         X    Y       I    0      \begin{bmatrix}A&U\\
 V&-C^{-1}\end{bmatrix}\begin{bmatrix}X\\
 Y\end{bmatrix}=\begin{bmatrix}I\\
 0\end{bmatrix}.   Expanding, we can see that the above reduces to      A  X   +   U  Y    =  I          A  X     U  Y    I    AX+UY=I   and      V  X   -    C   -  1    Y    =  0          V  X      superscript  C    1    Y    0    VX-C^{-1}Y=0   , which is equivalent to      (   A  +   U  C  V    )   X   =  I          A    U  C  V    X   I    (A+UCV)X=I   . Eliminating the first equation, we find that    X  =    A   -  1     (   I  -   U  Y    )        X     superscript  A    1      I    U  Y       X=A^{-1}(I-UY)   , which can be substituted into the second to find     V   A   -  1     (   I  -   U  Y    )    =    C   -  1    Y         V   superscript  A    1      I    U  Y        superscript  C    1    Y     VA^{-1}(I-UY)=C^{-1}Y   . Expanding and rearranging, we have     V   A   -  1     =    (    C   -  1    +   V   A   -  1    U    )   Y         V   superscript  A    1          superscript  C    1      V   superscript  A    1    U    Y     VA^{-1}=(C^{-1}+VA^{-1}U)Y   , or       (    C   -  1    +   V   A   -  1    U    )    -  1    V   A   -  1     =  Y         superscript     superscript  C    1      V   superscript  A    1    U      1    V   superscript  A    1     Y    (C^{-1}+VA^{-1}U)^{-1}VA^{-1}=Y   . Finally, we substitute into our      A  X   +   U  Y    =  I          A  X     U  Y    I    AX+UY=I   , and we have      A  X   +   U    (    C   -  1    +   V   A   -  1    U    )    -  1    V   A   -  1      =  I          A  X     U   superscript     superscript  C    1      V   superscript  A    1    U      1    V   superscript  A    1      I    AX+U(C^{-1}+VA^{-1}U)^{-1}VA^{-1}=I   . Thus,         (   A  +   U  C  V    )    -  1    =  X  =    A   -  1    -    A   -  1    U    (    C   -  1    +   V   A   -  1    U    )    -  1    V   A   -  1       .         superscript    A    U  C  V      1    X          superscript  A    1       superscript  A    1    U   superscript     superscript  C    1      V   superscript  A    1    U      1    V   superscript  A    1         (A+UCV)^{-1}=X=A^{-1}-A^{-1}U\left(C^{-1}+VA^{-1}U\right)^{-1}VA^{-1}.   We have derived the Woodbury matrix identity.  Derivation from LDU decomposition  We start by the matrix      [     A    U      V    C     ]      A  U    V  C     \begin{bmatrix}A&U\\
 V&C\end{bmatrix}   By eliminating the entry under the A (given that A is invertible) we get        [     I    0       -   V   A   -  1        I     ]    [     A    U      V    C     ]    =   [     A    U      0     C  -   V   A   -  1    U       ]           I  0        V   superscript  A    1      I      A  U    V  C       A  U    0    C    V   superscript  A    1    U        \begin{bmatrix}I&0\\
 -VA^{-1}&I\end{bmatrix}\begin{bmatrix}A&U\\
 V&C\end{bmatrix}=\begin{bmatrix}A&U\\
 0&C-VA^{-1}U\end{bmatrix}     Likewise, eliminating the entry above C gives        [     A    U      V    C     ]    [     I     -    A   -  1    U        0    I     ]    =   [     A    0      V     C  -   V   A   -  1    U       ]           A  U    V  C      I       superscript  A    1    U      0  I       A  0    V    C    V   superscript  A    1    U        \begin{bmatrix}A&U\\
 V&C\end{bmatrix}\begin{bmatrix}I&-A^{-1}U\\
 0&I\end{bmatrix}=\begin{bmatrix}A&0\\
 V&C-VA^{-1}U\end{bmatrix}     Now combining the above two, we get        [     I    0       -   V   A   -  1        I     ]    [     A    U      V    C     ]    [     I     -    A   -  1    U        0    I     ]    =   [     A    0      0     C  -   V   A   -  1    U       ]           I  0        V   superscript  A    1      I      A  U    V  C      I       superscript  A    1    U      0  I       A  0    0    C    V   superscript  A    1    U        \begin{bmatrix}I&0\\
 -VA^{-1}&I\end{bmatrix}\begin{bmatrix}A&U\\
 V&C\end{bmatrix}\begin{bmatrix}I&-A^{-1}U\\
 0&I\end{bmatrix}=\begin{bmatrix}A&0\\
 0&C-VA^{-1}U\end{bmatrix}     Moving to the right side gives       [     A    U      V    C     ]   =    [     I    0       V   A   -  1       I     ]    [     A    0      0     C  -   V   A   -  1    U       ]    [     I      A   -  1    U       0    I     ]          A  U    V  C        I  0      V   superscript  A    1     I      A  0    0    C    V   superscript  A    1    U        I     superscript  A    1    U     0  I       \begin{bmatrix}A&U\\
 V&C\end{bmatrix}=\begin{bmatrix}I&0\\
 VA^{-1}&I\end{bmatrix}\begin{bmatrix}A&0\\
 0&C-VA^{-1}U\end{bmatrix}\begin{bmatrix}I&A^{-1}U\\
 0&I\end{bmatrix}   which is the LDU decomposition of the block matrix into an upper triangular, diagonal, and lower triangular matrices.  Now inverting both sides gives       [     A    U      V    C     ]    -  1      superscript    A  U    V  C      1     \displaystyle\begin{bmatrix}A&U\\
 V&C\end{bmatrix}^{-1}     We could equally well have done it the other way (provided that C is invertible) i.e.       [     A    U      V    C     ]   =    [     I     U   C   -  1         0    I     ]    [      A  -   U   C   -  1    V      0      0    C     ]    [     I    0        C   -  1    V     I     ]          A  U    V  C        I    U   superscript  C    1       0  I        A    U   superscript  C    1    V    0    0  C      I  0       superscript  C    1    V   I       \begin{bmatrix}A&U\\
 V&C\end{bmatrix}=\begin{bmatrix}I&UC^{-1}\\
 0&I\end{bmatrix}\begin{bmatrix}A-UC^{-1}V&0\\
 0&C\end{bmatrix}\begin{bmatrix}I&0\\
 C^{-1}V&I\end{bmatrix}     Now again inverting both sides,       [     A    U      V    C     ]    -  1      superscript    A  U    V  C      1     \displaystyle\begin{bmatrix}A&U\\
 V&C\end{bmatrix}^{-1}     Now comparing elements (1,1) of the RHS of (1) and (2) above gives the Woodbury formula         (   A  -   U   C   -  1    V    )    -  1    =    A   -  1    +    A   -  1    U    (   C  -   V   A   -  1    U    )    -  1    V   A   -  1       .       superscript    A    U   superscript  C    1    V      1       superscript  A    1       superscript  A    1    U   superscript    C    V   superscript  A    1    U      1    V   superscript  A    1        \left(A-UC^{-1}V\right)^{-1}=A^{-1}+A^{-1}U(C-VA^{-1}U)^{-1}VA^{-1}.     Applications  This identity is useful in certain numerical computations where A −1 has already been computed and it is desired to compute ( A + UCV ) −1 . With the inverse of A available, it is only necessary to find the inverse of C −1 + VA −1 U in order to obtain the result using the right-hand side of the identity. If C has a much smaller dimension than A , this is more efficient than inverting A + UCV directly. A common case is finding the inverse of a low-rank update A + UCV of A (where U only has a few columns and V only a few rows), or finding an approximation of the inverse of the matrix A + B where the matrix can be approximated by a low-rank matrix UCV , for example using the singular value decomposition .  This is applied, e.g., in the Kalman filter and recursive least squares methods, to replace the parametric solution , requiring inversion of a state vector sized matrix, with a condition equations based solution. In case of the Kalman filter this matrix has the dimensions of the vector of observations, i.e., as small as 1 in case only one new observation is processed at a time. This significantly speeds up the often real time calculations of the filter.  See also   Sherman–Morrison formula  Schur complement  Matrix determinant lemma , formula for a rank- k update to a determinant   Notes     External links   Some matrix identities    "  Category:Linear algebra  Category:Lemmas     Max A. Woodbury, Inverting modified matrices , Memorandum Rept. 42, Statistical Research Group, Princeton University, Princeton, NJ, 1950, 4pp ↩  Max A. Woodbury, The Stability of Out-Input Matrices . Chicago, Ill., 1949. 5 pp. ↩  ↩  ↩      
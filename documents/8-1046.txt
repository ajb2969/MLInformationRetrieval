   Transportation theory (mathematics)      Transportation theory (mathematics)   In mathematics and economics, transportation theory is a name given to the study of optimal transportation and allocation of resources .  The problem was formalized by the French mathematician  Gaspard Monge in 1781. 1  In the 1920s A.N. Tolstoi was one of the first to study the transportation problem mathematically. In 1930, in the collection Transportation Planning Volume I for the National Commissariat of Transportation of the Soviet Union, he published a paper "Methods of Finding the Minimal Kilometrage in Cargo-transportation in space". 2 3  Major advances were made in the field during World War II by the Soviet / Russian  mathematician and economist Leonid Kantorovich . 4 Consequently, the problem as it is stated is sometimes known as the Mongeâ€“Kantorovich transportation problem . 5 The linear programming formulation of the transportation problem is also known as the Hitchcock â€“ Koopmans transportation problem . 6  Motivation  Mines and factories  Suppose that we have a collection of n mines mining iron ore, and a collection of n factories which consume the iron ore that the mines produce. Suppose for the sake of argument that these mines and factories form two disjoint  subsets  M and F of the Euclidean plane  R 2 . Suppose also that we have a cost function  c : R 2 Ã— R 2 â†’Â [0,Â âˆ), so that c ( x , y ) is the cost of transporting one shipment of iron from x to y . For simplicity, we ignore the time taken to do the transporting. We also assume that each mine can supply only one factory (no splitting of shipments) and that each factory requires precisely one shipment to be in operation (factories cannot work at half- or double-capacity). Having made the above assumptions, a transport plan is a bijection  T : M â†’ F . In other words, each mine m âˆˆ M supplies precisely one factory T ( m ) âˆˆ F and each factory is supplied by precisely one mine. We wish to find the optimal transport plan , the plan T whose total cost       c   (  T  )    :=    âˆ‘   m  âˆˆ  M     c   (  m  ,   T   (  m  )    )        assign    c  T     subscript     m  M      c   m    T  m        c(T):=\sum_{m\in M}c(m,T(m))     is the least of all possible transport plans from M to F . This motivating special case of the transportation problem is an instance of the assignment problem . More specifically, it is equivalent to finding a minimum weight matching in a bipartite graph.  Moving books: the importance of the cost function  The following simple example illustrates the importance of the cost function in determining the optimal transport plan. Suppose that we have n books of equal width on a shelf (the real line ), arranged in a single contiguous block. We wish to rearrange them into another contiguous block, but shifted one book-width to the right. Two obvious candidates for the optimal transport plan present themselves:   move all n books one book-width to the right; ("many small moves")  move the left-most book n book-widths to the right and leave all other books fixed. ("one big move")   If the cost function is proportional to Euclidean distance ( c ( x , y )Â =Â Î±| x âˆ’ y |) then these two candidates are both optimal. If, on the other hand, we choose the strictly convex cost function proportional to the square of Euclidean distance ( c ( x , y )Â =Â Î±| x âˆ’ y | 2 ), then the "many small moves" option becomes the unique minimizer.  Interestingly, while mathematicians prefer to work with convex cost functions, economists prefer concave ones. The intuitive justification for this is that once goods have been loaded on to, say, a goods train, transporting the goods 200 kilometres costs much less than twice what it would cost to transport them 100 kilometres. Concave cost functions represent this economy of scale .  Abstract formulation of the problem  Monge and Kantorovich formulations  The transportation problem as it is stated in modern or more technical literature looks somewhat different because of the development of Riemannian geometry and measure theory . The mines-factories example, simple as it is, is a useful reference point when thinking of the abstract case. In this setting, we allow the possibility that we may not wish to keep all mines and factories open for business, and allow mines to supply more than one factory, and factories to accept iron from more than one mine.  Let X and Y be two separable  metric spaces such that any probability measure on X (or Y ) is a Radon measure (i.e. they are Radon spaces ). Let c : X Ã— Y â†’ [0, âˆ] be a Borel- measurable function . Given probability measures Î¼ on X and Î½ on Y , Monge's formulation of the optimal transportation problem is to find a transport map T : X â†’ Y that realizes the infimum       inf   {    âˆ«  X    c   (  x  ,   T   (  x  )    )   d  Î¼   (  x  )     |    T   (  Î¼  )    =  Î½   }    ,     infimum   conditional-set    subscript   X     c   x    T  x    normal-d  Î¼  x        T  Î¼   Î½      \inf\left\{\left.\int_{X}c(x,T(x))\,\mathrm{d}\mu(x)\;\right|\;T(\mu)=\nu%
 \right\},     where T  (Î¼) denotes the push forward of Î¼ by T . A map T that attains this infimum ( i.e. makes it a minimum instead of an infimum) is called an "optimal transport map".  Monge's formulation of the optimal transportation problem can be ill-posed, because sometimes there is no T satisfying T âˆ— (Î¼) = Î½: this happens, for example, when Î¼ is a Dirac measure but Î½ is not).  We can improve on this by adopting Kantorovich's formulation of the optimal transportation problem, which is to find a probability measure Î³ on X Ã— Y that attains the infimum       inf   {    âˆ«   X  Ã—  Y     c   (  x  ,  y  )   d  Î³   (  x  ,  y  )     |   Î³  âˆˆ   Î“   (  Î¼  ,  Î½  )     }    ,     infimum   conditional-set    subscript     X  Y      c   x  y   normal-d  Î³   x  y       Î³    normal-Î“   Î¼  Î½        \inf\left\{\left.\int_{X\times Y}c(x,y)\,\mathrm{d}\gamma(x,y)\right|\gamma\in%
 \Gamma(\mu,\nu)\right\},     where Î“(Î¼, Î½) denotes the collection of all probability measures on X Ã— Y with marginals Î¼ on X and Î½ on Y . It can be shown 7 that a minimizer for this problem always exists when the cost function X is lower semi-continuous and Î“(Î¼, Î½) is a tight collection of measures (which is guaranteed for Radon spaces X and Y ). (Compare this formulation with the definition of the Wasserstein metric  W 1 on the space of probability measures.) A gradient descent formulation for the solution of the Monge-Kantorovich problem was given by Sigurd Angenent, Steven Haker, and Allen Tannenbaum . 8  Duality formula  The minimum of the Kantorovich problem is equal to       sup   (     âˆ«  X    Ï†   (  x  )   d  Î¼   (  x  )     +    âˆ«  Y    Ïˆ   (  y  )   d  Î½   (  y  )      )    ,     supremum      subscript   X     Ï†  x  normal-d  Î¼  x      subscript   Y     Ïˆ  y  normal-d  Î½  y       \sup\left(\int_{X}\varphi(x)\,\mathrm{d}\mu(x)+\int_{Y}\psi(y)\,\mathrm{d}\nu(%
 y)\right),     where the supremum runs over all pairs of bounded and continuous functions Ï† : X â†’ R and Ïˆ : Y â†’ R such that         Ï†   (  x  )    +   Ïˆ   (  y  )     â‰¤   c   (  x  ,  y  )     .          Ï†  x     Ïˆ  y      c   x  y      \varphi(x)+\psi(y)\leq c(x,y).     Solution of the problem  Optimal transportation on the real line  For 1 â‰¤ p \mathcal{P}_p(\mathbf{R}) denote the collection of probability measures on R that have finite p th moment . Let     Î¼  ,  Î½   âˆˆ    ğ’«  p    (  ğ‘  )         Î¼  Î½      subscript  ğ’«  p   ğ‘     \mu,\nu\in\mathcal{P}_{p}(\mathbf{R})   and let c ( x , y ) = h ( x âˆ’ y ), where h : R â†’ [0, âˆ) is a convex function .   If Î¼ has no atom , i.e., if the cumulative distribution function  F Î¼ : R â†’ [0, 1] of Î¼ is a continuous function , then      F  Î½   -  1    âˆ˜   F  Î¼    :   ğ‘  â†’  ğ‘      normal-:     superscript   subscript  F  Î½     1     subscript  F  Î¼     normal-â†’  ğ‘  ğ‘     F_{\nu}^{-1}\circ F_{\mu}:\mathbf{R}\to\mathbf{R}   is an optimal transport map. It is the unique optimal transport map if h is strictly convex.  We have            min   Î³  âˆˆ   Î“   (  Î¼  ,  Î½  )        âˆ«   ğ‘  2     c   (  x  ,  y  )   d  Î³   (  x  ,  y  )      =    âˆ«  0  1    c   (    F  Î¼   -  1     (  s  )    ,    F  Î½   -  1     (  s  )    )   d  s     .         subscript     Î³    normal-Î“   Î¼  Î½        subscript    superscript  ğ‘  2      c   x  y   normal-d  Î³   x  y        superscript   subscript   0   1     c      superscript   subscript  F  Î¼     1    s      superscript   subscript  F  Î½     1    s    normal-d  s      \min_{\gamma\in\Gamma(\mu,\nu)}\int_{\mathbf{R}^{2}}c(x,y)\,\mathrm{d}\gamma(x%
 ,y)=\int_{0}^{1}c\left(F_{\mu}^{-1}(s),F_{\nu}^{-1}(s)\right)\,\mathrm{d}s.        The proof of this solution appears in. 9  Separable Hilbert spaces  Let X be a separable  Hilbert space . Let     ğ’«  p    (  X  )        subscript  ğ’«  p   X    \mathcal{P}_{p}(X)   denote the collection of probability measures on X such that have finite p th moment; let     ğ’«  p  r    (  X  )        superscript   subscript  ğ’«  p   r   X    \mathcal{P}_{p}^{r}(X)   denote those elements    Î¼  âˆˆ    ğ’«  p    (  X  )        Î¼     subscript  ğ’«  p   X     \mu\in\mathcal{P}_{p}(X)   that are Gaussian regular : if g is any strictly positive  Gaussian measure on X and g ( N ) = 0, then Î¼( N ) = 0 also.  Let    Î¼  âˆˆ    ğ’«  p  r    (  X  )        Î¼     superscript   subscript  ğ’«  p   r   X     \mu\in\mathcal{P}_{p}^{r}(X)   ,    Î½  âˆˆ    ğ’«  p    (  X  )        Î½     subscript  ğ’«  p   X     \nu\in\mathcal{P}_{p}(X)   ,     c   (  x  ,  y  )    =     |   x  -  y   |   p   /  p         c   x  y       superscript      x  y    p   p     c(x,y)=|x-y|^{p}/p   for p âˆˆ (1, âˆ), p âˆ’1 + q âˆ’1 = 1. Then the Kantorovich problem has a unique solution Îº, and this solution is induced by an optimal transport map: i.e., there exists a Borel map r âˆˆ L p ( X'', Î¼; X ) such that       Îº  =     (    id  X   Ã—  r   )   *    (  Î¼  )    âˆˆ   Î“   (  Î¼  ,  Î½  )     .        Îº     subscript     subscript  id  X   r     Î¼          normal-Î“   Î¼  Î½       \kappa=(\mathrm{id}_{X}\times r)_{*}(\mu)\in\Gamma(\mu,\nu).     Moreover, if Î½ has bounded  support , then       r   (  x  )    =   x  -     |    âˆ‡  Ï•    (  x  )    |    q  -  2     âˆ‡  Ï•    (  x  )           r  x     x     superscript       normal-âˆ‡  Ï•   x      q  2     normal-âˆ‡  Ï•   x      r(x)=x-|\nabla\phi(x)|^{q-2}\nabla\phi(x)     for Î¼-almost all x âˆˆ X for some locally Lipschitz , c -concave and maximal Kantorovich potential Ï†. (Here âˆ‡Ï† denotes the GÃ¢teaux derivative of Ï†.)  See also   Wasserstein metric  Transport function  Hungarian algorithm  Transportation planning   References  Further reading     "  Category:Calculus of variations  Category:Matching  Category:Mathematical economics  Category:Measure theory  Category:Transport economics  Category:Optimization in vector spaces     G. Monge. MÃ©moire sur la thÃ©orie des dÃ©blais et des remblais. Histoire de lâ€™AcadÃ©mie Royale des Sciences de Paris, avec les MÃ©moires de MathÃ©matique et de Physique pour la mÃªme annÃ©e , pages 666â€“704, 1781. â†©  Schrijver, Alexander , [ http://books.google.com/books?id=mqGeSQ6dJycC&printsec; ;=frontcover Combinatorial Optimization ], Berlin ; New York : Springer, 2003. ISBN 3540443894. Cf. [ http://books.google.com/books?id=mqGeSQ6dJycC&pg; ;=PA362&lpg;=PA362&dq;=a.n.+tolstoi+transportation+networks&source;=bl&ots;=xONQNWerQa&sig;=LJl_9KbyS1FDp_wYuXNJ9ruEKes&hl;=en&ei;=bMujTLP6O4OClAfjoomQCw&sa;=X&oi;=book_result&ct;=result&resnum;=1&ved;=0CBsQ6AEwAA#v=onepage&q;=a.n.%20tolstoi%20transportation%20networks&f;=false p.362] â†©  Ivor Grattan-Guinness, Ivor, [ http://books.google.com/books?id=2hDvzITtfdAC&printsec; ;=frontcover Companion encyclopedia of the history and philosophy of the mathematical sciences ], Volume 1, JHU Press, 2003. Cf. [ http://books.google.com/books?id=2hDvzITtfdAC&pg; ;=PA831&lpg;=PA831&dq;=%22a.n.+tolstoy%22+mathematics&source;=bl&ots;=pCwrnZWBwI&sig;=QQz_1ng7mR6dmZWCmZ4L1Twar3U&hl;=en&ei;=w8SjTJeUDoT7lwe3nYT8Cw&sa;=X&oi;=book_result&ct;=result&resnum;=4&ved;=0CCAQ6AEwAw#v=onepage&q;=%22a.n.%20tolstoy%22%20mathematics&f;=false p.831] â†©  L. Kantorovich. On the translocation of masses. C.R. (Doklady) Acad. Sci. URSS (N.S.), 37:199â€“201, 1942. â†©  â†©  â†©  L. Ambrosio, N. Gigli & G. SavarÃ©. Gradient Flows in Metric Spaces and in the Space of Probability Measures. Lectures in Mathematics ETH ZÃ¼rich, BirkhÃ¤user Verlag, Basel. (2005) â†©  S. Angenent, S. Haker, and A. Tannenbaum. Minimizing flows for the Monge-Kantorovich problem. SIAM J. Math. Analysis, volume 35, pp. 61-97 (2003). â†©  Rachev, Svetlozar T., and Ludger RÃ¼schendorf. Mass Transportation Problems: Volume I: Theory . Vol. 1. Springer, 1998. â†©     
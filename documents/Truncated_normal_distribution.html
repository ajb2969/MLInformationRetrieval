<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1647">Truncated normal distribution</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Truncated normal distribution</h1>
<hr/>

<p>In probability and statistics, the <strong>truncated normal distribution</strong> is the probability distribution of a <a href="normally_distributed" title="wikilink">normally distributed</a> random variable whose value is either bounded below or above (or both). The truncated normal distribution has wide applications in statistics and <a class="uri" href="econometrics" title="wikilink">econometrics</a>. For example, it is used to model the probabilities of the binary outcomes in the <a href="probit_model" title="wikilink">probit model</a> and to model censored data in the <a href="Tobit_model" title="wikilink">Tobit model</a>.</p>
<h2 id="definition">Definition</h2>

<p>Suppose 

<math display="inline" id="Truncated_normal_distribution:0">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>∼</mo>
   <mrow>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mo rspace="0.8pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <ci>X</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <interval closure="open">
      <ci>μ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\sim N(\mu,\sigma^{2})\!
  </annotation>
 </semantics>
</math>

 has a normal distribution and lies within the interval 

<math display="inline" id="Truncated_normal_distribution:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>∈</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>a</mi>
     <mo>,</mo>
     <mi>b</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="5.3pt">,</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
    <mo>≤</mo>
    <mi>a</mi>
    <mo><</mo>
    <mi>b</mi>
    <mo>≤</mo>
    <mi mathvariant="normal">∞</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <in></in>
     <ci>X</ci>
     <interval closure="open">
      <ci>a</ci>
      <ci>b</ci>
     </interval>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <apply>
       <minus></minus>
       <infinity></infinity>
      </apply>
      <ci>a</ci>
     </apply>
     <apply>
      <lt></lt>
      <share href="#.cmml">
      </share>
      <ci>b</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <infinity></infinity>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X\in(a,b),\;-\infty\leq a<b\leq\infty
  </annotation>
 </semantics>
</math>

. Then 

<math display="inline" id="Truncated_normal_distribution:2">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 conditional on 

<math display="inline" id="Truncated_normal_distribution:3">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo><</mo>
   <mi>X</mi>
   <mo><</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <ci>a</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a<X<b
  </annotation>
 </semantics>
</math>

 has a truncated normal distribution.</p>

<p>Its <a href="probability_density_function" title="wikilink">probability density function</a>, ƒ, for 

<math display="inline" id="Truncated_normal_distribution:4">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>≤</mo>
   <mi>x</mi>
   <mo>≤</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <ci>a</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\leq x\leq b
  </annotation>
 </semantics>
</math>

, is given by</p>

<p>

<math display="block" id="Truncated_normal_distribution:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>;</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <mi>σ</mi>
     <mo>,</mo>
     <mi>a</mi>
     <mo>,</mo>
     <mi>b</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>σ</mi>
     </mfrac>
     <mi>ϕ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mfrac>
       <mrow>
        <mi>x</mi>
        <mo>-</mo>
        <mi>μ</mi>
       </mrow>
       <mi>σ</mi>
      </mfrac>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mfrac>
        <mrow>
         <mi>b</mi>
         <mo>-</mo>
         <mi>μ</mi>
        </mrow>
        <mi>σ</mi>
       </mfrac>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi mathvariant="normal">Φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mfrac>
        <mrow>
         <mi>a</mi>
         <mo>-</mo>
         <mi>μ</mi>
        </mrow>
        <mi>σ</mi>
       </mfrac>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <list>
      <ci>x</ci>
      <ci>μ</ci>
      <ci>σ</ci>
      <ci>a</ci>
      <ci>b</ci>
     </list>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>σ</ci>
      </apply>
      <ci>ϕ</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <ci>μ</ci>
       </apply>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>normal-Φ</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>b</ci>
         <ci>μ</ci>
        </apply>
        <ci>σ</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Φ</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>a</ci>
         <ci>μ</ci>
        </apply>
        <ci>σ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x;\mu,\sigma,a,b)=\frac{\frac{1}{\sigma}\phi(\frac{x-\mu}{\sigma})}{\Phi(%
\frac{b-\mu}{\sigma})-\Phi(\frac{a-\mu}{\sigma})}
  </annotation>
 </semantics>
</math>

</p>

<p>and by ƒ=0 otherwise.</p>

<p>Here, 

<math display="inline" id="Truncated_normal_distribution:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ξ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mstyle scriptlevel="+1">
     <mfrac>
      <mn>1</mn>
      <msqrt>
       <mrow>
        <mn>2</mn>
        <mi>π</mi>
       </mrow>
      </msqrt>
     </mfrac>
    </mstyle>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mstyle scriptlevel="+1">
         <mfrac>
          <mn>1</mn>
          <mn>2</mn>
         </mfrac>
        </mstyle>
        <msup>
         <mi>ξ</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <ci>ξ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>ξ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle{\phi(\xi)=\frac{1}{\sqrt{2\pi}}\exp{(-\frac{1}{2}\xi^{2}})}
  </annotation>
 </semantics>
</math>

 is the probability density function of the <a href="standard_normal_distribution" title="wikilink">standard normal distribution</a> and 

<math display="inline" id="Truncated_normal_distribution:7">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo>⋅</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Φ</ci>
    <ci>normal-⋅</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle{\Phi(\cdot)}
  </annotation>
 </semantics>
</math>

 is its <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a>. There is an understanding that if 

<math display="inline" id="Truncated_normal_distribution:8">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>=</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>b</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle{b=\infty}
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Truncated_normal_distribution:9">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mstyle scriptlevel="+1">
      <mfrac>
       <mrow>
        <mi>b</mi>
        <mo>-</mo>
        <mi>μ</mi>
       </mrow>
       <mi>σ</mi>
      </mfrac>
     </mstyle>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>b</ci>
       <ci>μ</ci>
      </apply>
      <ci>σ</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle{\Phi(\frac{b-\mu}{\sigma})=1}
  </annotation>
 </semantics>
</math>

, and similarly, if 

<math display="inline" id="Truncated_normal_distribution:10">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mi mathvariant="normal">∞</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>a</ci>
    <apply>
     <minus></minus>
     <infinity></infinity>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle{a=-\infty}
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Truncated_normal_distribution:11">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mstyle scriptlevel="+1">
      <mfrac>
       <mrow>
        <mi>a</mi>
        <mo>-</mo>
        <mi>μ</mi>
       </mrow>
       <mi>σ</mi>
      </mfrac>
     </mstyle>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Φ</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <ci>μ</ci>
      </apply>
      <ci>σ</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle{\Phi(\frac{a-\mu}{\sigma})=0}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="moments">Moments</h2>

<p>Two sided truncation:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>

<math display="block" id="Truncated_normal_distribution:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mrow>
        <mo fence="true">∣</mo>
        <mi>X</mi>
        <mo>></mo>
       </mrow>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>σ</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi>δ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>α</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Var</ci>
     <apply>
      <times></times>
      <ci>X</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <ci>X</ci>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>δ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}(X\mid X>a)=\sigma^{2}[1-\delta(\alpha)],\!
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Truncated_normal_distribution:13">
 <semantics>
  <mrow>
   <mrow>
    <mi>α</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>a</mi>
       <mo>-</mo>
       <mi>μ</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>/</mo>
     <mi>σ</mi>
    </mrow>
   </mrow>
   <mo rspace="5.3pt">,</mo>
   <mrow>
    <mrow>
     <mi>λ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>ϕ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>α</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi mathvariant="normal">Φ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>α</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="5.3pt" stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>α</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <ci>μ</ci>
      </apply>
      <ci>σ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>λ</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>ϕ</ci>
       <ci>α</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>normal-Φ</ci>
         <ci>α</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha=(a-\mu)/\sigma,\;\lambda(\alpha)=\phi(\alpha)/[1-\Phi(\alpha)]\;
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Truncated_normal_distribution:14">
 <semantics>
  <mrow>
   <mrow>
    <mpadded lspace="2.8pt" width="+2.8pt">
     <mi>δ</mi>
    </mpadded>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>α</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mi>λ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>α</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>α</mi>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>δ</ci>
     <ci>α</ci>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>α</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>λ</ci>
        <ci>α</ci>
       </apply>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \;\delta(\alpha)=\lambda(\alpha)[\lambda(\alpha)-\alpha]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Truncated_normal_distribution:15">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>σ</mi>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mi>μ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mfrac>
      <mrow>
       <msqrt>
        <mfrac>
         <mn>2</mn>
         <mi>π</mi>
        </mfrac>
       </msqrt>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mfrac>
          <msup>
           <mi>μ</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mn>2</mn>
           <msup>
            <mi>σ</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mfrac>
        </mrow>
       </msup>
      </mrow>
      <mrow>
       <mi>σ</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mtext>erf</mtext>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <mrow>
             <mi>μ</mi>
             <mo>-</mo>
             <mi>a</mi>
            </mrow>
            <mrow>
             <msqrt>
              <mn>2</mn>
             </msqrt>
             <mi>σ</mi>
            </mrow>
           </mfrac>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mtext>erf</mtext>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <mrow>
             <mi>μ</mi>
             <mo>-</mo>
             <mi>b</mi>
            </mrow>
            <mrow>
             <msqrt>
              <mn>2</mn>
             </msqrt>
             <mi>σ</mi>
            </mrow>
           </mfrac>
           <mo>)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <ci>x</ci>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <ci>μ</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <root></root>
         <apply>
          <divide></divide>
          <cn type="integer">2</cn>
          <ci>π</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>μ</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>σ</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>σ</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <mtext>erf</mtext>
          <apply>
           <divide></divide>
           <apply>
            <minus></minus>
            <ci>μ</ci>
            <ci>a</ci>
           </apply>
           <apply>
            <times></times>
            <apply>
             <root></root>
             <cn type="integer">2</cn>
            </apply>
            <ci>σ</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <mtext>erf</mtext>
          <apply>
           <divide></divide>
           <apply>
            <minus></minus>
            <ci>μ</ci>
            <ci>b</ci>
           </apply>
           <apply>
            <times></times>
            <apply>
             <root></root>
             <cn type="integer">2</cn>
            </apply>
            <ci>σ</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{\sigma^{2}f^{\prime}(x)+f(x)(x-\mu)=0,f(0)=\frac{\sqrt{\frac{2}{\pi}}e^%
{-\frac{\mu^{2}}{2\sigma^{2}}}}{\sigma\left(\text{erf}\left(\frac{\mu-a}{\sqrt%
{2}\sigma}\right)-\text{erf}\left(\frac{\mu-b}{\sqrt{2}\sigma}\right)\right)}\right\}
  </annotation>
 </semantics>
</math>

.</p>

<p>One sided truncation (lower tail):</p>

<p>

<math display="inline" id="Truncated_normal_distribution:16">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi mathvariant="normal">Φ</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi mathvariant="normal">Φ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>α</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>U</mi>
        <mo>⋅</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi mathvariant="normal">Φ</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>β</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mi mathvariant="normal">Φ</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>α</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>σ</mi>
    </mrow>
    <mo>+</mo>
    <mi>μ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Φ</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>normal-Φ</ci>
        <ci>α</ci>
       </apply>
       <apply>
        <ci>normal-⋅</ci>
        <ci>U</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>normal-Φ</ci>
          <ci>β</ci>
         </apply>
         <apply>
          <times></times>
          <ci>normal-Φ</ci>
          <ci>α</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>σ</ci>
     </apply>
     <ci>μ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\Phi^{-1}(\Phi(\alpha)+U\cdot(\Phi(\beta)-\Phi(\alpha)))\sigma+\mu
  </annotation>
 </semantics>
</math>

</p>

<p>Barr and Sherrill (1999) give a simpler expression for the variance of one sided truncations. Their formula is in terms of the chi-square CDF, which is implemented in standard software libraries. Bebu and Mathew (2009) provide formulas for (generalized) confidence intervals around the truncated moments.</p>
<dl>
<dt><a href="Differential_equation" title="wikilink">Differential equation</a></dt>
</dl>

<p>

<math display="inline" id="Truncated_normal_distribution:17">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dt>A recursive formula</dt>
</dl>

<p>As for the non-truncated case, there is a neat recursive formula for the truncated moments. See.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="simulating">Simulating</h2>

<p>A random variate x defined as 

<math display="inline" id="Truncated_normal_distribution:18">
 <semantics>
  <msup>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>normal-Φ</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi^{-1}
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Truncated_normal_distribution:19">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 the cumulative distribution function and 

<math display="inline" id="Truncated_normal_distribution:20">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <cn type="integer">0</cn>
    <cn type="integer">1</cn>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (0,1)
  </annotation>
 </semantics>
</math>

 its inverse, 

<math display="inline" id="Truncated_normal_distribution:21">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>a</mi>
   <mo>,</mo>
   <mi>b</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>a</ci>
    <ci>b</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a,b)
  </annotation>
 </semantics>
</math>

 a uniform random number on 

<math display="inline" id="Truncated_normal_distribution:22">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

, follows the distribution truncated to the range 

<math display="inline" id="Truncated_normal_distribution:23">
 <semantics>
  <msup>
   <mi mathvariant="normal">Φ</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>normal-Φ</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi^{-1}
  </annotation>
 </semantics>
</math>

. This method is theoretically the best, however the simulation of random variables from <span class="LaTeX">$\Phi$</span> and <span class="LaTeX">$\Phi^{-1}$</span> may imply numerical errors; thus practically one has to find other implementations.</p>

<p>For more on simulating a draw from the truncated normal distribution, see Robert (1995), Lynch (2007) Section 8.1.3 (pages 200–206), Devroye (1986). The <a href="http://cran.r-project.org/web/packages/msm/index.html">MSM</a> package in R has a function, <a href="http://rss.acs.unt.edu/Rdoc/library/msm/html/tnorm.html">rtnorm</a>, that calculates draws from a truncated normal. The <a href="http://cran.r-project.org/web/packages/truncnorm/">truncnorm</a> package in R also has functions to draw from a truncated normal.</p>

<p>Chopin proposed an algorithm inspired from the Ziggurat algorithm of Marsaglia and Tsang (1984, 2000), which is usually considered as the fastest Gaussian sampler, and is also very close to Ahrens’s algorithm (1995). Implementations can be found in <a href="http://www.crest.fr/ckfinder/userfiles/files/Pageperso/chopin/truncnorm_20120618.tgz">C</a>, <a href="http://miv.u-strasbg.fr/mazet/rtnorm/rtnormCpp.zip">C++</a>, <a href="http://miv.u-strasbg.fr/mazet/rtnorm/rtnormM.zip">Matlab</a> and <a href="http://www.christophlassner.de/blog/2013/08/12/Generation-of-Truncated-Gaussian-Samples/">Python</a>.</p>

<p>Sampling from the <em>multivariate</em> truncated normal distribution is considerably more difficult. Damien and Walker (2001) introduce a general methodology for sampling truncated densities within a <a href="Gibbs_sampling" title="wikilink">Gibbs sampling</a> framework. Their algorithm introduces one latent variable and is more computationally efficient than the algorithm of Robert (1995).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Normal_distribution" title="wikilink">Normal distribution</a></li>
<li><a href="Truncated_distribution" title="wikilink">Truncated distribution</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<ul>
<li></li>
<li>Norman L. Johnson and Samuel Kotz (1970). <em>Continuous univariate distributions-1</em>, chapter 13. John Wiley &amp; Sons.</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>Nicolas Chopin, "Fast simulation of truncated Gaussian distributions". <em>Statistics and Computing</em> <strong>21</strong>(2): 275-288.</li>
</ul>

<p><a href="fr:Loi_tronquée#Loi_normale_tronquée" title="wikilink">fr:Loi tronquée#Loi normale tronquée</a>"</p>

<p><a href="Category:Continuous_distributions" title="wikilink">Category:Continuous distributions</a> <a href="Category:Normal_distribution" title="wikilink">Category:Normal distribution</a> <a href="Category:Probability_distributions" title="wikilink">Category:Probability distributions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Johnson, N.L., Kotz, S., Balakrishnan, N. (1994) <em>Continuous Univariate Distributions, Volume 1</em>, Wiley. ISBN 0-471-58495-9 (Section 10.1)<a href="#fnref1">↩</a></li>
<li id="fn2">Document by Eric Orjebin, "<a class="uri" href="http://www.smp.uq.edu.au/people/YoniNazarathy/teaching_projects/studentWork/EricOrjebin_TruncatedNormalMoments.pdf">http://www.smp.uq.edu.au/people/YoniNazarathy/teaching_projects/studentWork/EricOrjebin_TruncatedNormalMoments.pdf</a>"<a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

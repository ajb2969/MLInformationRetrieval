   Pocklington primality test      Pocklington primality test   In mathematics, the Pocklington–Lehmer primality test is a primality test devised by Henry Cabourn Pocklington 1 and Derrick Henry Lehmer 2 to decide whether a given number   N   N   N   is prime. The output of the test is a proof that the number is prime or that primality could not be established.  Pocklington criterion  The test relies on the Pocklington Theorem (Pocklington criterion) which is formulated as follows:  Let    N  >  1      N  1    N>1   be an integer, and suppose there exist numbers a and q such that  (1)  q is prime,    q  |  N  -  1     fragments  q  normal-|  N   1    q|N-1   and    q  >    N   -  1       q      N   1     q>\sqrt{N}-1     (2)      a   N  -  1    ≡   1     (   mod  N   )         superscript  a    N  1     annotated  1   pmod  N      a^{N-1}\equiv 1\;\;(\mathop{{\rm mod}}N)     (3)      gcd   (    a    (   N  -  1   )   /  q    -  1   ,  N  )    =  1           superscript  a      N  1   q    1   N   1    \gcd{(a^{(N-1)/q}-1,N)}=1     Then   N   N   N   is prime. 3  Proof of this theorem  Suppose N is not prime. This means there must be a prime p , where    p  ≤   N       p    N     p\leq\sqrt{N}   that divides N .  Therefore,    q  >   p  -  1       q    p  1     q>p-1   which implies     gcd   (  q  ,   p  -  1   )    =  1        q    p  1    1    \gcd{(q,p-1)}=1   .  Thus there must exist an integer u with the property that  (4)      u  q   ≡   1     (   mod   p  -  1    )          u  q    annotated  1   pmod    p  1       uq\equiv 1\;\;(\mathop{{\rm mod}}p-1)     This implies:       1  ≡    a   N  -  1       (   mod  p   )        1   annotated   superscript  a    N  1     pmod  p      1\equiv a^{N-1}\;\;(\mathop{{\rm mod}}p)    , by (2) since     p  |  N     fragments  p  normal-|  N    p|N          ≡    (   a   N  -  1    )   u   ≡   a   u   (   N  -  1   )     ≡   a   u  q   (    (   N  -  1   )   /  q   )     ≡     (   a   u  q    )     (   N  -  1   )   /  q       (   mod  p   )          absent   superscript   superscript  a    N  1    u         superscript  a    u    N  1           superscript  a    u  q      N  1   q           annotated   superscript   superscript  a    u  q        N  1   q     pmod  p       \equiv(a^{N-1})^{u}\equiv a^{u(N-1)}\equiv a^{uq((N-1)/q)}\equiv(a^{uq})^{(N-1%
 )/q}\;\;(\mathop{{\rm mod}}p)   ,        ≡    a    (   N  -  1   )   /  q       (   mod  p   )        absent   annotated   superscript  a      N  1   q     pmod  p      \equiv a^{(N-1)/q}\;\;(\mathop{{\rm mod}}p)    , by (4) and Fermat's  little  theorem  This shows that   p   p   p   divides    gcd   (  )           \gcd()   from (3) , and therefore the    gcd   (  )           \gcd()   is not   1   1   1   ; a contradiction. 4  The test is simple once the theorem above is established. Given N , seek to find suitable a and q . If they can be obtained, then N is prime. Moreover, a and q are the certificate of primality. They can be quickly verified to satisfy the conditions of the theorem, confirming N as prime.  A problem which arises is the ability to find a suitable q , that must satisfy (1)–(3) and be provably prime. It is even quite possible that such a q does not exist. This is a large probability, indeed only 57.8% of the odd primes, N ,    N  ≤   10  ,  000       N   10  000     N\leq 10,000   have such a q . To find a is not nearly so difficult. If N is prime, and a suitable q is found, each choice of a where    1  ≤  a  <  N        1  a       N     1\leq a   will satisfy     a   N  -  1    ≡   1     (   mod  N   )         superscript  a    N  1     annotated  1   pmod  N      a^{N-1}\equiv 1\;\;(\mathop{{\rm mod}}N)   , and so will satisfy (2) as long as ord( a ) does not divide     (   N  -  1   )   /  q        N  1   q    (N-1)/q   . Thus a randomly chosen a is likely to work. If a is a generator mod N its order is N-1 and so the method is guaranteed to work for this choice. 5  Generalized Pocklington method  A generalized version of Pocklington's theorem covers more primes N .  Corollary:  Let N − 1 factor as N − 1 = AB , where A and B are relatively prime,    A  >   N       A    N     A>\sqrt{N}   and the factorization of A is known.  If for every prime factor p of A there exists an integer    a  p     subscript  a  p    a_{p}   so that       a  p   N  -  1    ≡   1     (   mod  N   )         subscript   superscript  a    N  1    p    annotated  1   pmod  N      a^{N-1}_{p}\equiv 1\;\;(\mathop{{\rm mod}}N)     and     gcd   (    a  p    (   N  -  1   )   /  p    -  1   ,  N  )    =  1           subscript   superscript  a      N  1   p    p   1   N   1    \gcd{(a^{(N-1)/p}_{p}-1,N)}=1   then N is prime. The reverse implication also holds: If N is prime then every prime factor of A can be written in the above manner. 6  Proof of Corollary: Let p be a prime dividing A and let    p  e     superscript  p  e    p^{e}   be the maximum power of p dividing A . Let v be a prime factor of N . For the    a  p     subscript  a  p    a_{p}   from the corollary set    b  ≡    a  p    (   N  -  1   )   /   p  e        (   mod  v   )        b   annotated   subscript   superscript  a      N  1    superscript  p  e     p    pmod  v      b\equiv a^{(N-1)/p^{e}}_{p}\;\;(\mathop{{\rm mod}}v)   . This means     b   p  e    ≡   a  p   N  -  1    ≡   1     (   mod  v   )           superscript  b   superscript  p  e     subscript   superscript  a    N  1    p         annotated  1   pmod  v       b^{p^{e}}\equiv a^{N-1}_{p}\equiv 1\;\;(\mathop{{\rm mod}}v)   and because of     gcd   (    a  p    (   N  -  1   )   /  p    -  1   ,  N  )    =  1           subscript   superscript  a      N  1   p    p   1   N   1    \gcd{(a^{(N-1)/p}_{p}-1,N)}=1   also     b   p   e  -  1     ≡   a  p    (   N  -  1   )   /  p    ≢   1     (   mod  v   )           superscript  b   superscript  p    e  1      subscript   superscript  a      N  1   p    p     not-equivalent-to     annotated  1   pmod  v       b^{p^{e-1}}\equiv a^{(N-1)/p}_{p}\not\equiv 1\;\;(\mathop{{\rm mod}}v)   .  This means that the order of    b     (   mod  v   )      annotated  b   pmod  v     b\;\;(\mathop{{\rm mod}}v)   is    p  e     superscript  p  e    p^{e}     Thus,     p  e   |   (  v  -  1  )      fragments   superscript  p  e   normal-|   fragments  normal-(  v   1  normal-)     p^{e}|(v-1)   . The same observation holds for each prime power factor    p  e     superscript  p  e    p^{e}   of A , which implies    A  |   (  v  -  1  )      fragments  A  normal-|   fragments  normal-(  v   1  normal-)     A|(v-1)   .  Specifically, this means     v  >  A  ≥   n    .        v  A         n      v>A\geq\sqrt{n}.     If N were composite, it would necessarily have a prime factor which is less than or equal to    N      N    \sqrt{N}   . It has been shown that there is no such factor, which implies that N is prime.  To see the converse choose    a  p     subscript  a  p    a_{p}   a generator of the integers modulo p . 7  The test  The Pocklington–Lehmer primality test follows directly from this corollary. We must first partially factor N − 1 into A and B . Then we must find an    a  p     subscript  a  p    a_{p}   for every prime factor p of A , which fulfills the conditions of the corollary. If such    a  p     subscript  a  p    a_{p}   's can be found, the Corollary implies that N is prime.  According to Koblitz,    a  p     subscript  a  p    a_{p}   = 2 often works. 8  Example      N  =  11351      N  11351    N=11351          N  -  1   =   2  ⋅   5  2   ⋅  227         N  1    normal-⋅  2   superscript  5  2   227     N-1=2\cdot 5^{2}\cdot 227     Choose    A  =   227  ⋅   5  2        A   normal-⋅  227   superscript  5  2      A=227\cdot 5^{2}   , which means    B  =  2      B  2    B=2     Now it is clear that     gcd   (  A  ,  B  )    =  1        A  B   1    \gcd{(A,B)}=1   and    A  >   N       A    N     A>\sqrt{N}   .  Next find an    a  p     subscript  a  p    a_{p}   for each prime factor p of A . E.g. choose     a  5   =  2       subscript  a  5   2    a_{5}=2   .       a  p   N  -  1    ≡   2  11350   ≡   1     (   mod  11351   )           subscript   superscript  a    N  1    p    superscript  2  11350         annotated  1   pmod  11351       a^{N-1}_{p}\equiv 2^{11350}\equiv 1\;\;(\mathop{{\rm mod}}11351)   .       gcd   (    a  p    (   N  -  1   )   /  p    -  1   ,  N  )    =   gcd   (    2   2  ⋅  5  ⋅  227    -  1   ,  11351  )    =  1.             subscript   superscript  a      N  1   p    p   1   N        superscript  2   normal-⋅  2  5  227    1   11351        1.     \gcd{(a^{(N-1)/p}_{p}-1,N)}=\gcd{(2^{2\cdot 5\cdot 227}-1,11351)}=1.     So     a  5   =  2       subscript  a  5   2    a_{5}=2   satisfies the necessary conditions. Choose     a  227   =  7       subscript  a  227   7    a_{227}=7   .       a  p   N  -  1    ≡   7  11350   ≡   1     (   mod  11351   )           subscript   superscript  a    N  1    p    superscript  7  11350         annotated  1   pmod  11351       a^{N-1}_{p}\equiv 7^{11350}\equiv 1\;\;(\mathop{{\rm mod}}11351)     and       gcd   (    a  p    (   N  -  1   )   /  p    -  1   ,  N  )    =   gcd   (    7   2  ⋅  25    -  1   ,  11351  )    =  1.             subscript   superscript  a      N  1   p    p   1   N        superscript  7   normal-⋅  2  25    1   11351        1.     \gcd{(a^{(N-1)/p}_{p}-1,N)}=\gcd(7^{2\cdot 25}-1,11351)=1.     So both    a  p     subscript  a  p    a_{p}   's work and thus N is prime.  We have chosen a small prime for calculation purposes but in practice when we start factoring A we will get factors that themselves must be checked for primality. It is not a proof of primality until we know our factors of A are prime as well. If we get a factor of A where primality is not certain, the test must be performed on this factor as well. This gives rise to a so-called down-run procedure, where the primality of a number is evaluated via the primality of a series of smaller numbers.  In our case, we can say with certainty that 2, 5, and 227 are prime, and thus we have proved our result. The certificate in our case is the list of    a  p     subscript  a  p    a_{p}   's, which can quickly be checked in the corollary.  If our example had given rise to a down-run sequence, the certificate would be more complicated. It would first consist of our initial round of    a  p     subscript  a  p    a_{p}   's which correspond to the 'prime' factors of A ; Next, for the factor(s) of A of which primality was uncertain, we would have more    a  p     subscript  a  p    a_{p}   's, and so on for factors of these factors until we reach factors of which primality is certain. This can continue for many layers if the initial prime is large, but the important thing to note, is that a simple certificate can be produced, containing at each level the prime to be tested, and the corresponding    a  p     subscript  a  p    a_{p}   's, which can easily be verified. If at any level we cannot find    a  p     subscript  a  p    a_{p}   's then we cannot say that N is prime.  The biggest difficulty with this test is the necessity of discovering prime factors of N - 1 , in essence, factoring N − 1. In practice this could be extremely difficult. Finding    a  p     subscript  a  p    a_{p}   's is a less difficult problem. 9  Extensions and variants  The seminal 1975 paper by Brillhart, Lehmer, and Selfridge 10 gives a proof for what is shown above as the "generalized Pocklington theorem" as theorem 4 on page 623. Additional theorems are shown allowing less factoring. This includes theorem 3 (a strengthening of Proth 1878):   Let     N  -  1   =   m  p         N  1     m  p     N-1=mp   where p is an odd prime such that      2  p   +  1   ≥   N           2  p   1     N     2p+1\geq\sqrt{N}   . If there exists an a for which     a    (   N  -  1   )   /  2    ≡    -  1      (   mod  N   )         superscript  a      N  1   2     annotated    1    pmod  N      a^{(N-1)/2}\equiv-1\;\;(\mathop{{\rm mod}}N)   , but     a   m  /  2    ≢    -  1      (   mod  N   )       not-equivalent-to   superscript  a    m  2     annotated    1    pmod  N      a^{m/2}\not\equiv-1\;\;(\mathop{{\rm mod}}N)   , then N is prime.   and theorem 5 on page 624 that allows a proof when the factored part has reached only     (   N  /  2   )    1  /  3      superscript    N  2     1  3     (N/2)^{1/3}   . Many additional theorems are provided.  References  External links  "  Category:Primality tests     ↩  ↩  Koblitz, Neal, A Course in Number Theory and Cryptography , 2nd Ed, Springer,1994 ↩   http://www.mast.queensu.ca/~math418/m418oh/m418og26.pdf ↩  Blake, Ian F., Seroussi, Gadiel, Smart, Nigel Paul, Elliptic Curves in Cryptography , Cambridge University Press, 1999 ↩  Washington, Lawrence C., Elliptic Curves: Number Theory and Cryptography , Chapman & Hall/CRC, 2003 ↩   ↩  ↩     
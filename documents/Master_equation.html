<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="787">Master equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Master equation</h1>
<hr/>

<p>In <a class="uri" href="physics" title="wikilink">physics</a> and <a class="uri" href="chemistry" title="wikilink">chemistry</a> and related fields, <strong>master equations</strong> are used to describe the time-evolution of a system that can be modelled as being in exactly one of countable number of <a href="Classical_mechanics" title="wikilink">states</a> at any given time, and where switching between states is treated <a href="probability" title="wikilink">probabilistically</a>. The equations are usually a set of <a href="differential_equations" title="wikilink">differential equations</a> for the variation over time of the <a href="probability" title="wikilink">probabilities</a> that the system occupies each of the different states.</p>
<h2 id="introduction">Introduction</h2>

<p>A master equation is a phenomenological set of first-order <a href="differential_equations" title="wikilink">differential equations</a> describing the time evolution of (usually) the <a class="uri" href="probability" title="wikilink">probability</a> of a system to occupy each one of a discrete <a href="set_(mathematics)" title="wikilink">set</a> of <a href="Classical_mechanics" title="wikilink">states</a> with regard to a continuous time variable <em>t</em>. The most familiar form of a master equation is a matrix form:</p>

<p>

<math display="block" id="Master_equation:0">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mi>𝐀</mi>
     <mover accent="true">
      <mi>P</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>P</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>𝐀</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>P</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\vec{P}}{dt}=\mathbf{A}\vec{P},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Master_equation:1">
 <semantics>
  <mover accent="true">
   <mi>P</mi>
   <mo stretchy="false">→</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \vec{P}
  </annotation>
 </semantics>
</math>

 is a column vector (where element <em>i</em> represents state <em>i</em>), and 

<math display="inline" id="Master_equation:2">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 is the matrix of connections. The way connections among states are made determines the dimension of the problem; it is either</p>
<ul>
<li>a d-dimensional system (where d is 1,2,3,...), where any state is connected with exactly its 2d nearest neighbors, or</li>
<li>a network, where every pair of states may have a connection (depending on the network's properties).</li>
</ul>

<p>When the connections are time-independent rate constants, the master equation represents a <a href="kinetic_scheme" title="wikilink">kinetic scheme</a>, and the process is <a href="Markov_process" title="wikilink">Markovian</a> (any jumping time probability density function for state <em>i</em> is an exponential, with a rate equal to the value of the connection). When the connections depend on the actual time (i.e. matrix 

<math display="inline" id="Master_equation:3">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 depends on the time, 

<math display="inline" id="Master_equation:4">
 <semantics>
  <mrow>
   <mi>𝐀</mi>
   <mo>→</mo>
   <mrow>
    <mi>𝐀</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>𝐀</ci>
    <apply>
     <times></times>
     <ci>𝐀</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}\rightarrow\mathbf{A}(t)
  </annotation>
 </semantics>
</math>

 ), the process is not stationary and the master equation reads</p>

<p>

<math display="block" id="Master_equation:5">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mi>𝐀</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>P</mi>
      <mo stretchy="false">→</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>P</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>𝐀</ci>
     <ci>t</ci>
     <apply>
      <ci>normal-→</ci>
      <ci>P</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\vec{P}}{dt}=\mathbf{A}(t)\vec{P}.
  </annotation>
 </semantics>
</math>

</p>

<p>When the connections represent multi exponential <a href="jumping_time" title="wikilink">jumping time</a> <a href="probability_density_function" title="wikilink">probability density functions</a>, the process is <a href="Semi-Markov_process" title="wikilink">semi-Markovian</a>, and the equation of motion is an <a href="integro-differential_equation" title="wikilink">integro-differential equation</a> termed the generalized master equation:</p>

<p>

<math display="block" id="Master_equation:6">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">→</mo>
      </mover>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>t</mi>
     </msubsup>
     <mrow>
      <mi>𝐀</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mi>τ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mover accent="true">
       <mi>P</mi>
       <mo stretchy="false">→</mo>
      </mover>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>τ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>τ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <ci>normal-→</ci>
       <ci>P</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <int></int>
       <ci>t</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <ci>𝐀</ci>
      <apply>
       <minus></minus>
       <ci>t</ci>
       <ci>τ</ci>
      </apply>
      <apply>
       <ci>normal-→</ci>
       <ci>P</ci>
      </apply>
      <ci>τ</ci>
      <ci>d</ci>
      <ci>τ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\vec{P}}{dt}=\int^{t}_{0}\mathbf{A}(t-\tau)\vec{P}(\tau)d\tau.
  </annotation>
 </semantics>
</math>

</p>

<p>The matrix 

<math display="inline" id="Master_equation:7">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 can also represent <a href="Birth-death_process" title="wikilink">birth and death</a>, meaning that probability is injected (birth) or taken from (death) the system, where then, the process is not in equilibrium.</p>
<h3 id="detailed-description-of-the-matrix-mathbfa-and-properties-of-the-system">Detailed description of the matrix 

<math display="inline" id="Master_equation:8">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

, and properties of the system</h3>

<p>Let 

<math display="inline" id="Master_equation:9">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 be the matrix describing the transition rates (also known as kinetic rates or reaction rates). As always, the first subscript represents the row, the second subscript the column. That is, the source is given by the second subscript, and the destination by the first subscript. This is the opposite of what one might expect, but it is technically convenient.</p>

<p>For each state <em>k</em>, the increase in occupation probability depends on the contribution from all other states to <em>k</em>, and is given by:</p>

<p>

<math display="block" id="Master_equation:10">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi mathvariant="normal">ℓ</mi>
    </munder>
    <mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi>k</mi>
       <mi mathvariant="normal">ℓ</mi>
      </mrow>
     </msub>
     <msub>
      <mi>P</mi>
      <mi mathvariant="normal">ℓ</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>normal-ℓ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>normal-ℓ</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>normal-ℓ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{\ell}A_{k\ell}P_{\ell},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Master_equation:11">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi mathvariant="normal">ℓ</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>normal-ℓ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{\ell},
  </annotation>
 </semantics>
</math>

 is the probability for the system to be in the state 

<math display="inline" id="Master_equation:12">
 <semantics>
  <mi mathvariant="normal">ℓ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-ℓ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell
  </annotation>
 </semantics>
</math>

, while the <a href="matrix_(mathematics)" title="wikilink">matrix</a> 

<math display="inline" id="Master_equation:13">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 is filled with a grid of transition-rate <a href="Constant_(mathematics)" title="wikilink">constants</a>. Similarly, 

<math display="inline" id="Master_equation:14">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{k}
  </annotation>
 </semantics>
</math>

 contributes to the occupation of all other states 

<math display="inline" id="Master_equation:15">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi mathvariant="normal">ℓ</mi>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>normal-ℓ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{\ell},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Master_equation:16">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi mathvariant="normal">ℓ</mi>
    </munder>
    <mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mi>k</mi>
      </mrow>
     </msub>
     <msub>
      <mi>P</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <sum></sum>
     <ci>normal-ℓ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>normal-ℓ</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{\ell}A_{\ell k}P_{k},
  </annotation>
 </semantics>
</math>

</p>

<p>In probability theory, this identifies the evolution as a <a href="continuous-time_Markov_process" title="wikilink">continuous-time Markov process</a>, with the integrated master equation obeying a <a href="Chapman–Kolmogorov_equation" title="wikilink">Chapman–Kolmogorov equation</a>.</p>

<p>The master equation can be simplified so that the terms with <em>ℓ</em> = <em>k</em> do not appear in the summation. This allows calculations even if the main diagonal of the 

<math display="inline" id="Master_equation:17">
 <semantics>
  <mi>𝐀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}
  </annotation>
 </semantics>
</math>

 is not defined or has been assigned an arbitrary value.</p>

<p>

<math display="block" id="Master_equation:18">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>P</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi mathvariant="normal">ℓ</mi>
     </munder>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>A</mi>
        <mrow>
         <mi>k</mi>
         <mi mathvariant="normal">ℓ</mi>
        </mrow>
       </msub>
       <msub>
        <mi>P</mi>
        <mi mathvariant="normal">ℓ</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi mathvariant="normal">ℓ</mi>
        <mo>≠</mo>
        <mi>k</mi>
       </mrow>
      </munder>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>A</mi>
         <mrow>
          <mi>k</mi>
          <mi mathvariant="normal">ℓ</mi>
         </mrow>
        </msub>
        <msub>
         <mi>P</mi>
         <mi mathvariant="normal">ℓ</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi>k</mi>
        <mi>k</mi>
       </mrow>
      </msub>
      <msub>
       <mi>P</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mo>≠</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>A</mi>
         <mrow>
          <mi>k</mi>
          <mi mathvariant="normal">ℓ</mi>
         </mrow>
        </msub>
        <msub>
         <mi>P</mi>
         <mi mathvariant="normal">ℓ</mi>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>A</mi>
         <mrow>
          <mi mathvariant="normal">ℓ</mi>
          <mi>k</mi>
         </mrow>
        </msub>
        <msub>
         <mi>P</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>normal-ℓ</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>normal-ℓ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <neq></neq>
         <ci>normal-ℓ</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>normal-ℓ</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <neq></neq>
        <ci>normal-ℓ</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>k</ci>
          <ci>normal-ℓ</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>normal-ℓ</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dP_{k}}{dt}=\sum_{\ell}(A_{k\ell}P_{\ell})=\sum_{\ell\neq k}(A_{k\ell}P_%
{\ell})+A_{kk}P_{k}=\sum_{\ell\neq k}(A_{k\ell}P_{\ell}-A_{\ell k}P_{k}).
  </annotation>
 </semantics>
</math>

</p>

<p>The final equality arises from the fact that</p>

<p>

<math display="block" id="Master_equation:19">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi mathvariant="normal">ℓ</mi>
    </munder>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mi>k</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mi>d</mi>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mi mathvariant="normal">ℓ</mi>
     </munder>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>P</mi>
       <mrow>
        <mi mathvariant="normal">ℓ</mi>
        <mi>k</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>normal-ℓ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <apply>
        <times></times>
        <ci>normal-ℓ</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>normal-ℓ</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <apply>
         <times></times>
         <ci>normal-ℓ</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{\ell}(A_{\ell k})=\frac{d}{dt}\sum_{\ell}(P_{\ell k})=0
  </annotation>
 </semantics>
</math>

 because the summation over a row of the probabilities 

<math display="inline" id="Master_equation:20">
 <semantics>
  <msub>
   <mi>P</mi>
   <mrow>
    <mi mathvariant="normal">ℓ</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <apply>
     <times></times>
     <ci>normal-ℓ</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{\ell k}
  </annotation>
 </semantics>
</math>


 yields one. The reason is that the probability to go from <em>ℓ</em> to any other state is a sure event and therefore has a probability of one. Using this we can write the diagonal elements as</p>

<p>

<math display="block" id="Master_equation:21">
 <semantics>
  <mrow>
   <msub>
    <mi>A</mi>
    <mrow>
     <mi>k</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mo>≠</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi mathvariant="normal">ℓ</mi>
        <mi>k</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>⇒</mo>
   <mrow>
    <msub>
     <mi>A</mi>
     <mrow>
      <mi>k</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <msub>
     <mi>P</mi>
     <mi>k</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mo>≠</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>A</mi>
        <mrow>
         <mi mathvariant="normal">ℓ</mi>
         <mi>k</mi>
        </mrow>
       </msub>
       <msub>
        <mi>P</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <neq></neq>
         <ci>normal-ℓ</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <apply>
         <times></times>
         <ci>normal-ℓ</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-⇒</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <neq></neq>
         <ci>normal-ℓ</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>normal-ℓ</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{kk}=-\sum_{\ell\neq k}(A_{\ell k})\Rightarrow A_{kk}P_{k}=-\sum_{\ell\neq k%
}(A_{\ell k}P_{k})
  </annotation>
 </semantics>
</math>

.</p>

<p>The master equation exhibits <a href="detailed_balance" title="wikilink">detailed balance</a> if each of the terms of the summation disappears separately at equilibrium — i.e. if, for all states <em>k</em> and <em>ℓ</em> having equilibrium probabilities 

<math display="inline" id="Master_equation:22">
 <semantics>
  <msub>
   <mi>π</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>π</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\pi_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Master_equation:23">
 <semantics>
  <msub>
   <mi>π</mi>
   <mi mathvariant="normal">ℓ</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>π</ci>
    <ci>normal-ℓ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\pi_{\ell}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Master_equation:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi>k</mi>
       <mi mathvariant="normal">ℓ</mi>
      </mrow>
     </msub>
     <msub>
      <mi>π</mi>
      <mi mathvariant="normal">ℓ</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>A</mi>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mi>k</mi>
      </mrow>
     </msub>
     <msub>
      <mi>π</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>normal-ℓ</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>π</ci>
      <ci>normal-ℓ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>A</ci>
      <apply>
       <times></times>
       <ci>normal-ℓ</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>π</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{k\ell}\pi_{\ell}=A_{\ell k}\pi_{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>These symmetry relations were proved on the basis of the <a href="time_reversibility" title="wikilink">time reversibility</a> of microscopic dynamics (<a href="microscopic_reversibility" title="wikilink">microscopic reversibility</a>) as <a href="Onsager_reciprocal_relations" title="wikilink">Onsager reciprocal relations</a>.</p>
<h3 id="examples-of-master-equations">Examples of master equations</h3>

<p>Many physical problems in <a href="classical_mechanics" title="wikilink">classical</a>, <a href="quantum_mechanics" title="wikilink">quantum mechanics</a> and problems in other sciences, can be reduced to the form of a <em>master equation</em>, thereby performing a great simplification of the problem (see <a href="mathematical_model" title="wikilink">mathematical model</a>).</p>

<p>The <a href="Lindblad_equation" title="wikilink">Lindblad equation</a> in <a href="quantum_mechanics" title="wikilink">quantum mechanics</a> is a generalization of the master equation describing the time evolution of a <a href="density_matrix" title="wikilink">density matrix</a>. Though the Lindblad equation is often referred to as a <em>master equation</em>, it is not one in the usual sense, as it governs not only the time evolution of probabilities (diagonal elements of the density matrix), but also of variables containing information about <a href="quantum_coherence" title="wikilink">quantum coherence</a> between the states of the system (non-diagonal elements of the density matrix).</p>

<p>Another special case of the master equation is the <a href="Fokker-Planck_equation" title="wikilink">Fokker-Planck equation</a> which describes the time evolution of a continuous probability distribution. Complicated master equations which resist analytic treatment can be cast into this form (under various approximations), by using approximation techniques such as the <a href="system_size_expansion" title="wikilink">system size expansion</a>.</p>
<h2 id="quantum-master-equations">Quantum master equations</h2>

<p>A <a href="quantum_master_equation" title="wikilink">quantum master equation</a> is a generalization of the idea of a master equation. Rather than just a system of differential equations for a set of probabilities (which only constitutes the diagonal elements of a <a href="density_matrix" title="wikilink">density matrix</a>), quantum master equations are differential equations for the entire density matrix, including off-diagonal elements. A density matrix with only diagonal elements can be modeled as a classical random process, therefore such an "ordinary" master equation is considered classical. Off-diagonal elements represent <a href="quantum_coherence" title="wikilink">quantum coherence</a> which is a physical characteristic that is intrinsically quantum mechanical.</p>

<p>The <a href="Lindblad_equation" title="wikilink">Lindblad equation</a> was a primitive example of a <a href="quantum_master_equation" title="wikilink">quantum master equation</a>. More accurate quantum master equations include the polaron transformed quantum master equation, and the <a href="variational_polaron_transformed_quantum_master_equation" title="wikilink">variational polaron transformed quantum master equation</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Markov_process" title="wikilink">Markov process</a></li>
<li><a href="Quantum_master_equation" title="wikilink">Quantum master equation</a></li>
<li><a href="Fermi's_golden_rule" title="wikilink">Fermi's golden rule</a></li>
<li><a href="Detailed_balance" title="wikilink">Detailed balance</a></li>
<li><a href="Boltzmann's_H-theorem" title="wikilink">Boltzmann's H-theorem</a></li>
<li><a href="Continuous-time_Markov_process" title="wikilink">Continuous-time Markov process</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>Timothy Jones, <em><a href="http://www.physics.drexel.edu/~tim/open/mas/mas.html">A Quantum Optics Derivation</a></em> (2006)</li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_mechanics" title="wikilink">Category:Statistical mechanics</a> <a href="Category:Stochastic_processes" title="wikilink">Category:Stochastic processes</a> <a class="uri" href="Category:Equations" title="wikilink">Category:Equations</a> <a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

   Generalized Dirichlet distribution      Generalized Dirichlet distribution   In statistics , the generalized Dirichlet distribution ( GD ) is a generalization of the Dirichlet distribution with a more general covariance structure and almost twice the number of parameters. Random variables with a GD distribution are neutral but not completely neutral. 1  The density function of     p  1   ,  …  ,   p   k  -  1        subscript  p  1   normal-…   subscript  p    k  1      p_{1},\ldots,p_{k-1}   is        [    ∏   i  =  1    k  -  1     B   (   a  i   ,   b  i   )     ]    -  1     p  k    b   k  -  1    -  1      ∏   i  =  1    k  -  1     [    p  i    a  i   -  1      (    ∑   j  =  i   k    p  j    )     b   i  -  1    -   (    a  i   +   b  i    )      ]         superscript   delimited-[]    superscript   subscript  product    i  1      k  1      B    subscript  a  i    subscript  b  i         1     superscript   subscript  p  k      subscript  b    k  1    1      superscript   subscript  product    i  1      k  1     delimited-[]     superscript   subscript  p  i      subscript  a  i   1     superscript    superscript   subscript     j  i    k    subscript  p  j       subscript  b    i  1       subscript  a  i    subscript  b  i           \left[\prod_{i=1}^{k-1}B(a_{i},b_{i})\right]^{-1}p_{k}^{b_{k-1}-1}\prod_{i=1}^%
 {k-1}\left[p_{i}^{a_{i}-1}\left(\sum_{j=i}^{k}p_{j}\right)^{b_{i-1}-(a_{i}+b_{%
 i})}\right]   where we define     p  k   =   1  -    ∑   i  =  1    k  -  1     p  i          subscript  p  k     1    superscript   subscript     i  1      k  1     subscript  p  i       p_{k}=1-\sum_{i=1}^{k-1}p_{i}   . Here    B   (  x  ,  y  )       B   x  y     B(x,y)   denotes the Beta function . This reduces to the standard Dirichlet distribution if     b   i  -  1    =    a  i   +   b  i         subscript  b    i  1       subscript  a  i    subscript  b  i      b_{i-1}=a_{i}+b_{i}   for    2  ⩽  i  ⩽   k  -  1         2  i         k  1      2\leqslant i\leqslant k-1   (    b  0     subscript  b  0    b_{0}   is arbitrary).  For example, if k=4 , then the density function of     p  1   ,   p  2   ,   p  3       subscript  p  1    subscript  p  2    subscript  p  3     p_{1},p_{2},p_{3}   is        [    ∏   i  =  1   3    B   (   a  i   ,   b  i   )     ]    -  1     p  1    a  1   -  1     p  2    a  2   -  1     p  3    a  3   -  1     p  4    b  3   -  1      (    p  2   +   p  3   +   p  4    )     b  1   -   (    a  2   +   b  2    )       (    p  3   +   p  4    )     b  2   -   (    a  3   +   b  3    )          superscript   delimited-[]    superscript   subscript  product    i  1    3     B    subscript  a  i    subscript  b  i         1     superscript   subscript  p  1      subscript  a  1   1     superscript   subscript  p  2      subscript  a  2   1     superscript   subscript  p  3      subscript  a  3   1     superscript   subscript  p  4      subscript  b  3   1     superscript     subscript  p  2    subscript  p  3    subscript  p  4       subscript  b  1      subscript  a  2    subscript  b  2       superscript     subscript  p  3    subscript  p  4       subscript  b  2      subscript  a  3    subscript  b  3        \left[\prod_{i=1}^{3}B(a_{i},b_{i})\right]^{-1}p_{1}^{a_{1}-1}p_{2}^{a_{2}-1}p%
 _{3}^{a_{3}-1}p_{4}^{b_{3}-1}\left(p_{2}+p_{3}+p_{4}\right)^{b_{1}-\left(a_{2}%
 +b_{2}\right)}\left(p_{3}+p_{4}\right)^{b_{2}-\left(a_{3}+b_{3}\right)}     where      p  1   +   p  2   +   p  3    <  1         subscript  p  1    subscript  p  2    subscript  p  3    1    p_{1}+p_{2}+p_{3}<1   and     p  4   =   1  -   p  1   -   p  2   -   p  3         subscript  p  4     1   subscript  p  1    subscript  p  2    subscript  p  3      p_{4}=1-p_{1}-p_{2}-p_{3}   .  Connor and Mosimann define the PDF as they did for the following reason. Define random variables     z  1   ,  …  ,   z   k  -  1        subscript  z  1   normal-…   subscript  z    k  1      z_{1},\ldots,z_{k-1}   with      z  1   =   p  1    ,     z  2   =    p  2   /   (   1  -   p  1    )     ,     z  3   =     p  3   /   (   1  -   (    p  1   +   p  2    )    )    ,  …    ,    z  i   =    p  i   /   (    1  -   p  1    +  ⋯  +   p   i  -  1     )          formulae-sequence     subscript  z  1    subscript  p  1     formulae-sequence     subscript  z  2      subscript  p  2     1   subscript  p  1       formulae-sequence     subscript  z  3       subscript  p  3     1     subscript  p  1    subscript  p  2      normal-…       subscript  z  i      subscript  p  i       1   subscript  p  1    normal-⋯   subscript  p    i  1           z_{1}=p_{1},z_{2}=p_{2}/\left(1-p_{1}\right),z_{3}=p_{3}/\left(1-(p_{1}+p_{2})%
 \right),\ldots,z_{i}=p_{i}/\left(1-p_{1}+\cdots+p_{i-1}\right)   . Then     p  1   ,  …  ,   p  k       subscript  p  1   normal-…   subscript  p  k     p_{1},\ldots,p_{k}   have the generalized Dirichlet distribution as parametrized above, if the    z  i     subscript  z  i    z_{i}   are iid  beta with parameters     a  i   ,   b  i       subscript  a  i    subscript  b  i     a_{i},b_{i}   ,    i  =   1  ,  …  ,   k  -  1        i   1  normal-…    k  1      i=1,\ldots,k-1   .  Alternative form given by Wong  Wong 2 gives the slightly more concise form for      x  1   +  ⋯  +   x  k    ⩽  1         subscript  x  1   normal-⋯   subscript  x  k    1    x_{1}+\cdots+x_{k}\leqslant 1          ∏   i  =  1   k      x  i    α  i   -  1      (   1  -   x  1   -  …  -   x  i    )    γ  i      B   (   α  i   ,   β  i   )         superscript   subscript  product    i  1    k        superscript   subscript  x  i      subscript  α  i   1     superscript    1   subscript  x  1   normal-…   subscript  x  i     subscript  γ  i       B    subscript  α  i    subscript  β  i        \prod_{i=1}^{k}\frac{x_{i}^{\alpha_{i}-1}\left(1-x_{1}-\ldots-x_{i}\right)^{%
 \gamma_{i}}}{B(\alpha_{i},\beta_{i})}   where     γ  j   =    β  j   -   α   j  +  1    -   β   j  +  1          subscript  γ  j      subscript  β  j    subscript  α    j  1     subscript  β    j  1       \gamma_{j}=\beta_{j}-\alpha_{j+1}-\beta_{j+1}   for    1  ⩽  j  ⩽   k  -  1         1  j         k  1      1\leqslant j\leqslant k-1   and     γ  k   =    β  k   -  1        subscript  γ  k      subscript  β  k   1     \gamma_{k}=\beta_{k}-1   . Note that Wong defines a distribution over a   k   k   k   dimensional space (implicitly defining     x   k  +  1    =   1  -    ∑   i  =  1   k    x  i          subscript  x    k  1      1    superscript   subscript     i  1    k    subscript  x  i       x_{k+1}=1-\sum_{i=1}^{k}x_{i}   ) while Connor and Mosiman use a    k  -  1      k  1    k-1   dimensional space with     x  k   =   1  -    ∑   i  =  1    k  -  1     x  i          subscript  x  k     1    superscript   subscript     i  1      k  1     subscript  x  i       x_{k}=1-\sum_{i=1}^{k-1}x_{i}   .  General moment function  If    X  =   (   X  1   ,  …  ,   X  k   )   ∼   G   D  k    (   α  1   ,  …  ,   α  k   ;   β  1   ,  …  ,   β  k   )          X    subscript  X  1   normal-…   subscript  X  k      similar-to      G   subscript  D  k     subscript  α  1   normal-…   subscript  α  k    subscript  β  1   normal-…   subscript  β  k        X=\left(X_{1},\ldots,X_{k}\right)\sim GD_{k}\left(\alpha_{1},\ldots,\alpha_{k}%
 ;\beta_{1},\ldots,\beta_{k}\right)   , then       E   [    X  1   r  1     X  2   r  2    ⋯   X  k   r  k     ]    =    ∏   j  =  1   k     Γ   (    α  j   +   β  j    )   Γ   (    α  j   +   r  j    )   Γ   (    β  j   +   δ  j    )     Γ   (   α  j   )   Γ   (   β  j   )   Γ   (    α  j   +   β  j   +   r  j   +   δ  j    )            E   delimited-[]     superscript   subscript  X  1    subscript  r  1     superscript   subscript  X  2    subscript  r  2    normal-⋯   superscript   subscript  X  k    subscript  r  k         superscript   subscript  product    j  1    k       normal-Γ     subscript  α  j    subscript  β  j    normal-Γ     subscript  α  j    subscript  r  j    normal-Γ     subscript  β  j    subscript  δ  j       normal-Γ   subscript  α  j   normal-Γ   subscript  β  j   normal-Γ     subscript  α  j    subscript  β  j    subscript  r  j    subscript  δ  j         E\left[X_{1}^{r_{1}}X_{2}^{r_{2}}\cdots X_{k}^{r_{k}}\right]=\prod_{j=1}^{k}%
 \frac{\Gamma\left(\alpha_{j}+\beta_{j}\right)\Gamma\left(\alpha_{j}+r_{j}%
 \right)\Gamma\left(\beta_{j}+\delta_{j}\right)}{\Gamma\left(\alpha_{j}\right)%
 \Gamma\left(\beta_{j}\right)\Gamma\left(\alpha_{j}+\beta_{j}+r_{j}+\delta_{j}%
 \right)}   where     δ  j   =    r   j  +  1    +   r   j  +  2    +  ⋯  +   r  k         subscript  δ  j      subscript  r    j  1     subscript  r    j  2    normal-⋯   subscript  r  k      \delta_{j}=r_{j+1}+r_{j+2}+\cdots+r_{k}   for    j  =   1  ,  2  ,  ⋯  ,   k  -  1        j   1  2  normal-⋯    k  1      j=1,2,\cdots,k-1   and     δ  k   =  0       subscript  δ  k   0    \delta_{k}=0   . Thus        E   (   X  j   )    =     α  j     α  j   +   β  j       ∏   m  =  1    j  -  1      β  m     α  m   +   β  m        .        E   subscript  X  j         subscript  α  j      subscript  α  j    subscript  β  j       superscript   subscript  product    m  1      j  1       subscript  β  m      subscript  α  m    subscript  β  m         E\left(X_{j}\right)=\frac{\alpha_{j}}{\alpha_{j}+\beta_{j}}\prod_{m=1}^{j-1}%
 \frac{\beta_{m}}{\alpha_{m}+\beta_{m}}.     Reduction to standard Dirichlet distribution  As stated above, if     b   i  -  1    =    a  i   +   b  i         subscript  b    i  1       subscript  a  i    subscript  b  i      b_{i-1}=a_{i}+b_{i}   for    2  ⩽  i  ⩽  k        2  i       k     2\leqslant i\leqslant k   then the distribution reduces to a standard Dirichlet. This condition is different from the usual case, in which setting the additional parameters of the generalized distribution to zero results in the original distribution. However, in the case of the GDD, this results in a very complicated density function.  Bayesian analysis  Suppose    X  =   (   X  1   ,  …  ,   X  k   )   ∼   G   D  k    (   α  1   ,  …  ,   α  k   ;   β  1   ,  …  ,   β  k   )          X    subscript  X  1   normal-…   subscript  X  k      similar-to      G   subscript  D  k     subscript  α  1   normal-…   subscript  α  k    subscript  β  1   normal-…   subscript  β  k        X=\left(X_{1},\ldots,X_{k}\right)\sim GD_{k}\left(\alpha_{1},\ldots,\alpha_{k}%
 ;\beta_{1},\ldots,\beta_{k}\right)   is generalized Dirichlet, and that    Y  |  X     fragments  Y  normal-|  X    Y|X   is multinomial with   n   n   n   trials (here    Y  =   (   Y  1   ,  …  ,   Y  k   )       Y    subscript  Y  1   normal-…   subscript  Y  k      Y=\left(Y_{1},\ldots,Y_{k}\right)   ). Writing     Y  j   =   y  j        subscript  Y  j    subscript  y  j     Y_{j}=y_{j}   for    1  ⩽  j  ⩽  k        1  j       k     1\leqslant j\leqslant k   and     y   k  +  1    =   n  -    ∑   i  =  1   k    y  i          subscript  y    k  1      n    superscript   subscript     i  1    k    subscript  y  i       y_{k+1}=n-\sum_{i=1}^{k}y_{i}   the joint posterior of    X  |  Y     fragments  X  normal-|  Y    X|Y   is a generalized Dirichlet distribution with      X  |  Y  ∼  G   D  k    (   α   ′  1    ,  …  ,   α   ′  k    ;   β   ′  1    ,  …  ,   β   ′  k    )      fragments  X  normal-|  Y  similar-to  G   subscript  D  k    fragments  normal-(   subscript   superscript  α  normal-′   1   normal-,  normal-…  normal-,   subscript   superscript  α  normal-′   k   normal-;   subscript   superscript  β  normal-′   1   normal-,  normal-…  normal-,   subscript   superscript  β  normal-′   k   normal-)     X|Y\sim GD_{k}\left({\alpha^{\prime}}_{1},\ldots,{\alpha^{\prime}}_{k};{\beta^%
 {\prime}}_{1},\ldots,{\beta^{\prime}}_{k}\right)     where     α   ′  j    =    α  j   +   y  j         subscript   superscript  α  normal-′   j      subscript  α  j    subscript  y  j      {\alpha^{\prime}}_{j}=\alpha_{j}+y_{j}   and     β   ′  j    =    β  j   +    ∑   i  =   j  +  1     k  +  1     y  i          subscript   superscript  β  normal-′   j      subscript  β  j     superscript   subscript     i    j  1       k  1     subscript  y  i       {\beta^{\prime}}_{j}=\beta_{j}+\sum_{i=j+1}^{k+1}y_{i}   for     1  ⩽  k   .      1  k    1\leqslant k.     Sampling experiment  Wong gives the following system as an example of how the Dirichlet and generalized Dirichlet distributions differ. He posits that a large urn contains balls of    k  +  1      k  1    k+1   different colours. The proportion of each colour is unknown. Write    X  =   (   X  1   ,  …  ,   X  k   )       X    subscript  X  1   normal-…   subscript  X  k      X=(X_{1},\ldots,X_{k})   for the proportion of the balls with colour   j   j   j   in the urn.  Experiment 1 . Analyst 1 believes that    X  ∼   D   (   α  1   ,  …  ,   α  k   ,   α   k  +  1    )       similar-to  X    D    subscript  α  1   normal-…   subscript  α  k    subscript  α    k  1        X\sim D(\alpha_{1},\ldots,\alpha_{k},\alpha_{k+1})   (ie,   X   X   X   is Dirichlet with parameters    α  i     subscript  α  i    \alpha_{i}   ). The analyst then makes    k  +  1      k  1    k+1   glass boxes and puts    α  i     subscript  α  i    \alpha_{i}   marbles of colour   i   i   i   in box   i   i   i   (it is assumed that the    α  i     subscript  α  i    \alpha_{i}   are integers     ≥  1      absent  1    \geq 1   ). Then analyst 1 draws a ball from the urn, observes its colour (say colour   j   j   j   ) and puts it in box   j   j   j   . He can identify the correct box because they are transparent and the colours of the marbles within are visible. The process continues until   n   n   n   balls have been drawn. The posterior distribution is then Dirichlet with parameters being the number of marbles in each box.  Experiment 2 . Analyst 2 believes that   X   X   X   follows a generalized Dirichlet distribution    X  ∼   G  D   (   α  1   ,  …  ,   α  k   ;   β  1   ,  …  ,   β  k   )       similar-to  X    G  D    subscript  α  1   normal-…   subscript  α  k    subscript  β  1   normal-…   subscript  β  k       X\sim GD(\alpha_{1},\ldots,\alpha_{k};\beta_{1},\ldots,\beta_{k})   . All parameters are again assumed to be positive integers. The analyst makes    k  +  1      k  1    k+1   wooden boxes. The boxes have two areas: one for balls and one for marbles. The balls are coloured but the marbles are not coloured. Then for    j  =   1  ,  …  ,  k       j   1  normal-…  k     j=1,\ldots,k   , he puts    α  j     subscript  α  j    \alpha_{j}   balls of colour   j   j   j   , and    β  j     subscript  β  j    \beta_{j}   marbles, in to box   j   j   j   . He then puts a ball of colour    k  +  1      k  1    k+1   in box    k  +  1      k  1    k+1   . The analyst then draws a ball from the urn. Because the boxes are wood, the analyst cannot tell which box to put the ball in (as he could in experiment 1 above); he also has a poor memory and cannot remember which box contains which colour balls. He has to discover which box is the correct one to put the ball in. He does this by opening box 1 and comparing the balls in it to the drawn ball. If the colours differ, the box is the wrong one. The analyst puts a marble (sic) in box 1 and proceeds to box 2. He repeats the process until the balls in the box match the drawn ball, at which point he puts the ball (sic) in the box with the other balls of matching colour. The analyst then draws another ball from the urn and repeats until   n   n   n   balls are drawn. The posterior is then generalized Dirichlet with parameters   α   α   \alpha   being the number of balls, and   β   β   \beta   the number of marbles, in each box.  Note that in experiment 2, changing the order of the boxes has a non-trivial effect, unlike experiment 1.  See also   Dirichlet-multinomial distribution  Lukacs's proportion-sum independence theorem   References  "  Category:Continuous distributions  Category:Probability distributions  Category:Multivariate continuous distributions  Category:Conjugate prior distributions  Category:Exponential family distributions     R. J. Connor and J. E. Mosiman 1969. Concepts of independence for proportions with a generalization of the Dirichlet distribution . Journal of the American Statistical Association, volume 64, pp194--206 ↩  T.-T. Wong 1998. Generalized Dirichlet distribution in Bayesian analysis . Applied Mathematics and Computation, volume 97, pp165-181 ↩     
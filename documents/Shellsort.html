<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="66">Shellsort</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Shellsort</h1>
<hr/>

<p> <strong>Shellsort</strong>, also known as <strong>Shell sort</strong> or <strong>Shell's method</strong>, is an in-place <a href="comparison_sort" title="wikilink">comparison sort</a>. It can be seen as either a generalization of sorting by exchange (<a href="bubble_sort" title="wikilink">bubble sort</a>) or sorting by insertion (<a href="insertion_sort" title="wikilink">insertion sort</a>).<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The method starts by sorting pairs of elements far apart from each other, then progressively reducing the gap between elements to be compared. Starting with far apart elements can move some out-of-place elements into position faster than a simple nearest neighbor exchange. <a href="Donald_Shell" title="wikilink">Donald Shell</a> published the first version of this sort in 1959.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The running time of Shellsort is heavily dependent on the gap sequence it uses. For many practical variants, determining their <a href="time_complexity" title="wikilink">time complexity</a> remains an <a href="open_problem" title="wikilink">open problem</a>.</p>
<h2 id="description">Description</h2>

<p>Shellsort is a generalization of <a href="insertion_sort" title="wikilink">insertion sort</a> that allows the exchange of items that are far apart. The idea is to arrange the list of elements so that, starting anywhere, considering every <em>h</em>th element gives a sorted list. Such a list is said to be <em>h</em>-sorted. Equivalently, it can be thought of as <em>h</em> interleaved lists, each individually sorted.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Beginning with large values of <em>h</em>, this rearrangement allows elements to move long distances in the original list, reducing large amounts of disorder quickly, and leaving less work for smaller <em>h</em>-sort steps to do.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> If the file is then <em>k-sorted</em> for some smaller integer <em>k</em>, then the file remains <em>h</em>-sorted. Following this idea for a decreasing sequence of <em>h</em> values ending in 1 is guaranteed to leave a sorted list in the end.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>An example run of Shellsort with gaps 5, 3 and 1 is shown below.</p>

<p>

<math display="inline" id="Shellsort:0">
 <semantics>
  <mtable>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>1</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>2</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>3</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>4</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>5</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>6</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>7</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>8</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>9</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>10</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>11</mn>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mrow>
      <mi>a</mi>
      <msub>
       <mo>;</mo>
       <mn>12</mn>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mtext>input data:</mtext>
    </mtd>
    <mtd columnalign="center">
     <mn>62</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>83</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>18</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>53</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>07</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>17</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>95</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>86</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>47</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>69</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>25</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>28</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mtext>after 5-sorting:</mtext>
    </mtd>
    <mtd columnalign="center">
     <mn>17</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>28</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>18</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>47</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>07</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>25</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>83</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>86</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>53</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>69</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>62</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>95</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mtext>after 3-sorting:</mtext>
    </mtd>
    <mtd columnalign="center">
     <mn>17</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>07</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>18</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>47</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>28</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>25</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>69</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>62</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>53</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>83</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>86</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>95</mn>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <mtext>after 1-sorting:</mtext>
    </mtd>
    <mtd columnalign="center">
     <mn>07</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>17</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>18</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>25</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>28</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>47</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>53</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>62</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>69</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>83</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>86</mn>
    </mtd>
    <mtd columnalign="center">
     <mn>95</mn>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">1</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">2</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">3</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">4</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">5</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">6</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">7</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">8</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">9</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">10</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">11</cn>
      </apply>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-;</ci>
       <cn type="integer">12</cn>
      </apply>
     </cerror>
    </matrixrow>
    <matrixrow>
     <mtext>input data:</mtext>
     <cn type="integer">62</cn>
     <cn type="integer">83</cn>
     <cn type="integer">18</cn>
     <cn type="integer">53</cn>
     <cn type="integer">07</cn>
     <cn type="integer">17</cn>
     <cn type="integer">95</cn>
     <cn type="integer">86</cn>
     <cn type="integer">47</cn>
     <cn type="integer">69</cn>
     <cn type="integer">25</cn>
     <cn type="integer">28</cn>
    </matrixrow>
    <matrixrow>
     <mtext>after 5-sorting:</mtext>
     <cn type="integer">17</cn>
     <cn type="integer">28</cn>
     <cn type="integer">18</cn>
     <cn type="integer">47</cn>
     <cn type="integer">07</cn>
     <cn type="integer">25</cn>
     <cn type="integer">83</cn>
     <cn type="integer">86</cn>
     <cn type="integer">53</cn>
     <cn type="integer">69</cn>
     <cn type="integer">62</cn>
     <cn type="integer">95</cn>
    </matrixrow>
    <matrixrow>
     <mtext>after 3-sorting:</mtext>
     <cn type="integer">17</cn>
     <cn type="integer">07</cn>
     <cn type="integer">18</cn>
     <cn type="integer">47</cn>
     <cn type="integer">28</cn>
     <cn type="integer">25</cn>
     <cn type="integer">69</cn>
     <cn type="integer">62</cn>
     <cn type="integer">53</cn>
     <cn type="integer">83</cn>
     <cn type="integer">86</cn>
     <cn type="integer">95</cn>
    </matrixrow>
    <matrixrow>
     <mtext>after 1-sorting:</mtext>
     <cn type="integer">07</cn>
     <cn type="integer">17</cn>
     <cn type="integer">18</cn>
     <cn type="integer">25</cn>
     <cn type="integer">28</cn>
     <cn type="integer">47</cn>
     <cn type="integer">53</cn>
     <cn type="integer">62</cn>
     <cn type="integer">69</cn>
     <cn type="integer">83</cn>
     <cn type="integer">86</cn>
     <cn type="integer">95</cn>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcccccccccccc}&a;_{1}&a;_{2}&a;_{3}&a;_{4}&a;_{5}&a;_{6}&a;_{7%
}&a;_{8}&a;_{9}&a;_{10}&a;_{11}&a;_{12}\\
\hbox{input data:}&62&83&18&53&07&17&95&86&47&69&25&28\\
\hbox{after 5-sorting:}&17&28&18&47&07&25&83&86&53&69&62&95\\
\hbox{after 3-sorting:}&17&07&18&47&28&25&69&62&53&83&86&95\\
\hbox{after 1-sorting:}&07&17&18&25&28&47&53&62&69&83&86&95\\
\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>The first pass, 5-sorting, performs insertion sort on separate subarrays (<em>a</em><sub>1</sub>, <em>a</em><sub>6</sub>, <em>a</em><sub>11</sub>), (<em>a</em><sub>2</sub>, <em>a</em><sub>7</sub>, <em>a</em><sub>12</sub>), (<em>a</em><sub>3</sub>, <em>a</em><sub>8</sub>), (<em>a</em><sub>4</sub>, <em>a</em><sub>9</sub>), (<em>a</em><sub>5</sub>, <em>a</em><sub>10</sub>). For instance, it changes the subarray (<em>a</em><sub>1</sub>, <em>a</em><sub>6</sub>, <em>a</em><sub>11</sub>) from (62, 17, 25) to (17, 25, 62). The next pass, 3-sorting, performs insertion sort on the subarrays (<em>a</em><sub>1</sub>, <em>a</em><sub>4</sub>, <em>a</em><sub>7</sub>, <em>a</em><sub>10</sub>), (<em>a</em><sub>2</sub>, <em>a</em><sub>5</sub>, <em>a</em><sub>8</sub>, <em>a</em><sub>11</sub>), (<em>a</em><sub>3</sub>, <em>a</em><sub>6</sub>, <em>a</em><sub>9</sub>, <em>a</em><sub>12</sub>). The last pass, 1-sorting, is an ordinary insertion sort of the entire array (<em>a</em><sub>1</sub>,..., <em>a</em><sub>12</sub>).</p>

<p>As the example illustrates, the subarrays that Shellsort operates on are initially short; later they are longer but almost ordered. In both cases insertion sort works efficiently.</p>

<p>Shellsort is <a href="sorting_algorithm#Stability" title="wikilink">unstable</a>: it may change the relative order of elements with equal values. It is an <a href="Adaptive_sort" title="wikilink"> adaptive sorting algorithm</a> in that it executes faster when the input is partially sorted.</p>
<h2 id="pseudocode">Pseudocode</h2>

<p>Using Marcin Ciura's gap sequence, with an inner insertion sort.</p>

<p><em><code>#</code> <code>Sort</code> <code>an</code> <code>array</code> <code>a[0...n-1].</code></em><br/>
<code>gaps = [701, 301, 132, 57, 23, 10, 4, 1]</code><br/>
<br/>
<em><code>#</code> <code>Start</code> <code>with</code> <code>the</code> <code>largest</code> <code>gap</code> <code>and</code> <code>work</code> <code>down</code> <code>to</code> <code>a</code> <code>gap</code> <code>of</code> <code>1</code></em><code> </code><br/>
<strong><a href="foreach" title="wikilink"><code>foreach</code></a></strong><code> (gap in gaps)</code><br/>
<code>{</code><br/>
<code>    </code><em><code>#</code> <code>Do</code> <code>a</code> <code>gapped</code> <code>insertion</code> <code>sort</code> <code>for</code> <code>this</code> <code>gap</code> <code>size.</code></em><br/>
<code>    </code><em><code>#</code> <code>The</code> <code>first</code> <code>gap</code> <code>elements</code> <code>a[0..gap-1]</code> <code>are</code> <code>already</code> <code>in</code> <code>gapped</code> <code>order</code></em><br/>
<code>    </code><em><code>#</code> <code>keep</code> <code>adding</code> <code>one</code> <code>more</code> <code>element</code> <code>until</code> <code>the</code> <code>entire</code> <code>array</code> <code>is</code> <code>gap</code> <code>sorted</code></em><code> </code><br/>
<code>    </code><strong><code>for</code></strong><code> (i = gap; i </code><code>= gap and a[j - gap] &gt; temp; j -= gap)</code><br/>
<code>        {</code><br/>
<code>            a[j] = a[j - gap]</code><br/>
<code>        }</code><br/>
<code>        </code><em><code>#</code> <code>put</code> <code>temp</code> <code>(the</code> <code>original</code> <code>a[i])</code> <code>in</code> <code>its</code> <code>correct</code> <code>location</code></em><br/>
<code>        a[j] = temp</code><br/>
<code>    }</code><br/>
<br/>
<code>}</code></p>
<h2 id="gap-sequences">Gap sequences</h2>

<p>The question of deciding which gap sequence to use is difficult. Every gap sequence that contains 1 yields a correct sort; however, the properties of thus obtained versions of Shellsort may be very different.</p>

<p>The table below compares most proposed gap sequences published so far. Some of them have decreasing elements that depend on the size of the sorted array (<em>N</em>). Others are increasing infinite sequences, whose elements less than <em>N</em> should be used in reverse order.</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>General term (<em>k</em> ≥ 1)</p></th>
<th style="text-align: left;">
<p>Concrete gaps</p></th>
<th style="text-align: left;">
<p>Worst-case<br/>
time complexity</p></th>
<th style="text-align: left;">
<p>Author and year of publication</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:1">
 <semantics>
  <mrow>
   <mo stretchy="false">⌊</mo>
   <mrow>
    <mi>N</mi>
    <mo>/</mo>
    <msup>
     <mn>2</mn>
     <mi>k</mi>
    </msup>
   </mrow>
   <mo stretchy="false">⌋</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <floor></floor>
    <apply>
     <divide></divide>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lfloor N/2^{k}\rfloor
  </annotation>
 </semantics>
</math>


</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:2">
 <semantics>
  <mrow>
   <mrow>
    <mo>⌊</mo>
    <mfrac>
     <mi>N</mi>
     <mn>2</mn>
    </mfrac>
    <mo>⌋</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>⌊</mo>
    <mfrac>
     <mi>N</mi>
     <mn>4</mn>
    </mfrac>
    <mo>⌋</mo>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <floor></floor>
     <apply>
      <divide></divide>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <floor></floor>
     <apply>
      <divide></divide>
      <ci>N</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <cn type="integer">1</cn>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lfloor\frac{N}{2}\right\rfloor,\left\lfloor\frac{N}{4}\right\rfloor,%
\ldots,1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:3">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(N^{2})
  </annotation>
 </semantics>
</math>

 [when <em>N</em>=2<sup><em>p</em></sup>]</p></td>
<td style="text-align: left;">
<p><a href="Donald_Shell" title="wikilink">Shell</a>, 1959<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:4">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">⌊</mo>
     <mrow>
      <mi>N</mi>
      <mo>/</mo>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">⌋</mo>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <floor></floor>
      <apply>
       <divide></divide>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\lfloor N/2^{k+1}\rfloor+1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo>⌊</mo>
      <mfrac>
       <mi>N</mi>
       <mn>4</mn>
      </mfrac>
      <mo>⌋</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <floor></floor>
       <apply>
        <divide></divide>
        <ci>N</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <cn type="integer">3</cn>
    <cn type="integer">1</cn>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\left\lfloor\frac{N}{4}\right\rfloor+1,\ldots,3,1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:6">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <divide></divide>
      <cn type="integer">3</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(N^{3/2})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>Frank &amp; Lazarus, 1960<ref>{{Cite journal</ref></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:7">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>k</mi>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{k}-1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:8">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>7</mn>
   <mo>,</mo>
   <mn>15</mn>
   <mo>,</mo>
   <mn>31</mn>
   <mo>,</mo>
   <mn>63</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">3</cn>
    <cn type="integer">7</cn>
    <cn type="integer">15</cn>
    <cn type="integer">31</cn>
    <cn type="integer">63</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,3,7,15,31,63,\ldots
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:9">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <divide></divide>
      <cn type="integer">3</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(N^{3/2})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p><a href="Thomas_N._Hibbard" title="wikilink">Hibbard</a>, 1963<ref>{{Cite journal</ref></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:10">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>k</mi>
   </msup>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{k}+1
  </annotation>
 </semantics>
</math>

, prefixed with 1</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:11">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo>,</mo>
   <mn>9</mn>
   <mo>,</mo>
   <mn>17</mn>
   <mo>,</mo>
   <mn>33</mn>
   <mo>,</mo>
   <mn>65</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">3</cn>
    <cn type="integer">5</cn>
    <cn type="integer">9</cn>
    <cn type="integer">17</cn>
    <cn type="integer">33</cn>
    <cn type="integer">65</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,3,5,9,17,33,65,\ldots
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:12">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <divide></divide>
      <cn type="integer">3</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(N^{3/2})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>Papernov &amp; Stasevich, 1965<ref>{{Cite journal</ref></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>successive numbers of the form 

<math display="inline" id="Shellsort:13">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>p</mi>
   </msup>
   <msup>
    <mn>3</mn>
    <mi>q</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>p</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">3</cn>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{p}3^{q}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:14">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>6</mn>
   <mo>,</mo>
   <mn>8</mn>
   <mo>,</mo>
   <mn>9</mn>
   <mo>,</mo>
   <mn>12</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
    <cn type="integer">3</cn>
    <cn type="integer">4</cn>
    <cn type="integer">6</cn>
    <cn type="integer">8</cn>
    <cn type="integer">9</cn>
    <cn type="integer">12</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,2,3,4,6,8,9,12,\ldots
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:15">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>N</mi>
     <mrow>
      <msup>
       <mi>log</mi>
       <mn>2</mn>
      </msup>
      <mi>N</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <log></log>
       <cn type="integer">2</cn>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(N\log^{2}N)
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p><a href="Vaughan_Ronald_Pratt" title="wikilink">Pratt</a>, 1971<ref name="Pratt">{{Cite book</ref></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:16">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mn>3</mn>
      <mi>k</mi>
     </msup>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">3</cn>
      <ci>k</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (3^{k}-1)/2
  </annotation>
 </semantics>
</math>

, not greater than 

<math display="inline" id="Shellsort:17">
 <semantics>
  <mrow>
   <mo stretchy="false">⌈</mo>
   <mrow>
    <mi>N</mi>
    <mo>/</mo>
    <mn>3</mn>
   </mrow>
   <mo stretchy="false">⌉</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ceiling></ceiling>
    <apply>
     <divide></divide>
     <ci>N</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lceil N/3\rceil
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:18">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>13</mn>
   <mo>,</mo>
   <mn>40</mn>
   <mo>,</mo>
   <mn>121</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">4</cn>
    <cn type="integer">13</cn>
    <cn type="integer">40</cn>
    <cn type="integer">121</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,4,13,40,121,\ldots
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:19">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Θ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Θ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <divide></divide>
      <cn type="integer">3</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta(N^{3/2})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p><a href="Vaughan_Ronald_Pratt" title="wikilink">Pratt</a>, 1971<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="block" id="Shellsort:20">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>q</mi>
   </msub>
   <mo>=</mo>
   <mi>min</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>n</mi>
    <mo>∈</mo>
    <mi>ℕ</mi>
    <mo>:</mo>
    <mi>n</mi>
    <mo>≥</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>5</mn>
      <mo>/</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>q</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>,</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>q</ci>
    </apply>
    <eq></eq>
    <min></min>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-{</ci>
     <csymbol cd="unknown">n</csymbol>
     <in></in>
     <csymbol cd="unknown">N</csymbol>
     <ci>normal-:</ci>
     <csymbol cd="unknown">n</csymbol>
     <geq></geq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <cn type="integer">5</cn>
       <divide></divide>
       <cn type="integer">2</cn>
       <ci>normal-)</ci>
      </cerror>
      <apply>
       <plus></plus>
       <ci>q</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-,</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{q}=\min\{n\in\mathbb{N}\colon n\geq(5/2)^{q+1},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Shellsort:21">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>7</mn>
   <mo>,</mo>
   <mn>21</mn>
   <mo>,</mo>
   <mn>48</mn>
   <mo>,</mo>
   <mn>112</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">3</cn>
    <cn type="integer">7</cn>
    <cn type="integer">21</cn>
    <cn type="integer">48</cn>
    <cn type="integer">112</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,3,7,21,48,112,\ldots
  </annotation>
 </semantics>
</math>

</p>

<p>:<math>\forall p\colon0\le p<q math=""></q></math></p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:22">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msqrt>
       <mrow>
        <mrow>
         <mn>8</mn>
         <mrow>
          <mi>ln</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>5</mn>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>/</mo>
        <mrow>
         <mi>ln</mi>
         <mi>N</mi>
        </mrow>
       </mrow>
      </msqrt>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">8</cn>
         <apply>
          <ln></ln>
          <apply>
           <divide></divide>
           <cn type="integer">5</cn>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <ln></ln>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{1+\sqrt{8\ln(5/2)/\ln N}})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:23">
 <semantics>
  <mrow>
   <msup>
    <mn>4</mn>
    <mi>k</mi>
   </msup>
   <mo>+</mo>
   <mrow>
    <mn>3</mn>
    <mo>⋅</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">4</cn>
     <ci>k</ci>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <cn type="integer">3</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   4^{k}+3\cdot 2^{k-1}+1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>Incerpi &amp; <a href="Robert_Sedgewick_(computer_scientist)" title="wikilink">Sedgewick</a>, 1985,<ref>{{Cite journal</ref></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:24">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>8</mn>
   <mo>,</mo>
   <mn>23</mn>
   <mo>,</mo>
   <mn>77</mn>
   <mo>,</mo>
   <mn>281</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">8</cn>
    <cn type="integer">23</cn>
    <cn type="integer">77</cn>
    <cn type="integer">281</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,8,23,77,281,\ldots
  </annotation>
 </semantics>
</math>

, prefixed with 1</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:25">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>4</mn>
      <mo>/</mo>
      <mn>3</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <divide></divide>
      <cn type="integer">4</cn>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{4/3})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>9</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mn>4</mn>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mo>-</mo>
       <msup>
        <mn>2</mn>
        <mfrac>
         <mi>k</mi>
         <mn>2</mn>
        </mfrac>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <msup>
      <mn>4</mn>
      <mrow>
       <mi>k</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>6</mn>
      <mo>⋅</mo>
      <msup>
       <mn>2</mn>
       <mfrac>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mn>2</mn>
       </mfrac>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">9</cn>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">4</cn>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <divide></divide>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">4</cn>
       <apply>
        <plus></plus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <cn type="integer">6</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   9(4^{k-1}-2^{\frac{k}{2}})+1,4^{k+1}-6\cdot 2^{\frac{k+1}{2}}+1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>Sedgewick, 1986<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:27">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo>,</mo>
   <mn>19</mn>
   <mo>,</mo>
   <mn>41</mn>
   <mo>,</mo>
   <mn>109</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">5</cn>
    <cn type="integer">19</cn>
    <cn type="integer">41</cn>
    <cn type="integer">109</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,5,19,41,109,\ldots
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:28">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>4</mn>
      <mo>/</mo>
      <mn>3</mn>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <apply>
      <divide></divide>
      <cn type="integer">4</cn>
      <cn type="integer">3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{4/3})
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>max</mi>
     <mrow>
      <mo>{</mo>
      <mrow>
       <mo>⌊</mo>
       <mrow>
        <mrow>
         <mn>5</mn>
         <msub>
          <mi>h</mi>
          <mrow>
           <mi>k</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>/</mo>
        <mn>11</mn>
       </mrow>
       <mo>⌋</mo>
      </mrow>
      <mo>,</mo>
      <mn>1</mn>
      <mo>}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <max></max>
      <apply>
       <floor></floor>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">5</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>h</ci>
          <apply>
           <minus></minus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">11</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{k}=\max\left\{\left\lfloor 5h_{k-1}/11\right\rfloor,1\right\},h_{0}=N
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>Sedgewick, 1986<ref name="Sedgewick">{{Cite journal</ref></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:30">
 <semantics>
  <mrow>
   <mrow>
    <mo>⌊</mo>
    <mfrac>
     <mrow>
      <mn>5</mn>
      <mi>N</mi>
     </mrow>
     <mn>11</mn>
    </mfrac>
    <mo>⌋</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo>⌊</mo>
    <mrow>
     <mfrac>
      <mn>5</mn>
      <mn>11</mn>
     </mfrac>
     <mrow>
      <mo>⌊</mo>
      <mfrac>
       <mrow>
        <mn>5</mn>
        <mi>N</mi>
       </mrow>
       <mn>11</mn>
      </mfrac>
      <mo>⌋</mo>
     </mrow>
    </mrow>
    <mo>⌋</mo>
   </mrow>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <floor></floor>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">5</cn>
       <ci>N</ci>
      </apply>
      <cn type="integer">11</cn>
     </apply>
    </apply>
    <apply>
     <floor></floor>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">5</cn>
       <cn type="integer">11</cn>
      </apply>
      <apply>
       <floor></floor>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">5</cn>
         <ci>N</ci>
        </apply>
        <cn type="integer">11</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>normal-…</ci>
    <cn type="integer">1</cn>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lfloor\frac{5N}{11}\right\rfloor,\left\lfloor\frac{5}{11}\left\lfloor%
\frac{5N}{11}\right\rfloor\right\rfloor,\ldots,1
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:31">
 <semantics>
  <mrow>
   <mo>⌈</mo>
   <mfrac>
    <mrow>
     <msup>
      <mn>9</mn>
      <mi>k</mi>
     </msup>
     <mo>-</mo>
     <msup>
      <mn>4</mn>
      <mi>k</mi>
     </msup>
    </mrow>
    <mrow>
     <mn>5</mn>
     <mo>⋅</mo>
     <msup>
      <mn>4</mn>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mfrac>
   <mo>⌉</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ceiling></ceiling>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">9</cn>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">4</cn>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <cn type="integer">5</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">4</cn>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lceil\frac{9^{k}-4^{k}}{5\cdot 4^{k-1}}\right\rceil
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p><a href="Gaston_Gonnet" title="wikilink">Gonnet</a> &amp; <a href="Ricardo_Baeza-Yates" title="wikilink"></a>, 1991<ref name="Gonnet">{{Cite book</ref></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:32">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>9</mn>
   <mo>,</mo>
   <mn>20</mn>
   <mo>,</mo>
   <mn>46</mn>
   <mo>,</mo>
   <mn>103</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">4</cn>
    <cn type="integer">9</cn>
    <cn type="integer">20</cn>
    <cn type="integer">46</cn>
    <cn type="integer">103</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,4,9,20,46,103,\ldots
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:33">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>10</mn>
   <mo>,</mo>
   <mn>23</mn>
   <mo>,</mo>
   <mn>57</mn>
   <mo>,</mo>
   <mn>132</mn>
   <mo>,</mo>
   <mn>301</mn>
   <mo>,</mo>
   <mn>701</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">4</cn>
    <cn type="integer">10</cn>
    <cn type="integer">23</cn>
    <cn type="integer">57</cn>
    <cn type="integer">132</cn>
    <cn type="integer">301</cn>
    <cn type="integer">701</cn>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,4,10,23,57,132,301,701
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>Tokuda, 1992<ref>{{Cite book</ref></p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>unknown</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Shellsort:34">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⌊</mo>
    <mrow>
     <mn>2.25</mn>
     <msub>
      <mi>h</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">⌋</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <floor></floor>
     <apply>
      <times></times>
      <cn type="float">2.25</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{k}=\lfloor 2.25h_{k-1}\rfloor
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>?</p></td>
<td style="text-align: left;">
<p>Ciura, 2001<ref>{{Cite book</ref></p></td>
</tr>
</tbody>
</table>

<p></p>
</dd>
</dl>

<p>When the binary representation of <em>N</em> contains many consecutive zeroes, Shellsort using Shell's original gap sequence makes Θ(<em>N</em><sup>2</sup>) comparisons in the worst case. For instance, this case occurs for <em>N</em> equal to a power of two when elements greater and smaller than the median occupy odd and even positions respectively, since they are compared only in the last pass.</p>

<p>Although it has higher complexity than the <em>O</em>(<em>N</em>log<em>N</em>) that is optimal for comparison sorts, Pratt's version lends itself to <a href="sorting_network" title="wikilink">sorting networks</a> and has the same asymptotic gate complexity as Batcher's <a href="bitonic_sorter" title="wikilink">bitonic sorter</a>.</p>

<p>Gonnet and Baeza-Yates observed that Shellsort makes the fewest comparisons on average when the ratios of successive gaps are roughly equal to 2.2.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> This is why their sequence with ratio 2.2 and Tokuda's sequence with ratio 2.25 prove efficient. However, it is not known why this is so. Sedgewick recommends to use gaps that have low <a href="greatest_common_divisor" title="wikilink">greatest common divisors</a> or are pairwise <a class="uri" href="coprime" title="wikilink">coprime</a>.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>With respect to the average number of comparisons, the best known gap sequences are 1, 4, 10, 23, 57, 132, 301, 701 and similar, with gaps found experimentally. Optimal gaps beyond 701 remain unknown, but good results can be obtained by extending the above sequence according to the recursive formula 

<math display="inline" id="Shellsort:35">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⌈</mo>
    <msubsup>
     <mi>h</mi>
     <mi>k</mi>
     <mo>′</mo>
    </msubsup>
    <mo stretchy="false">⌉</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <ceiling></ceiling>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{k}=\lceil h^{\prime}_{k}\rceil
  </annotation>
 </semantics>
</math>

.</p>

<p>Tokuda's sequence, defined by the simple formula 

<math display="inline" id="Shellsort:36">
 <semantics>
  <mrow>
   <msubsup>
    <mi>h</mi>
    <mi>k</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2.25</mn>
     <msubsup>
      <mi>h</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="float">2.25</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}_{k}=2.25h^{\prime}_{k-1}+1
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Shellsort:37">
 <semantics>
  <mrow>
   <msubsup>
    <mi>h</mi>
    <mn>1</mn>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <ci>normal-′</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}_{1}=1
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Shellsort:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>0.5349</mn>
     <mi>N</mi>
     <msqrt>
      <mi>N</mi>
     </msqrt>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>0.4387</mn>
     <mi>N</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>0.097</mn>
     <msqrt>
      <mi>N</mi>
     </msqrt>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="float">0.5349</cn>
      <ci>N</ci>
      <apply>
       <root></root>
       <ci>N</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="float">0.4387</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="float">0.097</cn>
      <apply>
       <root></root>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0.5349N\sqrt{N}-0.4387N-0.097\sqrt{N}+O(1)
  </annotation>
 </semantics>
</math>

, can be recommended for practical applications.</p>
<h2 id="computational-complexity">Computational complexity</h2>

<p>The following property holds: after <em>h</em><sub>2</sub>-sorting of any <em>h</em><sub>1</sub>-sorted array, the array remains <em>h</em><sub>1</sub>-sorted.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Every <em>h</em><sub>1</sub>-sorted and <em>h</em><sub>2</sub>-sorted array is also (<em>a</em><sub>1</sub><em>h</em><sub>1</sub>+<em>a</em><sub>2</sub><em>h</em><sub>2</sub>)-sorted, for any nonnegative integers <em>a</em><sub>1</sub> and <em>a</em><sub>2</sub>. The worst-case complexity of Shellsort is therefore connected with the <a href="coin_problem" title="wikilink">Frobenius problem</a>: for given integers <em>h</em><sub>1</sub>,..., <em>h</em><sub><em>n</em></sub> with gcd = 1, the Frobenius number <em>g</em>(<em>h</em><sub>1</sub>,..., <em>h</em><sub><em>n</em></sub>) is the greatest integer that cannot be represented as <em>a</em><sub>1</sub><em>h</em><sub>1</sub>+ ... +<em>a</em><sub><em>n</em></sub><em>h</em><sub><em>n</em></sub> with nonnegative integer <em>a</em><sub>1</sub>,..., <em>a</em><sub><em>n</em></sub>. Using known formulae for Frobenius numbers, we can determine the worst-case complexity of Shellsort for several classes of gap sequences.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> Proven results are shown in the above table.</p>

<p>With respect to the average number of operations, none of proven results concerns a practical gap sequence. For gaps that are powers of two, Espelid computed this average as 

<math display="inline" id="Shellsort:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>N</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>/</mo>
    <mi>h</mi>
   </mrow>
   <mo>+</mo>
   <msqrt>
    <mrow>
     <mi>π</mi>
     <msup>
      <mi>N</mi>
      <mn>3</mn>
     </msup>
     <mi>h</mi>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>h</ci>
    </apply>
    <apply>
     <root></root>
     <apply>
      <times></times>
      <ci>π</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>h</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2N^{2}/h+\sqrt{\pi N^{3}h}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> <a href="Donald_Knuth" title="wikilink">Knuth</a> determined the average complexity of sorting an <em>N</em>-element array with two gaps (<em>h</em>, 1) to be 

<math display="inline" id="Shellsort:40">
 <semantics>
  <mrow>
   <mfrac>
    <msup>
     <mi>N</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mn>4</mn>
     <mi>c</mi>
     <mi>h</mi>
    </mrow>
   </mfrac>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>N</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>c</ci>
      <ci>h</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{N^{2}}{4ch}+O(N)
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> It follows that a two-pass Shellsort with <em>h</em> = Θ(<em>N</em><sup>1/3</sup>) makes on average <em>O</em>(<em>N</em><sup>5/3</sup>) comparisons. <a href="Andrew_Yao" title="wikilink">Yao</a> found the average complexity of a three-pass Shellsort.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> His result was refined by Janson and Knuth:<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> the average number of comparisons made during a Shellsort with three gaps (<em>ch</em>, <em>cg</em>, 1), where <em>h</em> and <em>g</em> are coprime, is 

<math display="inline" id="Shellsort:41">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>8</mn>
      <mi>g</mi>
     </mrow>
    </mfrac>
    <msqrt>
     <mfrac>
      <mi>π</mi>
      <mrow>
       <mi>c</mi>
       <mi>h</mi>
      </mrow>
     </mfrac>
    </msqrt>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>h</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>h</mi>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">8</cn>
       <ci>g</ci>
      </apply>
     </apply>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <ci>π</ci>
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>h</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{8g}\sqrt{\frac{\pi}{ch}}(h-1)N^{3/2}+O(hN)
  </annotation>
 </semantics>
</math>

 in the first pass, 

<math display="inline" id="Shellsort:42">
 <semantics>
  <mrow>
   <mrow>
    <mi>ψ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo>,</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>N</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>8</mn>
    </mfrac>
    <msqrt>
     <mfrac>
      <mi>π</mi>
      <mi>c</mi>
     </mfrac>
    </msqrt>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>c</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>N</mi>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>c</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <msup>
       <mi>h</mi>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msup>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>c</mi>
       <mn>2</mn>
      </msup>
      <msup>
       <mi>g</mi>
       <mn>3</mn>
      </msup>
      <msup>
       <mi>h</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <interval closure="open">
      <ci>h</ci>
      <ci>g</ci>
     </interval>
     <ci>N</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">8</cn>
     </apply>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <ci>π</ci>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>N</ci>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>c</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(h,g)N+\frac{1}{8}\sqrt{\frac{\pi}{c}}(c-1)N^{3/2}+O((c-1)gh^{1/2}N)+O(c^{%
2}g^{3}h^{2})
  </annotation>
 </semantics>
</math>

 in the second pass and 

<math display="inline" id="Shellsort:43">
 <semantics>
  <mrow>
   <mrow>
    <msqrt>
     <mfrac>
      <mrow>
       <mi>π</mi>
       <mi>h</mi>
      </mrow>
      <mn>128</mn>
     </mfrac>
    </msqrt>
    <mi>g</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>g</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <msup>
       <mi>h</mi>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>g</mi>
      <msup>
       <mi>h</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>π</ci>
        <ci>h</ci>
       </apply>
       <cn type="integer">128</cn>
      </apply>
     </apply>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>O</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{\frac{\pi h}{128}}g+O(g^{-1/2}h^{1/2})+O(gh^{-1/2})
  </annotation>
 </semantics>
</math>

 in the third pass. <em>ψ</em>(<em>h</em>, <em>g</em>) in the last formula is a complicated function asymptotically equal to 

<math display="inline" id="Shellsort:44">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">⌊</mo>
    <mrow>
     <mn>2.25</mn>
     <msub>
      <mi>h</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">⌋</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <floor></floor>
     <apply>
      <times></times>
      <cn type="float">2.25</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{k}=\lfloor 2.25h_{k-1}\rfloor
  </annotation>
 </semantics>
</math>

. In particular, when <em>h</em> = Θ(<em>N</em><sup>7/15</sup>) and <em>g</em> = Θ(<em>N</em><sup>1/5</sup>), the average time of sorting is <em>O</em>(<em>N</em><sup>23/15</sup>).</p>

<p>Based on experiments, it is conjectured that Shellsort with <a href="Thomas_N._Hibbard" title="wikilink">Hibbard</a>'s gap sequence runs in <em>O</em>(<em>N</em><sup>5/4</sup>) average time,<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> and that Gonnet and Baeza-Yates's sequence requires on average 0.41<em>N</em>ln<em>N</em>(ln ln<em>N</em>+1/6) element moves.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> Approximations of the average number of operations formerly put forward for other sequences fail when sorted arrays contain millions of elements.</p>

<p>The graph below shows the average number of element comparisons in various variants of Shellsort, divided by the theoretical lower bound, i.e. log<sub>2</sub><em>N</em>!, where the sequence 1, 4, 10, 23, 57, 132, 301, 701 has been extended according to the formula <span class="LaTeX">$h_k = \lfloor2.25 h_{k-1}\rfloor$</span>.</p>
<figure><b>(Figure)</b>
<figcaption>Shell sort average number of comparisons (English).svg</figcaption>
</figure>

<p>Applying the theory of <a href="Kolmogorov_complexity" title="wikilink">Kolmogorov complexity</a>, Jiang, Li, and <a href="Paul_Vitanyi" title="wikilink">Vitányi</a> proved the following lower bounds for the order of the average number of operations in an <em>m</em>-pass Shellsort: Ω(<em>mN</em><sup>1+1/<em>m</em></sup>) when <em>m</em>≤log<sub>2</sub><em>N</em> and Ω(<em>mN</em>) when <em>m</em>&gt;log<sub>2</sub><em>N</em>.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> Therefore Shellsort has prospects of running in an average time that asymptotically grows like <em>N</em>log<em>N</em> only when using gap sequences whose number of gaps grows in proportion to the logarithm of the array size. It is, however, unknown whether Shellsort can reach this asymptotic order of average-case complexity, which is optimal for comparison sorts.</p>

<p>The worst-case complexity of any version of Shellsort is of higher order: Plaxton, Poonen, and <a href="Torsten_Suel" title="wikilink">Suel</a> showed that it grows at least as rapidly as Ω(<em>N</em>(log<em>N</em>/log log<em>N</em>)<sup>2</sup>).<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>
<h2 id="applications">Applications</h2>

<p>Shellsort is now rarely used in serious applications. It performs more operations and has higher <a href="CPU_cache#Cache_miss" title="wikilink">cache miss ratio</a> than <a class="uri" href="quicksort" title="wikilink">quicksort</a>. However, since it can be implemented using little code and does not use the <a href="call_stack" title="wikilink">call stack</a>, some implementations of the <a class="uri" href="qsort" title="wikilink">qsort</a> function in the <a href="C_standard_library" title="wikilink">C standard library</a> targeted at <a href="embedded_systems" title="wikilink">embedded systems</a> use it instead of quicksort. Shellsort is, for example, used in the <a class="uri" href="uClibc" title="wikilink">uClibc</a> library.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> For similar reasons, an implementation of Shellsort is present in the <a href="Linux_kernel" title="wikilink">Linux kernel</a>.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>

<p>Shellsort can also serve as a sub-algorithm of <a href="introsort" title="wikilink">introspective sort</a>, to sort short subarrays and to prevent a pathological slowdown when the recursion depth exceeds a given limit. This principle is employed, for instance, in the <a class="uri" href="bzip2" title="wikilink">bzip2</a> compressor.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Comb_sort" title="wikilink">Comb sort</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="bibliography">Bibliography</h2>
<ul>
<li></li>
<li><a href="http://www.cs.princeton.edu/~rs/shell/">Analysis of Shellsort and Related Algorithms</a>, Robert Sedgewick, Fourth European Symposium on Algorithms, Barcelona, September 1996.</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.youtube.com/watch?v=CmPA7zE8mx0">Shellsort with gaps 5, 3, 1 as a Hungarian folk dance</a></li>
</ul>

<p>"</p>

<p><a href="Category:Sorting_algorithms" title="wikilink">Category:Sorting algorithms</a> <a href="Category:Comparison_sorts" title="wikilink">Category:Comparison sorts</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3">Some older textbooks and references call this the "Shell-Metzner" sort after <a href="Marlene_Metzner_Norton" title="wikilink">Marlene Metzner Norton</a>, but according to Metzner, "I had nothing to do with the sort, and my name should never have been attached to it." See <a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"></li>
<li id="fn19"></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><a href="#fnref24">↩</a></li>
</ol>
</section>
</body>
</html>

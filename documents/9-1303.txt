   Determination of equilibrium constants      Determination of equilibrium constants   Equilibrium constants are determined in order to quantify chemical equilibria . When an equilibrium constant is expressed as a concentration quotient,      K  =      [  S  ]   σ     [  T  ]   τ   ⋯      [  A  ]   α     [  B  ]   β   ⋯        K       superscript   delimited-[]  S   σ    superscript   delimited-[]  T   τ   normal-⋯      superscript   delimited-[]  A   α    superscript   delimited-[]  B   β   normal-⋯      K=\frac{{[S]}^{\sigma}{[T]}^{\tau}\cdots}{{[A]}^{\alpha}{[B]}^{\beta}\cdots}   it is implied that the activity quotient is constant. In order for this assumption to be valid equilibrium constants should be determined in a medium of relatively high ionic strength . Where this is not possible, consideration should be given to possible activity variation.  The equilibrium expression above is a function of the concentrations [A], [B] etc. of the chemical species in equilibrium. The equilibrium constant value can be determined if any one of these concentrations can be measured. The general procedure is that the concentration in question is measured for a series of solutions with known analytical concentrations of the reactants. Typically, a titration is performed with one or more reactants in the titration vessel and one or more reactants in the burette. Knowing the analytical concentrations of reactants initially in the reaction vessel and in the burette, all analytical concentrations can be derived as a function of the volume (or mass) of titrant added.  The equilibrium constants may be derived by best-fitting of the experimental data with a chemical model of the equilibrium system.  Experimental methods  There are four main experimental methods. For less commonly used methods, see Rossotti and Rossotti. 1  Potentiometric measurements  A free concentration [ A ] or activity { A } is measured by means of an ion selective electrode such as the glass electrode . If the electrode is calibrated using activity standards it is assumed that the Nernst equation applies in the form      E  =    E  0   +     R  T    n  F     ln  A         E     superscript  E  0         R  T     n  F      A       E=E^{0}+\frac{RT}{nF}\ln{A}   where E 0 is the standard electrode potential . When buffer solutions of known pH are used for calibration the meter reading will be pH.       p  H   =     n  F    R  T     (    E  0   -  E   )          p  H         n  F     R  T       superscript  E  0   E      pH=\frac{nF}{RT}(E^{0}-E)   At 298K, 1 pH unit is approximately equal to 59 mV. 2  When the electrode is calibrated with solutions of known concentration, by means of a strong acid/strong base titration, for example, a modified Nernst equation is assumed.      E  =    E  0   +   s    log  10    [  A  ]          E     superscript  E  0     s    subscript   10   A       E=E^{0}+s\log_{10}[A]    s an empirical slope factor. A solution of known hydrogen ion concentration may be prepared by standardization of a strong acid against borax . Constant-boiling  hydrochloric acid may also be used as a primary standard for hydrogen ion concentration.  Spectrophotometric measurements  Absorbance  It is assumed that the Beer–Lambert law applies.      A  =   ℓ   ∑   ϵ  c         A    normal-ℓ      ϵ  c       A=\ell\sum{\epsilon c}     where ℓ is the optical path length, ϵ is a molar absorbance at unit path length and c is a concentration. More than one of the species may contribute to the absorbance. In principle absorbance may be measured at one wavelength only, but in present-day practice it is common to record complete spectra.  Fluorescence (luminescence) intensity  It is assumed that the scattered light intensity is a linear function of species’ concentrations.      I  =   ∑   ϕ  c        I      ϕ  c      I=\sum\phi c     where ϕ is a proportionality constant.  NMR chemical shift measurements  Chemical exchange is assumed to be rapid on the NMR time-scale. An individual chemical shift is the mole-fraction-weighted average of the shifts of nuclei in contributing species.       δ  ¯   =    ∑    c  i    δ  i      ∑   c  i          normal-¯  δ          subscript  c  i    subscript  δ  i        subscript  c  i       \bar{\delta}=\frac{\sum c_{i}\delta_{i}}{\sum c_{i}}     Calorimetric measurements  Simultaneous measurement of K and Δ H for 1:1 adducts is routinely carried out using isothermal titration calorimetry . Extension to more complex systems is limited by the availability of suitable software.  Range and limitations   Potentiometry. The most widely used electrode is the glass electrode which is selective for the hydrogen ion. This is suitable for all acid-base equilibria. Log 10  β values between about 2 and 11 can be measured directly by potentiometric titration using a glass electrode. This enormous range is possible because of the logarithmic response of the electrode. The limitations arise because the Nernst equation breaks down at very low or very high pH. The range can be extended by using the competition method . An example of the application of this method can be found in Palladium(II) cyanide  Absorbance and Luminescence. An upper limit on log 10  β of 4 is usually quoted, corresponding to the precision of the measurements, but it also depends on how intense the effect is. Spectra of contributing species should be clearly distinct from each other  NMR. Limited precision of chemical shift measurements also puts an upper limit of about 4 on log 10  β . Limited to diamagnetic systems.  Calorimetry. Insufficient evidence is currently available.   Computational methods  It is assumed that the experimental data which have been collected comprise a set of data points. At each i -th data point, the analytical concentrations of the reactants, T A  ( i ), T B ( i ) etc. are known along with a measured quantity, y i , that depends on one or more of these analytical concentrations. A general computational procedure has three main components.   Definion of a chemical model of the equilibria  Calculation of the concentrations of all the chemical species in each solution  Refinement of the equilibrium constants  Model selection   The chemical model  The chemical model consists of a set of chemical species present in solution, both the reactants added to the reaction mixture and the complex species formed from them. Denoting the reactants by A, B ..., each complex species is specified by the stoichiometric coefficients that relate the particular combination of reactants forming them.        p  A   +   q  B  …    ⇌    A  p    B  q   ⋯   :    β   p  q  ⋯    =    [    A  p    B  q   ⋯   ]      [  A  ]   p     [  B  ]   q   ⋯          normal-⇌      p  A     q  B  normal-…       subscript  A  p    subscript  B  q   normal-⋯     normal-:       subscript  β    p  q  normal-⋯       delimited-[]     subscript  A  p    subscript  B  q   normal-⋯       superscript   delimited-[]  A   p    superscript   delimited-[]  B   q   normal-⋯        pA+qB...\rightleftharpoons A_{p}B_{q}\cdots:\beta_{pq\cdots}=\frac{[A_{p}B_{q}%
 \cdots]}{[A]^{p}[B]^{q}\cdots}     When using general-purpose computer programs, it is usual to use cumulative , association constants , as shown above. Electrical charges are not shown in general expressions such as this and are often omitted from specific expressions, for simplicity of notation. In fact, electrical charges have no bearing on the equilibrium processes other that there being a requirement for overall electrical neutrality in all systems.  With aqueous solutions the concentrations of proton (hydronium ion) and hydroxide ion are constrained by the self-dissociation of water.        H  2   O   ⇌    H  +   +   O   H  -     :    K  W  ′   =     [   H  +   ]    [   O   H  -    ]     [    H  2   O   ]          normal-⇌     subscript  H  2   O      superscript  H      O   superscript  H        normal-:       superscript   subscript  K  W   normal-′        delimited-[]   superscript  H      delimited-[]    O   superscript  H        delimited-[]     subscript  H  2   O         H_{2}O\rightleftharpoons H^{+}+OH^{-}:K_{W}^{\prime}=\frac{[H^{+}][OH^{-}]}{[H%
 _{2}O]}     With dilute solutions the concentration of water can be assumed to be constant so the equilibrium expression is written in the familiar form of the ionic product of water.       K  W   =    [   H  +   ]    [   O   H  -    ]         subscript  K  W      delimited-[]   superscript  H      delimited-[]    O   superscript  H         K_{W}=[H^{+}][OH^{-}]\,     When both H + and OH − must be considered as reactants, one of them is eliminated from the model by specifying that its concentration is to be derived from the concentration of the other. Usually the concentration of the hydroxide ion is given by       [   O   H  -    ]   =    K  W      [   H  +   ]    -  1           delimited-[]    O   superscript  H         subscript  K  W    superscript   delimited-[]   superscript  H       1       [OH^{-}]=K_{W}[H^{+}]^{-1}\,   In this case the equilibrium constant for the formation of hydroxide has the stoichiometric coefficients −1 in regard to the proton and zero for the other reactants. This has important implications for all protonation equilibria in aqueous solution and for hydrolysis constants in particular.  It is quite usual to omit from the model those species whose concentrations are considered to be negligible. For example it is usually assumed then there is no interaction between the reactants and/or complexes and the electrolyte used to maintain constant ionic strength or the buffer used to maintain constant pH. These assumptions may or may not be justified. Also, it is implicitly assumed that there are no other complex species present. When complexes are wrongly ignored a systematic error is introduced into the calculations.  Equilibrium constant values are usually estimated initially by reference to data sources .  Speciation calculations  A speciation calculation is one in which the concentrations of all the species in an equilibrium system are calculated, knowing the analytical concentrations, T A , T B etc. of the reactants A, B etc. This means solving a set of non-linear equations of mass-balance      T  A     subscript  T  A    \displaystyle T_{A}     for the free concentrations [A], [B] etc. The concentrations of the complexes are derived from the free concentrations via the chemical model. Some authors 3 4 include the free reactant terms in the sums by declaring identity (unit)   β   β   \beta   constants for which the stoichiometric coefficients are 1 for the reactant concerned and zero for all other reactants:        [  A  ]   =    β   10  …     [  A  ]     ,    [  B  ]   =    β   01  …     [  B  ]    …        formulae-sequence     delimited-[]  A      subscript  β    10  normal-…     delimited-[]  A        delimited-[]  B      subscript  β    01  normal-…     delimited-[]  B   normal-…      [A]=\beta_{10\ldots}[A],[B]=\beta_{01\ldots}[B]\ldots\,          β   10  …    =    β   01  …    …   =   1          subscript  β    10  normal-…       subscript  β    01  normal-…    normal-…        1     \beta_{10\ldots}=\beta_{01\ldots}\ldots=1\,     In this manner, all chemical species, including the free reactants , are treated in the same way, having been formed from the combination of reactants that is specified by the stoichiometric coefficients. The mass-balance equations assume the simpler form.      T  A     subscript  T  A    \displaystyle T_{A}     In a titration system the analytical concentrations of the reactants at each titration point are obtained from the initial conditions, the burette concentrations and volumes. The analytical (total) concentration of a reactant R at the i 'th titration point is given by       T  R   =     R  0   +    v  i    [  R  ]       v  0   +   v  i          subscript  T  R        subscript  R  0      subscript  v  i    delimited-[]  R        subscript  v  0    subscript  v  i       T_{R}=\frac{R_{0}+v_{i}[R]}{v_{0}+v_{i}}     where    R  0     subscript  R  0    R_{0}   is the initial amount of R in the titration vessel,    v  0     subscript  v  0    v_{0}   is the initial volume,    [  R  ]     delimited-[]  R    [R]   is the concentration of R in the burette and    v  i     subscript  v  i    v_{i}   is the volume added. The burette concentration of a reactant not present in the burette is taken to be zero.  In general, solving these non-linear equations presents a formidable challenge because of the huge range over which the free concentrations may vary. At the beginning, values for the free concentrations must be estimated. Then, these values are refined, usually by means of Newton–Raphson iterations. The logarithms of the free concentrations may be refined rather than the free concentrations themselves. Refinement of the logarithms of the free concentrations has the added advantage of automatically imposing a non-negativity constraint on the free concentrations. Once the free reactant concentrations have been calculated, the concentrations of the complexes are derived from them and the equilibrium constants.  Note that the free reactant concentrations can be regarded as implicit parameters in the equilibrium constant refinement process. In that context the values of the free concentrations are constrained by forcing the conditions of mass-balance to apply at all stages of the process.  Equilibrium constant refinement  The objective of the refinement process it to find equilibrium constant values that give the best fit to the experimental data. This is usually achieved by minimising an objective function , U , by the method of non-linear least-squares . First the residuals are defined as       r  i   =    y  i  obs   -   y  i  calc         subscript  r  i      superscript   subscript  y  i   obs    superscript   subscript  y  i   calc      r_{i}=y_{i}^{\text{obs}}-y_{i}^{\text{calc}}     Then the most general objective function is given by      U  =    ∑  i     ∑  j     r  i    W   i  j      r  j           U    subscript   i     subscript   j      subscript  r  i    subscript  W    i  j     subscript  r  j        U=\sum_{i}\sum_{j}r_{i}W_{ij}r_{j}\,     The matrix of weights, W , should be, ideally, the inverse of the variance-covariance matrix of the observations. It is rare for this to be known. However, when it is, the expectation value of U is one, which means that the data are fitted within experimental error . Most often only the diagonal elements are known, in which case the objective function simplifies to      U  =    ∑  i     W   i  i     r  i  2         U    subscript   i      subscript  W    i  i     superscript   subscript  r  i   2       U=\sum_{i}W_{ii}r_{i}^{2}     with     W   i  j    =  0       subscript  W    i  j    0    W_{ij}=0   when j ≠ i . Unit weights,     W   i  i    =  1       subscript  W    i  i    1    W_{ii}=1   , are often used but, in that case, the expectation value of U is the root mean square of the experimental errors.  The minimization may be performed using the Gauss–Newton method . Firstly the objective function is linearised by approximating it as a first-order Taylor series expansion about an initial parameter set, p .      U  =    U  0   +    ∑  i      ∂  U    ∂   p  i     δ   p  i          U     superscript  U  0     subscript   i         U      subscript  p  i     δ   subscript  p  i        U=U^{0}+\sum_{i}\frac{\partial U}{\partial p_{i}}\delta p_{i}   The increments    δ   p  i       δ   subscript  p  i     \delta p_{i}   are to be added to the corresponding initial parameters such that U is less than U 0 . At the minimum the derivatives     ∂  U    ∂   p  i          U      subscript  p  i      \frac{\partial U}{\partial p_{i}}   , which are simply related to the elements of the Jacobian matrix, J       J   j  k    =    ∂   y  j   c  a  l  c      ∂   p  k          subscript  J    j  k         superscript   subscript  y  j     c  a  l  c        subscript  p  k       J_{jk}=\frac{\partial y_{j}^{calc}}{\partial p_{k}}   where p k is the kth parameter of the refinement, are equal to zero. One or more equilibrium constants may be parameters of the refinement. However, the measured quantities (see above) represented by y are not expressed in terms of the equilibrium constants, but in terms of the species concentrations, which are implicit functions of these parameters. Therefore the Jacobian elements must be obtained using implicit differentiation .  The parameter increments    δ  𝐩      δ  𝐩    \mathbf{\delta p}   are calculated by solving the normal equations , derived from the conditions that      ∂  𝐔    ∂  𝐩    =  𝟎          𝐔     𝐩    0    \mathbf{\frac{\partial U}{\partial p}=0}   at the minimum.        (    𝐉  𝐓   𝐖𝐉   )   δ  𝐩   =    𝐉  𝐓   𝐖𝐫            superscript  𝐉  𝐓   𝐖𝐉   δ  𝐩      superscript  𝐉  𝐓   𝐖𝐫     \mathbf{\left(J^{T}WJ\right)\delta p=J^{T}Wr}     The increments    δ  p      δ  p    \delta p   are added iteratively to the parameters       𝐩   𝐧  +  𝟏    =    𝐩  𝐧   +   δ  𝐩         superscript  𝐩    𝐧  1       superscript  𝐩  𝐧     δ  𝐩      \mathbf{p^{n+1}=p^{n}+\delta p}   where n is an iteration number. The species concentrations and    y   c  a  l  c      superscript  y    c  a  l  c     y^{calc}   values are recalculated at every data point. The iterations are continued until no significant reduction in U is achieved, that is, until a convergence criterion is satisfied. If, however, the updated parameters do not result in a decrease of the objective function, that is, if divergence occurs, the increment calculation must be modified. The simplest modification is to use a fraction, f , of calculated increment, so-called shift-cutting.       𝐩   𝐧  +  𝟏    =    𝐩  𝐧   +   f  δ  𝐩         superscript  𝐩    𝐧  1       superscript  𝐩  𝐧     f  δ  𝐩      \mathbf{p^{n+1}=p^{n}}+f\mathbf{\delta p}   In this case, the direction of the shift vector,    δ  𝐩      δ  𝐩    \mathbf{\delta p}   , is unchanged. With the more powerful Levenberg–Marquardt algorithm , on the other hand, the shift vector is rotated towards the direction of steepest descent , by modifying the normal equations,        (     𝐉  𝐓   𝐖𝐉   +   λ  𝐈    )   δ  𝐩   =    𝐉  𝐓   𝐖𝐫              superscript  𝐉  𝐓   𝐖𝐉     λ  𝐈    δ  𝐩      superscript  𝐉  𝐓   𝐖𝐫     \mathbf{\left(J^{T}WJ+\lambda I\right)\delta p=J^{T}Wr}   where   λ   λ   \lambda   is the Marquardt parameter and I is an identity matrix. Other methods of handling divergence have been proposed. 5  A particular issue arises with NMR and spectrophotometric data. For the latter, the observed quantity is absorbance, A, and the Beer–Lambert law can be written as       A  i   =   ∑    ϵ   p  q  ⋯     c    p  q  ⋯   ,  i           subscript  A  i        subscript  ϵ    p  q  normal-⋯     subscript  c     p  q  normal-⋯   i        A_{i}=\sum\epsilon_{pq\cdots}c_{pq\cdots,i}     It can be seen that absorbance, A, is a linear function of the molar absorbptivities,   ϵ   ϵ   \epsilon   , at the path length used. In matrix notation      𝐀  =    \Epsilon    𝐂        𝐀    \Epsilon  𝐂     \mathbf{A=\Epsilon C}\,     There are two approaches to the calculation of the unknown molar absorptivities   1) The   ϵ   ϵ   \epsilon   values are considered to be parameters of the minimization and the Jacobian is constructed on that basis. However, the   ϵ   ϵ   \epsilon   values themselves are calculated at each step of the refinement by linear least-squares:      \Epsilon   =     (    𝐂  𝐓   𝐂   )    -  𝟏     𝐂  𝐓   𝐀       \Epsilon     superscript     superscript  𝐂  𝐓   𝐂     1     superscript  𝐂  𝐓   𝐀     \mathbf{\Epsilon=\left(C^{T}C\right)^{-1}C^{T}A}      using the refined values of the equilibrium constants to obtain the speciation. The matrix      (    𝐂  𝐓   𝐂   )    -  𝟏     𝐂  𝐓        superscript     superscript  𝐂  𝐓   𝐂     1     superscript  𝐂  𝐓     \mathbf{\left(C^{T}C\right)^{-1}C^{T}}   is an example of a pseudo-inverse .  2) The Beer–Lambert law is written as     𝐀  =    (     (    𝐂  𝐓   𝐂   )    -  𝟏     𝐂  𝐓   𝐀   )   𝐂       𝐀       superscript     superscript  𝐂  𝐓   𝐂     1     superscript  𝐂  𝐓   𝐀   𝐂     \mathbf{A=\left(\left(C^{T}C\right)^{-1}C^{T}A\right)C}      Golub and Pereyra 6 showed how the pseudo-inverse can be differentiated so that parameter increments for both molar absorptivities and equilibrium constants can be calculated by solving the normal equations.   Parameter errors and correlation  In the region close to the minimum of the objective function, U , the system approximates to a linear least-squares system, for which      𝐩  =     (    𝐉  𝐓   𝐖𝐉   )    -  𝟏     𝐉  𝐓    𝐖𝐲  𝐨𝐛𝐬        𝐩     superscript     superscript  𝐉  𝐓   𝐖𝐉     1     superscript  𝐉  𝐓    superscript  𝐖𝐲  𝐨𝐛𝐬      \mathbf{p=(J^{T}WJ)^{-1}J^{T}Wy^{obs}}   Therefore the parameter values are (approximately) linear combinations of the observed data values and the errors on the parameters, p , can be obtained by error propagation from the observations, y obs , using the linear formula. Let the variance-covariance matrix for the observations be denoted by    Σ  y     superscript  normal-Σ  y    \Sigma^{y}   and that of the parameters by    Σ  p     superscript  normal-Σ  p    \Sigma^{p}   . Then,       𝚺  𝐩   =     (    𝐉  𝐓   𝐖𝐉   )    -  𝟏     𝐉  𝐓   𝐖   𝚺  𝐲    𝐖  𝐓   𝐉    (    𝐉  𝐓   𝐖𝐉   )    -  𝟏          superscript  𝚺  𝐩      superscript     superscript  𝐉  𝐓   𝐖𝐉     1     superscript  𝐉  𝐓   𝐖   superscript  𝚺  𝐲    superscript  𝐖  𝐓   𝐉   superscript     superscript  𝐉  𝐓   𝐖𝐉     1       \mathbf{\Sigma^{p}=(J^{T}WJ)^{-1}J^{T}W\Sigma^{y}W^{T}J(J^{T}WJ)^{-1}}   When    𝐖  =    (   𝚺  𝐲   )    -  𝟏        𝐖   superscript   superscript  𝚺  𝐲     1      \mathbf{W=(\Sigma^{y})^{-1}}   , this simplifies to       𝚺  𝐩   =    (    𝐉  𝐓   𝐖𝐉   )    -  𝟏         superscript  𝚺  𝐩    superscript     superscript  𝐉  𝐓   𝐖𝐉     1      \mathbf{\Sigma^{p}=(J^{T}WJ)^{-1}}   In most cases the errors on the observations are un-correlated, so that    Σ  y     superscript  normal-Σ  y    \Sigma^{y}   is diagonal . If so, each weight should be the reciprocal of the variance of the corresponding observation. For example, in a potentiometric titration , the weight at a titration point, k, can be given by       W  k   =   1    σ  E  2   +     (    ∂  E    ∂  v    )   k  2    σ  v  2           subscript  W  k     1     subscript   superscript  σ  2   E      subscript   superscript      E     v    2   k    subscript   superscript  σ  2   v        W_{k}=\frac{1}{\sigma^{2}_{E}+\left(\frac{\partial E}{\partial v}\right)^{2}_{%
 k}\sigma^{2}_{v}}   where     σ  E      subscript  σ  E    \sigma_{E}\,   is the error in electrode potential or pH,     (    ∂  E    ∂  v    )   k     subscript      E     v    k    \left(\frac{\partial E}{\partial v}\right)_{k}   is the slope of the titration curve and     σ  v      subscript  σ  v    \sigma_{v}\,   is the error on added volume.  When unit weights are used (     𝐖  =  𝐈   ,   𝐩  =     (    𝐉  𝐓   𝐉   )    -  𝟏     𝐉  𝐓   𝐲       formulae-sequence    𝐖  𝐈     𝐩     superscript     superscript  𝐉  𝐓   𝐉     1     superscript  𝐉  𝐓   𝐲      \mathbf{W=I,p=(J^{T}J)^{-1}J^{T}y}   ) it is implied that the experimental errors are uncorrelated and all equal     Σ  y   =    σ  2   𝐈        superscript  normal-Σ  y      superscript  σ  2   𝐈     \Sigma^{y}=\sigma^{2}\mathbf{I}   , where     σ  2      superscript  σ  2    \sigma^{2}\,   is known as the variance of an observation of unit weight, and   𝐈   𝐈   \mathbf{I}   is an identity matrix . In this case     σ  2      superscript  σ  2    \sigma^{2}\,   is approximated by    U    n  d   -   n  p        U     subscript  n  d    subscript  n  p      \frac{U}{n_{d}-n_{p}}   , where U is the minimum value of the objective function and n d and n p are the number of data and parameters, respectively.       𝚺  𝐩   =    𝐔    𝐧  𝐝   -   𝐧  𝐩       (    𝐉  𝐓   𝐉   )    -  𝟏          superscript  𝚺  𝐩       𝐔     subscript  𝐧  𝐝    subscript  𝐧  𝐩      superscript     superscript  𝐉  𝐓   𝐉     1       \mathbf{\Sigma^{p}=\frac{U}{n_{d}-n_{p}}(J^{T}J)^{-1}}   In all cases, the variance of the parameter p i is given by    Σ   i  i   p     subscript   superscript  normal-Σ  p     i  i     \Sigma^{p}_{ii}   and the covariance between parameters p i and p j is given by    Σ   i  j   p     subscript   superscript  normal-Σ  p     i  j     \Sigma^{p}_{ij}   . Standard deviation is the square root of variance. These error estimates reflect only random errors in the measurements. The true uncertainty in the parameters is larger due to the presence of systematic errors which, by definition, cannot be quantified.  Note that even though the observations may be un-correlated, the parameters are always correlated .  Derived constants  When cumulative constants have been refined it is often useful to derive stepwise constants from them. The general procedure is to write down the defining expressions for all the constants involved and then to equate concentrations. For example, suppose that one wishes to derive the pKa for removing one proton from a tribasic acid, LH 3 , such as citric acid .         L   3  -    +   2   H  +     ⇋   L   H  2  -     :    [   L   H  2  -    ]   =    β  12    [   L   3  -    ]     [   H  +   ]   2        normal-:   normal-⇋     superscript  L   limit-from  3       2   superscript  H        L   superscript   subscript  H  2          delimited-[]    L   superscript   subscript  H  2          subscript  β  12    delimited-[]   superscript  L   limit-from  3       superscript   delimited-[]   superscript  H     2       L^{3-}+2H^{+}\leftrightharpoons LH_{2}^{-}:[LH_{2}^{-}]=\beta_{12}[L^{3-}][H^{%
 +}]^{2}            L   3  -    +   3   H  +     ⇋   L   H  3     :    [   L   H  3    ]   =    β  13    [   L   3  -    ]     [   H  +   ]   3        normal-:   normal-⇋     superscript  L   limit-from  3       3   superscript  H        L   subscript  H  3        delimited-[]    L   subscript  H  3        subscript  β  13    delimited-[]   superscript  L   limit-from  3       superscript   delimited-[]   superscript  H     3       L^{3-}+3H^{+}\leftrightharpoons LH_{3}:[LH_{3}]=\beta_{13}[L^{3-}][H^{+}]^{3}   The stepwise association constant for formation of LH 3 is given by         L   H  2  -    +   H  +    ⇋   L   H  3     :    [   L   H  3    ]   =   K   [   L   H  2  -    ]    [   H  +   ]        normal-:   normal-⇋      L   superscript   subscript  H  2       superscript  H       L   subscript  H  3        delimited-[]    L   subscript  H  3       K   delimited-[]    L   superscript   subscript  H  2        delimited-[]   superscript  H         LH_{2}^{-}+H^{+}\leftrightharpoons LH_{3}:[LH_{3}]=K[LH_{2}^{-}][H^{+}]   Substitute the expressions for the concentrations of LH 3 and LH 2 − into this equation        β  13    [   L   3  -    ]     [   H  +   ]   3    =   K   β  12    [   L   3  -    ]     [   H  +   ]   2    [   H  +   ]           subscript  β  13    delimited-[]   superscript  L   limit-from  3       superscript   delimited-[]   superscript  H     3      K   subscript  β  12    delimited-[]   superscript  L   limit-from  3       superscript   delimited-[]   superscript  H     2    delimited-[]   superscript  H        \beta_{13}[L^{3-}][H^{+}]^{3}=K\beta_{12}[L^{3-}][H^{+}]^{2}[H^{+}]\,   whence        β  13   =   K   β  12     :   K  =     β  13    β  12         normal-:     subscript  β  13     K   subscript  β  12       K     subscript  β  13    subscript  β  12       \beta_{13}=K\beta_{12}:K=\frac{\beta_{13}}{\beta_{12}}\,   and since     p   K  a    =   -   log   (   1  /  K   )           p   subscript  K  a          1  K       pK_{a}=-\log(1/K)\,   its value is given by       p  K   a  1    =    log   β  13    -   log    β  12            p  K   subscript  a  1         subscript  β  13       subscript  β  12       pKa_{1}=\log\beta_{13}-\log\beta_{12}\,   When calculating the error on the stepwise constant, the fact that the cumulative constants are correlated must be taken into account. By error propagation       σ  K  2   =     σ   β  12   2   +   σ   β  13   2    -   2   σ   β  12     σ   β  13      ρ   12  ,  13            subscript   superscript  σ  2   K        subscript   superscript  σ  2    subscript  β  12     subscript   superscript  σ  2    subscript  β  13       2   subscript  σ   subscript  β  12     subscript  σ   subscript  β  13     subscript  ρ   12  13        \sigma^{2}_{K}=\sigma^{2}_{\beta_{12}}+\sigma^{2}_{\beta_{13}}-2\sigma_{\beta_%
 {12}}\sigma_{\beta_{13}}\rho_{12,13}\,   and       σ   log  K    =    σ  K   K        subscript  σ    K       subscript  σ  K   K     \sigma_{\log K}=\frac{\sigma_{K}}{K}     Model selection  Once a refinement has been completed the results should be checked to verify that the chosen model is acceptable. generally speaking, a model is acceptable when the data are fitted within experimental error, but there is no single criterion with which to make the judgement. The following should be taken into consideration.  The objective function  When the weights have been correctly derived from estimates of experimental error, the expectation value of    U    n  d   -   n  p        U     subscript  n  d    subscript  n  p      \frac{U}{n_{d}-n_{p}}   is 1. 7 It is therefore very useful to estimate experimental errors and derive some reasonable weights from them as this is an absolute indicator of the goodness of fit.  When unit weights are used, it is implied that all observations have the same variance.    U    n  d   -   n  p        U     subscript  n  d    subscript  n  p      \frac{U}{n_{d}-n_{p}}   , is expected to be equal to that variance.  Parameter errors  One would want the errors on the stability constants to be roughly commensurate with experimental error. For example, with pH titration data, if pH is measured to 2 decimal places, the errors of log   β   β   \beta   should not be much larger than 0.01. In exploratory work where the nature of the species present is not known in advance, several different chemical models may be tested and compared. There will be models where the uncertainties in the best estimate of an equilibrium constant may be somewhat or even significantly larger than    σ   p  H      subscript  σ    p  H     \sigma_{pH}   , especially with those constants governing the formation of comparatively minor species, but the decision as to how large is acceptable remains subjective. The decision process as to whether or not to include comparatively uncertain equilibria in a model, and for the comparison of competing models in general, can be made objective and has been outlined by Hamilton. 8  Distribution of residuals  At the minimum in U the system can be approximated to a linear one, the residuals in the case of unit weights are related to the observations by      𝐫  =    𝐲  obs   -   𝐉    (    𝐉  𝐓   𝐓   )    -  𝟏     𝐉  𝐓    𝐲  obs         𝐫     superscript  𝐲  obs     𝐉   superscript     superscript  𝐉  𝐓   𝐓     1     superscript  𝐉  𝐓    superscript  𝐲  obs       \mathbf{r=y^{\text{obs}}-J\left(J^{T}T\right)^{-1}J^{T}y^{\text{obs}}}   The symmetric , idempotent matrix    𝐉    (    𝐉  𝐓   𝐓   )    -  𝟏    𝐉      𝐉   superscript     superscript  𝐉  𝐓   𝐓     1    𝐉    \mathbf{J\left(J^{T}T\right)^{-1}J}   is known in the statistics literature as the hat matrix ,   𝐇   𝐇   \mathbf{H}   . Thus,      𝐫  =    (   𝐈  -  𝐇   )    𝐲  obs        𝐫      𝐈  𝐇    superscript  𝐲  obs      \mathbf{r=\left(I-H\right)y^{\text{obs}}}   and       𝐌  𝐫   =    (   𝐈  -  𝐇   )    𝐌  𝐲    (   𝐈  -  𝐇   )         superscript  𝐌  𝐫       𝐈  𝐇    superscript  𝐌  𝐲     𝐈  𝐇      \mathbf{M^{r}=\left(I-H\right)M^{y}\left(I-H\right)}   where I is an identity matrix and M r and M y are the variance-covariance matrices of the residuals and observations, respectively. This shows that even though the observations may be un-correlated, the residuals are always correlated.  The diagram at the right shows the result of a refinement of the stability constants of Ni Gly + , Ni(Gly) 2 and Ni(Gly) 3 − (GlyH = glycine ). The observed values are shown a blue diamonds and the species concentrations, as a percentage of the total nickel, are superimposed. The residuals are shown in the lower box. The presence of correlation is evident in the way sequences all have the same sign. Correlation notwithstanding, the magnitudes of the residuals show some randomness. Individual residuals are mostly commensurate with experimental error (about 0.002 in pH). This is about as good as it gets.  Physical constraints  Some physical constraints are usually incorporated in the calculations. For example, all the concentrations of free reactants and species must have positive values and association constants must have positive values.  With spectrophotometric data the molar absorptivity (or emissivity) values should all be positive. Most computer programs do not impose this constraint on the calculations.  Other models  If the model is not acceptable a variety of other models should be examined in order to find the model that best fits the experimental data, within experimental error. The main difficulty is with the so-called minor species. These are species whose concentration is so low that the effect on the measured quantity is at or below the level of error in the experimental measurement. The constant for a minor species may prove impossible to determine if there is no means to increase the concentration of the species. .  Implementations  Some simple systems are amenable to spreadsheet calculations. 9 A large number of computer programs for equilibrium constant calculation have been published. See 10 for a bibliography. The most frequently used programs are:   Potentiometric data: Hyperquad , BEST 11 PSEQUAD 12  Spectrophotometric data:[http://www.hyperquad.co.uk/HypSpec.htm HypSpec], SQUAD, 13 Specfit, 14  ReactLab EQUILIBRIA . 15  NMR data HypNMR , EQNMR   References    "  Category:Equilibrium chemistry  Category:Analytical chemistry     F.J,C. Rossotti and H. Rossotti, The determination of stability constants , McGraw-Hill, 1961. ↩  Definitions of pH scales, standard reference values, measurement of pH, and related terminology . Pure Appl. Chem . 57 , 531–542 (1985). ↩  R. J. Motekaitis and A. E. Martell, Can. J. Chem.  1982 , 60 , 2403–2409. ↩  P. G. Potvin, Can. J. Chem.  1990 , 68 , 2198–2207. . ↩   G.H. Golub and V. Pereyra, SIAM J. Numer. Anal ., 2 , 413–432 (1973) ↩  W. C. Hamilton, Statistics in Physical Science , The Ronald Press, New York, 1964 ↩   ↩  P. Gans, A. Sabatini and A. Vacca, Talanta , 43 ,1739–1753 (1996) ↩  A.E. Martell and R.J. Motekaitis, The determination and use of stability constants, Wiley-VCH, 1992. ISBN 0471188174 ↩  D. J. Leggett (editor), Computational methods for the determination of formation constants, Plenum Press, 1985. ISBN 978-0-306-41957-7 ↩   H. Gampp, M. Maeder, C.J.Mayer and a. Zuberbühler, Talanta , 32 , 95, 257 (1985) ↩  Jplus Consulting Pty Ltd ↩     
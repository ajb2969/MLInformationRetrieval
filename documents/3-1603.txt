   Spline interpolation      Spline interpolation   In the mathematical field of numerical analysis , spline interpolation is a form of interpolation where the interpolant is a special type of piecewise  polynomial called a spline . Spline interpolation is often preferred over polynomial interpolation because the interpolation error can be made small even when using low degree polynomials for the spline. Spline interpolation avoids the problem of Runge's phenomenon , in which oscillation can occur between points when interpolating using high degree polynomials.  Introduction  Originally, spline was a term for elastic  rulers that were bent to pass through a number of predefined points ("knots"). These were used to make technical drawings for shipbuilding and construction by hand, as illustrated by Figure 1. thumb|upright=1.8|right|Figure 1: Interpolation with cubic splines between eight points. Hand-drawn technical drawings were made for shipbuilding etc. using flexible rulers that were bent to follow pre-defined points  The approach to mathematically model the shape of such elastic rulers fixed by    n  +  1      n  1    n+1   knots    {   (   x  i   ,   y  i   )   :   i  =   0  ,  1  ,  ⋯  ,  n    }     conditional-set    subscript  x  i    subscript  y  i      i   0  1  normal-⋯  n      \left\{(x_{i},y_{i}):i=0,1,\cdots,n\right\}   is to interpolate between all the pairs of knots    (   x   i  -  1    ,   y   i  -  1    )      subscript  x    i  1     subscript  y    i  1      (x_{i-1},y_{i-1})   and    (   x  i   ,   y  i   )      subscript  x  i    subscript  y  i     (x_{i},y_{i})   with polynomials     y  =    q  i    (  x  )     ,   i  =   1  ,  2  ,  ⋯  ,  n       formulae-sequence    y     subscript  q  i   x      i   1  2  normal-⋯  n      y=q_{i}(x),i=1,2,\cdots,n   .  The curvature of a curve    y  =   f   (  x  )        y    f  x     y=f(x)   is given by:      κ  =    y  ′′     (   1  +   y   ′  2     )    3  /  2         κ     superscript  y  ′′    superscript    1   superscript  y   normal-′  2       3  2       \kappa=\frac{y^{\prime\prime}}{(1+y^{\prime 2})^{3/2}}     As the spline will take a shape that minimizes the bending (under the constraint of passing through all knots) both    y  ′     superscript  y  normal-′    y^{\prime}   and    y  ′′     superscript  y  ′′    y^{\prime\prime}   will be continuous everywhere and at the knots. To achieve this one must have that        {        q  i  ′    (   x  i   )    =    q   i  +  1   ′    (   x  i   )             q  i  ′′    (   x  i   )    =    q   i  +  1   ′′    (   x  i   )          1   ≤  i  ≤   n  -  1           cases       subscript   superscript  q  normal-′   i    subscript  x  i       subscript   superscript  q  normal-′     i  1     subscript  x  i     otherwise       subscript   superscript  q  ′′   i    subscript  x  i       subscript   superscript  q  ′′     i  1     subscript  x  i     otherwise   1   i         n  1      \begin{cases}q^{\prime}_{i}(x_{i})=q^{\prime}_{i+1}(x_{i})\\
 q^{\prime\prime}_{i}(x_{i})=q^{\prime\prime}_{i+1}(x_{i})\end{cases}\qquad 1%
 \leq i\leq n-1     This can only be achieved if polynomials of degree 3 or higher are used. The classical approach is to use polynomials of degree 3 — the case of cubic splines .  Algorithm to find the interpolating cubic spline  A third order polynomial    q   (  x  )       q  x    q(x)   for which       q   (   x  1   )    =   y  1         q   subscript  x  1     subscript  y  1     q(x_{1})=y_{1}          q   (   x  2   )    =   y  2         q   subscript  x  2     subscript  y  2     q(x_{2})=y_{2}           q  ′    (   x  1   )    =   k  1          superscript  q  normal-′    subscript  x  1     subscript  k  1     q^{\prime}(x_{1})=k_{1}           q  ′    (   x  2   )    =   k  2          superscript  q  normal-′    subscript  x  2     subscript  k  2     q^{\prime}(x_{2})=k_{2}     can be written in the symmetrical form where  As       q  ′   =    d  q    d  x    =     d  q    d  t      d  t    d  x     =     d  q    d  t     1    x  2   -   x  1             superscript  q  normal-′       d  q     d  x               d  q     d  t        d  t     d  x                d  q     d  t      1     subscript  x  2    subscript  x  1         q^{\prime}=\frac{dq}{dx}=\frac{dq}{dt}\frac{dt}{dx}=\frac{dq}{dt}\frac{1}{x_{2%
 }-x_{1}}   one gets that:  Setting  x 1 }} and  x 2 }} respectively in equations () and () one gets from () that indeed first derivatives  k 1 }} and  k 2 }} and also second derivatives  If now 0, 1, ..., n }} are    n  +  1      n  1    n+1   points and  where i = 1, 2, ..., n and    t  =    x  -   x   i  -  1       x  i   -   x   i  -  1          t      x   subscript  x    i  1        subscript  x  i    subscript  x    i  1        t=\tfrac{x-x_{i-1}}{x_{i}-x_{i-1}}   are n third degree polynomials interpolating   y   y   y   in the interval for i = 1, ..., n such that  q′ i +1 ( x i )}} for i = 1, ..., n −1 then the n polynomials together define a differentiable function in the interval and  for i = 1, ..., n where   If the sequence is such that in addition  q′′ i +1 ( x i )}} holds for i = 1, ..., n -1. Then the resulting function will even have a continuous second derivative.  From (), (), () and () follows that this is the case if and only if  {x_i-x_{i-1}} + \left(\frac {1}{x_i-x_{i-1}}+ \frac {1}\right) 2k_i+ \frac {k_{i+1}} =  3 \left(\frac {y_i - y_{i-1}}{{(x_i-x_{i-1})}^2}+\frac {y_{i+1} - y_i}{{(x_{i+1}-x_i)}^2}\right) | 15 }}  for i = 1, ..., n -1. The relations () are    n  −  1      n  normal-−  1    n−1   linear equations for the    n  +  1      n  1    n+1   values .  For the elastic rulers being the model for the spline interpolation one has that to the left of the left-most "knot" and to the right of the right-most "knot" the ruler can move freely and will therefore take the form of a straight line with     q  ′  ′   =  0        q  normal-′  normal-′   0    q′′=0   . As    q  ′  ′      q  normal-′  normal-′    q′′   should be a continuous function of   x   x   x   one gets that for "Natural Splines" one in addition to the    n  −  1      n  normal-−  1    n−1   linear equations () should have that         q  1  ′′    (   x  0   )    =   2     3   (    y  1   -   y  0    )    -    (    k  1   +   2   k  0     )    (    x  1   -   x  0    )       (    x  1   -   x  0    )   2     =  0   ,           subscript   superscript  q  ′′   1    subscript  x  0      2        3     subscript  y  1    subscript  y  0          subscript  k  1     2   subscript  k  0        subscript  x  1    subscript  x  0       superscript     subscript  x  1    subscript  x  0    2          0     q^{\prime\prime}_{1}(x_{0})=2\frac{3(y_{1}-y_{0})-(k_{1}+2k_{0})(x_{1}-x_{0})}%
 {{(x_{1}-x_{0})}^{2}}=0,            q  n  ′′    (   x  n   )    =   -   2     3   (    y  n   -   y   n  -  1     )    -    (    2   k  n    +   k   n  -  1     )    (    x  n   -   x   n  -  1     )       (    x  n   -   x   n  -  1     )   2      =  0   ,           subscript   superscript  q  ′′   n    subscript  x  n        2        3     subscript  y  n    subscript  y    n  1            2   subscript  k  n     subscript  k    n  1        subscript  x  n    subscript  x    n  1        superscript     subscript  x  n    subscript  x    n  1     2           0     q^{\prime\prime}_{n}(x_{n})=-2\frac{3(y_{n}-y_{n-1})-(2k_{n}+k_{n-1})(x_{n}-x_%
 {n-1})}{{(x_{n}-x_{n-1})}^{2}}=0,   i.e. that  k_{n-1} +\frac{2}{x_n-x_{n-1}}k_n = 3 \frac{y_n-y_{n-1}}{(x_n-x_{n-1})^2}.| 17 }}  Eventually, () together with () and () constitute    n  +  1      n  1    n+1   linear equations that uniquely define the    n  +  1      n  1    n+1   parameters .  There exists other end conditions: "Clamped spline", that specifies the slope at the ends of the spline, and the popular "not-a-knot spline", that requires that the third derivative is also continuous at the and points. For the "not-a-knot" spline, the additional equations will read:       q  1  ′′′    (   x  1   )   =   q  2  ′′′    (   x  1   )   =  >   1   Δ   x  1  2      k  0   +   (   1   Δ   x  1  2     -   1   Δ   x  2  2     )    k  1   -   1   Δ   x  2  2      k  2   =  2   (    Δ   y  1     Δ   x  1  3     -    Δ   y  2     Δ   x  2  3     )      fragments   subscript   superscript  q  ′′′   1    fragments  normal-(   subscript  x  1   normal-)     subscript   superscript  q  ′′′   2    fragments  normal-(   subscript  x  1   normal-)       1    normal-Δ   superscript   subscript  x  1   2      subscript  k  0     fragments  normal-(    1    normal-Δ   superscript   subscript  x  1   2        1    normal-Δ   superscript   subscript  x  2   2     normal-)    subscript  k  1      1    normal-Δ   superscript   subscript  x  2   2      subscript  k  2    2   fragments  normal-(      normal-Δ   subscript  y  1      normal-Δ   superscript   subscript  x  1   3          normal-Δ   subscript  y  2      normal-Δ   superscript   subscript  x  2   3     normal-)     q^{\prime\prime\prime}_{1}(x_{1})=q^{\prime\prime\prime}_{2}(x_{1})=>\frac{1}{%
 \Delta x_{1}^{2}}k_{0}+\left(\frac{1}{\Delta x_{1}^{2}}-\frac{1}{\Delta x_{2}^%
 {2}}\right)k_{1}-\frac{1}{\Delta x_{2}^{2}}k_{2}=2\left(\frac{\Delta y_{1}}{%
 \Delta x_{1}^{3}}-\frac{\Delta y_{2}}{\Delta x_{2}^{3}}\right)          q   n  -  1   ′′′    (   x   n  -  1    )   =   q  n  ′′′    (   x   n  -  1    )   =  >   1   Δ   x   n  -  1   2      k   n  -  2    +   (   1   Δ   x   n  -  1   2     -   1   Δ   x  n  2     )    k   n  -  1    -   1   Δ   x  n  2      k  n   =  2   (    Δ   y   n  -  1      Δ   x   n  -  1   3     -    Δ   y  n     Δ   x  n  3     )      fragments   subscript   superscript  q  ′′′     n  1     fragments  normal-(   subscript  x    n  1    normal-)     subscript   superscript  q  ′′′   n    fragments  normal-(   subscript  x    n  1    normal-)       1    normal-Δ   superscript   subscript  x    n  1    2      subscript  k    n  2      fragments  normal-(    1    normal-Δ   superscript   subscript  x    n  1    2        1    normal-Δ   superscript   subscript  x  n   2     normal-)    subscript  k    n  1       1    normal-Δ   superscript   subscript  x  n   2      subscript  k  n    2   fragments  normal-(      normal-Δ   subscript  y    n  1       normal-Δ   superscript   subscript  x    n  1    3          normal-Δ   subscript  y  n      normal-Δ   superscript   subscript  x  n   3     normal-)     q^{\prime\prime\prime}_{n-1}(x_{n-1})=q^{\prime\prime\prime}_{n}(x_{n-1})=>%
 \frac{1}{\Delta x_{n-1}^{2}}k_{n-2}+\left(\frac{1}{\Delta x_{n-1}^{2}}-\frac{1%
 }{\Delta x_{n}^{2}}\right)k_{n-1}-\frac{1}{\Delta x_{n}^{2}}k_{n}=2\left(\frac%
 {\Delta y_{n-1}}{\Delta x_{n-1}^{3}}-\frac{\Delta y_{n}}{\Delta x_{n}^{3}}\right)     where      Δ   x  i    =    x  i   -   x   i  -  1      ,    Δ   y  i    =    y  i   -   y   i  -  1         formulae-sequence      normal-Δ   subscript  x  i       subscript  x  i    subscript  x    i  1          normal-Δ   subscript  y  i       subscript  y  i    subscript  y    i  1        \Delta x_{i}=x_{i}-x_{i-1},\Delta y_{i}=y_{i}-y_{i-1}   .  Example  In case of three points the values for     k  0   ,   k  1   ,   k  2       subscript  k  0    subscript  k  1    subscript  k  2     k_{0},k_{1},k_{2}   are found by solving the tridiagonal linear equation system        [      a  11      a  12     0       a  21      a  22      a  23       0     a  32      a  33      ]    [      k  0        k  1        k  2      ]    =   [      b  1        b  2        b  3      ]            subscript  a  11    subscript  a  12   0     subscript  a  21    subscript  a  22    subscript  a  23     0   subscript  a  32    subscript  a  33        subscript  k  0      subscript  k  1      subscript  k  2         subscript  b  1      subscript  b  2      subscript  b  3       \begin{bmatrix}a_{11}&a_{12}&0\\
 a_{21}&a_{22}&a_{23}\\
 0&a_{32}&a_{33}\\
 \end{bmatrix}\begin{bmatrix}k_{0}\\
 k_{1}\\
 k_{2}\\
 \end{bmatrix}=\begin{bmatrix}b_{1}\\
 b_{2}\\
 b_{3}\\
 \end{bmatrix}   with       a  11   =   2    x  1   -   x  0          subscript  a  11     2     subscript  x  1    subscript  x  0       a_{11}=\frac{2}{x_{1}-x_{0}}          a  12   =   1    x  1   -   x  0          subscript  a  12     1     subscript  x  1    subscript  x  0       a_{12}=\frac{1}{x_{1}-x_{0}}          a  21   =   1    x  1   -   x  0          subscript  a  21     1     subscript  x  1    subscript  x  0       a_{21}=\frac{1}{x_{1}-x_{0}}          a  22   =    2    (    1    x  1   -   x  0     +   1    x  2   -   x  1      )         subscript  a  22     2      1     subscript  x  1    subscript  x  0       1     subscript  x  2    subscript  x  1         a_{22}=2\ \left(\frac{1}{x_{1}-x_{0}}+\frac{1}{{x_{2}-x_{1}}}\right)          a  23   =   1    x  2   -   x  1          subscript  a  23     1     subscript  x  2    subscript  x  1       a_{23}=\frac{1}{{x_{2}-x_{1}}}          a  32   =   1    x  2   -   x  1          subscript  a  32     1     subscript  x  2    subscript  x  1       a_{32}=\frac{1}{x_{2}-x_{1}}          a  33   =   2    x  2   -   x  1          subscript  a  33     2     subscript  x  2    subscript  x  1       a_{33}=\frac{2}{x_{2}-x_{1}}          b  1   =    3      y  1   -   y  0      (    x  1   -   x  0    )   2          subscript  b  1     3       subscript  y  1    subscript  y  0     superscript     subscript  x  1    subscript  x  0    2       b_{1}=3\ \frac{y_{1}-y_{0}}{(x_{1}-x_{0})^{2}}          b  2   =    3    (      y  1   -   y  0      (    x  1   -   x  0    )   2    +     y  2   -   y  1      (    x  2   -   x  1    )   2     )         subscript  b  2     3         subscript  y  1    subscript  y  0     superscript     subscript  x  1    subscript  x  0    2         subscript  y  2    subscript  y  1     superscript     subscript  x  2    subscript  x  1    2        b_{2}=3\ \left(\frac{y_{1}-y_{0}}{{(x_{1}-x_{0})}^{2}}+\frac{y_{2}-y_{1}}{{(x_%
 {2}-x_{1})}^{2}}\right)          b  3   =    3      y  2   -   y  1      (    x  2   -   x  1    )   2          subscript  b  3     3       subscript  y  2    subscript  y  1     superscript     subscript  x  2    subscript  x  1    2       b_{3}=3\ \frac{y_{2}-y_{1}}{(x_{2}-x_{1})^{2}}     For the three points       (   -  1   ,  0.5  )   ,   (  0  ,  0  )   ,   (  3  ,  3  )         1   0.5    0  0    3  3     (-1,0.5)\ ,\ (0,0)\ ,\ (3,3)   one gets that        k  0   =   -   0.6875     ,     k  1   =   -   0.1250     ,    k  2   =  1.5625       formulae-sequence     subscript  k  0     0.6875     formulae-sequence     subscript  k  1     0.1250       subscript  k  2   1.5625      k_{0}=-0.6875\ ,\ k_{1}=-0.1250\ ,\ k_{2}=1.5625   and from () and () that       a  1   =     k  0    (    x  1   -   x  0    )    -   (    y  1   -   y  0    )    =   -  0.1875          subscript  a  1        subscript  k  0      subscript  x  1    subscript  x  0        subscript  y  1    subscript  y  0            0.1875      a_{1}=k_{0}(x_{1}-x_{0})-(y_{1}-y_{0})=-0.1875          b  1   =    -    k  1    (    x  1   -   x  0    )     +   (    y  1   -   y  0    )    =   -  0.3750          subscript  b  1          subscript  k  1      subscript  x  1    subscript  x  0         subscript  y  1    subscript  y  0            0.3750      b_{1}=-k_{1}(x_{1}-x_{0})+(y_{1}-y_{0})=-0.3750          a  2   =     k  1    (    x  2   -   x  1    )    -   (    y  2   -   y  1    )    =   -  3.3750          subscript  a  2        subscript  k  1      subscript  x  2    subscript  x  1        subscript  y  2    subscript  y  1            3.3750      a_{2}=k_{1}(x_{2}-x_{1})-(y_{2}-y_{1})=-3.3750          b  2   =    -    k  2    (    x  2   -   x  1    )     +   (    y  2   -   y  1    )    =   -  1.6875          subscript  b  2          subscript  k  2      subscript  x  2    subscript  x  1         subscript  y  2    subscript  y  1            1.6875      b_{2}=-k_{2}(x_{2}-x_{1})+(y_{2}-y_{1})=-1.6875     In Figure 2 the spline function consisting of the two cubic polynomials     q  1    (  x  )        subscript  q  1   x    q_{1}(x)   and     q  2    (  x  )        subscript  q  2   x    q_{2}(x)   given by () is displayed  See also   Cubic Hermite spline  Centripetal Catmull–Rom spline  Discrete spline interpolation  Monotone cubic interpolation  NURBS  Multivariate interpolation  Polynomial interpolation  Smoothing spline  Spline wavelet   External links    Dynamic cubic splines with JSXGraph  Lectures on the theory and practice of spline interpolation  Paper which explains step by step how cubic spline interpolation is done, but only for equidistant knots.  Online Cubic Spline Interpolation Utility  Numerical Recipes in C , Go to Chapter 3 Section 3-3.  A note on cubic splines   "  Category:Splines  Category:Interpolation   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="750">Maximum length sequence</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Maximum length sequence</h1>
<hr/>

<p>A <strong>maximum length sequence</strong> (<strong>MLS</strong>) is a type of <a href="pseudorandom_binary_sequence" title="wikilink">pseudorandom binary sequence</a>.</p>

<p>They are bit sequences generated using maximal <a href="linear_feedback_shift_register" title="wikilink">linear feedback shift registers</a> and are so called because they are <a href="periodic_function" title="wikilink">periodic</a> and reproduce every <a href="binary_sequence" title="wikilink">binary sequence</a> (except the zero vector) that can be represented by the shift registers (i.e., for length-<em>m</em> registers they produce a sequence of length 2<sup><em>m</em></sup> − 1). An MLS is also sometimes called an <strong>n-sequence</strong> or an <strong>m-sequence</strong>. MLSs are <a href="Frequency_spectrum" title="wikilink">spectrally flat</a>, with the exception of a near-zero DC term.</p>

<p>These sequences may be represented as coefficients of irreducible polynomials in a <a href="polynomial_ring" title="wikilink">polynomial ring</a> over <a href="Congruence_subgroup" title="wikilink"> Z/2Z</a>.</p>

<p>Practical applications for MLS include measuring <a href="impulse_response" title="wikilink">impulse responses</a> (e.g., of room <a class="uri" href="reverberation" title="wikilink">reverberation</a>). They are also used as a basis for deriving pseudo-random sequences in digital communication systems that employ <a href="direct-sequence_spread_spectrum" title="wikilink">direct-sequence spread spectrum</a> and <a href="frequency-hopping_spread_spectrum" title="wikilink">frequency-hopping spread spectrum</a> <a href="transmission_system" title="wikilink">transmission systems</a>, and in the efficient design of some fMRI experiments<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="generation-of-maximum-length-sequences">Generation of maximum length sequences</h2>
<figure><b>(Figure)</b>
<figcaption>Figure 1: The next value of register <em>a</em><sub>3</sub> in a feedback shift register of length 4 is determined by the modulo-2 sum of <em>a</em><sub>0</sub> and <em>a</em><sub>1</sub>.</figcaption>
</figure>

<p>MLS are generated using maximal linear feedback shift registers. An MLS-generating system with a shift register of length 4 is shown in Fig. 1. It can be expressed using the following recursive relation:</p>

<p>

<math display="block" id="Maximum_length_sequence:0">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>a</mi>
          <mn>0</mn>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>n</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msub>
          <mi>a</mi>
          <mn>1</mn>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>n</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>3</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
    <mtr>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo>=</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
     </mtd>
     <mtd></mtd>
    </mtr>
   </mtable>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">cases</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <mtext>otherwise</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{cases}a_{3}[n+1]=a_{0}[n]+a_{1}[n]\\
a_{2}[n+1]=a_{3}[n]\\
a_{1}[n+1]=a_{2}[n]\\
a_{0}[n+1]=a_{1}[n]\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>n</em> is the time index and 

<math display="inline" id="Maximum_length_sequence:1">
 <semantics>
  <mo>+</mo>
  <annotation-xml encoding="MathML-Content">
   <plus></plus>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   +
  </annotation>
 </semantics>
</math>

 represents <a href="Modular_arithmetic" title="wikilink">modulo-2</a> addition.</p>

<p>As MLS are periodic and shift registers cycle through every possible binary value (with the exception of the zero vector), registers can be initialized to any state, with the exception of the zero vector.</p>
<h3 id="polynomial-interpretation">Polynomial interpretation</h3>

<p>A <a class="uri" href="polynomial" title="wikilink">polynomial</a> over <a href="Galois_field" title="wikilink">GF(2)</a> can be associated with the linear feedback shift register. It has degree of the length of the shift register, and has coefficients that are either 0 or 1, corresponding to the taps of the register that feed the <a class="uri" href="xor" title="wikilink">xor</a> gate. For example, the polynomial corresponding to Figure 1 is <em>x</em><sup>4</sup> + <em>x</em> + 1.</p>

<p>A necessary and sufficient condition for the sequence generated by a LFSR to be maximal length is that its corresponding polynomial be <a href="Primitive_polynomial_(field_theory)" title="wikilink">primitive</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="implementation">Implementation</h3>

<p>MLS are inexpensive to implement in hardware or software, and relatively low-order feedback shift registers can generate long sequences; a sequence generated using a shift register of length 20 is 2<sup>20</sup> − 1 samples long (1,048,575 samples).</p>
<h2 id="properties-of-maximum-length-sequences">Properties of maximum length sequences</h2>

<p>MLS have the following properties, as formulated by <a href="Solomon_Golomb" title="wikilink">Solomon Golomb</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="balance-property">Balance property</h3>

<p>The occurrence of 0 and 1 in the sequence should be approximately the same. More precisely, in a maximum length sequence of length 

<math display="inline" id="Maximum_length_sequence:2">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mi>n</mi>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n}-1
  </annotation>
 </semantics>
</math>

 there are 

<math display="inline" id="Maximum_length_sequence:3">
 <semantics>
  <msup>
   <mn>2</mn>
   <mrow>
    <mi>n</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <apply>
     <minus></minus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n-1}
  </annotation>
 </semantics>
</math>

 ones and 

<math display="inline" id="Maximum_length_sequence:4">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{n-1}-1
  </annotation>
 </semantics>
</math>

 zeros. The number of ones equals the number of zeros plus one, since the state containing only zeros cannot occur.</p>
<h3 id="run-property">Run property</h3>

<p>Of all the "runs" in the sequence of each type (i.e. runs consisting of "1"s and runs consisting of "0"s):</p>
<ul>
<li>One half of the runs are of length 1.</li>
<li>One quarter of the runs are of length 2.</li>
<li>One eighth of the runs are of length 3.</li>
<li>... etc. ...</li>
</ul>

<p>A "run" is a sub-sequence of "1"s or "0"s within the MLS concerned. The number of runs is the number of such sub-sequences.</p>
<h3 id="correlation-property">Correlation property</h3>

<p>The <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a> function of an MLS is a very close approximation to a strain of <a href="Kronecker_delta" title="wikilink">Kronecker delta</a> function.</p>
<h2 id="extraction-of-impulse-responses">Extraction of impulse responses</h2>

<p>If a <a href="LTI_system_theory" title="wikilink">linear time invariant</a> (LTI) system's impulse response is to be measured using a MLS, the response can be extracted from the measured system output <em>y</em>[<em>n</em>] by taking its circular cross-correlation with the MLS. This is because the <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a> of a MLS is 1 for zero-lag, and nearly zero (−1/<em>N</em> where <em>N</em> is the sequence length) for all other lags; in other words, the autocorrelation of the MLS can be said to approach unit impulse function as MLS length increases.</p>

<p>If the impulse response of a system is <em>h</em>[<em>n</em>] and the MLS is <em>s</em>[<em>n</em>], then</p>

<p>

<math display="block" id="Maximum_length_sequence:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>y</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>h</mi>
       <mo>*</mo>
       <mi>s</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>y</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <ci>h</ci>
      <ci>s</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y[n]=(h*s)[n].\,
  </annotation>
 </semantics>
</math>

</p>

<p>Taking the cross-correlation with respect to <em>s</em>[<em>n</em>] of both sides,</p>

<p>

<math display="block" id="Maximum_length_sequence:6">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mrow>
     <mi>s</mi>
     <mi>y</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>*</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>ϕ</mi>
      <mrow>
       <mi>s</mi>
       <mi>s</mi>
      </mrow>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <apply>
      <times></times>
      <ci>s</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\phi}_{sy}=h[n]*{\phi}_{ss}\,
  </annotation>
 </semantics>
</math>

</p>

<p>and assuming that φ<sub><em>ss</em></sub> is an impulse (valid for long sequences)</p>

<p>

<math display="block" id="Maximum_length_sequence:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>ϕ</mi>
     <mrow>
      <mi>s</mi>
      <mi>y</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>h</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <apply>
      <times></times>
      <ci>s</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h[n]={\phi}_{sy}.\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="relationship-to-hadamard-transform">Relationship to Hadamard transform</h2>

<p>Cohn and Lempel<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> showed the relationship of the MLS to the <a href="Hadamard_transform" title="wikilink">Hadamard transform</a>. This relationship allows the <a class="uri" href="correlation" title="wikilink">correlation</a> of an MLS to be computed in a fast algorithm similar to the <a href="Fast_Fourier_transform" title="wikilink">FFT</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Impulse_response" title="wikilink">Impulse response</a></li>
<li><a href="Frequency_response" title="wikilink">Frequency response</a></li>
<li><a href="Polynomial_ring" title="wikilink">Polynomial ring</a></li>
<li><a href="Federal_Standard_1037C" title="wikilink">Federal Standard 1037C</a></li>
<li><a href="Gold_code" title="wikilink">Gold code</a></li>
<li><a href="Complementary_sequences" title="wikilink">Complementary sequences</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>

<p>— Short on-line tutorial describing how MLS is used to obtain the <a href="impulse_response" title="wikilink">impulse response</a> of a <a href="linear_time-invariant_system" title="wikilink">linear time-invariant system</a>. Also describes how nonlinearities in the system can show up as spurious spikes in the apparent impulse response.</p></li>
<li>

<p>— Paper describing MLS generation. Contains C-code for MLS generation using up to 18-tap-LFSRs and matching Hadamard transform for impulse response extraction.</p></li>
<li></li>
<li>

<p>— Properties of maximal length sequences, and comprehensive feedback tables for maximal lengths from 7 to 16,777,215 (3 to 24 stages), and partial tables for lengths up to 4,294,967,295 (25 to 32 stages).</p></li>
<li>

<p>A (binaural) room impulse response database generated by means of maximum length sequences]</p></li>
<li>

<p>— Implementing lfsr's in FPGAs includes listing of taps for 3 to 168 bits</p></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Pseudorandomness" title="wikilink">Category:Pseudorandomness</a> <a class="uri" href="Category:Polynomials" title="wikilink">Category:Polynomials</a> <a href="Category:Binary_sequences" title="wikilink">Category:Binary sequences</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">"Linear Feedback Shift Registers-<small> Implementation, M-Sequence Properties, Feedback Tables</small>"<a href="http://www.newwaveinstruments.com/resources/articles/m_sequence_linear_feedback_shift_register_lfsr.htm">1</a>, New Wave Instruments (NW), Retrieved 2013.12.03.<a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="674">Naor-Reingold Pseudorandom Function</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Naor-Reingold Pseudorandom Function</h1>
<hr/>

<p>In 1997, <a href="Moni_Naor" title="wikilink">Moni Naor</a> and <a href="Omer_Reingold" title="wikilink">Omer Reingold</a> described efficient constructions for various <a href="cryptographic_primitive" title="wikilink">cryptographic primitives</a> in private key as well as <a href="public-key_cryptography" title="wikilink">public-key cryptography</a>. Their result is the construction of an efficient <a href="pseudorandom_function_family" title="wikilink">pseudorandom function</a>. Let <em>p</em> and <em>l</em> be <a href="prime_number" title="wikilink">prime numbers</a> with <em>l</em> |<em>p</em>-1. Select an element <em>g</em> ‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:0">
 <semantics>
  <mmultiscripts>
   <mi>ùîΩ</mi>
   <mi>p</mi>
   <none></none>
   <none></none>
   <mo>*</mo>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <ci>p</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\mathbb{F}_{p}}^{*}
  </annotation>
 </semantics>
</math>

 of <a href="multiplicative_order" title="wikilink">multiplicative order</a> <em>l</em>. Then for each n-dimensional <a href="coordinate_vector" title="wikilink">vector</a> <em>a</em> = (<em>a</em><sub><em>1</em></sub>, ..., <em>a</em><sub><em>n</em></sub>)‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:1">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>ùîΩ</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <ci>l</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbb{F}_{l})^{n}
  </annotation>
 </semantics>
</math>

 they define the function</p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <msubsup>
      <mi>a</mi>
      <mn>1</mn>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </msubsup>
     <msubsup>
      <mi>a</mi>
      <mn>2</mn>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msubsup>
      <mi>a</mi>
      <mi>n</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </msubsup>
    </mrow>
   </msup>
   <mo>‚àà</mo>
   <msub>
    <mi>ùîΩ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>a</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-‚Ä¶</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùîΩ</ci>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(x)=g^{a_{1}^{x_{1}}a_{2}^{x_{2}}...a_{n}^{x_{n}}}\in\mathbb{F}_{p}
  </annotation>
 </semantics>
</math>

</p>

<p>where x = x<sub><em>1</em></sub> ... x<sub><em>n</em></sub> is the <a href="Binary_numeral_system#Representation" title="wikilink">bit representation</a> of integer x, 0 ‚â§ x ‚â§ 2<sup>n-1</sup>, with some extra leading zeros if necessary.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="example">Example</h2>

<p>Let <em>p</em> = 7, <em>p</em> ‚Äì 1 = 6, and <em>l</em> = 3, <em>l</em> |<em>p</em>-1. Select <em>g</em> = 4 ‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:3">
 <semantics>
  <mmultiscripts>
   <mi>ùîΩ</mi>
   <mn>7</mn>
   <none></none>
   <none></none>
   <mo>*</mo>
  </mmultiscripts>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <cn type="integer">7</cn>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\mathbb{F}_{7}}^{*}
  </annotation>
 </semantics>
</math>


 of multiplicative order 3 (since 4<sup>3</sup> = 64 ‚â° 1 mod 7). For n = 3, a = (1, 2, 1) and x = 5 (the bit representation of 5 is 101), we can compute 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:4">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>5</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(5)
  </annotation>
 </semantics>
</math>

 as follows:</p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:5">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <msubsup>
      <mi>a</mi>
      <mn>1</mn>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </msubsup>
     <msubsup>
      <mi>a</mi>
      <mn>2</mn>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msubsup>
      <mi>a</mi>
      <mi>n</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </msubsup>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(x)=g^{a_{1}^{x_{1}}a_{2}^{x_{2}}...a_{n}^{x_{n}}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>5</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mn>4</mn>
    <mrow>
     <msup>
      <mn>1</mn>
      <mn>1</mn>
     </msup>
     <msup>
      <mn>2</mn>
      <mn>0</mn>
     </msup>
     <msup>
      <mn>1</mn>
      <mn>1</mn>
     </msup>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mn>4</mn>
    <mn>1</mn>
   </msup>
   <mo>=</mo>
   <mn>4</mn>
   <mo>‚àà</mo>
   <msub>
    <mi>ùîΩ</mi>
    <mn>7</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>a</ci>
      </apply>
      <cn type="integer">5</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">4</cn>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ùîΩ</ci>
      <cn type="integer">7</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(5)=4^{1^{1}2^{0}1^{1}}=4^{1}=4\in\mathbb{F}_{7}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="efficiency">Efficiency</h2>

<p>The evaluation of function 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:7">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(x)
  </annotation>
 </semantics>
</math>

 in the <strong>Naor-Reingold</strong> construction can be done very efficiently. Computing the value of the function 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:8">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(x)
  </annotation>
 </semantics>
</math>


 at any given point is comparable with one <a href="modular_exponentiation" title="wikilink">modular exponentiation</a> and n-modular multiplications. This function can be computed in parallel by threshold circuits of bounded depth and polynomial size.</p>

<p>The <strong>Naor-Reingold</strong> function can be used as the basis of many <a href="cryptography" title="wikilink">cryptographic</a> schemes including <a href="Symmetric-key_algorithm" title="wikilink">symmetric encryption</a>, <a class="uri" href="authentication" title="wikilink">authentication</a> and <a href="digital_signatures" title="wikilink">digital signatures</a>.</p>
<h2 id="security-of-the-function">Security of the Function</h2>

<p><code>¬†¬†¬†Assume¬†that¬†an¬†attacker¬†sees¬†several¬†outputs¬†of¬†the¬†function,¬†e.g.¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>f</mi>
      <mi>a</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mi>g</mi>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
    </msup>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>a</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>2</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <msup>
      <mi>g</mi>
      <msub>
       <mi>a</mi>
       <mn>2</mn>
      </msub>
     </msup>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>a</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>3</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <msub>
        <mi>a</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>a</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>a</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>a</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>a</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(1)=g^{a_{1}},f_{a}(2)=g^{a_{2}},f_{a}(3)=g^{a_{1}a_{2}}
  </annotation>
 </semantics>
</math>

<code>,¬†...¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <msubsup>
      <mi>a</mi>
      <mn>1</mn>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </msubsup>
     <msubsup>
      <mi>a</mi>
      <mn>2</mn>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msubsup>
      <mi>a</mi>
      <mi>n</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </msubsup>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(k)=g^{a_{1}^{x_{1}}a_{2}^{x_{2}}...a_{n}^{x_{n}}}
  </annotation>
 </semantics>
</math>

<code>¬†and¬†wants¬†to¬†compute¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:11">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(k+1)
  </annotation>
 </semantics>
</math>

<code>.¬†Assume¬†for¬†simplicity¬†that¬†x</code><sub><code>1</code></sub><code>¬†=¬†0,¬†then¬†the¬†attacker¬†needs¬†to¬†solve¬†the¬†</code><a href="Computational_Diffie‚ÄìHellman_assumption" title="wikilink"><code>Computational</code> <code>Diffie-Hellman</code> <code>(CDH)</code></a><code>¬†between¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:12">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(1)=g^{a_{1}}
  </annotation>
 </semantics>
</math>

<code>¬†and¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:13">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <msubsup>
      <mi>a</mi>
      <mn>2</mn>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msubsup>
      <mi>a</mi>
      <mi>n</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </msubsup>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(k)=g^{a_{2}^{x_{2}}...a_{n}^{x_{n}}}
  </annotation>
 </semantics>
</math>


<code>¬†to¬†get¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:14">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>k</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>1</mn>
     </msub>
     <msubsup>
      <mi>a</mi>
      <mn>2</mn>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </msubsup>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msubsup>
      <mi>a</mi>
      <mi>n</mi>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </msubsup>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(k+1)=g^{a_{1}a_{2}^{x_{2}}\dots a_{n}^{x_{n}}}
  </annotation>
 </semantics>
</math>

<code>.¬†In¬†general,¬†moving¬†from¬†</code><em><code>k</code></em><code>¬†to¬†</code><em><code>k</code></em><code>¬†+1¬†changes¬†the¬†bit¬†pattern¬†and¬†unless¬†</code><em><code>k</code></em><code>¬†+¬†1¬†is¬†a¬†power¬†of¬†2¬†one¬†can¬†split¬†the¬†exponent¬†in¬†</code>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:15">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>k</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(k+1)
  </annotation>
 </semantics>
</math>

<code>¬†so¬†that¬†the¬†computation¬†corresponds¬†to¬†computing¬†the¬†</code><a href="Diffie-Hellman_problem" title="wikilink"><code>Diffie-Hellman</code></a><code>¬†key¬†between¬†two¬†of¬†the¬†earlier¬†results.¬†This¬†attacker¬†wants¬†to¬†predict¬†the¬†next¬†</code><a href="sequence" title="wikilink"><code>sequence</code></a><code>¬†element.¬†Such¬†an¬†attack¬†would¬†be¬†very¬†bad‚Äîbut¬†it's¬†also¬†possible¬†to¬†fight¬†it¬†off¬†by¬†working¬†in¬†</code><a href="Group_(mathematics)" title="wikilink"><code>groups</code></a><code>¬†with¬†a¬†hard¬†</code><a href="Diffie-Hellman_problem" title="wikilink"><code>Diffie-Hellman</code> <code>problem</code></a><code>¬†(DHP).</code></p>

<p><strong>Example:</strong> An attacker sees several outputs of the function e.g. 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>5</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mn>4</mn>
    <mrow>
     <msup>
      <mn>1</mn>
      <mn>1</mn>
     </msup>
     <msup>
      <mn>2</mn>
      <mn>0</mn>
     </msup>
     <msup>
      <mn>1</mn>
      <mn>1</mn>
     </msup>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mn>4</mn>
    <mn>1</mn>
   </msup>
   <mo>=</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>a</ci>
      </apply>
      <cn type="integer">5</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(5)=4^{1^{1}2^{0}1^{1}}=4^{1}=4
  </annotation>
 </semantics>
</math>

, as in the previous example, and 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:17">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>1</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mn>4</mn>
    <mrow>
     <msup>
      <mn>1</mn>
      <mn>0</mn>
     </msup>
     <msup>
      <mn>2</mn>
      <mn>0</mn>
     </msup>
     <msup>
      <mn>1</mn>
      <mn>1</mn>
     </msup>
    </mrow>
   </msup>
   <mo>=</mo>
   <msup>
    <mn>4</mn>
    <mn>1</mn>
   </msup>
   <mo>=</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>a</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">1</cn>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">1</cn>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">4</cn>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}(1)=4^{1^{0}2^{0}1^{1}}=4^{1}=4
  </annotation>
 </semantics>
</math>

. Then, the attacker wants to predict the next sequence element of this function, 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:18">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>6</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(6)
  </annotation>
 </semantics>
</math>


. However, the attacker cannot predict the outcome of 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:19">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>6</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(6)
  </annotation>
 </semantics>
</math>

 from knowing 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:20">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(1)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:21">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>5</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(5)
  </annotation>
 </semantics>
</math>

.</p>

<p>There are other attacks that would be very bad for a <a href="Pseudorandom_Number_Generator" title="wikilink">Pseudorandom Number Generator</a>: the user expects to get random numbers from the output, so of course the stream should not be predictable, but even more, it should be indistinguishable from a random string. Let 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:22">
 <semantics>
  <msup>
   <mi class="ltx_font_mathcaligraphic">ùíú</mi>
   <mi>f</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>ùíú</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}^{f}
  </annotation>
 </semantics>
</math>

 denote the algorithm 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:23">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ùíú</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùíú</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>


 with access to an oracle for evaluating the function 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:24">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(x)
  </annotation>
 </semantics>
</math>

 . Suppose the <a href="Decisional_Diffie-Hellman_assumption" title="wikilink">Decisional Diffie-Hellman assumption</a> holds for 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:25">
 <semantics>
  <msub>
   <mi>ùîΩ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùîΩ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{p}
  </annotation>
 </semantics>
</math>

, <strong>Naor and Reingold</strong> show that for every <a href="PP_(complexity)" title="wikilink">probabilistic polynomial time</a> algorithm 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:26">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ùíú</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùíú</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

 and sufficiently large <em>n</em></p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:27">
 <semantics>
  <mrow>
   <mtext>Pr</mtext>
   <mrow>
    <mo stretchy="false">[</mo>
    <msup>
     <mi class="ltx_font_mathcaligraphic">ùíú</mi>
     <mrow>
      <msub>
       <mi>f</mi>
       <mi>a</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>,</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>‚Üí</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>-</mo>
   <mtext>Pr</mtext>
   <mrow>
    <mo stretchy="false">[</mo>
    <msup>
     <mi class="ltx_font_mathcaligraphic">ùíú</mi>
     <mi>R</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo>,</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>‚Üí</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <mtext>Pr</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùíú</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>a</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">p</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">g</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-‚Üí</ci>
     <cn type="integer">1</cn>
     <ci>normal-]</ci>
    </cerror>
    <minus></minus>
    <mtext>Pr</mtext>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ùíú</ci>
      <ci>R</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">p</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">g</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-‚Üí</ci>
     <cn type="integer">1</cn>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{Pr }[\mathcal{A}^{f_{a}(x)}(p,g)\to 1]-\text{Pr }[\mathcal{A}^{R}(p,g)%
\to 1]
  </annotation>
 </semantics>
</math>

 is <a href="Negligible_function" title="wikilink">negligible</a>.</p>

<p>The first probability is taken over the choice of the seed s = (p, g, a) and the second probability is taken over the random distribution induced on p, g by 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:28">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">‚Ñê</mi>
   <mi class="ltx_font_mathcaligraphic">ùí¢</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>‚Ñê</ci>
    <ci>ùí¢</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{I}\mathcal{G}(n)
  </annotation>
 </semantics>
</math>


, instance generator, and the random choice of the function 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:29">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>R</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>a</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{a}\;(x)
  </annotation>
 </semantics>
</math>

 among the set of all 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:30">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">{</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">}</mo>
    </mrow>
    <mi>n</mi>
   </msup>
   <mo>‚Üí</mo>
   <msub>
    <mi>ùîΩ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-‚Üí</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <set>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </set>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{0,1\}^{n}\to\mathbb{F}_{p}
  </annotation>
 </semantics>
</math>

 functions.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="linear-complexity">Linear Complexity</h2>

<p>One natural measure of how useful a sequence may be for <a href="cryptography" title="wikilink">cryptographic</a> purposes is the size of its <strong>linear complexity</strong>. The linear complexity of an <em>n</em>-element sequence W(x), x = 0,1,2,‚Ä¶,n ‚Äì 1, over a ring 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:31">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñõ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñõ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{R}
  </annotation>
 </semantics>
</math>

 is the length <em>l</em> of the shortest linear <a href="recurrence_relation" title="wikilink">recurrence relation</a> W (x + <em>l</em>) = A<sub><em>l</em>-1</sub> W (x +<em>l</em>-1) + ‚Ä¶ + A<sub>0</sub> W(x), x = 0,1,2,‚Ä¶, <em>n</em> ‚Äì <em>l</em> ‚Äì1 with A<sub>0</sub>, ‚Ä¶, A<sub><em>l</em>-1</sub> ‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:32">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñõ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñõ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{R}
  </annotation>
 </semantics>
</math>

, which is satisfied by this sequence.</p>

<p>For some 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:33">
 <semantics>
  <mi>Œ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>


 &gt; 0,n ‚â• (1+ 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:34">
 <semantics>
  <mi>Œ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

) 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:35">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mi>l</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <log></log>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log l
  </annotation>
 </semantics>
</math>

, for any 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:36">
 <semantics>
  <mrow>
   <mi>Œ¥</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>Œ¥</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta>0
  </annotation>
 </semantics>
</math>

, sufficiently large <em>l</em>, the linear complexity of the sequence 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:37">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(x)
  </annotation>
 </semantics>
</math>

,0 ‚â§ x ‚â§ 2<sup>n-1</sup>, denoted by 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:38">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{a}
  </annotation>
 </semantics>
</math>


 satisfies</p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:39">
 <semantics>
  <mrow>
   <msub>
    <mi>L</mi>
    <mi>a</mi>
   </msub>
   <mo>‚©æ</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <msup>
        <mi>l</mi>
        <mrow>
         <mn>1</mn>
         <mo rspace="7.5pt">-</mo>
         <mi>Œ¥</mi>
        </mrow>
       </msup>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>, if</mtext>
         <mi>Œ≥</mi>
        </mrow>
        <mo>‚©æ</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <msup>
        <mi>l</mi>
        <mrow>
         <mo>(</mo>
         <mstyle scriptlevel="-1">
          <mfrac>
           <mpadded lspace="5pt" width="+5pt">
            <mi>Œ≥</mi>
           </mpadded>
           <mrow>
            <mn>2</mn>
            <mo rspace="7.5pt">-</mo>
            <mi>Œ¥</mi>
           </mrow>
          </mfrac>
         </mstyle>
         <mo>)</mo>
        </mrow>
       </msup>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>, if</mtext>
         <mi>Œ≥</mi>
        </mrow>
        <mo><</mo>
        <mn>2</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>Œ¥</ci>
      </apply>
     </apply>
     <apply>
      <geq></geq>
      <apply>
       <times></times>
       <mtext>, if</mtext>
       <ci>Œ≥</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>l</ci>
      <apply>
       <divide></divide>
       <ci>Œ≥</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
        <ci>Œ¥</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <lt></lt>
      <apply>
       <times></times>
       <mtext>, if</mtext>
       <ci>Œ≥</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{a}\geqslant\begin{cases}l^{1-\ \delta\,\!}&\text{, if }\gamma\,\!\geqslant 2%
\\
l^{\left(\tfrac{\ \gamma\,\!}{2-\ \delta\,\!}\right)}&\text{, if }\gamma\,\!<2%
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>for all except possibly at most 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:40">
 <semantics>
  <mrow>
   <mn>3</mn>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>l</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mi>Œ¥</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">3</cn>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <ci>l</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>Œ¥</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3(l-1)^{n-\delta}
  </annotation>
 </semantics>
</math>

 vectors a ‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:41">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>ùîΩ</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <ci>l</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbb{F}_{l})^{n}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The bound of this work has disadvantages, namely it does not apply to the very interesting case 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mi>p</mi>
    </mrow>
    <mo>‚âà</mo>
    <mrow>
     <mi>log</mi>
     <mi>n</mi>
    </mrow>
    <mo>‚âà</mo>
    <mi>n</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <log></log>
      <ci>p</ci>
     </apply>
     <apply>
      <log></log>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log p\approx\log n\approx{n.}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="uniformity-of-distribution">Uniformity of Distribution</h2>

<p>The statistical distribution of 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:43">
 <semantics>
  <mrow>
   <mpadded width="+2.8pt">
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
   </mpadded>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a}\;(x)
  </annotation>
 </semantics>
</math>

 is exponentially close to <a href="Uniform_distribution_(discrete)" title="wikilink">uniform distribution</a> for almost all vectors a ‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:44">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>ùîΩ</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <ci>l</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbb{F}_{l})^{n}
  </annotation>
 </semantics>
</math>

.</p>

<p>Let 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:45">
 <semantics>
  <msub>
   <mi>ùêÉ</mi>
   <mi>a</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùêÉ</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\mathbf{D}}_{a}
  </annotation>
 </semantics>
</math>

 be the <a href="Inversive_congruential_generator" title="wikilink">discrepancy</a> of the set 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:46">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">|</mo>
   <mrow>
    <mn>0</mn>
    <mo>‚â§</mo>
    <mi>x</mi>
    <mo>‚â§</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">conditional-set</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">0</cn>
      <ci>x</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{f_{a}(x)|0\leq x\leq 2^{n-1}\}
  </annotation>
 </semantics>
</math>

. Thus, if 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:47">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mi>log</mi>
    <mi>p</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <apply>
     <log></log>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=\log p
  </annotation>
 </semantics>
</math>

 is the bit length of <em>p</em> then for all vectors a ‚àà 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:48">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>ùîΩ</mi>
     <mi>l</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùîΩ</ci>
     <ci>l</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbb{F}_{l})^{n}
  </annotation>
 </semantics>
</math>

 the bound 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:49">
 <semantics>
  <mrow>
   <msub>
    <mi>ùêÉ</mi>
    <mi>a</mi>
   </msub>
   <mo>‚â§</mo>
   <mrow>
    <mi mathvariant="normal">Œî</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùêÉ</ci>
     <ci>a</ci>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Œî</ci>
     <interval closure="open">
      <ci>l</ci>
      <ci>p</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\mathbf{D}}_{a}\leq\Delta(l,p)
  </annotation>
 </semantics>
</math>

 holds, where</p>

<p>

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:50">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Œî</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mrow>
             <mn>1</mn>
             <mo rspace="7.5pt">-</mo>
             <mi>Œ≥</mi>
            </mrow>
            <mn>2</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <msup>
         <mi>l</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
            <mn>2</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <mrow>
         <msup>
          <mi>log</mi>
          <mn>2</mn>
         </msup>
         <mi>p</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>, if</mtext>
         <mi>l</mi>
        </mrow>
        <mo>‚©æ</mo>
        <msup>
         <mi>p</mi>
         <mi>Œ≥</mi>
        </msup>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <msup>
         <mi>l</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <msup>
          <mi>log</mi>
          <mn>2</mn>
         </msup>
         <mi>p</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>, if</mtext>
         <msup>
          <mi>p</mi>
          <mi>Œ≥</mi>
         </msup>
        </mrow>
        <mo>></mo>
        <mi>l</mi>
        <mo>‚©æ</mo>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mn>2</mn>
            <mn>3</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mn>1</mn>
            <mn>4</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <msup>
         <mi>l</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mrow>
             <mo>-</mo>
             <mn>5</mn>
            </mrow>
            <mn>8</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <mrow>
         <msup>
          <mi>log</mi>
          <mn>2</mn>
         </msup>
         <mi>p</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>, if</mtext>
         <msup>
          <mi>p</mi>
          <mrow>
           <mo>(</mo>
           <mstyle scriptlevel="-1">
            <mfrac>
             <mn>2</mn>
             <mn>3</mn>
            </mfrac>
           </mstyle>
           <mo>)</mo>
          </mrow>
         </msup>
        </mrow>
        <mo>></mo>
        <mi>l</mi>
        <mo>‚©æ</mo>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mn>1</mn>
            <mn>2</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mn>1</mn>
            <mn>8</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <msup>
         <mi>l</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mrow>
             <mo>-</mo>
             <mn>3</mn>
            </mrow>
            <mn>8</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
        <mrow>
         <msup>
          <mi>log</mi>
          <mn>2</mn>
         </msup>
         <mi>p</mi>
        </mrow>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>, if</mtext>
         <msup>
          <mi>p</mi>
          <mrow>
           <mo>(</mo>
           <mstyle scriptlevel="-1">
            <mfrac>
             <mn>1</mn>
             <mn>2</mn>
            </mfrac>
           </mstyle>
           <mo>)</mo>
          </mrow>
         </msup>
        </mrow>
        <mo>></mo>
        <mi>l</mi>
        <mo>‚©æ</mo>
        <msup>
         <mi>p</mi>
         <mrow>
          <mo>(</mo>
          <mstyle scriptlevel="-1">
           <mfrac>
            <mn>1</mn>
            <mn>3</mn>
           </mfrac>
          </mstyle>
          <mo>)</mo>
         </mrow>
        </msup>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Œî</ci>
     <interval closure="open">
      <ci>l</ci>
      <ci>p</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>Œ≥</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <geq></geq>
      <apply>
       <times></times>
       <mtext>, if</mtext>
       <ci>l</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>Œ≥</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <and></and>
      <apply>
       <gt></gt>
       <apply>
        <times></times>
        <mtext>, if</mtext>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <ci>Œ≥</ci>
        </apply>
       </apply>
       <ci>l</ci>
      </apply>
      <apply>
       <geq></geq>
       <share href="#.cmml">
       </share>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <divide></divide>
         <cn type="integer">2</cn>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="integer">5</cn>
        </apply>
        <cn type="integer">8</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <and></and>
      <apply>
       <gt></gt>
       <apply>
        <times></times>
        <mtext>, if</mtext>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <apply>
          <divide></divide>
          <cn type="integer">2</cn>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
       <ci>l</ci>
      </apply>
      <apply>
       <geq></geq>
       <share href="#.cmml">
       </share>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">8</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">8</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
     <apply>
      <and></and>
      <apply>
       <gt></gt>
       <apply>
        <times></times>
        <mtext>, if</mtext>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>l</ci>
      </apply>
      <apply>
       <geq></geq>
       <share href="#.cmml">
       </share>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta(l,p)=\begin{cases}p^{\left(\tfrac{1-\ \gamma\,\!}{2}\right)}l^{\left(%
\tfrac{-1}{2}\right)}\log^{2}p&\text{, if }l\geqslant p^{\gamma\,\!}\\
p^{\left(\tfrac{1}{2}\right)}l^{-1}\log^{2}p&\text{, if }p^{\gamma\,\!}>l%
\geqslant p^{\left(\tfrac{2}{3}\right)}\\
p^{\left(\tfrac{1}{4}\right)}l^{\left(\tfrac{-5}{8}\right)}\log^{2}p&\text{, %
if }p^{\left(\tfrac{2}{3}\right)}>l\geqslant p^{\left(\tfrac{1}{2}\right)}\\
p^{\left(\tfrac{1}{8}\right)}l^{\left(\tfrac{-3}{8}\right)}\log^{2}p&\text{, %
if }p^{\left(\tfrac{1}{2}\right)}>l\geqslant p^{\left(\tfrac{1}{3}\right)}\\
\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:51">
 <semantics>
  <mi>Œ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Œ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 = 2.5 - 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:52">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <log></log>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log 3
  </annotation>
 </semantics>
</math>

= 0.9150....</p>

<p>Although this property does not seem to have any immediate cryptographic implications, the inverse fact, namely non uniform distribution, if true would have disastrous consequences for applications of this function.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="sequences-in-elliptic-curve">Sequences in Elliptic Curve</h2>

<p>The <a href="elliptic_curve" title="wikilink">elliptic curve</a> version of this function is of interest as well. In particular, it may help to improve the cryptographic security of the corresponding system. Let <em>p</em> &gt; 3 be prime and let E be an elliptic curve over 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:53">
 <semantics>
  <msub>
   <mi>ùîΩ</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ùîΩ</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{F}_{p}
  </annotation>
 </semantics>
</math>

, then each vector <strong>a</strong> defines a <a href="Sequence#Finite_and_infinite" title="wikilink">finite sequence</a> in the <a class="uri" href="subgroup" title="wikilink">subgroup</a> 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:54">
 <semantics>
  <mrow>
   <mo stretchy="false">‚ü®</mo>
   <mi>G</mi>
   <mo stretchy="false">‚ü©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-‚ü®‚ü©</csymbol>
    <ci>G</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle G\rangle
  </annotation>
 </semantics>
</math>

 as:</p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:55">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>F</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mi>a</mi>
       <mn>1</mn>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
      </msubsup>
      <msubsup>
       <mi>a</mi>
       <mn>2</mn>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </msubsup>
      <mi mathvariant="normal">‚Ä¶</mi>
      <msubsup>
       <mi>a</mi>
       <mi>n</mi>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </msubsup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>G</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>a</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>G</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{a}(x)=(a_{1}^{x_{1}}a_{2}^{x_{2}}\dots a_{n}^{x_{n}})G
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:56">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mi mathvariant="normal">‚Ä¶</mi>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=x_{1}\dots x_{n}
  </annotation>
 </semantics>
</math>

 is the bit representation of integer 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:57">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
   <mo>‚â§</mo>
   <mi>x</mi>
   <mo>‚â§</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <list>
      <ci>x</ci>
      <cn type="integer">0</cn>
     </list>
     <ci>x</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,0\leq x\leq 2^{n-1}
  </annotation>
 </semantics>
</math>

. The <strong>Naor-Reingold</strong> elliptic curve sequence is defined as</p>

<p>

<math display="block" id="Naor-Reingold_Pseudorandom_Function:58">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>u</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>X</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>f</mi>
        <mi>a</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo rspace="5.3pt" stretchy="false">)</mo>
     </mrow>
     <mtext>where</mtext>
     <mi>X</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>P</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mpadded width="+2.8pt">
      <mtext>is the abscissa of</mtext>
     </mpadded>
     <mi>P</mi>
    </mrow>
    <mo>‚àà</mo>
    <mi>E</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>X</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>a</ci>
       </apply>
       <ci>k</ci>
      </apply>
      <mtext>where</mtext>
      <ci>X</ci>
      <ci>P</ci>
      <mtext>is the abscissa of</mtext>
      <ci>P</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{k}=X(f_{a}(k))\;\mbox{where }X(P)\mbox{ is the abscissa of}\;P\in E.
  </annotation>
 </semantics>
</math>

<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>If the Decisional Diffie-Hellman assumption holds, the index <em>k</em> is not enough to compute 

<math display="inline" id="Naor-Reingold_Pseudorandom_Function:59">
 <semantics>
  <msub>
   <mi>u</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>u</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{k}
  </annotation>
 </semantics>
</math>

 in polynomial time, even if an attacker performs polynomially many queries to a random oracle.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Decisional_Diffie-Hellman_assumption" title="wikilink">Decisional Diffie-Hellman assumption</a></li>
<li><a href="Finite_Field" title="wikilink">Finite Field</a></li>
<li><a href="Inversive_congruential_generator" title="wikilink">Inversive congruential generator</a></li>
<li><a href="Generalized_inversive_congruential_pseudorandom_numbers" title="wikilink">Generalized inversive congruential pseudorandom numbers</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Pseudorandom_number_generators" title="wikilink">Category:Pseudorandom number generators</a> <a class="uri" href="Category:Cryptography" title="wikilink">Category:Cryptography</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
</ol>
</section>
</body>
</html>

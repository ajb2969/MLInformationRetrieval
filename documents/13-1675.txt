   GNSS positioning calculation      GNSS positioning calculation   The global navigation satellite system (GNSS) positioning for receiver's position is derived through the calculation steps, or algorithm, given below. In essence, a GNSS receiver measures the transmitting time of GNSS signals emitted from four or more GNSS satellites and these measurements are used to obtain its position (i.e., spatial coordinates) and reception time.  Calculation steps   A global-navigation-satellite-system (GNSS) receiver measures the apparent transmitting time,     t  ~   i     subscript   normal-~  t   i    \scriptstyle\tilde{t}_{i}   , or "phase", of GNSS signals emitted from four or more GNSS satellites (     i   =  1  ,  2  ,  3  ,  4  ,  .  .  ,  n     fragments  i   1  normal-,  2  normal-,  3  normal-,  4  normal-,  normal-.  normal-.  normal-,  n    \scriptstyle i\;=\;1,\,2,\,3,\,4,\,..,\,n   ), simultaneously. 1  GNSS satellites broadcast the messages of satellites' ephemeris ,     𝒓  i    (  t  )        subscript  𝒓  i   t    \scriptstyle\boldsymbol{r}_{i}(t)   , and intrinsic clock bias (i.e., clock advance),    δ   t   clock,sv  ,  i     (  t  )       δ   subscript  t   clock,sv  i    t    \scriptstyle\delta t_{\text{clock,sv},i}(t)   as the functions of ( atomic ) standard time , e.g., GPST . 2  The transmitting time of GNSS satellite signals,    t  i     subscript  t  i    \scriptstyle t_{i}   , is thus derived from the non- closed-form  equations        t  ~   i    =     t  i    +   δ   t   clock  ,  i     (   t  i   )          subscript   normal-~  t   i      subscript  t  i     δ   subscript  t   clock  i     subscript  t  i       \scriptstyle\tilde{t}_{i}\;=\;t_{i}\,+\,\delta t_{\text{clock},i}(t_{i})   and     δ   t   clock  ,  i     (   t  i   )    =    δ   t   clock,sv  ,  i     (   t  i   )    +   δ   t   orbit-relativ  ,  i     (   𝒓  i   ,    𝒓  ˙   i   )           δ   subscript  t   clock  i     subscript  t  i        δ   subscript  t   clock,sv  i     subscript  t  i      δ   subscript  t   orbit-relativ  i      subscript  𝒓  i    subscript   normal-˙  𝒓   i        \scriptstyle\delta t_{\text{clock},i}(t_{i})\;=\;\delta t_{\text{clock,sv},i}(%
 t_{i})\,+\,\delta t_{\text{orbit-relativ},\,i}(\boldsymbol{r}_{i},\,\dot{%
 \boldsymbol{r}}_{i})   , where    δ   t   orbit-relativ  ,  i     (   𝒓  i   ,    𝒓  ˙   i   )       δ   subscript  t   orbit-relativ  i      subscript  𝒓  i    subscript   normal-˙  𝒓   i      \scriptstyle\delta t_{\text{orbit-relativ},i}(\boldsymbol{r}_{i},\,\dot{%
 \boldsymbol{r}}_{i})   is the relativistic clock bias, periodically risen from the satellite's orbital eccentricity and Earth's gravity field . 3 The satellite's position and velocity are determined by    t  i     subscript  t  i    \scriptstyle t_{i}   as follows      𝒓  i    =    𝒓  i    (   t  i   )         subscript  𝒓  i      subscript  𝒓  i    subscript  t  i      \scriptstyle\boldsymbol{r}_{i}\;=\;\boldsymbol{r}_{i}(t_{i})   and       𝒓  ˙   i    =     𝒓  ˙   i    (   t  i   )         subscript   normal-˙  𝒓   i      subscript   normal-˙  𝒓   i    subscript  t  i      \scriptstyle\dot{\boldsymbol{r}}_{i}\;=\;\dot{\boldsymbol{r}}_{i}(t_{i})   .  In the field of GNSS, "geometric range",    r   (   𝒓  A   ,   𝒓  B   )       r    subscript  𝒓  A    subscript  𝒓  B      \scriptstyle r(\boldsymbol{r}_{A},\,\boldsymbol{r}_{B})   , is defined as straight range, or 3-dimensional distance , 4 from    𝒓  A     subscript  𝒓  A    \scriptstyle\boldsymbol{r}_{A}   to    𝒓  B     subscript  𝒓  B    \scriptstyle\boldsymbol{r}_{B}   in inertial frame (e.g., Earth Centered Inertial (ECI) one), not in rotating frame . 5  The receiver's position,    𝒓  rec     subscript  𝒓  rec    \scriptstyle\boldsymbol{r}_{\text{rec}}   , and reception time,    t  rec     subscript  t  rec    \scriptstyle t_{\text{rec}}   , satisfy the light-cone equation of       r   (   𝒓  i   ,   𝒓  rec   )    /   c    +   (    t  i   -   t  rec    )    =  0            r    subscript  𝒓  i    subscript  𝒓  rec     c      subscript  t  i    subscript  t  rec     0    \scriptstyle r(\boldsymbol{r}_{i},\,\boldsymbol{r}_{\text{rec}})/c\,+\,(t_{i}-%
 t_{\text{rec}})\;=\;0   in inertial frame , where   c   c   \scriptstyle c   is the speed of light . The signal transit time is    -   (     t  i    -   t  rec    )          subscript  t  i    subscript  t  rec      \scriptstyle-(t_{i}\,-\,t_{\text{rec}})   .  The above is extended to the satellite-navigation  positioning  equation ,        r   (   𝒓  i   ,   𝒓  rec   )    /   c    +   (     t  i    -   t  rec    )   +   δ    t   atmos  ,  i       -   δ    t   meas-err  ,  i       =  0              r    subscript  𝒓  i    subscript  𝒓  rec     c      subscript  t  i    subscript  t  rec      δ   subscript  t   atmos  i        δ   subscript  t   meas-err  i      0    \scriptstyle r(\boldsymbol{r}_{i},\,\boldsymbol{r}_{\text{rec}})/c\,+\,(t_{i}%
 \,-\,t_{\text{rec}})\,+\,\delta t_{\text{atmos},i}\,-\,\delta t_{\text{meas-%
 err},i}\;=\;0   , where    δ   t   atmos  ,  i        δ   subscript  t   atmos  i      \scriptstyle\delta t_{\text{atmos},i}   is atmospheric delay (= ionospheric delay + tropospheric delay ) along signal path and    δ   t   meas-err  ,  i        δ   subscript  t   meas-err  i      \scriptstyle\delta t_{\text{meas-err},i}   is the measurement error.  The Gauss–Newton method can be used to solve the nonlinear  least-squares problem for the solution     (    𝒓  ^   rec   ,    t  ^   rec   )   =    arg   min  ϕ     (   𝒓  rec   ,   t  rec   )          subscript   normal-^  𝒓   rec    subscript   normal-^  t   rec          ϕ      subscript  𝒓  rec    subscript  t  rec       \scriptstyle(\hat{\boldsymbol{r}}_{\text{rec}},\,\hat{t}_{\text{rec}})\;=\;%
 \arg\min\phi(\boldsymbol{r}_{\text{rec}},\,t_{\text{rec}})   , where     ϕ   (   𝒓  rec   ,   t  rec   )    =    ∑   i  =  1   n     (    δ   t   meas-err  ,  i     /   σ   δ   t   meas-err  ,  i       )   2          ϕ    subscript  𝒓  rec    subscript  t  rec       superscript   subscript     i  1    n    superscript      δ   subscript  t   meas-err  i      subscript  σ    δ   subscript  t   meas-err  i       2      \scriptstyle\phi(\boldsymbol{r}_{\text{rec}},\,t_{\text{rec}})\;=\;\sum_{i=1}^%
 {n}(\delta t_{\text{meas-err},i}/\sigma_{\delta t_{\text{meas-err},i}})^{2}   . Note that    δ   t   meas-err  ,  i        δ   subscript  t   meas-err  i      \scriptstyle\delta t_{\text{meas-err},i}   should be regarded as a function of    𝒓  rec     subscript  𝒓  rec    \scriptstyle\boldsymbol{r}_{\text{rec}}   and    t  rec     subscript  t  rec    \scriptstyle t_{\text{rec}}   .    The posterior distribution of    𝒓  rec     subscript  𝒓  rec    \scriptstyle\boldsymbol{r}_{\text{rec}}   and    t  rec     subscript  t  rec    \scriptstyle t_{\text{rec}}   is proportional to    exp   (   -     1  2    ϕ   (   𝒓  rec   ,   t  rec   )     )             1  2   ϕ    subscript  𝒓  rec    subscript  t  rec        \scriptstyle\exp(-\frac{1}{2}\phi(\boldsymbol{r}_{\text{rec}},\,t_{\text{rec}}))   , whose mode is    (    𝒓  ^   rec   ,    t  ^   rec   )      subscript   normal-^  𝒓   rec    subscript   normal-^  t   rec     \scriptstyle(\hat{\boldsymbol{r}}_{\text{rec}},\,\hat{t}_{\text{rec}})   . Their inference is formalized as maximum a posteriori estimation .  The posterior distribution of    𝒓  rec     subscript  𝒓  rec    \scriptstyle\boldsymbol{r}_{\text{rec}}   is proportional to     ∫   -  ∞   ∞     exp   (   -     1  2    ϕ   (   𝒓  rec   ,   t  rec   )     )    d   t  rec        superscript   subscript                    1  2   ϕ    subscript  𝒓  rec    subscript  t  rec       d   subscript  t  rec      \scriptstyle\int_{-\infty}^{\infty}\exp(-\frac{1}{2}\phi(\boldsymbol{r}_{\text%
 {rec}},\,t_{\text{rec}}))\,dt_{\text{rec}}   .   The solution illustrated  Image:Light cones.svg|alt=|Essentially, the solution,    (    𝒓  ^   rec   ,    t  ^   rec   )      subscript   normal-^  𝒓   rec    subscript   normal-^  t   rec     \scriptstyle(\hat{\boldsymbol{r}}_{\text{rec}},\,\hat{t}_{\text{rec}})   , is the intersection of light cones . Image:Evolution light cones 0.gif|alt=|The posterior distribution of the solution is derived from the product of the distribution of propagating spherical surfaces. (See animation .)  The GPS case   For Global Positioning System (GPS), 6 the non-closed-form equations in step 3 result in       {        Δ   t  i    (   t  i   ,   E  i   )    ≜      t  i    +   δ   t   clock  ,  i     (   t  i   ,   E  i   )     -     t  ~   i     =  0   ,           Δ   M  i    (   t  i   ,   E  i   )    ≜     M  i    (   t  i   )    -   (     E  i    -    e  i    sin   E  i      )    =  0   ,          cases     normal-≜    normal-Δ   subscript  t  i     subscript  t  i    subscript  E  i          subscript  t  i     δ   subscript  t   clock  i      subscript  t  i    subscript  E  i       subscript   normal-~  t   i         0    otherwise     normal-≜    normal-Δ   subscript  M  i     subscript  t  i    subscript  E  i          subscript  M  i    subscript  t  i       subscript  E  i      subscript  e  i      subscript  E  i            0    otherwise    \scriptstyle\begin{cases}\scriptstyle\Delta t_{i}(t_{i},\,E_{i})\;\triangleq\;%
 t_{i}\,+\,\delta t_{\text{clock},i}(t_{i},\,E_{i})\,-\,\tilde{t}_{i}\;=\;0,\\
 \scriptstyle\Delta M_{i}(t_{i},\,E_{i})\;\triangleq\;M_{i}(t_{i})\,-\,(E_{i}\,%
 -\,e_{i}\sin E_{i})\;=\;0,\end{cases}   in which    E  i     subscript  E  i    \scriptstyle E_{i}   is the orbital eccentric anomaly of satellite   i   i   i   ,    M  i     subscript  M  i    \scriptstyle M_{i}   is the mean anomaly ,    e  i     subscript  e  i    \scriptstyle e_{i}   is the eccentricity , and     δ   t   clock  ,  i     (   t  i   ,   E  i   )    =    δ   t   clock,sv  ,  i     (   t  i   )    +   δ   t   orbit-relativ  ,  i     (   E  i   )           δ   subscript  t   clock  i      subscript  t  i    subscript  E  i         δ   subscript  t   clock,sv  i     subscript  t  i      δ   subscript  t   orbit-relativ  i     subscript  E  i       \scriptstyle\delta t_{\text{clock},i}(t_{i},\,E_{i})\;=\;\delta t_{\text{clock%
 ,sv},i}(t_{i})\,+\,\delta t_{\text{orbit-relativ},i}(E_{i})   .   The above can be solved by using the bivariate  Newton-Raphson method on    t  i     subscript  t  i    \scriptstyle t_{i}   and    E  i     subscript  E  i    \scriptstyle E_{i}   . Two times of iteration will be necessary and sufficient in most cases. Its iterative update will be described by using the approximated inverse of Jacobian matrix as follows:        (      t  i        E  i      )   ←    (      t  i        E  i      )   -    (     1       0          M  ˙   i    (   t  i   )     1  -    e  i    cos   E  i             -   1   1  -    e  i    cos   E  i           )    (      Δ   t  i         Δ   M  i       )        normal-←     subscript  t  i      subscript  E  i          subscript  t  i      subscript  E  i         1  absent  0         subscript   normal-˙  M   i    subscript  t  i      1     subscript  e  i      subscript  E  i       absent      1    1     subscript  e  i      subscript  E  i              normal-Δ   subscript  t  i        normal-Δ   subscript  M  i          \scriptscriptstyle\begin{pmatrix}t_{i}\\
 E_{i}\\
 \end{pmatrix}\leftarrow\begin{pmatrix}t_{i}\\
 E_{i}\\
 \end{pmatrix}-\begin{pmatrix}1&&0\\
 \frac{\dot{M}_{i}(t_{i})}{1-e_{i}\cos E_{i}}&&-\frac{1}{1-e_{i}\cos E_{i}}\\
 \end{pmatrix}\begin{pmatrix}\Delta t_{i}\\
 \Delta M_{i}\\
 \end{pmatrix}      Tropospheric delay should not be ignored, while the Global Positioning System (GPS) specification 7 doesn't provide its detailed description.   The GLONASS case   The GLONASS ephemerides don't provide clock biases    δ   t   clock,sv  ,  i     (  t  )       δ   subscript  t   clock,sv  i    t    \scriptstyle\delta t_{\text{clock,sv},i}(t)   , but    δ   t   clock  ,  i     (  t  )       δ   subscript  t   clock  i    t    \scriptstyle\delta t_{\text{clock},i}(t)   .   Note   In the field of GNSS,       r  ~   i    =   -   c   (      t  ~   i    -    t  ~   rec    )          subscript   normal-~  r   i       c     subscript   normal-~  t   i    subscript   normal-~  t   rec        \scriptstyle\tilde{r}_{i}\;=\;-c(\tilde{t}_{i}\,-\,\tilde{t}_{\text{rec}})   is called pseudorange , where     t  ~   rec     subscript   normal-~  t   rec    \scriptstyle\tilde{t}_{\text{rec}}   is a provisional reception time of the receiver.     δ    t  clock,rec     =      t  ~   rec    -   t  rec          δ   subscript  t  clock,rec       subscript   normal-~  t   rec    subscript  t  rec      \scriptstyle\delta t_{\text{clock,rec}}\;=\;\tilde{t}_{\text{rec}}\,-\,t_{%
 \text{rec}}   is called receiver's clock bias (i.e., clock advance). 8  Standard GNSS receivers output     r  ~   i     subscript   normal-~  r   i    \scriptstyle\tilde{r}_{i}   and     t  ~   rec     subscript   normal-~  t   rec    \scriptstyle\tilde{t}_{\text{rec}}   per an observation epoch .  The temporal variation in the relativistic clock bias of satellite is linear if its orbit is circular (and thus its velocity is uniform in inertial frame).  The signal transit time is expressed as     -   (    t  i   -   t  rec    )    =       r  ~   i   /   c    +   δ    t   clock  ,  i       -   δ   t  clock,rec              subscript  t  i    subscript  t  rec            subscript   normal-~  r   i   c     δ   subscript  t   clock  i        δ   subscript  t  clock,rec       \scriptstyle-(t_{i}-t_{\text{rec}})\;=\;\tilde{r}_{i}/c\,+\,\delta t_{\text{%
 clock},i}\,-\,\delta t_{\text{clock,rec}}   , whose right side is round-off-error resistive during calculation.  The geometric range is calculated as     r   (   𝒓  i   ,   𝒓  rec   )    =   |     Ω  E    (     t  i    -   t  rec    )     𝒓   i  ,  ECEF      -   𝒓  rec,ECEF    |         r    subscript  𝒓  i    subscript  𝒓  rec            subscript  normal-Ω  E      subscript  t  i    subscript  t  rec     subscript  𝒓   i  ECEF      subscript  𝒓  rec,ECEF       \scriptstyle r(\boldsymbol{r}_{i},\,\boldsymbol{r}_{\text{rec}})\;=\;|\Omega_{%
 \text{E}}(t_{i}\,-\,t_{\text{rec}})\boldsymbol{r}_{i,\text{ECEF}}\,-\,%
 \boldsymbol{r}_{\text{rec,ECEF}}|   , where the Earth-centred Earth-fixed (ECEF) rotating frame (e.g., WGS84 or ITRF ) is used in the right side and    Ω  E     subscript  normal-Ω  E    \scriptstyle\Omega_{\text{E}}   is the Earth rotating matrix with the argument of the signal transit time . 9 The matrix can be factorized as      Ω  E    (     t  i    -   t  rec    )    =    Ω  E    (   δ   t  clock,rec    )    Ω  E    (    -     r  ~   i   /   c     -   δ   t   clock  ,  i      )           subscript  normal-Ω  E      subscript  t  i    subscript  t  rec        subscript  normal-Ω  E     δ   subscript  t  clock,rec     subscript  normal-Ω  E          subscript   normal-~  r   i   c      δ   subscript  t   clock  i         \scriptstyle\Omega_{\text{E}}(t_{i}\,-\,t_{\text{rec}})\;=\;\Omega_{\text{E}}(%
 \delta t_{\text{clock,rec}})\Omega_{\text{E}}(-\tilde{r}_{i}/c\,-\,\delta t_{%
 \text{clock},i})   .  The line-of-sight unit vector of satellite observed at    𝒓  rec,ECEF     subscript  𝒓  rec,ECEF    \scriptstyle\boldsymbol{r}_{\text{rec,ECEF}}   is described as      𝒆   i  ,  rec,ECEF     =   -      ∂  r    (   𝒓  i   ,   𝒓  rec   )     ∂   𝒓  rec,ECEF            subscript  𝒆   i  rec,ECEF            r     subscript  𝒓  i    subscript  𝒓  rec        subscript  𝒓  rec,ECEF        \scriptstyle\boldsymbol{e}_{i,\text{rec,ECEF}}\;=\;-\frac{\partial r(%
 \boldsymbol{r}_{i},\,\boldsymbol{r}_{\text{rec}})}{\partial\boldsymbol{r}_{%
 \text{rec,ECEF}}}   .  The satellite-navigation  positioning  equation may be expressed by using the variables     𝒓  rec,ECEF     subscript  𝒓  rec,ECEF    \scriptstyle\boldsymbol{r}_{\text{rec,ECEF}}   and    δ   t  clock,rec       δ   subscript  t  clock,rec     \scriptstyle\delta t_{\text{clock,rec}}   .  The nonlinearity of the vertical dependency of tropospheric delay degrades the convergence efficiency in the Gauss–Newton iterations in step 7.  The above notation is different from that in the Wikipedia articles, 'Position calculation introduction' and 'Position calculation advanced', of Global Positioning System (GPS).   See also   Least squares adjustment  Precise Point Positioning  Real Time Kinematic   References    "  Category:Satellite navigation systems     Misra, P. and Enge, P., Global Positioning System: Signals, Measurements, and Performance, 2nd, Ganga-Jamuna Press, 2006. ↩  The interface specification of NAVSTAR GLOBAL POSITIONING SYSTEM ↩   3-dimensional distance is given by     r   (   𝒓  A   ,   𝒓  B   )    =   |    𝒓  A   -   𝒓  B    |   =      (    x  A   -   x  B    )   2   +    (    y  A   -   y  B    )   2   +    (    z  A   -   z  B    )   2             r    subscript  𝒓  A    subscript  𝒓  B          subscript  𝒓  A    subscript  𝒓  B               superscript     subscript  x  A    subscript  x  B    2    superscript     subscript  y  A    subscript  y  B    2    superscript     subscript  z  A    subscript  z  B    2        \scriptstyle r(\boldsymbol{r}_{A},\,\boldsymbol{r}_{B})=|\boldsymbol{r}_{A}-%
 \boldsymbol{r}_{B}|=\sqrt{(x_{A}-x_{B})^{2}+(y_{A}-y_{B})^{2}+(z_{A}-z_{B})^{2}}   where     𝒓  A   =   (   x  A   ,   y  A   ,   z  A   )        subscript  𝒓  A     subscript  x  A    subscript  y  A    subscript  z  A      \scriptstyle\boldsymbol{r}_{A}=(x_{A},y_{A},z_{A})   and     𝒓  B   =   (   x  B   ,   y  B   ,   z  B   )        subscript  𝒓  B     subscript  x  B    subscript  y  B    subscript  z  B      \scriptstyle\boldsymbol{r}_{B}=(x_{B},y_{B},z_{B})   represented in inertial frame . ↩          
   Weighted arithmetic mean      Weighted arithmetic mean   The weighted arithmetic mean is similar to an ordinary arithmetic mean (the most common type of average ), except that instead of each of the data points contributing equally to the final average, some data points contribute more than others. The notion of weighted mean plays a role in descriptive statistics and also occurs in a more general form in several other areas of mathematics.  If all the weights are equal, then the weighted mean is the same as the arithmetic mean . While weighted means generally behave in a similar fashion to arithmetic means, they do have a few counterintuitive properties, as captured for instance in Simpson's paradox .  Examples  Basic example  Given two school classes, one with 20 students, and one with 30 students, the grades in each class on a test were:   Morning class=62, 67, 71, 74, 76, 77, 78, 79, 79, 80, 80, 81, 81, 82, 83, 84, 86, 89, 93, 98    Afternoon class=81, 82, 83, 84, 85, 86, 87, 87, 88, 88, 89, 89, 89, 90, 90, 90, 90, 91, 91, 91, 92, 92, 93, 93, 94, 95, 96, 97, 98, 99   The straight average for the morning class is 80 and the straight average of the afternoon class is 90. The straight average of 80 and 90 is 85, the mean of the two class means. However, this does not account for the difference in number of students in each class (20 versus 30); hence the value of 85 does not reflect the average student grade (independent of class). The average student grade can be obtained by averaging all the grades, without regard to classes (add all the grades up and divide by the total number of students):       x  Â¯   =   4300  50   =  86.         normal-Â¯  x     4300  50        86.     \bar{x}=\frac{4300}{50}=86.     Or, this can be accomplished by weighting the class means by the number of students in each class (using a weighted mean of the class means):       x  Â¯   =     (   20  Ã—  80   )   +   (   30  Ã—  90   )     20  +  30    =  86.         normal-Â¯  x         20  80     30  90      20  30         86.     \bar{x}=\frac{(20\times 80)+(30\times 90)}{20+30}=86.     Thus, the weighted mean makes it possible to find the average student grade in the case where only the class means and the number of students in each class are available.  Convex combination examples  Since only the relative weights are relevant, any weighted mean can be expressed using coefficients that sum to one. Such a linear combination is called a convex combination .  Using the previous example, we would get the following:       20   20  +  30    =   0.4         20    20  30    0.4    \frac{20}{20+30}=0.4\,          30   20  +  30    =   0.6         30    20  30    0.6    \frac{30}{20+30}=0.6\,          x  Â¯   =    (   0.4  Ã—  80   )   +   (   0.6  Ã—  90   )    =  86.         normal-Â¯  x       0.4  80     0.6  90         86.     \bar{x}=(0.4\times 80)+(0.6\times 90)=86.     Mathematical definition  Formally, the weighted mean of a non-empty set of data       {   x  1   ,   x  2   ,  â€¦  ,   x  n   }   ,      subscript  x  1    subscript  x  2   normal-â€¦   subscript  x  n     \{x_{1},x_{2},\dots,x_{n}\},     with non-negative weights        x  Â¯   =     âˆ‘   i  =  1   n     w  i    x  i       âˆ‘   i  =  1   n    w  i      ,       normal-Â¯  x       superscript   subscript     i  1    n      subscript  w  i    subscript  x  i       superscript   subscript     i  1    n    subscript  w  i       \bar{x}=\frac{\sum_{i=1}^{n}w_{i}x_{i}}{\sum_{i=1}^{n}w_{i}},     which means:        x  Â¯   =      w  1    x  1    +    w  2    x  2    +  â‹¯  +    w  n    x  n       w  1   +   w  2   +  â‹¯  +   w  n      .       normal-Â¯  x          subscript  w  1    subscript  x  1       subscript  w  2    subscript  x  2    normal-â‹¯     subscript  w  n    subscript  x  n        subscript  w  1    subscript  w  2   normal-â‹¯   subscript  w  n       \bar{x}=\frac{w_{1}x_{1}+w_{2}x_{2}+\cdots+w_{n}x_{n}}{w_{1}+w_{2}+\cdots+w_{n%
 }}.     Therefore data elements with a high weight contribute more to the weighted mean than do elements with a low weight. The weights cannot be negative. Some may be zero, but not all of them (since division by zero is not allowed).  The formulas are simplified when the weights are normalized such that they sum up to   1   1   1   , i.e.      âˆ‘   i  =  1   n    w  i    =  1        superscript   subscript     i  1    n    subscript  w  i    1    \sum_{i=1}^{n}{w_{i}}=1   . For such normalized weights the weighted mean is simply     x  Â¯   =    âˆ‘   i  =  1   n     w  i    x  i          normal-Â¯  x     superscript   subscript     i  1    n      subscript  w  i    subscript  x  i       \bar{x}=\sum_{i=1}^{n}{w_{i}x_{i}}   .  Note that one can always normalize the weights by making the following transformation on the weights     w  i  â€²   =    w  i      âˆ‘   j  =  1   n     w  j          superscript   subscript  w  i   normal-â€²      subscript  w  i     superscript   subscript     j  1    n    subscript  w  j       w_{i}^{\prime}=\frac{w_{i}}{\sum_{j=1}^{n}{w_{j}}}   . Using the normalized weight yields the same results as when using the original weights. Indeed,      x  Â¯     normal-Â¯  x    \displaystyle\bar{x}     The common mean     1  n     âˆ‘   i  =  1   n    x  i          1  n     superscript   subscript     i  1    n    subscript  x  i      \frac{1}{n}\sum_{i=1}^{n}{x_{i}}   is a special case of the weighted mean where all data have equal weights,     w  i   =  w       subscript  w  i   w    w_{i}=w   . When the weights are normalized then      w  i  â€²   =   1  n    .       superscript   subscript  w  i   normal-â€²     1  n     w_{i}^{\prime}=\frac{1}{n}.     Statistical properties  The weighted sample mean,    X  Â¯     normal-Â¯  X    \bar{X}   , with normalized weights (weights summing to one) is itself a random variable. Its expected value and standard deviation are related to the expected values and standard deviations of the observations as follows,  If the observations have expected values        E   (   X  i   )    =    Î¼  i   Â¯    ,        E   subscript  X  i     normal-Â¯   subscript  Î¼  i      E(X_{i})=\bar{\mu_{i}},   then the weighted sample mean has expectation        E   (   X  Â¯   )    =    âˆ‘   i  =  1   n     w  i    Î¼  i      .        E   normal-Â¯  X      superscript   subscript     i  1    n      subscript  w  i    subscript  Î¼  i       E(\bar{X})=\sum_{i=1}^{n}{w_{i}\mu_{i}}.   In particular, if the means are equal,     Î¼  i   =  Î¼       subscript  Î¼  i   Î¼    \mu_{i}=\mu   , then the expectation of the weighted sample mean will be that value,        E   (   X  Â¯   )    =  Î¼   .        E   normal-Â¯  X    Î¼    E(\bar{X})=\mu.\,     For uncorrelated observations with variances    Ïƒ  i  2     subscript   superscript  Ïƒ  2   i    \sigma^{2}_{i}   , the variance of the weighted sample mean is        Ïƒ   X  Â¯   2   =    âˆ‘   i  =  1   n     w  i  2    Ïƒ  i  2      .       subscript   superscript  Ïƒ  2    normal-Â¯  X      superscript   subscript     i  1    n      superscript   subscript  w  i   2    subscript   superscript  Ïƒ  2   i       \sigma^{2}_{\bar{X}}=\sum_{i=1}^{n}{w_{i}^{2}\sigma^{2}_{i}}.   Consequently,if all the observations have equal variance,     Ïƒ  i  2   =   Ïƒ  0  2        subscript   superscript  Ïƒ  2   i    subscript   superscript  Ïƒ  2   0     \sigma^{2}_{i}=\sigma^{2}_{0}   , the weighted sample mean will have variance        Ïƒ   X  Â¯   2   =    Ïƒ  0  2     âˆ‘   i  =  1   n    w  i  2      ,       subscript   superscript  Ïƒ  2    normal-Â¯  X       subscript   superscript  Ïƒ  2   0     superscript   subscript     i  1    n    superscript   subscript  w  i   2       \sigma^{2}_{\bar{X}}=\sigma^{2}_{0}\sum_{i=1}^{n}{w_{i}^{2}},   such that     1  /  n   â‰¤    âˆ‘   i  =  1   n    w  i  2    â‰¤  1          1  n     superscript   subscript     i  1    n    superscript   subscript  w  i   2         1     1/n\leq\sum_{i=1}^{n}{w_{i}^{2}}\leq 1   . It attains its minimum value when all weights are equal, and its maximum when all weights except one are zero. In the former case we have     Ïƒ   X  Â¯    =   Ïƒ  /   n         subscript  Ïƒ   normal-Â¯  X      Ïƒ    n      \sigma_{\bar{X}}=\sigma/\sqrt{n}   , which is related to the central limit theorem .  Note that due to the fact that one can always transform non-normalized weights to normalized weights all formula in this section can be adapted to non-normalized weights by replacing all    w  i     subscript  w  i    w_{i}   by     w  i  â€²   =    w  i      âˆ‘   i  =  1   n     w  i          superscript   subscript  w  i   normal-â€²      subscript  w  i     superscript   subscript     i  1    n    subscript  w  i       w_{i}^{\prime}=\frac{w_{i}}{\sum_{i=1}^{n}{w_{i}}}   .  Dealing with variance  For the weighted mean of a list of data for which each element    x  i     subscript  x  i    x_{i}\,\!   potentially comes from a different probability distribution with known variance      Ïƒ  i  2      superscript   subscript  Ïƒ  i   2    \sigma_{i}^{2}\,   , one possible choice for the weights is given by:        w  i   =   1   Ïƒ  i  2     .       subscript  w  i     1   superscript   subscript  Ïƒ  i   2      w_{i}=\frac{1}{\sigma_{i}^{2}}.     The weighted mean in this case is:        x  Â¯   =     âˆ‘   i  =  1   n    (    x  i    Ïƒ  i   -  2     )      âˆ‘   i  =  1   n    Ïƒ  i   -  2       ,       normal-Â¯  x       superscript   subscript     i  1    n      subscript  x  i    superscript   subscript  Ïƒ  i     2        superscript   subscript     i  1    n    superscript   subscript  Ïƒ  i     2        \bar{x}=\frac{\sum_{i=1}^{n}\left(x_{i}\sigma_{i}^{-2}\right)}{\sum_{i=1}^{n}%
 \sigma_{i}^{-2}},     and the variance of the weighted mean is:        Ïƒ   x  Â¯   2   =   1    âˆ‘   i  =  1   n    Ïƒ  i   -  2       ,       superscript   subscript  Ïƒ   normal-Â¯  x    2     1    superscript   subscript     i  1    n    superscript   subscript  Ïƒ  i     2        \sigma_{\bar{x}}^{2}=\frac{1}{\sum_{i=1}^{n}\sigma_{i}^{-2}},     which reduces to     Ïƒ   x  Â¯   2   =    Ïƒ  0  2   /  n        superscript   subscript  Ïƒ   normal-Â¯  x    2      superscript   subscript  Ïƒ  0   2   n     \sigma_{\bar{x}}^{2}=\sigma_{0}^{2}/n   when all     Ïƒ  i   =   Ïƒ  0        subscript  Ïƒ  i    subscript  Ïƒ  0     \sigma_{i}=\sigma_{0}   .  The two equations above can be combined to obtain:        x  Â¯   =    Ïƒ   x  Â¯   2     âˆ‘   i  =  1   n     x  i   /   Ïƒ  i  2       .       normal-Â¯  x      superscript   subscript  Ïƒ   normal-Â¯  x    2     superscript   subscript     i  1    n      subscript  x  i    superscript   subscript  Ïƒ  i   2        \bar{x}=\sigma_{\bar{x}}^{2}\sum_{i=1}^{n}x_{i}/\sigma_{i}^{2}.     The significance of this choice is that this weighted mean is the maximum likelihood estimator of the mean of the probability distributions under the assumption that they are independent and normally distributed with the same mean.  Correcting for over- or under-dispersion  Weighted means are typically used to find the weighted mean of experimental data, rather than theoretically generated data. In this case, there will be some error in the variance of each data point. Typically experimental errors may be underestimated due to the experimenter not taking into account all sources of error in calculating the variance of each data point. In this event, the variance in the weighted mean must be corrected to account for the fact that    Ï‡  2     superscript  Ï‡  2    \chi^{2}   is too large. The correction that must be made is       Ïƒ   x  Â¯   2   â†’    Ïƒ   x  Â¯   2     Ï‡  Î½  2        normal-â†’   superscript   subscript  Ïƒ   normal-Â¯  x    2      superscript   subscript  Ïƒ   normal-Â¯  x    2    subscript   superscript  Ï‡  2   Î½      \sigma_{\bar{x}}^{2}\rightarrow\sigma_{\bar{x}}^{2}\chi^{2}_{\nu}\,     where    Ï‡  Î½  2     subscript   superscript  Ï‡  2   Î½    \chi^{2}_{\nu}   is    Ï‡  2     superscript  Ï‡  2    \chi^{2}   divided by the number of degrees of freedom, in this case n âˆ’Â 1. This gives the variance in the weighted mean as:        Ïƒ   x  Â¯   2   =     1    âˆ‘   i  =  1   n    Ïƒ  i   -  2      Ã—   1   (   n  -  1   )       âˆ‘   i  =  1   n      (    x  i   -   x  Â¯    )   2    Ïƒ  i  2       ;       superscript   subscript  Ïƒ   normal-Â¯  x    2         1    superscript   subscript     i  1    n    superscript   subscript  Ïƒ  i     2        1    n  1       superscript   subscript     i  1    n      superscript     subscript  x  i    normal-Â¯  x    2    superscript   subscript  Ïƒ  i   2        \sigma_{\bar{x}}^{2}=\frac{1}{\sum_{i=1}^{n}\sigma_{i}^{-2}}\times\frac{1}{(n-%
 1)}\sum_{i=1}^{n}\frac{(x_{i}-\bar{x})^{2}}{\sigma_{i}^{2}};     when all data variances are equal,     Ïƒ  i   =   Ïƒ  0        subscript  Ïƒ  i    subscript  Ïƒ  0     \sigma_{i}=\sigma_{0}   , they cancel out in the weighted mean variance,    Ïƒ   x  Â¯   2     superscript   subscript  Ïƒ   normal-Â¯  x    2    \sigma_{\bar{x}}^{2}   , which then reduces to the standard error of the mean (squared),     Ïƒ   x  Â¯   2   =    Ïƒ  2   /  n        superscript   subscript  Ïƒ   normal-Â¯  x    2      superscript  Ïƒ  2   n     \sigma_{\bar{x}}^{2}=\sigma^{2}/n   , in terms of the sample standard deviation (squared),     Ïƒ  2   =    âˆ‘   i  =  1   n      (    x  i   -   x  Â¯    )   2   /   (   n  -  1   )          superscript  Ïƒ  2     superscript   subscript     i  1    n      superscript     subscript  x  i    normal-Â¯  x    2     n  1       \sigma^{2}=\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}/(n-1)   .  Weighted sample variance  Typically when a mean is calculated it is important to know the variance and standard deviation about that mean. When a weighted mean    Î¼  *     superscript  Î¼     \mu^{*}   is used, the variance of the weighted sample is different from the variance of the unweighted sample.  The biased weighted sample variance is defined similarly to the normal biased sample variance:       Ïƒ  ^   2     superscript   normal-^  Ïƒ   2    \displaystyle\hat{\sigma}^{2}   where     V  1   =    âˆ‘   i  =  1   n    w  i         subscript  V  1     superscript   subscript     i  1    n    subscript  w  i      V_{1}=\sum_{i=1}^{n}w_{i}   , which is 1 for normalized weights. If the weights are frequency weights (and thus are random variables), it can be shown that     Ïƒ  ^   weighted  2     subscript   superscript   normal-^  Ïƒ   2   weighted    \hat{\sigma}^{2}_{\mathrm{weighted}}   is the maximum likelihood estimator of    Ïƒ  2     superscript  Ïƒ  2    \sigma^{2}   for iid Gaussian observations.  For small samples, it is customary to use an unbiased estimator for the population variance. In normal unweighted samples, the N in the denominator (corresponding to the sample size) is changed to N âˆ’Â 1 (see Bessel's correction ). In the weighted setting, there are actually two different unbiased estimators, one for the case of frequency weights and another for the case of reliability weights .  Frequency weights  If the weights are frequency weights , then the unbiased estimator is:      s  2     superscript  s  2    \displaystyle s^{2}     For example, if values    {  2  ,  2  ,  4  ,  5  ,  5  ,  5  }     2  2  4  5  5  5    \{2,2,4,5,5,5\}   are drawn from the same distribution, then we can treat this set as an unweighted sample, or we can treat it as the weighted sample    {  2  ,  4  ,  5  }     2  4  5    \{2,4,5\}   with corresponding weights    {  2  ,  1  ,  3  }     2  1  3    \{2,1,3\}   , and we get the same result either way.  Reliability weights  If the weights are instead non-random ( reliability weights ), we can determine a correction factor to yield an unbiased estimator. Taking expectations we have,      E   [    Ïƒ  ^   2   ]       normal-E   delimited-[]   superscript   normal-^  Ïƒ   2      \displaystyle\mathrm{E}\left[\hat{\sigma}^{2}\right]     where     V  2   =    âˆ‘   i  =  1   n    w  i  2         subscript  V  2     superscript   subscript     i  1    n    superscript   subscript  w  i   2      V_{2}=\sum_{i=1}^{n}w_{i}^{2}   . Therefore, the bias in our estimator is    (   1  -    V  2    V  1  2     )      1     subscript  V  2    superscript   subscript  V  1   2      \left(1-\frac{V_{2}}{V_{1}^{2}}\right)   , analogous to the    (    N  -  1   N   )        N  1   N    \left(\frac{N-1}{N}\right)   bias in the unweighted estimator. This means that to unbias our estimator we need to pre-divide by    1  -   (    V  2   /   V  1  2    )       1     subscript  V  2    superscript   subscript  V  1   2      1-\left(V_{2}/V_{1}^{2}\right)   , ensuring that the expected value of the estimated variance equals the actual variance of the sampling distribution.  The final unbiased estimate of sample variance is:      s  2     superscript  s  2    \displaystyle s^{2}   , 1 where     E   [   s  2   ]    =   Ïƒ  actual  2         normal-E   delimited-[]   superscript  s  2      superscript   subscript  Ïƒ  actual   2     \mathrm{E}\left[s^{2}\right]=\sigma_{\mathrm{actual}}^{2}   .  The degrees of freedom of the weighted, unbiased sample variance vary accordingly from N âˆ’Â 1 down toÂ 0.  The standard deviation is simply the square root of the variance above.  As a side note, other approaches have been described to compute the weighted sample variance. 2  Weighted sample covariance  In a weighted sample, each row vector    ğ±  i     subscript  x  i    \textstyle\textbf{x}_{i}   (each set of single observations on each of the K random variables) is assigned a weight     w  i   â‰¥  0       subscript  w  i   0    \textstyle w_{i}\geq 0   . Without loss of generality, assume that the weights are normalized :        âˆ‘   i  =  1   N    w  i    =  1.        superscript   subscript     i  1    N    subscript  w  i    1.    \sum_{i=1}^{N}w_{i}=1.     If they are not, divide the weights by their sum:       w  i  â€²   =    w  i      âˆ‘   i  =  1   N     w  i          superscript   subscript  w  i   normal-â€²      subscript  w  i     superscript   subscript     i  1    N    subscript  w  i       w_{i}^{\prime}=\frac{w_{i}}{\sum_{i=1}^{N}w_{i}}     Then the weighted mean vector    Î¼  *     superscript  Î¼     \textstyle\mathbf{\mu^{*}}   is given by        Î¼  *   =    âˆ‘   i  =  1   N     w  i    ğ±  i      .       superscript  Î¼      superscript   subscript     i  1    N      subscript  w  i    subscript  ğ±  i       \mathbf{\mu^{*}}=\sum_{i=1}^{N}w_{i}\mathbf{x}_{i}.     (if the weights are not normalized, an equivalent formula to compute the weighted mean is:)        Î¼  *   =     âˆ‘   i  =  1   N     w  i    ğ±  i       âˆ‘   i  =  1   N    w  i      .       superscript  Î¼        superscript   subscript     i  1    N      subscript  w  i    subscript  ğ±  i       superscript   subscript     i  1    N    subscript  w  i       \mathbf{\mu^{*}}=\frac{\sum_{i=1}^{N}w_{i}\mathbf{x}_{i}}{\sum_{i=1}^{N}w_{i}}.     and an unbiased weighted estimate of the covariance matrix   ğšº   ğšº   \textstyle\mathbf{\Sigma}   is: 3 4      Î£  =       âˆ‘   i  =  1   N     w  i       (     âˆ‘   i  =  1   N     w  i    )   2   -     âˆ‘   i  =  1   N     w  i  2        âˆ‘   i  =  1   N     w  i     (    ğ±  i   -   Î¼  *    )   T    (    ğ±  i   -   Î¼  *    )       .      normal-Î£        superscript   subscript     i  1    N    subscript  w  i       superscript    superscript   subscript     i  1    N    subscript  w  i    2     superscript   subscript     i  1    N    superscript   subscript  w  i   2        superscript   subscript     i  1    N      subscript  w  i    superscript     subscript  ğ±  i    superscript  Î¼     T      subscript  ğ±  i    superscript  Î¼          \Sigma=\frac{\sum_{i=1}^{N}w_{i}}{\left(\sum_{i=1}^{N}w_{i}\right)^{2}-\sum_{i%
 =1}^{N}w_{i}^{2}}\sum_{i=1}^{N}w_{i}\left(\mathbf{x}_{i}-\mu^{*}\right)^{T}%
 \left(\mathbf{x}_{i}-\mu^{*}\right).     The reasoning here is the same as in the previous section.  If all weights are the same, i.e.      w  i   /   V  1    =   1  /  N          subscript  w  i    subscript  V  1      1  N     \textstyle w_{i}/V_{1}=1/N   , then the weighted mean and covariance reduce to the unweighted sample mean and covariance above.  Vector-valued estimates  The above generalizes easily to the case of taking the mean of vector-valued estimates. For example, estimates of position on a plane may have less certainty in one direction than another. As in the scalar case, the weighted mean of multiple estimates can provide a maximum likelihood estimate. We simply replace the variance    Ïƒ  2     superscript  Ïƒ  2    \sigma^{2}   by the covariance matrix    Î£   normal-Î£   \Sigma   and the arithmetic inverse by the matrix inverse (both denoted in the same way, via superscripts); the weight matrix then reads: 5        W  i   =   Î£  i   -  1     .       subscript  W  i    superscript   subscript  normal-Î£  i     1      \text{W}_{i}=\Sigma_{i}^{-1}.     The weighted mean in this case is:        ğ±  Â¯   =    Î£   ğ±  Â¯     (    âˆ‘   i  =  1   n     W  i    ğ±  i     )     ,       normal-Â¯  ğ±      subscript  normal-Î£   normal-Â¯  ğ±      superscript   subscript     i  1    n      subscript  W  i    subscript  ğ±  i        \bar{\mathbf{x}}=\Sigma_{\bar{\mathbf{x}}}\left(\sum_{i=1}^{n}\text{W}_{i}%
 \mathbf{x}_{i}\right),     (where the order of the matrix-vector product is not commutative ), in terms of the covariance of the weighted mean:        Î£   ğ±  Â¯    =    (    âˆ‘   i  =  1   n    W  i    )    -  1     ,       subscript  normal-Î£   normal-Â¯  ğ±     superscript    superscript   subscript     i  1    n    subscript  W  i      1      \Sigma_{\bar{\mathbf{x}}}=\left(\sum_{i=1}^{n}\text{W}_{i}\right)^{-1},     For example, consider the weighted mean of the point [1 0] with high variance in the second component and [0 1] with high variance in the first component. Then        ğ±  1   :=    [  10  ]   âŠ¤    ,    Î£  1   :=   [     1    0      0    100     ]       formulae-sequence   assign   subscript  ğ±  1    superscript   delimited-[]  10   top     assign   subscript  normal-Î£  1     1  0    0  100       \mathbf{x}_{1}:=[10]^{\top},\qquad\Sigma_{1}:=\begin{bmatrix}1&0\\
 0&100\end{bmatrix}           ğ±  2   :=    [  01  ]   âŠ¤    ,    Î£  2   :=   [     100    0      0    1     ]       formulae-sequence   assign   subscript  ğ±  2    superscript   delimited-[]  01   top     assign   subscript  normal-Î£  2     100  0    0  1       \mathbf{x}_{2}:=[01]^{\top},\qquad\Sigma_{2}:=\begin{bmatrix}100&0\\
 0&1\end{bmatrix}   then the weighted mean is:       ğ±  Â¯   =     (    Î£  1   -  1    +   Î£  2   -  1     )    -  1     (     Î£  1   -  1     ğ±  1    +    Î£  2   -  1     ğ±  2     )         normal-Â¯  ğ±      superscript     superscript   subscript  normal-Î£  1     1     superscript   subscript  normal-Î£  2     1       1         superscript   subscript  normal-Î£  1     1     subscript  ğ±  1       superscript   subscript  normal-Î£  2     1     subscript  ğ±  2        \bar{\mathbf{x}}=\left(\Sigma_{1}^{-1}+\Sigma_{2}^{-1}\right)^{-1}\left(\Sigma%
 _{1}^{-1}\mathbf{x}_{1}+\Sigma_{2}^{-1}\mathbf{x}_{2}\right)            =    [     0.9901    0      0    0.9901     ]    [     1      1     ]    =   [     0.9901      0.9901     ]         absent      0.9901  0    0  0.9901      1    1            0.9901    0.9901       =\begin{bmatrix}0.9901&0\\
 0&0.9901\end{bmatrix}\begin{bmatrix}1\\
 1\end{bmatrix}=\begin{bmatrix}0.9901\\
 0.9901\end{bmatrix}        which makes sense: the [1 0] estimate is "compliant" in the second component and the [0 1] estimate is compliant in the first component, so the weighted mean is nearly [1 1].  Accounting for correlations  In the general case, suppose that    ğ—  =   [   x  1   ,  â€¦  ,   x  n   ]       ğ—    subscript  x  1   normal-â€¦   subscript  x  n      \mathbf{X}=[x_{1},\dots,x_{n}]   ,   ğ‚   ğ‚   \mathbf{C}   is the covariance matrix relating the quantities    x  i     subscript  x  i    x_{i}   ,    x  Â¯     normal-Â¯  x    \bar{x}   is the common mean to be estimated, and   ğ–   ğ–   \mathbf{W}   is the design matrix [1, ..., 1] (of length   n   n   n   ). The Gaussâ€“Markov theorem states that the estimate of the mean having minimum variance is given by:        Ïƒ   x  Â¯   2   =    (    ğ–  T    ğ‚   -  1    ğ–   )    -  1     ,       subscript   superscript  Ïƒ  2    normal-Â¯  x     superscript     superscript  ğ–  T    superscript  ğ‚    1    ğ–     1      \sigma^{2}_{\bar{x}}=(\mathbf{W}^{T}\mathbf{C}^{-1}\mathbf{W})^{-1},     and        x  Â¯   =    Ïƒ   x  Â¯   2    (    ğ–  T    ğ‚   -  1    ğ—   )     .       normal-Â¯  x      subscript   superscript  Ïƒ  2    normal-Â¯  x       superscript  ğ–  T    superscript  ğ‚    1    ğ—      \bar{x}=\sigma^{2}_{\bar{x}}(\mathbf{W}^{T}\mathbf{C}^{-1}\mathbf{X}).     Decreasing strength of interactions  Consider the time series of an independent variable   x   x   x   and a dependent variable   y   y   y   , with   n   n   n   observations sampled at discrete times    t  i     subscript  t  i    t_{i}   . In many common situations, the value of   y   y   y   at time    t  i     subscript  t  i    t_{i}   depends not only on    x  i     subscript  x  i    x_{i}   but also on its past values. Commonly, the strength of this dependence decreases as the separation of observations in time increases. To model this situation, one may replace the independent variable by its sliding mean   z   z   z   for a window size   m   m   m   .        z  k   =    âˆ‘   i  =  1   m     w  i    x    k  +  1   -  i       .       subscript  z  k     superscript   subscript     i  1    m      subscript  w  i    subscript  x      k  1   i        z_{k}=\sum_{i=1}^{m}w_{i}x_{k+1-i}.         Range weighted mean interpretation     Range (1â€“5)     3.34â€“5.00     1.67â€“3.33     0.00â€“1.66     Exponentially decreasing weights  In the scenario described in the previous section, most frequently the decrease in interaction strength obeys a negative exponential law. If the observations are sampled at equidistant times, then exponential decrease is equivalent to decrease by a constant fraction    0  <  Î”  <  1        0  normal-Î”       1     0<\Delta<1   at each time step. Setting    w  =   1  -  Î”       w    1  normal-Î”     w=1-\Delta   we can define   m   m   m   normalized weights by        w  i   =    w   i  -  1     V  1     ,       subscript  w  i      superscript  w    i  1     subscript  V  1      w_{i}=\frac{w^{i-1}}{V_{1}},   where    V  1     subscript  V  1    V_{1}   is the sum of the unnormalized weights. In this case    V  1     subscript  V  1    V_{1}   is simply        V  1   =    âˆ‘   i  =  1   m    w   i  -  1     =    1  -   w  m     1  -  w     ,         subscript  V  1     superscript   subscript     i  1    m    superscript  w    i  1              1   superscript  w  m      1  w       V_{1}=\sum_{i=1}^{m}{w^{i-1}}=\frac{1-w^{m}}{1-w},   approaching     V  1   =   1  /   (   1  -  w   )         subscript  V  1     1    1  w      V_{1}=1/(1-w)   for large values of   m   m   m   .  The damping constant   w   w   w   must correspond to the actual decrease of interaction strength. If this cannot be determined from theoretical considerations, then the following properties of exponentially decreasing weights are useful in making a suitable choice: at step     (   1  -  w   )    -  1      superscript    1  w     1     (1-w)^{-1}   , the weight approximately equals      e   -  1     (   1  -  w   )    =   0.39   (   1  -  w   )           superscript  e    1      1  w      0.39    1  w      {e^{-1}}(1-w)=0.39(1-w)   , the tail area the value    e   -  1      superscript  e    1     e^{-1}   , the head area     1  -   e   -  1     =  0.61        1   superscript  e    1     0.61    {1-e^{-1}}=0.61   . The tail area at step   n   n   n   is     â‰¤   e   -   n   (   1  -  w   )          absent   superscript  e      n    1  w        \leq{e^{-n(1-w)}}   . Where primarily the closest   n   n   n   observations matter and the effect of the remaining observations can be ignored safely, then choose   w   w   w   such that the tail area is sufficiently small.  Weighted averages of functions  The concept of weighted average can be extended to functions. 6 Weighted averages of functions play an important role in the systems of weighted differential and integral calculus. 7  See also   Average  Mean  Summary statistics  Central tendency  Weight function  Weighted least squares  Weighted average cost of capital  Weighting  Weighted geometric mean  Weighted harmonic mean  Weighted median  Standard deviation   Notes  Further reading      External links     "  Category:Means  Category:Mathematical analysis  Category:Summary statistics     https://www.gnu.org/software/gsl/manual/html_node/Weighted-Samples.html â†©  Weighted Standard Error and its Impact on Significance Testing (WinCross vs. Quantum & SPSS), Dr. Albert Madansky â†©  Mark Galassi, Jim Davies, James Theiler, Brian Gough, Gerard Jungman, Michael Booth, and Fabrice Rossi. GNU Scientific Library - Reference manual, Version 1.15 , 2011. Sec. 21.7 Weighted Samples â†©  George R. Price, Ann. Hum. Genet., Lond, pp485-490, Extension of covariance selection mathematics , 1972. â†©  â†©  G. H. Hardy, J. E. Littlewood, and G. PÃ³lya. Inequalities (2nd ed.), Cambridge University Press, ISBN 978-0-521-35880-4, 1988. â†©  Jane Grossman, Michael Grossman, Robert Katz. [ http://books.google.com/books?as_brr=0&q; ;=%22The+First+Systems+of+Weighted+Differential+and+Integral+Calculus%E2%80%8E%22&btnG;=Search+Books, The First Systems of Weighted Differential and Integral Calculus ], ISBN 0-9771170-1-4, 1980. â†©     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1099">Weighted arithmetic mean</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Weighted arithmetic mean</h1>
<hr/>

<p>The <strong>weighted arithmetic mean</strong> is similar to an ordinary <a href="arithmetic_mean" title="wikilink">arithmetic mean</a> (the most common type of <a class="uri" href="average" title="wikilink">average</a>), except that instead of each of the data points contributing equally to the final average, some data points contribute more than others. The notion of weighted mean plays a role in <a href="descriptive_statistics" title="wikilink">descriptive statistics</a> and also occurs in a more general form in several other areas of mathematics.</p>

<p>If all the weights are equal, then the weighted mean is the same as the <a href="arithmetic_mean" title="wikilink">arithmetic mean</a>. While weighted means generally behave in a similar fashion to arithmetic means, they do have a few counterintuitive properties, as captured for instance in <a href="Simpson's_paradox" title="wikilink">Simpson's paradox</a>.</p>
<h2 id="examples">Examples</h2>
<h3 id="basic-example">Basic example</h3>

<p>Given two school classes, one with 20 students, and one with 30 students, the grades in each class on a test were:</p>
<dl>
<dd>Morning class=62, 67, 71, 74, 76, 77, 78, 79, 79, 80, 80, 81, 81, 82, 83, 84, 86, 89, 93, 98
</dd>
</dl>
<dl>
<dd>Afternoon class=81, 82, 83, 84, 85, 86, 87, 87, 88, 88, 89, 89, 89, 90, 90, 90, 90, 91, 91, 91, 92, 92, 93, 93, 94, 95, 96, 97, 98, 99
</dd>
</dl>

<p>The straight average for the morning class is 80 and the straight average of the afternoon class is 90. The straight average of 80 and 90 is 85, the mean of the two class means. However, this does not account for the difference in number of students in each class (20 versus 30); hence the value of 85 does not reflect the average student grade (independent of class). The average student grade can be obtained by averaging all the grades, without regard to classes (add all the grades up and divide by the total number of students):</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:0">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mfrac>
    <mn>4300</mn>
    <mn>50</mn>
   </mfrac>
   <mo>=</mo>
   <mn>86.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">4300</cn>
      <cn type="integer">50</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">86.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\frac{4300}{50}=86.
  </annotation>
 </semantics>
</math>

</p>

<p>Or, this can be accomplished by weighting the class means by the number of students in each class (using a weighted mean of the class means):</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:1">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>20</mn>
       <mo>×</mo>
       <mn>80</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>30</mn>
       <mo>×</mo>
       <mn>90</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mn>20</mn>
     <mo>+</mo>
     <mn>30</mn>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>86.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">20</cn>
        <cn type="integer">80</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">30</cn>
        <cn type="integer">90</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">20</cn>
       <cn type="integer">30</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">86.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\frac{(20\times 80)+(30\times 90)}{20+30}=86.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, the weighted mean makes it possible to find the average student grade in the case where only the class means and the number of students in each class are available.</p>
<h3 id="convex-combination-examples">Convex combination examples</h3>

<p>Since only the <em>relative</em> weights are relevant, any weighted mean can be expressed using coefficients that sum to one. Such a linear combination is called a <a href="convex_combination" title="wikilink">convex combination</a>.</p>

<p>Using the previous example, we would get the following:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:2">
 <semantics>
  <mrow>
   <mfrac>
    <mn>20</mn>
    <mrow>
     <mn>20</mn>
     <mo>+</mo>
     <mn>30</mn>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0.4</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">20</cn>
     <apply>
      <plus></plus>
      <cn type="integer">20</cn>
      <cn type="integer">30</cn>
     </apply>
    </apply>
    <cn type="float">0.4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{20}{20+30}=0.4\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:3">
 <semantics>
  <mrow>
   <mfrac>
    <mn>30</mn>
    <mrow>
     <mn>20</mn>
     <mo>+</mo>
     <mn>30</mn>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0.6</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">30</cn>
     <apply>
      <plus></plus>
      <cn type="integer">20</cn>
      <cn type="integer">30</cn>
     </apply>
    </apply>
    <cn type="float">0.6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{30}{20+30}=0.6\,
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:4">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>0.4</mn>
      <mo>×</mo>
      <mn>80</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>0.6</mn>
      <mo>×</mo>
      <mn>90</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>86.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="float">0.4</cn>
       <cn type="integer">80</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="float">0.6</cn>
       <cn type="integer">90</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">86.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=(0.4\times 80)+(0.6\times 90)=86.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="mathematical-definition">Mathematical definition</h2>

<p>Formally, the weighted mean of a <a href="non-empty_set" title="wikilink">non-empty set</a> of data</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:5">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{x_{1},x_{2},\dots,x_{n}\},
  </annotation>
 </semantics>
</math>

</p>

<p>with non-negative <a href="weight_function" title="wikilink">weights</a></p>

<p>

<math display="block" id="Weighted_arithmetic_mean:6">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <mrow>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\frac{\sum_{i=1}^{n}w_{i}x_{i}}{\sum_{i=1}^{n}w_{i}},
  </annotation>
 </semantics>
</math>

</p>

<p>which means:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:7">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msub>
        <mi>w</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>w</mi>
        <mn>2</mn>
       </msub>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>w</mi>
        <mi>n</mi>
       </msub>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>w</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>w</mi>
       <mn>2</mn>
      </msub>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <msub>
       <mi>w</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\frac{w_{1}x_{1}+w_{2}x_{2}+\cdots+w_{n}x_{n}}{w_{1}+w_{2}+\cdots+w_{n%
}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore data elements with a high weight contribute more to the weighted mean than do elements with a low weight. The weights cannot be negative. Some may be zero, but not all of them (since division by zero is not allowed).</p>

<p>The formulas are simplified when the weights are normalized such that they sum up to 

<math display="inline" id="Weighted_arithmetic_mean:8">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

, i.e. 

<math display="inline" id="Weighted_arithmetic_mean:9">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}{w_{i}}=1
  </annotation>
 </semantics>
</math>

. For such normalized weights the weighted mean is simply 

<math display="inline" id="Weighted_arithmetic_mean:10">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <msub>
      <mi>w</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\sum_{i=1}^{n}{w_{i}x_{i}}
  </annotation>
 </semantics>
</math>

.</p>

<p>Note that one can always normalize the weights by making the following transformation on the weights 

<math display="inline" id="Weighted_arithmetic_mean:11">
 <semantics>
  <mrow>
   <msubsup>
    <mi>w</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mstyle displaystyle="false">
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
     </mstyle>
     <msub>
      <mi>w</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}^{\prime}=\frac{w_{i}}{\sum_{j=1}^{n}{w_{j}}}
  </annotation>
 </semantics>
</math>

. Using the normalized weight yields the same results as when using the original weights. Indeed,</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:12">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\bar{x}
  </annotation>
 </semantics>
</math>


</p>

<p>The common mean 

<math display="inline" id="Weighted_arithmetic_mean:13">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mi>n</mi>
   </mfrac>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{n}\sum_{i=1}^{n}{x_{i}}
  </annotation>
 </semantics>
</math>

 is a special case of the weighted mean where all data have equal weights, 

<math display="inline" id="Weighted_arithmetic_mean:14">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mi>w</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <ci>w</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}=w
  </annotation>
 </semantics>
</math>

. When the weights are normalized then 

<math display="inline" id="Weighted_arithmetic_mean:15">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>w</mi>
     <mi>i</mi>
     <mo>′</mo>
    </msubsup>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}^{\prime}=\frac{1}{n}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="statistical-properties">Statistical properties</h2>

<p>The weighted sample mean, 

<math display="inline" id="Weighted_arithmetic_mean:16">
 <semantics>
  <mover accent="true">
   <mi>X</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{X}
  </annotation>
 </semantics>
</math>

, with normalized weights (weights summing to one) is itself a random variable. Its expected value and standard deviation are related to the expected values and standard deviations of the observations as follows,</p>

<p>If the observations have expected values</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>X</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mover accent="true">
     <msub>
      <mi>μ</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">¯</mo>
    </mover>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-¯</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(X_{i})=\bar{\mu_{i}},
  </annotation>
 </semantics>
</math>

 then the weighted sample mean has expectation</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>X</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>μ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>μ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\bar{X})=\sum_{i=1}^{n}{w_{i}\mu_{i}}.
  </annotation>
 </semantics>
</math>

 In particular, if the means are equal, 

<math display="inline" id="Weighted_arithmetic_mean:19">
 <semantics>
  <mrow>
   <msub>
    <mi>μ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mi>μ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>μ</ci>
     <ci>i</ci>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{i}=\mu
  </annotation>
 </semantics>
</math>

, then the expectation of the weighted sample mean will be that value,</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>X</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>μ</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <ci>μ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(\bar{X})=\mu.\,
  </annotation>
 </semantics>
</math>

</p>

<p>For uncorrelated observations with variances 

<math display="inline" id="Weighted_arithmetic_mean:21">
 <semantics>
  <msubsup>
   <mi>σ</mi>
   <mi>i</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{i}
  </annotation>
 </semantics>
</math>

, the variance of the weighted sample mean is</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:22">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mover accent="true">
      <mi>X</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msubsup>
       <mi>w</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
      <msubsup>
       <mi>σ</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{\bar{X}}=\sum_{i=1}^{n}{w_{i}^{2}\sigma^{2}_{i}}.
  </annotation>
 </semantics>
</math>

 Consequently,if all the observations have equal variance, 

<math display="inline" id="Weighted_arithmetic_mean:23">
 <semantics>
  <mrow>
   <msubsup>
    <mi>σ</mi>
    <mi>i</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mi>σ</mi>
    <mn>0</mn>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{i}=\sigma^{2}_{0}
  </annotation>
 </semantics>
</math>

, the weighted sample mean will have variance</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:24">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mover accent="true">
      <mi>X</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>σ</mi>
      <mn>0</mn>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <msubsup>
       <mi>w</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{\bar{X}}=\sigma^{2}_{0}\sum_{i=1}^{n}{w_{i}^{2}},
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Weighted_arithmetic_mean:25">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>n</mi>
   </mrow>
   <mo>≤</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msubsup>
     <mi>w</mi>
     <mi>i</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>≤</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/n\leq\sum_{i=1}^{n}{w_{i}^{2}}\leq 1
  </annotation>
 </semantics>
</math>

. It attains its minimum value when all weights are equal, and its maximum when all weights except one are zero. In the former case we have 

<math display="inline" id="Weighted_arithmetic_mean:26">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mover accent="true">
     <mi>X</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>σ</mi>
    <mo>/</mo>
    <msqrt>
     <mi>n</mi>
    </msqrt>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>σ</ci>
     <apply>
      <root></root>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{X}}=\sigma/\sqrt{n}
  </annotation>
 </semantics>
</math>

, which is related to the <a href="central_limit_theorem" title="wikilink">central limit theorem</a>.</p>

<p>Note that due to the fact that one can always transform non-normalized weights to normalized weights all formula in this section can be adapted to non-normalized weights by replacing all 

<math display="inline" id="Weighted_arithmetic_mean:27">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Weighted_arithmetic_mean:28">
 <semantics>
  <mrow>
   <msubsup>
    <mi>w</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mstyle displaystyle="false">
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
     </mstyle>
     <msub>
      <mi>w</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}^{\prime}=\frac{w_{i}}{\sum_{i=1}^{n}{w_{i}}}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="dealing-with-variance">Dealing with variance</h2>

<p>For the weighted mean of a list of data for which each element 

<math display="inline" id="Weighted_arithmetic_mean:29">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}\,\!
  </annotation>
 </semantics>
</math>

 potentially comes from a different <a href="probability_distribution" title="wikilink">probability distribution</a> with known <a class="uri" href="variance" title="wikilink">variance</a> 

<math display="inline" id="Weighted_arithmetic_mean:30">
 <semantics>
  <mpadded width="+1.7pt">
   <msubsup>
    <mi>σ</mi>
    <mi>i</mi>
    <mn>2</mn>
   </msubsup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i}^{2}\,
  </annotation>
 </semantics>
</math>

, one possible choice for the weights is given by:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <msubsup>
      <mi>σ</mi>
      <mi>i</mi>
      <mn>2</mn>
     </msubsup>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>i</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}=\frac{1}{\sigma_{i}^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>The weighted mean in this case is:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:32">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <msubsup>
         <mi>σ</mi>
         <mi>i</mi>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msubsup>
       <mi>σ</mi>
       <mi>i</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\frac{\sum_{i=1}^{n}\left(x_{i}\sigma_{i}^{-2}\right)}{\sum_{i=1}^{n}%
\sigma_{i}^{-2}},
  </annotation>
 </semantics>
</math>

</p>

<p>and the variance of the weighted mean is:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:33">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msubsup>
       <mi>σ</mi>
       <mi>i</mi>
       <mrow>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{x}}^{2}=\frac{1}{\sum_{i=1}^{n}\sigma_{i}^{-2}},
  </annotation>
 </semantics>
</math>

</p>

<p>which reduces to 

<math display="inline" id="Weighted_arithmetic_mean:34">
 <semantics>
  <mrow>
   <msubsup>
    <mi>σ</mi>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mn>0</mn>
     <mn>2</mn>
    </msubsup>
    <mo>/</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{x}}^{2}=\sigma_{0}^{2}/n
  </annotation>
 </semantics>
</math>

 when all 

<math display="inline" id="Weighted_arithmetic_mean:35">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>σ</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i}=\sigma_{0}
  </annotation>
 </semantics>
</math>

.</p>

<p>The two equations above can be combined to obtain:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:36">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>σ</mi>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>/</mo>
       <msubsup>
        <mi>σ</mi>
        <mi>i</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\sigma_{\bar{x}}^{2}\sum_{i=1}^{n}x_{i}/\sigma_{i}^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The significance of this choice is that this weighted mean is the <a href="maximum_likelihood_estimator" title="wikilink">maximum likelihood estimator</a> of the mean of the probability distributions under the assumption that they are independent and <a href="normally_distributed" title="wikilink">normally distributed</a> with the same mean.</p>
<h3 id="correcting-for-over--or-under-dispersion">Correcting for over- or under-dispersion</h3>

<p>Weighted means are typically used to find the weighted mean of experimental data, rather than theoretically generated data. In this case, there will be some error in the variance of each data point. Typically experimental errors may be underestimated due to the experimenter not taking into account all sources of error in calculating the variance of each data point. In this event, the variance in the weighted mean must be corrected to account for the fact that 

<math display="inline" id="Weighted_arithmetic_mean:37">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 is too large. The correction that must be made is</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:38">
 <semantics>
  <mrow>
   <msubsup>
    <mi>σ</mi>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mn>2</mn>
   </msubsup>
   <mo>→</mo>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mpadded width="+1.7pt">
     <msubsup>
      <mi>χ</mi>
      <mi>ν</mi>
      <mn>2</mn>
     </msubsup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>χ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>ν</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{x}}^{2}\rightarrow\sigma_{\bar{x}}^{2}\chi^{2}_{\nu}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Weighted_arithmetic_mean:39">
 <semantics>
  <msubsup>
   <mi>χ</mi>
   <mi>ν</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>χ</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>ν</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}_{\nu}
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Weighted_arithmetic_mean:40">
 <semantics>
  <msup>
   <mi>χ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>χ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \chi^{2}
  </annotation>
 </semantics>
</math>

 divided by the number of degrees of freedom, in this case <em>n</em> − 1. This gives the variance in the weighted mean as:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:41">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>n</mi>
        </msubsup>
        <msubsup>
         <mi>σ</mi>
         <mi>i</mi>
         <mrow>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
      <mo>×</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mfrac>
     </mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <msubsup>
        <mi>σ</mi>
        <mi>i</mi>
        <mn>2</mn>
       </msubsup>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{x}}^{2}=\frac{1}{\sum_{i=1}^{n}\sigma_{i}^{-2}}\times\frac{1}{(n-%
1)}\sum_{i=1}^{n}\frac{(x_{i}-\bar{x})^{2}}{\sigma_{i}^{2}};
  </annotation>
 </semantics>
</math>

</p>

<p>when all data variances are equal, 

<math display="inline" id="Weighted_arithmetic_mean:42">
 <semantics>
  <mrow>
   <msub>
    <mi>σ</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>σ</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{i}=\sigma_{0}
  </annotation>
 </semantics>
</math>

, they cancel out in the weighted mean variance, 

<math display="inline" id="Weighted_arithmetic_mean:43">
 <semantics>
  <msubsup>
   <mi>σ</mi>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>σ</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{x}}^{2}
  </annotation>
 </semantics>
</math>

, which then reduces to the <a href="standard_error_of_the_mean" title="wikilink">standard error of the mean</a> (squared), 

<math display="inline" id="Weighted_arithmetic_mean:44">
 <semantics>
  <mrow>
   <msubsup>
    <mi>σ</mi>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo>/</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{\bar{x}}^{2}=\sigma^{2}/n
  </annotation>
 </semantics>
</math>

, in terms of the <a href="sample_standard_deviation" title="wikilink">sample standard deviation</a> (squared), 

<math display="inline" id="Weighted_arithmetic_mean:45">
 <semantics>
  <mrow>
   <msup>
    <mi>σ</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>σ</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}=\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}/(n-1)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="weighted-sample-variance">Weighted sample variance</h2>

<p>Typically when a mean is calculated it is important to know the <a class="uri" href="variance" title="wikilink">variance</a> and <a href="standard_deviation" title="wikilink">standard deviation</a> about that mean. When a weighted mean 

<math display="inline" id="Weighted_arithmetic_mean:46">
 <semantics>
  <msup>
   <mi>μ</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>μ</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu^{*}
  </annotation>
 </semantics>
</math>

 is used, the variance of the weighted sample is different from the variance of the unweighted sample.</p>

<p>The <em>biased</em> weighted <a href="sample_variance" title="wikilink">sample variance</a> is defined similarly to the normal <em>biased</em> sample variance:</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:47">
 <semantics>
  <msup>
   <mover accent="true">
    <mi>σ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>σ</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\hat{\sigma}^{2}
  </annotation>
 </semantics>
</math>


 where 

<math display="inline" id="Weighted_arithmetic_mean:48">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}=\sum_{i=1}^{n}w_{i}
  </annotation>
 </semantics>
</math>

, which is 1 for normalized weights. If the weights are <em>frequency weights</em> (and thus are random variables), it can be shown that 

<math display="inline" id="Weighted_arithmetic_mean:49">
 <semantics>
  <msubsup>
   <mover accent="true">
    <mi>σ</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mi>weighted</mi>
   <mn>2</mn>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>σ</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>weighted</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\sigma}^{2}_{\mathrm{weighted}}
  </annotation>
 </semantics>
</math>

 is the maximum likelihood estimator of 

<math display="inline" id="Weighted_arithmetic_mean:50">
 <semantics>
  <msup>
   <mi>σ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>σ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}
  </annotation>
 </semantics>
</math>


 for iid Gaussian observations.</p>

<p>For small samples, it is customary to use an <a href="unbiased_estimator" title="wikilink">unbiased estimator</a> for the population variance. In normal unweighted samples, the <em>N</em> in the denominator (corresponding to the sample size) is changed to <em>N</em> − 1 (see <a href="Bessel's_correction" title="wikilink">Bessel's correction</a>). In the weighted setting, there are actually two different unbiased estimators, one for the case of <em>frequency weights</em> and another for the case of <em>reliability weights</em>.</p>
<h3 id="frequency-weights">Frequency weights</h3>

<p>If the weights are <em>frequency weights</em>, then the unbiased estimator is:</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:51">
 <semantics>
  <msup>
   <mi>s</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>s</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle s^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>For example, if values 

<math display="inline" id="Weighted_arithmetic_mean:52">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">2</cn>
    <cn type="integer">2</cn>
    <cn type="integer">4</cn>
    <cn type="integer">5</cn>
    <cn type="integer">5</cn>
    <cn type="integer">5</cn>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{2,2,4,5,5,5\}
  </annotation>
 </semantics>
</math>

 are drawn from the same distribution, then we can treat this set as an unweighted sample, or we can treat it as the weighted sample 

<math display="inline" id="Weighted_arithmetic_mean:53">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>4</mn>
   <mo>,</mo>
   <mn>5</mn>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">2</cn>
    <cn type="integer">4</cn>
    <cn type="integer">5</cn>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{2,4,5\}
  </annotation>
 </semantics>
</math>

 with corresponding weights 

<math display="inline" id="Weighted_arithmetic_mean:54">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">2</cn>
    <cn type="integer">1</cn>
    <cn type="integer">3</cn>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{2,1,3\}
  </annotation>
 </semantics>
</math>

, and we get the same result either way.</p>
<h3 id="reliability-weights">Reliability weights</h3>

<p>If the weights are instead non-random (<em>reliability weights</em>), we can determine a correction factor to yield an unbiased estimator. Taking expectations we have,</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:55">
 <semantics>
  <mrow>
   <mi mathvariant="normal">E</mi>
   <mrow>
    <mo>[</mo>
    <msup>
     <mover accent="true">
      <mi>σ</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mn>2</mn>
    </msup>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-E</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>σ</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathrm{E}\left[\hat{\sigma}^{2}\right]
  </annotation>
 </semantics>
</math>


</p>

<p>where 

<math display="inline" id="Weighted_arithmetic_mean:56">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msubsup>
     <mi>w</mi>
     <mi>i</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{2}=\sum_{i=1}^{n}w_{i}^{2}
  </annotation>
 </semantics>
</math>

. Therefore, the bias in our estimator is 

<math display="inline" id="Weighted_arithmetic_mean:57">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac>
     <msub>
      <mi>V</mi>
      <mn>2</mn>
     </msub>
     <msubsup>
      <mi>V</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
    </mfrac>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(1-\frac{V_{2}}{V_{1}^{2}}\right)
  </annotation>
 </semantics>
</math>

, analogous to the 

<math display="inline" id="Weighted_arithmetic_mean:58">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mfrac>
    <mrow>
     <mi>N</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </mfrac>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <ci>N</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{N-1}{N}\right)
  </annotation>
 </semantics>
</math>

 bias in the unweighted estimator. This means that to unbias our estimator we need to pre-divide by 

<math display="inline" id="Weighted_arithmetic_mean:59">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>V</mi>
      <mn>2</mn>
     </msub>
     <mo>/</mo>
     <msubsup>
      <mi>V</mi>
      <mn>1</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\left(V_{2}/V_{1}^{2}\right)
  </annotation>
 </semantics>
</math>

, ensuring that the expected value of the estimated variance equals the actual variance of the sampling distribution.</p>

<p>The final unbiased estimate of sample variance is:</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:60">
 <semantics>
  <msup>
   <mi>s</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>s</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle s^{2}
  </annotation>
 </semantics>
</math>


,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> where 

<math display="inline" id="Weighted_arithmetic_mean:61">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">E</mi>
    <mrow>
     <mo>[</mo>
     <msup>
      <mi>s</mi>
      <mn>2</mn>
     </msup>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msubsup>
    <mi>σ</mi>
    <mi>actual</mi>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>σ</ci>
      <ci>actual</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{E}\left[s^{2}\right]=\sigma_{\mathrm{actual}}^{2}
  </annotation>
 </semantics>
</math>

.</p>

<p>The degrees of freedom of the weighted, unbiased sample variance vary accordingly from <em>N</em> − 1 down to 0.</p>

<p>The standard deviation is simply the square root of the variance above.</p>

<p>As a side note, other approaches have been described to compute the weighted sample variance.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="weighted-sample-covariance">Weighted sample covariance</h2>

<p>In a weighted sample, each row vector 

<math display="inline" id="Weighted_arithmetic_mean:62">
 <semantics>
  <msub>
   <mtext>𝐱</mtext>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <mtext>x</mtext>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\textbf{x}_{i}
  </annotation>
 </semantics>
</math>

 (each set of single observations on each of the <em>K</em> random variables) is assigned a weight 

<math display="inline" id="Weighted_arithmetic_mean:63">
 <semantics>
  <mrow>
   <msub>
    <mi>w</mi>
    <mi>i</mi>
   </msub>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w_{i}\geq 0
  </annotation>
 </semantics>
</math>

. Without loss of generality, assume that the weights are <a href="Normalizing_constant" title="wikilink">normalized</a>:</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:64">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </msubsup>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{N}w_{i}=1.
  </annotation>
 </semantics>
</math>

</p>

<p>If they are not, divide the weights by their sum:</p>

<p>

<math display="inline" id="Weighted_arithmetic_mean:65">
 <semantics>
  <mrow>
   <msubsup>
    <mi>w</mi>
    <mi>i</mi>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mstyle displaystyle="false">
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </msubsup>
     </mstyle>
     <msub>
      <mi>w</mi>
      <mi>i</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}^{\prime}=\frac{w_{i}}{\sum_{i=1}^{N}w_{i}}
  </annotation>
 </semantics>
</math>

</p>

<p>Then the <a href="weighted_mean" title="wikilink">weighted mean</a> vector 

<math display="inline" id="Weighted_arithmetic_mean:66">
 <semantics>
  <msup>
   <mi>μ</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>μ</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{\mu^{*}}
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:67">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>μ</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>𝐱</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>μ</ci>
     <times></times>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐱</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\mu^{*}}=\sum_{i=1}^{N}w_{i}\mathbf{x}_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>(if the weights are not normalized, an equivalent formula to compute the weighted mean is:)</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:68">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>μ</mi>
     <mo>*</mo>
    </msup>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <mrow>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>𝐱</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>μ</ci>
     <times></times>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\mu^{*}}=\frac{\sum_{i=1}^{N}w_{i}\mathbf{x}_{i}}{\sum_{i=1}^{N}w_{i}}.
  </annotation>
 </semantics>
</math>

</p>

<p>and an <em>unbiased</em> weighted estimate of the covariance matrix 

<math display="inline" id="Weighted_arithmetic_mean:69">
 <semantics>
  <mi>𝚺</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝚺</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\mathbf{\Sigma}
  </annotation>
 </semantics>
</math>

 is:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> 

<math display="inline" id="Weighted_arithmetic_mean:70">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Σ</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mstyle displaystyle="false">
        <msubsup>
         <mo largeop="true" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>N</mi>
        </msubsup>
       </mstyle>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mstyle displaystyle="false">
           <msubsup>
            <mo largeop="true" symmetric="true">∑</mo>
            <mrow>
             <mi>i</mi>
             <mo>=</mo>
             <mn>1</mn>
            </mrow>
            <mi>N</mi>
           </msubsup>
          </mstyle>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <mrow>
        <mstyle displaystyle="false">
         <msubsup>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>i</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>N</mi>
         </msubsup>
        </mstyle>
        <msubsup>
         <mi>w</mi>
         <mi>i</mi>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
     </mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </msubsup>
      <mrow>
       <msub>
        <mi>w</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>𝐱</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msup>
           <mi>μ</mi>
           <mo>*</mo>
          </msup>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mi>T</mi>
       </msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>𝐱</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <msup>
          <mi>μ</mi>
          <mo>*</mo>
         </msup>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Σ</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>N</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>w</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>w</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐱</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>μ</ci>
          <times></times>
         </apply>
        </apply>
        <ci>T</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>μ</ci>
         <times></times>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma=\frac{\sum_{i=1}^{N}w_{i}}{\left(\sum_{i=1}^{N}w_{i}\right)^{2}-\sum_{i%
=1}^{N}w_{i}^{2}}\sum_{i=1}^{N}w_{i}\left(\mathbf{x}_{i}-\mu^{*}\right)^{T}%
\left(\mathbf{x}_{i}-\mu^{*}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The reasoning here is the same as in the previous section.</p>

<p>If all weights are the same, i.e. 

<math display="inline" id="Weighted_arithmetic_mean:71">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo>/</mo>
    <msub>
     <mi>V</mi>
     <mn>1</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle w_{i}/V_{1}=1/N
  </annotation>
 </semantics>
</math>

, then the weighted mean and covariance reduce to the unweighted sample mean and covariance above.</p>
<h2 id="vector-valued-estimates">Vector-valued estimates</h2>

<p>The above generalizes easily to the case of taking the mean of vector-valued estimates. For example, estimates of position on a plane may have less certainty in one direction than another. As in the scalar case, the weighted mean of multiple estimates can provide a <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> estimate. We simply replace the variance 

<math display="inline" id="Weighted_arithmetic_mean:72">
 <semantics>
  <msup>
   <mi>σ</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>σ</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}
  </annotation>
 </semantics>
</math>

 by the <a href="covariance_matrix" title="wikilink">covariance matrix</a> 

<math display="inline" id="Weighted_arithmetic_mean:73">
 <semantics>
  <mi mathvariant="normal">Σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma
  </annotation>
 </semantics>
</math>

 and the <a href="arithmetic_inverse" title="wikilink">arithmetic inverse</a> by the <a href="matrix_inverse" title="wikilink">matrix inverse</a> (both denoted in the same way, via superscripts); the weight matrix then reads:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="Weighted_arithmetic_mean:74">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mtext>W</mtext>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <msubsup>
     <mi mathvariant="normal">Σ</mi>
     <mi>i</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <mtext>W</mtext>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{W}_{i}=\Sigma_{i}^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>The weighted mean in this case is:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:75">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐱</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Σ</mi>
      <mover accent="true">
       <mi>𝐱</mi>
       <mo stretchy="false">¯</mo>
      </mover>
     </msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mrow>
        <msub>
         <mtext>W</mtext>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>𝐱</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>𝐱</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <mtext>W</mtext>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\mathbf{x}}=\Sigma_{\bar{\mathbf{x}}}\left(\sum_{i=1}^{n}\text{W}_{i}%
\mathbf{x}_{i}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>(where the order of the <a href="matrix-vector_product" title="wikilink">matrix-vector product</a> is not <a class="uri" href="commutative" title="wikilink">commutative</a>), in terms of the covariance of the weighted mean:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:76">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mover accent="true">
      <mi>𝐱</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </msub>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msub>
        <mtext>W</mtext>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Σ</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>𝐱</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>W</mtext>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma_{\bar{\mathbf{x}}}=\left(\sum_{i=1}^{n}\text{W}_{i}\right)^{-1},
  </annotation>
 </semantics>
</math>

</p>

<p>For example, consider the weighted mean of the point [1 0] with high variance in the second component and [0 1] with high variance in the first component. Then</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:77">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐱</mi>
     <mn>1</mn>
    </msub>
    <mo>:=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mn>10</mn>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>⊤</mo>
    </msup>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mn>1</mn>
    </msub>
    <mo>:=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>100</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <cn type="integer">10</cn>
      </apply>
      <csymbol cd="latexml">top</csymbol>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <cn type="integer">1</cn>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">1</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">100</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{1}:=[10]^{\top},\qquad\Sigma_{1}:=\begin{bmatrix}1&0\\
0&100\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:78">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐱</mi>
     <mn>2</mn>
    </msub>
    <mo>:=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <mn>01</mn>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo>⊤</mo>
    </msup>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <msub>
     <mi mathvariant="normal">Σ</mi>
     <mn>2</mn>
    </msub>
    <mo>:=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>100</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐱</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <cn type="integer">01</cn>
      </apply>
      <csymbol cd="latexml">top</csymbol>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <matrix>
      <matrixrow>
       <cn type="integer">100</cn>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}_{2}:=[01]^{\top},\qquad\Sigma_{2}:=\begin{bmatrix}100&0\\
0&1\end{bmatrix}
  </annotation>
 </semantics>
</math>

 then the weighted mean is:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:79">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝐱</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Σ</mi>
        <mn>1</mn>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi mathvariant="normal">Σ</mi>
        <mn>2</mn>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Σ</mi>
        <mn>1</mn>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <msub>
        <mi>𝐱</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Σ</mi>
        <mn>2</mn>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msubsup>
       <msub>
        <mi>𝐱</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\mathbf{x}}=\left(\Sigma_{1}^{-1}+\Sigma_{2}^{-1}\right)^{-1}\left(\Sigma%
_{1}^{-1}\mathbf{x}_{1}+\Sigma_{2}^{-1}\mathbf{x}_{2}\right)
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Weighted_arithmetic_mean:80">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>0.9901</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0.9901</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mn>0.9901</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0.9901</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <csymbol cd="latexml">absent</csymbol>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="float">0.9901</cn>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <cn type="float">0.9901</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="float">0.9901</cn>
      </matrixrow>
      <matrixrow>
       <cn type="float">0.9901</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   =\begin{bmatrix}0.9901&0\\
0&0.9901\end{bmatrix}\begin{bmatrix}1\\
1\end{bmatrix}=\begin{bmatrix}0.9901\\
0.9901\end{bmatrix}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>

<p>which makes sense: the [1 0] estimate is "compliant" in the second component and the [0 1] estimate is compliant in the first component, so the weighted mean is nearly [1 1].</p>
<h2 id="accounting-for-correlations">Accounting for correlations</h2>

<p>In the general case, suppose that 

<math display="inline" id="Weighted_arithmetic_mean:81">
 <semantics>
  <mrow>
   <mi>𝐗</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐗</ci>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}=[x_{1},\dots,x_{n}]
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Weighted_arithmetic_mean:82">
 <semantics>
  <mi>𝐂</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐂</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}
  </annotation>
 </semantics>
</math>

 is the <a href="covariance_matrix" title="wikilink">covariance matrix</a> relating the quantities 

<math display="inline" id="Weighted_arithmetic_mean:83">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Weighted_arithmetic_mean:84">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}
  </annotation>
 </semantics>
</math>

 is the common mean to be estimated, and 

<math display="inline" id="Weighted_arithmetic_mean:85">
 <semantics>
  <mi>𝐖</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐖</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{W}
  </annotation>
 </semantics>
</math>

 is the <a href="design_matrix" title="wikilink">design matrix</a> [1, ..., 1] (of length 

<math display="inline" id="Weighted_arithmetic_mean:86">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

). The <a href="Gauss–Markov_theorem" title="wikilink">Gauss–Markov theorem</a> states that the estimate of the mean having minimum variance is given by:</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:87">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐖</mi>
        <mi>T</mi>
       </msup>
       <msup>
        <mi>𝐂</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mi>𝐖</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐖</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐂</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>𝐖</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{\bar{x}}=(\mathbf{W}^{T}\mathbf{C}^{-1}\mathbf{W})^{-1},
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:88">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>σ</mi>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>2</mn>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>𝐖</mi>
        <mi>T</mi>
       </msup>
       <msup>
        <mi>𝐂</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mi>𝐗</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐖</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐂</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>𝐗</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\sigma^{2}_{\bar{x}}(\mathbf{W}^{T}\mathbf{C}^{-1}\mathbf{X}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="decreasing-strength-of-interactions">Decreasing strength of interactions</h2>

<p>Consider the time series of an independent variable 

<math display="inline" id="Weighted_arithmetic_mean:89">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 and a dependent variable 

<math display="inline" id="Weighted_arithmetic_mean:90">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Weighted_arithmetic_mean:91">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 observations sampled at discrete times 

<math display="inline" id="Weighted_arithmetic_mean:92">
 <semantics>
  <msub>
   <mi>t</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{i}
  </annotation>
 </semantics>
</math>

. In many common situations, the value of 

<math display="inline" id="Weighted_arithmetic_mean:93">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

 at time 

<math display="inline" id="Weighted_arithmetic_mean:94">
 <semantics>
  <msub>
   <mi>t</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>t</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{i}
  </annotation>
 </semantics>
</math>

 depends not only on 

<math display="inline" id="Weighted_arithmetic_mean:95">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 but also on its past values. Commonly, the strength of this dependence decreases as the separation of observations in time increases. To model this situation, one may replace the independent variable by its sliding mean 

<math display="inline" id="Weighted_arithmetic_mean:96">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 for a window size 

<math display="inline" id="Weighted_arithmetic_mean:97">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:98">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>z</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>x</mi>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo>-</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{k}=\sum_{i=1}^{m}w_{i}x_{k+1-i}.
  </annotation>
 </semantics>
</math>

</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><a href="Range_(statistics)" title="wikilink">Range</a> weighted mean interpretation</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Range (1–5)</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>3.34–5.00</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1.67–3.33</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>0.00–1.66</p></td>
</tr>
</tbody>
</table>
<h2 id="exponentially-decreasing-weights">Exponentially decreasing weights</h2>

<p>In the scenario described in the previous section, most frequently the decrease in interaction strength obeys a negative exponential law. If the observations are sampled at equidistant times, then exponential decrease is equivalent to decrease by a constant fraction 

<math display="inline" id="Weighted_arithmetic_mean:99">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mi mathvariant="normal">Δ</mi>
   <mo><</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>normal-Δ</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<\Delta<1
  </annotation>
 </semantics>
</math>

 at each time step. Setting 

<math display="inline" id="Weighted_arithmetic_mean:100">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mi mathvariant="normal">Δ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>normal-Δ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w=1-\Delta
  </annotation>
 </semantics>
</math>

 we can define 

<math display="inline" id="Weighted_arithmetic_mean:101">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 normalized weights by</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:102">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>w</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mi>w</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msub>
      <mi>V</mi>
      <mn>1</mn>
     </msub>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <apply>
       <minus></minus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{i}=\frac{w^{i-1}}{V_{1}},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Weighted_arithmetic_mean:103">
 <semantics>
  <msub>
   <mi>V</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}
  </annotation>
 </semantics>
</math>

 is the sum of the unnormalized weights. In this case 

<math display="inline" id="Weighted_arithmetic_mean:104">
 <semantics>
  <msub>
   <mi>V</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}
  </annotation>
 </semantics>
</math>

 is simply</p>

<p>

<math display="block" id="Weighted_arithmetic_mean:105">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>V</mi>
     <mn>1</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <msup>
      <mi>w</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>w</mi>
       <mi>m</mi>
      </msup>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>w</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>w</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>w</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}=\sum_{i=1}^{m}{w^{i-1}}=\frac{1-w^{m}}{1-w},
  </annotation>
 </semantics>
</math>

 approaching 

<math display="inline" id="Weighted_arithmetic_mean:106">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>w</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>w</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{1}=1/(1-w)
  </annotation>
 </semantics>
</math>

 for large values of 

<math display="inline" id="Weighted_arithmetic_mean:107">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

.</p>

<p>The damping constant 

<math display="inline" id="Weighted_arithmetic_mean:108">
 <semantics>
  <mi>w</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>w</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w
  </annotation>
 </semantics>
</math>

 must correspond to the actual decrease of interaction strength. If this cannot be determined from theoretical considerations, then the following properties of exponentially decreasing weights are useful in making a suitable choice: at step 

<math display="inline" id="Weighted_arithmetic_mean:109">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>w</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>w</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1-w)^{-1}
  </annotation>
 </semantics>
</math>

, the weight approximately equals 

<math display="inline" id="Weighted_arithmetic_mean:110">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>w</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>0.39</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>w</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>w</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="float">0.39</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>w</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {e^{-1}}(1-w)=0.39(1-w)
  </annotation>
 </semantics>
</math>

, the tail area the value 

<math display="inline" id="Weighted_arithmetic_mean:111">
 <semantics>
  <msup>
   <mi>e</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-1}
  </annotation>
 </semantics>
</math>

, the head area 

<math display="inline" id="Weighted_arithmetic_mean:112">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mn>0.61</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="float">0.61</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1-e^{-1}}=0.61
  </annotation>
 </semantics>
</math>

. The tail area at step 

<math display="inline" id="Weighted_arithmetic_mean:113">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Weighted_arithmetic_mean:114">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>≤</mo>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>w</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>w</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \leq{e^{-n(1-w)}}
  </annotation>
 </semantics>
</math>

. Where primarily the closest 

<math display="inline" id="Weighted_arithmetic_mean:115">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 observations matter and the effect of the remaining observations can be ignored safely, then choose 

<math display="inline" id="Weighted_arithmetic_mean:116">
 <semantics>
  <mi>w</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>w</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w
  </annotation>
 </semantics>
</math>

 such that the tail area is sufficiently small.</p>
<h2 id="weighted-averages-of-functions">Weighted averages of functions</h2>

<p>The concept of weighted average can be extended to functions.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Weighted averages of functions play an important role in the systems of weighted differential and integral calculus.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Average" title="wikilink">Average</a></li>
<li><a class="uri" href="Mean" title="wikilink">Mean</a></li>
<li><a href="Summary_statistics" title="wikilink">Summary statistics</a></li>
<li><a href="Central_tendency" title="wikilink">Central tendency</a></li>
<li><a href="Weight_function" title="wikilink">Weight function</a></li>
<li><a href="Weighted_least_squares" title="wikilink">Weighted least squares</a></li>
<li><a href="Weighted_average_cost_of_capital" title="wikilink">Weighted average cost of capital</a></li>
<li><a class="uri" href="Weighting" title="wikilink">Weighting</a></li>
<li><a href="Weighted_geometric_mean" title="wikilink">Weighted geometric mean</a></li>
<li><a href="Weighted_harmonic_mean" title="wikilink">Weighted harmonic mean</a></li>
<li><a href="Weighted_median" title="wikilink">Weighted median</a></li>
<li><a href="Standard_deviation" title="wikilink">Standard deviation</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Means" title="wikilink">Category:Means</a> <a href="Category:Mathematical_analysis" title="wikilink">Category:Mathematical analysis</a> <a href="Category:Summary_statistics" title="wikilink">Category:Summary statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a class="uri" href="https://www.gnu.org/software/gsl/manual/html_node/Weighted-Samples.html">https://www.gnu.org/software/gsl/manual/html_node/Weighted-Samples.html</a><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://www.analyticalgroup.com/download/WEIGHTED_MEAN.pdf">Weighted Standard Error and its Impact on Significance Testing (WinCross vs. Quantum &amp; SPSS), Dr. Albert Madansky</a><a href="#fnref2">↩</a></li>
<li id="fn3">Mark Galassi, Jim Davies, James Theiler, Brian Gough, Gerard Jungman, Michael Booth, and Fabrice Rossi. <a href="https://www.gnu.org/software/gsl/manual">GNU Scientific Library - Reference manual, Version 1.15</a>, 2011. <a href="https://www.gnu.org/software/gsl/manual/html_node/Weighted-Samples.html">Sec. 21.7 Weighted Samples</a><a href="#fnref3">↩</a></li>
<li id="fn4">George R. Price, <a href="http://www.dynamics.org/Altenberg/LIBRARY/REPRINTS/Price_extension_AnnHumGenetLond.1972.pdf">Ann. Hum. Genet., Lond, pp485-490, Extension of covariance selection mathematics</a>, 1972.<a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6">G. H. Hardy, J. E. Littlewood, and G. Pólya. <em>Inequalities</em> (2nd ed.), Cambridge University Press, ISBN 978-0-521-35880-4, 1988.<a href="#fnref6">↩</a></li>
<li id="fn7">Jane Grossman, Michael Grossman, Robert Katz. [<a class="uri" href="http://books.google.com/books?as_brr=0&amp;q">http://books.google.com/books?as_brr=0&amp;q;</a>;=%22The+First+Systems+of+Weighted+Differential+and+Integral+Calculus%E2%80%8E%22&amp;btnG;=Search+Books,<em>The First Systems of Weighted Differential and Integral Calculus</em>], ISBN 0-9771170-1-4, 1980.<a href="#fnref7">↩</a></li>
</ol>
</section>
</body>
</html>

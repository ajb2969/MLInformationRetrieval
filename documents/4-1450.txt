   Variation of parameters      Variation of parameters   In mathematics , variation of parameters , also known as variation of constants , is a general method to solve inhomogeneous  linear  ordinary differential equations .  For first-order inhomogeneous linear differential equations it is usually possible to find solutions via integrating factors or undetermined coefficients with considerably less effort, although those methods leverage heuristics that involve guessing and don't work for all inhomogeneous linear differential equations.  Variation of parameters extends to linear partial differential equations as well, specifically to inhomogeneous problems for linear evolution equations like the heat equation , wave equation , and vibrating plate equation. In this setting, the method is more often known as Duhamel's principle , named after Jean-Marie Duhamel who first applied the method to solve the inhomogeneous heat equation. Sometimes variation of parameters itself is called Duhamel's principle and vice versa.  History  The method of variation of parameters was introduced by the Swiss-born mathematician Leonhard Euler (1707–1783) and completed by the Italian-French mathematician Joseph-Louis Lagrange (1736–1813). See:   Forest Ray Moulton, An Introduction to Celestial Mechanics , 2nd ed. (first published by the Macmillan Company in 1914; reprinted in 1970 by Dover Publications, Inc., Mineola, New York), [ http://books.google.com/books?id=URPSrBntwdAC&pg; ;=PA431#v=onepage&q;&f;=false page 431].  Edgar Odell Lovett (1899) [ http://books.google.com/books?id=j7sKAAAAIAAJ&pg; ;=PA47#v=onepage&q;&f;=false "The theory of perturbations and Lie's theory of contact transformations,"] The Quarterly Journal of Pure and Applied Mathematics , vol. 30, pages 47-149; see especially pages 48-61. A forerunner of the method of variation of a celestial body's orbital elements appeared in Euler's work in 1748, while he was studying the mutual perturbations of Jupiter and Saturn. 1 In his 1749 study of the motions of the earth, Euler obtained differential equations for the orbital elements; 2 and in 1753 he applied the method to his study of the motions of the moon. 3 Lagrange first used the method in 1766. 4 Between 1778 and 1783, Lagrange further developed the method both in a series of memoirs on variations in the motions of the planets See:  Lagrange, J.-L. (1781) [ http://books.google.com/books?id=UitRAAAAYAAJ&pg; ;=PA199#v=onepage&q;&f;=false "Théorie des variations séculaires des élémens des Planetes. Premiere partie, … ,"] Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 199-276.  Lagrange, J.-L. (1782) [ http://books.google.com/books?id=kW9PAAAAYAAJ&pg; ;=PA169#v=onepage&q;&f;=false "Théorie des variations séculaires des élémens des Planetes. Seconde partie, … ,"] Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 169-292.  Lagrange, J.-L. (1783) [ http://books.google.com/books?id=Lz7fp3OnutEC&pg; ;=PA161#v=onepage&q;&f;=false "Théorie des variations périodiques des mouvemens des Planetes. Premiere partie, … ,"] Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 161-190. and in another series of memoirs on determining the orbit of a comet from three observations. See:  Lagrange, J.-L. (1778) [ http://books.google.com/books?id=F90_AAAAYAAJ&pg; ;=PA60-IA55#v=onepage&q;&f;=false "Sur le probleme de la détermination des orbites des cometes d'après trois observations, premier mémoire"] (On the problem of determining the orbits of comets from three observations, first memoir), Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 111-123 [published in 1780].  Lagrange, J.-L. (1778) [ http://books.google.com/books?id=F90_AAAAYAAJ&pg; ;=PA60-IA68#v=onepage&q;&f;=false "Sur le probleme de la détermination des orbites des cometes d'après trois observations, second mémoire"], Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 124-161 [published in 1780].  Lagrange, J.-L. (1783) "Sur le probleme de la détermination des orbites des cometes d'après trois observations. Troisième mémoire, dans lequel on donne une solution directe et générale du problème." , Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 296-332 [published in 1785]. (It should be noted that Euler and Lagrange applied this method to nonlinear differential equations and that, instead of varying the coefficients of linear combinations of solutions to homogeneous equations, they varied the constants of the unperturbed motions of the celestial bodies. 5 ) During 1808-1810, Lagrange gave the method of variation of parameters its final form in a series of papers. See:  Lagrange, J.-L. (1808) “Sur la théorie des variations des éléments des planètes et en particulier des variations des grands axes de leurs orbites,” Mémoires de la première Classe de l’Institut de France . Reprinted in: Joseph-Louis Lagrange with Joseph-Alfred Serret, ed., Oeuvres de Lagrange (Paris, France: Gauthier-Villars, 1873), vol. 6, pages 713-768 .  Lagrange, J.-L. (1809) “Sur la théorie générale de la variation des constantes arbitraires dans tous les problèmes de la méchanique,” Mémoires de la première Classe de l’Institut de France . Reprinted in: Joseph-Louis Lagrange with Joseph-Alfred Serret, ed., Oeuvres de Lagrange (Paris, France: Gauthier-Villars, 1873), vol. 6, pages 771-805 .  Lagrange, J.-L. (1810) “Second mémoire sur la théorie générale de la variation des constantes arbitraires dans tous les problèmes de la méchanique, … ,” Mémoires de la première Classe de l’Institut de France . Reprinted in: Joseph-Louis Lagrange with Joseph-Alfred Serret, ed., Oeuvres de Lagrange (Paris, France: Gauthier-Villars, 1873), vol. 6, pages 809-816 . The central result of his study was the system of planetary equations in the form of Lagrange, which described the evolution of the Keplerian parameters (orbital elements) of a perturbed orbit.   In his description of evolving orbits, Lagrange set a reduced two-body problem as an unperturbed solution, and presumed that all perturbations come from the gravitational pull which the bodies other than the primary exert at the secondary (orbiting) body. Accordingly, his method implied that the perturbations depend solely on the position of the secondary, but not on its velocity. In the 20th century, celestial mechanics began to consider interactions which depend on both positions and velocities (relativistic corrections, atmospheric drag, inertial forces). Therefore, the method of variation of parameters used by Lagrange was extended to the situation with velocity-dependent forces. See:   Michael Efroimsky (2005) "Gauge Freedom in Orbital Mechanics." ANYAS, Vol. 1065, pp. 346–374 (2005)  Michael Efroimsky and Peter Goldreich (2004) [ http://www.aanda.org/index.php?option=com_article&access; ;=standard&Itemid;=129&url;=/articles/aa/abs/2004/09/aa0058/aa0058.html "Gauge symmetry of the N-body problem of Celestial Mechanics." Astronomy and Astrophysics, Vol. 415, pp. 1187–1199. (2004)]  Michael Efroimsky and Peter Goldreich (2003) "Gauge symmetry of the N-body problem in the Hamilton-Jacobi approach." Journal of Mathematical Physics, Vol. 44, pp. 5958–5977. (2003)   Description of method  Given an ordinary non-homogeneous linear differential equation of order n       y   (  n  )     (  x  )   +   ∑   i  =  0    n  -  1     a  i    (  x  )    y   (  i  )     (  x  )   =  b   (  x  )   .   (  i  )      fragments   superscript  y  n    fragments  normal-(  x  normal-)     superscript   subscript     i  0      n  1     subscript  a  i    fragments  normal-(  x  normal-)    superscript  y  i    fragments  normal-(  x  normal-)    b   fragments  normal-(  x  normal-)   normal-.  italic-   fragments  normal-(  i  normal-)     y^{(n)}(x)+\sum_{i=0}^{n-1}a_{i}(x)y^{(i)}(x)=b(x).\quad\quad{\rm(i)}     let      y  1    (  x  )    ,  …  ,    y  n    (  x  )          subscript  y  1   x   normal-…     subscript  y  n   x     y_{1}(x),\ldots,y_{n}(x)   be a fundamental system of solutions of the corresponding homogeneous equation         y   (  n  )     (  x  )    +    ∑   i  =  0    n  -  1      a  i    (  x  )    y   (  i  )     (  x  )      =   0.   (  ii  )             superscript  y  n   x     superscript   subscript     i  0      n  1       subscript  a  i   x   superscript  y  i   x      0.  ii     y^{(n)}(x)+\sum_{i=0}^{n-1}a_{i}(x)y^{(i)}(x)=0.\quad\quad{\rm(ii)}     Then a particular solution to the non-homogeneous equation is given by        y  p    (  x  )    =     ∑   i  =  1   n     c  i    (  x  )    y  i    (  x  )      (  iii  )           subscript  y  p   x      superscript   subscript     i  1    n      subscript  c  i   x   subscript  y  i   x    iii     y_{p}(x)=\sum_{i=1}^{n}c_{i}(x)y_{i}(x)\quad\quad{\rm(iii)}     where the     c  i    (  x  )        subscript  c  i   x    c_{i}(x)   are differentiable functions which are assumed to satisfy the conditions         ∑   i  =  1   n     c  i  ′    (  x  )    y  i   (  j  )     (  x  )     =   0    ,   j  =   0  ,  …  ,   n  -  2.    (  iv  )        formulae-sequence      superscript   subscript     i  1    n      superscript   subscript  c  i   normal-′   x   superscript   subscript  y  i   j   x    0     j   0  normal-…    n  2.   iv      \sum_{i=1}^{n}c_{i}^{\prime}(x)y_{i}^{(j)}(x)=0\,\mathrm{,}\quad j=0,\ldots,n-%
 2.\quad\quad{\rm(iv)}     Starting with (iii), repeated differentiation combined with repeated use of (iv) gives         y  p   (  j  )     (  x  )    =    ∑   i  =  1   n     c  i    (  x  )    y  i   (  j  )     (  x  )      ,   j  =   0  ,  …  ,   n  -  1 .    (  v  )        formulae-sequence       superscript   subscript  y  p   j   x     superscript   subscript     i  1    n      subscript  c  i   x   superscript   subscript  y  i   j   x       j   0  normal-…    n  1 .   normal-v      y_{p}^{(j)}(x)=\sum_{i=1}^{n}c_{i}(x)y_{i}^{(j)}(x)\,\mathrm{,}\quad j=0,%
 \ldots,n-1\,\mathrm{.}\quad\quad{\rm(v)}     One last differentiation gives       y  p   (  n  )     (  x  )   =   ∑   i  =  1   n    c  i  ′    (  x  )    y  i   (   n  -  1   )     (  x  )   +   ∑   i  =  1   n    c  i    (  x  )    y  i   (  n  )     (  x  )   .   (  vi  )      fragments   superscript   subscript  y  p   n    fragments  normal-(  x  normal-)     superscript   subscript     i  1    n    superscript   subscript  c  i   normal-′    fragments  normal-(  x  normal-)    superscript   subscript  y  i     n  1     fragments  normal-(  x  normal-)     superscript   subscript     i  1    n    subscript  c  i    fragments  normal-(  x  normal-)    superscript   subscript  y  i   n    fragments  normal-(  x  normal-)   normal-.  italic-   fragments  normal-(  vi  normal-)     y_{p}^{(n)}(x)=\sum_{i=1}^{n}c_{i}^{\prime}(x)y_{i}^{(n-1)}(x)+\sum_{i=1}^{n}c%
 _{i}(x)y_{i}^{(n)}(x)\,\mathrm{.}\quad\quad{\rm(vi)}     By substituting (iii) into (i) and applying (v) and (vi) it follows that       ∑   i  =  1   n    c  i  ′    (  x  )    y  i   (   n  -  1   )     (  x  )   =  b   (  x  )   .   (  vii  )      fragments   superscript   subscript     i  1    n    superscript   subscript  c  i   normal-′    fragments  normal-(  x  normal-)    superscript   subscript  y  i     n  1     fragments  normal-(  x  normal-)    b   fragments  normal-(  x  normal-)   normal-.  italic-   fragments  normal-(  vii  normal-)     \sum_{i=1}^{n}c_{i}^{\prime}(x)y_{i}^{(n-1)}(x)=b(x).\quad\quad{\rm(vii)}     The linear system (iv and vii) of n equations can then be solved using Cramer's rule yielding         c  i  ′    (  x  )    =     W  i    (  x  )     W   (  x  )      ,   i  =   1  ,  …  ,  n       formulae-sequence       superscript   subscript  c  i   normal-′   x        subscript  W  i   x     W  x       i   1  normal-…  n      c_{i}^{\prime}(x)=\frac{W_{i}(x)}{W(x)},\,\quad i=1,\ldots,n     where    W   (  x  )       W  x    W(x)   is the Wronskian determinant of the fundamental system and     W  i    (  x  )        subscript  W  i   x    W_{i}(x)   is the Wronskian determinant of the fundamental system with the i -th column replaced by     (  0  ,  0  ,  …  ,   b   (  x  )    )   .     0  0  normal-…    b  x     (0,0,\ldots,b(x)).     The particular solution to the non-homogeneous equation can then be written as        ∑   i  =  1   n     y  i    (  x  )    ∫       W  i    (  x  )     W   (  x  )      d  x      .      superscript   subscript     i  1    n      subscript  y  i   x           subscript  W  i   x     W  x    normal-d  x       \sum_{i=1}^{n}y_{i}(x)\,\int\frac{W_{i}(x)}{W(x)}\ \mathrm{d}x.     Examples  First order equation        y  ′   +   p   (  x  )   y    =   q   (  x  )           superscript  y  normal-′     p  x  y      q  x     y^{\prime}+p(x)y=q(x)   Solve the corresponding homogeneous equation to find the general solution:        y  ′   +   p   (  x  )   y    =  0         superscript  y  normal-′     p  x  y    0    y^{\prime}+p(x)y=0   . This homogeneous differential equation can be solved by different methods, for example separation of variables :         d   d  x    y   +   p   (  x  )   y    =  0            d    d  x    y     p  x  y    0    \frac{d}{dx}y+p(x)y=0           d  y    d  x    =   -   p   (  x  )   y            d  y     d  x        p  x  y      \frac{dy}{dx}=-p(x)y            d  y   y   =   -   p   (  x  )   d  x     ,          d  y   y       p  x  d  x      {dy\over y}=-{p(x)dx},          ∫     1  y    d  y    =   -   ∫   p   (  x  )   d  x               1  y   d  y          p  x  d  x       \int\frac{1}{y}\,dy=-\int p(x)\,dx          ln   |  y  |    =    -   ∫   p   (  x  )   d  x     +   C  0            y            p  x  d  x      subscript  C  0      \ln|y|=-\int p(x)\,dx+C_{0}         y  =   ±   e    -    ∫   p   (  x  )   d  x      +   C  0      =   C   e   -    ∫   p   (  x  )   d  x              y   plus-or-minus   superscript  e          p  x  d  x      subscript  C  0             C   superscript  e        p  x  d  x          y=\pm e^{-\int p(x)\,dx+C_{0}}=Ce^{-\int p(x)\,dx}   The general solution is therefore:       y  g   =   C   e   -    ∫   p   (  x  )   d  x             subscript  y  g     C   superscript  e        p  x  d  x         y_{g}=Ce^{-\int p(x)\,dx}   Now we have to solve the non-homogeneous equation:        y  ′   +   p   (  x  )   y    =   q   (  x  )           superscript  y  normal-′     p  x  y      q  x     y^{\prime}+p(x)y=q(x)   Using the method variation of parameters, we get the particular solution from the general solution as:       y  p   =   C   (  x  )    e   -    ∫   p   (  x  )   d  x             subscript  y  p     C  x   superscript  e        p  x  d  x         y_{p}=C(x)e^{-\int p(x)\,dx}   By substituting the particular solution into the non-homogeneous equation, we can find C(x):          C  ′    (  x  )    e   -    ∫   p   (  x  )   d  x        -   C   (  x  )   p   (  x  )    e   -    ∫   p   (  x  )   d  x         +   p   (  x  )   C   (  x  )    e   -    ∫   p   (  x  )   d  x         =   q   (  x  )               superscript  C  normal-′   x   superscript  e        p  x  d  x         C  x  p  x   superscript  e        p  x  d  x          p  x  C  x   superscript  e        p  x  d  x          q  x     C^{\prime}(x)e^{-\int p(x)\,dx}-C(x)p(x)e^{-\int p(x)\,dx}+p(x)C(x)e^{-\int p(%
 x)\,dx}=q(x)           C  ′    (  x  )    e   -    ∫   p   (  x  )   d  x        =   q   (  x  )           superscript  C  normal-′   x   superscript  e        p  x  d  x         q  x     C^{\prime}(x)e^{-\int p(x)\,dx}=q(x)           C  ′    (  x  )    =   q   (  x  )    e    ∫   p   (  x  )   d  x              superscript  C  normal-′   x     q  x   superscript  e      p  x  d  x        C^{\prime}(x)=q(x)e^{\int p(x)\,dx}          C   (  x  )    =    ∫   q   (  x  )     e    ∫   p   (  x  )   d  x       d  x    +  C         C  x         q  x   superscript  e      p  x  d  x     d  x    C     C(x)=\int q(x)e^{\int p(x)\,dx}\,dx+C   Therefore the particular solution is:       y  p   =   C   e   -    ∫   p   (  x  )   d  x        ∫   q   (  x  )     e    ∫   p   (  x  )   d  x       d  x          subscript  y  p     C   superscript  e        p  x  d  x          q  x   superscript  e      p  x  d  x     d  x       y_{p}=Ce^{-\int p(x)\,dx}\int q(x)e^{\int p(x)\,dx}\,dx   The final solution of the differential equation is:      y  =    y  g   +   y  p        y     subscript  y  g    subscript  y  p      y=y_{g}+y_{p}         y  =    C   e   -    ∫   p   (  x  )   d  x        ∫   q   (  x  )     e    ∫   p   (  x  )   d  x       d  x     +   C   e   -    ∫   p   (  x  )   d  x             y      C   superscript  e        p  x  d  x          q  x   superscript  e      p  x  d  x     d  x       C   superscript  e        p  x  d  x          y=Ce^{-\int p(x)\,dx}\int q(x)e^{\int p(x)\,dx}\,dx+Ce^{-\int p(x)\,dx}         y  =   C   e   -    ∫   p   (  x  )   d  x        (    ∫   q   (  x  )     e    ∫   p   (  x  )   d  x       d  x    +  1   )        y    C   superscript  e        p  x  d  x            q  x   superscript  e      p  x  d  x     d  x    1      y=Ce^{-\int p(x)\,dx}(\int q(x)e^{\int p(x)\,dx}\,dx+1)     Specific second order equation  Let us solve         y  ′′   +   4   y  ′    +   4  y    =   cosh  x    .         superscript  y  ′′     4   superscript  y  normal-′      4  y      x     y^{\prime\prime}+4y^{\prime}+4y=\cosh{x}.\;\!     We want to find the general solution to the differential equation, that is, we want to find solutions to the homogeneous differential equation        y  ′′   +   4   y  ′    +   4  y    =   0.          superscript  y  ′′     4   superscript  y  normal-′      4  y    0.    y^{\prime\prime}+4y^{\prime}+4y=0.\;\!   From the characteristic equation        λ  2   +   4  λ   +  4   =    (   λ  +  2   )   2   =   0            superscript  λ  2     4  λ   4    superscript    λ  2   2        0     \lambda^{2}+4\lambda+4=(\lambda+2)^{2}=0\;\!         λ  =   -   2.        λ    2.     \lambda=-2.\;\!   Since we have a repeated root, we have to introduce a factor of x for one solution to ensure linear independence.  So, we obtain u 1 = e −2 x , and u 2 = xe −2 x . The Wronskian of these two functions is       |      e   -   2  x        x   e   -   2  x           -   2   e   -   2  x          -    e   -   2  x      (    2  x   -  1   )        |   =    -    e   -   2  x      e   -   2  x      (    2  x   -  1   )     +   2  x   e   -   2  x      e   -   2  x                superscript  e      2  x       x   superscript  e      2  x            2   superscript  e      2  x            superscript  e      2  x         2  x   1               superscript  e      2  x      superscript  e      2  x         2  x   1       2  x   superscript  e      2  x      superscript  e      2  x         \begin{vmatrix}e^{-2x}&xe^{-2x}\\
 -2e^{-2x}&-e^{-2x}(2x-1)\\
 \end{vmatrix}=-e^{-2x}e^{-2x}(2x-1)+2xe^{-2x}e^{-2x}           =    -    e   -   4  x      (    2  x   -  1   )     +   2  x   e   -   4  x       =    (    -   2  x    +  1  +   2  x    )    e   -   4  x      =   e   -   4  x      .        absent         superscript  e      4  x         2  x   1       2  x   superscript  e      4  x                    2  x    1    2  x     superscript  e      4  x            superscript  e      4  x        =-e^{-4x}(2x-1)+2xe^{-4x}=(-2x+1+2x)e^{-4x}=e^{-4x}.\;\!     Because the Wronskian is non-zero, the two functions are linearly independent, so this is in fact the general solution for the homogeneous differential equation (and not a mere subset of it).  We seek functions A ( x ) and B ( x ) so A ( x ) u 1 + B ( x ) u 2 is a general solution of the non-homogeneous equation. We need only calculate the integrals        A   (  x  )    =   -   ∫    1  W    u  2    (  x  )   b   (  x  )   d  x      ,    B   (  x  )    =   ∫    1  W    u  1    (  x  )   b   (  x  )   d  x        formulae-sequence      A  x           1  W    subscript  u  2   x  b  x  normal-d  x          B  x         1  W    subscript  u  1   x  b  x  normal-d  x       A(x)=-\int{1\over W}u_{2}(x)b(x)\,\mathrm{d}x,\;B(x)=\int{1\over W}u_{1}(x)b(x%
 )\,\mathrm{d}x   Recall that that for this example       b   (  x  )    =   cosh  x         b  x     x     b(x)=\cosh{x}   That is,       A   (  x  )    =   -   ∫    1   e   -   4  x      x   e   -   2  x      cosh    x   d  x       =   -   ∫   x   e   2  x     cosh    x   d  x       =    -    1  18    e  x    (    9   (   x  -  1   )    +    e   2  x     (    3  x   -  1   )     )     +   C  1            A  x           1   superscript  e      4  x      x   superscript  e      2  x         x  normal-d  x                  x   superscript  e    2  x        x  normal-d  x                    1  18    superscript  e  x       9    x  1       superscript  e    2  x        3  x   1        subscript  C  1       A(x)=-\int{1\over e^{-4x}}xe^{-2x}\cosh{x}\,\mathrm{d}x=-\int xe^{2x}\cosh{x}%
 \,\mathrm{d}x=-{1\over 18}e^{x}(9(x-1)+e^{2x}(3x-1))+C_{1}          B   (  x  )    =   ∫    1   e   -   4  x       e   -   2  x      cosh    x   d  x      =   ∫    e   2  x     cosh    x   d  x      =     1  6    e  x    (   3  +   e   2  x     )    +   C  2            B  x         1   superscript  e      4  x       superscript  e      2  x         x  normal-d  x                superscript  e    2  x        x  normal-d  x                 1  6    superscript  e  x     3   superscript  e    2  x       subscript  C  2       B(x)=\int{1\over e^{-4x}}e^{-2x}\cosh{x}\,\mathrm{d}x=\int e^{2x}\cosh{x}\,%
 \mathrm{d}x={1\over 6}e^{x}(3+e^{2x})+C_{2}   where    C  1     subscript  C  1    C_{1}   and    C  2     subscript  C  2    C_{2}   are constants of integration.  General second order equation  We have a differential equation of the form        u  ′′   +   p   (  x  )    u  ′    +   q   (  x  )   u    =   f   (  x  )           superscript  u  ′′     p  x   superscript  u  normal-′      q  x  u      f  x     u^{\prime\prime}+p(x)u^{\prime}+q(x)u=f(x)\,   and we define the linear operator      L  =    D  2   +   p   (  x  )   D   +   q   (  x  )         L     superscript  D  2     p  x  D     q  x      L=D^{2}+p(x)D+q(x)\,   where D represents the differential operator . We therefore have to solve the equation     L  u   (  x  )    =   f   (  x  )          L  u  x     f  x     Lu(x)=f(x)   for    u   (  x  )       u  x    u(x)   , where   L   L   L   and    f   (  x  )       f  x    f(x)   are known.  We must solve first the corresponding homogeneous equation:        u  ′′   +   p   (  x  )    u  ′    +   q   (  x  )   u    =   0          superscript  u  ′′     p  x   superscript  u  normal-′      q  x  u    0    u^{\prime\prime}+p(x)u^{\prime}+q(x)u=0\,   by the technique of our choice. Once we've obtained two linearly independent solutions to this homogeneous differential equation (because this ODE is second-order) — call them u 1 and u 2 — we can proceed with variation of parameters.  Now, we seek the general solution to the differential equation     u  G    (  x  )        subscript  u  G   x    u_{G}(x)   which we assume to be of the form         u  G    (  x  )    =    A   (  x  )    u  1    (  x  )    +   B   (  x  )    u  2    (  x  )      .         subscript  u  G   x       A  x   subscript  u  1   x     B  x   subscript  u  2   x      u_{G}(x)=A(x)u_{1}(x)+B(x)u_{2}(x).\,     Here,    A   (  x  )       A  x    A(x)   and    B   (  x  )       B  x    B(x)   are unknown and     u  1    (  x  )        subscript  u  1   x    u_{1}(x)   and     u  2    (  x  )        subscript  u  2   x    u_{2}(x)   are the solutions to the homogeneous equation. (Observe that if    A   (  x  )       A  x    A(x)   and    B   (  x  )       B  x    B(x)   are constants, then     L   u  G    (  x  )    =  0        L   subscript  u  G   x   0    Lu_{G}(x)=0   .) Since the above is only one equation and we have two unknown functions, it is reasonable to impose a second condition. We choose the following:         A  ′    (  x  )    u  1    (  x  )    +    B  ′    (  x  )    u  2    (  x  )     =   0.            superscript  A  normal-′   x   subscript  u  1   x      superscript  B  normal-′   x   subscript  u  2   x    0.    A^{\prime}(x)u_{1}(x)+B^{\prime}(x)u_{2}(x)=0.\,     Now,        u  G  ′    (  x  )    =    (    A   (  x  )    u  1    (  x  )    +   B   (  x  )    u  2    (  x  )     )   ′   =     (   A   (  x  )    u  1    (  x  )    )   ′   +     (   B   (  x  )    u  2    (  x  )    )   ′              superscript   subscript  u  G   normal-′   x    superscript      A  x   subscript  u  1   x     B  x   subscript  u  2   x    normal-′           superscript    A  x   subscript  u  1   x   normal-′    superscript    B  x   subscript  u  2   x   normal-′       u_{G}^{\prime}(x)=(A(x)u_{1}(x)+B(x)u_{2}(x))^{\prime}=(A(x)u_{1}(x))^{\prime}%
 +(B(x)u_{2}(x))^{\prime}\,          =     A  ′    (  x  )    u  1    (  x  )    +   A   (  x  )    u  1  ′    (  x  )    +    B  ′    (  x  )    u  2    (  x  )    +   B   (  x  )    u  2  ′    (  x  )         absent       superscript  A  normal-′   x   subscript  u  1   x     A  x   superscript   subscript  u  1   normal-′   x      superscript  B  normal-′   x   subscript  u  2   x     B  x   superscript   subscript  u  2   normal-′   x      =A^{\prime}(x)u_{1}(x)+A(x)u_{1}^{\prime}(x)+B^{\prime}(x)u_{2}(x)+B(x)u_{2}^{%
 \prime}(x)\,          =     A  ′    (  x  )    u  1    (  x  )    +    B  ′    (  x  )    u  2    (  x  )    +   A   (  x  )    u  1  ′    (  x  )    +   B   (  x  )    u  2  ′    (  x  )         absent       superscript  A  normal-′   x   subscript  u  1   x      superscript  B  normal-′   x   subscript  u  2   x     A  x   superscript   subscript  u  1   normal-′   x     B  x   superscript   subscript  u  2   normal-′   x      =A^{\prime}(x)u_{1}(x)+B^{\prime}(x)u_{2}(x)+A(x)u_{1}^{\prime}(x)+B(x)u_{2}^{%
 \prime}(x)\,   and since we have required the above condition, then we have         u  G  ′    (  x  )    =    A   (  x  )    u  1  ′    (  x  )    +   B   (  x  )    u  2  ′    (  x  )      .         superscript   subscript  u  G   normal-′   x       A  x   superscript   subscript  u  1   normal-′   x     B  x   superscript   subscript  u  2   normal-′   x      u_{G}^{\prime}(x)=A(x)u_{1}^{\prime}(x)+B(x)u_{2}^{\prime}(x).\,   Differentiating again (omitting intermediary steps)         u  G  ′′    (  x  )    =    A   (  x  )    u  1  ′′    (  x  )    +   B   (  x  )    u  2  ′′    (  x  )    +    A  ′    (  x  )    u  1  ′    (  x  )    +    B  ′    (  x  )    u  2  ′    (  x  )      .         superscript   subscript  u  G   ′′   x       A  x   superscript   subscript  u  1   ′′   x     B  x   superscript   subscript  u  2   ′′   x      superscript  A  normal-′   x   superscript   subscript  u  1   normal-′   x      superscript  B  normal-′   x   superscript   subscript  u  2   normal-′   x      u_{G}^{\prime\prime}(x)=A(x)u_{1}^{\prime\prime}(x)+B(x)u_{2}^{\prime\prime}(x%
 )+A^{\prime}(x)u_{1}^{\prime}(x)+B^{\prime}(x)u_{2}^{\prime}(x).\,     Now we can write the action of L upon u G as        L   u  G    =    A   (  x  )   L   u  1    (  x  )    +   B   (  x  )   L   u  2    (  x  )    +    A  ′    (  x  )    u  1  ′    (  x  )    +    B  ′    (  x  )    u  2  ′    (  x  )      .        L   subscript  u  G        A  x  L   subscript  u  1   x     B  x  L   subscript  u  2   x      superscript  A  normal-′   x   superscript   subscript  u  1   normal-′   x      superscript  B  normal-′   x   superscript   subscript  u  2   normal-′   x      Lu_{G}=A(x)Lu_{1}(x)+B(x)Lu_{2}(x)+A^{\prime}(x)u_{1}^{\prime}(x)+B^{\prime}(x%
 )u_{2}^{\prime}(x).\,   Since u 1 and u 2 are solutions, then        L   u  G    =     A  ′    (  x  )    u  1  ′    (  x  )    +    B  ′    (  x  )    u  2  ′    (  x  )      .        L   subscript  u  G         superscript  A  normal-′   x   superscript   subscript  u  1   normal-′   x      superscript  B  normal-′   x   superscript   subscript  u  2   normal-′   x      Lu_{G}=A^{\prime}(x)u_{1}^{\prime}(x)+B^{\prime}(x)u_{2}^{\prime}(x).\,     We have the system of equations         (       u  1    (  x  )        u  2    (  x  )          u  1  ′    (  x  )        u  2  ′    (  x  )       )    (       A  ′    (  x  )          B  ′    (  x  )       )    =   (     0      f     )    .             subscript  u  1   x      subscript  u  2   x        superscript   subscript  u  1   normal-′   x      superscript   subscript  u  2   normal-′   x          superscript  A  normal-′   x        superscript  B  normal-′   x        0    f      \begin{pmatrix}u_{1}(x)&u_{2}(x)\\
 u_{1}^{\prime}(x)&u_{2}^{\prime}(x)\end{pmatrix}\begin{pmatrix}A^{\prime}(x)\\
 B^{\prime}(x)\end{pmatrix}=\begin{pmatrix}0\\
 f\end{pmatrix}.   Expanding,        (        A  ′    (  x  )    u  1    (  x  )    +    B  ′    (  x  )    u  2    (  x  )            A  ′    (  x  )    u  1  ′    (  x  )    +    B  ′    (  x  )    u  2  ′    (  x  )        )   =   (     0      f     )    .             superscript  A  normal-′   x   subscript  u  1   x      superscript  B  normal-′   x   subscript  u  2   x           superscript  A  normal-′   x   superscript   subscript  u  1   normal-′   x      superscript  B  normal-′   x   superscript   subscript  u  2   normal-′   x        0    f      \begin{pmatrix}A^{\prime}(x)u_{1}(x)+B^{\prime}(x)u_{2}(x)\\
 A^{\prime}(x)u_{1}^{\prime}(x)+B^{\prime}(x)u_{2}^{\prime}(x)\end{pmatrix}=%
 \begin{pmatrix}0\\
 f\end{pmatrix}.   So the above system determines precisely the conditions         A  ′    (  x  )    u  1    (  x  )    +    B  ′    (  x  )    u  2    (  x  )     =   0            superscript  A  normal-′   x   subscript  u  1   x      superscript  B  normal-′   x   subscript  u  2   x    0    A^{\prime}(x)u_{1}(x)+B^{\prime}(x)u_{2}(x)=0\,             A  ′    (  x  )    u  1  ′    (  x  )    +    B  ′    (  x  )    u  2  ′    (  x  )     =   L   u  G    =  f   .             superscript  A  normal-′   x   superscript   subscript  u  1   normal-′   x      superscript  B  normal-′   x   superscript   subscript  u  2   normal-′   x      L   subscript  u  G         f     A^{\prime}(x)u_{1}^{\prime}(x)+B^{\prime}(x)u_{2}^{\prime}(x)=Lu_{G}=f.\,     We seek A ( x ) and B ( x ) from these conditions, so, given        (       u  1    (  x  )        u  2    (  x  )          u  1  ′    (  x  )        u  2  ′    (  x  )       )    (       A  ′    (  x  )          B  ′    (  x  )       )    =   (     0      f     )              subscript  u  1   x      subscript  u  2   x        superscript   subscript  u  1   normal-′   x      superscript   subscript  u  2   normal-′   x          superscript  A  normal-′   x        superscript  B  normal-′   x        0    f      \begin{pmatrix}u_{1}(x)&u_{2}(x)\\
 u_{1}^{\prime}(x)&u_{2}^{\prime}(x)\end{pmatrix}\begin{pmatrix}A^{\prime}(x)\\
 B^{\prime}(x)\end{pmatrix}=\begin{pmatrix}0\\
 f\end{pmatrix}   we can solve for ( A ′( x ), B ′( x )) T , so       (       A  ′    (  x  )          B  ′    (  x  )       )   =     (       u  1    (  x  )        u  2    (  x  )          u  1  ′    (  x  )        u  2  ′    (  x  )       )    -  1     (     0      f     )             superscript  A  normal-′   x        superscript  B  normal-′   x        superscript       subscript  u  1   x      subscript  u  2   x        superscript   subscript  u  1   normal-′   x      superscript   subscript  u  2   normal-′   x       1      0    f       \begin{pmatrix}A^{\prime}(x)\\
 B^{\prime}(x)\end{pmatrix}=\begin{pmatrix}u_{1}(x)&u_{2}(x)\\
 u_{1}^{\prime}(x)&u_{2}^{\prime}(x)\end{pmatrix}^{-1}\begin{pmatrix}0\\
 f\end{pmatrix}           =    1  W    (       u  2  ′    (  x  )       -    u  2    (  x  )          -    u  1  ′    (  x  )         u  1    (  x  )       )    (     0      f     )     ,      absent      1  W        superscript   subscript  u  2   normal-′   x        subscript  u  2   x           superscript   subscript  u  1   normal-′   x       subscript  u  1   x       0    f       ={1\over W}\begin{pmatrix}u_{2}^{\prime}(x)&-u_{2}(x)\\
 -u_{1}^{\prime}(x)&u_{1}(x)\end{pmatrix}\begin{pmatrix}0\\
 f\end{pmatrix},   where W denotes the Wronskian of u 1 and u 2 . (We know that W is nonzero, from the assumption that u 1 and u 2 are linearly independent.)  So,         A  ′    (  x  )    =   -    1  W    u  2    (  x  )   f   (  x  )      ,     B  ′    (  x  )    =    1  W    u  1    (  x  )   f   (  x  )        formulae-sequence       superscript  A  normal-′   x         1  W    subscript  u  2   x  f  x          superscript  B  normal-′   x       1  W    subscript  u  1   x  f  x      A^{\prime}(x)=-{1\over W}u_{2}(x)f(x),\;B^{\prime}(x)={1\over W}u_{1}(x)f(x)            A   (  x  )    =   -   ∫    1  W    u  2    (  x  )   f   (  x  )   d  x      ,    B   (  x  )    =   ∫    1  W    u  1    (  x  )   f   (  x  )   d  x      .     formulae-sequence      A  x           1  W    subscript  u  2   x  f  x  normal-d  x          B  x         1  W    subscript  u  1   x  f  x  normal-d  x       A(x)=-\int{1\over W}u_{2}(x)f(x)\,\mathrm{d}x,\;B(x)=\int{1\over W}u_{1}(x)f(x%
 )\,\mathrm{d}x.     While homogeneous equations are relatively easy to solve, this method allows the calculation of the coefficients of the general solution of the in homogeneous equation, and thus the complete general solution of the inhomogeneous equation can be determined.  Note that    A   (  x  )       A  x    A(x)   and    B   (  x  )       B  x    B(x)   are each determined only up to an arbitrary additive constant (the constant of integration ). Adding a constant to    A   (  x  )       A  x    A(x)   or    B   (  x  )       B  x    B(x)   does not change the value of    L   u  G    (  x  )       L   subscript  u  G   x    Lu_{G}(x)   because the extra term is just a linear combination of u 1 and u 2 , which is a solution of   L   L   L   by definition.  References     , pages 186-192, 237-241    External links   Online Notes / Proof by Paul Dawkins, Lamar University .  PlanetMath page .  A NOTE ON LAGRANGE’S METHOD OF VARIATION OF PARAMETERS   "  Category:Ordinary differential equations     Euler, L. (1748) [ http://books.google.com/books?id=GtA6Ea1NlqwC&pg; ;=PA1#v=onepage&q;&f;=false "Recherches sur la question des inégalités du mouvement de Saturne et de Jupiter, sujet proposé pour le prix de l'année 1748, par l’Académie Royale des Sciences de Paris"] [Investigations on the question of the differences in the movement of Saturn and Jupiter; this subject proposed for the prize of 1748 by the Royal Academy of Sciences (Paris)] (Paris, France: G. Martin, J.B. Coignard, & H.L. Guerin, 1749). ↩  Euler, L. (1749) [ http://books.google.com/books?id=xA0_AAAAYAAJ&pg; ;=PA289#v=onepage&q;&f;=false "Recherches sur la précession des équinoxes, et sur la nutation de l’axe de la terre,"] Histoire [or Mémoires ] de l'Académie Royale des Sciences et Belles-lettres (Berlin), pages 289-325 [published in 1751]. ↩  Euler, L. (1753) [ http://books.google.com/books?id=2c9NAAAAMAAJ&pg; ;=PR4#v=onepage&q;&f;=false Theoria motus lunae: exhibens omnes ejus inaequalitates … ] [The theory of the motion of the moon: demonstrating all of its inequalities … ] (Saint Petersburg, Russia: Academia Imperialis Scientiarum Petropolitanae [Imperial Academy of Science (St. Petersburg)], 1753). ↩  Lagrange, J.-L. (1766) [ http://books.google.com/books?id=XwVNAAAAMAAJ&pg; ;=RA1-PA179#v=onepage&q;&f;=false “Solution de différens problèmes du calcul integral,”] Mélanges de philosophie et de mathématique de la Société royale de Turin , vol. 3, pages 179-380. ↩  Michael Efroimsky (2002) "Implicit gauge symmetry emerging in the N-body problem of celestial mechanics," page 3. ↩     
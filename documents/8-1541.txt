   Okamoto–Uchiyama cryptosystem      Okamoto–Uchiyama cryptosystem   The Okamoto–Uchiyama cryptosystem was discovered in 1998 by Tatsuaki Okamoto and Shigenori Uchiyama . The system works in the multiplicative group of integers modulo n ,     (    ℤ  /  n   ℤ   )   *     superscript      ℤ  n   ℤ      (\mathbb{Z}/n\mathbb{Z})^{*}   , where n is of the form p 2 q and p and q are large primes .  Scheme definition  Like many public key cryptosystems , this scheme works in the group     (    ℤ  /  n   ℤ   )   *     superscript      ℤ  n   ℤ      (\mathbb{Z}/n\mathbb{Z})^{*}   . A fundamental difference of this cryptosystem is that here n is a of the form p 2 q , where p and q are large primes . This scheme is homomorphic and hence malleable .  Key generation  A public/private key pair is generated as follows:   Generate large primes p and q and set    n  =    p  2   q       n     superscript  p  2   q     n=p^{2}q   .  Choose    g  ∈    (    ℤ  /  n   ℤ   )   *       g   superscript      ℤ  n   ℤ       g\in(\mathbb{Z}/n\mathbb{Z})^{*}   such that     g  p   ≠   1  mod   p  2         superscript  g  p    modulo  1   superscript  p  2      g^{p}\neq 1\mod p^{2}   .  Let h = g n mod n .   The public key is then ( n , g , h ) and the private key is the factors ( p , q ).  Message encryption  To encrypt a message m , where m is taken to be an element in     ℤ  /  p   ℤ        ℤ  p   ℤ    \mathbb{Z}/p\mathbb{Z}      Select    r  ∈    ℤ  /  n   ℤ       r      ℤ  n   ℤ     r\in\mathbb{Z}/n\mathbb{Z}   at random. Set         C  =     g  m    h  r    mod  n       C   modulo     superscript  g  m    superscript  h  r    n     C=g^{m}h^{r}\mod n        Message decryption  If we define     L   (  x  )    =    x  -  1   p         L  x       x  1   p     L(x)=\frac{x-1}{p}   , then decryption becomes      m  =     L   (    C   p  -  1    mod   p  2    )     L   (    g   p  -  1    mod   p  2    )     mod  p       m   modulo      L   modulo   superscript  C    p  1     superscript  p  2       L   modulo   superscript  g    p  1     superscript  p  2      p     m=\frac{L\left(C^{p-1}\mod p^{2}\right)}{L\left(g^{p-1}\mod p^{2}\right)}\mod p     How the system works  The group        (     \Z   /  n    \Z    )   *   ≃     (    ℤ  /   p  2    ℤ   )   *   ×    (    ℤ  /  q   ℤ   )   *       similar-to-or-equals   superscript      \Z  n   \Z        superscript      ℤ   superscript  p  2    ℤ      superscript      ℤ  q   ℤ        (\Z/n\Z)^{*}\simeq(\mathbb{Z}/p^{2}\mathbb{Z})^{*}\times(\mathbb{Z}/q\mathbb{Z%
 })^{*}   .  The group     (    ℤ  /   p  2    ℤ   )   *     superscript      ℤ   superscript  p  2    ℤ      (\mathbb{Z}/p^{2}\mathbb{Z})^{*}   has a unique subgroup of order p , call it H . By the uniqueness of H , we must have      H  =   {  x  :    x  p   ≡   1  mod  p    }       H   conditional-set  x     superscript  x  p    modulo  1  p       H=\{x:x^{p}\equiv 1\mod p\}   .  For any element x in     (    ℤ  /   p  2    ℤ   )   *     superscript      ℤ   superscript  p  2    ℤ      (\mathbb{Z}/p^{2}\mathbb{Z})^{*}   , we have x p −1 mod p 2 is in H , since p divides x p −1 − 1.  The map L should be thought of as a logarithm from the cyclic group H to the additive group     ℤ  /  p   ℤ        ℤ  p   ℤ    \mathbb{Z}/p\mathbb{Z}   , and it is easy to check that L ( ab ) = L ( a ) + L ( b ), and that the L is an isomorphism between these two groups. As is the case with the usual logarithm, L ( x )/ L ( g ) is, in a sense, the logarithm of x with base g .  We have         (    g  m    h  r    )    p  -  1    =    (    g  m    g   n  r     )    p  -  1    =     (   g   p  -  1    )   m    g   p   (   p  -  1   )   r  p  q     =     (   g   p  -  1    )   m   mod   p  2     .         superscript     superscript  g  m    superscript  h  r      p  1     superscript     superscript  g  m    superscript  g    n  r       p  1            superscript   superscript  g    p  1    m    superscript  g    p    p  1   r  p  q           modulo   superscript   superscript  g    p  1    m    superscript  p  2       (g^{m}h^{r})^{p-1}=(g^{m}g^{nr})^{p-1}=(g^{p-1})^{m}g^{p(p-1)rpq}=(g^{p-1})^{m%
 }\mod p^{2}.     So to recover m we just need to take the logarithm with base g p −1 , which is accomplished by         L   (    (   g   p  -  1    )   m   )     L   (   g   p  -  1    )     =   m  mod  p    .          L   superscript   superscript  g    p  1    m      L   superscript  g    p  1       modulo  m  p     \frac{L\left((g^{p-1})^{m}\right)}{L(g^{p-1})}=m\mod p.     Security  The security of the entire message can be shown to be equivalent to factoring n . The semantic security rests on the p -subgroup assumption, which assumes that it is difficult to determine whether an element x in     (    ℤ  /  n   ℤ   )   *     superscript      ℤ  n   ℤ      (\mathbb{Z}/n\mathbb{Z})^{*}   is in the subgroup of order p . This is very similar to the quadratic residuosity problem and the higher residuosity problem .  References     "  Category:Public-key encryption schemes   
   Direct image functor      Direct image functor   In mathematics , in the field of sheaf theory and especially in algebraic geometry , the direct image functor generalizes the notion of a section of a sheaf to the relative case.  Definition  Let f : X → Y be a continuous mapping of topological spaces , and Sh (–) the category of sheaves of abelian groups on a topological space. The direct image functor       f  *   :    S  h   (  X  )    →   S  h   (  Y  )        normal-:   subscript  f     normal-→    S  h  X     S  h  Y      f_{*}:Sh(X)\to Sh(Y)     sends a sheaf F on X to its direct image presheaf         f  *   F   (  U  )    :=   F   (    f   -  1     (  U  )    )     ,     assign     subscript  f    F  U     F     superscript  f    1    U      f_{*}F(U):=F(f^{-1}(U)),     which turns out be a sheaf on Y .  This assignment is functorial, i.e. a morphism of sheaves φ: F → G on X gives rise to a morphism of sheaves f ∗ (φ): f ∗ ( F ) → f ∗ ( G ) on Y .  Example  If Y is a point, then the direct image equals the global sections functor . Let f: X → Y be a continuous map of topological spaces or a morphism of schemes. Then the exceptional inverse image is a functor f ! : D(Y) → D(X).  Variants  A similar definition applies to sheaves on topoi , such as etale sheaves . Instead of the above preimage f −1 ( U ) the fiber product of U and X over Y is used.  Higher direct images  The direct image functor is left exact, but usually not right exact. Hence one can consider the right derived functors of the direct image. They are called higher direct images and denoted R q f ∗ .  One can show that there is a similar expression as above for higher direct images: for a sheaf F on X , R q f ∗ ( F ) is the sheaf associated to the presheaf       U  ↦    H  q    (    f   -  1     (  U  )    ,  F  )     .     maps-to  U     superscript  H  q       superscript  f    1    U   F      U\mapsto H^{q}(f^{-1}(U),F).     Properties   The direct image functor is right adjoint to the inverse image functor , which means that for any continuous    f  :   X  →  Y      normal-:  f   normal-→  X  Y     f:X\to Y   and sheaves    ℱ  ,  𝒢     ℱ  𝒢    \mathcal{F},\mathcal{G}   respectively on X , Y , there is a natural isomorphism:         Hom   𝐒𝐡   (  X  )      (    f   -  1    𝒢   ,  ℱ  )    =    Hom   𝐒𝐡   (  Y  )      (  𝒢  ,    f  *   ℱ   )           subscript  Hom    𝐒𝐡  X        superscript  f    1    𝒢   ℱ       subscript  Hom    𝐒𝐡  Y     𝒢     subscript  f    ℱ       \mathrm{Hom}_{\mathbf{Sh}(X)}(f^{-1}\mathcal{G},\mathcal{F})=\mathrm{Hom}_{%
 \mathbf{Sh}(Y)}(\mathcal{G},f_{*}\mathcal{F})   .   If f is the inclusion of a closed subspace X ⊂ Y then f ∗ is exact. Actually, in this case f ∗ is an equivalence between sheaves on X and sheaves on Y supported on X . It follows from the fact that the stalk of     (    f  *   ℱ   )   y     subscript     subscript  f    ℱ   y    (f_{*}\mathcal{F})_{y}   is    ℱ  y     subscript  ℱ  y    \mathcal{F}_{y}   if    y  ∈  X      y  X    y\in X   and zero otherwise (here the closeness of X in Y is used).   See also   Proper base change theorem   References    , esp. section II.4   "  Category:Sheaf theory  Category:Continuous mappings   
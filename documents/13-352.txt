   Cnoidal wave      Cnoidal wave   In fluid dynamics , a cnoidal wave is a nonlinear and exact periodic  wave solution of the Korteweg–de Vries equation . These solutions are in terms of the Jacobi elliptic function  cn , which is why they are coined cn oidal waves. They are used to describe surface gravity waves of fairly long wavelength , as compared to the water depth.  The cnoidal wave solutions were derived by Korteweg and de Vries , in their 1895 paper in which they also propose their dispersive long-wave equation, now known as the Korteweg–de Vries equation. In the limit of infinite  wavelength , the cnoidal wave becomes a solitary wave .  The Benjamin–Bona–Mahony equation has improved short- wavelength behaviour, as compared to the Korteweg–de Vries equation, and is another uni-directional wave equation with cnoidal wave solutions. Further, since the Korteweg–de Vries equation is an approximation to the Boussinesq equations for the case of one-way wave propagation , cnoidal waves are approximate solutions to the Boussinesq equations.  Cnoidal wave solutions can appear in other applications than surface gravity waves as well, for instance to describe ion acoustic waves in plasma physics . 1    Background  Korteweg–de Vries, and Benjamin–Bona–Mahony equations  The Korteweg–de Vries equation (KdV equation) can be used to describe the uni-directional propagation of weakly nonlinear and long waves—where long wave means: having long wavelengths as compared with the mean water depth—of surface gravity waves on a fluid layer. The KdV equation is a dispersive wave equation, including both frequency dispersion and amplitude dispersion effects. In its classical use, the KdV equation is applicable for wavelengths λ in excess of about five times the average water depth h , so for λ > 5 h ; and for the period  τ greater than    7    h  /  g        7      h  g      \scriptstyle 7\sqrt{h/g}   with g the strength of the gravitational acceleration . 2 To envisage the position of the KdV equation within the scope of classical wave approximations, it distinguishes itself in the following ways:   Korteweg–de Vries equation — describes the forward propagation of weakly nonlinear and dispersive waves, for long waves with λ > 7 h .  Shallow water equations — are also nonlinear and do have amplitude dispersion, but no frequency dispersion; they are valid for very long waves, λ > 20 h .  Boussinesq equations — have the same range of validity as the KdV equation (in their classical form), but allow for wave propagation in arbitrary directions, so not only forward-propagating waves. The drawback is that the Boussinesq equations are often more difficult to solve than the KdV equation; and in many applications wave reflections are small and may be neglected.  Airy wave theory — has full frequency dispersion, so valid for arbitrary depth and wavelength, but is a linear theory without amplitude dispersion, limited to low-amplitude waves.  Stokes' wave theory — a perturbation-series approach to the description of weakly nonlinear and dispersive waves, especially successful in deeper water for relative short wavelengths, as compared to the water depth. However, for long waves the Boussinesq approach—as also applied in the KdV equation—is often preferred. This is because in shallow water the Stokes' perturbation series needs many terms before convergence towards the solution, due to the peaked crests and long flat troughs of the nonlinear waves. While the KdV or Boussinesq models give good approximations for these long nonlinear waves.   The KdV equation can be derived from the Boussinesq equations, but additional assumptions are needed to be able to split off the forward wave propagation. For practical applications, the Benjamin–Bona–Mahony equation (BBM equation) is preferable over the KdV equation, a forward-propagating model similar to KdV but with much better frequency-dispersion behaviour at shorter wavelengths. Further improvements in short-wave performance can be obtained by starting to derive a one-way wave equation from a modern improved Boussinesq model, valid for even shorter wavelengths. 3  Cnoidal waves  [[ File:Cnoidal wave profiles.svg|thumb|right|400px|Cnoidal wave profiles for three values of the elliptic parameter m .      blue   m = 0,      red   m = 0.9 and      black   m = 0.99999.      ]]  The cnoidal wave solutions of the KdV equation were presented by Korteweg and de Vries in their 1895 paper, which article is based on the PhD thesis by de Vries in 1894. 4 Solitary wave solutions for nonlinear and dispersive long waves had been found earlier by Boussinesq in 1872, and Rayleigh in 1876. The search for these solutions was triggered by the observations of this solitary wave (or "wave of translation") by Russell , both in nature and in laboratory experiments. 5 Cnoidal wave solutions of the KdV equation are stable with respect to small perturbations. 6  The surface elevation η ( x , t ), as a function of horizontal position x and time t , for a cnoidal wave is given by: 7        η   (  x  ,  t  )    =    η  2   +    H      cn  2     (       2   K   (  m  )     x  -    c   t    λ      m     )       ,        η   x  t       subscript  η  2     H    superscript  cn  2       2  K  m      x    c  t    λ    m         \eta(x,t)=\eta_{2}+H\,\operatorname{cn}^{2}\,\left(\begin{array}[]{c|c}%
 \displaystyle 2\,K(m)\,\frac{x-c\,t}{\lambda}&m\end{array}\right),     where H is the wave height , λ is the wavelength , c is the phase speed and η 2 is the trough elevation. Further cn is one of the Jacobi elliptic functions and K ( m ) is the complete elliptic integral of the first kind ; both are dependent on the elliptic parameter m . The latter, m , determines the shape of the cnoidal wave. For m equal to zero the cnoidal wave becomes a cosine function, while for values close to one the cnoidal wave gets peaked crests and (very) flat troughs. For values of m less than 0.95, the cnoidal function can be approximated with trigonometric functions. 8  An important dimensionless parameter for nonlinear long waves ( λ  h ) is the Ursell parameter :       U  =     H    λ  2     h  3    =     H  h      (   λ  h   )   2     .        U      H   superscript  λ  2     superscript  h  3             H  h    superscript    λ  h   2       U=\frac{H\,\lambda^{2}}{h^{3}}=\frac{H}{h}\,\left(\frac{\lambda}{h}\right)^{2}.     For small values of U , say U Due to the way it has been normalised, the Ursell parameter indicates linear theory is applicable when U ≪ 32 ''π 2 / 3 ≈ 100. a linear theory can be used, and at higher values nonlinear theories have to be used, like cnoidal wave theory. The demarcation zone between—third or fifth order—Stokes' and cnoidal wave theories is in the range 10–25 of the Ursell parameter. 9 As can be seen from the formula for the Ursell parameter, for a given relative wave height H / h the Ursell parameter—and thus also the nonlinearity—grows quickly with increasing relative wavelength λ / h .  Based on the analysis of the full nonlinear problem of surface gravity waves within potential flow theory, the above cnoidal waves can be considered the lowest-order term in a perturbation series. Higher-order cnoidal wave theories remain valid for shorter and more nonlinear waves. A fifth-order cnoidal wave theory was developed by Fenton in 1979. 10 A detailed description and comparison of fifth-order Stokes' and fifth-order cnoidal wave theories is given in the review article by Fenton. 11  Cnoidal wave descriptions, through a renormalisation, are also well suited to waves on deep water, even infinite water depth; as found by Clamond. 12 13 A description of the interactions of cnoidal waves in shallow water, as found in real seas, has been provided by Osborne in 1994. 14  Periodic wave solutions  Korteweg–de Vries equation  The Korteweg–de Vries equation (KdV equation), as used for water waves and in dimensional form, is: 15          ∂  t   η   +      g  h       ∂  x   η    +      3  2        g  h      η     ∂  x   η    +      1  6       h  2       g  h       ∂  x  3   η     =  0   ,          subscript   t   η         g  h      subscript   x   η        3  2       g  h    η    subscript   x   η        1  6    superscript  h  2       g  h      superscript   subscript   x   3   η     0    \partial_{t}\eta+\sqrt{gh}\;\partial_{x}\eta+\tfrac{3}{2}\,\sqrt{\frac{g}{h}}%
 \;\eta\,\partial_{x}\eta+\tfrac{1}{6}\,h^{2}\,\sqrt{gh}\;\partial_{x}^{3}\eta=0,     where        η   surface elevation , a function of x and t , with the positive direction upwards (opposing gravity),      x   horizontal coordinate,      t   time,      g   the value of Earth's gravity ,      h   the mean water depth, and      ∂ x and ∂ t   partial derivative operators with respect to x and t .         Non-dimensionalisation   All quantities can be made dimensionless using the gravitational acceleration g and water depth h :        η  ~   =   η  h    ,       normal-~  η     η  h     \tilde{\eta}=\frac{\eta}{h},        x  ~   =   x  h        normal-~  x     x  h     \tilde{x}=\frac{x}{h}   and      t  ~   =      g  h     t    .       normal-~  t         g  h    t     \tilde{t}=\sqrt{\frac{g}{h}}\,t.     The resulting non-dimensional form of the KdV equation is 16          ∂   t  ~     η  ~    +    ∂   x  ~     η  ~    +      3  2       η  ~      ∂   x  ~     η  ~     +      1  6       ∂   x  ~   3    η  ~      =  0   ,          subscript    normal-~  t     normal-~  η      subscript    normal-~  x     normal-~  η        3  2    normal-~  η     subscript    normal-~  x     normal-~  η         1  6     superscript   subscript    normal-~  x    3    normal-~  η      0    \partial_{\tilde{t}}\tilde{\eta}+\partial_{\tilde{x}}\tilde{\eta}+\tfrac{3}{2}%
 \,\tilde{\eta}\,\partial_{\tilde{x}}\tilde{\eta}+\tfrac{1}{6}\,\partial_{%
 \tilde{x}}^{3}\tilde{\eta}=0,     In the remainder, the tildes will be dropped for ease of notation.   Relation to a standard form   The form         ∂   t  ^    ϕ   +    6    ϕ     ∂   x  ^    ϕ    +    ∂   x  ^   3   ϕ    =  0          subscript    normal-^  t    ϕ     6  ϕ    subscript    normal-^  x    ϕ      superscript   subscript    normal-^  x    3   ϕ    0    \partial_{\hat{t}}\phi+6\,\phi\ \partial_{\hat{x}}\phi+\partial_{\hat{x}}^{3}%
 \phi=0     is obtained through the transformation        t  ^   =      1  6     t    ,       normal-^  t       1  6   t     \hat{t}=\tfrac{1}{6}\,t,\,        x  ^   =   x  -   t         normal-^  x     x  t     \hat{x}=x-t\,   and     ϕ  =     3  2    η    ,      ϕ      3  2   η     \phi=\tfrac{3}{2}\,\eta,\,     but this form will not be used any further in this derivation.   Fixed-form propagating waves   Periodic wave solutions, travelling with phase speed  c , are sought. These permanent waves have to be of the following:      η  =   η   (  ξ  )        η    η  ξ     \eta=\eta(\xi)\,   with   ξ   ξ   \xi   the wave phase :     ξ  =   x  -    c   t     .      ξ    x    c  t      \xi=x-c\,t.\,     Consequently, the partial derivatives with respect to space and time become:        ∂  x   η   =    η  ′          subscript   x   η    superscript  η  normal-′     \partial_{x}\eta=\eta^{\prime}\,   and       ∂  t   η   =   -    c    η  ′      ,        subscript   t   η       c   superscript  η  normal-′       \partial_{t}\eta=-c\,\eta^{\prime},\,     where η’ denotes the ordinary derivative of η ( ξ ) with respect to the argument  ξ .  Using these in the KdV equation, the following third-order ordinary differential equation is obtained: 17           1  6      η  ′′′    +    (   1  -  c   )    η  ′    +      3  2      η    η  ′     =   0.             1  6    superscript  η  ′′′        1  c    superscript  η  normal-′        3  2   η   superscript  η  normal-′     0.    \tfrac{1}{6}\,\eta^{\prime\prime\prime}+\left(1-c\right)\,\eta^{\prime}+\tfrac%
 {3}{2}\,\eta\,\eta^{\prime}=0.\,      Integration to a first-order ordinary differential equation   This can be integrated once, to obtain: 18           1  6     η  ′′    +    (   1  -  c   )   η   +      3  4      η  2     =     1  4    r    ,            1  6    superscript  η  ′′        1  c   η       3  4    superscript  η  2         1  4   r     \tfrac{1}{6}\eta^{\prime\prime}+\left(1-c\right)\,\eta+\tfrac{3}{4}\,\eta^{2}=%
 \tfrac{1}{4}r,\,     with r an integration constant . After multiplying with 4 η’ , and integrating once more 19           1  3      (   η  ′   )   2    +    2    (   1  -  c   )    η  2    +   η  3    =     r   η   +  s    ,            1  3    superscript   superscript  η  normal-′   2      2    1  c    superscript  η  2     superscript  η  3        r  η   s     \tfrac{1}{3}\left(\eta^{\prime}\right)^{2}+2\,\left(1-c\right)\,\eta^{2}+\eta^%
 {3}=r\,\eta+s,\,     with s another integration constant. This is written in the form   The cubic polynomial f ( η ) becomes negative for large positive values of η , and positive for large negative values of η . Since the surface elevation η is real valued , also the integration constants r and s are real. The polynomial f can be expressed in terms of its roots  η 1 , η 2 and η 3 : 20   Because f ( η ) is real valued, the three roots η 1 , η 2 and η 3 are either all three real, or otherwise one is real and the remaining two are a pair of complex conjugates . In the latter case, with only one real-valued root, there is only one elevation η at which f ( η ) is zero. And consequently also only one elevation at which the surface slope  η’ is zero. However, we are looking for wave like solutions, with two elevations—the wave crest and trough (physics) —where the surface slope is zero. The conclusion is that all three roots of f ( η ) have to be real valued.  Without loss of generality, it is assumed that the three real roots are ordered as:        η  1   ≥   η  2   ≥   η  3    .         subscript  η  1    subscript  η  2         subscript  η  3      \eta_{1}\geq\eta_{2}\geq\eta_{3}.\,      Solution of the first-order ordinary-differential equation   Now, from equation () it can be seen that only real values for the slope exist if f ( η ) is positive. This corresponds with η 2 ≤ η ≤ η 1 , which therefore is the range between which the surface elevation oscillates, see also the graph of f( η''). This condition is satisfied with the following representation of the elevation η ( ξ ): 21   in agreement with the periodic character of the sought wave solutions and with ψ ( ξ ) the phase of the trigonometric functions sin and cos. From this form, the following descriptions of various terms in equations () and () can be obtained:      η  -   η  1       η   subscript  η  1     \displaystyle\eta-\eta_{1}     Using these in equations () and (), the following ordinary differential equation relating ψ and ξ is obtained, after some manipulations: 22          4  3      (    d  ψ    d  ξ    )   2    =    (    η  1   -   η  3    )   -    (    η  1   -   η  2    )      sin  2    ψ    (  ξ  )      ,          4  3    superscript      d  ψ     d  ξ    2         subscript  η  1    subscript  η  3         subscript  η  1    subscript  η  2      superscript   2   ψ   ξ      \frac{4}{3}\,\left(\frac{\text{d}\psi}{\text{d}\xi}\right)^{2}=\left(\eta_{1}-%
 \eta_{3}\right)-\left(\eta_{1}-\eta_{2}\right)\;\sin^{2}\,\psi(\xi),     with the right hand side still positive, since η 1 − η 3 ≥ η 1 − η 2 . Without loss of generality, we can assume that ψ ( ξ ) is a monotone function, since f ( η ) has no zeros in the interval η 2 1''. So the above ordinary differential equation can also be solved in terms of ξ ( ψ ) being a function of ψ : 23          1  Δ      d  ξ    d  ψ     =   ±   1    1  -   m     sin  2    ψ         ,          1  normal-Δ       d  ξ     d  ψ      plus-or-minus    1      1    m    superscript   2   ψ          \frac{1}{\Delta}\,\frac{\text{d}\xi}{\text{d}\psi}=\pm\,\frac{1}{\sqrt{1-m\sin%
 ^{2}\,\psi}},     with:       Δ  2   =     4  3     1    η  1   -   η  3           superscript  normal-Δ  2       4  3     1     subscript  η  1    subscript  η  3        \Delta^{2}=\frac{4}{3}\,\frac{1}{\eta_{1}-\eta_{3}}   and     m  =     η  1   -   η  2      η  1   -   η  3      ,      m       subscript  η  1    subscript  η  2       subscript  η  1    subscript  η  3       m=\frac{\eta_{1}-\eta_{2}}{\eta_{1}-\eta_{3}},     where m is the so-called elliptic parameter, 24 25 satisfying 0 ≤ m ≤ 1 (because η 3 ≤ η 2 ≤ η 1 ). If ξ = 0 is chosen at the wave crest η (0) = η 1 integration gives 26  {\sqrt{1 - m\, \sin^2 \hat{\psi}}} = \pm\, \Delta\, F(\psi|m),| D }}  with F ( ψ | m ) the incomplete elliptic integral of the first kind . The Jacobi elliptic functions cn and sn are inverses of F ( ψ | m ) given by        cos   ψ   =   cn   (      ξ  Δ     m     )          ψ    cn      ξ  normal-Δ   m       \cos\,\psi=\operatorname{cn}\left(\begin{array}[]{c|c}\displaystyle\frac{\xi}{%
 \Delta}&m\end{array}\right)   and       sin   ψ   =   sn   (       ξ  Δ      m     )     .        ψ    sn      ξ  normal-Δ   m       \sin\,\psi=\operatorname{sn}\left(\begin{array}[]{c|c}\displaystyle\frac{\xi}{%
 \Delta}&m\end{array}\right).     With the use of equation (), the resulting cnoidal-wave solution of the KdV equation is found 27        η   (  ξ  )    =    η  2   +    (    η  1   -   η  2    )     cn  2    (      ξ  Δ     m     )       .        η  ξ      subscript  η  2        subscript  η  1    subscript  η  2      superscript  cn  2       ξ  normal-Δ   m         \eta(\xi)=\eta_{2}+\left(\eta_{1}-\eta_{2}\right)\,\operatorname{cn}^{2}\left(%
 \begin{array}[]{c|c}\displaystyle\frac{\xi}{\Delta}&m\end{array}\right).     What remains, is to determine the parameters: η 1 , η 2 , Δ and m .   Relationships between the cnoidal-wave parameters   First, since η 1 is the crest elevation and η 2 is the trough elevation, it is convenient to introduce the wave height , defined as H = η 1 − η 2 . Consequently, we find for m and for Δ :      m  =   H    η  1   -   η  3         m    H     subscript  η  1    subscript  η  3       m=\frac{H}{\eta_{1}-\eta_{3}}   and      Δ  2   m   =   4    3   H           superscript  normal-Δ  2   m     4    3  H      \frac{\Delta^{2}}{m}=\frac{4}{3\,H}   so     Δ  =     4  3    m  H      .      normal-Δ        4  3     m  H       \Delta=\sqrt{\frac{4}{3}\frac{m}{H}}.     The cnoidal wave solution can be written as:        η   (  ξ  )    =    η  2   +    H     cn  2    (      ξ  Δ     m     )       .        η  ξ      subscript  η  2     H    superscript  cn  2       ξ  normal-Δ   m         \eta(\xi)=\eta_{2}+H\,\operatorname{cn}^{2}\left(\begin{array}[]{c|c}%
 \displaystyle\frac{\xi}{\Delta}&m\end{array}\right).     Second, the trough is located at ψ = ½ π , so the distance between ξ = 0 and ξ = ½ λ is, with λ the wavelength , from equation ():           1  2     λ   =    Δ   F   (         1  2     π     m     )    =    Δ   K   (  m  )     ,            1  2   λ     normal-Δ  F        1  2   π   m            normal-Δ  K  m      \tfrac{1}{2}\,\lambda=\Delta\,F\left(\begin{array}[]{c|c}\tfrac{1}{2}\,\pi&m%
 \end{array}\right)=\Delta\,K(m),   giving     λ  =    2    Δ   K   (  m  )    =       16  3    m  H      K   (  m  )     ,        λ    2  normal-Δ  K  m                16  3     m  H     K  m      \lambda=2\,\Delta\,K(m)=\sqrt{\frac{16}{3}\frac{m}{H}}\;K(m),     where K ( m ) is the complete elliptic integral of the first kind . Third, since the wave oscillates around the mean water depth, the average value of η ( ξ ) has to be zero. So 28     0   0   \displaystyle 0     where E ( m ) is the complete elliptic integral of the second kind . The following expressions for η 1 , η 2 and η 3 as a function of the elliptic parameter m and wave height H result: 29        η  3   =   -     H  m      E   (  m  )     K   (  m  )        ,       subscript  η  3         H  m       E  m     K  m        \eta_{3}=-\,\frac{H}{m}\,\frac{E(m)}{K(m)},        η  1   =     H  m     (   1  -    E   (  m  )     K   (  m  )      )         subscript  η  1       H  m     1      E  m     K  m        \eta_{1}=\frac{H}{m}\,\left(1-\frac{E(m)}{K(m)}\right)   and      η  2   =     H  m     (   1  -  m  -    E   (  m  )     K   (  m  )      )     .       subscript  η  2       H  m     1  m      E  m     K  m        \eta_{2}=\frac{H}{m}\,\left(1-m-\frac{E(m)}{K(m)}\right).     Fourth, from equations () and () a relationship can be established between the phase speed  c and the roots η 1 , η 2 and η 3 : 30       c  =   1  +      1  2      (    η  1   +   η  2   +   η  3    )     =   1  +     H  m     (   1  -     1  2    m   -     3  2      E   (  m  )     K   (  m  )       )      .        c    1      1  2      subscript  η  1    subscript  η  2    subscript  η  3             1      H  m     1      1  2   m       3  2       E  m     K  m           c=1+\tfrac{1}{2}\,\left(\eta_{1}+\eta_{2}+\eta_{3}\right)=1+\frac{H}{m}\,\left%
 (1-\frac{1}{2}\,m-\frac{3}{2}\,\frac{E(m)}{K(m)}\right).     The relative phase-speed changes are depicted in the figure below. As can be seen, for m > 0.96 (so for 1 − m c = \frac{\lambda}{\tau}.   Résumé of the solution   All quantities here will be given in their dimensional forms, as valid for surface gravity waves before non-dimensionalisation .  (Figure)  Relative phase speed increase of cnoidal wave solutions for the Korteweg–de Vries equation as a function of 1− m , with m the elliptic parameter. The horizontal axis is on a logarithmic scale , from 10 −6 to 10 0 =1. The figure is for non-dimensional quantities, i.e. the phase speed c is made dimensionless with the shallow-water phase speed     g  h         g  h     \scriptstyle\sqrt{gh}   , and the wave height H is made dimensionless with the mean water depth h .   The cnoidal-wave solution of the KdV equation is: 31        η   (  x  ,  t  )    =    η  2   +    H     cn  2    (       x  -    c   t    Δ     m     )       ,        η   x  t       subscript  η  2     H    superscript  cn  2         x    c  t    normal-Δ   m         \eta(x,t)=\eta_{2}+H\,\operatorname{cn}^{2}\left(\begin{array}[]{c|c}%
 \displaystyle\frac{x-c\,t}{\Delta}&m\end{array}\right),     with H the wave height —the difference between crest and trough elevation, η 2 the trough elevation, m the elliptic parameter, c the phase speed and cn one of the Jacobi elliptic functions . The trough level η 2 and width parameter Δ can be expressed in terms of H , h and m : 32        η  2   =     H  m     (   1  -  m  -    E   (  m  )     K   (  m  )      )     ,       subscript  η  2       H  m     1  m      E  m     K  m        \eta_{2}=\frac{H}{m}\,\left(1-m-\frac{E(m)}{K(m)}\right),   and     Δ  =    λ    2   K   (  m  )      =    h      4  3      m   h   H       ,        normal-Δ    λ    2  K  m           h        4  3       m  h   H         \Delta=\frac{\lambda}{2\,K(m)}\,=h\,\sqrt{\frac{4}{3}\frac{m\,h}{H}},     with K ( m ) the complete elliptic integral of the first kind and E ( m ) the complete elliptic integral of the second kind . Note that K ( m ) and E ( m ) are denoted here as a function of the elliptic parameter m and not as a function of the elliptic modulus k , with m = k 2 .  The wavelength  λ , phase speed c and wave period  τ are related to H , h and m by: 33       λ  =    h       16  3      m   h   H      K   (  m  )     ,      λ    h        16  3       m  h   H     K  m     \lambda=h\,\sqrt{\frac{16}{3}\frac{m\,h}{H}}\;K(m),       c  =      g  h      [   1  +     H    m   h      (   1  -     1  2    m   -     3  2      E   (  m  )     K   (  m  )       )     ]        c        g  h     delimited-[]    1      H    m  h      1      1  2   m       3  2       E  m     K  m            c=\sqrt{gh}\,\left[1+\frac{H}{m\,h}\,\left(1-\frac{1}{2}\,m-\frac{3}{2}\,\frac%
 {E(m)}{K(m)}\right)\right]   and     τ  =   λ  c    ,      τ    λ  c     \tau=\frac{\lambda}{c},     with g the Earth's gravity .  Most often, the known wave parameters are the wave height H , mean water depth h , gravitational acceleration g , and either the wavelength λ or else the period τ . Then the above relations for λ , c and τ are used to find the elliptic parameter m . This requires numerical solution by some iterative method . 34  Benjamin–Bona–Mahony equation  The Benjamin–Bona–Mahony equation (BBM equation), or regularised long wave (RLW) equation, is in dimensional form given by: 35          ∂  t   η   +       g   h       ∂  x   η    +      3  2        g  h      η     ∂  x   η     -      1  6       h  2        ∂  t     ∂  x  2    η     =  0.            subscript   t   η         g  h      subscript   x   η        3  2       g  h    η    subscript   x   η         1  6    superscript  h  2      subscript   t    superscript   subscript   x   2    η     0.    \partial_{t}\eta+\sqrt{g\,h}\,\partial_{x}\eta+\tfrac{3}{2}\,\sqrt{\frac{g}{h}%
 }\,\eta\,\partial_{x}\eta-\tfrac{1}{6}\,h^{2}\,\partial_{t}\,\partial_{x}^{2}%
 \eta=0.     All quantities have the same meaning as for the KdV equation. The BBM equation is often preferred over the KdV equation because it has a better short-wave behaviour. 36   Derivation   The derivation is analogous to the one for the KdV equation. 37 The dimensionless BBM equation is, non-dimensionalised using mean water depth h and gravitational acceleration g : 38          ∂  t   η   +    ∂  x   η   +      3  2      η     ∂  x   η     -      1  6         ∂  t     ∂  x  2    η     =  0.            subscript   t   η     subscript   x   η       3  2   η    subscript   x   η         1  6      subscript   t    superscript   subscript   x   2    η     0.    \partial_{t}\eta+\partial_{x}\eta+\tfrac{3}{2}\,\eta\,\partial_{x}\eta-\tfrac{%
 1}{6}\,\partial_{t}\,\partial_{x}^{2}\eta=0.     This can be brought into the standard form          ∂   t  ^    φ   +    ∂   x  ^    φ   +    φ     ∂   x  ^    φ     -      ∂   t  ^      ∂   x  ^   2    φ    =   0             subscript    normal-^  t    φ     subscript    normal-^  x    φ     φ    subscript    normal-^  x    φ        subscript    normal-^  t     superscript   subscript    normal-^  x    2    φ    0    \partial_{\hat{t}}\varphi+\partial_{\hat{x}}\varphi+\varphi\,\partial_{\hat{x}%
 }\varphi-\partial_{\hat{t}}\,\partial_{\hat{x}}^{2}\varphi=0\,     through the transformation:        t  ^   =     6    t    ,       normal-^  t       6   t     \hat{t}=\sqrt{6}\,t,        x  ^   =     6    x        normal-^  x       6   x     \hat{x}=\sqrt{6}\,x   and     φ  =     3  2    η    ,      φ      3  2   η     \varphi=\tfrac{3}{2}\,\eta,     but this standard form will not be used here.  Analogue to the drivation of the cnoidal wave solution for the KdV equation, periodic wave solutions η ( ξ ), with ξ = x − ct are considered Then the BBM equation becomes a third-order ordinary differential equation, which can be integrated twice, to obtain:          1  3      c     (   η  ′   )   2    =   f   (  η  )            1  3   c   superscript   superscript  η  normal-′   2      f  η     \tfrac{1}{3}\,c\,\left(\eta^{\prime}\right)^{2}=f(\eta)\,   with      f   (  η  )    =    -   η  3    +    2    (   c  -  1   )    η  2    +    r   η   +  s    .        f  η        superscript  η  3      2    c  1    superscript  η  2      r  η   s     f(\eta)=-\eta^{3}+2\,\left(c-1\right)\,\eta^{2}+r\,\eta+s.\,     Which only differs from the equation for the KdV equation through the factor c in front of ( η′ ) 2 in the left hand side. Through a coordinate transformation β = ξ /    c      c    \scriptstyle\sqrt{c}   the factor c may be removed, resulting in the same first-order ordinary differential equation for both the KdV and BBM equation. However, here the form given in the preceding equation is used. This results in a different formulation for Δ as found for the KdV equation:       Δ  =     4  3      m   c   H      .      normal-Δ        4  3       m  c   H       \Delta=\sqrt{\frac{4}{3}\frac{m\,c}{H}}.     The relation of the wavelength λ , as a function of H and m , is affected by this change in    Δ  :      normal-:  normal-Δ  absent    \Delta:          λ  =        16  3       m   c   H      K   (  m  )     .      λ          16  3       m  c   H     K  m     \lambda=\sqrt{\frac{16}{3}\,\frac{m\,c}{H}}\;K(m).     For the rest, the derivation is analogous to the one for the KdV equation, and will not be repeated here.   Résumé   The results are presented in dimensional form, for water waves on a fluid layer of depth h .  The cnoidal wave solution of the BBM equation, together with the associated relationships for the parameters is: 39      η   (  x  ,  t  )       η   x  t     \displaystyle\eta(x,t)     The only difference with the cnoidal wave solution of the KdV equation is in the equation for the wavelength  λ . 40 For practical applications, usually the water depth h , wave height  H , gravitational acceleration  g , and either the wavelength  λ , or—most often—the period (physics)  τ are provided. Then the elliptic parameter m has to be determined from the above relations for λ , c and τ through some iterative method . 41  Example  (Figure)  Parameter relations for cnoidal wave solutions of the Korteweg–de Vries equation. Shown is −log 10 (1− m ), with m the elliptic parameter of the complete elliptic integrals , 42 as a function of dimensionless period  τ √( g / h ) and relative wave height  H / h . The values along the contour lines are −log 10 (1− m ), so a value 1 corresponds with m = 1 − 10 −1 = 0.9 and a value 40 with m = 1 − 10 −40 .   In this example, a cnoidal wave according to the Korteweg–de Vries (KdV) equation is considered. The following parameters of the wave are given:   mean water depth h = ,  wave height  H = ,  wave period  τ = 7 s , and  gravitational acceleration  g = 9.81 m/s 2 (32 ft/s 2 ).   Instead of the period τ , in other cases the wavelength  λ may occur as a quantity known beforehand.  First, the dimensionless period is computed:         τ     g  h     =  9.80   ,        τ      g  h     9.80    \tau\,\sqrt{\frac{g}{h}}=9.80,     which is larger than seven, so long enough for cnoidal theory to be valid. The main unknown is the elliptic parameter m . This has to be determined in such a way that the wave period τ , as computed from cnoidal wave theory for the KdV equation:       λ  =    h       16  3      m   h   H      K   (  m  )     ,      λ    h        16  3       m  h   H     K  m     \lambda=h\,\sqrt{\frac{16}{3}\frac{m\,h}{H}}\;K(m),       c  =      g  h      [   1  +     H    m   h      (   1  -     1  2    m   -     3  2      E   (  m  )     K   (  m  )       )     ]        c        g  h     delimited-[]    1      H    m  h      1      1  2   m       3  2       E  m     K  m            c=\sqrt{gh}\,\left[1+\frac{H}{m\,h}\,\left(1-\frac{1}{2}\,m-\frac{3}{2}\,\frac%
 {E(m)}{K(m)}\right)\right]   and     τ  =   λ  c    ,      τ    λ  c     \tau=\frac{\lambda}{c},     is consistent with the given value of τ ; here λ is the wavelength and c is the phase speed of the wave. Further, K ( m ) and E ( m ) are complete elliptic integrals of the first and second kind, respectively. Searching for the elliptic parameter m can be done by trial and error , or by use of a numerical root-finding algorithm . In this case, starting from an initial guess m init = 0.99, by trial and error the answer      m  =   0.9832       m  0.9832    m=0.9832\,     is found. Within the process, the wavelength λ and phase speed c have been computed:   wavelength λ = , and  phase speed c = .   The phase speed c can be compared with its value     g  h         g  h     \scriptstyle\sqrt{gh}   according to the shallow water equations :        c     g   h     =  1.0376   ,        c      g  h     1.0376    \frac{c}{\sqrt{g\,h}}=1.0376,     showing a 3.8% increase due to the effect of nonlinear amplitude  dispersion , which wins in this case from the reduction of phase speed by frequency dispersion.  Now the wavelength is known, the Ursell number can be computed as well:       U  =     H    λ  2     h  3    =  62   ,        U      H   superscript  λ  2     superscript  h  3         62     U=\frac{H\,\lambda^{2}}{h^{3}}=62,     which is not small, so linear wave theory is not applicable, but cnoidal wave theory is. Finally, the ratio of wavelength to depth is λ / h = 10.2 > 7, again indicating this wave is long enough to being considered as a cnoidal wave.  Solitary-wave limit  For very long nonlinear waves, with the parameter m close to one, m → 1, the Jacobi elliptic function cn can be approximated by 43        cn   (  z  |  m  )    ≈    sech   (  z  )    -      1  4      (   1  -  m   )    [     sinh   (  z  )     cosh   (  z  )     -  z   ]    tanh   (  z  )     sech   (  z  )       ,       cn  z  m      sech  z       1  4     1  m    delimited-[]        z     z    z      z    sech  z       \operatorname{cn}\left(z|m\right)\approx\operatorname{sech}(z)-\tfrac{1}{4}\,(%
 1-m)\,\Bigl[\sinh(z)\;\cosh(z)-z\Bigr]\,\tanh(z)\;\operatorname{sech}(z),   with      sech   (  z  )    =   1   cosh   (  z  )      .       sech  z     1    z      \operatorname{sech}(z)=\frac{1}{\cosh(z)}.     Here sinh, cosh, tanh and sech are hyperbolic functions . In the limit m = 1:        cn   (  z  |  m  )    →   sech   (  z  )     ,     normal-→   cn  z  m    sech  z     \operatorname{cn}\left(z|m\right)\to\operatorname{sech}(z),     with sech( z ) = 1 / cosh( z ).  Further, for the same limit of m → 1, the complete elliptic integral of the first kind K ( m ) goes to infinity, while the complete elliptic integral of the second kind E ( m ) goes to one. 44 This implies that the limiting values of the phase speed c and minimum elevelation η 2 become: 45      c  =       g   h      (   1  +     1  2     H  h     )        c        g  h      1      1  2     H  h        c=\sqrt{g\,h}\,\left(1+\frac{1}{2}\,\frac{H}{h}\right)   and     η  2   =   0.        subscript  η  2   0.    \eta_{2}=0.\,     Consequently, in terms of the width parameter Δ , the solitary wave solution to both the KdV and BBM equation is: 46        η   (  x  ,  t  )    =    H     sech  2    (    x  -    c   t    Δ   )      .        η   x  t      H    superscript  sech  2       x    c  t    normal-Δ       \eta(x,t)=H\,\operatorname{sech}^{2}\left(\frac{x-c\,t}{\Delta}\right).     The width parameter, as found for the cnoidal waves and now in the limit m → 1, is different for the KdV and the BBM equation: 47            Δ  =    h       4   h     3   H          normal-Δ    h        4  h     3  H        \Delta=h\,\sqrt{\frac{4\,h}{3\,H}}      KdV equation, and          Δ  =    h         4   h     3   H      c     g   h            normal-Δ    h          4  h     3  H      c      g  h          \Delta=h\,\sqrt{\frac{4\,h}{3\,H}\,\frac{c}{\sqrt{g\,h}}}      BBM equation.        But the phase speed of the solitary wave in both equations is the same, for a certain combination of height H and depth h .  Limit of infinitesimal wave height  For infinitesimal wave height the results of cnoidal wave theory are expected to converge towards those of Airy wave theory for the limit of long waves λ  h . First the surface elevation, and thereafter the phase speed, of the cnoidal waves for infinitesimal wave height will be examined.  Surface elevation  The Jacobi elliptic function cn can be expanded into a Fourier series 48        cn   (  z  |  m  )    =     π     m    K   (  m  )         ∑   n  =  0   ∞      sech   (    (    2  n   +  1   )      π    K  ′    (  m  )      2   K   (  m  )      )     cos   (    (    2  n   +  1   )      π   z     2   K   (  m  )      )        .       cn  z  m       π      m   K  m      superscript   subscript     n  0        sech        2  n   1       π   superscript  K  normal-′   m     2  K  m              2  n   1       π  z     2  K  m           \operatorname{cn}(z|m)=\frac{\pi}{\sqrt{m}\,K(m)}\,\sum_{n=0}^{\infty}\,%
 \operatorname{sech}\left((2n+1)\,\frac{\pi\,K^{\prime}(m)}{2\,K(m)}\right)\;%
 \cos\left((2n+1)\,\frac{\pi\,z}{2\,K(m)}\right).     K’ ( m ) is known as the imaginary quarter period, while K ( m ) is also called the real quarter period of the Jacobi elliptic function. They are related through: K’ ( m ) = K (1− m ) 49  Since the interest here is in small wave height, corresponding with small parameter m 1, it is convenient to consider the Maclaurin series for the relevant parameters, to start with the complete elliptic integrals  K and E : 50 51      K   (  m  )       K  m    \displaystyle K(m)     Then the hyperbolic-cosine terms, appearing in the Fourier series, can be expanded for small m 1 as follows: 52       sech   (    (    2  n   +  1   )      π    K  ′    (  m  )      2   K   (  m  )      )    =    2     q   n  +    1  2       1  +   q    2  n   +  1            sech        2  n   1       π   superscript  K  normal-′   m     2  K  m        2     superscript  q    n    1  2       1   superscript  q      2  n   1         \operatorname{sech}\left((2n+1)\,\frac{\pi\,K^{\prime}(m)}{2\,K(m)}\right)=2\,%
 \frac{q^{n+\tfrac{1}{2}}}{1+q^{2n+1}}   with the nome q given by     q  =   exp   (   -    π      K  ′    (  m  )     K   (  m  )       )     .      q        π       superscript  K  normal-′   m     K  m         q=\exp\left(-\pi\,\frac{K^{\prime}(m)}{K(m)}\right).     The nome q has the following behaviour for small m : 53       q  =    m  16   +    8     (   m  16   )   2    +    84     (   m  16   )   3    +    992     (   m  16   )   4    +  ⋯    .      q      m  16     8   superscript    m  16   2      84   superscript    m  16   3      992   superscript    m  16   4    normal-⋯     q=\frac{m}{16}+8\,\left(\frac{m}{16}\right)^{2}+84\,\left(\frac{m}{16}\right)^%
 {3}+992\,\left(\frac{m}{16}\right)^{4}+\cdots.     Consequently, the amplitudes of the first terms in the Fourier series are:            n  =   0       n  0    n=0\,      :           π     m    K   (  m  )       sech   (     π    K  ′    (  m  )      2   K   (  m  )     )     =    1  -     1  16    m   -     9  16     m  2     +  ⋯    ,          π      m   K  m     sech      π   superscript  K  normal-′   m     2  K  m          1      1  16   m       9  16    superscript  m  2     normal-⋯     \frac{\pi}{\sqrt{m}\,K(m)}\,\operatorname{sech}\,\left(\frac{\pi\,K^{\prime}(m%
 )}{2\,K(m)}\right)=1-\tfrac{1}{16}\,m-\tfrac{9}{16}\,m^{2}+\cdots,            n  =   1       n  1    n=1\,      :           π     m    K   (  m  )       sech   (     3    π    K  ′    (  m  )      2   K   (  m  )     )     =      1  16    m   +     1  32     m  2    +  ⋯    ,          π      m   K  m     sech      3  π   superscript  K  normal-′   m     2  K  m            1  16   m       1  32    superscript  m  2    normal-⋯     \frac{\pi}{\sqrt{m}\,K(m)}\,\operatorname{sech}\,\left(\frac{3\,\pi\,K^{\prime%
 }(m)}{2\,K(m)}\right)=\tfrac{1}{16}\,m+\tfrac{1}{32}\,m^{2}+\cdots,            n  =   2       n  2    n=2\,      :           π     m    K   (  m  )       sech   (     5    π    K  ′    (  m  )      2   K   (  m  )     )     =      1  256     m  2    +  ⋯    .          π      m   K  m     sech      5  π   superscript  K  normal-′   m     2  K  m            1  256    superscript  m  2    normal-⋯     \frac{\pi}{\sqrt{m}\,K(m)}\,\operatorname{sech}\,\left(\frac{5\,\pi\,K^{\prime%
 }(m)}{2\,K(m)}\right)=\tfrac{1}{256}\,m^{2}+\cdots.          So, for m 1 the Jacobi elliptic function has the first Fourier series terms:      cn   (  z  |  m  )      cn  z  m    \displaystyle\operatorname{cn}\,(z|m)   with     α  ≡   π    2   K   (  m  )      .      α    π    2  K  m      \alpha\equiv\frac{\pi}{2\,K(m)}.     And its square is        cn  2     (  z  |  m  )       superscript  cn  2   z  m    \displaystyle\operatorname{cn}^{2}\,(z|m)     The free surface η ( x , t ) of the cnoidal wave will be expressed in its Fourier series, for small values of the elliptic parameter m . First, note that the argument of the cn function is ξ / Δ , and that the wavelength λ = 2 Δ  K ( m ), so:       θ  ≡       π   ξ    K   (  m  )       ξ  Δ    =    2    π    ξ  λ     .        θ        π  ξ     K  m      ξ  normal-Δ           2  π    ξ  λ       \theta\equiv\frac{\pi\,\xi}{K(m)}\,\frac{\xi}{\Delta}=2\,\pi\,\frac{\xi}{%
 \lambda}.     Further, the mean free-surface elevation is zero. Therefore, the surface elevation of small amplitude waves is        η   (  x  ,  t  )    =     H    (      1  2    -      3  512      m  2     +  ⋯   )     cos    θ     +    H    (       1  16     m   +      1  32      m  2    +  ⋯   )    cos   2   θ      +    H    (       3  512      m  2    +  ⋯   )    cos   3   θ      +  ⋯    .        η   x  t        H        1  2       3  512    superscript  m  2     normal-⋯     θ      H        1  16   m       1  32    superscript  m  2    normal-⋯       2  θ       H        3  512    superscript  m  2    normal-⋯       3  θ     normal-⋯     \eta(x,t)=\;H\,\Bigl(\tfrac{1}{2}-\tfrac{3}{512}\,m^{2}+\cdots\Bigr)\,\cos\,%
 \theta\;+\;H\,\Bigl(\tfrac{1}{16}\,m+\tfrac{1}{32}\,m^{2}+\cdots\Bigr)\,\cos\,%
 2\theta\;+\;H\,\Bigl(\tfrac{3}{512}\,m^{2}+\cdots\Bigr)\,\cos\,3\theta\;+\;\cdots.     Also the wavelength λ can be expanded into a Maclaurin series of the elliptic parameter m , differently for the KdV and the BBM equation, but this is not necessary for the present purpose.        Note : The limiting behaviour for zero m —at infinitesimal wave height—can also be seen from: 54           cn   (  z  |  m  )    ≈    cos   (  z  )    +     1  4     m    (   z  -    sin   (  z  )     cos   (  z  )      )    sin   (  z  )     +  ⋯    ,       cn  z  m       z       1  4   m    z      z     z       z    normal-⋯     \operatorname{cn}(z|m)\approx\cos(z)+\tfrac{1}{4}\,m\,\bigl(z-\sin(z)\,\cos(z)%
 \bigr)\,\sin(z)+\cdots,        but the higher-order term proportional to m in this approximation contains a secular term , due to the mismatch between the period of cn( z | m ), which is 4 K ( m ), and the period 2 π for the cosine cos( z ). The above Fourier series for small m does not have this drawback, and is consistent with forms as found using the Lindstedt–Poincaré method in perturbation theory .       For infinitesimal wave height, in the limit m → 0, the free-surface elevation becomes:        η   (  x  ,  t  )    =      1  2      H     cos   θ     ,        η   x  t        1  2   H    θ      \eta(x,t)=\tfrac{1}{2}\,H\,\cos\,\theta,   with     θ  =    2    π    ξ  λ    =    2    π     x  -    c   t    λ     .        θ    2  π    ξ  λ           2  π      x    c  t    λ       \theta=2\,\pi\,\frac{\xi}{\lambda}=2\,\pi\ \frac{x-c\,t}{\lambda}.     So the wave amplitude is ½ H , half the wave height . This is of the same form as studied in Airy wave theory , but note that cnoidal wave theory is only valid for long waves with their wavelength much longer than the average water depth.  Phase speed  The phase speed of a cnoidal wave, both for the KdV and BBM equation, is given by: 55 56       c  =      g  h      [   1  +     H    m   h      (   1  -     1  2    m   -     3  2      E   (  m  )     K   (  m  )       )     ]     .      c        g  h     delimited-[]    1      H    m  h      1      1  2   m       3  2       E  m     K  m            c=\sqrt{gh}\,\left[1+\frac{H}{m\,h}\,\left(1-\frac{1}{2}\,m-\frac{3}{2}\,\frac%
 {E(m)}{K(m)}\right)\right].     In this formulation the phase speed is a function of wave height  H and parameter m . However, for the determination of wave propagation for waves of infinitesimal height, it is necessary to determine the behaviour of the phase speed at constant wavelength  λ in the limit that the parameter m approaches zero. This can be done by using the equation for the wavelength, which is different for the KdV and BBM equation: 57 58        KdV :        λ  =    h        16  3      m  h   H      K   (  m  )     ,      λ    h        16  3       m  h   H     K  m     \lambda=h\,\sqrt{\frac{16}{3}\,\frac{mh}{H}}\,K(m),        BBM :        λ  =    h        16  3       m  h   H     c     g   h        K   (  m  )     ,      λ    h        16  3       m  h   H     c      g  h       K  m     \lambda=h\,\sqrt{\frac{16}{3}\,\frac{mh}{H}\,\frac{c}{\sqrt{g\,h}}}\,K(m),          Introducing the relative wavenumber  κh :         κ   h   =       2   π   λ    h    ,        κ  h         2  π   λ   h     \kappa\,h=\frac{2\,\pi}{\lambda}\,h,     and using the above equations for the phase speed and wavelength, the factor H / m in the phase speed can be replaced by κh and m . The resulting phase speeds are:        KdV :        c  =      g  h      [   1  +      (    κ   h   )   2      4    3    π  2       K  2    (  m  )    (   1  -     1  2    m   -     3  2      E   (  m  )     K   (  m  )       )     ]     ,      c        g  h     delimited-[]    1     superscript    κ  h   2     4    3   superscript  π  2      superscript  K  2   m    1      1  2   m       3  2       E  m     K  m            c=\sqrt{gh}\,\left[1+(\kappa\,h)^{2}\,\frac{4}{3\,\pi^{2}}\,K^{2}(m)\,\left(1-%
 \frac{1}{2}\,m-\frac{3}{2}\,\frac{E(m)}{K(m)}\right)\right],        BBM :         c  =      g  h      1   1  -      (    κ   h   )   2       4    3    π  2        K  2    (  m  )    (   1  -      1  2     m   -      3  2        E   (  m  )     K   (  m  )        )        .      c        g  h      1    1     superscript    κ  h   2     4    3   superscript  π  2      superscript  K  2   m    1      1  2   m       3  2       E  m     K  m            c=\sqrt{gh}\,\frac{1}{\displaystyle 1-(\kappa\,h)^{2}\,\frac{4}{3\,\pi^{2}}\,K%
 ^{2}(m)\,\left(1-\frac{1}{2}\,m-\frac{3}{2}\,\frac{E(m)}{K(m)}\right)}.           The limiting behaviour for small m can be analysed through the use of the Maclaurin series for K ( m ) and E ( m ), 59 resulting in the following expression for the common factor in both formulas for c :       γ  =     4    3    π  2       K  2    (  m  )    (   1  -     1  2    m   -     3  2      E   (  m  )     K   (  m  )       )    =    -    1  6     +      1  64      m  2    +      1  64      m  3    +  ⋯    ,        γ      4    3   superscript  π  2      superscript  K  2   m    1      1  2   m       3  2       E  m     K  m                  1  6        1  64    superscript  m  2        1  64    superscript  m  3    normal-⋯      \gamma=\frac{4}{3\,\pi^{2}}\,K^{2}(m)\,\left(1-\frac{1}{2}\,m-\,\frac{3}{2}\,%
 \frac{E(m)}{K(m)}\right)=-\tfrac{1}{6}+\tfrac{1}{64}\,m^{2}+\tfrac{1}{64}\,m^{%
 3}+\cdots,     so in the limit m → 0, the factor γ → −     1  /  6      1  6    {1}/{6}    . The limiting value of the phase speed for m 1 directly results.  The phase speeds for infinitesimal wave height, according to the cnoidal wave theories for the KdV equation and BBM equation, are 60        KdV   :        c  =    [   1  -     1  6      (   κ  h   )   2     ]      g   h      ,      c     delimited-[]    1      1  6    superscript    κ  h   2          g  h       c=\Bigl[1-\tfrac{1}{6}\,\left(\kappa h\right)^{2}\Bigr]\,\sqrt{g\,h},        BBM   :        c  =     1   1  +      1  6       (   κ  h   )   2          g   h      ,      c      1    1      1  6    superscript    κ  h   2          g  h       c=\frac{1}{1+\tfrac{1}{6}\,\left(\kappa h\right)^{2}}\,\sqrt{g\,h},          with κ = 2 π / λ the wavenumber and κh the relative wavenumber. These phase speeds are in full agreement with the result obtained by directly searching for sine-wave solutions of the linearised KdV and BBM equations. As is evident from these equations, the linearised BBM equation has a positive phase speed for all κh . On the other hand, the phase speed of the linearised KdV equation changes sign for short waves with κh >    6      6    \scriptstyle\sqrt{6}   . This is in conflict with the derivation of the KdV equation as a one-way wave equation.  Direct derivation from the full inviscid-flow equations  (Figure)  Undular bore and whelps near the mouth of Araguari River in north-eastern Brazil. View is oblique toward mouth from airplane at approximately  altitude. 61   Cnoidal waves can be derived directly from the inviscid , irrotational and incompressible flow equations, and expressed in terms of three invariants of the flow, as shown by  in their research on undular bores . In a frame of reference moving with the phase speed , in which reference frame the flow becomes a steady flow , the cnoidal wave solutions can directly be related to the mass flux , momentum flux and energy head of the flow. Following —using a stream function description of this incompressible flow—the horizontal and vertical components of the flow velocity are the spatial derivatives of the stream function Ψ ( ξ , z ): +''∂ z Ψ  '' and − ∂ ξ Ψ , in the ξ and z direction respectively ( ξ = x − ct ). The vertical coordinate z is positive in the upward direction, opposite to the direction of the gravitational acceleration, and the zero level of z is at the impermeable lower boundary of the fluid domain. While the free surface is at z = ζ ( ξ ); note that ζ is the local water depth, related to the surface elevation η ( ξ ) as ζ = h + η with h the mean water depth.  In this steady flow, the discharge  Q through each vertical cross section is a constant independent of ξ , and because of the horizontal bed also the horizontal momentum flux S , divided by the density  ρ , through each vertical cross section is conserved. Further, for this inviscid and irrotational flow, Bernoulli's principle can be applied and has the same Bernoulli constant R everywhere in the flow domain. They are defined as: 62     Q   Q   \displaystyle Q     For fairly long waves, assuming the water depth ζ is small compared to the wavelength λ , the following relation is obtained between the water depth ζ ( ξ ) and the three invariants Q , R and S : 63   This nonlinear and first-order ordinary differential equation has cnoidal wave solutions.  For very long waves of infinitesimal  amplitude on a fluid of depth h and with a uniform flow velocity v , the flow constants are according to the shallow water equations : 64        Q  0   =    v   h    ,       subscript  Q  0     v  h     Q_{0}=v\,h,        R  0   =      1  2     v  2    +    g   h         subscript  R  0         1  2    superscript  v  2      g  h      R_{0}=\tfrac{1}{2}\,v^{2}+g\,h   and      S  0   =      v  2    h   +     1  2     g    h  2      .       subscript  S  0        superscript  v  2   h       1  2   g   superscript  h  2       S_{0}=v^{2}\,h+\tfrac{1}{2}\,g\,h^{2}.     Equation () can be brought into non-dimensional form by use of the discharge Q and gravitational acceleration g , and defining the critical depth h c :        h  c   =     Q  2   g   3    ,       subscript  h  c      3      superscript  Q  2   g      h_{c}=\sqrt[3]{\frac{Q^{2}}{g}},     related to the critical flow demarcation between subcritical flow and supercritical flow (see also Froude number ). Consequently, the non-dimensional form of the equation is           1  3       (    ζ  ~   ′   )   2    ≈      -   ζ  3    +    2     R  ~      ζ  ~   2     -    2     S  ~     ζ  ~     +  1    ,          1  3    superscript   superscript   normal-~  ζ   normal-′   2             superscript  ζ  3      2   normal-~  R    superscript   normal-~  ζ   2       2   normal-~  S    normal-~  ζ     1     \tfrac{1}{3}\,\left(\tilde{\zeta}^{\prime}\right)^{2}\approx-\zeta^{3}+2\,%
 \tilde{R}\,\tilde{\zeta}^{2}-2\,\tilde{S}\,\tilde{\zeta}+1,     with        ζ  ~   =   ζ   h  c     ,       normal-~  ζ     ζ   subscript  h  c      \tilde{\zeta}=\frac{\zeta}{h_{c}},         ξ  ~   =   ξ   h  c     ,       normal-~  ξ     ξ   subscript  h  c      \tilde{\xi}=\frac{\xi}{h_{c}},         R  ~   =   R    g    h  c      ,       normal-~  R     R    g   subscript  h  c       \tilde{R}=\frac{R}{g\,h_{c}},   and      S  ~   =   S    g    h  c  2      .       normal-~  S     S    g   superscript   subscript  h  c   2       \tilde{S}=\frac{S}{g\,h_{c}^{2}}.     Derivation  First eliminate the pressure p from the momentum flux S by use of the Bernoulli equation:       S  =      R   ζ   -      1  2      g    ζ  2     +    ∫  0  ζ      1  2     [     (    ∂  z   Ψ   )   2   -    (    ∂  ξ   Ψ   )   2    ]   d  z      .      S        R  ζ       1  2   g   superscript  ζ  2       superscript   subscript   0   ζ       1  2    delimited-[]     superscript    subscript   z   normal-Ψ   2    superscript    subscript   ξ   normal-Ψ   2     d  z       S=R\,\zeta-\tfrac{1}{2}\,g\,\zeta^{2}+\int_{0}^{\zeta}\tfrac{1}{2}\left[\left(%
 \partial_{z}\Psi\right)^{2}-\left(\partial_{\xi}\Psi\right)^{2}\right]\;\text{%
 d}z.     The streamfunction Ψ is expanded as a Maclaurin series around the bed at z = 0, and using that the impermeable bed is a streamline and the irrotationality of the flow: Ψ = 0 and ∂ z 2 Ψ = 0 at z = 0: 65       Ψ  =      z    u  b    (  ξ  )    -      z  3    3  !      u  b  ′′    (  ξ  )     +      z  5    5  !      u  b  iv    (  ξ  )    +  ⋯    ,      normal-Ψ        z   subscript  u  b   ξ        superscript  z  3     3     superscript   subscript  u  b   ′′   ξ         superscript  z  5     5     superscript   subscript  u  b   iv   ξ   normal-⋯     \Psi=z\,u_{b}(\xi)-\frac{z^{3}}{3!}\,u_{b}^{\prime\prime}(\xi)+\frac{z^{5}}{5!%
 }\,u_{b}^{\text{iv}}(\xi)+\cdots,     with u b the horizontal velocity at the bed z = 0. Because the waves are long, h ≫ λ , only terms up to z 3 and ζ 3 are retained in the approximations to Q and S . The momentum flux S then becomes: 66       S  =        R   ζ   -      1  2      g    ζ  2     +      1  2      ζ    u  b  2     -      1  6       ζ  3      u  b     u  b  ′′    -      1  6       ζ  3      (   u  b  ′   )   2     +  ⋯    .      S            R  ζ       1  2   g   superscript  ζ  2         1  2   ζ   superscript   subscript  u  b   2         1  6    superscript  ζ  3    subscript  u  b    superscript   subscript  u  b   ′′        1  6    superscript  ζ  3    superscript   superscript   subscript  u  b   normal-′   2     normal-⋯     S=R\,\zeta-\tfrac{1}{2}\,g\,\zeta^{2}+\tfrac{1}{2}\,\zeta\,u_{b}^{2}-\tfrac{1}%
 {6}\,\zeta^{3}\,u_{b}\,u_{b}^{\prime\prime}-\tfrac{1}{6}\,\zeta^{3}\,\left(u_{%
 b}^{\prime}\right)^{2}+\cdots.     The discharge Q becomes, since it is the value of the streamfunction Ψ at the free surface z = ζ :       Q  =      ζ    u  b    (  ξ  )    -      1  6       ζ  3     u  b  ′′   ξ    +  ⋯    .      Q        ζ   subscript  u  b   ξ       1  6    superscript  ζ  3    superscript   subscript  u  b   ′′   ξ    normal-⋯     Q=\zeta\,u_{b}(\xi)-\tfrac{1}{6}\,\zeta^{3}\,u_{b}^{\prime\prime}{\xi}+\cdots.     As can be seen, the discharge Q is an O( ζ ) quantity. From this, the bed velocity is seen to be 67        u  b   =    Q  ζ   +      1  6       ζ  2     u  b  ′′    +  ⋯    .       subscript  u  b       Q  ζ       1  6    superscript  ζ  2    superscript   subscript  u  b   ′′    normal-⋯     u_{b}=\frac{Q}{\zeta}+\tfrac{1}{6}\,\zeta^{2}\,u_{b}^{\prime\prime}+\cdots.     Note that Q / ζ is an order one quantity. This relation will be used to replace the bed velocity u b by Q and ζ in the momentum flux S . The following terms can be derived from it:      u  b  2     superscript   subscript  u  b   2    \displaystyle u_{b}^{2}     Consequently, the momentum flux S becomes, again retaining only terms up to proportional to ζ 3 : 68       S  ≈       R   ζ   -      1  2      g    ζ  2     +      1  2       Q  2   ζ     -      1  6        Q  2   ζ      (   ζ  ′   )   2      .      S          R  ζ       1  2   g   superscript  ζ  2         1  2      superscript  Q  2   ζ         1  6      superscript  Q  2   ζ    superscript   superscript  ζ  normal-′   2       S\approx R\,\zeta-\tfrac{1}{2}\,g\,\zeta^{2}+\tfrac{1}{2}\,\frac{Q^{2}}{\zeta}%
 -\tfrac{1}{6}\,\frac{Q^{2}}{\zeta}\,\left(\zeta^{\prime}\right)^{2}.     Which can directly be recast in the form of equation ().  Potential energy  The potential energy density       E  pot   =     1  λ      ∫  0  λ       1  2      ρ    g    η  2    (  x  ,  t  )   d  x          subscript  E  pot       1  λ     superscript   subscript   0   λ       1  2   ρ  g   superscript  η  2    x  t   d  x       E_{\text{pot}}=\frac{1}{\lambda}\,\int_{0}^{\lambda}\tfrac{1}{2}\,\rho\,g\,%
 \eta^{2}(x,t)\;\text{d}x     with ρ the fluid density , is one of the infinite number of invariants of the KdV equation. 69 This can be seen by multiplying the KdV equation with the surface elevation η ( x , t ); after repeated use of the chain rule the result is:          ∂  t    (      1  2      η  2    )    +    ∂  x    {       1  2         g   h      η  2    +      1  2        g  h      η  3    +      1  12      h  2       g   h      [     ∂  x  2    (   η  2   )    -   3    (    ∂  x   η   )   2     ]     }     =  0   ,          subscript   t       1  2    superscript  η  2       subscript   x         1  2       g  h     superscript  η  2        1  2       g  h     superscript  η  3        1  12    superscript  h  2       g  h     delimited-[]      superscript   subscript   x   2    superscript  η  2      3   superscript    subscript   x   η   2          0    \partial_{t}\left(\tfrac{1}{2}\,\eta^{2}\right)+\partial_{x}\left\{\tfrac{1}{2%
 }\,\sqrt{g\,h}\,\eta^{2}+\tfrac{1}{2}\,\sqrt{\frac{g}{h}}\,\eta^{3}+\tfrac{1}{%
 12}\,h^{2}\sqrt{g\,h}\,\left[\partial_{x}^{2}\left(\eta^{2}\right)-3\left(%
 \partial_{x}\eta\right)^{2}\right]\right\}=0,     which is in conservation form, and is an invariant after integration over the interval of periodicity—the wavelength for a cnoidal wave. The potential energy is not an invariant of the BBM equation, but ½ ρg [ η 2 +     1  /  6      1  6    {1}/{6}     h 2 ( ∂ x  η ) 2 ] is. 70  First the variance of the surface elevation in a cnoidal wave is computed. Note that η 2 = −(1/ λ ) 0 ∫ λ  H cn 2 ( ξ / Δ |m) d x , cn( ξ / Δ |m)  = cos ψ ( ξ ) and λ = 2 Δ  K ( m ), so 71         1  λ        ∫  0  λ       η  2    d  x          1  λ     superscript   subscript   0   λ      superscript  η  2   d  x      \displaystyle\frac{1}{\lambda}\,\int_{0}^{\lambda}\eta^{2}\;\text{d}x     The potential energy, both for the KdV and the BBM equation, is subsequently found to be 72        E  pot   =      1  2      ρ    g     H  2     [     -   1    3   m     +     2    3   m      (   1  +   1  m    )    (   1  -    E   (  m  )     K   (  m  )      )     -     1   m  2       (   1  -    E   (  m  )     K   (  m  )      )   2     ]     .       subscript  E  pot       1  2   ρ  g   superscript  H  2    delimited-[]          1    3  m         2    3  m      1    1  m      1      E  m     K  m           1   superscript  m  2     superscript    1      E  m     K  m     2         E_{\text{pot}}=\tfrac{1}{2}\,\rho\,g\,H^{2}\,\left[-\frac{1}{3\,m}+\frac{2}{3%
 \,m}\,\left(1+\frac{1}{m}\right)\left(1-\frac{E(m)}{K(m)}\right)-\frac{1}{m^{2%
 }}\,\left(1-\frac{E(m)}{K(m)}\right)^{2}\right].     The infinitesimal wave-height limit ( m → 0) of the potential energy is E pot =     1  /  16      1  16    {1}/{16}     ρ  g  H 2 , which is in agreement with Airy wave theory . 73 The wave height is twice the amplitude, H = 2 a , in the infinitesimal wave limit.  See also   Soliton   Notes and references  Notes  References      See Part 2, Chapter 6 .    Further reading          , see pp. 702–714 for cnoidal waves    "  Category:Fluid dynamics  Category:Water waves     , p. 205. ↩  Dingemans (1997) pp. 718–721. ↩  Dingemans (1997) pp. 689–691. ↩  ↩   ↩   ↩  , p. 61. ↩  ↩  ↩  ↩  ↩  ↩  Dingemans (1997) pp. 692–693. ↩   Dingemans (1997) p. 701. ↩    Dingemans (1997) pp. 708–715. ↩     Abramowitz & Stegun (1965) p. 590. ↩  The elliptic parameter m is distinct from the elliptic modulus k : m = k 2 . See Abramowitz & Stegun (1965) p. 590. ↩           Dingemans (1997) p. 694–696. ↩   Dingemans (1997) p. 715. ↩       Abramowitz & Stegun (1965) Eq. 16.15.2, p. 574. ↩  Abramowitz & Stegun (1965) Figures 17.1 & 17.2, p. 592. ↩  Dingemans (1997) pp. 702–704. ↩    Abramowitz & Stegun (1965) Eq. 16.23.2, p. 575. ↩  Abramowitz & Stegun (1965) Eq. 17.3.5, p. 590. ↩  Dingemans (1997) p. 784. ↩  Abramowitz & Stegun (1965) Eqs. 17.3.9 & 17.3.10, p. 591. ↩   Abramowitz & Stegun (1965) 17.3.21, p. 591. ↩  Abramowitz & Stegun (1965) Eq. 16.13.2, p. 573. ↩       Dingemans (1997) p. 695 ↩  Figure 5 in: ↩  Benjamin & Lighthill (1954) ↩        Dingemans (1997) pp. 730–733. ↩  Benjamin, Bona & Mahony (1972) ↩  Dingemans (1997) pp. 791–794. ↩       
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1936">Ordered dithering</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Ordered dithering</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p> <strong>Ordered dithering</strong> is an image <a class="uri" href="dithering" title="wikilink">dithering</a> algorithm. It is commonly used by programs that need to provide continuous image of higher colors on a display of less color depth. For example, <a href="Microsoft_Windows" title="wikilink">Microsoft Windows</a> uses it in 16-color graphics modes. It is easily distinguished by its noticeable crosshatch patterns.</p>

<p>The algorithm achieves dithering by applying a threshold map on the pixels displayed, causing some of the pixels to be rendered at a different color, depending on how far in between the color is of available color entries.</p>

<p>Different sizes of threshold maps exist:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="block" id="Ordered_dithering:0">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mn>5</mn>
   </mfrac>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>3</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>2</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">5</cn>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">3</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">4</cn>
      <cn type="integer">2</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\displaystyle 1}{\displaystyle 5}\begin{bmatrix}1&3\\
4&2\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Ordered_dithering:1">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mn>10</mn>
   </mfrac>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>3</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>7</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>4</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>6</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>9</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>8</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>5</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">10</cn>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">3</cn>
      <cn type="integer">7</cn>
      <cn type="integer">4</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">6</cn>
      <cn type="integer">1</cn>
      <cn type="integer">9</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">2</cn>
      <cn type="integer">8</cn>
      <cn type="integer">5</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\displaystyle 1}{\displaystyle 10}\begin{bmatrix}3&7&4\\
6&1&9\\
2&8&5\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Ordered_dithering:2">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mn>17</mn>
   </mfrac>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>9</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>3</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>11</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>13</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>5</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>15</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>7</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>12</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>10</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>16</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>8</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>14</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>6</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">17</cn>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">9</cn>
      <cn type="integer">3</cn>
      <cn type="integer">11</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">13</cn>
      <cn type="integer">5</cn>
      <cn type="integer">15</cn>
      <cn type="integer">7</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">4</cn>
      <cn type="integer">12</cn>
      <cn type="integer">2</cn>
      <cn type="integer">10</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">16</cn>
      <cn type="integer">8</cn>
      <cn type="integer">14</cn>
      <cn type="integer">6</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\displaystyle 1}{\displaystyle 17}\begin{bmatrix}1&9&3&11\\
13&5&15&7\\
4&12&2&10\\
16&8&14&6\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;">
<p>

<math display="block" id="Ordered_dithering:3">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mn>65</mn>
   </mfrac>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>49</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>13</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>61</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>4</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>52</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>16</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>64</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>33</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>17</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>45</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>29</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>36</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>20</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>48</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>32</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>9</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>57</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>5</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>53</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>12</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>60</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>8</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>56</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>41</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>25</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>37</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>21</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>44</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>28</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>40</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>24</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>3</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>51</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>15</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>63</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>2</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>50</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>14</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>62</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>35</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>19</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>47</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>31</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>34</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>18</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>46</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>30</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>11</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>59</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>7</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>55</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>10</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>58</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>6</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>54</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>43</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>27</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>39</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>23</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>42</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>26</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>38</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>22</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">65</cn>
    </apply>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">49</cn>
      <cn type="integer">13</cn>
      <cn type="integer">61</cn>
      <cn type="integer">4</cn>
      <cn type="integer">52</cn>
      <cn type="integer">16</cn>
      <cn type="integer">64</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">33</cn>
      <cn type="integer">17</cn>
      <cn type="integer">45</cn>
      <cn type="integer">29</cn>
      <cn type="integer">36</cn>
      <cn type="integer">20</cn>
      <cn type="integer">48</cn>
      <cn type="integer">32</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">9</cn>
      <cn type="integer">57</cn>
      <cn type="integer">5</cn>
      <cn type="integer">53</cn>
      <cn type="integer">12</cn>
      <cn type="integer">60</cn>
      <cn type="integer">8</cn>
      <cn type="integer">56</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">41</cn>
      <cn type="integer">25</cn>
      <cn type="integer">37</cn>
      <cn type="integer">21</cn>
      <cn type="integer">44</cn>
      <cn type="integer">28</cn>
      <cn type="integer">40</cn>
      <cn type="integer">24</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">3</cn>
      <cn type="integer">51</cn>
      <cn type="integer">15</cn>
      <cn type="integer">63</cn>
      <cn type="integer">2</cn>
      <cn type="integer">50</cn>
      <cn type="integer">14</cn>
      <cn type="integer">62</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">35</cn>
      <cn type="integer">19</cn>
      <cn type="integer">47</cn>
      <cn type="integer">31</cn>
      <cn type="integer">34</cn>
      <cn type="integer">18</cn>
      <cn type="integer">46</cn>
      <cn type="integer">30</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">11</cn>
      <cn type="integer">59</cn>
      <cn type="integer">7</cn>
      <cn type="integer">55</cn>
      <cn type="integer">10</cn>
      <cn type="integer">58</cn>
      <cn type="integer">6</cn>
      <cn type="integer">54</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">43</cn>
      <cn type="integer">27</cn>
      <cn type="integer">39</cn>
      <cn type="integer">23</cn>
      <cn type="integer">42</cn>
      <cn type="integer">26</cn>
      <cn type="integer">38</cn>
      <cn type="integer">22</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\displaystyle 1}{\displaystyle 65}\begin{bmatrix}1&49&13&61&4&52&16&64\\
33&17&45&29&36&20&48&32\\
9&57&5&53&12&60&8&56\\
41&25&37&21&44&28&40&24\\
3&51&15&63&2&50&14&62\\
35&19&47&31&34&18&46&30\\
11&59&7&55&10&58&6&54\\
43&27&39&23&42&26&38&22\\
\end{bmatrix}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>

<p>The map may be rotated or mirrored without affecting the power of the algorithm. This threshold map is also known as an <strong>index matrix</strong> or <strong>Bayer matrix</strong>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>Arbitrary size threshold maps can be devised with a simple rule: First fill each slot with a successive integer starting from 1. Then reorder them such that the average distance between two successive numbers in the map is as large as possible, ensuring that the table "wraps" around at edges. </p>

<p>The algorithm renders the image normally, but for each pixel, it adds a value from the threshold map, causing the pixel's value to be quantized one step higher if it exceeds the threshold. For example, in monochrome rendering, if the value of the pixel (scaled into the 0-9 range if using a 3x3 matrix) is less than the number in the corresponding cell of the matrix, plot that pixel black, otherwise, plot it white.</p>
<figure><b>(Figure)</b>
<figcaption>A color scale shown undithered and dithered. The palette has 8 red tones, 8 green tones, and their intersections for a total of 64 colors, whereas the original image has 140 in both directions for a total of 19600 colors.</figcaption>
</figure>

<p>In <a class="uri" href="pseudocode" title="wikilink">pseudocode</a>:</p>
<div class="sourceCode"><pre class="sourceCode perl"><code class="sourceCode perl"> <span class="kw">foreach</span> y
    <span class="kw">foreach</span> x
       oldpixel := pixel[x][y] + (pixel[x][y] <span class="kw">*</span> threshold_map_4x4[x mod <span class="dv">4</span>][y mod <span class="dv">4</span>])
       newpixel := find_closest_palette_color(oldpixel)
       pixel[x][y] := newpixel</code></pre></div>

<p>The values read from the threshold map should scale into the same range as is the minimal difference between distinct colors in the target palette.</p>

<p>Because the algorithm operates on single pixels and has no conditional statements, it is very fast and suitable for real-time transformations. Additionally, because the location of the dithering patterns stays always the same relative to the display frame, it is less prone to jitter than error-diffusion methods, making it suitable for animations. Because the patterns are more repetitive than error-diffusion method, an image with ordered dithering compresses better. Ordered dithering is more suitable for line-art graphics as it will result in straighter lines and fewer anomalies.</p>

<p>The size of the map selected should be equal to or larger than the ratio of source colors to target colors. For example, when quantizing a 24bpp image to 15bpp (256 colors per channel to 32 colors per channel), the smallest map one would choose would be 4x2, for the ratio of 8 (256:32). This allows expressing each distinct tone of the input with different dithering patterns. </p>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li><a href="http://www.visgraf.impa.br/Courses/ip00/proj/Dithering1/ordered_dithering.html">Ordered Dithering</a> (Graphics course project, Visgraf lab, Brazil)</li>
<li><a href="http://www.efg2.com/Lab/Library/ImageProcessing/DHALF.TXT">Dithering algorithms</a> (Lee Daniel Crocker, Paul Boulay and Mike Morra)</li>
<li><a href="http://bisqwit.iki.fi/story/howto/dither/jy/">Arbitrary-palette positional dithering algorithm</a> (Joel Yliluoma)</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://michal.is/projects/image-dithering-in-matlab/">Matlab implementation of various dithering methods</a></li>
</ul>

<p>"</p>

<p><a href="Category:Image_processing" title="wikilink">Category:Image processing</a> <a href="Category:Articles_with_example_pseudocode" title="wikilink">Category:Articles with example pseudocode</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>


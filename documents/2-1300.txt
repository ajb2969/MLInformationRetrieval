   Newton–Cotes formulas      Newton–Cotes formulas   In numerical analysis , the Newton–Cotes formulae , also called the Newton–Cotes quadrature rules or simply Newton–Cotes rules , are a group of formulae for numerical integration (also called quadrature ) based on evaluating the integrand at equally spaced points. They are named after Isaac Newton and Roger Cotes .  Newton–Cotes formulae can be useful if the value of the integrand at equally spaced points is given. If it is possible to change the points at which the integrand is evaluated, then other methods such as Gaussian quadrature and Clenshaw–Curtis quadrature are probably more suitable.  Description  It is assumed that the value of a function ƒ defined on [ a , b ] is known at equally spaced points x i , for i = 0, …, n , where x 0 = a and x n = b . There are two types of Newton–Cotes formulae, the "closed" type which uses the function value at all points, and the "open" type which does not use the function values at the endpoints. The closed Newton–Cotes formula of degree n is stated as        ∫  a  b    f   (  x  )   d  x    ≈    ∑   i  =  0   n      w  i    f   (   x  i   )           superscript   subscript   a   b     f  x  d  x      superscript   subscript     i  0    n      subscript  w  i   f   subscript  x  i       \int_{a}^{b}f(x)\,dx\approx\sum_{i=0}^{n}w_{i}\,f(x_{i})     where  h  i + x 0 }} , with h (called the step size ) equal to ( b − a ) / n }} . The w i are called weights .  As can be seen in the following derivation the weights are derived from the Lagrange basis polynomials . They depend only on the x i and not on the function ƒ . Let L ( x ) be the interpolation polynomial in the Lagrange form for the given data points , then         ∫  a  b    f   (  x  )   d  x    ≈    ∫  a  b    L   (  x  )   d  x    =    ∫  a  b     (    ∑   i  =  0   n    f   (   x  i   )    l  i    (  x  )     )   d  x    =    ∑   i  =  0   n    f   (   x  i   )       ∫  a  b     l  i    (  x  )   d  x    ⏟    w  i       .          superscript   subscript   a   b     f  x  d  x      superscript   subscript   a   b     L  x  d  x           superscript   subscript   a   b       superscript   subscript     i  0    n     f   subscript  x  i    subscript  l  i   x    d  x           superscript   subscript     i  0    n     f   subscript  x  i    subscript   normal-⏟    superscript   subscript   a   b      subscript  l  i   x  d  x      subscript  w  i         \int_{a}^{b}f(x)\,dx\approx\int_{a}^{b}L(x)\,dx=\int_{a}^{b}\bigl(\sum_{i=0}^{%
 n}f(x_{i})\,l_{i}(x)\bigr)\,dx=\sum_{i=0}^{n}f(x_{i})\underbrace{\int_{a}^{b}l%
 _{i}(x)\,dx}_{w_{i}}.     The open Newton–Cotes formula of degree n is stated as         ∫  a  b    f   (  x  )   d  x    ≈    ∑   i  =  1    n  -  1       w  i    f   (   x  i   )      .        superscript   subscript   a   b     f  x  d  x      superscript   subscript     i  1      n  1       subscript  w  i   f   subscript  x  i       \int_{a}^{b}f(x)\,dx\approx\sum_{i=1}^{n-1}w_{i}\,f(x_{i}).     The weights are found in a manner similar to the closed formula.  Instability for high degree  A Newton–Cotes formula of any degree n can be constructed. However, for large n a Newton–Cotes rule can sometimes suffer from catastrophic Runge's phenomenon where the error grows exponentially for large n . Methods such as Gaussian quadrature and Clenshaw–Curtis quadrature with unequally spaced points (clustered at the endpoints of the integration interval) are stable and much more accurate, and are normally preferred to Newton–Cotes. If these methods cannot be used, because the integrand is only given at the fixed equidistributed grid, then Runge's phenomenon can be avoided by using a composite rule, as explained below.  Closed Newton–Cotes formulae  This table lists some of the Newton–Cotes formulae of the closed type. The notation    f  i     subscript  f  i    f_{i}   is a shorthand for    f   (   x  i   )       f   subscript  x  i     f(x_{i})   , with x i = , and n the degree.      Closed Newton–Cotes Formulae   Degree   Common name   Formula   Error term     1   Trapezoid rule         b  -  a   2    (    f  0   +   f  1    )           b  a   2      subscript  f  0    subscript  f  1      \frac{b-a}{2}(f_{0}+f_{1})          -       (   b  -  a   )   3   12     f   (  2  )     (  ξ  )             superscript    b  a   3   12    superscript  f  2   ξ     -\frac{(b-a)^{3}}{12}\,f^{(2)}(\xi)        2   Simpson's rule         b  -  a   6    (    f  0   +   4   f  1    +   f  2    )           b  a   6      subscript  f  0     4   subscript  f  1     subscript  f  2      \frac{b-a}{6}(f_{0}+4f_{1}+f_{2})          -       (   b  -  a   )   5   2880     f   (  4  )     (  ξ  )             superscript    b  a   5   2880    superscript  f  4   ξ     -\frac{(b-a)^{5}}{2880}\,f^{(4)}(\xi)        3   Simpson's 3/8 rule         b  -  a   8    (    f  0   +   3   f  1    +   3   f  2    +   f  3    )           b  a   8      subscript  f  0     3   subscript  f  1      3   subscript  f  2     subscript  f  3      \frac{b-a}{8}(f_{0}+3f_{1}+3f_{2}+f_{3})          -       (   b  -  a   )   5   6480     f   (  4  )     (  ξ  )             superscript    b  a   5   6480    superscript  f  4   ξ     -\frac{(b-a)^{5}}{6480}\,f^{(4)}(\xi)        4   Boole's rule         b  -  a   90    (    7   f  0    +   32   f  1    +   12   f  2    +   32   f  3    +   7   f  4     )           b  a   90       7   subscript  f  0      32   subscript  f  1      12   subscript  f  2      32   subscript  f  3      7   subscript  f  4       \frac{b-a}{90}(7f_{0}+32f_{1}+12f_{2}+32f_{3}+7f_{4})          -       (   b  -  a   )   7   1935360     f   (  6  )     (  ξ  )             superscript    b  a   7   1935360    superscript  f  6   ξ     -\frac{(b-a)^{7}}{1935360}\,f^{(6)}(\xi)          Boole's rule is sometimes mistakenly called Bode's rule due to propagation of a typo in Abramowitz and Stegun, an early reference book. 1  The exponent of the segment size b − a in the error term shows the rate at which the approximation error decreases. The derivative of ƒ in the error term shows which polynomials can be integrated exactly (i.e., with error equal to zero). Note that the derivative of ƒ in the error term increases by 2 for every other rule. The number   ξ   ξ   \xi   is between a and b .  Open Newton–Cotes formulae  This table lists some of the Newton–Cotes formulae of the open type. Again, ƒ i is a shorthand for ƒ ( x i ), with x i = , and n the degree.      Open Newton–Cotes Formulae   Common name   step size   Formula   Error term   Degree     Rectangle rule , or midpoint rule        b  -  a   2        b  a   2    \frac{b-a}{2}           (   b  -  a   )     f  1          b  a    subscript  f  1     (b-a)f_{1}\,              (   b  -  a   )   3   24     f   (  2  )     (  ξ  )          superscript    b  a   3   24    superscript  f  2   ξ    \frac{(b-a)^{3}}{24}\,f^{(2)}(\xi)      2     Trapezoid method        b  -  a   3        b  a   3    \frac{b-a}{3}            b  -  a   2    (    f  1   +   f  2    )           b  a   2      subscript  f  1    subscript  f  2      \frac{b-a}{2}(f_{1}+f_{2})              (   b  -  a   )   3   36     f   (  2  )     (  ξ  )          superscript    b  a   3   36    superscript  f  2   ξ    \frac{(b-a)^{3}}{36}\,f^{(2)}(\xi)      3     Milne's rule        b  -  a   4        b  a   4    \frac{b-a}{4}            b  -  a   3    (     2   f  1    -   f  2    +   2   f  3     )           b  a   3         2   subscript  f  1     subscript  f  2      2   subscript  f  3       \frac{b-a}{3}(2f_{1}-f_{2}+2f_{3})            7    (   b  -  a   )   5    23040    f   (  4  )     (  ξ  )           7   superscript    b  a   5    23040    superscript  f  4   ξ    \frac{7(b-a)^{5}}{23040}f^{(4)}(\xi)      4     No Name        b  -  a   5        b  a   5    \frac{b-a}{5}            b  -  a   24    (    11   f  1    +   f  2   +   f  3   +   11   f  4     )           b  a   24       11   subscript  f  1     subscript  f  2    subscript  f  3     11   subscript  f  4       \frac{b-a}{24}(11f_{1}+f_{2}+f_{3}+11f_{4})            19    (   b  -  a   )   5    90000    f   (  4  )     (  ξ  )           19   superscript    b  a   5    90000    superscript  f  4   ξ    \frac{19(b-a)^{5}}{90000}f^{(4)}(\xi)      5     Composite rules  For the Newton–Cotes rules to be accurate, the step size h needs to be small, which means that the interval of integration    [  a  ,  b  ]     a  b    [a,b]   must be small itself, which is not true most of the time. For this reason, one usually performs numerical integration by splitting    [  a  ,  b  ]     a  b    [a,b]   into smaller subintervals, applying a Newton–Cotes rule on each subinterval, and adding up the results. This is called a composite rule , see Numerical integration .  See also   Quadrature (mathematics)  Interpolation  Spline interpolation   References     M. Abramowitz and I. A. Stegun, eds. Handbook of Mathematical Functions with Formulae, Graphs, and Mathematical Tables . New York: Dover, 1972. (See Section 25.4.)  George E. Forsythe, Michael A. Malcolm, and Cleve B. Moler. Computer Methods for Mathematical Computations . Englewood Cliffs, NJ: Prentice–Hall, 1977. (See Section 5.1.)   Josef Stoer and Roland Bulirsch. Introduction to Numerical Analysis . New York: Springer-Verlag, 1980. (See Section 3.1.)   External links    Newton–Cotes formulae on www.math-linux.com   Module for Newton–Cotes Integration , fullerton.edu  Newton–Cotes Integration , numericalmathematics.com   "  Category:Numerical integration (quadrature)     Booles Rule at Wolfram Mathworld ↩     
   Circulant matrix      Circulant matrix   In linear algebra , a circulant matrix is a special kind of Toeplitz matrix where each row vector is rotated one element to the right relative to the preceding row vector. In numerical analysis , circulant matrices are important because they are diagonalized by a discrete Fourier transform , and hence linear equations that contain them may be quickly solved using a fast Fourier transform . 1 They can be interpreted analytically as the integral kernel of a convolution operator on the cyclic group      â„¤  /  n   â„¤        â„¤  n   â„¤    \mathbb{Z}/n\mathbb{Z}   and hence frequently appear in formal descriptions of spatially invariant linear operations. In cryptography , a circulant matrix is used in the MixColumns step of the Advanced Encryption Standard .  Definition  An    n  Ã—  n      n  n    n\times n   circulant matrix    C    C   \ C   takes the form       C  =   [      c  0      c   n  -  1      â€¦     c  2      c  1        c  1      c  0      c   n  -  1          c  2       â‹®     c  1      c  0     â‹±    â‹®       c   n  -  2         â‹±    â‹±     c   n  -  1         c   n  -  1       c   n  -  2      â€¦     c  1      c  0      ]    .      C     subscript  c  0    subscript  c    n  1    normal-â€¦   subscript  c  2    subscript  c  1      subscript  c  1    subscript  c  0    subscript  c    n  1    absent   subscript  c  2     normal-â‹®   subscript  c  1    subscript  c  0   normal-â‹±  normal-â‹®     subscript  c    n  2    absent  normal-â‹±  normal-â‹±   subscript  c    n  1       subscript  c    n  1     subscript  c    n  2    normal-â€¦   subscript  c  1    subscript  c  0       C=\begin{bmatrix}c_{0}&c_{n-1}&\dots&c_{2}&c_{1}\\
 c_{1}&c_{0}&c_{n-1}&&c_{2}\\
 \vdots&c_{1}&c_{0}&\ddots&\vdots\\
 c_{n-2}&&\ddots&\ddots&c_{n-1}\\
 c_{n-1}&c_{n-2}&\dots&c_{1}&c_{0}\\
 \end{bmatrix}.     A circulant matrix is fully specified by one vector,    c    c   \ c   , which appears as the first column of    C    C   \ C   . The remaining columns of    C    C   \ C   are each cyclic permutations of the vector    c    c   \ c   with offset equal to the column index. The last row of    C    C   \ C   is the vector    c    c   \ c   in reverse order, and the remaining rows are each cyclic permutations of the last row. Note that different sources define the circulant matrix in different ways, for example with the coefficients corresponding to the first row rather than the first column of the matrix, or with a different direction of shift.  The polynomial     f   (  x  )    =    c  0   +    c  1   x   +  â€¦  +    c   n  -  1     x   n  -  1            f  x      subscript  c  0      subscript  c  1   x   normal-â€¦     subscript  c    n  1     superscript  x    n  1        f(x)=c_{0}+c_{1}x+\dots+c_{n-1}x^{n-1}   is called the associated polynomial of matrix   C   C   C   .  Properties  Eigenvectors and eigenvalues  The normalized eigenvectors of a circulant matrix are given by         v  j   =    1   n      (  1  ,   Ï‰  j   ,   Ï‰  j  2   ,  â€¦  ,   Ï‰  j   n  -  1    )   T     ,   j  =   0  ,  1  ,  â€¦  ,   n  -  1      ,     formulae-sequence     subscript  v  j       1    n     superscript   1   subscript  Ï‰  j    superscript   subscript  Ï‰  j   2   normal-â€¦   superscript   subscript  Ï‰  j     n  1     T       j   0  1  normal-â€¦    n  1       v_{j}=\frac{1}{\sqrt{n}}(1,~{}\omega_{j},~{}\omega_{j}^{2},~{}\ldots,~{}\omega%
 _{j}^{n-1})^{T},\quad j=0,1,\ldots,n-1,   where     Ï‰  j   =   exp   (    2  Ï€  i  j   n   )         subscript  Ï‰  j         2  Ï€  i  j   n      \omega_{j}=\exp\left(\tfrac{2\pi ij}{n}\right)   are the n -th roots of unity and   i   i   i   is the imaginary unit .  The corresponding eigenvalues are then given by        Î»  j   =    c  0   +    c   n  -  1     Ï‰  j    +    c   n  -  2     Ï‰  j  2    +  â€¦  +    c  1    Ï‰  j   n  -  1       ,   j  =    0  â€¦  n   -  1.       formulae-sequence     subscript  Î»  j      subscript  c  0      subscript  c    n  1     subscript  Ï‰  j       subscript  c    n  2     superscript   subscript  Ï‰  j   2    normal-â€¦     subscript  c  1    superscript   subscript  Ï‰  j     n  1         j      0  normal-â€¦  n   1.      \lambda_{j}=c_{0}+c_{n-1}\omega_{j}+c_{n-2}\omega_{j}^{2}+\ldots+c_{1}\omega_{%
 j}^{n-1},\qquad j=0\ldots n-1.     Determinant  As a consequence of the explicit formula for the eigenvalues above, the determinant of circulant matrix can be computed as:        det   (  C  )    =    âˆ   j  =  0    n  -  1     (    c  0   +    c   n  -  1     Ï‰  j    +    c   n  -  2     Ï‰  j  2    +  â€¦  +    c  1    Ï‰  j   n  -  1      )     .        det  C     superscript   subscript  product    j  0      n  1       subscript  c  0      subscript  c    n  1     subscript  Ï‰  j       subscript  c    n  2     superscript   subscript  Ï‰  j   2    normal-â€¦     subscript  c  1    superscript   subscript  Ï‰  j     n  1         \mathrm{det}(C)=\prod_{j=0}^{n-1}(c_{0}+c_{n-1}\omega_{j}+c_{n-2}\omega_{j}^{2%
 }+\dots+c_{1}\omega_{j}^{n-1}).   Since taking transpose does not change the eigenvalues of a matrix, an equivalent formulation is        det   (  C  )    =    âˆ   j  =  0    n  -  1     (    c  0   +    c  1    Ï‰  j    +    c  2    Ï‰  j  2    +  â€¦  +    c   n  -  1     Ï‰  j   n  -  1      )    =    âˆ   j  =  0    n  -  1     f   (   Ï‰  j   )      .          det  C     superscript   subscript  product    j  0      n  1       subscript  c  0      subscript  c  1    subscript  Ï‰  j       subscript  c  2    superscript   subscript  Ï‰  j   2    normal-â€¦     subscript  c    n  1     superscript   subscript  Ï‰  j     n  1              superscript   subscript  product    j  0      n  1      f   subscript  Ï‰  j        \mathrm{det}(C)=\prod_{j=0}^{n-1}(c_{0}+c_{1}\omega_{j}+c_{2}\omega_{j}^{2}+%
 \dots+c_{n-1}\omega_{j}^{n-1})=\prod_{j=0}^{n-1}f(\omega_{j}).     Rank  The rank of circulant matrix   C   C   C   is equal to    n  -  d      n  d    n-d   , where   d   d   d   is the degree of    gcd   (   f   (  x  )    ,    x  n   -  1   )         f  x      superscript  x  n   1     \gcd(f(x),x^{n}-1)   . 2  Other properties   We have          C  =     c  0   I   +    c  1   P   +    c  2    P  2    +  â€¦  +    c   n  -  1     P   n  -  1      =   f   (  P  )     .        C       subscript  c  0   I      subscript  c  1   P      subscript  c  2    superscript  P  2    normal-â€¦     subscript  c    n  1     superscript  P    n  1             f  P      C=c_{0}I+c_{1}P+c_{2}P^{2}+\ldots+c_{n-1}P^{n-1}=f(P).       where P is the 'cyclic permutation' matrix, a specific permutation matrix given by : P=    \begin{bmatrix}  0&0&\ldots&0&1\\  1&0&\ldots&0&0\\  0&\ddots&\ddots&\vdots&\vdots\\  \vdots&\ddots&\ddots&0&0\\  0&\ldots&0&1&0  \end{bmatrix}.   The set of    n  Ã—  n      n  n    n\times n   circulant matrices forms an n - dimensional  vector space ; this can be interpreted as the space of functions on the cyclic group of order n ,      ğ™  /  n   ğ™   ,        ğ™  n   ğ™    \mathbf{Z}/n\mathbf{Z},   or equivalently the group ring .    Circulant matrices form a commutative algebra , since for any two given circulant matrices    A    A   \ A   and    B    B   \ B   , the sum     A   +  B      A  B    \ A+B   is circulant, the product     A   B      A  B    \ AB   is circulant, and      A   B   =   B  A         A  B     B  A     \ AB=BA   .    The matrix U that is composed of the eigenvectors of a circulant matrix is related to the Discrete Fourier transform and its Inverse transform:     U_n^{*} = \frac{1}{\sqrt{n}} F_n, \quad\text{and}\quad U_n = \sqrt{n} F_n^{-1}, \quad\text{where}\quad F_n = (f_{jk}) \quad\text{with}\quad f_{jk} = \mathrm{e}^{-2jk\pi\mathrm{i}/n}, \quad\text{for}\quad 0\leq j,k     Thus, the matrix    U  n     subscript  U  n    U_{n}    diagonalizes  C . In fact, we have      C  =    U  n     diag   (    F  n   c   )     U  n  *     =    F  n   -  1      diag   (    F  n   c   )     F  n      ,        C     subscript  U  n     diag     subscript  F  n   c     superscript   subscript  U  n               superscript   subscript  F  n     1      diag     subscript  F  n   c     subscript  F  n        C=U_{n}\operatorname{diag}(F_{n}c)U_{n}^{*}=F_{n}^{-1}\operatorname{diag}(F_{n%
 }c)F_{n},      where   c   c   c\!\,   is the first column of   C   C   C\,\!   . Thus, the eigenvalues of   C   C   C   are given by the product      F   n   c       subscript  F  n   c    \ F_{n}c   . This product can be readily calculated by a Fast Fourier transform . 3    Analytic interpretation  Circulant matrices can be interpreted geometrically, which explains the connection with the discrete Fourier transform.  Consider vectors in    ğ‘  n     superscript  ğ‘  n    \mathbf{R}^{n}   as functions on the integers with period n, (i.e., as periodic bi-infinite sequences    â€¦  ,   a  0   ,   a  1   ,  â€¦  ,   a   n  -  1    ,   a  0   ,   a  1   ,  â€¦     normal-â€¦   subscript  a  0    subscript  a  1   normal-â€¦   subscript  a    n  1     subscript  a  0    subscript  a  1   normal-â€¦    \dots,a_{0},a_{1},\dots,a_{n-1},a_{0},a_{1},\dots   ) or equivalently, as functions on the cyclic group of order n, (    C  n     subscript  C  n    C_{n}   or     ğ™  /  n   ğ™        ğ™  n   ğ™    \mathbf{Z}/n\mathbf{Z}   ) geometrically, on (the vertices of) the regular n -gon: this is a discrete analog to periodic functions on the real line or circle.  Then, from the perspective of operator theory , a circulant matrix is the kernel of a discrete integral transform , namely the convolution operator for the function     (   c  0   ,   c  1   ,  â€¦  ,   c   n  -  1    )   ;      subscript  c  0    subscript  c  1   normal-â€¦   subscript  c    n  1      (c_{0},c_{1},\dots,c_{n-1});   this is a discrete circular convolution . The formula for the convolution of the functions     (   b  i   )   :=    (   c  i   )   *   (   a  i   )       assign   subscript  b  i      subscript  c  i    subscript  a  i      (b_{i}):=(c_{i})*(a_{i})   is       b  k   =    âˆ‘   i  =  0    n  -  1      a  i    c   k  -  i           subscript  b  k     superscript   subscript     i  0      n  1       subscript  a  i    subscript  c    k  i        b_{k}=\sum_{i=0}^{n-1}a_{i}c_{k-i}   (recall that the sequences are periodic) which is the product of the vector of    a  i     subscript  a  i    a_{i}   by the circulant matrix.  The discrete Fourier transform then converts convolution into multiplication, which in the matrix setting corresponds to diagonalization.  Applications  In linear equations  Given a matrix equation        ğ‚ğ±   =  ğ›   ,      ğ‚ğ±  ğ›    \ \mathbf{C}\mathbf{x}=\mathbf{b},   where    C    C   \ C   is a circulant square matrix of size    n    n   \ n   we can write the equation as the circular convolution         ğœ   â‹†  ğ±   =  ğ›   ,       normal-â‹†  ğœ  ğ±   ğ›    \ \mathbf{c}\star\mathbf{x}=\mathbf{b},   where    c    c   \ c   is the first column of    C    C   \ C   , and the vectors    c    c   \ c   ,    x    x   \ x   and    b    b   \ b   are cyclically extended in each direction. Using the results of the circular convolution theorem , we can use the discrete Fourier transform to transform the cyclic convolution into component-wise multiplication         â„±   n    (   ğœ  â‹†  ğ±   )    =    â„±  n    (  ğœ  )    â„±  n    (  ğ±  )    =    â„±  n    (  ğ›  )             subscript  â„±  n    normal-â‹†  ğœ  ğ±       subscript  â„±  n   ğœ   subscript  â„±  n   ğ±           subscript  â„±  n   ğ›      \ \mathcal{F}_{n}(\mathbf{c}\star\mathbf{x})=\mathcal{F}_{n}(\mathbf{c})%
 \mathcal{F}_{n}(\mathbf{x})=\mathcal{F}_{n}(\mathbf{b})     so that        ğ±   =    â„±  n   -  1      [    (     (    â„±  n    (  ğ›  )    )   Î½     (    â„±  n    (  ğœ  )    )   Î½    )    Î½  âˆˆ  ğ™    ]   T     .      ğ±     superscript   subscript  â„±  n     1     superscript   delimited-[]   subscript     subscript     subscript  â„±  n   ğ›   Î½    subscript     subscript  â„±  n   ğœ   Î½      Î½  ğ™     T      \ \mathbf{x}=\mathcal{F}_{n}^{-1}\left[\left(\frac{(\mathcal{F}_{n}(\mathbf{b}%
 ))_{\nu}}{(\mathcal{F}_{n}(\mathbf{c}))_{\nu}}\right)_{\nu\in\mathbf{Z}}\right%
 ]^{T}.     This algorithm is much faster than the standard Gaussian elimination , especially if a fast Fourier transform is used.  In graph theory  In graph theory , a graph or digraph whose adjacency matrix is circulant is called a circulant graph (or digraph). Equivalently, a graph is circulant if its automorphism group contains a full-length cycle. The MÃ¶bius ladders are examples of circulant graphs, as are the Paley graphs for fields of prime order.  References  External links   R. M. Gray, Toeplitz and Circulant Matrices: A Review    "  Category:Numerical linear algebra  Category:Matrices  Category:Latin squares  Category:Determinants     Davis, Philip J. , Circulant Matrices, Wiley, New York, 1970 ISBN 0471057711 â†©  â†©  â†©     
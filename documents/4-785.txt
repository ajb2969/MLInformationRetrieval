   Malliavin calculus      Malliavin calculus   The Malliavin calculus , named after Paul Malliavin , extends the calculus of variations from functions to stochastic processes . The Malliavin calculus is also called the stochastic calculus of variations . In particular, it allows the computation of derivatives of random variables .  Malliavin's ideas led to a proof that Hörmander's condition implies the existence and smoothness of a density for the solution of a stochastic differential equation ; Hörmander 's original proof was based on the theory of partial differential equations . The calculus has been applied to stochastic partial differential equations as well.  The calculus allows integration by parts with random variables ; this operation is used in mathematical finance to compute the sensitivities of financial derivatives . The calculus has applications in, for example, stochastic filtering .  Overview and history  Paul Malliavin's stochastic calculus of variations extends the calculus of variations from functions to stochastic processes . In particular, it allows the computation of derivatives of random variables .  Malliavin invented his calculus to provide a stochastic proof that Hörmander's condition implies the existence of a density for the solution of a stochastic differential equation ; Hörmander 's original proof was based on the theory of partial differential equations . His calculus enabled Malliavin to prove regularity bounds for the solution's density. The calculus has been applied to stochastic partial differential equations .  Invariance principle  The usual invariance principle for Lebesgue integration over the whole real line is that, for any real number ε and integrable function f , the following holds         ∫   -  ∞   ∞    f   (  x  )   d  λ   (  x  )     =    ∫   -  ∞   ∞    f   (   x  +  ε   )   d  λ   (  x  )      .        superscript   subscript            f  x  d  λ  x      superscript   subscript            f    x  ε   d  λ  x      \int_{-\infty}^{\infty}f(x)\,d\lambda(x)=\int_{-\infty}^{\infty}f(x+%
 \varepsilon)\,d\lambda(x).     This can be used to derive the integration by parts formula since, setting f = gh and differentiating with respect to ε on both sides, it implies         ∫   -  ∞   ∞      f  ′    d  λ    =    ∫   -  ∞   ∞       (   g  h   )   ′    d  λ    =     ∫   -  ∞   ∞    g    h  ′    d  λ    +    ∫   -  ∞   ∞     g  ′    h   d  λ      .          superscript   subscript             superscript  f  normal-′   d  λ      superscript   subscript             superscript    g  h   normal-′   d  λ             superscript   subscript            g   superscript  h  normal-′   d  λ      superscript   subscript             superscript  g  normal-′   h  d  λ        \int_{-\infty}^{\infty}f^{\prime}\,d\lambda=\int_{-\infty}^{\infty}(gh)^{%
 \prime}\,d\lambda=\int_{-\infty}^{\infty}gh^{\prime}\,d\lambda+\int_{-\infty}^%
 {\infty}g^{\prime}h\,d\lambda.     A similar idea can be applied in stochastic analysis for the differentiation along a Cameron-Martin-Girsanov direction. Indeed, let    h  s     subscript  h  s    h_{s}   be a square-integrable predictable process and set        φ   (  t  )    =    ∫  0  t      h  s    d  s     .        φ  t     superscript   subscript   0   t      subscript  h  s   d  s      \varphi(t)=\int_{0}^{t}h_{s}\,ds.     If   X   X   X   is a Wiener process , the Girsanov theorem then yields the following analogue of the invariance principle:        E   (   F   (   X  +   ε  φ    )    )    =   E   [   F   (  X  )    exp   (    ε    ∫  0  1      h  s    d   X  s      -    1  2    ε  2     ∫  0  1      h  s  2    d  s      )     ]     .        E    F    X    ε  φ        E   delimited-[]    F  X        ε    superscript   subscript   0   1      subscript  h  s   d   subscript  X  s          1  2    superscript  ε  2     superscript   subscript   0   1      superscript   subscript  h  s   2   d  s            E(F(X+\varepsilon\varphi))=E\left[F(X)\exp\left(\varepsilon\int_{0}^{1}h_{s}\,%
 dX_{s}-\frac{1}{2}\varepsilon^{2}\int_{0}^{1}h_{s}^{2}\,ds\right)\right].     Differentiating with respect to ε on both sides and evaluating at ε=0, one obtains the following integration by parts formula:        E   (   ⟨   D  F   (  X  )    ,  φ  ⟩   )    =   E   [   F   (  X  )     ∫  0  1      h  s    d   X  s      ]     .        E     D  F  X   φ      E   delimited-[]    F  X    superscript   subscript   0   1      subscript  h  s   d   subscript  X  s          E(\langle DF(X),\varphi\rangle)=E\Bigl[F(X)\int_{0}^{1}h_{s}\,dX_{s}\Bigr].     Here, the left-hand side is the Malliavin derivative of the random variable   F   F   F   in the direction   φ   φ   \varphi   and the integral appearing on the right hand side should be interpreted as an Itô integral . This expression also remains true (by definition) if   h   h   h   is not adapted, provided that the right hand side is interpreted as a Skorokhod integral .  Clark-Ocone formula  One of the most useful results from Malliavin calculus is the Clark-Ocone theorem , which allows the process in the martingale representation theorem to be identified explicitly. A simplified version of this theorem is as follows:  For    F  :    C   [  0  ,  1  ]    →   \R       normal-:  F   normal-→    C   0  1    \R     F:C[0,1]\to\R   satisfying     E   (   F    (  X  )   2    )    <  ∞        E    F   superscript  X  2        E(F(X)^{2})<\infty   which is Lipschitz and such that F has a strong derivative kernel, in the sense that for   φ   φ   \varphi   in C [0,1]         lim   ε  →  0      (   1  /  ε   )    (    F   (   X  +   ε  φ    )    -   F   (  X  )     )     =    ∫  0  1     F  ′    (  X  ,   d  t   )   φ   (  t  )   a     .  e  .  X     formulae-sequence      subscript    normal-→  ε  0        1  ε       F    X    ε  φ       F  X        superscript   subscript   0   1      superscript  F  normal-′    X    d  t    φ  t  normal-a     normal-e  X    \lim_{\varepsilon\to 0}(1/\varepsilon)(F(X+\varepsilon\varphi)-F(X))=\int_{0}^%
 {1}F^{\prime}(X,dt)\varphi(t)\ \mathrm{a.e.}\ X     then        F   (  X  )    =    E   (   F   (  X  )    )    +    ∫  0  1      H  t    d   X  t       ,        F  X       E    F  X      superscript   subscript   0   1      subscript  H  t   d   subscript  X  t        F(X)=E(F(X))+\int_{0}^{1}H_{t}\,dX_{t},     where H is the previsible projection of F '( x , ( t ,1]) which may be viewed as the derivative of the function F with respect to a suitable parallel shift of the process X over the portion ( t ,1] of its domain.  This may be more concisely expressed by      F   (  X  )   =  E   (  F   (  X  )   )   +   ∫  0  1   E   (   D  t   F  |   ℱ  t   )   d   X  t   .     fragments  F   fragments  normal-(  X  normal-)    E   fragments  normal-(  F   fragments  normal-(  X  normal-)   normal-)     superscript   subscript   0   1   E   fragments  normal-(   subscript  D  t   F  normal-|   subscript  ℱ  t   normal-)   d   subscript  X  t   normal-.    F(X)=E(F(X))+\int_{0}^{1}E(D_{t}F|\mathcal{F}_{t})\,dX_{t}.     Much of the work in the formal development of the Malliavin calculus involves extending this result to the largest possible class of functionals F by replacing the derivative kernel used above by the " Malliavin derivative " denoted    D  t     subscript  D  t    D_{t}   in the above statement of the result.  Skorokhod integral  The Skorokhod integral operator which is conventionally denoted δ is defined as the adjoint of the Malliavin derivative thus for u in the domain of the operator which is a subset of     L  2    (    [  0  ,  ∞  )   ×  Ω   )        superscript  L  2      0    normal-Ω     L^{2}([0,\infty)\times\Omega)   , for F in the domain of the Malliavin derivative, we require        E   (   ⟨   D  F   ,  u  ⟩   )    =   E   (   F  δ   (  u  )    )     ,        E     D  F   u      E    F  δ  u      E(\langle DF,u\rangle)=E(F\delta(u)),     where the inner product is that on     L  2    [  0  ,  ∞  )        superscript  L  2    0      L^{2}[0,\infty)   viz        ⟨  f  ,  g  ⟩   =    ∫  0  ∞    f   (  s  )   g   (  s  )   d  s     .       f  g     superscript   subscript   0       f  s  g  s  d  s      \langle f,g\rangle=\int_{0}^{\infty}f(s)g(s)\,ds.     The existence of this adjoint follows from the Riesz representation theorem for linear operators on Hilbert spaces .  It can be shown that if u is adapted then        δ   (  u  )    =    ∫  0  ∞      u  t    d   W  t      ,        δ  u     superscript   subscript   0        subscript  u  t   d   subscript  W  t       \delta(u)=\int_{0}^{\infty}u_{t}\,dW_{t},     where the integral is to be understood in the Itô sense. Thus this provides a method of extending the Itô integral to non adapted integrands.  Applications  The calculus allows integration by parts with random variables ; this operation is used in mathematical finance to compute the sensitivities of financial derivatives . The calculus has applications for example in stochastic filtering .  References   Kusuoka, S. and Stroock, D. (1981) "Applications of Malliavin Calculus I", Stochastic Analysis, Proceedings Taniguchi International Symposium Katata and Kyoto 1982, pp 271–306  Kusuoka, S. and Stroock, D. (1985) "Applications of Malliavin Calculus II", J. Faculty Sci. Uni. Tokyo Sect. 1A Math. , 32 pp 1–76  Kusuoka, S. and Stroock, D. (1987) "Applications of Malliavin Calculus III", J. Faculty Sci. Univ. Tokyo Sect. 1A Math. , 34 pp 391–442  Malliavin, Paul and Thalmaier, Anton. Stochastic Calculus of Variations in Mathematical Finance , Springer 2005, ISBN 3-540-43431-3   Bell, Denis. (2007) The Malliavin Calculus , Dover. ISBN 0-486-44994-7  Schiller, Alex (2009) Malliavin Calculus for Monte Carlo Simulation with Financial Applications . Thesis, Department of Mathematics, Princeton University  Øksendal, Bernt K. .(1997) [ http://www.quantcode.com/modules/wflinks/visit.php?cid=11&lid; ;=4 An Introduction To Malliavin Calculus With Applications To Economics ]. Lecture Notes, Dept. of Mathematics, University of Oslo (Zip file containing Thesis and addendum)  Di Nunno, Giulia, Øksendal, Bernt, Proske, Frank (2009) "Malliavin Calculus for Lévy Processes with Applications to Finance", Universitext, Springer. ISBN 978-3-540-78571-2   External links    Lecture Notes, 43 pages     Thesis, 100 pages   "  Category:Stochastic calculus  Category:Integral calculus  Category:Mathematical finance  Category:Calculus of variations   
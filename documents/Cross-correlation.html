<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="440">Cross-correlation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Cross-correlation</h1>
<hr/>

<p>In <a href="signal_processing" title="wikilink">signal processing</a>, <strong>cross-correlation</strong> is a measure of similarity of two series as a function of the lag of one relative to the other. This is also known as a <em>sliding <a href="dot_product" title="wikilink">dot product</a></em> or <em>sliding inner-product</em>. It is commonly used for searching a long signal for a shorter, known feature. It has applications in <a href="pattern_recognition" title="wikilink">pattern recognition</a>, <a href="single_particle_analysis" title="wikilink">single particle analysis</a>, <a href="electron_tomography" title="wikilink">electron tomography</a>, <a class="uri" href="averaging" title="wikilink">averaging</a>, <a class="uri" href="cryptanalysis" title="wikilink">cryptanalysis</a>, and <a class="uri" href="neurophysiology" title="wikilink">neurophysiology</a>.</p>

<p>For continuous functions <em>f</em> and <em>g</em>, the cross-correlation is defined as<strong>:</strong></p>

<p>

<math display="block" id="Cross-correlation:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>τ</mi>
      <mo rspace="7.5pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mover>
     <mo movablelimits="false">=</mo>
     <mi>def</mi>
    </mover>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>*</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo rspace="7.5pt" stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>t</mi>
        <mo>+</mo>
        <mi>τ</mi>
       </mrow>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋆</ci>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
     <ci>τ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <infinity></infinity>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <times></times>
      </apply>
      <ci>t</ci>
      <ci>g</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <ci>τ</ci>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\star g)(\tau)\ \stackrel{\mathrm{def}}{=}\int_{-\infty}^{\infty}f^{*}(t)\ g%
(t+\tau)\,dt,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Cross-correlation:1">
 <semantics>
  <msup>
   <mi>f</mi>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>f</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{*}
  </annotation>
 </semantics>
</math>

 denotes the <a href="complex_conjugate" title="wikilink">complex conjugate</a> of 

<math display="inline" id="Cross-correlation:2">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cross-correlation:3">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau
  </annotation>
 </semantics>
</math>

 is the lag.</p>

<p>Similarly, for discrete functions, the cross-correlation is defined as<strong>:</strong></p>

<p>

<math display="block" id="Cross-correlation:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo rspace="7.5pt" stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mover>
     <mo movablelimits="false">=</mo>
     <mi>def</mi>
    </mover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>=</mo>
       <mrow>
        <mo>-</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>*</mo>
      </msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>m</mi>
       <mo rspace="7.5pt" stretchy="false">]</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋆</ci>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>m</ci>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>m</ci>
      </apply>
      <ci>g</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\star g)[n]\ \stackrel{\mathrm{def}}{=}\sum_{m=-\infty}^{\infty}f^{*}[m]\ g[%
m+n].
  </annotation>
 </semantics>
</math>

</p>

<p> The cross-correlation is similar in nature to the <a class="uri" href="convolution" title="wikilink">convolution</a> of two functions.</p>

<p>In an <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a>, which is the cross-correlation of a signal with itself, there will always be a peak equal to unity at a lag of zero.</p>

<p>In <a class="uri" href="probability" title="wikilink">probability</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>, the term <strong>cross-correlations</strong> is used for referring to the <a href="covariance_and_correlation" title="wikilink">correlations</a> between the entries of two <a href="Multivariate_random_variable" title="wikilink">random vectors</a> <em>X</em> and <em>Y</em>, while the <em>autocorrelations</em> of a random vector <em>X</em> are considered to be the <a href="covariance_and_correlation" title="wikilink">correlations</a> between the entries of <em>X</em> itself, those forming the <a href="correlation_matrix" title="wikilink">correlation matrix</a> (matrix of correlations) of <em>X</em>. This is analogous to the distinction between <a class="uri" href="autocovariance" title="wikilink">autocovariance</a> of a random vector and <a class="uri" href="cross-covariance" title="wikilink">cross-covariance</a> of two random vectors. One more distinction to point out is that in <a class="uri" href="probability" title="wikilink">probability</a> and <a class="uri" href="statistics" title="wikilink">statistics</a> the definition of <em>correlation</em> always includes a standardising factor in such a way that correlations have values between −1 and +1.</p>

<p>If 

<math display="inline" id="Cross-correlation:5">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cross-correlation:6">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are two <a href="independent_(probability)" title="wikilink">independent</a> <a href="random_variable" title="wikilink">random variables</a> with <a href="probability_density_function" title="wikilink">probability density functions</a> <em>f</em> and <em>g</em>, respectively, then the probability density of the difference 

<math display="inline" id="Cross-correlation:7">
 <semantics>
  <mrow>
   <mi>Y</mi>
   <mo>-</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>Y</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y-X
  </annotation>
 </semantics>
</math>

 is formally given by the cross-correlation (in the signal-processing sense) 

<math display="inline" id="Cross-correlation:8">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>⋆</mo>
   <mi>g</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋆</ci>
    <ci>f</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\star g
  </annotation>
 </semantics>
</math>

; however this terminology is not used in probability and statistics. In contrast, the <a class="uri" href="convolution" title="wikilink">convolution</a> 

<math display="inline" id="Cross-correlation:9">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>*</mo>
   <mi>g</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f*g
  </annotation>
 </semantics>
</math>

 (equivalent to the cross-correlation of <em>f</em>(<em>t</em>) and <em>g</em>(−<em>t</em>) ) gives the probability density function of the sum 

<math display="inline" id="Cross-correlation:10">
 <semantics>
  <mrow>
   <mi>X</mi>
   <mo>+</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>X</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X+Y
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="explanation">Explanation</h2>

<p>As an example, consider two real valued functions 

<math display="inline" id="Cross-correlation:11">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cross-correlation:12">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 differing only by an unknown shift along the x-axis. One can use the cross-correlation to find how much 

<math display="inline" id="Cross-correlation:13">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 must be shifted along the x-axis to make it identical to 

<math display="inline" id="Cross-correlation:14">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

. The formula essentially slides the 

<math display="inline" id="Cross-correlation:15">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 function along the x-axis, calculating the integral of their product at each position. When the functions match, the value of 

<math display="inline" id="Cross-correlation:16">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>f</mi>
    <mo>⋆</mo>
    <mi>g</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋆</ci>
    <ci>f</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\star g)
  </annotation>
 </semantics>
</math>

 is maximized. This is because when peaks (positive areas) are aligned, they make a large contribution to the integral. Similarly, when troughs (negative areas) align, they also make a positive contribution to the integral because the product of two negative numbers is positive.</p>

<p>With <a href="complex-valued_function" title="wikilink">complex-valued functions</a> 

<math display="inline" id="Cross-correlation:17">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cross-correlation:18">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, taking the <a href="Complex_conjugate" title="wikilink">conjugate</a> of 

<math display="inline" id="Cross-correlation:19">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 ensures that aligned peaks (or aligned troughs) with imaginary components will contribute positively to the integral.</p>

<p>In <a class="uri" href="econometrics" title="wikilink">econometrics</a>, lagged cross-correlation is sometimes referred to as cross-autocorrelation.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="properties">Properties</h2>
<ul>
<li>The cross-correlation of functions <em>f</em>(<em>t</em>) and <em>g</em>(<em>t</em>) is equivalent to the <a class="uri" href="convolution" title="wikilink">convolution</a> of <em>f</em><sup>*</sup>(−<em>t</em>) and <em>g</em>(<em>t</em>). That is:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Cross-correlation:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mo>⋆</mo>
     <mi>g</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>*</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>t</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>*</mo>
     <mi>g</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋆</ci>
     <ci>f</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <times></times>
      </apply>
      <apply>
       <minus></minus>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\star g=f^{*}(-t)*g.
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<ul>
<li>If <em>f</em> is a <a href="Hermitian_function" title="wikilink">Hermitian function</a>, then 

<math display="inline" id="Cross-correlation:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mo>⋆</mo>
     <mi>g</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mo>*</mo>
     <mi>g</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋆</ci>
     <ci>f</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\star g=f*g.
  </annotation>
 </semantics>
</math>

</li>
</ul>
<ul>
<li>

<math display="inline" id="Cross-correlation:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>⋆</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>f</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>⋆</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋆</ci>
     <apply>
      <ci>normal-⋆</ci>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
     <apply>
      <ci>normal-⋆</ci>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋆</ci>
     <apply>
      <ci>normal-⋆</ci>
      <ci>f</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <ci>normal-⋆</ci>
      <ci>g</ci>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\star g)\star(f\star g)=(f\star f)\star(g\star g).
  </annotation>
 </semantics>
</math>

</li>
</ul>
<ul>
<li>Analogous to the <a href="convolution_theorem" title="wikilink">convolution theorem</a>, the cross-correlation satisfies</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Cross-correlation:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℱ</mi>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi class="ltx_font_mathcaligraphic">ℱ</mi>
         <mrow>
          <mo stretchy="false">{</mo>
          <mi>f</mi>
          <mo stretchy="false">}</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>*</mo>
      </msup>
      <mo>⋅</mo>
      <mi class="ltx_font_mathcaligraphic">ℱ</mi>
     </mrow>
     <mrow>
      <mo stretchy="false">{</mo>
      <mi>g</mi>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ℱ</ci>
     <set>
      <apply>
       <ci>normal-⋆</ci>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
     </set>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <ci>ℱ</ci>
        <set>
         <ci>f</ci>
        </set>
       </apply>
       <times></times>
      </apply>
      <ci>ℱ</ci>
     </apply>
     <set>
      <ci>g</ci>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}\{f\star g\}=(\mathcal{F}\{f\})^{*}\cdot\mathcal{F}\{g\},
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>where 

<math display="inline" id="Cross-correlation:24">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℱ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℱ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{F}
  </annotation>
 </semantics>
</math>

 denotes the <a href="Fourier_transform" title="wikilink">Fourier transform</a>, and an asterisk again indicates the complex conjugate. Coupled with <a href="fast_Fourier_transform" title="wikilink">fast Fourier transform</a> algorithms, this property is often exploited for the efficient numerical computation of cross-correlations (see <a href="Discrete_Fourier_transform#Circular_convolution_theorem_and_cross-correlation_theorem" title="wikilink">circular cross-correlation</a>).
</dd>
</dl>
<ul>
<li>The cross-correlation is related to the <a href="spectral_density" title="wikilink">spectral density</a> (see <a href="Wiener–Khinchin_theorem" title="wikilink">Wiener–Khinchin theorem</a>).</li>
</ul>
<ul>
<li>The cross-correlation of a convolution of <em>f</em> and <em>h</em> with a function <em>g</em> is the convolution of the cross-correlation of <em>f</em> and <em>g</em> with the kernel <em>h</em>:</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Cross-correlation:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>*</mo>
       <mi>h</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>⋆</mo>
     <mi>g</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mo>-</mo>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>*</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>⋆</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋆</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>h</ci>
     </apply>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <ci>h</ci>
      <minus></minus>
     </apply>
     <apply>
      <ci>normal-⋆</ci>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f*h)\star g=h(-)*(f\star g).
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<h2 id="time-series-analysis">Time series analysis</h2>

<p>In <a href="time_series_analysis" title="wikilink">time series analysis</a>, as applied in <a class="uri" href="statistics" title="wikilink">statistics</a> and <a href="signal_processing" title="wikilink">signal processing</a>, the cross-correlation between two time series describes the normalized cross-covariance function.</p>

<p>Let 

<math display="inline" id="Cross-correlation:26">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{t},Y_{t})
  </annotation>
 </semantics>
</math>

 represent a pair of <a href="stochastic_process" title="wikilink">stochastic processes</a> that are jointly <a href="wide-sense_stationary" title="wikilink">wide-sense stationary</a>. Then the cross-covariance and the cross-correlation are given by</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><a class="uri" href="cross-covariance" title="wikilink">cross-covariance</a></p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Cross-correlation:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>γ</mi>
      <mrow>
       <mi>X</mi>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>X</mi>
          <mi>t</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>μ</mi>
          <mi>X</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>Y</mi>
          <mrow>
           <mi>t</mi>
           <mo>+</mo>
           <mi>τ</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>μ</mi>
          <mi>Y</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>γ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <ci>τ</ci>
    </apply>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>t</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <apply>
         <plus></plus>
         <ci>t</ci>
         <ci>τ</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>μ</ci>
        <ci>Y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{XY}(\tau)=\operatorname{E}[(X_{t}-\mu_{X})(Y_{t+\tau}-\mu_{Y})],
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><a class="uri" href="cross-correlation" title="wikilink">cross-correlation</a></p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Cross-correlation:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>ρ</mi>
      <mrow>
       <mi>X</mi>
       <mi>Y</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>X</mi>
           <mi>t</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>μ</mi>
           <mi>X</mi>
          </msub>
         </mrow>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>Y</mi>
           <mrow>
            <mi>t</mi>
            <mo>+</mo>
            <mi>τ</mi>
           </mrow>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>μ</mi>
           <mi>Y</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>σ</mi>
        <mi>X</mi>
       </msub>
       <msub>
        <mi>σ</mi>
        <mi>Y</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ρ</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <ci>τ</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-E</ci>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>t</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <ci>X</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Y</ci>
         <apply>
          <plus></plus>
          <ci>t</ci>
          <ci>τ</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>μ</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <ci>Y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{XY}(\tau)=\operatorname{E}[(X_{t}-\mu_{X})\,(Y_{t+\tau}-\mu_{Y})]/(%
\sigma_{X}\sigma_{Y}),
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>where 

<math display="inline" id="Cross-correlation:29">
 <semantics>
  <msub>
   <mi>μ</mi>
   <mi>X</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>μ</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{X}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cross-correlation:30">
 <semantics>
  <msub>
   <mi>σ</mi>
   <mi>X</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>σ</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{X}
  </annotation>
 </semantics>
</math>

 are the mean and standard deviation of the process 

<math display="inline" id="Cross-correlation:31">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{t})
  </annotation>
 </semantics>
</math>

, which are constant over time due to stationarity; and similarly for 

<math display="inline" id="Cross-correlation:32">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Y_{t})
  </annotation>
 </semantics>
</math>

, respectively. That the cross-covariance and cross-correlation are independent of <em>t</em> is precisely the additional information (beyond being individually wide-sense stationary) conveyed by the requirement that 

<math display="inline" id="Cross-correlation:33">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>Y</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <ci>t</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X_{t},Y_{t})
  </annotation>
 </semantics>
</math>

 are <em>jointly</em> wide-sense stationary.</p>

<p>The cross-correlation of a pair of jointly <a href="wide_sense_stationary" title="wikilink">wide sense stationary</a> <a href="stochastic_process" title="wikilink">stochastic process</a> can be estimated by averaging the product of samples measured from one process and samples measured from the other (and its time shifts). The samples included in the average can be an arbitrary subset of all the samples in the signal (e.g., samples within a finite time window or a <a href="sampling_(statistics)" title="wikilink">sub-sampling</a> of one of the signals). For a large number of samples, the average converges to the true cross-correlation.</p>
<h2 id="time-delay-analysis">Time delay analysis</h2>

<p><strong>Cross-correlations</strong> are useful for determining the time delay between two signals, e.g. for determining time delays for the propagation of acoustic signals across a microphone array.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> After calculating the <strong>cross-correlation</strong> between the two signals, the maximum (or minimum if the signals are negatively correlated) of the cross-correlation function indicates the point in time where the signals are best aligned, i.e. the time delay between the two signals is determined by the argument of the maximum, or <a href="arg_max" title="wikilink">arg max</a> of the <strong>cross-correlation</strong>, as in</p>

<p>

<math display="block" id="Cross-correlation:34">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mi>delay</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munder accentunder="true">
     <mrow>
      <mpadded width="+1.7pt">
       <mi>arg</mi>
      </mpadded>
      <mi>max</mi>
     </mrow>
     <mo>𝑡</mo>
    </munder>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>⋆</mo>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>τ</ci>
     <ci>delay</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>t</ci>
      <apply>
       <times></times>
       <ci>arg</ci>
       <ci>max</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋆</ci>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{\mathrm{delay}}=\underset{t}{\operatorname{arg\,max}}((f\star g)(t))
  </annotation>
 </semantics>
</math>

</p>
<h2 id="normalized-cross-correlation">Normalized cross-correlation</h2>

<p>For image-processing applications in which the brightness of the image and template can vary due to lighting and exposure conditions, the images can be first normalized. This is typically done at every step by subtracting the mean and dividing by the <a href="standard_deviation" title="wikilink">standard deviation</a>. That is, the cross-correlation of a template, 

<math display="inline" id="Cross-correlation:35">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>t</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(x,y)
  </annotation>
 </semantics>
</math>

 with a subimage 

<math display="inline" id="Cross-correlation:36">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Cross-correlation:37">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mi>n</mi>
   </mfrac>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
     </mrow>
    </munder>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mover accent="true">
         <mi>f</mi>
         <mo>¯</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>t</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mover accent="true">
         <mi>t</mi>
         <mo>¯</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>σ</mi>
       <mi>f</mi>
      </msub>
      <msub>
       <mi>σ</mi>
       <mi>t</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <list>
       <ci>x</ci>
       <ci>y</ci>
      </list>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>f</ci>
         <interval closure="open">
          <ci>x</ci>
          <ci>y</ci>
         </interval>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>f</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>t</ci>
         <interval closure="open">
          <ci>x</ci>
          <ci>y</ci>
         </interval>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>f</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{n}\sum_{x,y}\frac{(f(x,y)-\overline{f})(t(x,y)-\overline{t})}{\sigma_%
{f}\sigma_{t}}
  </annotation>
 </semantics>
</math>

. where 

<math display="inline" id="Cross-correlation:38">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is the number of pixels in 

<math display="inline" id="Cross-correlation:39">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>t</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(x,y)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Cross-correlation:40">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Cross-correlation:41">
 <semantics>
  <mover accent="true">
   <mi>f</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{f}
  </annotation>
 </semantics>
</math>

 is the average of <em>f</em> and 

<math display="inline" id="Cross-correlation:42">
 <semantics>
  <msub>
   <mi>σ</mi>
   <mi>f</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>σ</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma_{f}
  </annotation>
 </semantics>
</math>

 is <a href="standard_deviation" title="wikilink">standard deviation</a> of <em>f</em>. In <a href="functional_analysis" title="wikilink">functional analysis</a> terms, this can be thought of as the dot product of two <a href="Unit_vector" title="wikilink">normalized vectors</a>. That is, if</p>

<p>

<math display="block" id="Cross-correlation:43">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mover accent="true">
     <mi>f</mi>
     <mo>¯</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>F</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <ci>f</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(x,y)=f(x,y)-\overline{f}
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Cross-correlation:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>t</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mover accent="true">
     <mi>t</mi>
     <mo>¯</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>t</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(x,y)=t(x,y)-\overline{t}
  </annotation>
 </semantics>
</math>

 then the above sum is equal to</p>

<p>

<math display="block" id="Cross-correlation:45">
 <semantics>
  <mrow>
   <mo>⟨</mo>
   <mfrac>
    <mi>F</mi>
    <mrow>
     <mo>∥</mo>
     <mi>F</mi>
     <mo>∥</mo>
    </mrow>
   </mfrac>
   <mo>,</mo>
   <mfrac>
    <mi>T</mi>
    <mrow>
     <mo>∥</mo>
     <mi>T</mi>
     <mo>∥</mo>
    </mrow>
   </mfrac>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <divide></divide>
     <ci>F</ci>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>F</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <ci>T</ci>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <ci>T</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\frac{F}{\|F\|},\frac{T}{\|T\|}\right\rangle
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Cross-correlation:46">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mo>⋅</mo>
   <mo>,</mo>
   <mo>⋅</mo>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>normal-⋅</ci>
    <ci>normal-⋅</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\cdot,\cdot\rangle
  </annotation>
 </semantics>
</math>

 is the <a href="inner_product" title="wikilink">inner product</a> and 

<math display="inline" id="Cross-correlation:47">
 <semantics>
  <mrow>
   <mo>∥</mo>
   <mo>⋅</mo>
   <mo>∥</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="latexml">parallel-to</csymbol>
    <ci>normal-⋅</ci>
    <csymbol cd="latexml">parallel-to</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\cdot\|
  </annotation>
 </semantics>
</math>

 is the <a href="Lp_space" title="wikilink"><em>L</em>² norm</a>. Thus, if <em>f</em> and <em>t</em> are real matrices, their normalized cross-correlation equals the cosine of the angle between the unit vectors <em>F</em> and <em>T</em>, being thus <em>1</em> if and only if <em>F</em> equals <em>T</em> multiplied by a positive scalar.</p>

<p>Normalized correlation is one of the methods used for <a href="template_matching" title="wikilink">template matching</a>, a process used for finding incidences of a pattern or object within an image. It is also the 2-dimensional version of <a href="Pearson_product-moment_correlation_coefficient" title="wikilink">Pearson product-moment correlation coefficient</a>.</p>
<h2 id="nonlinear-systems">Nonlinear systems</h2>

<p>Caution must be applied when using cross correlation for nonlinear systems. In certain circumstances, which depend on the properties of the input, cross correlation between the input and output of a system with nonlinear dynamics can be completely blind to certain nonlinear effects.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> This problem arises because some quadratic moments can equal zero and this can incorrectly suggest that there is little "correlation" (in the sense of statistical dependence) between two signals, when in fact the two signals are strongly related by nonlinear dynamics.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="Autocorrelation" title="wikilink">Autocorrelation</a></li>
<li><a class="uri" href="Autocovariance" title="wikilink">Autocovariance</a></li>
<li><a href="Coherence_(signal_processing)" title="wikilink">Coherence</a></li>
<li><a class="uri" href="Convolution" title="wikilink">Convolution</a></li>
<li><a class="uri" href="Correlation" title="wikilink">Correlation</a></li>
<li><a class="uri" href="Cross-covariance" title="wikilink">Cross-covariance</a></li>
<li><a class="uri" href="Cross-spectrum" title="wikilink">Cross-spectrum</a></li>
<li><a href="Covariance_mapping" title="wikilink">Covariance mapping</a></li>
<li><a href="Digital_image_correlation" title="wikilink">Digital image correlation</a></li>
<li><a href="Phase_correlation" title="wikilink">Phase correlation</a></li>
<li><a href="Scaled_correlation" title="wikilink">Scaled correlation</a></li>
<li><a href="Spectral_density" title="wikilink">Spectral density</a></li>
<li><a href="Wiener–Khinchin_theorem" title="wikilink">Wiener–Khinchin theorem</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://mathworld.wolfram.com/Cross-Correlation.html">Cross Correlation from Mathworld</a></li>
<li><a class="uri" href="http://scribblethink.org/Work/nvisionInterface/nip.html">http://scribblethink.org/Work/nvisionInterface/nip.html</a></li>
<li><a class="uri" href="http://www.phys.ufl.edu/LIGO/stochastic/sign05.pdf">http://www.phys.ufl.edu/LIGO/stochastic/sign05.pdf</a></li>
<li><a class="uri" href="http://www.staff.ncl.ac.uk/oliver.hinton/eee305/Chapter6.pdf">http://www.staff.ncl.ac.uk/oliver.hinton/eee305/Chapter6.pdf</a></li>
</ul>

<p>"</p>

<p><a href="Category:Bilinear_operators" title="wikilink">Category:Bilinear operators</a> <a href="Category:Covariance_and_correlation" title="wikilink">Category:Covariance and correlation</a> <a href="Category:Signal_processing" title="wikilink">Category:Signal processing</a> <a href="Category:Time_domain_analysis" title="wikilink">Category:Time domain analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

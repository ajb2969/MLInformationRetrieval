<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="619">Variance-based sensitivity analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Variance-based sensitivity analysis</h1>
<hr>'''Variance-based sensitivity analysis''' is a form of global [[sensitivity analysis]].<ref name="Primer">Saltelli, A., Ratto, M., Andres, T., Campolongo, F., Cariboni, J., Gatelli, D. Saisana, M., and Tarantola, S., 2008, ''Global Sensitivity Analysis. The Primer'',
<p><code>John Wiley &amp; Sons. Working within a </code><a href="probability" title="wikilink"><code>probabilistic</code></a><code> framework, it decomposes the </code><a href="variance" title="wikilink"><code>variance</code></a><code> of the output of the model or system into fractions which can be attributed to inputs or sets of inputs. For example, given a model with two inputs and one output, one might find that 70% of the output variance is caused by the variance in the first input, 20% by the variance in the second, and 10% due to </code><a href="Interaction_(statistics)" title="wikilink"><code>Interactions</code></a><code> between the two. These percentages are directly interpreted as measures of sensitivity. Variance-based measures of sensitivity are attractive because they measure sensitivity across the whole input space (i.e. it is a global method), they can deal with </code><a href="nonlinear" title="wikilink"><code>nonlinear</code></a><code> responses, and they can measure the effect of </code><a href="Interaction_(statistics)" title="wikilink"><code>interactions</code></a><code> in non-</code><a href="Additive_map" title="wikilink"><code>additive</code></a><code> systems.</code><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="decomposition-of-variance">Decomposition of Variance</h2>

<p>From a <a href="black_box" title="wikilink">black box</a> perspective, any <a href="mathematical_model" title="wikilink">model</a> may be viewed as a function <em>Y</em>=<em>f</em>(<strong>X</strong>), where <strong>X</strong> is a vector of <em>d</em> uncertain model inputs {<em>X</em><sub><em>1</em></sub>, <em>X</em><sub><em>2</em></sub>, ... <em>X</em><sub><em>d</em></sub>}, and <em>Y</em> is a chosen univariate model output (note that this approach examines scalar model outputs, but multiple outputs can be analysed by multiple independent sensitivity analyses). Furthermore, it will be assumed that the inputs are <a href="Independence_(probability_theory)" title="wikilink">independently</a> and <a href="Uniform_distribution_(continuous)" title="wikilink">uniformly</a> distributed within the unit hypercube, i.e. 

<math display="inline" id="Variance-based_sensitivity_analysis:0">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>i</ci>
    </apply>
    <interval closure="closed">
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}\in[0,1]
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Variance-based_sensitivity_analysis:1">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>d</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <ci>d</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=1,2,...,d
  </annotation>
 </semantics>
</math>

. This incurs no loss of generality because any input space can be transformed onto this unit hypercube. <em>f</em>(<strong>X</strong>) may be decomposed in the following way,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:2">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{0}=E(Y)
  </annotation>
 </semantics>
</math>

</p>

<p>i.e. all the terms in the functional decomposition are <a href="orthogonality" title="wikilink">orthogonal</a>. This leads to definitions of the terms of the functional decomposition in terms of conditional expected values,</p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:3">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Y</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <msub>
    <mi>f</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>i</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{i}(X_{i})=E(Y|X_{i})-f_{0}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:4">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Y</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>X</mi>
     <mi>j</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>-</mo>
   <msub>
    <mi>f</mi>
    <mn>0</mn>
   </msub>
   <mo>-</mo>
   <msub>
    <mi>f</mi>
    <mi>i</mi>
   </msub>
   <mo>-</mo>
   <msub>
    <mi>f</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>i</ci>
    </apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>j</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{ij}(X_{i},X_{j})=E(Y|X_{i},X_{j})-f_{0}-f_{i}-f_{j}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:5">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mrow>
     <mi>i</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mo>Var</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
   </msub>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>E</mi>
     <msub>
      <mtext>𝐗</mtext>
      <mrow>
       <mi></mi>
       <mo>∼</mo>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>Y</mi>
     <mo>∣</mo>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Var</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>X</mtext>
       <apply>
        <csymbol cd="latexml">similar-to</csymbol>
        <csymbol cd="latexml">absent</csymbol>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-∣</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{ij}=\operatorname{Var}_{X_{ij}}\left(E_{\textbf{X}_{\sim ij}}\left(Y\mid X_%
{ij}\right)\right)
  </annotation>
 </semantics>
</math>

</p>

<p>From which it can be seen that <em>f</em><sub><em>i</em></sub> is the effect of varying <em>X</em><sub><em>i</em></sub> alone (known as the <a href="main_effect" title="wikilink">main effect</a> of <em>X</em><sub><em>i</em></sub>), and <em>f</em><sub><em>ij</em></sub> is the effect of varying <em>X</em><sub><em>i</em></sub> and <em>X</em><sub><em>j</em></sub> simultaneously, <em>additional to the effect of their individual variations</em>. This is known as a second-order <a href="Interaction_(statistics)" title="wikilink">interaction</a>. Higher-order terms have analogous definitions.</p>

<p>Now, further assuming that the <em>f</em>(<strong>X</strong>) is <a href="Square-integrable_function" title="wikilink">square-integrable</a>, the functional decomposition may be squared and integrated to give,</p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:6">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>V</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo>Var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <ci>Var</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{i}=\frac{V_{i}}{\operatorname{Var}(Y)}
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:7">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>d</mi>
    </munderover>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>T</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>≥</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{d}S_{Ti}\geq 1
  </annotation>
 </semantics>
</math>

</p>

<p>and so on. The <em>X</em><sub>~<em>i</em></sub> notation indicates the set of all variables <em>except</em> <em>X</em><sub><em>i</em></sub>. The above variance decomposition shows how the variance of the model output can be decomposed into terms attributable to each input, as well as the interaction effects between them. Together, all terms sum to the total variance of the model output.</p>
<h2 id="first-order-indices">First-order indices</h2>

<p>A direct variance-based measure of sensitivity <em>S</em><sub><em>i</em></sub>, called the "first-order sensitivity index", or "main effect index" is stated as follows,<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:8">
 <semantics>
  <mrow>
   <msub>
    <mo>Var</mo>
    <msub>
     <mi>X</mi>
     <mi>i</mi>
    </msub>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>E</mi>
     <msub>
      <mi>𝐗</mi>
      <mrow>
       <mi></mi>
       <mo>∼</mo>
       <mi>i</mi>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>X</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mn>1</mn>
    <mi>N</mi>
   </mfrac>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>j</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>N</mi>
   </munderover>
   <mi>f</mi>
   <msub>
    <mrow>
     <mo>(</mo>
     <mi>𝐁</mi>
     <mo>)</mo>
    </mrow>
    <mi>j</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>f</mi>
    <msub>
     <mrow>
      <mo>(</mo>
      <msubsup>
       <mi>𝐀</mi>
       <mi>B</mi>
       <mi>i</mi>
      </msubsup>
      <mo>)</mo>
     </mrow>
     <mi>j</mi>
    </msub>
    <mo>-</mo>
    <mi>f</mi>
    <msub>
     <mrow>
      <mo>(</mo>
      <mi>𝐀</mi>
      <mo>)</mo>
     </mrow>
     <mi>j</mi>
    </msub>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Var</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <apply>
        <csymbol cd="latexml">similar-to</csymbol>
        <csymbol cd="latexml">absent</csymbol>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <approx></approx>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>N</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>N</ci>
    </apply>
    <csymbol cd="unknown">f</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">B</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>j</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">f</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀</ci>
         <ci>i</ci>
        </apply>
        <ci>B</ci>
       </apply>
       <ci>normal-)</ci>
      </cerror>
      <ci>j</ci>
     </apply>
     <minus></minus>
     <csymbol cd="unknown">f</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">A</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>j</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}_{X_{i}}(E_{\mathbf{X}_{\sim i}}(Y|X_{i}))\approx{\frac{1}{N%
}\sum_{j=1}^{N}f\left(\mathbf{B}\right)_{j}\left(f\left(\mathbf{A}^{i}_{B}%
\right)_{j}-f\left(\mathbf{A}\right)_{j}\right)}
  </annotation>
 </semantics>
</math>

</p>

<p>This is the contribution to the output variance of the main effect of <em>X</em><sub><em>i</em></sub>, therefore it measures the effect of varying <em>X</em><sub><em>i</em></sub> <em>alone</em>, but averaged over variations in other input parameters. It is standardised by the total variance to provide a fractional contribution. Higher-order interaction indices <em>S</em><sub><em>ij</em></sub>, <em>S</em><sub><em>ijk</em></sub> and so on can be formed by dividing other terms in the variance decomposition by Var(<em>Y</em>). Note that this has the implication that,</p>

<p>

<math display="block" id="Variance-based_sensitivity_analysis:9">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>E</mi>
     <msub>
      <mi>𝐗</mi>
      <mrow>
       <mi></mi>
       <mo>∼</mo>
       <mi>i</mi>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mo>Var</mo>
       <msub>
        <mi>X</mi>
        <mi>i</mi>
       </msub>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>Y</mi>
       <mo>∣</mo>
       <msub>
        <mi>𝐗</mi>
        <mrow>
         <mi></mi>
         <mo>∼</mo>
         <mi>i</mi>
        </mrow>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>2</mn>
      <mi>N</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mi>f</mi>
         <msub>
          <mrow>
           <mo>(</mo>
           <mi>𝐀</mi>
           <mo>)</mo>
          </mrow>
          <mi>j</mi>
         </msub>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>f</mi>
         <msub>
          <mrow>
           <mo>(</mo>
           <msubsup>
            <mi>𝐀</mi>
            <mi>B</mi>
            <mi>i</mi>
           </msubsup>
           <mo>)</mo>
          </mrow>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <apply>
        <csymbol cd="latexml">similar-to</csymbol>
        <csymbol cd="latexml">absent</csymbol>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Var</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>Y</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐗</ci>
       <apply>
        <csymbol cd="latexml">similar-to</csymbol>
        <csymbol cd="latexml">absent</csymbol>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>N</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐀</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>𝐀</ci>
            <ci>i</ci>
           </apply>
           <ci>B</ci>
          </apply>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{\mathbf{X}_{\sim i}}\left(\operatorname{Var}_{X_{i}}\left(Y\mid\mathbf{X}_{%
\sim i}\right)\right)\approx{\frac{1}{2N}\sum_{j=1}^{N}\left(f\left(\mathbf{A}%
\right)_{j}-f\left(\mathbf{A}^{i}_{B}\right)_{j}\right)^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>Note that unlike the <em>S</em><sub><em>i</em></sub>,</p>

<p><span class="LaTeX">$$\sum_{i=1}^d S_{Ti} \geq 1$$</span></p>

<p>due to the fact that the interaction effect between e.g. <em>X</em><sub><em>i</em></sub> and <em>X</em><sub><em>j</em></sub> is counted in both <em>S</em><sub><em>Ti</em></sub> <em>and</em> <em>S</em><sub><em>Tj</em></sub> In fact, the sum of the <em>S</em><sub><em>Ti</em></sub> will only be equal to 1 when the model is purely <a href="Additive_map" title="wikilink">additive</a>.</p>
<h2 id="calculation-of-indices">Calculation of indices</h2>

<p>For analytically tractable functions, the indices above may be calculated analytically by evaluating the integrals in the decomposition. However, in the vast majority of cases they are estimated - this is usually done by the <a href="Monte_Carlo_method" title="wikilink">Monte Carlo method</a>.</p>
<h3 id="sampling-sequences">Sampling sequences</h3>

<p><a href="File:Construction_of_ABi_matrices_in_monte_carlo_estimation_of_sensitivity_indices.png" title="wikilink">thumb | right | 500px | An example of construction of <strong>A</strong><sub>B</sub><sup><em>i</em></sup> matrices with <em>d</em>=3 and <em>N</em>=4.</a> The Monte Carlo approach involves generating a sequence of randomly distributed points inside the unit hypercube (strictly speaking these will be <a href="Pseudorandom_number_generator" title="wikilink">pseudorandom</a>). In practice, it is common to substitute random sequences with <a href="low-discrepancy_sequence" title="wikilink">low-discrepancy sequences</a> to improve the efficiency of the estimators. This is then known as the <a href="Quasi-Monte_Carlo_method" title="wikilink">Quasi-Monte Carlo method</a>. Some low-discrepancy sequences commonly used in sensitivity analysis include the <a href="Sobol_sequence" title="wikilink">Sobol sequence</a> and the <a href="Latin_hypercube_sampling" title="wikilink">Latin hypercube</a> design.</p>
<h3 id="procedure">Procedure</h3>

<p>To calculate the indices using the (Quasi) Monte Carlo method, the following steps are used:<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<ol>
<li>Generate an <em>N</em>x2<em>d</em> sample matrix, i.e. each row is a sample point in the hyperspace of 2<em>d</em> dimensions. This should be done with respect to the probability distributions of the input variables.</li>
<li>Use the first <em>d</em> columns of the matrix as matrix <strong>A</strong>, and the remaining <em>d</em> columns as matrix <strong>B</strong>. This effectively gives two independent samples of <em>N</em> points in the <em>d</em>-dimensional unit hypercube.</li>
<li>Build <em>d</em> further <em>N</em>x<em>d</em> matrices <strong>A</strong><sub>B</sub><sup><em>i</em></sup>, for <em>i</em> = 1,2,...,d, such that the <em>i</em>th column of <strong>A</strong><sub>B</sub><sup><em>i</em></sup> is equal to the <em>i</em>th column of <strong>B</strong>, and the remaining columns are from <strong>A</strong>.</li>
<li>The <strong>A</strong>, <strong>B</strong>, and the <em>d</em> <strong>A</strong><sub>B</sub><sup><em>i</em></sup> matrices in total specify <em>N</em>(<em>d</em>+2) points in the input space (one for each row). Run the model at each design point in the <strong>A</strong>, <strong>B</strong>, and <strong>A</strong><sub>B</sub><sup><em>i</em></sup> matrices, giving a total of <em>N</em>(<em>d</em>+2) model evaluations - the corresponding f(<strong>A</strong>), f(<strong>B</strong>) and f(<strong>A</strong><sub>B</sub><sup><em>i</em></sup>) values.</li>
<li>Calculate the sensitivity indices using the estimators below.</li>
</ol>

<p>The accuracy of the estimators is of course dependent on <em>N</em>. The value of <em>N</em> can be chosen by sequentially adding points and calculating the indices until the estimated values reach some acceptable convergence. For this reason, when using low-discrepancy sequences, it can be advantageous to use those that allow sequential addition of points (such as the Sobol sequence), as compared to those that do not (such as Latin hypercube sequences).</p>
<h3 id="estimators">Estimators</h3>

<p>There are a number of possible Monte Carlo estimators available for both indices. Two that are currently in general use are,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p><span class="LaTeX">$$\operatorname{Var}_{X_i}(E_{\mathbf{X}_{\sim i}}(Y|X_i)) \approx
  { \frac {1}{N}  \sum_{j=1}^{N}  f \left (  \mathbf{B} \right )_{j}  \left ( f   \left ( \mathbf{A}^i_B \right )_{j} -   f \left ( \mathbf{A} \right )_{j}  \right ) }$$</span></p>

<p>and</p>

<p><span class="LaTeX">$$E_{\mathbf{X}_{\sim i}}\left(\operatorname{Var}_{X_i}\left(Y \mid \mathbf{X}_{\sim i} \right) \right) \approx {\frac {1}{2N}\sum_{j=1}^{N}
\left( f   \left ( \mathbf{A} \right )_{j} - f  \left (\mathbf{A}^i_B \right )_{j}\right )^2
}$$</span></p>

<p>for the estimation of for estimation of the <em>S</em><sub><em>i</em></sub> and the <em>S</em><sub><em>Ti</em></sub> respectively.</p>
<h3 id="computational-expense">Computational Expense</h3>

<p>For the estimation of the <em>S</em><sub><em>i</em></sub> and the <em>S</em><sub><em>Ti</em></sub> for all input variables, <em>N</em>(<em>d</em>+2) model runs are required. Since <em>N</em> is often of the order of hundreds or thousands of runs, computational expense can quickly become a problem when the model takes a significant amount of time for a single run. In such cases, there are a number of techniques available to reduce the computational cost of estimating sensitivity indices, such as <a href="Sensitivity_analysis#Emulators" title="wikilink">emulators</a>, <a href="Sensitivity_analysis#High-Dimensional_Model_Representations_(HDMR)" title="wikilink">HDMR</a> and <a href="Sensitivity_analysis#Fourier_Amplitude_Sensitivity_Test_(FAST)" title="wikilink">FAST</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Sensitivity_analysis" title="wikilink">Sensitivity analysis</a></li>
<li><a href="Monte_Carlo_method" title="wikilink">Monte Carlo method</a></li>
<li><a href="Quasi-Monte_Carlo_method" title="wikilink">Quasi-Monte Carlo method</a></li>
<li><a href="Sobol_sequence" title="wikilink">Sobol sequence</a></li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Scientific_modeling" title="wikilink">Category:Scientific modeling</a> <a href="Category:Sensitivity_analysis" title="wikilink"> </a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><code>Saltelli,</code> <code>A.,</code> <code>Annoni,</code> <code>P.,</code> <code>2010,</code> <code>How</code> <code>to</code> <code>avoid</code> <code>a</code> <code>perfunctory</code> <code>sensitivity</code> <code>analysis,</code> <em><code>Environmental</code> <code>Modeling</code> <code>and</code> <code>Software</code></em> <strong><code>25</code></strong><code>,</code> <code>1508-1517.</code><a href="#fnref1">↩</a></li>
<li id="fn2">Sobol’, I. (1990). Sensitivity estimates for nonlinear mathematical models. <em>Matematicheskoe Modelirovanie</em> <strong>2</strong>, 112–118. in Russian, translated in English in Sobol’ , I. (1993). Sensitivity analysis for non-linear mathematical models. <em>Mathematical Modeling &amp; Computational Experiment (Engl. Transl.)</em>, 1993, <strong>1</strong>, 407–414.<a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5">Andrea Saltelli, Paola Annoni, Ivano Azzini, Francesca Campolongo, Marco Ratto, and Stefano Tarantola. Variance based sensitivity analysis of model output. Design and estimator for the total sensitivity index. Computer Physics Communications, 181(2):259{270, 2010<a href="#fnref5">↩</a></li>
</ol>
</section>
</ref></hr></body>
</html>

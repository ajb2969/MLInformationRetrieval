   Costas loop      Costas loop   A Costas loop is a phase-locked loop based circuit which is used for carrier phase recovery from suppressed-carrier modulation signals, such as from double- sideband suppressed carrier signals. It was invented by John P. Costas at General Electric in the 1950s . 1 Its invention was described as having had "a profound effect on modern digital communications". The primary application of Costas loops is in wireless receivers. Its advantage over the PLL-based detectors is that at small deviations the Costas loop error voltage is sin(2( θ i − θ f )) vs sin( θ i − θ f ). This translates to double the sensitivity and also makes the Costas loop uniquely suited for tracking doppler-shifted carriers esp. in OFDM and GPS receivers  2  Classical implementation     (Figure)  Costas loop, before synchronization   (Figure)  Costas Loop after synchronization         (Figure)  Carrier and VCO signals before synchronization   (Figure)  VCO input during synchronization   (Figure)  Carrier and VCO signals after synchronization      In the classical implementation of a Costas loop, 3 a local voltage-controlled oscillator (VCO) provides quadrature outputs, one to each of two phase detectors , e.g. , product detectors. The same phase of the input signal is also applied to both phase detectors and the output of each phase detector is passed through a low-pass filter . The outputs of these low-pass filters are inputs to another phase detector, the output of which passes through noise-reduction filter before being used to control the voltage-controlled oscillator. The overall loop response is controlled by the two individual low-pass filters that precede the third phase detector while the third low-pass filter serves a trivial role in terms of gain and phase margin.  Mathematical models of Costas loop  Model of Costas loop in the time domain  In the simplest case      m  2    (  t  )    =  1         superscript  m  2   t   1    m^{2}(t)=1   . Therefore,      m  2    (  t  )    =  1         superscript  m  2   t   1    m^{2}(t)=1   does not affect the input of noise-reduction filter. Carrier and VCO signals are periodic oscillations     f   1  ,  2     (   θ   (  t  )    )        superscript  f   1  2      θ  t     f^{1,2}(\theta(t))   with high-frequencies      θ  ˙    1  ,  2     (  t  )        superscript   normal-˙  θ    1  2    t    \dot{\theta}^{1,2}(t)   . Block    -   90  o        superscript  90  o     -90^{o}   shifts phase of VCO signal by    -   π  2         π  2     -\frac{\pi}{2}   . Block   ⊗   tensor-product   \bigotimes   is an Analog multiplier .  From the mathematical point of view, a linear filter can be described by a system of linear differential equations           x  ˙   =    A  x   +   b  ξ   (  t  )      ,       σ  =    c  *   x    ,            normal-˙  x       A  x     b  ξ  t       σ     superscript  c    x       \begin{array}[]{ll}\dot{x}=Ax+b\xi(t),&\sigma=c^{*}x,\end{array}   Here,   A   A   A   is a constant matrix,    x   (  t  )       x  t    x(t)   is a state vector of filter,   b   b   b   and   c   c   c   are constant vectors.  The model of voltage-controlled oscillator is usually assumed to be linear             θ  ˙   2    (  t  )    =    ω   f  r  e  e   2   +   L  G   (  t  )      ,       t  ∈   [  0  ,  T  ]    ,              superscript   normal-˙  θ   2   t      subscript   superscript  ω  2     f  r  e  e      L  G  t       t   0  T       \begin{array}[]{ll}\dot{\theta}^{2}(t)=\omega^{2}_{free}+LG(t),&t\in[0,T],\end%
 {array}   where    ω   f  r  e  e   2     subscript   superscript  ω  2     f  r  e  e     \omega^{2}_{free}   is a free-running frequency of voltage-controlled oscillator and   L   L   L   is an oscillator gain. Similar it is possible to consider various nonlinear models of VCO.  Suppose that the frequency of master generator is constant        θ  ˙   1    (  t  )    ≡   ω  1    .         superscript   normal-˙  θ   1   t    superscript  ω  1     \dot{\theta}^{1}(t)\equiv\omega^{1}.   Equation of VCO and equation of filter yield           x  ˙   =    A  x   +   b   f  1    (    θ  1    (  t  )    )    f  2    (    θ  2    (  t  )    )      ,         θ  ˙   2   =    ω   f  r  e  e   2   +   L   c  *   x     .            normal-˙  x       A  x     b   superscript  f  1      superscript  θ  1   t    superscript  f  2      superscript  θ  2   t         superscript   normal-˙  θ   2      subscript   superscript  ω  2     f  r  e  e      L   superscript  c    x        \begin{array}[]{ll}\dot{x}=Ax+bf^{1}(\theta^{1}(t))f^{2}(\theta^{2}(t)),&\dot{%
 \theta}^{2}=\omega^{2}_{free}+Lc^{*}x.\end{array}     The system is nonautonomous and rather difficult for investigation.  Model of Costas loop in phase-frequency domain    In the simplest case, when            f  1    (    θ  1    (  t  )    )    =   cos   (    ω  1   t   )     ,     f  2    (    θ  2    (  t  )    )    =   sin   (    ω  2   t   )             f  1     (    θ  1    (  t  )    )   2    f  2    (    θ  2    (  t  )    )    f  2    (     θ  2    (  t  )    -   π  2    )    =   -    1  8    (    2   sin   (   2   ω  2   t   )     +   sin   (    2   ω  2   t   -   2   ω  1   t    )    +   sin   (    2   ω  2   t   +   2   ω  1   t    )     )             formulae-sequence       superscript  f  1      superscript  θ  1   t         superscript  ω  1   t          superscript  f  2      superscript  θ  2   t         superscript  ω  2   t             superscript  f  1    superscript     superscript  θ  1   t   2    superscript  f  2      superscript  θ  2   t    superscript  f  2        superscript  θ  2   t     π  2           1  8       2      2   superscript  ω  2   t           2   superscript  ω  2   t     2   superscript  ω  1   t           2   superscript  ω  2   t     2   superscript  ω  1   t            \begin{array}[]{l}f^{1}\big(\theta^{1}(t)\big)=\cos\big(\omega^{1}t\big),f^{2}%
 \big(\theta^{2}(t)\big)=\sin\big(\omega^{2}t\big)\\
 f^{1}\big(\theta^{1}(t)\big)^{2}f^{2}\big(\theta^{2}(t)\big)f^{2}\big(\theta^{%
 2}(t)-\frac{\pi}{2}\big)=-\frac{1}{8}\Big(2\sin(2\omega^{2}t)+\sin(2\omega^{2}%
 t-2\omega^{1}t)+\sin(2\omega^{2}t+2\omega^{1}t)\Big)\end{array}   standard engineering assumption is that the filter removes the upper sideband with frequency from the input but leaves the lower sideband without change. Thus it is assumed that VCO input is     φ   (     θ  1    (  t  )    -    θ  2    (  t  )     )    =    1  8    sin   (    2   ω  1    -   2   ω  2     )           φ       superscript  θ  1   t      superscript  θ  2   t         1  8         2   superscript  ω  1      2   superscript  ω  2         \varphi(\theta^{1}(t)-\theta^{2}(t))=\frac{1}{8}\sin(2\omega^{1}-2\omega^{2})   . This makes Costas loop equivalent to Phase-Locked Loop with phase detector characteristic     φ   (  θ  )       φ  θ    \varphi(\theta)   corresponding to the particular waveforms     f  1    (  θ  )        superscript  f  1   θ    f^{1}(\theta)   and     f  2    (  θ  )        superscript  f  2   θ    f^{2}(\theta)   of input and VCO signals. It can be proved, that inputs    g   (  t  )       g  t    g(t)   and    G   (  t  )       G  t    G(t)   of VCO for phase-frequency domain and time domain models are almost equal. 4  5  6  Thus it is possible 7 to study more simple autonomous system of differential equations           x  ˙   =    A  x   +   b  φ   (   Δ  θ   )      ,        Δ   θ  ˙    =     ω   f  r  e  e   2   -   ω  1    +   L   c  *   x     ,          Δ  θ   =    θ  2   -   θ  1     .             normal-˙  x       A  x     b  φ    normal-Δ  θ          normal-Δ   normal-˙  θ         subscript   superscript  ω  2     f  r  e  e     superscript  ω  1      L   superscript  c    x           normal-Δ  θ      superscript  θ  2    superscript  θ  1      missing-subexpression      \begin{array}[]{ll}\dot{x}=Ax+b\varphi(\Delta\theta),&\Delta\dot{\theta}=%
 \omega^{2}_{free}-\omega^{1}+Lc^{*}x,\\
 \Delta\theta=\theta^{2}-\theta^{1}.&\end{array}   Well-known Krylov–Bogoliubov averaging method allows one to prove that solutions of nonautonomous and autonomous equations are close under some assumptions. Thus the block-scheme of Costas Loop in the time space can be asymptotically changed to the block-scheme on the level of phase-frequency relations.  The passage to analysis of autonomous dynamical model of Costas loop (in place of the nonautonomous one) allows one to overcome the difficulties, related with modeling Costas loop in time domain where one has to simultaneously observe very fast time scale of the input signals and slow time scale of signal's phase.  References       "  Category:Oscillators  Category:Communication circuits     ↩  ↩  ↩  ↩  ↩  ↩  ↩     
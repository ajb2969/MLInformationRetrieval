   Frobenius pseudoprime      Frobenius pseudoprime   In number theory , a Frobenius pseudoprime is a pseudoprime that passes a specific probable prime test described by Jon Grantham in a 1998 preprint and published in 2000. 1  2 It has been studied by other authors for the case of quadratic polynomials. 3  4  The test for quadratic polynomials  A Frobenius test is defined in terms of a monic polynomial . The case of a degree-2 polynomial (a quadratic) is common and can be shown in terms of Lucas sequences , lending itself to fast implementations.  For the polynomial      x  2   -   P  x    +  Q         superscript  x  2     P  x    Q    \scriptstyle x^{2}-Px+Q   , where    D  =    P  2   -   4  Q        D     superscript  P  2     4  Q      \scriptstyle D=P^{2}-4Q   is not a square, n a composite number,     gcd   (  n  ,   2  Q  D   )    =  1        n    2  Q  D    1    \scriptstyle\gcd(n,2QD)=1   , and k the Jacobi symbol     (   D  n   )      D  n    \scriptstyle\left(\tfrac{D}{n}\right)   , n is a Frobenius (P,Q) pseudoprime if and only if         (  1  )     U   n  -  k     ≡   0     (   mod  n   )           1    subscript  U    n  k      annotated  0   pmod  n      \text{ }(1)\text{ }U_{n-k}\equiv 0\;\;(\mathop{{\rm mod}}n)   and         (  2  )     V   n  -  k     ≡   {      2  Q       if  k   =   -  1        2      if  k   =   1  .               2    subscript  V    n  k      cases    2  Q       if  k     1    2      if  k     1  .       \text{ }(2)\text{ }V_{n-k}\equiv\begin{cases}2Q&\mbox{if }k=-1\\
 2&\mbox{if }k=1\mbox{.}\end{cases}     Both conditions hold for all primes, hence this constitutes a probable prime test.  Condition (1) is the same condition that defines a Lucas pseudoprime , hence every Frobenius (P,Q) pseudoprime is also a Lucas (P,Q) pseudoprime, but because of the additional condition (2), the converse is not true.  Example  Frobenius pseudoprimes with respect to the Fibonacci polynomial     x  2   -  x  -  1       superscript  x  2   x  1    \scriptstyle x^{2}-x-1   can be determined using the Fibonacci sequence (Lucas (1,-1) sequence) and are:   4181, 5777, 6721, 10877, 13201, 15251, 34561, 51841, 64079, 64681, 67861, 68251, 75077, 90061, 96049, 97921, 100127, 113573, 118441, 146611, 161027, 162133, 163081, 186961, 197209, 219781, 231703, 252601, 254321, 257761, 268801, 272611, 283361, 302101, 303101, 330929, 399001, 430127, 433621, 438751, 489601, ...   While 323 is the first Lucas pseudoprime with respect to the Fibonacci polynomial     x  2   -  x  -  1       superscript  x  2   x  1    \scriptstyle x^{2}-x-1   , the first Frobenius pseudoprime with respect to the same polynomial is 4181 (Grantham indicates it is 5777 5 but multiple authors have noted this is incorrect and is instead the first pseudoprime with     (   5  n   )   =   -  1         5  n     1     \left(\tfrac{5}{n}\right)=-1   for this polynomial 6 ).  Another case, Frobenius pseudoprimes with respect to the quadratic polynomial     x  2   -   3  x   -  1       superscript  x  2     3  x   1    \scriptstyle x^{2}-3x-1   can be determined using the Lucas (3,-1) sequence and are:   119, 649, 1189, 4187, 12871, 14041, 16109, 23479, 24769, 28421, 31631, 34997, 38503, 41441, 48577, 50545, 56279, 58081, 59081, 61447, 75077, 91187, 95761, 96139, 116821, 127937, 146329, 148943, 150281, 157693, 170039, 180517, 188501, 207761, 208349, 244649, 281017, 311579, 316409, 349441, 350173, 363091, 371399, 397927, 423721, 440833, 459191, 473801, 479119, 493697, ...   The quadratic polynomial     x  2   -   3  x   -  5       superscript  x  2     3  x   5    \scriptstyle x^{2}-3x-5   , with     (  P  ,  Q  )   =   (  3  ,   -  5   )        P  Q    3    5      \scriptstyle(P,Q)=(3,-5)   , has sparse pseudoprimes compared to many other simple quadratics. Using the same process above we get the sequence:   13333, 44801, 486157, 1615681, 3125281, 4219129, 9006401, 12589081, 13404751, 15576571, 16719781, ...   Every entry in this sequence is a Fermat pseudoprime to base 5 as well as a Lucas (3,-5) pseudoprime, but the converse is not true: 642001 is both a psp-5 and a Lucas (3,-5) pseudoprime, but is not a Frobenius (3,-5) pseudoprime.  Using parameter selection ideas first laid out in Baillie and Wagstaff 1980 7 as part of the Baillie-PSW primality test and used by Grantham in his Quadratic Frobenius Test  8 we can create even better quadratic tests, for instance using the parameters (P,2) where P is the first odd that satisfies     (   D  n   )   =   -  1         D  n     1     \scriptstyle\left(\tfrac{D}{n}\right)=-1   , which has no pseudoprimes less than    2  64     superscript  2  64    \scriptstyle 2^{64}   .  Relations to other pseudoprimes  For quadratic polynomials      x  2   -   P  x    +  Q         superscript  x  2     P  x    Q    \scriptstyle x^{2}-Px+Q   , every Frobenius (P,Q) pseudoprime is also a Lucas (P,Q) pseudoprime. 9  10  11 This immediately follows from condition (1) which defined a Lucas (P,Q) pseudoprime. The converse is not true, making the Frobenius pseudoprimes a subset of the Lucas pseudoprimes for a given (P,Q). The condition on    V  k     subscript  V  k    \scriptstyle V_{k}   indicate it must also be a Dickson pseudoprime of the second kind. 12  Every Frobenius pseudoprime to       x  3   -   r   x  2     +   s  x    -  1           superscript  x  3     r   superscript  x  2       s  x    1    x^{3}-rx^{2}+sx-1   is also a Perrin pseudoprime . 13  Alternate formulations  An alternate formulation is given by Khashin. 14 Given a number n , not a perfect square, where c is the smallest odd prime with Jacobi symbol     (   c  n   )   =   -  1         c  n     1     \left(\tfrac{c}{n}\right)=-1   , n is a either a prime or Frobenius pseudoprime if:        (   1  +   c    )   n   ≡    (   1  -   c    )      (   mod  n   )         superscript    1    c    n    annotated    1    c     pmod  n      (1+\sqrt{c})^{n}\equiv(1-\sqrt{c})\;\;(\mathop{{\rm mod}}n)   .  Note the additional condition of choosing a parameter based on the Jacobi symbol finding a quadratic non-residue. This is similar to the method from Baillie and Wagstaff shown in the examples section. 15 This makes far stronger tests, and is one reason for the success of the Baillie-PSW primality test . Similar to the example, Khashin notes that no pseudoprime has been found for his test. He further shows that any that exist under 2 60 must have a factor less than 19 or have c > 128.  Strong Frobenius pseudoprimes  Strong Frobenius pseudoprimes are also defined. 16 Details on implementation for quadratic polynomials can be found in Crandall and Pomerance. 17  Properties  The computational cost of the Frobenius pseudoprime test for quadratic polynomials is roughly three times the cost of a strong pseudoprime test (e.g. a single round of the Miller-Rabin primality test ), 1.5 times that of a Lucas pseudoprime test, and slightly more than a Baillie-PSW primality test .  Note that the quadratic Frobenius test is stronger than the Lucas test. For example, 1763 is a Lucas pseudoprime to ( P , Q ) = (3, -1) since U 1764 = 0 (mod 1763) where U is , and it also passes the Jacobi step since    (   13  1763   )      13  1763    \left(\tfrac{13}{1763}\right)   = -1, but it fails the Frobenius test to x 2 - 3x - 1. This property can be clearly seen when the algorithm is formulated as shown in Crandall and Pomerance Algorithm 3.6.9 18 or as shown by Loebenberger, 19 as the algorithm does a Lucas test followed by an additional check for the Frobenius condition.  While the quadratic Frobenius test does not have formal error bounds beyond that of the Lucas test, it can be used as the basis for methods with much smaller error bounds. Note that these have more steps, additional requirements, and non-negligible additional computation beyond what is described on this page. It is important to note that the error bounds for these methods do not apply to the standard or strong Frobenius tests with fixed values of (P,Q) described on this page.  Based on this idea of pseudoprimes, algorithms with strong worst-case error bounds can be built. The Quadratic Frobenius Test 20 has a bound of    1  7710      1  7710    \tfrac{1}{7710}   . Müller in 2001 proposed the MQFT test with bounds of essentially    1   131040  t       1   superscript  131040  t     \tfrac{1}{131040^{t}}   . 21 Damgård and Frandsen in 2003 proposed the EQFT with a bound of essentially    256   331776  t       256   superscript  331776  t     \tfrac{256}{{331776}^{t}}   . 22 Seysen in 2005 proposed the SQFT test with a bound of    1   4096  t       1   superscript  4096  t     \tfrac{1}{{4096}^{t}}   and a SQFT3 test with a bound of    16   336442  t       16   superscript  336442  t     \tfrac{16}{336442^{t}}   . 23  Given the same computational effort, these offer better worst-case bounds than the commonly used Miller-Rabin primality test .  See also   Pseudoprime  Lucas pseudoprime  Ferdinand Georg Frobenius  Quadratic Frobenius test   References  External links     Jacobsen, Dana Pseudoprime Statistics, Tables, and Data (data for Frobenius (1,-1) and (3,-5) pseudoprimes)   "  Category:Pseudoprimes     ↩  ↩  ↩  ↩    ↩  ↩    ↩    ↩        ↩  ↩  Martin Seysen. A Simplified Quadratic Frobenius Primality Test, 2005, http://eprint.iacr.org/2005/462 ↩     
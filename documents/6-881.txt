   Sherman–Morrison formula      Sherman–Morrison formula   In mathematics , in particular linear algebra , the Sherman–Morrison formula , 1 2 3 named after Jack Sherman and Winifred J. Morrison, computes the inverse of the sum of an invertible  matrix    A   A   A   and the outer product ,    u   v  T       u   superscript  v  T     uv^{T}   , of vectors    u   u   u   and   v   v   v   . The Sherman–Morrison formula is a special case of the Woodbury formula . Though named after Sherman and Morrison, it appeared already in earlier publications. 4  Statement  Suppose   A   A   A   is an invertible  square matrix and   u   u   u   ,   v   v   v   are column vectors . Suppose furthermore that     1  +    v  T    A   -  1    u    ≠  0        1     superscript  v  T    superscript  A    1    u    0    1+v^{T}A^{-1}u\neq 0   . Then the Sherman–Morrison formula states that         (   A  +   u   v  T     )    -  1    =    A   -  1    -     A   -  1    u   v  T    A   -  1      1  +    v  T    A   -  1    u       .       superscript    A    u   superscript  v  T       1       superscript  A    1         superscript  A    1    u   superscript  v  T    superscript  A    1       1     superscript  v  T    superscript  A    1    u        (A+uv^{T})^{-1}=A^{-1}-{A^{-1}uv^{T}A^{-1}\over 1+v^{T}A^{-1}u}.     Here,    u   v  T       u   superscript  v  T     uv^{T}   is the outer product of two vectors   u   u   u   and   v   v   v   . The general form shown here is the one published by Bartlett. 5  Application  If the inverse of   A   A   A   is already known, the formula provides a numerically  cheap way to compute the inverse of   A   A   A   corrected by the matrix    u   v  T       u   superscript  v  T     uv^{T}   (depending on the point of view, the correction may be seen as a perturbation or as a rank -1 update). The computation is relatively cheap because the inverse of    A  +   u   v  T        A    u   superscript  v  T      A+uv^{T}   does not have to be computed from scratch (which in general is expensive), but can be computed by correcting (or perturbing)    A   -  1      superscript  A    1     A^{-1}   .  Using unit columns (columns from the identity matrix ) for   u   u   u   or   v   v   v   , individual columns or rows of   A   A   A   may be manipulated and a correspondingly updated inverse computed relatively cheaply in this way. 6 In the general case, where    A   -  1      superscript  A    1     A^{-1}   is a   n   n   n   times   n   n   n   matrix and   u   u   u   and   v   v   v   are arbitrary vectors of dimension   n   n   n   , the whole matrix is updated 7 and the computation takes    3   n  2       3   superscript  n  2     3n^{2}   scalar multiplications. 8 If   u   u   u   is a unit column, the computation takes only    2   n  2       2   superscript  n  2     2n^{2}   scalar multiplications. The same goes if   v   v   v   is a unit column. If both   u   u   u   and   v   v   v   are unit columns, the computation takes only    n  2     superscript  n  2    n^{2}   scalar multiplications.  Verification  We verify the properties of the inverse. A matrix   Y   Y   Y   (in this case the right-hand side of the Sherman–Morrison formula) is the inverse of a matrix   X   X   X   (in this case    A  +   u   v  T        A    u   superscript  v  T      A+uv^{T}   ) if and only if     X  Y   =   Y  X   =  I          X  Y     Y  X        I     XY=YX=I   .  We first verify that the right hand side (   Y   Y   Y   ) satisfies     X  Y   =  I        X  Y   I    XY=I   .       X  Y   =    (   A  +   u   v  T     )    (    A   -  1    -     A   -  1    u   v  T    A   -  1      1  +    v  T    A   -  1    u      )          X  Y       A    u   superscript  v  T        superscript  A    1         superscript  A    1    u   superscript  v  T    superscript  A    1       1     superscript  v  T    superscript  A    1    u         XY=(A+uv^{T})\left(A^{-1}-{A^{-1}uv^{T}A^{-1}\over 1+v^{T}A^{-1}u}\right)            =     A   A   -  1     +   u   v  T    A   -  1      -     A   A   -  1    u   v  T    A   -  1     +   u   v  T    A   -  1    u   v  T    A   -  1       1  +    v  T    A   -  1    u          absent        A   superscript  A    1       u   superscript  v  T    superscript  A    1            A   superscript  A    1    u   superscript  v  T    superscript  A    1       u   superscript  v  T    superscript  A    1    u   superscript  v  T    superscript  A    1        1     superscript  v  T    superscript  A    1    u        =AA^{-1}+uv^{T}A^{-1}-{AA^{-1}uv^{T}A^{-1}+uv^{T}A^{-1}uv^{T}A^{-1}\over 1+v^{%
 T}A^{-1}u}               =    I  +   u   v  T    A   -  1      -     u   v  T    A   -  1     +   u   v  T    A   -  1    u   v  T    A   -  1       1  +    v  T    A   -  1    u          absent      I    u   superscript  v  T    superscript  A    1            u   superscript  v  T    superscript  A    1       u   superscript  v  T    superscript  A    1    u   superscript  v  T    superscript  A    1        1     superscript  v  T    superscript  A    1    u        =I+uv^{T}A^{-1}-{uv^{T}A^{-1}+uv^{T}A^{-1}uv^{T}A^{-1}\over 1+v^{T}A^{-1}u}               =    I  +   u   v  T    A   -  1      -    u   (   1  +    v  T    A   -  1    u    )    v  T    A   -  1      1  +    v  T    A   -  1    u          absent      I    u   superscript  v  T    superscript  A    1          u    1     superscript  v  T    superscript  A    1    u     superscript  v  T    superscript  A    1       1     superscript  v  T    superscript  A    1    u        =I+uv^{T}A^{-1}-{u(1+v^{T}A^{-1}u)v^{T}A^{-1}\over 1+v^{T}A^{-1}u}        Note that     v  T    A   -  1    u       superscript  v  T    superscript  A    1    u    v^{T}A^{-1}u   is a scalar, so    (   1  +    v  T    A   -  1    u    )      1     superscript  v  T    superscript  A    1    u     (1+v^{T}A^{-1}u)   can be factored out, leading to:        X  Y   =    I  +   u   v  T    A   -  1      -   u   v  T    A   -  1      =  I   .          X  Y       I    u   superscript  v  T    superscript  A    1        u   superscript  v  T    superscript  A    1           I     XY=I+uv^{T}A^{-1}-uv^{T}A^{-1}=I.\,     In the same way, it is verified that        Y  X   =    (    A   -  1    -     A   -  1    u   v  T    A   -  1      1  +    v  T    A   -  1    u      )    (   A  +   u   v  T     )    =  I   .          Y  X        superscript  A    1         superscript  A    1    u   superscript  v  T    superscript  A    1       1     superscript  v  T    superscript  A    1    u        A    u   superscript  v  T           I     YX=\left(A^{-1}-{A^{-1}uv^{T}A^{-1}\over 1+v^{T}A^{-1}u}\right)(A+uv^{T})=I.     Following is an alternate verification of the Sherman–Morrison formula using the easily verifiable identity        (   I  +   w   v  T     )    -  1    =   I  -    w   v  T     1  +    v  T   w           superscript    I    w   superscript  v  T       1      I      w   superscript  v  T      1     superscript  v  T   w        (I+wv^{T})^{-1}=I-\frac{wv^{T}}{1+v^{T}w}     Let    u  =   A  w       u    A  w     u=Aw   and     A  +   u   v  T     =   A   (   I  +   w   v  T     )          A    u   superscript  v  T       A    I    w   superscript  v  T        A+uv^{T}=A\left(I+wv^{T}\right)   , then        (   A  +   u   v  T     )    -  1    =     (   I  +   w   v  T     )    -  1     A   -  1     =    (   I  -    w   v  T     1  +    v  T   w      )    A   -  1            superscript    A    u   superscript  v  T       1       superscript    I    w   superscript  v  T       1     superscript  A    1              I      w   superscript  v  T      1     superscript  v  T   w       superscript  A    1        (A+uv^{T})^{-1}=(I+wv^{T})^{-1}{A^{-1}}=\left(I-\frac{wv^{T}}{1+v^{T}w}\right)%
 A^{-1}     Substituting    w  =    A   -  1    u       w     superscript  A    1    u     w={{A}^{-1}}u   gives        (   A  +   u   v  T     )    -  1    =    (   I  -     A   -  1    u   v  T     1  +    v  T    A   -  1    u      )    A   -  1     =    A   -  1    -     A   -  1    u   v  T    A   -  1      1  +    v  T    A   -  1    u             superscript    A    u   superscript  v  T       1        I       superscript  A    1    u   superscript  v  T      1     superscript  v  T    superscript  A    1    u       superscript  A    1             superscript  A    1         superscript  A    1    u   superscript  v  T    superscript  A    1       1     superscript  v  T    superscript  A    1    u         (A+uv^{T})^{-1}=\left(I-\frac{A^{-1}uv^{T}}{1+v^{T}A^{-1}u}\right)A^{-1}={A^{-%
 1}}-\frac{A^{-1}uv^{T}A^{-1}}{1+v^{T}A^{-1}u}     See also   The matrix determinant lemma performs a rank-1 update to a determinant .  Woodbury matrix identity  Quasi-Newton method  Binomial inverse theorem  Bunch–Nielsen–Sorensen formula   References  External links     "  Category:Linear algebra  Category:Matrix theory     ↩  ↩  ↩  ↩  ↩  Langville, Amy N.; and Meyer, Carl D.; "Google's PageRank and Beyond: The Science of Search Engine Rankings", Princeton University Press, 2006, p. 156 ↩   Update of the inverse matrix by the Sherman–Morrison formula ↩     
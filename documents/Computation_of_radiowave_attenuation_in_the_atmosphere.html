<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="370">Computation of radiowave attenuation in the atmosphere</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Computation of radiowave attenuation in the atmosphere</h1>
<hr/>

<p>One of the causes of <a class="uri" href="attenuation" title="wikilink">attenuation</a> of <a href="radio_propagation" title="wikilink">radio propagation</a> is the <a href="Absorption_(electromagnetic_radiation)" title="wikilink">absorption</a> by the <a class="uri" href="atmosphere" title="wikilink">atmosphere</a>. There are many well known facts on the phenomenon and qualitative treatments in <a href="textbook" title="wikilink">textbooks</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> A document published by the <a href="International_Telecommunication_Union" title="wikilink">International Telecommunication Union</a> (ITU) <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> provides some basis for a quantitative assessment of the attenuation. That document describes a simplified model along with semi-empirical formulas based on <a href="data_fitting" title="wikilink">data fitting</a>. It also recommended an <a class="uri" href="algorithm" title="wikilink">algorithm</a> to compute the attenuation of radiowave propagation in the atmosphere. <a class="uri" href="NASA" title="wikilink">NASA</a> also published a study on a related subject.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> Free software from <a class="uri" href="CNES" title="wikilink">CNES</a> based on ITU-R recommendations is available <a href="http://logiciels.cnes.fr/PROPA/fr/logiciel.htm">for download</a> and is available to the public.</p>
<h2 id="the-model-and-the-itu-recommendation">The model and the ITU recommendation</h2>

<p>The document ITU-R P.676-8 of the <a class="uri" href="ITU-R" title="wikilink">ITU-R</a> section considers the atmosphere as being divided into spherical homogeneous layers; each layer has a constant <a href="refraction_index" title="wikilink">refraction index</a>. By the use of <a class="uri" href="trigonometry" title="wikilink">trigonometry</a>, a couple of formulas and an algorithm were derived.</p>

<p>Through the use of an <a href="Invariant_(physics)" title="wikilink">invariant</a>, the same results can be directly derived:</p>
<figure><b>(Figure)</b>
<figcaption>Optinv.png</figcaption>
</figure>

<p>An <a href="incident_ray" title="wikilink">incident ray</a> at A under the angle Œ¶ hits the layer B at the angle¬†<em>Œ∏</em>. From basic <a href="Euclidean_geometry" title="wikilink">Euclidean geometry</a>:</p>

<p>

<math display="block" id="Computation_of_radiowave_attenuation_in_the_atmosphere:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <mi>C</mi>
      <mi>K</mi>
     </mrow>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>R</mi>
     <mrow>
      <mi>sin</mi>
      <mi>u</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>r</mi>
     <mrow>
      <mi>sin</mi>
      <mi>Œ∏</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <abs></abs>
      <apply>
       <times></times>
       <ci>C</ci>
       <ci>K</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>R</ci>
      <apply>
       <sin></sin>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>r</ci>
      <apply>
       <sin></sin>
       <ci>Œ∏</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |CK|=R\sin u=r\sin\theta.\,
  </annotation>
 </semantics>
</math>

</p>

<p>By <a href="Snell's_law" title="wikilink">Snell's law</a> (or <a href="Ren√©_Descartes" title="wikilink">Ren√© Descartes</a>' law from the French point of view!) :</p>

<p>

<math display="block" id="Computation_of_radiowave_attenuation_in_the_atmosphere:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>n</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mi>sin</mi>
      <mi mathvariant="normal">Œ¶</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>n</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mi>sin</mi>
      <mi>u</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <sin></sin>
      <ci>normal-Œ¶</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <sin></sin>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{1}\sin\Phi=n_{2}\sin u,\,
  </annotation>
 </semantics>
</math>

</p>

<p>so that</p>

<p>

<math display="block" id="Computation_of_radiowave_attenuation_in_the_atmosphere:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>n</mi>
     <mn>1</mn>
    </msub>
    <mi>R</mi>
    <mrow>
     <mi>sin</mi>
     <mi mathvariant="normal">Œ¶</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>n</mi>
     <mn>2</mn>
    </msub>
    <mi>r</mi>
    <mrow>
     <mi>sin</mi>
     <mi>Œ∏</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>I</mi>
    <mi>N</mi>
    <mpadded width="+1.7pt">
     <mi>V</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>R</ci>
      <apply>
       <sin></sin>
       <ci>normal-Œ¶</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>r</ci>
      <apply>
       <sin></sin>
       <ci>Œ∏</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>N</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{1}R\sin\Phi=n_{2}r\sin\theta=INV\,
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Notes:</strong></p>
<ul>
<li>One proof <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> starts from the <a href="Fermat's_principle" title="wikilink">Fermat's principle</a>. As a result one gets the proof of the Snell‚Äôs law along with this invariance. This invariant is valid in a more general situation; the spherical radius is then replaced by the <a href="Radius_of_curvature_(mathematics)" title="wikilink">Radius of curvature</a> at points along the ray. It is also used in equation (4) of the 2005 NASA's report<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> in an application of satellite tracking.</li>
</ul>
<ul>
<li>The assumption of the refraction index varying with the latitude is not strictly compatible with the notion of layers. However the variation of the index is very small, this point is usually ignored in practice.</li>
</ul>

<p>The ITU recommended algorithm consists of launching a ray from a <a href="radio_source" title="wikilink">radio source</a>, then at each step, a layer is chosen and a new <a href="incidence_angle" title="wikilink">incidence angle</a> is then computed. The process is iterated until the altitude of the target is reached. At each step, the covered distance <em>dL</em> is multiplied by a specific attenuation <a class="uri" href="coefficient" title="wikilink">coefficient</a> <em>g</em> expressed in¬†dB/km. All the increments <em>g</em>¬†<em>dL</em> are added to provide the total attenuation.</p>

<p>Note that the algorithm does not guaranty that the target is actually reached. For this, a much harder <a href="boundary_value_problem" title="wikilink">boundary value problem</a> would have to be solved.</p>
<h2 id="the-eikonal-equation">The eikonal equation</h2>

<p>This equation is discussed in the references.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> The equation is highly non-linear. Given that a smooth data fitting curve n(altitude) is provided by the ITU<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> for the refraction index n, and that the values of n differs from 1 only by something of the order¬†10<sup>‚àí4</sup>, a <a href="numerical_solution" title="wikilink">numerical solution</a> of the <a href="eikonal_equation" title="wikilink">eikonal equation</a> can be considered. Usually the equation is presented under the self-adjoint form, a more tractable equation for the ray head position vector <strong>r</strong><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> is given in generic parametric form:</p>

<p>

<math display="block" id="Computation_of_radiowave_attenuation_in_the_atmosphere:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>ùê´</mi>
    <mo>¬®</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>n</mi>
    </mpadded>
    <mpadded width="+1.7pt">
     <mi>grad</mi>
    </mpadded>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¬®</ci>
     <ci>ùê´</ci>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>grad</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{\mathbf{r}}=n\,\mathrm{grad}\,n
  </annotation>
 </semantics>
</math>

</p>
<h2 id="implementations">Implementations</h2>

<p>Three implementations to compute the attenuations exist:</p>
<ul>
<li>Take the ray to be a straight line.</li>
<li>Use the optical invariant and apply the ITU recommendationITU.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></li>
<li>Solve the eikonal equation.</li>
</ul>

<p>The first two are only of 1st order approximation (see <a href="Orders_of_approximation" title="wikilink">Orders of approximation</a>). For the <a href="eikonal_equation" title="wikilink">eikonal equation</a>, many numerical schemes are available.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Here only a simple second order scheme was chosen. For most standard configurations of source-target, the three methods differ little from each other. It is only in the case of rays grazing the ground that the differences are meaningful. The following was used for testing:</p>

<p>At the latitude of 10¬∞, when a ray starts at 5¬†km altitude with an elevation angle of¬†‚àí1¬∞ to hit a target at the same longitude but at latitude 8.84¬∞ and altitude 30¬†km. At 22.5¬†GHz, the results are:</p>
<figure><b>(Figure)</b>
<figcaption>The3results.png</figcaption>
</figure>

<p>Note that 22.5¬†GHz is not a practical frequency<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> but it is the most suitable for algorithms comparison. In the table, the first column gives the results in dB, the third gives the distance covered and the last gives the final altitude. Distances are in km. From the altitude 30¬†km up, the attenuation is negligible. The paths of the three are plotted:</p>
<figure><b>(Figure)</b>
<figcaption>The3methods.png</figcaption>
</figure>

<p>The linear path is the highest on the figure, the eikonal is the lowest.</p>

<p><strong>Note</strong>: A <a class="uri" href="MATLAB" title="wikilink">MATLAB</a> version for the uplink (<a href="Telecommunications_link" title="wikilink">Telecommunications link</a>) is available from the ITU<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h2 id="the-boundary-value-problem">The boundary value problem</h2>

<p>When a point S communicates with a point T, the orientation of the ray is specified by an elevation angle. In a na√Øve way, the angle can be given by tracing a straight line from S to T. This specification does not guaranty that the ray will reach T: the variation of refraction index bends the ray trajectory. The elevation angle has to be modified<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> to take into account the bending effect.</p>

<p>For the Eikonal equation, this correction can be done by solving a <a href="boundary_value_problem" title="wikilink">boundary value problem</a>. As the equation is of second order, the problem is well defined. In spite of the lack of a firm theoretical basis for the ITU method, a trial-error by dichotomy (or <a href="Binary_search_algorithm" title="wikilink">binary search</a>) can also be used. The next figure shows the results of numerical simulations.</p>
<figure><b>(Figure)</b>
<figcaption>Compare</figcaption>
</figure>

<p>The curve labeled as bvp is the trajectory found by correcting the elevation angle. The other two are from a fix step and a variable steps (chosen in accordance to the ITU recommendations<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a>) solutions without the elevation angle correction. The nominal elevation angle for this case is -0.5 degree. The numerical results obtained at 22.5¬†GHz were:</p>

<p><br/>
<br/>
Note the way the solution bvp bents over the straight line. A consequence of this property is that the ray can reach locations situated below the horizon of S. This is consistent with observations.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> The trajectory is a <a href="Concave_function" title="wikilink">Concave function</a> is a consequence of the fact that the gradient of the refraction index is negative, so the Eikonal equation implies that the second derivative of the trajectory is negative. From the point where the ray is parallel to ground, relative to the chosen coordinates, the ray goes down but relative to ground level, the ray goes up.</p>

<p>Often engineers are interested in finding the limits of a system. In this case, a simple idea is to try some low elevation angle and let the ray reach the desired altitude. This point of view has a problem: if suffice to take the angle for which the ray has a tangent point of lowest altitude. For instance with the case of a source at 5¬†km altitude, of nominal elevation angle -0.5 degree and the target is at 30¬†km altitude; the attenuation found by the boundary value method is 11.33¬†dB. The previous point of view of worst case leads to an elevation angle of -1.87 degree and an attenuation of 170.77¬†dB. With this kind of attenuation, every system would be unusable! It was found also for this case that with the nominal elevation angle, the distance of the tangent point to ground is 5.84¬†km; that of the worst case is 2.69¬†km. The nominal distance from source to target is 6383.84¬†km; for the worst case, it is 990.36¬†km.</p>

<p>There are many numerical methods to solve boundary value problems.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> For the Eikonal equation, due the good behavior of the refraction index just a simple <a href="Shooting_method" title="wikilink">Shooting method</a> can be used.</p>
<h2 id="conclusions">Conclusions</h2>

<p>Of the three methods, the linear and the ITU methods require some coding since they are not presented as differential equations. These methods do not benefit from the help of standard numerical packages; however, only high school mathematics are required to understand the methods. The more technical eikonal equation can be solved using standard differential equations solvers offered by a few numerical software packages mentioned in the Wikipedia <a href="List_of_numerical_analysis_software" title="wikilink">List of numerical analysis software</a> and it offers a higher precision order.</p>

<p>The attenuation mechanism as described here is only one amongst many others.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> The full problem is much more complex.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Ray_tracing_(physics)" title="wikilink">Ray tracing (physics)</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li>[<a class="uri" href="http://www.itu.int/publications/sector.aspx?lang=en&amp;sector">http://www.itu.int/publications/sector.aspx?lang=en&amp;sector;</a>;=1 ITU Publications]</li>
<li><a href="http://trs-new.jpl.nasa.gov/dspace/handle/2014/41145">JPL Publication 09-14</a></li>
</ul>

<p>"</p>

<p><a href="Category:Applied_mathematics" title="wikilink">Category:Applied mathematics</a> <a href="Category:Radio_technology" title="wikilink">Category:Radio technology</a> <a href="Category:Atmospheric_sciences" title="wikilink">Category:Atmospheric sciences</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><em>Antennas and radiowave propagation</em>. R. E. Collin. Mc Graw Hill, 1985<a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><em>ITU recommendation ITU-R</em> pp.¬†676‚Äì8, 2009<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><em><a class="uri" href="http://trs-new.jpl.nasa.gov/dspace/handle/2014/41145">http://trs-new.jpl.nasa.gov/dspace/handle/2014/41145</a></em>. NASA progress report<a href="#fnref3">‚Ü©</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"><em>Microwave and optical ray geometry</em>. S. Cornbleet, Wiley, 1984<a href="#fnref6">‚Ü©</a></li>
<li id="fn7"><em>Light transmission optics</em>. Detrich Marcuse, Van Nostrand, 1982<a href="#fnref7">‚Ü©</a></li>
<li id="fn8"><em>Methods in Electromagnetic Wave Propagation</em>. D. S. Jones, Oxford, 1987<a href="#fnref8">‚Ü©</a></li>
<li id="fn9"><em>ITU recommandation ITU-R</em> pp.¬†835‚Äì4, 2009<a href="#fnref9">‚Ü©</a></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"></li>
<li id="fn16"></li>
<li id="fn17"><em>ITU recommandation ITU-R</em> pp.¬† 834-6, 2007<a href="#fnref17">‚Ü©</a></li>
<li id="fn18"><em>Initial Value Methods for Boundary Value Problems</em>. Mayer. Academic Press, 1973<a href="#fnref18">‚Ü©</a></li>
<li id="fn19"></li>
<li id="fn20"><em>Field Guide to Atmospheric Optics (SPIE Vol. FG02)</em>. Larry C. Andrews. SPIE Publications, 2004<a href="#fnref20">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

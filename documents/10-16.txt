   Chow–Liu tree      Chow–Liu tree   (Figure)  400 px|A first-order dependency tree representing the product on the left.   In probability theory and statistics Chow–Liu tree is an efficient method for constructing a second- order product approximation of a joint probability distribution , first described in a paper by . The goals of such a decomposition, as with such Bayesian networks in general, may be either data compression or inference .  The Chow–Liu representation  The Chow–Liu method describes a joint probability distribution     P   (   X  1   ,   X  2   ,  …  ,   X  n   )       P    subscript  X  1    subscript  X  2   normal-…   subscript  X  n      P(X_{1},X_{2},\ldots,X_{n})   as a product of second-order conditional and marginal distributions. For example, the six-dimensional distribution    P   (   X  1   ,   X  2   ,   X  3   ,   X  4   ,   X  5   ,   X  6   )       P    subscript  X  1    subscript  X  2    subscript  X  3    subscript  X  4    subscript  X  5    subscript  X  6      P(X_{1},X_{2},X_{3},X_{4},X_{5},X_{6})   might be approximated as       P  ′    (   X  1   ,   X  2   ,   X  3   ,   X  4   ,   X  5   ,   X  6   )   =  P   (   X  6   |   X  5   )   P   (   X  5   |   X  2   )   P   (   X  4   |   X  2   )   P   (   X  3   |   X  2   )   P   (   X  2   |   X  1   )   P   (   X  1   )      fragments   superscript  P  normal-′    fragments  normal-(   subscript  X  1   normal-,   subscript  X  2   normal-,   subscript  X  3   normal-,   subscript  X  4   normal-,   subscript  X  5   normal-,   subscript  X  6   normal-)    P   fragments  normal-(   subscript  X  6   normal-|   subscript  X  5   normal-)   P   fragments  normal-(   subscript  X  5   normal-|   subscript  X  2   normal-)   P   fragments  normal-(   subscript  X  4   normal-|   subscript  X  2   normal-)   P   fragments  normal-(   subscript  X  3   normal-|   subscript  X  2   normal-)   P   fragments  normal-(   subscript  X  2   normal-|   subscript  X  1   normal-)   P   fragments  normal-(   subscript  X  1   normal-)     P^{\prime}(X_{1},X_{2},X_{3},X_{4},X_{5},X_{6})=P(X_{6}|X_{5})P(X_{5}|X_{2})P(%
 X_{4}|X_{2})P(X_{3}|X_{2})P(X_{2}|X_{1})P(X_{1})     where each new term in the product introduces just one new variable, and the product can be represented as a first-order dependency tree, as shown in the figure. The Chow–Liu algorithm (below) determines which conditional probabilities are to be used in the product approximation. In general, unless there are no third-order or higher-order interactions, the Chow–Liu approximation is indeed an approximation , and cannot capture the complete structure of the original distribution.  provides a modern analysis of the Chow–Liu tree as a Bayesian network .  The Chow–Liu algorithm  Chow and Liu show how to select second-order terms for the product approximation so that, among all such second-order approximations (first-order dependency trees), the constructed approximation    P  ′     superscript  P  normal-′    P^{\prime}   has the minimum Kullback–Leibler distance to the actual distribution   P   P   P   , and is thus the closest approximation in the classical information-theoretic sense. The Kullback–Leibler distance between a second-order product approximation and the actual distribution is shown to be      D   (  P  ∥   P  ′   )   =  -  ∑  I   (   X  i   ;   X   j   (  i  )     )   +  ∑  H   (   X  i   )   -  H   (   X  1   ,   X  2   ,  …  ,   X  n   )      fragments  D   fragments  normal-(  P  parallel-to   superscript  P  normal-′   normal-)      I   fragments  normal-(   subscript  X  i   normal-;   subscript  X    j  i    normal-)     H   fragments  normal-(   subscript  X  i   normal-)    H   fragments  normal-(   subscript  X  1   normal-,   subscript  X  2   normal-,  normal-…  normal-,   subscript  X  n   normal-)     D(P\parallel P^{\prime})=-\sum I(X_{i};X_{j(i)})+\sum H(X_{i})-H(X_{1},X_{2},%
 \ldots,X_{n})     where    I   (   X  i   ;   X   j   (  i  )     )       I    subscript  X  i    subscript  X    j  i       I(X_{i};X_{j(i)})   is the mutual information between variable    X  i     subscript  X  i    X_{i}   and its parent    X   j   (  i  )       subscript  X    j  i     X_{j(i)}   and    H   (   X  1   ,   X  2   ,  …  ,   X  n   )       H    subscript  X  1    subscript  X  2   normal-…   subscript  X  n      H(X_{1},X_{2},\ldots,X_{n})   is the joint entropy of variable set    {   X  1   ,   X  2   ,  …  ,   X  n   }      subscript  X  1    subscript  X  2   normal-…   subscript  X  n     \{X_{1},X_{2},\ldots,X_{n}\}   . Since the terms    ∑   H   (   X  i   )          H   subscript  X  i      \sum H(X_{i})   and    H   (   X  1   ,   X  2   ,  …  ,   X  n   )       H    subscript  X  1    subscript  X  2   normal-…   subscript  X  n      H(X_{1},X_{2},\ldots,X_{n})   are independent of the dependency ordering in the tree, only the sum of the pairwise mutual informations ,    ∑   I   (   X  i   ;   X   j   (  i  )     )          I    subscript  X  i    subscript  X    j  i        \sum I(X_{i};X_{j(i)})   , determines the quality of the approximation. Thus, if every branch (edge) on the tree is given a weight corresponding to the mutual information between the variables at its vertices, then the tree which provides the optimal second-order approximation to the target distribution is just the maximum-weight tree . The equation above also highlights the role of the dependencies in the approximation: When no dependencies exist, and the first term in the equation is absent, we have only an approximation based on first-order marginals, and the distance between the approximation and the true distribution is due to the redundancies that are not accounted for when the variables are treated as independent. As we specify second-order dependencies, we begin to capture some of that structure and reduce the distance between the two distributions.  Chow and Liu provide a simple algorithm for constructing the optimal tree; at each stage of the procedure the algorithm simply adds the maximum mutual information pair to the tree. See the original paper, , for full details. A more efficient tree construction algorithm for the common case of sparse data was outlined in .  Chow and Wagner proved in a later paper  that the learning of the Chow–Liu tree is consistent given samples (or observations) drawn i.i.d. from a tree-structured distribution. In other words, the probability of learning an incorrect tree decays to zero as the number of samples tends to infinity. The main idea in the proof is the continuity of the mutual information in the pairwise marginal distribution. Recently, the exponential rate of convergence of the error probability was provided. 1  Variations on Chow–Liu trees  The obvious problem which occurs when the actual distribution is not in fact a second-order dependency tree can still in some cases be addressed by fusing or aggregating together densely connected subsets of variables to obtain a "large-node" Chow–Liu tree , or by extending the idea of greedy maximum branch weight selection to non-tree (multiple parent) structures . (Similar techniques of variable substitution and construction are common in the Bayes network literature, e.g., for dealing with loops. See .)  Generalizations of the Chow–Liu tree are the so called t-cherry junction trees . It is proved that the t-cherry junction trees provide a better or at least as good approximation for a discrete multivariate probability distribution as the Chow–Liu tree gives. For the third order t-cherry junction tree see , for the k th-order t-cherry junction tree see . The second order t-cherry junction tree is in fact the Chow–Liu tree.  See also   Bayesian network  Knowledge representation   Notes  References    .   .    .   .   .   .   .   "  Category:Knowledge representation     A Large-Deviation Analysis for the Maximum-Likelihood Learning of Tree Structures. V. Y. F. Tan, A. Anandkumar, L. Tong and A. Willsky. In the International symposium on information theory (ISIT), July 2009. ↩     
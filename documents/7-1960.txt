   Toroidal coordinates      Toroidal coordinates   (Figure)  Illustration of toroidal coordinates, which are obtained by rotating a two-dimensional bipolar coordinate system about the axis separating its two foci. The foci are located at a distance 1 from the vertical z -axis. The red sphere is the σ = 30° isosurface, the blue torus is the τ = 0.5 isosurface, and the yellow half-plane is the φ = 60° isosurface. The green half-plane marks the x - z plane, from which φ is measured. The black point is located at the intersection of the red, blue and yellow isosurfaces, at Cartesian coordinates roughly (0.996, −1.725, 1.911).   Toroidal coordinates are a three-dimensional orthogonal  coordinate system that results from rotating the two-dimensional bipolar coordinate system about the axis that separates its two foci. Thus, the two foci     F  1     subscript  F  1    F_{1}   and    F  2     subscript  F  2    F_{2}   in bipolar coordinates become a ring of radius   a   a   a   in the    x  y      x  y    xy   plane of the toroidal coordinate system; the   z   z   z   -axis is the axis of rotation. The focal ring is also known as the reference circle.  Definition  The most common definition of toroidal coordinates    (  σ  ,  τ  ,  ϕ  )     σ  τ  ϕ    (\sigma,\tau,\phi)   is      x  =    a     sinh  τ     cosh  τ   -   cos  σ      cos  ϕ        x    a      τ       τ     σ       ϕ      x=a\ \frac{\sinh\tau}{\cosh\tau-\cos\sigma}\cos\phi         y  =    a     sinh  τ     cosh  τ   -   cos  σ      sin  ϕ        y    a      τ       τ     σ       ϕ      y=a\ \frac{\sinh\tau}{\cosh\tau-\cos\sigma}\sin\phi         z  =    a     sin  σ     cosh  τ   -   cos  σ          z    a      σ       τ     σ        z=a\ \frac{\sin\sigma}{\cosh\tau-\cos\sigma}     where the   σ   σ   \sigma   coordinate of a point   P   P   P   equals the angle     F  1   P   F  2        subscript  F  1   P   subscript  F  2     F_{1}PF_{2}   and the   τ   τ   \tau   coordinate equals the natural logarithm of the ratio of the distances    d  1     subscript  d  1    d_{1}   and    d  2     subscript  d  2    d_{2}   to opposite sides of the focal ring       τ  =   ln    d  1    d  2      .      τ       subscript  d  1    subscript  d  2       \tau=\ln\frac{d_{1}}{d_{2}}.     The coordinate ranges are     -  π   <  σ  ≤  π          π   σ       π     -\pi<\sigma\leq\pi   and    τ  ≥  0      τ  0    \tau\geq 0   and     0  ≤  ϕ  <   2  π    .        0  ϕ         2  π      0\leq\phi<2\pi.     Coordinate surfaces  (Figure)  |thumb|right|350px|Rotating this two-dimensional bipolar coordinate system about the vertical axis produces the three-dimensional toroidal coordinate system above. A circle on the vertical axis becomes the red sphere , whereas a circle on the horizontal axis becomes the blue torus .   Surfaces of constant   σ   σ   \sigma   correspond to spheres of different radii        (    x  2   +   y  2    )   +    (   z  -   a   cot  σ     )   2    =    a  2     sin  2   σ             superscript  x  2    superscript  y  2     superscript    z    a    σ     2       superscript  a  2     superscript   2   σ      \left(x^{2}+y^{2}\right)+\left(z-a\cot\sigma\right)^{2}=\frac{a^{2}}{\sin^{2}\sigma}     that all pass through the focal ring but are not concentric. The surfaces of constant   τ   τ   \tau   are non-intersecting tori of different radii        z  2   +    (      x  2   +   y  2     -   a   coth  τ     )   2    =    a  2     sinh  2   τ           superscript  z  2    superscript         superscript  x  2    superscript  y  2       a   hyperbolic-cotangent  τ     2       superscript  a  2     superscript   2   τ      z^{2}+\left(\sqrt{x^{2}+y^{2}}-a\coth\tau\right)^{2}=\frac{a^{2}}{\sinh^{2}\tau}     that surround the focal ring. The centers of the constant-   σ   σ   \sigma   spheres lie along the   z   z   z   -axis, whereas the constant-   τ   τ   \tau   tori are centered in the    x  y      x  y    xy   plane.  Inverse transformation  The (σ, τ, φ) coordinates may be calculated from the Cartesian coordinates ( x , y , z ) as follows. The azimuthal angle φ is given by the formula       tan  ϕ   =   y  x         ϕ     y  x     \tan\phi=\frac{y}{x}     The cylindrical radius ρ of the point P is given by       ρ  2   =    x  2   +   y  2         superscript  ρ  2      superscript  x  2    superscript  y  2      \rho^{2}=x^{2}+y^{2}     and its distances to the foci in the plane defined by φ is given by       d  1  2   =     (   ρ  +  a   )   2   +   z  2         superscript   subscript  d  1   2      superscript    ρ  a   2    superscript  z  2      d_{1}^{2}=(\rho+a)^{2}+z^{2}          d  2  2   =     (   ρ  -  a   )   2   +   z  2         superscript   subscript  d  2   2      superscript    ρ  a   2    superscript  z  2      d_{2}^{2}=(\rho-a)^{2}+z^{2}     (Figure)  Geometric interpretation of the coordinates σ and τ of a point P . Observed in the plane of constant azimuthal angle φ, toroidal coordinates are equivalent to bipolar coordinates . The angle σ is formed by the two foci in this plane and P , whereas τ is the logarithm of the ratio of distances to the foci. The corresponding circles of constant σ and τ are shown in red and blue, respectively, and meet at right angles (magenta box); they are orthogonal.   The coordinate τ equals the natural logarithm of the focal distances      τ  =   ln    d  1    d  2         τ       subscript  d  1    subscript  d  2       \tau=\ln\frac{d_{1}}{d_{2}}     whereas the coordinate σ equals the angle between the rays to the foci, which may be determined from the law of cosines       cos  σ   =   -     4   a  2    -   d  1  2   -   d  2  2     2   d  1    d  2            σ           4   superscript  a  2     superscript   subscript  d  1   2    superscript   subscript  d  2   2      2   subscript  d  1    subscript  d  2        \cos\sigma=-\frac{4a^{2}-d_{1}^{2}-d_{2}^{2}}{2d_{1}d_{2}}     where the sign of σ is determined by whether the coordinate surface sphere is above or below the x - y plane.  Scale factors  The scale factors for the toroidal coordinates   σ   σ   \sigma   and   τ   τ   \tau   are equal       h  σ   =   h  τ   =   a    cosh  τ   -   cos  σ            subscript  h  σ    subscript  h  τ          a      τ     σ        h_{\sigma}=h_{\tau}=\frac{a}{\cosh\tau-\cos\sigma}     whereas the azimuthal scale factor equals       h  ϕ   =    a   sinh  τ      cosh  τ   -   cos  σ          subscript  h  ϕ       a    τ        τ     σ       h_{\phi}=\frac{a\sinh\tau}{\cosh\tau-\cos\sigma}     Thus, the infinitesimal volume element equals       d  V   =       a  3    sinh  τ      (    cosh  τ   -   cos  σ    )   3     d   σ   d   τ   d  ϕ         d  V          superscript  a  3     τ     superscript      τ     σ    3    d  σ  d  τ  d  ϕ     dV=\frac{a^{3}\sinh\tau}{\left(\cosh\tau-\cos\sigma\right)^{3}}\,d\sigma\,d%
 \tau\,d\phi     and the Laplacian is given by        ∇  2   Φ   =      (    cosh  τ   -   cos  σ    )   3     a  2    sinh  τ            superscript  normal-∇  2   normal-Φ      superscript      τ     σ    3      superscript  a  2     τ       \displaystyle\nabla^{2}\Phi=\frac{\left(\cosh\tau-\cos\sigma\right)^{3}}{a^{2}%
 \sinh\tau}     Other differential operators such as    ∇  ⋅  𝐅     normal-⋅  normal-∇  𝐅    \nabla\cdot\mathbf{F}   and    ∇  ×  𝐅      normal-∇  𝐅    \nabla\times\mathbf{F}   can be expressed in the coordinates    (  σ  ,  τ  ,  ϕ  )     σ  τ  ϕ    (\sigma,\tau,\phi)   by substituting the scale factors into the general formulae found in orthogonal coordinates .  Toroidal harmonics  Standard separation  The 3-variable Laplace equation        ∇  2   Φ   =  0        superscript  normal-∇  2   normal-Φ   0    \nabla^{2}\Phi=0     admits solution via separation of variables in toroidal coordinates. Making the substitution      Φ  =   U     cosh  τ   -   cos  σ          normal-Φ    U        τ     σ        \Phi=U\sqrt{\cosh\tau-\cos\sigma}     A separable equation is then obtained. A particular solution obtained by separation of variables is:      Φ  =       cosh  τ   -   cos  σ       S  ν    (  σ  )    T   μ  ν     (  τ  )    V  μ    (  ϕ  )        normal-Φ          τ     σ      subscript  S  ν   σ   subscript  T    μ  ν    τ   subscript  V  μ   ϕ     \Phi=\sqrt{\cosh\tau-\cos\sigma}\,\,S_{\nu}(\sigma)T_{\mu\nu}(\tau)V_{\mu}(%
 \phi)\,     where each function is a linear combination of:        S  ν    (  σ  )    =     e   i  ν  σ      and    e   -   i  ν  σ             subscript  S  ν   σ      superscript  e    i  ν  σ    and   superscript  e      i  ν  σ        S_{\nu}(\sigma)=e^{i\nu\sigma}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\nu\sigma}           T   μ  ν     (  τ  )    =    P   ν  -   1  /  2    μ    (   cosh  τ   )    and    Q   ν  -   1  /  2    μ    (   cosh  τ   )           subscript  T    μ  ν    τ      superscript   subscript  P    ν    1  2     μ     τ   and   superscript   subscript  Q    ν    1  2     μ     τ      T_{\mu\nu}(\tau)=P_{\nu-1/2}^{\mu}(\cosh\tau)\,\,\,\,\mathrm{and}\,\,\,\,Q_{%
 \nu-1/2}^{\mu}(\cosh\tau)           V  μ    (  ϕ  )    =     e   i  μ  ϕ      and    e   -   i  μ  ϕ             subscript  V  μ   ϕ      superscript  e    i  μ  ϕ    and   superscript  e      i  μ  ϕ        V_{\mu}(\phi)=e^{i\mu\phi}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\mu\phi}     Where P and Q are associated Legendre functions of the first and second kind. These Legendre functions are often referred to as toroidal harmonics.  Toroidal harmonics have many interesting properties. If you make a variable substitution      Q   -   1  2      (  z  )    =     2   1  +  z     K   (    2   1  +  z     )           subscript  Q      1  2     z         2    1  z     K      2    1  z        Q_{-\frac{1}{2}}(z)=\sqrt{\frac{2}{1+z}}K\left(\sqrt{\frac{2}{1+z}}\right)           P   -   1  2      (  z  )    =    2  π     2   1  +  z     K   (     z  -  1    z  +  1     )           subscript  P      1  2     z       2  π       2    1  z     K        z  1     z  1        P_{-\frac{1}{2}}(z)=\frac{2}{\pi}\sqrt{\frac{2}{1+z}}K\left(\sqrt{\frac{z-1}{z%
 +1}}\right)     and     K   K   \,\!K     where   E   E   \,\!E   and    Φ  =   U   ρ        normal-Φ    U    ρ      \Phi=\frac{U}{\sqrt{\rho}}   are the complete elliptic integrals of the first and second kind respectively. The rest of the toroidal harmonics can be obtained, for instance, in terms of the complete elliptic integrals, by using recurrence relations for associated Legendre functions.  The classic applications of toroidal coordinates are in solving partial differential equations , e.g., Laplace's equation for which toroidal coordinates allow a separation of variables or the Helmholtz equation , for which toroidal coordinates do not allow a separation of variables. Typical examples would be the electric potential and electric field of a conducting torus, or in the degenerate case, an electric current-ring (Hulme 1982).  An alternative separation  Alternatively, a different substitution may be made (Andrews 2006)       ρ  =     x  2   +   y  2     =    a   sinh  τ      cosh  τ   -   cos  σ      .        ρ       superscript  x  2    superscript  y  2              a    τ        τ     σ        \rho=\sqrt{x^{2}+y^{2}}=\frac{a\sinh\tau}{\cosh\tau-\cos\sigma}.     where      Φ  =     a  ρ     S  ν    (  σ  )    T   μ  ν     (  τ  )    V  μ    (  ϕ  )        normal-Φ      a  ρ    subscript  S  ν   σ   subscript  T    μ  ν    τ   subscript  V  μ   ϕ     \Phi=\frac{a}{\rho}\,\,S_{\nu}(\sigma)T_{\mu\nu}(\tau)V_{\mu}(\phi)\,     Again, a separable equation is obtained. A particular solution obtained by separation of variables is then:        S  ν    (  σ  )    =     e   i  ν  σ      and    e   -   i  ν  σ             subscript  S  ν   σ      superscript  e    i  ν  σ    and   superscript  e      i  ν  σ        S_{\nu}(\sigma)=e^{i\nu\sigma}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\nu\sigma}     where each function is a linear combination of:        T   μ  ν     (  τ  )    =    P   μ  -   1  /  2    ν    (   coth  τ   )    and    Q   μ  -   1  /  2    ν    (   coth  τ   )           subscript  T    μ  ν    τ      superscript   subscript  P    μ    1  2     ν    hyperbolic-cotangent  τ   and   superscript   subscript  Q    μ    1  2     ν    hyperbolic-cotangent  τ      T_{\mu\nu}(\tau)=P_{\mu-1/2}^{\nu}(\coth\tau)\,\,\,\,\mathrm{and}\,\,\,\,Q_{%
 \mu-1/2}^{\nu}(\coth\tau)            V  μ    (  ϕ  )    =     e   i  μ  ϕ      and    e   -   i  μ  ϕ       .         subscript  V  μ   ϕ      superscript  e    i  μ  ϕ    and   superscript  e      i  μ  ϕ        V_{\mu}(\phi)=e^{i\mu\phi}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\mu\phi}.         coth  τ     hyperbolic-cotangent  τ    \coth\tau     Note that although the toroidal harmonics are used again for the T function, the argument is    cosh  τ      τ    \cosh\tau   rather than   μ   μ   \mu   and the   ν   ν   \nu   and   θ   θ   \theta   indices are exchanged. This method is useful for situations in which the boundary conditions are independent of the spherical angle $\theta$ , such as the charged ring, an infinite half plane, or two parallel planes. For identities relating the toroidal harmonics with argument hyperbolic cosine with those of argument hyperbolic cotangent, see the Whipple formulae .  References   Byerly, W E. (1893) An elementary treatise on Fourier's series and spherical, cylindrical, and ellipsoidal harmonics, with applications to problems in mathematical physics Ginn & co. pp. 264–266      Bibliography        External links   MathWorld description of toroidal coordinates   "  Category:Coordinate systems   
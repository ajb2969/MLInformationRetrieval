   Toroidal coordinates      Toroidal coordinates   (Figure)  Illustration of toroidal coordinates, which are obtained by rotating a two-dimensional bipolar coordinate system about the axis separating its two foci. The foci are located at a distance 1 from the vertical z -axis. The red sphere is the ÏƒÂ =Â 30Â° isosurface, the blue torus is the Ï„Â =Â 0.5 isosurface, and the yellow half-plane is the Ï†Â =Â 60Â° isosurface. The green half-plane marks the x - z plane, from which Ï† is measured. The black point is located at the intersection of the red, blue and yellow isosurfaces, at Cartesian coordinates roughly (0.996,Â âˆ’1.725,Â 1.911).   Toroidal coordinates are a three-dimensional orthogonal  coordinate system that results from rotating the two-dimensional bipolar coordinate system about the axis that separates its two foci. Thus, the two foci     F  1     subscript  F  1    F_{1}   and    F  2     subscript  F  2    F_{2}   in bipolar coordinates become a ring of radius   a   a   a   in the    x  y      x  y    xy   plane of the toroidal coordinate system; the   z   z   z   -axis is the axis of rotation. The focal ring is also known as the reference circle.  Definition  The most common definition of toroidal coordinates    (  Ïƒ  ,  Ï„  ,  Ï•  )     Ïƒ  Ï„  Ï•    (\sigma,\tau,\phi)   is      x  =    a     sinh  Ï„     cosh  Ï„   -   cos  Ïƒ      cos  Ï•        x    a      Ï„       Ï„     Ïƒ       Ï•      x=a\ \frac{\sinh\tau}{\cosh\tau-\cos\sigma}\cos\phi         y  =    a     sinh  Ï„     cosh  Ï„   -   cos  Ïƒ      sin  Ï•        y    a      Ï„       Ï„     Ïƒ       Ï•      y=a\ \frac{\sinh\tau}{\cosh\tau-\cos\sigma}\sin\phi         z  =    a     sin  Ïƒ     cosh  Ï„   -   cos  Ïƒ          z    a      Ïƒ       Ï„     Ïƒ        z=a\ \frac{\sin\sigma}{\cosh\tau-\cos\sigma}     where the   Ïƒ   Ïƒ   \sigma   coordinate of a point   P   P   P   equals the angle     F  1   P   F  2        subscript  F  1   P   subscript  F  2     F_{1}PF_{2}   and the   Ï„   Ï„   \tau   coordinate equals the natural logarithm of the ratio of the distances    d  1     subscript  d  1    d_{1}   and    d  2     subscript  d  2    d_{2}   to opposite sides of the focal ring       Ï„  =   ln    d  1    d  2      .      Ï„       subscript  d  1    subscript  d  2       \tau=\ln\frac{d_{1}}{d_{2}}.     The coordinate ranges are     -  Ï€   <  Ïƒ  â‰¤  Ï€          Ï€   Ïƒ       Ï€     -\pi<\sigma\leq\pi   and    Ï„  â‰¥  0      Ï„  0    \tau\geq 0   and     0  â‰¤  Ï•  <   2  Ï€    .        0  Ï•         2  Ï€      0\leq\phi<2\pi.     Coordinate surfaces  (Figure)  |thumb|right|350px|Rotating this two-dimensional bipolar coordinate system about the vertical axis produces the three-dimensional toroidal coordinate system above. A circle on the vertical axis becomes the red sphere , whereas a circle on the horizontal axis becomes the blue torus .   Surfaces of constant   Ïƒ   Ïƒ   \sigma   correspond to spheres of different radii        (    x  2   +   y  2    )   +    (   z  -   a   cot  Ïƒ     )   2    =    a  2     sin  2   Ïƒ             superscript  x  2    superscript  y  2     superscript    z    a    Ïƒ     2       superscript  a  2     superscript   2   Ïƒ      \left(x^{2}+y^{2}\right)+\left(z-a\cot\sigma\right)^{2}=\frac{a^{2}}{\sin^{2}\sigma}     that all pass through the focal ring but are not concentric. The surfaces of constant   Ï„   Ï„   \tau   are non-intersecting tori of different radii        z  2   +    (      x  2   +   y  2     -   a   coth  Ï„     )   2    =    a  2     sinh  2   Ï„           superscript  z  2    superscript         superscript  x  2    superscript  y  2       a   hyperbolic-cotangent  Ï„     2       superscript  a  2     superscript   2   Ï„      z^{2}+\left(\sqrt{x^{2}+y^{2}}-a\coth\tau\right)^{2}=\frac{a^{2}}{\sinh^{2}\tau}     that surround the focal ring. The centers of the constant-   Ïƒ   Ïƒ   \sigma   spheres lie along the   z   z   z   -axis, whereas the constant-   Ï„   Ï„   \tau   tori are centered in the    x  y      x  y    xy   plane.  Inverse transformation  The (Ïƒ, Ï„, Ï†) coordinates may be calculated from the Cartesian coordinates ( x , y , z ) as follows. The azimuthal angle Ï† is given by the formula       tan  Ï•   =   y  x         Ï•     y  x     \tan\phi=\frac{y}{x}     The cylindrical radius Ï of the point P is given by       Ï  2   =    x  2   +   y  2         superscript  Ï  2      superscript  x  2    superscript  y  2      \rho^{2}=x^{2}+y^{2}     and its distances to the foci in the plane defined by Ï† is given by       d  1  2   =     (   Ï  +  a   )   2   +   z  2         superscript   subscript  d  1   2      superscript    Ï  a   2    superscript  z  2      d_{1}^{2}=(\rho+a)^{2}+z^{2}          d  2  2   =     (   Ï  -  a   )   2   +   z  2         superscript   subscript  d  2   2      superscript    Ï  a   2    superscript  z  2      d_{2}^{2}=(\rho-a)^{2}+z^{2}     (Figure)  Geometric interpretation of the coordinates Ïƒ and Ï„ of a point P . Observed in the plane of constant azimuthal angle Ï†, toroidal coordinates are equivalent to bipolar coordinates . The angle Ïƒ is formed by the two foci in this plane and P , whereas Ï„ is the logarithm of the ratio of distances to the foci. The corresponding circles of constant Ïƒ and Ï„ are shown in red and blue, respectively, and meet at right angles (magenta box); they are orthogonal.   The coordinate Ï„ equals the natural logarithm of the focal distances      Ï„  =   ln    d  1    d  2         Ï„       subscript  d  1    subscript  d  2       \tau=\ln\frac{d_{1}}{d_{2}}     whereas the coordinate Ïƒ equals the angle between the rays to the foci, which may be determined from the law of cosines       cos  Ïƒ   =   -     4   a  2    -   d  1  2   -   d  2  2     2   d  1    d  2            Ïƒ           4   superscript  a  2     superscript   subscript  d  1   2    superscript   subscript  d  2   2      2   subscript  d  1    subscript  d  2        \cos\sigma=-\frac{4a^{2}-d_{1}^{2}-d_{2}^{2}}{2d_{1}d_{2}}     where the sign of Ïƒ is determined by whether the coordinate surface sphere is above or below the x - y plane.  Scale factors  The scale factors for the toroidal coordinates   Ïƒ   Ïƒ   \sigma   and   Ï„   Ï„   \tau   are equal       h  Ïƒ   =   h  Ï„   =   a    cosh  Ï„   -   cos  Ïƒ            subscript  h  Ïƒ    subscript  h  Ï„          a      Ï„     Ïƒ        h_{\sigma}=h_{\tau}=\frac{a}{\cosh\tau-\cos\sigma}     whereas the azimuthal scale factor equals       h  Ï•   =    a   sinh  Ï„      cosh  Ï„   -   cos  Ïƒ          subscript  h  Ï•       a    Ï„        Ï„     Ïƒ       h_{\phi}=\frac{a\sinh\tau}{\cosh\tau-\cos\sigma}     Thus, the infinitesimal volume element equals       d  V   =       a  3    sinh  Ï„      (    cosh  Ï„   -   cos  Ïƒ    )   3     d   Ïƒ   d   Ï„   d  Ï•         d  V          superscript  a  3     Ï„     superscript      Ï„     Ïƒ    3    d  Ïƒ  d  Ï„  d  Ï•     dV=\frac{a^{3}\sinh\tau}{\left(\cosh\tau-\cos\sigma\right)^{3}}\,d\sigma\,d%
 \tau\,d\phi     and the Laplacian is given by        âˆ‡  2   Î¦   =      (    cosh  Ï„   -   cos  Ïƒ    )   3     a  2    sinh  Ï„            superscript  normal-âˆ‡  2   normal-Î¦      superscript      Ï„     Ïƒ    3      superscript  a  2     Ï„       \displaystyle\nabla^{2}\Phi=\frac{\left(\cosh\tau-\cos\sigma\right)^{3}}{a^{2}%
 \sinh\tau}     Other differential operators such as    âˆ‡  â‹…  ð…     normal-â‹…  normal-âˆ‡  ð…    \nabla\cdot\mathbf{F}   and    âˆ‡  Ã—  ð…      normal-âˆ‡  ð…    \nabla\times\mathbf{F}   can be expressed in the coordinates    (  Ïƒ  ,  Ï„  ,  Ï•  )     Ïƒ  Ï„  Ï•    (\sigma,\tau,\phi)   by substituting the scale factors into the general formulae found in orthogonal coordinates .  Toroidal harmonics  Standard separation  The 3-variable Laplace equation        âˆ‡  2   Î¦   =  0        superscript  normal-âˆ‡  2   normal-Î¦   0    \nabla^{2}\Phi=0     admits solution via separation of variables in toroidal coordinates. Making the substitution      Î¦  =   U     cosh  Ï„   -   cos  Ïƒ          normal-Î¦    U        Ï„     Ïƒ        \Phi=U\sqrt{\cosh\tau-\cos\sigma}     A separable equation is then obtained. A particular solution obtained by separation of variables is:      Î¦  =       cosh  Ï„   -   cos  Ïƒ       S  Î½    (  Ïƒ  )    T   Î¼  Î½     (  Ï„  )    V  Î¼    (  Ï•  )        normal-Î¦          Ï„     Ïƒ      subscript  S  Î½   Ïƒ   subscript  T    Î¼  Î½    Ï„   subscript  V  Î¼   Ï•     \Phi=\sqrt{\cosh\tau-\cos\sigma}\,\,S_{\nu}(\sigma)T_{\mu\nu}(\tau)V_{\mu}(%
 \phi)\,     where each function is a linear combination of:        S  Î½    (  Ïƒ  )    =     e   i  Î½  Ïƒ      and    e   -   i  Î½  Ïƒ             subscript  S  Î½   Ïƒ      superscript  e    i  Î½  Ïƒ    and   superscript  e      i  Î½  Ïƒ        S_{\nu}(\sigma)=e^{i\nu\sigma}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\nu\sigma}           T   Î¼  Î½     (  Ï„  )    =    P   Î½  -   1  /  2    Î¼    (   cosh  Ï„   )    and    Q   Î½  -   1  /  2    Î¼    (   cosh  Ï„   )           subscript  T    Î¼  Î½    Ï„      superscript   subscript  P    Î½    1  2     Î¼     Ï„   and   superscript   subscript  Q    Î½    1  2     Î¼     Ï„      T_{\mu\nu}(\tau)=P_{\nu-1/2}^{\mu}(\cosh\tau)\,\,\,\,\mathrm{and}\,\,\,\,Q_{%
 \nu-1/2}^{\mu}(\cosh\tau)           V  Î¼    (  Ï•  )    =     e   i  Î¼  Ï•      and    e   -   i  Î¼  Ï•             subscript  V  Î¼   Ï•      superscript  e    i  Î¼  Ï•    and   superscript  e      i  Î¼  Ï•        V_{\mu}(\phi)=e^{i\mu\phi}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\mu\phi}     Where P and Q are associated Legendre functions of the first and second kind. These Legendre functions are often referred to as toroidal harmonics.  Toroidal harmonics have many interesting properties. If you make a variable substitution      Q   -   1  2      (  z  )    =     2   1  +  z     K   (    2   1  +  z     )           subscript  Q      1  2     z         2    1  z     K      2    1  z        Q_{-\frac{1}{2}}(z)=\sqrt{\frac{2}{1+z}}K\left(\sqrt{\frac{2}{1+z}}\right)           P   -   1  2      (  z  )    =    2  Ï€     2   1  +  z     K   (     z  -  1    z  +  1     )           subscript  P      1  2     z       2  Ï€       2    1  z     K        z  1     z  1        P_{-\frac{1}{2}}(z)=\frac{2}{\pi}\sqrt{\frac{2}{1+z}}K\left(\sqrt{\frac{z-1}{z%
 +1}}\right)     and     K   K   \,\!K     where   E   E   \,\!E   and    Î¦  =   U   Ï        normal-Î¦    U    Ï      \Phi=\frac{U}{\sqrt{\rho}}   are the complete elliptic integrals of the first and second kind respectively. The rest of the toroidal harmonics can be obtained, for instance, in terms of the complete elliptic integrals, by using recurrence relations for associated Legendre functions.  The classic applications of toroidal coordinates are in solving partial differential equations , e.g., Laplace's equation for which toroidal coordinates allow a separation of variables or the Helmholtz equation , for which toroidal coordinates do not allow a separation of variables. Typical examples would be the electric potential and electric field of a conducting torus, or in the degenerate case, an electric current-ring (Hulme 1982).  An alternative separation  Alternatively, a different substitution may be made (Andrews 2006)       Ï  =     x  2   +   y  2     =    a   sinh  Ï„      cosh  Ï„   -   cos  Ïƒ      .        Ï       superscript  x  2    superscript  y  2              a    Ï„        Ï„     Ïƒ        \rho=\sqrt{x^{2}+y^{2}}=\frac{a\sinh\tau}{\cosh\tau-\cos\sigma}.     where      Î¦  =     a  Ï     S  Î½    (  Ïƒ  )    T   Î¼  Î½     (  Ï„  )    V  Î¼    (  Ï•  )        normal-Î¦      a  Ï    subscript  S  Î½   Ïƒ   subscript  T    Î¼  Î½    Ï„   subscript  V  Î¼   Ï•     \Phi=\frac{a}{\rho}\,\,S_{\nu}(\sigma)T_{\mu\nu}(\tau)V_{\mu}(\phi)\,     Again, a separable equation is obtained. A particular solution obtained by separation of variables is then:        S  Î½    (  Ïƒ  )    =     e   i  Î½  Ïƒ      and    e   -   i  Î½  Ïƒ             subscript  S  Î½   Ïƒ      superscript  e    i  Î½  Ïƒ    and   superscript  e      i  Î½  Ïƒ        S_{\nu}(\sigma)=e^{i\nu\sigma}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\nu\sigma}     where each function is a linear combination of:        T   Î¼  Î½     (  Ï„  )    =    P   Î¼  -   1  /  2    Î½    (   coth  Ï„   )    and    Q   Î¼  -   1  /  2    Î½    (   coth  Ï„   )           subscript  T    Î¼  Î½    Ï„      superscript   subscript  P    Î¼    1  2     Î½    hyperbolic-cotangent  Ï„   and   superscript   subscript  Q    Î¼    1  2     Î½    hyperbolic-cotangent  Ï„      T_{\mu\nu}(\tau)=P_{\mu-1/2}^{\nu}(\coth\tau)\,\,\,\,\mathrm{and}\,\,\,\,Q_{%
 \mu-1/2}^{\nu}(\coth\tau)            V  Î¼    (  Ï•  )    =     e   i  Î¼  Ï•      and    e   -   i  Î¼  Ï•       .         subscript  V  Î¼   Ï•      superscript  e    i  Î¼  Ï•    and   superscript  e      i  Î¼  Ï•        V_{\mu}(\phi)=e^{i\mu\phi}\,\,\,\,\mathrm{and}\,\,\,\,e^{-i\mu\phi}.         coth  Ï„     hyperbolic-cotangent  Ï„    \coth\tau     Note that although the toroidal harmonics are used again for the T function, the argument is    cosh  Ï„      Ï„    \cosh\tau   rather than   Î¼   Î¼   \mu   and the   Î½   Î½   \nu   and   Î¸   Î¸   \theta   indices are exchanged. This method is useful for situations in which the boundary conditions are independent of the spherical angle $\theta$ , such as the charged ring, an infinite half plane, or two parallel planes. For identities relating the toroidal harmonics with argument hyperbolic cosine with those of argument hyperbolic cotangent, see the Whipple formulae .  References   Byerly, W E. (1893) An elementary treatise on Fourier's series and spherical, cylindrical, and ellipsoidal harmonics, with applications to problems in mathematical physics Ginn & co. pp. 264â€“266      Bibliography        External links   MathWorld description of toroidal coordinates   "  Category:Coordinate systems   
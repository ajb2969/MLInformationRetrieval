<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1703">Trapezoidal rule</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Trapezoidal rule</h1>
<hr/>

<p>{{ About|the quadrature rule for approximating integrals|the implicit trapezoidal rule for solving initial value problems|Trapezoidal rule (differential equations)|the explicit trapezoidal rule for solving initial value problems|Heun's method}}   In <a href="numerical_analysis" title="wikilink">numerical analysis</a>, the <strong>trapezoidal rule</strong> (also known as the <strong>trapezoid rule</strong> or <strong>trapezium rule</strong>) is a technique for approximating the <a href="integral" title="wikilink">definite integral</a></p>

<p>

<math display="block" id="Trapezoidal_rule:0">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>a</mi>
     <mi>b</mi>
    </msubsup>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <ci>a</ci>
     </apply>
     <ci>b</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx.
  </annotation>
 </semantics>
</math>

</p>

<p>The trapezoidal rule works by approximating the region under the graph of the function 

<math display="inline" id="Trapezoidal_rule:1">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 as a <a class="uri" href="trapezoid" title="wikilink">trapezoid</a> and calculating its area. It follows that</p>

<p>

<math display="block" id="Trapezoidal_rule:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>a</mi>
      <mi>b</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>b</mi>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mfrac>
       <mrow>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>b</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mn>2</mn>
      </mfrac>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>a</ci>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>b</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>f</ci>
         <ci>a</ci>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx\approx(b-a)\left[\frac{f(a)+f(b)}{2}\right].
  </annotation>
 </semantics>
</math>

</p>
<h2 id="applicability-and-alternatives">Applicability and alternatives</h2>

<p>The trapezoidal rule is one of a family of formulas for <a href="numerical_integration" title="wikilink">numerical integration</a> called <a href="Newton–Cotes_formulas" title="wikilink">Newton–Cotes formulas</a>, of which the <a href="midpoint_rule" title="wikilink">midpoint rule</a> is similar to the trapezoid rule. <a href="Simpson's_rule" title="wikilink">Simpson's rule</a> is another member of the same family, and in general has faster convergence than the trapezoidal rule for functions which are twice continuously differentiable, though not in all specific cases. However for various classes of rougher functions (ones with weaker smoothness conditions), the trapezoidal rule has faster convergence in general than Simpson's rule.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>Moreover, the trapezoidal rule tends to become extremely accurate when <a href="periodic_function" title="wikilink">periodic functions</a> are integrated over their periods, which can be <a href="#Periodic_functions" title="wikilink">analyzed in various ways</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>For non-periodic functions, however, methods with unequally spaced points such as <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a> and <a href="Clenshaw–Curtis_quadrature" title="wikilink">Clenshaw–Curtis quadrature</a> are generally far more accurate; Clenshaw–Curtis quadrature can be viewed as a change of variables to express arbitrary integrals in terms of periodic integrals, at which point the trapezoidal rule can be applied accurately.</p>
<h2 id="numerical-implementation">Numerical implementation</h2>
<figure><b>(Figure)</b>
<figcaption>Illustration of trapezoidal rule used on a sequence of samples (in this case, a non-uniform grid).</figcaption>
</figure>
<h3 id="uniform-grid">Uniform grid</h3>

<p>For a domain discretized into <em>N</em> equally spaced panels, or <em>N</em>+1 grid points <em>a</em> = <em>x</em><sub>1</sub> 2 N+1 = <em>b</em>, where the grid spacing is <em>h</em>=(<em>b</em>-<em>a</em>)/<em>N</em>, the approximation to the integral becomes</p>

<p>

<math display="block" id="Trapezoidal_rule:3">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mi>a</mi>
     <mi>b</mi>
    </msubsup>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mfrac>
     <mi>h</mi>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>k</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>a</ci>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx\approx\frac{h}{2}\sum_{k=1}^{N}\left(f(x_{k+1})+f(x_{k})\right)
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Trapezoidal_rule:4">
 <semantics>
  <mrow>
   <mrow>
    <mi></mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>b</mi>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mi>N</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>3</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mn>4</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mi>N</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>N</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>b</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>N</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <plus></plus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}=\frac{b-a}{2N}(f(x_{1})+2f(x_{2})+2f(x_{3})+2f(x_{4})+\cdots+2f(x_{N})+f(x_%
{N+1})).
  </annotation>
 </semantics>
</math>

</p>
<h3 id="non-uniform-grid">Non-uniform grid</h3>

<p>When the grid spacing is non-uniform, one can use the formula</p>

<p>

<math display="block" id="Trapezoidal_rule:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>a</mi>
      <mi>b</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mrow>
           <mi>k</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>x</mi>
            <mrow>
             <mi>k</mi>
             <mo>+</mo>
             <mn>1</mn>
            </mrow>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <msub>
            <mi>x</mi>
            <mi>k</mi>
           </msub>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>a</ci>
      </apply>
      <ci>b</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <apply>
           <plus></plus>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{a}^{b}f(x)\,dx\approx\frac{1}{2}\sum_{k=1}^{N}\left(x_{k+1}-x_{k}\right)%
\left(f(x_{k+1})+f(x_{k})\right).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="error-analysis">Error analysis</h2>

<p>The error of the composite trapezoidal rule is the difference between the value of the integral and the numerical result:</p>

<p>

<math display="block" id="Trapezoidal_rule:6">
 <semantics>
  <mrow>
   <mtext>error</mtext>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mi>a</mi>
      <mi>b</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>b</mi>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>b</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mn>2</mn>
       </mfrac>
       <mo>+</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>k</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </munderover>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>a</mi>
           <mo>+</mo>
           <mrow>
            <mi>k</mi>
            <mfrac>
             <mrow>
              <mi>b</mi>
              <mo>-</mo>
              <mi>a</mi>
             </mrow>
             <mi>N</mi>
            </mfrac>
           </mrow>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>error</mtext>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>a</ci>
       </apply>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>b</ci>
        <ci>a</ci>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <plus></plus>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <apply>
           <times></times>
           <ci>f</ci>
           <ci>a</ci>
          </apply>
          <apply>
           <times></times>
           <ci>f</ci>
           <ci>b</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>k</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <ci>N</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <plus></plus>
           <ci>a</ci>
           <apply>
            <times></times>
            <ci>k</ci>
            <apply>
             <divide></divide>
             <apply>
              <minus></minus>
              <ci>b</ci>
              <ci>a</ci>
             </apply>
             <ci>N</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{error}=\int_{a}^{b}f(x)\,dx-\frac{b-a}{N}\left[{f(a)+f(b)\over 2}+\sum_{%
k=1}^{N-1}f\left(a+k\frac{b-a}{N}\right)\right]
  </annotation>
 </semantics>
</math>

</p>

<p>There exists a number <em>ξ</em> between <em>a</em> and <em>b</em>, such that<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Trapezoidal_rule:7">
 <semantics>
  <mrow>
   <mtext>error</mtext>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>b</mi>
         <mo>-</mo>
         <mi>a</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>3</mn>
      </msup>
      <mrow>
       <mn>12</mn>
       <msup>
        <mi>N</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <msup>
      <mi>f</mi>
      <mi>′′</mi>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>ξ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>error</mtext>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>b</ci>
         <ci>a</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">12</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>′′</ci>
      </apply>
      <ci>ξ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{error}=-\frac{(b-a)^{3}}{12N^{2}}f^{\prime\prime}(\xi)
  </annotation>
 </semantics>
</math>

</p>

<p>It follows that if the integrand is <a href="concave_up" title="wikilink">concave up</a> (and thus has a positive second derivative), then the error is negative and the trapezoidal rule overestimates the true value. This can also be seen from the geometric picture: the trapezoids include all of the area under the curve and extend over it. Similarly, a <a class="uri" href="concave-down" title="wikilink">concave-down</a> function yields an underestimate because area is unaccounted for under the curve, but none is counted above. If the interval of the integral being approximated includes an inflection point, the error is harder to identify.</p>

<p>In general, three techniques are used in the analysis of error:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<ol>
<li><a href="Fourier_series" title="wikilink">Fourier series</a></li>
<li><a href="Residue_calculus" title="wikilink">Residue calculus</a></li>
<li><a href="Euler–Maclaurin_summation_formula" title="wikilink">Euler–Maclaurin summation formula</a>:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></li>
</ol>

<p>An asymptotic error estimate for <em>N</em> → ∞ is given by</p>

<p>

<math display="block" id="Trapezoidal_rule:8">
 <semantics>
  <mrow>
   <mrow>
    <mtext>error</mtext>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>b</mi>
           <mo>-</mo>
           <mi>a</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mrow>
         <mn>12</mn>
         <msup>
          <mi>N</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
       <mrow>
        <mo maxsize="120%" minsize="120%">[</mo>
        <mrow>
         <mrow>
          <msup>
           <mi>f</mi>
           <mo>′</mo>
          </msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>b</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <msup>
           <mi>f</mi>
           <mo>′</mo>
          </msup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo maxsize="120%" minsize="120%">]</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>O</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>N</mi>
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <mtext>error</mtext>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <ci>b</ci>
          <ci>a</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">12</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>N</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>f</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>b</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>f</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>a</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>O</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>N</ci>
       <apply>
        <minus></minus>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \text{error}=-\frac{(b-a)^{2}}{12N^{2}}\big[f^{\prime}(b)-f^{\prime}(a)\big]+O%
(N^{-3}).
  </annotation>
 </semantics>
</math>

 Further terms in this error estimate are given by the Euler–Maclaurin summation formula.</p>

<p>It is argued that the speed of convergence of the trapezoidal rule reflects and can be used as a definition of classes of smoothness of the functions.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h3 id="periodic-functions">Periodic functions</h3>

<p>The trapezoidal rule often converges very quickly for periodic functions.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> This can be explained intuitively as:</p>
<dl>
<dd>When the function is periodic and one integrates over one full period, there are about as many sections of the graph that are concave up as concave down, so the errors cancel.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a>
</dd>
</dl>

<p>In the error formula above, f'(a) = f'(b), and only the O(N<sup>−3</sup>) term remains.</p>

<p>More detailed analysis can be found in.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h3 id="rough-functions">"Rough" functions</h3>

<p>For various classes of functions that are not twice-differentiable, the trapezoidal rule has sharper bounds than <a href="Simpson's_rule" title="wikilink">Simpson's rule</a>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a></li>
<li><a href="Newton–Cotes_formulas" title="wikilink">Newton–Cotes formulas</a></li>
<li><a href="Rectangle_method" title="wikilink">Rectangle method</a></li>
<li><a href="Romberg's_method" title="wikilink">Romberg's method</a></li>
<li><a href="Simpson's_rule" title="wikilink">Simpson's rule</a></li>
</ul>
<h2 id="notes">Notes</h2>
<references>
</references>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li></li>
<li>

<p>.</p></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://math.fullerton.edu/mathews/n2003/TrapezoidalRuleMod.html">Trapezoidal Rule for Numerical Integration</a></li>
<li><a href="http://dedekind.mit.edu/~stevenj/trapezoidal.pdf">Notes on the convergence of trapezoidal-rule quadrature</a></li>
</ul>

<p>"</p>

<p><a href="Category:Numerical_integration_(quadrature)" title="wikilink">Category:Numerical integration (quadrature)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
</ol>
</section>
</body>
</html>

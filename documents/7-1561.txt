   Transfer matrix      Transfer matrix   In applied mathematics , the transfer matrix is a formulation in terms of a block-Toeplitz matrix of the two-scale equation, which characterizes refinable functions . Refinable functions play an important role in wavelet theory and finite element theory.  For the mask   h   h   h   , which is a vector with component indexes from   a   a   a   to   b   b   b   , the transfer matrix of   h   h   h   , we call it    T  h     subscript  T  h    T_{h}   here, is defined as         (   T  h   )    j  ,  k    =   h    2  ⋅  j   -  k     .       subscript   subscript  T  h    j  k     subscript  h     normal-⋅  2  j   k      (T_{h})_{j,k}=h_{2\cdot j-k}.   More verbosely        T  h   =   (      h  a                       h   a  +  2       h   a  +  1       h  a                 h   a  +  4       h   a  +  3       h   a  +  2       h   a  +  1       h  a          ⋱    ⋱    ⋱    ⋱    ⋱    ⋱          h  b      h   b  -  1       h   b  -  2       h   b  -  3       h   b  -  4                  h  b      h   b  -  1       h   b  -  2                        h  b      )    .       subscript  T  h      subscript  h  a   absent  absent  absent  absent  absent     subscript  h    a  2     subscript  h    a  1     subscript  h  a   absent  absent  absent     subscript  h    a  4     subscript  h    a  3     subscript  h    a  2     subscript  h    a  1     subscript  h  a   absent    normal-⋱  normal-⋱  normal-⋱  normal-⋱  normal-⋱  normal-⋱    absent   subscript  h  b    subscript  h    b  1     subscript  h    b  2     subscript  h    b  3     subscript  h    b  4      absent  absent  absent   subscript  h  b    subscript  h    b  1     subscript  h    b  2      absent  absent  absent  absent  absent   subscript  h  b       T_{h}=\begin{pmatrix}h_{a}&&&&&\\
 h_{a+2}&h_{a+1}&h_{a}&&&\\
 h_{a+4}&h_{a+3}&h_{a+2}&h_{a+1}&h_{a}&\\
 \ddots&\ddots&\ddots&\ddots&\ddots&\ddots\\
 &h_{b}&h_{b-1}&h_{b-2}&h_{b-3}&h_{b-4}\\
 &&&h_{b}&h_{b-1}&h_{b-2}\\
 &&&&&h_{b}\end{pmatrix}.   The effect of    T  h     subscript  T  h    T_{h}   can be expressed in terms of the downsampling operator "   ↓   normal-↓   \downarrow   ":        T  h   ⋅  x   =   (   h  *  x   )   ↓  2.         normal-⋅   subscript  T  h   x     h  x     normal-↓    2.     T_{h}\cdot x=(h*x)\downarrow 2.     Properties         T  h   ⋅  x   =    T  x   ⋅  h        normal-⋅   subscript  T  h   x    normal-⋅   subscript  T  x   h     T_{h}\cdot x=T_{x}\cdot h   .  If you drop the first and the last column and move the odd-indexed columns to the left and the even-indexed columns to the right, then you obtain a transposed Sylvester matrix .  The determinant of a transfer matrix is essentially a resultant.    More precisely:  Let    h  e     subscript  h  normal-e    h_{\mathrm{e}}   be the even-indexed coefficients of   h   h   h   (      (   h  e   )   k   =   h   2  k         subscript   subscript  h  normal-e   k    subscript  h    2  k      (h_{\mathrm{e}})_{k}=h_{2k}   ) and let    h  o     subscript  h  normal-o    h_{\mathrm{o}}   be the odd-indexed coefficients of   h   h   h   (      (   h  o   )   k   =   h    2  k   +  1         subscript   subscript  h  normal-o   k    subscript  h      2  k   1      (h_{\mathrm{o}})_{k}=h_{2k+1}   ).  Then     det   T  h    =      (   -  1   )    ⌊     b  -  a   +  1   4   ⌋    ⋅   h  a   ⋅   h  b   ⋅  res    (   h  e   ,   h  o   )           subscript  T  h       normal-⋅   superscript    1           b  a   1   4      subscript  h  a    subscript  h  b   res     subscript  h  normal-e    subscript  h  normal-o       \det T_{h}=(-1)^{\lfloor\frac{b-a+1}{4}\rfloor}\cdot h_{a}\cdot h_{b}\cdot%
 \mathrm{res}(h_{\mathrm{e}},h_{\mathrm{o}})   , where   res   res   \mathrm{res}   is the resultant .  This connection allows for fast computation using the Euclidean algorithm .    For the trace of the transfer matrix of convolved masks holds         tr    T   g  *  h     =      tr    T  g    ⋅   tr     T  h          tr   subscript  T    g  h        normal-⋅    tr   subscript  T  g    tr    subscript  T  h      \mathrm{tr}~{}T_{g*h}=\mathrm{tr}~{}T_{g}\cdot\mathrm{tr}~{}T_{h}      For the determinant of the transfer matrix of convolved mask holds        det   T   g  *  h     =   det    T  g   ⋅   det     T  h   ⋅  res    (   g  -   ,  h  )              subscript  T    g  h        normal-⋅   subscript  T  g        normal-⋅   subscript  T  h   res     subscript  g    h         \det T_{g*h}=\det T_{g}\cdot\det T_{h}\cdot\mathrm{res}(g_{-},h)      where    g  -     subscript  g     g_{-}   denotes the mask with alternating signs, i.e.      (   g  -   )   k   =     (   -  1   )   k   ⋅   g  k         subscript   subscript  g    k    normal-⋅   superscript    1   k    subscript  g  k      (g_{-})_{k}=(-1)^{k}\cdot g_{k}   .    If      T  h   ⋅  x   =  0       normal-⋅   subscript  T  h   x   0    T_{h}\cdot x=0   , then      T   g  *  h    ⋅   (    g  -   *  x   )    =  0       normal-⋅   subscript  T    g  h       subscript  g    x    0    T_{g*h}\cdot(g_{-}*x)=0   .    This is a concretion of the determinant property above. From the determinant property one knows that    T   g  *  h      subscript  T    g  h     T_{g*h}   is singular whenever    T  h     subscript  T  h    T_{h}   is singular. This property also tells, how vectors from the null space of    T  h     subscript  T  h    T_{h}   can be converted to null space vectors of    T   g  *  h      subscript  T    g  h     T_{g*h}   .    If   x   x   x   is an eigenvector of    T  h     subscript  T  h    T_{h}   with respect to the eigenvalue   λ   λ   \lambda   , i.e.         T  h   ⋅  x   =   λ  ⋅  x        normal-⋅   subscript  T  h   x    normal-⋅  λ  x     T_{h}\cdot x=\lambda\cdot x   ,   then    x  *   (  1  ,   -  1   )       x   1    1      x*(1,-1)   is an eigenvector of    T   h  *   (  1  ,  1  )       subscript  T    h   1  1      T_{h*(1,1)}   with respect to the same eigenvalue, i.e.        T   h  *   (  1  ,  1  )     ⋅   (   x  *   (  1  ,   -  1   )    )    =   λ  ⋅   (   x  *   (  1  ,   -  1   )    )         normal-⋅   subscript  T    h   1  1       x   1    1       normal-⋅  λ    x   1    1        T_{h*(1,1)}\cdot(x*(1,-1))=\lambda\cdot(x*(1,-1))   .    Let     λ  a   ,  …  ,   λ  b       subscript  λ  a   normal-…   subscript  λ  b     \lambda_{a},\dots,\lambda_{b}   be the eigenvalues of    T  h     subscript  T  h    T_{h}   , which implies      λ  a   +  …  +   λ  b    =    tr    T  h           subscript  λ  a   normal-…   subscript  λ  b      tr   subscript  T  h      \lambda_{a}+\dots+\lambda_{b}=\mathrm{tr}~{}T_{h}   and more generally      λ  a  n   +  …  +   λ  b  n    =   tr   (   T  h  n   )           superscript   subscript  λ  a   n   normal-…   superscript   subscript  λ  b   n      tr   superscript   subscript  T  h   n      \lambda_{a}^{n}+\dots+\lambda_{b}^{n}=\mathrm{tr}(T_{h}^{n})   . This sum is useful for estimating the spectral radius of    T  h     subscript  T  h    T_{h}   . There is an alternative possibility for computing the sum of eigenvalue powers, which is faster for small   n   n   n   .    Let     C  k   h       subscript  C  k   h    C_{k}h   be the periodization of   h   h   h   with respect to period     2  k   -  1       superscript  2  k   1    2^{k}-1   . That is     C  k   h       subscript  C  k   h    C_{k}h   is a circular filter, which means that the component indexes are residue classes with respect to the modulus     2  k   -  1       superscript  2  k   1    2^{k}-1   . Then with the upsampling operator   ↑   normal-↑   \uparrow   it holds      tr   (   T  h  n   )   =    (   C  k   h  *   (   C  k   h  ↑  2  )   *   (   C  k   h  ↑   2  2   )   *  ⋯  *   (   C  k   h  ↑   2   n  -  1    )   )     [  0  ]     2  n   -  1        fragments  tr   fragments  normal-(   superscript   subscript  T  h   n   normal-)     subscript   fragments  normal-(   subscript  C  k   h    fragments  normal-(   subscript  C  k   h  normal-↑  2  normal-)     fragments  normal-(   subscript  C  k   h  normal-↑   superscript  2  2   normal-)    normal-⋯    fragments  normal-(   subscript  C  k   h  normal-↑   superscript  2    n  1    normal-)   normal-)    subscript   delimited-[]  0      superscript  2  n   1       \mathrm{tr}(T_{h}^{n})=\left(C_{k}h*(C_{k}h\uparrow 2)*(C_{k}h\uparrow 2^{2})*%
 \cdots*(C_{k}h\uparrow 2^{n-1})\right)_{[0]_{2^{n}-1}}     Actually not    n  -  2      n  2    n-2   convolutions are necessary, but only    2  ⋅    log  2   n      normal-⋅  2    subscript   2   n     2\cdot\log_{2}n   ones, when applying the strategy of efficient computation of powers. Even more the approach can be further sped up using the Fast Fourier transform .    From the previous statement we can derive an estimate of the spectral radius of    ϱ   (   T  h   )       ϱ   subscript  T  h     \varrho(T_{h})   . It holds        ϱ   (   T  h   )    ≥   a    #  h     ≥   1     3  ⋅  #   h             ϱ   subscript  T  h      a      normal-#  h            1       normal-⋅  3  normal-#   h        \varrho(T_{h})\geq\frac{a}{\sqrt{\#h}}\geq\frac{1}{\sqrt{3\cdot\#h}}      where    #  h      normal-#  h    \#h   is the size of the filter and if all eigenvalues are real, it is also true that       ϱ   (   T  h   )    ≤  a        ϱ   subscript  T  h    a    \varrho(T_{h})\leq a   ,  where    a  =    ∥    C  2   h   ∥   2       a   subscript   norm     subscript  C  2   h    2     a=\|C_{2}h\|_{2}   .   See also   Transfer matrix method  Hurwitz determinant   References     (contains proofs of the above properties)   "  Category:Wavelets  Category:Numerical analysis   
   Midpoint method      Midpoint method   In numerical analysis , a branch of applied mathematics , the midpoint method is a one-step method for numerically solving the differential equation ,         y  ‚Ä≤    (  t  )    =   f   (  t  ,   y   (  t  )    )     ,    y   (   t  0   )    =   y  0       formulae-sequence       superscript  y  normal-‚Ä≤   t     f   t    y  t          y   subscript  t  0     subscript  y  0      y^{\prime}(t)=f(t,y(t)),\quad y(t_{0})=y_{0}   . The explicit midpoint method is given by the formula       y   n  +  1    =     y  n   +   h  f   (    t  n   +   h  2    ,    y  n   +    h  2   f   (   t  n   ,   y  n   )     )     ,   (   1  e   )         subscript  y    n  1        subscript  y  n     h  f      subscript  t  n     h  2       subscript  y  n       h  2   f    subscript  t  n    subscript  y  n           1  e      y_{n+1}=y_{n}+hf\left(t_{n}+\frac{h}{2},y_{n}+\frac{h}{2}f(t_{n},y_{n})\right)%
 ,\qquad\qquad(1e)   the implicit midpoint method by       y   n  +  1    =     y  n   +   h  f   (    t  n   +   h  2    ,    1  2    (    y  n   +   y   n  +  1     )    )     ,   (   1  i   )         subscript  y    n  1        subscript  y  n     h  f      subscript  t  n     h  2        1  2      subscript  y  n    subscript  y    n  1           1  i      y_{n+1}=y_{n}+hf\left(t_{n}+\frac{h}{2},\frac{1}{2}(y_{n}+y_{n+1})\right),%
 \qquad\qquad(1i)   for    n  =   0  ,  1  ,  2  ,  ‚Ä¶       n   0  1  2  normal-‚Ä¶     n=0,1,2,\dots   Here,   h   h   h   is the step size ‚Äî a small positive number,      t  n   =    t  0   +   n  h     ,       subscript  t  n      subscript  t  0     n  h      t_{n}=t_{0}+nh,   and    y  n     subscript  y  n    y_{n}   is the computed approximate value of     y   (   t  n   )    .      y   subscript  t  n     y(t_{n}).   The explicit midpoint method is also known as the modified Euler method , 1 the implicit method is the most simple collocation method , and, applied to Hamiltionian dynamics, a symplectic integrator .  The name of the method comes from the fact that in the formula above the function   f   f   f   giving the slope of the solution is evaluated at     t  =    t  n   +   h  /  2     ,      t     subscript  t  n     h  2      t=t_{n}+h/2,   which is the midpoint between    t  n     subscript  t  n    t_{n}   at which the value of y ( t ) is known and    t   n  +  1      subscript  t    n  1     t_{n+1}   at which the value of y ( t ) needs to be found.  The local error at each step of the midpoint method is of order    O   (   h  3   )       O   superscript  h  3     O\left(h^{3}\right)   , giving a global error of order    O   (   h  2   )       O   superscript  h  2     O\left(h^{2}\right)   . Thus, while more computationally intensive than Euler's method , the midpoint method generally gives more accurate results.  The methods are examples of a class of higher-order methods known as Runge-Kutta methods .  Derivation of the midpoint method    The midpoint method is a refinement of the Euler's method        y   n  +  1    =    y  n   +   h  f   (   t  n   ,   y  n   )      ,       subscript  y    n  1       subscript  y  n     h  f    subscript  t  n    subscript  y  n        y_{n+1}=y_{n}+hf(t_{n},y_{n}),\,   and is derived in a similar manner. The key to deriving Euler's method is the approximate equality       y   (   t  +  h   )    ‚âà     y   (  t  )    +   h  f   (  t  ,   y   (  t  )    )      (  2  )          y    t  h         y  t     h  f   t    y  t      2     y(t+h)\approx y(t)+hf(t,y(t))\qquad\qquad(2)   which is obtained from the slope formula        y  ‚Ä≤    (  t  )    ‚âà      y   (   t  +  h   )    -   y   (  t  )     h    (  3  )           superscript  y  normal-‚Ä≤   t          y    t  h      y  t    h   3     y^{\prime}(t)\approx\frac{y(t+h)-y(t)}{h}\qquad\qquad(3)   and keeping in mind that      y  ‚Ä≤   =   f   (  t  ,  y  )     .       superscript  y  normal-‚Ä≤     f   t  y      y^{\prime}=f(t,y).     For the midpoint methods, one replaces (3) with the more accurate        y  ‚Ä≤    (   t  +   h  2    )    ‚âà     y   (   t  +  h   )    -   y   (  t  )     h          superscript  y  normal-‚Ä≤     t    h  2           y    t  h      y  t    h     y^{\prime}\left(t+\frac{h}{2}\right)\approx\frac{y(t+h)-y(t)}{h}   when instead of (2) we find      y   (  t  +  h  )   ‚âà  y   (  t  )   +  h  f   (  t  +   h  2   ,  y   (  t  +   h  2   )   )   .   (  4  )      fragments  y   fragments  normal-(  t   h  normal-)    y   fragments  normal-(  t  normal-)    h  f   fragments  normal-(  t     h  2   normal-,  y   fragments  normal-(  t     h  2   normal-)   normal-)   normal-.  italic-   fragments  normal-(  4  normal-)     y(t+h)\approx y(t)+hf\left(t+\frac{h}{2},y\left(t+\frac{h}{2}\right)\right).%
 \qquad\qquad(4)     One cannot use this equation to find    y   (   t  +  h   )       y    t  h     y(t+h)   as one does not know   y   y   y   at    t  +   h  /  2       t    h  2     t+h/2   . The solution is then to use a Taylor series expansion exactly as if using the Euler method to solve for    y   (   t  +   h  /  2    )       y    t    h  2      y(t+h/2)   :        y   (   t  +   h  2    )    ‚âà    y   (  t  )    +    h  2    y  ‚Ä≤    (  t  )     =    y   (  t  )    +    h  2   f   (  t  ,   y   (  t  )    )      ,          y    t    h  2         y  t       h  2    superscript  y  normal-‚Ä≤   t             y  t       h  2   f   t    y  t         y\left(t+\frac{h}{2}\right)\approx y(t)+\frac{h}{2}y^{\prime}(t)=y(t)+\frac{h}%
 {2}f(t,y(t)),   which, when plugged in (4), gives us       y   (   t  +  h   )    ‚âà    y   (  t  )    +   h  f   (   t  +   h  2    ,    y   (  t  )    +    h  2   f   (  t  ,   y   (  t  )    )     )           y    t  h        y  t     h  f     t    h  2        y  t       h  2   f   t    y  t           y(t+h)\approx y(t)+hf\left(t+\frac{h}{2},y(t)+\frac{h}{2}f(t,y(t))\right)   and the explicit midpoint method (1e).  The implicit method (1i) is obtained by approximating the value at the half step    t  +   h  /  2       t    h  2     t+h/2   by the midpoint of the line segment from    y   (  t  )       y  t    y(t)   to    y   (   t  +  h   )       y    t  h     y(t+h)          y   (   t  +   h  2    )    ‚âà    1  2    (    y   (  t  )    +   y   (   t  +  h   )     )          y    t    h  2         1  2       y  t     y    t  h        y\left(t+\frac{h}{2}\right)\approx\frac{1}{2}\bigl(y(t)+y(t+h)\bigr)   and thus         y   (   t  +  h   )    -   y   (  t  )     h   ‚âà    y  ‚Ä≤    (   t  +   h  2    )    ‚âà  k  =   f   (   t  +   h  2    ,    1  2    (    y   (  t  )    +   y   (   t  +  h   )     )    )                y    t  h      y  t    h      superscript  y  normal-‚Ä≤     t    h  2          k         f     t    h  2        1  2       y  t     y    t  h           \frac{y(t+h)-y(t)}{h}\approx y^{\prime}\left(t+\frac{h}{2}\right)\approx k=f%
 \left(t+\frac{h}{2},\frac{1}{2}\bigl(y(t)+y(t+h)\bigr)\right)   Inserting the approximation     y  n   +    h   k        subscript  y  n     h  k     y_{n}+h\,k   for    y   (    t  n   +  h   )       y     subscript  t  n   h     y(t_{n}+h)   results in the implicit Runge-Kutta method     k   k   \displaystyle k   which contains the implicit Euler method with step size    h  /  2      h  2    h/2   as its first part.  Because of the time symmetry of the implicit method, all terms of even degree in   h   h   h   of the local error cancel, so that the local error is automatically of order    ùí™   (   h  3   )       ùí™   superscript  h  3     \mathcal{O}(h^{3})   . Replacing the implicit with the explicit Euler method in the determination of   k   k   k   results again in the explicit midpoint method.  See also   Rectangle method  Heun's method  Leapfrog integration and Verlet integration   Notes  References     .   "  Category:Numerical differential equations  Category:Runge‚ÄìKutta methods     ‚Ü©     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="69">Combined Linear Congruential Generator</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Combined Linear Congruential Generator</h1>
<hr/>

<p>A <strong>Combined Linear Congruential Generator</strong> (<strong>CLCG</strong>) is a <a href="Pseudorandomness" title="wikilink">pseudo-random</a> number generator <a class="uri" href="algorithm" title="wikilink">algorithm</a> based on combining two or more <a href="linear_congruential_generator" title="wikilink">linear congruential generators</a> (LCG). A traditional LCG has a <a href="Periodic_function" title="wikilink">period</a> which is inadequate for complex system simulation.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> By combining two or more LCGs, random numbers with a longer period and better statistical properties can be created.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The algorithm is defined as:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:0">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>i</mi>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>k</mi>
      </munderover>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>j</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msub>
        <mi>Y</mi>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>1</mn>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <list>
         <ci>i</ci>
         <ci>j</ci>
        </list>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}\equiv\left(\sum_{j=1}^{k}(-1)^{j-1}Y_{i,j}\right)\;\;(\mathop{{\rm mod}}%
(m_{1}-1))
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:1">
 <semantics>
  <msub>
   <mi>m</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1}
  </annotation>
 </semantics>
</math>

 — the "<a href="modulo_operation" title="wikilink">modulus</a>" of the first LCG</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:2">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <list>
     <ci>i</ci>
     <ci>j</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{i,j}
  </annotation>
 </semantics>
</math>

 — the i<sup>th</sup> input from the j<sup>th</sup> LCG</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:3">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i}
  </annotation>
 </semantics>
</math>

 — the i<sup>th</sup> generated random integer</p>

<p>with:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:4">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>i</mi>
   </msub>
   <mo>≡</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <msub>
         <mi>X</mi>
         <mi>i</mi>
        </msub>
        <mo>/</mo>
        <msub>
         <mi>m</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <msub>
          <mi>X</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>m</mi>
           <mn>1</mn>
          </msub>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>/</mo>
        <msub>
         <mi>m</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <msub>
          <mi>X</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <gt></gt>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}\equiv\begin{cases}X_{i}/m_{1}&\text{for }X_{i}>0\\
(m_{1}-1)/m_{1}&\text{for }X_{i}=0\end{cases}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Combined_Linear_Congruential_Generator:5">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

 is a <a href="Uniform_distribution_(continuous)" title="wikilink">uniformly distributed</a> random number between 0 and 1.</p>
<h2 id="derivation">Derivation</h2>

<p>If <em>W</em><sub><em>i</em>,1</sub>, <em>W</em><sub><em>i</em>,2</sub>, ..., <em>W</em><sub><em>i</em>,k</sub> are any independent, discrete, random-variables and one of them is uniformly distributed from 0 to <em>m</em><sub>1</sub> − 2, then <em>Z</em><sub><em>i</em></sub> is uniformly distributed between 0 and <em>m</em><sub>1</sub> − 2, where:<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:6">
 <semantics>
  <mrow>
   <msub>
    <mi>Z</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>k</mi>
      </munderover>
      <msub>
       <mi>W</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>1</mn>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Z</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>W</ci>
       <list>
        <ci>i</ci>
        <ci>j</ci>
       </list>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{i}=\left(\sum_{j=1}^{k}W_{i,j}\right)\;\;(\mathop{{\rm mod}}(m_{1}-1))
  </annotation>
 </semantics>
</math>

</p>

<p>Let <em>X</em><sub><em>i</em>,1</sub>, <em>X</em><sub><em>i</em>,2</sub>, ..., <em>X</em><sub><em>i</em>,<em>k</em></sub> be outputs from <em>k</em> LCGs. If <em>W</em><sub><em>i</em>,<em>j</em></sub> is defined as <em>X</em><sub><em>i</em>,<em>j</em></sub> − 1, then <em>W</em><sub><em>i</em>,<em>j</em></sub> will be approximately uniformly distributed from 0 to <em>m</em><sub><em>j</em></sub> − 1.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> The coefficient "(−1)<sup><em>j</em>−1</sup>" implicitly performs the subtraction of one from <em>X</em><sub><em>i</em>,<em>j</em></sub>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="properties">Properties</h2>

<p>The CLCG provides an efficient way to calculate pseudo-random numbers. The LCG algorithm is computationally inexpensive to use.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> The results of multiple LCG algorithms are combined through the CLCG algorithm to create pseudo-random numbers with a longer <a href="Periodic_function" title="wikilink">period</a> than is achievable with the LCG method by itself.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>The period of a CLCG is dependent on the seed value used to initiate the algorithm. The maximum period of a CLCG is defined by the function:<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:7">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>1</mn>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>m</mi>
         <mn>2</mn>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">⋯</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>m</mi>
         <mi>k</mi>
        </msub>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mn>2</mn>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <ci>k</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=((m_{1}-1)(m_{2}-1)\cdots(m_{k}-1))/(2^{k-1})
  </annotation>
 </semantics>
</math>

</p>
<h2 id="example">Example</h2>

<p>The following is an example algorithm designed for use in 32 bit computers:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:8">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=2
  </annotation>
 </semantics>
</math>

 LCGs are used with the following properties:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:9">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>40</mn>
    <mo>,</mo>
    <mn>014</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <cn type="integer">40</cn>
     <cn type="integer">014</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1}=40,014
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:10">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mn>147</mn>
    <mo>,</mo>
    <mn>483</mn>
    <mo>,</mo>
    <mn>563</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <cn type="integer">2</cn>
     <cn type="integer">147</cn>
     <cn type="integer">483</cn>
     <cn type="integer">563</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1}=2,147,483,563
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:11">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>40</mn>
    <mo>,</mo>
    <mn>692</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <list>
     <cn type="integer">40</cn>
     <cn type="integer">692</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2}=40,692
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:12">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mn>147</mn>
    <mo>,</mo>
    <mn>483</mn>
    <mo>,</mo>
    <mn>399</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
    <list>
     <cn type="integer">2</cn>
     <cn type="integer">147</cn>
     <cn type="integer">483</cn>
     <cn type="integer">399</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{2}=2,147,483,399
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:13">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>c</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{1}=c_{2}=0
  </annotation>
 </semantics>
</math>

</p>

<p>The CLCG algorithm is setup as follows:</p>

<p>1. The seed for the first LCG, 

<math display="inline" id="Combined_Linear_Congruential_Generator:14">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <list>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0,1}
  </annotation>
 </semantics>
</math>

, should be selected in the range of [1, 2,147,483,562].</p>
<dl>
<dd>The seed for the second LCG, 

<math display="inline" id="Combined_Linear_Congruential_Generator:15">
 <semantics>
  <msub>
   <mi>Y</mi>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mn>2</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Y</ci>
    <list>
     <cn type="integer">0</cn>
     <cn type="integer">2</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{0,2}
  </annotation>
 </semantics>
</math>

, should be selected in the range of [1, 2,147,483,398].
</dd>
<dd>Set

<math display="block" id="Combined_Linear_Congruential_Generator:16">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i=0
  </annotation>
 </semantics>
</math>


</dd>
</dl>

<p>2. The two LCGs are evaluated as follows:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:17">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mrow>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>40</mn>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mn>014</mn>
      <mo>×</mo>
      <msub>
       <mi>Y</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mrow>
        <mn>2</mn>
        <mo>,</mo>
        <mn>147</mn>
        <mo>,</mo>
        <mn>483</mn>
        <mo>,</mo>
        <mn>563</mn>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <list>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">1</cn>
     </list>
    </apply>
    <list>
     <cn type="integer">40</cn>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <times></times>
       <cn type="integer">014</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <list>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </list>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <list>
        <cn type="integer">2</cn>
        <cn type="integer">147</cn>
        <cn type="integer">483</cn>
        <cn type="integer">563</cn>
       </list>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{i+1,1}=40,014\times Y_{i,1}\;\;(\mathop{{\rm mod}}2,147,483,563)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:18">
 <semantics>
  <mrow>
   <msub>
    <mi>Y</mi>
    <mrow>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>40</mn>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mn>692</mn>
      <mo>×</mo>
      <msub>
       <mi>Y</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mspace width="veryverythickmathspace">
     </mspace>
     <mrow>
      <mo lspace="8.1pt" stretchy="false">(</mo>
      <mrow>
       <mo>mod</mo>
       <mrow>
        <mn>2</mn>
        <mo>,</mo>
        <mn>147</mn>
        <mo>,</mo>
        <mn>483</mn>
        <mo>,</mo>
        <mn>399</mn>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Y</ci>
     <list>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </list>
    </apply>
    <list>
     <cn type="integer">40</cn>
     <apply>
      <csymbol cd="latexml">annotated</csymbol>
      <apply>
       <times></times>
       <cn type="integer">692</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <list>
         <ci>i</ci>
         <cn type="integer">2</cn>
        </list>
       </apply>
      </apply>
      <apply>
       <ci>pmod</ci>
       <list>
        <cn type="integer">2</cn>
        <cn type="integer">147</cn>
        <cn type="integer">483</cn>
        <cn type="integer">399</cn>
       </list>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y_{i+1,2}=40,692\times Y_{i,2}\;\;(\mathop{{\rm mod}}2,147,483,399)
  </annotation>
 </semantics>
</math>

</p>

<p>3. The CLCG equation is solved as shown below:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:19">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>Y</mi>
       <mrow>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo>,</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>Y</mi>
       <mrow>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo>,</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mspace width="veryverythickmathspace">
    </mspace>
    <mrow>
     <mo lspace="8.1pt" stretchy="false">(</mo>
     <mrow>
      <mo>mod</mo>
      <mrow>
       <mn>2</mn>
       <mo>,</mo>
       <mn>147</mn>
       <mo>,</mo>
       <mn>483</mn>
       <mo>,</mo>
       <mn>562</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">annotated</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <list>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">1</cn>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Y</ci>
       <list>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <apply>
      <ci>pmod</ci>
      <list>
       <cn type="integer">2</cn>
       <cn type="integer">147</cn>
       <cn type="integer">483</cn>
       <cn type="integer">562</cn>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{i+1}=(Y_{i+1,1}-Y_{i+1,2})\;\;(\mathop{{\rm mod}}2,147,483,562)
  </annotation>
 </semantics>
</math>

</p>

<p>4. Calculate the random number:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:20">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>i</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo>,</mo>
        <mn>147</mn>
        <mo>,</mo>
        <mn>483</mn>
        <mo>,</mo>
        <mn>563</mn>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>i</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>></mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>X</mi>
           <mrow>
            <mi>i</mi>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo>,</mo>
         <mn>147</mn>
         <mo>,</mo>
         <mn>483</mn>
         <mo>,</mo>
         <mn>563</mn>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>i</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo><</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>2</mn>
        <mo>,</mo>
        <mn>147</mn>
        <mo>,</mo>
        <mn>483</mn>
        <mo>,</mo>
        <mrow>
         <mn>562</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo>,</mo>
        <mn>147</mn>
        <mo>,</mo>
        <mn>483</mn>
        <mo>,</mo>
        <mn>563</mn>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>for</mtext>
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>i</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <list>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">147</cn>
      <cn type="integer">483</cn>
      <cn type="integer">563</cn>
     </list>
     <apply>
      <gt></gt>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <plus></plus>
      <vector>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <plus></plus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">147</cn>
       <cn type="integer">483</cn>
       <cn type="integer">563</cn>
      </vector>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <lt></lt>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <list>
      <cn type="integer">2</cn>
      <cn type="integer">147</cn>
      <cn type="integer">483</cn>
      <apply>
       <divide></divide>
       <cn type="integer">562</cn>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">147</cn>
      <cn type="integer">483</cn>
      <cn type="integer">563</cn>
     </list>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <mtext>for</mtext>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i+1}=\begin{cases}X_{i+1}/2,147,483,563&\text{for }X_{i+1}>0\\
(X_{i+1}/2,147,483,563)+1&\text{for }X_{i+1}<0\\
2,147,483,562/2,147,483,563&\text{for }X_{i+1}=0\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>5. Increment the counter (i=i+1) then return to step 2 and repeat.</p>

<p>The maximum period of the two LCGs used is calculated using the formula:.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:21">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>m</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m-1)
  </annotation>
 </semantics>
</math>

 This equates to 2.1x10<sup>9</sup> for the two LCGs used.</p>

<p>This CLCG shown in this example has a maximum period of:</p>

<p>

<math display="block" id="Combined_Linear_Congruential_Generator:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>m</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>m</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2.3</mn>
    <mo>×</mo>
    <msup>
     <mn>10</mn>
     <mn>18</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="float">2.3</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">10</cn>
      <cn type="integer">18</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (m_{1}-1)(m_{2}-1)/2=2.3\times 10^{18}
  </annotation>
 </semantics>
</math>

 This represents a tremendous improvement over the period of the individual LCGs. It can be seen that the combined method increases the period by 9 orders of magnitude.</p>

<p>Surprisingly the period of this CLCG may not be sufficient for all applications:.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Other algorithms using the CLCG method have been used to create pseudo-random number generators with periods as long as 3x10<sup>57</sup>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a><a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Linear_congruential_generator" title="wikilink">Linear congruential generator</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<ul>
<li>Banks, Jerry., Carson, John S., Nelson, Barry L., Nicol, David M., (2010). <em>Discrete-Event System Simulation</em>, 5th edition, Prentice Hall, ISBN 0-13-606212-1.</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="https://www.msu.edu/~amthoral/random.ppt">An overview of use and testing of pseudo-random number generators</a></li>
</ul>

<p>"</p>

<p><a href="Category:Pseudorandom_number_generators" title="wikilink">Category:Pseudorandom number generators</a> <a href="Category:Modular_arithmetic" title="wikilink">Category:Modular arithmetic</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Banks 2010, Sec. 7.3.2<a href="#fnref1">↩</a></li>
<li id="fn2">Banks 2010, Sec. 7.3.2<a href="#fnref2">↩</a></li>
<li id="fn3">L'Ecuyer 1988<a href="#fnref3">↩</a></li>
<li id="fn4">L'Ecuyer 1988<a href="#fnref4">↩</a></li>
<li id="fn5">L'Ecuyer 1988<a href="#fnref5">↩</a></li>
<li id="fn6">Banks 2010, Sec. 7.3.2<a href="#fnref6">↩</a></li>
<li id="fn7">Pandey 2008, Sec. 2.2<a href="#fnref7">↩</a></li>
<li id="fn8">Pandey 2008, Sec. 2.2<a href="#fnref8">↩</a></li>
<li id="fn9">Banks 2010, Sec. 7.3.2<a href="#fnref9">↩</a></li>
<li id="fn10">L'Ecuyer 1988<a href="#fnref10">↩</a></li>
<li id="fn11">Banks 2010, Sec. 7.3.2<a href="#fnref11">↩</a></li>
<li id="fn12">Banks 2010, Sec. 7.3.2<a href="#fnref12">↩</a></li>
<li id="fn13">L'Ecuyer 1996<a href="#fnref13">↩</a></li>
<li id="fn14">L'Ecuyer 1999<a href="#fnref14">↩</a></li>
<li id="fn15">L'Ecuyer 2002<a href="#fnref15">↩</a></li>
</ol>
</section>
</body>
</html>

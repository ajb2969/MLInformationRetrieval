   System size expansion      System size expansion   The system size expansion , also known as van Kampen's expansion or the Î©-expansion , is a technique pioneered by Nico van Kampen 1 used in the analysis of stochastic processes . Specifically, it allows one to find an approximation to the solution of a master equation with nonlinear transition rates. The leading order term of the expansion is given by the linear noise approximation , in which the master equation is approximated by a Fokkerâ€“Planck equation with linear coefficients determined by the transition rates and stoichiometry of the system.  Less formally, it is normally straightforward to write down a mathematical description of a system where processes happen randomly (for example, radioactive atoms randomly decay in a physical system, or genes that are expressed stochastically in a cell). However, these mathematical descriptions are often too difficult to solve for the study of the systems statistics (for example, the mean and variance of the number of atoms or proteins as a function of time). The system size expansion allows one to obtain an approximate statistical description that can be solved much more easily than the master equation.  Preliminaries  Systems that admit a treatment with the system size expansion may be described by a probability distribution     P   (  X  ,  t  )       P   X  t     P(X,t)   , giving the probability of observing the system in state   X   X   X   at time   t   t   t   .   X   X   X   may be, for example, a vector with elements corresponding to the number of molecules of different chemical species in a system. In a system of size   Î©   normal-Î©   \Omega   (intuitively interpreted as the volume), we will adopt the following nomenclature   ğ—   ğ—   \mathbf{X}   is a vector of macroscopic copy numbers,    ğ±  =   ğ—  /  Î©       ğ±    ğ—  normal-Î©     \mathbf{x}=\mathbf{X}/\Omega   is a vector of concentrations, and   Ï•   Ï•   \mathbf{\phi}   is a vector of deterministic concentrations, as they would appear according to the rate equation in an infinite system.   ğ±   ğ±   \mathbf{x}   and   ğ—   ğ—   \mathbf{X}   are thus quantities subject to stochastic effects.  A master equation describes the time evolution of this probability. 2 Henceforth, a system of chemical reactions 3 will be discussed to provide a concrete example, although the nomenclature of "species" and "reactions" is generalisable. A system involving   N   N   N   species and   R   R   R   reactions can be described with the master equation:         d  P   (  ğ—  ,  t  )     d  t    =   Î©    âˆ‘   j  =  1   R     (     âˆ   i  =  1   N    ğ”¼   -   S   i  j       -  1   )    f  j    (  ğ±  ,  Î©  )   P   (  ğ—  ,  t  )       .          d  P   ğ—  t      d  t      normal-Î©    superscript   subscript     j  1    R         superscript   subscript  product    i  1    N    superscript  ğ”¼     subscript  S    i  j       1    subscript  f  j    ğ±  normal-Î©   P   ğ—  t        \frac{dP(\mathbf{X},t)}{dt}=\Omega\sum_{j=1}^{R}\left(\prod_{i=1}^{N}\mathbb{E%
 }^{-S_{ij}}-1\right)f_{j}(\mathbf{x},\Omega)P(\mathbf{X},t).     Here,   Î©   normal-Î©   \Omega   is the system size,   ğ”¼   ğ”¼   \mathbb{E}   is an operator which will be addressed later,    S   i  j      subscript  S    i  j     S_{ij}   is the stoichiometric matrix for the system (in which element    S   i  j      subscript  S    i  j     S_{ij}   gives the stoichiometric coefficient for species   i   i   i   in reaction   j   j   j   ), and    f  j     subscript  f  j    f_{j}   is the rate of reaction   j   j   j   given a state   ğ±   ğ±   \mathbf{x}   and system size   Î©   normal-Î©   \Omega   .      ğ”¼   -   S   i  j        superscript  ğ”¼     subscript  S    i  j       \mathbb{E}^{-S_{ij}}   is a step operator, 4 removing    S   i  j      subscript  S    i  j     S_{ij}   from the   i   i   i   th element of its argument. For example,      ğ”¼   -   S  23     f   (   x  1   ,   x  2   ,   x  3   )    =   f   (   x  1   ,    x  2   -   S  23    ,   x  3   )           superscript  ğ”¼     subscript  S  23     f    subscript  x  1    subscript  x  2    subscript  x  3       f    subscript  x  1      subscript  x  2    subscript  S  23     subscript  x  3       \mathbb{E}^{-S_{23}}f(x_{1},x_{2},x_{3})=f(x_{1},x_{2}-S_{23},x_{3})   . This formalism will be useful later.  The above equation can be interpreted as follows. The initial sum on the RHS is over all reactions. For each reaction   j   j   j   , the brackets immediately following the sum give two terms. The term with the simple coefficient âˆ’1 gives the probability flux away from a given state   ğ—   ğ—   \mathbf{X}   due to reaction   j   j   j   changing the state. The term preceded by the product of step operators gives the probability flux due to reaction   j   j   j   changing a different state    ğ—  â€²     superscript  ğ—  normal-â€²    \mathbf{X^{\prime}}   into state   ğ—   ğ—   \mathbf{X}   . The product of step operators constructs this state    ğ—  â€²     superscript  ğ—  normal-â€²    \mathbf{X^{\prime}}   .  Example  For example, consider the (linear) chemical system involving two chemical species    X  1     subscript  X  1    X_{1}   and    X  2     subscript  X  2    X_{2}   and the reaction     X  1   â†’   X  2      normal-â†’   subscript  X  1    subscript  X  2     X_{1}\rightarrow X_{2}   . In this system,    N  =  2      N  2    N=2   (species),    R  =  1      R  1    R=1   (reactions). A state of the system is a vector    ğ—  =   {   n  1   ,   n  2   }       ğ—    subscript  n  1    subscript  n  2      \mathbf{X}=\{n_{1},n_{2}\}   , where     n  1   ,   n  2       subscript  n  1    subscript  n  2     n_{1},n_{2}   are the number of molecules of    X  1     subscript  X  1    X_{1}   and    X  2     subscript  X  2    X_{2}   respectively. Let      f  1    (  ğ±  ,  Î©  )    =    n  1   Î©   =   x  1            subscript  f  1    ğ±  normal-Î©       subscript  n  1   normal-Î©         subscript  x  1      f_{1}(\mathbf{x},\Omega)=\frac{n_{1}}{\Omega}=x_{1}   , so that the rate of reaction 1 (the only reaction) depends on the concentration of    X  1     subscript  X  1    X_{1}   . The stoichiometry matrix is     (   -  1   ,  1  )   T     superscript     1   1   T    (-1,1)^{T}   .  Then the master equation reads:        d  P   (  ğ—  ,  t  )     d  t          d  P   ğ—  t      d  t     \displaystyle\frac{dP(\mathbf{X},t)}{dt}     where     ğš«  ğ—   =   {  1  ,   -  1   }         ğš«  ğ—    1    1      \mathbf{\Delta X}=\{1,-1\}   is the shift caused by the action of the product of step operators, required to change state   ğ—   ğ—   \mathbf{X}   to a precursor state    ğ—  â€²     superscript  ğ—  normal-â€²    \mathbf{X}^{\prime}   .  Linear noise approximation  If the master equation possesses nonlinear transition rates, it may be impossible to solve it analytically. The system size expansion utilises the ansatz that the variance of the steady-state probability distribution of constituent numbers in a population scales like the system size. This ansatz is used to expand the master equation in terms of a small parameter given by the inverse system size.  Specifically, let us write the    X  i     subscript  X  i    X_{i}   , the copy number of component   i   i   i   , as a sum of its "deterministic" value (a scaled-up concentration) and a random variable    Î¾   Î¾   \xi   , scaled by    Î©   1  /  2      superscript  normal-Î©    1  2     \Omega^{1/2}   :        X  i   =    Î©   Ï•  i    +    Î©   1  /  2     Î¾  i      .       subscript  X  i       normal-Î©   subscript  Ï•  i       superscript  normal-Î©    1  2     subscript  Î¾  i       X_{i}=\Omega\phi_{i}+\Omega^{1/2}\xi_{i}.     The probability distribution of   ğ—   ğ—   \mathbf{X}   can then be rewritten in the vector of random variables   Î¾   Î¾   \xi   :        P   (  ğ—  ,  t  )    =   P   (    Î©  Ï•   +    Î©   1  /  2    Î¾    )    =   Î    (  Î¾  ,  t  )     .          P   ğ—  t      P      normal-Î©  Ï•      superscript  normal-Î©    1  2    Î¾            normal-Î    Î¾  t       P(\mathbf{X},t)=P(\Omega\mathbf{\phi}+\Omega^{1/2}\mathbf{\xi})=\Pi(\mathbf{%
 \xi},t).     Let us consider how to write reaction rates   f   f   f   and the step operator   ğ”¼   ğ”¼   \mathbb{E}   in terms of this new random variable. Taylor expansion of the transition rates gives:         f  j    (  ğ±  )    =    f  j    (   Ï•  +    Î©   -   1  /  2     Î¾    )    =     f  j    (  Ï•  )    +    Î©   -   1  /  2       âˆ‘   i  =  1   N       âˆ‚   f  j  â€²     (  Ï•  )     âˆ‚   Ï•  i      Î¾  i      +   O   (   Î©   -  1    )      .           subscript  f  j   ğ±      subscript  f  j     Ï•     superscript  normal-Î©      1  2     Î¾               subscript  f  j   Ï•      superscript  normal-Î©      1  2       superscript   subscript     i  1    N            subscript   superscript  f  normal-â€²   j    Ï•      subscript  Ï•  i      subscript  Î¾  i        O   superscript  normal-Î©    1         f_{j}(\mathbf{x})=f_{j}(\mathbf{\phi}+\Omega^{-1/2}\mathbf{\xi})=f_{j}(\mathbf%
 {\phi})+\Omega^{-1/2}\sum_{i=1}^{N}\frac{\partial f^{\prime}_{j}(\mathbf{\phi}%
 )}{\partial\phi_{i}}\xi_{i}+O(\Omega^{-1}).     The step operator has the effect     ğ”¼  f   (  n  )    â†’   f   (   n  +  1   )       normal-â†’    ğ”¼  f  n     f    n  1      \mathbb{E}f(n)\rightarrow f(n+1)   and hence     ğ”¼  f   (  Î¾  )    â†’   f   (   Î¾  +   Î©   -   1  /  2      )       normal-â†’    ğ”¼  f  Î¾     f    Î¾   superscript  normal-Î©      1  2         \mathbb{E}f(\xi)\rightarrow f(\xi+\Omega^{-1/2})   :         âˆ   i  =  1   N    ğ”¼   -   S   i  j       â‰ƒ    1  -    Î©   -   1  /  2       âˆ‘  i     S   i  j     âˆ‚   âˆ‚   Î¾  i         +     Î©   -  1    2     âˆ‘  i     âˆ‘  k     S   i  j     S   k  j      âˆ‚  2     âˆ‚    Î¾  i      âˆ‚   Î¾  k          +   O   (   Î©   -   3  /  2     )      .     similar-to-or-equals    superscript   subscript  product    i  1    N    superscript  ğ”¼     subscript  S    i  j           1     superscript  normal-Î©      1  2       subscript   i      subscript  S    i  j          subscript  Î¾  i              superscript  normal-Î©    1    2     subscript   i     subscript   k      subscript  S    i  j     subscript  S    k  j       superscript   2        subscript  Î¾  i       subscript  Î¾  k            O   superscript  normal-Î©      3  2         \prod_{i=1}^{N}\mathbb{E}^{-S_{ij}}\simeq 1-\Omega^{-1/2}\sum_{i}S_{ij}\frac{%
 \partial}{\partial\xi_{i}}+\frac{\Omega^{-1}}{2}\sum_{i}\sum_{k}S_{ij}S_{kj}%
 \frac{\partial^{2}}{\partial\xi_{i}\,\partial\xi_{k}}+O(\Omega^{-3/2}).     We are now in a position to recast the master equation.           âˆ‚  Î     (  Î¾  ,  t  )     âˆ‚  t      -    Î©   1  /  2       âˆ‘   i  =  1   N        âˆ‚   Ï•  i     âˆ‚  t         âˆ‚  Î     (  Î¾  ,  t  )     âˆ‚   Î¾  i                   normal-Î     Î¾  t      t       superscript  normal-Î©    1  2      superscript   subscript     i  1    N          subscript  Ï•  i      t          normal-Î     Î¾  t       subscript  Î¾  i          \displaystyle{}\quad\frac{\partial\Pi(\mathbf{\xi},t)}{\partial t}-\Omega^{1/2%
 }\sum_{i=1}^{N}\frac{\partial\phi_{i}}{\partial t}\frac{\partial\Pi(\mathbf{%
 \xi},t)}{\partial\xi_{i}}     This rather frightening expression makes a bit more sense when we gather terms in different powers of   Î©   normal-Î©   \Omega   . First, terms of order    Î©   1  /  2      superscript  normal-Î©    1  2     \Omega^{1/2}   give         âˆ‘   i  =  1   N      âˆ‚   Ï•  i     âˆ‚  t       âˆ‚  Î     (  Î¾  ,  t  )     âˆ‚   Î¾  i       =    âˆ‘   i  =  1   N     âˆ‘   j  =  1   R     S   i  j     f  j  â€²    (  Ï•  )      âˆ‚  Î     (  Î¾  ,  t  )     âˆ‚   Î¾  j         .        superscript   subscript     i  1    N          subscript  Ï•  i      t          normal-Î     Î¾  t       subscript  Î¾  i         superscript   subscript     i  1    N     superscript   subscript     j  1    R      subscript  S    i  j     subscript   superscript  f  normal-â€²   j   Ï•        normal-Î     Î¾  t       subscript  Î¾  j          \sum_{i=1}^{N}\frac{\partial\phi_{i}}{\partial t}\frac{\partial\Pi(\mathbf{\xi%
 },t)}{\partial\xi_{i}}=\sum_{i=1}^{N}\sum_{j=1}^{R}S_{ij}f^{\prime}_{j}(%
 \mathbf{\phi})\frac{\partial\Pi(\mathbf{\xi},t)}{\partial\xi_{j}}.     These terms cancel, due to the macroscopic reaction equation         âˆ‚   Ï•  i     âˆ‚  t    =    âˆ‘   j  =  1   R     S   i  j     f  j  â€²    (  Ï•  )      .           subscript  Ï•  i      t      superscript   subscript     j  1    R      subscript  S    i  j     subscript   superscript  f  normal-â€²   j   Ï•      \frac{\partial\phi_{i}}{\partial t}=\sum_{j=1}^{R}S_{ij}f^{\prime}_{j}(\mathbf%
 {\phi}).     The terms of order    Î©  0     superscript  normal-Î©  0    \Omega^{0}   are more interesting:          âˆ‚  Î     (  Î¾  ,  t  )     âˆ‚  t    =    âˆ‘  j    (     âˆ‘   i  k    -    S   i  j      âˆ‚   f  j  â€²     âˆ‚   Ï•  k       âˆ‚   (    Î¾  k   Î    (  Î¾  ,  t  )    )     âˆ‚   Î¾  i       +    1  2    f  j  â€²     âˆ‘   i  k      S   i  j     S   k  j        âˆ‚  2   Î     (  Î¾  ,  t  )      âˆ‚    Î¾  i      âˆ‚   Î¾  k          )     ,            normal-Î     Î¾  t      t      subscript   j        subscript     i  k       subscript  S    i  j         subscript   superscript  f  normal-â€²   j       subscript  Ï•  k            subscript  Î¾  k   normal-Î    Î¾  t        subscript  Î¾  i           1  2    subscript   superscript  f  normal-â€²   j     subscript     i  k       subscript  S    i  j     subscript  S    k  j          superscript   2   normal-Î     Î¾  t         subscript  Î¾  i       subscript  Î¾  k             \frac{\partial\Pi(\mathbf{\xi},t)}{\partial t}=\sum_{j}\left(\sum_{ik}-S_{ij}%
 \frac{\partial f^{\prime}_{j}}{\partial\phi_{k}}\frac{\partial(\xi_{k}\Pi(%
 \mathbf{\xi},t))}{\partial\xi_{i}}+\frac{1}{2}f^{\prime}_{j}\sum_{ik}S_{ij}S_{%
 kj}\frac{\partial^{2}\Pi(\mathbf{\xi},t)}{\partial\xi_{i}\,\partial\xi_{k}}%
 \right),     which can be written as          âˆ‚  Î     (  Î¾  ,  t  )     âˆ‚  t    =     âˆ‘   i  k      A   i  k      âˆ‚   (    Î¾  k   Î    )     âˆ‚   Î¾  i       +    1  2     âˆ‘   i  k       [   ğğ  T   ]    i  k       âˆ‚  2   Î      âˆ‚    Î¾  i      âˆ‚   Î¾  k           ,            normal-Î     Î¾  t      t        subscript     i  k       subscript  A    i  k           subscript  Î¾  k   normal-Î        subscript  Î¾  i           1  2     subscript     i  k       subscript   delimited-[]   superscript  ğğ  T      i  k        superscript   2   normal-Î         subscript  Î¾  i       subscript  Î¾  k            \frac{\partial\Pi(\mathbf{\xi},t)}{\partial t}=\sum_{ik}A_{ik}\frac{\partial(%
 \xi_{k}\Pi)}{\partial\xi_{i}}+\frac{1}{2}\sum_{ik}[\mathbf{BB}^{T}]_{ik}\frac{%
 \partial^{2}\Pi}{\partial\xi_{i}\,\partial\xi_{k}},     where        A   i  k    =    âˆ‘   j  =  1   R     S   i  j      âˆ‚   f  j  â€²     âˆ‚   Ï•  k       =    âˆ‚   (    ğ’  i   â‹…  ğŸ   )     âˆ‚   Ï•  k      ,         subscript  A    i  k      superscript   subscript     j  1    R      subscript  S    i  j         subscript   superscript  f  normal-â€²   j       subscript  Ï•  k                 normal-â‹…   subscript  ğ’  i   ğŸ       subscript  Ï•  k        A_{ik}=\sum_{j=1}^{R}S_{ij}\frac{\partial f^{\prime}_{j}}{\partial\phi_{k}}=%
 \frac{\partial(\mathbf{S}_{i}\cdot\mathbf{f})}{\partial\phi_{k}},     and         [   ğğ  T   ]    i  k    =    âˆ‘   j  =  1   R     S   i  j     S   k  j     f  j  â€²    (  Ï•  )     =    [    ğ’   diag   (   f   (  Ï•  )    )    ğ’  T    ]    i  k     .         subscript   delimited-[]   superscript  ğğ  T      i  k      superscript   subscript     j  1    R      subscript  S    i  j     subscript  S    k  j     subscript   superscript  f  normal-â€²   j   Ï•          subscript   delimited-[]    ğ’  diag    f  Ï•    superscript  ğ’  T       i  k       [\mathbf{BB}^{T}]_{ik}=\sum_{j=1}^{R}S_{ij}S_{kj}f^{\prime}_{j}(\mathbf{\phi})%
 =[\mathbf{S}\,\mbox{diag}(f(\mathbf{\phi}))\,\mathbf{S}^{T}]_{ik}.     The time evolution of   Î    normal-Î    \Pi   is then governed by the linear Fokkerâ€“Planck equation with coefficient matrices   ğ€   ğ€   \mathbf{A}   and    ğğ  T     superscript  ğğ  T    \mathbf{BB}^{T}   (in the large-   Î©   normal-Î©   \Omega   limit, terms of    O   (   Î©   -   1  /  2     )       O   superscript  normal-Î©      1  2       O(\Omega^{-1/2})   may be neglected, termed the linear noise approximation ). With knowledge of the reaction rates   ğŸ   ğŸ   \mathbf{f}   and stoichiometry   S   S   S   , the moments of   Î    normal-Î    \Pi   can then be calculated.  Software  The linear noise approximation has become a popular technique for estimating the size of intrinsic noise in terms of coefficients of variation and Fano factors for molecular species in intracellular pathways. The second moment obtained from the linear noise approximation (on which the noise measures are based) are exact only if the pathway is composed of first-order reactions. However bimolecular reactions such as enzyme-substrate , protein-protein and protein-DNA interactions are ubiquitous elements of all known pathways; for such cases, the linear noise approximation can give estimates which are accurate in the limit of large reaction volumes. Since this limit is taken at constant concentrations, it follows that the linear noise approximation gives accurate results in the limit of large molecule numbers and becomes less reliable for pathways characterized by many species with low copy numbers of molecules.  A number of studies have elucidated cases of the insufficiency of the linear noise approximation in biological contexts by comparison of its predictions with those of stochastic simulations. 5 6 This has led to the investigation of higher order terms of the system size expansion that go beyond the linear approximation. These terms have been used to obtain more accurate moment estimates for the mean concentrations and for the variances of the concentration fluctuations in intracellular pathways. In particular, the leading order corrections to the linear noise approximation yield corrections of the conventional rate equations . 7 Terms of higher order have also been used to obtain corrections to the variances and covariances estimates of the linear noise approximation. 8 9 The linear noise approximation and corrections to it can be computed using the open source software intrinsic Noise Analyzer . The corrections have been shown to be particularly considerable for allosteric and non-allosteric enzyme-mediated reactions in intracellular compartments .  References  "  Category:Articles created via the Article Wizard  Category:Stochastic processes  Category:Applied mathematics  Category:Chemical kinetics  Category:Stoichiometry  Category:Concepts in physics     van Kampen, N. G. (2007) "Stochastic Processes in Physics and Chemistry", North-Holland Personal Library â†©   Elf, J. and Ehrenberg, M. (2003) "Fast Evaluation of Fluctuations in Biochemical Networks With the Linear Noise Approximation", Genome Research , 13:2475â€“2484. â†©   Hayot, F. and Jayaprakash, C. (2004), "The linear noise approximation for molecular fluctuations within cells", Physical Biology , 1:205 â†©  Ferm, L. LÃ¶tstedt, P. and Hellander, A. (2008), "A Hierarchy of Approximations of the Master Equation Scaled by a Size Parameter", Journal of Scientific Computing , 34:127 â†©  Grima, R. (2010) "An effective rate equation approach to reaction kinetics in small volumes: Theory and application to biochemical reactions in nonequilibrium steady-state conditions", The Journal of Chemical Physics , 132:035101 â†©  Grima, R. and Thomas, P. and Straube, A.V. (2011), "How accurate are the nonlinear chemical Fokker-Planck and chemical Langevin equations?", The Journal of Chemical Physics , 135:084103 â†©  Grima, R. (2012), "A study of the accuracy of moment-closure approximations for stochastic chemical kinetics", The Journal of Chemical Physics , 136: 154105 â†©     
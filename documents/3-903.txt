   Matrix normal distribution      Matrix normal distribution   | cdf = | mean =   ğŒ   ğŒ   \mathbf{M}   | median = | mode = | variance =   ğ”   ğ”   \mathbf{U}   (among-row) and   ğ•   ğ•   \mathbf{V}   (among-column) | skewness = | kurtosis = | entropy = | mgf = | char = }}  In statistics , the matrix normal distribution is a probability distribution that is a generalization of the multivariate normal distribution to matrix-valued random variables.  Definition  The probability density function for the random matrix X ( n Ã— p ) that follows the matrix normal distribution    â„³   ğ’©   n  ,  p     (  ğŒ  ,  ğ”  ,  ğ•  )       â„³   subscript  ğ’©   n  p     ğŒ  ğ”  ğ•     \mathcal{MN}_{n,p}(\mathbf{M},\mathbf{U},\mathbf{V})   has the form:      p   (  ğ—  âˆ£  ğŒ  ,  ğ”  ,  ğ•  )   =    exp   (   -     1  2    tr   [    ğ•   -  1      (   ğ—  -  ğŒ   )   T    ğ”   -  1     (   ğ—  -  ğŒ   )    ]     )       (   2  Ï€   )     n  p   /  2      |  ğ•  |    n  /  2      |  ğ”  |    p  /  2         fragments  p   fragments  normal-(  X  normal-âˆ£  M  normal-,  U  normal-,  V  normal-)              1  2   tr   delimited-[]     superscript  ğ•    1     superscript    ğ—  ğŒ   T    superscript  ğ”    1      ğ—  ğŒ           superscript    2  Ï€       n  p   2     superscript    ğ•     n  2     superscript    ğ”     p  2        p(\mathbf{X}\mid\mathbf{M},\mathbf{U},\mathbf{V})=\frac{\exp\left(-\frac{1}{2}%
 \,\mathrm{tr}\left[\mathbf{V}^{-1}(\mathbf{X}-\mathbf{M})^{T}\mathbf{U}^{-1}(%
 \mathbf{X}-\mathbf{M})\right]\right)}{(2\pi)^{np/2}|\mathbf{V}|^{n/2}|\mathbf{%
 U}|^{p/2}}     where   tr   tr   \mathrm{tr}   denotes trace and M is n Ã— p , U is n Ã— n and V is p Ã— p .  The matrix normal is related to the multivariate normal distribution in the following way:       ğ—  âˆ¼   â„³   ğ’©   n  Ã—  p     (  ğŒ  ,  ğ”  ,  ğ•  )     ,     similar-to  ğ—    â„³   subscript  ğ’©    n  p     ğŒ  ğ”  ğ•      \mathbf{X}\sim\mathcal{MN}_{n\times p}(\mathbf{M},\mathbf{U},\mathbf{V}),     if and only if       vec   (  ğ—  )    âˆ¼    ğ’©   n  p     (   vec   (  ğŒ  )    ,   ğ•  âŠ—  ğ”   )       similar-to    vec  ğ—      subscript  ğ’©    n  p       vec  ğŒ    tensor-product  ğ•  ğ”       \mathrm{vec}(\mathbf{X})\sim\mathcal{N}_{np}(\mathrm{vec}(\mathbf{M}),\mathbf{%
 V}\otimes\mathbf{U})     where   âŠ—   tensor-product   \otimes   denotes the Kronecker product and    vec   (  ğŒ  )       vec  ğŒ    \mathrm{vec}(\mathbf{M})   denotes the vectorization of   ğŒ   ğŒ   \mathbf{M}   .  Proof  The equivalence between the above matrix normal and multivariate normal density functions can be shown using several properties of the trace and Kronecker product , as follows. We start with the argument of the exponent of the matrix normal PDF:      -     1  2    tr   [    ğ•   -  1      (   ğ—  -  ğŒ   )   T    ğ”   -  1     (   ğ—  -  ğŒ   )    ]            1  2   tr   delimited-[]     superscript  ğ•    1     superscript    ğ—  ğŒ   T    superscript  ğ”    1      ğ—  ğŒ        \displaystyle\;\;\;\;-\frac{1}{2}\text{tr}\left[\mathbf{V}^{-1}(\mathbf{X}-%
 \mathbf{M})^{T}\mathbf{U}^{-1}(\mathbf{X}-\mathbf{M})\right]   which is the argument of the exponent of the multivariate normal PDF. The proof is completed by using the determinant property      |   ğ•  âŠ—  ğ”   |   =     |  ğ•  |   n     |  ğ”  |   p     .         tensor-product  ğ•  ğ”       superscript    ğ•   n    superscript    ğ”   p      |\mathbf{V}\otimes\mathbf{U}|=|\mathbf{V}|^{n}|\mathbf{U}|^{p}.     Properties  If    ğ—  âˆ¼   â„³   ğ’©   n  Ã—  p     (  ğŒ  ,  ğ”  ,  ğ•  )       similar-to  ğ—    â„³   subscript  ğ’©    n  p     ğŒ  ğ”  ğ•      \mathbf{X}\sim\mathcal{MN}_{n\times p}(\mathbf{M},\mathbf{U},\mathbf{V})   , then we have the following properties: 1 2  Expected values  The mean, or expected value is:       E   [  ğ—  ]    =  ğŒ        E   delimited-[]  ğ—    ğŒ    E[\mathbf{X}]=\mathbf{M}   and we have the following second-order expectations:       E   [    (   ğ—  -  ğŒ   )     (   ğ—  -  ğŒ   )   T    ]    =   ğ”   tr   (  ğ•  )           E   delimited-[]      ğ—  ğŒ    superscript    ğ—  ğŒ   T        ğ”   tr  ğ•      E[(\mathbf{X}-\mathbf{M})(\mathbf{X}-\mathbf{M})^{T}]=\mathbf{U}\operatorname{%
 tr}(\mathbf{V})          E   [     (   ğ—  -  ğŒ   )   T    (   ğ—  -  ğŒ   )    ]    =   ğ•   tr   (  ğ”  )           E   delimited-[]     superscript    ğ—  ğŒ   T     ğ—  ğŒ        ğ•   tr  ğ”      E[(\mathbf{X}-\mathbf{M})^{T}(\mathbf{X}-\mathbf{M})]=\mathbf{V}\operatorname{%
 tr}(\mathbf{U})   where   tr   tr   \operatorname{tr}   denotes trace .  More generally, for appropriately dimensioned matrices A , B , C :      E   [   ğ—ğ€ğ—  T   ]       E   delimited-[]   superscript  ğ—ğ€ğ—  T      \displaystyle E[\mathbf{X}\mathbf{A}\mathbf{X}^{T}]     Transformation  Transpose transform:       ğ—  T   âˆ¼   â„³   ğ’©   p  Ã—  n     (   ğŒ  T   ,  ğ•  ,  ğ”  )       similar-to   superscript  ğ—  T     â„³   subscript  ğ’©    p  n      superscript  ğŒ  T   ğ•  ğ”      \mathbf{X}^{T}\sim\mathcal{MN}_{p\times n}(\mathbf{M}^{T},\mathbf{V},\mathbf{U})     Linear transform: let D ( r -by- n ), be of full rank  r â‰¤ n and C ( p -by- s ), be of full rank s â‰¤ p , then:      ğƒğ—ğ‚  âˆ¼   â„³   ğ’©   n  Ã—  p     (  ğƒğŒğ‚  ,   ğƒğ”ğƒ  T   ,    ğ‚  T   ğ•ğ‚   )       similar-to  ğƒğ—ğ‚    â„³   subscript  ğ’©    n  p     ğƒğŒğ‚   superscript  ğƒğ”ğƒ  T      superscript  ğ‚  T   ğ•ğ‚       \mathbf{DXC}\sim\mathcal{MN}_{n\times p}(\mathbf{DMC},\mathbf{DUD}^{T},\mathbf%
 {C}^{T}\mathbf{VC})     Example  Let's imagine a sample of n independent p -dimensional random variables identically distributed according to a multivariate normal distribution :       ğ˜  i   âˆ¼    ğ’©  p    (  ğ  ,  ğšº  )   with  i   âˆˆ   {  1  ,  â€¦  ,  n  }        similar-to   subscript  ğ˜  i      subscript  ğ’©  p    ğ  ğšº   with  i         1  normal-â€¦  n      \mathbf{Y}_{i}\sim\mathcal{N}_{p}({\boldsymbol{\mu}},{\boldsymbol{\Sigma}})%
 \text{ with }i\in\{1,\ldots,n\}   . When defining the n Ã— p matrix   ğ—   ğ—   \mathbf{X}   for which the i th row is    ğ˜  i     subscript  ğ˜  i    \mathbf{Y}_{i}   , we obtain:      ğ—  âˆ¼   â„³   ğ’©   n  Ã—  p     (  ğŒ  ,  ğ”  ,  ğ•  )       similar-to  ğ—    â„³   subscript  ğ’©    n  p     ğŒ  ğ”  ğ•      \mathbf{X}\sim\mathcal{MN}_{n\times p}(\mathbf{M},\mathbf{U},\mathbf{V})   where each row of   ğŒ   ğŒ   \mathbf{M}   is equal to   ğ   ğ   {\boldsymbol{\mu}}   , that is    ğŒ  =    ğŸ  n   Ã—   ğ  T        ğŒ     subscript  1  n    superscript  ğ  T      \mathbf{M}=\mathbf{1}_{n}\times{\boldsymbol{\mu}}^{T}   ,   ğ”   ğ”   \mathbf{U}   is the n Ã— n identity matrix, that is the rows are independent, and    ğ•  =  ğšº      ğ•  ğšº    \mathbf{V}={\boldsymbol{\Sigma}}   .  Maximum Likelihood Parameter Estimation  Given k matrices, each of size n Ã— p , denoted     ğ—  1   ,   ğ—  2   ,  â€¦  ,   ğ—  k       subscript  ğ—  1    subscript  ğ—  2   normal-â€¦   subscript  ğ—  k     \mathbf{X}_{1},\mathbf{X}_{2},\ldots,\mathbf{X}_{k}   , which we assume have been sampled i.i.d. from a matrix normal distribution, the maximum likelihood estimate of the parameters can be obtained by maximizing:       âˆ   i  =  1   k   â„³   ğ’©   n  Ã—  p     (   ğ—  i   âˆ£  ğŒ  ,  ğ”  ,  ğ•  )   .     fragments   superscript   subscript  product    i  1    k   M   subscript  ğ’©    n  p     fragments  normal-(   subscript  ğ—  i   normal-âˆ£  M  normal-,  U  normal-,  V  normal-)   normal-.    \prod_{i=1}^{k}\mathcal{MN}_{n\times p}(\mathbf{X}_{i}\mid\mathbf{M},\mathbf{U%
 },\mathbf{V}).   The solution for the mean has a closed form, namely      ğŒ  =    1  k     âˆ‘   i  =  1   k    ğ—  i         ğŒ      1  k     superscript   subscript     i  1    k    subscript  ğ—  i       \mathbf{M}=\frac{1}{k}\sum_{i=1}^{k}\mathbf{X}_{i}   but the covariance parameters do not. However, these parameters can be iteratively maximized by zero-ing their gradients at:      ğ”  =    1   k  p      âˆ‘   i  =  1   k     (    ğ—  i   -  ğŒ   )    ğ•   -  1      (    ğ—  i   -  ğŒ   )   T          ğ”      1    k  p      superscript   subscript     i  1    k        subscript  ğ—  i   ğŒ    superscript  ğ•    1     superscript     subscript  ğ—  i   ğŒ   T        \mathbf{U}=\frac{1}{kp}\sum_{i=1}^{k}(\mathbf{X}_{i}-\mathbf{M})\mathbf{V}^{-1%
 }(\mathbf{X}_{i}-\mathbf{M})^{T}   and       ğ•  =    1   k  n      âˆ‘   i  =  1   k      (    ğ—  i   -  ğŒ   )   T    ğ”   -  1     (    ğ—  i   -  ğŒ   )       ,      ğ•      1    k  n      superscript   subscript     i  1    k      superscript     subscript  ğ—  i   ğŒ   T    superscript  ğ”    1       subscript  ğ—  i   ğŒ        \mathbf{V}=\frac{1}{kn}\sum_{i=1}^{k}(\mathbf{X}_{i}-\mathbf{M})^{T}\mathbf{U}%
 ^{-1}(\mathbf{X}_{i}-\mathbf{M}),   See for example 3 and references therein. It should be noted that the covariance parameters are non-identifiable in the sense that for any scale factor, s>0 , we have:      â„³   ğ’©   n  Ã—  p     (  ğ—  âˆ£  ğŒ  ,  ğ”  ,  ğ•  )   =  â„³   ğ’©   n  Ã—  p     (  ğ—  âˆ£  ğŒ  ,  s  ğ”  ,  1  /  s  ğ•  )   .     fragments  M   subscript  ğ’©    n  p     fragments  normal-(  X  normal-âˆ£  M  normal-,  U  normal-,  V  normal-)    M   subscript  ğ’©    n  p     fragments  normal-(  X  normal-âˆ£  M  normal-,  s  U  normal-,  1   s  V  normal-)   normal-.    \mathcal{MN}_{n\times p}(\mathbf{X}\mid\mathbf{M},\mathbf{U},\mathbf{V})=%
 \mathcal{MN}_{n\times p}(\mathbf{X}\mid\mathbf{M},s\mathbf{U},1/s\mathbf{V}).     Drawing values from the distribution  Sampling from the matrix normal distribution is a special case of the sampling procedure for the multivariate normal distribution . Let   ğ—   ğ—   \mathbf{X}   be an n by p matrix of np independent samples from the standard normal distribution, so that       ğ—  âˆ¼   â„³   ğ’©   n  Ã—  p     (  ğŸ  ,  ğˆ  ,  ğˆ  )     .     similar-to  ğ—    â„³   subscript  ğ’©    n  p     0  ğˆ  ğˆ      \mathbf{X}\sim\mathcal{MN}_{n\times p}(\mathbf{0},\mathbf{I},\mathbf{I}).   Then let       ğ˜  =   ğŒ  +  ğ€ğ—ğ    ,      ğ˜    ğŒ  ğ€ğ—ğ     \mathbf{Y}=\mathbf{M}+\mathbf{A}\mathbf{X}\mathbf{B},   so that       ğ˜  âˆ¼   â„³   ğ’©   n  Ã—  p     (  ğŒ  ,   ğ€ğ€  T   ,    ğ  T   ğ   )     ,     similar-to  ğ˜    â„³   subscript  ğ’©    n  p     ğŒ   superscript  ğ€ğ€  T      superscript  ğ  T   ğ       \mathbf{Y}\sim\mathcal{MN}_{n\times p}(\mathbf{M},\mathbf{AA}^{T},\mathbf{B}^{%
 T}\mathbf{B}),   where A and B can be chosen by Cholesky decomposition or a similar matrix square root operation.  Relation to other distributions  Dawid (1981) provides a discussion of the relation of the matrix-valued normal distribution to other distributions, including the Wishart distribution , Inverse Wishart distribution and matrix t-distribution , but uses different notation from that employed here.  See also   Multivariate normal distribution .   References       "  Category:Random matrices  Category:Continuous distributions  Category:Multivariate continuous distributions  Category:Probability distributions     â†©  â†©  â†©     
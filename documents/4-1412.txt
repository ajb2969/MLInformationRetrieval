   Canonical basis      Canonical basis   In mathematics, a canonical basis is a basis of an algebraic structure that is canonical in a sense that depends on the precise context:   In a coordinate space, and more generally in a free module, it refers to the standard basis defined by the Kronecker delta .  In a polynomial ring, it refers to its standard basis given by the monomials ,     (   X  i   )   i     subscript   superscript  X  i   i    (X^{i})_{i}   .  For finite extension fields, it means the polynomial basis .  In linear algebra , it refers to a set of n linearly independent generalized eigenvectors of an n Ã— n matrix   A   A   A   , if the set is composed entirely of Jordan chains . 1   Representation theory  In representation theory there are several basis that are called "canonical", e.g. Lusztig's canonical basis and closely related Kashiwara's crystal basis in quantum groups and their representations. There is a general concept underlying these basis:  Consider the ring of integral Laurent polynomials     ğ’µ  :=   â„¤   [  v  ,   v   -  1    ]       assign  ğ’µ    â„¤   v   superscript  v    1        \mathcal{Z}:=\mathbb{Z}[v,v^{-1}]   with its two subrings     ğ’µ  Â±   :=   â„¤   [   v   Â±  1    ]       assign   superscript  ğ’µ  plus-or-minus     â„¤   delimited-[]   superscript  v   plus-or-minus  1        \mathcal{Z}^{\pm}:=\mathbb{Z}[v^{\pm 1}]   and the automorphism    â‹…  Â¯     normal-Â¯  normal-â‹…    \overline{\cdot}   that is defined by     v  Â¯   :=   v   -  1       assign   normal-Â¯  v    superscript  v    1      \overline{v}:=v^{-1}   .  A precanonical structure on a free   ğ’µ   ğ’µ   \mathcal{Z}   -module   F   F   F   consists of   A standard basis     (   t  i   )    i  âˆˆ  I      subscript   subscript  t  i     i  I     (t_{i})_{i\in I}   of   F   F   F   ,  A partial order on   I   I   I   that is interval finite, i.e.     (   -  âˆ   ,  i  ]   :=   {   j  âˆˆ  I   |   j  â‰¤  i   }      assign       i    conditional-set    j  I     j  i      (-\infty,i]:=\{j\in I|j\leq i\}   is finite for all    i  âˆˆ  I      i  I    i\in I   ,  A dualization operation, i.e. a bijection    F  â†’  F     normal-â†’  F  F    F\to F   of order two that is    â‹…  Â¯     normal-Â¯  normal-â‹…    \overline{\cdot}   - semilinear and will be denoted by    â‹…  Â¯     normal-Â¯  normal-â‹…    \overline{\cdot}   as well.   If a precanonical structure is given, then one can define the    ğ’µ  Â±     superscript  ğ’µ  plus-or-minus    \mathcal{Z}^{\pm}   submodule     F  Â±   :=   âˆ‘    ğ’µ  Â±    t  j        assign   superscript  F  plus-or-minus        superscript  ğ’µ  plus-or-minus    subscript  t  j       F^{\pm}:=\sum\mathcal{Z}^{\pm}t_{j}   of   F   F   F   .  A canonical basis at    v  =  0      v  0    v=0    of the precanonical structure is then a   ğ’µ   ğ’µ   \mathcal{Z}   -basis     (   c  i   )    i  âˆˆ  I      subscript   subscript  c  i     i  I     (c_{i})_{i\in I}   of   F   F   F   that satisfies:         c  i   Â¯   =   c  i        normal-Â¯   subscript  c  i     subscript  c  i     \overline{c_{i}}=c_{i}   and       c  i   âˆˆ    âˆ‘   j  â‰¤  i      ğ’µ  +    t  j          subscript  c  i     subscript     j  i       superscript  ğ’µ     subscript  t  j       c_{i}\in\sum_{j\leq i}\mathcal{Z}^{+}t_{j}   and     c  i   â‰¡    t  i   mod   v   F  +          subscript  c  i    modulo   subscript  t  i     v   superscript  F        c_{i}\equiv t_{i}\mod vF^{+}      for all    i  âˆˆ  I      i  I    i\in I   . A canonical basis at    v  =  âˆ      v     v=\infty    is analogously defined to be a basis     (    c  ~   i   )    i  âˆˆ  I      subscript   subscript   normal-~  c   i     i  I     (\widetilde{c}_{i})_{i\in I}   that satisfies          c  ~   i   Â¯   =    c  ~   i        normal-Â¯   subscript   normal-~  c   i     subscript   normal-~  c   i     \overline{\widetilde{c}_{i}}=\widetilde{c}_{i}   and        c  ~   i   âˆˆ    âˆ‘   j  â‰¤  i      ğ’µ  -    t  j          subscript   normal-~  c   i     subscript     j  i       superscript  ğ’µ     subscript  t  j       \widetilde{c}_{i}\in\sum_{j\leq i}\mathcal{Z}^{-}t_{j}   and      c  ~   i   â‰¡    t  i   mod    v   -  1     F  -          subscript   normal-~  c   i    modulo   subscript  t  i      superscript  v    1     superscript  F        \widetilde{c}_{i}\equiv t_{i}\mod v^{-1}F^{-}      for all    i  âˆˆ  I      i  I    i\in I   . The naming "at    v  =  âˆ      v     v=\infty   " alludes to the fact      lim   v  â†’  âˆ     v   -  1     =  0        subscript    normal-â†’  v      superscript  v    1     0    \lim_{v\to\infty}v^{-1}=0   and hence the "specialization"    v  â†¦  âˆ     maps-to  v     v\mapsto\infty   corresponds to quotienting out the relation     v   -  1    =  0       superscript  v    1    0    v^{-1}=0   .  One can show that there exists at most one canonical basis at v=0 (and at most one at    v  =  âˆ      v     v=\infty   ) for each precanonical structure. A sufficient condition for existence is that the polynomials     r   i  j    âˆˆ  ğ’µ       subscript  r    i  j    ğ’µ    r_{ij}\in\mathcal{Z}   defined by      t  j   Â¯   =    âˆ‘  i     r   i  j     t  i          normal-Â¯   subscript  t  j      subscript   i      subscript  r    i  j     subscript  t  i       \overline{t_{j}}=\sum_{i}r_{ij}t_{i}   satisfy     r   i  i    =  1       subscript  r    i  i    1    r_{ii}=1   and     r   i  j    â‰   0  âŸ¹  i  â‰¤  j         subscript  r    i  j    0       i       j     r_{ij}\neq 0\implies i\leq j   .  A canonical basis at v=0 (    v  =  âˆ      v     v=\infty   ) induces an isomorphism from      F  +   âˆ©    F  +   Â¯    =    âˆ‘  i    â„¤   c  i            superscript  F     normal-Â¯   superscript  F        subscript   i     â„¤   subscript  c  i       \textstyle F^{+}\cap\overline{F^{+}}=\sum_{i}\mathbb{Z}c_{i}   to      F  +   /  v    F  +          superscript  F    v    superscript  F      F^{+}/vF^{+}   (      F  -   âˆ©    F  -   Â¯    =    âˆ‘  i    â„¤    c  ~   i     â†’     F  -   /   v   -  1      F  -             superscript  F     normal-Â¯   superscript  F        subscript   i     â„¤   subscript   normal-~  c   i       normal-â†’         superscript  F     superscript  v    1      superscript  F        \textstyle F^{-}\cap\overline{F^{-}}=\sum_{i}\mathbb{Z}\widetilde{c}_{i}\to F^%
 {-}/v^{-1}F^{-}   respectively).  Examples  Quantum groups  The canonical basis of quantum groups in the sense of Lusztig and Kashiwara are canonical basis at    v  =  0      v  0    v=0   .  Hecke algebras  Let    (  W  ,  S  )     W  S    (W,S)   be a Coxeter group . The corresponding Iwahori-Hecke algebra    H   H   H   has the standard basis     (   T  w   )    w  âˆˆ  W      subscript   subscript  T  w     w  W     (T_{w})_{w\in W}   , the group is partially ordered by the Bruhat order which is interval finite and has a dualization operation defined by      T  w   Â¯   :=   T   w   -  1     -  1       assign   normal-Â¯   subscript  T  w     superscript   subscript  T   superscript  w    1       1      \overline{T_{w}}:=T_{w^{-1}}^{-1}   . This is a precanonical structure on   H   H   H   that satisfies the sufficient condition above and the corresponding canonical basis of   H   H   H   at    v  =  0      v  0    v=0   is the Kazhdan-Lusztig basis      C  w  â€²   =    âˆ‘   y  â‰¤  w      P   y  ,  w     (   v  2   )    T  w          superscript   subscript  C  w   normal-â€²     subscript     y  w       subscript  P   y  w     superscript  v  2    subscript  T  w       C_{w}^{\prime}=\sum_{y\leq w}P_{y,w}(v^{2})T_{w}   with    P   y  ,  w      subscript  P   y  w     P_{y,w}   being the Kazhdan-Lusztig polynomials .  Linear algebra  If we are given an n Ã— n  matrix    A   A   A   and wish to find a matrix   J   J   J   in Jordan normal form , similar to   A   A   A   , we are interested only in sets of linearly independent generalized eigenvectors. A matrix in Jordan normal form is an "almost diagonal matrix," that is, as close to diagonal as possible. A diagonal matrix    D   D   D   is a special case of a matrix in Jordan normal form. An ordinary eigenvector is a special case of a generalized eigenvector.  Every n Ã— n matrix   A   A   A   possesses n linearly independent generalized eigenvectors. Generalized eigenvectors corresponding to distinct eigenvalues are linearly independent. If   Î»   Î»   \lambda   is an eigenvalue of   A   A   A   of algebraic multiplicity    Î¼   Î¼   \mu   , then   A   A   A   will have   Î¼   Î¼   \mu   linearly independent generalized eigenvectors corresponding to   Î»   Î»   \lambda   .  For any given n Ã— n matrix   A   A   A   , there are infinitely many ways to pick the n linearly independent generalized eigenvectors. If they are chosen in a particularly judicious manner, we can use these vectors to show that   A   A   A   is similar to a matrix in Jordan normal form. In particular,  Definition: A set of n linearly independent generalized eigenvectors is a canonical basis if it is composed entirely of Jordan chains.  Thus, once we have determined that a generalized eigenvector of rank  m is in a canonical basis, it follows that the m âˆ’ 1 vectors     ğ•©   m  -  1    ,   ğ•©   m  -  2    ,  â€¦  ,   ğ•©  1       subscript  ğ•©    m  1     subscript  ğ•©    m  2    normal-â€¦   subscript  ğ•©  1     \mathbb{x}_{m-1},\mathbb{x}_{m-2},\ldots,\mathbb{x}_{1}   that are in the Jordan chain generated by    ğ•©  m     subscript  ğ•©  m    \mathbb{x}_{m}   are also in the canonical basis. 2  Computation  Let    Î»  i     subscript  Î»  i    \lambda_{i}   be an eigenvalue of   A   A   A   of algebraic multiplicity    Î¼  i     subscript  Î¼  i    \mu_{i}   . First, find the ranks (matrix ranks) of the matrices     (   A  -    Î»  i   I    )   ,    (   A  -    Î»  i   I    )   2   ,  â€¦  ,    (   A  -    Î»  i   I    )    m  i         A     subscript  Î»  i   I     superscript    A     subscript  Î»  i   I    2   normal-â€¦   superscript    A     subscript  Î»  i   I     subscript  m  i      (A-\lambda_{i}I),(A-\lambda_{i}I)^{2},\ldots,(A-\lambda_{i}I)^{m_{i}}   . The integer    m  i     subscript  m  i    m_{i}   is determined to be the first integer for which     (   A  -    Î»  i   I    )    m  i      superscript    A     subscript  Î»  i   I     subscript  m  i     (A-\lambda_{i}I)^{m_{i}}   has rank    n  -   Î¼  i       n   subscript  Î¼  i     n-\mu_{i}   ( n being the number of rows or columns of   A   A   A   , that is,   A   A   A   is n Ã— n ).  Now define       Ï  k   =  r  a  n  k    (  A  -   Î»  i   I  )    k  -  1    -  r  a  n  k    (  A  -   Î»  i   I  )   k    (  k  =  1  ,  2  ,  â€¦  ,   m  i   )   .     fragments   subscript  Ï  k    r  a  n  k   superscript   fragments  normal-(  A    subscript  Î»  i   I  normal-)     k  1     r  a  n  k   superscript   fragments  normal-(  A    subscript  Î»  i   I  normal-)   k   italic-   fragments  normal-(  k   1  normal-,  2  normal-,  normal-â€¦  normal-,   subscript  m  i   normal-)   normal-.    \rho_{k}=rank(A-\lambda_{i}I)^{k-1}-rank(A-\lambda_{i}I)^{k}\qquad(k=1,2,%
 \ldots,m_{i}).     The variable    Ï  k     subscript  Ï  k    \rho_{k}   designates the number of linearly independent generalized eigenvectors of rank k (generalized eigenvector rank; see generalized eigenvector ) corresponding to the eigenvalue    Î»  i     subscript  Î»  i    \lambda_{i}   that will appear in a canonical basis for   A   A   A   . Note that        r  a  n  k    (   A  -    Î»  i   I    )   0    =   r  a  n  k   (  I  )    =  n   .          r  a  n  k   superscript    A     subscript  Î»  i   I    0      r  a  n  k  I        n     rank(A-\lambda_{i}I)^{0}=rank(I)=n.     Once we have determined the number of generalized eigenvectors of each rank that a canonical basis has, we can obtain the vectors explicitly (see generalized eigenvector ). 3  Example  This example illustrates a canonical basis with two Jordan chains. Unfortunately, it is a little difficult to construct an interesting example of low order. 4 The matrix      A  =   (     4    1    1    0    0     -  1       0    4    2    0    0    1      0    0    4    1    0    0      0    0    0    5    1    0      0    0    0    0    5    2      0    0    0    0    0    4     )       A    4  1  1  0  0    1     0  4  2  0  0  1    0  0  4  1  0  0    0  0  0  5  1  0    0  0  0  0  5  2    0  0  0  0  0  4      A=\begin{pmatrix}4&1&1&0&0&-1\\
 0&4&2&0&0&1\\
 0&0&4&1&0&0\\
 0&0&0&5&1&0\\
 0&0&0&0&5&2\\
 0&0&0&0&0&4\end{pmatrix}     has eigenvalues     Î»  1   =  4       subscript  Î»  1   4    \lambda_{1}=4   and     Î»  2   =  5       subscript  Î»  2   5    \lambda_{2}=5   with algebraic multiplicities     Î¼  1   =  4       subscript  Î¼  1   4    \mu_{1}=4   and     Î¼  2   =  2       subscript  Î¼  2   2    \mu_{2}=2   , but geometric multiplicities      Î³  1   =  1       subscript  Î³  1   1    \gamma_{1}=1   and     Î³  2   =  1       subscript  Î³  2   1    \gamma_{2}=1   .  For      Î»  1   =  4   ,       subscript  Î»  1   4    \lambda_{1}=4,   we have      n  -   Î¼  1    =   6  -  4   =  2   ,          n   subscript  Î¼  1      6  4        2     n-\mu_{1}=6-4=2,         (   A  -   4  I    )      A    4  I     (A-4I)   has rank 5,       (   A  -   4  I    )   2     superscript    A    4  I    2    (A-4I)^{2}   has rank 4,       (   A  -   4  I    )   3     superscript    A    4  I    3    (A-4I)^{3}   has rank 3,       (   A  -   4  I    )   4     superscript    A    4  I    4    (A-4I)^{4}   has rank 2.  Therefore     m  1   =  4.       subscript  m  1   4.    m_{1}=4.           Ï  4   =    r  a  n  k    (   A  -   4  I    )   3    -   r  a  n  k    (   A  -   4  I    )   4     =   3  -  2   =  1   ,         subscript  Ï  4       r  a  n  k   superscript    A    4  I    3      r  a  n  k   superscript    A    4  I    4            3  2        1     \rho_{4}=rank(A-4I)^{3}-rank(A-4I)^{4}=3-2=1,           Ï  3   =    r  a  n  k    (   A  -   4  I    )   2    -   r  a  n  k    (   A  -   4  I    )   3     =   4  -  3   =  1   ,         subscript  Ï  3       r  a  n  k   superscript    A    4  I    2      r  a  n  k   superscript    A    4  I    3            4  3        1     \rho_{3}=rank(A-4I)^{2}-rank(A-4I)^{3}=4-3=1,           Ï  2   =    r  a  n  k    (   A  -   4  I    )   1    -   r  a  n  k    (   A  -   4  I    )   2     =   5  -  4   =  1   ,         subscript  Ï  2       r  a  n  k   superscript    A    4  I    1      r  a  n  k   superscript    A    4  I    2            5  4        1     \rho_{2}=rank(A-4I)^{1}-rank(A-4I)^{2}=5-4=1,          Ï  1   =    r  a  n  k    (   A  -   4  I    )   0    -   r  a  n  k    (   A  -   4  I    )   1     =   6  -  5   =  1.         subscript  Ï  1       r  a  n  k   superscript    A    4  I    0      r  a  n  k   superscript    A    4  I    1            6  5        1.     \rho_{1}=rank(A-4I)^{0}-rank(A-4I)^{1}=6-5=1.     Thus, a canonical basis for   A   A   A   will have, corresponding to      Î»  1   =  4   ,       subscript  Î»  1   4    \lambda_{1}=4,   one generalized eigenvector each of ranks 4, 3, 2 and 1.  For      Î»  2   =  5   ,       subscript  Î»  2   5    \lambda_{2}=5,   we have      n  -   Î¼  2    =   6  -  2   =  4   ,          n   subscript  Î¼  2      6  2        4     n-\mu_{2}=6-2=4,         (   A  -   5  I    )      A    5  I     (A-5I)   has rank 5,       (   A  -   5  I    )   2     superscript    A    5  I    2    (A-5I)^{2}   has rank 4.  Therefore     m  2   =  2.       subscript  m  2   2.    m_{2}=2.           Ï  2   =    r  a  n  k    (   A  -   5  I    )   1    -   r  a  n  k    (   A  -   5  I    )   2     =   5  -  4   =  1   ,         subscript  Ï  2       r  a  n  k   superscript    A    5  I    1      r  a  n  k   superscript    A    5  I    2            5  4        1     \rho_{2}=rank(A-5I)^{1}-rank(A-5I)^{2}=5-4=1,          Ï  1   =    r  a  n  k    (   A  -   5  I    )   0    -   r  a  n  k    (   A  -   5  I    )   1     =   6  -  5   =  1.         subscript  Ï  1       r  a  n  k   superscript    A    5  I    0      r  a  n  k   superscript    A    5  I    1            6  5        1.     \rho_{1}=rank(A-5I)^{0}-rank(A-5I)^{1}=6-5=1.     Thus, a canonical basis for   A   A   A   will have, corresponding to      Î»  2   =  5   ,       subscript  Î»  2   5    \lambda_{2}=5,   one generalized eigenvector each of ranks 2 and 1.  A canonical basis for   A   A   A   is        {   ğ•©  1   ,   ğ•©  2   ,   ğ•©  3   ,   ğ•©  4   ,   ğ•ª  1   ,   ğ•ª  2   }   =   {    (      -  4       0      0      0      0      0     )    (      -  27        -  4       0      0      0      0     )    (     25       -  25        -  2       0      0      0     )    (     0      36       -  12        -  2       2       -  1      )    (     3      2      1      1      0      0     )    (      -  8        -  4        -  1       0      1      0     )    }    .        subscript  ğ•©  1    subscript  ğ•©  2    subscript  ğ•©  3    subscript  ğ•©  4    subscript  ğ•ª  1    subscript  ğ•ª  2           4     0    0    0    0    0        27       4     0    0    0    0      25      25       2     0    0    0      0    36      12       2     2      1       3    2    1    1    0    0        8       4       1     0    1    0        \left\{\mathbb{x}_{1},\mathbb{x}_{2},\mathbb{x}_{3},\mathbb{x}_{4},\mathbb{y}_%
 {1},\mathbb{y}_{2}\right\}=\left\{\begin{pmatrix}-4\\
 0\\
 0\\
 0\\
 0\\
 0\end{pmatrix}\begin{pmatrix}-27\\
 -4\\
 0\\
 0\\
 0\\
 0\end{pmatrix}\begin{pmatrix}25\\
 -25\\
 -2\\
 0\\
 0\\
 0\end{pmatrix}\begin{pmatrix}0\\
 36\\
 -12\\
 -2\\
 2\\
 -1\end{pmatrix}\begin{pmatrix}3\\
 2\\
 1\\
 1\\
 0\\
 0\end{pmatrix}\begin{pmatrix}-8\\
 -4\\
 -1\\
 0\\
 1\\
 0\end{pmatrix}\right\}.       ğ•©  1     subscript  ğ•©  1    \mathbb{x}_{1}   is the ordinary eigenvector associated with    Î»  1     subscript  Î»  1    \lambda_{1}   .     ğ•©  2   ,   ğ•©  3       subscript  ğ•©  2    subscript  ğ•©  3     \mathbb{x}_{2},\mathbb{x}_{3}   and    ğ•©  4     subscript  ğ•©  4    \mathbb{x}_{4}   are generalized eigenvectors associated with    Î»  1     subscript  Î»  1    \lambda_{1}   .    ğ•ª  1     subscript  ğ•ª  1    \mathbb{y}_{1}   is the ordinary eigenvector associated with    Î»  2     subscript  Î»  2    \lambda_{2}   .    ğ•ª  2     subscript  ğ•ª  2    \mathbb{y}_{2}   is a generalized eigenvector associated with    Î»  2     subscript  Î»  2    \lambda_{2}   .  A matrix   J   J   J   in Jordan normal form, similar to   A   A   A   is obtained as follows:       M  =   (      ğ•©  1      ğ•©  2      ğ•©  3      ğ•©  4      ğ•ª  1      ğ•ª  2      )   =   (      -  4      -  27     25    0    3     -  8       0     -  4      -  25     36    2     -  4       0    0     -  2      -  12     1     -  1       0    0    0     -  2     1    0      0    0    0    2    0    1      0    0    0     -  1     0    0     )    ,        M     subscript  ğ•©  1    subscript  ğ•©  2    subscript  ğ•©  3    subscript  ğ•©  4    subscript  ğ•ª  1    subscript  ğ•ª  2              4     27   25  0  3    8     0    4     25   36  2    4     0  0    2     12   1    1     0  0  0    2   1  0    0  0  0  2  0  1    0  0  0    1   0  0       M=\begin{pmatrix}\mathbb{x}_{1}&\mathbb{x}_{2}&\mathbb{x}_{3}&\mathbb{x}_{4}&%
 \mathbb{y}_{1}&\mathbb{y}_{2}\end{pmatrix}=\begin{pmatrix}-4&-27&25&0&3&-8\\
 0&-4&-25&36&2&-4\\
 0&0&-2&-12&1&-1\\
 0&0&0&-2&1&0\\
 0&0&0&2&0&1\\
 0&0&0&-1&0&0\end{pmatrix},          J  =   (     4    1    0    0    0    0      0    4    1    0    0    0      0    0    4    1    0    0      0    0    0    4    0    0      0    0    0    0    5    1      0    0    0    0    0    5     )    ,      J    4  1  0  0  0  0    0  4  1  0  0  0    0  0  4  1  0  0    0  0  0  4  0  0    0  0  0  0  5  1    0  0  0  0  0  5      J=\begin{pmatrix}4&1&0&0&0&0\\
 0&4&1&0&0&0\\
 0&0&4&1&0&0\\
 0&0&0&4&0&0\\
 0&0&0&0&5&1\\
 0&0&0&0&0&5\end{pmatrix},     where the matrix   M   M   M   is a generalized modal matrix for   A   A   A   and     A  M   =   M  J         A  M     M  J     AM=MJ   . 5  See also   Canonical form  Normal form (disambiguation)  Polynomial basis  Normal basis  Change of basis   Notes    References       fr:Base canonique  pt:Base canÃ´nica "  Category:Linear algebra  Category:Abstract algebra     â†©  â†©  â†©  â†©  â†©     
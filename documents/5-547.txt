   Multipole expansion      Multipole expansion   A multipole expansion is a mathematical series representing a function that depends on angles â€” usually the two angles on a sphere . These series are useful because they can often be truncated, meaning that only the first few terms need to be retained for a good approximation to the original function. The function being expanded may be complex in general. Multipole expansions are very frequently used in the study of electromagnetic and gravitational fields , where the fields at distant points are given in terms of sources in a small region. The multipole expansion with angles is often combined with an expansion in radius . Such a combination gives an expansion describing a function throughout three-dimensional space. 1  The multipole expansion is expressed as a sum of terms with progressively finer angular features. For example, the initial term â€” called the zero-th, or monopole, moment â€” is a constant, independent of angle. The following term â€” the first, or dipole , moment â€” varies once from positive to negative around the sphere. Higher-order terms (like the quadrupole and octupole) vary more quickly with angles. 2 A multipole moment usually involves powers (or inverse powers) of the distance to the origin, as well as some angular dependence.  In principle, a multipole expansion provides an exact description of the potential and generally converges under two conditions: (1) if the sources (e.g., charges) are localized close to the origin and the point at which the potential is observed is far from the origin; or (2) the reverse, i.e., if the sources (e.g., charges) are located far from the origin and the potential is observed close to the origin. In the first (more common) case, the coefficients of the series expansion are called exterior multipole moments or simply multipole moments whereas, in the second case, they are called interior multipole moments . The first (the zeroth-order) term in the expansion is called the monopole moment, the second (the first-order) term is denoted as the dipole moment, and the third (the second-order), fourth (the third-order), etc. terms are denoted as quadrupole , octupole, etc. moments.  Expansion in spherical harmonics  Most commonly, the series is written as a sum of spherical harmonics . Thus, we might write a function    f   (  Î¸  ,  Ï•  )       f   Î¸  Ï•     f(\theta,\phi)   as the sum        f   (  Î¸  ,  Ï•  )    =     âˆ‘   l  =  0   âˆ       âˆ‘   m  =   -  l    l       C  l  m     Y  l  m    (  Î¸  ,  Ï•  )       .        f   Î¸  Ï•      superscript   subscript     l  0        superscript   subscript     m    l     l      subscript   superscript  C  m   l    subscript   superscript  Y  m   l    Î¸  Ï•        f(\theta,\phi)=\sum_{l=0}^{\infty}\,\sum_{m=-l}^{l}\,C^{m}_{l}\,Y^{m}_{l}(%
 \theta,\phi).   Here,     Y  l  m    (  Î¸  ,  Ï•  )        subscript   superscript  Y  m   l    Î¸  Ï•     Y^{m}_{l}(\theta,\phi)   are the standard spherical harmonics, and    C  l  m     subscript   superscript  C  m   l    C^{m}_{l}   are constant coefficients which depend on the function. The term    C  0  0     subscript   superscript  C  0   0    C^{0}_{0}   represents the monopole;     C  1   -  1    ,   C  1  0   ,   C  1  1       subscript   superscript  C    1    1    subscript   superscript  C  0   1    subscript   superscript  C  1   1     C^{-1}_{1},C^{0}_{1},C^{1}_{1}   represent the dipole; and so on. Equivalently, the series is also frequently written 3 as        f   (  Î¸  ,  Ï•  )    =   C  +    C  i    n  i    +    C   i  j     n  i    n  j    +    C   i  j  k     n  i    n  j    n  k    +    C   i  j  k  l     n  i    n  j    n  k    n  l    +  â‹¯    .        f   Î¸  Ï•      C     subscript  C  i    superscript  n  i       subscript  C    i  j     superscript  n  i    superscript  n  j       subscript  C    i  j  k     superscript  n  i    superscript  n  j    superscript  n  k       subscript  C    i  j  k  l     superscript  n  i    superscript  n  j    superscript  n  k    superscript  n  l    normal-â‹¯     f(\theta,\phi)=C+C_{i}n^{i}+C_{ij}n^{i}n^{j}+C_{ijk}n^{i}n^{j}n^{k}+C_{ijkl}n^%
 {i}n^{j}n^{k}n^{l}+\cdots.   Here, the    n  i     superscript  n  i    n^{i}   represent the components of a unit vector in the direction given by the angles   Î¸   Î¸   \theta   and   Ï•   Ï•   \phi   , and indices are implicitly summed . Here, the term   C   C   C   is the monopole;    C  i     subscript  C  i    C_{i}   is a set of three numbers representing the dipole; and so on.  In the above expansions, the coefficients may be real or complex. If the function being expressed as a multipole expansion is real, however, the coefficients must satisfy certain properties. In the spherical harmonic expansion, we must have        C  l   -  m    =     (   -  1   )   m     C  l   m  âˆ—       .       superscript   subscript  C  l     m       superscript    1   m    subscript   superscript  C   m  normal-âˆ—    l      C_{l}^{-m}=(-1)^{m}C^{m\ast}_{l}\ .   In the multi-vector expansion, each coefficient must be real:       C  =   C  âˆ—    ;     C  i   =   C  i  âˆ—    ;     C   i  j    =   C   i  j   âˆ—    ;    C   i  j  k    =    C   i  j  k   âˆ—   ;  â€¦         formulae-sequence    C   superscript  C  normal-âˆ—     formulae-sequence     subscript  C  i    superscript   subscript  C  i   normal-âˆ—     formulae-sequence     subscript  C    i  j     superscript   subscript  C    i  j    normal-âˆ—       subscript  C    i  j  k      superscript   subscript  C    i  j  k    normal-âˆ—   normal-â€¦        C=C^{\ast};\ C_{i}=C_{i}^{\ast};\ C_{ij}=C_{ij}^{\ast};\ C_{ijk}=C_{ijk}^{\ast%
 };\ \ldots     While expansions of scalar functions are by far the most common application of multipole expansions, they may also be generalized to describe tensors of arbitrary rank. 4 This finds use in multipole expansions of the vector potential in electromagnetism, or the metric perturbation in the description of gravitational waves .  For describing functions of three dimensions, away from the coordinate origin, the coefficients of the multipole expansion can be written as functions of the distance to the origin,   r   r   r   â€”most frequently, as a Laurent series in powers of   r   r   r   . For example, to describe the electromagnetic potential,   V   V   V   , from a source in a small region near the origin, the coefficients may be written as:        V   (  r  ,  Î¸  ,  Ï•  )    =     âˆ‘   l  =  0   âˆ       âˆ‘   m  =   -  l    l      C  l  m    (  r  )    Y  l  m    (  Î¸  ,  Ï•  )      =     âˆ‘   j  =  1   âˆ       âˆ‘   l  =  0   âˆ       âˆ‘   m  =   -  l    l        D   l  ,  j   m    r  j      Y  l  m    (  Î¸  ,  Ï•  )        .          V   r  Î¸  Ï•      superscript   subscript     l  0        superscript   subscript     m    l     l      subscript   superscript  C  m   l   r   subscript   superscript  Y  m   l    Î¸  Ï•             superscript   subscript     j  1        superscript   subscript     l  0        superscript   subscript     m    l     l        subscript   superscript  D  m    l  j     superscript  r  j     subscript   superscript  Y  m   l    Î¸  Ï•          V(r,\theta,\phi)=\sum_{l=0}^{\infty}\,\sum_{m=-l}^{l}\,C^{m}_{l}(r)\,Y^{m}_{l}%
 (\theta,\phi)=\sum_{j=1}^{\infty}\,\sum_{l=0}^{\infty}\,\sum_{m=-l}^{l}\,\frac%
 {D^{m}_{l,j}}{r^{j}}\,Y^{m}_{l}(\theta,\phi).     Applications of multipole expansions  Multipole expansions are widely used in problems involving gravitational fields of systems of masses , electric and magnetic fields of charge and current distributions, and the propagation of electromagnetic waves . A classic example is the calculation of the exterior multipole moments of atomic nuclei from their interaction energies with the interior multipoles of the electronic orbitals. The multipole moments of the nuclei report on the distribution of charges within the nucleus and, thus, on the shape of the nucleus. Truncation of the multipole expansion to its first non-zero term is often useful for theoretical calculations.  Multipole expansions are also useful in numerical simulations, and form the basis of the Fast Multipole Method 5 of Greengard and Rokhlin , a general technique for efficient computation of energies and forces in systems of interacting particles. The basic idea is to decompose the particles into groups; particles within a group interact normally (i.e., by the full potential), whereas the energies and forces between groups of particles are calculated from their multipole moments. The efficiency of the fast multipole method is generally similar to that of Ewald summation , but is superior if the particles are clustered, i.e., if the system has large density fluctuations.  Multipole expansion of a potential outside an electrostatic charge distribution  Consider a discrete charge distribution consisting of N point charges q i with position vectors r i . We assume the charges to be clustered around the origin, so that for all i : r i max, where r max has some finite value. The potential V ( R ), due to the charge distribution, at a point R outside the charge distribution, i.e., | R | > r max , can be expanded in powers of 1/ R . Two ways of making this expansion can be found in the literature. The first is a Taylor series in the Cartesian coordinates x , y , and z , while the second is in terms of spherical harmonics which depend on spherical polar coordinates. The Cartesian approach has the advantage that no prior knowledge of Legendre functions, spherical harmonics, etc., is required. Its disadvantage is that the derivations are fairly cumbersome (in fact a large part of it is the implicit rederivation of the Legendre expansion of 1/| r - R |, which was done once and for all by Legendre in the 1780s). Also it is difficult to give a closed expression for a general term of the multipole expansionâ€”usually only the first few terms are given followed by an ellipsis.  Expansion in Cartesian coordinates  The Taylor expansion of an arbitrary function v ( R - r ) around the origin r = 0 is       v   (   ğ‘  -  ğ«   )    =       v   (  ğ‘  )    -    âˆ‘   Î±  =   x  ,  y  ,  z       r  Î±    v  Î±    (  ğ‘  )      +    1  2     âˆ‘   Î±  =   x  ,  y  ,  z       âˆ‘   Î²  =   x  ,  y  ,  z       r  Î±    r  Î²    v   Î±  Î²     (  ğ‘  )        -  â‹¯   +  â‹¯         v    ğ‘  ğ«              v  ğ‘     subscript     Î±   x  y  z        subscript  r  Î±    subscript  v  Î±   ğ‘         1  2     subscript     Î±   x  y  z       subscript     Î²   x  y  z        subscript  r  Î±    subscript  r  Î²    subscript  v    Î±  Î²    ğ‘       normal-â‹¯   normal-â‹¯     v(\mathbf{R}-\mathbf{r})=v(\mathbf{R})-\sum_{\alpha=x,y,z}r_{\alpha}v_{\alpha}%
 (\mathbf{R})+\frac{1}{2}\sum_{\alpha=x,y,z}\sum_{\beta=x,y,z}r_{\alpha}r_{%
 \beta}v_{\alpha\beta}(\mathbf{R})-\cdots+\cdots   with          v  Î±    (  ğ‘  )    â‰¡     (     âˆ‚  v    (   ğ«  -  ğ‘   )     âˆ‚   r  Î±     )    ğ«  =  ğŸ    and       v   Î±  Î²     (  ğ‘  )    â‰¡    (      âˆ‚  2   v    (   ğ«  -  ğ‘   )      âˆ‚   r  Î±     âˆ‚   r  Î²      )    ğ«  =  ğŸ      .     formulae-sequence       subscript  v  Î±   ğ‘     subscript        v     ğ«  ğ‘       subscript  r  Î±       ğ«  0    and         subscript  v    Î±  Î²    ğ‘    subscript        superscript   2   v     ğ«  ğ‘         subscript  r  Î±       subscript  r  Î²        ğ«  0       v_{\alpha}(\mathbf{R})\equiv\left(\frac{\partial v(\mathbf{r}-\mathbf{R})}{%
 \partial r_{\alpha}}\right)_{\mathbf{r}=\mathbf{0}}\quad\hbox{and}\quad v_{%
 \alpha\beta}(\mathbf{R})\equiv\left(\frac{\partial^{2}v(\mathbf{r}-\mathbf{R})%
 }{\partial r_{\alpha}\partial r_{\beta}}\right)_{\mathbf{r}=\mathbf{0}}.   If v ( r - R ) satisfies the Laplace equation        (     âˆ‡  2   v    (   ğ«  -  ğ‘   )    )    ğ«  =  ğŸ    =    âˆ‘   Î±  =   x  ,  y  ,  z       v   Î±  Î±     (  ğ‘  )     =  0         subscript      superscript  normal-âˆ‡  2   v     ğ«  ğ‘      ğ«  0      subscript     Î±   x  y  z        subscript  v    Î±  Î±    ğ‘         0     \left(\nabla^{2}v(\mathbf{r}-\mathbf{R})\right)_{\mathbf{r}=\mathbf{0}}=\sum_{%
 \alpha=x,y,z}v_{\alpha\alpha}(\mathbf{R})=0   then the expansion can be rewritten in terms of the components of a traceless Cartesian second rank tensor :         âˆ‘   Î±  =   x  ,  y  ,  z       âˆ‘   Î²  =   x  ,  y  ,  z       r  Î±    r  Î²    v   Î±  Î²     (  ğ‘  )      =    1  3     âˆ‘   Î±  =   x  ,  y  ,  z       âˆ‘   Î²  =   x  ,  y  ,  z       (    3   r  Î±    r  Î²    -    Î´   Î±  Î²     r  2     )    v   Î±  Î²     (  ğ‘  )        ,        subscript     Î±   x  y  z       subscript     Î²   x  y  z        subscript  r  Î±    subscript  r  Î²    subscript  v    Î±  Î²    ğ‘         1  3     subscript     Î±   x  y  z       subscript     Î²   x  y  z           3   subscript  r  Î±    subscript  r  Î²       subscript  Î´    Î±  Î²     superscript  r  2      subscript  v    Î±  Î²    ğ‘        \sum_{\alpha=x,y,z}\sum_{\beta=x,y,z}r_{\alpha}r_{\beta}v_{\alpha\beta}(%
 \mathbf{R})=\frac{1}{3}\sum_{\alpha=x,y,z}\sum_{\beta=x,y,z}(3r_{\alpha}r_{%
 \beta}-\delta_{\alpha\beta}r^{2})v_{\alpha\beta}(\mathbf{R}),   where Î´ Î±Î² is the Kronecker delta and r 2 â‰¡ | r | 2 . Removing the trace is common, because it takes the rotationally invariant r 2 out of the second rank tensor.  Example  Consider now the following form of v ( r - R ):        v   (   ğ«  -  ğ‘   )    â‰¡   1   |   ğ«  -  ğ‘   |     .        v    ğ«  ğ‘      1      ğ«  ğ‘       v(\mathbf{r}-\mathbf{R})\equiv\frac{1}{|\mathbf{r}-\mathbf{R}|}.   Then by direct differentiation it follows that         v   (  ğ‘  )    =   1  R    ,      v  Î±    (  ğ‘  )    =    -    R  Î±    R  3     ,  and       v   Î±  Î²     (  ğ‘  )    =     3   R  Î±    R  Î²    -    Î´   Î±  Î²     R  2      R  5       .     formulae-sequence      v  ğ‘     1  R     formulae-sequence       subscript  v  Î±   ğ‘         subscript  R  Î±    superscript  R  3     and         subscript  v    Î±  Î²    ğ‘         3   subscript  R  Î±    subscript  R  Î²       subscript  Î´    Î±  Î²     superscript  R  2      superscript  R  5        v(\mathbf{R})=\frac{1}{R},\quad v_{\alpha}(\mathbf{R})=-\frac{R_{\alpha}}{R^{3%
 }},\quad\hbox{and}\quad v_{\alpha\beta}(\mathbf{R})=\frac{3R_{\alpha}R_{\beta}%
 -\delta_{\alpha\beta}R^{2}}{R^{5}}.   Define a monopole, dipole, and (traceless) quadrupole by, respectively,         q  tot   â‰¡    âˆ‘   i  =  1   N    q  i     ,     P  Î±   â‰¡     âˆ‘   i  =  1   N     q  i    r   i  Î±      ,  and      Q   Î±  Î²    â‰¡    âˆ‘   i  =  1   N     q  i    (    3   r   i  Î±     r   i  Î²     -    Î´   Î±  Î²     r  i  2     )        ,     formulae-sequence     subscript  q  tot     superscript   subscript     i  1    N    subscript  q  i      formulae-sequence     subscript  P  Î±      superscript   subscript     i  1    N      subscript  q  i    subscript  r    i  Î±      and       subscript  Q    Î±  Î²      superscript   subscript     i  1    N      subscript  q  i       3   subscript  r    i  Î±     subscript  r    i  Î²        subscript  Î´    Î±  Î²     superscript   subscript  r  i   2           q_{\mathrm{tot}}\equiv\sum_{i=1}^{N}q_{i},\quad P_{\alpha}\equiv\sum_{i=1}^{N}%
 q_{i}r_{i\alpha},\quad\hbox{and}\quad Q_{\alpha\beta}\equiv\sum_{i=1}^{N}q_{i}%
 (3r_{i\alpha}r_{i\beta}-\delta_{\alpha\beta}r_{i}^{2}),   and we obtain finally the first few terms of the multipole expansion of the total potential, which is the sum of the Coulomb potentials of the separate charges:       4  Ï€   Îµ  0   V   (  ğ‘  )    â‰¡    âˆ‘   i  =  1   N     q  i   v   (    ğ«  i   -  ğ‘   )           4  Ï€   subscript  Îµ  0   V  ğ‘     superscript   subscript     i  1    N      subscript  q  i   v     subscript  ğ«  i   ğ‘       4\pi\varepsilon_{0}V(\mathbf{R})\equiv\sum_{i=1}^{N}q_{i}v(\mathbf{r}_{i}-%
 \mathbf{R})            \frac{q_\mathrm{tot}}{R} + \frac{1}{R^3}\sum_{\alpha  x,y,z} P_\alpha R_\alpha + \frac{1}{6 R^5}\sum_{\alpha,\beta=x,y,z} Q_{\alpha\beta} (3R_\alpha R_\beta - \delta_{\alpha\beta} R^2) +\cdots  This expansion of the potential of a discrete charge distribution is very similar to the one in real solid harmonics given below. The main difference is that the present one is in terms of linear dependent quantities, for         âˆ‘  Î±    v   Î±  Î±     =   0  and       âˆ‘  Î±    Q   Î±  Î±     =  0.      formulae-sequence      subscript   Î±    subscript  v    Î±  Î±      0  and        subscript   Î±    subscript  Q    Î±  Î±     0.     \sum_{\alpha}v_{\alpha\alpha}=0\quad\hbox{and}\quad\sum_{\alpha}Q_{\alpha%
 \alpha}=0.     NOTE: If the charge distribution consists of two charges of opposite sign which are an infinitesimal distance d apart, so that d/R >> ( d/R ) 2 , it is easily shown that the only non-vanishing term in the expansion is        V   (  ğ‘  )    =    1   4  Ï€   Îµ  0    R  3      (   ğ  â‹…  ğ‘   )     ,        V  ğ‘       1    4  Ï€   subscript  Îµ  0    superscript  R  3      normal-â‹…  ğ  ğ‘      V(\mathbf{R})=\frac{1}{4\pi\varepsilon_{0}R^{3}}(\mathbf{P}\cdot\mathbf{R}),   the electric dipolar potential field .  Spherical form  The potential V ( R ) at a point R outside the charge distribution, i.e., | R |Â > r max , can be expanded by the Laplace expansion :        V   (  ğ‘  )    â‰¡    âˆ‘   i  =  1   N     q  i    4  Ï€   Îµ  0    |    ğ«  i   -  ğ‘   |      =    1   4  Ï€   Îµ  0       âˆ‘   â„“  =  0   âˆ     âˆ‘   m  =   -  â„“    â„“      (   -  1   )   m    I  â„“   -  m     (  ğ‘  )     âˆ‘   i  =  1   N     q  i    R  â„“  m    (   ğ«  i   )          ,          V  ğ‘     superscript   subscript     i  1    N      subscript  q  i     4  Ï€   subscript  Îµ  0        subscript  ğ«  i   ğ‘                1    4  Ï€   subscript  Îµ  0       superscript   subscript     normal-â„“  0        superscript   subscript     m    normal-â„“     normal-â„“      superscript    1   m    subscript   superscript  I    m    normal-â„“   ğ‘    superscript   subscript     i  1    N      subscript  q  i    subscript   superscript  R  m   normal-â„“    subscript  ğ«  i            V(\mathbf{R})\equiv\sum_{i=1}^{N}\frac{q_{i}}{4\pi\varepsilon_{0}|\mathbf{r}_{%
 i}-\mathbf{R}|}=\frac{1}{4\pi\varepsilon_{0}}\sum_{\ell=0}^{\infty}\sum_{m=-%
 \ell}^{\ell}(-1)^{m}I^{-m}_{\ell}(\mathbf{R})\sum_{i=1}^{N}q_{i}R^{m}_{\ell}(%
 \mathbf{r}_{i}),     where     I  â„“   -  m     (  ğ‘  )        subscript   superscript  I    m    normal-â„“   ğ‘    I^{-m}_{\ell}(\mathbf{R})   is an irregular solid harmonic (defined below as a spherical harmonic function divided by    R   â„“  +  1      superscript  R    normal-â„“  1     R^{\ell+1}   ) and     R  â„“  m    (  ğ«  )        subscript   superscript  R  m   normal-â„“   ğ«    R^{m}_{\ell}(\mathbf{r})   is a regular solid harmonic (a spherical harmonic times r â„“ ). We define the spherical multipole moment of the charge distribution as follows         Q  â„“  m   â‰¡    âˆ‘   i  =  1   N     q  i    R  â„“  m    (   ğ«  i   )      ,    -  â„“   â‰¤  m  â‰¤  â„“    .     formulae-sequence     subscript   superscript  Q  m   normal-â„“     superscript   subscript     i  1    N      subscript  q  i    subscript   superscript  R  m   normal-â„“    subscript  ğ«  i            normal-â„“   m       normal-â„“      Q^{m}_{\ell}\equiv\sum_{i=1}^{N}q_{i}R^{m}_{\ell}(\mathbf{r}_{i}),\qquad-\ell%
 \leq m\leq\ell.   Note that a multipole moment is solely determined by the charge distribution (the positions and magnitudes of the N charges).  A spherical harmonic depends on the unit vector    R  ^     normal-^  R    \hat{R}   . (A unit vector is determined by two spherical polar angles.) Thus, by definition, the irregular solid harmonics can be written as        I  â„“  m    (  ğ‘  )    â‰¡      4  Ï€     2  â„“   +  1        Y  â„“  m    (   R  ^   )     R   â„“  +  1             subscript   superscript  I  m   normal-â„“   ğ‘           4  Ï€       2  normal-â„“   1          subscript   superscript  Y  m   normal-â„“    normal-^  R     superscript  R    normal-â„“  1        I^{m}_{\ell}(\mathbf{R})\equiv\sqrt{\frac{4\pi}{2\ell+1}}\frac{Y^{m}_{\ell}(%
 \hat{R})}{R^{\ell+1}}   so that the multipole expansion of the field V ( R ) at the point R outside the charge distribution is given by       V   (  ğ‘  )    =    1   4  Ï€   Îµ  0       âˆ‘   â„“  =  0   âˆ     âˆ‘   m  =   -  â„“    â„“      (   -  1   )   m    I  â„“   -  m     (  ğ‘  )    Q  â„“  m             V  ğ‘       1    4  Ï€   subscript  Îµ  0       superscript   subscript     normal-â„“  0        superscript   subscript     m    normal-â„“     normal-â„“      superscript    1   m    subscript   superscript  I    m    normal-â„“   ğ‘   subscript   superscript  Q  m   normal-â„“         V(\mathbf{R})=\frac{1}{4\pi\varepsilon_{0}}\sum_{\ell=0}^{\infty}\sum_{m=-\ell%
 }^{\ell}(-1)^{m}I^{-m}_{\ell}(\mathbf{R})Q^{m}_{\ell}            \frac{1}{4\pi\varepsilon_0} \sum_{\ell  0}^\infty \left[\frac{4\pi}{2\ell+1}\right]^{1/2}\; \frac{1}{R^{\ell+1}}\; \sum_{m=-\ell}^{\ell} (-1)^m Y^{-m}_\ell(\hat{R}) Q^m_\ell, \qquad R > r_{\mathrm{max}}.  This expansion is completely general in that it gives a closed form for all terms, not just for the first few. It shows that the spherical multipole moments appear as coefficients in the 1/ R expansion of the potential.  It is of interest to consider the first few terms in real form, which are the only terms commonly found in undergraduate textbooks. Since the summand of the m summation is invariant under a unitary transformation of both factors simultaneously and since transformation of complex spherical harmonics to real form is by a unitary transformation , we can simply substitute real irregular solid harmonics and real multipole moments. The â„“ = 0 term becomes          V   â„“  =  0     (  ğ‘  )    =     q  tot    4  Ï€   Îµ  0   R    with      q  tot   â‰¡    âˆ‘   i  =  1   N    q  i      .     formulae-sequence       subscript  V    normal-â„“  0    ğ‘       subscript  q  tot     4  Ï€   subscript  Îµ  0   R    with       subscript  q  tot     superscript   subscript     i  1    N    subscript  q  i       V_{\ell=0}(\mathbf{R})=\frac{q_{\mathrm{tot}}}{4\pi\varepsilon_{0}R}\qquad%
 \hbox{with}\quad q_{\mathrm{tot}}\equiv\sum_{i=1}^{N}q_{i}.   This is in fact Coulomb's law again. For the â„“ = 1 term we introduce        ğ‘  =   (   R  x   ,   R  y   ,   R  z   )    ,    ğ  =    (   P  x   ,   P  y   ,   P  z   )   with       P  Î±   â‰¡    âˆ‘   i  =  1   N     q  i    r   i  Î±       ,   Î±  =   x  ,  y  ,  z       .     formulae-sequence    ğ‘    subscript  R  x    subscript  R  y    subscript  R  z      formulae-sequence    ğ     subscript  P  x    subscript  P  y    subscript  P  z    with     formulae-sequence     subscript  P  Î±     superscript   subscript     i  1    N      subscript  q  i    subscript  r    i  Î±         Î±   x  y  z        \mathbf{R}=(R_{x},R_{y},R_{z}),\quad\mathbf{P}=(P_{x},P_{y},P_{z})\quad\hbox{%
 with}\quad P_{\alpha}\equiv\sum_{i=1}^{N}q_{i}r_{i\alpha},\quad\alpha=x,y,z.   Then         V   â„“  =  1     (  ğ‘  )    =    1   4  Ï€   Îµ  0    R  3      (     R  x    P  x    +    R  y    P  y    +    R  z    P  z     )    =    ğ‘  â‹…  ğ    4  Ï€   Îµ  0    R  3     =     R  ^   â‹…  ğ    4  Ï€   Îµ  0    R  2      .           subscript  V    normal-â„“  1    ğ‘       1    4  Ï€   subscript  Îµ  0    superscript  R  3          subscript  R  x    subscript  P  x       subscript  R  y    subscript  P  y       subscript  R  z    subscript  P  z              normal-â‹…  ğ‘  ğ     4  Ï€   subscript  Îµ  0    superscript  R  3             normal-â‹…   normal-^  R   ğ     4  Ï€   subscript  Îµ  0    superscript  R  2        V_{\ell=1}(\mathbf{R})=\frac{1}{4\pi\varepsilon_{0}R^{3}}(R_{x}P_{x}+R_{y}P_{y%
 }+R_{z}P_{z})=\frac{\mathbf{R}\cdot\mathbf{P}}{4\pi\varepsilon_{0}R^{3}}=\frac%
 {\hat{R}\cdot\mathbf{P}}{4\pi\varepsilon_{0}R^{2}}.   This term is identical to the one found in Cartesian form.  In order to write the â„“ = 2 term, we have to introduce shorthand notations for the five real components of the quadrupole moment and the real spherical harmonics. Notations of the type        Q   z  2    â‰¡    âˆ‘   i  =  1   N      q  i     1  2    (    3   z  i  2    -   r  i  2    )      ,       subscript  Q   superscript  z  2      superscript   subscript     i  1    N      subscript  q  i     1  2       3   superscript   subscript  z  i   2     superscript   subscript  r  i   2        Q_{z^{2}}\equiv\sum_{i=1}^{N}q_{i}\;\frac{1}{2}(3z_{i}^{2}-r_{i}^{2}),   can be found in the literature. Clearly the real notation becomes awkward very soon, exhibiting the usefulness of the complex notation.  Interaction of two non-overlapping charge distributions  Consider two sets of point charges, one set { q i } clustered around a point A and one set { q j } clustered around a point B . Think for example of two molecules , and recall that a molecule by definition consists of electrons (negative point charges) and nuclei (positive point charges). The total electrostatic interaction energy U AB between the two distributions is        U   A  B    =    âˆ‘   i  âˆˆ  A      âˆ‘   j  âˆˆ  B       q  i    q  j     4  Ï€   Îµ  0    r   i  j         .       subscript  U    A  B      subscript     i  A      subscript     j  B         subscript  q  i    subscript  q  j      4  Ï€   subscript  Îµ  0    subscript  r    i  j          U_{AB}=\sum_{i\in A}\sum_{j\in B}\frac{q_{i}q_{j}}{4\pi\varepsilon_{0}r_{ij}}.   This energy can be expanded in a power series in the inverse distance of A and B . This expansion is known as the multipole expansion of U AB .  In order to derive this multipole expansion, we write r XY = r Y - r X , which is a vector pointing from X towards Y . Note that          ğ‘   A  B    +   ğ«   B  j    +   ğ«   j  i    +   ğ«   i  A     =   0  â‡”      ğ«   i  j    =     ğ‘   A  B    -   ğ«   A  i     +   ğ«   B  j       .     formulae-sequence       subscript  ğ‘    A  B     subscript  ğ«    B  j     subscript  ğ«    j  i     subscript  ğ«    i  A      0  normal-â‡”       subscript  ğ«    i  j         subscript  ğ‘    A  B     subscript  ğ«    A  i      subscript  ğ«    B  j        \mathbf{R}_{AB}+\mathbf{r}_{Bj}+\mathbf{r}_{ji}+\mathbf{r}_{iA}=0\quad%
 \Leftrightarrow\quad\mathbf{r}_{ij}=\mathbf{R}_{AB}-\mathbf{r}_{Ai}+\mathbf{r}%
 _{Bj}.   We assume that the two distributions do not overlap:        |   ğ‘   A  B    |   >    |    ğ«   B  j    -   ğ«   A  i     |   for all  i  ,  j    .         subscript  ğ‘    A  B           subscript  ğ«    B  j     subscript  ğ«    A  i      for all  i  j     |\mathbf{R}_{AB}|>|\mathbf{r}_{Bj}-\mathbf{r}_{Ai}|\quad\hbox{for all}\quad i,j.   Under this condition we may apply the Laplace expansion in the following form        1   |    ğ«  j   -   ğ«  i    |    =   1   |    ğ‘   A  B    -   (    ğ«   A  i    -   ğ«   B  j     )    |    =    âˆ‘   L  =  0   âˆ      âˆ‘   M  =   -  L    L       (   -  1   )   M    I  L   -  M     (   ğ‘   A  B    )    R  L  M    (    ğ«   A  i    -   ğ«   B  j     )       ,          1       subscript  ğ«  j    subscript  ğ«  i        1       subscript  ğ‘    A  B       subscript  ğ«    A  i     subscript  ğ«    B  j               superscript   subscript     L  0        superscript   subscript     M    L     L      superscript    1   M    superscript   subscript  I  L     M     subscript  ğ‘    A  B     subscript   superscript  R  M   L      subscript  ğ«    A  i     subscript  ğ«    B  j           \frac{1}{|\mathbf{r}_{j}-\mathbf{r}_{i}|}=\frac{1}{|\mathbf{R}_{AB}-(\mathbf{r%
 }_{Ai}-\mathbf{r}_{Bj})|}=\sum_{L=0}^{\infty}\sum_{M=-L}^{L}\,(-1)^{M}I_{L}^{-%
 M}(\mathbf{R}_{AB})\;R^{M}_{L}(\mathbf{r}_{Ai}-\mathbf{r}_{Bj}),   where    I  L  M     subscript   superscript  I  M   L    I^{M}_{L}   and    R  L  M     subscript   superscript  R  M   L    R^{M}_{L}   are irregular and regular solid harmonics , respectively. The translation of the regular solid harmonic gives a finite expansion,        R  L  M    (    ğ«   A  i    -   ğ«   B  j     )    =    âˆ‘    â„“  A   =  0   L      (   -  1   )    L  -   â„“  A       (      2  L        2   â„“  A       )    1  /  2             subscript   superscript  R  M   L      subscript  ğ«    A  i     subscript  ğ«    B  j        superscript   subscript      subscript  normal-â„“  A   0    L      superscript    1     L   subscript  normal-â„“  A      superscript   binomial    2  L     2   subscript  normal-â„“  A       1  2        R^{M}_{L}(\mathbf{r}_{Ai}-\mathbf{r}_{Bj})=\sum_{\ell_{A}=0}^{L}(-1)^{L-\ell_{%
 A}}{\left({{2L}\atop{2\ell_{A}}}\right)}^{1/2}            \times \sum_{m_A=-\ell_A}^{\ell_A} R^{m_A}_{\ell_A}(\mathbf{r}_{Ai}) R^{M-m_A}_{L-\ell_A}(\mathbf{r}_{Bj})\; \langle \ell_A, m_A; L-\ell_A, M-m_A| L M \rangle,  where the quantity between pointed brackets is a Clebsch-Gordan coefficient . Further we used         R  â„“  m    (   -  ğ«   )    =     (   -  1   )   â„“    R  â„“  m    (  ğ«  )     .         subscript   superscript  R  m   normal-â„“     ğ«       superscript    1   normal-â„“    subscript   superscript  R  m   normal-â„“   ğ«     R^{m}_{\ell}(-\mathbf{r})=(-1)^{\ell}R^{m}_{\ell}(\mathbf{r}).   Use of the definition of spherical multipoles  Q m l and covering of the summation ranges in a somewhat different order (which is only allowed for an infinite range of L ) gives finally       U   A  B    =    1   4  Ï€   Îµ  0       âˆ‘    â„“  A   =  0   âˆ     âˆ‘    â„“  B   =  0   âˆ      (   -  1   )    â„“  B       (       2   â„“  A    +   2   â„“  B          2   â„“  A       )    1  /  2              subscript  U    A  B        1    4  Ï€   subscript  Îµ  0       superscript   subscript      subscript  normal-â„“  A   0        superscript   subscript      subscript  normal-â„“  B   0         superscript    1    subscript  normal-â„“  B     superscript   binomial      2   subscript  normal-â„“  A      2   subscript  normal-â„“  B       2   subscript  normal-â„“  A       1  2          U_{AB}=\frac{1}{4\pi\varepsilon_{0}}\sum_{\ell_{A}=0}^{\infty}\sum_{\ell_{B}=0%
 }^{\infty}(-1)^{\ell_{B}}{\left({{2\ell_{A}+2\ell_{B}}\atop{2\ell_{A}}}\right)%
 }^{1/2}\,            \times \sum_{m_A=-\ell_A}^{\ell_A} \sum_{m_B=-\ell_B}^{\ell_B}(-1)^{m_A+m_B} I_{\ell_A+\ell_B}^{-m_A-m_B}(\mathbf{R}_{AB})\; Q^{m_A}_{\ell_A} Q^{m_B}_{\ell_B}\; \langle \ell_A, m_A; \ell_B, m_B| \ell_A+\ell_B, m_A+m_B \rangle.  This is the multipole expansion of the interaction energy of two non-overlapping charge distributions which are a distance R AB apart. Since        I    â„“  A   +   â„“  B     -   (    m  A   +   m  B    )      (   ğ‘   A  B    )    â‰¡      [    4  Ï€     2   â„“  A    +   2   â„“  B    +  1    ]    1  /  2        Y    â„“  A   +   â„“  B     -   (    m  A   +   m  B    )      (    ğ‘  ^    A  B    )     R   A  B     â„“  A   +   â„“  B   +  1             superscript   subscript  I     subscript  normal-â„“  A    subscript  normal-â„“  B          subscript  m  A    subscript  m  B       subscript  ğ‘    A  B        superscript   delimited-[]      4  Ï€       2   subscript  normal-â„“  A      2   subscript  normal-â„“  B    1       1  2         subscript   superscript  Y       subscript  m  A    subscript  m  B         subscript  normal-â„“  A    subscript  normal-â„“  B      subscript   normal-^  ğ‘     A  B      subscript   superscript  R     subscript  normal-â„“  A    subscript  normal-â„“  B   1      A  B        I_{\ell_{A}+\ell_{B}}^{-(m_{A}+m_{B})}(\mathbf{R}_{AB})\equiv\left[\frac{4\pi}%
 {2\ell_{A}+2\ell_{B}+1}\right]^{1/2}\;\frac{Y^{-(m_{A}+m_{B})}_{\ell_{A}+\ell_%
 {B}}(\widehat{\mathbf{R}}_{AB})}{R^{\ell_{A}+\ell_{B}+1}_{AB}}   this expansion is manifestly in powers of 1/ R AB . The function Y m l is a normalized spherical harmonic .  Molecular moments  All atoms and molecules (except S -state atoms) have one or more non-vanishing permanent multipole moments. Different definitions can be found in the literature, but the following definition in spherical form has the advantage that it is contained in one general equation. Because it is in complex form it has as the further advantage that it is easier to manipulate in calculations than its real counterpart.  We consider a molecule consisting of N particles (electrons and nuclei) with charges eZ i . (Electrons have the Z -value unity, for nuclei it is the atomic number ). Particle i has spherical polar coordinates r i , Î¸ i , and Ï† i and Cartesian coordinates x i , y i , and z i . The (complex) electrostatic multipole operator is        Q  â„“  m   â‰¡    âˆ‘   i  =  1   N    e    Z  i     R  â„“  m    (   ğ«  i   )      ,       subscript   superscript  Q  m   normal-â„“     superscript   subscript     i  1    N     e   subscript  Z  i    subscript   superscript  R  m   normal-â„“    subscript  ğ«  i       Q^{m}_{\ell}\equiv\sum_{i=1}^{N}eZ_{i}\;R^{m}_{\ell}(\mathbf{r}_{i}),   where     R  â„“  m    (   ğ«  i   )        subscript   superscript  R  m   normal-â„“    subscript  ğ«  i     R^{m}_{\ell}(\mathbf{r}_{i})   is a regular solid harmonic function in Racah's normalization (also known as Schmidt's semi-normalization). If the molecule has total normalized wave function Î¨ (depending on the coordinates of electrons and nuclei), then the multipole moment of order   â„“   normal-â„“   \ell   of the molecule is given by the expectation (expected) value :        M  â„“  m   â‰¡   âŸ¨  Î¨  |   Q  â„“  m   |  Î¨  âŸ©    .       subscript   superscript  M  m   normal-â„“    quantum-operator-product  normal-Î¨   subscript   superscript  Q  m   normal-â„“   normal-Î¨     M^{m}_{\ell}\equiv\langle\Psi|Q^{m}_{\ell}|\Psi\rangle.   If the molecule has certain point group symmetry , then this is reflected in the wave function: Î¨ transforms according to a certain irreducible representation Î» of the group ("Î¨ has symmetry type Î»"). This has the consequence that selection rules hold for the expectation value of the multipole operator, or in other words, that the expectation value may vanish because of symmetry. A well-known example of this is the fact that molecules with an inversion center do not carry a dipole (the expectation values of    Q  1  m     subscript   superscript  Q  m   1    Q^{m}_{1}   vanish for m =Â âˆ’1,Â 0,Â 1). For a molecule without symmetry no selection rules are operative and such a molecule will have non-vanishing multipoles of any order (it will carry a dipole and simultaneously a quadrupole, octupole, hexadecapole, etc.).  The lowest explicit forms of the regular solid harmonics (with the Condon-Shortley phase ) give:        M  0  0   =    âˆ‘   i  =  1   N    e   Z  i      ,       subscript   superscript  M  0   0     superscript   subscript     i  1    N     e   subscript  Z  i       M^{0}_{0}=\sum_{i=1}^{N}eZ_{i},   (the total charge of the molecule). The (complex) dipole components are:         M  1  1   =    -      1  2       âˆ‘   i  =  1   N    e   Z  i    âŸ¨  Î¨  |    x  i   +   i   y  i     |  Î¨  âŸ©       and      M  1   -  1    =      1  2       âˆ‘   i  =  1   N    e   Z  i    âŸ¨  Î¨  |    x  i   -   i   y  i     |  Î¨  âŸ©        .     formulae-sequence     subscript   superscript  M  1   1            1  2      superscript   subscript     i  1    N     e   subscript  Z  i    quantum-operator-product  normal-Î¨     subscript  x  i     i   subscript  y  i     normal-Î¨       and       subscript   superscript  M    1    1         1  2      superscript   subscript     i  1    N     e   subscript  Z  i    quantum-operator-product  normal-Î¨     subscript  x  i     i   subscript  y  i     normal-Î¨         M^{1}_{1}=-\sqrt{\tfrac{1}{2}}\sum_{i=1}^{N}eZ_{i}\langle\Psi|x_{i}+iy_{i}|%
 \Psi\rangle\quad\hbox{and}\quad M^{-1}_{1}=\sqrt{\tfrac{1}{2}}\sum_{i=1}^{N}eZ%
 _{i}\langle\Psi|x_{i}-iy_{i}|\Psi\rangle.           M  1  0   =    âˆ‘   i  =  1   N    e   Z  i    âŸ¨  Î¨  |   z  i   |  Î¨  âŸ©      .       subscript   superscript  M  0   1     superscript   subscript     i  1    N     e   subscript  Z  i    quantum-operator-product  normal-Î¨   subscript  z  i   normal-Î¨       M^{0}_{1}=\sum_{i=1}^{N}eZ_{i}\langle\Psi|z_{i}|\Psi\rangle.     Note that by a simple linear combination one can transform the complex multipole operators to real ones. The real multipole operators are of cosine type    C  â„“  m     subscript   superscript  C  m   normal-â„“    C^{m}_{\ell}   or sine type    S  â„“  m     subscript   superscript  S  m   normal-â„“    S^{m}_{\ell}   . A few of the lowest ones are:      C  1  0     subscript   superscript  C  0   1    \displaystyle C^{0}_{1}     Note on conventions  The definition of the complex molecular multipole moment given above is the complex conjugate of the definition given in this article , which follows the definition of the standard textbook on classical electrodynamics by Jackson, 6 except for the normalization. Moreover, in the classical definition of Jackson the equivalent of the N -particle quantum mechanical expectation value is an integral over a one-particle charge distribution. Remember that in the case of a one-particle quantum mechanical system the expectation value is nothing but an integral over the charge distribution (modulus of wavefunction squared), so that the definition of this article is a quantum mechanical N -particle generalization of Jackson's definition.  The definition in this article agrees with, among others, the one of Fano and Racah 7 and Brink and Satchler. 8  Examples of multipole expansions  There are many types of multipole moments, since there are many types of potentials and many ways of approximating a potential by a series expansion , depending on the coordinates and the symmetry of the charge distribution. The most common expansions include:   Axial multipole moments of a 1/ R potential;  Spherical multipole moments of a 1/ R potential; and  Cylindrical multipole moments of a ln R potential   Examples of 1/ R potentials include the electric potential , the magnetic potential and the gravitational potential of point sources. An example of a ln R potential is the electric potential of an infinite line charge.  General mathematical properties  Multipole moments in mathematics and mathematical physics form an orthogonal basis for the decomposition of a function, based on the response of a field to point sources that are brought infinitely close to each other. These can be thought of as arranged in various geometrical shapes, or, in the sense of distribution theory , as directional derivatives .  Multipole expansions are related to the underlying rotational symmetry of the physical laws and their associated differential equations. Even though the source terms (such as the masses, charges, or currents) may not be symmetrical, one can expand them in terms of irreducible representations of the rotational symmetry group , which leads to spherical harmonics and related sets of orthogonal functions. One uses the technique of separation of variables to extract the corresponding solutions for the radial dependencies.  In practice, many fields can be well approximated with a finite number of multipole moments (although an infinite number may be required to reconstruct a field exactly). A typical application is to approximate the field of a localized charge distribution by its monopole and dipole terms. Problems solved once for a given order of multipole moment may be linearly combined to create a final approximate solution for a given source.  See also   Barnesâ€“Hut simulation  Laplace expansion  Legendre polynomials  Quadrupole magnets are used in particle accelerators  Solid harmonics  Toroidal moment   References    "  Category:Potential theory  Category:Vector calculus     â†©  â†©  â†©  â†©  â†©  J. D. Jackson, Classical Electrodynamics , 2nd edition, Wiley, New York, (1975). p. 137 â†©  U. Fano and G. Racah, Irreducible Tensorial Sets , Academic Press, New York (1959). p. 31 â†©  D. M. Brink and G. R. Satchler, Angular Momentum , 2nd edition, Clarendon Press, Oxford, UK (1968). p. 64. See also footnote on p. 90. â†©     
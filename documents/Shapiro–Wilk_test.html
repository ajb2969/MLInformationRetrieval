<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1101">Shapiro‚ÄìWilk test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Shapiro‚ÄìWilk test</h1>
<hr/>

<p>The <strong>Shapiro‚ÄìWilk test</strong> is a test of <a href="Normality_test" title="wikilink">normality</a> in frequentist <a class="uri" href="statistics" title="wikilink">statistics</a>. It was published in 1965 by <a href="Samuel_Sanford_Shapiro" title="wikilink">Samuel Sanford Shapiro</a> and <a href="Martin_Wilk" title="wikilink">Martin Wilk</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="theory">Theory</h2>

<p>The Shapiro‚ÄìWilk test utilizes the <a href="null_hypothesis" title="wikilink">null hypothesis</a> principle to check whether a <a href="statistical_sample" title="wikilink">sample</a> <em>x</em><sub>1</sub>, ..., <em>x</em><sub><em>n</em></sub> came from a <a href="normal_distribution" title="wikilink">normally distributed</a> population. The <a href="test_statistic" title="wikilink">test statistic</a> is:</p>

<p>

<math display="block" id="Shapiro‚ÄìWilk_test:0">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mo>=</mo>
   <mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>x</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">‚àë</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mover accent="true">
         <mi>x</mi>
         <mo>¬Ø</mo>
        </mover>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>W</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¬Ø</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W={\left(\sum_{i=1}^{n}a_{i}x_{(i)}\right)^{2}\over\sum_{i=1}^{n}(x_{i}-%
\overline{x})^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Shapiro‚ÄìWilk_test:1">
 <semantics>
  <msub>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>i</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{(i)}
  </annotation>
 </semantics>
</math>

 (with parentheses enclosing the subscript index <em>i</em>) is the <em>i</em>th <a href="order_statistic" title="wikilink">order statistic</a>, i.e., the <em>i</em>th-smallest number in the sample;</li>
<li>

<math display="inline" id="Shapiro‚ÄìWilk_test:2">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo>¬Ø</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <mi mathvariant="normal">‚ãØ</mi>
      <mo>+</mo>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>/</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¬Ø</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚ãØ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{x}=\left(x_{1}+\cdots+x_{n}\right)/n
  </annotation>
 </semantics>
</math>

 is the sample mean;</li>
<li>the constants 

<math display="inline" id="Shapiro‚ÄìWilk_test:3">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>


 are given by<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Shapiro‚ÄìWilk_test:4">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">‚Ä¶</mi>
    <mo>,</mo>
    <msub>
     <mi>a</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi>m</mi>
      <mi>ùñ≥</mi>
     </msup>
     <msup>
      <mi>V</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>m</mi>
        <mi>ùñ≥</mi>
       </msup>
       <msup>
        <mi>V</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msup>
        <mi>V</mi>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mi>m</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-‚Ä¶</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>n</ci>
     </apply>
    </vector>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <ci>ùñ≥</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <ci>ùñ≥</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>V</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>V</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (a_{1},\dots,a_{n})={m^{\mathsf{T}}V^{-1}\over(m^{\mathsf{T}}V^{-1}V^{-1}m)^{1%
/2}}
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>where
</dd>
</dl>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Shapiro‚ÄìWilk_test:5">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>m</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">‚Ä¶</mi>
      <mo>,</mo>
      <msub>
       <mi>m</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>ùñ≥</mi>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
     </vector>
     <ci>ùñ≥</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=(m_{1},\dots,m_{n})^{\mathsf{T}}\,
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
</dl>
<dl>
<dd>and 

<math display="inline" id="Shapiro‚ÄìWilk_test:6">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">‚Ä¶</mi>
   <mo>,</mo>
   <msub>
    <mi>m</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-‚Ä¶</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>n</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1},\ldots,m_{n}
  </annotation>
 </semantics>
</math>

 are the <a href="expected_value" title="wikilink">expected values</a> of the <a href="order_statistic" title="wikilink">order statistics</a> of <a href="independent_and_identically_distributed_random_variables" title="wikilink">independent and identically distributed random variables</a> sampled from the standard normal distribution, and 

<math display="inline" id="Shapiro‚ÄìWilk_test:7">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 is the <a href="covariance_matrix" title="wikilink">covariance matrix</a> of those order statistics. The user may reject the null hypothesis if 

<math display="inline" id="Shapiro‚ÄìWilk_test:8">
 <semantics>
  <mi>W</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>W</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W
  </annotation>
 </semantics>
</math>


 is below a predetermined threshold.
</dd>
</dl>
<h2 id="interpretation">Interpretation</h2>

<p>The <a href="Statistical_hypothesis_testing" title="wikilink">null-hypothesis</a> of this test is that the population is normally distributed. Thus if the <a href="p-value" title="wikilink"><em>p</em>-value</a> is less than the chosen <a href="alpha_level" title="wikilink">alpha level</a>, then the null hypothesis is rejected and there is evidence that the data tested are not from a normally distributed population. In other words, the data are not normal. On the contrary, if the <em>p</em>-value is greater than the chosen alpha level, then the null hypothesis that the data came from a normally distributed population cannot be rejected. E.g. for an alpha level of 0.05, a data set with a <em>p</em>-value of 0.02 rejects the null hypothesis that the data are from a normally distributed population.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> However, since the test is biased by sample size,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> the test may be statistically significant from a normal distribution in any large samples. Thus a <a href="Q‚ÄìQ_plot" title="wikilink">Q‚ÄìQ plot</a> is required for verification in addition to the test.</p>
<h2 id="power-analysis">Power analysis</h2>

<p>Empirical testing<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> has found that Shapiro‚ÄìWilk has the best <a href="Statistical_power" title="wikilink">power</a> for a given <a href="Statistical_significance" title="wikilink">significance</a>, followed closely by Anderson‚ÄìDarling when comparing the Shapiro‚ÄìWilk, <a href="Kolmogorov‚ÄìSmirnov_test" title="wikilink">Kolmogorov‚ÄìSmirnov</a>, <a href="Lilliefors_test" title="wikilink">Lilliefors</a>, and <a href="Anderson‚ÄìDarling_test" title="wikilink">Anderson‚ÄìDarling</a> tests.</p>
<h2 id="approximation">Approximation</h2>

<p>Royston proposed an alternative method of calculating the coefficients vector by providing an algorithm for calculating values, which extended the sample size to 2000.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> This technique is used in several software packages including R,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Stata,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> SPSS and SAS.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Anderson‚ÄìDarling_test" title="wikilink">Anderson‚ÄìDarling test</a></li>
<li><a href="Cram√©r‚Äìvon_Mises_criterion" title="wikilink">Cram√©r‚Äìvon Mises criterion</a></li>
<li><a href="Kolmogorov‚ÄìSmirnov_test" title="wikilink">Kolmogorov‚ÄìSmirnov test</a></li>
<li><a href="Normal_probability_plot" title="wikilink">Normal probability plot</a></li>
<li><a href="Ryan‚ÄìJoiner_test" title="wikilink">Ryan‚ÄìJoiner test</a></li>
<li><a href="Watson_test" title="wikilink">Watson test</a></li>
<li><a href="Lilliefors_test" title="wikilink">Lilliefors test</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.answers.com/topic/samuel-sanford-shapiro">Samuel Sanford Shapiro</a></li>
<li><a href="http://lib.stat.cmu.edu/apstat/R94">Algorithm AS R94 (Shapiro Wilk) FORTRAN code</a></li>
<li><a href="http://cran.us.r-project.org/doc/manuals/R-intro.html#Examining-the-distribution-of-a-set-of-data">Exploratory analysis using the Shapiro‚ÄìWilk normality test in R</a></li>
</ul>

<p>"</p>

<p><a href="Category:Normality_tests" title="wikilink">Category:Normality tests</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"> p.¬†593<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
<li id="fn7"><a href="#fnref7">‚Ü©</a></li>
<li id="fn8"><a href="#fnref8">‚Ü©</a></li>
<li id="fn9"><a href="https://www.stata.com/manuals13/rswilk.pdf">Shapiro‚ÄìWilk and Shapiro‚ÄìFrancia tests for normality</a><a href="#fnref9">‚Ü©</a></li>
<li id="fn10"><a href="#fnref10">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

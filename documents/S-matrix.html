<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1949">S-matrix</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>S-matrix</h1>
<hr/>

<p>In <a class="uri" href="physics" title="wikilink">physics</a>, the <strong>S-matrix</strong> or <strong>scattering matrix</strong> relates the initial state and the final state of a physical system undergoing a <a href="scattering" title="wikilink">scattering process</a>. It is used in <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>, <a href="scattering_theory" title="wikilink">scattering theory</a> and <a href="quantum_field_theory" title="wikilink">quantum field theory</a>.</p>

<p>More formally, the S-matrix is defined as the <a href="unitary_matrix" title="wikilink">unitary matrix</a> connecting asymptotic particle states in the <a href="Hilbert_space" title="wikilink">Hilbert space</a> of physical states (<a href="scattering_channel" title="wikilink">scattering channels</a>). While the S-matrix may be defined for any background (<a class="uri" href="spacetime" title="wikilink">spacetime</a>) that is asymptotically solvable and has no <a href="event_horizon" title="wikilink">event horizons</a>, it has a simple form in the case of the <a href="Minkowski_space" title="wikilink">Minkowski space</a>. In this special case, the Hilbert space is a space of irreducible <a href="unitary_representation" title="wikilink">unitary representations</a> of the <a href="inhomogeneous_space" title="wikilink">inhomogeneous</a> <a href="Lorentz_group" title="wikilink">Lorentz group</a> (the <a href="Poincaré_group" title="wikilink">Poincaré group</a>); the S-matrix is the <a href="evolution_operator" title="wikilink">evolution operator</a> between time equal to minus infinity (the distant past), and time equal to plus infinity (the distant future). It is defined only in the limit of zero energy density (or infinite particle separation distance).</p>

<p>It can be shown that if a quantum field theory in Minkowski space has a <a href="mass_gap" title="wikilink">mass gap</a>, the <a href="quantum_state" title="wikilink">state</a> in the asymptotic past and in the asymptotic future are both described by <a href="Fock_space" title="wikilink">Fock spaces</a>.</p>
<h2 id="history">History</h2>

<p>The S-matrix was first introduced by <a href="John_Archibald_Wheeler" title="wikilink">John Archibald Wheeler</a> in the 1937 paper "'On the Mathematical Description of Light Nuclei by the Method of Resonating Group Structure'".<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In this paper Wheeler introduced a <em>scattering matrix</em> – a unitary matrix of coefficients connecting "the asymptotic behaviour of an arbitrary particular solution [of the integral equations] with that of solutions of a standard form",<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> but did not develop it fully.</p>

<p>In the 1940s, <a href="Werner_Heisenberg" title="wikilink">Werner Heisenberg</a> developed, independently, and substantiated the idea of the S-matrix. Because of the problematic divergences present in <a href="quantum_field_theory" title="wikilink">quantum field theory</a> at that time, Heisenberg was motivated to isolate the <em>essential features of the theory</em> that would not be affected by future changes as the theory developed. In doing so, he was led to introduce a unitary "characteristic" S-matrix.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>After World War II, the clout of Heisenberg and his attachment to the <a href="S-matrix_theory" title="wikilink">S-matrix approach</a> may well have slowed down development of alternative approaches, such as <a href="quantum_field_theory" title="wikilink">quantum field theory</a> and the closer study of sub-hadronic physics for a decade or more, at least in Europe: <em>"Pretty much like medieval Scholastic Magisters were extremely inventive in defending the Church Dogmas and blocking the way to experimental science, some great minds in the sixties developed the S-Matrix dogma with great perfection and skill before it was buried down in the seventies after discovery of quarks and asymptotic freedom"</em> <a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Today, however, <strong>exact S-matrix results</strong> are a crowning achievement of <a href="Conformal_field_theory" title="wikilink">Conformal field theory</a>, <a href="Integrable_systems" title="wikilink">Integrable systems</a>, and several further areas of <a href="quantum_field_theory" title="wikilink">quantum field theory</a> and <a href="string_theory" title="wikilink">string theory</a>. S-matrices are not substitutes for a field-theoretic treatment, but rather, complements and the end results of such.</p>
<h2 id="motivation">Motivation</h2>

<p>In high-energy <a href="particle_physics" title="wikilink">particle physics</a> we are interested in computing the <a class="uri" href="probability" title="wikilink">probability</a> for different outcomes in <a class="uri" href="scattering" title="wikilink">scattering</a> experiments. These experiments can be broken down into three stages:</p>

<p>1. Collide together a collection of incoming <a href="subatomic_particle" title="wikilink">particles</a> (usually <em>two</em> particles with high energies).</p>

<p>2. Allowing the incoming particles to interact. These interactions may change the types of particles present (e.g. if an <a class="uri" href="electron" title="wikilink">electron</a> and a <a class="uri" href="positron" title="wikilink">positron</a> <a class="uri" href="annihilate" title="wikilink">annihilate</a> they may produce two <a href="photon" title="wikilink">photons</a>).</p>

<p>3. Measuring the resulting outgoing particles.</p>

<p>The process by which the incoming particles are transformed (through their <a class="uri" href="interaction" title="wikilink">interaction</a>) into the outgoing particles is called <a class="uri" href="scattering" title="wikilink">scattering</a>. For particle physics, a physical theory of these processes must be able to compute the probability for different outgoing particles when different incoming particles collide with different energies.</p>

<p>The S-matrix in <a href="quantum_field_theory" title="wikilink">quantum field theory</a> achieves exactly this. It is assumed that the small-energy-density approximation is valid in these cases.</p>
<h2 id="use-of-s-matrices">Use of S-matrices</h2>

<p>The S-matrix is closely related to the transition <a href="probability_amplitude" title="wikilink">probability amplitude</a> in quantum mechanics and to <a href="cross_section_(physics)" title="wikilink">cross sections</a> of various interactions; the <a href="matrix_element" title="wikilink">elements</a> (individual numerical entries) in the S-matrix are known as <strong>scattering amplitudes</strong>. <a href="pole_(complex_analysis)" title="wikilink">Poles</a> of the S-matrix in the complex-energy plane are identified with <a href="bound_state" title="wikilink">bound states</a>, virtual states or <a href="resonance_(particle_physics)" title="wikilink">resonances</a>. <a href="Branch_point" title="wikilink">Branch cuts</a> of the S-matrix in the complex-energy plane are associated to the opening of a <a href="scattering_channel" title="wikilink">scattering channel</a>.</p>

<p>In the <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> approach to <a href="quantum_field_theory" title="wikilink">quantum field theory</a>, the S-matrix may be calculated as a <a class="uri" href="time-ordered" title="wikilink">time-ordered</a> <a href="matrix_exponential" title="wikilink">exponential</a> of the integrated Hamiltonian in the <a href="interaction_picture" title="wikilink">interaction picture</a>; it may also be expressed using <a href="Feynman's_path_integral" title="wikilink">Feynman's path integrals</a>. In both cases, the <a href="perturbation_theory_(quantum_mechanics)" title="wikilink">perturbative</a> calculation of the S-matrix leads to <a href="Feynman_diagram" title="wikilink">Feynman diagrams</a>.</p>

<p>In <a href="scattering_theory" title="wikilink">scattering theory</a>, the <strong>S-matrix</strong> is an <a href="operator_(physics)" title="wikilink">operator</a> mapping free particle <em>in-states</em> to free particle <em>out-states</em> (<a href="scattering_channel" title="wikilink">scattering channels</a>) in the <a href="Heisenberg_picture" title="wikilink">Heisenberg picture</a>. This is very useful because often we cannot describe the interaction (at least, not the most interesting ones) exactly.</p>
<h2 id="s-matrix-in-one-dimensional-quantum-mechanics">S-matrix in one-dimensional quantum mechanics</h2>

<p>A simple prototype in which the S-matrix is 2-dimensional is considered first, for the purposes of illustration. In it, particles with sharp energy 

<math display="inline" id="S-matrix:0">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 scatter from a localized potential 

<math display="inline" id="S-matrix:1">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 according to the rules of 1-dimensional quantum mechanics. Already this simple model displays some features of more general cases, but is easier to handle.</p>

<p>Each energy 

<math display="inline" id="S-matrix:2">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 yields an S-matrix 

<math display="inline" id="S-matrix:3">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>E</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>E</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=S(E)
  </annotation>
 </semantics>
</math>

 that depends on 

<math display="inline" id="S-matrix:4">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

. Thus, the total S-matrix could, figuratively speaking, be visualized, in a suitable basis, as a "continuous matrix" with every element zero except for 

<math display="inline" id="S-matrix:5">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi mathvariant="normal">×</mi>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>normal-×</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2×2
  </annotation>
 </semantics>
</math>

-blocks along the diagonal for a given 

<math display="inline" id="S-matrix:6">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="definition">Definition</h3>

<p>Consider a localized one dimensional <a href="potential_barrier" title="wikilink">potential barrier</a> 

<math display="inline" id="S-matrix:7">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(x)
  </annotation>
 </semantics>
</math>

, subjected to a beam of quantum particles with energy 

<math display="inline" id="S-matrix:8">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

. These particles incident on the potential barrier from left and right.</p>

<p>The solution of <a href="Schrödinger's_equation" title="wikilink">Schrödinger's equation</a> outside the potential barrier are <a href="plane_waves" title="wikilink">plane waves</a> given by</p>

<p>

<math display="block" id="S-matrix:9">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ψ</mi>
     <mi>L</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>x</mi>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>B</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ψ</ci>
      <ci>L</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi_{L}(x)=Ae^{ikx}+Be^{-ikx}
  </annotation>
 </semantics>
</math>

 for the region to the left of the potential barrier, and</p>

<p>

<math display="block" id="S-matrix:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ψ</mi>
     <mi>R</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>C</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>x</mi>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>D</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ψ</ci>
      <ci>R</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>D</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi_{R}(x)=Ce^{ikx}+De^{-ikx}
  </annotation>
 </semantics>
</math>

 for the region to the right to the potential barrier, where</p>

<p>

<math display="block" id="S-matrix:11">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
      <mi>E</mi>
     </mrow>
     <mo>/</mo>
     <msup>
      <mi mathvariant="normal">ℏ</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
       <ci>E</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=\sqrt{2mE/\hbar^{2}}
  </annotation>
 </semantics>
</math>

 is the <a href="wave_vector" title="wikilink">wave vector</a>. The time dependence is not needed and is hence omitted. The term with coefficient 

<math display="inline" id="S-matrix:12">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 represents the incoming wave, whereas term with coefficient 

<math display="inline" id="S-matrix:13">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 represents the outgoing wave. 

<math display="inline" id="S-matrix:14">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 stands for the reflecting wave, and 

<math display="inline" id="S-matrix:15">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 could be omitted if we set the incoming wave as the positive direction.</p>

<p>The "scattering amplitude", i.e., the transition overlap of the outgoing waves with the incoming waves is a linear relation defining the S-matrix,</p>

<p>

<math display="block" id="S-matrix:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>B</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>C</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>S</mi>
          <mn>11</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>S</mi>
          <mn>12</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>S</mi>
          <mn>21</mn>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>S</mi>
          <mn>22</mn>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mi>A</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>D</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <ci>B</ci>
     </matrixrow>
     <matrixrow>
      <ci>C</ci>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">11</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">12</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">21</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">22</cn>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <ci>A</ci>
      </matrixrow>
      <matrixrow>
       <ci>D</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}B\\
C\end{pmatrix}=\begin{pmatrix}S_{11}&S_{12}\\
S_{21}&S_{22}\end{pmatrix}\begin{pmatrix}A\\
D\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>The above relation can be written as</p>

<p>

<math display="block" id="S-matrix:17">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Ψ</mi>
    <mrow>
     <mi>o</mi>
     <mi>u</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>S</mi>
    <msub>
     <mi mathvariant="normal">Ψ</mi>
     <mrow>
      <mi>i</mi>
      <mi>n</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Ψ</ci>
     <apply>
      <times></times>
      <ci>o</ci>
      <ci>u</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{out}=S\Psi_{in}
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="S-matrix:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mi>o</mi>
       <mi>u</mi>
       <mi>t</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mi>B</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>C</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <msub>
       <mi mathvariant="normal">Ψ</mi>
       <mrow>
        <mi>i</mi>
        <mi>n</mi>
       </mrow>
      </msub>
      <mo>=</mo>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mi>A</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi>D</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo rspace="22.5pt">,</mo>
     <mrow>
      <mi>S</mi>
      <mo>=</mo>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>S</mi>
           <mn>11</mn>
          </msub>
         </mtd>
         <mtd columnalign="center">
          <msub>
           <mi>S</mi>
           <mn>12</mn>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>S</mi>
           <mn>21</mn>
          </msub>
         </mtd>
         <mtd columnalign="center">
          <msub>
           <mi>S</mi>
           <mn>22</mn>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <apply>
       <times></times>
       <ci>o</ci>
       <ci>u</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <ci>B</ci>
      </matrixrow>
      <matrixrow>
       <ci>C</ci>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <ci>A</ci>
       </matrixrow>
       <matrixrow>
        <ci>D</ci>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <eq></eq>
      <ci>S</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">11</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">12</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">21</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <cn type="integer">22</cn>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{out}=\begin{pmatrix}B\\
C\end{pmatrix},\quad\Psi_{in}=\begin{pmatrix}A\\
D\end{pmatrix},\qquad S=\begin{pmatrix}S_{11}&S_{12}\\
S_{21}&S_{22}\end{pmatrix}.
  </annotation>
 </semantics>
</math>

 The elements of 

<math display="inline" id="S-matrix:19">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 completely characterize the scattering properties of the potential barrier 

<math display="inline" id="S-matrix:20">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(x)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="unitary-property-of-s-matrix">Unitary property of S-matrix</h3>

<p>The unitary property of S-matrix is directly related to the conservation of the <a href="probability_current" title="wikilink">probability current</a> in <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>.</p>

<p>The probability current 

<math display="inline" id="S-matrix:21">
 <semantics>
  <mi>J</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>J</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J
  </annotation>
 </semantics>
</math>

 of the <a href="wave_function" title="wikilink">wave function</a> 

<math display="inline" id="S-matrix:22">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ψ</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ψ(x)
  </annotation>
 </semantics>
</math>

 is defined as</p>

<p>

<math display="block" id="S-matrix:23">
 <semantics>
  <mrow>
   <mi>J</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mi mathvariant="normal">ℏ</mi>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
      <mi>i</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <msup>
        <mi>ψ</mi>
        <mo>*</mo>
       </msup>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>ψ</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>x</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>ψ</mi>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <msup>
          <mi>ψ</mi>
          <mo>*</mo>
         </msup>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>x</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>J</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>ψ</ci>
        <times></times>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>ψ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>ψ</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>ψ</ci>
          <times></times>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J=\frac{\hbar}{2mi}\left(\psi^{*}\frac{\partial\psi}{\partial x}-\psi\frac{%
\partial\psi^{*}}{\partial x}\right)
  </annotation>
 </semantics>
</math>

. The current density to the left of the barrier is</p>

<p>

<math display="block" id="S-matrix:24">
 <semantics>
  <mrow>
   <msub>
    <mi>J</mi>
    <mi>L</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi mathvariant="normal">ℏ</mi>
      <mi>k</mi>
     </mrow>
     <mi>m</mi>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>A</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>B</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <ci>L</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <ci>k</ci>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>A</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>B</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{L}=\frac{\hbar k}{m}\left(|A|^{2}-|B|^{2}\right)
  </annotation>
 </semantics>
</math>

, while the current density to the right of the barrier is</p>

<p>

<math display="block" id="S-matrix:25">
 <semantics>
  <mrow>
   <msub>
    <mi>J</mi>
    <mi>R</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi mathvariant="normal">ℏ</mi>
      <mi>k</mi>
     </mrow>
     <mi>m</mi>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>C</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>-</mo>
      <msup>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>D</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <ci>R</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <ci>k</ci>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>C</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>D</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{R}=\frac{\hbar k}{m}\left(|C|^{2}-|D|^{2}\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>For conservation of the probability current density, <mtpl> <em>J</em><sub><em>R</em></sub>}}</mtpl>. This implies the S-matrix is a <a href="unitary_matrix" title="wikilink">unitary matrix</a>.</p>
<dl>
<dd>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Proof</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="inline" id="S-matrix:26">
 <semantics>
  <mtable>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <msub>
       <mi>J</mi>
       <mi>L</mi>
      </msub>
      <mo>=</mo>
      <msub>
       <mi>J</mi>
       <mi>R</mi>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>A</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>B</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>=</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>C</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>-</mo>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>D</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>B</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>C</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>=</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>A</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mrow>
         <mo stretchy="false">|</mo>
         <mi>D</mi>
         <mo stretchy="false">|</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>o</mi>
         <mi>u</mi>
         <mi>t</mi>
        </mrow>
        <mo>†</mo>
       </msubsup>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>o</mi>
         <mi>u</mi>
         <mi>t</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>=</mo>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
        <mo>†</mo>
       </msubsup>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
        <mo>†</mo>
       </msubsup>
       <msup>
        <mi>S</mi>
        <mo>†</mo>
       </msup>
       <mi>S</mi>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>=</mo>
      <mrow>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
        <mo>†</mo>
       </msubsup>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mrow>
         <mi>i</mi>
         <mi>n</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <msup>
        <mi>S</mi>
        <mo>†</mo>
       </msup>
       <mi>S</mi>
      </mrow>
      <mo>=</mo>
      <mi>I</mi>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>J</ci>
       <ci>L</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>J</ci>
       <ci>R</ci>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>A</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>B</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>C</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>D</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>B</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>C</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>A</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <ci>D</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <apply>
          <times></times>
          <ci>o</ci>
          <ci>u</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <apply>
         <times></times>
         <ci>o</ci>
         <ci>u</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>S</ci>
        <ci>normal-†</ci>
       </apply>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>S</ci>
        <ci>normal-†</ci>
       </apply>
       <ci>S</ci>
      </apply>
      <ci>I</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}&\displaystyle J_{L}=J_{R}\\
&\displaystyle|A|^{2}-|B|^{2}=|C|^{2}-|D|^{2}\\
&\displaystyle|B|^{2}+|C|^{2}=|A|^{2}+|D|^{2}\\
&\displaystyle\Psi_{out}^{\dagger}\Psi_{out}=\Psi_{in}^{\dagger}\Psi_{in}\\
&\displaystyle\Psi_{in}^{\dagger}S^{\dagger}S\Psi_{in}=\Psi_{in}^{\dagger}\Psi%
_{in}\\
&\displaystyle S^{\dagger}S=I\\
\end{aligned}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<h3 id="time-reversal-symmetry">Time-reversal symmetry</h3>

<p>If the potential 

<math display="inline" id="S-matrix:27">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(x)
  </annotation>
 </semantics>
</math>

 is real,then the system possesses <a href="time-reversal_symmetry" title="wikilink">time-reversal symmetry</a>. Under this condition, if 

<math display="inline" id="S-matrix:28">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ψ</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ψ(x)
  </annotation>
 </semantics>
</math>

 is a solution of Schrödinger's equation, then 

<math display="inline" id="S-matrix:29">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mo>*</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ψ</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ψ*(x)
  </annotation>
 </semantics>
</math>

 is also a solution.</p>

<p>The time-reversed solution is given by</p>

<p>

<math display="block" id="S-matrix:30">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>ψ</mi>
     <mi>L</mi>
     <mo>*</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>A</mi>
      <mo>*</mo>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>B</mi>
      <mo>*</mo>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>x</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ψ</ci>
       <times></times>
      </apply>
      <ci>L</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi^{*}_{L}(x)=A^{*}e^{-ikx}+B^{*}e^{ikx}
  </annotation>
 </semantics>
</math>

 for the region to the left to the potential barrier, and</p>

<p>

<math display="block" id="S-matrix:31">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>ψ</mi>
     <mi>R</mi>
     <mo>*</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>C</mi>
      <mo>*</mo>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>D</mi>
      <mo>*</mo>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>k</mi>
       <mi>x</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>ψ</ci>
       <times></times>
      </apply>
      <ci>R</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>C</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>k</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <times></times>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi^{*}_{R}(x)=C^{*}e^{-ikx}+D^{*}e^{ikx}
  </annotation>
 </semantics>
</math>

 for the region to the right to the potential barrier, where the terms with coefficient 

<math display="inline" id="S-matrix:32">
 <semantics>
  <mrow>
   <mi>B</mi>
   <mo>*</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">B</csymbol>
    <times></times>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B*
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="S-matrix:33">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>*</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">C</csymbol>
    <times></times>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C*
  </annotation>
 </semantics>
</math>

 represent incoming wave, and terms with coefficient 

<math display="inline" id="S-matrix:34">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>*</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">A</csymbol>
    <times></times>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A*
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="S-matrix:35">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>*</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">D</csymbol>
    <times></times>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D*
  </annotation>
 </semantics>
</math>

 represent outgoing wave.</p>

<p>They are again related by the S-matrix,</p>

<p>

<math display="block" id="S-matrix:36">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <msup>
        <mi>A</mi>
        <mo>*</mo>
       </msup>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <msup>
        <mi>D</mi>
        <mo>*</mo>
       </msup>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>S</mi>
         <mn>11</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>S</mi>
         <mn>12</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>S</mi>
         <mn>21</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>S</mi>
         <mn>22</mn>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mpadded width="+1.7pt">
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msup>
          <mi>B</mi>
          <mo>*</mo>
         </msup>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msup>
          <mi>C</mi>
          <mo>*</mo>
         </msup>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <matrix>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <times></times>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>D</ci>
       <times></times>
      </apply>
     </matrixrow>
    </matrix>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">11</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">12</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">21</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">22</cn>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <times></times>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>C</ci>
        <times></times>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}A^{*}\\
D^{*}\end{pmatrix}=\begin{pmatrix}S_{11}&S_{12}\\
S_{21}&S_{22}\end{pmatrix}\begin{pmatrix}B^{*}\\
C^{*}\end{pmatrix}\,
  </annotation>
 </semantics>
</math>

 that is,<br/>


<math display="block" id="S-matrix:37">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mrow>
      <mi>i</mi>
      <mi>n</mi>
     </mrow>
     <mo>*</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mi>S</mi>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mi>o</mi>
       <mi>u</mi>
       <mi>t</mi>
      </mrow>
      <mo>*</mo>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-Ψ</ci>
      <times></times>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Ψ</ci>
       <times></times>
      </apply>
      <apply>
       <times></times>
       <ci>o</ci>
       <ci>u</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi^{*}_{in}=S\Psi^{*}_{out}.
  </annotation>
 </semantics>
</math>

 Now, the relations</p>

<p>

<math display="block" id="S-matrix:38">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mrow>
      <mi>i</mi>
      <mi>n</mi>
     </mrow>
     <mo>*</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mi>S</mi>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mi>o</mi>
       <mi>u</mi>
       <mi>t</mi>
      </mrow>
      <mo>*</mo>
     </msubsup>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <msub>
     <mi mathvariant="normal">Ψ</mi>
     <mrow>
      <mi>o</mi>
      <mi>u</mi>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>S</mi>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mi>i</mi>
       <mi>n</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-Ψ</ci>
       <times></times>
      </apply>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>normal-Ψ</ci>
        <times></times>
       </apply>
       <apply>
        <times></times>
        <ci>o</ci>
        <ci>u</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <apply>
       <times></times>
       <ci>o</ci>
       <ci>u</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi^{*}_{in}=S\Psi^{*}_{out},\quad\Psi_{out}=S\Psi_{in}
  </annotation>
 </semantics>
</math>

 together yield a condition</p>

<p>

<math display="block" id="S-matrix:39">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>S</mi>
     <mo>*</mo>
    </msup>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mi>I</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>S</ci>
      <times></times>
     </apply>
     <ci>S</ci>
    </apply>
    <ci>I</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S^{*}S=I
  </annotation>
 </semantics>
</math>

 This condition, in conjunction with the unitarity relation, implies that the S-matrix is symmetric, as a result of time reversal symmetry,</p>

<p>

<math display="block" id="S-matrix:40">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>S</mi>
     <mi>T</mi>
    </msup>
    <mo>=</mo>
    <mi>S</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>S</ci>
     <ci>T</ci>
    </apply>
    <ci>S</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S^{T}=S.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="transmission-coefficient-and-reflection-coefficient">Transmission coefficient and Reflection coefficient</h3>

<p>The <a href="transmission_coefficient" title="wikilink">transmission coefficient</a> from the left of the potential barrier is, when 

<math display="inline" id="S-matrix:41">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=0
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="S-matrix:42">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>L</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>C</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>A</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>S</mi>
       <mn>21</mn>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>L</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>C</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>A</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">21</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{L}=\frac{|C|^{2}}{|A|^{2}}=|S_{21}|^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="reflection_coefficient" title="wikilink">reflection coefficient</a> from the left of the potential barrier is, when 

<math display="inline" id="S-matrix:43">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>D</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D=0
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="S-matrix:44">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi>L</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>B</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>A</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>S</mi>
       <mn>11</mn>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>L</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>B</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>A</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">11</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{L}=\frac{|B|^{2}}{|A|^{2}}=|S_{11}|^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Similarly, the transmission coefficient from the right of the potential barrier is, when 

<math display="inline" id="S-matrix:45">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=0
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="S-matrix:46">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>R</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>B</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>D</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>S</mi>
       <mn>12</mn>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>R</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>B</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>D</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">12</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{R}=\frac{|B|^{2}}{|D|^{2}}=|S_{12}|^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The reflection coefficient from the right of the potential barrier is, when 

<math display="inline" id="S-matrix:47">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=0
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="S-matrix:48">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi>R</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>C</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>D</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>S</mi>
       <mn>22</mn>
      </msub>
      <mo stretchy="false">|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>R</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>C</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>D</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">22</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{R}=\frac{|C|^{2}}{|D|^{2}}=|S_{22}|^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The relations between the transmission and reflection coefficients are</p>

<p>

<math display="block" id="S-matrix:49">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>L</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>R</mi>
     <mi>L</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>L</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>L</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{L}+R_{L}=1
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="S-matrix:50">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>R</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>R</mi>
     <mi>R</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>R</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>R</ci>
     </apply>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{R}+R_{R}=1.
  </annotation>
 </semantics>
</math>

 This is a consequence of the unitarity property of the S-matrix.</p>
<h3 id="optical-theorem-in-one-dimension">Optical theorem in one dimension</h3>

<p>In the case of <a href="free_particle" title="wikilink">free particles</a> 

<math display="inline" id="S-matrix:51">
 <semantics>
  <mrow>
   <mrow>
    <mi>V</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>V</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(x)=0
  </annotation>
 </semantics>
</math>

, the S-matrix is<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>

<math display="block" id="S-matrix:52">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\begin{pmatrix}0&1\\
1&0\end{pmatrix}.
  </annotation>
 </semantics>
</math>

 Whenever 

<math display="inline" id="S-matrix:53">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(x)
  </annotation>
 </semantics>
</math>

 is different from zero, however, there is a departure of the S-matrix from the above form, to</p>

<p>

<math display="block" id="S-matrix:54">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>2</mn>
         <mi>i</mi>
         <mi>r</mi>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>i</mi>
          <mi>t</mi>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>i</mi>
          <mi>t</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>2</mn>
         <mi>i</mi>
         <msup>
          <mi>r</mi>
          <mo>*</mo>
         </msup>
         <mstyle displaystyle="false">
          <mfrac>
           <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mrow>
             <mn>2</mn>
             <mi>i</mi>
             <mi>t</mi>
            </mrow>
           </mrow>
           <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mrow>
             <mn>2</mn>
             <mi>i</mi>
             <msup>
              <mi>t</mi>
              <mo>*</mo>
             </msup>
            </mrow>
           </mrow>
          </mfrac>
         </mstyle>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <matrix>
     <matrixrow>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>i</ci>
       <ci>r</ci>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>i</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <times></times>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>i</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>i</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>t</ci>
           <times></times>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\begin{pmatrix}2ir&1+2it\\
1+2it&2ir^{*}\frac{1+2it}{1-2it^{*}}\end{pmatrix}.
  </annotation>
 </semantics>
</math>

 This departure is parameterized by two <a href="complex_functions" title="wikilink">complex functions</a> of energy, 

<math display="inline" id="S-matrix:55">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="S-matrix:56">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

. From unitarity there also follows a relationship between these two functions,</p>

<p>

<math display="block" id="S-matrix:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>r</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>t</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>Im</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <ci>r</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <abs></abs>
       <ci>t</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <ci>Im</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |r|^{2}+|t|^{2}=\operatorname{Im}(t).
  </annotation>
 </semantics>
</math>

</p>

<p>The analogue of this identity in three dimensions is known as the <a href="optical_theorem" title="wikilink">optical theorem</a>.</p>
<h2 id="definition-in-quantum-field-theory">Definition in quantum field theory</h2>
<h3 id="interaction-picture">Interaction picture</h3>

<p>A straightforward way to define the S-matrix begins with considering the <a href="interaction_picture" title="wikilink">interaction picture</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Let the Hamiltonian 

<math display="inline" id="S-matrix:58">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 be split into the free part <mtpl></mtpl> and the interaction 

<math display="inline" id="S-matrix:59">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, <mtpl> <em>H</em><sub>0</sub> + <em>V</em>}}</mtpl>. In this picture, the operators behave as free field operators and the state vectors have dynamics according to the interaction 

<math display="inline" id="S-matrix:60">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

. Let</p>

<p>

<math display="block" id="S-matrix:61">
 <semantics>
  <mrow>
   <mo fence="true">|</mo>
   <mrow>
    <mi mathvariant="normal">Ψ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <times></times>
     <ci>normal-Ψ</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\Psi(t)\right\rangle
  </annotation>
 </semantics>
</math>

 denote a state that has evolved from a free initial state</p>

<p>

<math display="block" id="S-matrix:62">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true">|</mo>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mi>i</mi>
    </msub>
    <mo>⟩</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Φ</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\Phi_{i}\right\rangle.
  </annotation>
 </semantics>
</math>

 The S-matrix element is then defined as the projection of this state on the final state</p>

<p>

<math display="block" id="S-matrix:63">
 <semantics>
  <mrow>
   <mrow>
    <mo>⟨</mo>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mi>f</mi>
    </msub>
    <mo fence="true">|</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">bra</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Φ</ci>
     <ci>f</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\Phi_{f}\right|.
  </annotation>
 </semantics>
</math>

 Thus</p>

<p>

<math display="block" id="S-matrix:64">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>f</mi>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo>≡</mo>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <mi>t</mi>
       <mo>→</mo>
       <mrow>
        <mo>+</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
      </mrow>
     </munder>
     <mrow>
      <mo>⟨</mo>
      <msub>
       <mi mathvariant="normal">Φ</mi>
       <mi>f</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi mathvariant="normal">Ψ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>t</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⟩</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mo>⟨</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>f</mi>
     </msub>
     <mo fence="true">|</mo>
     <mi>S</mi>
     <mo fence="true">|</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>i</mi>
     </msub>
     <mo>⟩</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <equivalent></equivalent>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-→</ci>
        <ci>t</ci>
        <apply>
         <plus></plus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">inner-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Φ</ci>
        <ci>f</ci>
       </apply>
       <apply>
        <times></times>
        <ci>normal-Ψ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>f</ci>
      </apply>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{fi}\equiv\lim_{t\rightarrow+\infty}\left\langle\Phi_{f}|\Psi(t)\right%
\rangle\equiv\left\langle\Phi_{f}\right|S\left|\Phi_{i}\right\rangle,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="S-matrix:65">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 is the <strong>S-operator</strong>. The great advantage of this definition is that the <strong>time-evolution operator</strong> 

<math display="inline" id="S-matrix:66">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 evolving a state in the interaction picture is formally known,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>

<math display="block" id="S-matrix:67">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>U</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo>,</mo>
      <msub>
       <mi>t</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>T</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mrow>
         <mstyle displaystyle="false">
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <msub>
            <mi>t</mi>
            <mn>0</mn>
           </msub>
           <mi>t</mi>
          </msubsup>
         </mstyle>
         <mrow>
          <mi>d</mi>
          <mi>τ</mi>
          <mi>V</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>τ</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <interval closure="open">
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>t</ci>
       <cn type="integer">0</cn>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>t</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <ci>t</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>τ</ci>
          <ci>V</ci>
          <ci>τ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(t,t_{0})=Te^{-i\int_{t_{0}}^{t}d\tau V(\tau)},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="S-matrix:68">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 denotes the <a href="time-ordered_product" title="wikilink">time-ordered product</a>. Expressed in this operator,</p>

<p>

<math display="block" id="S-matrix:69">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>f</mi>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <msub>
        <mi>t</mi>
        <mn>2</mn>
       </msub>
       <mo>→</mo>
       <mrow>
        <mo>+</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
      </mrow>
     </munder>
     <mrow>
      <munder>
       <mo movablelimits="false">lim</mo>
       <mrow>
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
        <mo>→</mo>
        <mrow>
         <mo>-</mo>
         <mi mathvariant="normal">∞</mi>
        </mrow>
       </mrow>
      </munder>
      <mrow>
       <mo>⟨</mo>
       <msub>
        <mi mathvariant="normal">Φ</mi>
        <mi>f</mi>
       </msub>
       <mo fence="true">|</mo>
       <mrow>
        <mi>U</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>t</mi>
          <mn>2</mn>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>t</mi>
          <mn>1</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo fence="true">|</mo>
       <msub>
        <mi mathvariant="normal">Φ</mi>
        <mi>i</mi>
       </msub>
       <mo>⟩</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <infinity></infinity>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-→</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Φ</ci>
        <ci>f</ci>
       </apply>
       <apply>
        <times></times>
        <ci>U</ci>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>t</ci>
          <cn type="integer">1</cn>
         </apply>
        </interval>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Φ</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{fi}=\lim_{t_{2}\rightarrow+\infty}\lim_{t_{1}\rightarrow-\infty}\left%
\langle\Phi_{f}\right|U(t_{2},t_{1})\left|\Phi_{i}\right\rangle,
  </annotation>
 </semantics>
</math>

 from which</p>

<p>

<math display="block" id="S-matrix:70">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <mi>U</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">∞</mi>
      <mo>,</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <ci>U</ci>
     <interval closure="open">
      <infinity></infinity>
      <apply>
       <minus></minus>
       <infinity></infinity>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=U(\infty,-\infty).
  </annotation>
 </semantics>
</math>

 Using the knowledge about 

<math display="inline" id="S-matrix:71">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="S-matrix:72">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mi>i</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <mo>-</mo>
         <mi mathvariant="normal">∞</mi>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </msubsup>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
        <mi mathvariant="normal">⋯</mi>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mo>-</mo>
           <mi mathvariant="normal">∞</mi>
          </mrow>
          <mi mathvariant="normal">∞</mi>
         </msubsup>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>t</mi>
           <mi>n</mi>
          </msub>
          <mi>T</mi>
          <mrow>
           <mo>[</mo>
           <mrow>
            <mi>V</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi mathvariant="normal">⋯</mi>
            <mi>V</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>t</mi>
              <mi>n</mi>
             </msub>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mo>]</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>i</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <minus></minus>
          <infinity></infinity>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <minus></minus>
            <infinity></infinity>
           </apply>
          </apply>
          <infinity></infinity>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>t</ci>
           <ci>n</ci>
          </apply>
          <ci>T</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <times></times>
            <ci>V</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">1</cn>
            </apply>
            <ci>normal-⋯</ci>
            <ci>V</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <ci>n</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\sum_{n=0}^{\infty}\frac{(-i)^{n}}{n!}\int_{-\infty}^{\infty}dt_{1}\cdots%
\int_{-\infty}^{\infty}dt_{n}T\left[V(t_{1})\cdots V(t_{n})\right],
  </annotation>
 </semantics>
</math>

 or, if 

<math display="inline" id="S-matrix:73">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 comes as a Hamiltonian density,</p>

<p>

<math display="block" id="S-matrix:74">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mi>i</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <mo>-</mo>
         <mi mathvariant="normal">∞</mi>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </msubsup>
       <mrow>
        <mi>d</mi>
        <msubsup>
         <mi>x</mi>
         <mn>1</mn>
         <mn>4</mn>
        </msubsup>
        <mi mathvariant="normal">⋯</mi>
        <mrow>
         <msubsup>
          <mo largeop="true" symmetric="true">∫</mo>
          <mrow>
           <mo>-</mo>
           <mi mathvariant="normal">∞</mi>
          </mrow>
          <mi mathvariant="normal">∞</mi>
         </msubsup>
         <mrow>
          <mi>d</mi>
          <msubsup>
           <mi>x</mi>
           <mi>n</mi>
           <mn>4</mn>
          </msubsup>
          <mi>T</mi>
          <mrow>
           <mo>[</mo>
           <mrow>
            <mi class="ltx_font_mathcaligraphic">ℋ</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>t</mi>
              <mn>1</mn>
             </msub>
             <mo stretchy="false">)</mo>
            </mrow>
            <mi mathvariant="normal">⋯</mi>
            <mi class="ltx_font_mathcaligraphic">ℋ</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <msub>
              <mi>t</mi>
              <mi>n</mi>
             </msub>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mo>]</mo>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>i</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <minus></minus>
          <infinity></infinity>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">4</cn>
        </apply>
        <ci>normal-⋯</ci>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <minus></minus>
            <infinity></infinity>
           </apply>
          </apply>
          <infinity></infinity>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>n</ci>
           </apply>
           <cn type="integer">4</cn>
          </apply>
          <ci>T</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <times></times>
            <ci>ℋ</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <cn type="integer">1</cn>
            </apply>
            <ci>normal-⋯</ci>
            <ci>ℋ</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>t</ci>
             <ci>n</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\sum_{n=0}^{\infty}\frac{(-i)^{n}}{n!}\int_{-\infty}^{\infty}dx_{1}^{4}%
\cdots\int_{-\infty}^{\infty}dx_{n}^{4}T\left[\mathcal{H}(t_{1})\cdots\mathcal%
{H}(t_{n})\right].
  </annotation>
 </semantics>
</math>

</p>

<p>Being a special type of time-evolution operator, 

<math display="inline" id="S-matrix:75">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 is unitary. For any initial state and any final state one finds</p>

<p>

<math display="block" id="S-matrix:76">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>f</mi>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>⟨</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>f</mi>
     </msub>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>i</mi>
     </msub>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>⟨</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>f</mi>
     </msub>
     <mo fence="true">|</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mi>i</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>n</mi>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
       <mrow>
        <msubsup>
         <mo largeop="true" symmetric="true">∫</mo>
         <mrow>
          <mo>-</mo>
          <mi mathvariant="normal">∞</mi>
         </mrow>
         <mi mathvariant="normal">∞</mi>
        </msubsup>
        <mrow>
         <mi>d</mi>
         <msubsup>
          <mi>x</mi>
          <mn>1</mn>
          <mn>4</mn>
         </msubsup>
         <mi mathvariant="normal">⋯</mi>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∫</mo>
           <mrow>
            <mo>-</mo>
            <mi mathvariant="normal">∞</mi>
           </mrow>
           <mi mathvariant="normal">∞</mi>
          </msubsup>
          <mrow>
           <mi>d</mi>
           <msubsup>
            <mi>x</mi>
            <mi>n</mi>
            <mn>4</mn>
           </msubsup>
           <mi>T</mi>
           <mrow>
            <mo>[</mo>
            <mrow>
             <mi class="ltx_font_mathcaligraphic">ℋ</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>t</mi>
               <mn>1</mn>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
             <mi mathvariant="normal">⋯</mi>
             <mi class="ltx_font_mathcaligraphic">ℋ</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <msub>
               <mi>t</mi>
               <mi>n</mi>
              </msub>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mo>]</mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo fence="true">|</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>i</mi>
     </msub>
     <mo>⟩</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>f</ci>
      </apply>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>f</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>n</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <ci>i</ci>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <int></int>
           <apply>
            <minus></minus>
            <infinity></infinity>
           </apply>
          </apply>
          <infinity></infinity>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <cn type="integer">1</cn>
           </apply>
           <cn type="integer">4</cn>
          </apply>
          <ci>normal-⋯</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <int></int>
             <apply>
              <minus></minus>
              <infinity></infinity>
             </apply>
            </apply>
            <infinity></infinity>
           </apply>
           <apply>
            <times></times>
            <ci>d</ci>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <ci>x</ci>
              <ci>n</ci>
             </apply>
             <cn type="integer">4</cn>
            </apply>
            <ci>T</ci>
            <apply>
             <csymbol cd="latexml">delimited-[]</csymbol>
             <apply>
              <times></times>
              <ci>ℋ</ci>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <cn type="integer">1</cn>
              </apply>
              <ci>normal-⋯</ci>
              <ci>ℋ</ci>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>t</ci>
               <ci>n</ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{fi}=\left\langle\Phi_{f}|S|\Phi_{i}\right\rangle=\left\langle\Phi_{f}\left|%
\sum_{n=0}^{\infty}\frac{(-i)^{n}}{n!}\int_{-\infty}^{\infty}dx_{1}^{4}\cdots%
\int_{-\infty}^{\infty}dx_{n}^{4}T\left[\mathcal{H}(t_{1})\cdots\mathcal{H}(t_%
{n})\right]\right|\Phi_{i}\right\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>This approach is somewhat naîve in that potential problems are swept under the carpet.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> This is intentional. The approach works in practice and some of the technical issues are addressed in the other sections.</p>
<h3 id="in-and-out-states">In and out states</h3>

<p>Here a slightly more rigorous approach is taken in order to address potential problems that were disregarded in the interaction picture approach of above. The final outcome is, of course, the same as when taking the quicker route. For this, the notions of in and out states are needed. These will be developed in two ways, from vacua, and from free particle states. Needless to say, the two approaches are equivalent, but they illuminate matters from different angles.</p>
<h4 id="from-vacua">From vacua</h4>

<p>If 

<math display="inline" id="S-matrix:77">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a(k)
  </annotation>
 </semantics>
</math>

<sup>†</sup> is a <a href="creation_operator" title="wikilink">creation operator</a>, its <a href="hermitian_adjoint" title="wikilink">hermitian adjoint</a> is an <a href="annihilation_operator" title="wikilink">annihilation operator</a> and destroys the vacuum,</p>

<p>

<math display="block" id="S-matrix:78">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true">|</mo>
     <mrow>
      <mo>*</mo>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
     <mo>⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>a</ci>
     <ci>k</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <times></times>
       <cn type="integer">0</cn>
      </list>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a(k)\left|*,0\right\rangle=0.
  </annotation>
 </semantics>
</math>

</p>

<p>In <a href="Dirac_notation" title="wikilink">Dirac notation</a>, define</p>

<p>

<math display="block" id="S-matrix:79">
 <semantics>
  <mrow>
   <mo fence="true" stretchy="false">|</mo>
   <mrow>
    <mo>*</mo>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <list>
     <times></times>
     <cn type="integer">0</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |*,0\rangle
  </annotation>
 </semantics>
</math>

 as a <a href="vacuum_state" title="wikilink">vacuum quantum state</a>, i.e. a state without real particles. The asterisk signifies that not all vacua are necessarily equal, and certainly not equal to the Hilbert space zero state 

<math display="inline" id="S-matrix:80">
 <semantics>
  <mn>0</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">0</cn>
  </annotation-xml>
 </semantics>
</math>

. All vacuum states are assumed <a href="Poincaré_group" title="wikilink">Poincaré invariant</a>, invariance under translations, rotations and boosts,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> formally,</p>

<p>

<math display="block" id="S-matrix:81">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>P</mi>
       <mi>μ</mi>
      </msup>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mo>*</mo>
        <mo>,</mo>
        <mn>0</mn>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>M</mi>
       <mrow>
        <mi>μ</mi>
        <mi>ν</mi>
       </mrow>
      </msup>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mo>*</mo>
        <mo>,</mo>
        <mn>0</mn>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <mrow>
       <mo>*</mo>
       <mo>,</mo>
       <mn>0</mn>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <ci>μ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <times></times>
        <cn type="integer">0</cn>
       </list>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>M</ci>
       <apply>
        <times></times>
        <ci>μ</ci>
        <ci>ν</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <times></times>
        <cn type="integer">0</cn>
       </list>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <times></times>
       <cn type="integer">0</cn>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P^{\mu}|*,0\rangle=0,\quad M^{\mu\nu}|*,0\rangle=|*,0\rangle,
  </annotation>
 </semantics>
</math>

 where <mtpl></mtpl> is the <strong>generator of translation</strong> in space and time, and <mtpl></mtpl> is the generator of <a href="Lorentz_transformation" title="wikilink">Lorentz transformations</a>. Thus the description of the vacuum is independent of the frame of reference. Associated to the in and out states to be defined are the in and out <strong>field operators</strong> (aka <strong>fields</strong>) <mtpl></mtpl> and <mtpl></mtpl>. Attention is here focused to the simplest case, that of a <strong>scalar theory</strong> in order to exemplify with the least possible cluttering of the notation. The in and out fields satisfy</p>

<p>

<math display="block" id="S-matrix:82">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi mathvariant="normal">□</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <msup>
        <mi>m</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ϕ</mi>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>o</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-□</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <list>
       <ci>i</ci>
       <ci>o</ci>
      </list>
     </apply>
     <ci>x</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\Box^{2}+m^{2})\phi_{i,o}(x)=0,
  </annotation>
 </semantics>
</math>

 the free <a href="Klein–Gordon_equation" title="wikilink">Klein–Gordon equation</a>. These fields are postulated to have the same equal time commutation relations (<strong>ETCR</strong>) as the free fields,</p>

<p>

<math display="block" id="S-matrix:83">
 <semantics>
  <mrow>
   <mtable displaystyle="true">
    <mtr>
     <mtd columnalign="right">
      <msub>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <msub>
          <mi>ϕ</mi>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>o</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <msub>
          <mi>π</mi>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>o</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>=</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mrow>
        <mi></mi>
        <mo>=</mo>
        <mrow>
         <mi>i</mi>
         <mi>δ</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>𝐱</mi>
           <mo>-</mo>
           <mi>𝐲</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>,</mo>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd columnalign="right">
      <msub>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <msub>
          <mi>ϕ</mi>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>o</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
         <msub>
          <mi>ϕ</mi>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>o</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mrow>
        <msub>
         <mi>x</mi>
         <mn>0</mn>
        </msub>
        <mo>=</mo>
        <msub>
         <mi>y</mi>
         <mn>0</mn>
        </msub>
       </mrow>
      </msub>
     </mtd>
     <mtd columnalign="left">
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <msub>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <msub>
           <mi>π</mi>
           <mrow>
            <mi>i</mi>
            <mo>,</mo>
            <mi>o</mi>
           </mrow>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>,</mo>
         <mrow>
          <msub>
           <mi>π</mi>
           <mrow>
            <mi>i</mi>
            <mo>,</mo>
            <mi>o</mi>
           </mrow>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>y</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
        <mrow>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
         <mo>=</mo>
         <msub>
          <mi>y</mi>
          <mn>0</mn>
         </msub>
        </mrow>
       </msub>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <interval closure="closed">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <list>
          <ci>i</ci>
          <ci>o</ci>
         </list>
        </apply>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>π</ci>
         <list>
          <ci>i</ci>
          <ci>o</ci>
         </list>
        </apply>
        <ci>y</ci>
       </apply>
      </interval>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>δ</ci>
       <apply>
        <minus></minus>
        <ci>𝐱</ci>
        <ci>𝐲</ci>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <interval closure="closed">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <list>
          <ci>i</ci>
          <ci>o</ci>
         </list>
        </apply>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <list>
          <ci>i</ci>
          <ci>o</ci>
         </list>
        </apply>
        <ci>y</ci>
       </apply>
      </interval>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <and></and>
      <apply>
       <eq></eq>
       <csymbol cd="latexml">absent</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <interval closure="closed">
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>π</ci>
           <list>
            <ci>i</ci>
            <ci>o</ci>
           </list>
          </apply>
          <ci>x</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>π</ci>
           <list>
            <ci>i</ci>
            <ci>o</ci>
           </list>
          </apply>
          <ci>y</ci>
         </apply>
        </interval>
        <apply>
         <eq></eq>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <share href="#.cmml">
       </share>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle{[\phi_{i,o}(x),\pi_{i,o}(y)]}_{x_{0}=y_{0}}&%
\displaystyle=i\delta(\mathbf{x}-\mathbf{y}),\\
\displaystyle{[\phi_{i,o}(x),\phi_{i,o}(y)]}_{x_{0}=y_{0}}&\displaystyle={[\pi%
_{i,o}(x),\pi_{i,o}(y)]}_{x_{0}=y_{0}}=0\end{aligned},
  </annotation>
 </semantics>
</math>

 where <mtpl></mtpl> is the field <strong>canonically conjugate</strong> to <mtpl></mtpl>. Associated to the in and out fields are two sets of creation and annihilation operators, <mtpl></mtpl><sup>†</sup> and <mtpl></mtpl><sup>†</sup>, acting in the <em>same</em> <a href="Hilbert_space" title="wikilink">Hilbert space</a>,<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> on two <em>distinct</em> complete sets (<a href="Fock_space" title="wikilink">Fock spaces</a>; initial space 

<math display="inline" id="S-matrix:84">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

, final space 

<math display="inline" id="S-matrix:85">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 ). These operators satisfy the usual commutation rules,</p>

<p>

<math display="inline" id="S-matrix:86">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>o</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐩</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msubsup>
     <mi>a</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>o</mi>
     </mrow>
     <mo>†</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>𝐩</mi>
      <mo>′</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <ci>i</ci>
       <ci>o</ci>
      </list>
     </apply>
     <ci>𝐩</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-†</ci>
      </apply>
      <list>
       <ci>i</ci>
       <ci>o</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐩</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle{[a_{i,o}(\mathbf{p}),a^{\dagger}_{i,o}(\mathbf{p}^{\prime})]}
  </annotation>
 </semantics>
</math>


</p>

<p>The action of a the creation operators on their respective vacua and states with a finite number of particles in the in and out states is given by</p>

<p>

<math display="inline" id="S-matrix:87">
 <semantics>
  <mrow>
   <mo fence="true">|</mo>
   <mrow>
    <mi>i</mi>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <mi mathvariant="normal">…</mi>
     <msub>
      <mi>k</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">ket</csymbol>
    <list>
     <ci>i</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left|i,k_{1}\ldots k_{n}\right\rangle
  </annotation>
 </semantics>
</math>


 where issues of normalization have been ignored. See the next section for a detailed account on how a general  state is normalized. The initial and final spaces are defined by</p>

<p>

<math display="block" id="S-matrix:88">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>span</mo>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mrow>
        <mo fence="true">|</mo>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mrow>
          <msub>
           <mi>k</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <msub>
           <mi>k</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>⟩</mo>
       </mrow>
       <mo>=</mo>
       <mrow>
        <msubsup>
         <mi>a</mi>
         <mi>i</mi>
         <mo>†</mo>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>k</mi>
          <mn>1</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">⋯</mi>
        <msubsup>
         <mi>a</mi>
         <mi>i</mi>
         <mo>†</mo>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>k</mi>
          <mi>n</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo fence="true">|</mo>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mn>0</mn>
         </mrow>
         <mo>⟩</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℋ</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <ci>span</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>i</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <list>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}_{i}=\operatorname{span}\{\left|i,k_{1}\ldots k_{n}\right\rangle=a_%
{i}^{\dagger}(k_{1})\cdots a_{i}^{\dagger}(k_{n})\left|i,0\right\rangle\},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="S-matrix:89">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
     <mi>f</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>span</mo>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <mrow>
        <mo fence="true">|</mo>
        <mrow>
         <mi>f</mi>
         <mo>,</mo>
         <mrow>
          <msub>
           <mi>p</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <msub>
           <mi>p</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>⟩</mo>
       </mrow>
       <mo>=</mo>
       <mrow>
        <msubsup>
         <mi>a</mi>
         <mi>f</mi>
         <mo>†</mo>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>p</mi>
          <mn>1</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi mathvariant="normal">⋯</mi>
        <msubsup>
         <mi>a</mi>
         <mi>f</mi>
         <mo>†</mo>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>p</mi>
          <mi>n</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo fence="true">|</mo>
         <mrow>
          <mi>f</mi>
          <mo>,</mo>
          <mn>0</mn>
         </mrow>
         <mo>⟩</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℋ</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <ci>span</ci>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>f</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>f</ci>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-⋯</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>f</ci>
        </apply>
        <ci>normal-†</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <list>
         <ci>f</ci>
         <cn type="integer">0</cn>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{H}_{f}=\operatorname{span}\{\left|f,p_{1}\ldots p_{n}\right\rangle=a_%
{f}^{\dagger}(p_{1})\cdots a_{f}^{\dagger}(p_{n})\left|f,0\right\rangle\}.
  </annotation>
 </semantics>
</math>

</p>

<p>The asymptotic states are assumed to have well defined Poincaré transformation properties, i.e. they are assumed to transform as a direct product of one-particle states.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> This is a characteristic of a non-interacting field. From this follows that the asymptotic states are all <a href="eigenstate" title="wikilink">eigenstates</a> of the momentum operator <mtpl></mtpl>,<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="block" id="S-matrix:90">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>P</mi>
       <mi>μ</mi>
      </msup>
      <mrow>
       <mo fence="true">|</mo>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mrow>
         <msub>
          <mi>k</mi>
          <mn>1</mn>
         </msub>
         <mi mathvariant="normal">…</mi>
         <msub>
          <mi>k</mi>
          <mi>m</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msubsup>
       <mi>k</mi>
       <mn>1</mn>
       <mi>μ</mi>
      </msubsup>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi>k</mi>
        <mi>m</mi>
        <mi>μ</mi>
       </msubsup>
       <mrow>
        <mo fence="true">|</mo>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mrow>
          <msub>
           <mi>k</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <msub>
           <mi>k</mi>
           <mi>m</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>⟩</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>P</mi>
       <mi>μ</mi>
      </msup>
      <mrow>
       <mo fence="true">|</mo>
       <mrow>
        <mi>f</mi>
        <mo>,</mo>
        <mrow>
         <msub>
          <mi>p</mi>
          <mn>1</mn>
         </msub>
         <mi mathvariant="normal">…</mi>
         <msub>
          <mi>p</mi>
          <mi>n</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>⟩</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msubsup>
       <mi>p</mi>
       <mn>1</mn>
       <mi>μ</mi>
      </msubsup>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <msubsup>
        <mi>p</mi>
        <mi>n</mi>
        <mi>μ</mi>
       </msubsup>
       <mrow>
        <mo fence="true">|</mo>
        <mrow>
         <mi>f</mi>
         <mo>,</mo>
         <mrow>
          <msub>
           <mi>p</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <msub>
           <mi>p</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </mrow>
        <mo>⟩</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <ci>μ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>i</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>k</ci>
          <ci>m</ci>
         </apply>
        </apply>
       </list>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>μ</ci>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>m</ci>
        </apply>
        <ci>μ</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <list>
         <ci>i</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>k</ci>
           <ci>m</ci>
          </apply>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>P</ci>
       <ci>μ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>f</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </list>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>μ</ci>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>n</ci>
        </apply>
        <ci>μ</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <list>
         <ci>f</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P^{\mu}\left|i,k_{1}\ldots k_{m}\right\rangle=k_{1}^{\mu}+\cdots+k_{m}^{\mu}%
\left|i,k_{1}\ldots k_{m}\right\rangle,\quad P^{\mu}\left|f,p_{1}\ldots p_{n}%
\right\rangle=p_{1}^{\mu}+\cdots+p_{n}^{\mu}\left|f,p_{1}\ldots p_{n}\right\rangle.
  </annotation>
 </semantics>
</math>

 In particular, they are eigenstates of the full Hamiltonian,</p>

<p>

<math display="block" id="S-matrix:91">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <msup>
     <mi>P</mi>
     <mn>0</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>P</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=P^{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>The vacuum is usually postulated to be stable and unique,<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a><a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>

<math display="block" id="S-matrix:92">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>f</mi>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mo>*</mo>
      <mo>,</mo>
      <mn>0</mn>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mn>0</mn>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <ci>i</ci>
       <cn type="integer">0</cn>
      </list>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <ci>f</ci>
       <cn type="integer">0</cn>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <times></times>
       <cn type="integer">0</cn>
      </list>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <cn type="integer">0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |i,0\rangle=|f,0\rangle=|*,0\rangle\equiv|0\rangle.
  </annotation>
 </semantics>
</math>

.</p>

<p>The interaction is assumed adiabatically turned on and off.</p>
<h4 id="heisenberg-picture">Heisenberg picture</h4>

<p>The <a href="Heisenberg_picture" title="wikilink">Heisenberg picture</a> is employed henceforth. In this picture, the states are time-independent. A Heisenberg state vector thus represents the complete spacetime history of a system of particles.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> The labeling of the in and out states refers to the asymptotic appearance. An state <mtpl></mtpl> is characterized by that as 

<math display="inline" id="S-matrix:93">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mi mathvariant="normal">→</mi>
   <mi mathvariant="normal">−</mi>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>t</ci>
    <ci>normal-→</ci>
    <ci>normal-−</ci>
    <ci>normal-∞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t→−∞
  </annotation>
 </semantics>
</math>

 the particle content is that represented collectively by 

<math display="inline" id="S-matrix:94">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

. Likewise, a state <mtpl></mtpl> will have the particle content represented by 

<math display="inline" id="S-matrix:95">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   β
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="S-matrix:96">
 <semantics>
  <mrow>
   <mrow>
    <mi>t</mi>
    <mi mathvariant="normal">→</mi>
   </mrow>
   <mo>+</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>normal-→</ci>
    </apply>
    <ci>normal-∞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t→+∞
  </annotation>
 </semantics>
</math>

. Using the assumption that the in and out states, as well as the interacting states, inhabit the same Hilbert space and assuming completeness of the normalized in and out states (postulate of asymptotic completeness<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a>), the initial states can be expanded in a basis of final states (or vice versa). The explicit expression is given later after more notation and terminology has been introduced. The expansion coefficients are precisely the S-matrix elements to be defined below.</p>

<p>While the state vectors are constant in time in the Heisenberg picture, the physical states they represent are <em>not</em>. If a system is found to be in a state 

<math display="inline" id="S-matrix:97">
 <semantics>
  <mi mathvariant="normal">Ψ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ψ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ψ
  </annotation>
 </semantics>
</math>

 at time 

<math display="inline" id="S-matrix:98">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=0
  </annotation>
 </semantics>
</math>

, then it will be found in the state <mtpl><em>e</em><sup>−<em>iHτ</em></sup>Ψ}}</mtpl> at time 

<math display="inline" id="S-matrix:99">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <mi>τ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=τ
  </annotation>
 </semantics>
</math>

. This is not (necessarily) the same Heisenberg state vector, but it is an <em>equivalent</em> state vector, meaning that it will, upon measurement, be found to be one of the final states from the expansion with nonzero coefficient. Letting 

<math display="inline" id="S-matrix:100">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   τ
  </annotation>
 </semantics>
</math>

 vary one sees that the observed 

<math display="inline" id="S-matrix:101">
 <semantics>
  <mi mathvariant="normal">Ψ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Ψ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ψ
  </annotation>
 </semantics>
</math>

 (not measured) is indeed the <a href="Schrödinger_picture" title="wikilink">Schrödinger picture</a> state vector. By repeating the measurement sufficiently many times and averaging, one may say that the <em>same</em> state vector is indeed found at time 

<math display="inline" id="S-matrix:102">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <mi>τ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <ci>τ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=τ
  </annotation>
 </semantics>
</math>

 as at time 

<math display="inline" id="S-matrix:103">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t=0
  </annotation>
 </semantics>
</math>

. This reflects the expansion above of an in state into out states.</p>
<h4 id="from-free-particle-states">From free particle states</h4>

<p>For this viewpoint, one should consider how the archetypical scattering experiment is performed. The initial particles are prepared in well defined states where they are so far apart that they don't interact. They are somehow made to interact, and the final particles are registered when they are so far apart that they have ceased to interact. The idea is to look for states in the <a href="Heisenberg_picture" title="wikilink">Heisenberg picture</a> that in the distant past had the appearance of free particle states. This will be the in states. Likewise, an out state will be a state that in the distant future has the appearance of a free particle state.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>

<p>The notation from the general reference for this section,  will be used. A general non-interacting multi-particle state is given by</p>

<p>

<math display="block" id="S-matrix:104">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Ψ</mi>
    <mrow>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>σ</mi>
       <mn>1</mn>
      </msub>
      <msub>
       <mi>n</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>;</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>σ</mi>
       <mn>2</mn>
      </msub>
      <msub>
       <mi>n</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>;</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </msub>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Ψ</ci>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{p_{1}\sigma_{1}n_{1};p_{2}\sigma_{2}n_{2};\cdots},
  </annotation>
 </semantics>
</math>

 where</p>
<ul>
<li>

<math display="inline" id="S-matrix:105">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is momentum,</li>
<li>

<math display="inline" id="S-matrix:106">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   σ
  </annotation>
 </semantics>
</math>

 is spin z-component or, in the massless case, <a href="helicity_(particle_physics)" title="wikilink">helicity</a>,</li>
<li>

<math display="inline" id="S-matrix:107">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is particle species.</li>
</ul>

<p>These states are normalized as</p>

<p>

<math display="block" id="S-matrix:108">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mrow>
        <msubsup>
         <mi>p</mi>
         <mn>1</mn>
         <mo>′</mo>
        </msubsup>
        <msubsup>
         <mi>σ</mi>
         <mn>1</mn>
         <mo>′</mo>
        </msubsup>
        <msubsup>
         <mi>n</mi>
         <mn>1</mn>
         <mo>′</mo>
        </msubsup>
       </mrow>
       <mo>;</mo>
       <mrow>
        <msubsup>
         <mi>p</mi>
         <mn>2</mn>
         <mo>′</mo>
        </msubsup>
        <msubsup>
         <mi>σ</mi>
         <mn>2</mn>
         <mo>′</mo>
        </msubsup>
        <msubsup>
         <mi>n</mi>
         <mn>2</mn>
         <mo>′</mo>
        </msubsup>
       </mrow>
       <mo>;</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mrow>
       <mrow>
        <msub>
         <mi>p</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>σ</mi>
         <mn>1</mn>
        </msub>
        <msub>
         <mi>n</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo>;</mo>
       <mrow>
        <msub>
         <mi>p</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>σ</mi>
         <mn>2</mn>
        </msub>
        <msub>
         <mi>n</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo>;</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>δ</mi>
       <mn>3</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>𝐩</mi>
         <mn>1</mn>
         <mo>′</mo>
        </msubsup>
        <mo>-</mo>
        <msub>
         <mi>𝐩</mi>
         <mn>1</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>δ</mi>
       <mrow>
        <msubsup>
         <mi>σ</mi>
         <mn>1</mn>
         <mo>′</mo>
        </msubsup>
        <msub>
         <mi>σ</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </msub>
      <msub>
       <mi>δ</mi>
       <mrow>
        <msubsup>
         <mi>n</mi>
         <mn>1</mn>
         <mo>′</mo>
        </msubsup>
        <msub>
         <mi>n</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </msub>
      <msup>
       <mi>δ</mi>
       <mn>3</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>𝐩</mi>
         <mn>2</mn>
         <mo>′</mo>
        </msubsup>
        <mo>-</mo>
        <msub>
         <mi>𝐩</mi>
         <mn>2</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>δ</mi>
       <mrow>
        <msubsup>
         <mi>σ</mi>
         <mn>2</mn>
         <mo>′</mo>
        </msubsup>
        <msub>
         <mi>σ</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </msub>
      <msub>
       <mi>δ</mi>
       <mrow>
        <msubsup>
         <mi>n</mi>
         <mn>2</mn>
         <mo>′</mo>
        </msubsup>
        <msub>
         <mi>n</mi>
         <mn>2</mn>
        </msub>
       </mrow>
      </msub>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mrow>
      <mo>±</mo>
      <mtext>permutations</mtext>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <list>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <list>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </list>
     </apply>
    </interval>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>δ</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐩</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐩</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>δ</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐩</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐩</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <mtext>permutations</mtext>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\Psi_{p_{1}^{\prime}\sigma_{1}^{\prime}n_{1}^{\prime};p_{2}^{\prime}%
\sigma_{2}^{\prime}n_{2}^{\prime};\cdots},\Psi_{p_{1}\sigma_{1}n_{1};p_{2}%
\sigma_{2}n_{2};\cdots}\right)=\delta^{3}(\mathbf{p}_{1}^{\prime}-\mathbf{p}_{%
1})\delta_{\sigma_{1}^{\prime}\sigma_{1}}\delta_{n_{1}^{\prime}n_{1}}\delta^{3%
}(\mathbf{p}_{2}^{\prime}-\mathbf{p}_{2})\delta_{\sigma_{2}^{\prime}\sigma_{2}%
}\delta_{n_{2}^{\prime}n_{2}}\cdots\quad\pm\text{ permutations}.
  </annotation>
 </semantics>
</math>

 Permutations work as such; if <mtpl></mtpl> is a permutation of 

<math display="inline" id="S-matrix:109">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 objects (for a  state) such that</p>

<p>

<math display="block" id="S-matrix:110">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>n</mi>
      <mrow>
       <mi>s</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>′</mo>
     </msubsup>
     <mo>=</mo>
     <msub>
      <mi>n</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <mn>1</mn>
     <mo>≤</mo>
     <mi>i</mi>
     <mo>≤</mo>
     <mi>k</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <apply>
        <times></times>
        <ci>s</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <leq></leq>
      <cn type="integer">1</cn>
      <ci>i</ci>
     </apply>
     <apply>
      <leq></leq>
      <share href="#.cmml">
      </share>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{s(i)}^{\prime}=n_{i},\quad 1\leq i\leq k,
  </annotation>
 </semantics>
</math>

 then a nonzero term results. The sign is plus unless 

<math display="inline" id="S-matrix:111">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 involves an odd number of fermion transpositions, in which case it is minus. The notation is usually abbreviated letting one Greek letter stand for the whole collection describing the state. In abbreviated form the normalization becomes</p>

<p>

<math display="block" id="S-matrix:112">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <msup>
       <mi>α</mi>
       <mo>′</mo>
      </msup>
     </msub>
     <mo>,</mo>
     <msub>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>α</mi>
        <mo>′</mo>
       </msup>
       <mo>-</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <ci>α</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>δ</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\Psi_{\alpha^{\prime}},\Psi_{\alpha}\right)=\delta(\alpha^{\prime}-%
\alpha).
  </annotation>
 </semantics>
</math>

 When integrating over free-particle states one writes in this notation</p>

<p>

<math display="block" id="S-matrix:113">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>α</mi>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <msub>
        <mi>n</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>σ</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>n</mi>
        <mn>2</mn>
       </msub>
       <msub>
        <mi>σ</mi>
        <mn>2</mn>
       </msub>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </munder>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <msub>
        <mi>p</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <msub>
        <mi>p</mi>
        <mn>2</mn>
       </msub>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>α</ci>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int d\alpha\cdots\equiv\sum_{n_{1}\sigma_{1}n_{2}\sigma_{2}\cdots}\int d^{3}p%
_{1}d^{3}p_{2}\cdots,
  </annotation>
 </semantics>
</math>

 where the sum includes only terms such that no two terms are equal modulo a permutation of the particle type indices. The sets of states sought for are supposed to be <em>complete</em>. This is expressed as</p>

<p>

<math display="block" id="S-matrix:114">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Ψ</mi>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>α</mi>
      <msub>
       <mi mathvariant="normal">Ψ</mi>
       <mi>α</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">Ψ</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-Ψ</ci>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <ci>normal-Ψ</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi=\int d\alpha\Psi_{\alpha}\left(\Psi_{\alpha},\Psi\right),
  </annotation>
 </semantics>
</math>

 which could be paraphrased as</p>

<p>

<math display="block" id="S-matrix:115">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>α</mi>
      <mrow>
       <mo fence="true">|</mo>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
       </msub>
       <mo>⟩</mo>
      </mrow>
      <mrow>
       <mo>⟨</mo>
       <msub>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
       </msub>
       <mo fence="true">|</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>α</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">bra</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int d\alpha\left|\Psi_{\alpha}\right\rangle\left\langle\Psi_{\alpha}\right|=1,
  </annotation>
 </semantics>
</math>

 where for each fixed 

<math display="inline" id="S-matrix:116">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

, the right hand side is a projection operator onto the state 

<math display="inline" id="S-matrix:117">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

. Under an inhomogeneous Lorentz transformation 

<math display="inline" id="S-matrix:118">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi mathvariant="normal">Λ</mi>
   <mo>,</mo>
   <mi>a</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>normal-Λ</ci>
    <ci>a</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Λ,a)
  </annotation>
 </semantics>
</math>

, the field transforms according to the rule \sum_{\sigma_1'\sigma_2'\cdots} D_{\sigma_1'\sigma_1}^{(j_1)}(W(\Lambda, p_1))D_{\sigma_2'\sigma_2}^{(j_2)}(W(\Lambda, p_2))\cdots \Psi_{\Lambda p_1\sigma_1' n_1;\Lambda p_2\sigma_2' n_2\cdots},|<mtpl><eqref>1<eqref></eqref></eqref></mtpl>}} where 

<math display="inline" id="S-matrix:119">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Λ</mi>
    <mo>,</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>W</ci>
    <interval closure="open">
     <ci>normal-Λ</ci>
     <ci>p</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W(Λ,p)
  </annotation>
 </semantics>
</math>

 is the <a href="Wigner_rotation" title="wikilink">Wigner rotation</a> and <mtpl></mtpl> is the  representation of 

<math display="inline" id="S-matrix:120">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>O</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SO(3)
  </annotation>
 </semantics>
</math>

. By putting 

<math display="inline" id="S-matrix:121">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Λ</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>τ</mi>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>normal-Λ</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <vector>
      <ci>τ</ci>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Λ=1,a=(τ,0,0,0)
  </annotation>
 </semantics>
</math>

, for which 

<math display="inline" id="S-matrix:122">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="S-matrix:123">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mi>x</mi>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>i</mi>
     <mi>H</mi>
     <mi>τ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>e</ci>
    <ci>x</ci>
    <ci>p</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>H</ci>
     <ci>τ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   exp(iHτ)
  </annotation>
 </semantics>
</math>

, in , it immediately follows that</p>

<p>

<math display="block" id="S-matrix:124">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>H</mi>
      <mi mathvariant="normal">Ψ</mi>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>E</mi>
       <mi>α</mi>
      </msub>
      <mi mathvariant="normal">Ψ</mi>
     </mrow>
    </mrow>
    <mo rspace="12.5pt">,</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mi>α</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <msubsup>
       <mi>p</mi>
       <mn>1</mn>
       <mn>0</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>p</mi>
       <mn>2</mn>
       <mn>0</mn>
      </msubsup>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>normal-Ψ</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>α</ci>
      </apply>
      <ci>normal-Ψ</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">0</cn>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H\Psi=E_{\alpha}\Psi,\quad E_{\alpha}=p_{1}^{0}+p_{2}^{0}+\cdots,
  </annotation>
 </semantics>
</math>

 so the in and out states sough after are eigenstates of the full Hamiltonian that are necessarily non-interacting due to the absence of mixed particle energy terms. The discussion in the section above suggests that the in states <mtpl></mtpl> and the out states <mtpl></mtpl> should be such that</p>

<p>

<math display="block" id="S-matrix:125">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>i</mi>
       <mi>H</mi>
       <mi>τ</mi>
      </mrow>
     </mrow>
    </msup>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>α</mi>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>α</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>α</mi>
       <mo>±</mo>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mi>d</mi>
     <mi>α</mi>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <msub>
         <mi>E</mi>
         <mi>α</mi>
        </msub>
        <mi>τ</mi>
       </mrow>
      </mrow>
     </msup>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>α</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>±</mo>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>H</ci>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>α</ci>
       <ci>g</ci>
       <ci>α</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <ci>α</ci>
        </apply>
        <csymbol cd="latexml">plus-or-minus</csymbol>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <int></int>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>i</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>α</ci>
         </apply>
         <ci>τ</ci>
        </apply>
       </apply>
      </apply>
      <ci>g</ci>
      <ci>α</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-iH\tau}\int d\alpha g(\alpha)\Psi_{\alpha}^{\pm}=\int d\alpha e^{-iE_{%
\alpha}\tau}g(\alpha)\Psi_{\alpha}^{\pm}
  </annotation>
 </semantics>
</math>

 for large positive and negative 

<math display="inline" id="S-matrix:126">
 <semantics>
  <mi>τ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>τ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   τ
  </annotation>
 </semantics>
</math>

 has the appearance of the corresponding package, represented by 

<math display="inline" id="S-matrix:127">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, of free-particle states, 

<math display="inline" id="S-matrix:128">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 assumed smooth and suitably localized in momentum. Wave packages are necessary, else the time evolution will yield only a phase factor indicating free particles, which cannot be the case. The right hand side follows from that the in and out states are eigenstates of the Hamiltonian per above. To formalize this requirement, assume that the full <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> 

<math display="inline" id="S-matrix:129">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 can be divided into two terms, a free-particle Hamiltonian <mtpl></mtpl> and an interaction 

<math display="inline" id="S-matrix:130">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, <mtpl> <em>H</em><sub>0</sub> + <em>V</em>}}</mtpl> such that the eigenstates <mtpl></mtpl> of <mtpl></mtpl> have the same appearance as the in- and out-states with respect to normalization and Lorentz transformation properties,</p>

<p>

<math display="block" id="S-matrix:131">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>H</mi>
      <mn>0</mn>
     </msub>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mi>α</mi>
     </msub>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{0}\Phi_{\alpha}=E_{\alpha}\Phi_{\alpha},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="S-matrix:132">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
      <mo>′</mo>
     </msubsup>
     <mo>,</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>α</mi>
        <mo>′</mo>
       </msup>
       <mo>-</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>α</ci>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>δ</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\Phi_{\alpha}^{\prime},\Phi_{\alpha})=\delta(\alpha^{\prime}-\alpha).
  </annotation>
 </semantics>
</math>

</p>

<p>The in and out states are defined as eigenstates of the full Hamiltonian,</p>

<p>

<math display="block" id="S-matrix:133">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>H</mi>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>±</mo>
     </msubsup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mi>α</mi>
     </msub>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>±</mo>
     </msubsup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H\Psi_{\alpha}^{\pm}=E_{\alpha}\Psi_{\alpha}^{\pm},
  </annotation>
 </semantics>
</math>

 satisfying</p>

<p>

<math display="block" id="S-matrix:134">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <mi>H</mi>
        <mi>τ</mi>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>d</mi>
       <mi>α</mi>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>α</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
        <mo>±</mo>
       </msubsup>
      </mrow>
     </mrow>
    </mrow>
    <mo>→</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <msub>
         <mi>H</mi>
         <mn>0</mn>
        </msub>
        <mi>τ</mi>
       </mrow>
      </mrow>
     </msup>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>d</mi>
       <mi>α</mi>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>α</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi mathvariant="normal">Φ</mi>
        <mi>α</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>H</ci>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>α</ci>
       <ci>g</ci>
       <ci>α</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <ci>α</ci>
        </apply>
        <csymbol cd="latexml">plus-or-minus</csymbol>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>α</ci>
       <ci>g</ci>
       <ci>α</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Φ</ci>
        <ci>α</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{-iH\tau}\int d\alpha g(\alpha)\Psi_{\alpha}^{\pm}\rightarrow e^{-iH_{0}\tau%
}\int d\alpha g(\alpha)\Phi_{\alpha}.
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="S-matrix:135">
 <semantics>
  <mrow>
   <mi>τ</mi>
   <mi mathvariant="normal">→</mi>
   <mi mathvariant="normal">−</mi>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>τ</ci>
    <ci>normal-→</ci>
    <ci>normal-−</ci>
    <ci>normal-∞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   τ→−∞
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="S-matrix:136">
 <semantics>
  <mrow>
   <mrow>
    <mi>τ</mi>
    <mi mathvariant="normal">→</mi>
   </mrow>
   <mo>+</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>τ</ci>
     <ci>normal-→</ci>
    </apply>
    <ci>normal-∞</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   τ→+∞
  </annotation>
 </semantics>
</math>

 respectively. Define</p>

<p>

<math display="block" id="S-matrix:137">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Ω</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>τ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>+</mo>
       <mrow>
        <mi>i</mi>
        <mi>H</mi>
        <mi>τ</mi>
       </mrow>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>i</mi>
        <msub>
         <mi>H</mi>
         <mn>0</mn>
        </msub>
        <mi>τ</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <times></times>
     <ci>normal-Ω</ci>
     <ci>τ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>H</ci>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <cn type="integer">0</cn>
        </apply>
        <ci>τ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega(\tau)\equiv e^{+iH\tau}e^{-iH_{0}\tau},
  </annotation>
 </semantics>
</math>

 then</p>

<p>

<math display="block" id="S-matrix:138">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>±</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Ω</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>∓</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <ci>α</ci>
     </apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Ω</ci>
     <apply>
      <csymbol cd="latexml">minus-or-plus</csymbol>
      <infinity></infinity>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{\alpha}^{\pm}=\Omega(\mp\infty)\Phi_{\alpha}.
  </annotation>
 </semantics>
</math>

 This last expression will work only using wave packages.From these definitions follow that the in and out states are normalized in the same way as the free-particle states,</p>

<p>

<math display="block" id="S-matrix:139">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>β</mi>
      <mo>+</mo>
     </msubsup>
     <mo>,</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>+</mo>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>β</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>β</mi>
      <mo>-</mo>
     </msubsup>
     <mo>,</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>-</mo>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>β</mi>
       <mo>-</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <plus></plus>
      </apply>
     </interval>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>β</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Φ</ci>
       <ci>α</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <minus></minus>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <minus></minus>
      </apply>
     </interval>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>δ</ci>
      <apply>
       <minus></minus>
       <ci>β</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\Psi_{\beta}^{+},\Psi_{\alpha}^{+})=(\Phi_{\beta},\Phi_{\alpha})=(\Psi_{\beta%
}^{-},\Psi_{\alpha}^{-})=\delta(\beta-\alpha),
  </annotation>
 </semantics>
</math>

 and the three sets are unitarily equivalent. Now rewrite the eigenvalue equation,</p>

<p>

<math display="block" id="S-matrix:140">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>E</mi>
         <mi>α</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>H</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo>±</mo>
       <mrow>
        <mi>i</mi>
        <mi>ϵ</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>±</mo>
     </msubsup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>±</mo>
      <mrow>
       <mi>i</mi>
       <mi>ϵ</mi>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
        <mo>±</mo>
       </msubsup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>V</mi>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>α</mi>
       <mo>±</mo>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>α</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>ϵ</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>ϵ</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <ci>α</ci>
        </apply>
        <csymbol cd="latexml">plus-or-minus</csymbol>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (E_{\alpha}-H_{0}\pm i\epsilon)\Psi_{\alpha}^{\pm}=\pm i\epsilon\Psi_{\alpha}^%
{\pm}+V\Psi_{\alpha}^{\pm},
  </annotation>
 </semantics>
</math>

 where the 

<math display="inline" id="S-matrix:141">
 <semantics>
  <mrow>
   <mi mathvariant="normal">±</mi>
   <mi>i</mi>
   <mi>ε</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-±</ci>
    <ci>i</ci>
    <ci>ε</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ±iε
  </annotation>
 </semantics>
</math>

 terms has been added to make the operator on the LHS invertible. Since the in and out states reduce to the free-particle states for 

<math display="inline" id="S-matrix:142">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mi mathvariant="normal">→</mi>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <ci>normal-→</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V→0
  </annotation>
 </semantics>
</math>

, put</p>

<p>

<math display="block" id="S-matrix:143">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mi>ϵ</mi>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>±</mo>
    </msubsup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>i</mi>
    <mi>ϵ</mi>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mi>α</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>ϵ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>ϵ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\epsilon\Psi_{\alpha}^{\pm}=i\epsilon\Phi_{\alpha}
  </annotation>
 </semantics>
</math>

 on the RHS to obtain</p>

<p>

<math display="block" id="S-matrix:144">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>±</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>E</mi>
           <mi>α</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>H</mi>
           <mn>0</mn>
          </msub>
         </mrow>
         <mo>±</mo>
         <mrow>
          <mi>i</mi>
          <mi>ϵ</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>V</mi>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>α</mi>
       <mo>±</mo>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <ci>α</ci>
     </apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">plus-or-minus</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>α</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>ϵ</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{\alpha}^{\pm}=\Phi_{\alpha}+(E_{\alpha}-H_{0}\pm i\epsilon)^{-1}V\Psi_{%
\alpha}^{\pm}.
  </annotation>
 </semantics>
</math>

 Then use the completeness of the free-particle states,</p>

<p>

<math display="block" id="S-matrix:145">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>V</mi>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>±</mo>
     </msubsup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi mathvariant="normal">Φ</mi>
        <mi>β</mi>
       </msub>
       <mo>,</mo>
       <mrow>
        <mi>V</mi>
        <msubsup>
         <mi mathvariant="normal">Ψ</mi>
         <mi>α</mi>
         <mo>±</mo>
        </msubsup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi mathvariant="normal">Φ</mi>
       <mi>β</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>≡</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>β</mi>
      <msubsup>
       <mi>T</mi>
       <mrow>
        <mi>β</mi>
        <mi>α</mi>
       </mrow>
       <mo>±</mo>
      </msubsup>
      <msub>
       <mi mathvariant="normal">Φ</mi>
       <mi>β</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>β</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Φ</ci>
         <ci>β</ci>
        </apply>
        <apply>
         <times></times>
         <ci>V</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>normal-Ψ</ci>
           <ci>α</ci>
          </apply>
          <csymbol cd="latexml">plus-or-minus</csymbol>
         </apply>
        </apply>
       </interval>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Φ</ci>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>β</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>α</ci>
         </apply>
        </apply>
        <csymbol cd="latexml">plus-or-minus</csymbol>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Φ</ci>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V\Psi_{\alpha}^{\pm}=\int d\beta(\Phi_{\beta},V\Psi_{\alpha}^{\pm})\Phi_{\beta%
}\equiv\int d\beta T_{\beta\alpha}^{\pm}\Phi_{\beta},
  </annotation>
 </semantics>
</math>

 to finally obtain</p>

<p>

<math display="block" id="S-matrix:146">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>±</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>d</mi>
       <mi>β</mi>
       <mfrac>
        <mrow>
         <msubsup>
          <mi>T</mi>
          <mrow>
           <mi>β</mi>
           <mi>α</mi>
          </mrow>
          <mo>±</mo>
         </msubsup>
         <msub>
          <mi mathvariant="normal">Φ</mi>
          <mi>β</mi>
         </msub>
        </mrow>
        <mrow>
         <mrow>
          <msub>
           <mi>E</mi>
           <mi>α</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>E</mi>
           <mi>β</mi>
          </msub>
         </mrow>
         <mo>±</mo>
         <mrow>
          <mi>i</mi>
          <mi>ϵ</mi>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <ci>α</ci>
     </apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>β</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>T</ci>
           <apply>
            <times></times>
            <ci>β</ci>
            <ci>α</ci>
           </apply>
          </apply>
          <csymbol cd="latexml">plus-or-minus</csymbol>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Φ</ci>
          <ci>β</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">plus-or-minus</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>E</ci>
           <ci>α</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>E</ci>
           <ci>β</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>ϵ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{\alpha}^{\pm}=\Phi_{\alpha}+\int d\beta\frac{T_{\beta\alpha}^{\pm}\Phi_{%
\beta}}{E_{\alpha}-E_{\beta}\pm i\epsilon}.
  </annotation>
 </semantics>
</math>

 Here <mtpl></mtpl> has been replaced by its eigenvalue on the free-particle states. This is the <a href="Lippmann–Schwinger_equation" title="wikilink">Lippmann–Schwinger equation</a>.</p>
<h4 id="in-states-expressed-as-out-states">In states expressed as out states</h4>

<p>The initial states can be expanded in a basis of final states (or vice versa). Using the completeness relation,</p>

<p>

<math display="block" id="S-matrix:147">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>-</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>β</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>β</mi>
        <mo>+</mo>
       </msubsup>
       <mo>,</mo>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
        <mo>-</mo>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>β</mi>
       <mo>+</mo>
      </msubsup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <mi>β</mi>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>β</mi>
        <mo>+</mo>
       </msubsup>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>β</mi>
        <mo>+</mo>
       </msubsup>
       <mo stretchy="false">|</mo>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>α</mi>
        <mo>-</mo>
       </msubsup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <msub>
        <mi>n</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>σ</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>n</mi>
        <mn>2</mn>
       </msub>
       <msub>
        <mi>σ</mi>
        <mn>2</mn>
       </msub>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </munder>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <msub>
        <mi>p</mi>
        <mn>1</mn>
       </msub>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <msub>
        <mi>p</mi>
        <mn>2</mn>
       </msub>
       <mi mathvariant="normal">⋯</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi mathvariant="normal">Ψ</mi>
         <mi>β</mi>
         <mo>+</mo>
        </msubsup>
        <mo>,</mo>
        <msubsup>
         <mi mathvariant="normal">Ψ</mi>
         <mi>α</mi>
         <mo>-</mo>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
       <msubsup>
        <mi mathvariant="normal">Ψ</mi>
        <mi>β</mi>
        <mo>+</mo>
       </msubsup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <minus></minus>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>β</ci>
       <interval closure="open">
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ψ</ci>
          <ci>β</ci>
         </apply>
         <plus></plus>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ψ</ci>
          <ci>α</ci>
         </apply>
         <minus></minus>
        </apply>
       </interval>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <ci>β</ci>
        </apply>
        <plus></plus>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>β</ci>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ψ</ci>
          <ci>β</ci>
         </apply>
         <plus></plus>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">inner-product</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ψ</ci>
          <ci>β</ci>
         </apply>
         <plus></plus>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ψ</ci>
          <ci>α</ci>
         </apply>
         <minus></minus>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
       </apply>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
        <interval closure="open">
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>normal-Ψ</ci>
           <ci>β</ci>
          </apply>
          <plus></plus>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>normal-Ψ</ci>
           <ci>α</ci>
          </apply>
          <minus></minus>
         </apply>
        </interval>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ψ</ci>
          <ci>β</ci>
         </apply>
         <plus></plus>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{\alpha}^{-}=\int d\beta(\Psi_{\beta}^{+},\Psi_{\alpha}^{-})\Psi_{\beta}^%
{+}=\int d\beta|\Psi_{\beta}^{+}\rangle\langle\Psi_{\beta}^{+}|\Psi_{\alpha}^{%
-}\rangle=\sum_{n_{1}\sigma_{1}n_{2}\sigma_{2}\cdots}\int d^{3}p_{1}d^{3}p_{2}%
\cdots(\Psi_{\beta}^{+},\Psi_{\alpha}^{-})\Psi_{\beta}^{+},
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="S-matrix:148">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>-</mo>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mo fence="true">|</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>k</mi>
        <mn>1</mn>
       </msub>
       <mi mathvariant="normal">…</mi>
       <msub>
        <mi>k</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>C</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo fence="true">|</mo>
       <mrow>
        <mi>f</mi>
        <mo>,</mo>
        <mn>0</mn>
       </mrow>
       <mo rspace="7.5pt">⟩</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>m</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
        <msub>
         <mi>p</mi>
         <mn>1</mn>
        </msub>
        <mi mathvariant="normal">…</mi>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
        <msub>
         <mi>p</mi>
         <mi>m</mi>
        </msub>
        <msub>
         <mi>C</mi>
         <mi>m</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>p</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">…</mi>
          <msub>
           <mi>p</mi>
           <mi>m</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo fence="true">|</mo>
         <mrow>
          <mi>f</mi>
          <mo>,</mo>
          <mrow>
           <msub>
            <mi>p</mi>
            <mn>1</mn>
           </msub>
           <mi mathvariant="normal">…</mi>
           <msub>
            <mi>p</mi>
            <mi>m</mi>
           </msub>
          </mrow>
         </mrow>
         <mo rspace="5.8pt">⟩</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <minus></minus>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <list>
       <ci>i</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">ket</csymbol>
        <list>
         <ci>f</ci>
         <cn type="integer">0</cn>
        </list>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>m</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <int></int>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>d</ci>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>normal-…</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>d</ci>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>m</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>C</ci>
          <ci>m</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>m</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="latexml">ket</csymbol>
          <list>
           <ci>f</ci>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>p</ci>
             <cn type="integer">1</cn>
            </apply>
            <ci>normal-…</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>p</ci>
             <ci>m</ci>
            </apply>
           </apply>
          </list>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Psi_{\alpha}^{-}=\left|i,k_{1}\ldots k_{n}\right\rangle=C_{0}\left|f,0\right%
\rangle\ +\sum_{m=1}^{\infty}\int{d^{4}p_{1}\ldots d^{4}p_{m}C_{m}(p_{1}\ldots
p%
_{m})\left|f,p_{1}\ldots p_{m}\right\rangle}~{},
  </annotation>
 </semantics>
</math>

 where <mtpl><em>C</em><sub><em>m</em></sub>{{!}}<sup>2</sup>}}</mtpl> is the probability that the interaction transforms</p>

<p>

<math display="block" id="S-matrix:149">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true">|</mo>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
      <msub>
       <mi>k</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <msubsup>
    <mi mathvariant="normal">Ψ</mi>
    <mi>α</mi>
    <mo>-</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <list>
      <ci>i</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <ci>α</ci>
     </apply>
     <minus></minus>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|i,k_{1}\ldots k_{n}\right\rangle=\Psi_{\alpha}^{-}
  </annotation>
 </semantics>
</math>

 into</p>

<p>

<math display="block" id="S-matrix:150">
 <semantics>
  <mrow>
   <mrow>
    <mo fence="true">|</mo>
    <mrow>
     <mi>f</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
      <msub>
       <mi>p</mi>
       <mi>m</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>⟩</mo>
   </mrow>
   <mo>=</mo>
   <msubsup>
    <mi mathvariant="normal">Ψ</mi>
    <mi>β</mi>
    <mo>+</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <list>
      <ci>f</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ψ</ci>
      <ci>β</ci>
     </apply>
     <plus></plus>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|f,p_{1}\ldots p_{m}\right\rangle=\Psi_{\beta}^{+}
  </annotation>
 </semantics>
</math>

. By the ordinary rules of quantum mechanics,</p>

<p>

<math display="block" id="S-matrix:151">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>C</mi>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
      <msub>
       <mi>p</mi>
       <mi>m</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>⟨</mo>
    <mrow>
     <mi>f</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
      <msub>
       <mi>p</mi>
       <mi>m</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>|</mo>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">…</mi>
      <msub>
       <mi>k</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>β</mi>
     <mo>+</mo>
    </msubsup>
    <mo>,</mo>
    <msubsup>
     <mi mathvariant="normal">Ψ</mi>
     <mi>α</mi>
     <mo>-</mo>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <list>
       <ci>f</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>m</ci>
        </apply>
       </apply>
      </list>
      <list>
       <ci>i</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <minus></minus>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{m}(p_{1}\ldots p_{m})=\left\langle f,p_{1}\ldots p_{m}\right|i,k_{1}\ldots k%
_{n}\rangle=(\Psi_{\beta}^{+},\Psi_{\alpha}^{-})
  </annotation>
 </semantics>
</math>

 and one may write</p>

<p>

<math display="block" id="S-matrix:152">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo fence="true">|</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>k</mi>
        <mn>1</mn>
       </msub>
       <mi mathvariant="normal">…</mi>
       <msub>
        <mi>k</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>C</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo fence="true">|</mo>
       <mrow>
        <mi>f</mi>
        <mo>,</mo>
        <mn>0</mn>
       </mrow>
       <mo rspace="7.5pt">⟩</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>m</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
        <msub>
         <mi>p</mi>
         <mn>1</mn>
        </msub>
        <mi mathvariant="normal">…</mi>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
        <msub>
         <mi>p</mi>
         <mi>m</mi>
        </msub>
        <mrow>
         <mo fence="true">|</mo>
         <mrow>
          <mi>f</mi>
          <mo>,</mo>
          <mrow>
           <msub>
            <mi>p</mi>
            <mn>1</mn>
           </msub>
           <mi mathvariant="normal">…</mi>
           <msub>
            <mi>p</mi>
            <mi>m</mi>
           </msub>
          </mrow>
         </mrow>
         <mo>⟩</mo>
        </mrow>
        <mrow>
         <mo>⟨</mo>
         <mrow>
          <mi>f</mi>
          <mo>,</mo>
          <mrow>
           <msub>
            <mi>p</mi>
            <mn>1</mn>
           </msub>
           <mi mathvariant="normal">…</mi>
           <msub>
            <mi>p</mi>
            <mi>m</mi>
           </msub>
          </mrow>
         </mrow>
         <mo>|</mo>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mrow>
           <msub>
            <mi>k</mi>
            <mn>1</mn>
           </msub>
           <mi mathvariant="normal">…</mi>
           <msub>
            <mi>k</mi>
            <mi>n</mi>
           </msub>
          </mrow>
         </mrow>
         <mo rspace="5.8pt" stretchy="false">⟩</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <list>
      <ci>i</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>f</ci>
        <cn type="integer">0</cn>
       </list>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <csymbol cd="latexml">ket</csymbol>
         <list>
          <ci>f</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <ci>m</ci>
           </apply>
          </apply>
         </list>
        </apply>
        <apply>
         <csymbol cd="latexml">inner-product</csymbol>
         <list>
          <ci>f</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <ci>m</ci>
           </apply>
          </apply>
         </list>
         <list>
          <ci>i</ci>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>normal-…</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>k</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </list>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|i,k_{1}\ldots k_{n}\right\rangle=C_{0}\left|f,0\right\rangle\ +\sum_{m=1%
}^{\infty}\int{d^{4}p_{1}\ldots d^{4}p_{m}\left|f,p_{1}\ldots p_{m}\right%
\rangle}\left\langle f,p_{1}\ldots p_{m}\right|i,k_{1}\ldots k_{n}\rangle~{}.
  </annotation>
 </semantics>
</math>

 The expansion coefficients are precisely the S-matrix elements to be defined below.</p>
<h3 id="the-s-matrix">The S-matrix</h3>

<p>The S-matrix is now defined by<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>

<math display="block" id="S-matrix:153">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>S</mi>
      <mrow>
       <mi>β</mi>
       <mi>α</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>β</mi>
       <mo>-</mo>
      </msubsup>
      <mo stretchy="false">|</mo>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>α</mi>
       <mo>+</mo>
      </msubsup>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <mi>f</mi>
       <mo>,</mo>
       <mi>β</mi>
      </mrow>
      <mo stretchy="false">|</mo>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>α</mi>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>f</mi>
        <mo>,</mo>
        <mi>β</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mo>∈</mo>
      <msub>
       <mi class="ltx_font_mathcaligraphic">ℋ</mi>
       <mi>f</mi>
      </msub>
     </mrow>
     <mo rspace="12.5pt">,</mo>
     <mrow>
      <mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>α</mi>
       </mrow>
       <mo stretchy="false">⟩</mo>
      </mrow>
      <mo>∈</mo>
      <msub>
       <mi class="ltx_font_mathcaligraphic">ℋ</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>α</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">inner-product</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <ci>β</ci>
        </apply>
        <minus></minus>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Ψ</ci>
         <ci>α</ci>
        </apply>
        <plus></plus>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <apply>
       <csymbol cd="latexml">inner-product</csymbol>
       <list>
        <ci>f</ci>
        <ci>β</ci>
       </list>
       <list>
        <ci>i</ci>
        <ci>α</ci>
       </list>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <in></in>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>f</ci>
        <ci>β</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℋ</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <in></in>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <list>
        <ci>i</ci>
        <ci>α</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℋ</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{\beta\alpha}=\langle\Psi_{\beta}^{-}|\Psi_{\alpha}^{+}\rangle=\langle f,%
\beta|i,\alpha\rangle,\qquad|f,\beta\rangle\in\mathcal{H}_{f},\quad|i,\alpha%
\rangle\in\mathcal{H}_{i}.
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="S-matrix:154">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   α
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="S-matrix:155">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   β
  </annotation>
 </semantics>
</math>

 are shorthands that represent the particle content but suppresses the individual labels. Associated to the S-matrix there is the <strong>S-operator</strong> 

<math display="inline" id="S-matrix:156">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 defined by<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>

<p>

<math display="block" id="S-matrix:157">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>β</mi>
     </msub>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <msub>
      <mi mathvariant="normal">Φ</mi>
      <mi>α</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>≡</mo>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>β</mi>
      <mi>α</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="latexml">quantum-operator-product</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>β</ci>
     </apply>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <times></times>
      <ci>β</ci>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\Phi_{\beta}|S|\Phi_{\alpha}\rangle\equiv S_{\beta\alpha},
  </annotation>
 </semantics>
</math>

</p>

<p>where the <mtpl></mtpl> are free particle states.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> This definition conforms with the direct approach used in the interaction picture. Also, due to unitary equivalence,</p>

<p>

<math display="block" id="S-matrix:158">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>β</mi>
      <mo>+</mo>
     </msubsup>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>+</mo>
     </msubsup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>β</mi>
      <mi>α</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>β</mi>
      <mo>-</mo>
     </msubsup>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>-</mo>
     </msubsup>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <plus></plus>
      </apply>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <plus></plus>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <minus></minus>
      </apply>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <minus></minus>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\Psi_{\beta}^{+}|S|\Psi_{\alpha}^{+}\rangle=S_{\beta\alpha}=\langle\Psi%
_{\beta}^{-}|S|\Psi_{\alpha}^{-}\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>As a physical requirement, 

<math display="inline" id="S-matrix:159">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 must be a <a href="unitary_operator" title="wikilink">unitary operator</a>. This is a statement of conservation of probability in quantum field theory. But</p>

<p>

<math display="block" id="S-matrix:160">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>β</mi>
      <mo>-</mo>
     </msubsup>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>-</mo>
     </msubsup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>β</mi>
      <mi>α</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>β</mi>
      <mo>-</mo>
     </msubsup>
     <mo stretchy="false">|</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>+</mo>
     </msubsup>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <minus></minus>
      </apply>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <minus></minus>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>α</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>β</ci>
       </apply>
       <minus></minus>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <plus></plus>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\Psi_{\beta}^{-}|S|\Psi_{\alpha}^{-}\rangle=S_{\beta\alpha}=\langle\Psi%
_{\beta}^{-}|\Psi_{\alpha}^{+}\rangle.
  </annotation>
 </semantics>
</math>

 By completeness then,</p>

<p>

<math display="block" id="S-matrix:161">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo fence="true" stretchy="false">|</mo>
      <msubsup>
       <mi mathvariant="normal">Ψ</mi>
       <mi>α</mi>
       <mo>-</mo>
      </msubsup>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo fence="true" stretchy="false">|</mo>
     <msubsup>
      <mi mathvariant="normal">Ψ</mi>
      <mi>α</mi>
      <mo>+</mo>
     </msubsup>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Ψ</ci>
        <ci>α</ci>
       </apply>
       <minus></minus>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Ψ</ci>
       <ci>α</ci>
      </apply>
      <plus></plus>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S|\Psi_{\alpha}^{-}\rangle=|\Psi_{\alpha}^{+}\rangle,
  </annotation>
 </semantics>
</math>

 so S is the unitary transformation from in-states to out states. Lorentz invariance is another crucial requirement on the S-matrix.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a><a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> The S-operator represents the <a href="Matrix_mechanics#Transformation_theory" title="wikilink">quantum canonical transformation</a> of the initial <em>in</em> states to the final <em>out</em> states. Moreover, 

<math display="inline" id="S-matrix:162">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 leaves the vacuum state invariant and transforms <em>in</em>-space fields to <em>out</em>-space fields,<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>

<p>

<math display="block" id="S-matrix:163">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mrow>
     <mo fence="true">|</mo>
     <mn>0</mn>
     <mo>⟩</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo fence="true">|</mo>
    <mn>0</mn>
    <mo>⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S\left|0\right\rangle=\left|0\right\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="S-matrix:164">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ϕ</mi>
     <mi>f</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>S</mi>
     <msub>
      <mi>ϕ</mi>
      <mi>i</mi>
     </msub>
     <mpadded width="+3.3pt">
      <msup>
       <mi>S</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ϕ</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>S</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{f}=S\phi_{i}S^{-1}~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>In terms of creation and annihilation operators, this becomes</p>

<p>

<math display="block" id="S-matrix:165">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>f</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>p</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>S</mi>
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>p</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>S</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>a</mi>
       <mi>f</mi>
       <mo>†</mo>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>p</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mi>S</mi>
      <msubsup>
       <mi>a</mi>
       <mi>i</mi>
       <mo>†</mo>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>p</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>S</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>f</ci>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>i</ci>
      </apply>
      <ci>p</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>f</ci>
       </apply>
       <ci>normal-†</ci>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>i</ci>
       </apply>
       <ci>normal-†</ci>
      </apply>
      <ci>p</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{f}(p)=Sa_{i}(p)S^{-1},a_{f}^{\dagger}(p)=Sa_{i}^{\dagger}(p)S^{-1},
  </annotation>
 </semantics>
</math>

 hence</p>

<p>

<math display="inline" id="S-matrix:166">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mrow>
    <mo fence="true" stretchy="false">|</mo>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>k</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <msub>
      <mi>k</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <apply>
     <csymbol cd="latexml">ket</csymbol>
     <list>
      <ci>i</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>n</ci>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle S|i,k_{1},k_{2},\ldots,k_{n}\rangle
  </annotation>
 </semantics>
</math>


 A similar expression holds when 

<math display="inline" id="S-matrix:167">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 operates to the left on an out state. This means that the S-matrix can be expressed as</p>

<p>

<math display="block" id="S-matrix:168">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mrow>
      <mi>β</mi>
      <mi>α</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mi>o</mi>
      <mo>,</mo>
      <mi>β</mi>
     </mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>α</mi>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>β</mi>
     </mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>α</mi>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mi>o</mi>
      <mo>,</mo>
      <mi>β</mi>
     </mrow>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <mrow>
      <mi>o</mi>
      <mo>,</mo>
      <mi>α</mi>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <times></times>
       <ci>β</ci>
       <ci>α</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <list>
       <ci>o</ci>
       <ci>β</ci>
      </list>
      <list>
       <ci>i</ci>
       <ci>α</ci>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <list>
       <ci>i</ci>
       <ci>β</ci>
      </list>
      <ci>S</ci>
      <list>
       <ci>i</ci>
       <ci>α</ci>
      </list>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <list>
       <ci>o</ci>
       <ci>β</ci>
      </list>
      <ci>S</ci>
      <list>
       <ci>o</ci>
       <ci>α</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{\beta\alpha}=\langle o,\beta|i,\alpha\rangle=\langle i,\beta|S|i,\alpha%
\rangle=\langle o,\beta|S|o,\alpha\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>If 

<math display="inline" id="S-matrix:169">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 describes an interaction correctly, these properties must be also true:</p>
<ul>
<li>If the system is made up with <em>a single particle</em> in momentum eigenstate 

<math display="inline" id="S-matrix:170">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mi>k</mi>
   <mi mathvariant="normal">⟩</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">k</csymbol>
    <csymbol cd="unknown">⟩</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |k⟩
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="S-matrix:171">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo stretchy="false">|</mo>
   <mi>k</mi>
   <mi mathvariant="normal">⟩</mi>
   <mo>=</mo>
   <mo stretchy="false">|</mo>
   <mi>k</mi>
   <mi mathvariant="normal">⟩</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">S</csymbol>
    <ci>normal-|</ci>
    <csymbol cd="unknown">k</csymbol>
    <csymbol cd="unknown">⟩</csymbol>
    <eq></eq>
    <ci>normal-|</ci>
    <csymbol cd="unknown">k</csymbol>
    <csymbol cd="unknown">⟩</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S|k⟩=|k⟩
  </annotation>
 </semantics>
</math>

. This follows from the calculation above as a special case.</li>
<li>The S-matrix element may be nonzero only where the output state has the same total <a class="uri" href="momentum" title="wikilink">momentum</a> as the input state.This follows from the required Lorentz invariance of the S-matrix.</li>
</ul>
<h2 id="s-matrix-and-evolution-operator-u">S-matrix and evolution operator <em>U</em></h2>

<p>Define a time-dependent creation and annihilation operator as follows,</p>

<p>

<math display="block" id="S-matrix:172">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>a</mi>
     <mo>†</mo>
    </msup>
    <mrow>
     <mo>(</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>U</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msubsup>
     <mi>a</mi>
     <mi>i</mi>
     <mo>†</mo>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mi>k</mi>
     <mo>)</mo>
    </mrow>
    <mi>U</mi>
    <mrow>
     <mo>(</mo>
     <mi>t</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <ci>normal-†</ci>
     </apply>
     <interval closure="open">
      <ci>k</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>U</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-†</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
     <ci>U</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\dagger}\left(k,t\right)=U^{-1}(t)a^{\dagger}_{i}\left(k\right)U\left(t\right)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="S-matrix:173">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>a</mi>
     <mrow>
      <mo>(</mo>
      <mi>k</mi>
      <mo>,</mo>
      <mi>t</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>U</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>a</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>k</mi>
      <mo>)</mo>
     </mrow>
     <mi>U</mi>
     <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo rspace="5.8pt">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>a</ci>
     <interval closure="open">
      <ci>k</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>U</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>t</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <ci>i</ci>
     </apply>
     <ci>k</ci>
     <ci>U</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\left(k,t\right)=U^{-1}(t)a_{i}\left(k\right)U\left(t\right)~{},
  </annotation>
 </semantics>
</math>

 so, for the fields,</p>

<p>

<math display="block" id="S-matrix:174">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ϕ</mi>
     <mi>f</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>U</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">∞</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ϕ</mi>
      <mi>i</mi>
     </msub>
     <mi>U</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi mathvariant="normal">∞</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>S</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msub>
      <mi>ϕ</mi>
      <mi>i</mi>
     </msub>
     <mpadded width="+3.3pt">
      <mi>S</mi>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>U</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <infinity></infinity>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <ci>U</ci>
      <infinity></infinity>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>S</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <ci>S</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{f}=U^{-1}(\infty)\phi_{i}U(\infty)=S^{-1}\phi_{i}S~{},
  </annotation>
 </semantics>
</math>

 where</p>

<p>

<math display="block" id="S-matrix:175">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>α</mi>
      </mrow>
     </msup>
    </mpadded>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi mathvariant="normal">∞</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>α</ci>
      </apply>
     </apply>
     <ci>U</ci>
     <infinity></infinity>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=e^{i\alpha}\,U(\infty)
  </annotation>
 </semantics>
</math>

 .</p>

<p>We allow for a phase difference, given by</p>

<p>

<math display="block" id="S-matrix:176">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>i</mi>
      <mi>α</mi>
     </mrow>
    </msup>
    <mo>=</mo>
    <mpadded width="+3.3pt">
     <msup>
      <mrow>
       <mo>⟨</mo>
       <mn>0</mn>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>U</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi mathvariant="normal">∞</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mn>0</mn>
       <mo>⟩</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mpadded>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <cn type="integer">0</cn>
      <apply>
       <times></times>
       <ci>U</ci>
       <infinity></infinity>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{i\alpha}=\left\langle 0|U(\infty)|0\right\rangle^{-1}~{},
  </annotation>
 </semantics>
</math>

 because for 

<math display="inline" id="S-matrix:177">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="S-matrix:178">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mrow>
      <mo fence="true">|</mo>
      <mn>0</mn>
      <mo>⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo fence="true">|</mo>
     <mn>0</mn>
     <mo>⟩</mo>
    </mrow>
    <mo>⟹</mo>
    <mrow>
     <mo>⟨</mo>
     <mn>0</mn>
     <mo fence="true" stretchy="false">|</mo>
     <mi>S</mi>
     <mo fence="true" stretchy="false">|</mo>
     <mn>0</mn>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>⟨</mo>
     <mn>0</mn>
     <mo stretchy="false">|</mo>
     <mn>0</mn>
     <mo>⟩</mo>
    </mrow>
    <mo>=</mo>
    <mpadded width="+3.3pt">
     <mn>1</mn>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>S</ci>
      <apply>
       <csymbol cd="latexml">ket</csymbol>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">ket</csymbol>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <ci>normal-⟹</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">quantum-operator-product</csymbol>
      <cn type="integer">0</cn>
      <ci>S</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">inner-product</csymbol>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S\left|0\right\rangle=\left|0\right\rangle\Longrightarrow\left\langle 0|S|0%
\right\rangle=\left\langle 0|0\right\rangle=1~{}.
  </annotation>
 </semantics>
</math>

</p>

<p>Substituting the explicit expression for 

<math display="inline" id="S-matrix:179">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

, one has</p>

<p>

<math display="block" id="S-matrix:180">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mo>⟨</mo>
       <mn>0</mn>
       <mo fence="true" stretchy="false">|</mo>
       <mrow>
        <mi>U</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi mathvariant="normal">∞</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo fence="true" stretchy="false">|</mo>
       <mn>0</mn>
       <mo>⟩</mo>
      </mrow>
     </mfrac>
     <mi class="ltx_font_mathcaligraphic">𝒯</mi>
     <mpadded width="+3.3pt">
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>i</mi>
         <mstyle scriptlevel="-1">
          <mrow>
           <mo largeop="true" symmetric="true">∫</mo>
           <mrow>
            <mi>d</mi>
            <mi>τ</mi>
            <msub>
             <mi>H</mi>
             <mi>int</mi>
            </msub>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>τ</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mstyle>
        </mrow>
       </mrow>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="latexml">quantum-operator-product</csymbol>
       <cn type="integer">0</cn>
       <apply>
        <times></times>
        <ci>U</ci>
        <infinity></infinity>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <ci>𝒯</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>τ</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>H</ci>
           <ci>int</ci>
          </apply>
          <ci>τ</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\frac{1}{\left\langle 0|U(\infty)|0\right\rangle}\mathcal{T}e^{-i\int{d\tau H%
_{\rm{int}}(\tau)}}~{},
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="S-matrix:181">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>int</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>int</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\rm{int}}
  </annotation>
 </semantics>
</math>

 is the interaction part of the hamiltonian and 

<math display="inline" id="S-matrix:182">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒯</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒯</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{T}
  </annotation>
 </semantics>
</math>

 is the time ordering.</p>

<p>By inspection, it can be seen that this formula is not explicitly covariant.</p>
<h2 id="dyson-series">Dyson series</h2>

<p>The most widely used expression for the S-matrix is the <a href="Dyson_series" title="wikilink">Dyson series</a>. This expresses the S-matrix operator as the <a href="Series_(mathematics)" title="wikilink">series</a>:</p>

<p>

<math display="block" id="S-matrix:183">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>n</mi>
      </msup>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi mathvariant="normal">⋯</mi>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <msup>
          <mi>d</mi>
          <mn>4</mn>
         </msup>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msup>
          <mi>d</mi>
          <mn>4</mn>
         </msup>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
         <mi mathvariant="normal">…</mi>
         <msup>
          <mi>d</mi>
          <mn>4</mn>
         </msup>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mi>T</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <msub>
            <mi class="ltx_font_mathcaligraphic">ℋ</mi>
            <mi>int</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>x</mi>
             <mn>1</mn>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
           <msub>
            <mi class="ltx_font_mathcaligraphic">ℋ</mi>
            <mi>int</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>x</mi>
             <mn>2</mn>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi mathvariant="normal">⋯</mi>
           <msub>
            <mi class="ltx_font_mathcaligraphic">ℋ</mi>
            <mi>int</mi>
           </msub>
           <mrow>
            <mo stretchy="false">(</mo>
            <msub>
             <mi>x</mi>
             <mi>n</mi>
            </msub>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <ci>i</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <ci>normal-⋯</ci>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>d</ci>
           <cn type="integer">4</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>d</ci>
           <cn type="integer">4</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>normal-…</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>d</ci>
           <cn type="integer">4</cn>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>n</ci>
          </apply>
          <ci>T</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ℋ</ci>
             <ci>int</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <cn type="integer">1</cn>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ℋ</ci>
             <ci>int</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <cn type="integer">2</cn>
            </apply>
            <ci>normal-⋯</ci>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>ℋ</ci>
             <ci>int</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>n</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\sum_{n=0}^{\infty}\frac{(-i)^{n}}{n!}\int\cdots\int d^{4}x_{1}d^{4}x_{2}%
\ldots d^{4}x_{n}T[\mathcal{H}_{\rm{int}}(x_{1})\mathcal{H}_{\rm{int}}(x_{2})%
\cdots\mathcal{H}_{\rm{int}}(x_{n})]
  </annotation>
 </semantics>
</math>

</p>

<p>where:</p>
<ul>
<li>

<math display="inline" id="S-matrix:184">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T[\cdots]
  </annotation>
 </semantics>
</math>

 denotes <a class="uri" href="time-ordering" title="wikilink">time-ordering</a>,</li>
<li>

<math display="inline" id="S-matrix:185">
 <semantics>
  <mrow>
   <msub>
    <mpadded lspace="2.8pt" width="+2.8pt">
     <mi class="ltx_font_mathcaligraphic">ℋ</mi>
    </mpadded>
    <mi>int</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℋ</ci>
     <ci>int</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \;\mathcal{H}_{\rm{int}}(x)
  </annotation>
 </semantics>
</math>

 denotes the <a href="interaction_Hamiltonian" title="wikilink">interaction Hamiltonian</a> density which describes the interactions in the theory.</li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Feynman_diagram" title="wikilink">Feynman diagram</a></li>
<li><a href="LSZ_reduction_formula" title="wikilink">LSZ reduction formula</a></li>
<li><a href="Wick's_theorem" title="wikilink">Wick's theorem</a></li>
<li><a href="Haag's_theorem" title="wikilink">Haag's theorem</a></li>
<li><a href="Interaction_picture" title="wikilink">Interaction picture</a></li>
<li><a href="Dyson_series" title="wikilink">Dyson series</a></li>
</ul>
<h2 id="remarks">Remarks</h2>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p> §125</p></li>
<li></li>
<li></li>
</ul>
<ul>
<li></li>
<li></li>
</ul>
<ul>
<li></li>
<li></li>
</ul>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Quantum_field_theory" title="wikilink">Category:Quantum field theory</a> <a href="Category:Scattering_theory" title="wikilink">Category:Scattering theory</a> <a class="uri" href="Category:Matrices" title="wikilink">Category:Matrices</a> <a href="Category:Mathematical_physics" title="wikilink">Category:Mathematical physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">John Archibald Wheeler, '<a href="http://link.aps.org/abstract/PR/v52/p1107">On the Mathematical Description of Light Nuclei by the Method. of Resonating Group Structure</a>' Phys. Rev. 52, 1107–1122 (1937)<a href="#fnref1">↩</a></li>
<li id="fn2">Jagdish Mehra, Helmut Rechenberg, <em>The Historical Development of Quantum Theory</em> (Pages 990 and 1031) Springer, 2001 ISBN 0-387-95086-9, ISBN 978-0-387-95086-0<a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="Alexander_Migdal" title="wikilink">Alexander Migdal</a>, <a href="http://alexandermigdal.com/prose/paradise1.shtml">Paradise Lost, Part 1</a><a href="#fnref4">↩</a></li>
<li id="fn5"> Ch 6. A more common convention, utilized below, is to have the S-matrix go to the identity in the free particle case.<a href="#fnref5">↩</a></li>
<li id="fn6"> Section 8.2.<a href="#fnref6">↩</a></li>
<li id="fn7"> Equation 8.44.<a href="#fnref7">↩</a></li>
<li id="fn8"> Chapter 9.<a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"> Chapter 3. See especially remark at the beginning of section 3.2.<a href="#fnref10">↩</a></li>
<li id="fn11"> Chapter 3.<a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14">This is not true if an open system is studied. Under an influence of an external field the in and out vacua can differ since the external field can produce particles.<a href="#fnref14">↩</a></li>
<li id="fn15"></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"></li>
<li id="fn19"></li>
<li id="fn20"></li>
<li id="fn21">Here it is assumed that the full <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> 

<math display="inline" id="S-matrix:186">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 can be divided into two terms, a free-particle Hamiltonian <mtpl></mtpl> and an interaction 

<math display="inline" id="S-matrix:187">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

, <mtpl> <em>H</em><sub>0</sub> + <em>V</em>}}</mtpl> such that the eigenstates <mtpl></mtpl> of <mtpl></mtpl> have the same appearance as the in- and out-states with respect to normalization and Lorentz transformation properties. See , page 110.<a href="#fnref21">↩</a></li>
<li id="fn22"></li>
<li id="fn23">If 

<math display="inline" id="S-matrix:188">
 <semantics>
  <mi mathvariant="normal">Λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Λ
  </annotation>
 </semantics>
</math>

 is a (inhomogeneous) proper orthochronous Lorentz transformation, then <a href="Wigner's_theorem" title="wikilink">Wigner's theorem</a> guarantees the existence of a unitary operator 

<math display="inline" id="S-matrix:189">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Λ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <ci>normal-Λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(Λ)
  </annotation>
 </semantics>
</math>

 acting either on <mtpl></mtpl> <em>or</em> <mtpl></mtpl>. A theory is said to be Lorentz invariant if the same 

<math display="inline" id="S-matrix:190">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Λ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <ci>normal-Λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(Λ)
  </annotation>
 </semantics>
</math>

 acts on <mtpl></mtpl> <em>and</em> <mtpl></mtpl>. Using the unitarity of 

<math display="inline" id="S-matrix:191">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Λ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <ci>normal-Λ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(Λ)
  </annotation>
 </semantics>
</math>

, <mtpl> ⟨<em>i</em>, <em>β</em>{{!}}<em>f</em>, <em>α</em>⟩ {{=}} ⟨<em>i</em>, <em>β</em>{{!}}<em>U</em>(Λ)<sup>†</sup><em>U</em>(Λ){{!}}<em>f</em>, <em>α</em>⟩}}</mtpl>. The right-hand side can be expanded using knowledge about how the non-interacting states transform to obtain an expression, and that expression is to be taken as a <em>definition</em> of what it means for the S-matrix to be Lorentz invariant. See , equation 3.3.1 gives an explicit form.<a href="#fnref23">↩</a></li>
<li id="fn24">Here the <strong>postulate of asymptotic completeness</strong> is employed. The in and out states span the same Hilbert space, which is assumed to agree with the Hilbert space of the interacting theory. This is not a trivial postulate. If particles can be permanently combined into bound states, the structure of the Hilbert space changes. See , section 9.2.<a href="#fnref24">↩</a></li>
</ol>
</section>
</body>
</html>

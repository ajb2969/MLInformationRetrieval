   Thermodynamic integration      Thermodynamic integration  '''Thermodynamic integration''' is a method used to compare the di fference in free energy between two given states (e.g., A and B) whose potential energies    U  A     subscript  U  A    U_{A}   and    U  B     subscript  U  B    U_{B}   have different dependences on the spatial coordinates. Because the free energy of a system is not simply a function of the phase space coordinates of the system, but is instead a function of the Boltzmann-weighted integral over phase space (i.e. partition function ), the free energy difference between two states cannot be calculated directly. In thermodynamic integration, the free energy difference is calculated by defining a thermodynamic path between the states and integrating over ensemble-averaged enthalpy changes along the path. Such paths can either be real chemical processes or alchemical processes. An example alchemical process is the Kirkwood's coupling parameter method. 1  Derivation  Consider two systems, A and B, with potential energies    U  A     subscript  U  A    U_{A}   and    U  B     subscript  U  B    U_{B}   . The potential energy in either system can be calculated as an ensemble average over configurations sampled from a molecular dynamics or Monte Carlo simulation with proper Boltzmann weighting. Now consider a new potential energy function defined as:       U   (  λ  )    =    U  A   +   λ   (    U  B   -   U  A    )           U  λ      subscript  U  A     λ     subscript  U  B    subscript  U  A        U(\lambda)=U_{A}+\lambda(U_{B}-U_{A})     Here,   λ   λ   \lambda   is defined as a coupling parameter with a value between 0 and 1, and thus the potential energy as a function of   λ   λ   \lambda   varies from the energy of system A for    λ  =  0      λ  0    \lambda=0   and system B for    λ  =  1      λ  1    \lambda=1   . In the canonical ensemble , the partition function of the system can be written as:       Q   (  N  ,  V  ,  T  ,  λ  )    =    ∑  s    exp   [   -      U  s    (  λ  )    /   k  B    T    ]           Q   N  V  T  λ      subscript   s              subscript  U  s   λ    subscript  k  B    T        Q(N,V,T,\lambda)=\sum_{s}\exp[-U_{s}(\lambda)/k_{B}T]     In this notation,     U  s    (  λ  )        subscript  U  s   λ    U_{s}(\lambda)   is the potential energy of state   s   s   s   in the ensemble with potential energy function    U   (  λ  )       U  λ    U(\lambda)   as defined above. The free energy of this system is defined as:       F   (  N  ,  V  ,  T  ,  λ  )    =   -    k  B   T   ln  Q    (  N  ,  V  ,  T  ,  λ  )           F   N  V  T  λ         subscript  k  B   T    Q    N  V  T  λ       F(N,V,T,\lambda)=-k_{B}T\ln Q(N,V,T,\lambda)   ,  If we take the derivative of F with respect to λ, we will get that it equals the ensemble average of the derivative of potential energy with respect to λ.      Δ  F   (  A  →  B  )   =   ∫  0  1   d  λ     ∂  F    (  λ  )     ∂  λ    =  -   ∫  0  1   d  λ     k  B   T   Q     ∂  Q    ∂  λ    =   ∫  0  1   d  λ     k  B   T   Q    ∑  s    1    k  B   T    exp   [  -   U  s    (  λ  )   /   k  B   T  ]      ∂   U  s     (  λ  )     ∂  λ    =   ∫  0  1   d  λ    ⟨     ∂  U    (  λ  )     ∂  λ    ⟩   λ      fragments  Δ  F   fragments  normal-(  A  normal-→  B  normal-)     superscript   subscript   0   1   d  λ        F   λ     λ       superscript   subscript   0   1   d  λ       subscript  k  B   T   Q       Q     λ      superscript   subscript   0   1   d  λ       subscript  k  B   T   Q    subscript   s     1     subscript  k  B   T      fragments  normal-[    subscript  U  s    fragments  normal-(  λ  normal-)     subscript  k  B   T  normal-]          subscript  U  s    λ     λ      superscript   subscript   0   1   d  λ   subscript   fragments  normal-⟨        U   λ     λ    normal-⟩   λ     \Delta F(A\rightarrow B)=\int_{0}^{1}d\lambda\frac{\partial F(\lambda)}{%
 \partial\lambda}\par
 =-\int_{0}^{1}d\lambda\frac{k_{B}T}{Q}\frac{\partial Q}{%
 \partial\lambda}\par
 =\int_{0}^{1}d\lambda\frac{k_{B}T}{Q}\sum_{s}\frac{1}{k_{%
 B}T}\exp[-U_{s}(\lambda)/k_{B}T]\frac{\partial U_{s}(\lambda)}{\partial\lambda%
 }\par
 =\int_{0}^{1}d\lambda\left\langle\frac{\partial U(\lambda)}{\partial%
 \lambda}\right\rangle_{\lambda}     The change in free energy between states A and B can thus be computed from the integral of the ensemble averaged derivatives of potential energy over the coupling parameter   λ   λ   \lambda   . 2 In practice, this is performed by defining a potential energy function    U   (  λ  )       U  λ    U(\lambda)   , sampling the ensemble of equilibrium configurations at a series of   λ   λ   \lambda   values, calculating the ensemble-averaged derivative of    U   (  λ  )       U  λ    U(\lambda)   with respect to   λ   λ   \lambda   at each   λ   λ   \lambda   value, and finally computing the integral over the ensemble-averaged derivatives.  Umbrella sampling is a related free energy method. It adds a bias to the potential energy. In the limit of an infinite strong bias it is equivalent to thermodynamic integration. 3  See also   Free energy perturbation  Bennett acceptance ratio   References    "  Category:Computational chemistry     J. G. Kirkwood. Statistical mechanics of fluid mixtures, J. Chem. Phys., 3:300-313,1935 ↩  Frenkel, Daan and Smit, Berend. Understanding Molecular Simulation: From Algorithms to Applications. Academic Press, 2007 ↩  ↩     
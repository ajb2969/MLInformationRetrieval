<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1124">100 prisoners problem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>100 prisoners problem</h1>
<hr/>

<p> The <strong>100 prisoners problem</strong> is a <a href="Mathematics" title="wikilink">mathematical</a> <a class="uri" href="problem" title="wikilink">problem</a> from <a href="probability_theory" title="wikilink">probability theory</a> and <a class="uri" href="combinatorics" title="wikilink">combinatorics</a>. In this problem, in order to survive, 100 prisoners have to find their own numbers in one of 100 drawers. Thereby, each prisoner may open only 50 of the drawers and cannot communicate with the other prisoners. At first glance the situation appears hopeless, but a clever strategy exists which offers the prisoners a realistic chance of survival. The problem was first posed in 2003 by Danish computer scientist Peter Bro Miltersen.</p>
<h2 id="problem">Problem</h2>

<p>The 100 prisoners problem has different renditions in the literature. The following version is by <a href="Philippe_Flajolet" title="wikilink">Philippe Flajolet</a> and <a href="Robert_Sedgewick_(computer_scientist)" title="wikilink">Robert Sedgewick</a>:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<dl>
<dd><em>The director of a prison offers 100 prisoners on death row, which are numbered from 1 to 100, a last chance. In a room there is a cupboard with 100 drawers. The director puts in each drawer the number of exactly one prisoner in random order and closes the drawers afterwards. The prisoners enter the room one after another. Each prisoner may open and look into 50 drawers in any order and the drawers are closed again afterwards. If during this search every prisoner finds his number in one of the drawers, all prisoners are pardoned. If just one prisoner does not find his number, all prisoners have to die. Before the first prisoner enters the room, the prisoners may discuss their strategy, afterwards no communication of any means is possible. What is the best strategy for the prisoners?</em>
</dd>
</dl>

<p>If every prisoner selects 50 drawers at <a href="Randomness" title="wikilink">random</a>, the <a class="uri" href="probability" title="wikilink">probability</a> that a single prisoner finds his number is 50%. Therefore, the probability that all prisoners find their numbers is the <a href="product_(mathematics)" title="wikilink">product</a> of the single probabilities which is (½)<sup>100</sup> ≈ 0.0000000000000000000000000000008, a vanishingly small number. The situation appears hopeless for the prisoners.</p>
<h2 id="solution">Solution</h2>
<h3 id="strategy">Strategy</h3>

<p>Surprisingly, there is a strategy which gives the prisoners a survival probability of more than 30%. The key to success is that the prisoners do not have to decide beforehand which drawers they are going to open. Each prisoner can use the <a class="uri" href="information" title="wikilink">information</a> gained from the contents of previously opened drawers to help him decide which drawer to open next. Another important observation is that this way the success of one prisoner is not <a href="Stochastic_independence" title="wikilink">independent</a> of the success of the other prisoners.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>In order to describe the strategy, not only the prisoners, but also the drawers are numbered from 1 to 100, for example row by row starting with the top left drawer. The strategy is now as follows:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<ol>
<li>Each prisoner first opens the drawer with his own number.</li>
<li>If this drawer contains his number he is finished with his search and was successful.</li>
<li>Otherwise, the drawer contains the number of another prisoner and he next opens the drawer with this number.</li>
<li>The prisoner repeats steps 2 and 3 until he finds his own number or has opened 50 drawers.</li>
</ol>

<p>This approach ensures that every time a prisoner opens a drawer he either finds his own number or the number of another prisoner he has not encountered so far.</p>
<h3 id="examples">Examples</h3>

<p>The reason this is a promising strategy is illustrated with the following example using eight prisoners and drawers, whereby each prisoner may open four drawers. The prison director has distributed the prisoners' numbers into the drawers in the following fashion</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>style="background:#FFEBAD;" <strong>number of drawer</strong></p></td>
<td style="text-align: left;">
<p>  1  </p></td>
<td style="text-align: left;">
<p>  2  </p></td>
<td style="text-align: left;">
<p>  3  </p></td>
<td style="text-align: left;">
<p>  4  </p></td>
<td style="text-align: left;">
<p>  5  </p></td>
<td style="text-align: left;">
<p>  6  </p></td>
<td style="text-align: left;">
<p>  7  </p></td>
<td style="text-align: left;">
<p>  8  </p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>style="background:#FFEBAD;" <strong>number of prisoner</strong></p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>The prisoners now act as follows:</p>
<ul>
<li>Prisoner 1 first opens drawer 1 and finds number 7. Then he opens drawer 7 and finds number 5. Then he opens drawer 5 where he finds his own number and is successful.</li>
<li>Prisoner 2 opens drawers 2, 4, and 8 in this order. In the last drawer he finds his own number 2.</li>
<li>Prisoner 3 opens drawers 3 and 6, where he finds his own number.</li>
<li>Prisoner 4 opens drawers 4, 8, and 2 where he finds his own number. An outside observer could have derived this from the information gained by prisoner 2.</li>
<li>That prisoners 5 to 8 will also find their numbers can also be derived from the information gained by the first three prisoners.</li>
</ul>

<p>In this case, all prisoners will be successful in finding their numbers. This is, however, not always the case. In the following example the prison director has distributed the numbers like this:</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>style="background:#FFEBAD;" <strong>number of drawer</strong></p></td>
<td style="text-align: left;">
<p>  1  </p></td>
<td style="text-align: left;">
<p>  2  </p></td>
<td style="text-align: left;">
<p>  3  </p></td>
<td style="text-align: left;">
<p>  4  </p></td>
<td style="text-align: left;">
<p>  5  </p></td>
<td style="text-align: left;">
<p>  6  </p></td>
<td style="text-align: left;">
<p>  7  </p></td>
<td style="text-align: left;">
<p>  8  </p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>style="background:#FFEBAD;" <strong>number of prisoner</strong></p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p>2</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>In this case, prisoner 1 opens drawers 1, 3, 7, and 4, at which point he has to stop unsuccessfully. Except for prisoner 6, who directly finds his number, all other prisoners are also unsuccessful.</p>
<h3 id="permutation-representation">Permutation representation</h3>

<p>The prison director's assignment of prisoner numbers to drawers can mathematically be described as a <a class="uri" href="permutation" title="wikilink">permutation</a> of the numbers 1 to 100. Such a permutation is a <a href="bijection" title="wikilink">one-to-one mapping</a> of the set of natural numbers from 1 to 100 to itself. A sequence of numbers which after repeated application of the permutation returns to the first number is called a <a href="cyclic_permutation" title="wikilink">cycle</a> of the permutation. Every permutation can be decomposed into <a href="disjoint_sets" title="wikilink">disjoint</a> cycles, that is cycles which have no common elements. The permutation of the first example above can be written in <a href="cycle_notation" title="wikilink">cycle notation</a> as</p>

<p>

<math display="block" id="100_prisoners_problem:0">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mn>1</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>7</mn>
     </mpadded>
     <mn>5</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mn>2</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>4</mn>
     </mpadded>
     <mn>8</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mn>3</mn>
     </mpadded>
     <mn>6</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <cn type="integer">7</cn>
     <cn type="integer">5</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <cn type="integer">4</cn>
     <cn type="integer">8</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1~{}7~{}5)(2~{}4~{}8)(3~{}6)
  </annotation>
 </semantics>
</math>

</p>

<p>and thus consists of two cycles of length 3 and one cycle of length 2. The permutation of the second example is accordingly</p>

<p>

<math display="block" id="100_prisoners_problem:1">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mpadded width="+3.3pt">
      <mn>1</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>3</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>7</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>4</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>5</mn>
     </mpadded>
     <mpadded width="+3.3pt">
      <mn>8</mn>
     </mpadded>
     <mn>2</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>6</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <cn type="integer">3</cn>
     <cn type="integer">7</cn>
     <cn type="integer">4</cn>
     <cn type="integer">5</cn>
     <cn type="integer">8</cn>
     <cn type="integer">2</cn>
    </apply>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1~{}3~{}7~{}4~{}5~{}8~{}2)(6)
  </annotation>
 </semantics>
</math>

</p>

<p>and consists of a cycle of length 7 and a cycle of length 1. The cycle notation is not unique since a cycle of length 

<math display="inline" id="100_prisoners_problem:2">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 can be written in 

<math display="inline" id="100_prisoners_problem:3">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 different ways depending on the starting number of the cycle. During the opening the drawers in the above strategy, each prisoner follows a single cycle which always ends with his own number. In the case of eight prisoners, this cycle-following strategy is successful if and only if the length of the longest cycle of the permutation is at most 4. If a permutation contains a cycle of length 5 or more, all prisoners whose numbers lie in such a cycle will not have reached their own number after 4 steps.</p>
<h3 id="probability-of-success">Probability of success</h3>
<figure><b>(Figure)</b>
<figcaption>Probability distribution of the length of the longest cycle of a random permutation of the numbers 1 to 100. The green area corresponds to the survival probability of the prisoners</figcaption>
</figure>

<p>In the initial problem, the 100 prisoners will be successful if the longest cycle of the permutation has a length of at most 50. Their survival probability is therefore equal to the probability that a <a href="random_permutation" title="wikilink">random permutation</a> of the numbers 1 to 100 contains no cycle of length greater than 50. This probability is now determined.</p>

<p>A permutation of the numbers 1 to 100 can contain at most one cycle of length 

<math display="inline" id="100_prisoners_problem:4">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mn>50</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">50</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>50
  </annotation>
 </semantics>
</math>

. There are exactly 

<math display="inline" id="100_prisoners_problem:5">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mn>100</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>l</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <cn type="integer">100</cn>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\textstyle\left({{100}\atop{l}}\right)}
  </annotation>
 </semantics>
</math>

 ways to select the numbers of such a cycle (see <a class="uri" href="combination" title="wikilink">combination</a>). Within this cycle, these numbers can be arranged in 

<math display="inline" id="100_prisoners_problem:6">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>l</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <apply>
     <minus></minus>
     <ci>l</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (l-1)!
  </annotation>
 </semantics>
</math>

 ways since there are 

<math display="inline" id="100_prisoners_problem:7">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 possibilities to select the starting number of the cycle. The remaining numbers can be arranged in 

<math display="inline" id="100_prisoners_problem:8">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>100</mn>
     <mo>-</mo>
     <mi>l</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <apply>
     <minus></minus>
     <cn type="integer">100</cn>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (100-l)!
  </annotation>
 </semantics>
</math>

 ways. Therefore, the number of permutations of the numbers 1 to 100 with a cycle of length 

<math display="inline" id="100_prisoners_problem:9">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mn>50</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">50</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>50
  </annotation>
 </semantics>
</math>

 is equal to</p>

<p>

<math display="block" id="100_prisoners_problem:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mn>100</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>l</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>l</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>100</mn>
       <mo>-</mo>
       <mi>l</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>100</mn>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mi>l</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <cn type="integer">100</cn>
      <ci>l</ci>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <ci>l</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <cn type="integer">100</cn>
       <ci>l</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <cn type="integer">100</cn>
     </apply>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{100}\atop{l}}\right)}\cdot(l-1)!\cdot(100-l)!=\frac{100!}{l}
  </annotation>
 </semantics>
</math>

.</p>

<p>The probability, that a (<a href="Uniform_distribution_(discrete)" title="wikilink">uniformly distributed</a>) random permutation contains no cycle of length greater than 50 is with the formula for <a href="Event_(probability_theory)" title="wikilink">single events</a> and the formula for <a href="complementary_event" title="wikilink">complementary events</a> thus given by</p>

<p>

<math display="block" id="100_prisoners_problem:11">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>100</mn>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mn>100</mn>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mn>51</mn>
       </mfrac>
       <mo>+</mo>
       <mi mathvariant="normal">…</mi>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <mn>100</mn>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mn>100</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>51</mn>
      </mfrac>
      <mo>+</mo>
      <mi mathvariant="normal">…</mi>
      <mo>+</mo>
      <mfrac>
       <mn>1</mn>
       <mn>100</mn>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>H</mi>
       <mn>100</mn>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>H</mi>
       <mn>50</mn>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mn>0.31183</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <factorial></factorial>
         <cn type="integer">100</cn>
        </apply>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <divide></divide>
         <apply>
          <factorial></factorial>
          <cn type="integer">100</cn>
         </apply>
         <cn type="integer">51</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <divide></divide>
         <apply>
          <factorial></factorial>
          <cn type="integer">100</cn>
         </apply>
         <cn type="integer">100</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">51</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">100</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">100</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <cn type="integer">50</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.31183</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\frac{1}{100!}\left(\frac{100!}{51}+\ldots+\frac{100!}{100}\right)=1-\left(%
\frac{1}{51}+\ldots+\frac{1}{100}\right)=1-(H_{100}-H_{50})\approx 0.31183
  </annotation>
 </semantics>
</math>

,</p>

<p>where 

<math display="inline" id="100_prisoners_problem:12">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{n}
  </annotation>
 </semantics>
</math>

 is the 

<math display="inline" id="100_prisoners_problem:13">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

-th <a href="harmonic_number" title="wikilink">harmonic number</a>. Therefore, using the cycle-following strategy the prisoners survive in a surprising 31% of cases.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="asymptotics">Asymptotics</h3>
<figure><b>(Figure)</b>
<figcaption>The harmonic numbers are approximately given by the area under the hyperbola and can therefore be approximated by a logarithm</figcaption>
</figure>

<p>If 

<math display="inline" id="100_prisoners_problem:14">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2n
  </annotation>
 </semantics>
</math>

 instead of 100 prisoners are considered, where 

<math display="inline" id="100_prisoners_problem:15">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 an arbitrary natural number, the prisoners' survival probability with the cycle-following strategy is given by</p>

<p>

<math display="block" id="100_prisoners_problem:16">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>H</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>H</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>H</mi>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
        </msub>
        <mo>-</mo>
        <mrow>
         <mi>ln</mi>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>H</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <mi>ln</mi>
        <mi>n</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>ln</mi>
     <mn>2</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <ln></ln>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <ln></ln>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ln></ln>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-(H_{2n}-H_{n})=1-(H_{2n}-\ln 2n)+(H_{n}-\ln n)-\ln 2
  </annotation>
 </semantics>
</math>

.</p>

<p>With the <a href="Euler_Mascheroni_constant" title="wikilink">Euler Mascheroni constant</a> 

<math display="inline" id="100_prisoners_problem:17">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="100_prisoners_problem:18">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>→</mo>
   <mi mathvariant="normal">∞</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>n</ci>
    <infinity></infinity>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\to\infty
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="100_prisoners_problem:19">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>n</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munder>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>H</mi>
       <mi>n</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <mi>ln</mi>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>γ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>n</ci>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <ln></ln>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{n\to\infty}(H_{n}-\ln n)=\gamma
  </annotation>
 </semantics>
</math>

</p>

<p>holds, which results in an asymptotic survival probability of</p>

<p>

<math display="block" id="100_prisoners_problem:20">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>n</mi>
      <mo>→</mo>
      <mi mathvariant="normal">∞</mi>
     </mrow>
    </munder>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>H</mi>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>+</mo>
      <msub>
       <mi>H</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>γ</mi>
     </mrow>
     <mo>+</mo>
     <mi>γ</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>ln</mi>
     <mn>2</mn>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mrow>
     <mi>ln</mi>
     <mn>2</mn>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mn>0.30685</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-→</ci>
        <ci>n</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>H</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>γ</ci>
       </apply>
       <ci>γ</ci>
      </apply>
      <apply>
       <ln></ln>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <ln></ln>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.30685</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{n\to\infty}(1-H_{2n}+H_{n})=1-\gamma+\gamma-\ln 2=1-\ln 2\approx 0.30685
  </annotation>
 </semantics>
</math>

.</p>

<p>Since the sequence of probabilities is <a href="monotonically_decreasing" title="wikilink">monotonically decreasing</a>, the prisoners survive with the cycle-following strategy in more than 30% of cases independently of the number of prisoners.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h3 id="optimality">Optimality</h3>

<p>In 2006, Eugene Curtin and Max Warshauer gave a proof for the optimality of the cycle-following strategy. The proof is based on an equivalence to a related problem in which all prisoners are allowed to be present in the room and observe the opening of the drawers. Mathematically, this equivalence is based on <a href="Permutation#Foata's_transition_lemma_(or_the_fundamental_bijection)" title="wikilink">Foata's transition lemma</a>, a one-to-one correspondence of the (canonical) cycle notation and the one-line notation of permutations. In the second problem, the survival probability is independent of the chosen strategy and equal to the survival probability in the original problem with the cycle-following strategy. Since an arbitrary strategy for the original problem can also be applied to the second problem, but cannot attain a higher survival probability there, the cycle-following strategy has to be optimal.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="history">History</h2>

<p>The 100 prisoners problem was first considered in 2003 by Danish computer scientist Peter Bro Miltersen who published it with Anna Gál in the <a href="conference_proceedings" title="wikilink">proceedings</a> of the <em>30. International Colloquium on Automata, Languages and Programming</em> (ICALP).<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> In their version, player A (the prison director) randomly colors strips of paper with the names of the players of team B (the prisoners) in red or blue and puts each strip into a different box. Every player of team B has to guess his color correctly after opening half of the boxes in order for their team to win. Initially, Milterson assumed that the winning probability quickly tends to zero with increasing number of players. Sven Skyum, a colleague of Miltersen at <a href="Aarhus_University" title="wikilink">Aarhus University</a>, however brought his attention to the cycle-following strategy. To find this strategy was left open as an exercise in the publication. The paper was honored with the best paper award.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>In spring 2004, the problem appeared in Joe Buhler and <a href="Elwyn_Berlekamp" title="wikilink">Elwyn Berlekamp</a>'s puzzle column of the quarterly <em>The Emissary</em> of the <a href="Mathematical_Sciences_Research_Institute" title="wikilink">Mathematical Sciences Research Institute</a>. Thereby, the authors replaced boxes by <a href="Read-only_memory" title="wikilink">ROMs</a> and colored strips of paper by <a href="Sign_(mathematics)" title="wikilink">signed</a> numbers. The authors noted that the winning probability can be increased also in the case where the team members don't find their own numbers. If the given answer is the product of all the signs found and if the length of the longest cycle is half the (even) number of players plus one, then the team members in this cycle either all guess wrong or all guess right. Even if this extension of the strategy offers a visible improvement for a small number of players, it becomes neglibile when the number of players becomes large.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>In the following years, the problem entered the mathematical literature, where it was shaped in further different ways, for example with cards on a table<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> or wallets in lockers (<em>locker puzzle</em>).<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> In the form of a prisoner problem it was posed in 2006 by Christoph Pöppe in the journal <em><a href="Spektrum_der_Wissenschaft" title="wikilink">Spektrum der Wissenschaft</a></em> and by <a href="Peter_Winkler" title="wikilink">Peter Winkler</a> in the <em><a href="College_Mathematics_Journal" title="wikilink">College Mathematics Journal</a></em>.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> With slight alterations this form was adopted by Philippe Flajolet, Robert Sedgewick und <a href="Richard_P._Stanley" title="wikilink">Richard P. Stanley</a> in their textbooks on combinatorics.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="variants">Variants</h2>
<h3 id="empty-boxes">Empty boxes</h3>

<p>At first, Gál and Miltersen considered in their paper the case that the number of boxes is twice the number of team members while half of the boxes are empty. This is a more difficult problem since empty boxes lead nowhere and thus the cycle-following strategy cannot be applied. It is an open problem if in this case the winning probability tends to zero with growing number of team members.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>In 2005, Navin Goyal and <a href="Michael_Saks_(mathematician)" title="wikilink">Michael Saks</a> developed a strategy for team B based on the cycle-following strategy for a more general problem in which the fraction of empty boxes as well as the fraction of boxes each team member is allowed to open are variable. The winning probability still tends to zero in this case, but slower than suggested by Gál and Miltersen. If the number of team members and the fraction of boxes which are opened is fixed, the winning probability stays strictly larger than zero when more empty boxes are added.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>

<p>David Avis and Anne Broadbent considered in 2009 a <a href="Quantum_complexity_theory" title="wikilink">quantum theoretical</a> variant in which team B wins with certainty.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>
<h3 id="the-malicious-director">The malicious director</h3>

<p>In case the prison director does not have to distribute the numbers into the drawers randomly, he can foil the prisoners' strategy if he knows the numbering of the drawers. To this end, he just has to ensure that his assignment of prisoners' numbers to drawers constitutes a permutation with a cycle of length larger than 50. The prisoners in turn can counter this by choosing their own numbering of the drawers randomly.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>
<h3 id="monty-hall-problem">Monty Hall problem</h3>

<p>In 2009, Adam S. Landsberg proposed the following simpler variant of the 100 prisoners problem which is based on the well-known <a href="Monty_Hall_problem" title="wikilink">Monty Hall problem</a>:<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p>
<dl>
<dd><em>Behind three closed doors a car, the car keys and a goat are randomly distributed. There are two players: the first player has to find the car, the second player the keys to the car. Only if both players are successful they may drive the car home. The first player enters the room and may consecutively open two of the three doors. If he is successful, the doors are closed again and the second player enters the room. The second player may also open two of the three doors, but he cannot communicate with the first player in any form. What is the winning probability if both players act optimally?</em>
</dd>
</dl>

<p>If the players select their doors randomly, the winning probability is only 4/9 (about 44%). The optimal strategy is, however, as follows:</p>
<ul>
<li>Player 1 first opens door 1. If the car is behind the door, he is successful. If the keys are behind the door, he next opens door 2, if the goat is behind the door, he next opens door 3.</li>
<li>Player 2 first opens door 2. If the keys are behind the door, he is successful. If the goat is behind the door, he next opens door 3, if the car is behind the door, he next opens door 1.</li>
</ul>

<p>In the six possible distributions of car, keys and goat behind the three doors, the players open the following doors (in the green cases, the player was successful):</p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>Car − Keys − Goat</p></td>
<td style="text-align: left;">
<p>Car − Goat − Keys</p></td>
<td style="text-align: left;">
<p>Keys − Car − Goat</p></td>
<td style="text-align: left;">
<p>Keys − Goat − Car</p></td>
<td style="text-align: left;">
<p>Goat − Car − Keys</p></td>
<td style="text-align: left;">
<p>Goat − Keys − Car</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Player 1</p></td>
<td style="text-align: left;">
<p>Door 1: Car</p></td>
<td style="text-align: left;">
<p>Door 1: Car</p></td>
<td style="text-align: left;">
<p>Door 1: Keys<br/>
 Door 2: Car</p></td>
<td style="text-align: left;">
<p>Door 1: Keys<br/>
 Door 2: Goat</p></td>
<td style="text-align: left;">
<p>Door 1: Goat<br/>
 Door 3: Keys</p></td>
<td style="text-align: left;">
<p>Door 1: Goat<br/>
 Door 3: Car</p></td>
</tr>
<tr class="odd">
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Player 2</p></td>
<td style="text-align: left;">
<p>Door 2: Keys</p></td>
<td style="text-align: left;">
<p>Door 2: Goat<br/>
 Door 3: Keys</p></td>
<td style="text-align: left;">
<p>Door 2: Car<br/>
 Door 1: Keys</p></td>
<td style="text-align: left;">
<p>(Door 2: Goat)<br/>
 (Door 3: Car)</p></td>
<td style="text-align: left;">
<p>(Door 2: Car)<br/>
 (Door 1: Goat)</p></td>
<td style="text-align: left;">
<p>Door 2: Keys</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>The success of the strategy is based on building a correlation between the successes and failures of the two players. Here, the winning probability is 2/3 which is optimal since the first player does not have a higher winning probability.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> In a further variant, three prizes are hidden behind the three doors and three players have to independently find their assigned prizes with two tries. In this case the winning probability is also 2/3 when the optimal strategy is employed.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Prisoner's_dilemma" title="wikilink">Prisoner's dilemma</a></li>
<li><a href="Three_prisoners_problem" title="wikilink">Three prisoners problem</a></li>
<li><a href="Random_permutation_statistics" title="wikilink">Random permutation statistics</a></li>
<li><a href="Golomb-Dickman_constant" title="wikilink">Golomb-Dickman constant</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="literature">Literature</h2>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>Rob Heaton: <a href="http://robertheaton.com/2014/01/13/mathematicians-hate-civil-liberties-100-prisoners-100-boxes/">Mathematicians hate civil liberties - 100 prisoners and 100 boxes</a>, 13 January 2014</li>
<li>Oliver Nash: <a href="http://ocfnash.wordpress.com/2009/12/12/pity-the-prisoners/">Pity the prisoners</a>, 12 December 2009</li>
<li>Jamie Mulholland: <a href="http://people.math.sfu.ca/~jtmulhol/math302/notes/25-Prisoners-in-Boxes.pdf">Prisoners in Boxes</a>, Spring 2011 (PDF)</li>
<li><a class="uri" href="MinutePhysics" title="wikilink">MinutePhysics</a>:  and , 8 December 2014</li>
</ul>

<p>"</p>

<p><a href="Category:Recreational_mathematics" title="wikilink">Category:Recreational mathematics</a> <a href="Category:Probability_theory_paradoxes" title="wikilink">Category:Probability theory paradoxes</a> <a class="uri" href="Category:Permutations" title="wikilink">Category:Permutations</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"></li>
<li id="fn15"></li>
<li id="fn16"></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
</ol>
</section>
</body>
</html>

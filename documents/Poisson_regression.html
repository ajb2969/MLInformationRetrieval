<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1155">Poisson regression</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Poisson regression</h1>
<hr/>

<p>In <a class="uri" href="statistics" title="wikilink">statistics</a>, <strong>Poisson regression</strong> is a form of <a href="regression_analysis" title="wikilink">regression analysis</a> used to model <a href="count_data" title="wikilink">count data</a> and <a href="contingency_table" title="wikilink">contingency tables</a>. Poisson regression assumes the response variable <em>Y</em> has a <a href="Poisson_distribution" title="wikilink">Poisson distribution</a>, and assumes the <a class="uri" href="logarithm" title="wikilink">logarithm</a> of its <a href="expected_value" title="wikilink">expected value</a> can be modeled by a linear combination of unknown <a href="parameter" title="wikilink">parameters</a>. A Poisson regression model is sometimes known as a <a href="log-linear_model" title="wikilink">log-linear model</a>, especially when used to model contingency tables.</p>

<p>Poisson regression models are <a href="generalized_linear_model" title="wikilink">generalized linear models</a> with the logarithm as the (canonical) <a href="link_function" title="wikilink">link function</a>, and the <a href="Poisson_distribution" title="wikilink">Poisson</a> distribution function as the assumed probability distribution of the response.</p>
<h2 id="regression-models">Regression models</h2>

<p>If 

<math display="inline" id="Poisson_regression:0">
 <semantics>
  <mrow>
   <mi>𝐱</mi>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>𝐱</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}\in\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

 is a vector of <a href="independent_variables" title="wikilink">independent variables</a>, then the model takes the form</p>

<p>

<math display="block" id="Poisson_regression:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>∣</mo>
        <mi>𝐱</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>α</mi>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>β</mi>
       <mo>′</mo>
      </msup>
      <mi>𝐱</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <log></log>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
      <ci>𝐱</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <ci>α</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>𝐱</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log(\operatorname{E}(Y\mid\mathbf{x}))=\alpha+\mathbf{\beta}^{\prime}\mathbf{%
x},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Poisson_regression:2">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>∈</mo>
   <mi>ℝ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>α</ci>
    <ci>ℝ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\in\mathbb{R}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Poisson_regression:3">
 <semantics>
  <mrow>
   <mi>β</mi>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>β</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{\beta}\in\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

. Sometimes this is written more compactly as</p>

<p>

<math display="block" id="Poisson_regression:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>∣</mo>
        <mi>𝐱</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝜽</mi>
      <mo>′</mo>
     </msup>
     <mi>𝐱</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <log></log>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
      <ci>𝐱</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝜽</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>𝐱</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log(\operatorname{E}(Y\mid\mathbf{x}))=\boldsymbol{\theta}^{\prime}\mathbf{x},\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>x</strong> is now an (<em>n</em> + 1)-dimensional vector consisting of <em>n</em> independent variables concatenated to a vector of ones. Here <strong><em>θ</em></strong> is simply <em>α</em> concatenated to <strong>β</strong>.</p>

<p>Thus, when given a Poisson regression model <strong><em>θ</em></strong> and an input vector <strong>x</strong>, the predicted mean of the associated Poisson distribution is given by</p>

<p>

<math display="block" id="Poisson_regression:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo>∣</mo>
      <mi>𝐱</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <msup>
       <mi>𝜽</mi>
       <mo>′</mo>
      </msup>
      <mi>𝐱</mi>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>Y</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝜽</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>𝐱</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(Y\mid\mathbf{x})=e^{\boldsymbol{\theta}^{\prime}\mathbf{x}}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>If <em>Y</em><sub><em>i</em></sub> are <a href="statistical_independence" title="wikilink">independent</a> observations with corresponding values <strong>x</strong><sub><em>i</em></sub> of the predictor variables, then <strong><em>θ</em></strong> can be estimated by <a href="maximum_likelihood" title="wikilink">maximum likelihood</a>. The maximum-likelihood estimates lack a <a href="closed-form_expression" title="wikilink">closed-form expression</a> and must be found by numerical methods. The probability surface for maximum-likelihood Poisson regression is always concave, making Newton–Raphson or other gradient-based methods appropriate estimation techniques.</p>
<h2 id="maximum-likelihood-based-parameter-estimation">Maximum likelihood-based parameter estimation</h2>

<p>Given a set of parameters <em>θ</em> and an input vector <em>x</em>, the mean of the predicted <a href="Poisson_distribution" title="wikilink">Poisson distribution</a>, as stated above, is given by</p>

<p>

<math display="block" id="Poisson_regression:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>E</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo>∣</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>e</mi>
     <mrow>
      <msup>
       <mi>θ</mi>
       <mo>′</mo>
      </msup>
      <mi>x</mi>
     </mrow>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <ci>Y</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>θ</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(Y\mid x)=e^{\theta^{\prime}x}\,
  </annotation>
 </semantics>
</math>

,</p>

<p>and thus, the Poisson distribution's <a href="probability_mass_function" title="wikilink">probability mass function</a> is given by</p>

<p>

<math display="block" id="Poisson_regression:7">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>y</mi>
    <mo>∣</mo>
    <mi>x</mi>
    <mo>;</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mo>E</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Y</mi>
         <mo>∣</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <mi>y</mi>
     </msup>
     <mo>×</mo>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mo>E</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Y</mi>
         <mo>∣</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <mi>y</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>y</mi>
       <msup>
        <mi>θ</mi>
        <mo>′</mo>
       </msup>
       <mi>x</mi>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <msup>
        <mi>e</mi>
        <mrow>
         <msup>
          <mi>θ</mi>
          <mo>′</mo>
         </msup>
         <mi>x</mi>
        </mrow>
       </msup>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <mi>y</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-;</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <ci>normal-E</ci>
         <ci>Y</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <ci>normal-E</ci>
         <ci>Y</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <ci>y</ci>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>y</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>θ</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>θ</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <ci>y</ci>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y\mid x;\theta)=\frac{[\operatorname{E}(Y\mid x)]^{y}\times e^{-%
\operatorname{E}(Y\mid x)}}{y!}=\frac{e^{y\theta^{\prime}x}e^{-e^{\theta^{%
\prime}x}}}{y!}
  </annotation>
 </semantics>
</math>

</p>

<p>Now suppose we are given a data set consisting of <em>m</em> vectors 

<math display="inline" id="Poisson_regression:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>∈</mo>
    <msup>
     <mi>ℝ</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo rspace="4.2pt">,</mo>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mi mathvariant="normal">…</mi>
     <mo>,</mo>
     <mi>m</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>ℝ</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <ci>m</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}\in\mathbb{R}^{n+1},\,i=1,\ldots,m
  </annotation>
 </semantics>
</math>

, along with a set of <em>m</em> values 

<math display="inline" id="Poisson_regression:9">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>m</mi>
    </msub>
   </mrow>
   <mo>∈</mo>
   <mi>ℝ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>m</ci>
     </apply>
    </list>
    <ci>ℝ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{1},\ldots,y_{m}\in\mathbb{R}
  </annotation>
 </semantics>
</math>

. Then, for a given set of parameters <em>θ</em>, the probability of attaining this particular set of data is given by</p>

<p>

<math display="block" id="Poisson_regression:10">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>m</mi>
    </msub>
    <mo>∣</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>x</mi>
     <mi>m</mi>
    </msub>
    <mo>;</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <mfrac>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mi>θ</mi>
        <mo>′</mo>
       </msup>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <msup>
        <mi>e</mi>
        <mrow>
         <msup>
          <mi>θ</mi>
          <mo>′</mo>
         </msup>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </msup>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>m</ci>
     </apply>
     <ci>normal-∣</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>m</ci>
     </apply>
     <ci>normal-;</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>θ</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>θ</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{1},\ldots,y_{m}\mid x_{1},\ldots,x_{m};\theta)=\prod_{i=1}^{m}\frac{e^{y_%
{i}\theta^{\prime}x_{i}}e^{-e^{\theta^{\prime}x_{i}}}}{y_{i}!}.
  </annotation>
 </semantics>
</math>

</p>

<p>By the method of <a href="maximum_likelihood" title="wikilink">maximum likelihood</a>, we wish to find the set of parameters <em>θ</em> that makes this probability as large as possible. To do this, the equation is first rewritten as a <a href="likelihood_function" title="wikilink">likelihood function</a> in terms of θ:</p>

<p>

<math display="block" id="Poisson_regression:11">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo>∣</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <mfrac>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mi>θ</mi>
        <mo>′</mo>
       </msup>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </msup>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <msup>
        <mi>e</mi>
        <mrow>
         <msup>
          <mi>θ</mi>
          <mo>′</mo>
         </msup>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
        </mrow>
       </msup>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>θ</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>θ</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(\theta\mid X,Y)=\prod_{i=1}^{m}\frac{e^{y_{i}\theta^{\prime}x_{i}}e^{-e^{%
\theta^{\prime}x_{i}}}}{y_{i}!}
  </annotation>
 </semantics>
</math>

.</p>

<p>Note that the expression on the <a href="Sides_of_an_equation" title="wikilink">right hand side</a> has not actually changed. A formula in this form is typically difficult to work with; instead, one uses the <em>log-likelihood</em>:</p>

<p>

<math display="block" id="Poisson_regression:12">
 <semantics>
  <mrow>
   <mi mathvariant="normal">ℓ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo>∣</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>log</mi>
   <mi>L</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo>∣</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <msup>
     <mi>θ</mi>
     <mo>′</mo>
    </msup>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <msup>
       <mi>θ</mi>
       <mo>′</mo>
      </msup>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </msup>
    <mo>-</mo>
    <mi>log</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ℓ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <log></log>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <minus></minus>
     <log></log>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
      <factorial></factorial>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell(\theta\mid X,Y)=\log L(\theta\mid X,Y)=\sum_{i=1}^{m}\left(y_{i}\theta^{%
\prime}x_{i}-e^{\theta^{\prime}x_{i}}-\log(y_{i}!)\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>Notice that the parameters <em>θ</em> only appear in the first two terms of each term in the summation. Therefore, given that we are only interested in finding the best value for <em>θ</em> we may drop the <em>y</em><sub><em>i</em></sub>! and simply write</p>

<p>

<math display="block" id="Poisson_regression:13">
 <semantics>
  <mrow>
   <mi mathvariant="normal">ℓ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo>∣</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <msup>
     <mi>θ</mi>
     <mo>′</mo>
    </msup>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <msup>
       <mi>θ</mi>
       <mo>′</mo>
      </msup>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ℓ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ell(\theta\mid X,Y)=\sum_{i=1}^{m}\left(y_{i}\theta^{\prime}x_{i}-e^{\theta^{%
\prime}x_{i}}\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>To find a maximum, we need to solve an equation 

<math display="inline" id="Poisson_regression:14">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi mathvariant="normal">ℓ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo>∣</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>θ</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <partialdiff></partialdiff>
      <csymbol cd="unknown">ℓ</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-∣</ci>
       <csymbol cd="unknown">X</csymbol>
       <ci>normal-,</ci>
       <csymbol cd="unknown">Y</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <partialdiff></partialdiff>
      <ci>θ</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial\ell(\theta\mid X,Y)}{\partial\theta}=0
  </annotation>
 </semantics>
</math>

 which has no closed-form solution. However, the negative log-likelihood, 

<math display="inline" id="Poisson_regression:15">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mi mathvariant="normal">ℓ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo>∣</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <minus></minus>
    <csymbol cd="unknown">ℓ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-∣</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\ell(\theta\mid X,Y)
  </annotation>
 </semantics>
</math>

, is a convex function, and so standard <a href="convex_optimization" title="wikilink">convex optimization</a> techniques such as <a href="gradient_descent" title="wikilink">gradient descent</a> can be applied to find the optimal value of <em>θ</em>.</p>
<h2 id="poisson-regression-in-practice">Poisson regression in practice</h2>

<p>Poisson regression may be appropriate when the dependent variable is a count, for instance of <a href="Poisson_distribution#Occurrence" title="wikilink">events</a> such as the arrival of a telephone call at a call centre.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The events must be independent in the sense that the arrival of one call will not make another more or less likely, but the probability per unit time of events is understood to be related to covariates such as time of day.</p>
<h3 id="exposure-and-offset">"Exposure" and offset</h3>

<p>Poisson regression may also be appropriate for rate data, where the rate is a count of events occurring to a particular unit of observation, divided by some measure of that unit's <em>exposure</em>. For example, biologists may count the number of tree species in a forest, and the rate would be the number of species per square kilometre. Demographers may model death rates in geographic areas as the count of deaths divided by person−years. More generally, event rates can be calculated as events per unit time, which allows the observation window to vary for each unit. In these examples, exposure is respectively unit area, person−years and unit time. In Poisson regression this is handled as an <strong>offset</strong>, where the exposure variable enters on the right-hand side of the equation, but with a parameter estimate (for log(exposure)) constrained to 1.</p>

<p>

<math display="block" id="Poisson_regression:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>E</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Y</mi>
       <mo>∣</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mtext>exposure</mtext>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>θ</mi>
      <mo>′</mo>
     </msup>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <log></log>
     <apply>
      <ci>normal-E</ci>
      <ci>Y</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <log></log>
      <mtext>exposure</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>θ</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log{(\operatorname{E}(Y\mid x))}=\log{(\text{exposure})}+\theta^{\prime}x
  </annotation>
 </semantics>
</math>

 which implies</p>

<p>

<math display="block" id="Poisson_regression:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>∣</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mtext>exposure</mtext>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>log</mi>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mrow>
       <mo>E</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Y</mi>
        <mo>∣</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mtext>exposure</mtext>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>θ</mi>
     <mo>′</mo>
    </msup>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <log></log>
       <apply>
        <ci>normal-E</ci>
        <ci>Y</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <log></log>
       <mtext>exposure</mtext>
      </apply>
     </apply>
     <apply>
      <log></log>
      <apply>
       <divide></divide>
       <apply>
        <ci>normal-E</ci>
        <ci>Y</ci>
        <ci>x</ci>
       </apply>
       <mtext>exposure</mtext>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>θ</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log{(\operatorname{E}(Y\mid x))}-\log{(\text{exposure})}=\log{\left(\frac{%
\operatorname{E}(Y\mid x)}{\text{exposure}}\right)}=\theta^{\prime}x
  </annotation>
 </semantics>
</math>

</p>

<p>Offset in the case of a <a href="Generalized_linear_model" title="wikilink">GLM</a> in <a href="R_(programming_language)" title="wikilink">R</a> can be achieved using the offset() function:</p>
<pre class="rsplus"><code>glm(y ~ offset(log(exposure)) + x, family=poisson(link=log) )</code></pre>
<h3 id="overdispersion-and-zero-inflation">Overdispersion and zero inflation</h3>

<p>A characteristic of the <a href="Poisson_distribution" title="wikilink">Poisson distribution</a> is that its mean is equal to its variance. In certain circumstances, it will be found that the observed <a class="uri" href="variance" title="wikilink">variance</a> is greater than the mean; this is known as <a class="uri" href="overdispersion" title="wikilink">overdispersion</a> and indicates that the model is not appropriate. A common reason is the omission of relevant explanatory variables, or dependent observations. Under some circumstances, the problem of overdispersion can be solved by using <a class="uri" href="quasi-likelihood" title="wikilink">quasi-likelihood</a> estimation or a <a href="negative_binomial_distribution" title="wikilink">negative binomial distribution</a> instead.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Another common problem with Poisson regression is excess zeros: if there are two processes at work, one determining whether there are zero events or any events, and a Poisson process determining how many events there are, there will be more zeros than a Poisson regression would predict. An example would be the distribution of cigarettes smoked in an hour by members of a group where some individuals are non-smokers.</p>

<p>Other <a href="generalized_linear_model" title="wikilink">generalized linear models</a> such as the <a href="negative_binomial_distribution" title="wikilink">negative binomial</a> model or <a href="zero-inflated_model" title="wikilink">zero-inflated model</a> may function better in these cases.</p>
<h3 id="use-in-survival-analysis">Use in survival analysis</h3>

<p>Poisson regression creates proportional hazards models, one class of <a href="survival_analysis" title="wikilink">survival analysis</a>: see <a href="proportional_hazards_models" title="wikilink">proportional hazards models</a> for descriptions of Cox models.</p>
<h2 id="extensions">Extensions</h2>
<h3 id="regularized-poisson-regression">Regularized Poisson regression</h3>

<p>When estimating the parameters for Poisson regression, one typically tries to find values for <em>θ</em> that maximize the likelihood of an expression of the form</p>

<p>

<math display="block" id="Poisson_regression:18">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </munderover>
    <mrow>
     <mi>log</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>p</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo>;</mo>
        <msup>
         <mi>e</mi>
         <mrow>
          <msup>
           <mi>θ</mi>
           <mo>′</mo>
          </msup>
          <mi>x</mi>
         </mrow>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>m</ci>
    </apply>
    <apply>
     <log></log>
     <apply>
      <times></times>
      <ci>p</ci>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>θ</ci>
          <ci>normal-′</ci>
         </apply>
         <ci>x</ci>
        </apply>
       </apply>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{m}\log(p(y_{i};e^{\theta^{\prime}x})),
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>m</em> is the number of examples in the data set, and 

<math display="inline" id="Poisson_regression:19">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>;</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <msup>
       <mi>θ</mi>
       <mo>′</mo>
      </msup>
      <mi>x</mi>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{i};e^{\theta^{\prime}x})
  </annotation>
 </semantics>
</math>

 is the <a href="probability_mass_function" title="wikilink">probability mass function</a> of the <a href="Poisson_distribution" title="wikilink">Poisson distribution</a> with the mean set to 

<math display="inline" id="Poisson_regression:20">
 <semantics>
  <msup>
   <mi>e</mi>
   <mrow>
    <msup>
     <mi>θ</mi>
     <mo>′</mo>
    </msup>
    <mi>x</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{\theta^{\prime}x}
  </annotation>
 </semantics>
</math>

. Regularization can be added to this optimization problem by instead maximizing</p>

<p>

<math display="block" id="Poisson_regression:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <mi>log</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>y</mi>
          <mi>i</mi>
         </msub>
         <mo>;</mo>
         <msup>
          <mi>e</mi>
          <mrow>
           <msup>
            <mi>θ</mi>
            <mo>′</mo>
           </msup>
           <mi>x</mi>
          </mrow>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>λ</mi>
     <msubsup>
      <mrow>
       <mo>∥</mo>
       <mi>θ</mi>
       <mo>∥</mo>
      </mrow>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <log></log>
      <apply>
       <times></times>
       <ci>p</ci>
       <list>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>θ</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>x</ci>
         </apply>
        </apply>
       </list>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>λ</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <ci>θ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{m}\log(p(y_{i};e^{\theta^{\prime}x}))-\lambda\left\|\theta\right\|%
_{2}^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>for some positive constant 

<math display="inline" id="Poisson_regression:22">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

. This technique, similar to <a href="ridge_regression" title="wikilink">ridge regression</a>, can reduce <a class="uri" href="overfitting" title="wikilink">overfitting</a>.</p>
<h2 id="implementations">Implementations</h2>

<p>Some <a href="statistics_packages" title="wikilink">statistics packages</a> include implementations of Poisson regression.</p>
<ul>
<li><a class="uri" href="GenStat" title="wikilink">GenStat</a>: Poisson regression is a standard option of the regression section, using the "MODEL", "FIT" and associated commands; it is also available in the "Stats &gt; Regression Analysis &gt; Generalized Linear Models" menu.</li>
<li><a class="uri" href="MATLAB" title="wikilink">MATLAB</a> Statistics Toolbox: Poisson regression can be performed using the "glmfit" and "glmval" functions.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></li>
<li><a href="Microsoft_Excel" title="wikilink">Microsoft Excel</a>: Excel is not capable of doing Poisson regression by default. One of the Excel Add-ins for Poisson regression is <a href="http://www.indiana.edu/~jslsoc/files_research/xpost/xpost.pdf">XPost</a></li>
<li>mPlus: mPlus allows for Poisson regression using the command COUNT IS when specifying the data</li>
<li><a href="R_(programming_language)" title="wikilink">R</a>: The function for fitting a generalized linear model in R is glm(), and can be used for Poisson Regression</li>
<li><a href="SAS_System" title="wikilink">SAS</a>: Poisson regression in SAS is done by using GENMOD, HPGENSELECT, COUNTREG, GLIMMIX, and NLMIXED</li>
<li><a class="uri" href="SPSS" title="wikilink">SPSS</a>: In SPSS, Poisson regression is done by using the GENLIN command</li>
<li><a class="uri" href="Stata" title="wikilink">Stata</a>: Stata has a procedure for Poisson regression named <code>poisson</code>,<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> and for panel data <code>xtpoisson</code>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></li>
<li><a class="uri" href="CrimeStat" title="wikilink">CrimeStat</a>: CrimeStat has Poisson, Poisson NB1, Poisson-Gamma(negative binomial), and Poisson-Lognormal regression models.</li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Zero-inflated_model" title="wikilink">Zero-inflated model</a></li>
<li><a href="Poisson_distribution" title="wikilink">Poisson distribution</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Generalized_linear_models" title="wikilink">Category:Generalized linear models</a> <a href="Category:Categorical_data" title="wikilink">Category:Categorical data</a> <a class="uri" href="Category:Econometrics" title="wikilink">Category:Econometrics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a class="uri" href="http://www.mathworks.com/help/toolbox/stats/glmfit.html">http://www.mathworks.com/help/toolbox/stats/glmfit.html</a><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="https://www.stata.com/manuals13/rpoisson.pdf">Poisson regression</a><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="https://www.stata.com/manuals13/xtxtpoisson.pdf">Fixed-effects, random-effects, and population-averaged Poisson models</a><a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

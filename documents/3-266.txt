   Farey sequence      Farey sequence  table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
   margin: 0; padding: 0; vertical-align: baseline; border: none; }
 <style>
 table.sourceCode { width: 100%; line-height: 100%; }
 td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
 td.sourceCode { padding-left: 5px; }
 code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
 code > span.dt { color: #902000; } /* DataType */
 code > span.dv { color: #40a070; } /* DecVal */
 code > span.bn { color: #40a070; } /* BaseN */
 code > span.fl { color: #40a070; } /* Float */
 code > span.ch { color: #4070a0; } /* Char */
 code > span.st { color: #4070a0; } /* String */
 code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
 code > span.ot { color: #007020; } /* Other */
 code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
 code > span.fu { color: #06287e; } /* Function */
 code > span.er { color: #ff0000; font-weight: bold; } /* Error */
 code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
 code > span.cn { color: #880000; } /* Constant */
 code > span.sc { color: #4070a0; } /* SpecialChar */
 code > span.vs { color: #4070a0; } /* VerbatimString */
 code > span.ss { color: #bb6688; } /* SpecialString */
 code > span.im { } /* Import */
 code > span.va { color: #19177c; } /* Variable */
 code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
 code > span.op { color: #666666; } /* Operator */
 code > span.bu { } /* BuiltIn */
 code > span.ex { } /* Extension */
 code > span.pp { color: #bc7a00; } /* Preprocessor */
 code > span.at { color: #7d9029; } /* Attribute */
 code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
 code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
 code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
 code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */       In mathematics , the Farey sequence of order n is the sequence of completely reduced fractions between 0 and 1 which, when in lowest terms , have denominators less than or equal to n , arranged in order of increasing size.  Each Farey sequence starts with the value 0, denoted by the fraction 0 ⁄ 1 , and ends with the value 1, denoted by the fraction 1 ⁄ 1 (although some authors omit these terms).  A Farey sequence is sometimes called a Farey series , which is not strictly correct, because the terms are not summed.  Examples  The Farey sequences of orders 1 to 8 are :   F 1 = {    0  1      0  1    \frac{0}{1}    ,     1  1      1  1    \frac{1}{1}   }  F 2 = {    0  1      0  1    \frac{0}{1}    ,     1  2      1  2    \frac{1}{2}    ,     1  1      1  1    \frac{1}{1}   }  F 3 = {    0  1      0  1    \frac{0}{1}    ,     1  3      1  3    \frac{1}{3}    ,     1  2      1  2    \frac{1}{2}    ,     2  3      2  3    \frac{2}{3}    ,     1  1      1  1    \frac{1}{1}   }  F 4 = {    0  1      0  1    \frac{0}{1}    ,     1  4      1  4    \frac{1}{4}    ,     1  3      1  3    \frac{1}{3}    ,     1  2      1  2    \frac{1}{2}    ,     2  3      2  3    \frac{2}{3}    ,     3  4      3  4    \frac{3}{4}    ,     1  1      1  1    \frac{1}{1}   }  F 5 = {    0  1      0  1    \frac{0}{1}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     1  3      1  3    \frac{1}{3}    ,     2  5      2  5    \frac{2}{5}    ,     1  2      1  2    \frac{1}{2}    ,     3  5      3  5    \frac{3}{5}    ,     2  3      2  3    \frac{2}{3}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     1  1      1  1    \frac{1}{1}   }  F 6 = {    0  1      0  1    \frac{0}{1}    ,     1  6      1  6    \frac{1}{6}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     1  3      1  3    \frac{1}{3}    ,     2  5      2  5    \frac{2}{5}    ,     1  2      1  2    \frac{1}{2}    ,     3  5      3  5    \frac{3}{5}    ,     2  3      2  3    \frac{2}{3}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     5  6      5  6    \frac{5}{6}    ,     1  1      1  1    \frac{1}{1}   }  F 7 = {    0  1      0  1    \frac{0}{1}    ,     1  7      1  7    \frac{1}{7}    ,     1  6      1  6    \frac{1}{6}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     2  7      2  7    \frac{2}{7}    ,     1  3      1  3    \frac{1}{3}    ,     2  5      2  5    \frac{2}{5}    ,     3  7      3  7    \frac{3}{7}    ,     1  2      1  2    \frac{1}{2}    ,     4  7      4  7    \frac{4}{7}    ,     3  5      3  5    \frac{3}{5}    ,     2  3      2  3    \frac{2}{3}    ,     5  7      5  7    \frac{5}{7}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     5  6      5  6    \frac{5}{6}    ,     6  7      6  7    \frac{6}{7}    ,     1  1      1  1    \frac{1}{1}   }  F 8 = {    0  1      0  1    \frac{0}{1}    ,     1  8      1  8    \frac{1}{8}    ,     1  7      1  7    \frac{1}{7}    ,     1  6      1  6    \frac{1}{6}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     2  7      2  7    \frac{2}{7}    ,     1  3      1  3    \frac{1}{3}    ,     3  8      3  8    \frac{3}{8}    ,     2  5      2  5    \frac{2}{5}    ,     3  7      3  7    \frac{3}{7}    ,     1  2      1  2    \frac{1}{2}    ,     4  7      4  7    \frac{4}{7}    ,     3  5      3  5    \frac{3}{5}    ,     5  8      5  8    \frac{5}{8}    ,     2  3      2  3    \frac{2}{3}    ,     5  7      5  7    \frac{5}{7}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     5  6      5  6    \frac{5}{6}    ,     6  7      6  7    \frac{6}{7}    ,     7  8      7  8    \frac{7}{8}    ,     1  1      1  1    \frac{1}{1}   }       Centered       F 1 = {    0  1      0  1    \frac{0}{1}    ,     1  1      1  1    \frac{1}{1}   }     F 2 = {    0  1      0  1    \frac{0}{1}    ,     1  2      1  2    \frac{1}{2}    ,     1  1      1  1    \frac{1}{1}   }     F 3 = {    0  1      0  1    \frac{0}{1}    ,     1  3      1  3    \frac{1}{3}    ,     1  2      1  2    \frac{1}{2}    ,     2  3      2  3    \frac{2}{3}    ,     1  1      1  1    \frac{1}{1}   }     F 4 = {    0  1      0  1    \frac{0}{1}    ,     1  4      1  4    \frac{1}{4}    ,     1  3      1  3    \frac{1}{3}    ,     1  2      1  2    \frac{1}{2}    ,     2  3      2  3    \frac{2}{3}    ,     3  4      3  4    \frac{3}{4}    ,     1  1      1  1    \frac{1}{1}   }     F 5 = {    0  1      0  1    \frac{0}{1}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     1  3      1  3    \frac{1}{3}    ,     2  5      2  5    \frac{2}{5}    ,     1  2      1  2    \frac{1}{2}    ,     3  5      3  5    \frac{3}{5}    ,     2  3      2  3    \frac{2}{3}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     1  1      1  1    \frac{1}{1}   }     F 6 = {    0  1      0  1    \frac{0}{1}    ,     1  6      1  6    \frac{1}{6}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     1  3      1  3    \frac{1}{3}    ,     2  5      2  5    \frac{2}{5}    ,     1  2      1  2    \frac{1}{2}    ,     3  5      3  5    \frac{3}{5}    ,     2  3      2  3    \frac{2}{3}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     5  6      5  6    \frac{5}{6}    ,     1  1      1  1    \frac{1}{1}   }     F 7 = {    0  1      0  1    \frac{0}{1}    ,     1  7      1  7    \frac{1}{7}    ,     1  6      1  6    \frac{1}{6}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     2  7      2  7    \frac{2}{7}    ,     1  3      1  3    \frac{1}{3}    ,     2  5      2  5    \frac{2}{5}    ,     3  7      3  7    \frac{3}{7}    ,     1  2      1  2    \frac{1}{2}    ,     4  7      4  7    \frac{4}{7}    ,     3  5      3  5    \frac{3}{5}    ,     2  3      2  3    \frac{2}{3}    ,     5  7      5  7    \frac{5}{7}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     5  6      5  6    \frac{5}{6}    ,     6  7      6  7    \frac{6}{7}    ,     1  1      1  1    \frac{1}{1}   }     F 8 = {    0  1      0  1    \frac{0}{1}    ,     1  8      1  8    \frac{1}{8}    ,     1  7      1  7    \frac{1}{7}    ,     1  6      1  6    \frac{1}{6}    ,     1  5      1  5    \frac{1}{5}    ,     1  4      1  4    \frac{1}{4}    ,     2  7      2  7    \frac{2}{7}    ,     1  3      1  3    \frac{1}{3}    ,     3  8      3  8    \frac{3}{8}    ,     2  5      2  5    \frac{2}{5}    ,     3  7      3  7    \frac{3}{7}    ,     1  2      1  2    \frac{1}{2}    ,     4  7      4  7    \frac{4}{7}    ,     3  5      3  5    \frac{3}{5}    ,     5  8      5  8    \frac{5}{8}    ,     2  3      2  3    \frac{2}{3}    ,     5  7      5  7    \frac{5}{7}    ,     3  4      3  4    \frac{3}{4}    ,     4  5      4  5    \frac{4}{5}    ,     5  6      5  6    \frac{5}{6}    ,     6  7      6  7    \frac{6}{7}    ,     7  8      7  8    \frac{7}{8}    ,     1  1      1  1    \frac{1}{1}   }         Sorted      F1 = {0/1,                                                                                                          1/1}
  F2 = {0/1,                                                   1/2,                                                   1/1}
  F3 = {0/1,                               1/3,                1/2,                2/3,                               1/1}
  F4 = {0/1,                     1/4,      1/3,                1/2,                2/3,      3/4,                     1/1}
  F5 = {0/1,                1/5, 1/4,      1/3,      2/5,      1/2,      3/5,      2/3,      3/4, 4/5,                1/1}
  F6 = {0/1,           1/6, 1/5, 1/4,      1/3,      2/5,      1/2,      3/5,      2/3,      3/4, 4/5, 5/6,           1/1}
  F7 = {0/1,      1/7, 1/6, 1/5, 1/4, 2/7, 1/3,      2/5, 3/7, 1/2, 4/7, 3/5,      2/3, 5/7, 3/4, 4/5, 5/6, 6/7,      1/1}
  F8 = {0/1, 1/8, 1/7, 1/6, 1/5, 1/4, 2/7, 1/3, 3/8, 2/5, 3/7, 1/2, 4/7, 3/5, 5/8, 2/3, 5/7, 3/4, 4/5, 5/6, 6/7, 7/8, 1/1}     History   The history of 'Farey series' is very curious — Hardy & Wright (1979) Chapter III 1     ... once again the man whose name was given to a mathematical relation was not the original discoverer so far as the records go. — Beiler (1964) Chapter XVI 2    Farey sequences are named after the British  geologist  John Farey, Sr. , whose letter about these sequences was published in the Philosophical Magazine in 1816. Farey conjectured, without offering proof, that each new term in a Farey sequence expansion is the mediant of its neighbours. Farey's letter was read by Cauchy , who provided a proof in his Exercices de mathématique , and attributed this result to Farey. In fact, another mathematician, Charles Haros , had published similar results in 1802 which were not known either to Farey or to Cauchy. 3 Thus it was a historical accident that linked Farey's name with these sequences. This is an example of Stigler's law of eponymy .  Properties  (Figure)  Farey diagram circle packing 5.png   Sequence length and index of a fraction  The Farey sequence of order n contains all of the members of the Farey sequences of lower orders. In particular F n contains all of the members of F n −1 , and also contains an additional fraction for each number that is less than n and coprime to n . Thus F 6 consists of F 5 together with the fractions    1  6      1  6    \frac{1}{6}   and    5  6      5  6    \frac{5}{6}   .  The middle term of a Farey sequence F n is always    1  2      1  2    \frac{1}{2}   , for n > 1.  From this, we can relate the lengths of F n and F n −1 using Euler's totient function     φ   (  n  )       φ  n    \varphi(n)   :        |   F  n   |   =    |   F   n  -  1    |   +   φ   (  n  )      .         subscript  F  n         subscript  F    n  1       φ  n      |F_{n}|=|F_{n-1}|+\varphi(n).     Using the fact that | F 1 | = 2, we can derive an expression for the length of F n :        |   F  n   |   =   1  +    ∑   m  =  1   n    φ   (  m  )       .         subscript  F  n      1    superscript   subscript     m  1    n     φ  m       |F_{n}|=1+\sum_{m=1}^{n}\varphi(m).     We also have :        |   F  n   |   =    1  2    (   3  +    ∑   d  =  1   n    μ   (  d  )     ⌊    n  d    ⌋   2      )     ,         subscript  F  n        1  2     3    superscript   subscript     d  1    n     μ  d   superscript      n  d    2         |F_{n}|=\frac{1}{2}\left(3+\sum_{d=1}^{n}\mu(d)\left\lfloor\tfrac{n}{d}\right%
 \rfloor^{2}\right),   and by a Möbius inversion formula :        |   F  n   |   =     1  2    (   n  +  3   )   n   -    ∑   d  =  2   n    |   F   ⌊   n  /  d   ⌋    |      ,         subscript  F  n          1  2     n  3   n     superscript   subscript     d  2    n      subscript  F      n  d          |F_{n}|=\frac{1}{2}(n+3)n-\sum_{d=2}^{n}|F_{\lfloor n/d\rfloor}|,   where µ( d ) is the number-theoretic Möbius function , and    ⌊   n  d   ⌋        n  d     \lfloor\tfrac{n}{d}\rfloor   is the floor function .  The asymptotic behaviour of | F n | is :        |   F  n   |   ∼    3   n  2     π  2     .     similar-to     subscript  F  n        3   superscript  n  2     superscript  π  2      |F_{n}|\sim\frac{3n^{2}}{\pi^{2}}.     The index      I  n    (   a   k  ,  n    )    =  k         subscript  I  n    subscript  a   k  n     k    I_{n}(a_{k,n})=k   of a fraction    a   k  ,  n      subscript  a   k  n     a_{k,n}   in the Farey sequence     F  n   =   {   a   k  ,  n    :   k  =   0  ,  1  ,  …  ,   m  n     }        subscript  F  n    conditional-set   subscript  a   k  n      k   0  1  normal-…   subscript  m  n        F_{n}=\{a_{k,n}:k=0,1,\ldots,m_{n}\}   is simply the position that    a   k  ,  n      subscript  a   k  n     a_{k,n}   occupies in the sequence. This is of special relevance as it is used in an alternative formulation of the Riemann hypothesis , see below. Various useful properties follow:         I  n    (   0  /  1   )    =  0   ,         subscript  I  n     0  1    0    I_{n}(0/1)=0,            I  n    (   1  /  n   )    =  1   ,         subscript  I  n     1  n    1    I_{n}(1/n)=1,            I  n    (   1  /  2   )    =    (    |   F  n   |   -  1   )   /  2    ,         subscript  I  n     1  2           subscript  F  n    1   2     I_{n}(1/2)=(|F_{n}|-1)/2,            I  n    (   1  /  1   )    =    |   F  n   |   -  1    ,         subscript  I  n     1  1         subscript  F  n    1     I_{n}(1/1)=|F_{n}|-1,            I  n    (   h  /  k   )    =    |   F  n   |   -  1  -    I  n    (    (   k  -  h   )   /  k   )      .         subscript  I  n     h  k         subscript  F  n    1     subscript  I  n       k  h   k       I_{n}(h/k)=|F_{n}|-1-I_{n}((k-h)/k).     Farey neighbours  Fractions which are neighbouring terms in any Farey sequence are known as a Farey pair and have the following properties.  If    a  b      a  b    \frac{a}{b}   and    c  d      c  d    \frac{c}{d}   are neighbours in a Farey sequence, with    a  b      a  b    \frac{a}{b}   $\frac{c}{d}$, then their difference    c  d      c  d    \frac{c}{d}   −    a  b      a  b    \frac{a}{b}   is equal to    1   b  d       1    b  d     \frac{1}{bd}   . Since         c  d   -   a  b    =     b  c   -   a  d     b  d     ,          c  d     a  b          b  c     a  d      b  d      \frac{c}{d}-\frac{a}{b}=\frac{bc-ad}{bd},     this is equivalent to saying that   bc − ad = 1.   Thus    1  3      1  3    \frac{1}{3}   and    2  5      2  5    \frac{2}{5}   are neighbours in F 5 , and their difference is    1  15      1  15    \frac{1}{15}   .  The converse is also true. If   bc − ad = 1   for positive integers a , b , c and d with a $\frac{a}{b}$ and    c  d      c  d    \frac{c}{d}   will be neighbours in the Farey sequence of order max( b,d ).  If    p  q      p  q    \frac{p}{q}   has neighbours    a  b      a  b    \frac{a}{b}   and    c  d      c  d    \frac{c}{d}   in some Farey sequence, with       a  b      a  b    \frac{a}{b}   $\frac{p}{q}$ $\frac{c}{d}$   then    p  q      p  q    \frac{p}{q}   is the mediant of    a  b      a  b    \frac{a}{b}   and    c  d      c  d    \frac{c}{d}   — in other words,        p  q   =    a  +  c    b  +  d     .        p  q       a  c     b  d      \frac{p}{q}=\frac{a+c}{b+d}.     This follows easily from the previous property, since if bp - aq = qc - pd = 1, then bp + pd = qc + aq , p ( b + d )= q ( a + c ),    p  q      p  q    \frac{p}{q}   =    a   +  c       a     c     a\frac{+}{c}     It follows that if    a  b      a  b    \frac{a}{b}   and    c  d      c  d    \frac{c}{d}   are neighbours in a Farey sequence then the first term that appears between them as the order of the Farey sequence is increased is        a  +  c    b  +  d    ,        a  c     b  d     \frac{a+c}{b+d},     which first appears in the Farey sequence of order b + d .  Thus the first term to appear between    1  3      1  3    \frac{1}{3}   and    2  5      2  5    \frac{2}{5}   is    3  8      3  8    \frac{3}{8}   , which appears in F 8 .  The Stern-Brocot tree is a data structure showing how the sequence is built up from 0 (=    0  1      0  1    \frac{0}{1}   ) and 1 (=    1  1      1  1    \frac{1}{1}   ), by taking successive mediants.  Fractions that appear as neighbours in a Farey sequence have closely related continued fraction expansions. Every fraction has two continued fraction expansions — in one the final term is 1; in the other the final term is greater than 1. If    p  q      p  q    \frac{p}{q}   , which first appears in Farey sequence F q , has continued fraction expansions   [0; a 1 , a 2 , …, a n − 1 , a n , 1]  [0; a 1 , a 2 , …, a n − 1 , a n + 1]   then the nearest neighbour of    p  q      p  q    \frac{p}{q}   in F q (which will be its neighbour with the larger denominator) has a continued fraction expansion   [0; a 1 , a 2 , …, a n ]   and its other neighbour has a continued fraction expansion   [0; a 1 , a 2 , …, a n − 1 ]   Thus    3  8      3  8    \frac{3}{8}   has the two continued fraction expansions [0; 2, 1, 1, 1] and [0; 2, 1, 2], and its neighbours in F 8 are    2  5      2  5    \frac{2}{5}   , which can be expanded as [0; 2, 1, 1]; and    1  3      1  3    \frac{1}{3}   , which can be expanded as [0; 2, 1].  Applications  Farey sequences are very useful to find rational approximations of irrational numbers 1 .  In physics systems featuring resonance phenomena Farey sequences provide a very elegant and efficient method to compute resonance locations in 1D 4 and 2D 5  Ford circles  (Figure)  Ford circles   There is a connection between Farey sequence and Ford circles .  For every fraction p / q (in its lowest terms) there is a Ford circle C[ p / q ], which is the circle with radius 1/(2 q 2 ) and centre at ( p / q , 1/(2 q 2 )). Two Ford circles for different fractions are either disjoint or they are tangent to one another—two Ford circles never intersect. If 0 F_n are    {   a   k  ,  n    :   k  =   0  ,  1  ,  …  ,   m  n     }     conditional-set   subscript  a   k  n      k   0  1  normal-…   subscript  m  n       \{a_{k,n}:k=0,1,\ldots,m_{n}\}   . Define     d   k  ,  n    =    a   k  ,  n    -   k  /   m  n          subscript  d   k  n       subscript  a   k  n      k   subscript  m  n       d_{k,n}=a_{k,n}-k/m_{n}   , in other words    d   k  ,  n      subscript  d   k  n     d_{k,n}   is the difference between the k th term of the n th Farey sequence, and the k th member of a set of the same number of points, distributed evenly on the unit interval. In 1924 Jérôme Franel 6 proved that the statement         ∑   k  =  1    m  n     d   k  ,  n   2    =   𝒪   (   n  r   )       ∀  r   >   -  1       formulae-sequence      superscript   subscript     k  1     subscript  m  n     superscript   subscript  d   k  n    2      𝒪   superscript  n  r        for-all  r     1      \sum_{k=1}^{m_{n}}d_{k,n}^{2}=\mathcal{O}(n^{r})\quad\forall r>-1     is equivalent to the Riemann hypothesis, and then Edmund Landau 7 remarked (just after Franel's paper) that the statement         ∑   k  =  1    m  n     |   d   k  ,  n    |    =   𝒪   (   n  r   )       ∀  r   >   1  /  2       formulae-sequence      superscript   subscript     k  1     subscript  m  n       subscript  d   k  n        𝒪   superscript  n  r        for-all  r     1  2      \sum_{k=1}^{m_{n}}|d_{k,n}|=\mathcal{O}(n^{r})\quad\forall r>1/2     is also equivalent to the Riemann hypothesis.  Next term  A surprisingly simple algorithm exists to generate the terms of F n in either traditional order (ascending) or non-traditional order (descending). The algorithm computes each successive entry in terms of the previous two entries using the mediant property given above. If    a  b      a  b    \frac{a}{b}   and    c  d      c  d    \frac{c}{d}   are the two given entries, and    p  q      p  q    \frac{p}{q}   is the unknown next entry, then    c  d      c  d    \frac{c}{d}   =    a   +  p       a     p     a\frac{+}{p}   . Since    c  d      c  d    \frac{c}{d}   is in lowest terms, there must be an integer k such that kc = a + p and kd = b + q , giving p = kc − a and q = kd − b . If we consider p and q to be functions of k , then         p   (  k  )     q   (  k  )     -   c  d    =     c  b   -   d  a     d   (    k  d   -  b   )               p  k     q  k      c  d          c  b     d  a      d      k  d   b       \frac{p(k)}{q(k)}-\frac{c}{d}=\frac{cb-da}{d(kd-b)}   so the larger k gets, the closer    p  q      p  q    \frac{p}{q}   gets to    c  d      c  d    \frac{c}{d}   .  To give the next term in the sequence k must be as large as possible, subject to kd − b ≤ n (as we are only considering numbers with denominators not greater than n ), so k is the greatest integer ≤    n   +  b       n     b     n\frac{+}{b}   . Putting this value of k back into the equations for p and q gives      p  =     ⌊    n  +  b   d   ⌋   c   -  a       p            n  b   d    c   a     p=\left\lfloor\frac{n+b}{d}\right\rfloor c-a         q  =     ⌊    n  +  b   d   ⌋   d   -  b       q            n  b   d    d   b     q=\left\lfloor\frac{n+b}{d}\right\rfloor d-b     This is implemented in Python as:  def farey( n, asc = True ): """Python function to print the nth Farey sequence, either ascending or descending."""  if asc: 
         a, b, c, d =  0 , 1 , 1 , n # (*)  else :
         a, b, c, d =  1 , 1 , n -1 , n # (*)  print  " %d / %d "  % (a,b) while (asc and c <= n) or ( not asc and a >  0 ):
         k =  int ((n + b) / d)
         a, b, c, d = c, d, k * c - a, k * d - b print  " %d / %d "  % (a,b)  Brute-force searches for solutions to Diophantine equations in rationals can often take advantage of the Farey series (to search only reduced forms). The lines marked (*) can also be modified to include any two adjacent terms so as to generate terms only larger (or smaller) than a given term. 8  See also   Stern-Brocot tree   References    Further reading   Allen Hatcher , Topology of Numbers  Ronald L. Graham , Donald E. Knuth , and Oren Patashnik , Concrete Mathematics: A Foundation for Computer Science , 2nd Edition (Addison-Wesley, Boston, 1989); in particular, Sec. 4.5 (pp. 115–123), Bonus Problem 4.61 (pp. 150, 523–524), Sec. 4.9 (pp. 133–139), Sec. 9.3, Problem 9.3.6 (pp. 462–463). ISBN 0-201-55802-5.  Linas Vepstas. The Minkowski Question Mark, GL(2,Z), and the Modular Group.  http://linas.org/math/chap-minkowski.pdf reviews the isomorphisms of the Stern-Brocot Tree.  Linas Vepstas. Symmetries of Period-Doubling Maps.  http://linas.org/math/chap-takagi.pdf reviews connections between Farey Fractions and Fractals.  Scott B. Guthery, A Motif of Mathematics: History and Application of the Mediant and the Farey Sequence , (Docent Press, Boston, 2010). ISBN 1-4538-1057-9.  Cristian Cobeli and Alexandru Zaharescu, The Haros-Farey Sequence at Two Hundred Years. A Survey , Acta Univ. Apulensis Math. Inform. no. 5 (2003) 1–38, pp. 1–20  pp. 21–38  A.O. Matveev, A Note on Boolean Lattices and Farey Sequences III , arXiv:1507.07236  A.O. Matveev, Neighboring Fractions in Farey Subsequences , arXiv:0801.1981   External links   Alexander Bogomolny. Farey series and Stern-Brocot Tree at Cut-the-Knot    Farey Sequence from The On-Line Encyclopedia of Integer Sequences .    "  Category:Fractions (mathematics)  Category:Number theory  Category:Sequences and series     Hardy, G.H. & Wright, E.M. (1979) An Introduction to the Theory of Numbers (Fifth Edition). Oxford University Press. ISBN 0-19-853171-0 ↩  Beiler, Albert H. (1964) Recreations in the Theory of Numbers (Second Edition). Dover. ISBN 0-486-21096-0. Cited in Farey Series, A Story at Cut-the-Knot ↩   A. Zhenhua Li, W.G. Harter, "Quantum Revivals of Morse Oscillators and Farey-Ford Geometry", arXiv:1308.4470v1 ↩  http://prst-ab.aps.org/abstract/PRSTAB/v17/i1/e014001 ↩  "Les suites de Farey et le problème des nombres premiers", Gött. Nachr. 1924, 198-201 ↩  "Bemerkungen zu der vorstehenden Abhandlung von Herrn Franel", Gött. Nachr. 1924, 202-206 ↩  Norman Routledge, "Computing Farey Series," The Mathematical Gazette , Vol. ''' 92 ''' (No. 523), 55–62 (March 2008). ↩    
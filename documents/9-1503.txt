   Centering matrix      Centering matrix   In mathematics and multivariate statistics , the centering matrix 1 is a symmetric and idempotent  matrix , which when multiplied with a vector has the same effect as subtracting the mean of the components of the vector from every component.  Definition  The centering matrix of size n is defined as the n -by- n matrix       C  n   =    I  n   -     1  n    𝕆         subscript  C  n      subscript  I  n       1  n   𝕆      C_{n}=I_{n}-\tfrac{1}{n}\mathbb{O}   where     I  n      subscript  I  n    I_{n}\,   is the identity matrix of size n and   𝕆   𝕆   \mathbb{O}   is an n -by- n matrix of all 1's. This can also be written as:       C  n   =    I  n   -     1  n     𝟏𝟏  ⊤          subscript  C  n      subscript  I  n       1  n    superscript  11  top       C_{n}=I_{n}-\tfrac{1}{n}\mathbf{1}\mathbf{1}^{\top}   where   𝟏   1   \mathbf{1}   is the column-vector of n ones and where   ⊤   top   \top   denotes matrix transpose .  For example       C  1   =   [     0     ]        subscript  C  1     0      C_{1}=\begin{bmatrix}0\end{bmatrix}   ,       C  2   =    [     1    0            0    1      ]   -    1  2    [     1    1            1    1      ]     =   [      1  2      -   1  2               -   1  2       1  2       ]          subscript  C  2      delimited-[]    1  0   missing-subexpression      missing-subexpression    missing-subexpression    missing-subexpression     0  1   missing-subexpression          1  2    delimited-[]    1  1   missing-subexpression      missing-subexpression    missing-subexpression    missing-subexpression     1  1   missing-subexpression              delimited-[]      1  2       1  2     missing-subexpression      missing-subexpression    missing-subexpression    missing-subexpression         1  2      1  2    missing-subexpression         C_{2}=\left[\begin{array}[]{rrr}1&0\\
 \\
 0&1\end{array}\right]-\frac{1}{2}\left[\begin{array}[]{rrr}1&1\\
 \\
 1&1\end{array}\right]=\left[\begin{array}[]{rrr}\frac{1}{2}&-\frac{1}{2}\\
 \\
 -\frac{1}{2}&\frac{1}{2}\end{array}\right]   ,       C  3   =    [     1    0    0           0    1    0           0    0    1     ]   -    1  3    [     1    1    1           1    1    1           1    1    1     ]     =   [      2  3      -   1  3       -   1  3              -   1  3       2  3      -   1  3              -   1  3       -   1  3       2  3      ]          subscript  C  3      delimited-[]    1  0  0     missing-subexpression    missing-subexpression    missing-subexpression     0  1  0     missing-subexpression    missing-subexpression    missing-subexpression     0  0  1         1  3    delimited-[]    1  1  1     missing-subexpression    missing-subexpression    missing-subexpression     1  1  1     missing-subexpression    missing-subexpression    missing-subexpression     1  1  1             delimited-[]      2  3       1  3        1  3       missing-subexpression    missing-subexpression    missing-subexpression         1  3      2  3       1  3       missing-subexpression    missing-subexpression    missing-subexpression         1  3        1  3      2  3         C_{3}=\left[\begin{array}[]{rrr}1&0&0\\
 \\
 0&1&0\\
 \\
 0&0&1\end{array}\right]-\frac{1}{3}\left[\begin{array}[]{rrr}1&1&1\\
 \\
 1&1&1\\
 \\
 1&1&1\end{array}\right]=\left[\begin{array}[]{rrr}\frac{2}{3}&-\frac{1}{3}&-%
 \frac{1}{3}\\
 \\
 -\frac{1}{3}&\frac{2}{3}&-\frac{1}{3}\\
 \\
 -\frac{1}{3}&-\frac{1}{3}&\frac{2}{3}\end{array}\right]     Properties  Given a column-vector,    𝐯    𝐯   \mathbf{v}\,   of size n , the centering property of     C  n      subscript  C  n    C_{n}\,   can be expressed as         C  n    𝐯   =   𝐯  -    (     1  n     𝟏  ′   𝐯   )   𝟏           subscript  C  n   𝐯     𝐯        1  n    superscript  1  normal-′   𝐯   1      C_{n}\,\mathbf{v}=\mathbf{v}-(\tfrac{1}{n}\mathbf{1}^{\prime}\mathbf{v})%
 \mathbf{1}   where     1  n    𝟏  ′   𝐯        1  n    superscript  1  normal-′   𝐯    \tfrac{1}{n}\mathbf{1}^{\prime}\mathbf{v}   is the mean of the components of    𝐯    𝐯   \mathbf{v}\,   .       C  n      subscript  C  n    C_{n}\,   is symmetric positive semi-definite .       C  n      subscript  C  n    C_{n}\,   is idempotent , so that     C  n  k   =   C  n        superscript   subscript  C  n   k    subscript  C  n     C_{n}^{k}=C_{n}   , for    k  =   1  ,  2  ,  …       k   1  2  normal-…     k=1,2,\ldots   . Once the mean has been removed, it is zero and removing it again has no effect.       C  n      subscript  C  n    C_{n}\,   is singular . The effects of applying the transformation      C  n    𝐯       subscript  C  n   𝐯    C_{n}\,\mathbf{v}   cannot be reversed.       C  n      subscript  C  n    C_{n}\,   has the eigenvalue 1 of multiplicity n − 1 and eigenvalue 0 of multiplicity 1.       C  n      subscript  C  n    C_{n}\,   has a nullspace of dimension 1, along the vector   𝟏   1   \mathbf{1}   .       C  n      subscript  C  n    C_{n}\,   is a projection matrix . That is,     C  n   𝐯       subscript  C  n   𝐯    C_{n}\mathbf{v}   is a projection of    𝐯    𝐯   \mathbf{v}\,   onto the ( n − 1)-dimensional subspace that is orthogonal to the nullspace   𝟏   1   \mathbf{1}   . (This is the subspace of all n -vectors whose components sum to zero.)  Application  Although multiplication by the centering matrix is not a computationally efficient way of removing the mean from a vector, it forms an analytical tool that conveniently and succinctly expresses mean removal. It can be used not only to remove the mean of a single vector, but also of multiple vectors stored in the rows or columns of a matrix. For an m -by- n matrix    X    X   X\,   , the multiplication      C  m    X       subscript  C  m   X    C_{m}\,X   removes the means from each of the n columns, while     X    C  n       X   subscript  C  n     X\,C_{n}   removes the means from each of the m rows.  The centering matrix provides in particular a succinct way to express the scatter matrix ,    S  =    (   X  -   μ   𝟏  ′     )     (   X  -   μ   𝟏  ′     )   ′        S      X    μ   superscript  1  normal-′      superscript    X    μ   superscript  1  normal-′     normal-′      S=(X-\mu\mathbf{1}^{\prime})(X-\mu\mathbf{1}^{\prime})^{\prime}   of a data sample    X    X   X\,   , where    μ  =    1  n   X  𝟏       μ      1  n   X  1     \mu=\tfrac{1}{n}X\mathbf{1}   is the sample mean . The centering matrix allows us to express the scatter matrix more compactly as       S  =    X    C  n     (    X    C  n    )   ′    =    X     C  n      C  n      X   ′    =    X     C  n      X   ′     .        S    X   subscript  C  n    superscript    X   subscript  C  n    normal-′           X   subscript  C  n    subscript  C  n    superscript  X  normal-′           X   subscript  C  n    superscript  X  normal-′       S=X\,C_{n}(X\,C_{n})^{\prime}=X\,C_{n}\,C_{n}\,X\,^{\prime}=X\,C_{n}\,X\,^{%
 \prime}.       C  n     subscript  C  n    C_{n}   is the covariance matrix of the multinomial distribution , in the special case where the parameters of that distribution are    k  =  n      k  n    k=n   , and     p  1   =   p  2   =  ⋯  =   p  n   =   1  n          subscript  p  1    subscript  p  2        normal-⋯        subscript  p  n          1  n      p_{1}=p_{2}=\cdots=p_{n}=\frac{1}{n}   .  References    "  Category:Multivariate statistics  Category:Matrices  Category:Statistical terminology     John I. Marden, Analyzing and Modeling Rank Data , Chapman & Hall, 1995, ISBN 0-412-99521-2, page 59. ↩     
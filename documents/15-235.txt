


Common spatial pattern




Common spatial pattern

Common spatial pattern (CSP) is a mathematical procedure used in signal processing for separating a multivariate signal into additive subcomponents which have maximum differences in variance between two windows.1
Details
Let 
 
 
 
  of size 
 
 
 
  and 
 
 
 
  of size 
 
 
 
  be two windows of a multivariate signal, where 
 
 
 
  is the number of signals and 
 
 
 
  and 
 
 
 
  are the respective number of samples.
The CSP algorithm determines the component 
 
 
 
  such that the ratio of variance (or second-order moment) is maximized between the two windows:



The solution is given by computing the two covariance matrices:






Then, the simultaneous diagonalization of those two matrices (also called generalized eigenvalue decomposition) is realized. We find the matrix of eigenvectors

 
  and the diagonal matrix

 
  of eigenvalues

 
  sorted by decreasing order such that:



and



with 
 
 
 
  the identity matrix.
This is equivalent to the eigendecomposition of 
 
 
 
 :





 
  will correspond to the first column of 
 
 
 
 :



Discussion
Relation between variance ratio and eigenvalue
The eigenvectors composing 
 
 
 
  are components with variance ratio between the two windows equal to their corresponding eigenvalue:



Other components
The vectorial subspace

 
  generated by the 
 
 
 
  first eigenvectors 
 
 
 
  will be the subspace maximizing the variance ratio of all components belonging to it:



On the same way, the vectorial subpsace 
 
 
 
  generated by the 
 
 
 
  last eigenvectors 
 
 
 
  will be the subspace minimizing the variance ratio of all components belonging to it:



Variance or second-order moment
CSP can be applied after a mean subtraction (a.k.a. "mean centering") on signals in order to realize a variance ratio optimization. Otherwize CSP optimizes the ratio of second-order moment.
Choice of windows X1 and X2

The standard use consists on choosing the windows to correspond to two periods of time with different activation of sources (e.g. during rest and during a specific task).


It is also possible to choose the two windows to correspond to two different frequency bands in order to find components with specific frequency pattern.2 Those frequency bands can be on temporal or on frequential basis. Since the matrix 
 
 
 
  depends only of the covariance matrices, the same results can be obtained if the processing is applied on the Fourier transform of the signals.


Y. Wang 3 has proposed a particular choice for the first window 
 
 
 
  in order to extract components which have a specific period. 
 
 
 
  was the mean of the different periods for the examined signals.


If there is only one window, 
 
 
 
  can be considered as the identity matrix and then CSP corresponds to Principal component analysis.

Applications
This method can be applied to several multivariate signal but it seems that most works on it concern electroencephalographic signals.
Particularly, the method is mostly used on brain–computer interface in order to retrieve the component signal which best transduce the cerebral activity for a specific task (e.g. hand movement).4
It can also be used to separate artifacts from electroencephalographics signals.5
See also

Blind signal separation

References
"
Category:Signal processing



Zoltan J. Koles, Michael S. Lazaret and Steven Z. Zhou, "Spatial patterns underlying population differences in the background EEG", Brain topography, Vol. 2 (4) pp. 275-284, 1990↩
S. Boudet, "Filtrage d'artefacts par analyse multicomposantes de l'électroencephalogramme de patients épileptiques.", PhD. Thesis: Unviversité de Lille 1, 07/2008↩
Y. Wang, "Reduction of cardiac artifacts in magnetoencephalogram." Proc. of the 12th Int. Conf. on Biomagnetism, 2000↩
G. Pfurtscheller, C. Gugeret and H. Ramoser "EEG-based brain-computer interface using subject-specific spatial filters", Engineering applications of bio-inspired artificial neural networks, Lecture Notes in Computer Science, 1999, Vol. 1607/1999, pp. 248-254↩






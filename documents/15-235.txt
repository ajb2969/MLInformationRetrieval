   Common spatial pattern      Common spatial pattern   Common spatial pattern ( CSP ) is a mathematical procedure used in signal processing for separating a multivariate signal into additive subcomponents which have maximum differences in variance between two windows . 1  Details  Let    ğ—  1     subscript  ğ—  1    \mathbf{X}_{1}   of size    (  n  ,   t  1   )     n   subscript  t  1     (n,t_{1})   and    ğ—  2     subscript  ğ—  2    \mathbf{X}_{2}   of size    (  n  ,   t  2   )     n   subscript  t  2     (n,t_{2})   be two windows of a multivariate signal , where   n   n   n   is the number of signals and    t  1     subscript  t  1    t_{1}   and    t  2     subscript  t  2    t_{2}   are the respective number of samples.  The CSP algorithm determines the component    ğ°  T     superscript  ğ°  T    \mathbf{w}^{\text{T}}   such that the ratio of variance (or second-order moment ) is maximized between the two windows:      ğ°  =   arg    max  ğ°      âˆ¥   ğ°ğ—  1   âˆ¥   2     âˆ¥   ğ°ğ—  2   âˆ¥   2          ğ°      subscript   ğ°      superscript   norm   subscript  ğ°ğ—  1    2    superscript   norm   subscript  ğ°ğ—  2    2        \mathbf{w}={\arg\max}_{\mathbf{w}}\frac{\left\|\mathbf{wX}_{1}\right\|^{2}}{%
 \left\|\mathbf{wX}_{2}\right\|^{2}}     The solution is given by computing the two covariance matrices :       ğ‘  1   =     ğ—  1    ğ—  1  T     t  1         subscript  ğ‘  1        subscript  ğ—  1    superscript   subscript  ğ—  1   T     subscript  t  1      \mathbf{R}_{1}=\frac{\mathbf{X}_{1}\mathbf{X}_{1}^{\text{T}}}{t_{1}}          ğ‘  2   =     ğ—  2    ğ—  2  T     t  2         subscript  ğ‘  2        subscript  ğ—  2    superscript   subscript  ğ—  2   T     subscript  t  2      \mathbf{R}_{2}=\frac{\mathbf{X}_{2}\mathbf{X}_{2}^{\text{T}}}{t_{2}}     Then, the simultaneous diagonalization of those two matrices (also called generalized eigenvalue decomposition ) is realized. We find the matrix of eigenvectors     ğ  =   [      ğ©  1     â‹¯     ğ©  n      ]       ğ     subscript  ğ©  1   normal-â‹¯   subscript  ğ©  n       \mathbf{P}=\begin{bmatrix}\mathbf{p}_{1}&\cdots&\mathbf{p}_{n}\end{bmatrix}   and the diagonal matrix    ğƒ   ğƒ   \mathbf{D}   of eigenvalues     {   Î»  1   ,  â‹¯  ,   Î»  n   }      subscript  Î»  1   normal-â‹¯   subscript  Î»  n     \{\lambda_{1},\cdots,\lambda_{n}\}   sorted by decreasing order such that:        ğ   -  1     ğ‘  1   ğ   =  ğƒ         superscript  ğ    1     subscript  ğ‘  1   ğ   ğƒ    \mathbf{P}^{-1}\mathbf{R}_{1}\mathbf{P}=\mathbf{D}     and        ğ   -  1     ğ‘  2   ğ   =   ğˆ  n          superscript  ğ    1     subscript  ğ‘  2   ğ    subscript  ğˆ  n     \mathbf{P}^{-1}\mathbf{R}_{2}\mathbf{P}=\mathbf{I}_{n}     with    ğˆ  n     subscript  ğˆ  n    \mathbf{I}_{n}   the identity matrix .  This is equivalent to the eigendecomposition of     ğ‘  2   -  1     ğ‘  1        superscript   subscript  ğ‘  2     1     subscript  ğ‘  1     \mathbf{R}_{2}^{-1}\mathbf{R}_{1}   :        ğ‘  2   -  1     ğ‘  1    =   ğğƒğ   -  1           superscript   subscript  ğ‘  2     1     subscript  ğ‘  1     superscript  ğğƒğ    1      \mathbf{R}_{2}^{-1}\mathbf{R}_{1}=\mathbf{PDP}^{-1}         ğ°  T     superscript  ğ°  T    \mathbf{w}^{\text{T}}   will correspond to the first column of   ğ   ğ   \mathbf{P}   :      ğ°  =   ğ©  1  T       ğ°   superscript   subscript  ğ©  1   T     \mathbf{w}=\mathbf{p}_{1}^{\text{T}}     Discussion  Relation between variance ratio and eigenvalue  The eigenvectors composing   ğ   ğ   \mathbf{P}   are components with variance ratio between the two windows equal to their corresponding eigenvalue:       Î»  i   =     âˆ¥    ğ©  i  T    ğ—  1    âˆ¥   2     âˆ¥    ğ©  i  T    ğ—  2    âˆ¥   2         subscript  Î»  i      superscript   norm     superscript   subscript  ğ©  i   T    subscript  ğ—  1     2    superscript   norm     superscript   subscript  ğ©  i   T    subscript  ğ—  2     2      \mathbf{\lambda}_{i}=\frac{\left\|\mathbf{p}_{i}^{\text{T}}\mathbf{X}_{1}%
 \right\|^{2}}{\left\|\mathbf{p}_{i}^{\text{T}}\mathbf{X}_{2}\right\|^{2}}     Other components  The vectorial subspace     E  i     subscript  E  i    E_{i}   generated by the   i   i   i   first eigenvectors    [      ğ©  1     â‹¯     ğ©  i      ]       subscript  ğ©  1   normal-â‹¯   subscript  ğ©  i      \begin{bmatrix}\mathbf{p}_{1}&\cdots&\mathbf{p}_{i}\end{bmatrix}   will be the subspace maximizing the variance ratio of all components belonging to it:       E  i   =   arg    max  E    (       min   p  âˆˆ  E        âˆ¥    ğ©  T    ğ—  1    âˆ¥   2     âˆ¥    ğ©  T    ğ—  2    âˆ¥   2         )          subscript  E  i       subscript   E       subscript     p  E       superscript   norm     superscript  ğ©  T    subscript  ğ—  1     2    superscript   norm     superscript  ğ©  T    subscript  ğ—  2     2           E_{i}={\arg\max}_{E}\begin{pmatrix}\min_{p\in E}\frac{\left\|\mathbf{p^{\text{%
 T}}X}_{1}\right\|^{2}}{\left\|\mathbf{p^{\text{T}}X}_{2}\right\|^{2}}\end{pmatrix}     On the same way, the vectorial subpsace    F  j     subscript  F  j    F_{j}   generated by the   j   j   j   last eigenvectors    [      ğ©    n  -  j   +  1      â‹¯     ğ©  n      ]       subscript  ğ©      n  j   1    normal-â‹¯   subscript  ğ©  n      \begin{bmatrix}\mathbf{p}_{n-j+1}&\cdots&\mathbf{p}_{n}\end{bmatrix}   will be the subspace minimizing the variance ratio of all components belonging to it:       F  j   =   arg    min  F    (       max   p  âˆˆ  F        âˆ¥    ğ©  T    ğ—  1    âˆ¥   2     âˆ¥    ğ©  T    ğ—  2    âˆ¥   2         )          subscript  F  j       subscript   F       subscript     p  F       superscript   norm     superscript  ğ©  T    subscript  ğ—  1     2    superscript   norm     superscript  ğ©  T    subscript  ğ—  2     2           F_{j}={\arg\min}_{F}\begin{pmatrix}\max_{p\in F}\frac{\left\|\mathbf{p^{\text{%
 T}}X}_{1}\right\|^{2}}{\left\|\mathbf{p^{\text{T}}X}_{2}\right\|^{2}}\end{pmatrix}     Variance or second-order moment  CSP can be applied after a mean subtraction (a.k.a. "mean centering") on signals in order to realize a variance ratio optimization. Otherwize CSP optimizes the ratio of second-order moment.  Choice of windows X 1 and X 2   The standard use consists on choosing the windows to correspond to two periods of time with different activation of sources (e.g. during rest and during a specific task).    It is also possible to choose the two windows to correspond to two different frequency bands in order to find components with specific frequency pattern. 2 Those frequency bands can be on temporal or on frequential basis. Since the matrix   ğ   ğ   \mathbf{P}   depends only of the covariance matrices, the same results can be obtained if the processing is applied on the Fourier transform of the signals.    Y. Wang 3 has proposed a particular choice for the first window    ğ—  1     subscript  ğ—  1    \mathbf{X}_{1}   in order to extract components which have a specific period.    ğ—  1     subscript  ğ—  1    \mathbf{X}_{1}   was the mean of the different periods for the examined signals.    If there is only one window,    ğ‘  2     subscript  ğ‘  2    \mathbf{R}_{2}   can be considered as the identity matrix and then CSP corresponds to Principal component analysis .   Applications  This method can be applied to several multivariate signal but it seems that most works on it concern electroencephalographic signals.  Particularly, the method is mostly used on brainâ€“computer interface in order to retrieve the component signal which best transduce the cerebral activity for a specific task (e.g. hand movement). 4  It can also be used to separate artifacts from electroencephalographics signals. 5  See also   Blind signal separation   References  "  Category:Signal processing     Zoltan J. Koles, Michael S. Lazaret and Steven Z. Zhou, "Spatial patterns underlying population differences in the background EEG" , Brain topography, Vol. 2 (4) pp. 275-284, 1990 â†©  S. Boudet, "Filtrage d'artefacts par analyse multicomposantes de l'Ã©lectroencephalogramme de patients Ã©pileptiques." , PhD. Thesis: UnviversitÃ© de Lille 1, 07/2008 â†©  Y. Wang, "Reduction of cardiac artifacts in magnetoencephalogram." Proc. of the 12th Int. Conf. on Biomagnetism, 2000 â†©  G. Pfurtscheller, C. Gugeret and H. Ramoser "EEG-based brain-computer interface using subject-specific spatial filters" , Engineering applications of bio-inspired artificial neural networks, Lecture Notes in Computer Science, 1999, Vol. 1607/1999, pp. 248-254 â†©      